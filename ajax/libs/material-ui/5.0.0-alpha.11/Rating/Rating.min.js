"use strict";var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard"),_interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.styles=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray")),_objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties")),React=_interopRequireWildcard(require("react")),_propTypes=_interopRequireDefault(require("prop-types")),_clsx=_interopRequireDefault(require("clsx")),_system=require("@material-ui/system"),_utils=require("@material-ui/utils"),_styles=require("../styles"),_utils2=require("../utils"),_Star=_interopRequireDefault(require("../internal/svg-icons/Star")),_StarBorder=_interopRequireDefault(require("../internal/svg-icons/StarBorder"));function clamp(e,t,a){return e<t?t:a<e?a:e}function getDecimalPrecision(e){var t=e.toString().split(".")[1];return t?t.length:0}function roundValueToPrecision(e,t){if(null==e)return e;var a=Math.round(e/t)*t;return Number(a.toFixed(getDecimalPrecision(t)))}var styles=function(e){return{root:{display:"inline-flex",position:"relative",fontSize:e.typography.pxToRem(24),color:"#faaf00",cursor:"pointer",textAlign:"left",WebkitTapHighlightColor:"transparent","&$disabled":{opacity:e.palette.action.disabledOpacity,pointerEvents:"none"},"&$focusVisible $iconActive":{outline:"1px solid #999"}},sizeSmall:{fontSize:e.typography.pxToRem(18)},sizeLarge:{fontSize:e.typography.pxToRem(30)},readOnly:{pointerEvents:"none"},disabled:{},focusVisible:{},visuallyHidden:_system.visuallyHidden,label:{cursor:"inherit"},labelEmptyValueActive:{top:0,bottom:0,position:"absolute",outline:"1px solid #999",width:"100%"},icon:{display:"flex",transition:e.transitions.create("transform",{duration:e.transitions.duration.shortest}),pointerEvents:"none"},iconEmpty:{color:e.palette.action.disabled},iconFilled:{},iconHover:{},iconFocus:{},iconActive:{transform:"scale(1.2)"},decimal:{position:"relative"}}};function IconContainer(e){e.value;var t=(0,_objectWithoutProperties2.default)(e,["value"]);return React.createElement("span",t)}exports.styles=styles,"production"!==process.env.NODE_ENV&&(IconContainer.propTypes={value:_propTypes.default.number.isRequired});var defaultIcon=React.createElement(_Star.default,{fontSize:"inherit"}),defaultEmptyIcon=React.createElement(_StarBorder.default,{fontSize:"inherit"});function defaultLabelText(e){return"".concat(e," Star").concat(1!==e?"s":"")}var Rating=React.forwardRef(function(e,t){function n(e){var t=parseFloat(e.target.value);B(t),C&&C(e,t)}function o(e){0===e.clientX&&0===e.clientY||(G({hover:-1,focus:-1}),B(null),C&&parseFloat(e.target.value)===W&&C(e,null))}function i(e){ee(e),!0===Q.current&&ne(!0);var t=parseFloat(e.target.value);G(function(e){return{hover:e.hover,focus:t}}),S&&Y!==t&&S(e,t)}function l(e){-1===U&&(Z(e),!1===Q.current&&ne(!1),G(function(e){return{hover:e.hover,focus:-1}}),S&&-1!==Y&&S(e,-1))}function u(e,t){var a="".concat(P,"-").concat(String(e.value).replace(".","-")),r=React.createElement(g,{value:e.value,className:(0,_clsx.default)(s.icon,e.filled?s.iconFilled:s.iconEmpty,e.hover&&s.iconHover,e.focus&&s.iconFocus,e.active&&s.iconActive)},v&&!e.filled?v:R);return V?React.createElement("span",(0,_extends2.default)({key:e.value},t),r):React.createElement(React.Fragment,{key:e.value},React.createElement("label",(0,_extends2.default)({className:s.label,htmlFor:a},t),r,React.createElement("span",{className:s.visuallyHidden},b(e.value))),React.createElement("input",{onFocus:i,onBlur:l,onChange:n,onClick:o,disabled:d,value:e.value,id:a,type:"radio",name:P,checked:e.checked,className:s.visuallyHidden}))}var s=e.classes,a=e.className,r=e.defaultValue,c=void 0===r?null:r,p=e.disabled,d=void 0!==p&&p,f=e.emptyIcon,v=void 0===f?defaultEmptyIcon:f,m=e.emptyLabelText,y=void 0===m?"Empty":m,_=e.getLabelText,b=void 0===_?defaultLabelText:_,h=e.icon,R=void 0===h?defaultIcon:h,T=e.IconContainerComponent,g=void 0===T?IconContainer:T,x=e.max,E=void 0===x?5:x,q=e.name,C=e.onChange,S=e.onChangeActive,A=e.onMouseLeave,F=e.onMouseMove,I=e.precision,M=void 0===I?1:I,N=e.readOnly,V=void 0!==N&&N,z=e.size,D=void 0===z?"medium":z,L=e.value,k=(0,_objectWithoutProperties2.default)(e,["classes","className","defaultValue","disabled","emptyIcon","emptyLabelText","getLabelText","icon","IconContainerComponent","max","name","onChange","onChangeActive","onMouseLeave","onMouseMove","precision","readOnly","size","value"]),P=(0,_utils2.unstable_useId)(q),w=(0,_utils2.useControlled)({controlled:L,default:c,name:"Rating"}),O=(0,_slicedToArray2.default)(w,2),H=O[0],B=O[1],W=roundValueToPrecision(H,M),j=(0,_styles.useTheme)(),X=React.useState({hover:-1,focus:-1}),$=X[0],U=$.hover,Y=$.focus,G=X[1],J=-1!==Y?Y:-1!==U?U:W,K=(0,_utils2.useIsFocusVisible)(),Q=K.isFocusVisibleRef,Z=K.onBlur,ee=K.onFocus,te=K.ref,ae=React.useState(!1),re=ae[0],ne=ae[1],oe=React.useRef(),ie=(0,_utils2.useForkRef)(te,oe),le=(0,_utils2.useForkRef)(ie,t),ue=React.useState(!1),se=ue[0],ce=ue[1];return React.createElement("span",(0,_extends2.default)({ref:le,onMouseMove:function(e){F&&F(e);var t=oe.current,a=t.getBoundingClientRect(),r=a.right,n=a.left,o=t.firstChild.getBoundingClientRect().width,i="rtl"===j.direction?(r-e.clientX)/(o*E):(e.clientX-n)/(o*E),l=clamp(l=roundValueToPrecision(E*i+M/2,M),M,E);G(function(e){return e.hover===l&&e.focus===l?e:{hover:l,focus:l}}),ne(!1),S&&U!==l&&S(e,l)},onMouseLeave:function(e){A&&A(e);G({hover:-1,focus:-1}),S&&-1!==U&&S(e,-1)},className:(0,_clsx.default)(s.root,a,"medium"!==D&&s["size".concat((0,_utils2.capitalize)(D))],d&&s.disabled,re&&s.focusVisible,V&&s.readOnly),role:V?"img":null,"aria-label":V?b(J):null},k),Array.from(new Array(E)).map(function(e,t){var r=t+1;if(M<1){var n=Array.from(new Array(1/M));return React.createElement("span",{key:r,className:(0,_clsx.default)(s.decimal,r===Math.ceil(J)&&(-1!==U||-1!==Y)&&s.iconActive)},n.map(function(e,t){var a=roundValueToPrecision(r-1+(t+1)*M,M);return u({value:a,filled:a<=J,hover:a<=U,focus:a<=Y,checked:a===W},{style:n.length-1===t?{}:{width:a===J?"".concat((t+1)*M*100,"%"):"0%",overflow:"hidden",zIndex:1,position:"absolute"}})}))}return u({value:r,active:r===J&&(-1!==U||-1!==Y),filled:r<=J,hover:r<=U,focus:r<=Y,checked:r===W})}),!V&&!d&&null==W&&React.createElement("label",{className:(0,_clsx.default)(se&&s.labelEmptyValueActive)},React.createElement("input",{value:"",id:"".concat(P,"-empty"),type:"radio",name:P,defaultChecked:!0,className:s.visuallyHidden,onFocus:function(){return ce(!0)},onBlur:function(){return ce(!1)}}),React.createElement("span",{className:s.visuallyHidden},y)))});"production"!==process.env.NODE_ENV&&(Rating.propTypes={classes:_propTypes.default.object,className:_propTypes.default.string,defaultValue:_propTypes.default.number,disabled:_propTypes.default.bool,emptyIcon:_propTypes.default.node,emptyLabelText:_propTypes.default.node,getLabelText:_propTypes.default.func,icon:_propTypes.default.node,IconContainerComponent:_propTypes.default.elementType,max:_propTypes.default.number,name:_propTypes.default.string,onChange:_propTypes.default.func,onChangeActive:_propTypes.default.func,onMouseLeave:_propTypes.default.func,onMouseMove:_propTypes.default.func,precision:(0,_utils.chainPropTypes)(_propTypes.default.number,function(e){return e.precision<.1?new Error(["Material-UI: The prop `precision` should be above 0.1.","A value below this limit has an imperceptible impact."].join("\n")):null}),readOnly:_propTypes.default.bool,size:_propTypes.default.oneOf(["large","medium","small"]),value:_propTypes.default.number});var _default=(0,_styles.withStyles)(styles,{name:"MuiRating"})(Rating);exports.default=_default;
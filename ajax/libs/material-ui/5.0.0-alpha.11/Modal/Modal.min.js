"use strict";var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard"),_interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.styles=void 0;var _objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties")),_extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),React=_interopRequireWildcard(require("react")),_propTypes=_interopRequireDefault(require("prop-types")),_styles=require("@material-ui/styles"),_utils=require("@material-ui/utils"),_ownerDocument=_interopRequireDefault(require("../utils/ownerDocument")),_Portal=_interopRequireDefault(require("../Portal")),_createChainedFunction=_interopRequireDefault(require("../utils/createChainedFunction")),_useForkRef=_interopRequireDefault(require("../utils/useForkRef")),_useEventCallback=_interopRequireDefault(require("../utils/useEventCallback")),_zIndex=_interopRequireDefault(require("../styles/zIndex")),_ModalManager=_interopRequireWildcard(require("./ModalManager")),_Unstable_TrapFocus=_interopRequireDefault(require("../Unstable_TrapFocus")),_SimpleBackdrop=_interopRequireDefault(require("./SimpleBackdrop"));function getContainer(e){return"function"==typeof e?e():e}function getHasTransition(e){return!!e.children&&e.children.props.hasOwnProperty("in")}var defaultManager=new _ModalManager.default,styles=function(e){return{root:{position:"fixed",zIndex:e.zIndex.modal,right:0,bottom:0,top:0,left:0},hidden:{visibility:"hidden"}}};exports.styles=styles;var Modal=React.forwardRef(function(e,o){function t(){return(0,_ownerDocument.default)(O.current)}function r(){return H.current.modalRef=N.current,H.current.mountNode=O.current,H.current}function a(){w.mount(r(),{disableScrollLock:x}),N.current.scrollTop=0}var n=(0,_styles.useTheme)(),l=(0,_styles.getThemeProps)({name:"MuiModal",props:(0,_extends2.default)({},e),theme:n}),i=l.BackdropComponent,u=void 0===i?_SimpleBackdrop.default:i,s=l.BackdropProps,d=l.children,p=l.closeAfterTransition,c=void 0!==p&&p,f=l.container,_=l.disableAutoFocus,b=void 0!==_&&_,y=l.disableBackdropClick,R=void 0!==y&&y,k=l.disableEnforceFocus,T=void 0!==k&&k,q=l.disableEscapeKeyDown,m=void 0!==q&&q,v=l.disablePortal,E=void 0!==v&&v,h=l.disableRestoreFocus,C=void 0!==h&&h,D=l.disableScrollLock,x=void 0!==D&&D,F=l.hideBackdrop,M=void 0!==F&&F,g=l.keepMounted,B=void 0!==g&&g,P=l.manager,w=void 0===P?defaultManager:P,I=l.onBackdropClick,A=l.onClose,K=l.onEscapeKeyDown,S=l.open,W=(0,_objectWithoutProperties2.default)(l,["BackdropComponent","BackdropProps","children","closeAfterTransition","container","disableAutoFocus","disableBackdropClick","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","manager","onBackdropClick","onClose","onEscapeKeyDown","open"]),z=React.useState(!0),j=z[0],L=z[1],H=React.useRef({}),O=React.useRef(null),N=React.useRef(null),U=(0,_useForkRef.default)(N,o),V=getHasTransition(l),G=(0,_useEventCallback.default)(function(){var e=getContainer(f)||t().body;w.add(r(),e),N.current&&a()}),J=React.useCallback(function(){return w.isTopModal(r())},[w]),Q=(0,_useEventCallback.default)(function(e){(O.current=e)&&(S&&J()?a():(0,_ModalManager.ariaHidden)(N.current,!0))}),X=React.useCallback(function(){w.remove(r())},[w]);if(React.useEffect(function(){return function(){X()}},[X]),React.useEffect(function(){S?G():V&&c||X()},[S,X,V,c,G]),!B&&!S&&(!V||j))return null;var Y=styles(n||{zIndex:_zIndex.default}),Z={};return void 0===d.props.tabIndex&&(Z.tabIndex=d.props.tabIndex||"-1"),V&&(Z.onEnter=(0,_createChainedFunction.default)(function(){L(!1)},d.props.onEnter),Z.onExited=(0,_createChainedFunction.default)(function(){L(!0),c&&X()},d.props.onExited)),React.createElement(_Portal.default,{ref:Q,container:f,disablePortal:E},React.createElement("div",(0,_extends2.default)({ref:U,onKeyDown:function(e){"Escape"===e.key&&J()&&(K&&K(e),m||(e.stopPropagation(),A&&A(e,"escapeKeyDown")))},role:"presentation"},W,{style:(0,_extends2.default)({},Y.root,!S&&j?Y.hidden:{},W.style)}),M?null:React.createElement(u,(0,_extends2.default)({open:S,onClick:function(e){e.target===e.currentTarget&&(I&&I(e),!R&&A&&A(e,"backdropClick"))}},s)),React.createElement(_Unstable_TrapFocus.default,{disableEnforceFocus:T,disableAutoFocus:b,disableRestoreFocus:C,getDoc:t,isEnabled:J,open:S},React.cloneElement(d,Z))))});"production"!==process.env.NODE_ENV&&(Modal.propTypes={BackdropComponent:_propTypes.default.elementType,BackdropProps:_propTypes.default.object,children:_utils.elementAcceptingRef.isRequired,closeAfterTransition:_propTypes.default.bool,container:_propTypes.default.oneOfType([_utils.HTMLElementType,_propTypes.default.func]),disableAutoFocus:_propTypes.default.bool,disableBackdropClick:_propTypes.default.bool,disableEnforceFocus:_propTypes.default.bool,disableEscapeKeyDown:_propTypes.default.bool,disablePortal:_propTypes.default.bool,disableRestoreFocus:_propTypes.default.bool,disableScrollLock:_propTypes.default.bool,hideBackdrop:_propTypes.default.bool,keepMounted:_propTypes.default.bool,onBackdropClick:_propTypes.default.func,onClose:_propTypes.default.func,onEscapeKeyDown:_propTypes.default.func,open:_propTypes.default.bool.isRequired});var _default=Modal;exports.default=Modal;
"use strict";var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard"),_interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.styles=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties")),_defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty")),React=_interopRequireWildcard(require("react")),_reactIs=require("react-is"),_propTypes=_interopRequireDefault(require("prop-types")),_clsx=_interopRequireDefault(require("clsx")),_utils=require("@material-ui/utils"),_debounce=_interopRequireDefault(require("../utils/debounce")),_ownerWindow=_interopRequireDefault(require("../utils/ownerWindow")),_scrollLeft=require("../utils/scrollLeft"),_animate=_interopRequireDefault(require("../internal/animate")),_ScrollbarSize=_interopRequireDefault(require("./ScrollbarSize")),_withStyles=_interopRequireDefault(require("../styles/withStyles")),_TabIndicator=_interopRequireDefault(require("./TabIndicator")),_TabScrollButton=_interopRequireDefault(require("../TabScrollButton")),_useEventCallback=_interopRequireDefault(require("../utils/useEventCallback")),_useTheme=_interopRequireDefault(require("../styles/useTheme")),styles=function(e){return{root:{overflow:"hidden",minHeight:48,WebkitOverflowScrolling:"touch",display:"flex"},vertical:{flexDirection:"column"},flexContainer:{display:"flex"},flexContainerVertical:{flexDirection:"column"},centered:{justifyContent:"center"},scroller:{position:"relative",display:"inline-block",flex:"1 1 auto",whiteSpace:"nowrap"},fixed:{overflowX:"hidden",width:"100%"},scrollableX:{overflowX:"auto",overflowY:"hidden"},scrollableY:{overflowY:"auto",overflowX:"hidden"},hideScrollbar:{scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}},scrollButtons:{},scrollButtonsDesktop:(0,_defineProperty2.default)({},e.breakpoints.down("xs"),{display:"none"}),indicator:{}}};exports.styles=styles;var Tabs=React.forwardRef(function(e,t){var r=e["aria-label"],l=e["aria-labelledby"],o=e.action,a=e.centered,n=void 0!==a&&a,i=e.children,c=e.classes,s=e.className,u=e.component,d=void 0===u?"div":u,f=e.indicatorColor,p=void 0===f?"secondary":f,b=e.onChange,_=e.orientation,v=void 0===_?"horizontal":_,h=e.ScrollButtonComponent,m=void 0===h?_TabScrollButton.default:h,y=e.scrollButtons,T=void 0===y?"auto":y,R=e.selectionFollowsFocus,w=e.TabIndicatorProps,S=void 0===w?{}:w,g=e.TabScrollButtonProps,x=e.textColor,q=void 0===x?"inherit":x,C=e.value,E=e.variant,D=void 0===E?"standard":E,N=e.visibleScrollbar,B=void 0!==N&&N,W=(0,_objectWithoutProperties2.default)(e,["aria-label","aria-labelledby","action","centered","children","classes","className","component","indicatorColor","onChange","orientation","ScrollButtonComponent","scrollButtons","selectionFollowsFocus","TabIndicatorProps","TabScrollButtonProps","textColor","value","variant","visibleScrollbar"]),k=(0,_useTheme.default)(),L="scrollable"===D,P="rtl"===k.direction,I="vertical"===v,M=I?"scrollTop":"scrollLeft",z=I?"top":"left",j=I?"bottom":"right",O=I?"clientHeight":"clientWidth",F=I?"height":"width";"production"!==process.env.NODE_ENV&&n&&L&&console.error('Material-UI: You can not use the `centered={true}` and `variant="scrollable"` properties at the same time on a `Tabs` component.');function A(){var e,t,r,l,o,a=ne.current;return a&&(e=a.getBoundingClientRect(),t={clientWidth:a.clientWidth,scrollLeft:a.scrollLeft,scrollTop:a.scrollTop,scrollLeftNormalized:(0,_scrollLeft.getNormalizedScrollLeft)(a,k.direction),scrollWidth:a.scrollWidth,top:e.top,bottom:e.bottom,left:e.left,right:e.right}),!a||!1===C||0<(l=ie.current.children).length&&(o=l[ae.get(C)],"production"!==process.env.NODE_ENV&&(o||console.error(["Material-UI: The value provided to the Tabs component is invalid.","None of the Tabs' children match with `".concat(C,"`."),ae.keys?"You can provide one of the following values: ".concat(Array.from(ae.keys()).join(", "),"."):null].join("\n"))),r=o?o.getBoundingClientRect():null),{tabsMeta:t,tabMeta:r}}function V(e){(0,_animate.default)(M,ne.current,e)}function H(e){var t=ne.current[M];I?t+=e:(t+=e*(P?-1:1),t*=P&&"reverse"===(0,_scrollLeft.detectScrollType)()?-1:1),V(t)}function X(){H(-ne.current[O])}function Y(){H(ne.current[O])}var U=React.useState(!1),K=U[0],G=U[1],J=React.useState({}),Q=J[0],Z=J[1],$=React.useState({start:!1,end:!1}),ee=$[0],te=$[1],re=React.useState({overflow:"hidden",scrollbarWidth:0}),le=re[0],oe=re[1],ae=new Map,ne=React.useRef(null),ie=React.useRef(null),ce=(0,_useEventCallback.default)(function(){var e,t,r=A(),l=r.tabsMeta,o=r.tabMeta,a=0;o&&l&&(a=I?o.top-l.top+l.scrollTop:(t=P?l.scrollLeftNormalized+l.clientWidth-l.scrollWidth:l.scrollLeft,o.left-l.left+t));var n,i,c=(e={},(0,_defineProperty2.default)(e,z,a),(0,_defineProperty2.default)(e,F,o?o[F]:0),e);isNaN(Q[z])||isNaN(Q[F])?Z(c):(n=Math.abs(Q[z]-c[z]),i=Math.abs(Q[F]-c[F]),(1<=n||1<=i)&&Z(c))}),se=React.useCallback(function(e){oe({overflow:null,scrollbarWidth:e})},[]),ue=(0,_useEventCallback.default)(function(){var e,t,r=A(),l=r.tabsMeta,o=r.tabMeta;o&&l&&(o[z]<l[z]?(e=l[M]+(o[z]-l[z]),V(e)):o[j]>l[j]&&(t=l[M]+(o[j]-l[j]),V(t)))}),de=(0,_useEventCallback.default)(function(){var e,t,r,l,o,a,n,i,c;L&&"off"!==T&&(t=(e=ne.current).scrollTop,r=e.scrollHeight,l=e.clientHeight,o=e.scrollWidth,a=e.clientWidth,c=I?(i=1<t,t<r-l-1):(n=(0,_scrollLeft.getNormalizedScrollLeft)(ne.current,k.direction),i=P?n<o-a-1:1<n,P?1<n:n<o-a-1),i===ee.start&&c===ee.end||te({start:i,end:c}))});React.useEffect(function(){var e=(0,_debounce.default)(function(){ce(),de()}),t=(0,_ownerWindow.default)(ne.current);return t.addEventListener("resize",e),function(){e.clear(),t.removeEventListener("resize",e)}},[ce,de]);var fe=React.useMemo(function(){return(0,_debounce.default)(function(){de()})},[de]);React.useEffect(function(){return function(){fe.clear()}},[fe]),React.useEffect(function(){G(!0)},[]),React.useEffect(function(){ce(),de()}),React.useEffect(function(){ue()},[ue,Q]),React.useImperativeHandle(o,function(){return{updateIndicator:ce,updateScrollButtons:de}},[ce,de]);var pe=React.createElement(_TabIndicator.default,(0,_extends2.default)({className:c.indicator,orientation:v,color:p},S,{style:(0,_extends2.default)({},Q,S.style)})),be=0,_e=React.Children.map(i,function(e){if(!React.isValidElement(e))return null;"production"!==process.env.NODE_ENV&&(0,_reactIs.isFragment)(e)&&console.error(["Material-UI: The Tabs component doesn't accept a Fragment as a child.","Consider providing an array instead."].join("\n"));var t=void 0===e.props.value?be:e.props.value;ae.set(t,be);var r=t===C;return be+=1,React.cloneElement(e,(0,_extends2.default)({fullWidth:"fullWidth"===D,indicator:r&&!K&&pe,selected:r,selectionFollowsFocus:R,onChange:b,textColor:q,value:t},1!==be||!1!==C||e.props.tabIndex?{}:{tabIndex:0}))}),ve=function(){var e={};e.scrollbarSizeListener=L?React.createElement(_ScrollbarSize.default,{onChange:se,className:(0,_clsx.default)(c.scrollableX,c.hideScrollbar)}):null;var t=ee.start||ee.end,r=L&&("auto"===T&&t||"desktop"===T||"on"===T);return e.scrollButtonStart=r?React.createElement(m,(0,_extends2.default)({orientation:v,direction:P?"right":"left",onClick:X,disabled:!ee.start,className:(0,_clsx.default)(c.scrollButtons,"on"!==T&&c.scrollButtonsDesktop)},g)):null,e.scrollButtonEnd=r?React.createElement(m,(0,_extends2.default)({orientation:v,direction:P?"left":"right",onClick:Y,disabled:!ee.end,className:(0,_clsx.default)(c.scrollButtons,"on"!==T&&c.scrollButtonsDesktop)},g)):null,e}();return React.createElement(d,(0,_extends2.default)({className:(0,_clsx.default)(c.root,s,I&&c.vertical),ref:t},W),ve.scrollButtonStart,ve.scrollbarSizeListener,React.createElement("div",{className:(0,_clsx.default)(c.scroller,L?[I?c.scrollableY:c.scrollableX,!B&&c.hideScrollbar]:c.fixed),style:(0,_defineProperty2.default)({overflow:le.overflow},I?"margin".concat(P?"Left":"Right"):"marginBottom",B?void 0:-le.scrollbarWidth),ref:ne,onScroll:fe},React.createElement("div",{"aria-label":r,"aria-labelledby":l,"aria-orientation":"vertical"===v?"vertical":null,className:(0,_clsx.default)(c.flexContainer,I&&c.flexContainerVertical,n&&!L&&c.centered),onKeyDown:function(e){var t=e.target;if("tab"===t.getAttribute("role")){var r=null,l="vertical"!==v?"ArrowLeft":"ArrowUp",o="vertical"!==v?"ArrowRight":"ArrowDown";switch("vertical"!==v&&"rtl"===k.direction&&(l="ArrowRight",o="ArrowLeft"),e.key){case l:r=t.previousElementSibling||ie.current.lastChild;break;case o:r=t.nextElementSibling||ie.current.firstChild;break;case"Home":r=ie.current.firstChild;break;case"End":r=ie.current.lastChild}null!==r&&(r.focus(),e.preventDefault())}},ref:ie,role:"tablist"},_e),K&&pe),ve.scrollButtonEnd)});"production"!==process.env.NODE_ENV&&(Tabs.propTypes={action:_utils.refType,"aria-label":_propTypes.default.string,"aria-labelledby":_propTypes.default.string,centered:_propTypes.default.bool,children:_propTypes.default.node,classes:_propTypes.default.object,className:_propTypes.default.string,component:_propTypes.default.elementType,indicatorColor:_propTypes.default.oneOf(["primary","secondary"]),onChange:_propTypes.default.func,orientation:_propTypes.default.oneOf(["horizontal","vertical"]),ScrollButtonComponent:_propTypes.default.elementType,scrollButtons:_propTypes.default.oneOf(["auto","desktop","off","on"]),selectionFollowsFocus:_propTypes.default.bool,TabIndicatorProps:_propTypes.default.object,TabScrollButtonProps:_propTypes.default.object,textColor:_propTypes.default.oneOf(["inherit","primary","secondary"]),value:_propTypes.default.any,variant:_propTypes.default.oneOf(["fullWidth","scrollable","standard"]),visibleScrollbar:_propTypes.default.bool});var _default=(0,_withStyles.default)(styles,{name:"MuiTabs"})(Tabs);exports.default=_default;
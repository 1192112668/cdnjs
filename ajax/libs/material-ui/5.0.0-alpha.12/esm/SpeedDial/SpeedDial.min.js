import _extends from"@babel/runtime/helpers/esm/extends";import _slicedToArray from"@babel/runtime/helpers/esm/slicedToArray";import _objectWithoutProperties from"@babel/runtime/helpers/esm/objectWithoutProperties";import*as React from"react";import{isFragment}from"react-is";import PropTypes from"prop-types";import clsx from"clsx";import{duration,withStyles}from"@material-ui/core/styles";import Zoom from"@material-ui/core/Zoom";import Fab from"@material-ui/core/Fab";import{capitalize,isMuiElement,useForkRef,useControlled}from"@material-ui/core/utils";function getOrientation(e){return"up"===e||"down"===e?"vertical":"right"===e||"left"===e?"horizontal":void 0}function clamp(e,o,n){return e<o?o:e>n?n:e}var dialRadius=32,spacingActions=16;export var styles=function(e){return{root:{zIndex:e.zIndex.speedDial,display:"flex",alignItems:"center",pointerEvents:"none"},fab:{pointerEvents:"auto"},directionUp:{flexDirection:"column-reverse","& $actions":{flexDirection:"column-reverse",marginBottom:-dialRadius,paddingBottom:spacingActions+dialRadius}},directionDown:{flexDirection:"column","& $actions":{flexDirection:"column",marginTop:-dialRadius,paddingTop:spacingActions+dialRadius}},directionLeft:{flexDirection:"row-reverse","& $actions":{flexDirection:"row-reverse",marginRight:-dialRadius,paddingRight:spacingActions+dialRadius}},directionRight:{flexDirection:"row","& $actions":{flexDirection:"row",marginLeft:-dialRadius,paddingLeft:spacingActions+dialRadius}},actions:{display:"flex",pointerEvents:"auto"},actionsClosed:{transition:"top 0s linear 0.2s",pointerEvents:"none"}}};var SpeedDial=React.forwardRef(function(e,o){var n=e.ariaLabel,r=e.FabProps,t=(r=void 0===r?{}:r).ref,i=_objectWithoutProperties(r,["ref"]),a=e.children,s=e.classes,c=e.className,p=e.direction,u=void 0===p?"up":p,l=e.hidden,d=void 0!==l&&l,m=e.icon,f=e.onBlur,y=e.onClose,T=e.onFocus,v=e.onKeyDown,g=e.onMouseEnter,P=e.onMouseLeave,b=e.onOpen,R=e.open,h=(e.openIcon,e.TransitionComponent),x=void 0===h?Zoom:h,D=e.transitionDuration,E=void 0===D?{enter:duration.enteringScreen,exit:duration.leavingScreen}:D,w=e.TransitionProps,C=_objectWithoutProperties(e,["ariaLabel","FabProps","children","classes","className","direction","hidden","icon","onBlur","onClose","onFocus","onKeyDown","onMouseEnter","onMouseLeave","onOpen","open","openIcon","TransitionComponent","transitionDuration","TransitionProps"]),F=useControlled({controlled:R,default:!1,name:"SpeedDial",state:"open"}),O=_slicedToArray(F,2),_=O[0],L=O[1],M=React.useRef();React.useEffect(function(){return function(){clearTimeout(M.current)}},[]);var N=React.useRef(0),S=React.useRef(),A=React.useRef([]);A.current=[A.current[0]];var j=React.useCallback(function(e){A.current[0]=e},[]),k=useForkRef(t,j);React.useEffect(function(){_||(N.current=0,S.current=void 0)},[_]);var I=function(e){"mouseleave"===e.type&&P&&P(e),"blur"===e.type&&f&&f(e),clearTimeout(M.current),"blur"===e.type?(e.persist(),M.current=setTimeout(function(){L(!1),y&&y(e,"blur")})):(L(!1),y&&y(e,"mouseLeave"))},z=function(e){"mouseenter"===e.type&&g&&g(e),"focus"===e.type&&T&&T(e),clearTimeout(M.current),_||(e.persist(),M.current=setTimeout(function(){if(L(!0),b){b(e,{focus:"focus",mouseenter:"mouseEnter"}[e.type])}}))},B=n.replace(/^[^a-z]+|[^\w:.-]+/gi,""),K=React.Children.toArray(a).filter(function(e){return"production"!==process.env.NODE_ENV&&isFragment(e)&&console.error(["Material-UI: The SpeedDial component doesn't accept a Fragment as a child.","Consider providing an array instead."].join("\n")),React.isValidElement(e)}),W=K.map(function(e,o){var n=e.props.FabProps,r=(n=void 0===n?{}:n).ref,t=_objectWithoutProperties(n,["ref"]);return React.cloneElement(e,{FabProps:_extends({},t,{ref:function(e,o){return function(n){A.current[e+1]=n,o&&o(n)}}(o,r)}),delay:30*(_?o:K.length-o),open:_,id:"".concat(B,"-action-").concat(o)})});return React.createElement("div",_extends({className:clsx(s.root,s["direction".concat(capitalize(u))],c),ref:o,role:"presentation",onKeyDown:function(e){v&&v(e);var o=e.key.replace("Arrow","").toLowerCase(),n=S.current,r=void 0===n?o:n;if("Escape"===e.key)return L(!1),void(y&&(A.current[0].focus(),y(e,"escapeKeyDown")));if(getOrientation(o)===getOrientation(r)&&void 0!==getOrientation(o)){e.preventDefault();var t=o===r?1:-1,i=clamp(N.current+t,0,A.current.length-1);A.current[i].focus(),N.current=i,S.current=r}},onBlur:I,onFocus:z,onMouseEnter:z,onMouseLeave:I},C),React.createElement(x,_extends({in:!d,timeout:E,unmountOnExit:!0},w),React.createElement(Fab,_extends({color:"primary","aria-label":n,"aria-haspopup":"true","aria-expanded":_,"aria-controls":"".concat(B,"-actions")},i,{onClick:function(e){i.onClick&&i.onClick(e),clearTimeout(M.current),_?(L(!1),y&&y(e,"toggle")):(L(!0),b&&b(e,"toggle"))},className:clsx(s.fab,i.className),ref:k}),React.isValidElement(m)&&isMuiElement(m,["SpeedDialIcon"])?React.cloneElement(m,{open:_}):m)),React.createElement("div",{id:"".concat(B,"-actions"),role:"menu","aria-orientation":getOrientation(u),className:clsx(s.actions,!_&&s.actionsClosed)},W))});"production"!==process.env.NODE_ENV&&(SpeedDial.propTypes={ariaLabel:PropTypes.string.isRequired,children:PropTypes.node,classes:PropTypes.object,className:PropTypes.string,direction:PropTypes.oneOf(["down","left","right","up"]),FabProps:PropTypes.object,hidden:PropTypes.bool,icon:PropTypes.node,onBlur:PropTypes.func,onClose:PropTypes.func,onFocus:PropTypes.func,onKeyDown:PropTypes.func,onMouseEnter:PropTypes.func,onMouseLeave:PropTypes.func,onOpen:PropTypes.func,open:PropTypes.bool,openIcon:PropTypes.node,TransitionComponent:PropTypes.elementType,transitionDuration:PropTypes.oneOfType([PropTypes.number,PropTypes.shape({appear:PropTypes.number,enter:PropTypes.number,exit:PropTypes.number})]),TransitionProps:PropTypes.object});export default withStyles(styles,{name:"MuiSpeedDial"})(SpeedDial);
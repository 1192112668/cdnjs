"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ownKeys(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function _objectSpread2(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _createSuper(r){var n=_isNativeReflectConstruct();return function(){var e,t=_getPrototypeOf(r);return _possibleConstructorReturn(this,n?(e=_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function isArray(e){return Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)}var INFINITY=1/0;function baseToString(e){if("string"==typeof e)return e;var t=e+"";return"0"==t&&1/e==-INFINITY?"-0":t}function toString(e){return null==e?"":baseToString(e)}function isString(e){return"string"==typeof e}function isNumber(e){return"number"==typeof e}function isObject(e){return"object"===_typeof(e)}function isDefined(e){return null!=e}function isBlank(e){return!e.trim().length}var EXTENDED_SEARCH_UNAVAILABLE="Extended search is not available",INCORRECT_INDEX_TYPE="Incorrect 'index' type",LOGICAL_SEARCH_INVALID_QUERY_FOR_KEY=function(e){return"Invalid value for key ".concat(e)},PATTERN_LENGTH_TOO_LARGE=function(e){return"Pattern length exceeds max of ".concat(e,".")},MISSING_KEY_PROPERTY=function(e){return"Missing ".concat(e," property in key")},INVALID_KEY_WEIGHT_VALUE=function(e){return"Property 'weight' in key '".concat(e,"' must be a positive integer")},hasOwn=Object.prototype.hasOwnProperty,KeyStore=function(){function t(e){var r=this;_classCallCheck(this,t),this._keys=[],this._keyMap={};var n=0;e.forEach(function(e){var t=createKey(e);n+=t.weight,r._keys.push(t),r._keyMap[t.id]=t,n+=t.weight}),this._keys.forEach(function(e){e.weight/=n})}return _createClass(t,[{key:"get",value:function(e){return this._keyMap[e]}},{key:"keys",value:function(){return this._keys}},{key:"toJSON",value:function(){return JSON.stringify(this._keys)}}]),t}();function createKey(e){var t=null,r=null,n=null,i=1;if(isString(e)||isArray(e))t=createKeyPath(n=e),r=createKeyId(e);else{if(!hasOwn.call(e,"name"))throw new Error(MISSING_KEY_PROPERTY("name"));var a=e.name,n=a;if(hasOwn.call(e,"weight")&&(i=e.weight)<=0)throw new Error(INVALID_KEY_WEIGHT_VALUE(a));t=createKeyPath(a),r=createKeyId(a)}return{path:t,id:r,weight:i,src:n}}function createKeyPath(e){return isArray(e)?e:e.split(".")}function createKeyId(e){return isArray(e)?e.join("."):e}function get(e,t){var s=[],c=!1;return function e(t,r,n){if(r[n]){var i=t[r[n]];if(!isDefined(i))return;if(n===r.length-1&&(isString(i)||isNumber(i)))s.push(toString(i));else if(isArray(i)){c=!0;for(var a=0,o=i.length;a<o;a+=1)e(i[a],r,n+1)}else r.length&&e(i,r,n+1)}else s.push(t)}(e,isString(t)?t.split("."):t,0),c?s:s[0]}var MatchOptions={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},BasicOptions={isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:function(e,t){return e.score===t.score?e.idx<t.idx?-1:1:e.score<t.score?-1:1}},FuzzyOptions={location:0,threshold:.6,distance:100},AdvancedOptions={useExtendedSearch:!1,getFn:get,ignoreLocation:!1,ignoreFieldNorm:!1},Config=_objectSpread2({},BasicOptions,{},MatchOptions,{},FuzzyOptions,{},AdvancedOptions),SPACE=/[^ ]+/g;function norm(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:3,i=new Map;return{get:function(e){var t=e.match(SPACE).length;if(i.has(t))return i.get(t);var r=parseFloat((1/Math.sqrt(t)).toFixed(n));return i.set(t,r),r},clear:function(){i.clear()}}}var FuseIndex=function(){function r(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).getFn,t=void 0===e?Config.getFn:e;_classCallCheck(this,r),this.norm=norm(3),this.getFn=t,this.isCreated=!1,this.setIndexRecords()}return _createClass(r,[{key:"setSources",value:function(e){var t=0<arguments.length&&void 0!==e?e:[];this.docs=t}},{key:"setIndexRecords",value:function(e){var t=0<arguments.length&&void 0!==e?e:[];this.records=t}},{key:"setKeys",value:function(e){var r=this,t=0<arguments.length&&void 0!==e?e:[];this.keys=t,this._keysMap={},t.forEach(function(e,t){r._keysMap[e.id]=t})}},{key:"create",value:function(){var r=this;!this.isCreated&&this.docs.length&&(this.isCreated=!0,isString(this.docs[0])?this.docs.forEach(function(e,t){r._addString(e,t)}):this.docs.forEach(function(e,t){r._addObject(e,t)}),this.norm.clear())}},{key:"add",value:function(e){var t=this.size();isString(e)?this._addString(e,t):this._addObject(e,t)}},{key:"removeAt",value:function(e){this.records.splice(e,1);for(var t=e,r=this.size();t<r;t+=1)--this.records[t].i}},{key:"getValueForItemAtKeyId",value:function(e,t){return e[this._keysMap[t]]}},{key:"size",value:function(){return this.records.length}},{key:"_addString",value:function(e,t){var r;isDefined(e)&&!isBlank(e)&&(r={v:e,i:t,n:this.norm.get(e)},this.records.push(r))}},{key:"_addObject",value:function(r,e){var c=this,u={i:e,$:{}};this.keys.forEach(function(e,o){var t,s=c.getFn(r,e.path);isDefined(s)&&(isArray(s)?function(){for(var e=[],r=[{nestedArrIndex:-1,value:s}];r.length;){var t,n=r.pop(),i=n.nestedArrIndex,a=n.value;isDefined(a)&&(isString(a)&&!isBlank(a)?(t={v:a,i:i,n:c.norm.get(a)},e.push(t)):isArray(a)&&a.forEach(function(e,t){r.push({nestedArrIndex:t,value:e})}))}u.$[o]=e}():isBlank(s)||(t={v:s,n:c.norm.get(s)},u.$[o]=t))}),this.records.push(u)}},{key:"toJSON",value:function(){return{keys:this.keys,records:this.records}}}]),r}();function createIndex(e,t){var r=(2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).getFn,n=void 0===r?Config.getFn:r,i=new FuseIndex({getFn:n});return i.setKeys(e.map(createKey)),i.setSources(t),i.create(),i}function parseIndex(e){var t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).getFn,r=void 0===t?Config.getFn:t,n=e.keys,i=e.records,a=new FuseIndex({getFn:r});return a.setKeys(n),a.setIndexRecords(i),a}function transformMatches(e,r){var t=e.matches;r.matches=[],isDefined(t)&&t.forEach(function(e){var t;isDefined(e.indices)&&e.indices.length&&(t={indices:e.indices,value:e.value},e.key&&(t.key=e.key.src),-1<e.idx&&(t.refIndex=e.idx),r.matches.push(t))})}function transformScore(e,t){t.score=e.score}function computeScore(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=t.errors,n=void 0===r?0:r,i=t.currentLocation,a=void 0===i?0:i,o=t.expectedLocation,s=void 0===o?0:o,c=t.distance,u=void 0===c?Config.distance:c,h=t.ignoreLocation,l=void 0===h?Config.ignoreLocation:h,f=n/e.length;if(l)return f;var d=Math.abs(s-a);return u?f+d/u:d?1:f}function convertMaskToIndices(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Config.minMatchCharLength,r=[],n=-1,i=-1,a=0,o=e.length;a<o;a+=1){var s=e[a];s&&-1===n?n=a:s||-1===n||(t<=(i=a-1)-n+1&&r.push([n,i]),n=-1)}return e[a-1]&&t<=a-n&&r.push([n,a-1]),r}var MAX_BITS=32;function search(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},i=n.location,a=void 0===i?Config.location:i,o=n.distance,s=void 0===o?Config.distance:o,c=n.threshold,u=void 0===c?Config.threshold:c,h=n.findAllMatches,l=void 0===h?Config.findAllMatches:h,f=n.minMatchCharLength,d=void 0===f?Config.minMatchCharLength:f,v=n.includeMatches,g=void 0===v?Config.includeMatches:v,y=n.ignoreLocation,p=void 0===y?Config.ignoreLocation:y;if(t.length>MAX_BITS)throw new Error(PATTERN_LENGTH_TOO_LARGE(MAX_BITS));for(var _,C=t.length,m=e.length,M=Math.max(0,Math.min(a,m)),k=u,S=M,x=1<d||g,A=x?Array(m):[];-1<(_=e.indexOf(t,S));){var b=computeScore(t,{currentLocation:_,expectedLocation:M,distance:s,ignoreLocation:p}),k=Math.min(b,k),S=_+C;if(x)for(var I=0;I<C;)I+=A[_+I]=1}S=-1;for(var E=[],O=1,L=C+m,P=1<<C-1,T=0;T<C;T+=1){for(var w=0,R=L;w<R;){computeScore(t,{errors:T,currentLocation:M+R,expectedLocation:M,distance:s,ignoreLocation:p})<=k?w=R:L=R,R=Math.floor((L-w)/2+w)}L=R;var F=Math.max(1,M-R+1),N=l?m:Math.min(M+R,m)+C,j=Array(N+2);j[N+1]=(1<<T)-1;for(var $=N;F<=$;--$){var K=$-1,D=r[e.charAt(K)];if(x&&(A[K]=+!!D),j[$]=(j[$+1]<<1|1)&D,T&&(j[$]|=(E[$+1]|E[$])<<1|1|E[$+1]),j[$]&P&&(O=computeScore(t,{errors:T,currentLocation:K,expectedLocation:M,distance:s,ignoreLocation:p}))<=k){if(k=O,(S=K)<=M)break;F=Math.max(1,2*M-S)}}if(k<computeScore(t,{errors:T+1,currentLocation:M,expectedLocation:M,distance:s,ignoreLocation:p}))break;E=j}var B,z={isMatch:0<=S,score:Math.max(.001,O)};return x&&((B=convertMaskToIndices(A,d)).length?g&&(z.indices=B):z.isMatch=!1),z}function createPatternAlphabet(e){for(var t={},r=0,n=e.length;r<n;r+=1){var i=e.charAt(r);t[i]=(t[i]||0)|1<<n-r-1}return t}var BitapSearch=function(){function A(e){var r=this,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.location,i=void 0===n?Config.location:n,a=t.threshold,o=void 0===a?Config.threshold:a,s=t.distance,c=void 0===s?Config.distance:s,u=t.includeMatches,h=void 0===u?Config.includeMatches:u,l=t.findAllMatches,f=void 0===l?Config.findAllMatches:l,d=t.minMatchCharLength,v=void 0===d?Config.minMatchCharLength:d,g=t.isCaseSensitive,y=void 0===g?Config.isCaseSensitive:g,p=t.ignoreLocation,_=void 0===p?Config.ignoreLocation:p;if(_classCallCheck(this,A),this.options={location:i,threshold:o,distance:c,includeMatches:h,findAllMatches:f,minMatchCharLength:v,isCaseSensitive:y,ignoreLocation:_},this.pattern=y?e:e.toLowerCase(),this.chunks=[],this.pattern.length){var C=function(e,t){r.chunks.push({pattern:e,alphabet:createPatternAlphabet(e),startIndex:t})},m=this.pattern.length;if(MAX_BITS<m){for(var M,k=0,S=m%MAX_BITS,x=m-S;k<x;)C(this.pattern.substr(k,MAX_BITS),k),k+=MAX_BITS;S&&(M=m-MAX_BITS,C(this.pattern.substr(M),M))}else C(this.pattern,0)}}return _createClass(A,[{key:"searchIn",value:function(c){var e=this.options,t=e.isCaseSensitive,u=e.includeMatches;if(t||(c=c.toLowerCase()),this.pattern===c){var r={isMatch:!0,score:0};return u&&(r.indices=[[0,c.length-1]]),r}var n=this.options,h=n.location,l=n.distance,f=n.threshold,d=n.findAllMatches,v=n.minMatchCharLength,g=n.ignoreLocation,y=[],p=0,_=!1;this.chunks.forEach(function(e){var t=e.pattern,r=e.alphabet,n=e.startIndex,i=search(c,t,r,{location:h+n,distance:l,threshold:f,findAllMatches:d,minMatchCharLength:v,includeMatches:u,ignoreLocation:g}),a=i.isMatch,o=i.score,s=i.indices;a&&(_=!0),p+=o,a&&s&&(y=[].concat(_toConsumableArray(y),_toConsumableArray(s)))});var i={isMatch:_,score:_?p/this.chunks.length:1};return _&&u&&(i.indices=y),i}}]),A}(),BaseMatch=function(){function t(e){_classCallCheck(this,t),this.pattern=e}return _createClass(t,[{key:"search",value:function(){}}],[{key:"isMultiMatch",value:function(e){return getMatch(e,this.multiRegex)}},{key:"isSingleMatch",value:function(e){return getMatch(e,this.singleRegex)}}]),t}();function getMatch(e,t){var r=e.match(t);return r?r[1]:null}var ExactMatch=function(){_inherits(r,BaseMatch);var t=_createSuper(r);function r(e){return _classCallCheck(this,r),t.call(this,e)}return _createClass(r,[{key:"search",value:function(e){var t=e===this.pattern;return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}],[{key:"type",get:function(){return"exact"}},{key:"multiRegex",get:function(){return/^="(.*)"$/}},{key:"singleRegex",get:function(){return/^=(.*)$/}}]),r}(),InverseExactMatch=function(){_inherits(r,BaseMatch);var t=_createSuper(r);function r(e){return _classCallCheck(this,r),t.call(this,e)}return _createClass(r,[{key:"search",value:function(e){var t=-1===e.indexOf(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}}],[{key:"type",get:function(){return"inverse-exact"}},{key:"multiRegex",get:function(){return/^!"(.*)"$/}},{key:"singleRegex",get:function(){return/^!(.*)$/}}]),r}(),PrefixExactMatch=function(){_inherits(r,BaseMatch);var t=_createSuper(r);function r(e){return _classCallCheck(this,r),t.call(this,e)}return _createClass(r,[{key:"search",value:function(e){var t=e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}],[{key:"type",get:function(){return"prefix-exact"}},{key:"multiRegex",get:function(){return/^\^"(.*)"$/}},{key:"singleRegex",get:function(){return/^\^(.*)$/}}]),r}(),InversePrefixExactMatch=function(){_inherits(r,BaseMatch);var t=_createSuper(r);function r(e){return _classCallCheck(this,r),t.call(this,e)}return _createClass(r,[{key:"search",value:function(e){var t=!e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}}],[{key:"type",get:function(){return"inverse-prefix-exact"}},{key:"multiRegex",get:function(){return/^!\^"(.*)"$/}},{key:"singleRegex",get:function(){return/^!\^(.*)$/}}]),r}(),SuffixExactMatch=function(){_inherits(r,BaseMatch);var t=_createSuper(r);function r(e){return _classCallCheck(this,r),t.call(this,e)}return _createClass(r,[{key:"search",value:function(e){var t=e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[e.length-this.pattern.length,e.length-1]}}}],[{key:"type",get:function(){return"suffix-exact"}},{key:"multiRegex",get:function(){return/^"(.*)"\$$/}},{key:"singleRegex",get:function(){return/^(.*)\$$/}}]),r}(),InverseSuffixExactMatch=function(){_inherits(r,BaseMatch);var t=_createSuper(r);function r(e){return _classCallCheck(this,r),t.call(this,e)}return _createClass(r,[{key:"search",value:function(e){var t=!e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}}],[{key:"type",get:function(){return"inverse-suffix-exact"}},{key:"multiRegex",get:function(){return/^!"(.*)"\$$/}},{key:"singleRegex",get:function(){return/^!(.*)\$$/}}]),r}(),FuzzyMatch=function(){_inherits(_,BaseMatch);var p=_createSuper(_);function _(e){var t,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=r.location,i=void 0===n?Config.location:n,a=r.threshold,o=void 0===a?Config.threshold:a,s=r.distance,c=void 0===s?Config.distance:s,u=r.includeMatches,h=void 0===u?Config.includeMatches:u,l=r.findAllMatches,f=void 0===l?Config.findAllMatches:l,d=r.minMatchCharLength,v=void 0===d?Config.minMatchCharLength:d,g=r.isCaseSensitive,y=void 0===g?Config.isCaseSensitive:g;return _classCallCheck(this,_),(t=p.call(this,e))._bitapSearch=new BitapSearch(e,{location:i,threshold:o,distance:c,includeMatches:h,findAllMatches:f,minMatchCharLength:v,isCaseSensitive:y}),t}return _createClass(_,[{key:"search",value:function(e){return this._bitapSearch.searchIn(e)}}],[{key:"type",get:function(){return"fuzzy"}},{key:"multiRegex",get:function(){return/^"(.*)"$/}},{key:"singleRegex",get:function(){return/^(.*)$/}}]),_}(),IncludeMatch=function(){_inherits(r,BaseMatch);var t=_createSuper(r);function r(e){return _classCallCheck(this,r),t.call(this,e)}return _createClass(r,[{key:"search",value:function(e){for(var t,r=0,n=[],i=this.pattern.length;-1<(t=e.indexOf(this.pattern,r));)r=t+i,n.push([t,r-1]);var a=!!n.length;return{isMatch:a,score:a?1:0,indices:n}}}],[{key:"type",get:function(){return"include"}},{key:"multiRegex",get:function(){return/^'"(.*)"$/}},{key:"singleRegex",get:function(){return/^'(.*)$/}}]),r}(),searchers=[ExactMatch,IncludeMatch,PrefixExactMatch,InversePrefixExactMatch,InverseSuffixExactMatch,SuffixExactMatch,InverseExactMatch,FuzzyMatch],searchersLen=searchers.length,SPACE_RE=/ +(?=([^\"]*\"[^\"]*\")*[^\"]*$)/,OR_TOKEN="|";function parseQuery(e){var f=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return e.split(OR_TOKEN).map(function(e){for(var t=e.trim().split(SPACE_RE).filter(function(e){return e&&!!e.trim()}),r=[],n=0,i=t.length;n<i;n+=1){for(var a=t[n],o=!1,s=-1;!o&&++s<searchersLen;){var c=searchers[s],u=c.isMultiMatch(a);u&&(r.push(new c(u,f)),o=!0)}if(!o)for(s=-1;++s<searchersLen;){var h=searchers[s],l=h.isSingleMatch(a);if(l){r.push(new h(l,f));break}}}return r})}var MultiMatchSet=new Set([FuzzyMatch.type,IncludeMatch.type]),ExtendedSearch=function(){function y(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=t.isCaseSensitive,n=void 0===r?Config.isCaseSensitive:r,i=t.includeMatches,a=void 0===i?Config.includeMatches:i,o=t.minMatchCharLength,s=void 0===o?Config.minMatchCharLength:o,c=t.findAllMatches,u=void 0===c?Config.findAllMatches:c,h=t.location,l=void 0===h?Config.location:h,f=t.threshold,d=void 0===f?Config.threshold:f,v=t.distance,g=void 0===v?Config.distance:v;_classCallCheck(this,y),this.query=null,this.options={isCaseSensitive:n,includeMatches:a,minMatchCharLength:s,findAllMatches:u,location:l,threshold:d,distance:g},this.pattern=n?e:e.toLowerCase(),this.query=parseQuery(this.pattern,this.options)}return _createClass(y,[{key:"searchIn",value:function(e){var t=this.query;if(!t)return{isMatch:!1,score:1};var r=this.options,n=r.includeMatches;e=r.isCaseSensitive?e:e.toLowerCase();for(var i=0,a=[],o=0,s=0,c=t.length;s<c;s+=1){for(var u=t[s],h=i=a.length=0,l=u.length;h<l;h+=1){var f,d=u[h],v=d.search(e),g=v.isMatch,y=v.indices,p=v.score;if(!g){i=o=0,a.length=0;break}i+=1,o+=p,n&&(f=d.constructor.type,MultiMatchSet.has(f)?a=[].concat(_toConsumableArray(a),_toConsumableArray(y)):a.push(y))}if(i){var _={isMatch:!0,score:o/i};return n&&(_.indices=a),_}}return{isMatch:!1,score:1}}}],[{key:"condition",value:function(e,t){return t.useExtendedSearch}}]),y}(),registeredSearchers=[];function register(){registeredSearchers.push.apply(registeredSearchers,arguments)}function createSearcher(e,t){for(var r=0,n=registeredSearchers.length;r<n;r+=1){var i=registeredSearchers[r];if(i.condition(e,t))return new i(e,t)}return new BitapSearch(e,t)}var LogicalOperator={AND:"$and",OR:"$or"},KeyType={PATH:"$path",PATTERN:"$val"},isExpression=function(e){return!(!e[LogicalOperator.AND]&&!e[LogicalOperator.OR])},isPath=function(e){return!!e[KeyType.PATH]},isLeaf=function(e){return!isArray(e)&&isObject(e)&&!isExpression(e)},convertToExplicit=function(t){return _defineProperty({},LogicalOperator.AND,Object.keys(t).map(function(e){return _defineProperty({},e,t[e])}))};function parse(e,c){var t=(2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).auto,u=void 0===t||t;return isExpression(e)||(e=convertToExplicit(e)),function r(n){var e=Object.keys(n),t=isPath(n);if(!t&&1<e.length&&!isExpression(n))return r(convertToExplicit(n));if(isLeaf(n)){var i=t?n[KeyType.PATH]:e[0],a=t?n[KeyType.PATTERN]:n[i];if(!isString(a))throw new Error(LOGICAL_SEARCH_INVALID_QUERY_FOR_KEY(i));var o={keyId:createKeyId(i),pattern:a};return u&&(o.searcher=createSearcher(a,c)),o}var s={children:[],operator:e[0]};return e.forEach(function(e){var t=n[e];isArray(t)&&t.forEach(function(e){s.children.push(r(e))})}),s}(e)}var Fuse=function(){function n(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=2<arguments.length?arguments[2]:void 0;_classCallCheck(this,n),this.options=_objectSpread2({},Config,{},t),this.options.useExtendedSearch,this._keyStore=new KeyStore(this.options.keys),this.setCollection(e,r)}return _createClass(n,[{key:"setCollection",value:function(e,t){if(this._docs=e,t&&!(t instanceof FuseIndex))throw new Error(INCORRECT_INDEX_TYPE);this._myIndex=t||createIndex(this.options.keys,this._docs,{getFn:this.options.getFn})}},{key:"add",value:function(e){isDefined(e)&&(this._docs.push(e),this._myIndex.add(e))}},{key:"remove",value:function(e){for(var t=0<arguments.length&&void 0!==e?e:function(){return!1},r=[],n=0,i=this._docs.length;n<i;n+=1){var a=this._docs[n];t(a,n)&&(this.removeAt(n),--n,r.push(a))}return r}},{key:"removeAt",value:function(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}},{key:"getIndex",value:function(){return this._myIndex}},{key:"search",value:function(e,t){var r=(1<arguments.length&&void 0!==t?t:{}).limit,n=void 0===r?-1:r,i=this.options,a=i.includeMatches,o=i.includeScore,s=i.shouldSort,c=i.sortFn,u=i.ignoreFieldNorm,h=isString(e)?isString(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return computeScore$1(h,{ignoreFieldNorm:u}),s&&h.sort(c),isNumber(n)&&-1<n&&(h=h.slice(0,n)),format(h,this._docs,{includeMatches:a,includeScore:o})}},{key:"_searchStringList",value:function(e){var c=createSearcher(e,this.options),t=this._myIndex.records,u=[];return t.forEach(function(e){var t,r,n,i,a=e.v,o=e.i,s=e.n;isDefined(a)&&(r=(t=c.searchIn(a)).isMatch,n=t.score,i=t.indices,r&&u.push({item:a,idx:o,matches:[{score:n,value:a,norm:s,indices:i}]}))}),u}},{key:"_searchLogical",value:function(e){var g=this,i=parse(e,this.options),t=this._myIndex.records,a={},o=[];return t.forEach(function(e){var t,r=e.$,n=e.i;!isDefined(r)||(t=function e(t,r,n){if(!t.children){var i=t.keyId,a=t.searcher,o=g._findMatches({key:g._keyStore.get(i),value:g._myIndex.getValueForItemAtKeyId(r,i),searcher:a});return o&&o.length?[{idx:n,item:r,matches:o}]:[]}switch(t.operator){case LogicalOperator.AND:for(var s=[],c=0,u=t.children.length;c<u;c+=1){var h=e(t.children[c],r,n);if(!h.length)return[];s.push.apply(s,_toConsumableArray(h))}return s;case LogicalOperator.OR:for(var l=[],f=0,d=t.children.length;f<d;f+=1){var v=e(t.children[f],r,n);if(v.length){l.push.apply(l,_toConsumableArray(v));break}}return l}}(i,r,n)).length&&(a[n]||(a[n]={idx:n,item:r,matches:[]},o.push(a[n])),t.forEach(function(e){var t,r=e.matches;(t=a[n].matches).push.apply(t,_toConsumableArray(r))}))}),o}},{key:"_searchObjectList",value:function(e){var i=this,a=createSearcher(e,this.options),t=this._myIndex,o=t.keys,r=t.records,s=[];return r.forEach(function(e){var r,n=e.$,t=e.i;isDefined(n)&&(r=[],o.forEach(function(e,t){r.push.apply(r,_toConsumableArray(i._findMatches({key:e,value:n[t],searcher:a})))}),r.length&&s.push({idx:t,item:n,matches:r}))}),s}},{key:"_findMatches",value:function(e){var c=e.key,t=e.value,u=e.searcher;if(!isDefined(t))return[];var r,n,i,a,o,s,h=[];return isArray(t)?t.forEach(function(e){var t,r,n,i,a=e.v,o=e.i,s=e.n;isDefined(a)&&(r=(t=u.searchIn(a)).isMatch,n=t.score,i=t.indices,r&&h.push({score:n,key:c,value:a,idx:o,norm:s,indices:i}))}):(r=t.v,n=t.n,a=(i=u.searchIn(r)).isMatch,o=i.score,s=i.indices,a&&h.push({score:o,key:c,value:r,norm:n,indices:s})),h}}]),n}();function computeScore$1(e,t){var r=t.ignoreFieldNorm,o=void 0===r?Config.ignoreFieldNorm:r;e.forEach(function(e){var a=1;e.matches.forEach(function(e){var t=e.key,r=e.norm,n=e.score,i=t?t.weight:null;a*=Math.pow(0===n&&i?Number.EPSILON:n,(i||1)*(o?1:r))}),e.score=a})}function format(e,n){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=t.includeMatches,i=void 0===r?Config.includeMatches:r,a=t.includeScore,o=void 0===a?Config.includeScore:a,s=[];return i&&s.push(transformMatches),o&&s.push(transformScore),e.map(function(t){var e=t.idx,r={item:n[e],refIndex:e};return s.length&&s.forEach(function(e){e(t,r)}),r})}Fuse.version="6.4.0",Fuse.createIndex=createIndex,Fuse.parseIndex=parseIndex,Fuse.config=Config,Fuse.parseQuery=parse,register(ExtendedSearch),module.exports=Fuse;
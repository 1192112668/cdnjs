!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).firebase=t.firebase||{},t.firebase.app={}))}(this,function(t){"use strict";var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,n)},n=function(){return(n=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function r(t,e,n,r){return new(n=n||Promise)(function(i,o){function s(t){try{a(r.next(t))}catch(t){o(t)}}function u(t){try{a(r.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):((e=t.value)instanceof n?e:new n(function(t){t(e)})).then(s,u)}a((r=r.apply(t,e||[])).next())})}function i(t,e){var n,r,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s={next:u(0),throw:u(1),return:u(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=0<(i=o.trys).length&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}function o(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function s(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}var u=(a.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch(function(){}),1===t.length?t(n):t(n,r))}},a);function a(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}var c,h,l,f="FirebaseError",p=(c=Error,e(h=v,l=c),h.prototype=null===l?Object.create(l):(d.prototype=l.prototype,new d),v);function d(){this.constructor=h}function v(t,e){var n=c.call(this,e)||this;return n.code=t,n.name=f,Object.setPrototypeOf(n,v.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,y.prototype.create),n}var y=(g.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(r=i,s.replace(m,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",c=new p(o,a),h=0,l=Object.keys(i);h<l.length;h++){var f=l[h];"_"!==f.slice(-1)&&(f in c&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),c[f]=i[f])}return c},g);function g(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var m=/\{\$([^}]+)}/g,w=(b.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},b.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},b.prototype.setServiceProps=function(t){return this.serviceProps=t,this},b);function b(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var E="[DEFAULT]",I=(_.prototype.get=function(t){void 0===t&&(t=E);var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new u;this.instancesDeferred.set(e,n);try{var r=this.getOrInitializeService(e);r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},_.prototype.getImmediate=function(t){var e=n({identifier:E,optional:!1},t),r=e.identifier,i=e.optional,o=this.normalizeInstanceIdentifier(r);try{var s=this.getOrInitializeService(o);if(s)return s;if(i)return null;throw Error("Service "+this.name+" is not available")}catch(t){if(i)return null;throw t}},_.prototype.getComponent=function(){return this.component},_.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if("EAGER"===(this.component=t).instantiationMode)try{this.getOrInitializeService(E)}catch(t){}try{for(var r=o(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var u=s(i.value,2),a=u[0],c=u[1],h=this.normalizeInstanceIdentifier(a);try{var l=this.getOrInitializeService(h);c.resolve(l)}catch(t){}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},_.prototype.clearInstance=function(t){void 0===t&&(t=E),this.instancesDeferred.delete(t),this.instances.delete(t)},_.prototype.delete=function(){return r(this,void 0,void 0,function(){var t;return i(this,function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(s(arguments[e]));return t}(t.filter(function(t){return"INTERNAL"in t}).map(function(t){return t.INTERNAL.delete()}),t.filter(function(t){return"_delete"in t}).map(function(t){return t._delete()})))];case 1:return e.sent(),[2]}})})},_.prototype.isComponentSet=function(){return null!=this.component},_.prototype.getOrInitializeService=function(t){var e,n=this.instances.get(t);return!n&&this.component&&(n=this.component.instanceFactory(this.container,(e=t)===E?void 0:e),this.instances.set(t,n)),n||null},_.prototype.normalizeInstanceIdentifier=function(t){return!this.component||this.component.multipleInstances?t:E},_);function _(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}var T,A=(N.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},N.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},N.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new I(t,this);return this.providers.set(t,e),e},N.prototype.getProviders=function(){return Array.from(this.providers.values())},N);function N(t){this.name=t,this.providers=new Map}function S(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}var O,D,L=[];function R(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=k[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,S(["["+i+"]  "+t.name+":"],n))}}(D=O=O||{})[D.DEBUG=0]="DEBUG",D[D.VERBOSE=1]="VERBOSE",D[D.INFO=2]="INFO",D[D.WARN=3]="WARN",D[D.ERROR=4]="ERROR",D[D.SILENT=5]="SILENT";var x={debug:O.DEBUG,verbose:O.VERBOSE,info:O.INFO,warn:O.WARN,error:O.ERROR,silent:O.SILENT},P=O.INFO,k=((T={})[O.DEBUG]="log",T[O.VERBOSE]="log",T[O.INFO]="info",T[O.WARN]="warn",T[O.ERROR]="error",T),C=(Object.defineProperty(V.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in O))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),V.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?x[t]:t},Object.defineProperty(V.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),V.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,S([this,O.DEBUG],t)),this._logHandler.apply(this,S([this,O.DEBUG],t))},V.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,S([this,O.VERBOSE],t)),this._logHandler.apply(this,S([this,O.VERBOSE],t))},V.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,S([this,O.INFO],t)),this._logHandler.apply(this,S([this,O.INFO],t))},V.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,S([this,O.WARN],t)),this._logHandler.apply(this,S([this,O.WARN],t))},V.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,S([this,O.ERROR],t)),this._logHandler.apply(this,S([this,O.ERROR],t))},V);function V(t){this.name=t,this._logLevel=P,this._logHandler=R,this._userLogHandler=null,L.push(this)}var U=(M.prototype.getPlatformInfoString=function(){return this.container.getProviders().map(function(t){if("VERSION"!==(null==(e=t.getComponent())?void 0:e.type))return null;var e,n=t.getImmediate();return n.library+"/"+n.version}).filter(function(t){return t}).join(" ")},M);function M(t){this.container=t}var F,j,q="@firebase/app",B=new C("@firebase/app"),G="[DEFAULT]",z=((F={})[q]="fire-core",F["@firebase/app-compat"]="fire-core-compat",F["@firebase/analytics"]="fire-analytics",F["@firebase/auth"]="fire-auth",F["@firebase/database"]="fire-rtdb",F["@firebase/functions"]="fire-fn",F["@firebase/installations"]="fire-iid",F["@firebase/messaging"]="fire-fcm",F["@firebase/performance"]="fire-perf",F["@firebase/remote-config"]="fire-rc",F["@firebase/storage"]="fire-gcs",F["@firebase/firestore"]="fire-fst",F["fire-js"]="fire-js",F.firebase="fire-js-all",F),H=new Map,$=new Map;function W(t,e){try{t.container.addComponent(e)}catch(n){B.debug("Component "+e.name+" failed to register with FirebaseApp "+t.name,n)}}function Q(t){var e,n,r=t.name;if($.has(r))return B.debug("There were multiple attempts to register component "+r+"."),!1;$.set(r,t);try{for(var i=o(H.values()),s=i.next();!s.done;s=i.next())W(s.value,t)}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return!0}function K(t,e){return t.container.getProvider(e)}var Y=((j={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",j["bad-app-name"]="Illegal App name: '{$appName}",j["duplicate-app"]="Firebase App named '{$appName}' already exists",j["app-deleted"]="Firebase App named '{$appName}' already deleted",j["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",j["invalid-log-argument"]="First argument to `onLog` must be null or a function.",j),X=new y("app","Firebase",Y),J=(Object.defineProperty(Z.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(Z.prototype,"name",{get:function(){return this.checkDestroyed(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(Z.prototype,"options",{get:function(){return this.checkDestroyed(),this.options_},enumerable:!1,configurable:!0}),Z.prototype.checkDestroyed=function(){if(this.isDeleted)throw X.create("app-deleted",{appName:this.name_})},Z);function Z(t,e,r){var i=this;this.isDeleted=!1,this.options_=n({},t),this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled,this.container=r,this.container.addComponent(new w("app-exp",function(){return i},"PUBLIC"))}function tt(t,e,n){var r,i=null!==(r=z[t])&&void 0!==r?r:t;n&&(i+="-"+n);var o=i.match(/\s|\//),s=e.match(/\s|\//);if(o||s){var u=['Unable to register library "'+i+'" with version "'+e+'":'];return o&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),o&&s&&u.push("and"),s&&u.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void B.warn(u.join(" "))}Q(new w(i+"-version",function(){return{library:i,version:e}},"VERSION"))}Q(new w("platform-logger",function(t){return new U(t)},"PRIVATE")),tt(q,"0.0.800-exp.fe55004be",void 0),tt("fire-js",""),tt("firebase","0.800.9","app"),t.SDK_VERSION="7.21.1",t._DEFAULT_ENTRY_NAME=G,t._addComponent=W,t._addOrOverwriteComponent=function(t,e){t.container.addOrOverwriteComponent(e)},t._apps=H,t._clearComponents=function(){$.clear()},t._components=$,t._getProvider=K,t._registerComponent=Q,t._removeServiceInstance=function(t,e,n){void 0===n&&(n=G),K(t,e).clearInstance(n)},t.deleteApp=function(t){return r(this,void 0,void 0,function(){var e;return i(this,function(n){switch(n.label){case 0:return e=t.name,H.has(e)?(H.delete(e),[4,Promise.all(t.container.getProviders().map(function(t){return t.delete()}))]):[3,2];case 1:n.sent(),t.isDeleted=!0,n.label=2;case 2:return[2]}})})},t.getApp=function(t){void 0===t&&(t=G);var e=H.get(t);if(!e)throw X.create("no-app",{appName:t});return e},t.getApps=function(){return Array.from(H.values())},t.initializeApp=function(t,e){var r,i;void 0===e&&(e={}),"object"!=typeof e&&(e={name:e});var s=n({name:G,automaticDataCollectionEnabled:!1},e),u=s.name;if("string"!=typeof u||!u)throw X.create("bad-app-name",{appName:String(u)});if(H.has(u))throw X.create("duplicate-app",{appName:u});var a=new A(u);try{for(var c=o($.values()),h=c.next();!h.done;h=c.next()){var l=h.value;a.addComponent(l)}}catch(t){r={error:t}}finally{try{h&&!h.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}var f=new J(t,s,a);return H.set(u,f),f},t.onLog=function(t,e){if(null!==t&&"function"!=typeof t)throw X.create("invalid-log-argument",{appName:name});!function(t,e){for(var n=0,r=L;n<r.length;n++)!function(n){var r=null;e&&e.level&&(r=x[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var s=i.map(function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}}).filter(function(t){return t}).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:O[n].toLowerCase(),message:s,args:i,type:e.name})}}(r[n])}(t,e)},t.registerVersion=tt,t.setLogLevel=function(t){var e;e=t,L.forEach(function(t){t.setLogLevel(e)})},Object.defineProperty(t,"__esModule",{value:!0})}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@firebase/app")):"function"==typeof define&&define.amd?define(["exports","@firebase/app"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).firebase=t.firebase||{},t.firebase.functions=t.firebase.functions||{}),t.firebase.app)}(this,function(t,e){"use strict";try{(function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function r(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function i(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{a(r.next(t))}catch(t){o(t)}}function u(t){try{a(r.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,u)}a((r=r.apply(t,e||[])).next())})}function o(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}var s="FirebaseError",u=function(t){function e(n,r){var i=t.call(this,r)||this;return i.code=n,i.name=s,Object.setPrototypeOf(i,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,a.prototype.create),i}return r(e,t),e}(Error),a=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?function(t,e){return t.replace(c,function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"})}(o,r):"Error",a=this.serviceName+": "+s+" ("+i+").",h=new u(i,a),l=0,f=Object.keys(r);l<f.length;l++){var p=f[l];"_"!==p.slice(-1)&&(p in h&&console.warn('Overwriting FirebaseError base field "'+p+'" can cause unexpected behavior.'),h[p]=r[p])}return h},t}();var c=/\{\$([^}]+)}/g,h=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),l="type.googleapis.com/google.protobuf.Int64Value",f="type.googleapis.com/google.protobuf.UInt64Value";function p(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function d(t){if(null==t)return t;if(t["@type"])switch(t["@type"]){case l:case f:var e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e;default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(function(t){return d(t)}):"function"==typeof t||"object"==typeof t?p(t,function(t){return d(t)}):t}var v="functions",y={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},g=function(t){function e(e,n,r){var i=t.call(this,v+"/"+e,n||"")||this;return i.details=r,i}return r(e,t),e}(u);var m=function(){function t(t,e){var n=this;this.auth=null,this.messaging=null,this.auth=t.getImmediate({optional:!0}),this.messaging=e.getImmediate({optional:!0}),this.auth||t.get().then(function(t){return n.auth=t},function(){}),this.messaging||e.get().then(function(t){return n.messaging=t},function(){})}return t.prototype.getAuthToken=function(){return i(this,void 0,void 0,function(){var t;return o(this,function(e){switch(e.label){case 0:if(!this.auth)return[2,void 0];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.auth.getToken()];case 2:return[2,null==(t=e.sent())?void 0:t.accessToken];case 3:return e.sent(),[2,void 0];case 4:return[2]}})})},t.prototype.getMessagingToken=function(){return i(this,void 0,void 0,function(){return o(this,function(t){if(!(this.messaging&&"Notification"in self&&"granted"===Notification.permission))return[2,void 0];try{return[2,this.messaging.getToken()]}catch(t){return[2,void 0]}return[2]})})},t.prototype.getContext=function(){return i(this,void 0,void 0,function(){var t,e;return o(this,function(n){switch(n.label){case 0:return[4,this.getAuthToken()];case 1:return t=n.sent(),[4,this.getMessagingToken()];case 2:return e=n.sent(),[2,{authToken:t,messagingToken:e}]}})})},t}(),w="us-central1";var b=function(){function t(t,e,n,r,i){var o=this;void 0===r&&(r=w),this.app=t,this.fetchImpl=i,this.emulatorOrigin=null,this.contextProvider=new m(e,n),this.cancelAllRequests=new Promise(function(t){o.deleteService=function(){return Promise.resolve(t())}});try{var s=new URL(r);this.customDomain=s.origin,this.region=w}catch(t){this.customDomain=null,this.region=r}}return t.prototype._delete=function(){return this.deleteService()},t.prototype._url=function(t){var e=this.app.options.projectId;return null!==this.emulatorOrigin?this.emulatorOrigin+"/"+e+"/"+this.region+"/"+t:null!==this.customDomain?this.customDomain+"/"+t:"https://"+this.region+"-"+e+".cloudfunctions.net/"+t},t}();function E(t,e,n){return function(r){return function(t,e,n,r){return i(this,void 0,void 0,function(){var s,u,a,c,h,l,f,v;return o(this,function(m){switch(m.label){case 0:return s=t._url(e),n=function t(e){if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"==typeof e&&isFinite(e))return e;if(!0===e||!1===e)return e;if("[object String]"===Object.prototype.toString.call(e))return e;if(Array.isArray(e))return e.map(function(e){return t(e)});if("function"==typeof e||"object"==typeof e)return p(e,function(e){return t(e)});throw new Error("Data cannot be encoded in JSON: "+e)}(n),u={data:n},a={},[4,t.contextProvider.getContext()];case 1:return(c=m.sent()).authToken&&(a.Authorization="Bearer "+c.authToken),c.messagingToken&&(a["Firebase-Instance-ID-Token"]=c.messagingToken),h=r.timeout||7e4,[4,Promise.race([function(t,e,n,r){return i(this,void 0,void 0,function(){var i,s;return o(this,function(o){switch(o.label){case 0:n["Content-Type"]="application/json",o.label=1;case 1:return o.trys.push([1,3,,4]),[4,r(t,{method:"POST",body:JSON.stringify(e),headers:n})];case 2:return i=o.sent(),[3,4];case 3:return o.sent(),[2,{status:0,json:null}];case 4:s=null,o.label=5;case 5:return o.trys.push([5,7,,8]),[4,i.json()];case 6:return s=o.sent(),[3,8];case 7:return o.sent(),[3,8];case 8:return[2,{status:i.status,json:s}]}})})}(s,u,a,t.fetchImpl),(w=h,new Promise(function(t,e){setTimeout(function(){e(new g("deadline-exceeded","deadline-exceeded"))},w)})),t.cancelAllRequests])];case 2:if(!(l=m.sent()))throw new g("cancelled","Firebase Functions instance was deleted.");if(f=function(t,e){var n=function(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(t),r=n,i=void 0;try{var o=e&&e.error;if(o){var s=o.status;if("string"==typeof s){if(!y[s])return new g("internal","internal");n=y[s],r=s}var u=o.message;"string"==typeof u&&(r=u),void 0!==(i=o.details)&&(i=d(i))}}catch(t){}return"ok"===n?null:new g(n,r,i)}(l.status,l.json))throw f;if(!l.json)throw new g("internal","Response is not valid JSON object.");if(void 0===(v=l.json.data)&&(v=l.json.result),void 0===v)throw new g("internal","Response is missing data field.");return[2,{data:d(v)}]}var w})})}(t,e,r,n||{})}}var I;I=fetch,e._registerComponent(new h(v,function(t,e){var n=t.getProvider("app-exp").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("messaging");return new b(n,r,i,e,I)},"PUBLIC").setMultipleInstances(!0)),e.registerVersion("@firebase/functions-exp","0.0.800"),t.getFunctions=function(t,n){return void 0===n&&(n=w),e._getProvider(t,v).getImmediate({identifier:n})},t.httpsCallable=function(t,e,n){return E(t,e,n)},t.useFunctionsEmulator=function(t,e){!function(t,e){t.emulatorOrigin=e}(t,e)},Object.defineProperty(t,"__esModule",{value:!0})}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-functions.js - be sure to load firebase-app.js first.")}}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@firebase/app")):"function"==typeof define&&define.amd?define(["exports","@firebase/app"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).firebase=t.firebase||{},t.firebase.firestore=t.firebase.firestore||{}),t.firebase.app)}(this,function(t,e){"use strict";try{(function(){var n,r,i=function(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}(e),o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function s(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function u(t,e,n,r){return new(n||(n=Promise))(function(i,o){function s(t){try{a(r.next(t))}catch(t){o(t)}}function u(t){try{a(r.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,u)}a((r=r.apply(t,e||[])).next())})}function a(t,e){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}function c(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function h(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(r||(r={}));var l={debug:r.DEBUG,verbose:r.VERBOSE,info:r.INFO,warn:r.WARN,error:r.ERROR,silent:r.SILENT},f=r.INFO,p=((n={})[r.DEBUG]="log",n[r.VERBOSE]="log",n[r.INFO]="info",n[r.WARN]="warn",n[r.ERROR]="error",n),d=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=p[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,h(["["+i+"]  "+t.name+":"],n))}},v=function(){function t(t){this.name=t,this._logLevel=f,this._logHandler=d,this._userLogHandler=null}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in r))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?l[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,h([this,r.DEBUG],t)),this._logHandler.apply(this,h([this,r.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,h([this,r.VERBOSE],t)),this._logHandler.apply(this,h([this,r.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,h([this,r.INFO],t)),this._logHandler.apply(this,h([this,r.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,h([this,r.WARN],t)),this._logHandler.apply(this,h([this,r.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,h([this,r.ERROR],t)),this._logHandler.apply(this,h([this,r.ERROR],t))},t}();function y(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var g="FirebaseError",m=function(t){function e(n,r){var i=t.call(this,r)||this;return i.code=n,i.name=g,Object.setPrototypeOf(i,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,w.prototype.create),i}return s(e,t),e}(Error),w=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?function(t,e){return t.replace(b,function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"})}(o,r):"Error",u=this.serviceName+": "+s+" ("+i+").",a=new m(i,u),c=0,h=Object.keys(r);c<h.length;c++){var l=h[c];"_"!==l.slice(-1)&&(l in a&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),a[l]=r[l])}return a},t}();var b=/\{\$([^}]+)}/g,E=function(t,e){return(E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function I(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var _,T="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},A=A||{},N=T||self;function S(){}function O(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function D(t){var e=O(t);return"array"==e||"object"==e&&"number"==typeof t.length}function L(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var R="closure_uid_"+(1e9*Math.random()>>>0),x=0;function P(t,e,n){return t.call.apply(t.bind,arguments)}function k(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?P:k).apply(null,arguments)}function V(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var U=Date.now;function M(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.ja=function(){if(!this.j&&(this.j=!0,this.G(),0))(function(t){Object.prototype.hasOwnProperty.call(t,R)&&t[R]||(t[R]=++x)})(this)},F.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var j=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},q=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function B(t){return Array.prototype.concat.apply([],arguments)}function G(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function z(t){return/^[\s\xa0]*$/.test(t)}var H,$=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function W(t,e){return-1!=t.indexOf(e)}function Q(t,e){return t<e?-1:t>e?1:0}t:{var K=N.navigator;if(K){var Y=K.userAgent;if(Y){H=Y;break t}}H=""}function X(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function J(t){var e={};for(var n in t)e[n]=t[n];return e}var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<Z.length;o++)n=Z[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function et(t){return et[" "](t),t}et[" "]=S;var nt,rt,it=W(H,"Opera"),ot=W(H,"Trident")||W(H,"MSIE"),st=W(H,"Edge"),ut=st||ot,at=W(H,"Gecko")&&!(W(H.toLowerCase(),"webkit")&&!W(H,"Edge"))&&!(W(H,"Trident")||W(H,"MSIE"))&&!W(H,"Edge"),ct=W(H.toLowerCase(),"webkit")&&!W(H,"Edge");function ht(){var t=N.document;return t?t.documentMode:void 0}t:{var lt="",ft=(rt=H,at?/rv:([^\);]+)(\)|;)/.exec(rt):st?/Edge\/([\d\.]+)/.exec(rt):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(rt):ct?/WebKit\/(\S+)/.exec(rt):it?/(?:Version)[ \/]?(\S+)/.exec(rt):void 0);if(ft&&(lt=ft?ft[1]:""),ot){var pt=ht();if(null!=pt&&pt>parseFloat(lt)){nt=String(pt);break t}}nt=lt}var dt,vt={};function yt(t){return function(t,e){var n=vt;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,function(){for(var e=0,n=$(String(nt)).split("."),r=$(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var s=n[o]||"",u=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],0==s[0].length&&0==u[0].length)break;e=Q(0==s[1].length?0:parseInt(s[1],10),0==u[1].length?0:parseInt(u[1],10))||Q(0==s[2].length,0==u[2].length)||Q(s[2],u[2]),s=s[3],u=u[3]}while(0==e)}return 0<=e})}if(N.document&&ot){var gt=ht();dt=gt||(parseInt(nt,10)||void 0)}else dt=void 0;var mt=dt,wt=!ot||9<=Number(mt),bt=ot&&!yt("9"),Et=function(){if(!N.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{N.addEventListener("test",S,e),N.removeEventListener("test",S,e)}catch(t){}return t}();function It(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function _t(t,e){if(It.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(at){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Tt[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}It.prototype.b=function(){this.defaultPrevented=!0},M(_t,It);var Tt={2:"touch",3:"pen",4:"mouse"};_t.prototype.b=function(){_t.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,bt)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}};var At="closure_listenable_"+(1e6*Math.random()|0),Nt=0;function St(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Ot(t){this.src=t,this.a={},this.b=0}function Dt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=j(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(St(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Lt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Ot.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Lt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new function(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Nt,this.Y=this.Z=!1}(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Rt="closure_lm_"+(1e6*Math.random()|0),xt={};function Pt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=qt(r);return e&&e[At]?e.wa(n,r,L(i)?!!i.capture:!!i,o):kt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Pt(t,e[o],n,r,i);return null}return n=qt(n),t&&t[At]?t.va(e,n,L(r)?!!r.capture:!!r,i):kt(t,e,n,!1,r,i)}function kt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=L(i)?!!i.capture:!!i;if(s&&!wt)return null;var u=Ft(t);if(u||(t[Rt]=u=new Ot(t)),(n=u.add(e,n,r,s,o)).proxy)return n;if(r=function(){var t=Mt,e=wt?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Et||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Vt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ct(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[At])Dt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Vt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ft(e))?(Dt(n,t),0==n.b&&(n.src=null,e[Rt]=null)):St(t)}}}function Vt(t){return t in xt?xt[t]:xt[t]="on"+t}function Ut(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Ct(t),n.call(r,e)}function Mt(t,e){if(t.Y)return!0;if(!wt){if(!e)t:{e=["window","event"];for(var n=N,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ut(t,e=new _t(e,this))}return Ut(t,new _t(e,this))}function Ft(t){return(t=t[Rt])instanceof Ot?t:null}var jt="__closure_events_fn_"+(1e9*Math.random()>>>0);function qt(t){return"function"==O(t)?t:(t[jt]||(t[jt]=function(e){return t.handleEvent(e)}),t[jt])}function Bt(){F.call(this),this.c=new Ot(this),this.J=this,this.C=null}function Gt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.Y&&s.capture==n){var u=s.listener,a=s.ca||s.src;s.Z&&Dt(t.c,s),i=!1!==u.call(a,r)&&i}}return i&&!r.defaultPrevented}M(Bt,F),Bt.prototype[At]=!0,(_=Bt.prototype).addEventListener=function(t,e,n,r){Pt(this,t,e,n,r)},_.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=L(i)?!!i.capture:!!i,r=qt(r),e&&e[At]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Lt(s=e.a[n],r,i,o))&&(St(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):e&&(e=Ft(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Lt(n,r,i,o)),(r=-1<e?n[e]:null)&&Ct(r))}(this,t,e,n,r)},_.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t)t=new It(t,n);else if(t instanceof It)t.target=t.target||n;else{var i=t;tt(t=new It(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];i=Gt(s,r,!0,t)&&i}if(i=Gt(s=t.a=n,r,!0,t)&&i,i=Gt(s,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=Gt(s=t.a=e[o],r,!1,t)&&i;return i},_.G=function(){if(Bt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)St(n[r]);delete e.a[t],e.b--}}this.C=null},_.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},_.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var zt=N.JSON.stringify;function Ht(){this.b=this.a=null}var $t,Wt=new(function(){function t(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},t}())(function(){return new Kt},function(t){t.reset()},100);function Qt(){var t=Zt,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Kt(){this.next=this.b=this.a=null}function Yt(t){N.setTimeout(function(){throw t},0)}function Xt(t,e){$t||function(){var t=N.Promise.resolve(void 0);$t=function(){t.then(te)}}(),Jt||($t(),Jt=!0),Zt.add(t,e)}Ht.prototype.add=function(t,e){var n=Wt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Kt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Kt.prototype.reset=function(){this.next=this.b=this.a=null};var Jt=!1,Zt=new Ht;function te(){for(var t;t=Qt();){try{t.a.call(t.b)}catch(t){Yt(t)}var e=Wt;e.g(t),e.b<e.f&&(e.b++,t.next=e.a,e.a=t)}Jt=!1}function ee(t,e){Bt.call(this),this.b=t||1,this.a=e||N,this.f=C(this.Ya,this),this.g=U()}function ne(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function re(t,e,n){if("function"==O(t))n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:N.setTimeout(t,e||0)}M(ee,Bt),(_=ee.prototype).aa=!1,_.M=null,_.Ya=function(){if(this.aa){var t=U()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(ne(this),this.start()))}},_.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=U())},_.G=function(){ee.S.G.call(this),ne(this),delete this.a};var ie=function(t){function e(e,n,r){var i=t.call(this)||this;return i.g=null!=r?e.bind(r):e,i.h=n,i.b=null,i.c=!1,i.a=null,i}return function(t,e){function n(){this.constructor=t}E(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=re(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(N.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(F);function oe(t){F.call(this),this.b=t,this.a={}}M(oe,F);var se=[];function ue(t,e,n,r){Array.isArray(n)||(n&&(se[0]=n.toString()),n=se);for(var i=0;i<n.length;i++){var o=Pt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ae(t){X(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ct(t)},t),t.a={}}function ce(){this.a=!0}function he(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return zt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}oe.prototype.G=function(){oe.S.G.call(this),ae(this)},oe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ce.prototype.info=function(){};var le=null;function fe(){return le=le||new Bt}function pe(t){It.call(this,"serverreachability",t)}function de(t){var e=fe();e.dispatchEvent(new pe(e,t))}function ve(t){It.call(this,"statevent",t)}function ye(t){var e=fe();e.dispatchEvent(new ve(e,t))}function ge(t){It.call(this,"timingevent",t)}function me(t,e){if("function"!=O(t))throw Error("Fn must not be null and must be a function");return N.setTimeout(function(){t()},e)}M(pe,It),M(ve,It),M(ge,It);var we={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},be={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Ee(){}function Ie(t){var e;return(e=t.a)||(e=t.a={}),e}function _e(){}Ee.prototype.a=null;var Te,Ae={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Ne(){It.call(this,"d")}function Se(){It.call(this,"c")}function Oe(){}function De(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new oe(this),this.P=Le,t=ut?125:void 0,this.R=new ee(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}M(Ne,It),M(Se,It),M(Oe,Ee),Te=new Oe;var Le=45e3,Re={},xe={};function Pe(t,e,n){t.H=1,t.i=en(Ke(e)),t.j=n,t.I=!0,ke(t,null)}function ke(t,e){t.u=U(),Ue(t),t.l=Ke(t.i);var n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),vn(n.b,"t",r),t.D=0,t.a=ur(t.g,t.g.C?e:null),0<t.O&&(t.F=new ie(C(t.Ca,t,t.a),t.O)),ue(t.J,t.a,"readystatechange",t.Wa),e=t.B?J(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),de(1),function(t,e,n,r,i,o){t.info(function(){if(t.a)if(o)for(var s="",u=o.split("&"),a=0;a<u.length;a++){var c=u[a].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");s=2<=l.length&&"type"==l[1]?s+(h+"=")+c+"&":s+(h+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+s})}(t.c,t.m,t.l,t.f,t.T,t.j)}function Ce(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=Ve(t,n);if(i==xe){4==e&&(t.h=4,ye(14),r=!1),he(t.c,t.f,null,"[Incomplete Response]");break}if(i==Re){t.h=4,ye(15),he(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}he(t.c,t.f,i,null),Be(t,i)}4==e&&0==n.length&&(t.h=1,ye(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Zn(e),e.F=!0)):(he(t.c,t.f,n,"[Invalid Chunked Response]"),qe(t),je(t))}function Ve(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?xe:(n=Number(e.substring(n,r)),isNaN(n)?Re:(r+=1)+n>e.length?xe:(e=e.substr(r,n),t.D=r+n,e))}function Ue(t){t.U=U()+t.P,Me(t,t.P)}function Me(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=me(C(t.Ua,t),e)}function Fe(t){t.o&&(N.clearTimeout(t.o),t.o=null)}function je(t){0==t.g.v||t.A||nr(t.g,t)}function qe(t){Fe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ne(t.R),ae(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Be(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||En(n.b,t)))if(n.I=t.N,!t.C&&En(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(t){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;er(n),zn(n)}Jn(n),ye(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=me(C(n.Ra,n),6e3));if(1>=bn(n.b)&&n.ea){try{n.ea()}catch(t){}n.ea=void 0}}else ir(n,11)}else if((t.C||n.a==t)&&er(n),!z(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(i=e[r],n.P=i[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var s=i[4];null!=s&&(n.pa=s,n.c.info("SVER="+n.pa));var u=i[5];if(null!=u&&"number"==typeof u&&0<u){var a=1.5*u;n.D=a,n.c.info("backChannelRequestTimeoutMs_="+a)}a=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var l=a.b;!l.a&&(W(h,"spdy")||W(h,"quic")||W(h,"h2"))&&(l.f=l.g,l.a=new Set,l.b&&(In(l,l.b),l.b=null))}if(a.A){var f=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(a.na=f,tn(a.B,a.A,f))}}n.v=3,n.f&&n.f.ta(),n.V&&(n.N=U()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var p=t;if((a=n).la=sr(a,a.C?a.ga:null,a.fa),p.C){_n(a.b,p);var d=p,v=a.D;v&&d.setTimeout(v),d.o&&(Fe(d),Ue(d)),a.a=p}else Xn(a);0<n.g.length&&Wn(n)}else"stop"!=i[0]&&"close"!=i[0]||ir(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?ir(n,7):Gn(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);de(4)}catch(t){}}function Ge(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(D(t)||"string"==typeof t)q(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(D(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(D(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function ze(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof ze)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function He(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];$e(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)$e(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function $e(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(_=De.prototype).setTimeout=function(t){this.P=t},_.Wa=function(t){t=t.target;var e=this.F;e&&3==Fn(t)?e.f():this.Ca(t)},_.Ca=function(t){try{if(t==this.a)t:{var e=Fn(this.a),n=this.a.ua(),r=this.a.X();if(!(3>e||3==e&&!ut&&!this.a.$())){this.A||4!=e||7==n||de(8==n||0>=r?3:2),Fe(this);var i=this.a.X();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,s){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+s})}(this.c,this.m,this.l,this.f,this.T,e,i),this.b){if(this.V&&!this.C){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,ye(12),qe(this),je(this);break t}he(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Be(this,a)}this.I?(Ce(this,e,o),ut&&this.b&&3==e&&(ue(this.J,this.R,"tick",this.Va),this.R.start())):(he(this.c,this.f,o,null),Be(this,o)),4==e&&qe(this),this.b&&!this.A&&(4==e?nr(this.g,this):(this.b=!1,Ue(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,ye(12)):(this.h=0,ye(13)),qe(this),je(this)}}}catch(t){}},_.Va=function(){if(this.a){var t=Fn(this.a),e=this.a.$();this.D<e.length&&(Fe(this),Ce(this,t,e),this.b&&4!=t&&Ue(this))}},_.cancel=function(){this.A=!0,qe(this)},_.Ua=function(){this.o=null;var t=U();0<=t-this.U?(function(t,e){t.info(function(){return"TIMEOUT: "+e})}(this.c,this.l),2!=this.H&&(de(3),ye(17)),qe(this),this.h=2,je(this)):Me(this,this.U-t)},(_=ze.prototype).K=function(){He(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},_.L=function(){return He(this),this.a.concat()},_.get=function(t,e){return $e(this.b,t)?this.b[t]:e},_.set=function(t,e){$e(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},_.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var We=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Qe(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Qe){this.a=void 0!==e?e:t.a,Ye(this,t.f),this.j=t.j,Xe(this,t.c),Je(this,t.h),this.g=t.g,e=t.b;var n=new ln;n.c=e.c,e.a&&(n.a=new ze(e.a),n.b=e.b),Ze(this,n),this.i=t.i}else t&&(n=String(t).match(We))?(this.a=!!e,Ye(this,n[1]||"",!0),this.j=nn(n[2]||""),Xe(this,n[3]||"",!0),Je(this,n[4]),this.g=nn(n[5]||"",!0),Ze(this,n[6]||"",!0),this.i=nn(n[7]||"")):(this.a=!!e,this.b=new ln(null,this.a))}function Ke(t){return new Qe(t)}function Ye(t,e,n){t.f=n?nn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Xe(t,e,n){t.c=n?nn(e,!0):e}function Je(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ze(t,e,n){e instanceof ln?(t.b=e,function(t,e){e&&!t.f&&(fn(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(pn(this,e),vn(this,n,t))},t)),t.f=e}(t.b,t.a)):(n||(e=rn(e,cn)),t.b=new ln(e,t.a))}function tn(t,e,n){t.b.set(e,n)}function en(t){return tn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^U()).toString(36)),t}function nn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function rn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,on),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function on(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Qe.prototype.toString=function(){var t=[],e=this.f;e&&t.push(rn(e,sn,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(rn(e,sn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(rn(n,"/"==n.charAt(0)?an:un,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",rn(n,hn)),t.join("")};var sn=/[#\/\?@]/g,un=/[#\?:]/g,an=/[#\?]/g,cn=/[#\?@]/g,hn=/#/g;function ln(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function fn(t){t.a||(t.a=new ze,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function pn(t,e){fn(t),e=yn(t,e),$e(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,$e((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&He(t)))}function dn(t,e){return fn(t),e=yn(t,e),$e(t.a.b,e)}function vn(t,e,n){pn(t,e),0<n.length&&(t.c=null,t.a.set(yn(t,e),G(n)),t.b+=n.length)}function yn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function gn(t){this.g=t||mn,N.PerformanceNavigationTiming?t=0<(t=N.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(N.ia&&N.ia.ya&&N.ia.ya()&&N.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(_=ln.prototype).add=function(t,e){fn(this),this.c=null,t=yn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},_.forEach=function(t,e){fn(this),this.a.forEach(function(n,r){q(n,function(n){t.call(e,n,r,this)},this)},this)},_.L=function(){fn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},_.K=function(t){fn(this);var e=[];if("string"==typeof t)dn(this,t)&&(e=B(e,this.a.get(yn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},_.set=function(t,e){return fn(this),this.c=null,dn(this,t=yn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},_.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},_.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var mn=10;function wn(t){return!!t.b||!!t.a&&t.a.size>=t.f}function bn(t){return t.b?1:t.a?t.a.size:0}function En(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function In(t,e){t.a?t.a.add(e):t.b=e}function _n(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Tn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=I(t.a.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return G(t.c)}function An(){}function Nn(t,e,n){var r=n||"";try{Ge(t,function(t,n){var i=t;L(t)&&(i=zt(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function Sn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}gn.prototype.cancel=function(){var t,e;if(this.c=Tn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=I(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},An.prototype.stringify=function(t){return N.JSON.stringify(t,void 0)},An.prototype.parse=function(t){return N.JSON.parse(t,void 0)};var On=N.JSON.parse;function Dn(t){Bt.call(this),this.headers=new ze,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Ln,this.D=this.F=!1}M(Dn,Bt);var Ln="",Rn=/^https?$/i,xn=["POST","PUT"];function Pn(t){return"content-type"==t.toLowerCase()}function kn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Cn(t),Un(t)}function Cn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Vn(t){if(t.b&&void 0!==A&&(!t.s[1]||4!=Fn(t)||2!=t.X()))if(t.l&&4==Fn(t))re(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==Fn(t)){t.b=!1;try{var e,n=t.X();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(We)[1]||null;if(!o&&N.self&&N.self.location){var s=N.self.location.protocol;o=s.substr(0,s.length-1)}i=!Rn.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Fn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Cn(t)}}finally{Un(t)}}}function Un(t,e){if(t.a){Mn(t);var n=t.a,r=t.s[0]?S:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Mn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(N.clearTimeout(t.m),t.m=null)}function Fn(t){return t.a?t.a.readyState:0}function jn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return X(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):tn(t,e,n))}function qn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Bn(t){this.pa=0,this.g=[],this.c=new ce,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=qn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=qn("baseRetryDelayMs",5e3,t),this.Ma=qn("retryDelaySeedMs",1e4,t),this.Ja=qn("forwardChannelMaxRetries",2,t),this.ma=qn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new gn(t&&t.concurrentRequestLimit),this.ka=new function(){this.a=new An},this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Gn(t){if(Hn(t),3==t.v){var e=t.R++,n=Ke(t.B);tn(n,"SID",t.J),tn(n,"RID",e),tn(n,"TYPE","terminate"),Kn(t,n),(e=new De(t,t.c,e,void 0)).H=2,e.i=en(Ke(n)),n=!1,N.navigator&&N.navigator.sendBeacon&&(n=N.navigator.sendBeacon(e.i.toString(),"")),!n&&N.Image&&((new Image).src=e.i,n=!0),n||(e.a=ur(e.g,null),e.a.ba(e.i)),e.u=U(),Ue(e)}or(t)}function zn(t){t.a&&(Zn(t),t.a.cancel(),t.a=null)}function Hn(t){zn(t),t.j&&(N.clearTimeout(t.j),t.j=null),er(t),t.b.cancel(),t.h&&("number"==typeof t.h&&N.clearTimeout(t.h),t.h=null)}function $n(t,e){t.g.push(new function(t,e){this.b=t,this.a=e}(t.La++,e)),3==t.v&&Wn(t)}function Wn(t){wn(t.b)||t.h||(t.h=!0,Xt(t.Ba,t),t.u=0)}function Qn(t,e){var n;n=e?e.f:t.R++;var r=Ke(t.B);tn(r,"SID",t.J),tn(r,"RID",n),tn(r,"AID",t.P),Kn(t,r),t.i&&t.l&&jn(r,t.i,t.l),n=new De(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Yn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),In(t.b,n),Pe(n,r,e)}function Kn(t,e){t.f&&Ge({},function(t,n){tn(e,n,t)})}function Yn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?C(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if(0>(c-=o))o=Math.max(0,i[a].b-100),u=!1;else try{Nn(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Xn(t){t.a||t.j||(t.U=1,Xt(t.Aa,t),t.o=0)}function Jn(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=me(C(t.Aa,t),rr(t,t.o)),t.o++,!0)}function Zn(t){null!=t.s&&(N.clearTimeout(t.s),t.s=null)}function tr(t){t.a=new De(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ke(t.la);tn(e,"RID","rpc"),tn(e,"SID",t.J),tn(e,"CI",t.H?"0":"1"),tn(e,"AID",t.P),Kn(t,e),tn(e,"TYPE","xmlhttp"),t.i&&t.l&&jn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=en(Ke(e)),n.j=null,n.I=!0,ke(n,t)}function er(t){null!=t.m&&(N.clearTimeout(t.m),t.m=null)}function nr(t,e){var n=null;if(t.a==e){er(t),Zn(t),t.a=null;var r=2}else{if(!En(t.b,e))return;n=e.s,_n(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=U()-e.u;var i=t.u;(r=fe()).dispatchEvent(new ge(r,n,e,i)),Wn(t)}else Xn(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(bn(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)||(t.h=me(C(t.Ba,t,e),rr(t,t.u)),t.u++,0)))}(t,e)||2==r&&Jn(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:ir(t,5);break;case 4:ir(t,10);break;case 3:ir(t,6);break;default:ir(t,2)}}function rr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function ir(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=C(t.Xa,t);n||(n=new Qe("//www.google.com/images/cleardot.gif"),N.location&&"http"==N.location.protocol||Ye(n,"https"),en(n)),function(t,e){var n=new ce;if(N.Image){var r=new Image;r.onload=V(Sn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=V(Sn,n,r,"TestLoadImage: error",!1,e),r.onabort=V(Sn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=V(Sn,n,r,"TestLoadImage: timeout",!1,e),N.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else ye(2);t.v=0,t.f&&t.f.ra(e),or(t),Hn(t)}function or(t){t.v=0,t.I=-1,t.f&&(0==Tn(t.b).length&&0==t.g.length||(t.b.c.length=0,G(t.g),t.g.length=0),t.f.qa())}function sr(t,e,n){var r=function(t){return t instanceof Qe?Ke(t):new Qe(t,void 0)}(n);if(""!=r.c)e&&Xe(r,e+"."+r.c),Je(r,r.h);else{var i=N.location;r=function(t,e,n,r){var i=new Qe(null,void 0);return t&&Ye(i,t),e&&Xe(i,e),n&&Je(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.W&&X(t.W,function(t,e){tn(r,e,t)}),e=t.A,n=t.na,e&&n&&tn(r,e,n),tn(r,"VER",t.ha),Kn(t,r),r}function ur(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Dn(t.Ka)).F=t.C,e}function ar(){}function cr(){if(ot&&!(10<=Number(mt)))throw Error("Environmental error: no available transport.")}function hr(t,e){Bt.call(this),this.a=new Bn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!z(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!z(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new pr(this)}function lr(t){Ne.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function fr(){Se.call(this),this.status=1}function pr(t){this.a=t}(_=Dn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ie(this.H):Ie(Te),this.a.onreadystatechange=C(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void kn(this,t)}t=n||"";var i=new ze(this.headers);r&&Ge(r,function(t,e){i.set(e,t)}),r=function(t){t:{for(var e=Pn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=N.FormData&&t instanceof N.FormData,!(0<=j(xn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Mn(this),0<this.o&&((this.D=function(t){return ot&&yt(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=C(this.xa,this)):this.m=re(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){kn(this,t)}},_.xa=function(){void 0!==A&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},_.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Un(this))},_.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Un(this,!0)),Dn.S.G.call(this)},_.za=function(){this.j||(this.A||this.l||this.g?Vn(this):this.Ta())},_.Ta=function(){Vn(this)},_.X=function(){try{return 2<Fn(this)?this.a.status:-1}catch(t){return-1}},_.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},_.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),On(e)}},_.ua=function(){return this.h},_.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(_=Bn.prototype).ha=8,_.v=1,_.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new De(this,this.c,t,void 0),r=this.l;if(this.O&&(r?tt(r=J(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Yn(this,n,e),tn(i=Ke(this.B),"RID",t),tn(i,"CVER",22),this.A&&tn(i,"X-HTTP-Session-Id",this.A),Kn(this,i),this.i&&r&&jn(i,this.i,r),In(this.b,n),this.Ga&&tn(i,"TYPE","init"),this.da?(tn(i,"$req",e),tn(i,"SID","null"),n.V=!0,Pe(n,i,null)):Pe(n,i,e),this.v=2}}else 3==this.v&&(t?Qn(this,t):0==this.g.length||wn(this.b)||Qn(this))},_.Aa=function(){if(this.j=null,tr(this),this.V&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=me(C(this.Sa,this),t)}},_.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,zn(this),tr(this))},_.Ra=function(){null!=this.m&&(this.m=null,zn(this),Jn(this),ye(19))},_.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),ye(2)):(this.c.info("Failed to ping google.com"),ye(1))},(_=ar.prototype).ta=function(){},_.sa=function(){},_.ra=function(){},_.qa=function(){},_.Ha=function(){},cr.prototype.a=function(t,e){return new hr(t,e)},M(hr,Bt),(_=hr.prototype).addEventListener=function(t,e,n,r){hr.S.addEventListener.call(this,t,e,n,r)},_.removeEventListener=function(t,e,n,r){hr.S.removeEventListener.call(this,t,e,n,r)},_.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;ye(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=sr(t,null,t.fa),Wn(t)},_.close=function(){Gn(this.a)},_.Pa=function(t){if("string"==typeof t){var e={};e.__data__=t,$n(this.a,e)}else this.g?((e={}).__data__=zt(t),$n(this.a,e)):$n(this.a,t)},_.G=function(){this.a.f=null,delete this.f,Gn(this.a),delete this.a,hr.S.G.call(this)},M(lr,Ne),M(fr,Se),M(pr,ar),pr.prototype.ta=function(){this.a.dispatchEvent("a")},pr.prototype.sa=function(t){this.a.dispatchEvent(new lr(t))},pr.prototype.ra=function(t){this.a.dispatchEvent(new fr(t))},pr.prototype.qa=function(){this.a.dispatchEvent("b")},cr.prototype.createWebChannel=cr.prototype.a,hr.prototype.send=hr.prototype.Pa,hr.prototype.open=hr.prototype.Oa,hr.prototype.close=hr.prototype.close,we.NO_ERROR=0,we.TIMEOUT=8,we.HTTP_ERROR=6,be.COMPLETE="complete",_e.EventType=Ae,Ae.OPEN="a",Ae.CLOSE="b",Ae.ERROR="c",Ae.MESSAGE="d",Bt.prototype.listen=Bt.prototype.va,Dn.prototype.listenOnce=Dn.prototype.wa,Dn.prototype.getLastError=Dn.prototype.Qa,Dn.prototype.getLastErrorCode=Dn.prototype.ua,Dn.prototype.getStatus=Dn.prototype.X,Dn.prototype.getResponseJson=Dn.prototype.Na,Dn.prototype.getResponseText=Dn.prototype.$,Dn.prototype.send=Dn.prototype.ba;var dr={createWebChannelTransport:function(){return new cr},ErrorCode:we,EventType:be,WebChannel:_e,XhrIo:Dn},vr=dr.createWebChannelTransport,yr=dr.ErrorCode,gr=dr.EventType,mr=dr.WebChannel,wr=dr.XhrIo,br=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),Er={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ir=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return s(e,t),e}(Error),_r=new v("@firebase/firestore");function Tr(){return _r.logLevel}function Ar(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(_r.logLevel<=r.DEBUG){var i=e.map(Or);_r.debug.apply(_r,c(["Firestore (7.21.1): "+t],i))}}function Nr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(_r.logLevel<=r.ERROR){var i=e.map(Or);_r.error.apply(_r,c(["Firestore (7.21.1): "+t],i))}}function Sr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(_r.logLevel<=r.WARN){var i=e.map(Or);_r.warn.apply(_r,c(["Firestore (7.21.1): "+t],i))}}function Or(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function Dr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (7.21.1) INTERNAL ASSERTION FAILED: "+t;throw Nr(e),new Error(e)}function Lr(t,e){t||Dr()}function Rr(t,e){return t}function xr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Pr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function kr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Cr=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&Dr(),void 0===n?n=t.length-e:n>t.length-e&&Dr(),this.segments=t,this.offset=e,this.t=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.i(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):n.push(e),this.o(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.u=function(t){return t=void 0===t?1:t,this.o(this.segments,this.offset+t,this.length-t)},t.prototype.h=function(){return this.o(this.segments,this.offset,this.length-1)},t.prototype.l=function(){return this.segments[this.offset]},t.prototype._=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.m=function(){return 0===this.length},t.prototype.T=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.I=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.A=function(){return this.segments.slice(this.offset,this.limit())},t.i=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),Vr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.o=function(t,n,r){return new e(t,n,r)},e.prototype.R=function(){return this.A().join("/")},e.prototype.toString=function(){return this.R()},e.P=function(t){if(t.indexOf("//")>=0)throw new Ir(Er.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new e(t.split("/").filter(function(t){return t.length>0}))},e.g=function(){return new e([])},e}(Cr),Ur=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Mr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.o=function(t,n,r){return new e(t,n,r)},e.V=function(t){return Ur.test(t)},e.prototype.R=function(){return this.A().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.V(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.R()},e.prototype.p=function(){return 1===this.length&&"__name__"===this.get(0)},e.v=function(){return new e(["__name__"])},e.S=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Ir(Er.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},s=!1;i<t.length;){var u=t[i];if("\\"===u){if(i+1===t.length)throw new Ir(Er.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[i+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new Ir(Er.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=a,i+=2}else"`"===u?(s=!s,i++):"."!==u||s?(r+=u,i++):(o(),i++)}if(o(),s)throw new Ir(Er.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.g=function(){return new e([])},e}(Cr),Fr=function(){function t(t){this.path=t}return t.D=function(e){return new t(Vr.P(e))},t.C=function(e){return new t(Vr.P(e).u(5))},t.prototype.N=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===Vr.i(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.i=function(t,e){return Vr.i(t.path,e.path)},t.F=function(t){return t.length%2==0},t.$=function(e){return new t(new Vr(e.slice()))},t}();function jr(t,e){if(0!==e.length)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+ii(e.length,"argument")+".")}function qr(t,e,n){if(e.length!==n)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires "+ii(n,"argument")+", but was called with "+ii(e.length,"argument")+".")}function Br(t,e,n){if(e.length<n)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires at least "+ii(n,"argument")+", but was called with "+ii(e.length,"argument")+".")}function Gr(t,e,n,r){if(e.length<n||e.length>r)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+ii(e.length,"argument")+".")}function zr(t,e,n,r){Yr(t,e,ri(n)+" argument",r)}function Hr(t,e,n,r){void 0!==r&&zr(t,e,n,r)}function $r(t,e,n,r){Yr(t,e,n+" option",r)}function Wr(t,e,n,r){void 0!==r&&$r(t,e,n,r)}function Qr(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){for(var o=[],s=0,u=i;s<u.length;s++){var a=u[s];if(a===r)return;o.push(Jr(a))}var c=Jr(r);throw new Ir(Er.INVALID_ARGUMENT,"Invalid value "+c+" provided to function "+t+'() for option "'+n+'". Acceptable values: '+o.join(", "))}(t,0,n,r,i)}function Kr(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Ir(Er.INVALID_ARGUMENT,"Invalid value "+Jr(r)+" provided to function "+t+"() for its "+ri(n)+" argument. Acceptable values: "+e.join(", "));return r}function Yr(t,e,n,r){if(!("object"===e?Xr(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=Jr(r);throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function Xr(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Jr(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Dr()}function Zr(t,e,n){if(void 0===n)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+ri(e)+" argument, but it was undefined.")}function ti(t,e,n){Pr(e,function(e,r){if(n.indexOf(e)<0)throw new Ir(Er.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+t+"(). Available options: "+n.join(", "))})}function ei(t,e,n,r){var i=Jr(r);return new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires its "+ri(n)+" argument to be a "+e+", but it was: "+i)}function ni(t,e,n){if(n<=0)throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires its "+ri(e)+" argument to be a positive number, but it was: "+n+".")}function ri(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function ii(t,e){return t+" "+e+(1===t?"":"s")}function oi(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var si=function(){function t(){}return t.k=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=oi(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function ui(t,e){return t<e?-1:t>e?1:0}function ai(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}function ci(t){return t+"\0"}var hi=function(){function t(t){this.M=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.M,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.M)},t.prototype.O=function(){return 2*this.M.length},t.prototype.L=function(t){return ui(this.M,t.M)},t.prototype.isEqual=function(t){return this.M===t.M},t}();hi.B=new hi("");var li=function(){function t(t){this.q=t}return t.fromBase64String=function(e){try{return new t(hi.fromBase64String(e))}catch(e){throw new Ir(Er.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(hi.fromUint8Array(e))},t.prototype.toBase64=function(){return this.q.toBase64()},t.prototype.toUint8Array=function(){return this.q.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this.q.isEqual(t.q)},t}();function fi(){if("undefined"==typeof Uint8Array)throw new Ir(Er.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function pi(){if("undefined"==typeof atob)throw new Ir(Er.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var di=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.fromBase64String=function(t){qr("Blob.fromBase64String",arguments,1),zr("Blob.fromBase64String","string",1,t),pi();try{return new e(hi.fromBase64String(t))}catch(t){throw new Ir(Er.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},e.fromUint8Array=function(t){if(qr("Blob.fromUint8Array",arguments,1),fi(),!(t instanceof Uint8Array))throw ei("Blob.fromUint8Array","Uint8Array",1,t);return new e(hi.fromUint8Array(t))},e.prototype.toBase64=function(){return qr("Blob.toBase64",arguments,0),pi(),t.prototype.toBase64.call(this)},e.prototype.toUint8Array=function(){return qr("Blob.toUint8Array",arguments,0),fi(),t.prototype.toUint8Array.call(this)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(li),vi=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"W",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.L=function(t){return ui(this.projectId,t.projectId)||ui(this.database,t.database)},t}(),yi=function(){function t(t,e){this.j=t,this.K=e,this.G={}}return t.prototype.get=function(t){var e=this.j(t),n=this.G[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.K(s,t))return u}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.j(t),r=this.G[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.K(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.G[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.j(t),n=this.G[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.K(n[r][0],t))return 1===n.length?delete this.G[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){Pr(this.G,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];t(s,u)}})},t.prototype.m=function(){return kr(this.G)},t}(),gi=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Ir(Er.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Ir(Er.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Ir(Er.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Ir(Er.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype.H=function(t){return this.seconds===t.seconds?ui(this.nanoseconds,t.nanoseconds):ui(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),mi=function(){function t(t){this.timestamp=t}return t.Y=function(e){return new t(e)},t.min=function(){return new t(new gi(0,0))},t.prototype.L=function(t){return this.timestamp.H(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.J=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.X=function(){return this.timestamp},t}();function wi(t){return null==t}function bi(t){return 0===t&&1/t==-1/0}function Ei(t){return"number"==typeof t&&Number.isInteger(t)&&!bi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Ii=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Z=null};function _i(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Ii(t,e,n,r,i,o,s)}function Ti(t){var e=Rr(t);if(null===e.Z){var n=e.path.R();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(t){return function(t){return t.field.R()+t.op.toString()+po(t.value)}(t)}).join(","),n+="|ob:",n+=e.orderBy.map(function(t){return(e=t).field.R()+e.dir;var e}).join(","),wi(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=au(e.startAt)),e.endAt&&(n+="|ub:",n+=au(e.endAt)),e.Z=n}return e.Z}function Ai(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!pu(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!co(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!hu(t.startAt,e.startAt)&&hu(t.endAt,e.endAt)}function Ni(t){return Fr.F(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Si,Oi,Di=function(){function t(t,e,n,r,i,o,s){void 0===i&&(i=mi.min()),void 0===o&&(o=mi.min()),void 0===s&&(s=hi.B),this.target=t,this.targetId=e,this.tt=n,this.sequenceNumber=r,this.et=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return t.prototype.nt=function(e){return new t(this.target,this.targetId,this.tt,e,this.et,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.st=function(e,n){return new t(this.target,this.targetId,this.tt,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.it=function(e){return new t(this.target,this.targetId,this.tt,this.sequenceNumber,this.et,e,this.resumeToken)},t}();function Li(t){switch(t){case Er.OK:return Dr();case Er.CANCELLED:case Er.UNKNOWN:case Er.DEADLINE_EXCEEDED:case Er.RESOURCE_EXHAUSTED:case Er.INTERNAL:case Er.UNAVAILABLE:case Er.UNAUTHENTICATED:return!1;case Er.INVALID_ARGUMENT:case Er.NOT_FOUND:case Er.ALREADY_EXISTS:case Er.PERMISSION_DENIED:case Er.FAILED_PRECONDITION:case Er.ABORTED:case Er.OUT_OF_RANGE:case Er.UNIMPLEMENTED:case Er.DATA_LOSS:return!0;default:return Dr()}}function Ri(t){if(void 0===t)return Nr("GRPC error has no .code"),Er.UNKNOWN;switch(t){case Si.OK:return Er.OK;case Si.CANCELLED:return Er.CANCELLED;case Si.UNKNOWN:return Er.UNKNOWN;case Si.DEADLINE_EXCEEDED:return Er.DEADLINE_EXCEEDED;case Si.RESOURCE_EXHAUSTED:return Er.RESOURCE_EXHAUSTED;case Si.INTERNAL:return Er.INTERNAL;case Si.UNAVAILABLE:return Er.UNAVAILABLE;case Si.UNAUTHENTICATED:return Er.UNAUTHENTICATED;case Si.INVALID_ARGUMENT:return Er.INVALID_ARGUMENT;case Si.NOT_FOUND:return Er.NOT_FOUND;case Si.ALREADY_EXISTS:return Er.ALREADY_EXISTS;case Si.PERMISSION_DENIED:return Er.PERMISSION_DENIED;case Si.FAILED_PRECONDITION:return Er.FAILED_PRECONDITION;case Si.ABORTED:return Er.ABORTED;case Si.OUT_OF_RANGE:return Er.OUT_OF_RANGE;case Si.UNIMPLEMENTED:return Er.UNIMPLEMENTED;case Si.DATA_LOSS:return Er.DATA_LOSS;default:return Dr()}}(Oi=Si||(Si={}))[Oi.OK=0]="OK",Oi[Oi.CANCELLED=1]="CANCELLED",Oi[Oi.UNKNOWN=2]="UNKNOWN",Oi[Oi.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Oi[Oi.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Oi[Oi.NOT_FOUND=5]="NOT_FOUND",Oi[Oi.ALREADY_EXISTS=6]="ALREADY_EXISTS",Oi[Oi.PERMISSION_DENIED=7]="PERMISSION_DENIED",Oi[Oi.UNAUTHENTICATED=16]="UNAUTHENTICATED",Oi[Oi.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Oi[Oi.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Oi[Oi.ABORTED=10]="ABORTED",Oi[Oi.OUT_OF_RANGE=11]="OUT_OF_RANGE",Oi[Oi.UNIMPLEMENTED=12]="UNIMPLEMENTED",Oi[Oi.INTERNAL=13]="INTERNAL",Oi[Oi.UNAVAILABLE=14]="UNAVAILABLE",Oi[Oi.DATA_LOSS=15]="DATA_LOSS";var xi=function(){function t(t,e){this.i=t,this.root=e||ki.EMPTY}return t.prototype.rt=function(e,n){return new t(this.i,this.root.rt(e,n,this.i).copy(null,null,ki.ot,null,null))},t.prototype.remove=function(e){return new t(this.i,this.root.remove(e,this.i).copy(null,null,ki.ot,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.m();){var n=this.i(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.m();){var r=this.i(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.m=function(){return this.root.m()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.at=function(){return this.root.at()},t.prototype.ct=function(){return this.root.ct()},t.prototype.ut=function(t){return this.root.ut(t)},t.prototype.forEach=function(t){this.ut(function(e,n){return t(e,n),!1})},t.prototype.toString=function(){var t=[];return this.ut(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},t.prototype.ht=function(t){return this.root.ht(t)},t.prototype.lt=function(){return new Pi(this.root,null,this.i,!1)},t.prototype._t=function(t){return new Pi(this.root,t,this.i,!1)},t.prototype.ft=function(){return new Pi(this.root,null,this.i,!0)},t.prototype.dt=function(t){return new Pi(this.root,t,this.i,!0)},t}(),Pi=function(){function t(t,e,n,r){this.wt=r,this.Tt=[];for(var i=1;!t.m();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.wt?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.wt?t.right:t.left}}return t.prototype.Et=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.m();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.m();)this.Tt.push(t),t=t.left;return e},t.prototype.It=function(){return this.Tt.length>0},t.prototype.At=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},t}(),ki=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.m=function(){return!1},t.prototype.ut=function(t){return this.left.ut(t)||t(this.key,this.value)||this.right.ut(t)},t.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},t.prototype.min=function(){return this.left.m()?this:this.left.min()},t.prototype.at=function(){return this.min().key},t.prototype.ct=function(){return this.right.m()?this.key:this.right.ct()},t.prototype.rt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.rt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.rt(t,e,n))).Rt()},t.prototype.Pt=function(){if(this.left.m())return t.EMPTY;var e=this;return e.left.gt()||e.left.left.gt()||(e=e.yt()),(e=e.copy(null,null,null,e.left.Pt(),null)).Rt()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.m()||i.left.gt()||i.left.left.gt()||(i=i.yt()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.gt()&&(i=i.Vt()),i.right.m()||i.right.gt()||i.right.left.gt()||(i=i.bt()),0===n(e,i.key)){if(i.right.m())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.Pt())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.Rt()},t.prototype.gt=function(){return this.color},t.prototype.Rt=function(){var t=this;return t.right.gt()&&!t.left.gt()&&(t=t.vt()),t.left.gt()&&t.left.left.gt()&&(t=t.Vt()),t.left.gt()&&t.right.gt()&&(t=t.St()),t},t.prototype.yt=function(){var t=this.St();return t.right.left.gt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Vt())).vt()).St()),t},t.prototype.bt=function(){var t=this.St();return t.left.left.gt()&&(t=(t=t.Vt()).St()),t},t.prototype.vt=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.Vt=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.St=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.Dt=function(){var t=this.Ct();return Math.pow(2,t)<=this.size+1},t.prototype.Ct=function(){if(this.gt()&&this.left.gt())throw Dr();if(this.right.gt())throw Dr();var t=this.left.Ct();if(t!==this.right.Ct())throw Dr();return t+(this.gt()?0:1)},t}();ki.EMPTY=null,ki.RED=!0,ki.ot=!1,ki.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.rt=function(t,e,n){return new ki(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.m=function(){return!0},t.prototype.ut=function(t){return!1},t.prototype.ht=function(t){return!1},t.prototype.at=function(){return null},t.prototype.ct=function(){return null},t.prototype.gt=function(){return!1},t.prototype.Dt=function(){return!0},t.prototype.Ct=function(){return 0},t}());var Ci=function(){function t(t){this.i=t,this.data=new xi(this.i)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.at()},t.prototype.last=function(){return this.data.ct()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.ut(function(e,n){return t(e),!1})},t.prototype.Nt=function(t,e){for(var n=this.data._t(t[0]);n.It();){var r=n.Et();if(this.i(r.key,t[1])>=0)return;e(r.key)}},t.prototype.Ft=function(t,e){var n;for(n=void 0!==e?this.data._t(e):this.data.lt();n.It();)if(!t(n.Et().key))return},t.prototype.xt=function(t){var e=this.data._t(t);return e.It()?e.Et().key:null},t.prototype.lt=function(){return new Vi(this.data.lt())},t.prototype._t=function(t){return new Vi(this.data._t(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).rt(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.m=function(){return this.data.m()},t.prototype.$t=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.lt(),r=e.data.lt();n.It();){var i=n.Et().key,o=r.Et().key;if(0!==this.i(i,o))return!1}return!0},t.prototype.A=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.i);return n.data=e,n},t}(),Vi=function(){function t(t){this.kt=t}return t.prototype.Et=function(){return this.kt.Et().key},t.prototype.It=function(){return this.kt.It()},t}(),Ui=new xi(Fr.i);function Mi(){return Ui}function Fi(){return Mi()}var ji=new xi(Fr.i);function qi(){return ji}var Bi=new xi(Fr.i),Gi=new Ci(Fr.i);function zi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Gi,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Hi=new Ci(ui);function $i(){return Hi}var Wi=function(){function t(t){this.i=t?function(e,n){return t(e,n)||Fr.i(e.key,n.key)}:function(t,e){return Fr.i(t.key,e.key)},this.Mt=qi(),this.Ot=new xi(this.i)}return t.Lt=function(e){return new t(e.i)},t.prototype.has=function(t){return null!=this.Mt.get(t)},t.prototype.get=function(t){return this.Mt.get(t)},t.prototype.first=function(){return this.Ot.at()},t.prototype.last=function(){return this.Ot.ct()},t.prototype.m=function(){return this.Ot.m()},t.prototype.indexOf=function(t){var e=this.Mt.get(t);return e?this.Ot.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.Ot.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.Ot.ut(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Mt.rt(t.key,t),e.Ot.rt(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Mt.remove(t),this.Ot.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.Ot.lt(),r=e.Ot.lt();n.It();){var i=n.Et().key,o=r.Et().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.i=this.i,r.Mt=e,r.Ot=n,r},t}(),Qi=function(){function t(){this.Bt=new xi(Fr.i)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Bt.get(e);n?0!==t.type&&3===n.type?this.Bt=this.Bt.rt(e,t):3===t.type&&1!==n.type?this.Bt=this.Bt.rt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Bt=this.Bt.rt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Bt=this.Bt.remove(e):1===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):Dr():this.Bt=this.Bt.rt(e,t)},t.prototype.qt=function(){var t=[];return this.Bt.ut(function(e,n){t.push(n)}),t},t}(),Ki=function(){function t(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Ut=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.Wt=s,this.jt=u}return t.Kt=function(e,n,r,i){var o=[];return n.forEach(function(t){o.push({type:0,doc:t})}),new t(e,n,Wi.Lt(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.Qt.m()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Wt===t.Wt&&this.Qt.isEqual(t.Qt)&&Ws(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ut.isEqual(t.Ut)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Yi=function(){function t(t,e,n,r,i){this.et=t,this.Gt=e,this.zt=n,this.Ht=r,this.Yt=i}return t.Jt=function(e,n){var r=new Map;return r.set(e,Xi.Xt(e,n)),new t(mi.min(),r,$i(),Mi(),zi())},t}(),Xi=function(){function t(t,e,n,r,i){this.resumeToken=t,this.Zt=e,this.te=n,this.ee=r,this.ne=i}return t.Xt=function(e,n){return new t(hi.B,n,zi(),zi(),zi())},t}(),Ji=function(t,e,n,r){this.se=t,this.removedTargetIds=e,this.key=n,this.ie=r},Zi=function(t,e){this.targetId=t,this.re=e},to=function(t,e,n,r){void 0===n&&(n=hi.B),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},eo=function(){function t(){this.oe=0,this.ae=io(),this.ce=hi.B,this.ue=!1,this.he=!0}return Object.defineProperty(t.prototype,"Zt",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"le",{get:function(){return 0!==this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_e",{get:function(){return this.he},enumerable:!1,configurable:!0}),t.prototype.fe=function(t){t.O()>0&&(this.he=!0,this.ce=t)},t.prototype.de=function(){var t=zi(),e=zi(),n=zi();return this.ae.forEach(function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Dr()}}),new Xi(this.ce,this.ue,t,e,n)},t.prototype.we=function(){this.he=!1,this.ae=io()},t.prototype.me=function(t,e){this.he=!0,this.ae=this.ae.rt(t,e)},t.prototype.Te=function(t){this.he=!0,this.ae=this.ae.remove(t)},t.prototype.Ee=function(){this.oe+=1},t.prototype.Ie=function(){this.oe-=1},t.prototype.Ae=function(){this.he=!0,this.ue=!0},t}(),no=function(){function t(t){this.Re=t,this.Pe=new Map,this.ge=Mi(),this.ye=ro(),this.Ve=new Ci(ui)}return t.prototype.pe=function(t){for(var e=0,n=t.se;e<n.length;e++){var r=n[e];t.ie instanceof Rs?this.be(r,t.ie):t.ie instanceof xs&&this.ve(r,t.key,t.ie)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.ve(s,t.key,t.ie)}},t.prototype.Se=function(t){var e=this;this.De(t,function(n){var r=e.Ce(n);switch(t.state){case 0:e.Ne(n)&&r.fe(t.resumeToken);break;case 1:r.Ie(),r.le||r.we(),r.fe(t.resumeToken);break;case 2:r.Ie(),r.le||e.removeTarget(n);break;case 3:e.Ne(n)&&(r.Ae(),r.fe(t.resumeToken));break;case 4:e.Ne(n)&&(e.Fe(n),r.fe(t.resumeToken));break;default:Dr()}})},t.prototype.De=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.Pe.forEach(function(t,r){n.Ne(r)&&e(r)})},t.prototype.xe=function(t){var e=t.targetId,n=t.re.count,r=this.$e(e);if(r){var i=r.target;if(Ni(i))if(0===n){var o=new Fr(i.path);this.ve(e,o,new xs(o,mi.min()))}else Lr(1===n);else this.ke(e)!==n&&(this.Fe(e),this.Ve=this.Ve.add(e))}},t.prototype.Me=function(t){var e=this,n=new Map;this.Pe.forEach(function(r,i){var o=e.$e(i);if(o){if(r.Zt&&Ni(o.target)){var s=new Fr(o.target.path);null!==e.ge.get(s)||e.Oe(i,s)||e.ve(i,s,new xs(s,t))}r._e&&(n.set(i,r.de()),r.we())}});var r=zi();this.ye.forEach(function(t,n){var i=!0;n.Ft(function(t){var n=e.$e(t);return!n||2===n.tt||(i=!1,!1)}),i&&(r=r.add(t))});var i=new Yi(t,n,this.Ve,this.ge,r);return this.ge=Mi(),this.ye=ro(),this.Ve=new Ci(ui),i},t.prototype.be=function(t,e){if(this.Ne(t)){var n=this.Oe(t,e.key)?2:0;this.Ce(t).me(e.key,n),this.ge=this.ge.rt(e.key,e),this.ye=this.ye.rt(e.key,this.Le(e.key).add(t))}},t.prototype.ve=function(t,e,n){if(this.Ne(t)){var r=this.Ce(t);this.Oe(t,e)?r.me(e,1):r.Te(e),this.ye=this.ye.rt(e,this.Le(e).delete(t)),n&&(this.ge=this.ge.rt(e,n))}},t.prototype.removeTarget=function(t){this.Pe.delete(t)},t.prototype.ke=function(t){var e=this.Ce(t).de();return this.Re.Be(t).size+e.te.size-e.ne.size},t.prototype.Ee=function(t){this.Ce(t).Ee()},t.prototype.Ce=function(t){var e=this.Pe.get(t);return e||(e=new eo,this.Pe.set(t,e)),e},t.prototype.Le=function(t){var e=this.ye.get(t);return e||(e=new Ci(ui),this.ye=this.ye.rt(t,e)),e},t.prototype.Ne=function(t){var e=null!==this.$e(t);return e||Ar("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.$e=function(t){var e=this.Pe.get(t);return e&&e.le?null:this.Re.qe(t)},t.prototype.Fe=function(t){var e=this;this.Pe.set(t,new eo),this.Re.Be(t).forEach(function(n){e.ve(t,n,null)})},t.prototype.Oe=function(t,e){return this.Re.Be(t).has(e)},t}();function ro(){return new xi(Fr.i)}function io(){return new xi(Fr.i)}function oo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function so(t){var e=vo(t.mapValue.fields.__local_write_time__.timestampValue);return new gi(e.seconds,e.nanos)}var uo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ao(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?oo(t)?4:10:Dr()}function co(t,e){var n=ao(t);if(n!==ao(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return so(t).isEqual(so(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=vo(t.timestampValue),r=vo(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return go(t.bytesValue).isEqual(go(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return yo(t.geoPointValue.latitude)===yo(e.geoPointValue.latitude)&&yo(t.geoPointValue.longitude)===yo(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return yo(t.integerValue)===yo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=yo(t.doubleValue),r=yo(e.doubleValue);return n===r?bi(n)===bi(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return ai(t.arrayValue.values||[],e.arrayValue.values||[],co);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(xr(n)!==xr(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!co(n[i],r[i])))return!1;return!0}(t,e);default:return Dr()}}function ho(t,e){return void 0!==(t.values||[]).find(function(t){return co(t,e)})}function lo(t,e){var n=ao(t),r=ao(e);if(n!==r)return ui(n,r);switch(n){case 0:return 0;case 1:return ui(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=yo(t.integerValue||t.doubleValue),r=yo(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return fo(t.timestampValue,e.timestampValue);case 4:return fo(so(t),so(e));case 5:return ui(t.stringValue,e.stringValue);case 6:return function(t,e){var n=go(t),r=go(e);return n.L(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=ui(n[i],r[i]);if(0!==o)return o}return ui(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=ui(yo(t.latitude),yo(e.latitude));return 0!==n?n:ui(yo(t.longitude),yo(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=lo(n[i],r[i]);if(o)return o}return ui(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=ui(r[s],o[s]);if(0!==u)return u;var a=lo(n[r[s]],i[o[s]]);if(0!==a)return a}return ui(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Dr()}}function fo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return ui(t,e);var n=vo(t),r=vo(e),i=ui(n.seconds,r.seconds);return 0!==i?i:ui(n.nanos,r.nanos)}function po(t){return function t(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(t){var e=vo(t);return"time("+e.seconds+","+e.nanos+")"}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?go(e.bytesValue).toBase64():"referenceValue"in e?(r=e.referenceValue,Fr.C(r).toString()):"geoPointValue"in e?"geo("+(n=e.geoPointValue).latitude+","+n.longitude+")":"arrayValue"in e?function(e){for(var n="[",r=!0,i=0,o=e.values||[];i<o.length;i++){var s=o[i];r?r=!1:n+=",",n+=t(s)}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){for(var n="{",r=!0,i=0,o=Object.keys(e.fields||{}).sort();i<o.length;i++){var s=o[i];r?r=!1:n+=",",n+=s+":"+t(e.fields[s])}return n+"}"}(e.mapValue):Dr();var n,r}(t)}function vo(t){if(Lr(!!t),"string"==typeof t){var e=0,n=uo.exec(t);if(Lr(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:yo(t.seconds),nanos:yo(t.nanos)}}function yo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function go(t){return"string"==typeof t?hi.fromBase64String(t):hi.fromUint8Array(t)}function mo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.R()}}function wo(t){return!!t&&"integerValue"in t}function bo(t){return!!t&&"arrayValue"in t}function Eo(t){return!!t&&"nullValue"in t}function Io(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function _o(t){return!!t&&"mapValue"in t}var To={asc:"ASCENDING",desc:"DESCENDING"},Ao={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},No=function(t,e){this.U=t,this.Ue=e};function So(t){return{integerValue:""+t}}function Oo(t,e){if(t.Ue){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:bi(e)?"-0":e}}function Do(t,e){return Ei(e)?So(e):Oo(t,e)}function Lo(t,e){return t.Ue?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ro(t,e){return t.Ue?e.toBase64():e.toUint8Array()}function xo(t){return Lr(!!t),mi.Y(function(t){var e=vo(t);return new gi(e.seconds,e.nanos)}(t))}function Po(t,e){return function(t){return new Vr(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).R()}function ko(t){var e=Vr.P(t);return Lr(Yo(e)),e}function Co(t,e){return Po(t.U,e.path)}function Vo(t,e){var n=ko(e);return Lr(n.get(1)===t.U.projectId),Lr(!n.get(3)&&!t.U.database||n.get(3)===t.U.database),new Fr(jo(n))}function Uo(t,e){return Po(t.U,e)}function Mo(t){var e=ko(t);return 4===e.length?Vr.g():jo(e)}function Fo(t){return new Vr(["projects",t.U.projectId,"databases",t.U.database]).R()}function jo(t){return Lr(t.length>4&&"documents"===t.get(4)),t.u(5)}function qo(t,e,n){return{name:Co(t,e),fields:n.proto.mapValue.fields}}function Bo(t,e){var n;if(e instanceof ws)n={update:qo(t,e.key,e.value)};else if(e instanceof As)n={delete:Co(t,e.key)};else if(e instanceof bs)n={update:qo(t,e.key,e.data),updateMask:function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.R())}),{fieldPaths:e}}(e.Qe)};else if(e instanceof Is)n={transform:{document:Co(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){return function(t,e){var n=e.transform;if(n instanceof es)return{fieldPath:e.field.R(),setToServerValue:"REQUEST_TIME"};if(n instanceof ns)return{fieldPath:e.field.R(),appendMissingElements:{values:n.elements}};if(n instanceof is)return{fieldPath:e.field.R(),removeAllFromArray:{values:n.elements}};if(n instanceof ss)return{fieldPath:e.field.R(),increment:n.We};throw Dr()}(0,t)})}};else{if(!(e instanceof Ns))return Dr();n={verify:Co(t,e.key)}}return e.Ke.je||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:function(t,e){return Lo(t,e.X())}(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Dr()}(t,e.Ke)),n}function Go(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?ls.updateTime(xo(t.updateTime)):void 0!==t.exists?ls.exists(t.exists):ls.Ge()}(e.currentDocument):ls.Ge();if(e.update){e.update.name;var r=Vo(t,e.update.name),i=new Ss({mapValue:{fields:e.update.fields}});if(e.updateMask){var o=function(t){var e=t.fieldPaths||[];return new cs(e.map(function(t){return Mr.S(t)}))}(e.updateMask);return new bs(r,i,o,n)}return new ws(r,i,n)}if(e.delete){var s=Vo(t,e.delete);return new As(s,n)}if(e.transform){var u=Vo(t,e.transform.document),a=e.transform.fieldTransforms.map(function(e){return function(t,e){var n=null;if("setToServerValue"in e)Lr("REQUEST_TIME"===e.setToServerValue),n=new es;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new ns(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new is(i)}else"increment"in e?n=new ss(t,e.increment):Dr();var o=Mr.S(e.fieldPath);return new hs(o,n)}(t,e)});return Lr(!0===n.exists),new Is(u,a)}if(e.verify){var c=Vo(t,e.verify);return new Ns(c,n)}return Dr()}function zo(t,e){return{documents:[Uo(t,e.path)]}}function Ho(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Uo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Uo(t,r.h()),n.structuredQuery.from=[{collectionId:r._()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return function(t){if("=="===t.op){if(Io(t.value))return{unaryFilter:{field:Qo(t.field),op:"IS_NAN"}};if(Eo(t.value))return{unaryFilter:{field:Qo(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Io(t.value))return{unaryFilter:{field:Qo(t.field),op:"IS_NOT_NAN"}};if(Eo(t.value))return{unaryFilter:{field:Qo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Qo(t.field),op:function(t){return Ao[t]}(t.op),value:t.value}}}(t)});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return function(t){return{field:Qo(t.field),direction:function(t){return To[t]}(t.dir)}}(t)})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s=function(t,e){return t.Ue||wi(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=$o(e.startAt)),e.endAt&&(n.structuredQuery.endAt=$o(e.endAt)),n}function $o(t){return{before:t.before,values:t.position}}function Wo(t){var e=!!t.before,n=t.values||[];return new uu(n,e)}function Qo(t){return{fieldPath:t.R()}}function Ko(t){return Mr.S(t.fieldPath)}function Yo(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}var Xo=function(){this.ze=void 0};function Jo(t,e,n){return t instanceof es?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof ns?rs(t,e):t instanceof is?os(t,e):function(t,e){var n=ts(t,e),r=us(n)+us(t.We);return wo(n)&&wo(t.We)?So(r):Oo(t.serializer,r)}(t,e)}function Zo(t,e,n){return t instanceof ns?rs(t,e):t instanceof is?os(t,e):n}function ts(t,e){return t instanceof ss?wo(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var es=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(Xo),ns=function(t){function e(e){var n;return(n=t.call(this)||this).elements=e,n}return s(e,t),e}(Xo);function rs(t,e){for(var n=as(e),r=function(t){n.some(function(e){return co(e,t)})||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var is=function(t){function e(e){var n;return(n=t.call(this)||this).elements=e,n}return s(e,t),e}(Xo);function os(t,e){for(var n=as(e),r=function(t){n=n.filter(function(e){return!co(e,t)})},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var ss=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).serializer=e,r.We=n,r}return s(e,t),e}(Xo);function us(t){return yo(t.integerValue||t.doubleValue)}function as(t){return bo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var cs=function(){function t(t){this.fields=t,t.sort(Mr.i)}return t.prototype.He=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].T(t))return!0;return!1},t.prototype.isEqual=function(t){return ai(this.fields,t.fields,function(t,e){return t.isEqual(e)})},t}(),hs=function(t,e){this.field=t,this.transform=e},ls=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.Ge=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"je",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function fs(t,e){return void 0!==t.updateTime?e instanceof Rs&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Rs}var ps=function(){};function ds(t,e,n){return t instanceof ws?function(t,e,n){return new Rs(t.key,n.version,t.value,{hasCommittedMutations:!0})}(t,0,n):t instanceof bs?function(t,e,n){if(!fs(t.Ke,e))return new Ps(t.key,n.version);var r=Es(t,e);return new Rs(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof Is?function(t,e,n){if(Lr(null!=n.transformResults),!fs(t.Ke,e))return new Ps(t.key,n.version);var r=_s(t,e),i=function(t,e,n){var r=[];Lr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Rs&&(u=e.field(o.field)),r.push(Zo(s,u,n[i]))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Ts(t,r.data(),i);return new Rs(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):function(t,e,n){return new xs(t.key,n.version,{hasCommittedMutations:!0})}(t,0,n)}function vs(t,e,n,r){return t instanceof ws?function(t,e){if(!fs(t.Ke,e))return e;var n=ms(e);return new Rs(t.key,n,t.value,{Ye:!0})}(t,e):t instanceof bs?function(t,e){if(!fs(t.Ke,e))return e;var n=ms(e),r=Es(t,e);return new Rs(t.key,n,r,{Ye:!0})}(t,e):t instanceof Is?function(t,e,n,r){if(!fs(t.Ke,e))return e;var i=_s(t,e),o=function(t,e,n,r){for(var i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof Rs&&(c=n.field(u.field)),null===c&&r instanceof Rs&&(c=r.field(u.field)),i.push(Jo(a,c,e))}return i}(t.fieldTransforms,n,e,r),s=Ts(t,i.data(),o);return new Rs(t.key,i.version,s,{Ye:!0})}(t,e,r,n):function(t,e){return fs(t.Ke,e)?new xs(t.key,mi.min()):e}(t,e)}function ys(t,e){return t instanceof Is?function(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],s=e instanceof Rs?e.field(o.field):void 0,u=ts(o.transform,s||null);null!=u&&(n=null==n?(new Os).set(o.field,u):n.set(o.field,u))}return n?n.Je():null}(t,e):null}function gs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ke.isEqual(e.Ke)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||ai(t.fieldTransforms,t.fieldTransforms,function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof ns&&e instanceof ns||t instanceof is&&e instanceof is?ai(t.elements,e.elements,co):t instanceof ss&&e instanceof ss?co(t.We,e.We):t instanceof es&&e instanceof es}(t.transform,e.transform)}(t,e)}))}function ms(t){return t instanceof Rs?t.version:mi.min()}var ws=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).key=e,i.value=n,i.Ke=r,i.type=0,i}return s(e,t),e}(ps),bs=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this)||this).key=e,o.data=n,o.Qe=r,o.Ke=i,o.type=1,o}return s(e,t),e}(ps);function Es(t,e){return function(t,e){var n=new Os(e);return t.Qe.fields.forEach(function(e){if(!e.m()){var r=t.data.field(e);null!==r?n.set(e,r):n.delete(e)}}),n.Je()}(t,e instanceof Rs?e.data():Ss.empty())}var Is=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.fieldTransforms=n,r.type=2,r.Ke=ls.exists(!0),r}return s(e,t),e}(ps);function _s(t,e){return e}function Ts(t,e,n){for(var r=new Os(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Je()}var As=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Ke=n,r.type=3,r}return s(e,t),e}(ps),Ns=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.Ke=n,r.type=4,r}return s(e,t),e}(ps),Ss=function(){function t(t){this.proto=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.m())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!_o(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t._()])||null},t.prototype.isEqual=function(t){return co(this.proto,t.proto)},t}(),Os=function(){function t(t){void 0===t&&(t=Ss.empty()),this.Xe=t,this.Ze=new Map}return t.prototype.set=function(t,e){return this.tn(t,e),this},t.prototype.delete=function(t){return this.tn(t,null),this},t.prototype.tn=function(t,e){for(var n=this.Ze,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===ao(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t._(),e)},t.prototype.Je=function(){var t=this.en(Mr.g(),this.Ze);return null!=t?new Ss(t):this.Xe},t.prototype.en=function(t,e){var n=this,r=!1,i=this.Xe.field(t),o=_o(i)?Object.assign({},i.mapValue.fields):{};return e.forEach(function(e,i){if(e instanceof Map){var s=n.en(t.child(i),e);null!=s&&(o[i]=s,r=!0)}else null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)}),r?{mapValue:{fields:o}}:null},t}();function Ds(t){var e=[];return Pr(t.fields||{},function(t,n){var r=new Mr([t]);if(_o(n)){var i=Ds(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,s=i;o<s.length;o++){var u=s[o];e.push(r.child(u))}}else e.push(r)}),new cs(e)}var Ls=function(t,e){this.key=t,this.version=e},Rs=function(t){function e(e,n,r,i){var o=this;return(o=t.call(this,e,n)||this).nn=r,o.Ye=!!i.Ye,o.hasCommittedMutations=!!i.hasCommittedMutations,o}return s(e,t),e.prototype.field=function(t){return this.nn.field(t)},e.prototype.data=function(){return this.nn},e.prototype.sn=function(){return this.nn.proto},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ye===t.Ye&&this.hasCommittedMutations===t.hasCommittedMutations&&this.nn.isEqual(t.nn)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.nn.toString()+", {hasLocalMutations: "+this.Ye+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.Ye||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e}(Ls),xs=function(t){function e(e,n,r){var i;return(i=t.call(this,e,n)||this).hasCommittedMutations=!(!r||!r.hasCommittedMutations),i}return s(e,t),e.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Ls),Ps=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},e}(Ls),ks=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.rn=n,this.filters=r,this.limit=i,this.on=o,this.startAt=s,this.endAt=u,this.an=null,this.cn=null,this.startAt,this.endAt};function Cs(t,e,n,r,i,o,s,u){return new ks(t,e,n,r,i,o,s,u)}function Vs(t){return new ks(t)}function Us(t){return!wi(t.limit)&&"F"===t.on}function Ms(t){return!wi(t.limit)&&"L"===t.on}function Fs(t){return t.rn.length>0?t.rn[0].field:null}function js(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.un())return r.field}return null}function qs(t){return null!==t.collectionGroup}function Bs(t){var e=Rr(t);if(null===e.an){e.an=[];var n=js(e),r=Fs(e);if(null!==n&&null===r)n.p()||e.an.push(new lu(n)),e.an.push(new lu(Mr.v(),"asc"));else{for(var i=!1,o=0,s=e.rn;o<s.length;o++){var u=s[o];e.an.push(u),u.field.p()&&(i=!0)}if(!i){var a=e.rn.length>0?e.rn[e.rn.length-1].dir:"asc";e.an.push(new lu(Mr.v(),a))}}}return e.an}function Gs(t){var e=Rr(t);if(!e.cn)if("F"===e.on)e.cn=_i(e.path,e.collectionGroup,Bs(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Bs(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new lu(o.field,s))}var u=e.endAt?new uu(e.endAt.position,!e.endAt.before):null,a=e.startAt?new uu(e.startAt.position,!e.startAt.before):null;e.cn=_i(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.cn}function zs(t,e,n){return new ks(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Hs(t,e){return new ks(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,e,t.endAt)}function $s(t,e){return new ks(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,t.startAt,e)}function Ws(t,e){return Ai(Gs(t),Gs(e))&&t.on===e.on}function Qs(t){return Ti(Gs(t))+"|lt:"+t.on}function Ks(t){return"Query(target="+function(t){var e=t.path.R();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map(function(t){return(e=t).field.R()+" "+e.op+" "+po(e.value);var e}).join(", ")+"]"),wi(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map(function(t){return(e=t).field.R()+" ("+e.dir+")";var e}).join(", ")+"]"),t.startAt&&(e+=", startAt: "+au(t.startAt)),t.endAt&&(e+=", endAt: "+au(t.endAt)),"Target("+e+")"}(Gs(t))+"; limitType="+t.on+")"}function Ys(t,e){return function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.N(t.collectionGroup)&&t.path.T(n):Fr.F(t.path)?t.path.isEqual(n):t.path.I(n)}(t,e)&&function(t,e){for(var n=0,r=t.rn;n<r.length;n++){var i=r[n];if(!i.field.p()&&null===e.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!cu(t.startAt,Bs(t),e)||t.endAt&&cu(t.endAt,Bs(t),e))}(t,e)}function Xs(t){return function(e,n){for(var r=!1,i=0,o=Bs(t);i<o.length;i++){var s=o[i],u=fu(s,e,n);if(0!==u)return u;r=r||s.field.p()}return 0}}var Js=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return s(e,t),e.create=function(t,n,r){if(t.p())return"in"===n||"not-in"===n?this.hn(t,n,r):new Zs(t,n,r);if(Eo(r)){if("=="!==n&&"!="!==n)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. Null only supports '==' and '!=' comparisons.");return new e(t,n,r)}if(Io(r)){if("=="!==n&&"!="!==n)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. NaN only supports '==' and '!=' comparisons.");return new e(t,n,r)}return"array-contains"===n?new ru(t,r):"in"===n?new iu(t,r):"not-in"===n?new ou(t,r):"array-contains-any"===n?new su(t,r):new e(t,n,r)},e.hn=function(t,e,n){return"in"===e?new tu(t,n):new eu(t,n)},e.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.ln(lo(e,this.value)):null!==e&&ao(this.value)===ao(e)&&this.ln(lo(e,this.value))},e.prototype.ln=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Dr()}},e.prototype.un=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}(function(){}),Zs=function(t){function e(e,n,r){var i;return(i=t.call(this,e,n,r)||this).key=Fr.C(r.referenceValue),i}return s(e,t),e.prototype.matches=function(t){var e=Fr.i(t.key,this.key);return this.ln(e)},e}(Js),tu=function(t){function e(e,n){var r;return(r=t.call(this,e,"in",n)||this).keys=nu("in",n),r}return s(e,t),e.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},e}(Js),eu=function(t){function e(e,n){var r;return(r=t.call(this,e,"not-in",n)||this).keys=nu("not-in",n),r}return s(e,t),e.prototype.matches=function(t){return!this.keys.some(function(e){return e.isEqual(t.key)})},e}(Js);function nu(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return Fr.C(t.referenceValue)})}var ru=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return s(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return bo(e)&&ho(e.arrayValue,this.value)},e}(Js),iu=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return s(e,t),e.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&ho(this.value.arrayValue,e)},e}(Js),ou=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return s(e,t),e.prototype.matches=function(t){if(ho(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!ho(this.value.arrayValue,e)},e}(Js),su=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return s(e,t),e.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!bo(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return ho(e.value.arrayValue,t)})},e}(Js),uu=function(t,e){this.position=t,this.before=e};function au(t){return(t.before?"b":"a")+":"+t.position.map(function(t){return po(t)}).join(",")}function cu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];if(r=o.field.p()?Fr.i(Fr.C(s.referenceValue),n.key):lo(s,n.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function hu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!co(t.position[n],e.position[n]))return!1;return!0}var lu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function fu(t,e,n){var r=t.field.p()?Fr.i(e.key,n.key):function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?lo(r,i):Dr()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Dr()}}function pu(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var du=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})},vu=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this._n=t,this.fn=e,this.dn=n,this.wn=r,this.mn=i,this.Tn=0,this.En=null,this.In=Date.now(),this.reset()}return t.prototype.reset=function(){this.Tn=0},t.prototype.An=function(){this.Tn=this.mn},t.prototype.Rn=function(t){var e=this;this.cancel();var n=Math.floor(this.Tn+this.Pn()),r=Math.max(0,Date.now()-this.In),i=Math.max(0,n-r);i>0&&Ar("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Tn+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.En=this._n.gn(this.fn,i,function(){return e.In=Date.now(),t()}),this.Tn*=this.wn,this.Tn<this.dn&&(this.Tn=this.dn),this.Tn>this.mn&&(this.Tn=this.mn)},t.prototype.yn=function(){null!==this.En&&(this.En.Vn(),this.En=null)},t.prototype.cancel=function(){null!==this.En&&(this.En.cancel(),this.En=null)},t.prototype.Pn=function(){return(Math.random()-.5)*this.Tn},t}(),yu=function(){function t(t){var e=this;this.pn=null,this.bn=null,this.result=void 0,this.error=void 0,this.vn=!1,this.Sn=!1,t(function(t){e.vn=!0,e.result=t,e.pn&&e.pn(t)},function(t){e.vn=!0,e.error=t,e.bn&&e.bn(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.Sn&&Dr(),this.Sn=!0,this.vn?this.error?this.Dn(n,this.error):this.Cn(e,this.result):new t(function(t,i){r.pn=function(n){r.Cn(e,n).next(t,i)},r.bn=function(e){r.Dn(n,e).next(t,i)}})},t.prototype.Nn=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.Fn=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.Cn=function(e,n){return e?this.Fn(function(){return e(n)}):t.resolve(n)},t.prototype.Dn=function(e,n){return e?this.Fn(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.xn=function(e){return new t(function(t,n){var r=0,i=0,o=!1;e.forEach(function(e){++r,e.next(function(){++i,o&&i===r&&t()},function(t){return n(t)})}),o=!0,i===r&&t()})},t.$n=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next(function(n){return n?t.resolve(n):e()})},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.xn(r)},t}(),gu=function(){function t(e,n,r){this.name=e,this.version=n,this.kn=r,12.2===t.Mn(y())&&Nr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return Ar("SimpleDb","Removing database:",t),_u(window.indexedDB.deleteDatabase(t)).Nn()},t.On=function(){if("undefined"==typeof indexedDB)return!1;if(t.Ln())return!0;var e=y(),n=t.Mn(e),r=0<n&&n<10,i=t.Bn(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.Ln=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.qn)},t.Un=function(t,e){return t.store(e)},t.Mn=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Bn=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.Qn=function(){return u(this,void 0,void 0,function(){var t,e=this;return a(this,function(n){switch(n.label){case 0:return this.db?[3,2]:(Ar("SimpleDb","Opening database:",this.name),t=this,[4,new Promise(function(t,n){var r=indexedDB.open(e.name,e.version);r.onsuccess=function(e){var n=e.target.result;t(n)},r.onblocked=function(){n(new wu("Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){var e=t.target.error;"VersionError"===e.name?n(new Ir(Er.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new wu(e))},r.onupgradeneeded=function(t){Ar("SimpleDb",'Database "'+e.name+'" requires upgrade from version:',t.oldVersion);var n=t.target.result;e.kn.createOrUpgrade(n,r.transaction,t.oldVersion,e.version).next(function(){Ar("SimpleDb","Database upgrade to version "+e.version+" complete")})}})]);case 1:t.db=n.sent(),n.label=2;case 2:return[2,(this.Wn&&(this.db.onversionchange=function(t){return e.Wn(t)}),this.db)]}})})},t.prototype.jn=function(t){this.Wn=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n){return u(this,void 0,void 0,function(){var r,i,o,s,u;return a(this,function(c){switch(c.label){case 0:r="readonly"===t,i=0,o=function(){var t,o,u,c,h;return a(this,function(a){switch(a.label){case 0:++i,a.label=1;case 1:return a.trys.push([1,4,,5]),[4,s.Qn()];case 2:return s.db=a.sent(),t=Eu.open(s.db,r?"readonly":"readwrite",e),o=n(t).catch(function(e){return t.abort(e),yu.reject(e)}).Nn(),u={},o.catch(function(){}),[4,t.Kn];case 3:return[2,(u.value=(a.sent(),o),u)];case 4:return c=a.sent(),h="FirebaseError"!==c.name&&i<3,Ar("SimpleDb","Transaction failed with error:",c.message,"Retrying:",h),s.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}})},s=this,c.label=1;case 1:return[5,o()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}})})},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),mu=function(){function t(t){this.Gn=t,this.zn=!1,this.Hn=null}return Object.defineProperty(t.prototype,"vn",{get:function(){return this.zn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Yn",{get:function(){return this.Hn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Gn=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.zn=!0},t.prototype.Jn=function(t){this.Hn=t},t.prototype.delete=function(){return _u(this.Gn.delete())},t}(),wu=function(t){function e(e){var n;return(n=t.call(this,Er.UNAVAILABLE,"IndexedDB transaction failed: "+e)||this).name="IndexedDbTransactionError",n}return s(e,t),e}(Ir);function bu(t){return"IndexedDbTransactionError"===t.name}var Eu=function(){function t(t){var e=this;this.transaction=t,this.aborted=!1,this.Xn=new du,this.transaction.oncomplete=function(){e.Xn.resolve()},this.transaction.onabort=function(){t.error?e.Xn.reject(new wu(t.error)):e.Xn.resolve()},this.transaction.onerror=function(t){var n=Au(t.target.error);e.Xn.reject(new wu(n))}}return t.open=function(e,n,r){try{return new t(e.transaction(r,n))}catch(e){throw new wu(e)}},Object.defineProperty(t.prototype,"Kn",{get:function(){return this.Xn.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.Xn.reject(t),this.aborted||(Ar("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Iu(e)},t}(),Iu=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(Ar("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Ar("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),_u(n)},t.prototype.add=function(t){return Ar("SimpleDb","ADD",this.store.name,t,t),_u(this.store.add(t))},t.prototype.get=function(t){var e=this;return _u(this.store.get(t)).next(function(n){return void 0===n&&(n=null),Ar("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return Ar("SimpleDb","DELETE",this.store.name,t),_u(this.store.delete(t))},t.prototype.count=function(){return Ar("SimpleDb","COUNT",this.store.name),_u(this.store.count())},t.prototype.Zn=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.ts(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.es=function(t,e){Ar("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.ns=!1;var r=this.cursor(n);return this.ts(r,function(t,e,n){return n.delete()})},t.prototype.ss=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.ts(r,e)},t.prototype.rs=function(t){var e=this.cursor({});return new yu(function(n,r){e.onerror=function(t){var e=Au(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},t.prototype.ts=function(t,e){var n=[];return new yu(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new mu(i),s=e(i.primaryKey,i.value,o);if(s instanceof yu){var u=s.catch(function(t){return o.done(),yu.reject(t)});n.push(u)}o.vn?r():null===o.Yn?i.continue():i.continue(o.Yn)}else r()}}).next(function(){return yu.xn(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.ns?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function _u(t){return new yu(function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=Au(t.target.error);n(e)}})}var Tu=!1;function Au(t){var e=gu.Mn(y());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Ir("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Tu||(Tu=!0,setTimeout(function(){throw r},0)),r}}return t}function Nu(){return"undefined"!=typeof window?window:null}function Su(){return"undefined"!=typeof document?document:null}var Ou=function(){function t(t,e,n,r,i){this.os=t,this.fn=e,this.cs=n,this.op=r,this.us=i,this.hs=new du,this.then=this.hs.promise.then.bind(this.hs.promise),this.hs.promise.catch(function(t){})}return t.ls=function(e,n,r,i,o){var s=new t(e,n,Date.now()+r,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this._s=setTimeout(function(){return e.fs()},t)},t.prototype.Vn=function(){return this.fs()},t.prototype.cancel=function(t){null!==this._s&&(this.clearTimeout(),this.hs.reject(new Ir(Er.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.fs=function(){var t=this;this.os.ds(function(){return null!==t._s?(t.clearTimeout(),t.op().then(function(e){return t.hs.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this._s&&(this.us(this),clearTimeout(this._s),this._s=null)},t}(),Du=function(){function t(){var t=this;this.ws=Promise.resolve(),this.Ts=[],this.Es=!1,this.Is=[],this.As=null,this.Rs=!1,this.Ps=[],this.gs=new vu(this,"async_queue_retry"),this.ys=function(){var e=Su();e&&Ar("AsyncQueue","Visibility state changed to  ",e.visibilityState),t.gs.yn()};var e=Su();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.ys)}return Object.defineProperty(t.prototype,"Vs",{get:function(){return this.Es},enumerable:!1,configurable:!0}),t.prototype.ds=function(t){this.enqueue(t)},t.prototype.ps=function(t){this.bs(),this.vs(t)},t.prototype.Ss=function(){if(!this.Es){this.Es=!0;var t=Su();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.ys)}},t.prototype.enqueue=function(t){return this.bs(),this.Es?new Promise(function(t){}):this.vs(t)},t.prototype.Ds=function(t){var e=this;this.Ts.push(t),this.ds(function(){return e.Cs()})},t.prototype.Cs=function(){return u(this,void 0,void 0,function(){var t,e=this;return a(this,function(n){switch(n.label){case 0:if(0===this.Ts.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.Ts[0]()];case 2:return n.sent(),this.Ts.shift(),this.gs.reset(),[3,4];case 3:if(!bu(t=n.sent()))throw t;return Ar("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.Ts.length>0&&this.gs.Rn(function(){return e.Cs()}),n.label=5;case 5:return[2]}})})},t.prototype.vs=function(t){var e=this,n=this.ws.then(function(){return e.Rs=!0,t().catch(function(t){throw e.As=t,e.Rs=!1,Nr("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(function(t){return e.Rs=!1,t})});return this.ws=n,n},t.prototype.gn=function(t,e,n){var r=this;this.bs(),this.Ps.indexOf(t)>-1&&(e=0);var i=Ou.ls(this,t,e,n,function(t){return r.Ns(t)});return this.Is.push(i),i},t.prototype.bs=function(){this.As&&Dr()},t.prototype.Fs=function(){},t.prototype.xs=function(){return u(this,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return[4,t=this.ws];case 1:e.sent(),e.label=2;case 2:if(t!==this.ws)return[3,0];e.label=3;case 3:return[2]}})})},t.prototype.$s=function(t){for(var e=0,n=this.Is;e<n.length;e++)if(n[e].fn===t)return!0;return!1},t.prototype.ks=function(t){var e=this;return this.xs().then(function(){e.Is.sort(function(t,e){return t.cs-e.cs});for(var n=0,r=e.Is;n<r.length;n++){var i=r[n];if(i.Vn(),"all"!==t&&i.fn===t)break}return e.xs()})},t.prototype.Ms=function(t){this.Ps.push(t)},t.prototype.Ns=function(t){var e=this.Is.indexOf(t);this.Is.splice(e,1)},t}();function Lu(t,e){if(Nr("AsyncQueue",e+": "+t),bu(t))return new Ir(Er.UNAVAILABLE,e+": "+t);throw t}var Ru=function(){this.Os=void 0,this.listeners=[]};function xu(t,e){return u(this,void 0,void 0,function(){var n,r,i,o,s,u,c;return a(this,function(a){switch(a.label){case 0:if(n=Rr(t),r=e.query,i=!1,(o=n.Ls.get(r))||(i=!0,o=new Ru),!i)return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),s=o,[4,n.qs(r)];case 2:return s.Os=a.sent(),[3,4];case 3:return u=a.sent(),c=Lu(u,"Initialization of query '"+Ks(e.query)+"' failed"),[2,void e.onError(c)];case 4:return n.Ls.set(r,o),o.listeners.push(e),e.Us(n.onlineState),o.Os&&e.Qs(o.Os)&&ku(n),[2]}})})}function Pu(t,e){return u(this,void 0,void 0,function(){var n,r,i,o,s;return a(this,function(u){return n=Rr(t),r=e.query,i=!1,(o=n.Ls.get(r))&&(s=o.listeners.indexOf(e))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.Ls.delete(r),n.Ws(r))]:[2]})})}function ku(t){t.Bs.forEach(function(t){t.next()})}var Cu=function(){function t(t,e,n){this.query=t,this.js=e,this.Ks=!1,this.Gs=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Qs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Ki(t.query,t.docs,t.Ut,e,t.Qt,t.fromCache,t.Wt,!0)}var o=!1;return this.Ks?this.zs(t)&&(this.js.next(t),o=!0):this.Hs(t,this.onlineState)&&(this.Ys(t),o=!0),this.Gs=t,o},t.prototype.onError=function(t){this.js.error(t)},t.prototype.Us=function(t){this.onlineState=t;var e=!1;return this.Gs&&!this.Ks&&this.Hs(this.Gs,t)&&(this.Ys(this.Gs),e=!0),e},t.prototype.Hs=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Js&&n||t.docs.m()&&"Offline"!==e)},t.prototype.zs=function(t){if(t.docChanges.length>0)return!0;var e=this.Gs&&this.Gs.hasPendingWrites!==t.hasPendingWrites;return!(!t.Wt&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.Ys=function(t){t=Ki.Kt(t.query,t.docs,t.Qt,t.fromCache),this.Ks=!0,this.js.next(t)},t}(),Vu=function(){function t(t){this.uid=t}return t.prototype.Xs=function(){return null!=this.uid},t.prototype.Zs=function(){return this.Xs()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();Vu.UNAUTHENTICATED=new Vu(null),Vu.ti=new Vu("google-credentials-uid"),Vu.ei=new Vu("first-party-uid");var Uu=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.ni=function(t){return n.si(t)},this.ii=function(t){return e.ri(t)})}return t.prototype.si=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.ii&&this.ii(t),t},t}();function Mu(t,e){return"firestore_clients_"+t+"_"+e}function Fu(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.Xs()&&(r+="_"+e.uid),r}function ju(t,e){return"firestore_targets_"+t+"_"+e}Uu.oi=-1;var qu=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.ai=function(e,n,r){var i=JSON.parse(r),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error),s=void 0;return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(s=new Ir(i.error.code,i.error.message)),o?new t(e,n,i.state,s):(Nr("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.ci=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Bu=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.ai=function(e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Ir(r.error.code,r.error.message)),i?new t(e,r.state,o):(Nr("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.ci=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),Gu=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.ai=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=$i(),s=0;i&&s<r.activeTargetIds.length;++s)i=Ei(r.activeTargetIds[s]),o=o.add(r.activeTargetIds[s]);return i?new t(e,o):(Nr("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),zu=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.ai=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Nr("SharedClientState","Failed to parse online state: "+e),null)},t}(),Hu=function(){function t(){this.activeTargetIds=$i()}return t.prototype.ui=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.hi=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.ci=function(){var t={activeTargetIds:this.activeTargetIds.A(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),$u=function(){function t(t,e,n,r,i){this.window=t,this._n=e,this.persistenceKey=n,this.li=r,this._i=null,this.fi=null,this.ni=null,this.di=this.wi.bind(this),this.mi=new xi(ui),this.Ti=!1,this.Ei=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ii=Mu(this.persistenceKey,this.li),this.Ai=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.mi=this.mi.rt(this.li,new Hu),this.Ri=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Pi=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.gi=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.yi=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.di)}return t.On=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return u(this,void 0,void 0,function(){var t,e,n,r,i,o,s,u,c,h,l,f=this;return a(this,function(a){switch(a.label){case 0:return[4,this._i.Vi()];case 1:for(t=a.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.li&&(i=this.getItem(Mu(this.persistenceKey,r)))&&(o=Gu.ai(r,i))&&(this.mi=this.mi.rt(o.clientId,o));for(this.pi(),(s=this.storage.getItem(this.yi))&&(u=this.bi(s))&&this.vi(u),c=0,h=this.Ei;c<h.length;c++)l=h[c],this.wi(l);return this.Ei=[],this.window.addEventListener("unload",function(){return f.Si()}),this.Ti=!0,[2]}})})},t.prototype.ri=function(t){this.setItem(this.Ai,JSON.stringify(t))},t.prototype.Di=function(){return this.Ci(this.mi)},t.prototype.Ni=function(t){var e=!1;return this.mi.forEach(function(n,r){r.activeTargetIds.has(t)&&(e=!0)}),e},t.prototype.Fi=function(t){this.xi(t,"pending")},t.prototype.$i=function(t,e,n){this.xi(t,e,n),this.ki(t)},t.prototype.Mi=function(t){var e="not-current";if(this.Ni(t)){var n=this.storage.getItem(ju(this.persistenceKey,t));if(n){var r=Bu.ai(t,n);r&&(e=r.state)}}return this.Oi.ui(t),this.pi(),e},t.prototype.Li=function(t){this.Oi.hi(t),this.pi()},t.prototype.Bi=function(t){return this.Oi.activeTargetIds.has(t)},t.prototype.qi=function(t){this.removeItem(ju(this.persistenceKey,t))},t.prototype.Ui=function(t,e,n){this.Qi(t,e,n)},t.prototype.Wi=function(t,e,n){var r=this;e.forEach(function(t){r.ki(t)}),this.currentUser=t,n.forEach(function(t){r.Fi(t)})},t.prototype.ji=function(t){this.Ki(t)},t.prototype.Si=function(){this.Ti&&(this.window.removeEventListener("storage",this.di),this.removeItem(this.Ii),this.Ti=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return Ar("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){Ar("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){Ar("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.wi=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(Ar("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ii)return void Nr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this._n.Ds(function(){return u(e,void 0,void 0,function(){var t,e,r,i,o,s;return a(this,function(u){if(this.Ti){if(null!==n.key)if(this.Ri.test(n.key)){if(null==n.newValue)return t=this.Gi(n.key),[2,this.zi(t,null)];if(e=this.Hi(n.key,n.newValue))return[2,this.zi(e.clientId,e)]}else if(this.Pi.test(n.key)){if(null!==n.newValue&&(r=this.Yi(n.key,n.newValue)))return[2,this.Ji(r)]}else if(this.gi.test(n.key)){if(null!==n.newValue&&(i=this.Xi(n.key,n.newValue)))return[2,this.Zi(i)]}else if(n.key===this.yi){if(null!==n.newValue&&(o=this.bi(n.newValue)))return[2,this.vi(o)]}else n.key===this.Ai&&(s=function(t){var e=Uu.oi;if(null!=t)try{var n=JSON.parse(t);Lr("number"==typeof n),e=n}catch(t){Nr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Uu.oi&&this.ni(s)}else this.Ei.push(n);return[2]})})})}},Object.defineProperty(t.prototype,"Oi",{get:function(){return this.mi.get(this.li)},enumerable:!1,configurable:!0}),t.prototype.pi=function(){this.setItem(this.Ii,this.Oi.ci())},t.prototype.xi=function(t,e,n){var r=new qu(this.currentUser,t,e,n),i=Fu(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ci())},t.prototype.ki=function(t){var e=Fu(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Ki=function(t){var e={clientId:this.li,onlineState:t};this.storage.setItem(this.yi,JSON.stringify(e))},t.prototype.Qi=function(t,e,n){var r=ju(this.persistenceKey,t),i=new Bu(t,e,n);this.setItem(r,i.ci())},t.prototype.Gi=function(t){var e=this.Ri.exec(t);return e?e[1]:null},t.prototype.Hi=function(t,e){var n=this.Gi(t);return Gu.ai(n,e)},t.prototype.Yi=function(t,e){var n=this.Pi.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return qu.ai(new Vu(i),r,e)},t.prototype.Xi=function(t,e){var n=this.gi.exec(t),r=Number(n[1]);return Bu.ai(r,e)},t.prototype.bi=function(t){return zu.ai(t)},t.prototype.Ji=function(t){return u(this,void 0,void 0,function(){return a(this,function(e){return t.user.uid===this.currentUser.uid?[2,this._i.tr(t.batchId,t.state,t.error)]:(Ar("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},t.prototype.Zi=function(t){return this._i.er(t.targetId,t.state,t.error)},t.prototype.zi=function(t,e){var n=this,r=e?this.mi.rt(t,e):this.mi.remove(t),i=this.Ci(this.mi),o=this.Ci(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this._i.nr(s,u).then(function(){n.mi=r})},t.prototype.vi=function(t){this.mi.get(t.clientId)&&this.fi(t.onlineState)},t.prototype.Ci=function(t){var e=$i();return t.forEach(function(t,n){e=e.$t(n.activeTargetIds)}),e},t}(),Wu=function(){function t(){this.sr=new Hu,this.ir={},this.fi=null,this.ni=null}return t.prototype.Fi=function(t){},t.prototype.$i=function(t,e,n){},t.prototype.Mi=function(t){return this.sr.ui(t),this.ir[t]||"not-current"},t.prototype.Ui=function(t,e,n){this.ir[t]=e},t.prototype.Li=function(t){this.sr.hi(t)},t.prototype.Bi=function(t){return this.sr.activeTargetIds.has(t)},t.prototype.qi=function(t){delete this.ir[t]},t.prototype.Di=function(){return this.sr.activeTargetIds},t.prototype.Ni=function(t){return this.sr.activeTargetIds.has(t)},t.prototype.start=function(){return this.sr=new Hu,Promise.resolve()},t.prototype.Wi=function(t,e,n){},t.prototype.ji=function(t){},t.prototype.Si=function(){},t.prototype.ri=function(t){},t}(),Qu=function(){function t(t,e,n,r){this.batchId=t,this.rr=e,this.baseMutations=n,this.mutations=r}return t.prototype.ar=function(t,e,n){for(var r=n.cr,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=ds(o,e,r[i]))}return e},t.prototype.ur=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=vs(i,e,e,this.rr))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=vs(a,e,o,this.rr))}return e},t.prototype.hr=function(t){var e=this,n=t;return this.mutations.forEach(function(r){var i=e.ur(r.key,t.get(r.key));i&&(n=n.rt(r.key,i))}),n},t.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},zi())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&ai(this.mutations,t.mutations,function(t,e){return gs(t,e)})&&ai(this.baseMutations,t.baseMutations,function(t,e){return gs(t,e)})},t}(),Ku=function(){function t(t,e,n,r){this.batch=t,this.lr=e,this.cr=n,this._r=r}return t.from=function(e,n,r){Lr(e.mutations.length===r.length);for(var i=Bi,o=e.mutations,s=0;s<o.length;s++)i=i.rt(o[s].key,r[s].version);return new t(e,n,r,i)},t}(),Yu=function(){function t(){this.dr=new yi(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.wr=!1}return Object.defineProperty(t.prototype,"readTime",{get:function(){return this.mr},set:function(t){this.mr=t},enumerable:!1,configurable:!0}),t.prototype.Tr=function(t,e){this.Er(),this.readTime=e,this.dr.set(t.key,t)},t.prototype.Ir=function(t,e){this.Er(),e&&(this.readTime=e),this.dr.set(t,null)},t.prototype.Ar=function(t,e){this.Er();var n=this.dr.get(e);return void 0!==n?yu.resolve(n):this.Rr(t,e)},t.prototype.getEntries=function(t,e){return this.Pr(t,e)},t.prototype.apply=function(t){return this.Er(),this.wr=!0,this.gr(t)},t.prototype.Er=function(){},t}(),Xu="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ju=function(){function t(){this.yr=[]}return t.prototype.Vr=function(t){this.yr.push(t)},t.prototype.pr=function(){this.yr.forEach(function(t){return t()})},t}(),Zu=function(){function t(t,e,n){this.br=t,this.vr=e,this.Sr=n}return t.prototype.Dr=function(t,e){var n=this;return this.vr.Cr(t,e).next(function(r){return n.Nr(t,e,r)})},t.prototype.Nr=function(t,e,n){return this.br.Ar(t,e).next(function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].ur(e,t);return t})},t.prototype.Fr=function(t,e,n){var r=Fi();return e.forEach(function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].ur(t,e);r=r.rt(t,e)}),r},t.prototype.$r=function(t,e){var n=this;return this.br.getEntries(t,e).next(function(e){return n.kr(t,e)})},t.prototype.kr=function(t,e){var n=this;return this.vr.Mr(t,e).next(function(r){var i=n.Fr(t,e,r),o=Mi();return i.forEach(function(t,e){e||(e=new xs(t,mi.min())),o=o.rt(t,e)}),o})},t.prototype.Or=function(t,e,n){return function(t){return Fr.F(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Lr(t,e.path):qs(e)?this.Br(t,e,n):this.qr(t,e,n)},t.prototype.Lr=function(t,e){return this.Dr(t,new Fr(e)).next(function(t){var e=qi();return t instanceof Rs&&(e=e.rt(t.key,t)),e})},t.prototype.Br=function(t,e,n){var r=this,i=e.collectionGroup,o=qi();return this.Sr.Ur(t,i).next(function(s){return yu.forEach(s,function(s){var u=function(t,e){return new ks(e,null,t.rn.slice(),t.filters.slice(),t.limit,t.on,t.startAt,t.endAt)}(e,s.child(i));return r.qr(t,u,n).next(function(t){t.forEach(function(t,e){o=o.rt(t,e)})})}).next(function(){return o})})},t.prototype.qr=function(t,e,n){var r,i,o=this;return this.br.Or(t,e,n).next(function(n){return r=n,o.vr.Qr(t,e)}).next(function(e){return i=e,o.Wr(t,i,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=u[s],c=a.key,h=r.get(c),l=vs(a,h,h,o.rr);r=l instanceof Rs?r.rt(c,l):r.remove(c)}})}).next(function(){return r.forEach(function(t,n){Ys(e,n)||(r=r.remove(t))}),r})},t.prototype.Wr=function(t,e,n){for(var r=zi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof bs&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.br.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Rs&&(c=c.rt(t,e))}),c})},t}(),ta=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.jr=n,this.Kr=r}return t.Gr=function(e,n){for(var r=zi(),i=zi(),o=0,s=n.docChanges;o<s.length;o++){var u=s[o];switch(u.type){case 0:r=r.add(u.doc.key);break;case 1:i=i.add(u.doc.key)}}return new t(e,n.fromCache,r,i)},t}();function ea(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=ui(n,i);return 0===s?ui(r,o):s}var na=function(){function t(t){this.zr=t,this.buffer=new Ci(ea),this.Hr=0}return t.prototype.Yr=function(){return++this.Hr},t.prototype.Jr=function(t){var e=[t,this.Yr()];if(this.buffer.size<this.zr)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();ea(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),ra={Xr:!1,Zr:0,eo:0,no:0},ia=function(){function t(t,e,n){this.so=t,this.io=e,this.ro=n}return t.oo=function(e){return new t(e,t.ao,t.co)},t}();ia.uo=-1,ia.ho=1048576,ia.lo=41943040,ia.ao=10,ia.co=1e3,ia._o=new ia(ia.lo,ia.ao,ia.co),ia.fo=new ia(ia.uo,0,0);var oa=function(){function t(t,e){this.do=t,this.os=e,this.wo=!1,this.mo=null}return t.prototype.start=function(t){this.do.params.so!==ia.uo&&this.To(t)},t.prototype.stop=function(){this.mo&&(this.mo.cancel(),this.mo=null)},Object.defineProperty(t.prototype,"Ti",{get:function(){return null!==this.mo},enumerable:!1,configurable:!0}),t.prototype.To=function(t){var e=this,n=this.wo?3e5:6e4;Ar("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.mo=this.os.gn("lru_garbage_collection",n,function(){return u(e,void 0,void 0,function(){var e;return a(this,function(n){switch(n.label){case 0:this.mo=null,this.wo=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.Eo(this.do)];case 2:return n.sent(),[3,7];case 3:return bu(e=n.sent())?(Ar("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,mc(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.To(t)];case 8:return n.sent(),[2]}})})})},t}(),sa=function(){function t(t,e){this.Io=t,this.params=e}return t.prototype.Ao=function(t,e){return this.Io.Ro(t).next(function(t){return Math.floor(e/100*t)})},t.prototype.Po=function(t,e){var n=this;if(0===e)return yu.resolve(Uu.oi);var r=new na(e);return this.Io.De(t,function(t){return r.Jr(t.sequenceNumber)}).next(function(){return n.Io.yo(t,function(t){return r.Jr(t)})}).next(function(){return r.maxValue})},t.prototype.Vo=function(t,e,n){return this.Io.Vo(t,e,n)},t.prototype.po=function(t,e){return this.Io.po(t,e)},t.prototype.bo=function(t,e){var n=this;return this.params.so===ia.uo?(Ar("LruGarbageCollector","Garbage collection skipped; disabled"),yu.resolve(ra)):this.vo(t).next(function(r){return r<n.params.so?(Ar("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.so),ra):n.So(t,e)})},t.prototype.vo=function(t){return this.Io.vo(t)},t.prototype.So=function(t,e){var n,i,o,s,u,a,c,h=this,l=Date.now();return this.Ao(t,this.params.io).next(function(e){return e>h.params.ro?(Ar("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.ro+" from "+e),i=h.params.ro):i=e,s=Date.now(),h.Po(t,i)}).next(function(r){return n=r,u=Date.now(),h.Vo(t,n,e)}).next(function(e){return o=e,a=Date.now(),h.po(t,n)}).next(function(t){return c=Date.now(),Tr()<=r.DEBUG&&Ar("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-l)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-l)+"ms"),yu.resolve({Xr:!0,Zr:i,eo:o,no:t})})},t}();function ua(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=ca(e)),e=aa(t.get(n),e);return ca(e)}function aa(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function ca(t){return t+""}function ha(t){var e=t.length;if(Lr(e>=2),2===e)return Lr(""===t.charAt(0)&&""===t.charAt(1)),Vr.g();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||s>n)&&Dr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Dr()}o=s+2}return new Vr(r)}var la=function(t){this.Do=t};function fa(t,e){if(e.document)return function(t,e,n){var r=Vo(t,e.name),i=xo(e.updateTime),o=new Ss({mapValue:{fields:e.fields}});return new Rs(r,i,o,{hasCommittedMutations:!!n})}(t.Do,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Fr.$(e.noDocument.path),r=ga(e.noDocument.readTime);return new xs(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var i=Fr.$(e.unknownDocument.path),o=ga(e.unknownDocument.version);return new Ps(i,o)}return Dr()}function pa(t,e,n){var r=da(n),i=e.key.path.h().A();if(e instanceof Rs){var o=function(t,e){return{name:Co(t,e.key),fields:e.sn().mapValue.fields,updateTime:Lo(t,e.version.X())}}(t.Do,e),s=e.hasCommittedMutations;return new Ba(null,null,o,s,r,i)}if(e instanceof xs){var u=e.key.path.A(),a=ya(e.version),c=e.hasCommittedMutations;return new Ba(null,new ja(u,a),null,c,r,i)}if(e instanceof Ps){var h=e.key.path.A(),l=ya(e.version);return new Ba(new qa(h,l),null,null,!0,r,i)}return Dr()}function da(t){var e=t.X();return[e.seconds,e.nanoseconds]}function va(t){var e=new gi(t[0],t[1]);return mi.Y(e)}function ya(t){var e=t.X();return new Ca(e.seconds,e.nanoseconds)}function ga(t){var e=new gi(t.seconds,t.nanoseconds);return mi.Y(e)}function ma(t,e){var n=(e.baseMutations||[]).map(function(e){return Go(t.Do,e)}),r=e.mutations.map(function(e){return Go(t.Do,e)}),i=gi.fromMillis(e.localWriteTimeMs);return new Qu(e.batchId,i,n,r)}function wa(t){var e,n,r=ga(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?ga(t.lastLimboFreeSnapshotVersion):mi.min();return void 0!==t.query.documents?(Lr(1===(n=t.query).documents.length),e=Gs(Vs(Mo(n.documents[0])))):e=function(t){var e=Mo(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Lr(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Ko(t.unaryFilter.field);return Js.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Ko(t.unaryFilter.field);return Js.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Ko(t.unaryFilter.field);return Js.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Ko(t.unaryFilter.field);return Js.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Dr()}}(e)]:void 0!==e.fieldFilter?[function(t){return Js.create(Ko(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Dr()}}(t.fieldFilter.op),t.fieldFilter.value)}(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(function(e){return t(e)}).reduce(function(t,e){return t.concat(e)}):Dr():[]}(n.where));var u=[];n.orderBy&&(u=n.orderBy.map(function(t){return function(t){return new lu(Ko(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)}));var a=null;n.limit&&(a=function(t){var e;return wi(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=Wo(n.startAt));var h=null;return n.endAt&&(h=Wo(n.endAt)),Gs(Cs(e,i,u,s,a,"F",c,h))}(t.query),new Di(e,t.targetId,0,t.lastListenSequenceNumber,r,i,hi.fromBase64String(t.resumeToken))}function ba(t,e){var n,r=ya(e.et),i=ya(e.lastLimboFreeSnapshotVersion);n=Ni(e.target)?zo(t.Do,e.target):Ho(t.Do,e.target);var o=e.resumeToken.toBase64();return new za(e.targetId,Ti(e.target),r,o,e.sequenceNumber,i,n)}var Ea=function(){function t(t,e,n,r){this.userId=t,this.serializer=e,this.Sr=n,this.Co=r,this.No={}}return t.Fo=function(e,n,r,i){return Lr(""!==e.uid),new t(e.Xs()?e.uid:"",n,r,i)},t.prototype.xo=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ta(t).ss({index:Ma.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.$o=function(t,e,n,r){var i=this,o=Aa(t),s=Ta(t);return s.add({}).next(function(u){Lr("number"==typeof u);for(var a=new Qu(u,e,n,r),c=function(t,e,n){var r=n.baseMutations.map(function(e){return Bo(t.Do,e)}),i=n.mutations.map(function(e){return Bo(t.Do,e)});return new Ma(e,n.batchId,n.rr.toMillis(),r,i)}(i.serializer,i.userId,a),h=[],l=new Ci(function(t,e){return ui(t.R(),e.R())}),f=0,p=r;f<p.length;f++){var d=p[f],v=Fa.key(i.userId,d.key.path,u);l=l.add(d.key.path.h()),h.push(s.put(c)),h.push(o.put(v,Fa.PLACEHOLDER))}return l.forEach(function(e){h.push(i.Sr.ko(t,e))}),t.Vr(function(){i.No[u]=a.keys()}),yu.xn(h).next(function(){return a})})},t.prototype.Mo=function(t,e){var n=this;return Ta(t).get(e).next(function(t){return t?(Lr(t.userId===n.userId),ma(n.serializer,t)):null})},t.prototype.Oo=function(t,e){var n=this;return this.No[e]?yu.resolve(this.No[e]):this.Mo(t,e).next(function(t){if(t){var r=t.keys();return n.No[e]=r,r}return null})},t.prototype.Lo=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Ta(t).ss({index:Ma.userMutationsIndex,range:i},function(t,e,i){e.userId===n.userId&&(Lr(e.batchId>=r),o=ma(n.serializer,e)),i.done()}).next(function(){return o})},t.prototype.Bo=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Ta(t).ss({index:Ma.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},t.prototype.qo=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ta(t).Zn(Ma.userMutationsIndex,n).next(function(t){return t.map(function(t){return ma(e.serializer,t)})})},t.prototype.Cr=function(t,e){var n=this,r=Fa.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Aa(t).ss({range:i},function(r,i,s){var u=r[0],a=r[1],c=r[2],h=ha(a);if(u===n.userId&&e.path.isEqual(h))return Ta(t).get(c).next(function(t){if(!t)throw Dr();Lr(t.userId===n.userId),o.push(ma(n.serializer,t))});s.done()}).next(function(){return o})},t.prototype.Mr=function(t,e){var n=this,r=new Ci(ui),i=[];return e.forEach(function(e){var o=Fa.prefixForPath(n.userId,e.path),s=IDBKeyRange.lowerBound(o),u=Aa(t).ss({range:s},function(t,i,o){var s=t[0],u=t[1],a=t[2],c=ha(u);s===n.userId&&e.path.isEqual(c)?r=r.add(a):o.done()});i.push(u)}),yu.xn(i).next(function(){return n.Uo(t,r)})},t.prototype.Qr=function(t,e){var n=this,r=e.path,i=r.length+1,o=Fa.prefixForPath(this.userId,r),s=IDBKeyRange.lowerBound(o),u=new Ci(ui);return Aa(t).ss({range:s},function(t,e,o){var s=t[0],a=t[1],c=t[2],h=ha(a);s===n.userId&&r.T(h)?h.length===i&&(u=u.add(c)):o.done()}).next(function(){return n.Uo(t,u)})},t.prototype.Uo=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(Ta(t).get(e).next(function(t){if(null===t)throw Dr();Lr(t.userId===n.userId),r.push(ma(n.serializer,t))}))}),yu.xn(i).next(function(){return r})},t.prototype.Qo=function(t,e){var n=this;return _a(t.Wo,this.userId,e).next(function(r){return t.Vr(function(){n.jo(e.batchId)}),yu.forEach(r,function(e){return n.Co.Ko(t,e)})})},t.prototype.jo=function(t){delete this.No[t]},t.prototype.Go=function(t){var e=this;return this.xo(t).next(function(n){if(!n)return yu.resolve();var r=IDBKeyRange.lowerBound(Fa.prefixForUser(e.userId)),i=[];return Aa(t).ss({range:r},function(t,n,r){if(t[0]===e.userId){var o=ha(t[1]);i.push(o)}else r.done()}).next(function(){Lr(0===i.length)})})},t.prototype.zo=function(t,e){return Ia(t,this.userId,e)},t.prototype.Ho=function(t){var e=this;return Na(t).get(this.userId).next(function(t){return t||new Ua(e.userId,-1,"")})},t}();function Ia(t,e,n){var r=Fa.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),s=!1;return Aa(t).ss({range:o,ns:!0},function(t,n,r){var o=t[0],u=t[1];t[2],o===e&&u===i&&(s=!0),r.done()}).next(function(){return s})}function _a(t,e,n){var r=t.store(Ma.store),i=t.store(Fa.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.ss({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){Lr(1===u)}));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],p=Fa.key(e,f.key.path,n.batchId);o.push(i.delete(p)),c.push(f.key)}return yu.xn(o).next(function(){return c})}function Ta(t){return sc.Un(t,Ma.store)}function Aa(t){return sc.Un(t,Fa.store)}function Na(t){return sc.Un(t,Ua.store)}var Sa=function(){function t(t,e){this.serializer=t,this.Sr=e}return t.prototype.Tr=function(t,e,n){return Da(t).put(La(e),n)},t.prototype.Ir=function(t,e){var n=Da(t),r=La(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.Yo(t,r)})},t.prototype.Ar=function(t,e){var n=this;return Da(t).get(La(e)).next(function(t){return n.Jo(t)})},t.prototype.Xo=function(t,e){var n=this;return Da(t).get(La(e)).next(function(t){var e=n.Jo(t);return e?{Zo:e,size:Ra(t)}:null})},t.prototype.getEntries=function(t,e){var n=this,r=Fi();return this.ta(t,e,function(t,e){var i=n.Jo(e);r=r.rt(t,i)}).next(function(){return r})},t.prototype.ea=function(t,e){var n=this,r=Fi(),i=new xi(Fr.i);return this.ta(t,e,function(t,e){var o=n.Jo(e);o?(r=r.rt(t,o),i=i.rt(t,Ra(e))):(r=r.rt(t,null),i=i.rt(t,0))}).next(function(){return{na:r,sa:i}})},t.prototype.ta=function(t,e,n){if(e.m())return yu.resolve();var r=IDBKeyRange.bound(e.first().path.A(),e.last().path.A()),i=e.lt(),o=i.Et();return Da(t).ss({range:r},function(t,e,r){for(var s=Fr.$(t);o&&Fr.i(o,s)<0;)n(o,null),o=i.Et();o&&o.isEqual(s)&&(n(o,e),o=i.It()?i.Et():null),o?r.Jn(o.path.A()):r.done()}).next(function(){for(;o;)n(o,null),o=i.It()?i.Et():null})},t.prototype.Or=function(t,e,n){var r=this,i=qi(),o=e.path.length+1,s={};if(n.isEqual(mi.min())){var u=e.path.A();s.range=IDBKeyRange.lowerBound(u)}else{var a=e.path.A(),c=da(n);s.range=IDBKeyRange.lowerBound([a,c],!0),s.index=Ba.collectionReadTimeIndex}return Da(t).ss(s,function(t,n,s){if(t.length===o){var u=fa(r.serializer,n);e.path.T(u.key.path)?u instanceof Rs&&Ys(e,u)&&(i=i.rt(u.key,u)):s.done()}}).next(function(){return i})},t.prototype.ia=function(t,e){var n=this,r=Mi(),i=da(e),o=Da(t),s=IDBKeyRange.lowerBound(i,!0);return o.ss({index:Ba.readTimeIndex,range:s},function(t,e){var o=fa(n.serializer,e);r=r.rt(o.key,o),i=e.readTime}).next(function(){return{ra:r,readTime:va(i)}})},t.prototype.oa=function(t){var e=Da(t),n=mi.min();return e.ss({index:Ba.readTimeIndex,reverse:!0},function(t,e,r){e.readTime&&(n=va(e.readTime)),r.done()}).next(function(){return n})},t.prototype.aa=function(e){return new t.ca(this,!!e&&e.ua)},t.prototype.ha=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},t.prototype.getMetadata=function(t){return Oa(t).get(Ga.key).next(function(t){return Lr(!!t),t})},t.prototype.Yo=function(t,e){return Oa(t).put(Ga.key,e)},t.prototype.Jo=function(t){if(t){var e=fa(this.serializer,t);return e instanceof xs&&e.version.isEqual(mi.min())?null:e}return null},t}();function Oa(t){return sc.Un(t,Ga.store)}function Da(t){return sc.Un(t,Ba.store)}function La(t){return t.path.A()}function Ra(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Dr();e=t.noDocument}return JSON.stringify(e).length}Sa.ca=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).la=e,r.ua=n,r._a=new yi(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),r}return s(e,t),e.prototype.gr=function(t){var e=this,n=[],r=0,i=new Ci(function(t,e){return ui(t.R(),e.R())});return this.dr.forEach(function(o,s){var u=e._a.get(o);if(s){var a=pa(e.la.serializer,s,e.readTime);i=i.add(o.path.h());var c=Ra(a);r+=c-u,n.push(e.la.Tr(t,o,a))}else if(r-=u,e.ua){var h=pa(e.la.serializer,new xs(o,mi.min()),e.readTime);n.push(e.la.Tr(t,o,h))}else n.push(e.la.Ir(t,o))}),i.forEach(function(r){n.push(e.la.Sr.ko(t,r))}),n.push(this.la.updateMetadata(t,r)),yu.xn(n)},e.prototype.Rr=function(t,e){var n=this;return this.la.Xo(t,e).next(function(t){return null===t?(n._a.set(e,0),null):(n._a.set(e,t.size),t.Zo)})},e.prototype.Pr=function(t,e){var n=this;return this.la.ea(t,e).next(function(t){var e=t.na;return t.sa.forEach(function(t,e){n._a.set(t,e)}),e})},e}(Yu);var xa=function(){function t(){this.fa=new Pa}return t.prototype.ko=function(t,e){return this.fa.add(e),yu.resolve()},t.prototype.Ur=function(t,e){return yu.resolve(this.fa.getEntries(e))},t}(),Pa=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t._(),n=t.h(),r=this.index[e]||new Ci(Vr.i),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t._(),n=t.h(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Ci(Vr.i)).A()},t}(),ka=function(){function t(t){this.serializer=t}return t.prototype.createOrUpgrade=function(t,e,n,r){var i=this;Lr(n<r&&n>=0&&r<=10);var o=new Eu(e);n<1&&r>=1&&(function(t){t.createObjectStore(Va.store)}(t),function(t){t.createObjectStore(Ua.store,{keyPath:Ua.keyPath}),t.createObjectStore(Ma.store,{keyPath:Ma.keyPath,autoIncrement:!0}).createIndex(Ma.userMutationsIndex,Ma.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Fa.store)}(t),Qa(t),function(t){t.createObjectStore(Ba.store)}(t));var s=yu.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Ha.store),t.deleteObjectStore(za.store),t.deleteObjectStore($a.store)}(t),Qa(t)),s=s.next(function(){return t=o.store($a.store),e=new $a(0,0,mi.min().X(),0),t.put($a.key,e);var t,e})),n<4&&r>=4&&(0!==n&&(s=s.next(function(){return function(t,e){return e.store(Ma.store).Zn().next(function(n){t.deleteObjectStore(Ma.store),t.createObjectStore(Ma.store,{keyPath:Ma.keyPath,autoIncrement:!0}).createIndex(Ma.userMutationsIndex,Ma.userMutationsKeyPath,{unique:!0});var r=e.store(Ma.store),i=n.map(function(t){return r.put(t)});return yu.xn(i)})}(t,o)})),s=s.next(function(){!function(t){t.createObjectStore(Ka.store,{keyPath:Ka.keyPath})}(t)})),n<5&&r>=5&&(s=s.next(function(){return i.removeAcknowledgedMutations(o)})),n<6&&r>=6&&(s=s.next(function(){return function(t){t.createObjectStore(Ga.store)}(t),i.addDocumentGlobal(o)})),n<7&&r>=7&&(s=s.next(function(){return i.ensureSequenceNumbers(o)})),n<8&&r>=8&&(s=s.next(function(){return i.createCollectionParentIndex(t,o)})),n<9&&r>=9&&(s=s.next(function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(Ba.store);e.createIndex(Ba.readTimeIndex,Ba.readTimeIndexPath,{unique:!1}),e.createIndex(Ba.collectionReadTimeIndex,Ba.collectionReadTimeIndexPath,{unique:!1})}(e)})),n<10&&r>=10&&(s=s.next(function(){return i.rewriteCanonicalIds(o)})),s},t.prototype.addDocumentGlobal=function(t){var e=0;return t.store(Ba.store).ss(function(t,n){e+=Ra(n)}).next(function(){var n=new Ga(e);return t.store(Ga.store).put(Ga.key,n)})},t.prototype.removeAcknowledgedMutations=function(t){var e=this,n=t.store(Ua.store),r=t.store(Ma.store);return n.Zn().next(function(n){return yu.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Zn(Ma.userMutationsIndex,i).next(function(r){return yu.forEach(r,function(r){Lr(r.userId===n.userId);var i=ma(e.serializer,r);return _a(t,n.userId,i).next(function(){})})})})})},t.prototype.ensureSequenceNumbers=function(t){var e=t.store(Ha.store),n=t.store(Ba.store);return t.store($a.store).get($a.key).next(function(t){var r=[];return n.ss(function(n,i){var o=new Vr(n),s=[0,ua(o)];r.push(e.get(s).next(function(n){return n?yu.resolve():function(n){return e.put(new Ha(0,ua(n),t.highestListenSequenceNumber))}(o)}))}).next(function(){return yu.xn(r)})})},t.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(Wa.store,{keyPath:Wa.keyPath});var n=e.store(Wa.store),r=new Pa,i=function(t){if(r.add(t)){var e=t._(),i=t.h();return n.put({collectionId:e,parent:ua(i)})}};return e.store(Ba.store).ss({ns:!0},function(t,e){var n=new Vr(t);return i(n.h())}).next(function(){return e.store(Fa.store).ss({ns:!0},function(t,e){t[0];var n=t[1],r=(t[2],ha(n));return i(r.h())})})},t.prototype.rewriteCanonicalIds=function(t){var e=this,n=t.store(za.store);return n.ss(function(t,r){var i=wa(r),o=ba(e.serializer,i);return n.put(o)})},t}(),Ca=function(t,e){this.seconds=t,this.nanoseconds=e},Va=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Va.store="owner",Va.key="owner";var Ua=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Ua.store="mutationQueues",Ua.keyPath="userId";var Ma=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Ma.store="mutations",Ma.keyPath="batchId",Ma.userMutationsIndex="userMutationsIndex",Ma.userMutationsKeyPath=["userId","batchId"];var Fa=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,ua(e)]},t.key=function(t,e,n){return[t,ua(e),n]},t}();Fa.store="documentMutations",Fa.PLACEHOLDER=new Fa;var ja=function(t,e){this.path=t,this.readTime=e},qa=function(t,e){this.path=t,this.version=e},Ba=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Ba.store="remoteDocuments",Ba.readTimeIndex="readTimeIndex",Ba.readTimeIndexPath="readTime",Ba.collectionReadTimeIndex="collectionReadTimeIndex",Ba.collectionReadTimeIndexPath=["parentPath","readTime"];var Ga=function(t){this.byteSize=t};Ga.store="remoteDocumentGlobal",Ga.key="remoteDocumentGlobalKey";var za=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};za.store="targets",za.keyPath="targetId",za.queryTargetsIndexName="queryTargetsIndex",za.queryTargetsKeyPath=["canonicalId","targetId"];var Ha=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Ha.store="targetDocuments",Ha.keyPath=["targetId","path"],Ha.documentTargetsIndex="documentTargetsIndex",Ha.documentTargetsKeyPath=["path","targetId"];var $a=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};$a.key="targetGlobalKey",$a.store="targetGlobal";var Wa=function(t,e){this.collectionId=t,this.parent=e};function Qa(t){t.createObjectStore(Ha.store,{keyPath:Ha.keyPath}).createIndex(Ha.documentTargetsIndex,Ha.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(za.store,{keyPath:za.keyPath}).createIndex(za.queryTargetsIndexName,za.queryTargetsKeyPath,{unique:!0}),t.createObjectStore($a.store)}Wa.store="collectionParents",Wa.keyPath=["collectionId","parent"];var Ka=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Ka.store="clientMetadata",Ka.keyPath="clientId";var Ya=c(c(c([Ua.store,Ma.store,Fa.store,Ba.store,za.store,Va.store,$a.store,Ha.store],[Ka.store]),[Ga.store]),[Wa.store]),Xa=function(){function t(){this.da=new Pa}return t.prototype.ko=function(t,e){var n=this;if(!this.da.has(e)){var r=e._(),i=e.h();t.Vr(function(){n.da.add(e)});var o={collectionId:r,parent:ua(i)};return Ja(t).put(o)}return yu.resolve()},t.prototype.Ur=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[ci(e),""],!1,!0);return Ja(t).Zn(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(ha(o.parent))}return n})},t}();function Ja(t){return sc.Un(t,Wa.store)}var Za=function(){function t(t){this.wa=t}return t.prototype.next=function(){return this.wa+=2,this.wa},t.ma=function(){return new t(0)},t.Ta=function(){return new t(-1)},t}(),tc=function(){function t(t,e){this.Co=t,this.serializer=e}return t.prototype.Ea=function(t){var e=this;return this.Ia(t).next(function(n){var r=new Za(n.highestTargetId);return n.highestTargetId=r.next(),e.Aa(t,n).next(function(){return n.highestTargetId})})},t.prototype.Ra=function(t){return this.Ia(t).next(function(t){return mi.Y(new gi(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.Pa=function(t){return this.Ia(t).next(function(t){return t.highestListenSequenceNumber})},t.prototype.ga=function(t,e,n){var r=this;return this.Ia(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.X()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Aa(t,i)})},t.prototype.ya=function(t,e){var n=this;return this.Va(t,e).next(function(){return n.Ia(t).next(function(r){return r.targetCount+=1,n.pa(e,r),n.Aa(t,r)})})},t.prototype.ba=function(t,e){return this.Va(t,e)},t.prototype.va=function(t,e){var n=this;return this.Sa(t,e.targetId).next(function(){return ec(t).delete(e.targetId)}).next(function(){return n.Ia(t)}).next(function(e){return Lr(e.targetCount>0),e.targetCount-=1,n.Aa(t,e)})},t.prototype.Vo=function(t,e,n){var r=this,i=0,o=[];return ec(t).ss(function(s,u){var a=wa(u);a.sequenceNumber<=e&&null===n.get(a.targetId)&&(i++,o.push(r.va(t,a)))}).next(function(){return yu.xn(o)}).next(function(){return i})},t.prototype.De=function(t,e){return ec(t).ss(function(t,n){var r=wa(n);e(r)})},t.prototype.Ia=function(t){return nc(t).get($a.key).next(function(t){return Lr(null!==t),t})},t.prototype.Aa=function(t,e){return nc(t).put($a.key,e)},t.prototype.Va=function(t,e){return ec(t).put(ba(this.serializer,e))},t.prototype.pa=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.Da=function(t){return this.Ia(t).next(function(t){return t.targetCount})},t.prototype.Ca=function(t,e){var n=Ti(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return ec(t).ss({range:r,index:za.queryTargetsIndexName},function(t,n,r){var o=wa(n);Ai(e,o.target)&&(i=o,r.done())}).next(function(){return i})},t.prototype.Na=function(t,e,n){var r=this,i=[],o=rc(t);return e.forEach(function(e){var s=ua(e.path);i.push(o.put(new Ha(n,s))),i.push(r.Co.Fa(t,n,e))}),yu.xn(i)},t.prototype.xa=function(t,e,n){var r=this,i=rc(t);return yu.forEach(e,function(e){var o=ua(e.path);return yu.xn([i.delete([n,o]),r.Co.$a(t,n,e)])})},t.prototype.Sa=function(t,e){var n=rc(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.ka=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=rc(t),i=zi();return r.ss({range:n,ns:!0},function(t,e,n){var r=ha(t[1]),o=new Fr(r);i=i.add(o)}).next(function(){return i})},t.prototype.zo=function(t,e){var n=ua(e.path),r=IDBKeyRange.bound([n],[ci(n)],!1,!0),i=0;return rc(t).ss({index:Ha.documentTargetsIndex,ns:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return i>0})},t.prototype.qe=function(t,e){return ec(t).get(e).next(function(t){return t?wa(t):null})},t}();function ec(t){return sc.Un(t,za.store)}function nc(t){return sc.Un(t,$a.store)}function rc(t){return sc.Un(t,Ha.store)}var ic="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",oc=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Wo=e,r.Ma=n,r}return s(e,t),e}(Ju),sc=function(){function t(e,n,r,i,o,s,u,a,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this._n=o,this.window=s,this.document=u,this.Oa=c,this.La=h,this.Ba=null,this.qa=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ua=null,this.inForeground=!1,this.Qa=null,this.Wa=null,this.ja=Number.NEGATIVE_INFINITY,this.Ka=function(t){return Promise.resolve()},!t.On())throw new Ir(Er.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Co=new cc(this,i),this.Ga=n+"main",this.serializer=new la(a),this.za=new gu(this.Ga,10,new ka(this.serializer)),this.Ha=new tc(this.Co,this.serializer),this.Sr=new Xa,this.br=new Sa(this.serializer,this.Sr),this.window&&this.window.localStorage?this.Ya=this.window.localStorage:(this.Ya=null,!1===h&&Nr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.Un=function(t,e){if(t instanceof oc)return gu.Un(t.Wo,e);throw Dr()},t.prototype.start=function(){var t=this;return this.Ja().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Ir(Er.FAILED_PRECONDITION,ic);return t.Xa(),t.Za(),t.tc(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(e){return t.Ha.Pa(e)})}).then(function(e){t.Ba=new Uu(e,t.Oa)}).then(function(){t.qa=!0}).catch(function(e){return t.za&&t.za.close(),Promise.reject(e)})},t.prototype.ec=function(t){var e=this;return this.Ka=function(n){return u(e,void 0,void 0,function(){return a(this,function(e){return this.Ti?[2,t(n)]:[2]})})},t(this.isPrimary)},t.prototype.nc=function(t){var e=this;this.za.jn(function(n){return u(e,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},t.prototype.sc=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this._n.ds(function(){return u(e,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return this.Ti?[4,this.Ja()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},t.prototype.Ja=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return ac(e).put(new Ka(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.ic(e).next(function(e){e||(t.isPrimary=!1,t._n.Ds(function(){return t.Ka(!1)}))})}).next(function(){return t.rc(e)}).next(function(n){return t.isPrimary&&!n?t.oc(e).next(function(){return!1}):!!n&&t.ac(e).next(function(){return!0})})}).catch(function(e){if(bu(e))return Ar("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return Ar("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(function(e){t.isPrimary!==e&&t._n.Ds(function(){return t.Ka(e)}),t.isPrimary=e})},t.prototype.ic=function(t){var e=this;return uc(t).get(Va.key).next(function(t){return yu.resolve(e.cc(t))})},t.prototype.uc=function(t){return ac(t).delete(this.clientId)},t.prototype.hc=function(){return u(this,void 0,void 0,function(){var e,n,r,i,o=this;return a(this,function(s){switch(s.label){case 0:return!this.isPrimary||this.lc(this.ja,18e5)?[3,2]:(this.ja=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(e){var n=t.Un(e,Ka.store);return n.Zn().next(function(t){var e=o._c(t,18e5),r=t.filter(function(t){return-1===e.indexOf(t)});return yu.forEach(r,function(t){return n.delete(t.clientId)}).next(function(){return r})})}).catch(function(){return[]})]);case 1:if(e=s.sent(),this.Ya)for(n=0,r=e;n<r.length;n++)i=r[n],this.Ya.removeItem(this.fc(i.clientId));s.label=2;case 2:return[2]}})})},t.prototype.tc=function(){var t=this;this.Wa=this._n.gn("client_metadata_refresh",4e3,function(){return t.Ja().then(function(){return t.hc()}).then(function(){return t.tc()})})},t.prototype.cc=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.rc=function(t){var e=this;return this.La?yu.resolve(!0):uc(t).get(Va.key).next(function(n){if(null!==n&&e.lc(n.leaseTimestampMs,5e3)&&!e.dc(n.ownerId)){if(e.cc(n)&&e.networkEnabled)return!0;if(!e.cc(n)){if(!n.allowTabSynchronization)throw new Ir(Er.FAILED_PRECONDITION,ic);return!1}}return!(!e.networkEnabled||!e.inForeground)||ac(t).Zn().next(function(t){return void 0===e._c(t,5e3).find(function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1})})}).next(function(t){return e.isPrimary!==t&&Ar("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},t.prototype.Si=function(){return u(this,void 0,void 0,function(){var t=this;return a(this,function(e){switch(e.label){case 0:return this.qa=!1,this.wc(),this.Wa&&(this.Wa.cancel(),this.Wa=null),this.mc(),this.Tc(),[4,this.za.runTransaction("readwrite",[Va.store,Ka.store],function(e){var n=new oc(e,Uu.oi);return t.oc(n).next(function(){return t.uc(n)})})];case 1:return e.sent(),this.za.close(),this.Ec(),[2]}})})},t.prototype._c=function(t,e){var n=this;return t.filter(function(t){return n.lc(t.updateTimeMs,e)&&!n.dc(t.clientId)})},t.prototype.Vi=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(e){return ac(e).Zn().next(function(e){return t._c(e,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(t.prototype,"Ti",{get:function(){return this.qa},enumerable:!1,configurable:!0}),t.prototype.Ic=function(t){return Ea.Fo(t,this.serializer,this.Sr,this.Co)},t.prototype.Ac=function(){return this.Ha},t.prototype.Rc=function(){return this.br},t.prototype.Pc=function(){return this.Sr},t.prototype.runTransaction=function(t,e,n){var r=this;Ar("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.za.runTransaction(o,Ya,function(o){return i=new oc(o,r.Ba?r.Ba.next():Uu.oi),"readwrite-primary"===e?r.ic(i).next(function(t){return!!t||r.rc(i)}).next(function(e){if(!e)throw Nr("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r._n.Ds(function(){return r.Ka(!1)}),new Ir(Er.FAILED_PRECONDITION,Xu);return n(i)}).next(function(t){return r.ac(i).next(function(){return t})}):r.gc(i).next(function(){return n(i)})}).then(function(t){return i.pr(),t})},t.prototype.gc=function(t){var e=this;return uc(t).get(Va.key).next(function(t){if(null!==t&&e.lc(t.leaseTimestampMs,5e3)&&!e.dc(t.ownerId)&&!e.cc(t)&&!(e.La||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Ir(Er.FAILED_PRECONDITION,ic)})},t.prototype.ac=function(t){var e=new Va(this.clientId,this.allowTabSynchronization,Date.now());return uc(t).put(Va.key,e)},t.On=function(){return gu.On()},t.prototype.oc=function(t){var e=this,n=uc(t);return n.get(Va.key).next(function(t){return e.cc(t)?(Ar("IndexedDbPersistence","Releasing primary lease."),n.delete(Va.key)):yu.resolve()})},t.prototype.lc=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(Nr("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.Xa=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Qa=function(){t._n.ds(function(){return t.inForeground="visible"===t.document.visibilityState,t.Ja()})},this.document.addEventListener("visibilitychange",this.Qa),this.inForeground="visible"===this.document.visibilityState)},t.prototype.mc=function(){this.Qa&&(this.document.removeEventListener("visibilitychange",this.Qa),this.Qa=null)},t.prototype.Za=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Ua=function(){e.wc(),e._n.ds(function(){return e.Si()})},this.window.addEventListener("unload",this.Ua))},t.prototype.Tc=function(){this.Ua&&(this.window.removeEventListener("unload",this.Ua),this.Ua=null)},t.prototype.dc=function(t){var e;try{var n=null!==(null===(e=this.Ya)||void 0===e?void 0:e.getItem(this.fc(t)));return Ar("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Nr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.wc=function(){if(this.Ya)try{this.Ya.setItem(this.fc(this.clientId),String(Date.now()))}catch(t){Nr("Failed to set zombie client id.",t)}},t.prototype.Ec=function(){if(this.Ya)try{this.Ya.removeItem(this.fc(this.clientId))}catch(t){}},t.prototype.fc=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function uc(t){return sc.Un(t,Va.store)}function ac(t){return sc.Un(t,Ka.store)}var cc=function(){function t(t,e){this.db=t,this.do=new sa(this,e)}return t.prototype.Ro=function(t){var e=this.yc(t);return this.db.Ac().Da(t).next(function(t){return e.next(function(e){return t+e})})},t.prototype.yc=function(t){var e=0;return this.yo(t,function(t){e++}).next(function(){return e})},t.prototype.De=function(t,e){return this.db.Ac().De(t,e)},t.prototype.yo=function(t,e){return this.Vc(t,function(t,n){return e(n)})},t.prototype.Fa=function(t,e,n){return hc(t,n)},t.prototype.$a=function(t,e,n){return hc(t,n)},t.prototype.Vo=function(t,e,n){return this.db.Ac().Vo(t,e,n)},t.prototype.Ko=function(t,e){return hc(t,e)},t.prototype.bc=function(t,e){return function(t,e){var n=!1;return Na(t).rs(function(r){return Ia(t,r,e).next(function(t){return t&&(n=!0),yu.resolve(!t)})}).next(function(){return n})}(t,e)},t.prototype.po=function(t,e){var n=this,r=this.db.Rc().aa(),i=[],o=0;return this.Vc(t,function(s,u){if(u<=e){var a=n.bc(t,s).next(function(e){if(!e)return o++,r.Ar(t,s).next(function(){return r.Ir(s),rc(t).delete([0,ua(s.path)])})});i.push(a)}}).next(function(){return yu.xn(i)}).next(function(){return r.apply(t)}).next(function(){return o})},t.prototype.removeTarget=function(t,e){var n=e.nt(t.Ma);return this.db.Ac().ba(t,n)},t.prototype.vc=function(t,e){return hc(t,e)},t.prototype.Vc=function(t,e){var n,r=rc(t),i=Uu.oi;return r.ss({index:Ha.documentTargetsIndex},function(t,r){var o=t[0],s=(t[1],r.path),u=r.sequenceNumber;0===o?(i!==Uu.oi&&e(new Fr(ha(n)),i),i=u,n=s):i=Uu.oi}).next(function(){i!==Uu.oi&&e(new Fr(ha(n)),i)})},t.prototype.vo=function(t){return this.db.Rc().ha(t)},t}();function hc(t,e){return rc(t).put(function(t,e){return new Ha(0,ua(t.path),e)}(e,t.Ma))}function lc(t,e){var n=t.projectId;return t.W||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var fc=function(){function t(t,e,n){this.persistence=t,this.Sc=e,this.Dc=new xi(ui),this.Cc=new yi(function(t){return Ti(t)},Ai),this.Nc=mi.min(),this.vr=t.Ic(n),this.Fc=t.Rc(),this.Ha=t.Ac(),this.xc=new Zu(this.Fc,this.vr,this.persistence.Pc()),this.Sc.$c(this.xc)}return t.prototype.Eo=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.bo(n,e.Dc)})},t}();function pc(t){var e=Rr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Ha.Ra(t)})}function dc(t,e){var n=Rr(t);return n.persistence.runTransaction("Allocate target","readwrite",function(t){var r;return n.Ha.Ca(t,e).next(function(i){return i?(r=i,yu.resolve(r)):n.Ha.Ea(t).next(function(i){return r=new Di(e,i,0,t.Ma),n.Ha.ya(t,r).next(function(){return r})})})}).then(function(t){var r=n.Dc.get(t.targetId);return(null===r||t.et.L(r.et)>0)&&(n.Dc=n.Dc.rt(t.targetId,t),n.Cc.set(e,t.targetId)),t})}function vc(t,e,n){return u(this,void 0,void 0,function(){var r,i,o,s;return a(this,function(u){switch(u.label){case 0:r=Rr(t),i=r.Dc.get(e),o=n?"readwrite":"readwrite-primary",u.label=1;case 1:return u.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,function(t){return r.persistence.Co.removeTarget(t,i)})];case 2:u.sent(),u.label=3;case 3:return[3,5];case 4:if(!bu(s=u.sent()))throw s;return Ar("LocalStore","Failed to update sequence numbers for target "+e+": "+s),[3,5];case 5:return r.Dc=r.Dc.remove(e),r.Cc.delete(i.target),[2]}})})}function yc(t,e,n){var r=Rr(t),i=mi.min(),o=zi();return r.persistence.runTransaction("Execute query","readonly",function(t){return function(t,e,n){var r=Rr(t),i=r.Cc.get(n);return void 0!==i?yu.resolve(r.Dc.get(i)):r.Ha.Ca(e,n)}(r,t,Gs(e)).next(function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.Ha.ka(t,e.targetId).next(function(t){o=t})}).next(function(){return r.Sc.Or(t,e,n?i:mi.min(),n?o:zi())}).next(function(t){return{documents:t,kc:o}})})}function gc(t,e){var n=Rr(t),r=Rr(n.Ha),i=n.Dc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.qe(t,e).next(function(t){return t?t.target:null})})}function mc(t){return u(this,void 0,void 0,function(){return a(this,function(e){if(t.code!==Er.FAILED_PRECONDITION||t.message!==Xu)throw t;return Ar("LocalStore","Unexpectedly lost primary lease"),[2]})})}var wc=function(){function t(){this.Mc=new Ci(bc.Oc),this.Lc=new Ci(bc.Bc)}return t.prototype.m=function(){return this.Mc.m()},t.prototype.Fa=function(t,e){var n=new bc(t,e);this.Mc=this.Mc.add(n),this.Lc=this.Lc.add(n)},t.prototype.qc=function(t,e){var n=this;t.forEach(function(t){return n.Fa(t,e)})},t.prototype.$a=function(t,e){this.Uc(new bc(t,e))},t.prototype.Qc=function(t,e){var n=this;t.forEach(function(t){return n.$a(t,e)})},t.prototype.Wc=function(t){var e=this,n=new Fr(new Vr([])),r=new bc(n,t),i=new bc(n,t+1),o=[];return this.Lc.Nt([r,i],function(t){e.Uc(t),o.push(t.key)}),o},t.prototype.jc=function(){var t=this;this.Mc.forEach(function(e){return t.Uc(e)})},t.prototype.Uc=function(t){this.Mc=this.Mc.delete(t),this.Lc=this.Lc.delete(t)},t.prototype.Kc=function(t){var e=new Fr(new Vr([])),n=new bc(e,t),r=new bc(e,t+1),i=zi();return this.Lc.Nt([n,r],function(t){i=i.add(t.key)}),i},t.prototype.zo=function(t){var e=new bc(t,0),n=this.Mc.xt(e);return null!==n&&t.isEqual(n.key)},t}(),bc=function(){function t(t,e){this.key=t,this.Gc=e}return t.Oc=function(t,e){return Fr.i(t.key,e.key)||ui(t.Gc,e.Gc)},t.Bc=function(t,e){return ui(t.Gc,e.Gc)||Fr.i(t.key,e.key)},t}(),Ec=function(){function t(){this.Hc=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.Yc=function(){},t.prototype.Jc=function(t){this.Hc=t,t(Vu.UNAUTHENTICATED)},t.prototype.Xc=function(){this.Hc=null},t}(),Ic=function(){function t(t){var e=this;this.Zc=null,this.currentUser=Vu.UNAUTHENTICATED,this.tu=!1,this.eu=0,this.Hc=null,this.forceRefresh=!1,this.Zc=function(){e.eu++,e.currentUser=e.nu(),e.tu=!0,e.Hc&&e.Hc(e.currentUser)},this.eu=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Zc):(this.Zc(null),t.get().then(function(t){e.auth=t,e.Zc&&e.auth.addAuthTokenListener(e.Zc)},function(){}))}return t.prototype.getToken=function(){var t=this,e=this.eu,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return t.eu!==e?(Ar("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Lr("string"==typeof n.accessToken),new function(t,e){this.user=e,this.type="OAuth",this.zc={},this.zc.Authorization="Bearer "+t}(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},t.prototype.Yc=function(){this.forceRefresh=!0},t.prototype.Jc=function(t){this.Hc=t,this.tu&&t(this.currentUser)},t.prototype.Xc=function(){this.auth&&this.auth.removeAuthTokenListener(this.Zc),this.Zc=null,this.Hc=null},t.prototype.nu=function(){var t=this.auth&&this.auth.getUid();return Lr(null===t||"string"==typeof t),new Vu(t)},t}(),_c=function(){function t(t,e){this.su=t,this.iu=e,this.type="FirstParty",this.user=Vu.ei}return Object.defineProperty(t.prototype,"zc",{get:function(){var t={"X-Goog-AuthUser":this.iu},e=this.su.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),t}(),Tc=function(){function t(t,e){this.su=t,this.iu=e}return t.prototype.getToken=function(){return Promise.resolve(new _c(this.su,this.iu))},t.prototype.Jc=function(t){t(Vu.ei)},t.prototype.Xc=function(){},t.prototype.Yc=function(){},t}(),Ac=function(){function t(t,e,n,r,i,o){this._n=t,this.ru=n,this.ou=r,this.au=i,this.listener=o,this.state=0,this.cu=0,this.uu=null,this.stream=null,this.gs=new vu(t,e)}return t.prototype.hu=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.lu=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this._u()},t.prototype.stop=function(){return u(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return this.hu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.fu=function(){this.state=0,this.gs.reset()},t.prototype.du=function(){var t=this;this.lu()&&null===this.uu&&(this.uu=this._n.gn(this.ru,6e4,function(){return t.wu()}))},t.prototype.mu=function(t){this.Tu(),this.stream.send(t)},t.prototype.wu=function(){return u(this,void 0,void 0,function(){return a(this,function(t){return this.lu()?[2,this.close(0)]:[2]})})},t.prototype.Tu=function(){this.uu&&(this.uu.cancel(),this.uu=null)},t.prototype.close=function(t,e){return u(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return this.Tu(),this.gs.cancel(),this.cu++,3!==t?this.gs.reset():e&&e.code===Er.RESOURCE_EXHAUSTED?(Nr(e.toString()),Nr("Using maximum backoff delay to prevent overloading the backend."),this.gs.An()):e&&e.code===Er.UNAUTHENTICATED&&this.au.Yc(),null!==this.stream&&(this.Eu(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Iu(e)];case 1:return n.sent(),[2]}})})},t.prototype.Eu=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.Au(this.cu),n=this.cu;this.au.getToken().then(function(e){t.cu===n&&t.Ru(e)},function(n){e(function(){var e=new Ir(Er.UNKNOWN,"Fetching auth token failed: "+n.message);return t.Pu(e)})})},t.prototype.Ru=function(t){var e=this,n=this.Au(this.cu);this.stream=this.gu(t),this.stream.yu(function(){n(function(){return e.state=2,e.listener.yu()})}),this.stream.Iu(function(t){n(function(){return e.Pu(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},t.prototype._u=function(){var t=this;this.state=4,this.gs.Rn(function(){return u(t,void 0,void 0,function(){return a(this,function(t){return this.state=0,this.start(),[2]})})})},t.prototype.Pu=function(t){return Ar("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.Au=function(t){var e=this;return function(n){e._n.ds(function(){return e.cu===t?n():(Ar("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),Nc=function(t){function e(e,n,r,i,o){var s;return(s=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).serializer=i,s}return s(e,t),e.prototype.gu=function(t){return this.ou.Vu("Listen",t)},e.prototype.onMessage=function(t){this.gs.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Dr()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.Ue?(Lr(void 0===e||"string"==typeof e),hi.fromBase64String(e||"")):(Lr(void 0===e||e instanceof Uint8Array),hi.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,u=s&&function(t){var e=void 0===t.code?Er.UNKNOWN:Ri(t.code);return new Ir(e,t.message||"")}(s);n=new to(r,i,o,u||null)}else if("documentChange"in e){e.documentChange;var a=e.documentChange;a.document,a.document.name,a.document.updateTime;var c=Vo(t,a.document.name),h=xo(a.document.updateTime),l=new Ss({mapValue:{fields:a.document.fields}}),f=new Rs(c,h,l,{}),p=a.targetIds||[],d=a.removedTargetIds||[];n=new Ji(p,d,f.key,f)}else if("documentDelete"in e){e.documentDelete;var v=e.documentDelete;v.document;var y=Vo(t,v.document),g=v.readTime?xo(v.readTime):mi.min(),m=new xs(y,g),w=v.removedTargetIds||[];n=new Ji([],w,m.key,m)}else if("documentRemove"in e){e.documentRemove;var b=e.documentRemove;b.document;var E=Vo(t,b.document),I=b.removedTargetIds||[];n=new Ji([],I,E,null)}else{if(!("filter"in e))return Dr();e.filter;var _=e.filter;_.targetId;var T=new function(t){this.count=t}(_.count||0),A=_.targetId;n=new Zi(A,T)}return n}(this.serializer,t),n=function(t){if(!("targetChange"in t))return mi.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?mi.min():e.readTime?xo(e.readTime):mi.min()}(t);return this.listener.pu(e,n)},e.prototype.bu=function(t){var e={};e.database=Fo(this.serializer),e.addTarget=function(t,e){var n,r=e.target;return(n=Ni(r)?{documents:zo(t,r)}:{query:Ho(t,r)}).targetId=e.targetId,e.resumeToken.O()>0&&(n.resumeToken=Ro(t,e.resumeToken)),n}(this.serializer,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Dr()}}(0,e.tt);return null==n?null:{"goog-listen-tags":n}}(this.serializer,t);n&&(e.labels=n),this.mu(e)},e.prototype.vu=function(t){var e={};e.database=Fo(this.serializer),e.removeTarget=t,this.mu(e)},e}(Ac),Sc=function(t){function e(e,n,r,i,o){var s=this;return(s=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).serializer=i,s.Su=!1,s}return s(e,t),Object.defineProperty(e.prototype,"Du",{get:function(){return this.Su},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.Su=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.Eu=function(){this.Su&&this.Cu([])},e.prototype.gu=function(t){return this.ou.Vu("Write",t)},e.prototype.onMessage=function(t){if(Lr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Su){this.gs.reset();var e=function(t,e){return t&&t.length>0?(Lr(void 0!==e),t.map(function(t){return function(t,e){var n=t.updateTime?xo(t.updateTime):xo(e);n.isEqual(mi.min())&&(n=xo(e));var r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults),new function(t,e){this.version=t,this.transformResults=e}(n,r)}(t,e)})):[]}(t.writeResults,t.commitTime),n=xo(t.commitTime);return this.listener.Nu(n,e)}return Lr(!t.writeResults||0===t.writeResults.length),this.Su=!0,this.listener.Fu()},e.prototype.xu=function(){var t={};t.database=Fo(this.serializer),this.mu(t)},e.prototype.Cu=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Bo(e.serializer,t)})};this.mu(n)},e}(Ac),Oc=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.ou=n,i.serializer=r,i.$u=!1,i}return s(e,t),e.prototype.ku=function(){if(this.$u)throw new Ir(Er.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Mu=function(t,e,n){var r=this;return this.ku(),this.credentials.getToken().then(function(i){return r.ou.Mu(t,e,n,i)}).catch(function(t){throw t.code===Er.UNAUTHENTICATED&&r.credentials.Yc(),t})},e.prototype.Ou=function(t,e,n){var r=this;return this.ku(),this.credentials.getToken().then(function(i){return r.ou.Ou(t,e,n,i)}).catch(function(t){throw t.code===Er.UNAUTHENTICATED&&r.credentials.Yc(),t})},e.prototype.terminate=function(){this.$u=!1},e}(function(){}),Dc=function(){function t(t,e){this.os=t,this.fi=e,this.state="Unknown",this.Lu=0,this.Bu=null,this.qu=!0}return t.prototype.Uu=function(){var t=this;0===this.Lu&&(this.Qu("Unknown"),this.Bu=this.os.gn("online_state_timeout",1e4,function(){return t.Bu=null,t.Wu("Backend didn't respond within 10 seconds."),t.Qu("Offline"),Promise.resolve()}))},t.prototype.ju=function(t){"Online"===this.state?this.Qu("Unknown"):(this.Lu++,this.Lu>=1&&(this.Ku(),this.Wu("Connection failed 1 times. Most recent error: "+t.toString()),this.Qu("Offline")))},t.prototype.set=function(t){this.Ku(),this.Lu=0,"Online"===t&&(this.qu=!1),this.Qu(t)},t.prototype.Qu=function(t){t!==this.state&&(this.state=t,this.fi(t))},t.prototype.Wu=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.qu?(Nr(e),this.qu=!1):Ar("OnlineStateTracker",e)},t.prototype.Ku=function(){null!==this.Bu&&(this.Bu.cancel(),this.Bu=null)},t}();function Lc(t){return u(this,void 0,void 0,function(){var e,n;return a(this,function(r){switch(r.label){case 0:if(!Fc(t))return[3,4];e=0,n=t.Zu,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Rc(t){return u(this,void 0,void 0,function(){var e,n;return a(this,function(r){switch(r.label){case 0:e=0,n=t.Zu,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function xc(t){return u(this,void 0,void 0,function(){var e;return a(this,function(n){switch(n.label){case 0:return e=Rr(t),Ar("RemoteStore","RemoteStore shutting down."),e.Xu.add(5),[4,Rc(e)];case 1:return n.sent(),e.th.Si(),e.nh.set("Unknown"),[2]}})})}function Pc(t,e){var n=Rr(t);n.Ju.has(e.targetId)||(n.Ju.set(e.targetId,e),Mc(n)?Uc(n):Wc(n).lu()&&Cc(n,e))}function kc(t,e){var n=Rr(t),r=Wc(n);n.Ju.delete(e),r.lu()&&Vc(n,e),0===n.Ju.size&&(r.lu()?r.du():Fc(n)&&n.nh.set("Unknown"))}function Cc(t,e){t.sh.Ee(e.targetId),Wc(t).bu(e)}function Vc(t,e){t.sh.Ee(e),Wc(t).vu(e)}function Uc(t){t.sh=new no({Be:function(e){return t.Hu.Be(e)},qe:function(e){return t.Ju.get(e)||null}}),Wc(t).start(),t.nh.Uu()}function Mc(t){return Fc(t)&&!Wc(t).hu()&&t.Ju.size>0}function Fc(t){return 0===Rr(t).Xu.size}function jc(t){t.sh=void 0}function qc(t,e,n){return u(this,void 0,void 0,function(){var r=this;return a(this,function(i){switch(i.label){case 0:if(!bu(e))throw e;return t.Xu.add(1),[4,Rc(t)];case 1:return i.sent(),t.nh.set("Offline"),n||(n=function(){return pc(t.Gu)}),t.os.Ds(function(){return u(r,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return Ar("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Xu.delete(1),[4,Lc(t)];case 2:return e.sent(),[2]}})})}),[2]}})})}function Bc(t,e){return e().catch(function(n){return qc(t,n,e)})}function Gc(t){return u(this,void 0,void 0,function(){var e,n,r,i,o;return a(this,function(s){switch(s.label){case 0:e=Rr(t),n=Qc(e),r=e.Yu.length>0?e.Yu[e.Yu.length-1].batchId:-1,s.label=1;case 1:if(!function(t){return Fc(t)&&t.Yu.length<10}(e))return[3,7];s.label=2;case 2:return s.trys.push([2,4,,6]),[4,function(t,e){var n=Rr(t);return n.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.vr.Lo(t,e)})}(e.Gu,r)];case 3:return null===(i=s.sent())?(0===e.Yu.length&&n.du(),[3,7]):(r=i.batchId,function(t,e){t.Yu.push(e);var n=Qc(t);n.lu()&&n.Du&&n.Cu(e.mutations)}(e,i),[3,6]);case 4:return o=s.sent(),[4,qc(e,o)];case 5:return s.sent(),[3,6];case 6:return[3,1];case 7:return zc(e)&&Hc(e),[2]}})})}function zc(t){return Fc(t)&&!Qc(t).hu()&&t.Yu.length>0}function Hc(t){Qc(t).start()}function $c(t,e){return u(this,void 0,void 0,function(){var n;return a(this,function(r){switch(r.label){case 0:return n=Rr(t),e?(n.Xu.delete(2),[4,Lc(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Xu.add(2),[4,Rc(n)]);case 3:r.sent(),n.nh.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function Wc(t){var e=this;return t.uh||(t.uh=function(t,e,n){var r=Rr(t);return r.ku(),new Nc(e,r.ou,r.credentials,r.serializer,n)}(t.zu,t.os,{yu:function(t){return u(this,void 0,void 0,function(){return a(this,function(e){return t.Ju.forEach(function(e,n){Cc(t,e)}),[2]})})}.bind(null,t),Iu:function(t,e){return u(this,void 0,void 0,function(){return a(this,function(n){return jc(t),Mc(t)?(t.nh.ju(e),Uc(t)):t.nh.set("Unknown"),[2]})})}.bind(null,t),pu:function(t,e,n){return u(this,void 0,void 0,function(){var r,i,o;return a(this,function(s){switch(s.label){case 0:if(t.nh.set("Online"),!(e instanceof to&&2===e.state&&e.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(t,e){return u(this,void 0,void 0,function(){var n,r,i,o;return a(this,function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?(o=i[r],t.Ju.has(o)?[4,t.Hu.ih(o,n)]:[3,3]):[3,5];case 2:s.sent(),t.Ju.delete(o),t.sh.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}})})}(t,e)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),Ar("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,qc(t,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof Ji?t.sh.pe(e):e instanceof Zi?t.sh.xe(e):t.sh.Se(e),n.isEqual(mi.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,pc(t.Gu)];case 8:return i=s.sent(),n.L(i)>=0?[4,function(t,e){var n=t.sh.Me(e);return n.Gt.forEach(function(n,r){if(n.resumeToken.O()>0){var i=t.Ju.get(r);i&&t.Ju.set(r,i.st(n.resumeToken,e))}}),n.zt.forEach(function(e){var n=t.Ju.get(e);if(n){t.Ju.set(e,n.st(hi.B,n.et)),Vc(t,e);var r=new Di(n.target,e,1,n.sequenceNumber);Cc(t,r)}}),t.Hu.rh(n)}(t,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return Ar("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,qc(t,o)];case 12:return s.sent(),[3,13];case 13:return[2]}})})}.bind(null,t)}),t.Zu.push(function(n){return u(e,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return n?(t.uh.fu(),Mc(t)?Uc(t):t.nh.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.uh.stop()];case 2:e.sent(),jc(t),e.label=3;case 3:return[2]}})})})),t.uh}function Qc(t){var e=this;return t.hh||(t.hh=function(t,e,n){var r=Rr(t);return r.ku(),new Sc(e,r.ou,r.credentials,r.serializer,n)}(t.zu,t.os,{yu:function(t){return u(this,void 0,void 0,function(){return a(this,function(e){return Qc(t).xu(),[2]})})}.bind(null,t),Iu:function(t,e){return u(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return e&&Qc(t).Du?[4,function(t,e){return u(this,void 0,void 0,function(){var n,r;return a(this,function(i){switch(i.label){case 0:return Li(r=e.code)&&r!==Er.ABORTED?(n=t.Yu.shift(),Qc(t).fu(),[4,Bc(t,function(){return t.Hu.ah(n.batchId,e)})]):[3,3];case 1:return i.sent(),[4,Gc(t)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return zc(t)&&Hc(t),[2]}})})}.bind(null,t),Fu:function(t){return u(this,void 0,void 0,function(){var e,n,r,i;return a(this,function(o){for(e=Qc(t),n=0,r=t.Yu;n<r.length;n++)i=r[n],e.Cu(i.mutations);return[2]})})}.bind(null,t),Nu:function(t,e,n){return u(this,void 0,void 0,function(){var r,i;return a(this,function(o){switch(o.label){case 0:return r=t.Yu.shift(),i=Ku.from(r,e,n),[4,Bc(t,function(){return t.Hu.oh(i)})];case 1:return o.sent(),[4,Gc(t)];case 2:return o.sent(),[2]}})})}.bind(null,t)}),t.Zu.push(function(n){return u(e,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return n?(t.hh.fu(),[4,Gc(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.hh.stop()];case 3:e.sent(),t.Yu.length>0&&(Ar("RemoteStore","Stopping write stream with "+t.Yu.length+" pending writes"),t.Yu=[]),e.label=4;case 4:return[2]}})})})),t.hh}var Kc=function(t){this.key=t},Yc=function(t){this.key=t},Xc=function(){function t(t,e){this.query=t,this.lh=e,this._h=null,this.Zt=!1,this.fh=zi(),this.Qt=zi(),this.dh=Xs(t),this.wh=new Wi(this.dh)}return Object.defineProperty(t.prototype,"mh",{get:function(){return this.lh},enumerable:!1,configurable:!0}),t.prototype.Th=function(t,e){var n=this,r=e?e.Eh:new Qi,i=e?e.wh:this.wh,o=e?e.Qt:this.Qt,s=i,u=!1,a=Us(this.query)&&i.size===this.query.limit?i.last():null,c=Ms(this.query)&&i.size===this.query.limit?i.first():null;if(t.ut(function(t,e){var h=i.get(t),l=e instanceof Rs?e:null;l&&(l=Ys(n.query,l)?l:null);var f=!!h&&n.Qt.has(h.key),p=!!l&&(l.Ye||n.Qt.has(l.key)&&l.hasCommittedMutations),d=!1;h&&l?h.data().isEqual(l.data())?f!==p&&(r.track({type:3,doc:l}),d=!0):n.Ih(h,l)||(r.track({type:2,doc:l}),d=!0,(a&&n.dh(l,a)>0||c&&n.dh(l,c)<0)&&(u=!0)):!h&&l?(r.track({type:0,doc:l}),d=!0):h&&!l&&(r.track({type:1,doc:h}),d=!0,(a||c)&&(u=!0)),d&&(l?(s=s.add(l),o=p?o.add(t):o.delete(t)):(s=s.delete(t),o=o.delete(t)))}),Us(this.query)||Ms(this.query))for(;s.size>this.query.limit;){var h=Us(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{wh:s,Eh:r,Ah:u,Qt:o}},t.prototype.Ih=function(t,e){return t.Ye&&e.hasCommittedMutations&&!e.Ye},t.prototype.gr=function(t,e,n){var r=this,i=this.wh;this.wh=t.wh,this.Qt=t.Qt;var o=t.Eh.qt();o.sort(function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Dr()}};return n(t)-n(e)}(t.type,e.type)||r.dh(t.doc,e.doc)}),this.Rh(n);var s=e?this.Ph():[],u=0===this.fh.size&&this.Zt?1:0,a=u!==this._h;return this._h=u,0!==o.length||a?{snapshot:new Ki(this.query,t.wh,i,o,t.Qt,0===u,a,!1),gh:s}:{gh:s}},t.prototype.Us=function(t){return this.Zt&&"Offline"===t?(this.Zt=!1,this.gr({wh:this.wh,Eh:new Qi,Qt:this.Qt,Ah:!1},!1)):{gh:[]}},t.prototype.yh=function(t){return!this.lh.has(t)&&!!this.wh.has(t)&&!this.wh.get(t).Ye},t.prototype.Rh=function(t){var e=this;t&&(t.te.forEach(function(t){return e.lh=e.lh.add(t)}),t.ee.forEach(function(t){}),t.ne.forEach(function(t){return e.lh=e.lh.delete(t)}),this.Zt=t.Zt)},t.prototype.Ph=function(){var t=this;if(!this.Zt)return[];var e=this.fh;this.fh=zi(),this.wh.forEach(function(e){t.yh(e.key)&&(t.fh=t.fh.add(e.key))});var n=[];return e.forEach(function(e){t.fh.has(e)||n.push(new Yc(e))}),this.fh.forEach(function(t){e.has(t)||n.push(new Kc(t))}),n},t.prototype.Vh=function(t){this.lh=t.kc,this.fh=zi();var e=this.Th(t.documents);return this.gr(e,!0)},t.prototype.ph=function(){return Ki.Kt(this.query,this.wh,this.Qt,0===this._h)},t}(),Jc=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Zc=function(t){this.key=t,this.bh=!1},th=function(){function t(t,e,n,r,i,o){this.Gu=t,this.Sh=e,this.Dh=n,this.Ch=r,this.currentUser=i,this.Nh=o,this.Fh={},this.xh=new yi(function(t){return Qs(t)},Ws),this.$h=new Map,this.kh=[],this.Mh=new xi(Fr.i),this.Oh=new Map,this.Lh=new wc,this.Bh={},this.qh=new Map,this.Uh=Za.Ta(),this.onlineState="Unknown",this.Qh=void 0}return Object.defineProperty(t.prototype,"Wh",{get:function(){return!0===this.Qh},enumerable:!1,configurable:!0}),t}();function eh(t,e,n,r){return u(this,void 0,void 0,function(){var i,o,s,c,h,l;return a(this,function(f){switch(f.label){case 0:return t.jh=function(e,n,r){return function(t,e,n,r){return u(this,void 0,void 0,function(){var i,o,s;return a(this,function(u){switch(u.label){case 0:return(i=e.view.Th(n)).Ah?[4,yc(t.Gu,e.query,!1).then(function(t){var n=t.documents;return e.view.Th(n,i)})]:[3,2];case 1:i=u.sent(),u.label=2;case 2:return o=r&&r.Gt.get(e.targetId),s=e.view.gr(i,t.Wh,o),[2,(ch(t,e.targetId,s.gh),s.snapshot)]}})})}(t,e,n,r)},[4,yc(t.Gu,e,!0)];case 1:return i=f.sent(),o=new Xc(e,i.kc),s=o.Th(i.documents),c=Xi.Xt(n,r&&"Offline"!==t.onlineState),h=o.gr(s,t.Wh,c),ch(t,n,h.gh),l=new Jc(e,n,o),[2,(t.xh.set(e,l),t.$h.has(n)?t.$h.get(n).push(e):t.$h.set(n,[e]),h.snapshot)]}})})}function nh(t,e){return u(this,void 0,void 0,function(){var n,r;return a(this,function(i){switch(i.label){case 0:n=Rr(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,function(t,e){var n=Rr(t),r=e.et,i=n.Dc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(t){var o=n.Fc.aa({ua:!0});i=n.Dc;var s=[];e.Gt.forEach(function(e,o){var u=i.get(o);if(u){s.push(n.Ha.xa(t,e.ne,o).next(function(){return n.Ha.Na(t,e.te,o)}));var a=e.resumeToken;if(a.O()>0){var c=u.st(a,r).nt(t.Ma);i=i.rt(o,c),function(t,e,n){return Lr(e.resumeToken.O()>0),0===t.resumeToken.O()||e.et.J()-t.et.J()>=3e8||n.te.size+n.ee.size+n.ne.size>0}(u,c,e)&&s.push(n.Ha.ba(t,c))}}});var u=Mi(),a=zi();if(e.Ht.forEach(function(t,e){a=a.add(t)}),s.push(o.getEntries(t,a).next(function(i){e.Ht.forEach(function(a,c){var h=i.get(a);c instanceof xs&&c.version.isEqual(mi.min())?(o.Ir(a,r),u=u.rt(a,c)):null==h||c.version.L(h.version)>0||0===c.version.L(h.version)&&h.hasPendingWrites?(o.Tr(c,r),u=u.rt(a,c)):Ar("LocalStore","Ignoring outdated watch update for ",a,". Current version:",h.version," Watch version:",c.version),e.Yt.has(a)&&s.push(n.persistence.Co.vc(t,a))})})),!r.isEqual(mi.min())){var c=n.Ha.Ra(t).next(function(e){return n.Ha.ga(t,t.Ma,r)});s.push(c)}return yu.xn(s).next(function(){return o.apply(t)}).next(function(){return n.xc.kr(t,u)})}).then(function(t){return n.Dc=i,t})}(n.Gu,e)];case 2:return r=i.sent(),e.Gt.forEach(function(t,e){var r=n.Oh.get(e);r&&(Lr(t.te.size+t.ee.size+t.ne.size<=1),t.te.size>0?r.bh=!0:t.ee.size>0?Lr(r.bh):t.ne.size>0&&(Lr(r.bh),r.bh=!1))}),[4,fh(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,mc(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function rh(t,e,n){var r=Rr(t);if(r.Wh&&0===n||!r.Wh&&1===n){var i=[];r.xh.forEach(function(t,n){var r=n.view.Us(e);r.snapshot&&i.push(r.snapshot)}),function(t,e){var n=Rr(t);n.onlineState=e;var r=!1;n.Ls.forEach(function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].Us(e)&&(r=!0)}),r&&ku(n)}(r.Dh,e),i.length&&r.Fh.pu(i),r.onlineState=e,r.Wh&&r.Ch.ji(e)}}function ih(t,e){return u(this,void 0,void 0,function(){var n,r,i;return a(this,function(o){switch(o.label){case 0:n=Rr(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=Rr(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r=e.batch.keys(),i=n.Fc.aa({ua:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),s=yu.resolve();return o.forEach(function(t){s=s.next(function(){return r.Ar(e,t)}).next(function(e){var o=e,s=n._r.get(t);Lr(null!==s),(!o||o.version.L(s)<0)&&(o=i.ar(t,o,n))&&r.Tr(o,n.lr)})}),s.next(function(){return t.vr.Qo(e,i)})}(n,t,e,i).next(function(){return i.apply(t)}).next(function(){return n.vr.Go(t)}).next(function(){return n.xc.$r(t,r)})})}(n.Gu,e)];case 2:return i=o.sent(),sh(n,r,null),oh(n,r),n.Ch.$i(r,"acknowledged"),[4,fh(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,mc(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function oh(t,e){(t.qh.get(e)||[]).forEach(function(t){t.resolve()}),t.qh.delete(e)}function sh(t,e,n){var r=Rr(t),i=r.Bh[r.currentUser.Zs()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.Bh[r.currentUser.Zs()]=i}}function uh(t,e,n){void 0===n&&(n=null),t.Ch.Li(e);for(var r=0,i=t.$h.get(e);r<i.length;r++){var o=i[r];t.xh.delete(o),n&&t.Fh.Kh(o,n)}t.$h.delete(e),t.Wh&&t.Lh.Wc(e).forEach(function(e){t.Lh.zo(e)||ah(t,e)})}function ah(t,e){var n=t.Mh.get(e);null!==n&&(kc(t.Sh,n),t.Mh=t.Mh.remove(e),t.Oh.delete(n),lh(t))}function ch(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Kc?(t.Lh.Fa(o.key,e),hh(t,o)):o instanceof Yc?(Ar("SyncEngine","Document no longer in limbo: "+o.key),t.Lh.$a(o.key,e),t.Lh.zo(o.key)||ah(t,o.key)):Dr()}}function hh(t,e){var n=e.key;t.Mh.get(n)||(Ar("SyncEngine","New document in limbo: "+n),t.kh.push(n),lh(t))}function lh(t){for(;t.kh.length>0&&t.Mh.size<t.Nh;){var e=t.kh.shift(),n=t.Uh.next();t.Oh.set(n,new Zc(e)),t.Mh=t.Mh.rt(e,n),Pc(t.Sh,new Di(Gs(Vs(e.path)),n,2,Uu.oi))}}function fh(t,e,n){return u(this,void 0,void 0,function(){var r,i,o,s;return a(this,function(c){switch(c.label){case 0:return r=Rr(t),i=[],o=[],s=[],r.xh.m()?[3,3]:(r.xh.forEach(function(t,u){s.push(r.jh(u,e,n).then(function(t){if(t){r.Wh&&r.Ch.Ui(u.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=ta.Gr(u.targetId,t);o.push(e)}}))}),[4,Promise.all(s)]);case 1:return c.sent(),r.Fh.pu(i),[4,function(t,e){return u(this,void 0,void 0,function(){var n,r,i,o,s,u,c,h,l;return a(this,function(a){switch(a.label){case 0:n=Rr(t),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(t){return yu.forEach(e,function(e){return yu.forEach(e.jr,function(r){return n.persistence.Co.Fa(t,e.targetId,r)}).next(function(){return yu.forEach(e.Kr,function(r){return n.persistence.Co.$a(t,e.targetId,r)})})})})];case 2:return a.sent(),[3,4];case 3:if(!bu(r=a.sent()))throw r;return Ar("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)s=o[i],u=s.targetId,s.fromCache||(c=n.Dc.get(u),h=c.et,l=c.it(h),n.Dc=n.Dc.rt(u,l));return[2]}})})}(r.Gu,o)];case 2:c.sent(),c.label=3;case 3:return[2]}})})}function ph(t,e,n){return u(this,void 0,void 0,function(){var n,r,i,o,s,c,h,l,f,p,d,v,y,g;return a(this,function(m){switch(m.label){case 0:n=Rr(t),r=[],i=[],o=0,s=e,m.label=1;case 1:return o<s.length?(c=s[o],h=void 0,(l=n.$h.get(c))&&0!==l.length?[4,dc(n.Gu,Gs(l[0]))]:[3,7]):[3,13];case 2:h=m.sent(),f=0,p=l,m.label=3;case 3:return f<p.length?(d=p[f],v=n.xh.get(d),[4,function(t,e){return u(this,void 0,void 0,function(){var n,r,i;return a(this,function(o){switch(o.label){case 0:return[4,yc((n=Rr(t)).Gu,e.query,!0)];case 1:return r=o.sent(),i=e.view.Vh(r),[2,(n.Wh&&ch(n,e.targetId,i.gh),i)]}})})}(n,v)]):[3,6];case 4:(y=m.sent()).snapshot&&i.push(y.snapshot),m.label=5;case 5:return f++,[3,3];case 6:return[3,11];case 7:return[4,gc(n.Gu,c)];case 8:return g=m.sent(),[4,dc(n.Gu,g)];case 9:return h=m.sent(),[4,eh(n,dh(g),c,!1)];case 10:m.sent(),m.label=11;case 11:r.push(h),m.label=12;case 12:return o++,[3,1];case 13:return[2,(n.Fh.pu(i),r)]}})})}function dh(t){return Cs(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function vh(t){var e=Rr(t);return e.Sh.Hu.rh=nh.bind(null,e),e.Sh.Hu.Be=function(t,e){var n=Rr(t),r=n.Oh.get(e);if(r&&r.bh)return zi().add(r.key);var i=zi(),o=n.$h.get(e);if(!o)return i;for(var s=0,u=o;s<u.length;s++){var a=u[s],c=n.xh.get(a);i=i.$t(c.view.mh)}return i}.bind(null,e),e.Sh.Hu.ih=function(t,e,n){return u(this,void 0,void 0,function(){var r,i,o,s,u,c;return a(this,function(a){switch(a.label){case 0:return(r=Rr(t)).Ch.Ui(e,"rejected",n),i=r.Oh.get(e),(o=i&&i.key)?(s=(s=new xi(Fr.i)).rt(o,new xs(o,mi.min())),u=zi().add(o),c=new Yi(mi.min(),new Map,new Ci(ui),s,u),[4,nh(r,c)]):[3,2];case 1:return a.sent(),r.Mh=r.Mh.remove(o),r.Oh.delete(e),lh(r),[3,4];case 2:return[4,vc(r.Gu,e,!1).then(function(){return uh(r,e,n)}).catch(mc)];case 3:a.sent(),a.label=4;case 4:return[2]}})})}.bind(null,e),e.Fh.pu=function(t,e){for(var n=Rr(t),r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,a=n.Ls.get(u);if(a){for(var c=0,h=a.listeners;c<h.length;c++)h[c].Qs(s)&&(r=!0);a.Os=s}}r&&ku(n)}.bind(null,e.Dh),e.Fh.Kh=function(t,e,n){var r=Rr(t),i=r.Ls.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.Ls.delete(e)}.bind(null,e.Dh),e}function yh(t){var e=Rr(t);return e.Sh.Hu.oh=ih.bind(null,e),e.Sh.Hu.ah=function(t,e,n){return u(this,void 0,void 0,function(){var r,i;return a(this,function(o){switch(o.label){case 0:r=Rr(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=Rr(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",function(t){var r;return n.vr.Mo(t,e).next(function(e){return Lr(null!==e),r=e.keys(),n.vr.Qo(t,e)}).next(function(){return n.vr.Go(t)}).next(function(){return n.xc.$r(t,r)})})}(r.Gu,e)];case 2:return i=o.sent(),sh(r,e,n),oh(r,e),r.Ch.$i(e,"rejected",n),[4,fh(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,mc(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}.bind(null,e),e}var gh=function(){function t(){}return t.prototype.$c=function(t){this.Yh=t},t.prototype.Or=function(t,e,n,i){var o=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.rn.length||1===t.rn.length&&t.rn[0].field.p())}(e)||n.isEqual(mi.min())?this.Jh(t,e):this.Yh.$r(t,i).next(function(s){var u=o.Xh(e,s);return(Us(e)||Ms(e))&&o.Ah(e.on,u,i,n)?o.Jh(t,e):(Tr()<=r.DEBUG&&Ar("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Ks(e)),o.Yh.Or(t,e,n).next(function(t){return u.forEach(function(e){t=t.rt(e.key,e)}),t}))})},t.prototype.Xh=function(t,e){var n=new Ci(Xs(t));return e.forEach(function(e,r){r instanceof Rs&&Ys(t,r)&&(n=n.add(r))}),n},t.prototype.Ah=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.L(r)>0)},t.prototype.Jh=function(t,e){return Tr()<=r.DEBUG&&Ar("IndexFreeQueryEngine","Using full collection scan to execute query:",Ks(e)),this.Yh.Or(t,e,mi.min())},t}(),mh=function(){function t(t,e){this.Sr=t,this.Co=e,this.vr=[],this.Zh=1,this.tl=new Ci(bc.Oc)}return t.prototype.xo=function(t){return yu.resolve(0===this.vr.length)},t.prototype.$o=function(t,e,n,r){var i=this.Zh;this.Zh++,this.vr.length>0&&this.vr[this.vr.length-1];var o=new Qu(i,e,n,r);this.vr.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.tl=this.tl.add(new bc(a.key,i)),this.Sr.ko(t,a.key.path.h())}return yu.resolve(o)},t.prototype.Mo=function(t,e){return yu.resolve(this.el(e))},t.prototype.Lo=function(t,e){var n=e+1,r=this.nl(n),i=r<0?0:r;return yu.resolve(this.vr.length>i?this.vr[i]:null)},t.prototype.Bo=function(){return yu.resolve(0===this.vr.length?-1:this.Zh-1)},t.prototype.qo=function(t){return yu.resolve(this.vr.slice())},t.prototype.Cr=function(t,e){var n=this,r=new bc(e,0),i=new bc(e,Number.POSITIVE_INFINITY),o=[];return this.tl.Nt([r,i],function(t){var e=n.el(t.Gc);o.push(e)}),yu.resolve(o)},t.prototype.Mr=function(t,e){var n=this,r=new Ci(ui);return e.forEach(function(t){var e=new bc(t,0),i=new bc(t,Number.POSITIVE_INFINITY);n.tl.Nt([e,i],function(t){r=r.add(t.Gc)})}),yu.resolve(this.sl(r))},t.prototype.Qr=function(t,e){var n=e.path,r=n.length+1,i=n;Fr.F(i)||(i=i.child(""));var o=new bc(new Fr(i),0),s=new Ci(ui);return this.tl.Ft(function(t){var e=t.key.path;return!!n.T(e)&&(e.length===r&&(s=s.add(t.Gc)),!0)},o),yu.resolve(this.sl(s))},t.prototype.sl=function(t){var e=this,n=[];return t.forEach(function(t){var r=e.el(t);null!==r&&n.push(r)}),n},t.prototype.Qo=function(t,e){var n=this;Lr(0===this.il(e.batchId,"removed")),this.vr.shift();var r=this.tl;return yu.forEach(e.mutations,function(i){var o=new bc(i.key,e.batchId);return r=r.delete(o),n.Co.Ko(t,i.key)}).next(function(){n.tl=r})},t.prototype.jo=function(t){},t.prototype.zo=function(t,e){var n=new bc(e,0),r=this.tl.xt(n);return yu.resolve(e.isEqual(r&&r.key))},t.prototype.Go=function(t){return this.vr.length,yu.resolve()},t.prototype.il=function(t,e){return this.nl(t)},t.prototype.nl=function(t){return 0===this.vr.length?0:t-this.vr[0].batchId},t.prototype.el=function(t){var e=this.nl(t);return e<0||e>=this.vr.length?null:this.vr[e]},t}(),wh=function(){function t(t,e){this.Sr=t,this.rl=e,this.docs=new xi(Fr.i),this.size=0}return t.prototype.Tr=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.rl(e);return this.docs=this.docs.rt(r,{Zo:e,size:s,readTime:n}),this.size+=s-o,this.Sr.ko(t,r.path.h())},t.prototype.Ir=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.Ar=function(t,e){var n=this.docs.get(e);return yu.resolve(n?n.Zo:null)},t.prototype.getEntries=function(t,e){var n=this,r=Fi();return e.forEach(function(t){var e=n.docs.get(t);r=r.rt(t,e?e.Zo:null)}),yu.resolve(r)},t.prototype.Or=function(t,e,n){for(var r=qi(),i=new Fr(e.path.child("")),o=this.docs._t(i);o.It();){var s=o.Et(),u=s.key,a=s.value,c=a.Zo,h=a.readTime;if(!e.path.T(u.path))break;h.L(n)<=0||c instanceof Rs&&Ys(e,c)&&(r=r.rt(c.key,c))}return yu.resolve(r)},t.prototype.ol=function(t,e){return yu.forEach(this.docs,function(t){return e(t)})},t.prototype.aa=function(e){return new t.ca(this)},t.prototype.ha=function(t){return yu.resolve(this.size)},t}();wh.ca=function(t){function e(e){var n;return(n=t.call(this)||this).la=e,n}return s(e,t),e.prototype.gr=function(t){var e=this,n=[];return this.dr.forEach(function(r,i){i?n.push(e.la.Tr(t,i,e.readTime)):e.la.Ir(r)}),yu.xn(n)},e.prototype.Rr=function(t,e){return this.la.Ar(t,e)},e.prototype.Pr=function(t,e){return this.la.getEntries(t,e)},e}(Yu);var bh=function(){function t(t){this.persistence=t,this.al=new yi(function(t){return Ti(t)},Ai),this.lastRemoteSnapshotVersion=mi.min(),this.highestTargetId=0,this.cl=0,this.ul=new wc,this.targetCount=0,this.hl=Za.ma()}return t.prototype.De=function(t,e){return this.al.forEach(function(t,n){return e(n)}),yu.resolve()},t.prototype.Ra=function(t){return yu.resolve(this.lastRemoteSnapshotVersion)},t.prototype.Pa=function(t){return yu.resolve(this.cl)},t.prototype.Ea=function(t){return this.highestTargetId=this.hl.next(),yu.resolve(this.highestTargetId)},t.prototype.ga=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.cl&&(this.cl=e),yu.resolve()},t.prototype.Va=function(t){this.al.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.hl=new Za(e),this.highestTargetId=e),t.sequenceNumber>this.cl&&(this.cl=t.sequenceNumber)},t.prototype.ya=function(t,e){return this.Va(e),this.targetCount+=1,yu.resolve()},t.prototype.ba=function(t,e){return this.Va(e),yu.resolve()},t.prototype.va=function(t,e){return this.al.delete(e.target),this.ul.Wc(e.targetId),this.targetCount-=1,yu.resolve()},t.prototype.Vo=function(t,e,n){var r=this,i=0,o=[];return this.al.forEach(function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.al.delete(s),o.push(r.Sa(t,u.targetId)),i++)}),yu.xn(o).next(function(){return i})},t.prototype.Da=function(t){return yu.resolve(this.targetCount)},t.prototype.Ca=function(t,e){var n=this.al.get(e)||null;return yu.resolve(n)},t.prototype.Na=function(t,e,n){return this.ul.qc(e,n),yu.resolve()},t.prototype.xa=function(t,e,n){this.ul.Qc(e,n);var r=this.persistence.Co,i=[];return r&&e.forEach(function(e){i.push(r.Ko(t,e))}),yu.xn(i)},t.prototype.Sa=function(t,e){return this.ul.Wc(e),yu.resolve()},t.prototype.ka=function(t,e){var n=this.ul.Kc(e);return yu.resolve(n)},t.prototype.zo=function(t,e){return yu.resolve(this.ul.zo(e))},t}(),Eh=function(){function t(t){var e=this;this.ll={},this.Ba=new Uu(0),this.qa=!1,this.qa=!0,this.Co=t(this),this.Ha=new bh(this),this.Sr=new xa,this.br=new wh(this.Sr,function(t){return e.Co._l(t)})}return t.prototype.start=function(){return Promise.resolve()},t.prototype.Si=function(){return this.qa=!1,Promise.resolve()},Object.defineProperty(t.prototype,"Ti",{get:function(){return this.qa},enumerable:!1,configurable:!0}),t.prototype.nc=function(){},t.prototype.sc=function(){},t.prototype.Pc=function(){return this.Sr},t.prototype.Ic=function(t){var e=this.ll[t.Zs()];return e||(e=new mh(this.Sr,this.Co),this.ll[t.Zs()]=e),e},t.prototype.Ac=function(){return this.Ha},t.prototype.Rc=function(){return this.br},t.prototype.runTransaction=function(t,e,n){var r=this;Ar("MemoryPersistence","Starting transaction:",t);var i=new Ih(this.Ba.next());return this.Co.fl(),n(i).next(function(t){return r.Co.dl(i).next(function(){return t})}).Nn().then(function(t){return i.pr(),t})},t.prototype.wl=function(t,e){return yu.$n(Object.values(this.ll).map(function(n){return function(){return n.zo(t,e)}}))},t}(),Ih=function(t){function e(e){var n;return(n=t.call(this)||this).Ma=e,n}return s(e,t),e}(Ju),_h=function(){function t(t){this.persistence=t,this.ml=new wc,this.Tl=null}return t.El=function(e){return new t(e)},Object.defineProperty(t.prototype,"Il",{get:function(){if(this.Tl)return this.Tl;throw Dr()},enumerable:!1,configurable:!0}),t.prototype.Fa=function(t,e,n){return this.ml.Fa(n,e),this.Il.delete(n.toString()),yu.resolve()},t.prototype.$a=function(t,e,n){return this.ml.$a(n,e),this.Il.add(n.toString()),yu.resolve()},t.prototype.Ko=function(t,e){return this.Il.add(e.toString()),yu.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.ml.Wc(e.targetId).forEach(function(t){return n.Il.add(t.toString())});var r=this.persistence.Ac();return r.ka(t,e.targetId).next(function(t){t.forEach(function(t){return n.Il.add(t.toString())})}).next(function(){return r.va(t,e)})},t.prototype.fl=function(){this.Tl=new Set},t.prototype.dl=function(t){var e=this,n=this.persistence.Rc().aa();return yu.forEach(this.Il,function(r){var i=Fr.D(r);return e.Al(t,i).next(function(t){t||n.Ir(i)})}).next(function(){return e.Tl=null,n.apply(t)})},t.prototype.vc=function(t,e){var n=this;return this.Al(t,e).next(function(t){t?n.Il.delete(e.toString()):n.Il.add(e.toString())})},t.prototype._l=function(t){return 0},t.prototype.Al=function(t,e){var n=this;return yu.$n([function(){return yu.resolve(n.ml.zo(e))},function(){return n.persistence.Ac().zo(t,e)},function(){return n.persistence.wl(t,e)}])},t}(),Th=function(){function t(t){this.Rl=t.Rl,this.Pl=t.Pl}return t.prototype.yu=function(t){this.gl=t},t.prototype.Iu=function(t){this.yl=t},t.prototype.onMessage=function(t){this.Vl=t},t.prototype.close=function(){this.Pl()},t.prototype.send=function(t){this.Rl(t)},t.prototype.pl=function(){this.gl()},t.prototype.bl=function(t){this.yl(t)},t.prototype.vl=function(t){this.Vl(t)},t}(),Ah={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Nh=function(t){function e(e){var n;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n}return s(e,t),e.prototype.xl=function(t,e,n,r){return new Promise(function(i,o){var s=new wr;s.listenOnce(gr.COMPLETE,function(){try{switch(s.getLastErrorCode()){case yr.NO_ERROR:var e=s.getResponseJson();Ar("Connection","XHR received:",JSON.stringify(e)),i(e);break;case yr.TIMEOUT:Ar("Connection",'RPC "'+t+'" timed out'),o(new Ir(Er.DEADLINE_EXCEEDED,"Request time out"));break;case yr.HTTP_ERROR:var n=s.getStatus();if(Ar("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var u=function(t){var e=r.status.toLowerCase().replace("_","-");return Object.values(Er).indexOf(e)>=0?e:Er.UNKNOWN}();o(new Ir(u,r.message))}else o(new Ir(Er.UNKNOWN,"Server responded with status "+s.getStatus()))}else o(new Ir(Er.UNAVAILABLE,"Connection failed."));break;default:Dr()}}finally{Ar("Connection",'RPC "'+t+'" completed.')}});var u=JSON.stringify(r);s.send(e,"POST",u,n,15)})},e.prototype.Vu=function(t,e){var n,r,i=[this.Dl,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=vr(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.U.projectId+"/databases/"+this.U.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.Fl(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(y())||"object"==typeof navigator&&"ReactNative"===navigator.product||y().indexOf("Electron/")>=0||((r=y()).indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0)||y().indexOf("MSAppHost/")>=0||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");Ar("Connection","Creating WebChannel: "+u,s);var a=o.createWebChannel(u,s),c=!1,h=!1,l=new Th({Rl:function(t){h?Ar("Connection","Not sending because WebChannel is closed:",t):(c||(Ar("Connection","Opening WebChannel transport."),a.open(),c=!0),Ar("Connection","WebChannel sending:",t),a.send(t))},Pl:function(){return a.close()}}),f=function(t,e){a.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return f(mr.EventType.OPEN,function(){h||Ar("Connection","WebChannel transport opened.")}),f(mr.EventType.CLOSE,function(){h||(h=!0,Ar("Connection","WebChannel transport closed"),l.bl())}),f(mr.EventType.ERROR,function(t){h||(h=!0,Sr("Connection","WebChannel transport errored:",t),l.bl(new Ir(Er.UNAVAILABLE,"The operation could not be completed")))}),f(mr.EventType.MESSAGE,function(t){var e;if(!h){var n=t.data[0];Lr(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){Ar("Connection","WebChannel received error:",i);var o=i.status,s=function(t){var e=Si[o];if(void 0!==e)return Ri(e)}(),u=i.message;void 0===s&&(s=Er.INTERNAL,u="Unknown error status: "+o+" with message "+i.message),h=!0,l.bl(new Ir(s,u)),a.close()}else Ar("Connection","WebChannel received:",n),l.vl(n)}}),setTimeout(function(){l.pl()},0),l},e}(function(){function t(t){this.Sl=t,this.U=t.U;var e=t.ssl?"https":"http";this.Dl=e+"://"+t.host,this.Cl="projects/"+this.U.projectId+"/databases/"+this.U.database+"/documents"}return t.prototype.Mu=function(t,e,n,r){var i=this.Nl(t,e);Ar("RestConnection","Sending: ",i,n);var o={};return this.Fl(o,r),this.xl(t,i,o,n).then(function(t){return Ar("RestConnection","Received: ",t),t},function(e){throw Sr("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e})},t.prototype.Ou=function(t,e,n,r){return this.Mu(t,e,n,r)},t.prototype.Fl=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.21.1",t["Content-Type"]="text/plain",e)for(var n in e.zc)e.zc.hasOwnProperty(n)&&(t[n]=e.zc[n])},t.prototype.Nl=function(t,e){var n=Ah[t];return this.Dl+"/v1/"+e+":"+n},t}()),Sh=function(){function t(){var t=this;this.$l=function(){return t.kl()},this.Ml=function(){return t.Ol()},this.Ll=[],this.Bl()}return t.prototype.eh=function(t){this.Ll.push(t)},t.prototype.Si=function(){window.removeEventListener("online",this.$l),window.removeEventListener("offline",this.Ml)},t.prototype.Bl=function(){window.addEventListener("online",this.$l),window.addEventListener("offline",this.Ml)},t.prototype.kl=function(){Ar("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Ll;t<e.length;t++)(0,e[t])(0)},t.prototype.Ol=function(){Ar("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Ll;t<e.length;t++)(0,e[t])(1)},t.On=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Oh=function(){function t(){}return t.prototype.eh=function(t){},t.prototype.Si=function(){},t}();function Dh(t){return new No(t,!0)}var Lh="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Rh=function(){function t(){}return t.prototype.initialize=function(t){return u(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return this.Ch=this.ql(t),this.persistence=this.Ul(t),[4,this.persistence.start()];case 1:return e.sent(),this.Ql=this.Wl(t),this.Gu=this.jl(t),[2]}})})},t.prototype.Wl=function(t){return null},t.prototype.jl=function(t){return e=this.persistence,n=new gh,r=t.Kl,new fc(e,n,r);var e,n,r},t.prototype.Ul=function(t){if(t.persistenceSettings.Gl)throw new Ir(Er.FAILED_PRECONDITION,Lh);return new Eh(_h.El)},t.prototype.ql=function(t){return new Wu},t.prototype.terminate=function(){return u(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return this.Ql&&this.Ql.stop(),[4,this.Ch.Si()];case 1:return t.sent(),[4,this.persistence.Si()];case 2:return t.sent(),[2]}})})},t.prototype.clearPersistence=function(t,e){throw new Ir(Er.FAILED_PRECONDITION,Lh)},t}(),xh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.initialize=function(e){return u(this,void 0,void 0,function(){var n,r=this;return a(this,function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.zl._i,this.Ch instanceof $u?(this.Ch._i={tr:function(t,e,n,r){return u(this,void 0,void 0,function(){var i,o;return a(this,function(s){switch(s.label){case 0:return[4,function(t,e){var n=Rr(t),r=Rr(n.vr);return n.persistence.runTransaction("Lookup mutation documents","readonly",function(t){return r.Oo(t,e).next(function(e){return e?n.xc.$r(t,e):yu.resolve(null)})})}((i=Rr(t)).Gu,e)];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,Gc(i.Sh)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(sh(i,e,r||null),oh(i,e),function(t,e){Rr(Rr(t).vr).jo(e)}(i.Gu,e)):Dr(),s.label=4;case 4:return[4,fh(i,o)];case 5:return s.sent(),[3,7];case 6:Ar("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}})})}.bind(null,n),er:function(t,e,n,r){return u(this,void 0,void 0,function(){var i,o,s;return a(this,function(u){switch(u.label){case 0:return(i=Rr(t)).Qh?(Ar("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.$h.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,function(t){var e=Rr(t),n=Rr(e.Fc);return e.persistence.runTransaction("Get new document changes","readonly",function(t){return n.ia(t,e.Nc)}).then(function(t){var n=t.ra,r=t.readTime;return e.Nc=r,n})}(i.Gu)];case 3:return o=u.sent(),s=Yi.Jt(e,"current"===n),[4,fh(i,o,s)];case 4:return u.sent(),[3,8];case 5:return[4,vc(i.Gu,e,!0)];case 6:return u.sent(),uh(i,e,r),[3,8];case 7:Dr(),u.label=8;case 8:return[2]}})})}.bind(null,n),nr:function(t,e,n){return u(this,void 0,void 0,function(){var r,i,o,s,u,c,h,l,f,p;return a(this,function(d){switch(d.label){case 0:if(!(r=vh(t)).Qh)return[3,10];i=0,o=e,d.label=1;case 1:return i<o.length?(s=o[i],r.$h.has(s)?(Ar("SyncEngine","Adding an already active target "+s),[3,5]):[4,gc(r.Gu,s)]):[3,6];case 2:return u=d.sent(),[4,dc(r.Gu,u)];case 3:return c=d.sent(),[4,eh(r,dh(u),c.targetId,!1)];case 4:d.sent(),Pc(r.Sh,c),d.label=5;case 5:return i++,[3,1];case 6:h=function(t){return a(this,function(e){switch(e.label){case 0:return r.$h.has(t)?[4,vc(r.Gu,t,!1).then(function(){kc(r.Sh,t),uh(r,t)}).catch(mc)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},l=0,f=n,d.label=7;case 7:return l<f.length?(p=f[l],[5,h(p)]):[3,10];case 8:d.sent(),d.label=9;case 9:return l++,[3,7];case 10:return[2]}})})}.bind(null,n),Vi:function(t){return Rr(Rr(Rr(t).Gu).persistence).Vi()}.bind(null,n)},[4,this.Ch.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.ec(function(t){return u(r,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return[4,function(t,e){return u(this,void 0,void 0,function(){var n,r,i,o,s,u,c,h;return a(this,function(a){switch(a.label){case 0:return vh(n=Rr(t)),yh(n),!0!==e||!0===n.Qh?[3,3]:(r=n.Ch.Di(),[4,ph(n,r.A())]);case 1:return i=a.sent(),n.Qh=!0,[4,$c(n.Sh,!0)];case 2:for(a.sent(),o=0,s=i;o<s.length;o++)u=s[o],Pc(n.Sh,u);return[3,7];case 3:return!1!==e||!1===n.Qh?[3,7]:(c=[],h=Promise.resolve(),n.$h.forEach(function(t,e){n.Ch.Bi(e)?c.push(e):h=h.then(function(){return uh(n,e),vc(n.Gu,e,!0)}),kc(n.Sh,e)}),[4,h]);case 4:return a.sent(),[4,ph(n,c)];case 5:return a.sent(),function(t){var e=Rr(t);e.Oh.forEach(function(t,n){kc(e.Sh,n)}),e.Lh.jc(),e.Oh=new Map,e.Mh=new xi(Fr.i)}(n),n.Qh=!1,[4,$c(n.Sh,!1)];case 6:a.sent(),a.label=7;case 7:return[2]}})})}(this.zl._i,t)];case 1:return e.sent(),this.Ql&&(t&&!this.Ql.Ti?this.Ql.start(this.Gu):t||this.Ql.stop()),[2]}})})})];case 4:return i.sent(),[2]}})})},e.prototype.ql=function(t){if(t.persistenceSettings.Gl&&t.persistenceSettings.synchronizeTabs){var e=Nu();if(!$u.On(e))throw new Ir(Er.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=lc(t.Sl.U,t.Sl.persistenceKey);return new $u(e,t.os,n,t.clientId,t.Kl)}return new Wu},e}(function(t){function e(e){var n;return(n=t.call(this)||this).zl=e,n}return s(e,t),e.prototype.initialize=function(e){return u(this,void 0,void 0,function(){return a(this,function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,function(t){return u(this,void 0,void 0,function(){var e,n;return a(this,function(r){return e=Rr(t),n=Rr(e.Fc),[2,e.persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return n.oa(t)}).then(function(t){e.Nc=t})]})})}(this.Gu)];case 2:return n.sent(),[4,this.zl.initialize(this,e)];case 3:return n.sent(),[4,yh(this.zl._i)];case 4:return n.sent(),[4,Gc(this.zl.Sh)];case 5:return n.sent(),[2]}})})},e.prototype.Wl=function(t){var e=this.persistence.Co.do;return new oa(e,t.os)},e.prototype.Ul=function(t){var e=lc(t.Sl.U,t.Sl.persistenceKey),n=Dh(t.Sl.U);return new sc(t.persistenceSettings.synchronizeTabs,e,t.clientId,ia.oo(t.persistenceSettings.cacheSizeBytes),t.os,Nu(),Su(),n,this.Ch,t.persistenceSettings.La)},e.prototype.ql=function(t){return new Wu},e.prototype.clearPersistence=function(t,e){return function(t){return u(this,void 0,void 0,function(){var e;return a(this,function(n){switch(n.label){case 0:return gu.On()?(e=t+"main",[4,gu.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}})})}(lc(t,e))},e}(Rh)),Ph=function(){function t(){}return t.prototype.initialize=function(t,e){return u(this,void 0,void 0,function(){var n=this;return a(this,function(r){switch(r.label){case 0:return this.Gu?[3,2]:(this.Gu=t.Gu,this.Ch=t.Ch,this.zu=this.Hl(e),this.Sh=this.Yl(e),this.Dh=this.Jl(e),this._i=this.Xl(e),this.Ch.fi=function(t){return rh(n._i,t,1)},this.Sh.Hu.Zl=function(t,e){return u(this,void 0,void 0,function(){var n,r;return a(this,function(i){switch(i.label){case 0:return(n=Rr(t)).currentUser.isEqual(e)?[3,3]:(Ar("SyncEngine","User change. New user:",e.Zs()),[4,function(t,e){return u(this,void 0,void 0,function(){var n,r,i,o;return a(this,function(s){switch(s.label){case 0:return n=Rr(t),r=n.vr,i=n.xc,[4,n.persistence.runTransaction("Handle user change","readonly",function(t){var o;return n.vr.qo(t).next(function(s){return o=s,r=n.persistence.Ic(e),i=new Zu(n.Fc,r,n.persistence.Pc()),r.qo(t)}).next(function(e){for(var n=[],r=[],s=zi(),u=0,a=o;u<a.length;u++){var c=a[u];n.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++){var f=l[h];s=s.add(f.key)}}for(var p=0,d=e;p<d.length;p++){var v=d[p];r.push(v.batchId);for(var y=0,g=v.mutations;y<g.length;y++){var m=g[y];s=s.add(m.key)}}return i.$r(t,s).next(function(t){return{Gh:t,zh:n,Hh:r}})})})];case 1:return o=s.sent(),[2,(n.vr=r,n.xc=i,n.Sc.$c(n.xc),o)]}})})}(n.Gu,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.qh.forEach(function(t){t.forEach(function(t){t.reject(new Ir(Er.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),t.qh.clear()}(n),n.Ch.Wi(e,r.zh,r.Hh),[4,fh(n,r.Gh)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}.bind(null,this._i),[4,$c(this.Sh,this._i.Wh)]);case 1:r.sent(),r.label=2;case 2:return[2]}})})},t.prototype.Jl=function(t){return new function(){this.Ls=new yi(function(t){return Qs(t)},Ws),this.onlineState="Unknown",this.Bs=new Set}},t.prototype.Hl=function(t){var e,n=Dh(t.Sl.U),r=(e=t.Sl,new Nh(e));return function(t,e,n){return new Oc(t,r,n)}(t.credentials,0,n)},t.prototype.Yl=function(t){var e=this;return new function(t,e,n,r,i){var o=this;this.Gu=t,this.zu=e,this.os=n,this.Hu={},this.Yu=[],this.Ju=new Map,this.Xu=new Set,this.Zu=[],this.th=i,this.th.eh(function(t){n.ds(function(){return u(o,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return Fc(this)?(Ar("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return u(this,void 0,void 0,function(){var e;return a(this,function(n){switch(n.label){case 0:return(e=Rr(t)).Xu.add(4),[4,Rc(e)];case 1:return n.sent(),e.nh.set("Unknown"),e.Xu.delete(4),[4,Lc(e)];case 2:return n.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.nh=new Dc(n,r)}(this.Gu,this.zu,t.os,function(t){return rh(e._i,t,0)},Sh.On()?new Sh:new Oh)},t.prototype.Xl=function(t){return function(t,e,n,r,i,o,s){var u=new th(t,e,n,r,i,o);return s&&(u.Qh=!0),u}(this.Gu,this.Sh,this.Dh,this.Ch,t.Kl,t.Nh,!t.persistenceSettings.Gl||!t.persistenceSettings.synchronizeTabs)},t.prototype.terminate=function(){return xc(this.Sh)},t}(),kh=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.t_(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.t_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.e_=function(){this.muted=!0},t.prototype.t_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),Ch=function(t){!function(t,e,n,r){if(!(e instanceof Array)||e.length<1)throw new Ir(Er.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least "+ii(1,"element")+".")}(0,t);for(var e=0;e<t.length;++e)if(zr("FieldPath","string",e,t[e]),0===t[e].length)throw new Ir(Er.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.n_=new Mr(t)},Vh=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.call(this,e)||this}return s(e,t),e.documentId=function(){return new e(Mr.v().R())},e.prototype.isEqual=function(t){if(!(t instanceof e))throw ei("isEqual","FieldPath",1,t);return this.n_.isEqual(t.n_)},e}(Ch),Uh=new RegExp("[~\\*/\\[\\]]"),Mh=function(){this.s_=this},Fh=function(t){function e(e){var n;return(n=t.call(this)||this).i_=e,n}return s(e,t),e.prototype.r_=function(t){if(2!==t.o_)throw 1===t.o_?t.a_(this.i_+"() can only appear at the top level of your update data"):t.a_(this.i_+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(Mh);function jh(t,e,n){return new Zh({o_:3,c_:e.settings.c_,methodName:t.i_,u_:n},e.U,e.serializer,e.ignoreUndefinedProperties)}var qh=function(t){function e(e){var n;return(n=t.call(this)||this).i_=e,n}return s(e,t),e.prototype.r_=function(t){return new hs(t.path,new es)},e.prototype.isEqual=function(t){return t instanceof e},e}(Mh),Bh=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).i_=e,r.h_=n,r}return s(e,t),e.prototype.r_=function(t){var e=jh(this,t,!0),n=this.h_.map(function(t){return ol(t,e)}),r=new ns(n);return new hs(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Mh),Gh=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).i_=e,r.h_=n,r}return s(e,t),e.prototype.r_=function(t){var e=jh(this,t,!0),n=this.h_.map(function(t){return ol(t,e)}),r=new is(n);return new hs(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Mh),zh=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).i_=e,r.l_=n,r}return s(e,t),e.prototype.r_=function(t){var e=new ss(t.serializer,Do(t.serializer,this.l_));return new hs(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(Mh),Hh=function(t){function e(){return t.call(this)||this}return s(e,t),e.delete=function(){return jr("FieldValue.delete",arguments),new $h(new Fh("FieldValue.delete"))},e.serverTimestamp=function(){return jr("FieldValue.serverTimestamp",arguments),new $h(new qh("FieldValue.serverTimestamp"))},e.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Br("FieldValue.arrayUnion",arguments,1),new $h(new Bh("FieldValue.arrayUnion",t))},e.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Br("FieldValue.arrayRemove",arguments,1),new $h(new Gh("FieldValue.arrayRemove",t))},e.increment=function(t){return zr("FieldValue.increment","number",1,t),qr("FieldValue.increment",arguments,1),new $h(new zh("FieldValue.increment",t))},e}(Mh),$h=function(t){function e(e){var n=this;return(n=t.call(this)||this).s_=e,n.i_=e.i_,n}return s(e,t),e.prototype.r_=function(t){return this.s_.r_(t)},e.prototype.isEqual=function(t){return t instanceof e&&this.s_.isEqual(t.s_)},e}(Hh),Wh=function(){function t(t,e){if(qr("GeoPoint",arguments,2),zr("GeoPoint","number",1,t),zr("GeoPoint","number",2,e),!isFinite(t)||t<-90||t>90)throw new Ir(Er.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Ir(Er.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.__=t,this.f_=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this.__},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this.f_},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.__===t.__&&this.f_===t.f_},t.prototype.toJSON=function(){return{latitude:this.__,longitude:this.f_}},t.prototype.H=function(t){return ui(this.__,t.__)||ui(this.f_,t.f_)},t}(),Qh=/^__.*__$/,Kh=function(t,e,n){this.d_=t,this.w_=e,this.m_=n},Yh=function(){function t(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}return t.prototype.T_=function(t,e){var n=[];return null!==this.Qe?n.push(new bs(t,this.data,this.Qe,e)):n.push(new ws(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new Is(t,this.fieldTransforms)),n},t}(),Xh=function(){function t(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}return t.prototype.T_=function(t,e){var n=[new bs(t,this.data,this.Qe,e)];return this.fieldTransforms.length>0&&n.push(new Is(t,this.fieldTransforms)),n},t}();function Jh(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Dr()}}var Zh=function(){function t(t,e,n,r,i,o){this.settings=t,this.U=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.E_(),this.fieldTransforms=i||[],this.Qe=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"o_",{get:function(){return this.settings.o_},enumerable:!1,configurable:!0}),t.prototype.I_=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.U,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},t.prototype.A_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.I_({path:n,u_:!1});return r.R_(t),r},t.prototype.P_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.I_({path:n,u_:!1});return r.E_(),r},t.prototype.g_=function(t){return this.I_({path:void 0,u_:!0})},t.prototype.a_=function(t){return ll(t,this.settings.methodName,this.settings.y_||!1,this.path,this.settings.c_)},t.prototype.contains=function(t){return void 0!==this.Qe.find(function(e){return t.T(e)})||void 0!==this.fieldTransforms.find(function(e){return t.T(e.field)})},t.prototype.E_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.R_(this.path.get(t))},t.prototype.R_=function(t){if(0===t.length)throw this.a_("Document fields must not be empty");if(Jh(this.o_)&&Qh.test(t))throw this.a_('Document fields cannot begin and end with "__"')},t}(),tl=function(){function t(t,e,n){this.U=t,this.ignoreUndefinedProperties=e,this.serializer=n||Dh(t)}return t.prototype.V_=function(t,e,n,r){return void 0===r&&(r=!1),new Zh({o_:t,methodName:e,c_:n,path:Mr.g(),u_:!1,y_:r},this.U,this.serializer,this.ignoreUndefinedProperties)},t}();function el(t,e,n,r,i,o){void 0===o&&(o={});var s=t.V_(o.merge||o.mergeFields?2:0,e,n,i);al("Data must be an object, but it was:",s,r);var u,a,c=sl(r,s);if(o.merge)u=new cs(s.Qe),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],l=0,f=o.mergeFields;l<f.length;l++){var p=f[l],d=void 0;if(p instanceof Ch)d=p.n_;else{if("string"!=typeof p)throw Dr();d=hl(e,p,n)}if(!s.contains(d))throw new Ir(Er.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");fl(h,d)||h.push(d)}u=new cs(h),a=s.fieldTransforms.filter(function(t){return u.He(t.field)})}else u=null,a=s.fieldTransforms;return new Yh(new Ss(c),u,a)}function nl(t,e,n,r){var i=t.V_(1,e,n);al("Data must be an object, but it was:",i,r);var o=[],s=new Os;Pr(r,function(t,r){var u=hl(e,t,n),a=i.P_(u);if(r instanceof Mh&&r.s_ instanceof Fh)o.push(u);else{var c=ol(r,a);null!=c&&(o.push(u),s.set(u,c))}});var u=new cs(o);return new Xh(s.Je(),u,i.fieldTransforms)}function rl(t,e,n,r,i,o){var s=t.V_(1,e,n),u=[cl(e,r,n)],a=[i];if(o.length%2!=0)throw new Ir(Er.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(cl(e,o[c])),a.push(o[c+1]);for(var h=[],l=new Os,f=u.length-1;f>=0;--f)if(!fl(h,u[f])){var p=u[f],d=a[f],v=s.P_(p);if(d instanceof Mh&&d.s_ instanceof Fh)h.push(p);else{var y=ol(d,v);null!=y&&(h.push(p),l.set(p,y))}}var g=new cs(h);return new Xh(l.Je(),g,s.fieldTransforms)}function il(t,e,n,r){return void 0===r&&(r=!1),ol(n,t.V_(r?4:3,e))}function ol(t,e){if(ul(t))return al("Unsupported field value:",e,t),sl(t,e);if(t instanceof Mh)return function(t,e){if(!Jh(e.o_))throw e.a_(t.i_+"() can only be used with update() and set()");if(!e.path)throw e.a_(t.i_+"() is not currently supported inside arrays");var n=t.r_(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.Qe.push(e.path),t instanceof Array){if(e.settings.u_&&4!==e.o_)throw e.a_("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=ol(o[i],e.g_(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Do(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=gi.fromDate(t);return{timestampValue:Lo(e.serializer,n)}}if(t instanceof gi){var r=new gi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Lo(e.serializer,r)}}if(t instanceof Wh)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof li)return{bytesValue:Ro(e.serializer,t.q)};if(t instanceof Kh){var i=e.U,o=t.d_;if(!o.isEqual(i))throw e.a_("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:Po(t.d_||e.U,t.w_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.a_("Unsupported field value: "+Jr(t))}(t,e)}function sl(t,e){var n={};return kr(t)?e.path&&e.path.length>0&&e.Qe.push(e.path):Pr(t,function(t,r){var i=ol(r,e.A_(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function ul(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof gi||t instanceof Wh||t instanceof li||t instanceof Kh||t instanceof Mh)}function al(t,e,n){if(!ul(n)||!Xr(n)){var r=Jr(n);throw"an object"===r?e.a_(t+" a custom object"):e.a_(t+" "+r)}}function cl(t,e,n){if(e instanceof Ch)return e.n_;if("string"==typeof e)return hl(t,e);throw ll("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function hl(t,e,n){try{return function(t){if(t.search(Uh)>=0)throw new Ir(Er.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Vh.bind.apply(Vh,c([void 0],t.split("."))))}catch(e){throw new Ir(Er.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).n_}catch(e){throw ll((r=e)instanceof Error?r.message:r.toString(),t,!1,void 0,n)}var r}function ll(t,e,n,r,i){var o=r&&!r.m(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new Ir(Er.INVALID_ARGUMENT,(u+=". ")+t+a)}function fl(t,e){return t.some(function(t){return t.isEqual(e)})}var pl=function(){function t(t){this.zu=t,this.p_=new Map,this.mutations=[],this.b_=!1,this.v_=null,this.S_=new Set}return t.prototype.D_=function(t){return u(this,void 0,void 0,function(){var e,n=this;return a(this,function(r){switch(r.label){case 0:if(this.C_(),this.mutations.length>0)throw new Ir(Er.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return u(this,void 0,void 0,function(){var n,r,i,o,s,u;return a(this,function(a){switch(a.label){case 0:return n=Rr(t),r=Fo(n.serializer)+"/documents",i={documents:e.map(function(t){return Co(n.serializer,t)})},[4,n.Ou("BatchGetDocuments",r,i)];case 1:return o=a.sent(),s=new Map,o.forEach(function(t){var e=function(t,e){return"found"in e?function(t,e){Lr(!!e.found),e.found.name,e.found.updateTime;var n=Vo(t,e.found.name),r=xo(e.found.updateTime),i=new Ss({mapValue:{fields:e.found.fields}});return new Rs(n,r,i,{})}(t,e):"missing"in e?function(t,e){Lr(!!e.missing),Lr(!!e.readTime);var n=Vo(t,e.missing),r=xo(e.readTime);return new xs(n,r)}(t,e):Dr()}(n.serializer,t);s.set(e.key.toString(),e)}),u=[],[2,(e.forEach(function(t){var e=s.get(t.toString());Lr(!!e),u.push(e)}),u)]}})})}(this.zu,t)];case 1:return[2,((e=r.sent()).forEach(function(t){t instanceof xs||t instanceof Rs?n.N_(t):Dr()}),e)]}})})},t.prototype.set=function(t,e){this.write(e.T_(t,this.Ke(t))),this.S_.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.T_(t,this.F_(t)))}catch(t){this.v_=t}this.S_.add(t.toString())},t.prototype.delete=function(t){this.write([new As(t,this.Ke(t))]),this.S_.add(t.toString())},t.prototype.commit=function(){return u(this,void 0,void 0,function(){var t,e=this;return a(this,function(n){switch(n.label){case 0:if(this.C_(),this.v_)throw this.v_;return t=this.p_,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(t,n){var r=Fr.D(n);e.mutations.push(new Ns(r,e.Ke(r)))}),[4,function(t,e){return u(this,void 0,void 0,function(){var n,r,i;return a(this,function(o){switch(o.label){case 0:return n=Rr(t),r=Fo(n.serializer)+"/documents",i={writes:e.map(function(t){return Bo(n.serializer,t)})},[4,n.Mu("Commit",r,i)];case 1:return o.sent(),[2]}})})}(this.zu,this.mutations)];case 1:return n.sent(),this.b_=!0,[2]}})})},t.prototype.N_=function(t){var e;if(t instanceof Rs)e=t.version;else{if(!(t instanceof xs))throw Dr();e=mi.min()}var n=this.p_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Ir(Er.ABORTED,"Document version changed between two reads.")}else this.p_.set(t.key.toString(),e)},t.prototype.Ke=function(t){var e=this.p_.get(t.toString());return!this.S_.has(t.toString())&&e?ls.updateTime(e):ls.Ge()},t.prototype.F_=function(t){var e=this.p_.get(t.toString());if(!this.S_.has(t.toString())&&e){if(e.isEqual(mi.min()))throw new Ir(Er.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ls.updateTime(e)}return ls.exists(!0)},t.prototype.write=function(t){this.C_(),this.mutations=this.mutations.concat(t)},t.prototype.C_=function(){},t}(),dl=function(){function t(t,e,n,r){this.os=t,this.zu=e,this.updateFunction=n,this.hs=r,this.x_=5,this.gs=new vu(this.os,"transaction_retry")}return t.prototype.run=function(){this.k_()},t.prototype.k_=function(){var t=this;this.gs.Rn(function(){return u(t,void 0,void 0,function(){var t,e,n=this;return a(this,function(r){return t=new pl(this.zu),(e=this.M_(t))&&e.then(function(e){n.os.ds(function(){return t.commit().then(function(){n.hs.resolve(e)}).catch(function(t){n.O_(t)})})}).catch(function(t){n.O_(t)}),[2]})})})},t.prototype.M_=function(t){try{var e=this.updateFunction(t);return!wi(e)&&e.catch&&e.then?e:(this.hs.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.hs.reject(t),null}},t.prototype.O_=function(t){var e=this;this.x_>0&&this.L_(t)?(this.x_-=1,this.os.ds(function(){return e.k_(),Promise.resolve()})):this.hs.reject(t)},t.prototype.L_=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Li(e)}return!1},t}(),vl=function(){function t(t,e){this.credentials=t,this.os=e,this.clientId=si.k(),this.B_=new du}return t.prototype.start=function(t,e,n,r){var i=this;this.q_(),this.Sl=t;var o=new du,s=!1;return this.credentials.Jc(function(t){if(!s)return s=!0,Ar("FirestoreClient","Initializing. user=",t.uid),i.U_(e,n,r,t,o).then(i.B_.resolve,i.B_.reject);i.os.Ds(function(){return function(t,e){return u(this,void 0,void 0,function(){var n,r;return a(this,function(i){switch(i.label){case 0:return(n=Rr(t)).os.Fs(),Ar("RemoteStore","RemoteStore received new credentials"),r=Fc(n),n.Xu.add(3),[4,Rc(n)];case 1:return i.sent(),r&&n.nh.set("Unknown"),[4,n.Hu.Zl(e)];case 2:return i.sent(),n.Xu.delete(3),[4,Lc(n)];case 3:return i.sent(),[2]}})})}(i.Sh,t)})}),this.os.ds(function(){return i.B_.promise}),o.promise},t.prototype.enableNetwork=function(){var t=this;return this.q_(),this.os.enqueue(function(){return t.persistence.sc(!0),function(t){var e=Rr(t);return e.Xu.delete(0),Lc(e)}(t.Sh)})},t.prototype.U_=function(t,e,n,r,i){return u(this,void 0,void 0,function(){var o,s,c=this;return a(this,function(h){switch(h.label){case 0:return h.trys.push([0,3,,4]),o={os:this.os,Sl:this.Sl,clientId:this.clientId,credentials:this.credentials,Kl:r,Nh:100,persistenceSettings:n},[4,t.initialize(o)];case 1:return h.sent(),[4,e.initialize(t,o)];case 2:return h.sent(),this.persistence=t.persistence,this.Ch=t.Ch,this.Gu=t.Gu,this.Ql=t.Ql,this.zu=e.zu,this.Sh=e.Sh,this._i=e._i,this.Q_=e.Dh,this.Q_.qs=function(t,e){return u(this,void 0,void 0,function(){var n,r,i,o,s,u;return a(this,function(a){switch(a.label){case 0:return n=vh(t),(o=n.xh.get(e))?(r=o.targetId,n.Ch.Mi(r),i=o.view.ph(),[3,4]):[3,1];case 1:return[4,dc(n.Gu,Gs(e))];case 2:return s=a.sent(),u=n.Ch.Mi(s.targetId),r=s.targetId,[4,eh(n,e,r,"current"===u)];case 3:i=a.sent(),n.Wh&&Pc(n.Sh,s),a.label=4;case 4:return[2,i]}})})}.bind(null,this._i),this.Q_.Ws=function(t,e){return u(this,void 0,void 0,function(){var n,r,i;return a(this,function(o){switch(o.label){case 0:return n=Rr(t),r=n.xh.get(e),(i=n.$h.get(r.targetId)).length>1?[2,(n.$h.set(r.targetId,i.filter(function(t){return!Ws(t,e)})),void n.xh.delete(e))]:n.Wh?(n.Ch.Li(r.targetId),n.Ch.Ni(r.targetId)?[3,2]:[4,vc(n.Gu,r.targetId,!1).then(function(){n.Ch.qi(r.targetId),kc(n.Sh,r.targetId),uh(n,r.targetId)}).catch(mc)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return uh(n,r.targetId),[4,vc(n.Gu,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}})})}.bind(null,this._i),this.persistence.nc(function(){return u(c,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),i.resolve(),[3,4];case 3:if(s=h.sent(),i.reject(s),!this.W_(s))throw s;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+s),this.U_(new Rh,new Ph,{Gl:!1},r,i))];case 4:return[2]}})})},t.prototype.W_=function(t){return"FirebaseError"===t.name?t.code===Er.FAILED_PRECONDITION||t.code===Er.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},t.prototype.q_=function(){if(this.os.Vs)throw new Ir(Er.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.disableNetwork=function(){var t=this;return this.q_(),this.os.enqueue(function(){return t.persistence.sc(!1),function(t){return u(this,void 0,void 0,function(){var e;return a(this,function(n){switch(n.label){case 0:return(e=Rr(t)).Xu.add(0),[4,Rc(e)];case 1:return n.sent(),e.nh.set("Offline"),[2]}})})}(t.Sh)})},t.prototype.terminate=function(){var t=this;this.os.Ss();var e=new du;return this.os.ps(function(){return u(t,void 0,void 0,function(){var t,n;return a(this,function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),this.Ql&&this.Ql.stop(),[4,xc(this.Sh)];case 1:return r.sent(),[4,this.Ch.Si()];case 2:return r.sent(),[4,this.persistence.Si()];case 3:return r.sent(),this.credentials.Xc(),e.resolve(),[3,5];case 4:return t=r.sent(),n=Lu(t,"Failed to shutdown persistence"),e.reject(n),[3,5];case 5:return[2]}})})}),e.promise},t.prototype.waitForPendingWrites=function(){var t=this;this.q_();var e=new du;return this.os.ds(function(){return function(t,e){return u(this,void 0,void 0,function(){var n,r,i,o,s;return a(this,function(u){switch(u.label){case 0:Fc((n=Rr(t)).Sh)||Ar("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),u.label=1;case 1:return u.trys.push([1,3,,4]),[4,function(t){var e=Rr(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.vr.Bo(t)})}(n.Gu)];case 2:return-1===(r=u.sent())?[2,void e.resolve()]:((i=n.qh.get(r)||[]).push(e),n.qh.set(r,i),[3,4]);case 3:return o=u.sent(),s=Lu(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(s),[3,4];case 4:return[2]}})})}(t._i,e)}),e.promise},t.prototype.listen=function(t,e,n){var r=this;this.q_();var i=new kh(n),o=new Cu(t,i,e);return this.os.ds(function(){return xu(r.Q_,o)}),function(){i.e_(),r.os.ds(function(){return Pu(r.Q_,o)})}},t.prototype.j_=function(t){return u(this,void 0,void 0,function(){var e,n=this;return a(this,function(r){switch(r.label){case 0:return this.q_(),[4,this.B_.promise];case 1:return r.sent(),e=new du,[2,(this.os.ds(function(){return function(t,e,n){return u(this,void 0,void 0,function(){var r,i,o;return a(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,function(t,e){var n=Rr(t);return n.persistence.runTransaction("read document","readonly",function(t){return n.xc.Dr(t,e)})}(t,e)];case 1:return(r=s.sent())instanceof Rs?n.resolve(r):r instanceof xs?n.resolve(null):n.reject(new Ir(Er.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return i=s.sent(),o=Lu(i,"Failed to get document '"+e+" from cache"),n.reject(o),[3,3];case 3:return[2]}})})}(n.Gu,t,e)}),e.promise)]}})})},t.prototype.K_=function(t,e){return void 0===e&&(e={}),u(this,void 0,void 0,function(){var n,r=this;return a(this,function(i){switch(i.label){case 0:return this.q_(),[4,this.B_.promise];case 1:return i.sent(),n=new du,[2,(this.os.ds(function(){return function(t,e,n,r,i){var o=new kh({next:function(o){e.ds(function(){return Pu(t,s)});var u=o.docs.has(n);!u&&o.fromCache?i.reject(new Ir(Er.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&o.fromCache&&r&&"server"===r.source?i.reject(new Ir(Er.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new Cu(Vs(n.path),o,{includeMetadataChanges:!0,Js:!0});return xu(t,s)}(r.Q_,r.os,t,e,n)}),n.promise)]}})})},t.prototype.G_=function(t){return u(this,void 0,void 0,function(){var e,n=this;return a(this,function(r){switch(r.label){case 0:return this.q_(),[4,this.B_.promise];case 1:return r.sent(),e=new du,[2,(this.os.ds(function(){return function(t,e,n){return u(this,void 0,void 0,function(){var r,i,o,s,u,c;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,yc(t,e,!0)];case 1:return r=a.sent(),i=new Xc(e,r.kc),o=i.Th(r.documents),s=i.gr(o,!1),n.resolve(s.snapshot),[3,3];case 2:return u=a.sent(),c=Lu(u,"Failed to execute query '"+e+" against cache"),n.reject(c),[3,3];case 3:return[2]}})})}(n.Gu,t,e)}),e.promise)]}})})},t.prototype.z_=function(t,e){return void 0===e&&(e={}),u(this,void 0,void 0,function(){var n,r=this;return a(this,function(i){switch(i.label){case 0:return this.q_(),[4,this.B_.promise];case 1:return i.sent(),n=new du,[2,(this.os.ds(function(){return function(t,e,n,r,i){var o=new kh({next:function(n){e.ds(function(){return Pu(t,s)}),n.fromCache&&"server"===r.source?i.reject(new Ir(Er.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new Cu(n,o,{includeMetadataChanges:!0,Js:!0});return xu(t,s)}(r.Q_,r.os,t,e,n)}),n.promise)]}})})},t.prototype.write=function(t){var e=this;this.q_();var n=new du;return this.os.ds(function(){return function(t,e,n){return u(this,void 0,void 0,function(){var r,i,o,s;return a(this,function(u){switch(u.label){case 0:r=yh(t),u.label=1;case 1:return u.trys.push([1,5,,6]),[4,function(t,e){var n,r=Rr(t),i=gi.now(),o=e.reduce(function(t,e){return t.add(e.key)},zi());return r.persistence.runTransaction("Locally write mutations","readwrite",function(t){return r.xc.$r(t,o).next(function(o){n=o;for(var s=[],u=0,a=e;u<a.length;u++){var c=a[u],h=ys(c,n.get(c.key));null!=h&&s.push(new bs(c.key,h,Ds(h.proto.mapValue),ls.exists(!0)))}return r.vr.$o(t,i,s,e)})}).then(function(t){var e=t.hr(n);return{batchId:t.batchId,dr:e}})}(r.Gu,e)];case 2:return i=u.sent(),r.Ch.Fi(i.batchId),function(t,e,n){var r=t.Bh[t.currentUser.Zs()];r||(r=new xi(ui)),r=r.rt(e,n),t.Bh[t.currentUser.Zs()]=r}(r,i.batchId,n),[4,fh(r,i.dr)];case 3:return u.sent(),[4,Gc(r.Sh)];case 4:return u.sent(),[3,6];case 5:return o=u.sent(),s=Lu(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}})})}(e._i,t,n)}),n.promise},t.prototype.U=function(){return this.Sl.U},t.prototype.H_=function(t){var e=this;this.q_();var n=new kh(t);return this.os.ds(function(){return u(e,void 0,void 0,function(){return a(this,function(t){return[2,function(t,e){Rr(t).Bs.add(e),e.next()}(this.Q_,n)]})})}),function(){n.e_(),e.os.ds(function(){return u(e,void 0,void 0,function(){return a(this,function(t){return[2,function(t,e){Rr(t).Bs.delete(e)}(this.Q_,n)]})})})}},Object.defineProperty(t.prototype,"Y_",{get:function(){return this.os.Vs},enumerable:!1,configurable:!0}),t.prototype.transaction=function(t){var e=this;this.q_();var n=new du;return this.os.ds(function(){return new dl(e.os,e.zu,t,n).run(),Promise.resolve()}),n.promise},t}();function yl(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var gl=function(){function t(t,e,n,r,i){this.U=t,this.timestampsInSnapshots=e,this.J_=n,this.X_=r,this.Z_=i}return t.prototype.tf=function(t){switch(ao(t)){case 0:return null;case 1:return t.booleanValue;case 2:return yo(t.integerValue||t.doubleValue);case 3:return this.ef(t.timestampValue);case 4:return this.nf(t);case 5:return t.stringValue;case 6:return this.Z_(go(t.bytesValue));case 7:return this.sf(t.referenceValue);case 8:return this.if(t.geoPointValue);case 9:return this.rf(t.arrayValue);case 10:return this.af(t.mapValue);default:throw Dr()}},t.prototype.af=function(t){var e=this,n={};return Pr(t.fields||{},function(t,r){n[t]=e.tf(r)}),n},t.prototype.if=function(t){return new Wh(yo(t.latitude),yo(t.longitude))},t.prototype.rf=function(t){var e=this;return(t.values||[]).map(function(t){return e.tf(t)})},t.prototype.nf=function(t){switch(this.J_){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return oo(n)?t(n):n}(t);return null==e?null:this.tf(e);case"estimate":return this.ef(so(t));default:return null}},t.prototype.ef=function(t){var e=vo(t),n=new gi(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},t.prototype.sf=function(t){var e=Vr.P(t);Lr(Yo(e));var n=new vi(e.get(1),e.get(3)),r=new Fr(e.u(5));return n.isEqual(this.U)||Nr("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.U.projectId+"/"+this.U.database+") instead."),this.X_(r)},t}(),ml=ia.uo,wl=function(){function t(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new Ir(Er.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else $r("settings","non-empty string","host",t.host),this.host=t.host,Wr("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(ti("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),Wr("settings","object","credentials",t.credentials),this.credentials=t.credentials,Wr("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),Wr("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Nr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Nr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,Wr("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=ia.lo;else{if(t.cacheSizeBytes!==ml&&t.cacheSizeBytes<ia.ho)throw new Ir(Er.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+ia.ho);this.cacheSizeBytes=t.cacheSizeBytes}Wr("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),bl=function(){function t(e,n,r,i){var o=this;if(void 0===r&&(r=new Rh),void 0===i&&(i=new Ph),this.cf=r,this.uf=i,this.hf=null,this.lf=new Du,this.INTERNAL={delete:function(){return u(o,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return this._f(),[4,this.ff.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof e.options){var s=e;this.hf=s,this.d_=t.df(s),this.wf=s.name,this.mf=new Ic(n)}else{var c=e;if(!c.projectId)throw new Ir(Er.INVALID_ARGUMENT,"Must provide projectId");this.d_=new vi(c.projectId,c.database),this.wf="[DEFAULT]",this.mf=new Ec}this.Tf=new wl({})}return Object.defineProperty(t.prototype,"Ef",{get:function(){return this.If||(this.If=new tl(this.d_,this.Tf.ignoreUndefinedProperties)),this.If},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){qr("Firestore.settings",arguments,1),zr("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.Tf),t)).merge;var e=new wl(t);if(this.ff&&!this.Tf.isEqual(e))throw new Ir(Er.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this.Tf=e,void 0!==e.credentials&&(this.mf=function(t){if(!t)return new Ec;switch(t.type){case"gapi":var e=t.client;return Lr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Tc(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Ir(Er.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},t.prototype.enableNetwork=function(){return this._f(),this.ff.enableNetwork()},t.prototype.disableNetwork=function(){return this._f(),this.ff.disableNetwork()},t.prototype.enablePersistence=function(t){var e,n;if(this.ff)throw new Ir(Er.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Nr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new Ir(Er.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Af(this.cf,this.uf,{Gl:!0,cacheSizeBytes:this.Tf.cacheSizeBytes,synchronizeTabs:r,La:i})},t.prototype.clearPersistence=function(){return u(this,void 0,void 0,function(){var t,e=this;return a(this,function(n){if(void 0!==this.ff&&!this.ff.Y_)throw new Ir(Er.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return t=new du,[2,(this.lf.ps(function(){return u(e,void 0,void 0,function(){var e;return a(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.cf.clearPersistence(this.d_,this.wf)];case 1:return n.sent(),t.resolve(),[3,3];case 2:return e=n.sent(),t.reject(e),[3,3];case 3:return[2]}})})}),t.promise)]})})},t.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(t.prototype,"Rf",{get:function(){return this._f(),this.ff.Y_},enumerable:!1,configurable:!0}),t.prototype.waitForPendingWrites=function(){return this._f(),this.ff.waitForPendingWrites()},t.prototype.onSnapshotsInSync=function(t){if(this._f(),yl(t))return this.ff.H_(t);zr("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.ff.H_(e)},t.prototype._f=function(){return this.ff||this.Af(new Rh,new Ph,{Gl:!1}),this.ff},t.prototype.Pf=function(){return new function(t,e,n,r,i){this.U=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}(this.d_,this.wf,this.Tf.host,this.Tf.ssl,this.Tf.experimentalForceLongPolling)},t.prototype.Af=function(t,e,n){var r=this.Pf();return this.ff=new vl(this.mf,this.lf),this.ff.start(r,t,e,n)},t.df=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Ir(Er.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Ir(Er.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new vi(n)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.hf)throw new Ir(Er.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.hf},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){return qr("Firestore.collection",arguments,1),zr("Firestore.collection","non-empty string",1,t),this._f(),new Pl(Vr.P(t),this,null)},t.prototype.doc=function(t){return qr("Firestore.doc",arguments,1),zr("Firestore.doc","non-empty string",1,t),this._f(),_l.gf(Vr.P(t),this,null)},t.prototype.collectionGroup=function(t){if(qr("Firestore.collectionGroup",arguments,1),zr("Firestore.collectionGroup","non-empty string",1,t),t.indexOf("/")>=0)throw new Ir(Er.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this._f(),new Rl(function(t){return new ks(Vr.g(),t)}(t),this,null)},t.prototype.runTransaction=function(t){var e=this;return qr("Firestore.runTransaction",arguments,1),zr("Firestore.runTransaction","function",1,t),this._f().transaction(function(n){return t(new El(e,n))})},t.prototype.batch=function(){return this._f(),new Il(this)},Object.defineProperty(t,"logLevel",{get:function(){switch(Tr()){case r.DEBUG:return"debug";case r.ERROR:return"error";case r.SILENT:return"silent";case r.WARN:return"warn";case r.INFO:return"info";case r.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),t.setLogLevel=function(t){var e;qr("Firestore.setLogLevel",arguments,1),Kr("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),e=t,_r.setLogLevel(e)},t.prototype.yf=function(){return this.Tf.timestampsInSnapshots},t.prototype.Vf=function(){return this.Tf},t}(),El=function(){function t(t,e){this.pf=t,this.bf=e}return t.prototype.get=function(t){var e=this;qr("Transaction.get",arguments,1);var n=Ul("Transaction.get",t,this.pf);return this.bf.D_([n.w_]).then(function(t){if(!t||1!==t.length)return Dr();var r=t[0];if(r instanceof xs)return new Al(e.pf,n.w_,null,!1,!1,n.m_);if(r instanceof Rs)return new Al(e.pf,n.w_,r,!1,!1,n.m_);throw Dr()})},t.prototype.set=function(t,e,n){Gr("Transaction.set",arguments,2,3);var r=Ul("Transaction.set",t,this.pf);n=kl("Transaction.set",n);var i=Ml(r.m_,e,n),o=el(this.pf.Ef,"Transaction.set",r.w_,i,null!==r.m_,n);return this.bf.set(r.w_,o),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return"string"==typeof e||e instanceof Vh?(Br("Transaction.update",arguments,3),r=Ul("Transaction.update",t,this.pf),i=rl(this.pf.Ef,"Transaction.update",r.w_,e,n,o)):(qr("Transaction.update",arguments,2),r=Ul("Transaction.update",t,this.pf),i=nl(this.pf.Ef,"Transaction.update",r.w_,e)),this.bf.update(r.w_,i),this},t.prototype.delete=function(t){qr("Transaction.delete",arguments,1);var e=Ul("Transaction.delete",t,this.pf);return this.bf.delete(e.w_),this},t}(),Il=function(){function t(t){this.pf=t,this.vf=[],this.Sf=!1}return t.prototype.set=function(t,e,n){Gr("WriteBatch.set",arguments,2,3),this.Df();var r=Ul("WriteBatch.set",t,this.pf);n=kl("WriteBatch.set",n);var i=Ml(r.m_,e,n),o=el(this.pf.Ef,"WriteBatch.set",r.w_,i,null!==r.m_,n);return this.vf=this.vf.concat(o.T_(r.w_,ls.Ge())),this},t.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Df(),"string"==typeof e||e instanceof Vh?(Br("WriteBatch.update",arguments,3),r=Ul("WriteBatch.update",t,this.pf),i=rl(this.pf.Ef,"WriteBatch.update",r.w_,e,n,o)):(qr("WriteBatch.update",arguments,2),r=Ul("WriteBatch.update",t,this.pf),i=nl(this.pf.Ef,"WriteBatch.update",r.w_,e)),this.vf=this.vf.concat(i.T_(r.w_,ls.exists(!0))),this},t.prototype.delete=function(t){qr("WriteBatch.delete",arguments,1),this.Df();var e=Ul("WriteBatch.delete",t,this.pf);return this.vf=this.vf.concat(new As(e.w_,ls.Ge())),this},t.prototype.commit=function(){return this.Df(),this.Sf=!0,this.vf.length>0?this.pf._f().write(this.vf):Promise.resolve()},t.prototype.Df=function(){if(this.Sf)throw new Ir(Er.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),_l=function(t){function e(e,n,r){var i=this;return(i=t.call(this,n.d_,e,r)||this).w_=e,i.firestore=n,i.m_=r,i.ff=i.firestore._f(),i}return s(e,t),e.gf=function(t,n,r){if(t.length%2!=0)throw new Ir(Er.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.R()+" has "+t.length);return new e(new Fr(t),n,r)},Object.defineProperty(e.prototype,"id",{get:function(){return this.w_.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new Pl(this.w_.path.h(),this.firestore,this.m_)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.w_.path.R()},enumerable:!1,configurable:!0}),e.prototype.collection=function(t){if(qr("DocumentReference.collection",arguments,1),zr("DocumentReference.collection","non-empty string",1,t),!t)throw new Ir(Er.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Vr.P(t);return new Pl(this.w_.path.child(e),this.firestore,null)},e.prototype.isEqual=function(t){if(!(t instanceof e))throw ei("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.w_.isEqual(t.w_)&&this.m_===t.m_},e.prototype.set=function(t,e){Gr("DocumentReference.set",arguments,1,2),e=kl("DocumentReference.set",e);var n=Ml(this.m_,t,e),r=el(this.firestore.Ef,"DocumentReference.set",this.w_,n,null!==this.m_,e);return this.ff.write(r.T_(this.w_,ls.Ge()))},e.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return"string"==typeof t||t instanceof Vh?(Br("DocumentReference.update",arguments,2),n=rl(this.firestore.Ef,"DocumentReference.update",this.w_,t,e,r)):(qr("DocumentReference.update",arguments,1),n=nl(this.firestore.Ef,"DocumentReference.update",this.w_,t)),this.ff.write(n.T_(this.w_,ls.exists(!0)))},e.prototype.delete=function(){return qr("DocumentReference.delete",arguments,0),this.ff.write([new As(this.w_,ls.Ge())])},e.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Gr("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||yl(i[u])||(ti("DocumentReference.onSnapshot",s=i[u],["includeMetadataChanges"]),Wr("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++);var a={includeMetadataChanges:s.includeMetadataChanges};if(yl(i[u])){var c=i[u];i[u]=null===(t=c.next)||void 0===t?void 0:t.bind(c),i[u+1]=null===(e=c.error)||void 0===e?void 0:e.bind(c),i[u+2]=null===(n=c.complete)||void 0===n?void 0:n.bind(c)}else zr("DocumentReference.onSnapshot","function",u,i[u]),Hr("DocumentReference.onSnapshot","function",u+1,i[u+1]),Hr("DocumentReference.onSnapshot","function",u+2,i[u+2]);var h={next:function(t){i[u]&&i[u](r.Cf(t))},error:i[u+1],complete:i[u+2]};return this.ff.listen(Vs(this.w_.path),a,h)},e.prototype.get=function(t){var e=this;Gr("DocumentReference.get",arguments,0,1),Vl("DocumentReference.get",t);var n=this.firestore._f();return t&&"cache"===t.source?n.j_(this.w_).then(function(t){return new Al(e.firestore,e.w_,t,!0,t instanceof Rs&&t.Ye,e.m_)}):n.K_(this.w_,t).then(function(t){return e.Cf(t)})},e.prototype.withConverter=function(t){return new e(this.w_,this.firestore,t)},e.prototype.Cf=function(t){var e=t.docs.get(this.w_);return new Al(this.firestore,this.w_,e,t.fromCache,t.hasPendingWrites,this.m_)},e}(Kh),Tl=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Al=function(){function t(t,e,n,r,i,o){this.pf=t,this.w_=e,this.Nf=n,this.Ff=r,this.xf=i,this.m_=o}return t.prototype.data=function(t){var e=this;if(Gr("DocumentSnapshot.data",arguments,0,1),t=Cl("DocumentSnapshot.data",t),this.Nf){if(this.m_){var n=new Nl(this.pf,this.w_,this.Nf,this.Ff,this.xf,null);return this.m_.fromFirestore(n,t)}return new gl(this.pf.d_,this.pf.yf(),t.serverTimestamps||"none",function(t){return new _l(t,e.pf,null)},function(t){return new di(t)}).tf(this.Nf.sn())}},t.prototype.get=function(t,e){var n=this;if(Gr("DocumentSnapshot.get",arguments,1,2),e=Cl("DocumentSnapshot.get",e),this.Nf){var r=this.Nf.data().field(cl("DocumentSnapshot.get",t,this.w_));if(null!==r)return new gl(this.pf.d_,this.pf.yf(),e.serverTimestamps||"none",function(t){return new _l(t,n.pf,n.m_)},function(t){return new di(t)}).tf(r)}},Object.defineProperty(t.prototype,"id",{get:function(){return this.w_.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new _l(this.w_,this.pf,this.m_)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this.Nf},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new Tl(this.xf,this.Ff)},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw ei("isEqual","DocumentSnapshot",1,e);return this.pf===e.pf&&this.Ff===e.Ff&&this.w_.isEqual(e.w_)&&(null===this.Nf?null===e.Nf:this.Nf.isEqual(e.Nf))&&this.m_===e.m_},t}(),Nl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.data=function(e){return t.prototype.data.call(this,e)},e}(Al);function Sl(t,e,n){if("string"==typeof n){if(""===n)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!qs(e)&&-1!==n.indexOf("/"))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Vr.P(n));if(!Fr.F(r))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return mo(t,new Fr(r))}if(n instanceof Kh)return mo(t,n.w_);throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Jr(n)+".")}function Ol(t,e){if(!Array.isArray(t)||0===t.length)throw new Ir(Er.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Ir(Er.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(t.indexOf(null)>=0)throw new Ir(Er.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(t.filter(function(t){return Number.isNaN(t)}).length>0)throw new Ir(Er.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function Dl(t,e,n){if(!n.isEqual(e))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Ll(t){if(Ms(t)&&0===t.rn.length)throw new Ir(Er.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Rl=function(){function t(t,e,n){this.$f=t,this.firestore=e,this.m_=n}return t.prototype.where=function(e,n,r){qr("Query.where",arguments,3),Zr("Query.where",3,r);var i=Kr("Query.where",["<","<=","==","!=",">=",">","array-contains","in","array-contains-any","not-in"],2,n),o=cl("Query.where",e),s=function(t,e,n,r,i,o,s){var u;if(i.p()){if("array-contains"===o||"array-contains-any"===o)throw new Ir(Er.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Ol(s,o);for(var a=[],c=0,h=s;c<h.length;c++){var l=h[c];a.push(Sl(r,t,l))}u={arrayValue:{values:a}}}else u=Sl(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Ol(s,o),u=il(n,e,s,"in"===o||"not-in"===o);var f=Js.create(i,o,u);return function(t,e){if(e.un()){var n=js(t);if(null!==n&&!n.isEqual(e.field))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=Fs(t);null!==r&&Dl(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==i)throw i===e.op?new Ir(Er.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Ir(Er.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(this.$f,"Query.where",this.firestore.Ef,this.firestore.d_,o,i,r);return new t(function(t,e){var n=t.filters.concat([e]);return new ks(t.path,t.collectionGroup,t.rn.slice(),n,t.limit,t.on,t.startAt,t.endAt)}(this.$f,s),this.firestore,this.m_)},t.prototype.orderBy=function(e,n){var r;if(Gr("Query.orderBy",arguments,1,2),Hr("Query.orderBy","non-empty string",2,n),void 0===n||"asc"===n)r="asc";else{if("desc"!==n)throw new Ir(Er.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r="desc"}var i=cl("Query.orderBy",e),o=function(t,e,n){if(null!==t.startAt)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new lu(e,n);return function(t,e){if(null===Fs(t)){var n=js(t);null!==n&&Dl(0,n,e.field)}}(t,r),r}(this.$f,i,r);return new t(function(t,e){var n=t.rn.concat([e]);return new ks(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.on,t.startAt,t.endAt)}(this.$f,o),this.firestore,this.m_)},t.prototype.limit=function(e){return qr("Query.limit",arguments,1),zr("Query.limit","number",1,e),ni("Query.limit",1,e),new t(zs(this.$f,e,"F"),this.firestore,this.m_)},t.prototype.limitToLast=function(e){return qr("Query.limitToLast",arguments,1),zr("Query.limitToLast","number",1,e),ni("Query.limitToLast",1,e),new t(zs(this.$f,e,"L"),this.firestore,this.m_)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Br("Query.startAt",arguments,1);var i=this.kf("Query.startAt",e,n,!0);return new t(Hs(this.$f,i),this.firestore,this.m_)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Br("Query.startAfter",arguments,1);var i=this.kf("Query.startAfter",e,n,!1);return new t(Hs(this.$f,i),this.firestore,this.m_)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Br("Query.endBefore",arguments,1);var i=this.kf("Query.endBefore",e,n,!0);return new t($s(this.$f,i),this.firestore,this.m_)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Br("Query.endAt",arguments,1);var i=this.kf("Query.endAt",e,n,!1);return new t($s(this.$f,i),this.firestore,this.m_)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw ei("isEqual","Query",1,e);return this.firestore===e.firestore&&Ws(this.$f,e.$f)&&this.m_===e.m_},t.prototype.withConverter=function(e){return new t(this.$f,this.firestore,e)},t.prototype.kf=function(t,e,n,r){if(Zr(t,1,e),e instanceof Al)return qr(t,c([e],n),1),function(t,e,n,r,i){if(!r)throw new Ir(Er.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],s=0,u=Bs(t);s<u.length;s++){var a=u[s];if(a.field.p())o.push(mo(e,r.key));else{var c=r.field(a.field);if(oo(c))throw new Ir(Er.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=a.field.R();throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new uu(o,i)}(this.$f,this.firestore.d_,t,e.Nf,r);var i=[e].concat(n);return function(t,e,n,r,i,o){var s=t.rn;if(i.length>s.length)throw new Ir(Er.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.p()){if("string"!=typeof c)throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!qs(t)&&-1!==c.indexOf("/"))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Vr.P(c));if(!Fr.F(h))throw new Ir(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var l=new Fr(h);u.push(mo(e,l))}else{var f=il(n,r,c);u.push(f)}}return new uu(u,o)}(this.$f,this.firestore.d_,this.firestore.Ef,t,i,r)},t.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Gr("Query.onSnapshot",arguments,1,4);var s={},u=0;if("object"!=typeof i[u]||yl(i[u])||(ti("Query.onSnapshot",s=i[u],["includeMetadataChanges"]),Wr("Query.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++),yl(i[u])){var a=i[u];i[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),i[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),i[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)}else zr("Query.onSnapshot","function",u,i[u]),Hr("Query.onSnapshot","function",u+1,i[u+1]),Hr("Query.onSnapshot","function",u+2,i[u+2]);var c={next:function(t){i[u]&&i[u](new xl(r.firestore,r.$f,t,r.m_))},error:i[u+1],complete:i[u+2]};return Ll(this.$f),this.firestore._f().listen(this.$f,s,c)},t.prototype.get=function(t){var e=this;Gr("Query.get",arguments,0,1),Vl("Query.get",t),Ll(this.$f);var n=this.firestore._f();return(t&&"cache"===t.source?n.G_(this.$f):n.z_(this.$f,t)).then(function(t){return new xl(e.firestore,e.$f,t,e.m_)})},t}(),xl=function(){function t(t,e,n,r){this.pf=t,this.Mf=e,this.Of=n,this.m_=r,this.Lf=null,this.Bf=null,this.metadata=new Tl(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this.Of.docs.m()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.Of.docs.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;Gr("QuerySnapshot.forEach",arguments,1,2),zr("QuerySnapshot.forEach","function",1,t),this.Of.docs.forEach(function(r){t.call(e,n.qf(r,n.metadata.fromCache,n.Of.Qt.has(r.key)))})},Object.defineProperty(t.prototype,"query",{get:function(){return new Rl(this.Mf,this.pf,this.m_)},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){t&&(ti("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Wr("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.Of.jt)throw new Ir(Er.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Lf&&this.Bf===e||(this.Lf=function(t,e,n){if(t.Ut.m()){var r=0;return t.docChanges.map(function(e){var i=n(e.doc,t.fromCache,t.Qt.has(e.doc.key));return e.doc,{type:"added",doc:i,oldIndex:-1,newIndex:r++}})}var i=t.Ut;return t.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var r=n(e.doc,t.fromCache,t.Qt.has(e.doc.key)),o=-1,s=-1;return 0!==e.type&&(o=i.indexOf(e.doc.key),i=i.delete(e.doc.key)),1!==e.type&&(s=(i=i.add(e.doc)).indexOf(e.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Dr()}}(e.type),doc:r,oldIndex:o,newIndex:s}})}(this.Of,e,this.qf.bind(this)),this.Bf=e),this.Lf},t.prototype.isEqual=function(e){if(!(e instanceof t))throw ei("isEqual","QuerySnapshot",1,e);return this.pf===e.pf&&Ws(this.Mf,e.Mf)&&this.Of.isEqual(e.Of)&&this.m_===e.m_},t.prototype.qf=function(t,e,n){return new Nl(this.pf,t.key,t,e,n,this.m_)},t}(),Pl=function(t){function e(e,n,r){var i;if((i=t.call(this,Vs(e),n,r)||this).Uf=e,e.length%2!=1)throw new Ir(Er.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.R()+" has "+e.length);return i}return s(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.$f.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this.$f.path.h();return t.m()?null:new _l(new Fr(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this.$f.path.R()},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){Gr("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=si.k()),zr("CollectionReference.doc","non-empty string",1,t);var e=Vr.P(t);return _l.gf(this.$f.path.child(e),this.firestore,this.m_)},e.prototype.add=function(t){qr("CollectionReference.add",arguments,1);var e=this.m_?this.m_.toFirestore(t):t;zr("CollectionReference.add","object",1,e);var n=this.doc();return new _l(n.w_,this.firestore,null).set(e).then(function(){return n})},e.prototype.withConverter=function(t){return new e(this.Uf,this.firestore,t)},e}(Rl);function kl(t,e){if(void 0===e)return{merge:!1};if(ti(t,e,["merge","mergeFields"]),Wr(t,"boolean","merge",e.merge),function(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){if(!(r instanceof Array))throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Jr(r));for(var o=0;o<r.length;++o)if(!i(r[o]))throw new Ir(Er.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+o+" was: "+Jr(r[o]))}(t,"mergeFields",0,r,function(t){return"string"==typeof t||t instanceof Vh})}(t,0,0,e.mergeFields),void 0!==e.mergeFields&&void 0!==e.merge)throw new Ir(Er.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Cl(t,e){return void 0===e?{}:(ti(t,e,["serverTimestamps"]),Qr(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Vl(t,e){Hr(t,"object",1,e),e&&(ti(t,e,["source"]),Qr(t,0,"source",e.source,["default","server","cache"]))}function Ul(t,e,n){if(e instanceof Kh){if(e.firestore!==n)throw new Ir(Er.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw ei(t,"DocumentReference",1,e)}function Ml(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Fl={Firestore:bl,GeoPoint:Wh,Timestamp:gi,Blob:di,Transaction:El,WriteBatch:Il,DocumentReference:_l,DocumentSnapshot:Al,Query:Rl,QueryDocumentSnapshot:Nl,QuerySnapshot:xl,CollectionReference:Pl,FieldPath:Vh,FieldValue:Hh,setLogLevel:bl.setLogLevel,CACHE_SIZE_UNLIMITED:ml};function jl(t){!function(t,e){t.INTERNAL.registerComponent(new br("firestore",function(t){return function(t,e){var n=new Ph,r=new xh(n);return new bl(t,e,r,n)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},Fl)))}(t),t.registerVersion("@firebase/firestore","1.17.1")}jl(i.default),t.__PRIVATE_registerFirestore=jl,Object.defineProperty(t,"__esModule",{value:!0})}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@firebase/app")):"function"==typeof define&&define.amd?define(["exports","@firebase/app"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).firebase=t.firebase||{},t.firebase["firestore-lite"]=t.firebase["firestore-lite"]||{}),t.firebase.app)}(this,function(t,e){"use strict";try{(function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var r="FirebaseError",i=function(t){function e(n,i){var s=t.call(this,i)||this;return s.code=n,s.name=r,Object.setPrototypeOf(s,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(s,o.prototype.create),s}return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e}(Error),o=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?function(t,e){return t.replace(a,function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"})}(s,r):"Error",c=this.serviceName+": "+u+" ("+o+").",h=new i(o,c),l=0,f=Object.keys(r);l<f.length;l++){var p=f[l];"_"!==p.slice(-1)&&(p in h&&console.warn('Overwriting FirebaseError base field "'+p+'" can cause unexpected behavior.'),h[p]=r[p])}return h},t}();var s,u,a=/\{\$([^}]+)}/g,c=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}();function h(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(u=t.LogLevel||(t.LogLevel={}))[u.DEBUG=0]="DEBUG",u[u.VERBOSE=1]="VERBOSE",u[u.INFO=2]="INFO",u[u.WARN=3]="WARN",u[u.ERROR=4]="ERROR",u[u.SILENT=5]="SILENT";var l={debug:t.LogLevel.DEBUG,verbose:t.LogLevel.VERBOSE,info:t.LogLevel.INFO,warn:t.LogLevel.WARN,error:t.LogLevel.ERROR,silent:t.LogLevel.SILENT},f=t.LogLevel.INFO,p=((s={})[t.LogLevel.DEBUG]="log",s[t.LogLevel.VERBOSE]="log",s[t.LogLevel.INFO]="info",s[t.LogLevel.WARN]="warn",s[t.LogLevel.ERROR]="error",s),d=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=p[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,h(["["+i+"]  "+t.name+":"],n))}},v=function(){function e(t){this.name=t,this._logLevel=f,this._logHandler=d,this._userLogHandler=null}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in t.LogLevel))throw new TypeError('Invalid value "'+e+'" assigned to `logLevel`');this._logLevel=e},enumerable:!1,configurable:!0}),e.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?l[t]:t},Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),e.prototype.debug=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,h([this,t.LogLevel.DEBUG],e)),this._logHandler.apply(this,h([this,t.LogLevel.DEBUG],e))},e.prototype.log=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,h([this,t.LogLevel.VERBOSE],e)),this._logHandler.apply(this,h([this,t.LogLevel.VERBOSE],e))},e.prototype.info=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,h([this,t.LogLevel.INFO],e)),this._logHandler.apply(this,h([this,t.LogLevel.INFO],e))},e.prototype.warn=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,h([this,t.LogLevel.WARN],e)),this._logHandler.apply(this,h([this,t.LogLevel.WARN],e))},e.prototype.error=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,h([this,t.LogLevel.ERROR],e)),this._logHandler.apply(this,h([this,t.LogLevel.ERROR],e))},e}();const y="ok",g="cancelled",m="unknown",w="invalid-argument",b="deadline-exceeded",E="not-found",I="already-exists",_="permission-denied",T="unauthenticated",A="resource-exhausted",N="failed-precondition",S="aborted",O="out-of-range",D="unimplemented",L="internal",R="unavailable",x="data-loss";class P extends Error{constructor(t,e){super(e),this.code=t,this.message=e,this.name="FirebaseError",this.toString=(()=>`${this.name}: [code=${this.code}]: ${this.message}`)}}const k=new v("@firebase/firestore");function C(e,...n){if(k.logLevel<=t.LogLevel.DEBUG){const t=n.map(U);k.debug("Firestore (7.21.1): "+e,...t)}}function V(e,...n){if(k.logLevel<=t.LogLevel.ERROR){const t=n.map(U);k.error("Firestore (7.21.1): "+e,...t)}}function U(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function M(t="Unexpected state"){const e="FIRESTORE (7.21.1) INTERNAL ASSERTION FAILED: "+t;throw V(e),new Error(e)}function F(t,e){t||M()}function j(t,e){return t}function q(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}class B{static t(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const r=q(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length))}return n}}function G(t,e){return t<e?-1:t>e?1:0}function z(t,e,n){return t.length===e.length&&t.every((t,r)=>n(t,e[r]))}class H{constructor(t,e,n,r,i){this.i=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}}class ${constructor(t,e){this.projectId=t,this.database=e||"(default)"}get o(){return"(default)"===this.database}isEqual(t){return t instanceof $&&t.projectId===this.projectId&&t.database===this.database}u(t){return G(this.projectId,t.projectId)||G(this.database,t.database)}}class W{constructor(t){this.uid=t}h(){return null!=this.uid}l(){return this.h()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}W.UNAUTHENTICATED=new W(null),W._=new W("google-credentials-uid"),W.m=new W("first-party-uid");class Q{constructor(t,e){this.user=e,this.type="OAuth",this.p={},this.p.Authorization="Bearer "+t}}class K{constructor(t){this.I=null,this.currentUser=W.UNAUTHENTICATED,this.A=!1,this.T=0,this.P=null,this.forceRefresh=!1,this.I=(()=>{this.T++,this.currentUser=this.R(),this.A=!0,this.P&&this.P(this.currentUser)}),this.T=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.I):(this.I(null),t.get().then(t=>{this.auth=t,this.I&&this.auth.addAuthTokenListener(this.I)},()=>{}))}getToken(){const t=this.T,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(e=>this.T!==t?(C("FirebaseCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(F("string"==typeof e.accessToken),new Q(e.accessToken,this.currentUser)):null):Promise.resolve(null)}V(){this.forceRefresh=!0}g(t){this.P=t,this.A&&t(this.currentUser)}v(){this.auth&&this.auth.removeAuthTokenListener(this.I),this.I=null,this.P=null}R(){const t=this.auth&&this.auth.getUid();return F(null===t||"string"==typeof t),new W(t)}}class Y{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new P(w,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new P(w,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new P(w,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new P(w,"Timestamp seconds out of range: "+t)}static now(){return Y.fromMillis(Date.now())}static fromDate(t){return Y.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3);return new Y(e,1e6*(t-1e3*e))}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}N(t){return this.seconds===t.seconds?G(this.nanoseconds,t.nanoseconds):G(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class X{constructor(t){this.timestamp=t}static $(t){return new X(t)}static min(){return new X(new Y(0,0))}u(t){return this.timestamp.N(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}F(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}D(){return this.timestamp}}class J{constructor(t,e,n){void 0===e?e=0:e>t.length&&M(),void 0===n?n=t.length-e:n>t.length-e&&M(),this.segments=t,this.offset=e,this.q=n}get length(){return this.q}isEqual(t){return 0===J.S(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof J?t.forEach(t=>{e.push(t)}):e.push(t),this.O(e)}limit(){return this.offset+this.length}C(t){return t=void 0===t?1:t,this.O(this.segments,this.offset+t,this.length-t)}L(){return this.O(this.segments,this.offset,this.length-1)}U(){return this.segments[this.offset]}M(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}j(){return 0===this.length}B(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}k(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}G(){return this.segments.slice(this.offset,this.limit())}static S(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const n=t.get(r),i=e.get(r);if(n<i)return-1;if(n>i)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class Z extends J{O(t,e,n){return new Z(t,e,n)}W(){return this.G().join("/")}toString(){return this.W()}static Y(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new P(w,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter(t=>t.length>0))}return new Z(e)}static H(){return new Z([])}}const tt=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class et extends J{O(t,e,n){return new et(t,e,n)}static K(t){return tt.test(t)}W(){return this.G().map(t=>(t=t.replace("\\","\\\\").replace("`","\\`"),et.K(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.W()}J(){return 1===this.length&&"__name__"===this.get(0)}static Z(){return new et(["__name__"])}static X(t){const e=[];let n="",r=0;const i=()=>{if(0===n.length)throw new P(w,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let o=!1;for(;r<t.length;){const e=t[r];if("\\"===e){if(r+1===t.length)throw new P(w,"Path has trailing escape character: "+t);const e=t[r+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new P(w,"Path has invalid escape sequence: "+t);n+=e,r+=2}else"`"===e?(o=!o,r++):"."!==e||o?(n+=e,r++):(i(),r++)}if(i(),o)throw new P(w,"Unterminated ` in path: "+t);return new et(e)}static H(){return new et([])}}class nt{constructor(t){this.path=t}static tt(t){return new nt(Z.Y(t))}static nt(t){return new nt(Z.Y(t).C(5))}et(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}isEqual(t){return null!==t&&0===Z.S(this.path,t.path)}toString(){return this.path.toString()}static S(t,e){return Z.S(t.path,e.path)}static rt(t){return t.length%2==0}static st(t){return new nt(new Z(t.slice()))}}function rt(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function it(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}class ot{constructor(t){this.it=t}static fromBase64String(t){const e=atob(t);return new ot(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new ot(e)}toBase64(){return t=this.it,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.it)}ot(){return 2*this.it.length}u(t){return G(this.it,t.it)}isEqual(t){return this.it===t.it}}function st(t){return null==t}function ut(t){return 0===t&&1/t==-1/0}function at(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ct(t){const e=yt(t.mapValue.fields.__local_write_time__.timestampValue);return new Y(e.seconds,e.nanos)}ot.ut=new ot("");const ht=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function lt(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?at(t)?4:10:M()}function ft(t,e){const n=lt(t);if(n!==lt(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ct(t).isEqual(ct(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=yt(t.timestampValue),r=yt(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return mt(t.bytesValue).isEqual(mt(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return gt(t.geoPointValue.latitude)===gt(e.geoPointValue.latitude)&&gt(t.geoPointValue.longitude)===gt(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return gt(t.integerValue)===gt(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=gt(t.doubleValue),r=gt(e.doubleValue);return n===r?ut(n)===ut(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return z(t.arrayValue.values||[],e.arrayValue.values||[],ft);case 10:return function(t,e){const n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(rt(n)!==rt(r))return!1;for(const t in n)if(n.hasOwnProperty(t)&&(void 0===r[t]||!ft(n[t],r[t])))return!1;return!0}(t,e);default:return M()}}function pt(t,e){return void 0!==(t.values||[]).find(t=>ft(t,e))}function dt(t,e){const n=lt(t),r=lt(e);if(n!==r)return G(n,r);switch(n){case 0:return 0;case 1:return G(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=gt(t.integerValue||t.doubleValue),r=gt(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return vt(t.timestampValue,e.timestampValue);case 4:return vt(ct(t),ct(e));case 5:return G(t.stringValue,e.stringValue);case 6:return function(t,e){const n=mt(t),r=mt(e);return n.u(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),r=e.split("/");for(let t=0;t<n.length&&t<r.length;t++){const e=G(n[t],r[t]);if(0!==e)return e}return G(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=G(gt(t.latitude),gt(e.latitude));return 0!==n?n:G(gt(t.longitude),gt(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],r=e.values||[];for(let t=0;t<n.length&&t<r.length;++t){const e=dt(n[t],r[t]);if(e)return e}return G(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){const n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(let t=0;t<r.length&&t<o.length;++t){const e=G(r[t],o[t]);if(0!==e)return e;const s=dt(n[r[t]],i[o[t]]);if(0!==s)return s}return G(r.length,o.length)}(t.mapValue,e.mapValue);default:throw M()}}function vt(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return G(t,e);const n=yt(t),r=yt(e),i=G(n.seconds,r.seconds);return 0!==i?i:G(n.nanos,r.nanos)}function yt(t){if(F(!!t),"string"==typeof t){let e=0;const n=ht.exec(t);if(F(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:gt(t.seconds),nanos:gt(t.nanos)}}function gt(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function mt(t){return"string"==typeof t?ot.fromBase64String(t):ot.fromUint8Array(t)}function wt(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.W()}`}}function bt(t){return!!t&&"arrayValue"in t}function Et(t){return!!t&&"nullValue"in t}function It(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function _t(t){return!!t&&"mapValue"in t}class Tt{constructor(t,e=null,n=[],r=[],i=null,o=null,s=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.at=null}}function At(t,e=null,n=[],r=[],i=null,o=null,s=null){return new Tt(t,e,n,r,i,o,s)}class Nt{constructor(t,e=null,n=[],r=[],i=null,o="F",s=null,u=null){this.path=t,this.collectionGroup=e,this.ct=n,this.filters=r,this.limit=i,this.ht=o,this.startAt=s,this.endAt=u,this.lt=null,this.ft=null,this.startAt,this.endAt}}function St(t){return!st(t.limit)&&"L"===t.ht}function Ot(t){return t.ct.length>0?t.ct[0].field:null}function Dt(t){for(const e of t.filters)if(e.dt())return e.field;return null}function Lt(t){return null!==t.collectionGroup}function Rt(t){const e=j(t);if(null===e.lt){e.lt=[];const t=Dt(e),n=Ot(e);if(null!==t&&null===n)t.J()||e.lt.push(new zt(t)),e.lt.push(new zt(et.Z(),"asc"));else{let t=!1;for(const n of e.ct)e.lt.push(n),n.field.J()&&(t=!0);if(!t){const t=e.ct.length>0?e.ct[e.ct.length-1].dir:"asc";e.lt.push(new zt(et.Z(),t))}}}return e.lt}function xt(t){const e=j(t);if(!e.ft)if("F"===e.ht)e.ft=At(e.path,e.collectionGroup,Rt(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const n of Rt(e)){const e="desc"===n.dir?"asc":"desc";t.push(new zt(n.field,e))}const n=e.endAt?new Bt(e.endAt.position,!e.endAt.before):null,r=e.startAt?new Bt(e.startAt.position,!e.startAt.before):null;e.ft=At(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}return e.ft}class Pt extends class{}{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){if(t.J())return"in"===e||"not-in"===e?this._t(t,e,n):new kt(t,e,n);if(Et(n)){if("=="!==e&&"!="!==e)throw new P(w,"Invalid query. Null only supports '==' and '!=' comparisons.");return new Pt(t,e,n)}if(It(n)){if("=="!==e&&"!="!==e)throw new P(w,"Invalid query. NaN only supports '==' and '!=' comparisons.");return new Pt(t,e,n)}return"array-contains"===e?new Mt(t,n):"in"===e?new Ft(t,n):"not-in"===e?new jt(t,n):"array-contains-any"===e?new qt(t,n):new Pt(t,e,n)}static _t(t,e,n){return"in"===e?new Ct(t,n):new Vt(t,n)}matches(t){const e=t.field(this.field);return"!="===this.op?null!==e&&this.wt(dt(e,this.value)):null!==e&&lt(this.value)===lt(e)&&this.wt(dt(e,this.value))}wt(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return M()}}dt(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class kt extends Pt{constructor(t,e,n){super(t,e,n),this.key=nt.nt(n.referenceValue)}matches(t){const e=nt.S(t.key,this.key);return this.wt(e)}}class Ct extends Pt{constructor(t,e){super(t,"in",e),this.keys=Ut("in",e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}}class Vt extends Pt{constructor(t,e){super(t,"not-in",e),this.keys=Ut("not-in",e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}}function Ut(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(t=>nt.nt(t.referenceValue))}class Mt extends Pt{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.field(this.field);return bt(e)&&pt(e.arrayValue,this.value)}}class Ft extends Pt{constructor(t,e){super(t,"in",e)}matches(t){const e=t.field(this.field);return null!==e&&pt(this.value.arrayValue,e)}}class jt extends Pt{constructor(t,e){super(t,"not-in",e)}matches(t){if(pt(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.field(this.field);return null!==e&&!pt(this.value.arrayValue,e)}}class qt extends Pt{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.field(this.field);return!(!bt(e)||!e.arrayValue.values)&&e.arrayValue.values.some(t=>pt(this.value.arrayValue,t))}}class Bt{constructor(t,e){this.position=t,this.before=e}}function Gt(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ft(t.position[n],e.position[n]))return!1;return!0}class zt{constructor(t,e="asc"){this.field=t,this.dir=e}}function Ht(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var $t,Wt;function Qt(t){if(void 0===t)return V("RPC_ERROR","HTTP error has no status"),m;switch(t){case 200:return y;case 400:return N;case 401:return T;case 403:return _;case 404:return E;case 409:return S;case 416:return O;case 429:return A;case 499:return g;case 500:return m;case 501:return D;case 503:return R;case 504:return b;default:return t>=200&&t<300?y:t>=400&&t<500?N:t>=500&&t<600?L:m}}(Wt=$t||($t={}))[Wt.OK=0]="OK",Wt[Wt.CANCELLED=1]="CANCELLED",Wt[Wt.UNKNOWN=2]="UNKNOWN",Wt[Wt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Wt[Wt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Wt[Wt.NOT_FOUND=5]="NOT_FOUND",Wt[Wt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Wt[Wt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Wt[Wt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Wt[Wt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Wt[Wt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Wt[Wt.ABORTED=10]="ABORTED",Wt[Wt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Wt[Wt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Wt[Wt.INTERNAL=13]="INTERNAL",Wt[Wt.UNAVAILABLE=14]="UNAVAILABLE",Wt[Wt.DATA_LOSS=15]="DATA_LOSS";const Kt={asc:"ASCENDING",desc:"DESCENDING"},Yt={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class Xt{constructor(t,e){this.i=t,this.yt=e}}function Jt(t,e){return function(t){return"number"==typeof t&&Number.isInteger(t)&&!ut(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}(e)?{integerValue:""+e}:function(t,e){if(t.yt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ut(e)?"-0":e}}(t,e)}function Zt(t,e){return t.yt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function te(t){return F(!!t),X.$(function(t){const e=yt(t);return new Y(e.seconds,e.nanos)}(t))}function ee(t,e){return function(t){return new Z(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).W()}function ne(t,e){return ee(t.i,e.path)}function re(t,e){const n=function(t){const e=Z.Y(t);return F(le(e)),e}(e);return F(n.get(1)===t.i.projectId),F(!n.get(3)&&!t.i.database||n.get(3)===t.i.database),new nt((F((r=n).length>4&&"documents"===r.get(4)),r.C(5)));var r}function ie(t,e){return ee(t.i,e)}function oe(t){return new Z(["projects",t.i.projectId,"databases",t.i.database]).W()}function se(t,e,n){return{name:ne(t,e),fields:n.proto.mapValue.fields}}function ue(t,e){let n;if(e instanceof Ee)n={update:se(t,e.key,e.value)};else if(e instanceof Te)n={delete:ne(t,e.key)};else if(e instanceof Ie)n={update:se(t,e.key,e.data),updateMask:function(t){const e=[];return t.fields.forEach(t=>e.push(t.W())),{fieldPaths:e}}(e.Et)};else if(e instanceof _e)n={transform:{document:ne(t,e.key),fieldTransforms:e.fieldTransforms.map(t=>(function(t,e){const n=e.transform;if(n instanceof pe)return{fieldPath:e.field.W(),setToServerValue:"REQUEST_TIME"};if(n instanceof de)return{fieldPath:e.field.W(),appendMissingElements:{values:n.elements}};if(n instanceof ve)return{fieldPath:e.field.W(),removeAllFromArray:{values:n.elements}};if(n instanceof ye)return{fieldPath:e.field.W(),increment:n.It};throw M()})(0,t))}};else{if(!(e instanceof Ae))return M();n={verify:ne(t,e.key)}}return e.Tt.At||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:function(t,e){return Zt(t,e.D())}(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:M()}(t,e.Tt)),n}function ae(t,e){const n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=ie(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=ie(t,r.L()),n.structuredQuery.from=[{collectionId:r.M()}]);const i=function(t){if(0===t.length)return;const e=t.map(t=>(function(t){if("=="===t.op){if(It(t.value))return{unaryFilter:{field:he(t.field),op:"IS_NAN"}};if(Et(t.value))return{unaryFilter:{field:he(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(It(t.value))return{unaryFilter:{field:he(t.field),op:"IS_NOT_NAN"}};if(Et(t.value))return{unaryFilter:{field:he(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:he(t.field),op:function(t){return Yt[t]}(t.op),value:t.value}}})(t));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}(e.filters);i&&(n.structuredQuery.where=i);const o=function(t){if(0!==t.length)return t.map(t=>(function(t){return{field:he(t.field),direction:function(t){return Kt[t]}(t.dir)}})(t))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const s=function(t,e){return t.yt||st(e)?e:{value:e}}(t,e.limit);return null!==s&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=ce(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ce(e.endAt)),n}function ce(t){return{before:t.before,values:t.position}}function he(t){return{fieldPath:t.W()}}function le(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}class fe{constructor(){this.Pt=void 0}}class pe extends fe{}class de extends fe{constructor(t){super(),this.elements=t}}class ve extends fe{constructor(t){super(),this.elements=t}}class ye extends fe{constructor(t,e){super(),this.serializer=t,this.It=e}}class ge{constructor(t){this.fields=t,t.sort(et.S)}Rt(t){for(const e of this.fields)if(e.B(t))return!0;return!1}isEqual(t){return z(this.fields,t.fields,(t,e)=>t.isEqual(e))}}class me{constructor(t,e){this.field=t,this.transform=e}}class we{constructor(t,e){this.updateTime=t,this.exists=e}static Vt(){return new we}static exists(t){return new we(void 0,t)}static updateTime(t){return new we(t)}get At(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}class be{}class Ee extends be{constructor(t,e,n){super(),this.key=t,this.value=e,this.Tt=n,this.type=0}}class Ie extends be{constructor(t,e,n,r){super(),this.key=t,this.data=e,this.Et=n,this.Tt=r,this.type=1}}class _e extends be{constructor(t,e){super(),this.key=t,this.fieldTransforms=e,this.type=2,this.Tt=we.exists(!0)}}class Te extends be{constructor(t,e){super(),this.key=t,this.Tt=e,this.type=3}}class Ae extends be{constructor(t,e){super(),this.key=t,this.Tt=e,this.type=4}}class Ne{constructor(t){this.proto=t}static empty(){return new Ne({mapValue:{}})}field(t){if(t.j())return this.proto;{let e=this.proto;for(let n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!_t(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.M()])||null}}isEqual(t){return ft(this.proto,t.proto)}}class Se{constructor(t=Ne.empty()){this.gt=t,this.bt=new Map}set(t,e){return this.vt(t,e),this}delete(t){return this.vt(t,null),this}vt(t,e){let n=this.bt;for(let e=0;e<t.length-1;++e){const r=t.get(e);let i=n.get(r);i instanceof Map?n=i:i&&10===lt(i)?(i=new Map(Object.entries(i.mapValue.fields||{})),n.set(r,i),n=i):(i=new Map,n.set(r,i),n=i)}n.set(t.M(),e)}Nt(){const t=this.$t(et.H(),this.bt);return null!=t?new Ne(t):this.gt}$t(t,e){let n=!1;const r=this.gt.field(t),i=_t(r)?Object.assign({},r.mapValue.fields):{};return e.forEach((e,r)=>{if(e instanceof Map){const o=this.$t(t.child(r),e);null!=o&&(i[r]=o,n=!0)}else null!==e?(i[r]=e,n=!0):i.hasOwnProperty(r)&&(delete i[r],n=!0)}),n?{mapValue:{fields:i}}:null}}class Oe{constructor(t,e){this.key=t,this.version=e}}class De extends Oe{constructor(t,e,n,r){super(t,e),this.Ft=n,this.Dt=!!r.Dt,this.hasCommittedMutations=!!r.hasCommittedMutations}field(t){return this.Ft.field(t)}data(){return this.Ft}qt(){return this.Ft.proto}isEqual(t){return t instanceof De&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Dt===t.Dt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Ft.isEqual(t.Ft)}toString(){return`Document(${this.key}, ${this.version}, ${this.Ft.toString()}, {hasLocalMutations: ${this.Dt}}), {hasCommittedMutations: ${this.hasCommittedMutations}})`}get hasPendingWrites(){return this.Dt||this.hasCommittedMutations}}class Le extends Oe{constructor(t,e,n){super(t,e),this.hasCommittedMutations=!(!n||!n.hasCommittedMutations)}toString(){return`NoDocument(${this.key}, ${this.version})`}get hasPendingWrites(){return this.hasCommittedMutations}isEqual(t){return t instanceof Le&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)}}class Re{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}}class xe{constructor(t,e,n=1e3,r=1.5,i=6e4){this.xt=t,this.St=e,this.Ot=n,this.Ct=r,this.Lt=i,this.Ut=0,this.Mt=null,this.jt=Date.now(),this.reset()}reset(){this.Ut=0}Bt(){this.Ut=this.Lt}kt(t){this.cancel();const e=Math.floor(this.Ut+this.Qt()),n=Math.max(0,Date.now()-this.jt),r=Math.max(0,e-n);r>0&&C("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ut} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.Mt=this.xt.Gt(this.St,r,()=>(this.jt=Date.now(),t())),this.Ut*=this.Ct,this.Ut<this.Ot&&(this.Ut=this.Ot),this.Ut>this.Lt&&(this.Ut=this.Lt)}Wt(){null!==this.Mt&&(this.Mt.Yt(),this.Mt=null)}cancel(){null!==this.Mt&&(this.Mt.cancel(),this.Mt=null)}Qt(){return(Math.random()-.5)*this.Ut}}function Pe(){return"undefined"!=typeof document?document:null}class ke{constructor(t,e,n,r,i){this.zt=t,this.St=e,this.Ht=n,this.op=r,this.Kt=i,this.Jt=new Re,this.then=this.Jt.promise.then.bind(this.Jt.promise),this.Jt.promise.catch(t=>{})}static Zt(t,e,n,r,i){const o=Date.now()+n,s=new ke(t,e,o,r,i);return s.start(n),s}start(t){this.Xt=setTimeout(()=>this.tn(),t)}Yt(){return this.tn()}cancel(t){null!==this.Xt&&(this.clearTimeout(),this.Jt.reject(new P(g,"Operation cancelled"+(t?": "+t:""))))}tn(){this.zt.nn(()=>null!==this.Xt?(this.clearTimeout(),this.op().then(t=>this.Jt.resolve(t))):Promise.resolve())}clearTimeout(){null!==this.Xt&&(this.Kt(this),clearTimeout(this.Xt),this.Xt=null)}}class Ce{constructor(){this.en=Promise.resolve(),this.rn=[],this.sn=!1,this.on=[],this.un=null,this.an=!1,this.cn=[],this.hn=new xe(this,"async_queue_retry"),this.ln=(()=>{const t=Pe();t&&C("AsyncQueue","Visibility state changed to  ",t.visibilityState),this.hn.Wt()});const t=Pe();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.ln)}get fn(){return this.sn}nn(t){this.enqueue(t)}dn(t){this._n(),this.wn(t)}mn(){if(!this.sn){this.sn=!0;const t=Pe();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.ln)}}enqueue(t){return this._n(),this.sn?new Promise(t=>{}):this.wn(t)}pn(t){this.rn.push(t),this.nn(()=>this.yn())}async yn(){if(0!==this.rn.length){try{await this.rn[0](),this.rn.shift(),this.hn.reset()}catch(t){if(!function(t){return"IndexedDbTransactionError"===t.name}(t))throw t;C("AsyncQueue","Operation failed with retryable error: "+t)}this.rn.length>0&&this.hn.kt(()=>this.yn())}}wn(t){const e=this.en.then(()=>(this.an=!0,t().catch(t=>{throw this.un=t,this.an=!1,V("INTERNAL UNHANDLED ERROR: ",function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t}).then(t=>(this.an=!1,t))));return this.en=e,e}Gt(t,e,n){this._n(),this.cn.indexOf(t)>-1&&(e=0);const r=ke.Zt(this,t,e,n,t=>this.En(t));return this.on.push(r),r}_n(){this.un&&M()}In(){}async An(){let t;do{t=this.en,await t}while(t!==this.en)}Tn(t){for(const e of this.on)if(e.St===t)return!0;return!1}Pn(t){return this.An().then(()=>{this.on.sort((t,e)=>t.Ht-e.Ht);for(const e of this.on)if(e.Yt(),"all"!==t&&e.St===t)break;return this.An()})}Rn(t){this.cn.push(t)}En(t){const e=this.on.indexOf(t);this.on.splice(e,1)}}class Ve extends class{}{constructor(t,e,n){super(),this.credentials=t,this.Vn=e,this.serializer=n,this.gn=!1}bn(){if(this.gn)throw new P(N,"The client has already been terminated.")}vn(t,e,n){return this.bn(),this.credentials.getToken().then(r=>this.Vn.vn(t,e,n,r)).catch(t=>{throw t.code===T&&this.credentials.V(),t})}Nn(t,e,n){return this.bn(),this.credentials.getToken().then(r=>this.Vn.Nn(t,e,n,r)).catch(t=>{throw t.code===T&&this.credentials.V(),t})}terminate(){this.gn=!1}}async function Ue(t,e){const n=j(t),r=oe(n.serializer)+"/documents",i={writes:e.map(t=>ue(n.serializer,t))};await n.vn("Commit",r,i)}async function Me(t,e){const n=j(t),r=oe(n.serializer)+"/documents",i={documents:e.map(t=>ne(n.serializer,t))},o=await n.Nn("BatchGetDocuments",r,i),s=new Map;o.forEach(t=>{const e=function(t,e){return"found"in e?function(t,e){F(!!e.found),e.found.name,e.found.updateTime;const n=re(t,e.found.name),r=te(e.found.updateTime),i=new Ne({mapValue:{fields:e.found.fields}});return new De(n,r,i,{})}(t,e):"missing"in e?function(t,e){F(!!e.missing),F(!!e.readTime);const n=re(t,e.missing),r=te(e.readTime);return new Le(n,r)}(t,e):M()}(n.serializer,t);s.set(e.key.toString(),e)});const u=[];return e.forEach(t=>{const e=s.get(t.toString());F(!!e),u.push(e)}),u}const Fe={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class je extends class{constructor(t){this.$n=t,this.i=t.i;const e=t.ssl?"https":"http";this.Fn=e+"://"+t.host,this.Dn="projects/"+this.i.projectId+"/databases/"+this.i.database+"/documents"}vn(e,n,r,i){const o=this.qn(e,n);C("RestConnection","Sending: ",o,r);const s={};return this.xn(s,i),this.Sn(e,o,s,r).then(t=>(C("RestConnection","Received: ",t),t),n=>{throw function(e,...n){if(k.logLevel<=t.LogLevel.WARN){const t=n.map(U);k.warn("Firestore (7.21.1): RestConnection",...t)}}(0,e+" failed with error: ",n,"url: ",o,"request:",r),n})}Nn(t,e,n,r){return this.vn(t,e,n,r)}xn(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.21.1",t["Content-Type"]="text/plain",e)for(const n in e.p)e.p.hasOwnProperty(n)&&(t[n]=e.p[n])}qn(t,e){const n=Fe[t];return`${this.Fn}/v1/${e}:${n}`}}{constructor(t,e){super(t),this.On=e}Cn(t,e){throw new Error("Not supported by FetchConnection")}async Sn(t,e,n,r){const i=JSON.stringify(r);let o;try{o=await this.On(e,{method:"POST",headers:n,body:i})}catch(t){throw new P(Qt(t.status),"Request failed with error: "+t.statusText)}if(!o.ok)throw new P(Qt(o.status),"Request failed with error: "+o.statusText);return o.json()}}function qe(t){return new Xt(t,!0)}const Be=new Map;function Ge(t){var e,n;if(t.Ln)throw new P(N,"The client has already been terminated.");if(!Be.has(t)){C("ComponentProvider","Initializing Datastore");const r=t.Un(),i=new H(t.Mn,t.jn,null!==(e=r.host)&&void 0!==e?e:"firestore.googleapis.com",null===(n=r.ssl)||void 0===n||n,!1),o=new je(i,fetch.bind(null)),s=qe(i.i),u=function(t,e,n){return new Ve(t,o,s)}(t.Bn);Be.set(t,u)}return Be.get(t)}class ze{constructor(t,e){this.jn="(lite)",this.kn=!1,this.app=t,this.Mn=ze.Qn(t),this.Bn=new K(e)}get Gn(){return this.kn}get Ln(){return void 0!==this.Wn}Yn(t){if(this.kn)throw new P(N,"Firestore has already been started and its settings can no longer be changed. initializeFirestore() cannot be called after calling getFirestore().");this.zn=t}Un(){return this.zn||(this.zn={}),this.kn=!0,this.zn}static Qn(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new P(w,'"projectId" not provided in firebase.initializeApp.');return new $(t.options.projectId)}_delete(){return this.Wn||(this.Wn=this.Hn()),this.Wn}Hn(){return function(t){const e=Be.get(t);e&&(C("ComponentProvider","Removing Datastore"),Be.delete(t),e.terminate())}(this),Promise.resolve()}}function He(t,e,n){if(e.length!==n)throw new P(w,`Function ${t}() requires `+tn(n,"argument")+", but was called with "+tn(e.length,"argument")+".")}function $e(t,e,n){if(e.length<n)throw new P(w,`Function ${t}() requires at least `+tn(n,"argument")+", but was called with "+tn(e.length,"argument")+".")}function We(t,e,n,r){!function(t,e,n,r){let i=!1;if(!(i="object"===e?Ye(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){const i=Xe(r);throw new P(w,`Function ${t}() requires its ${n} to be of type ${e}, but it was: ${i}`)}}(t,e,Ze(n)+" argument",r)}function Qe(t){if(!nt.rt(t))throw new P(w,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Ke(t){if(nt.rt(t))throw new P(w,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Ye(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Xe(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){if(t.constructor){const e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":M()}function Je(t,e,n){if(n<=0)throw new P(w,`Function ${t}() requires its ${Ze(e)} argument to be a positive number, but it was: ${n}.`)}function Ze(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function tn(t,e){return`${t} ${e}`+(1===t?"":"s")}class en{constructor(t){!function(t,e,n,r){if(!(e instanceof Array)||e.length<1)throw new P(w,"Function FieldPath() requires its fieldNames argument to be an array with at least "+tn(1,"element")+".")}(0,t);for(let e=0;e<t.length;++e)if(We("FieldPath","string",e,t[e]),0===t[e].length)throw new P(w,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Kn=new et(t)}}class nn extends en{constructor(...t){super(t)}static documentId(){return new nn(et.Z().W())}isEqual(t){if(!(t instanceof nn))throw function(t,e,n,r){const i=Xe(r);return new P(w,`Function isEqual() requires its ${Ze(1)} argument to be a FieldPath, but it was: ${i}`)}(0,0,0,t);return this.Kn.isEqual(t.Kn)}}const rn=new RegExp("[~\\*/\\[\\]]");class on{constructor(t){this.Jn=t}}class sn extends on{Zn(t){if(2!==t.Xn)throw 1===t.Xn?t.te(this.Jn+"() can only appear at the top level of your update data"):t.te(this.Jn+"() cannot be used with set() unless you pass {merge:true}");return t.Et.push(t.path),null}isEqual(t){return t instanceof sn}}function un(t,e,n){return new bn({Xn:3,ne:e.settings.ne,methodName:t.Jn,ee:n},e.i,e.serializer,e.ignoreUndefinedProperties)}class an extends on{Zn(t){return new me(t.path,new pe)}isEqual(t){return t instanceof an}}class cn extends on{constructor(t,e){super(t),this.re=e}Zn(t){const e=un(this,t,!0),n=this.re.map(t=>Nn(t,e)),r=new de(n);return new me(t.path,r)}isEqual(t){return this===t}}class hn extends on{constructor(t,e){super(t),this.re=e}Zn(t){const e=un(this,t,!0),n=this.re.map(t=>Nn(t,e)),r=new ve(n);return new me(t.path,r)}isEqual(t){return this===t}}class ln extends on{constructor(t,e){super(t),this.se=e}Zn(t){const e=new ye(t.serializer,Jt(t.serializer,this.se));return new me(t.path,e)}isEqual(t){return this===t}}class fn{constructor(t,e){if(He("GeoPoint",arguments,2),We("GeoPoint","number",1,t),We("GeoPoint","number",2,e),!isFinite(t)||t<-90||t>90)throw new P(w,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new P(w,"Longitude must be a number between -180 and 180, but was: "+e);this.ie=t,this.oe=e}get latitude(){return this.ie}get longitude(){return this.oe}isEqual(t){return this.ie===t.ie&&this.oe===t.oe}toJSON(){return{latitude:this.ie,longitude:this.oe}}N(t){return G(this.ie,t.ie)||G(this.oe,t.oe)}}class pn{constructor(t){this.ue=t}static fromBase64String(t){try{return new pn(ot.fromBase64String(t))}catch(t){throw new P(w,"Failed to construct Bytes from Base64 string: "+t)}}static fromUint8Array(t){return new pn(ot.fromUint8Array(t))}toBase64(){return this.ue.toBase64()}toUint8Array(){return this.ue.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this.ue.isEqual(t.ue)}}class dn{constructor(t){this.ae=t}}const vn=/^__.*__$/;class yn{constructor(t,e,n){this.Mn=t,this.ce=e,this.he=n}}class gn{constructor(t,e,n){this.data=t,this.Et=e,this.fieldTransforms=n}le(t,e){const n=[];return null!==this.Et?n.push(new Ie(t,this.data,this.Et,e)):n.push(new Ee(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new _e(t,this.fieldTransforms)),n}}class mn{constructor(t,e,n){this.data=t,this.Et=e,this.fieldTransforms=n}le(t,e){const n=[new Ie(t,this.data,this.Et,e)];return this.fieldTransforms.length>0&&n.push(new _e(t,this.fieldTransforms)),n}}function wn(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw M()}}class bn{constructor(t,e,n,r,i,o){this.settings=t,this.i=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.fe(),this.fieldTransforms=i||[],this.Et=o||[]}get path(){return this.settings.path}get Xn(){return this.settings.Xn}de(t){return new bn(Object.assign(Object.assign({},this.settings),t),this.i,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Et)}_e(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.de({path:n,ee:!1});return r.we(t),r}me(t){var e;const n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.de({path:n,ee:!1});return r.fe(),r}pe(t){return this.de({path:void 0,ee:!0})}te(t){return xn(t,this.settings.methodName,this.settings.ye||!1,this.path,this.settings.ne)}contains(t){return void 0!==this.Et.find(e=>t.B(e))||void 0!==this.fieldTransforms.find(e=>t.B(e.field))}fe(){if(this.path)for(let t=0;t<this.path.length;t++)this.we(this.path.get(t))}we(t){if(0===t.length)throw this.te("Document fields must not be empty");if(wn(this.Xn)&&vn.test(t))throw this.te('Document fields cannot begin and end with "__"')}}class En{constructor(t,e,n){this.i=t,this.ignoreUndefinedProperties=e,this.serializer=n||qe(t)}Ee(t,e,n,r=!1){return new bn({Xn:t,methodName:e,ne:n,path:et.H(),ee:!1,ye:r},this.i,this.serializer,this.ignoreUndefinedProperties)}}function In(t,e,n,r,i,o={}){const s=t.Ee(o.merge||o.mergeFields?2:0,e,n,i);Dn("Data must be an object, but it was:",s,r);const u=Sn(r,s);let a,c;if(o.merge)a=new ge(s.Et),c=s.fieldTransforms;else if(o.mergeFields){const t=[];for(const r of o.mergeFields){let i;if(r instanceof en)i=r.Kn;else{if("string"!=typeof r)throw M();i=Rn(e,r,n)}if(!s.contains(i))throw new P(w,`Field '${i}' is specified in your field mask but missing from your input data.`);Pn(t,i)||t.push(i)}a=new ge(t),c=s.fieldTransforms.filter(t=>a.Rt(t.field))}else a=null,c=s.fieldTransforms;return new gn(new Ne(u),a,c)}function _n(t,e,n,r){const i=t.Ee(1,e,n);Dn("Data must be an object, but it was:",i,r);const o=[],s=new Se;it(r,(t,r)=>{const u=Rn(e,t,n),a=i.me(u);if(r instanceof sn||r instanceof dn&&r.ae instanceof sn)o.push(u);else{const t=Nn(r,a);null!=t&&(o.push(u),s.set(u,t))}});const u=new ge(o);return new mn(s.Nt(),u,i.fieldTransforms)}function Tn(t,e,n,r,i,o){const s=t.Ee(1,e,n),u=[Ln(e,r,n)],a=[i];if(o.length%2!=0)throw new P(w,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let t=0;t<o.length;t+=2)u.push(Ln(e,o[t])),a.push(o[t+1]);const c=[],h=new Se;for(let t=u.length-1;t>=0;--t)if(!Pn(c,u[t])){const e=u[t],n=a[t],r=s.me(e);if(n instanceof sn||n instanceof dn&&n.ae instanceof sn)c.push(e);else{const t=Nn(n,r);null!=t&&(c.push(e),h.set(e,t))}}const l=new ge(c);return new mn(h.Nt(),l,s.fieldTransforms)}function An(t,e,n,r=!1){return Nn(n,t.Ee(r?4:3,e))}function Nn(t,e){if(t instanceof dn&&(t=t.ae),On(t))return Dn("Unsupported field value:",e,t),Sn(t,e);if(t instanceof on)return function(t,e){if(!wn(e.Xn))throw e.te(t.Jn+"() can only be used with update() and set()");if(!e.path)throw e.te(t.Jn+"() is not currently supported inside arrays");const n=t.Zn(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(e.path&&e.Et.push(e.path),t instanceof Array){if(e.settings.ee&&4!==e.Xn)throw e.te("Nested arrays are not supported");return function(t,e){const n=[];let r=0;for(const i of t){let t=Nn(i,e.pe(r));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Jt(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const n=Y.fromDate(t);return{timestampValue:Zt(e.serializer,n)}}if(t instanceof Y){const n=new Y(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Zt(e.serializer,n)}}if(t instanceof fn)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof pn)return{bytesValue:function(t,e){return t.yt?e.toBase64():e.toUint8Array()}(e.serializer,t.ue)};if(t instanceof yn){const n=e.i,r=t.Mn;if(!r.isEqual(n))throw e.te(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:ee(t.Mn||e.i,t.ce.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.te("Unsupported field value: "+Xe(t))}(t,e)}function Sn(t,e){const n={};return function(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}(t)?e.path&&e.path.length>0&&e.Et.push(e.path):it(t,(t,r)=>{const i=Nn(r,e._e(t));null!=i&&(n[t]=i)}),{mapValue:{fields:n}}}function On(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Y||t instanceof fn||t instanceof pn||t instanceof yn||t instanceof on)}function Dn(t,e,n){if(!On(n)||!Ye(n)){const r=Xe(n);throw"an object"===r?e.te(t+" a custom object"):e.te(t+" "+r)}}function Ln(t,e,n){if(e instanceof en)return e.Kn;if("string"==typeof e)return Rn(t,e);throw xn("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Rn(t,e,n){try{return function(t){if(t.search(rn)>=0)throw new P(w,`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`);try{return new nn(...t.split("."))}catch(e){throw new P(w,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`)}}(e).Kn}catch(e){throw xn((r=e)instanceof Error?r.message:r.toString(),t,!1,void 0,n)}var r}function xn(t,e,n,r,i){const o=r&&!r.j(),s=void 0!==i;let u=`Function ${e}() called with invalid data`;n&&(u+=" (via `toFirestore()`)");let a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new P(w,(u+=". ")+t+a)}function Pn(t,e){return t.some(t=>t.isEqual(e))}class kn{constructor(t,e,n,r,i){this.i=t,this.timestampsInSnapshots=e,this.Ie=n,this.Ae=r,this.Te=i}Pe(t){switch(lt(t)){case 0:return null;case 1:return t.booleanValue;case 2:return gt(t.integerValue||t.doubleValue);case 3:return this.Re(t.timestampValue);case 4:return this.Ve(t);case 5:return t.stringValue;case 6:return this.Te(mt(t.bytesValue));case 7:return this.ge(t.referenceValue);case 8:return this.be(t.geoPointValue);case 9:return this.ve(t.arrayValue);case 10:return this.Ne(t.mapValue);default:throw M()}}Ne(t){const e={};return it(t.fields||{},(t,n)=>{e[t]=this.Pe(n)}),e}be(t){return new fn(gt(t.latitude),gt(t.longitude))}ve(t){return(t.values||[]).map(t=>this.Pe(t))}Ve(t){switch(this.Ie){case"previous":const e=function t(e){const n=e.mapValue.fields.__previous_value__;return at(n)?t(n):n}(t);return null==e?null:this.Pe(e);case"estimate":return this.Re(ct(t));default:return null}}Re(t){const e=yt(t),n=new Y(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()}ge(t){const e=Z.Y(t);F(le(e));const n=new $(e.get(1),e.get(3)),r=new nt(e.C(5));return n.isEqual(this.i)||V(`Document ${r} contains a document reference within a different database (${n.projectId}/${n.database}) which is not supported. It will be treated as a reference in the current database (${this.i.projectId}/${this.i.database}) instead.`),this.Ae(r)}}class Cn{constructor(t,e,n,r){this.$e=t,this.ce=e,this.Fe=n,this.he=r}get id(){return this.ce.path.M()}get ref(){return new $n(this.$e,this.he,this.ce.path)}exists(){return null!==this.Fe}data(){if(this.Fe){if(this.he){const t=new Vn(this.$e,this.ce,this.Fe,null);return this.he.fromFirestore(t)}return new kn(this.$e.Mn,!0,"none",t=>new $n(this.$e,null,t.path),t=>new pn(t)).Pe(this.Fe.qt())}}get(t){if(this.Fe){const e=this.Fe.data().field(Mn("DocumentSnapshot.get",t));if(null!==e)return new kn(this.$e.Mn,!0,"none",t=>new $n(this.$e,this.he,t.path),t=>new pn(t)).Pe(e)}}}class Vn extends Cn{data(){return super.data()}}class Un{constructor(t,e){this.De=e,this.query=t}get docs(){return[...this.De]}get size(){return this.docs.length}get empty(){return 0===this.docs.length}forEach(t,e){this.De.forEach(t,e)}}function Mn(t,e){return"string"==typeof e?Rn(t,e):e.Kn}class Fn{constructor(t){this.qe=t,this.xe=new Map,this.mutations=[],this.Se=!1,this.Oe=null,this.Ce=new Set}async Le(t){if(this.Ue(),this.mutations.length>0)throw new P(w,"Firestore transactions require all reads to be executed before all writes.");const e=await Me(this.qe,t);return e.forEach(t=>{t instanceof Le||t instanceof De?this.Me(t):M()}),e}set(t,e){this.write(e.le(t,this.Tt(t))),this.Ce.add(t.toString())}update(t,e){try{this.write(e.le(t,this.je(t)))}catch(t){this.Oe=t}this.Ce.add(t.toString())}delete(t){this.write([new Te(t,this.Tt(t))]),this.Ce.add(t.toString())}async commit(){if(this.Ue(),this.Oe)throw this.Oe;const t=this.xe;this.mutations.forEach(e=>{t.delete(e.key.toString())}),t.forEach((t,e)=>{const n=nt.tt(e);this.mutations.push(new Ae(n,this.Tt(n)))}),await Ue(this.qe,this.mutations),this.Se=!0}Me(t){let e;if(t instanceof De)e=t.version;else{if(!(t instanceof Le))throw M();e=X.min()}const n=this.xe.get(t.key.toString());if(n){if(!e.isEqual(n))throw new P(S,"Document version changed between two reads.")}else this.xe.set(t.key.toString(),e)}Tt(t){const e=this.xe.get(t.toString());return!this.Ce.has(t.toString())&&e?we.updateTime(e):we.Vt()}je(t){const e=this.xe.get(t.toString());if(!this.Ce.has(t.toString())&&e){if(e.isEqual(X.min()))throw new P(w,"Can't update a document that doesn't exist.");return we.updateTime(e)}return we.exists(!0)}write(t){this.Ue(),this.mutations=this.mutations.concat(t)}Ue(){}}class jn{constructor(t,e,n,r){this.zt=t,this.qe=e,this.updateFunction=n,this.Jt=r,this.Be=5,this.hn=new xe(this.zt,"transaction_retry")}run(){this.ke()}ke(){this.hn.kt(async()=>{const t=new Fn(this.qe),e=this.Qe(t);e&&e.then(e=>{this.zt.nn(()=>t.commit().then(()=>{this.Jt.resolve(e)}).catch(t=>{this.Ge(t)}))}).catch(t=>{this.Ge(t)})})}Qe(t){try{const e=this.updateFunction(t);return!st(e)&&e.catch&&e.then?e:(this.Jt.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Jt.reject(t),null}}Ge(t){this.Be>0&&this.We(t)?(this.Be-=1,this.zt.nn(()=>(this.ke(),Promise.resolve()))):this.Jt.reject(t)}We(t){if("FirebaseError"===t.name){const e=t.code;return"aborted"===e||"failed-precondition"===e||!function(t){switch(e){case y:return M();case g:case m:case b:case A:case L:case R:case T:return!1;case w:case E:case I:case _:case N:case S:case O:case D:case x:return!0;default:return M()}}()}return!1}}function qn(t,e,n){if("string"==typeof n){if(""===n)throw new P(w,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Lt(e)&&-1!==n.indexOf("/"))throw new P(w,`Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Z.Y(n));if(!nt.rt(r))throw new P(w,`Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return wt(t,new nt(r))}if(n instanceof yn)return wt(t,n.ce);throw new P(w,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Xe(n)+".")}function Bn(t,e){if(!Array.isArray(t)||0===t.length)throw new P(w,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(t.length>10)throw new P(w,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`);if("in"===e||"array-contains-any"===e){if(t.indexOf(null)>=0)throw new P(w,`Invalid Query. '${e.toString()}' filters cannot contain 'null' in the value array.`);if(t.filter(t=>Number.isNaN(t)).length>0)throw new P(w,`Invalid Query. '${e.toString()}' filters cannot contain 'NaN' in the value array.`)}}function Gn(t,e,n){if(!n.isEqual(e))throw new P(w,`Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}function zn(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}class Hn extends en{constructor(...t){super(t)}isEqual(t){return this.Kn.isEqual(t.Kn)}}class $n extends yn{constructor(t,e,n){super(t.Mn,new nt(n),e),this.Ye=n,this.type="document",this.firestore=t}get id(){return this.Ye.M()}get path(){return this.Ye.W()}get parent(){return new er(this.firestore,this.he,this.ce.path.L())}withConverter(t){return new $n(this.firestore,t,this.Ye)}}class Wn{constructor(t,e,n){this.he=e,this.ze=n,this.type="query",this.firestore=t}withConverter(t){return new Wn(this.firestore,t,this.ze)}}class Qn{}class Kn extends Qn{constructor(t,e,n){super(),this.Ke=t,this.Je=e,this.Ze=n,this.type="where"}He(t){const e=ir(t.firestore),n=function(t,e,n,r,i,o,s){let u;if(i.J()){if("array-contains"===o||"array-contains-any"===o)throw new P(w,`Invalid Query. You can't perform '${o}' queries on FieldPath.documentId().`);if("in"===o||"not-in"===o){Bn(s,o);const e=[];for(const n of s)e.push(qn(r,t,n));u={arrayValue:{values:e}}}else u=qn(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Bn(s,o),u=An(n,e,s,"in"===o||"not-in"===o);const a=Pt.create(i,o,u);return function(t,e){if(e.dt()){const n=Dt(t);if(null!==n&&!n.isEqual(e.field))throw new P(w,`Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${e.field.toString()}'`);const r=Ot(t);null!==r&&Gn(0,e.field,r)}const n=function(t,e){for(const n of t.filters)if(e.indexOf(n.op)>=0)return n.op;return null}(t,function(t){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==n)throw n===e.op?new P(w,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new P(w,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}(t,a),a}(t.ze,"where",e,t.firestore.Mn,this.Ke,this.Je,this.Ze);return new Wn(t.firestore,t.he,function(t,e){const n=t.filters.concat([e]);return new Nt(t.path,t.collectionGroup,t.ct.slice(),n,t.limit,t.ht,t.startAt,t.endAt)}(t.ze,n))}}class Yn extends Qn{constructor(t,e){super(),this.Ke=t,this.Xe=e,this.type="orderBy"}He(t){const e=function(t,e,n){if(null!==t.startAt)throw new P(w,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new P(w,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const r=new zt(e,n);return function(t,e){if(null===Ot(t)){const n=Dt(t);null!==n&&Gn(0,n,e.field)}}(t,r),r}(t.ze,this.Ke,this.Xe);return new Wn(t.firestore,t.he,function(t,e){const n=t.ct.concat([e]);return new Nt(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.ht,t.startAt,t.endAt)}(t.ze,e))}}class Xn extends Qn{constructor(t,e,n){super(),this.type=t,this.tr=e,this.nr=n}He(t){return new Wn(t.firestore,t.he,function(t,e,n){return new Nt(t.path,t.collectionGroup,t.ct.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}(t.ze,this.tr,this.nr))}}class Jn extends Qn{constructor(t,e,n){super(),this.type=t,this.er=e,this.rr=n}He(t){const e=tr(t,this.type,this.er,this.rr);return new Wn(t.firestore,t.he,function(t,e){return new Nt(t.path,t.collectionGroup,t.ct.slice(),t.filters.slice(),t.limit,t.ht,e,t.endAt)}(t.ze,e))}}class Zn extends Qn{constructor(t,e,n){super(),this.type=t,this.er=e,this.rr=n}He(t){const e=tr(t,this.type,this.er,this.rr);return new Wn(t.firestore,t.he,function(t,e){return new Nt(t.path,t.collectionGroup,t.ct.slice(),t.filters.slice(),t.limit,t.ht,t.startAt,e)}(t.ze,e))}}function tr(t,e,n,r){if(n[0]instanceof Cn)return He(e,n,1),function(t,e,n,r,i){if(!r)throw new P(E,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");const o=[];for(const n of Rt(t))if(n.field.J())o.push(wt(e,r.key));else{const t=r.field(n.field);if(at(t))throw new P(w,'Invalid query. You are trying to start or end a query using a document for which the field "'+n.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===t){const t=n.field.W();throw new P(w,`Invalid query. You are trying to start or end a query using a document for which the field '${t}' (used as the orderBy) does not exist.`)}o.push(t)}return new Bt(o,i)}(t.ze,t.firestore.Mn,e,n[0].Fe,r);{const i=ir(t.firestore);return function(t,e,n,r,i,o){const s=t.ct;if(i.length>s.length)throw new P(w,`Too many arguments provided to ${r}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const u=[];for(let o=0;o<i.length;o++){const a=i[o];if(s[o].field.J()){if("string"!=typeof a)throw new P(w,`Invalid query. Expected a string for document ID in ${r}(), but got a ${typeof a}`);if(!Lt(t)&&-1!==a.indexOf("/"))throw new P(w,`Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to ${r}() must be a plain document ID, but '${a}' contains a slash.`);const n=t.path.child(Z.Y(a));if(!nt.rt(n))throw new P(w,`Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to ${r}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);const i=new nt(n);u.push(wt(e,i))}else{const t=An(n,r,a);u.push(t)}}return new Bt(u,o)}(t.ze,t.firestore.Mn,i,e,n,r)}}class er extends Wn{constructor(t,e,n){super(t,e,new Nt(n)),this.firestore=t,this.Ye=n,this.type="collection"}get id(){return this.ze.path.M()}get path(){return this.ze.path.W()}get parent(){const t=this.Ye.L();return t.j()?null:new $n(this.firestore,null,t)}withConverter(t){return new er(this.firestore,t,this.Ye)}}function nr(t,e,...n){if(1===arguments.length&&(e=B.t()),or("doc","path",e),t instanceof ze){const r=Z.Y(e,...n);return Qe(r),new $n(t,null,r)}{if(!(t instanceof $n||t instanceof er))throw new P(w,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t.Ye.child(Z.Y(e,...n));return Qe(r),new $n(t.firestore,t instanceof er?t.he:null,r)}}function rr(t,e){return t instanceof Wn&&e instanceof Wn&&t.firestore===e.firestore&&function(t,e){return function(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Ht(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let i=0;i<t.filters.length;i++)if(n=t.filters[i],r=e.filters[i],n.op!==r.op||!n.field.isEqual(r.field)||!ft(n.value,r.value))return!1;var n,r;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Gt(t.startAt,e.startAt)&&Gt(t.endAt,e.endAt)}(xt(t),xt(e))&&t.ht===e.ht}(t.ze,e.ze)&&t.he===e.he}function ir(t){const e=t.Un(),n=qe(t.Mn);return new En(t.Mn,!!e.ignoreUndefinedProperties,n)}function or(t,e,n){if(!n)throw new P(w,`Function ${t}() cannot be called with an empty ${e}.`)}class sr{constructor(t,e){this.$e=t,this.sr=e,this.ir=[],this.ur=!1,this.ar=ir(t)}set(t,e,n){this.cr();const r=ur(t,this.$e),i=zn(r.he,e,n),o=In(this.ar,"WriteBatch.set",r.ce,i,null!==r.he,n);return this.ir=this.ir.concat(o.le(r.ce,we.Vt())),this}update(t,e,n,...r){this.cr();const i=ur(t,this.$e);let o;return o="string"==typeof e||e instanceof Hn?Tn(this.ar,"WriteBatch.update",i.ce,e,n,r):_n(this.ar,"WriteBatch.update",i.ce,e),this.ir=this.ir.concat(o.le(i.ce,we.exists(!0))),this}delete(t){this.cr();const e=ur(t,this.$e);return this.ir=this.ir.concat(new Te(e.ce,we.Vt())),this}commit(){return this.cr(),this.ur=!0,this.ir.length>0?this.sr(this.ir):Promise.resolve()}cr(){if(this.ur)throw new P(N,"A write batch can no longer be used after commit() has been called.")}}function ur(t,e){if(t.firestore!==e)throw new P(w,"Provided document reference is from a different Firestore instance.");return t}class ar{constructor(t,e){this.$e=t,this.hr=e,this.ar=ir(t)}get(t){const e=ur(t,this.$e);return this.hr.Le([e.ce]).then(t=>{if(!t||1!==t.length)return M();const n=t[0];if(n instanceof Le)return new Cn(this.$e,e.ce,null,e.he);if(n instanceof De)return new Cn(this.$e,n.key,n,e.he);throw M()})}set(t,e,n){const r=ur(t,this.$e),i=zn(r.he,e,n),o=In(this.ar,"Transaction.set",r.ce,i,null!==r.he,n);return this.hr.set(r.ce,o),this}update(t,e,n,...r){const i=ur(t,this.$e);let o;return o="string"==typeof e||e instanceof Hn?Tn(this.ar,"Transaction.update",i.ce,e,n,r):_n(this.ar,"Transaction.update",i.ce,e),this.hr.update(i.ce,o),this}delete(t){const e=ur(t,this.$e);return this.hr.delete(e.ce),this}}e._registerComponent(new c("firestore/lite",t=>((t,e)=>new ze(t,e))(t.getProvider("app-exp").getImmediate(),t.getProvider("auth-internal")),"PUBLIC")),e.registerVersion("firestore-lite","0.0.800","node"),t.Bytes=pn,t.CollectionReference=er,t.DocumentReference=$n,t.DocumentSnapshot=Cn,t.FieldPath=Hn,t.FieldValue=on,t.FirebaseFirestore=ze,t.FirestoreError=P,t.GeoPoint=fn,t.Query=Wn,t.QueryConstraint=Qn,t.QueryDocumentSnapshot=Vn,t.QuerySnapshot=Un,t.Timestamp=Y,t.Transaction=ar,t.WriteBatch=sr,t.addDoc=function(t,e){const n=nr(t),r=zn(t.he,e),i=In(ir(t.firestore),"addDoc",n.ce,r,null!==n.he,{});return Ue(Ge(t.firestore),i.le(n.ce,we.exists(!1))).then(()=>n)},t.arrayRemove=function(...t){return $e("arrayRemove()",arguments,1),new hn("arrayRemove",t)},t.arrayUnion=function(...t){return $e("arrayUnion()",arguments,1),new cn("arrayUnion",t)},t.collection=function(t,e,...n){if(or("collection","path",e),t instanceof ze){const r=Z.Y(e,...n);return Ke(r),new er(t,null,r)}{if(!(t instanceof $n||t instanceof er))throw new P(w,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=Z.Y(t.path,...n).child(Z.Y(e));return Ke(r),new er(t.firestore,null,r)}},t.collectionGroup=function(t,e){if(or("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new P(w,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Wn(t,null,function(t){return new Nt(Z.H(),t)}(e))},t.deleteDoc=function(t){return Ue(Ge(t.firestore),[new Te(t.ce,we.Vt())])},t.deleteField=function(){return new sn("deleteField")},t.doc=nr,t.documentId=function(){return new Hn("__name__")},t.endAt=function(...t){return new Zn("endAt",t,!1)},t.endBefore=function(...t){return new Zn("endBefore",t,!0)},t.getDoc=function(t){return Me(Ge(t.firestore),[t.ce]).then(e=>{F(1===e.length);const n=e[0];return new Cn(t.firestore,t.ce,n instanceof De?n:null,t.he)})},t.getDocs=function(t){return function(t){if(St(t)&&0===t.ct.length)throw new P(D,"limitToLast() queries require specifying at least one orderBy() clause")}(t.ze),async function(t,e){const n=j(t),r=ae(n.serializer,xt(e));return(await n.Nn("RunQuery",r.parent,{structuredQuery:r.structuredQuery})).filter(t=>!!t.document).map(t=>(function(t,e,n){const r=re(t,e.name),i=te(e.updateTime),o=new Ne({mapValue:{fields:e.fields}});return new De(r,i,o,{hasCommittedMutations:!1})})(n.serializer,t.document))}(Ge(t.firestore),t.ze).then(e=>{const n=e.map(e=>new Vn(t.firestore,e.key,e,t.he));return St(t.ze)&&n.reverse(),new Un(t,n)})},t.getFirestore=function(t){return e._getProvider(t,"firestore/lite").getImmediate()},t.increment=function(t){return new ln("increment",t)},t.initializeFirestore=function(t,n){const r=e._getProvider(t,"firestore/lite").getImmediate();return r.Yn(n),r},t.limit=function(t){return Je("limit",1,t),new Xn("limit",t,"F")},t.limitToLast=function(t){return Je("limitToLast",1,t),new Xn("limitToLast",t,"L")},t.orderBy=function(t,e="asc"){const n=e,r=Mn("orderBy",t);return new Yn(r,n)},t.query=function(t,...e){for(const n of e)t=n.He(t);return t},t.queryEqual=rr,t.refEqual=function(t,e){return(t instanceof $n||t instanceof er)&&(e instanceof $n||e instanceof er)&&t.firestore===e.firestore&&t.path===e.path&&t.he===e.he},t.runTransaction=function(t,e){const n=Ge(t),r=new Re;return new jn(new Ce,n,n=>e(new ar(t,n)),r).run(),r.promise},t.serverTimestamp=function(){return new an("serverTimestamp")},t.setDoc=function(t,e,n){const r=zn(t.he,e,n),i=In(ir(t.firestore),"setDoc",t.ce,r,null!==t.he,n);return Ue(Ge(t.firestore),i.le(t.ce,we.Vt()))},t.setLogLevel=function(t){k.setLogLevel(t)},t.snapshotEqual=function t(e,n){return e instanceof Cn&&n instanceof Cn?e.$e===n.$e&&e.ce.isEqual(n.ce)&&(null===e.Fe?null===n.Fe:e.Fe.isEqual(n.Fe))&&e.he===n.he:e instanceof Un&&n instanceof Un&&rr(e.query,n.query)&&z(e.docs,n.docs,t)},t.startAfter=function(...t){return new Jn("startAfter",t,!1)},t.startAt=function(...t){return new Jn("startAt",t,!0)},t.terminate=function(t){return e._removeServiceInstance(t.app,"firestore/lite"),t._delete()},t.updateDoc=function(t,e,n,...r){const i=ir(t.firestore);let o;return o="string"==typeof e||e instanceof Hn?Tn(i,"updateDoc",t.ce,e,n,r):_n(i,"updateDoc",t.ce,e),Ue(Ge(t.firestore),o.le(t.ce,we.exists(!0)))},t.where=function(t,e,n){const r=e,i=Mn("where",t);return new Kn(i,r,n)},t.writeBatch=function(t){const e=Ge(t);return new sr(t,t=>Ue(e,t))},Object.defineProperty(t,"__esModule",{value:!0})}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore-lite.js - be sure to load firebase-app.js first.")}}),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@firebase/app")):"function"==typeof define&&define.amd?define(["exports","@firebase/app"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).firebase=t.firebase||{},t.firebase.performance=t.firebase.performance||{}),t.firebase.app)}(this,function(t,e){"use strict";try{(function(){var n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var r=function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}var o="FirebaseError",s=function(t){function e(n,r){var i=t.call(this,r)||this;return i.code=n,i.name=o,Object.setPrototypeOf(i,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,u.prototype.create),i}return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e}(Error),u=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],u=o?function(t,e){return t.replace(h,function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"})}(o,r):"Error",a=this.serviceName+": "+u+" ("+i+").",c=new s(i,a),l=0,f=Object.keys(r);l<f.length;l++){var p=f[l];"_"!==p.slice(-1)&&(p in c&&console.warn('Overwriting FirebaseError base field "'+p+'" can cause unexpected behavior.'),c[p]=r[p])}return c},t}();var a,c,h=/\{\$([^}]+)}/g;function l(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(c||(c={}));var f,p,d,v={debug:c.DEBUG,verbose:c.VERBOSE,info:c.INFO,warn:c.WARN,error:c.ERROR,silent:c.SILENT},y=c.INFO,g=((a={})[c.DEBUG]="log",a[c.VERBOSE]="log",a[c.INFO]="info",a[c.WARN]="warn",a[c.ERROR]="error",a),m=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=g[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,l(["["+i+"]  "+t.name+":"],n))}},w=function(){function t(t){this.name=t,this._logLevel=y,this._logHandler=m,this._userLogHandler=null}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in c))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?v[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,l([this,c.DEBUG],t)),this._logHandler.apply(this,l([this,c.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,l([this,c.VERBOSE],t)),this._logHandler.apply(this,l([this,c.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,l([this,c.INFO],t)),this._logHandler.apply(this,l([this,c.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,l([this,c.WARN],t)),this._logHandler.apply(this,l([this,c.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,l([this,c.ERROR],t)),this._logHandler.apply(this,l([this,c.ERROR],t))},t}(),b=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),E="0.0.800",I="FB-PERF-TRACE-START",_="FB-PERF-TRACE-STOP",T="FB-PERF-TRACE-MEASURE",A="_wt_",N="@firebase/performance/config",S="@firebase/performance/configexpire",O=((f={})["trace started"]="Trace {$traceName} was started before.",f["trace stopped"]="Trace {$traceName} is not running.",f["no window"]="Window is not available.",f["no app id"]="App id is not available.",f["no project id"]="Project id is not available.",f["no api key"]="Api key is not available.",f["invalid cc log"]="Attempted to queue invalid cc event",f["FB not default"]="Performance can only start when Firebase app instance is the default one.",f["RC response not ok"]="RC response is not ok",f["invalid attribute name"]="Attribute name {$attributeName} is invalid.",f["invalid attribute value"]="Attribute value {$attributeValue} is invalid.",f["invalid custom metric name"]="Custom metric name {$customMetricName} is invalid",f["invalid String merger input"]="Input for String merger is invalid, contact support team to resolve.",f),D=new u("performance","Performance",O),L=new w("Performance");L.logLevel=c.INFO;var R,x,P=function(){function t(t){if(this.window=t,!t)throw D.create("no window");this.performance=t.performance,this.PerformanceObserver=t.PerformanceObserver,this.windowLocation=t.location,this.navigator=t.navigator,this.document=t.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=t.localStorage),t.perfMetrics&&t.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=t.perfMetrics.onFirstInputDelay)}return t.prototype.getUrl=function(){return this.windowLocation.href.split("?")[0]},t.prototype.mark=function(t){this.performance&&this.performance.mark&&this.performance.mark(t)},t.prototype.measure=function(t,e,n){this.performance&&this.performance.measure&&this.performance.measure(t,e,n)},t.prototype.getEntriesByType=function(t){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(t):[]},t.prototype.getEntriesByName=function(t){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(t):[]},t.prototype.getTimeOrigin=function(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)},t.prototype.requiredApisAvailable=function(){return fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled?"indexedDB"in self&&null!=indexedDB||(L.info("IndexedDB is not supported by current browswer"),!1):(L.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)},t.prototype.setupObserver=function(t,e){this.PerformanceObserver&&new this.PerformanceObserver(function(t){for(var n=0,r=t.getEntries();n<r.length;n++){var i=r[n];e(i)}}).observe({entryTypes:[t]})},t.getInstance=function(){return void 0===p&&(p=new t(d)),p},t}();function k(){return R}function C(t,e){var n=t.length-e.length;if(n<0||n>1)throw D.create("invalid String merger input");for(var r=[],i=0;i<t.length;i++)r.push(t.charAt(i)),e.length>i&&r.push(e.charAt(i));return r.join("")}var V,U=function(){function t(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=C("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=C("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}return t.prototype.getFlTransportFullUrl=function(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)},t.getInstance=function(){return void 0===x&&(x=new t),x},t}();!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.VISIBLE=1]="VISIBLE",t[t.HIDDEN=2]="HIDDEN"}(V||(V={}));var M=["firebase_","google_","ga_"],F=new RegExp("^[a-zA-Z]\\w*$"),j=40,q=100;function B(){switch(P.getInstance().document.visibilityState){case"visible":return V.VISIBLE;case"hidden":return V.HIDDEN;default:return V.UNKNOWN}}function G(t){var e,n=null===(e=t.options)||void 0===e?void 0:e.appId;if(!n)throw D.create("no app id");return n}var z="0.0.1",H={loggingEnabled:!0},$="FIREBASE_INSTALLATIONS_AUTH";function W(t,e){var n=function(){var t=P.getInstance().localStorage;if(!t)return;var e=t.getItem(S);if(!(e&&(n=e,Number(n)>Date.now())))return;var n;var r=t.getItem(N);if(!r)return;try{var i=JSON.parse(r);return i}catch(t){return}}();return n?(K(n),Promise.resolve()):function(t,e){return(n=t.installations,r=n.getToken(),r.then(function(t){}),r).then(function(n){var r=function(t){var e,n=null===(e=t.options)||void 0===e?void 0:e.projectId;if(!n)throw D.create("no project id");return n}(t.app),i=function(t){var e,n=null===(e=t.options)||void 0===e?void 0:e.apiKey;if(!n)throw D.create("no api key");return n}(t.app),o="https://firebaseremoteconfig.googleapis.com/v1/projects/"+r+"/namespaces/fireperf:fetch?key="+i,s=new Request(o,{method:"POST",headers:{Authorization:$+" "+n},body:JSON.stringify({app_instance_id:e,app_instance_id_token:n,app_id:G(t.app),app_version:E,sdk_version:z})});return fetch(s).then(function(t){if(t.ok)return t.json();throw D.create("RC response not ok")})}).catch(function(){L.info(Q)});var n,r}(t,e).then(K).then(function(t){return function(t){var e=P.getInstance().localStorage;if(!t||!e)return;e.setItem(N,JSON.stringify(t)),e.setItem(S,String(Date.now()+60*U.getInstance().configTimeToLive*60*1e3))}(t)},function(){})}var Q="Could not fetch config, will use default configs";function K(t){if(!t)return t;var e=U.getInstance(),n=t.entries||{};return void 0!==n.fpr_enabled?e.loggingEnabled="true"===String(n.fpr_enabled):e.loggingEnabled=H.loggingEnabled,n.fpr_log_source&&(e.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(e.logEndPointUrl=n.fpr_log_endpoint_url),n.fpr_log_transport_key&&(e.transportKey=n.fpr_log_transport_key),void 0!==n.fpr_vc_network_request_sampling_rate&&(e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),e.logTraceAfterSampling=Y(e.tracesSamplingRate),e.logNetworkAfterSampling=Y(e.networkRequestsSamplingRate),t}function Y(t){return Math.random()<=t}var X,J=1;function Z(t){return J=2,X=X||function(t){return(e=P.getInstance().document,new Promise(function(t){if(e&&"complete"!==e.readyState){var n=function(){"complete"===e.readyState&&(e.removeEventListener("readystatechange",n),t())};e.addEventListener("readystatechange",n)}else t()})).then(function(){return e=t.installations,(n=e.getId()).then(function(t){R=t}),n;var e,n}).then(function(e){return W(t,e)}).then(function(){return tt()},function(){return tt()});var e}(t)}function tt(){J=3}var et,nt=1e4,rt=5500,it=3,ot=it,st=[],ut=!1;function at(t){setTimeout(function(){if(0!==ot)return st.length?void function(){var t=i(st);st=[];var e=t.map(function(t){return{source_extension_json_proto3:t.message,event_time_ms:String(t.eventTime)}});(function(t,e){return function(t){var e=U.getInstance().getFlTransportFullUrl();return fetch(e,{method:"POST",body:JSON.stringify(t)})}(t).then(function(t){return t.ok||L.info("Call to Firebase backend failed."),t.json()}).then(function(t){var n=Number(t.nextRequestWaitMillis),r=nt;isNaN(n)||(r=Math.max(n,r));var o=t.logResponseDetails;Array.isArray(o)&&o.length>0&&"RETRY_REQUEST_LATER"===o[0].responseAction&&(st=i(e,st),L.info("Retry transport request later.")),ot=it,at(r)})})({request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:U.getInstance().logSource,log_event:e},t).catch(function(){st=i(t,st),ot--,L.info("Tries left: "+ot+"."),at(nt)})}():at(nt)},t)}function ct(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];!function(t){if(!t.eventTime||!t.message)throw D.create("invalid cc log");st=i(st,[t])}({message:t.apply(void 0,e),eventTime:Date.now()})}}function ht(t,e){et||(et=ct(pt)),et(t,e)}function lt(t){var e=U.getInstance();!e.instrumentationEnabled&&t.isAuto||(e.dataCollectionEnabled||t.isAuto)&&P.getInstance().requiredApisAvailable()&&(t.isAuto&&B()!==V.VISIBLE||e.loggingEnabled&&e.logTraceAfterSampling&&(3===J?ft(t):Z(t.performanceController).then(function(){return ft(t)},function(){return ft(t)})))}function ft(t){k()&&setTimeout(function(){return ht(t,1)},0)}function pt(t,e){return 0===e?(r={url:(n=t).url,http_method:n.httpMethod||0,http_response_code:200,response_payload_bytes:n.responsePayloadBytes,client_start_time_us:n.startTimeUs,time_to_response_initiated_us:n.timeToResponseInitiatedUs,time_to_response_completed_us:n.timeToResponseCompletedUs},i={application_info:dt(n.performanceController.app),network_request_metric:r},JSON.stringify(i)):function(t){var e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};0!==Object.keys(t.counters).length&&(e.counters=t.counters);var n=t.getAttributes();0!==Object.keys(n).length&&(e.custom_attributes=n);var r={application_info:dt(t.performanceController.app),trace_metric:e};return JSON.stringify(r)}(t);var n,r,i}function dt(t){return{google_app_id:G(t),app_instance_id:k(),web_app_info:{sdk_version:E,page_url:P.getInstance().getUrl(),service_worker_status:(e=P.getInstance().navigator,"serviceWorker"in e?e.serviceWorker.controller?2:3:1),visibility_state:B(),effective_connection_type:function(){var t=P.getInstance().navigator.connection;switch(t&&t.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}()},application_process_state:0};var e}var vt=100,yt="_",gt=["_fp","_fcp","_fid"];var mt=function(){function t(t,e,n,r){void 0===n&&(n=!1),this.performanceController=t,this.name=e,this.isAuto=n,this.state=1,this.customAttributes={},this.counters={},this.api=P.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark=I+"-"+this.randomId+"-"+this.name,this.traceStopMark=_+"-"+this.randomId+"-"+this.name,this.traceMeasure=r||T+"-"+this.randomId+"-"+this.name,r&&this.calculateTraceMetrics())}return t.prototype.start=function(){if(1!==this.state)throw D.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2},t.prototype.stop=function(){if(2!==this.state)throw D.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),lt(this)},t.prototype.record=function(t,e,n){if(this.durationUs=Math.floor(1e3*e),this.startTimeUs=Math.floor(1e3*t),n&&n.attributes&&(this.customAttributes=r({},n.attributes)),n&&n.metrics)for(var i=0,o=Object.keys(n.metrics);i<o.length;i++){var s=o[i];isNaN(Number(n.metrics[s]))||(this.counters[s]=Number(Math.floor(n.metrics[s])))}lt(this)},t.prototype.incrementMetric=function(t,e){void 0===e&&(e=1),void 0===this.counters[t]?this.putMetric(t,e):this.putMetric(t,this.counters[t]+e)},t.prototype.putMetric=function(t,e){if(i=t,o=this.name,0===i.length||i.length>vt||!(o&&o.startsWith(A)&&gt.indexOf(i)>-1)&&i.startsWith(yt))throw D.create("invalid custom metric name",{customMetricName:t});var n,r,i,o;this.counters[t]=(n=e,(r=Math.floor(n))<n&&L.info("Metric value should be an Integer, setting the value as : "+r+"."),r)},t.prototype.getMetric=function(t){return this.counters[t]||0},t.prototype.putAttribute=function(t,e){var n,r=!(0===(n=t).length||n.length>j||M.some(function(t){return n.startsWith(t)})||!n.match(F)),i=function(t){return 0!==t.length&&t.length<=q}(e);if(r&&i)this.customAttributes[t]=e;else{if(!r)throw D.create("invalid attribute name",{attributeName:t});if(!i)throw D.create("invalid attribute value",{attributeValue:e})}},t.prototype.getAttribute=function(t){return this.customAttributes[t]},t.prototype.removeAttribute=function(t){void 0!==this.customAttributes[t]&&delete this.customAttributes[t]},t.prototype.getAttributes=function(){return r({},this.customAttributes)},t.prototype.setStartTime=function(t){this.startTimeUs=t},t.prototype.setDuration=function(t){this.durationUs=t},t.prototype.calculateTraceMetrics=function(){var t=this.api.getEntriesByName(this.traceMeasure),e=t&&t[0];e&&(this.durationUs=Math.floor(1e3*e.duration),this.startTimeUs=Math.floor(1e3*(e.startTime+this.api.getTimeOrigin())))},t.createOobTrace=function(e,n,r,i){var o=P.getInstance().getUrl();if(o){var s=new t(e,A+o,!0),u=Math.floor(1e3*P.getInstance().getTimeOrigin());s.setStartTime(u),n&&n[0]&&(s.setDuration(Math.floor(1e3*n[0].duration)),s.putMetric("domInteractive",Math.floor(1e3*n[0].domInteractive)),s.putMetric("domContentLoadedEventEnd",Math.floor(1e3*n[0].domContentLoadedEventEnd)),s.putMetric("loadEventEnd",Math.floor(1e3*n[0].loadEventEnd)));if(r){var a=r.find(function(t){return"first-paint"===t.name});a&&a.startTime&&s.putMetric("_fp",Math.floor(1e3*a.startTime));var c=r.find(function(t){return"first-contentful-paint"===t.name});c&&c.startTime&&s.putMetric("_fcp",Math.floor(1e3*c.startTime)),i&&s.putMetric("_fid",Math.floor(1e3*i))}lt(s)}},t.createUserTimingTrace=function(e,n){lt(new t(e,n,!1,n))},t}();function wt(t,e){var n=e;if(n&&void 0!==n.responseStart){var r=P.getInstance().getTimeOrigin(),i=Math.floor(1e3*(n.startTime+r)),o=n.responseStart?Math.floor(1e3*(n.responseStart-n.startTime)):void 0,s=Math.floor(1e3*(n.responseEnd-n.startTime));!function(t){var e=U.getInstance();if(e.instrumentationEnabled){var n=t.url,r=e.logEndPointUrl.split("?")[0],i=e.flTransportEndpointUrl.split("?")[0];n!==r&&n!==i&&e.loggingEnabled&&e.logNetworkAfterSampling&&setTimeout(function(){return ht(t,0)},0)}}({performanceController:t,url:n.name&&n.name.split("?")[0],responsePayloadBytes:n.transferSize,startTimeUs:i,timeToResponseInitiatedUs:o,timeToResponseCompletedUs:s})}}var bt=5e3;function Et(t){k()&&(setTimeout(function(){return function(t){var e=P.getInstance(),n=e.getEntriesByType("navigation"),r=e.getEntriesByType("paint");if(e.onFirstInputDelay){var i=setTimeout(function(){mt.createOobTrace(t,n,r),i=void 0},bt);e.onFirstInputDelay(function(e){i&&(clearTimeout(i),mt.createOobTrace(t,n,r,e))})}else mt.createOobTrace(t,n,r)}(t)},0),setTimeout(function(){return function(t){for(var e=P.getInstance(),n=e.getEntriesByType("resource"),r=0,i=n;r<i.length;r++){var o=i[r];wt(t,o)}e.setupObserver("resource",function(e){return wt(t,e)})}(t)},0),setTimeout(function(){return function(t){for(var e=P.getInstance(),n=e.getEntriesByType("measure"),r=0,i=n;r<i.length;r++){var o=i[r];It(t,o)}e.setupObserver("measure",function(e){return It(t,e)})}(t)},0))}function It(t,e){var n=e.name;n.substring(0,T.length)!==T&&mt.createUserTimingTrace(t,n)}var _t=function(){function t(t,e){this.app=t,this.installations=e,this.initialized=!1}return t.prototype._init=function(t){var e=this;this.initialized||(void 0!==(null==t?void 0:t.dataCollectionEnabled)&&(this.dataCollectionEnabled=t.dataCollectionEnabled),void 0!==(null==t?void 0:t.instrumentationEnabled)&&(this.instrumentationEnabled=t.instrumentationEnabled),P.getInstance().requiredApisAvailable()?new Promise(function(t,e){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=window.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||window.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}}).then(function(t){t&&(ut||(at(rt),ut=!0),Z(e).then(function(){return Et(e)},function(){return Et(e)}),e.initialized=!0)}).catch(function(t){L.info("Environment doesn't support IndexedDB: "+t)}):L.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))},Object.defineProperty(t.prototype,"instrumentationEnabled",{get:function(){return U.getInstance().instrumentationEnabled},set:function(t){U.getInstance().instrumentationEnabled=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataCollectionEnabled",{get:function(){return U.getInstance().dataCollectionEnabled},set:function(t){U.getInstance().dataCollectionEnabled=t},enumerable:!1,configurable:!0}),t}();var Tt=function(t){var e=t.getProvider("app-exp").getImmediate(),n=t.getProvider("installations-exp-internal").getImmediate();if("[DEFAULT]"!==e.name)throw D.create("FB not default");if("undefined"==typeof window)throw D.create("no window");return function(t){d=t}(window),new _t(e,n)};e._registerComponent(new b("performance-exp",Tt,"PUBLIC")),e.registerVersion("@firebase/performance-exp","0.0.800"),t.getPerformance=function(t,n){var r=e._getProvider(t,"performance-exp").getImmediate();return r._init(n),r},t.trace=function(t,e){return new mt(t,e)},Object.defineProperty(t,"__esModule",{value:!0})}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-performance.js - be sure to load firebase-app.js first.")}});
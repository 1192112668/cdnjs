!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(uy){"use strict";try{(function(){var l,t,e=(t=uy)&&"object"==typeof t&&"default"in t?t:{default:t},r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(be=l=l||{})[be.DEBUG=0]="DEBUG",be[be.VERBOSE=1]="VERBOSE",be[be.INFO=2]="INFO",be[be.WARN=3]="WARN",be[be.ERROR=4]="ERROR",be[be.SILENT=5]="SILENT";var u={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},a=l.INFO,c=((Ie={})[l.DEBUG]="log",Ie[l.VERBOSE]="log",Ie[l.INFO]="info",Ie[l.WARN]="warn",Ie[l.ERROR]="error",Ie),h=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?u[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.DEBUG],t)),this._logHandler.apply(this,s([this,l.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.VERBOSE],t)),this._logHandler.apply(this,s([this,l.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.INFO],t)),this._logHandler.apply(this,s([this,l.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.WARN],t)),this._logHandler.apply(this,s([this,l.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.ERROR],t)),this._logHandler.apply(this,s([this,l.ERROR],t))},f);function f(t){this.name=t,this._logLevel=a,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e){return(e=d.call(this,e)||this).code=t,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(I.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,t=(t=this.errors[t])?(r=i,t.replace(E,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").",s=new m(o,t),u=0,a=Object.keys(i);u<a.length;u++){var c=a[u];"_"!==c.slice(-1)&&(c in s&&console.warn('Overwriting FirebaseError base field "'+c+'" can cause unexpected behavior.'),s[c]=i[c])}return s},I);function I(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g,_=function(t,e){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function T(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,A="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S=A||self;function D(){}function O(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function x(t){var e=O(t);return"array"==e||"object"==e&&"number"==typeof t.length}function R(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var k="closure_uid_"+(1e9*Math.random()>>>0),L=0;function P(t,e,n){return t.call.apply(t.bind,arguments)}function V(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?P:V).apply(null,arguments)}function U(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var M=Date.now;function j(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,k)&&this[k]||(this[k]=++L))},F.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var q=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function G(){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function W(t){return/^[\s\xa0]*$/.test(t)}var K,H=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Q(t,e){return-1!=t.indexOf(e)}function Y(t,e){return t<e?-1:e<t?1:0}var X=S.navigator;function $(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function J(t){var e,n={};for(e in t)n[e]=t[e];return n}K=(X=X&&X.userAgent)?X:"";var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<Z.length;i++)e=Z[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function et(t){return et[" "](t),t}et[" "]=D;var nt,rt=Q(K,"Opera"),it=Q(K,"Trident")||Q(K,"MSIE"),ot=Q(K,"Edge"),st=ot||it,ut=Q(K,"Gecko")&&!(Q(K.toLowerCase(),"webkit")&&!Q(K,"Edge"))&&!(Q(K,"Trident")||Q(K,"MSIE"))&&!Q(K,"Edge"),at=Q(K.toLowerCase(),"webkit")&&!Q(K,"Edge");function ct(){var t=S.document;return t?t.documentMode:void 0}var ht="",ft=(ft=K,ut?/rv:([^\);]+)(\)|;)/.exec(ft):ot?/Edge\/([\d\.]+)/.exec(ft):it?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ft):at?/WebKit\/(\S+)/.exec(ft):rt?/(?:Version)[ \/]?(\S+)/.exec(ft):void 0);ft&&(ht=ft?ft[1]:""),nt=it&&null!=(ft=ct())&&ft>parseFloat(ht)?String(ft):ht;var lt={};function pt(u){return t=u,e=function(){for(var t=0,e=H(String(nt)).split("."),n=H(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Y(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Y(0==o[2].length,0==s[2].length)||Y(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=lt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var dt=S.document&&it&&(ct()||parseInt(nt,10))||void 0,yt=!it||9<=Number(dt),vt=it&&!pt("9"),gt=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",D,e),S.removeEventListener("test",D,e)}catch(t){}return t}();function mt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function wt(t,e){if(mt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ut){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:bt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}mt.prototype.b=function(){this.defaultPrevented=!0},j(wt,mt);var bt={2:"touch",3:"pen",4:"mouse"};wt.prototype.b=function(){wt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,vt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var It="closure_listenable_"+(1e6*Math.random()|0),Et=0;function _t(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Et,this.Y=this.Z=!1}function Tt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Nt(t){this.src=t,this.a={},this.b=0}function At(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=q(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Tt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function St(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Nt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=St(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new _t(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Dt="closure_lm_"+(1e6*Math.random()|0),Ot={};function xt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Mt(r),e&&e[It]?e.wa(n,r,R(i)?!!i.capture:!!i,o):Rt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)xt(t,e[o],n,r,i);return null}return n=Mt(n),t&&t[It]?t.va(e,n,R(r)?!!r.capture:!!r,i):Rt(t,e,n,!1,r,i)}function Rt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=R(i)?!!i.capture:!!i;if(s&&!yt)return null;var u,a,c=Ct(t);if(c||(t[Dt]=c=new Nt(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Vt,r=a=yt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)gt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Lt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function kt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[It]?At(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Lt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ct(e))?(At(n,t),0==n.b&&(n.src=null,e[Dt]=null)):Tt(t)))}function Lt(t){return t in Ot?Ot[t]:Ot[t]="on"+t}function Pt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&kt(t),n.call(r,e)}function Vt(t,e){if(t.Y)return!0;if(yt)return Pt(t,new wt(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Pt(t,e=new wt(e,this))}function Ct(t){return(t=t[Dt])instanceof Nt?t:null}var Ut="__closure_events_fn_"+(1e9*Math.random()>>>0);function Mt(e){return"function"==O(e)?e:(e[Ut]||(e[Ut]=function(t){return e.handleEvent(t)}),e[Ut])}function jt(){F.call(this),this.c=new Nt(this),(this.J=this).C=null}function Ft(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&At(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}j(jt,F),jt.prototype[It]=!0,(N=jt.prototype).addEventListener=function(t,e,n,r){xt(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=R(i)?!!i.capture:!!i,r=Mt(r),e&&e[It]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=St(s=e.a[n],r,i,o))&&(Tt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ct(e))&&(n=e.a[n.toString()],e=-1,n&&(e=St(n,r,i,o)),(r=-1<e?n[e]:null)&&kt(r))}(this,t,e,n,r)},N.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new mt(t,n):t instanceof mt?t.target=t.target||n:(s=t,tt(t=new mt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=Ft(o,r,!0,t)&&s;if(s=Ft(o=t.a=n,r,!0,t)&&s,s=Ft(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Ft(o=t.a=e[i],r,!1,t)&&s;return s},N.G=function(){if(jt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Tt(n[r]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},N.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var qt=S.JSON.stringify;function Bt(){this.b=this.a=null}var Gt,zt=(Wt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Wt(function(){return new Kt},function(t){t.reset()},100));function Wt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Kt(){this.next=this.b=this.a=null}function Ht(t,e){var n;Gt||(n=S.Promise.resolve(void 0),Gt=function(){n.then(Xt)}),Qt||(Gt(),Qt=!0),Yt.add(t,e)}Bt.prototype.add=function(t,e){var n=zt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Kt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Qt=!(Kt.prototype.reset=function(){this.next=this.b=this.a=null}),Yt=new Bt;function Xt(){for(var t,e;n=e=void 0,n=null,(e=Yt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var n=zt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Qt=!1}function $t(t,e){jt.call(this),this.b=t||1,this.a=e||S,this.f=C(this.Ya,this),this.g=M()}function Jt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Zt(t,e,n){if("function"==O(t))n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}j($t,jt),(N=$t.prototype).aa=!1,N.M=null,N.Ya=function(){var t;this.aa&&(0<(t=M()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(Jt(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=M())},N.G=function(){$t.S.G.call(this),Jt(this),delete this.a};var te,ee,ne,re=(_(ee=oe,ne=te=F),ee.prototype=null===ne?Object.create(ne):(ie.prototype=ne.prototype,new ie),oe.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=Zt(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},oe.prototype.G=function(){te.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},oe);function ie(){this.constructor=ee}function oe(t,e,n){var r=te.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function se(t){F.call(this),this.b=t,this.a={}}j(se,F);var ue=[];function ae(t,e,n,r){Array.isArray(n)||(n&&(ue[0]=n.toString()),n=ue);for(var i=0;i<n.length;i++){var o=xt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ce(t){$(t.a,function(t,e){this.a.hasOwnProperty(e)&&kt(t)},t),t.a={}}function he(){this.a=!0}function fe(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return qt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}se.prototype.G=function(){se.S.G.call(this),ce(this)},se.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},he.prototype.info=function(){};var le=null;function pe(){return le=le||new jt}function de(t){mt.call(this,"serverreachability",t)}function ye(){var t=pe();t.dispatchEvent(new de(t))}function ve(t){mt.call(this,"statevent",t)}function ge(){var t=pe();t.dispatchEvent(new ve(t))}function me(t){mt.call(this,"timingevent",t)}function we(t,e){if("function"!=O(t))throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}j(de,mt),j(ve,mt),j(me,mt);var be={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ie={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Ee(){}function _e(t){var e;return(e=t.a)||(e=t.a={}),e}function Te(){}Ee.prototype.a=null;var Ne,A={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Ae(){mt.call(this,"d")}function Se(){mt.call(this,"c")}function De(){}function Oe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new se(this),this.P=xe,t=st?125:void 0,this.R=new $t(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}j(Ae,mt),j(Se,mt),j(De,Ee),Ne=new De;var xe=45e3,Re={},ke={};function Le(t,e,n){t.H=1,t.i=tn(Qe(e)),t.j=n,t.I=!0,Pe(t,null)}function Pe(t,e){t.u=M(),Ce(t),t.l=Qe(t.i);var s,u,a,c,h,f,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),dn(n.b,"t",r),t.D=0,t.a=ur(t.g,t.g.C?e:null),0<t.O&&(t.F=new re(C(t.Ca,t,t.a),t.O)),ae(t.J,t.a,"readystatechange",t.Wa),e=t.B?J(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ye(),s=t.c,u=t.m,a=t.l,c=t.f,h=t.T,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Ve(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?ke:(i=Number(u.substring(i,o)),isNaN(i)?Re:(o+=1)+i>u.length?ke:(u=u.substr(o,i),r.D=o+i,u)));if(u==ke){4==e&&(t.h=4,ge(),s=!1),fe(t.c,t.f,null,"[Incomplete Response]");break}if(u==Re){t.h=4,ge(),fe(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}fe(t.c,t.f,u,null),qe(t,u)}4==e&&0==n.length&&(t.h=1,ge(),s=!1),t.b=t.b&&s,s?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Zn(e),e.F=!0)):(fe(t.c,t.f,n,"[Invalid Chunked Response]"),Fe(t),je(t))}function Ce(t){t.U=M()+t.P,Ue(t,t.P)}function Ue(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=we(C(t.Ua,t),e)}function Me(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function je(t){0==t.g.v||t.A||nr(t.g,t)}function Fe(t){Me(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Jt(t.R),ce(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function qe(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||In(u.b,t)))if(u.I=t.N,!t.C&&In(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;er(u),zn(u)}Jn(u),ge()}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=we(C(u.Ra,u),6e3));if(bn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else ir(u,11)}else if(!t.C&&u.a!=t||er(u),!W(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(Q(r,"spdy")||Q(r,"quic")||Q(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(En(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,Ze(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.V&&(u.N=M()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=sr(n,n.C?n.ga:null,n.fa),i.C?(_n(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Me(o),Ce(o)),n.a=i):$n(n),0<u.g.length&&Hn(u)):"stop"!=c[0]&&"close"!=c[0]||ir(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?ir(u,7):Gn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0);ye()}catch(t){}}function Be(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(x(t)||"string"==typeof t)B(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(x(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(x(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ge(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ge)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function ze(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];We(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)We(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function We(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=Oe.prototype).setTimeout=function(t){this.P=t},N.Wa=function(t){t=t.target;var e=this.F;e&&3==jn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=jn(this.a),n=this.a.ua(),r=this.a.X();if(!(e<3||3==e&&!st&&!this.a.$())){this.A||4!=e||7==n||ye(),Me(this);var i=this.a.X();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.T,f=e,l=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+f+" "+l}),this.b){if(this.V&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!W(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,ge(),Fe(this),je(this);break t}fe(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,qe(this,s)}this.I?(Ve(this,e,n),st&&this.b&&3==e&&(ae(this.J,this.R,"tick",this.Va),this.R.start())):(fe(this.c,this.f,n,null),qe(this,n)),4==e&&Fe(this),this.b&&!this.A&&(4==e?nr(this.g,this):(this.b=!1,Ce(this)))}else 400==i&&0<n.indexOf("Unknown SID")?this.h=3:this.h=0,ge(),Fe(this),je(this)}}}catch(t){}var u,a,c,h,f,l},N.Va=function(){var t,e;this.a&&(t=jn(this.a),e=this.a.$(),this.D<e.length&&(Me(this),Ve(this,t,e),this.b&&4!=t&&Ce(this)))},N.cancel=function(){this.A=!0,Fe(this)},N.Ua=function(){this.o=null;var t,e,n=M();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ye(),ge()),Fe(this),this.h=2,je(this)):Ue(this,this.U-n)},(N=Ge.prototype).K=function(){ze(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return ze(this),this.a.concat()},N.get=function(t,e){return We(this.b,t)?this.b[t]:e},N.set=function(t,e){We(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ke=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function He(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof He?(this.a=void 0!==e?e:t.a,Ye(this,t.f),this.j=t.j,Xe(this,t.c),$e(this,t.h),this.g=t.g,e=t.b,(n=new hn).c=e.c,e.a&&(n.a=new Ge(e.a),n.b=e.b),Je(this,n),this.i=t.i):t&&(n=String(t).match(Ke))?(this.a=!!e,Ye(this,n[1]||"",!0),this.j=en(n[2]||""),Xe(this,n[3]||"",!0),$e(this,n[4]),this.g=en(n[5]||"",!0),Je(this,n[6]||"",!0),this.i=en(n[7]||"")):(this.a=!!e,this.b=new hn(null,this.a))}function Qe(t){return new He(t)}function Ye(t,e,n){t.f=n?en(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Xe(t,e,n){t.c=n?en(e,!0):e}function $e(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Je(t,e,n){var r,i;e instanceof hn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(fn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(ln(this,e),dn(this,n,t))},r)),r.f=i):(n||(e=nn(e,an)),t.b=new hn(e,t.a))}function Ze(t,e,n){t.b.set(e,n)}function tn(t){return Ze(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^M()).toString(36)),t}function en(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function nn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,rn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function rn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}He.prototype.toString=function(){var t=[],e=this.f;e&&t.push(nn(e,on,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(nn(e,on,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(nn(n,"/"==n.charAt(0)?un:sn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",nn(n,cn)),t.join("")};var on=/[#\/\?@]/g,sn=/[#\?:]/g,un=/[#\?]/g,an=/[#\?@]/g,cn=/#/g;function hn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function fn(u){u.a||(u.a=new Ge,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function ln(t,e){fn(t),e=yn(t,e),We(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,We((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&ze(t)))}function pn(t,e){return fn(t),e=yn(t,e),We(t.a.b,e)}function dn(t,e,n){ln(t,e),0<n.length&&(t.c=null,t.a.set(yn(t,e),z(n)),t.b+=n.length)}function yn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function vn(t,e){this.b=t,this.a=e}function gn(t){this.g=t||mn,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(N=hn.prototype).add=function(t,e){fn(this),this.c=null,t=yn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,r){fn(this),this.a.forEach(function(t,e){B(t,function(t){n.call(r,t,e,this)},this)},this)},N.L=function(){fn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},N.K=function(t){fn(this);var e=[];if("string"==typeof t)pn(this,t)&&(e=G(e,this.a.get(yn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},N.set=function(t,e){return fn(this),this.c=null,pn(this,t=yn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var mn=10;function wn(t){return t.b||t.a&&t.a.size>=t.f}function bn(t){return t.b?1:t.a?t.a.size:0}function In(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function En(t,e){t.a?t.a.add(e):t.b=e}function _n(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Tn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=T(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Nn(){}function An(){this.a=new Nn}function Sn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}gn.prototype.cancel=function(){var t,e;if(this.c=Tn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=T(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Nn.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},Nn.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var Dn=S.JSON.parse;function On(t){jt.call(this),this.headers=new Ge,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=xn,this.D=this.F=!1}j(On,jt);var xn="",Rn=/^https?$/i,kn=["POST","PUT"];function Ln(t){return"content-type"==t.toLowerCase()}function Pn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Vn(t),Un(t)}function Vn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Cn(t){if(t.b&&(!t.s[1]||4!=jn(t)||2!=t.X()))if(t.l&&4==jn(t))Zt(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==jn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Ke)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!Rn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<jn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Vn(t)}}finally{Un(t)}}}function Un(t,e){if(t.a){Mn(t);var n=t.a,r=t.s[0]?D:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Mn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function jn(t){return t.a?t.a.readyState:0}function Fn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",$(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ze(t,e,n))}function qn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Bn(t){this.pa=0,this.g=[],this.c=new he,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=qn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=qn("baseRetryDelayMs",5e3,t),this.Ma=qn("retryDelaySeedMs",1e4,t),this.Ja=qn("forwardChannelMaxRetries",2,t),this.ma=qn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new gn(t&&t.concurrentRequestLimit),this.ka=new An,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Gn(t){var e,n;Wn(t),3==t.v&&(e=t.R++,Ze(n=Qe(t.B),"SID",t.J),Ze(n,"RID",e),Ze(n,"TYPE","terminate"),Yn(t,n),(e=new Oe(t,t.c,e,void 0)).H=2,e.i=tn(Qe(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.i.toString(),"")),!n&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=ur(e.g,null),e.a.ba(e.i)),e.u=M(),Ce(e)),or(t)}function zn(t){t.a&&(Zn(t),t.a.cancel(),t.a=null)}function Wn(t){zn(t),t.j&&(S.clearTimeout(t.j),t.j=null),er(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function Kn(t,e){t.g.push(new vn(t.La++,e)),3==t.v&&Hn(t)}function Hn(t){wn(t.b)||t.h||(t.h=!0,Ht(t.Ba,t),t.u=0)}function Qn(t,e){var n=e?e.f:t.R++,r=Qe(t.B);Ze(r,"SID",t.J),Ze(r,"RID",n),Ze(r,"AID",t.P),Yn(t,r),t.i&&t.l&&Fn(r,t.i,t.l),n=new Oe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Xn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),En(t.b,n),Le(n,r,e)}function Yn(t,n){t.f&&Be({},function(t,e){Ze(n,e,t)})}function Xn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?C(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+c+"_"||"";try{Be(t,function(t,e){var n=t;R(t)&&(n=qt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s)}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function $n(t){t.a||t.j||(t.U=1,Ht(t.Aa,t),t.o=0)}function Jn(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=we(C(t.Aa,t),rr(t,t.o)),t.o++,1)}function Zn(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function tr(t){t.a=new Oe(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Qe(t.la);Ze(e,"RID","rpc"),Ze(e,"SID",t.J),Ze(e,"CI",t.H?"0":"1"),Ze(e,"AID",t.P),Yn(t,e),Ze(e,"TYPE","xmlhttp"),t.i&&t.l&&Fn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=tn(Qe(e)),n.j=null,n.I=!0,Pe(n,t)}function er(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function nr(t,e){var n,r=null;if(t.a==e){er(t),Zn(t),t.a=null;var i=2}else{if(!In(t.b,e))return;r=e.s,_n(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b)1==i?(r=e.j?e.j.length:0,e=M()-e.u,n=t.u,(i=pe()).dispatchEvent(new me(i)),Hn(t)):$n(t);else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(bn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=we(C(t.Ba,t,e),rr(t,t.u)),t.u++,1}}(t,e)||2==i&&Jn(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:ir(t,5);break;case 4:ir(t,10);break;case 3:ir(t,6);break;default:ir(t,2)}}function rr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function ir(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=C(t.Xa,t),r||(r=new He("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||Ye(r,"https"),tn(r)),n=r.toString(),r=o,o=new he,S.Image?((i=new Image).onload=U(Sn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=U(Sn,o,i,"TestLoadImage: error",!1,r),i.onabort=U(Sn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=U(Sn,o,i,"TestLoadImage: timeout",!1,r),S.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):ge(),t.v=0,t.f&&t.f.ra(e),or(t),Wn(t)}function or(t){t.v=0,t.I=-1,t.f&&(0==Tn(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function sr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof He?Qe(s):new He(s,void 0);return""!=a.c?(e&&Xe(a,e+"."+a.c),$e(a,a.h)):(r=(u=S.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new He(null,void 0),r&&Ye(u,r),i&&Xe(u,i),o&&$e(u,o),s&&(u.g=s),a=u),t.W&&$(t.W,function(t,e){Ze(a,e,t)}),e=t.A,n=t.na,e&&n&&Ze(a,e,n),Ze(a,"VER",t.ha),Yn(t,a),a}function ur(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new On(t.Ka)).F=t.C,e}function ar(){}function cr(){if(it&&!(10<=Number(dt)))throw Error("Environmental error: no available transport.")}function hr(t,e){jt.call(this),this.a=new Bn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!W(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!W(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new pr(this)}function fr(t){Ae.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function lr(){Se.call(this),this.status=1}function pr(t){this.a=t}(N=On.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?_e(this.H):_e(Ne),this.a.onreadystatechange=C(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Pn(this,t)}t=n||"";var i,o=new Ge(this.headers);r&&Be(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Ln,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=q(kn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Mn(this),0<this.o&&((this.D=(i=this.a,it&&pt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=C(this.xa,this)):this.m=Zt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Pn(this,t)}},N.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Un(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Un(this,!0)),On.S.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?Cn(this):this.Ta())},N.Ta=function(){Cn(this)},N.X=function(){try{return 2<jn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Dn(e)}},N.ua=function(){return this.h},N.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=Bn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Oe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?tt(r=J(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Xn(this,n,e),Ze(i=Qe(this.B),"RID",t),Ze(i,"CVER",22),this.A&&Ze(i,"X-HTTP-Session-Id",this.A),Yn(this,i),this.i&&r&&Fn(i,this.i,r),En(this.b,n),this.Ga&&Ze(i,"TYPE","init"),this.da?(Ze(i,"$req",e),Ze(i,"SID","null"),n.V=!0,Le(n,i,null)):Le(n,i,e),this.v=2}}else 3==this.v&&(t?Qn(this,t):0==this.g.length||wn(this.b)||Qn(this))},N.Aa=function(){var t;this.j=null,tr(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=we(C(this.Sa,this),t))},N.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,zn(this),tr(this))},N.Ra=function(){null!=this.m&&(this.m=null,zn(this),Jn(this),ge())},N.Xa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),ge()},(N=ar.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ha=function(){},cr.prototype.a=function(t,e){return new hr(t,e)},j(hr,jt),(N=hr.prototype).addEventListener=function(t,e,n,r){hr.S.addEventListener.call(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){hr.S.removeEventListener.call(this,t,e,n,r)},N.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;ge(),t.fa=e,t.W=n||{},t.H=t.T,t.B=sr(t,null,t.fa),Hn(t)},N.close=function(){Gn(this.a)},N.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Kn(this.a,e)):this.g?((e={}).__data__=qt(t),Kn(this.a,e)):Kn(this.a,t)},N.G=function(){this.a.f=null,delete this.f,Gn(this.a),delete this.a,hr.S.G.call(this)},j(fr,Ae),j(lr,Se),j(pr,ar),pr.prototype.ta=function(){this.a.dispatchEvent("a")},pr.prototype.sa=function(t){this.a.dispatchEvent(new fr(t))},pr.prototype.ra=function(t){this.a.dispatchEvent(new lr)},pr.prototype.qa=function(){this.a.dispatchEvent("b")},cr.prototype.createWebChannel=cr.prototype.a,hr.prototype.send=hr.prototype.Pa,hr.prototype.open=hr.prototype.Oa,be.NO_ERROR=0,be.TIMEOUT=8,be.HTTP_ERROR=6,Ie.COMPLETE="complete",(Te.EventType=A).OPEN="a",A.CLOSE="b",A.ERROR="c",A.MESSAGE="d",jt.prototype.listen=jt.prototype.va,On.prototype.listenOnce=On.prototype.wa,On.prototype.getLastError=On.prototype.Qa,On.prototype.getLastErrorCode=On.prototype.ua,On.prototype.getStatus=On.prototype.X,On.prototype.getResponseJson=On.prototype.Na,On.prototype.getResponseText=On.prototype.$,On.prototype.send=On.prototype.ba;var dr=(be={createWebChannelTransport:function(){return new cr},ErrorCode:be,EventType:Ie,WebChannel:Te,XhrIo:On}).createWebChannelTransport,yr=be.ErrorCode,vr=be.EventType,gr=be.WebChannel,mr=be.XhrIo,wr=(br.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},br.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},br.prototype.setServiceProps=function(t){return this.serviceProps=t,this},br);function br(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Ir,Er={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},_r=(n(Ar,Ir=Error),Ar),Tr="7.23.0-202096215419",Nr=new h("@firebase/firestore");function Ar(t,e){var n=this;return(n=Ir.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Sr(){return Nr.logLevel}function Dr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=l.DEBUG&&(e=n.map(Rr),Nr.debug.apply(Nr,i(["Firestore ("+Tr+"): "+t],e)))}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=l.ERROR&&(e=n.map(Rr),Nr.error.apply(Nr,i(["Firestore ("+Tr+"): "+t],e)))}function xr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=l.WARN&&(e=n.map(Rr),Nr.warn.apply(Nr,i(["Firestore ("+Tr+"): "+t],e)))}function Rr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function kr(t){throw void 0===t&&(t="Unexpected state"),Or(t="FIRESTORE ("+Tr+") INTERNAL ASSERTION FAILED: "+t),new Error(t)}function Lr(t){t||kr()}function Pr(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Vr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Cr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Ur,Mr,Ie=(Object.defineProperty(Kr.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),Kr.prototype.isEqual=function(t){return 0===Kr.i(this,t)},Kr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Kr?t.forEach(function(t){e.push(t)}):e.push(t),this.o(e)},Kr.prototype.limit=function(){return this.offset+this.length},Kr.prototype.u=function(t){return t=void 0===t?1:t,this.o(this.segments,this.offset+t,this.length-t)},Kr.prototype.h=function(){return this.o(this.segments,this.offset,this.length-1)},Kr.prototype.l=function(){return this.segments[this.offset]},Kr.prototype._=function(){return this.get(this.length-1)},Kr.prototype.get=function(t){return this.segments[this.offset+t]},Kr.prototype.m=function(){return 0===this.length},Kr.prototype.T=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Kr.prototype.I=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Kr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Kr.prototype.A=function(){return this.segments.slice(this.offset,this.limit())},Kr.i=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Kr),jr=(n(Wr,Mr=Ie),Wr.prototype.o=function(t,e,n){return new Wr(t,e,n)},Wr.prototype.R=function(){return this.A().join("/")},Wr.prototype.toString=function(){return this.R()},Wr.P=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new _r(Er.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new Wr(n)},Wr.g=function(){return new Wr([])},Wr),Fr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,qr=(n(zr,Ur=Ie),zr.prototype.o=function(t,e,n){return new zr(t,e,n)},zr.V=function(t){return Fr.test(t)},zr.prototype.R=function(){return this.A().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),zr.V(t)||(t="`"+t+"`"),t}).join(".")},zr.prototype.toString=function(){return this.R()},zr.prototype.p=function(){return 1===this.length&&"__name__"===this.get(0)},zr.v=function(){return new zr(["__name__"])},zr.S=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new _r(Er.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new _r(Er.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new _r(Er.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new _r(Er.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new zr(e)},zr.g=function(){return new zr([])},zr),Br=(Gr.D=function(t){return new Gr(jr.P(t))},Gr.C=function(t){return new Gr(jr.P(t).u(5))},Gr.prototype.N=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Gr.prototype.isEqual=function(t){return null!==t&&0===jr.i(this.path,t.path)},Gr.prototype.toString=function(){return this.path.toString()},Gr.i=function(t,e){return jr.i(t.path,e.path)},Gr.F=function(t){return t.length%2==0},Gr.$=function(t){return new Gr(new jr(t.slice()))},Gr);function Gr(t){this.path=t}function zr(){return null!==Ur&&Ur.apply(this,arguments)||this}function Wr(){return null!==Mr&&Mr.apply(this,arguments)||this}function Kr(t,e,n){void 0===e?e=0:e>t.length&&kr(),void 0===n?n=t.length-e:n>t.length-e&&kr(),this.segments=t,this.offset=e,this.t=n}function Hr(t,e){if(0!==e.length)throw new _r(Er.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+fi(e.length,"argument")+".")}function Qr(t,e,n){if(e.length!==n)throw new _r(Er.INVALID_ARGUMENT,"Function "+t+"() requires "+fi(n,"argument")+", but was called with "+fi(e.length,"argument")+".")}function Yr(t,e,n){if(e.length<n)throw new _r(Er.INVALID_ARGUMENT,"Function "+t+"() requires at least "+fi(n,"argument")+", but was called with "+fi(e.length,"argument")+".")}function Xr(t,e,n,r){if(e.length<n||e.length>r)throw new _r(Er.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+fi(e.length,"argument")+".")}function $r(t,e,n,r){ri(t,e,hi(n)+" argument",r)}function Jr(t,e,n,r){void 0!==r&&$r(t,e,n,r)}function Zr(t,e,n,r){ri(t,e,n+" option",r)}function ti(t,e,n,r){void 0!==r&&Zr(t,e,n,r)}function ei(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(oi(s))}var u=oi(n);throw new _r(Er.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function ni(t,e,n,r){if(!e.some(function(t){return t===r}))throw new _r(Er.INVALID_ARGUMENT,"Invalid value "+oi(r)+" provided to function "+t+"() for its "+hi(n)+" argument. Acceptable values: "+e.join(", "));return r}function ri(t,e,n,r){if(!("object"===e?ii(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e))throw r=oi(r),new _r(Er.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}function ii(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function oi(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":kr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function si(t,e,n){if(void 0===n)throw new _r(Er.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+hi(e)+" argument, but it was undefined.")}function ui(n,t,r){Vr(t,function(t,e){if(r.indexOf(t)<0)throw new _r(Er.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function ai(t,e,n,r){return r=oi(r),new _r(Er.INVALID_ARGUMENT,"Function "+t+"() requires its "+hi(n)+" argument to be a "+e+", but it was: "+r)}function ci(t,e,n){if(n<=0)throw new _r(Er.INVALID_ARGUMENT,"Function "+t+"() requires its "+hi(e)+" argument to be a positive number, but it was: "+n+".")}function hi(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function fi(t,e){return t+" "+e+(1===t?"":"s")}var li=(pi.k=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},pi);function pi(){}function di(t,e){return t<e?-1:e<t?1:0}function yi(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function vi(t){return t+"\0"}var gi=(mi.fromBase64String=function(t){return new mi(atob(t))},mi.fromUint8Array=function(t){return new mi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},mi.prototype.toBase64=function(){return t=this.M,btoa(t);var t},mi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.M)},mi.prototype.O=function(){return 2*this.M.length},mi.prototype.L=function(t){return di(this.M,t.M)},mi.prototype.isEqual=function(t){return this.M===t.M},mi);function mi(t){this.M=t}gi.B=new gi("");var wi=(bi.fromBase64String=function(t){try{return new bi(gi.fromBase64String(t))}catch(t){throw new _r(Er.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},bi.fromUint8Array=function(t){return new bi(gi.fromUint8Array(t))},bi.prototype.toBase64=function(){return this.q.toBase64()},bi.prototype.toUint8Array=function(){return this.q.toUint8Array()},bi.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},bi.prototype.isEqual=function(t){return this.q.isEqual(t.q)},bi);function bi(t){this.q=t}function Ii(){if("undefined"==typeof Uint8Array)throw new _r(Er.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Ei(){if("undefined"==typeof atob)throw new _r(Er.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function _i(t,e,n,r,i){this.U=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var Ti,Ni=(n(Pi,Ti=wi),Pi.fromBase64String=function(t){Qr("Blob.fromBase64String",arguments,1),$r("Blob.fromBase64String","string",1,t),Ei();try{return new Pi(gi.fromBase64String(t))}catch(t){throw new _r(Er.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Pi.fromUint8Array=function(t){if(Qr("Blob.fromUint8Array",arguments,1),Ii(),!(t instanceof Uint8Array))throw ai("Blob.fromUint8Array","Uint8Array",1,t);return new Pi(gi.fromUint8Array(t))},Pi.prototype.toBase64=function(){return Qr("Blob.toBase64",arguments,0),Ei(),Ti.prototype.toBase64.call(this)},Pi.prototype.toUint8Array=function(){return Qr("Blob.toUint8Array",arguments,0),Ii(),Ti.prototype.toUint8Array.call(this)},Pi.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Pi),Ai=(Object.defineProperty(Li.prototype,"W",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Li.prototype.isEqual=function(t){return t instanceof Li&&t.projectId===this.projectId&&t.database===this.database},Li.prototype.L=function(t){return di(this.projectId,t.projectId)||di(this.database,t.database)},Li),Si=(ki.prototype.get=function(t){var e=this.j(t);if(void 0!==(e=this.G[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.K(i,t))return o}},ki.prototype.has=function(t){return void 0!==this.get(t)},ki.prototype.set=function(t,e){var n=this.j(t),r=this.G[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.K(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.G[n]=[[t,e]]},ki.prototype.delete=function(t){var e=this.j(t),n=this.G[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.K(n[r][0],t))return 1===n.length?delete this.G[e]:n.splice(r,1),!0;return!1},ki.prototype.forEach=function(s){Vr(this.G,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},ki.prototype.m=function(){return Cr(this.G)},ki),Di=(Ri.now=function(){return Ri.fromMillis(Date.now())},Ri.fromDate=function(t){return Ri.fromMillis(t.getTime())},Ri.fromMillis=function(t){var e=Math.floor(t/1e3);return new Ri(e,1e6*(t-1e3*e))},Ri.prototype.toDate=function(){return new Date(this.toMillis())},Ri.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Ri.prototype.H=function(t){return this.seconds===t.seconds?di(this.nanoseconds,t.nanoseconds):di(this.seconds,t.seconds)},Ri.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Ri.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Ri.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},Ri.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Ri),Oi=(xi.Y=function(t){return new xi(t)},xi.min=function(){return new xi(new Di(0,0))},xi.prototype.L=function(t){return this.timestamp.H(t.timestamp)},xi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},xi.prototype.J=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},xi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},xi.prototype.X=function(){return this.timestamp},xi);function xi(t){this.timestamp=t}function Ri(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new _r(Er.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new _r(Er.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new _r(Er.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new _r(Er.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function ki(t,e){this.j=t,this.K=e,this.G={}}function Li(t,e){this.projectId=t,this.database=e||"(default)"}function Pi(){return null!==Ti&&Ti.apply(this,arguments)||this}function Vi(t){return null==t}function Ci(t){return 0===t&&1/t==-1/0}function Ui(t){return"number"==typeof t&&Number.isInteger(t)&&!Ci(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Mi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Z=null};function ji(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Mi(t,e,n,r,i,o,s)}function Fi(t){var e=t;return null===e.Z&&(t=e.path.R(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.R()+t.op.toString()+Fo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.R()+t.dir}).join(","),Vi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=ga(e.startAt)),e.endAt&&(t+="|ub:",t+=ga(e.endAt)),e.Z=t),e.Z}function qi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Co(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!wa(t.startAt,e.startAt)&&wa(t.endAt,e.endAt)}function Bi(t){return Br.F(t.path)&&null===t.collectionGroup&&0===t.filters.length}function Gi(t){this.count=t}var zi,Wi=(Ki.prototype.nt=function(t){return new Ki(this.target,this.targetId,this.tt,t,this.et,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Ki.prototype.st=function(t,e){return new Ki(this.target,this.targetId,this.tt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Ki.prototype.it=function(t){return new Ki(this.target,this.targetId,this.tt,this.sequenceNumber,this.et,t,this.resumeToken)},Ki);function Ki(t,e,n,r,i,o,s){void 0===i&&(i=Oi.min()),void 0===o&&(o=Oi.min()),void 0===s&&(s=gi.B),this.target=t,this.targetId=e,this.tt=n,this.sequenceNumber=r,this.et=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Hi(t){switch(t){case Er.OK:return kr(),0;case Er.CANCELLED:case Er.UNKNOWN:case Er.DEADLINE_EXCEEDED:case Er.RESOURCE_EXHAUSTED:case Er.INTERNAL:case Er.UNAVAILABLE:case Er.UNAUTHENTICATED:return;case Er.INVALID_ARGUMENT:case Er.NOT_FOUND:case Er.ALREADY_EXISTS:case Er.PERMISSION_DENIED:case Er.FAILED_PRECONDITION:case Er.ABORTED:case Er.OUT_OF_RANGE:case Er.UNIMPLEMENTED:case Er.DATA_LOSS:return 1;default:return kr(),0}}function Qi(t){if(void 0===t)return Or("GRPC error has no .code"),Er.UNKNOWN;switch(t){case zi.OK:return Er.OK;case zi.CANCELLED:return Er.CANCELLED;case zi.UNKNOWN:return Er.UNKNOWN;case zi.DEADLINE_EXCEEDED:return Er.DEADLINE_EXCEEDED;case zi.RESOURCE_EXHAUSTED:return Er.RESOURCE_EXHAUSTED;case zi.INTERNAL:return Er.INTERNAL;case zi.UNAVAILABLE:return Er.UNAVAILABLE;case zi.UNAUTHENTICATED:return Er.UNAUTHENTICATED;case zi.INVALID_ARGUMENT:return Er.INVALID_ARGUMENT;case zi.NOT_FOUND:return Er.NOT_FOUND;case zi.ALREADY_EXISTS:return Er.ALREADY_EXISTS;case zi.PERMISSION_DENIED:return Er.PERMISSION_DENIED;case zi.FAILED_PRECONDITION:return Er.FAILED_PRECONDITION;case zi.ABORTED:return Er.ABORTED;case zi.OUT_OF_RANGE:return Er.OUT_OF_RANGE;case zi.UNIMPLEMENTED:return Er.UNIMPLEMENTED;case zi.DATA_LOSS:return Er.DATA_LOSS;default:return kr()}}(be=zi=zi||{})[be.OK=0]="OK",be[be.CANCELLED=1]="CANCELLED",be[be.UNKNOWN=2]="UNKNOWN",be[be.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",be[be.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",be[be.NOT_FOUND=5]="NOT_FOUND",be[be.ALREADY_EXISTS=6]="ALREADY_EXISTS",be[be.PERMISSION_DENIED=7]="PERMISSION_DENIED",be[be.UNAUTHENTICATED=16]="UNAUTHENTICATED",be[be.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",be[be.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",be[be.ABORTED=10]="ABORTED",be[be.OUT_OF_RANGE=11]="OUT_OF_RANGE",be[be.UNIMPLEMENTED=12]="UNIMPLEMENTED",be[be.INTERNAL=13]="INTERNAL",be[be.UNAVAILABLE=14]="UNAVAILABLE",be[be.DATA_LOSS=15]="DATA_LOSS";var Yi=(to.prototype.rt=function(t,e){return new to(this.i,this.root.rt(t,e,this.i).copy(null,null,$i.ot,null,null))},to.prototype.remove=function(t){return new to(this.i,this.root.remove(t,this.i).copy(null,null,$i.ot,null,null))},to.prototype.get=function(t){for(var e=this.root;!e.m();){var n=this.i(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},to.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.m();){var r=this.i(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},to.prototype.m=function(){return this.root.m()},Object.defineProperty(to.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),to.prototype.at=function(){return this.root.at()},to.prototype.ct=function(){return this.root.ct()},to.prototype.ut=function(t){return this.root.ut(t)},to.prototype.forEach=function(n){this.ut(function(t,e){return n(t,e),!1})},to.prototype.toString=function(){var n=[];return this.ut(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},to.prototype.ht=function(t){return this.root.ht(t)},to.prototype.lt=function(){return new Xi(this.root,null,this.i,!1)},to.prototype._t=function(t){return new Xi(this.root,t,this.i,!1)},to.prototype.ft=function(){return new Xi(this.root,null,this.i,!0)},to.prototype.dt=function(t){return new Xi(this.root,t,this.i,!0)},to),Xi=(Zi.prototype.Et=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.m();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.m();)this.Tt.push(t),t=t.left;return e},Zi.prototype.It=function(){return 0<this.Tt.length},Zi.prototype.At=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},Zi),$i=(Ji.prototype.copy=function(t,e,n,r,i){return new Ji(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ji.prototype.m=function(){return!1},Ji.prototype.ut=function(t){return this.left.ut(t)||t(this.key,this.value)||this.right.ut(t)},Ji.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},Ji.prototype.min=function(){return this.left.m()?this:this.left.min()},Ji.prototype.at=function(){return this.min().key},Ji.prototype.ct=function(){return this.right.m()?this.key:this.right.ct()},Ji.prototype.rt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.rt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.rt(t,e,n))).Rt()},Ji.prototype.Pt=function(){if(this.left.m())return Ji.EMPTY;var t=this;return t.left.gt()||t.left.left.gt()||(t=t.yt()),(t=t.copy(null,null,null,t.left.Pt(),null)).Rt()},Ji.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.m()||r.left.gt()||r.left.left.gt()||(r=r.yt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.gt()&&(r=r.Vt()),r.right.m()||r.right.gt()||r.right.left.gt()||(r=r.bt()),0===e(t,r.key)){if(r.right.m())return Ji.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Pt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Rt()},Ji.prototype.gt=function(){return this.color},Ji.prototype.Rt=function(){var t=this;return t.right.gt()&&!t.left.gt()&&(t=t.vt()),t.left.gt()&&t.left.left.gt()&&(t=t.Vt()),t.left.gt()&&t.right.gt()&&(t=t.St()),t},Ji.prototype.yt=function(){var t=this.St();return t.right.left.gt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Vt())).vt()).St()),t},Ji.prototype.bt=function(){var t=this.St();return t.left.left.gt()&&(t=(t=t.Vt()).St()),t},Ji.prototype.vt=function(){var t=this.copy(null,null,Ji.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Ji.prototype.Vt=function(){var t=this.copy(null,null,Ji.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Ji.prototype.St=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Ji.prototype.Dt=function(){var t=this.Ct();return Math.pow(2,t)<=this.size+1},Ji.prototype.Ct=function(){if(this.gt()&&this.left.gt())throw kr();if(this.right.gt())throw kr();var t=this.left.Ct();if(t!==this.right.Ct())throw kr();return t+(this.gt()?0:1)},Ji);function Ji(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Ji.RED,this.left=null!=r?r:Ji.EMPTY,this.right=null!=i?i:Ji.EMPTY,this.size=this.left.size+1+this.right.size}function Zi(t,e,n,r){this.wt=r,this.Tt=[];for(var i=1;!t.m();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.wt?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.wt?t.right:t.left}}function to(t,e){this.i=t,this.root=e||$i.EMPTY}function eo(){this.size=0}$i.EMPTY=null,$i.RED=!0,$i.ot=!1,$i.EMPTY=(Object.defineProperty(eo.prototype,"key",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"value",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"color",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"left",{get:function(){throw kr()},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"right",{get:function(){throw kr()},enumerable:!1,configurable:!0}),eo.prototype.copy=function(t,e,n,r,i){return this},eo.prototype.rt=function(t,e,n){return new $i(t,e)},eo.prototype.remove=function(t,e){return this},eo.prototype.m=function(){return!0},eo.prototype.ut=function(t){return!1},eo.prototype.ht=function(t){return!1},eo.prototype.at=function(){return null},eo.prototype.ct=function(){return null},eo.prototype.gt=function(){return!1},eo.prototype.Dt=function(){return!0},eo.prototype.Ct=function(){return 0},new eo);var no=(so.prototype.has=function(t){return null!==this.data.get(t)},so.prototype.first=function(){return this.data.at()},so.prototype.last=function(){return this.data.ct()},Object.defineProperty(so.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),so.prototype.indexOf=function(t){return this.data.indexOf(t)},so.prototype.forEach=function(n){this.data.ut(function(t,e){return n(t),!1})},so.prototype.Nt=function(t,e){for(var n=this.data._t(t[0]);n.It();){var r=n.Et();if(0<=this.i(r.key,t[1]))return;e(r.key)}},so.prototype.Ft=function(t,e){for(var n=void 0!==e?this.data._t(e):this.data.lt();n.It();)if(!t(n.Et().key))return},so.prototype.$t=function(t){return(t=this.data._t(t)).It()?t.Et().key:null},so.prototype.lt=function(){return new ro(this.data.lt())},so.prototype._t=function(t){return new ro(this.data._t(t))},so.prototype.add=function(t){return this.copy(this.data.remove(t).rt(t,!0))},so.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},so.prototype.m=function(){return this.data.m()},so.prototype.xt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},so.prototype.isEqual=function(t){if(!(t instanceof so))return!1;if(this.size!==t.size)return!1;for(var e=this.data.lt(),n=t.data.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(0!==this.i(r,i))return!1}return!0},so.prototype.A=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},so.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},so.prototype.copy=function(t){var e=new so(this.i);return e.data=t,e},so),ro=(oo.prototype.Et=function(){return this.kt.Et().key},oo.prototype.It=function(){return this.kt.It()},oo),io=new Yi(Br.i);function oo(t){this.kt=t}function so(t){this.i=t,this.data=new Yi(this.i)}var uo=new Yi(Br.i),ao=new Yi(Br.i),co=new no(Br.i);function ho(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=co,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var fo=new no(di),lo=(Oo.Lt=function(t){return new Oo(t.i)},Oo.prototype.has=function(t){return null!=this.Mt.get(t)},Oo.prototype.get=function(t){return this.Mt.get(t)},Oo.prototype.first=function(){return this.Ot.at()},Oo.prototype.last=function(){return this.Ot.ct()},Oo.prototype.m=function(){return this.Ot.m()},Oo.prototype.indexOf=function(t){return(t=this.Mt.get(t))?this.Ot.indexOf(t):-1},Object.defineProperty(Oo.prototype,"size",{get:function(){return this.Ot.size},enumerable:!1,configurable:!0}),Oo.prototype.forEach=function(n){this.Ot.ut(function(t,e){return n(t),!1})},Oo.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Mt.rt(t.key,t),e.Ot.rt(t,null))},Oo.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Mt.remove(t),this.Ot.remove(e)):this},Oo.prototype.isEqual=function(t){if(!(t instanceof Oo))return!1;if(this.size!==t.size)return!1;for(var e=this.Ot.lt(),n=t.Ot.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(!r.isEqual(i))return!1}return!0},Oo.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Oo.prototype.copy=function(t,e){var n=new Oo;return n.i=this.i,n.Mt=t,n.Ot=e,n},Oo),po=(Do.prototype.track=function(t){var e=t.doc.key,n=this.Bt.get(e);!n||0!==t.type&&3===n.type?this.Bt=this.Bt.rt(e,t):3===t.type&&1!==n.type?this.Bt=this.Bt.rt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Bt=this.Bt.rt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Bt=this.Bt.remove(e):1===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):kr()},Do.prototype.qt=function(){var n=[];return this.Bt.ut(function(t,e){n.push(e)}),n},Do),yo=(So.Kt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new So(t,e,lo.Lt(e),i,n,r,!0,!1)},Object.defineProperty(So.prototype,"hasPendingWrites",{get:function(){return!this.Qt.m()},enumerable:!1,configurable:!0}),So.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Wt===t.Wt&&this.Qt.isEqual(t.Qt)&&Fu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ut.isEqual(t.Ut)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},So),vo=(Ao.Jt=function(t,e){var n=new Map;return n.set(t,go.Xt(t,e)),new Ao(Oi.min(),n,fo,io,ho())},Ao),go=(No.Xt=function(t,e){return new No(gi.B,e,ho(),ho(),ho())},No),mo=function(t,e,n,r){this.se=t,this.removedTargetIds=e,this.key=n,this.ie=r},wo=function(t,e){this.targetId=t,this.re=e},bo=function(t,e,n,r){void 0===n&&(n=gi.B),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Io=(Object.defineProperty(To.prototype,"Zt",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(To.prototype,"resumeToken",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(To.prototype,"le",{get:function(){return 0!==this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(To.prototype,"_e",{get:function(){return this.he},enumerable:!1,configurable:!0}),To.prototype.fe=function(t){0<t.O()&&(this.he=!0,this.ce=t)},To.prototype.de=function(){var n=ho(),r=ho(),i=ho();return this.ae.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:kr()}}),new go(this.ce,this.ue,n,r,i)},To.prototype.we=function(){this.he=!1,this.ae=Ro()},To.prototype.me=function(t,e){this.he=!0,this.ae=this.ae.rt(t,e)},To.prototype.Te=function(t){this.he=!0,this.ae=this.ae.remove(t)},To.prototype.Ee=function(){this.oe+=1},To.prototype.Ie=function(){--this.oe},To.prototype.Ae=function(){this.he=!0,this.ue=!0},To),Eo=(_o.prototype.pe=function(t){for(var e=0,n=t.se;e<n.length;e++){var r=n[e];t.ie instanceof Iu?this.be(r,t.ie):t.ie instanceof Eu&&this.ve(r,t.key,t.ie)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.ve(s,t.key,t.ie)}},_o.prototype.Se=function(n){var r=this;this.De(n,function(t){var e=r.Ce(t);switch(n.state){case 0:r.Ne(t)&&e.fe(n.resumeToken);break;case 1:e.Ie(),e.le||e.we(),e.fe(n.resumeToken);break;case 2:e.Ie(),e.le||r.removeTarget(t);break;case 3:r.Ne(t)&&(e.Ae(),e.fe(n.resumeToken));break;case 4:r.Ne(t)&&(r.Fe(t),e.fe(n.resumeToken));break;default:kr()}})},_o.prototype.De=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Pe.forEach(function(t,e){r.Ne(e)&&n(e)})},_o.prototype.$e=function(t){var e=t.targetId,n=t.re.count;(t=this.xe(e))&&(Bi(t=t.target)?0===n?(t=new Br(t.path),this.ve(e,t,new Eu(t,Oi.min()))):Lr(1===n):this.ke(e)!==n&&(this.Fe(e),this.Ve=this.Ve.add(e)))},_o.prototype.Me=function(r){var i=this,o=new Map;this.Pe.forEach(function(t,e){var n=i.xe(e);n&&(t.Zt&&Bi(n.target)&&(n=new Br(n.target.path),null!==i.ge.get(n)||i.Oe(e,n)||i.ve(e,n,new Eu(n,r))),t._e&&(o.set(e,t.de()),t.we()))});var s=ho();this.ye.forEach(function(t,e){var n=!0;e.Ft(function(t){return!(t=i.xe(t))||2===t.tt||(n=!1)}),n&&(s=s.add(t))});var t=new vo(r,o,this.Ve,this.ge,s);return this.ge=io,this.ye=xo(),this.Ve=new no(di),t},_o.prototype.be=function(t,e){var n;this.Ne(t)&&(n=this.Oe(t,e.key)?2:0,this.Ce(t).me(e.key,n),this.ge=this.ge.rt(e.key,e),this.ye=this.ye.rt(e.key,this.Le(e.key).add(t)))},_o.prototype.ve=function(t,e,n){var r;this.Ne(t)&&(r=this.Ce(t),this.Oe(t,e)?r.me(e,1):r.Te(e),this.ye=this.ye.rt(e,this.Le(e).delete(t)),n&&(this.ge=this.ge.rt(e,n)))},_o.prototype.removeTarget=function(t){this.Pe.delete(t)},_o.prototype.ke=function(t){var e=this.Ce(t).de();return this.Re.Be(t).size+e.te.size-e.ne.size},_o.prototype.Ee=function(t){this.Ce(t).Ee()},_o.prototype.Ce=function(t){var e=this.Pe.get(t);return e||(e=new Io,this.Pe.set(t,e)),e},_o.prototype.Le=function(t){var e=this.ye.get(t);return e||(e=new no(di),this.ye=this.ye.rt(t,e)),e},_o.prototype.Ne=function(t){var e=null!==this.xe(t);return e||Dr("WatchChangeAggregator","Detected inactive target",t),e},_o.prototype.xe=function(t){var e=this.Pe.get(t);return e&&e.le?null:this.Re.qe(t)},_o.prototype.Fe=function(e){var n=this;this.Pe.set(e,new Io),this.Re.Be(e).forEach(function(t){n.ve(e,t,null)})},_o.prototype.Oe=function(t,e){return this.Re.Be(t).has(e)},_o);function _o(t){this.Re=t,this.Pe=new Map,this.ge=io,this.ye=xo(),this.Ve=new no(di)}function To(){this.oe=0,this.ae=Ro(),this.ce=gi.B,this.ue=!1,this.he=!0}function No(t,e,n,r,i){this.resumeToken=t,this.Zt=e,this.te=n,this.ee=r,this.ne=i}function Ao(t,e,n,r,i){this.et=t,this.Gt=e,this.zt=n,this.Ht=r,this.Yt=i}function So(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Ut=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.Wt=s,this.jt=u}function Do(){this.Bt=new Yi(Br.i)}function Oo(n){this.i=n?function(t,e){return n(t,e)||Br.i(t.key,e.key)}:function(t,e){return Br.i(t.key,e.key)},this.Mt=uo,this.Ot=new Yi(this.i)}function xo(){return new Yi(Br.i)}function Ro(){return new Yi(Br.i)}function ko(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Lo(t){return t=qo(t.mapValue.fields.__local_write_time__.timestampValue),new Di(t.seconds,t.nanos)}var Po=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Vo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ko(t)?4:10:kr()}function Co(r,i){var t,e,n,o=Vo(r);if(o!==Vo(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return Lo(r).isEqual(Lo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=qo(r.timestampValue),t=qo(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Go(r.bytesValue).isEqual(Go(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return o=i,Bo((t=r).geoPointValue.latitude)===Bo(o.geoPointValue.latitude)&&Bo(t.geoPointValue.longitude)===Bo(o.geoPointValue.longitude);case 2:return n=i,"integerValue"in(e=r)&&"integerValue"in n?Bo(e.integerValue)===Bo(n.integerValue):"doubleValue"in e&&"doubleValue"in n&&((e=Bo(e.doubleValue))===(n=Bo(n.doubleValue))?Ci(e)===Ci(n):isNaN(e)&&isNaN(n));case 9:return yi(r.arrayValue.values||[],i.arrayValue.values||[],Co);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Pr(e)!==Pr(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Co(e[t],n[t])))return!1;return!0}();default:return kr()}}function Uo(t,e){return void 0!==(t.values||[]).find(function(t){return Co(t,e)})}function Mo(t,e){var n,r,i,o,s=Vo(t),u=Vo(e);if(s!==u)return di(s,u);switch(s){case 0:return 0;case 1:return di(t.booleanValue,e.booleanValue);case 2:return n=e,(r=Bo(t.integerValue||t.doubleValue))<(n=Bo(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return jo(t.timestampValue,e.timestampValue);case 4:return jo(Lo(t),Lo(e));case 5:return di(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,o=e.bytesValue,i=Go(i),o=Go(o),i.L(o);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=di(n[i],r[i]);if(0!==o)return o}return di(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return s=t.geoPointValue,r=e.geoPointValue,0!==(n=di(Bo(s.latitude),Bo(r.latitude)))?n:di(Bo(s.longitude),Bo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Mo(n[i],r[i]);if(o)return o}return di(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=di(r[s],o[s]);if(0!==u)return u;if(0!==(u=Mo(n[r[s]],i[o[s]])))return u}return di(r.length,o.length)}(t.mapValue,e.mapValue);default:throw kr()}}function jo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return di(t,e);var n=qo(t),t=qo(e);return 0!==(e=di(n.seconds,t.seconds))?e:di(n.nanos,t.nanos)}function Fo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=qo(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?Go(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,Br.C(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):kr();var t,e}(t)}function qo(t){if(Lr(!!t),"string"!=typeof t)return{seconds:Bo(t.seconds),nanos:Bo(t.nanos)};var e=0,n=Po.exec(t);return Lr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Bo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Go(t){return"string"==typeof t?gi.fromBase64String(t):gi.fromUint8Array(t)}function zo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.R()}}function Wo(t){return t&&"integerValue"in t}function Ko(t){return!!t&&"arrayValue"in t}function Ho(t){return t&&"nullValue"in t}function Qo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Yo(t){return t&&"mapValue"in t}var Xo={asc:"ASCENDING",desc:"DESCENDING"},$o={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Jo=function(t,e){this.U=t,this.Ue=e};function Zo(t){return{integerValue:""+t}}function ts(t,e){if(t.Ue){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ci(e)?"-0":e}}function es(t,e){return Ui(e)?Zo(e):ts(t,e)}function ns(t,e){return t.Ue?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function rs(t,e){return t.Ue?e.toBase64():e.toUint8Array()}function is(t){return Lr(!!t),Oi.Y((t=qo(t),new Di(t.seconds,t.nanos)))}function os(t,e){return new jr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).R()}function ss(t){return Lr(_s(t=jr.P(t))),t}function us(t,e){return os(t.U,e.path)}function as(t,e){return Lr((e=ss(e)).get(1)===t.U.projectId),Lr(!e.get(3)&&!t.U.database||e.get(3)===t.U.database),new Br(ls(e))}function cs(t,e){return os(t.U,e)}function hs(t){return 4===(t=ss(t)).length?jr.g():ls(t)}function fs(t){return new jr(["projects",t.U.projectId,"databases",t.U.database]).R()}function ls(t){return Lr(4<t.length&&"documents"===t.get(4)),t.u(5)}function ps(t,e,n){return{name:us(t,e),fields:n.proto.mapValue.fields}}function ds(t,e){var n,r,i;if(e instanceof Zs)n={update:ps(t,e.key,e.value)};else if(e instanceof hu)n={delete:us(t,e.key)};else if(e instanceof tu)n={update:ps(t,e.key,e.data),updateMask:(i=e.Qe,r=[],i.fields.forEach(function(t){return r.push(t.R())}),{fieldPaths:r})};else if(e instanceof ou)n={transform:{document:us(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Ss)return{fieldPath:t.field.R(),setToServerValue:"REQUEST_TIME"};if(e instanceof Ds)return{fieldPath:t.field.R(),appendMissingElements:{values:e.elements}};if(e instanceof Ls)return{fieldPath:t.field.R(),removeAllFromArray:{values:e.elements}};if(e instanceof Us)return{fieldPath:t.field.R(),increment:e.We};throw kr()})}};else{if(!(e instanceof fu))return kr();n={verify:us(t,e.key)}}return e.Ke.je||(n.currentDocument=void 0!==(i=e.Ke).updateTime?{updateTime:ns(e=t,(t=i.updateTime).X())}:void 0!==i.exists?{exists:i.exists}:kr()),n}function ys(o,t){var e=t.currentDocument?void 0!==(i=t.currentDocument).updateTime?Ws.updateTime(is(i.updateTime)):void 0!==i.exists?Ws.exists(i.exists):Ws.Ge():Ws.Ge();if(t.update){t.update.name;var n=as(o,t.update.name),r=new lu({mapValue:{fields:t.update.fields}});if(t.updateMask){var i=(i=t.updateMask.fieldPaths||[],new qs(i.map(function(t){return qr.S(t)})));return new tu(n,r,i,e)}return new Zs(n,r,e)}if(t.delete){var s=as(o,t.delete);return new hu(s,e)}return t.transform?(r=as(o,t.transform.document),s=t.transform.fieldTransforms.map(function(t){return e=o,i=null,"setToServerValue"in(n=t)?(Lr("REQUEST_TIME"===n.setToServerValue),i=new Ss):"appendMissingElements"in n?(r=n.appendMissingElements.values||[],i=new Ds(r)):"removeAllFromArray"in n?(r=n.removeAllFromArray.values||[],i=new Ls(r)):"increment"in n?i=new Us(e,n.increment):kr(),n=qr.S(n.fieldPath),new Bs(n,i);var e,n,r,i}),Lr(!0===e.exists),new ou(r,s)):t.verify?(t=as(o,t.verify),new fu(t,e)):kr()}function vs(t,e){return{documents:[cs(t,e.path)]}}function gs(t,e){var n={structuredQuery:{}},r=e.path;return null!==e.collectionGroup?(n.parent=cs(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=cs(t,r.h()),n.structuredQuery.from=[{collectionId:r._()}]),(r=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(Qo(t.value))return{unaryFilter:{field:Is(t.field),op:"IS_NAN"}};if(Ho(t.value))return{unaryFilter:{field:Is(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Qo(t.value))return{unaryFilter:{field:Is(t.field),op:"IS_NOT_NAN"}};if(Ho(t.value))return{unaryFilter:{field:Is(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Is(t.field),op:(e=t.op,$o[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(e.filters))&&(n.structuredQuery.where=r),(r=function(t){if(0!==t.length)return t.map(function(t){return{field:Is((t=t).field),direction:(t=t.dir,Xo[t])}})}(e.orderBy))&&(n.structuredQuery.orderBy=r),r=e.limit,null!==(r=t.Ue||Vi(r)?r:{value:r})&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=ws(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ws(e.endAt)),n}function ms(t){var e=hs(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Lr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Es(t.unaryFilter.field);return Ku.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Es(t.unaryFilter.field);return Ku.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":return n=Es(t.unaryFilter.field),Ku.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return t=Es(t.unaryFilter.field),Ku.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return kr()}}(e)]:void 0!==e.fieldFilter?[(n=e,Ku.create(Es(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return kr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):kr():[];var n}(n.where)),t=[],n.orderBy&&(t=n.orderBy.map(function(t){return new ba(Es((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e})),r=null,n.limit&&(r=Vi(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=bs(n.startAt));var u=null;return n.endAt&&(u=bs(n.endAt)),Cu(Du(e,i,t,o,r,"F",s,u))}function ws(t){return{before:t.before,values:t.position}}function bs(t){var e=!!t.before,t=t.values||[];return new la(t,e)}function Is(t){return{fieldPath:t.R()}}function Es(t){return qr.S(t.fieldPath)}function _s(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function Ts(t,e){return t instanceof Us?Wo(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var Ns,As,Ss=(n(xs,As=h=function(){this.ze=void 0}),xs),Ds=(n(Os,Ns=h),Os);function Os(t){var e=this;return(e=Ns.call(this)||this).elements=t,e}function xs(){return null!==As&&As.apply(this,arguments)||this}function Rs(t,e){for(var n=Fs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Co(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var ks,Ls=(n(Ps,ks=h),Ps);function Ps(t){var e=this;return(e=ks.call(this)||this).elements=t,e}function Vs(t,e){for(var n=Fs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Co(t,e)})}(i[r]);return{arrayValue:{values:n}}}var Cs,Us=(n(Ms,Cs=h),Ms);function Ms(t,e){var n=this;return(n=Cs.call(this)||this).serializer=t,n.We=e,n}function js(t){return Bo(t.integerValue||t.doubleValue)}function Fs(t){return Ko(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var qs=(Gs.prototype.He=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].T(t))return!0;return!1},Gs.prototype.isEqual=function(t){return yi(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Gs),Bs=function(t,e){this.field=t,this.transform=e};function Gs(t){(this.fields=t).sort(qr.i)}function zs(t,e){this.version=t,this.transformResults=e}var Ws=(Ks.Ge=function(){return new Ks},Ks.exists=function(t){return new Ks(void 0,t)},Ks.updateTime=function(t){return new Ks(t)},Object.defineProperty(Ks.prototype,"je",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Ks.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Ks);function Ks(t,e){this.updateTime=t,this.exists=e}function Hs(t,e){return void 0!==t.updateTime?e instanceof Iu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Iu}function Qs(t,e,n,r){return t instanceof Zs?(o=e,Hs((i=t).Ke,o)?(o=Xs(o),new Iu(i.key,o,i.value,{Ye:!0})):o):t instanceof tu?function(t,e){if(!Hs(t.Ke,e))return e;var n=Xs(e),e=ru(t,e);return new Iu(t.key,n,e,{Ye:!0})}(t,e):t instanceof ou?function(t,e,n,r){if(!Hs(t.Ke,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof Iu&&(h=n.field(a.field)),null===h&&r instanceof Iu&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,(c=c)instanceof Ss?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof Ds?Rs(c,i):c instanceof Ls?Vs(c,i):(i=js(c=Ts(h=c,i))+js(h.We),Wo(c)&&Wo(h.We)?Zo(i):ts(h.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=uu(t,i.data(),r);return new Iu(t.key,i.version,r,{Ye:!0})}(t,e,r,n):(e=e,Hs((t=t).Ke,e)?new Eu(t.key,Oi.min()):e);var i,o}function Ys(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ke.isEqual(e.Ke)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||yi(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof Ds&&e instanceof Ds||t instanceof Ls&&e instanceof Ls?yi(t.elements,e.elements,Co):t instanceof Us&&e instanceof Us?Co(t.We,e.We):t instanceof Ss&&e instanceof Ss)}))}function Xs(t){return t instanceof Iu?t.version:Oi.min()}var $s,Js,Zs=(n(nu,Js=Ie=function(){}),nu),tu=(n(eu,$s=Ie),eu);function eu(t,e,n,r){var i=this;return(i=$s.call(this)||this).key=t,i.data=e,i.Qe=n,i.Ke=r,i.type=1,i}function nu(t,e,n){var r=this;return(r=Js.call(this)||this).key=t,r.value=e,r.Ke=n,r.type=0,r}function ru(t,e){return n=t,e=e instanceof Iu?e.data():lu.empty(),r=new pu(e),n.Qe.fields.forEach(function(t){var e;t.m()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Je();var n,r}var iu,ou=(n(su,iu=Ie),su);function su(t,e){var n=this;return(n=iu.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ke=Ws.exists(!0),n}function uu(t,e,n){for(var r=new pu(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Je()}var au,cu,hu=(n(gu,cu=Ie),gu),fu=(n(vu,au=Ie),vu),lu=(yu.empty=function(){return new yu({mapValue:{}})},yu.prototype.field=function(t){if(t.m())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Yo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t._()])||null},yu.prototype.isEqual=function(t){return Co(this.proto,t.proto)},yu),pu=(du.prototype.set=function(t,e){return this.tn(t,e),this},du.prototype.delete=function(t){return this.tn(t,null),this},du.prototype.tn=function(t,e){for(var n=this.Ze,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===Vo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t._(),e)},du.prototype.Je=function(){var t=this.en(qr.g(),this.Ze);return null!=t?new lu(t):this.Xe},du.prototype.en=function(r,t){var i=this,o=!1,e=this.Xe.field(r),s=Yo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.en(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},du);function du(t){void 0===t&&(t=lu.empty()),this.Xe=t,this.Ze=new Map}function yu(t){this.proto=t}function vu(t,e){var n=this;return(n=au.call(this)||this).key=t,n.Ke=e,n.type=4,n}function gu(t,e){var n=this;return(n=cu.call(this)||this).key=t,n.Ke=e,n.type=3,n}var mu,wu,bu,Iu=(n(Su,bu=be=function(t,e){this.key=t,this.version=e}),Su.prototype.field=function(t){return this.nn.field(t)},Su.prototype.data=function(){return this.nn},Su.prototype.sn=function(){return this.nn.proto},Su.prototype.isEqual=function(t){return t instanceof Su&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ye===t.Ye&&this.hasCommittedMutations===t.hasCommittedMutations&&this.nn.isEqual(t.nn)},Su.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.nn.toString()+", {hasLocalMutations: "+this.Ye+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Su.prototype,"hasPendingWrites",{get:function(){return this.Ye||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Su),Eu=(n(Au,wu=be),Au.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Au.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Au.prototype.isEqual=function(t){return t instanceof Au&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Au),_u=(n(Nu,mu=be),Nu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Nu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Nu.prototype.isEqual=function(t){return t instanceof Nu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Nu),Tu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.rn=n,this.filters=r,this.limit=i,this.on=o,this.startAt=s,this.endAt=u,this.an=null,this.cn=null,this.startAt,this.endAt};function Nu(){return null!==mu&&mu.apply(this,arguments)||this}function Au(t,e,n){var r=this;return(r=wu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Su(t,e,n,r){var i=this;return(i=bu.call(this,t,e)||this).nn=n,i.Ye=!!r.Ye,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Du(t,e,n,r,i,o,s,u){return new Tu(t,e,n,r,i,o,s,u)}function Ou(t){return new Tu(t)}function xu(t){return!Vi(t.limit)&&"F"===t.on}function Ru(t){return!Vi(t.limit)&&"L"===t.on}function ku(t){return 0<t.rn.length?t.rn[0].field:null}function Lu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.un())return r.field}return null}function Pu(t){return null!==t.collectionGroup}function Vu(t){var e=t;if(null===e.an){e.an=[];var n=Lu(e),t=ku(e);if(null!==n&&null===t)n.p()||e.an.push(new ba(n)),e.an.push(new ba(qr.v(),"asc"));else{for(var r=!1,i=0,o=e.rn;i<o.length;i++){var s=o[i];e.an.push(s),s.field.p()&&(r=!0)}r||(n=0<e.rn.length?e.rn[e.rn.length-1].dir:"asc",e.an.push(new ba(qr.v(),n)))}}return e.an}function Cu(t){var e=t;if(!e.cn)if("F"===e.on)e.cn=ji(e.path,e.collectionGroup,Vu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Vu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new ba(o.field,s))}var u=e.endAt?new la(e.endAt.position,!e.endAt.before):null,t=e.startAt?new la(e.startAt.position,!e.startAt.before):null;e.cn=ji(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.cn}function Uu(t,e,n){return new Tu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Mu(t,e){return new Tu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,e,t.endAt)}function ju(t,e){return new Tu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,t.startAt,e)}function Fu(t,e){return qi(Cu(t),Cu(e))&&t.on===e.on}function qu(t){return Fi(Cu(t))+"|lt:"+t.on}function Bu(t){return"Query(target="+(n=(e=Cu(t)).path.R(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.R()+" "+t.op+" "+Fo(t.value)}).join(", ")+"]"),Vi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.R()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+ga(e.startAt)),e.endAt&&(n+=", endAt: "+ga(e.endAt)),"Target("+n+")")+"; limitType="+t.on+")";var e,n}function Gu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.N(e.collectionGroup)&&e.path.T(n):Br.F(e.path)?e.path.isEqual(n):e.path.I(n))&&function(t){for(var e=0,n=i.rn;e<n.length;e++){var r=n[e];if(!r.field.p()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||ma(t.startAt,Vu(t),n))&&(!t.endAt||!ma(t.endAt,Vu(t),n)));var e,n}function zu(u){return function(t,e){for(var n=!1,r=0,i=Vu(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i,o;switch(n=t.field.p()?Br.i(e.key,n.key):(r=t.field,i=n,o=e.field(r),r=i.field(r),null!==o&&null!==r?Mo(o,r):kr()),t.dir){case"asc":return n;case"desc":return-1*n;default:return kr()}}(o,t,e);if(0!==s)return s;n=n||o.field.p()}return 0}}var Wu,Ku=(n(Hu,Wu=function(){}),Hu.create=function(t,e,n){if(t.p())return"in"===e||"not-in"===e?this.hn(t,e,n):new $u(t,e,n);if(Ho(n)){if("=="!==e&&"!="!==e)throw new _r(Er.INVALID_ARGUMENT,"Invalid query. Null only supports '==' and '!=' comparisons.");return new Hu(t,e,n)}if(Qo(n)){if("=="!==e&&"!="!==e)throw new _r(Er.INVALID_ARGUMENT,"Invalid query. NaN only supports '==' and '!=' comparisons.");return new Hu(t,e,n)}return"array-contains"===e?new aa(t,n):"in"===e?new ca(t,n):"not-in"===e?new ha(t,n):"array-contains-any"===e?new fa(t,n):new Hu(t,e,n)},Hu.hn=function(t,e,n){return new("in"===e?Ju:Zu)(t,n)},Hu.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this.ln(Mo(t,this.value)):null!==t&&Vo(this.value)===Vo(t)&&this.ln(Mo(t,this.value))},Hu.prototype.ln=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return kr()}},Hu.prototype.un=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Hu);function Hu(t,e,n){var r=this;return(r=Wu.call(this)||this).field=t,r.op=e,r.value=n,r}var Qu,Yu,Xu,$u=(n(na,Xu=Ku),na.prototype.matches=function(t){return t=Br.i(t.key,this.key),this.ln(t)},na),Ju=(n(ea,Yu=Ku),ea.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},ea),Zu=(n(ta,Qu=Ku),ta.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},ta);function ta(t,e){var n=this;return(n=Qu.call(this,t,"not-in",e)||this).keys=ra(0,e),n}function ea(t,e){var n=this;return(n=Yu.call(this,t,"in",e)||this).keys=ra(0,e),n}function na(t,e,n){var r=this;return(r=Xu.call(this,t,e,n)||this).key=Br.C(n.referenceValue),r}function ra(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return Br.C(t.referenceValue)})}var ia,oa,sa,ua,aa=(n(va,ua=Ku),va.prototype.matches=function(t){return Ko(t=t.field(this.field))&&Uo(t.arrayValue,this.value)},va),ca=(n(ya,sa=Ku),ya.prototype.matches=function(t){return null!==(t=t.field(this.field))&&Uo(this.value.arrayValue,t)},ya),ha=(n(da,oa=Ku),da.prototype.matches=function(t){return!Uo(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!Uo(this.value.arrayValue,t))},da),fa=(n(pa,ia=Ku),pa.prototype.matches=function(t){var e=this;return!(!Ko(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return Uo(e.value.arrayValue,t)})},pa),la=function(t,e){this.position=t,this.before=e};function pa(t,e){return ia.call(this,t,"array-contains-any",e)||this}function da(t,e){return oa.call(this,t,"not-in",e)||this}function ya(t,e){return sa.call(this,t,"in",e)||this}function va(t,e){return ua.call(this,t,"array-contains",e)||this}function ga(t){return(t.before?"b":"a")+":"+t.position.map(Fo).join(",")}function ma(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.p()?Br.i(Br.C(s.referenceValue),n.key):Mo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function wa(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Co(t.position[n],e.position[n]))return!1;return!0}var ba=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Ia(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var Ea,_a=(ka.prototype.reset=function(){this.Tn=0},ka.prototype.An=function(){this.Tn=this.mn},ka.prototype.Rn=function(t){var e=this;this.cancel();var n=Math.floor(this.Tn+this.Pn()),r=Math.max(0,Date.now()-this.In),i=Math.max(0,n-r);0<i&&Dr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Tn+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.En=this._n.gn(this.fn,i,function(){return e.In=Date.now(),t()}),this.Tn*=this.wn,this.Tn<this.dn&&(this.Tn=this.dn),this.Tn>this.mn&&(this.Tn=this.mn)},ka.prototype.yn=function(){null!==this.En&&(this.En.Vn(),this.En=null)},ka.prototype.cancel=function(){null!==this.En&&(this.En.cancel(),this.En=null)},ka.prototype.Pn=function(){return(Math.random()-.5)*this.Tn},ka),Ta=(Ra.prototype.catch=function(t){return this.next(void 0,t)},Ra.prototype.next=function(r,i){var o=this;return this.Sn&&kr(),this.Sn=!0,this.vn?this.error?this.Dn(i,this.error):this.Cn(r,this.result):new Ra(function(e,n){o.pn=function(t){o.Cn(r,t).next(e,n)},o.bn=function(t){o.Dn(i,t).next(e,n)}})},Ra.prototype.Nn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Ra.prototype.Fn=function(t){try{var e=t();return e instanceof Ra?e:Ra.resolve(e)}catch(t){return Ra.reject(t)}},Ra.prototype.Cn=function(t,e){return t?this.Fn(function(){return t(e)}):Ra.resolve(e)},Ra.prototype.Dn=function(t,e){return t?this.Fn(function(){return t(e)}):Ra.reject(e)},Ra.resolve=function(n){return new Ra(function(t,e){t(n)})},Ra.reject=function(n){return new Ra(function(t,e){e(n)})},Ra.$n=function(t){return new Ra(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Ra.xn=function(t){for(var n=Ra.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Ra.resolve(t):e()})}(r[e]);return n},Ra.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.$n(i)},Ra),Na=(xa.delete=function(t){return Dr("SimpleDb","Removing database:",t),Ma(window.indexedDB.deleteDatabase(t)).Nn()},xa.On=function(){if("undefined"==typeof indexedDB)return!1;if(xa.Ln())return!0;var t=p(),e=0<(n=xa.Mn(t))&&n<10,n=0<(n=xa.Bn(t))&&n<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||e||n)},xa.Ln=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.qn)},xa.Un=function(t,e){return t.store(e)},xa.Mn=function(t){return t=(t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i))?t[1].split("_").slice(0,2).join("."):"-1",Number(t)},xa.Bn=function(t){return t=(t=t.match(/Android ([\d.]+)/i))?t[1].split(".").slice(0,2).join("."):"-1",Number(t)},xa.prototype.Qn=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Dr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result,e(t)},r.onblocked=function(){n(new Sa(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){"VersionError"===(t=t.target.error).name?n(new _r(Er.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new Sa(o,t))},r.onupgradeneeded=function(t){Dr("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.kn.createOrUpgrade(e,r.transaction,t.oldVersion,i.version).next(function(){Dr("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.Wn&&(this.db.onversionchange=function(t){return i.Wn(t)}),this.db)]}})})},xa.prototype.jn=function(e){this.Wn=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},xa.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.Qn(u)];case 2:return s.db=t.sent(),e=Pa.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),Ta.reject(t)}).Nn(),r={},n.catch(function(){}),[4,e.Kn];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,Dr("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},xa.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},xa),Aa=(Object.defineProperty(Oa.prototype,"vn",{get:function(){return this.zn},enumerable:!1,configurable:!0}),Object.defineProperty(Oa.prototype,"Yn",{get:function(){return this.Hn},enumerable:!1,configurable:!0}),Object.defineProperty(Oa.prototype,"cursor",{set:function(t){this.Gn=t},enumerable:!1,configurable:!0}),Oa.prototype.done=function(){this.zn=!0},Oa.prototype.Jn=function(t){this.Hn=t},Oa.prototype.delete=function(){return Ma(this.Gn.delete())},Oa),Sa=(n(Da,Ea=_r),Da);function Da(t,e){var n=this;return(n=Ea.call(this,Er.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function Oa(t){this.Gn=t,this.zn=!1,this.Hn=null}function xa(t,e,n){this.name=t,this.version=e,this.kn=n,12.2===xa.Mn(p())&&Or("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function Ra(t){var e=this;this.pn=null,this.bn=null,this.result=void 0,this.error=void 0,this.vn=!1,this.Sn=!1,t(function(t){e.vn=!0,e.result=t,e.pn&&e.pn(t)},function(t){e.vn=!0,e.error=t,e.bn&&e.bn(t)})}function ka(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this._n=t,this.fn=e,this.dn=n,this.wn=r,this.mn=i,this.Tn=0,this.En=null,this.In=Date.now(),this.reset()}function La(t){return"IndexedDbTransactionError"===t.name}var Pa=(Ua.open=function(t,e,n,r){try{return new Ua(e,t.transaction(r,n))}catch(t){throw new Sa(e,t)}},Object.defineProperty(Ua.prototype,"Kn",{get:function(){return this.Xn.promise},enumerable:!1,configurable:!0}),Ua.prototype.abort=function(t){t&&this.Xn.reject(t),this.aborted||(Dr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Ua.prototype.store=function(t){return t=this.transaction.objectStore(t),new Va(t)},Ua),Va=(Ca.prototype.put=function(t,e){return Ma(t=void 0!==e?(Dr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Dr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},Ca.prototype.add=function(t){return Dr("SimpleDb","ADD",this.store.name,t,t),Ma(this.store.add(t))},Ca.prototype.get=function(e){var n=this;return Ma(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Dr("SimpleDb","GET",n.store.name,e,t),t})},Ca.prototype.delete=function(t){return Dr("SimpleDb","DELETE",this.store.name,t),Ma(this.store.delete(t))},Ca.prototype.count=function(){return Dr("SimpleDb","COUNT",this.store.name),Ma(this.store.count())},Ca.prototype.Zn=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.ts(e,function(t,e){n.push(e)}).next(function(){return n})},Ca.prototype.es=function(t,e){return Dr("SimpleDb","DELETE ALL",this.store.name),(e=this.options(t,e)).ns=!1,e=this.cursor(e),this.ts(e,function(t,e,n){return n.delete()})},Ca.prototype.ss=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.ts(n,e)},Ca.prototype.rs=function(r){var t=this.cursor({});return new Ta(function(n,e){t.onerror=function(t){t=Fa(t.target.error),e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},Ca.prototype.ts=function(t,i){var o=[];return new Ta(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new Aa(n),(t=i(n.primaryKey,n.value,e))instanceof Ta&&(t=t.catch(function(t){return e.done(),Ta.reject(t)}),o.push(t)),e.vn?r():null===e.Yn?n.continue():n.continue(e.Yn)):r()}}).next(function(){return Ta.$n(o)})},Ca.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Ca.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.ns?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Ca);function Ca(t){this.store=t}function Ua(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.Xn=new Ia,this.transaction.oncomplete=function(){n.Xn.resolve()},this.transaction.onabort=function(){t.error?n.Xn.reject(new Sa(e,t.error)):n.Xn.resolve()},this.transaction.onerror=function(t){t=Fa(t.target.error),n.Xn.reject(new Sa(e,t))}}function Ma(t){return new Ta(function(e,n){t.onsuccess=function(t){t=t.target.result,e(t)},t.onerror=function(t){t=Fa(t.target.error),n(t)}})}var ja=!1;function Fa(t){var e=Na.Mn(p());if(12.2<=e&&e<13&&(e="An internal error was encountered in the Indexed Database server",0<=t.message.indexOf(e))){var n=new _r("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return ja||(ja=!0,setTimeout(function(){throw n},0)),n}return t}function qa(){return"undefined"!=typeof window?window:null}function Ba(){return"undefined"!=typeof document?document:null}var Ga=(Ka.ls=function(t,e,n,r,i){return(i=new Ka(t,e,Date.now()+n,r,i)).start(n),i},Ka.prototype.start=function(t){var e=this;this._s=setTimeout(function(){return e.fs()},t)},Ka.prototype.Vn=function(){return this.fs()},Ka.prototype.cancel=function(t){null!==this._s&&(this.clearTimeout(),this.hs.reject(new _r(Er.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Ka.prototype.fs=function(){var e=this;this.os.ds(function(){return null!==e._s?(e.clearTimeout(),e.op().then(function(t){return e.hs.resolve(t)})):Promise.resolve()})},Ka.prototype.clearTimeout=function(){null!==this._s&&(this.us(this),clearTimeout(this._s),this._s=null)},Ka),za=(Object.defineProperty(Wa.prototype,"Vs",{get:function(){return this.Es},enumerable:!1,configurable:!0}),Wa.prototype.ds=function(t){this.enqueue(t)},Wa.prototype.ps=function(t){this.bs(),this.vs(t)},Wa.prototype.Ss=function(){var t;this.Es||(this.Es=!0,(t=Ba())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.ys))},Wa.prototype.enqueue=function(t){return this.bs(),this.Es?new Promise(function(t){}):this.vs(t)},Wa.prototype.Ds=function(t){var e=this;this.Ts.push(t),this.ds(function(){return e.Cs()})},Wa.prototype.Cs=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Ts.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Ts[0]()];case 2:return t.sent(),this.Ts.shift(),this.gs.reset(),[3,4];case 3:if(!La(e=t.sent()))throw e;return Dr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Ts.length&&this.gs.Rn(function(){return n.Cs()}),t.label=5;case 5:return[2]}})})},Wa.prototype.vs=function(t){var r=this,e=this.ws.then(function(){return r.Rs=!0,t().catch(function(t){throw r.As=t,r.Rs=!1,Or("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Rs=!1,t})});return this.ws=e},Wa.prototype.gn=function(t,e,n){var r=this;return this.bs(),-1<this.Ps.indexOf(t)&&(e=0),n=Ga.ls(this,t,e,n,function(t){return r.Ns(t)}),this.Is.push(n),n},Wa.prototype.bs=function(){this.As&&kr()},Wa.prototype.Fs=function(){},Wa.prototype.$s=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.ws];case 1:t.sent(),t.label=2;case 2:if(e!==this.ws)return[3,0];t.label=3;case 3:return[2]}})})},Wa.prototype.xs=function(t){for(var e=0,n=this.Is;e<n.length;e++)if(n[e].fn===t)return!0;return!1},Wa.prototype.ks=function(r){var i=this;return this.$s().then(function(){i.Is.sort(function(t,e){return t.cs-e.cs});for(var t=0,e=i.Is;t<e.length;t++){var n=e[t];if(n.Vn(),"all"!==r&&n.fn===r)break}return i.$s()})},Wa.prototype.Ms=function(t){this.Ps.push(t)},Wa.prototype.Ns=function(t){t=this.Is.indexOf(t),this.Is.splice(t,1)},Wa);function Wa(){var e=this;this.ws=Promise.resolve(),this.Ts=[],this.Es=!1,this.Is=[],this.As=null,this.Rs=!1,this.Ps=[],this.gs=new _a(this,"async_queue_retry"),this.ys=function(){var t=Ba();t&&Dr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.gs.yn()};var t=Ba();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.ys)}function Ka(t,e,n,r,i){this.os=t,this.fn=e,this.cs=n,this.op=r,this.us=i,this.hs=new Ia,this.then=this.hs.promise.then.bind(this.hs.promise),this.hs.promise.catch(function(t){})}function Ha(t,e){if(Or("AsyncQueue",e+": "+t),La(t))return new _r(Er.UNAVAILABLE,e+": "+t);throw t}function Qa(){this.Os=void 0,this.listeners=[]}function Ya(){this.Ls=new Si(qu,Fu),this.onlineState="Unknown",this.Bs=new Set}function Xa(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.Ls.get(n))||(r=!0,i=new Qa),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.qs(n)];case 2:return o.Os=t.sent(),[3,4];case 3:return o=Ha(o=t.sent(),"Initialization of query '"+Bu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.Ls.set(n,i),i.listeners.push(u),u.Us(e.onlineState),i.Os&&u.Qs(i.Os)&&Ja(e),[2]}})})}function $a(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.Ls.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.Ls.delete(n),e.Ws(n))]:[2]})})}function Ja(t){t.Bs.forEach(function(t){t.next()})}var Za=(nc.prototype.Qs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new yo(t.query,t.docs,t.Ut,e,t.Qt,t.fromCache,t.Wt,!0)}var o=!1;return this.Ks?this.zs(t)&&(this.js.next(t),o=!0):this.Hs(t,this.onlineState)&&(this.Ys(t),o=!0),this.Gs=t,o},nc.prototype.onError=function(t){this.js.error(t)},nc.prototype.Us=function(t){this.onlineState=t;var e=!1;return this.Gs&&!this.Ks&&this.Hs(this.Gs,t)&&(this.Ys(this.Gs),e=!0),e},nc.prototype.Hs=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Js&&n||t.docs.m()&&"Offline"!==e)},nc.prototype.zs=function(t){if(0<t.docChanges.length)return!0;var e=this.Gs&&this.Gs.hasPendingWrites!==t.hasPendingWrites;return!(!t.Wt&&!e)&&!0===this.options.includeMetadataChanges},nc.prototype.Ys=function(t){t=yo.Kt(t.query,t.docs,t.Qt,t.fromCache),this.Ks=!0,this.js.next(t)},nc),tc=(ec.prototype.Xs=function(){return null!=this.uid},ec.prototype.Zs=function(){return this.Xs()?"uid:"+this.uid:"anonymous-user"},ec.prototype.isEqual=function(t){return t.uid===this.uid},ec);function ec(t){this.uid=t}function nc(t,e,n){this.query=t,this.js=e,this.Ks=!1,this.Gs=null,this.onlineState="Unknown",this.options=n||{}}tc.UNAUTHENTICATED=new tc(null),tc.ti=new tc("google-credentials-uid"),tc.ei=new tc("first-party-uid");var rc=(ic.prototype.si=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},ic.prototype.next=function(){var t=++this.previousValue;return this.ii&&this.ii(t),t},ic);function ic(t,e){var n=this;this.previousValue=t,e&&(e.ni=function(t){return n.si(t)},this.ii=function(t){return e.ri(t)})}function oc(t,e){return"firestore_clients_"+t+"_"+e}function sc(t,e,n){return n="firestore_mutations_"+t+"_"+n,e.Xs()&&(n+="_"+e.uid),n}function uc(t,e){return"firestore_targets_"+t+"_"+e}rc.oi=-1;var ac=(kc.ai=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new _r(r.error.code,r.error.message)),i?new kc(t,e,r.state,o):(Or("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},kc.prototype.ci=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},kc),cc=(Rc.ai=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new _r(n.error.code,n.error.message)),r?new Rc(t,n.state,i):(Or("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},Rc.prototype.ci=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Rc),hc=(xc.ai=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=fo,o=0;r&&o<n.activeTargetIds.length;++o)r=Ui(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new xc(t,i):(Or("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},xc),fc=(Oc.ai=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Oc(e.clientId,e.onlineState):(Or("SharedClientState","Failed to parse online state: "+t),null)},Oc),lc=(Dc.prototype.ui=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Dc.prototype.hi=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Dc.prototype.ci=function(){var t={activeTargetIds:this.activeTargetIds.A(),updateTimeMs:Date.now()};return JSON.stringify(t)},Dc),pc=(Sc.On=function(t){return!(!t||!t.localStorage)},Sc.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f=this;return v(this,function(t){switch(t.label){case 0:return[4,this._i.Vi()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this.li&&(i=this.getItem(oc(this.persistenceKey,r)))&&(o=hc.ai(r,i))&&(this.mi=this.mi.rt(o.clientId,o));for(this.pi(),(s=this.storage.getItem(this.yi))&&(u=this.bi(s))&&this.vi(u),a=0,c=this.Ei;a<c.length;a++)h=c[a],this.wi(h);return this.Ei=[],this.window.addEventListener("unload",function(){return f.Si()}),this.Ti=!0,[2]}})})},Sc.prototype.ri=function(t){this.setItem(this.Ai,JSON.stringify(t))},Sc.prototype.Di=function(){return this.Ci(this.mi)},Sc.prototype.Ni=function(n){var r=!1;return this.mi.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},Sc.prototype.Fi=function(t){this.$i(t,"pending")},Sc.prototype.xi=function(t,e,n){this.$i(t,e,n),this.ki(t)},Sc.prototype.Mi=function(t){var e,n="not-current";return this.Ni(t)&&(!(e=this.storage.getItem(uc(this.persistenceKey,t)))||(e=cc.ai(t,e))&&(n=e.state)),this.Oi.ui(t),this.pi(),n},Sc.prototype.Li=function(t){this.Oi.hi(t),this.pi()},Sc.prototype.Bi=function(t){return this.Oi.activeTargetIds.has(t)},Sc.prototype.qi=function(t){this.removeItem(uc(this.persistenceKey,t))},Sc.prototype.Ui=function(t,e,n){this.Qi(t,e,n)},Sc.prototype.Wi=function(t,e,n){var r=this;e.forEach(function(t){r.ki(t)}),this.currentUser=t,n.forEach(function(t){r.Fi(t)})},Sc.prototype.ji=function(t){this.Ki(t)},Sc.prototype.Si=function(){this.Ti&&(this.window.removeEventListener("storage",this.di),this.removeItem(this.Ii),this.Ti=!1)},Sc.prototype.getItem=function(t){var e=this.storage.getItem(t);return Dr("SharedClientState","READ",t,e),e},Sc.prototype.setItem=function(t,e){Dr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},Sc.prototype.removeItem=function(t){Dr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},Sc.prototype.wi=function(t){var e=this,s=t;if(s.storageArea===this.storage){if(Dr("SharedClientState","EVENT",s.key,s.newValue),s.key===this.Ii)return void Or("Received WebStorage notification for local change. Another client might have garbage-collected our state");this._n.Ds(function(){return y(e,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){if(this.Ti){if(null!==s.key)if(this.Ri.test(s.key)){if(null==s.newValue)return e=this.Gi(s.key),[2,this.zi(e,null)];if(e=this.Hi(s.key,s.newValue))return[2,this.zi(e.clientId,e)]}else if(this.Pi.test(s.key)){if(null!==s.newValue&&(n=this.Yi(s.key,s.newValue)))return[2,this.Ji(n)]}else if(this.gi.test(s.key)){if(null!==s.newValue&&(r=this.Xi(s.key,s.newValue)))return[2,this.Zi(r)]}else if(s.key===this.yi){if(null!==s.newValue&&(i=this.bi(s.newValue)))return[2,this.vi(i)]}else s.key===this.Ai&&(o=function(t){var e=rc.oi;if(null!=t)try{var n=JSON.parse(t);Lr("number"==typeof n),e=n}catch(t){Or("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(s.newValue))!==rc.oi&&this.ni(o)}else this.Ei.push(s);return[2]})})})}},Object.defineProperty(Sc.prototype,"Oi",{get:function(){return this.mi.get(this.li)},enumerable:!1,configurable:!0}),Sc.prototype.pi=function(){this.setItem(this.Ii,this.Oi.ci())},Sc.prototype.$i=function(t,e,n){n=new ac(this.currentUser,t,e,n),t=sc(this.persistenceKey,this.currentUser,t),this.setItem(t,n.ci())},Sc.prototype.ki=function(t){t=sc(this.persistenceKey,this.currentUser,t),this.removeItem(t)},Sc.prototype.Ki=function(t){t={clientId:this.li,onlineState:t},this.storage.setItem(this.yi,JSON.stringify(t))},Sc.prototype.Qi=function(t,e,n){var r=uc(this.persistenceKey,t),n=new cc(t,e,n);this.setItem(r,n.ci())},Sc.prototype.Gi=function(t){return(t=this.Ri.exec(t))?t[1]:null},Sc.prototype.Hi=function(t,e){return t=this.Gi(t),hc.ai(t,e)},Sc.prototype.Yi=function(t,e){var n=this.Pi.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return ac.ai(new tc(n),t,e)},Sc.prototype.Xi=function(t,e){return t=this.gi.exec(t),t=Number(t[1]),cc.ai(t,e)},Sc.prototype.bi=function(t){return fc.ai(t)},Sc.prototype.Ji=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this._i.tr(e.batchId,e.state,e.error)]:(Dr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},Sc.prototype.Zi=function(t){return this._i.er(t.targetId,t.state,t.error)},Sc.prototype.zi=function(t,e){var n=this,r=e?this.mi.rt(t,e):this.mi.remove(t),i=this.Ci(this.mi),o=this.Ci(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this._i.nr(s,u).then(function(){n.mi=r})},Sc.prototype.vi=function(t){this.mi.get(t.clientId)&&this.fi(t.onlineState)},Sc.prototype.Ci=function(t){var n=fo;return t.forEach(function(t,e){n=n.xt(e.activeTargetIds)}),n},Sc),dc=(Ac.prototype.Fi=function(t){},Ac.prototype.xi=function(t,e,n){},Ac.prototype.Mi=function(t){return this.sr.ui(t),this.ir[t]||"not-current"},Ac.prototype.Ui=function(t,e,n){this.ir[t]=e},Ac.prototype.Li=function(t){this.sr.hi(t)},Ac.prototype.Bi=function(t){return this.sr.activeTargetIds.has(t)},Ac.prototype.qi=function(t){delete this.ir[t]},Ac.prototype.Di=function(){return this.sr.activeTargetIds},Ac.prototype.Ni=function(t){return this.sr.activeTargetIds.has(t)},Ac.prototype.start=function(){return this.sr=new lc,Promise.resolve()},Ac.prototype.Wi=function(t,e,n){},Ac.prototype.ji=function(t){},Ac.prototype.Si=function(){},Ac.prototype.ri=function(t){},Ac),yc=(Nc.prototype.ar=function(t,e,n){for(var r,i,o,s,u,a,c=n.cr,h=0;h<this.mutations.length;h++){var f=this.mutations[h];f.key.isEqual(t)&&(r=f,i=e,o=c[h],a=u=s=void 0,e=r instanceof Zs?new Iu(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof tu?(u=i,a=o,Hs((s=r).Ke,u)?(u=ru(s,u),new Iu(s.key,a.version,u,{hasCommittedMutations:!0})):new _u(s.key,a.version)):r instanceof ou?function(t,e,n){if(Lr(null!=n.transformResults),!Hs(t.Ke,e))return new _u(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Lr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Iu&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof Ds?Rs(o,s):o instanceof Ls?Vs(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=uu(t,r.data(),e);return new Iu(t.key,n,e,{hasCommittedMutations:!0})}(r,i,o):new Eu(r.key,o.version,{hasCommittedMutations:!0}))}return e},Nc.prototype.ur=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Qs(i,e,e,this.rr))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Qs(a,e,o,this.rr))}return e},Nc.prototype.hr=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ur(t.key,n.get(t.key));e&&(i=i.rt(t.key,e))}),i},Nc.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},ho())},Nc.prototype.isEqual=function(t){return this.batchId===t.batchId&&yi(this.mutations,t.mutations,Ys)&&yi(this.baseMutations,t.baseMutations,Ys)},Nc),vc=(Tc.from=function(t,e,n){Lr(t.mutations.length===n.length);for(var r=ao,i=t.mutations,o=0;o<i.length;o++)r=r.rt(i[o].key,n[o].version);return new Tc(t,e,n,r)},Tc),h=(Object.defineProperty(_c.prototype,"readTime",{get:function(){return this.mr},set:function(t){this.mr=t},enumerable:!1,configurable:!0}),_c.prototype.Tr=function(t,e){this.Er(),this.readTime=e,this.dr.set(t.key,t)},_c.prototype.Ir=function(t,e){this.Er(),e&&(this.readTime=e),this.dr.set(t,null)},_c.prototype.Ar=function(t,e){this.Er();var n=this.dr.get(e);return void 0!==n?Ta.resolve(n):this.Rr(t,e)},_c.prototype.getEntries=function(t,e){return this.Pr(t,e)},_c.prototype.apply=function(t){return this.Er(),this.wr=!0,this.gr(t)},_c.prototype.Er=function(){},_c),gc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ie=(Ec.prototype.Vr=function(t){this.yr.push(t)},Ec.prototype.pr=function(){this.yr.forEach(function(t){return t()})},Ec),mc=(Ic.prototype.Dr=function(e,n){var r=this;return this.vr.Cr(e,n).next(function(t){return r.Nr(e,n,t)})},Ic.prototype.Nr=function(t,r,i){return this.br.Ar(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ur(r,t);return t})},Ic.prototype.Fr=function(t,e,i){var o=io;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ur(t,e);o=o.rt(t,e)}),o},Ic.prototype.$r=function(e,t){var n=this;return this.br.getEntries(e,t).next(function(t){return n.kr(e,t)})},Ic.prototype.kr=function(e,r){var i=this;return this.vr.Mr(e,r).next(function(t){var t=i.Fr(e,r,t),n=io;return t.forEach(function(t,e){e=e||new Eu(t,Oi.min()),n=n.rt(t,e)}),n})},Ic.prototype.Or=function(t,e,n){return r=e,Br.F(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Lr(t,e.path):Pu(e)?this.Br(t,e,n):this.qr(t,e,n);var r},Ic.prototype.Lr=function(t,e){return this.Dr(t,new Br(e)).next(function(t){var e=uo;return t instanceof Iu&&(e=e.rt(t.key,t)),e})},Ic.prototype.Br=function(n,r,i){var o=this,s=r.collectionGroup,u=uo;return this.Sr.Ur(n,s).next(function(t){return Ta.forEach(t,function(t){var e=(e=r,t=t.child(s),new Tu(t,null,e.rn.slice(),e.filters.slice(),e.limit,e.on,e.startAt,e.endAt));return o.qr(n,e,i).next(function(t){t.forEach(function(t,e){u=u.rt(t,e)})})}).next(function(){return u})})},Ic.prototype.qr=function(e,n,t){var c,h,r=this;return this.br.Or(e,n,t).next(function(t){return c=t,r.vr.Qr(e,n)}).next(function(t){return h=t,r.Wr(e,h,c).next(function(t){c=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=Qs(s,a=c.get(u),a,r.rr);c=a instanceof Iu?c.rt(u,a):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){Gu(n,e)||(c=c.remove(t))}),c})},Ic.prototype.Wr=function(t,e,n){for(var r=ho(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof tu&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.br.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Iu&&(c=c.rt(t,e))}),c})},Ic),wc=(bc.Gr=function(t,e){for(var n=ho(),r=ho(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new bc(t,e.fromCache,n,r)},bc);function bc(t,e,n,r){this.targetId=t,this.fromCache=e,this.jr=n,this.Kr=r}function Ic(t,e,n){this.br=t,this.vr=e,this.Sr=n}function Ec(){this.yr=[]}function _c(){this.dr=new Si(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.wr=!1}function Tc(t,e,n,r){this.batch=t,this.lr=e,this.cr=n,this._r=r}function Nc(t,e,n,r){this.batchId=t,this.rr=e,this.baseMutations=n,this.mutations=r}function Ac(){this.sr=new lc,this.ir={},this.fi=null,this.ni=null}function Sc(t,e,n,r,i){this.window=t,this._n=e,this.persistenceKey=n,this.li=r,this._i=null,this.fi=null,this.ni=null,this.di=this.wi.bind(this),this.mi=new Yi(di),this.Ti=!1,this.Ei=[],n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),this.storage=this.window.localStorage,this.currentUser=i,this.Ii=oc(this.persistenceKey,this.li),this.Ai="firestore_sequence_number_"+this.persistenceKey,this.mi=this.mi.rt(this.li,new lc),this.Ri=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.Pi=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.gi=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.yi="firestore_online_state_"+this.persistenceKey,this.window.addEventListener("storage",this.di)}function Dc(){this.activeTargetIds=fo}function Oc(t,e){this.clientId=t,this.onlineState=e}function xc(t,e){this.clientId=t,this.activeTargetIds=e}function Rc(t,e,n){this.targetId=t,this.state=e,this.error=n}function kc(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function Lc(t,e){var n=t[0],r=t[1],t=e[0],e=e[1];return 0===(t=di(n,t))?di(r,e):t}var Pc=(Mc.prototype.Yr=function(){return++this.Hr},Mc.prototype.Jr=function(t){var e=[t,this.Yr()];this.buffer.size<this.zr?this.buffer=this.buffer.add(e):Lc(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(Mc.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),Mc),Vc={Xr:!1,Zr:0,eo:0,no:0},Cc=(Uc.oo=function(t){return new Uc(t,Uc.ao,Uc.co)},Uc);function Uc(t,e,n){this.so=t,this.io=e,this.ro=n}function Mc(t){this.zr=t,this.buffer=new no(Lc),this.Hr=0}Cc.uo=-1,Cc.ho=1048576,Cc.lo=41943040,Cc.ao=10,Cc.co=1e3,Cc._o=new Cc(Cc.lo,Cc.ao,Cc.co),Cc.fo=new Cc(Cc.uo,0,0);var jc=(Bc.prototype.start=function(t){this.do.params.so!==Cc.uo&&this.To(t)},Bc.prototype.stop=function(){this.mo&&(this.mo.cancel(),this.mo=null)},Object.defineProperty(Bc.prototype,"Ti",{get:function(){return null!==this.mo},enumerable:!1,configurable:!0}),Bc.prototype.To=function(n){var t=this,e=this.wo?3e5:6e4;Dr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.mo=this.os.gn("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.mo=null,this.wo=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.Eo(this.do)];case 2:return t.sent(),[3,7];case 3:return La(e=t.sent())?(Dr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,gf(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.To(n)];case 8:return t.sent(),[2]}})})})},Bc),Fc=(qc.prototype.Ao=function(t,e){return this.Io.Ro(t).next(function(t){return Math.floor(e/100*t)})},qc.prototype.Po=function(t,e){var n=this;if(0===e)return Ta.resolve(rc.oi);var r=new Pc(e);return this.Io.De(t,function(t){return r.Jr(t.sequenceNumber)}).next(function(){return n.Io.yo(t,function(t){return r.Jr(t)})}).next(function(){return r.maxValue})},qc.prototype.Vo=function(t,e,n){return this.Io.Vo(t,e,n)},qc.prototype.po=function(t,e){return this.Io.po(t,e)},qc.prototype.bo=function(e,n){var r=this;return this.params.so===Cc.uo?(Dr("LruGarbageCollector","Garbage collection skipped; disabled"),Ta.resolve(Vc)):this.vo(e).next(function(t){return t<r.params.so?(Dr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.so),Vc):r.So(e,n)})},qc.prototype.vo=function(t){return this.Io.vo(t)},qc.prototype.So=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.Ao(e,this.params.io).next(function(t){return i=t>h.params.ro?(Dr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.ro+" from "+t),h.params.ro):t,s=Date.now(),h.Po(e,i)}).next(function(t){return r=t,u=Date.now(),h.Vo(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.po(e,r)}).next(function(t){return c=Date.now(),Sr()<=l.DEBUG&&Dr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),Ta.resolve({Xr:!0,Zr:i,eo:o,no:t})})},qc);function qc(t,e){this.Io=t,this.params=e}function Bc(t,e){this.do=t,this.os=e,this.wo=!1,this.mo=null}function Gc(t){for(var o="",e=0;e<t.length;e++)0<o.length&&(o=zc(o)),o=function(t){for(var e=o,n=t.length,r=0;r<n;r++){var i=t.charAt(r);switch(i){case"\0":e+="";break;case"":e+="";break;default:e+=i}}return e}(t.get(e));return zc(o)}function zc(t){return t+""}function Wc(t){var e=t.length;if(Lr(2<=e),2===e)return Lr(""===t.charAt(0)&&""===t.charAt(1)),jr.g();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&kr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:kr()}o=s+2}return new jr(r)}var Kc=function(t){this.Do=t};function Hc(t,e){if(e.document)return n=t.Do,r=e.document,i=!!e.hasCommittedMutations,t=as(n,r.name),n=is(r.updateTime),r=new lu({mapValue:{fields:r.fields}}),new Iu(t,n,r,{hasCommittedMutations:!!i});var n,r;if(e.noDocument){var i=Br.$(e.noDocument.path),o=Jc(e.noDocument.readTime);return new Eu(i,o,{hasCommittedMutations:!!e.hasCommittedMutations})}return e.unknownDocument?(o=Br.$(e.unknownDocument.path),e=Jc(e.unknownDocument.version),new _u(o,e)):kr()}function Qc(t,e,n){var r=Yc(n),n=e.key.path.h().A();if(e instanceof Iu){var i={name:us(i=t.Do,(o=e).key),fields:o.sn().mapValue.fields,updateTime:ns(i,o.version.X())},o=e.hasCommittedMutations;return new kh(null,null,i,o,r,n)}if(e instanceof Eu){var i=e.key.path.A(),o=$c(e.version),s=e.hasCommittedMutations;return new kh(null,new xh(i,o),null,s,r,n)}return e instanceof _u?(s=e.key.path.A(),e=$c(e.version),new kh(new Rh(s,e),null,null,!0,r,n)):kr()}function Yc(t){return[(t=t.X()).seconds,t.nanoseconds]}function Xc(t){return t=new Di(t[0],t[1]),Oi.Y(t)}function $c(t){return t=t.X(),new Ih(t.seconds,t.nanoseconds)}function Jc(t){return t=new Di(t.seconds,t.nanoseconds),Oi.Y(t)}function Zc(e,t){var n=(t.baseMutations||[]).map(function(t){return ys(e.Do,t)}),r=t.mutations.map(function(t){return ys(e.Do,t)}),i=Di.fromMillis(t.localWriteTimeMs);return new yc(t.batchId,i,n,r)}function th(t){var e=Jc(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?Jc(t.lastLimboFreeSnapshotVersion):Oi.min(),r=void 0!==t.query.documents?(Lr(1===(r=t.query).documents.length),Cu(Ou(hs(r.documents[0])))):ms(t.query);return new Wi(r,t.targetId,0,t.lastListenSequenceNumber,e,n,gi.fromBase64String(t.resumeToken))}function eh(t,e){var n=$c(e.et),r=$c(e.lastLimboFreeSnapshotVersion),i=(Bi(e.target)?vs:gs)(t.Do,e.target),t=e.resumeToken.toBase64();return new Ph(e.targetId,Fi(e.target),n,t,e.sequenceNumber,r,i)}var nh=(rh.Fo=function(t,e,n,r){return Lr(""!==t.uid),new rh(t.Xs()?t.uid:"",e,n,r)},rh.prototype.$o=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return sh(t).ss({index:Sh.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},rh.prototype.xo=function(d,y,v,g){var m=this,w=uh(d),b=sh(d);return b.add({}).next(function(t){Lr("number"==typeof t);for(var e,n,r,i,o,s=new yc(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return ds(e.Do,t)}),o=r.mutations.map(function(t){return ds(e.Do,t)}),new Sh(n,r.batchId,r.rr.toMillis(),i,o)),a=[],c=new no(function(t,e){return di(t.R(),e.R())}),h=0,f=g;h<f.length;h++){var l=f[h],p=Dh.key(m.userId,l.key.path,t),c=c.add(l.key.path.h());a.push(b.put(u)),a.push(w.put(p,Dh.PLACEHOLDER))}return c.forEach(function(t){a.push(m.Sr.ko(d,t))}),d.Vr(function(){m.No[t]=s.keys()}),Ta.$n(a).next(function(){return s})})},rh.prototype.Mo=function(t,e){var n=this;return sh(t).get(e).next(function(t){return t?(Lr(t.userId===n.userId),Zc(n.serializer,t)):null})},rh.prototype.Oo=function(t,e){var n=this;return this.No[e]?Ta.resolve(this.No[e]):this.Mo(t,e).next(function(t){return t?(t=t.keys(),n.No[e]=t):null})},rh.prototype.Lo=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return sh(t).ss({index:Sh.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(Lr(e.batchId>=i),o=Zc(r.serializer,e)),n.done()}).next(function(){return o})},rh.prototype.Bo=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return sh(t).ss({index:Sh.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},rh.prototype.qo=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return sh(t).Zn(Sh.userMutationsIndex,n).next(function(t){return t.map(function(t){return Zc(e.serializer,t)})})},rh.prototype.Cr=function(o,s){var u=this,t=Dh.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return uh(o).ss({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Wc(i);if(r===u.userId&&s.path.isEqual(i))return sh(o).get(t).next(function(t){if(!t)throw kr();Lr(t.userId===u.userId),a.push(Zc(u.serializer,t))});n.done()}).next(function(){return a})},rh.prototype.Mr=function(e,t){var s=this,u=new no(di),n=[];return t.forEach(function(o){var t=Dh.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=uh(e).ss({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Wc(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),Ta.$n(n).next(function(){return s.Uo(e,u)})},rh.prototype.Qr=function(t,e){var o=this,s=e.path,u=s.length+1,e=Dh.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new no(di);return uh(t).ss({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Wc(i);r===o.userId&&s.T(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.Uo(t,a)})},rh.prototype.Uo=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(sh(e).get(t).next(function(t){if(null===t)throw kr();Lr(t.userId===n.userId),r.push(Zc(n.serializer,t))}))}),Ta.$n(i).next(function(){return r})},rh.prototype.Qo=function(e,n){var r=this;return oh(e.Wo,this.userId,n).next(function(t){return e.Vr(function(){r.jo(n.batchId)}),Ta.forEach(t,function(t){return r.Co.Ko(e,t)})})},rh.prototype.jo=function(t){delete this.No[t]},rh.prototype.Go=function(e){var i=this;return this.$o(e).next(function(t){if(!t)return Ta.resolve();var t=IDBKeyRange.lowerBound(Dh.prefixForUser(i.userId)),r=[];return uh(e).ss({range:t},function(t,e,n){t[0]===i.userId?(t=Wc(t[1]),r.push(t)):n.done()}).next(function(){Lr(0===r.length)})})},rh.prototype.zo=function(t,e){return ih(t,this.userId,e)},rh.prototype.Ho=function(t){var e=this;return ah(t).get(this.userId).next(function(t){return t||new Ah(e.userId,-1,"")})},rh);function rh(t,e,n,r){this.userId=t,this.serializer=e,this.Sr=n,this.Co=r,this.No={}}function ih(t,o,e){var s=(e=Dh.prefixForPath(o,e.path))[1],e=IDBKeyRange.lowerBound(e),u=!1;return uh(t).ss({range:e,ns:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function oh(t,e,n){var r=t.store(Sh.store),i=t.store(Dh.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r.ss({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){Lr(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],f=Dh.key(e,h.key.path,n.batchId);o.push(i.delete(f)),u.push(h.key)}return Ta.$n(o).next(function(){return u})}function sh(t){return tf.Un(t,Sh.store)}function uh(t){return tf.Un(t,Dh.store)}function ah(t){return tf.Un(t,Ah.store)}var ch,hh=(ph.prototype.Tr=function(t,e,n){return yh(t).put(vh(e),n)},ph.prototype.Ir=function(t,e){return t=yh(t),e=vh(e),t.delete(e)},ph.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.Yo(e,t)})},ph.prototype.Ar=function(t,e){var n=this;return yh(t).get(vh(e)).next(function(t){return n.Jo(t)})},ph.prototype.Xo=function(t,e){var n=this;return yh(t).get(vh(e)).next(function(t){var e=n.Jo(t);return e?{Zo:e,size:gh(t)}:null})},ph.prototype.getEntries=function(t,e){var n=this,r=io;return this.ta(t,e,function(t,e){e=n.Jo(e),r=r.rt(t,e)}).next(function(){return r})},ph.prototype.ea=function(t,e){var r=this,i=io,o=new Yi(Br.i);return this.ta(t,e,function(t,e){var n=r.Jo(e);o=n?(i=i.rt(t,n),o.rt(t,gh(e))):(i=i.rt(t,null),o.rt(t,0))}).next(function(){return{na:i,sa:o}})},ph.prototype.ta=function(t,e,i){if(e.m())return Ta.resolve();var n=IDBKeyRange.bound(e.first().path.A(),e.last().path.A()),o=e.lt(),s=o.Et();return yh(t).ss({range:n},function(t,e,n){for(var r=Br.$(t);s&&Br.i(s,r)<0;)i(s,null),s=o.Et();s&&s.isEqual(r)&&(i(s,e),s=o.It()?o.Et():null),s?n.Jn(s.path.A()):n.done()}).next(function(){for(;s;)i(s,null),s=o.It()?o.Et():null})},ph.prototype.Or=function(t,r,e){var n,i=this,o=uo,s=r.path.length+1,u={};return e.isEqual(Oi.min())?(n=r.path.A(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.A(),e=Yc(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=kh.collectionReadTimeIndex),yh(t).ss(u,function(t,e,n){t.length===s&&(e=Hc(i.serializer,e),r.path.T(e.key.path)?e instanceof Iu&&Gu(r,e)&&(o=o.rt(e.key,e)):n.done())}).next(function(){return o})},ph.prototype.ia=function(t){return new fh(this,!!t&&t.ra)},ph.prototype.oa=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},ph.prototype.getMetadata=function(t){return dh(t).get(Lh.key).next(function(t){return Lr(!!t),t})},ph.prototype.Yo=function(t,e){return dh(t).put(Lh.key,e)},ph.prototype.Jo=function(t){return!t||(t=Hc(this.serializer,t))instanceof Eu&&t.version.isEqual(Oi.min())?null:t},ph),fh=(n(lh,ch=h),lh.prototype.gr=function(i){var o=this,s=[],u=0,a=new no(function(t,e){return di(t.R(),e.R())});return this.dr.forEach(function(t,e){var n,r=o.ca.get(t);e?(n=Qc(o.aa.serializer,e,o.readTime),a=a.add(t.path.h()),e=gh(n),u+=e-r,s.push(o.aa.Tr(i,t,n))):(u-=r,o.ra?(r=Qc(o.aa.serializer,new Eu(t,Oi.min()),o.readTime),s.push(o.aa.Tr(i,t,r))):s.push(o.aa.Ir(i,t)))}),a.forEach(function(t){s.push(o.aa.Sr.ko(i,t))}),s.push(this.aa.updateMetadata(i,u)),Ta.$n(s)},lh.prototype.Rr=function(t,e){var n=this;return this.aa.Xo(t,e).next(function(t){return null===t?(n.ca.set(e,0),null):(n.ca.set(e,t.size),t.Zo)})},lh.prototype.Pr=function(t,e){var n=this;return this.aa.ea(t,e).next(function(t){var e=t.na;return t.sa.forEach(function(t,e){n.ca.set(t,e)}),e})},lh);function lh(t,e){var n=this;return(n=ch.call(this)||this).aa=t,n.ra=e,n.ca=new Si(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function ph(t,e){this.serializer=t,this.Sr=e}function dh(t){return tf.Un(t,Lh.store)}function yh(t){return tf.Un(t,kh.store)}function vh(t){return t.path.A()}function gh(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw kr();e=t.noDocument}return JSON.stringify(e).length}var mh=(Nh.prototype.ko=function(t,e){return this.ua.add(e),Ta.resolve()},Nh.prototype.Ur=function(t,e){return Ta.resolve(this.ua.getEntries(e))},Nh),wh=(Th.prototype.add=function(t){var e=t._(),n=t.h(),r=this.index[e]||new no(jr.i),t=!r.has(n);return this.index[e]=r.add(n),t},Th.prototype.has=function(t){var e=t._(),t=t.h();return(e=this.index[e])&&e.has(t)},Th.prototype.getEntries=function(t){return(this.index[t]||new no(jr.i)).A()},Th),bh=(_h.prototype.createOrUpgrade=function(e,n,t,r){var i=this;Lr(t<r&&0<=t&&r<=10);var o=new Pa("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(Eh.store),(s=e).createObjectStore(Ah.store,{keyPath:Ah.keyPath}),s.createObjectStore(Sh.store,{keyPath:Sh.keyPath,autoIncrement:!0}).createIndex(Sh.userMutationsIndex,Sh.userMutationsKeyPath,{unique:!0}),s.createObjectStore(Dh.store),Mh(e),e.createObjectStore(kh.store));var s,u=Ta.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(Vh.store),s.deleteObjectStore(Ph.store),s.deleteObjectStore(Ch.store),Mh(e)),u=u.next(function(){return t=o.store(Ch.store),e=new Ch(0,0,Oi.min().X(),0),t.put(Ch.key,e);var t,e})),t<4&&4<=r&&(0!==t&&(u=u.next(function(){return n=e,(r=o).store(Sh.store).Zn().next(function(t){n.deleteObjectStore(Sh.store),n.createObjectStore(Sh.store,{keyPath:Sh.keyPath,autoIncrement:!0}).createIndex(Sh.userMutationsIndex,Sh.userMutationsKeyPath,{unique:!0});var e=r.store(Sh.store),t=t.map(function(t){return e.put(t)});return Ta.$n(t)});var n,r})),u=u.next(function(){e.createObjectStore(jh.store,{keyPath:jh.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.removeAcknowledgedMutations(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(Lh.store),i.addDocumentGlobal(o)})),t<7&&7<=r&&(u=u.next(function(){return i.ensureSequenceNumbers(o)})),t<8&&8<=r&&(u=u.next(function(){return i.createCollectionParentIndex(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(kh.store)).createIndex(kh.readTimeIndex,kh.readTimeIndexPath,{unique:!1}),t.createIndex(kh.collectionReadTimeIndex,kh.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.rewriteCanonicalIds(o)})),u},_h.prototype.addDocumentGlobal=function(e){var n=0;return e.store(kh.store).ss(function(t,e){n+=gh(e)}).next(function(){var t=new Lh(n);return e.store(Lh.store).put(Lh.key,t)})},_h.prototype.removeAcknowledgedMutations=function(n){var r=this,t=n.store(Ah.store),i=n.store(Sh.store);return t.Zn().next(function(t){return Ta.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.Zn(Sh.userMutationsIndex,t).next(function(t){return Ta.forEach(t,function(t){return Lr(t.userId===e.userId),t=Zc(r.serializer,t),oh(n,e.userId,t).next(function(){})})})})})},_h.prototype.ensureSequenceNumbers=function(t){var o=t.store(Vh.store),e=t.store(kh.store);return t.store(Ch.store).get(Ch.key).next(function(r){var i=[];return e.ss(function(t,e){var n=new jr(t),t=[0,Gc(n)];i.push(o.get(t).next(function(t){return t?Ta.resolve():o.put(new Vh(0,Gc(n),r.highestListenSequenceNumber))}))}).next(function(){return Ta.$n(i)})})},_h.prototype.createCollectionParentIndex=function(t,e){function r(t){if(i.add(t)){var e=t._(),t=t.h();return n.put({collectionId:e,parent:Gc(t)})}}t.createObjectStore(Uh.store,{keyPath:Uh.keyPath});var n=e.store(Uh.store),i=new wh;return e.store(kh.store).ss({ns:!0},function(t,e){return r((t=new jr(t)).h())}).next(function(){return e.store(Dh.store).ss({ns:!0},function(t,e){t[0];var n=t[1];return r((n=(t[2],Wc(n))).h())})})},_h.prototype.rewriteCanonicalIds=function(t){var n=this,r=t.store(Ph.store);return r.ss(function(t,e){return e=th(e),e=eh(n.serializer,e),r.put(e)})},_h),Ih=function(t,e){this.seconds=t,this.nanoseconds=e},Eh=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function _h(t){this.serializer=t}function Th(){this.index={}}function Nh(){this.ua=new wh}Eh.store="owner",Eh.key="owner";var Ah=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Ah.store="mutationQueues",Ah.keyPath="userId";var Sh=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Sh.store="mutations",Sh.keyPath="batchId",Sh.userMutationsIndex="userMutationsIndex",Sh.userMutationsKeyPath=["userId","batchId"];var Dh=(Oh.prefixForUser=function(t){return[t]},Oh.prefixForPath=function(t,e){return[t,Gc(e)]},Oh.key=function(t,e,n){return[t,Gc(e),n]},Oh);function Oh(){}Dh.store="documentMutations",Dh.PLACEHOLDER=new Dh;var xh=function(t,e){this.path=t,this.readTime=e},Rh=function(t,e){this.path=t,this.version=e},kh=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};kh.store="remoteDocuments",kh.readTimeIndex="readTimeIndex",kh.readTimeIndexPath="readTime",kh.collectionReadTimeIndex="collectionReadTimeIndex",kh.collectionReadTimeIndexPath=["parentPath","readTime"];var Lh=function(t){this.byteSize=t};Lh.store="remoteDocumentGlobal",Lh.key="remoteDocumentGlobalKey";var Ph=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Ph.store="targets",Ph.keyPath="targetId",Ph.queryTargetsIndexName="queryTargetsIndex",Ph.queryTargetsKeyPath=["canonicalId","targetId"];var Vh=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Vh.store="targetDocuments",Vh.keyPath=["targetId","path"],Vh.documentTargetsIndex="documentTargetsIndex",Vh.documentTargetsKeyPath=["path","targetId"];var Ch=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Ch.key="targetGlobalKey",Ch.store="targetGlobal";var Uh=function(t,e){this.collectionId=t,this.parent=e};function Mh(t){t.createObjectStore(Vh.store,{keyPath:Vh.keyPath}).createIndex(Vh.documentTargetsIndex,Vh.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Ph.store,{keyPath:Ph.keyPath}).createIndex(Ph.queryTargetsIndexName,Ph.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Ch.store)}Uh.store="collectionParents",Uh.keyPath=["collectionId","parent"];var jh=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};jh.store="clientMetadata",jh.keyPath="clientId";var Fh=i(i(i([Ah.store,Sh.store,Dh.store,kh.store,Ph.store,Eh.store,Ch.store,Vh.store],[jh.store]),[Lh.store]),[Uh.store]),qh=(Bh.prototype.ko=function(t,e){var n=this;if(this.ha.has(e))return Ta.resolve();var r=e._(),i=e.h();return t.Vr(function(){n.ha.add(e)}),i={collectionId:r,parent:Gc(i)},Gh(t).put(i)},Bh.prototype.Ur=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[vi(i),""],!1,!0);return Gh(t).Zn(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(Wc(r.parent))}return o})},Bh);function Bh(){this.ha=new wh}function Gh(t){return tf.Un(t,Uh.store)}var zh=(Hh.prototype.next=function(){return this.la+=2,this.la},Hh._a=function(){return new Hh(0)},Hh.fa=function(){return new Hh(-1)},Hh),Wh=(Kh.prototype.da=function(n){var r=this;return this.wa(n).next(function(t){var e=new zh(t.highestTargetId);return t.highestTargetId=e.next(),r.ma(n,t).next(function(){return t.highestTargetId})})},Kh.prototype.Ta=function(t){return this.wa(t).next(function(t){return Oi.Y(new Di(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},Kh.prototype.Ea=function(t){return this.wa(t).next(function(t){return t.highestListenSequenceNumber})},Kh.prototype.Ia=function(e,n,r){var i=this;return this.wa(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.X()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.ma(e,t)})},Kh.prototype.Aa=function(e,n){var r=this;return this.Ra(e,n).next(function(){return r.wa(e).next(function(t){return t.targetCount+=1,r.Pa(n,t),r.ma(e,t)})})},Kh.prototype.ga=function(t,e){return this.Ra(t,e)},Kh.prototype.ya=function(e,t){var n=this;return this.Va(e,t.targetId).next(function(){return Qh(e).delete(t.targetId)}).next(function(){return n.wa(e)}).next(function(t){return Lr(0<t.targetCount),--t.targetCount,n.ma(e,t)})},Kh.prototype.Vo=function(n,r,i){var o=this,s=0,u=[];return Qh(n).ss(function(t,e){(e=th(e)).sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.ya(n,e)))}).next(function(){return Ta.$n(u)}).next(function(){return s})},Kh.prototype.De=function(t,n){return Qh(t).ss(function(t,e){e=th(e),n(e)})},Kh.prototype.wa=function(t){return Yh(t).get(Ch.key).next(function(t){return Lr(null!==t),t})},Kh.prototype.ma=function(t,e){return Yh(t).put(Ch.key,e)},Kh.prototype.Ra=function(t,e){return Qh(t).put(eh(this.serializer,e))},Kh.prototype.Pa=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},Kh.prototype.pa=function(t){return this.wa(t).next(function(t){return t.targetCount})},Kh.prototype.ba=function(t,r){var e=Fi(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return Qh(t).ss({range:e,index:Ph.queryTargetsIndexName},function(t,e,n){e=th(e),qi(r,e.target)&&(i=e,n.done())}).next(function(){return i})},Kh.prototype.va=function(n,t,r){var i=this,o=[],s=Xh(n);return t.forEach(function(t){var e=Gc(t.path);o.push(s.put(new Vh(r,e))),o.push(i.Co.Sa(n,r,t))}),Ta.$n(o)},Kh.prototype.Da=function(n,t,r){var i=this,o=Xh(n);return Ta.forEach(t,function(t){var e=Gc(t.path);return Ta.$n([o.delete([r,e]),i.Co.Ca(n,r,t)])})},Kh.prototype.Va=function(t,e){return t=Xh(t),e=IDBKeyRange.bound([e],[e+1],!1,!0),t.delete(e)},Kh.prototype.Na=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=Xh(t),r=ho();return t.ss({range:e,ns:!0},function(t,e,n){t=Wc(t[1]),t=new Br(t),r=r.add(t)}).next(function(){return r})},Kh.prototype.zo=function(t,e){var e=Gc(e.path),e=IDBKeyRange.bound([e],[vi(e)],!1,!0),i=0;return Xh(t).ss({index:Vh.documentTargetsIndex,ns:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},Kh.prototype.qe=function(t,e){return Qh(t).get(e).next(function(t){return t?th(t):null})},Kh);function Kh(t,e){this.Co=t,this.serializer=e}function Hh(t){this.la=t}function Qh(t){return tf.Un(t,Ph.store)}function Yh(t){return tf.Un(t,Ch.store)}function Xh(t){return tf.Un(t,Vh.store)}var $h,Jh="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Zh=(n(nf,$h=Ie),nf),tf=(ef.Un=function(t,e){if(t instanceof Zh)return Na.Un(t.Wo,e);throw kr()},ef.prototype.start=function(){var e=this;return this.Ga().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new _r(Er.FAILED_PRECONDITION,Jh);return e.za(),e.Ha(),e.Ya(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.ja.Ea(t)})}).then(function(t){e.ka=new rc(t,e.$a)}).then(function(){e.Ma=!0}).catch(function(t){return e.Wa&&e.Wa.close(),Promise.reject(t)})},ef.prototype.Ja=function(n){var t=this;return this.Ua=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.Ti?[2,n(e)]:[2]})})},n(this.isPrimary)},ef.prototype.Xa=function(n){var t=this;this.Wa.jn(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},ef.prototype.Za=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this._n.ds(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ti?[4,this.Ga()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},ef.prototype.Ga=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return of(e).put(new jh(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.tc(e).next(function(t){t||(n.isPrimary=!1,n._n.Ds(function(){return n.Ua(!1)}))})}).next(function(){return n.ec(e)}).next(function(t){return n.isPrimary&&!t?n.nc(e).next(function(){return!1}):!!t&&n.sc(e).next(function(){return!0})})}).catch(function(t){if(La(t))return Dr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Dr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n._n.Ds(function(){return n.Ua(t)}),n.isPrimary=t})},ef.prototype.tc=function(t){var e=this;return rf(t).get(Eh.key).next(function(t){return Ta.resolve(e.ic(t))})},ef.prototype.rc=function(t){return of(t).delete(this.clientId)},ef.prototype.oc=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.ac(this.qa,18e5)?[3,2]:(this.qa=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=ef.Un(t,jh.store);return r.Zn().next(function(t){var e=o.cc(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return Ta.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.Ka)for(n=0,r=e;n<r.length;n++)i=r[n],this.Ka.removeItem(this.uc(i.clientId));t.label=2;case 2:return[2]}})})},ef.prototype.Ya=function(){var t=this;this.Ba=this._n.gn("client_metadata_refresh",4e3,function(){return t.Ga().then(function(){return t.oc()}).then(function(){return t.Ya()})})},ef.prototype.ic=function(t){return!!t&&t.ownerId===this.clientId},ef.prototype.ec=function(e){var r=this;return this.xa?Ta.resolve(!0):rf(e).get(Eh.key).next(function(t){if(null!==t&&r.ac(t.leaseTimestampMs,5e3)&&!r.hc(t.ownerId)){if(r.ic(t)&&r.networkEnabled)return!0;if(!r.ic(t)){if(!t.allowTabSynchronization)throw new _r(Er.FAILED_PRECONDITION,Jh);return!1}}return!(!r.networkEnabled||!r.inForeground)||of(e).Zn().next(function(t){return void 0===r.cc(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&Dr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},ef.prototype.Si=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this.Ma=!1,this.lc(),this.Ba&&(this.Ba.cancel(),this.Ba=null),this._c(),this.fc(),[4,this.Wa.runTransaction("shutdown","readwrite",[Eh.store,jh.store],function(t){var e=new Zh(t,rc.oi);return n.nc(e).next(function(){return n.rc(e)})})];case 1:return t.sent(),this.Wa.close(),this.dc(),[2]}})})},ef.prototype.cc=function(t,e){var n=this;return t.filter(function(t){return n.ac(t.updateTimeMs,e)&&!n.hc(t.clientId)})},ef.prototype.Vi=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return of(t).Zn().next(function(t){return e.cc(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(ef.prototype,"Ti",{get:function(){return this.Ma},enumerable:!1,configurable:!0}),ef.prototype.wc=function(t){return nh.Fo(t,this.serializer,this.Sr,this.Co)},ef.prototype.mc=function(){return this.ja},ef.prototype.Tc=function(){return this.br},ef.prototype.Ec=function(){return this.Sr},ef.prototype.runTransaction=function(e,n,r){var i=this;Dr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Wa.runTransaction(e,t,Fh,function(t){return o=new Zh(t,i.ka?i.ka.next():rc.oi),"readwrite-primary"===n?i.tc(o).next(function(t){return!!t||i.ec(o)}).next(function(t){if(!t)throw Or("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i._n.Ds(function(){return i.Ua(!1)}),new _r(Er.FAILED_PRECONDITION,gc);return r(o)}).next(function(t){return i.sc(o).next(function(){return t})}):i.Ic(o).next(function(){return r(o)})}).then(function(t){return o.pr(),t})},ef.prototype.Ic=function(t){var e=this;return rf(t).get(Eh.key).next(function(t){if(null!==t&&e.ac(t.leaseTimestampMs,5e3)&&!e.hc(t.ownerId)&&!e.ic(t)&&!(e.xa||e.allowTabSynchronization&&t.allowTabSynchronization))throw new _r(Er.FAILED_PRECONDITION,Jh)})},ef.prototype.sc=function(t){var e=new Eh(this.clientId,this.allowTabSynchronization,Date.now());return rf(t).put(Eh.key,e)},ef.On=function(){return Na.On()},ef.prototype.nc=function(t){var e=this,n=rf(t);return n.get(Eh.key).next(function(t){return e.ic(t)?(Dr("IndexedDbPersistence","Releasing primary lease."),n.delete(Eh.key)):Ta.resolve()})},ef.prototype.ac=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Or("Detected an update time that is in the future: "+t+" > "+n),1))},ef.prototype.za=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.La=function(){t._n.ds(function(){return t.inForeground="visible"===t.document.visibilityState,t.Ga()})},this.document.addEventListener("visibilitychange",this.La),this.inForeground="visible"===this.document.visibilityState)},ef.prototype._c=function(){this.La&&(this.document.removeEventListener("visibilitychange",this.La),this.La=null)},ef.prototype.Ha=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Oa=function(){e.lc(),e._n.ds(function(){return e.Si()})},this.window.addEventListener("unload",this.Oa))},ef.prototype.fc=function(){this.Oa&&(this.window.removeEventListener("unload",this.Oa),this.Oa=null)},ef.prototype.hc=function(t){try{var e=null!==(null===(e=this.Ka)||void 0===e?void 0:e.getItem(this.uc(t)));return Dr("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return Or("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},ef.prototype.lc=function(){if(this.Ka)try{this.Ka.setItem(this.uc(this.clientId),String(Date.now()))}catch(t){Or("Failed to set zombie client id.",t)}},ef.prototype.dc=function(){if(this.Ka)try{this.Ka.removeItem(this.uc(this.clientId))}catch(t){}},ef.prototype.uc=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},ef);function ef(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this._n=i,this.window=o,this.document=s,this.$a=a,this.xa=c,this.ka=null,this.Ma=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Oa=null,this.inForeground=!1,this.La=null,this.Ba=null,this.qa=Number.NEGATIVE_INFINITY,this.Ua=function(t){return Promise.resolve()},!ef.On())throw new _r(Er.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Co=new sf(this,r),this.Qa=e+"main",this.serializer=new Kc(u),this.Wa=new Na(this.Qa,10,new bh(this.serializer)),this.ja=new Wh(this.Co,this.serializer),this.Sr=new qh,this.br=(e=this.serializer,u=this.Sr,new hh(e,u)),this.window&&this.window.localStorage?this.Ka=this.window.localStorage:(this.Ka=null,!1===c&&Or("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function nf(t,e){var n=this;return(n=$h.call(this)||this).Wo=t,n.Fa=e,n}function rf(t){return tf.Un(t,Eh.store)}function of(t){return tf.Un(t,jh.store)}var sf=(uf.prototype.Ro=function(t){var n=this.Ac(t);return this.db.mc().pa(t).next(function(e){return n.next(function(t){return e+t})})},uf.prototype.Ac=function(t){var e=0;return this.yo(t,function(t){e++}).next(function(){return e})},uf.prototype.De=function(t,e){return this.db.mc().De(t,e)},uf.prototype.yo=function(t,n){return this.Rc(t,function(t,e){return n(e)})},uf.prototype.Sa=function(t,e,n){return af(t,n)},uf.prototype.Ca=function(t,e,n){return af(t,n)},uf.prototype.Vo=function(t,e,n){return this.db.mc().Vo(t,e,n)},uf.prototype.Ko=af,uf.prototype.Pc=function(t,e){return r=e,i=!1,ah(n=t).rs(function(t){return ih(n,t,r).next(function(t){return t&&(i=!0),Ta.resolve(!t)})}).next(function(){return i});var n,r,i},uf.prototype.po=function(n,r){var i=this,o=this.db.Tc().ia(),s=[],u=0;return this.Rc(n,function(e,t){t<=r&&(t=i.Pc(n,e).next(function(t){if(!t)return u++,o.Ar(n,e).next(function(){return o.Ir(e),Xh(n).delete([0,Gc(e.path)])})}),s.push(t))}).next(function(){return Ta.$n(s)}).next(function(){return o.apply(n)}).next(function(){return u})},uf.prototype.removeTarget=function(t,e){return e=e.nt(t.Fa),this.db.mc().ga(t,e)},uf.prototype.gc=af,uf.prototype.Rc=function(t,r){var i,t=Xh(t),o=rc.oi;return t.ss({index:Vh.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==rc.oi&&r(new Br(Wc(i)),o),o=e,i=t):o=rc.oi}).next(function(){o!==rc.oi&&r(new Br(Wc(i)),o)})},uf.prototype.vo=function(t){return this.db.Tc().oa(t)},uf);function uf(t,e){this.db=t,this.do=new Fc(this,e)}function af(t,e){return Xh(t).put((t=t.Fa,new Vh(0,Gc(e.path),t)))}function cf(t,e){var n=t.projectId;return t.W||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var hf=(ff.prototype.Eo=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.bo(t,n.Vc)})},ff);function ff(t,e,n){this.persistence=t,this.yc=e,this.Vc=new Yi(di),this.bc=new Si(Fi,qi),this.vc=Oi.min(),this.vr=t.wc(n),this.Sc=t.Tc(),this.ja=t.mc(),this.Dc=new mc(this.Sc,this.vr,this.persistence.Ec()),this.yc.Cc(this.Dc)}function lf(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.ja.Ta(t)})}function pf(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.ja.ba(e,r).next(function(t){return t?(n=t,Ta.resolve(n)):i.ja.da(e).next(function(t){return n=new Wi(r,t,0,e.Fa),i.ja.Aa(e,n).next(function(){return n})})})}).then(function(t){var e=i.Vc.get(t.targetId);return(null===e||0<t.et.L(e.et))&&(i.Vc=i.Vc.rt(t.targetId,t),i.bc.set(r,t.targetId)),t})}function df(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).Vc.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Co.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!La(r=t.sent()))throw r;return Dr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.Vc=e.Vc.remove(o),e.bc.delete(n.target),[2]}})})}function yf(t,o,s){var u=t,a=Oi.min(),c=ho();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=Cu(o),(void 0!==(t=(i=t).bc.get(r))?Ta.resolve(i.Vc.get(t)):i.ja.ba(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.ja.Na(e,t.targetId).next(function(t){c=t})}).next(function(){return u.yc.Or(e,o,s?a:Oi.min(),s?c:ho())}).next(function(t){return{documents:t,Nc:c}});var t,n,r,i})}function vf(t,e){var n=t,r=n.ja;return(t=n.Vc.get(e))?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.qe(t,e).next(function(t){return t?t.target:null})})}function gf(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Er.FAILED_PRECONDITION||e.message!==gc)throw e;return Dr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function mf(t,e){this.user=e,this.type="OAuth",this.jc={},this.jc.Authorization="Bearer "+t}function wf(t,e,n,r,i){var o=this;this.Wu=t,this.ju=e,this.os=n,this.Ku={},this.Gu=[],this.zu=new Map,this.Hu=new Set,this.Yu=[],this.Ju=i,this.Ju.Xu(function(t){n.ds(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Zf(this)?(Dr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Hu.add(4),[4,Wf(e)];case 1:return t.sent(),e.Zu.set("Unknown"),e.Hu.delete(4),[4,zf(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Zu=new kf(n,r)}var bf,If,Ef,_f=(Gf.prototype.m=function(){return this.$c.m()},Gf.prototype.Sa=function(t,e){e=new Tf(t,e),this.$c=this.$c.add(e),this.kc=this.kc.add(e)},Gf.prototype.Oc=function(t,e){var n=this;t.forEach(function(t){return n.Sa(t,e)})},Gf.prototype.Ca=function(t,e){this.Lc(new Tf(t,e))},Gf.prototype.Bc=function(t,e){var n=this;t.forEach(function(t){return n.Ca(t,e)})},Gf.prototype.qc=function(t){var e=this,n=new Br(new jr([])),r=new Tf(n,t),t=new Tf(n,t+1),i=[];return this.kc.Nt([r,t],function(t){e.Lc(t),i.push(t.key)}),i},Gf.prototype.Uc=function(){var e=this;this.$c.forEach(function(t){return e.Lc(t)})},Gf.prototype.Lc=function(t){this.$c=this.$c.delete(t),this.kc=this.kc.delete(t)},Gf.prototype.Qc=function(t){var e=new Br(new jr([])),n=new Tf(e,t),t=new Tf(e,t+1),r=ho();return this.kc.Nt([n,t],function(t){r=r.add(t.key)}),r},Gf.prototype.zo=function(t){var e=new Tf(t,0);return null!==(e=this.$c.$t(e))&&t.isEqual(e.key)},Gf),Tf=(Bf.xc=function(t,e){return Br.i(t.key,e.key)||di(t.Wc,e.Wc)},Bf.Mc=function(t,e){return di(t.Wc,e.Wc)||Br.i(t.key,e.key)},Bf),Nf=(qf.prototype.getToken=function(){return Promise.resolve(null)},qf.prototype.Gc=function(){},qf.prototype.zc=function(t){(this.Kc=t)(tc.UNAUTHENTICATED)},qf.prototype.Hc=function(){this.Kc=null},qf),Af=(Ff.prototype.getToken=function(){var e=this,n=this.Xc,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.Xc!==n?(Dr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Lr("string"==typeof t.accessToken),new mf(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Ff.prototype.Gc=function(){this.forceRefresh=!0},Ff.prototype.zc=function(t){this.Kc=t,this.Jc&&t(this.currentUser)},Ff.prototype.Hc=function(){this.auth&&this.auth.removeAuthTokenListener(this.Yc),this.Yc=null,this.Kc=null},Ff.prototype.Zc=function(){var t=this.auth&&this.auth.getUid();return Lr(null===t||"string"==typeof t),new tc(t)},Ff),Sf=(Object.defineProperty(jf.prototype,"jc",{get:function(){var t={"X-Goog-AuthUser":this.eu},e=this.tu.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),jf),Df=(Mf.prototype.getToken=function(){return Promise.resolve(new Sf(this.tu,this.eu))},Mf.prototype.zc=function(t){t(tc.ei)},Mf.prototype.Hc=function(){},Mf.prototype.Gc=function(){},Mf),be=(Uf.prototype.au=function(){return 1===this.state||2===this.state||4===this.state},Uf.prototype.cu=function(){return 2===this.state},Uf.prototype.start=function(){3!==this.state?this.auth():this.uu()},Uf.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.au()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Uf.prototype.hu=function(){this.state=0,this.gs.reset()},Uf.prototype.lu=function(){var t=this;this.cu()&&null===this.ou&&(this.ou=this._n.gn(this.nu,6e4,function(){return t._u()}))},Uf.prototype.fu=function(t){this.du(),this.stream.send(t)},Uf.prototype._u=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.cu()?[2,this.close(0)]:[2]})})},Uf.prototype.du=function(){this.ou&&(this.ou.cancel(),this.ou=null)},Uf.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.du(),this.gs.cancel(),this.ru++,3!==e?this.gs.reset():n&&n.code===Er.RESOURCE_EXHAUSTED?(Or(n.toString()),Or("Using maximum backoff delay to prevent overloading the backend."),this.gs.An()):n&&n.code===Er.UNAUTHENTICATED&&this.iu.Gc(),null!==this.stream&&(this.wu(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.mu(n)];case 1:return t.sent(),[2]}})})},Uf.prototype.wu=function(){},Uf.prototype.auth=function(){var n=this;this.state=1;var t=this.Tu(this.ru),e=this.ru;this.iu.getToken().then(function(t){n.ru===e&&n.Eu(t)},function(e){t(function(){var t=new _r(Er.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Iu(t)})})},Uf.prototype.Eu=function(t){var e=this,n=this.Tu(this.ru);this.stream=this.Au(t),this.stream.Ru(function(){n(function(){return e.state=2,e.listener.Ru()})}),this.stream.mu(function(t){n(function(){return e.Iu(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Uf.prototype.uu=function(){var t=this;this.state=4,this.gs.Rn(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},Uf.prototype.Iu=function(t){return Dr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Uf.prototype.Tu=function(e){var n=this;return function(t){n._n.ds(function(){return n.ru===e?t():(Dr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Uf),Of=(n(Cf,Ef=be),Cf.prototype.Au=function(t){return this.su.Pu("Listen",t)},Cf.prototype.onMessage=function(t){this.gs.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:kr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Ue?(Lr(void 0===o||"string"==typeof o),gi.fromBase64String(o||"")):(Lr(void 0===o||o instanceof Uint8Array),gi.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Er.UNKNOWN:Qi(s.code),new _r(o,s.message||"")),r=new bo(n,r,i,s||null)}else if("documentChange"in e){e.documentChange,(a=e.documentChange).document,a.document.name,a.document.updateTime;var i=as(t,a.document.name),u=is(a.document.updateTime),s=new lu({mapValue:{fields:a.document.fields}}),u=new Iu(i,u,s,{}),s=a.targetIds||[],a=a.removedTargetIds||[];r=new mo(s,a,u.key,u)}else if("documentDelete"in e){e.documentDelete,(a=e.documentDelete).document;var u=as(t,a.document),c=a.readTime?is(a.readTime):Oi.min(),c=new Eu(u,c),a=a.removedTargetIds||[];r=new mo([],a,c.key,c)}else if("documentRemove"in e){e.documentRemove,(c=e.documentRemove).document;var h=as(t,c.document),c=c.removedTargetIds||[];r=new mo([],c,h,null)}else{if(!("filter"in e))return kr();e.filter,(h=e.filter).targetId,e=new Gi(e=h.count||0),h=h.targetId,r=new wo(h,e)}return r}(this.serializer,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?Oi.min():is(e.readTime);return this.listener.gu(n,t)},Cf.prototype.yu=function(t){var e,n,r,i,o={};o.database=fs(this.serializer),o.addTarget=(e=this.serializer,(r=Bi(r=(n=t).target)?{documents:vs(e,r)}:{query:gs(e,r)}).targetId=n.targetId,0<n.resumeToken.O()&&(r.resumeToken=rs(e,n.resumeToken)),r),(t=(this.serializer,i=t,null==(t=function(){switch(i.tt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return kr()}}())?null:{"goog-listen-tags":t}))&&(o.labels=t),this.fu(o)},Cf.prototype.Vu=function(t){var e={};e.database=fs(this.serializer),e.removeTarget=t,this.fu(e)},Cf),xf=(n(Vf,If=be),Object.defineProperty(Vf.prototype,"bu",{get:function(){return this.pu},enumerable:!1,configurable:!0}),Vf.prototype.start=function(){this.pu=!1,this.lastStreamToken=void 0,If.prototype.start.call(this)},Vf.prototype.wu=function(){this.pu&&this.vu([])},Vf.prototype.Au=function(t){return this.su.Pu("Write",t)},Vf.prototype.onMessage=function(t){if(Lr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.pu){this.gs.reset();var e=(n=t.writeResults,i=t.commitTime,n&&0<n.length?(Lr(void 0!==i),n.map(function(t){return n=i,(r=(e=t).updateTime?is(e.updateTime):is(n)).isEqual(Oi.min())&&(r=is(n)),n=null,e.transformResults&&0<e.transformResults.length&&(n=e.transformResults),new zs(r,n);var e,n,r})):[]),n=is(t.commitTime);return this.listener.Su(n,e)}var i;return Lr(!t.writeResults||0===t.writeResults.length),this.pu=!0,this.listener.Du()},Vf.prototype.Cu=function(){var t={};t.database=fs(this.serializer),this.fu(t)},Vf.prototype.vu=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return ds(e.serializer,t)})};this.fu(t)},Vf),Rf=(n(Pf,bf=function(){}),Pf.prototype.Fu=function(){if(this.Nu)throw new _r(Er.FAILED_PRECONDITION,"The client has already been terminated.")},Pf.prototype.$u=function(e,n,r){var i=this;return this.Fu(),this.credentials.getToken().then(function(t){return i.su.$u(e,n,r,t)}).catch(function(t){throw t.code===Er.UNAUTHENTICATED&&i.credentials.Gc(),t})},Pf.prototype.xu=function(e,n,r){var i=this;return this.Fu(),this.credentials.getToken().then(function(t){return i.su.xu(e,n,r,t)}).catch(function(t){throw t.code===Er.UNAUTHENTICATED&&i.credentials.Gc(),t})},Pf.prototype.terminate=function(){this.Nu=!1},Pf),kf=(Lf.prototype.Lu=function(){var t=this;0===this.ku&&(this.Bu("Unknown"),this.Mu=this.os.gn("online_state_timeout",1e4,function(){return t.Mu=null,t.qu("Backend didn't respond within 10 seconds."),t.Bu("Offline"),Promise.resolve()}))},Lf.prototype.Uu=function(t){"Online"===this.state?this.Bu("Unknown"):(this.ku++,1<=this.ku&&(this.Qu(),this.qu("Connection failed 1 times. Most recent error: "+t.toString()),this.Bu("Offline")))},Lf.prototype.set=function(t){this.Qu(),this.ku=0,"Online"===t&&(this.Ou=!1),this.Bu(t)},Lf.prototype.Bu=function(t){t!==this.state&&(this.state=t,this.fi(t))},Lf.prototype.qu=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.Ou?(Or(t),this.Ou=!1):Dr("OnlineStateTracker",t)},Lf.prototype.Qu=function(){null!==this.Mu&&(this.Mu.cancel(),this.Mu=null)},Lf);function Lf(t,e){this.os=t,this.fi=e,this.state="Unknown",this.ku=0,this.Mu=null,this.Ou=!0}function Pf(t,e,n){var r=this;return(r=bf.call(this)||this).credentials=t,r.su=e,r.serializer=n,r.Nu=!1,r}function Vf(t,e,n,r,i){var o=this;return(o=If.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.pu=!1,o}function Cf(t,e,n,r,i){var o=this;return(o=Ef.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Uf(t,e,n,r,i,o){this._n=t,this.nu=n,this.su=r,this.iu=i,this.listener=o,this.state=0,this.ru=0,this.ou=null,this.stream=null,this.gs=new _a(t,e)}function Mf(t,e){this.tu=t,this.eu=e}function jf(t,e){this.tu=t,this.eu=e,this.type="FirstParty",this.user=tc.ei}function Ff(t){var e=this;this.Yc=null,this.currentUser=tc.UNAUTHENTICATED,this.Jc=!1,this.Xc=0,this.Kc=null,this.forceRefresh=!1,this.Yc=function(){e.Xc++,e.currentUser=e.Zc(),e.Jc=!0,e.Kc&&e.Kc(e.currentUser)},this.Xc=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Yc):(this.Yc(null),t.get().then(function(t){e.auth=t,e.Yc&&e.auth.addAuthTokenListener(e.Yc)},function(){}))}function qf(){this.Kc=null}function Bf(t,e){this.key=t,this.Wc=e}function Gf(){this.$c=new no(Tf.xc),this.kc=new no(Tf.Mc)}function zf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!Zf(r))return[3,4];e=0,n=r.Yu,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Wf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.Yu,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Kf(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Dr("RemoteStore","RemoteStore shutting down."),e.Hu.add(5),[4,Wf(e)];case 1:return t.sent(),e.Ju.Si(),e.Zu.set("Unknown"),[2]}})})}function Hf(t,e){t.zu.has(e.targetId)||(t.zu.set(e.targetId,e),Jf(t)?$f(t):ul(t).cu()&&Yf(t,e))}function Qf(t,e){var n=t,t=ul(n);n.zu.delete(e),t.cu()&&Xf(n,e),0===n.zu.size&&(t.cu()?t.lu():Zf(n)&&n.Zu.set("Unknown"))}function Yf(t,e){t.th.Ee(e.targetId),ul(t).yu(e)}function Xf(t,e){t.th.Ee(e),ul(t).Vu(e)}function $f(e){e.th=new Eo({Be:function(t){return e.Ku.Be(t)},qe:function(t){return e.zu.get(t)||null}}),ul(e).start(),e.Zu.Lu()}function Jf(t){return Zf(t)&&!ul(t).au()&&0<t.zu.size}function Zf(t){return 0===t.Hu.size}function tl(t){t.th=void 0}function el(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!La(r))throw r;return n.Hu.add(1),[4,Wf(n)];case 1:return t.sent(),n.Zu.set("Offline"),i=i||function(){return lf(n.Wu)},n.os.Ds(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Dr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Hu.delete(1),[4,zf(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function nl(e,n){return n().catch(function(t){return el(e,t,n)})}function rl(h){return y(this,void 0,void 0,function(){var s,u,a,c;return v(this,function(t){switch(t.label){case 0:u=al(s=h),a=0<s.Gu.length?s.Gu[s.Gu.length-1].batchId:-1,t.label=1;case 1:if(!(Zf(s)&&s.Gu.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(r=s.Wu,i=a,(o=r).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===i&&(i=-1),o.vr.Lo(t,i)}))];case 3:return null===(c=t.sent())?(0===s.Gu.length&&u.lu(),[3,7]):(a=c.batchId,n=c,(e=s).Gu.push(n),(e=al(e)).cu()&&e.bu&&e.vu(n.mutations),[3,6]);case 4:return c=t.sent(),[4,el(s,c)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return il(s)&&ol(s),[2]}var e,n,r,i,o})})}function il(t){return Zf(t)&&!al(t).au()&&0<t.Gu.length}function ol(t){al(t).start()}function sl(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Hu.delete(2),[4,zf(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Hu.add(2),[4,Wf(e)]);case 3:t.sent(),e.Zu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function ul(n){var t,e,r,i=this;return n.rh||(n.rh=(t=n.ju,e=n.os,r={Ru:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.zu.forEach(function(t,e){Yf(n,t)}),[2]})})}.bind(null,n),mu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return tl(e),Jf(e)?(e.Zu.Uu(n),$f(e)):e.Zu.set("Unknown"),[2]})})}.bind(null,n),gu:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Zu.set("Online"),!(u instanceof bo&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.zu.has(i)?[4,o.Ku.eh(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.zu.delete(i),o.th.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Dr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,el(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof mo?s.th.pe(u):u instanceof wo?s.th.$e(u):s.th.Se(u),a.isEqual(Oi.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,lf(s.Wu)];case 8:return o=t.sent(),0<=a.L(o)?[4,(i=a,(e=(r=s).th.Me(i)).Gt.forEach(function(t,e){var n;0<t.resumeToken.O()&&(n=r.zu.get(e))&&r.zu.set(e,n.st(t.resumeToken,i))}),e.zt.forEach(function(t){var e=r.zu.get(t);e&&(r.zu.set(t,e.st(gi.B,e.et)),Xf(r,t),e=new Wi(e.target,t,1,e.sequenceNumber),Yf(r,e))}),r.Ku.nh(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Dr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,el(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},t.Fu(),new Of(e,t.su,t.credentials,t.serializer,r)),n.Yu.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.rh.hu(),Jf(n)?$f(n):n.Zu.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.rh.stop()];case 2:t.sent(),tl(n),t.label=3;case 3:return[2]}})})})),n.rh}function al(n){var t,e,r,i=this;return n.oh||(n.oh=(t=n.ju,e=n.os,r={Ru:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return al(e).Cu(),[2]})})}.bind(null,n),mu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&al(e).bu?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Hi(n=i.code)&&n!==Er.ABORTED?(e=r.Gu.shift(),al(r).hu(),[4,nl(r,function(){return r.Ku.ih(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,rl(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return il(e)&&ol(e),[2]}})})}.bind(null,n),Du:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=al(o),n=0,r=o.Gu;n<r.length;n++)i=r[n],e.vu(i.mutations);return[2]})})}.bind(null,n),Su:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Gu.shift(),n=vc.from(e,i,o),[4,nl(r,function(){return r.Ku.sh(n)})];case 1:return t.sent(),[4,rl(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Fu(),new xf(e,t.su,t.credentials,t.serializer,r)),n.Yu.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.oh.hu(),[4,rl(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.oh.stop()];case 3:t.sent(),0<n.Gu.length&&(Dr("RemoteStore","Stopping write stream with "+n.Gu.length+" pending writes"),n.Gu=[]),t.label=4;case 4:return[2]}})})})),n.oh}var cl=function(t){this.key=t},hl=function(t){this.key=t},fl=(Object.defineProperty(vl.prototype,"fh",{get:function(){return this.ah},enumerable:!1,configurable:!0}),vl.prototype.dh=function(t,e){var s=this,u=e?e.wh:new po,a=(e||this)._h,c=(e||this).Qt,h=a,f=!1,l=xu(this.query)&&a.size===this.query.limit?a.last():null,p=Ru(this.query)&&a.size===this.query.limit?a.first():null;if(t.ut(function(t,e){var n=a.get(t),r=(r=e instanceof Iu?e:null)&&(Gu(s.query,r)?r:null),i=!!n&&s.Qt.has(n.key),o=!!r&&(r.Ye||s.Qt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.mh(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s.lh(r,l)||p&&s.lh(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),xu(this.query)||Ru(this.query))for(;h.size>this.query.limit;){var n=xu(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{_h:h,wh:u,Th:f,Qt:c}},vl.prototype.mh=function(t,e){return t.Ye&&e.hasCommittedMutations&&!e.Ye},vl.prototype.gr=function(t,e,n){var o=this,r=this._h;this._h=t._h,this.Qt=t.Qt;var i=t.wh.qt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.lh(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return kr()}}var r,i}),this.Eh(n);var s=e?this.Ih():[],e=(n=0===this.hh.size&&this.Zt?1:0)!==this.uh;return this.uh=n,0!==i.length||e?{snapshot:new yo(this.query,t._h,r,i,t.Qt,0==n,e,!1),Ah:s}:{Ah:s}},vl.prototype.Us=function(t){return this.Zt&&"Offline"===t?(this.Zt=!1,this.gr({_h:this._h,wh:new po,Qt:this.Qt,Th:!1},!1)):{Ah:[]}},vl.prototype.Rh=function(t){return!this.ah.has(t)&&!!this._h.has(t)&&!this._h.get(t).Ye},vl.prototype.Eh=function(t){var e=this;t&&(t.te.forEach(function(t){return e.ah=e.ah.add(t)}),t.ee.forEach(function(t){}),t.ne.forEach(function(t){return e.ah=e.ah.delete(t)}),this.Zt=t.Zt)},vl.prototype.Ih=function(){var e=this;if(!this.Zt)return[];var n=this.hh;this.hh=ho(),this._h.forEach(function(t){e.Rh(t.key)&&(e.hh=e.hh.add(t.key))});var r=[];return n.forEach(function(t){e.hh.has(t)||r.push(new hl(t))}),this.hh.forEach(function(t){n.has(t)||r.push(new cl(t))}),r},vl.prototype.Ph=function(t){return this.ah=t.Nc,this.hh=ho(),t=this.dh(t.documents),this.gr(t,!0)},vl.prototype.gh=function(){return yo.Kt(this.query,this._h,this.Qt,0===this.uh)},vl),ll=function(t,e,n){this.query=t,this.targetId=e,this.view=n},pl=function(t){this.key=t,this.yh=!1},dl=(Object.defineProperty(yl.prototype,"qh",{get:function(){return!0===this.Bh},enumerable:!1,configurable:!0}),yl);function yl(t,e,n,r,i,o){this.Wu=t,this.Vh=e,this.ph=n,this.bh=r,this.currentUser=i,this.Sh=o,this.Dh={},this.Ch=new Si(qu,Fu),this.Nh=new Map,this.Fh=[],this.$h=new Yi(Br.i),this.xh=new Map,this.kh=new _f,this.Mh={},this.Oh=new Map,this.Lh=zh.fa(),this.onlineState="Unknown",this.Bh=void 0}function vl(t,e){this.query=t,this.ah=e,this.uh=null,this.Zt=!1,this.hh=ho(),this.Qt=ho(),this.lh=zu(t),this._h=new lo(this.lh)}function gl(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Uh=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.dh(o)).Th?[4,yf(r.Wu,i.query,!1).then(function(t){return t=t.documents,i.view.dh(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.Gt.get(i.targetId),n=i.view.gr(e,r.qh,n),[2,(Tl(r,i.targetId,n.Ah),n.snapshot)]}})})}(i,t,e,n)},[4,yf(i.Wu,o,!0)];case 1:return n=t.sent(),r=new fl(o,n.Nc),e=r.dh(n.documents),n=go.Xt(s,u&&"Offline"!==i.onlineState),n=r.gr(e,i.qh,n),Tl(i,s,n.Ah),r=new ll(o,s,r),[2,(i.Ch.set(o,r),i.Nh.has(s)?i.Nh.get(s).push(o):i.Nh.set(s,[o]),n.snapshot)]}})})}function ml(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:n=i,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Wu,c=e,h=(a=o).et,f=c.Vc,c.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var i=c.Sc.ia({ra:!0});f=c.Vc;var u=[];a.Gt.forEach(function(t,e){var n,r,i,o=f.get(e);o&&(u.push(c.ja.Da(s,t.ne,e).next(function(){return c.ja.va(s,t.te,e)})),0<(i=t.resumeToken).O()&&(n=o.st(i,h).nt(s.Fa),f=f.rt(e,n),r=o,i=t,Lr(0<(o=n).resumeToken.O()),(0===r.resumeToken.O()||3e8<=o.et.J()-r.et.J()||0<i.te.size+i.ee.size+i.ne.size)&&u.push(c.ja.ga(s,n))))});var t,o=io,n=ho();return a.Ht.forEach(function(t,e){n=n.add(t)}),u.push(i.getEntries(s,n).next(function(r){a.Ht.forEach(function(t,e){var n=r.get(t);e instanceof Eu&&e.version.isEqual(Oi.min())?(i.Ir(t,h),o=o.rt(t,e)):null==n||0<e.version.L(n.version)||0===e.version.L(n.version)&&n.hasPendingWrites?(i.Tr(e,h),o=o.rt(t,e)):Dr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Yt.has(t)&&u.push(c.persistence.Co.gc(s,t))})})),h.isEqual(Oi.min())||(t=c.ja.Ta(s).next(function(t){return c.ja.Ia(s,s.Fa,h)}),u.push(t)),Ta.$n(u).next(function(){return i.apply(s)}).next(function(){return c.Dc.kr(s,o)})}).then(function(t){return c.Vc=f,t}))];case 2:return r=t.sent(),o.Gt.forEach(function(t,e){(e=n.xh.get(e))&&(Lr(t.te.size+t.ee.size+t.ne.size<=1),0<t.te.size?e.yh=!0:0<t.ee.size?Lr(e.yh):0<t.ne.size&&(Lr(e.yh),e.yh=!1))}),[4,Al(n,r,o)];case 3:return t.sent(),[3,6];case 4:return[4,gf(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,a,c,h,f})})}function wl(t,n,e){var r;((t=t).qh&&0===e||!t.qh&&1===e)&&(r=[],t.Ch.forEach(function(t,e){(e=e.view.Us(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.Ls.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Us(i)&&(o=!0)}),o&&Ja(t)}(t.ph,n),r.length&&t.Dh.gu(r),t.onlineState=n,t.qh&&t.bh.ji(n))}function bl(t,e){(t.Oh.get(e)||[]).forEach(function(t){t.resolve()}),t.Oh.delete(e)}function Il(t,e,n){var r=t,i=r.Mh[r.currentUser.Zs()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.Mh[r.currentUser.Zs()]=i)}function El(e,t,n){void 0===n&&(n=null),e.bh.Li(t);for(var r=0,i=e.Nh.get(t);r<i.length;r++){var o=i[r];e.Ch.delete(o),n&&e.Dh.Qh(o,n)}e.Nh.delete(t),e.qh&&e.kh.qc(t).forEach(function(t){e.kh.zo(t)||_l(e,t)})}function _l(t,e){var n=t.$h.get(e);null!==n&&(Qf(t.Vh,n),t.$h=t.$h.remove(e),t.xh.delete(n),Nl(t))}function Tl(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof cl?(t.kh.Sa(u.key,e),r=t,i=(i=u).key,r.$h.get(i)||(Dr("SyncEngine","New document in limbo: "+i),r.Fh.push(i),Nl(r))):u instanceof hl?(Dr("SyncEngine","Document no longer in limbo: "+u.key),t.kh.Ca(u.key,e),t.kh.zo(u.key)||_l(t,u.key)):kr()}}function Nl(t){for(;0<t.Fh.length&&t.$h.size<t.Sh;){var e=t.Fh.shift(),n=t.Lh.next();t.xh.set(n,new pl(e)),t.$h=t.$h.rt(e,n),Hf(t.Vh,new Wi(Cu(Ou(e.path)),n,2,rc.oi))}}function Al(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Ch.m()?[3,3]:(n.Ch.forEach(function(t,e){o.push(n.Uh(e,s,u).then(function(t){t&&(n.qh&&n.bh.Ui(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=wc.Gr(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.Dh.gu(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Ta.forEach(c,function(e){return Ta.forEach(e.jr,function(t){return r.persistence.Co.Sa(n,e.targetId,t)}).next(function(){return Ta.forEach(e.Kr,function(t){return r.persistence.Co.Ca(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!La(e=t.sent()))throw e;return Dr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.Vc.get(o),u=s.et,u=s.it(u),r.Vc=r.Vc.rt(o,u));return[2]}})})}(n.Wu,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function Sl(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.Nh.get(s))&&0!==a.length?[4,pf(e.Wu,Cu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],f=e.Ch.get(f),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,yf((e=r).Wu,i.query,!0)];case 1:return n=t.sent(),n=i.view.Ph(n),[2,(e.qh&&Tl(e,i.targetId,n.Ah),n)]}})})}(e,f)]):[3,6];case 4:(f=t.sent()).snapshot&&r.push(f.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,vf(e.Wu,s)];case 8:return l=t.sent(),[4,pf(e.Wu,l)];case 9:return u=t.sent(),[4,gl(e,Dl(l),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.Dh.gu(r),n)]}})})}function Dl(t){return Du(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Ol(t){return t.Vh.Ku.nh=ml.bind(null,t),t.Vh.Ku.Be=function(t,e){var n=t;if((t=n.xh.get(e))&&t.yh)return ho().add(t.key);var r=ho();if(!(e=n.Nh.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Ch.get(s),r=r.xt(s.view.fh);return r}.bind(null,t),t.Vh.Ku.eh=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).bh.Ui(s,"rejected",u),i=e.xh.get(s),(n=i&&i.key)?(r=(r=new Yi(Br.i)).rt(n,new Eu(n,Oi.min())),i=ho().add(n),i=new vo(Oi.min(),new Map,new no(di),r,i),[4,ml(e,i)]):[3,2];case 1:return t.sent(),e.$h=e.$h.remove(n),e.xh.delete(s),Nl(e),[3,4];case 2:return[4,df(e.Wu,s,!1).then(function(){return El(e,s,u)}).catch(gf)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.Dh.gu=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.Ls.get(u)){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Qs(s)&&(r=!0);u.Os=s}}r&&Ja(n)}.bind(null,t.ph),t.Dh.Qh=function(t,e,n){var r=t;if(t=r.Ls.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.Ls.delete(e)}.bind(null,t.ph),t}function xl(t){return t.Vh.Ku.sh=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Wu,h=s,(f=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=h.batch.keys(),n=f.Sc.ia({ra:!0}),i=f,o=t,s=n,u=(r=h).batch,a=u.keys(),c=Ta.resolve();return a.forEach(function(n){c=c.next(function(){return s.Ar(o,n)}).next(function(t){var e=t;Lr(null!==(t=r._r.get(n))),(!e||e.version.L(t)<0)&&(e=u.ar(n,e,r))&&s.Tr(e,r.lr)})}),c.next(function(){return i.vr.Qo(o,u)}).next(function(){return n.apply(t)}).next(function(){return f.vr.Go(t)}).next(function(){return f.Dc.$r(t,e)})}))];case 2:return i=t.sent(),Il(n,r,null),bl(n,r),n.bh.xi(r,"acknowledged"),[4,Al(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,gf(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,h,f})})}.bind(null,t),t.Vh.Ku.ih=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Wu,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.vr.Mo(e,r).next(function(t){return Lr(null!==t),n=t.keys(),i.vr.Qo(e,t)}).next(function(){return i.vr.Go(e)}).next(function(){return i.Dc.$r(e,n)})}))];case 2:return o=t.sent(),Il(n,u,a),bl(n,u),n.bh.xi(u,"rejected",a),[4,Al(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,gf(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,t),t}var Rl,kl,Ll,Pl=(op.prototype.Cc=function(t){this.Gh=t},op.prototype.Or=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.rn.length||1===r.rn.length&&r.rn[0].field.p())||i.isEqual(Oi.min())?this.zh(e,r):this.Gh.$r(e,o).next(function(t){var n=s.Hh(r,t);return(xu(r)||Ru(r))&&s.Th(r.on,n,o,i)?s.zh(e,r):(Sr()<=l.DEBUG&&Dr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Bu(r)),s.Gh.Or(e,r,i).next(function(e){return n.forEach(function(t){e=e.rt(t.key,t)}),e}))})},op.prototype.Hh=function(n,t){var r=new no(zu(n));return t.forEach(function(t,e){e instanceof Iu&&Gu(n,e)&&(r=r.add(e))}),r},op.prototype.Th=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.L(r))},op.prototype.zh=function(t,e){return Sr()<=l.DEBUG&&Dr("IndexFreeQueryEngine","Using full collection scan to execute query:",Bu(e)),this.Gh.Or(t,e,Oi.min())},op),Vl=(ip.prototype.$o=function(t){return Ta.resolve(0===this.vr.length)},ip.prototype.xo=function(t,e,n,r){var i=this.Yh;this.Yh++,0<this.vr.length&&this.vr[this.vr.length-1],n=new yc(i,e,n,r),this.vr.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Jh=this.Jh.add(new Tf(u.key,i)),this.Sr.ko(t,u.key.path.h())}return Ta.resolve(n)},ip.prototype.Mo=function(t,e){return Ta.resolve(this.Xh(e))},ip.prototype.Lo=function(t,e){return e+=1,e=(e=this.Zh(e))<0?0:e,Ta.resolve(this.vr.length>e?this.vr[e]:null)},ip.prototype.Bo=function(){return Ta.resolve(0===this.vr.length?-1:this.Yh-1)},ip.prototype.qo=function(t){return Ta.resolve(this.vr.slice())},ip.prototype.Cr=function(t,e){var n=this,r=new Tf(e,0),e=new Tf(e,Number.POSITIVE_INFINITY),i=[];return this.Jh.Nt([r,e],function(t){t=n.Xh(t.Wc),i.push(t)}),Ta.resolve(i)},ip.prototype.Mr=function(t,e){var n=this,r=new no(di);return e.forEach(function(t){var e=new Tf(t,0),t=new Tf(t,Number.POSITIVE_INFINITY);n.Jh.Nt([e,t],function(t){r=r.add(t.Wc)})}),Ta.resolve(this.tl(r))},ip.prototype.Qr=function(t,e){var n=e.path,r=n.length+1,e=n;Br.F(e)||(e=e.child(""));var e=new Tf(new Br(e),0),i=new no(di);return this.Jh.Ft(function(t){var e=t.key.path;return!!n.T(e)&&(e.length===r&&(i=i.add(t.Wc)),!0)},e),Ta.resolve(this.tl(i))},ip.prototype.tl=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.Xh(t))&&n.push(t)}),n},ip.prototype.Qo=function(n,r){var i=this;Lr(0===this.el(r.batchId,"removed")),this.vr.shift();var o=this.Jh;return Ta.forEach(r.mutations,function(t){var e=new Tf(t.key,r.batchId);return o=o.delete(e),i.Co.Ko(n,t.key)}).next(function(){i.Jh=o})},ip.prototype.jo=function(t){},ip.prototype.zo=function(t,e){var n=new Tf(e,0),n=this.Jh.$t(n);return Ta.resolve(e.isEqual(n&&n.key))},ip.prototype.Go=function(t){return this.vr.length,Ta.resolve()},ip.prototype.el=function(t,e){return this.Zh(t)},ip.prototype.Zh=function(t){return 0===this.vr.length?0:t-this.vr[0].batchId},ip.prototype.Xh=function(t){return(t=this.Zh(t))<0||t>=this.vr.length?null:this.vr[t]},ip),Cl=(rp.prototype.Tr=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.nl(e);return this.docs=this.docs.rt(r,{Zo:e,size:o,readTime:n}),this.size+=o-i,this.Sr.ko(t,r.path.h())},rp.prototype.Ir=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},rp.prototype.Ar=function(t,e){return e=this.docs.get(e),Ta.resolve(e?e.Zo:null)},rp.prototype.getEntries=function(t,e){var n=this,r=io;return e.forEach(function(t){var e=n.docs.get(t);r=r.rt(t,e?e.Zo:null)}),Ta.resolve(r)},rp.prototype.Or=function(t,e,n){for(var r=uo,i=new Br(e.path.child("")),o=this.docs._t(i);o.It();){var s=(u=o.Et()).key,u=(a=u.value).Zo,a=a.readTime;if(!e.path.T(s.path))break;a.L(n)<=0||u instanceof Iu&&Gu(e,u)&&(r=r.rt(u.key,u))}return Ta.resolve(r)},rp.prototype.sl=function(t,e){return Ta.forEach(this.docs,function(t){return e(t)})},rp.prototype.ia=function(t){return new Ul(this)},rp.prototype.oa=function(t){return Ta.resolve(this.size)},rp),Ul=(n(np,Ll=h),np.prototype.gr=function(n){var r=this,i=[];return this.dr.forEach(function(t,e){e?i.push(r.aa.Tr(n,e,r.readTime)):r.aa.Ir(t)}),Ta.$n(i)},np.prototype.Rr=function(t,e){return this.aa.Ar(t,e)},np.prototype.Pr=function(t,e){return this.aa.getEntries(t,e)},np),Ml=(ep.prototype.De=function(t,n){return this.il.forEach(function(t,e){return n(e)}),Ta.resolve()},ep.prototype.Ta=function(t){return Ta.resolve(this.lastRemoteSnapshotVersion)},ep.prototype.Ea=function(t){return Ta.resolve(this.rl)},ep.prototype.da=function(t){return this.highestTargetId=this.al.next(),Ta.resolve(this.highestTargetId)},ep.prototype.Ia=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.rl&&(this.rl=e),Ta.resolve()},ep.prototype.Ra=function(t){this.il.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.al=new zh(e),this.highestTargetId=e),t.sequenceNumber>this.rl&&(this.rl=t.sequenceNumber)},ep.prototype.Aa=function(t,e){return this.Ra(e),this.targetCount+=1,Ta.resolve()},ep.prototype.ga=function(t,e){return this.Ra(e),Ta.resolve()},ep.prototype.ya=function(t,e){return this.il.delete(e.target),this.ol.qc(e.targetId),--this.targetCount,Ta.resolve()},ep.prototype.Vo=function(n,r,i){var o=this,s=0,u=[];return this.il.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.il.delete(t),u.push(o.Va(n,e.targetId)),s++)}),Ta.$n(u).next(function(){return s})},ep.prototype.pa=function(t){return Ta.resolve(this.targetCount)},ep.prototype.ba=function(t,e){return e=this.il.get(e)||null,Ta.resolve(e)},ep.prototype.va=function(t,e,n){return this.ol.Oc(e,n),Ta.resolve()},ep.prototype.Da=function(e,t,n){this.ol.Bc(t,n);var r=this.persistence.Co,i=[];return r&&t.forEach(function(t){i.push(r.Ko(e,t))}),Ta.$n(i)},ep.prototype.Va=function(t,e){return this.ol.qc(e),Ta.resolve()},ep.prototype.Na=function(t,e){return e=this.ol.Qc(e),Ta.resolve(e)},ep.prototype.zo=function(t,e){return Ta.resolve(this.ol.zo(e))},ep),jl=(tp.prototype.start=function(){return Promise.resolve()},tp.prototype.Si=function(){return this.Ma=!1,Promise.resolve()},Object.defineProperty(tp.prototype,"Ti",{get:function(){return this.Ma},enumerable:!1,configurable:!0}),tp.prototype.Xa=function(){},tp.prototype.Za=function(){},tp.prototype.Ec=function(){return this.Sr},tp.prototype.wc=function(t){var e=this.cl[t.Zs()];return e||(e=new Vl(this.Sr,this.Co),this.cl[t.Zs()]=e),e},tp.prototype.mc=function(){return this.ja},tp.prototype.Tc=function(){return this.br},tp.prototype.runTransaction=function(t,e,n){var r=this;Dr("MemoryPersistence","Starting transaction:",t);var i=new Fl(this.ka.next());return this.Co.hl(),n(i).next(function(t){return r.Co.ll(i).next(function(){return t})}).Nn().then(function(t){return i.pr(),t})},tp.prototype._l=function(e,n){return Ta.xn(Object.values(this.cl).map(function(t){return function(){return t.zo(e,n)}}))},tp),Fl=(n(Zl,kl=Ie),Zl),ql=(Jl.wl=function(t){return new Jl(t)},Object.defineProperty(Jl.prototype,"ml",{get:function(){if(this.dl)return this.dl;throw kr()},enumerable:!1,configurable:!0}),Jl.prototype.Sa=function(t,e,n){return this.fl.Sa(n,e),this.ml.delete(n.toString()),Ta.resolve()},Jl.prototype.Ca=function(t,e,n){return this.fl.Ca(n,e),this.ml.add(n.toString()),Ta.resolve()},Jl.prototype.Ko=function(t,e){return this.ml.add(e.toString()),Ta.resolve()},Jl.prototype.removeTarget=function(t,e){var n=this;this.fl.qc(e.targetId).forEach(function(t){return n.ml.add(t.toString())});var r=this.persistence.mc();return r.Na(t,e.targetId).next(function(t){t.forEach(function(t){return n.ml.add(t.toString())})}).next(function(){return r.ya(t,e)})},Jl.prototype.hl=function(){this.dl=new Set},Jl.prototype.ll=function(n){var r=this,i=this.persistence.Tc().ia();return Ta.forEach(this.ml,function(t){var e=Br.D(t);return r.Tl(n,e).next(function(t){t||i.Ir(e)})}).next(function(){return r.dl=null,i.apply(n)})},Jl.prototype.gc=function(t,e){var n=this;return this.Tl(t,e).next(function(t){t?n.ml.delete(e.toString()):n.ml.add(e.toString())})},Jl.prototype.ul=function(t){return 0},Jl.prototype.Tl=function(t,e){var n=this;return Ta.xn([function(){return Ta.resolve(n.fl.zo(e))},function(){return n.persistence.mc().zo(t,e)},function(){return n.persistence._l(t,e)}])},Jl),Bl=($l.prototype.Ru=function(t){this.Al=t},$l.prototype.mu=function(t){this.Rl=t},$l.prototype.onMessage=function(t){this.Pl=t},$l.prototype.close=function(){this.Il()},$l.prototype.send=function(t){this.El(t)},$l.prototype.gl=function(){this.Al()},$l.prototype.yl=function(t){this.Rl(t)},$l.prototype.Vl=function(t){this.Pl(t)},$l),Gl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},zl=(Xl.prototype.$u=function(e,t,n,r){var i=this.Sl(e,t);return Dr("RestConnection","Sending: ",i,n),t={},this.Dl(t,r),this.Cl(e,i,t,n).then(function(t){return Dr("RestConnection","Received: ",t),t},function(t){throw xr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Xl.prototype.xu=function(t,e,n,r){return this.$u(t,e,n,r)},Xl.prototype.Dl=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.23.0-202096215419",t["Content-Type"]="text/plain",e)for(var n in e.jc)e.jc.hasOwnProperty(n)&&(t[n]=e.jc[n])},Xl.prototype.Sl=function(t,e){return t=Gl[t],this.bl+"/v1/"+e+":"+t},n(Yl,Rl=Xl),Yl.prototype.Cl=function(o,e,s,u){return new Promise(function(n,r){var i=new mr;i.listenOnce(vr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case yr.NO_ERROR:var t=i.getResponseJson();Dr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case yr.TIMEOUT:Dr("Connection",'RPC "'+o+'" timed out'),r(new _r(Er.DEADLINE_EXCEEDED,"Request time out"));break;case yr.HTTP_ERROR:var e=i.getStatus();Dr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Er).indexOf(e)?e:Er.UNKNOWN,r(new _r(e,t.message))):r(new _r(Er.UNKNOWN,"Server responded with status "+i.getStatus())):r(new _r(Er.UNAVAILABLE,"Connection failed."));break;default:kr()}}finally{Dr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Yl.prototype.Pu=function(t,e){var n,r=[this.bl,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=dr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.U.projectId+"/databases/"+this.U.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.Dl(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),Dr("Connection","Creating WebChannel: "+(r=r.join("")),t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new Bl({El:function(t){u?Dr("Connection","Not sending because WebChannel is closed:",t):(s||(Dr("Connection","Opening WebChannel transport."),o.open(),s=!0),Dr("Connection","WebChannel sending:",t),o.send(t))},Il:function(){return o.close()}});return(t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})})(gr.EventType.OPEN,function(){u||Dr("Connection","WebChannel transport opened.")}),t(gr.EventType.CLOSE,function(){u||(u=!0,Dr("Connection","WebChannel transport closed"),a.yl())}),t(gr.EventType.ERROR,function(t){u||(u=!0,xr("Connection","WebChannel transport errored:",t),a.yl(new _r(Er.UNAVAILABLE,"The operation could not be completed")))}),t(gr.EventType.MESSAGE,function(t){var e,n,r,i;u||(Lr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Dr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=zi[r];if(void 0!==t)return Qi(t)}(),i=n.message,void 0===t&&(t=Er.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.yl(new _r(t,i)),o.close()):(Dr("Connection","WebChannel received:",e),a.Vl(e)))}),setTimeout(function(){a.gl()},0),a},Yl),Wl=(Ql.prototype.Xu=function(t){this.kl.push(t)},Ql.prototype.Si=function(){window.removeEventListener("online",this.Nl),window.removeEventListener("offline",this.$l)},Ql.prototype.Ml=function(){window.addEventListener("online",this.Nl),window.addEventListener("offline",this.$l)},Ql.prototype.Fl=function(){Dr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.kl;t<e.length;t++)(0,e[t])(0)},Ql.prototype.xl=function(){Dr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.kl;t<e.length;t++)(0,e[t])(1)},Ql.On=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Ql),Kl=(Hl.prototype.Xu=function(t){},Hl.prototype.Si=function(){},Hl);function Hl(){}function Ql(){var t=this;this.Nl=function(){return t.Fl()},this.$l=function(){return t.xl()},this.kl=[],this.Ml()}function Yl(t){var e=this;return(e=Rl.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function Xl(t){this.pl=t,this.U=t.U;var e=t.ssl?"https":"http";this.bl=e+"://"+t.host,this.vl="projects/"+this.U.projectId+"/databases/"+this.U.database+"/documents"}function $l(t){this.El=t.El,this.Il=t.Il}function Jl(t){this.persistence=t,this.fl=new _f,this.dl=null}function Zl(t){var e=this;return(e=kl.call(this)||this).Fa=t,e}function tp(t){var e=this;this.cl={},this.ka=new rc(0),this.Ma=!1,this.Ma=!0,this.Co=t(this),this.ja=new Ml(this),this.Sr=new mh,this.br=(t=this.Sr,new Cl(t,function(t){return e.Co.ul(t)}))}function ep(t){this.persistence=t,this.il=new Si(Fi,qi),this.lastRemoteSnapshotVersion=Oi.min(),this.highestTargetId=0,this.rl=0,this.ol=new _f,this.targetCount=0,this.al=zh._a()}function np(t){var e=this;return(e=Ll.call(this)||this).aa=t,e}function rp(t,e){this.Sr=t,this.nl=e,this.docs=new Yi(Br.i),this.size=0}function ip(t,e){this.Sr=t,this.Co=e,this.vr=[],this.Yh=1,this.Jh=new no(Tf.xc)}function op(){}function sp(t){return new Jo(t,!0)}var up,ap,cp,hp,fp="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",lp=(Sp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.bh=this.Ol(e),this.persistence=this.Ll(e),[4,this.persistence.start()];case 1:return t.sent(),this.Bl=this.ql(e),this.Wu=this.Ul(e),[2]}})})},Sp.prototype.ql=function(t){return null},Sp.prototype.Ul=function(t){return e=this.persistence,n=new Pl,t=t.Ql,new hf(e,n,t);var e,n},Sp.prototype.Ll=function(t){if(t.persistenceSettings.Wl)throw new _r(Er.FAILED_PRECONDITION,fp);return new jl(ql.wl)},Sp.prototype.Ol=function(t){return new dc},Sp.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Bl&&this.Bl.stop(),[4,this.bh.Si()];case 1:return t.sent(),[4,this.persistence.Si()];case 2:return t.sent(),[2]}})})},Sp.prototype.clearPersistence=function(t,e){throw new _r(Er.FAILED_PRECONDITION,fp)},Sp),pp=(n(Ap,hp=lp),Ap.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,hp.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=yh(t),r=Oi.min(),t.ss({index:kh.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=Xc(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.vc=t})]})})}(this.Wu)];case 2:return t.sent(),[4,this.jl.initialize(this,e)];case 3:return t.sent(),[4,xl(this.jl._i)];case 4:return t.sent(),[4,rl(this.jl.Vh)];case 5:return t.sent(),[2]}})})},Ap.prototype.ql=function(t){var e=this.persistence.Co.do;return new jc(e,t.os)},Ap.prototype.Ll=function(t){var e=cf(t.pl.U,t.pl.persistenceKey),n=sp(t.pl.U);return new tf(t.persistenceSettings.synchronizeTabs,e,t.clientId,Cc.oo(t.persistenceSettings.cacheSizeBytes),t.os,qa(),Ba(),n,this.bh,t.persistenceSettings.xa)},Ap.prototype.Ol=function(t){return new dc},Ap.prototype.clearPersistence=function(t,e){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return Na.On()?(e=n+"main",[4,Na.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(cf(t,e))},n(Np,cp=Ap),Np.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,cp.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.jl._i,this.bh instanceof pc?(this.bh._i={tr:function(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).Wu,n=a,i=(r=e).vr,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Oo(e,n).next(function(t){return t?r.Dc.$r(e,t):Ta.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,rl(o.Vh)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(Il(o,a,h||null),bl(o,a),o.Wu.vr.jo(a)):kr(),t.label=4;case 4:return[4,Al(o,s)];case 5:return t.sent(),[3,7];case 6:Dr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}.bind(null,e),er:function(o,u,a,c){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:return(n=o).Bh?(Dr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!n.Nh.has(u))return[3,8];switch(a){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,(e=n.Wu,(s=e).persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.Sc,n=t,t=s.vc,r=e,i=io,o=Yc(t),t=yh(n),n=IDBKeyRange.lowerBound(o,!0),t.ss({index:kh.readTimeIndex,range:n},function(t,e){var n=Hc(r.serializer,e);i=i.rt(n.key,n),o=e.readTime}).next(function(){return{Fc:i,readTime:Xc(o)}});var e,n,r,i,o}).then(function(t){var e=t.Fc,t=t.readTime;return s.vc=t,e}))];case 3:return r=t.sent(),i=vo.Jt(u,"current"===a),[4,Al(n,r,i)];case 4:return t.sent(),[3,8];case 5:return[4,df(n.Wu,u,!0)];case 6:return t.sent(),El(n,u,c),[3,8];case 7:kr(),t.label=8;case 8:return[2]}var e,s})})}.bind(null,e),nr:function(c,h,f){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=Ol(c)).Bh)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.Nh.has(r)?(Dr("SyncEngine","Adding an already active target "+r),[3,5]):[4,vf(n.Wu,r)]):[3,6];case 2:return i=t.sent(),[4,pf(n.Wu,i)];case 3:return o=t.sent(),[4,gl(n,Dl(i),o.targetId,!1)];case 4:t.sent(),Hf(n.Vh,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.Nh.has(e)?[4,df(n.Wu,e,!1).then(function(){Qf(n.Vh,e),El(n,e)}).catch(gf)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=f,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),Vi:function(t){return t.Wu.persistence.Vi()}.bind(null,e)},[4,this.bh.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.Ja(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,function(h,f){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return Ol(r=h),xl(r),!0!==f||!0===r.Bh?[3,3]:(e=r.bh.Di(),[4,Sl(r,e.A())]);case 1:return i=t.sent(),r.Bh=!0,[4,sl(r.Vh,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],Hf(r.Vh,u);return[3,7];case 3:return!1!==f||!1===r.Bh?[3,7]:(a=[],c=Promise.resolve(),r.Nh.forEach(function(t,e){r.bh.Bi(e)?a.push(e):c=c.then(function(){return El(r,e),df(r.Wu,e,!0)}),Qf(r.Vh,e)}),[4,c]);case 4:return t.sent(),[4,Sl(r,a)];case 5:return t.sent(),(n=r).xh.forEach(function(t,e){Qf(n.Vh,e)}),n.kh.Uc(),n.xh=new Map,n.$h=new Yi(Br.i),r.Bh=!1,[4,sl(r.Vh,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}(this.jl._i,e)];case 1:return t.sent(),this.Bl&&(e&&!this.Bl.Ti?this.Bl.start(this.Wu):e||this.Bl.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},Np.prototype.Ol=function(t){if(t.persistenceSettings.Wl&&t.persistenceSettings.synchronizeTabs){var e=qa();if(!pc.On(e))throw new _r(Er.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=cf(t.pl.U,t.pl.persistenceKey);return new pc(e,t.os,n,t.clientId,t.Ql)}return new dc},Np),dp=(Tp.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Wu?[3,2]:(this.Wu=n.Wu,this.bh=n.bh,this.ju=this.Kl(r),this.Vh=this.Gl(r),this.ph=this.zl(r),this._i=this.Hl(r),this.bh.fi=function(t){return wl(e._i,t,1)},this.Vh.Ku.Yl=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Dr("SyncEngine","User change. New user:",o.Zs()),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).vr,m=e.Dc,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.vr.qo(v).next(function(t){return g=t,n=e.persistence.wc(o),m=new mc(e.Sc,n,e.persistence.Ec()),n.qo(v)}).next(function(t){for(var e=[],n=[],r=ho(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.$r(v,r).next(function(t){return{Wh:t,jh:e,Kh:n}})})})];case 1:return r=t.sent(),[2,(e.vr=n,e.Dc=m,e.yc.Cc(e.Dc),r)]}})})}(n.Wu,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Oh.forEach(function(t){t.forEach(function(t){t.reject(new _r(Er.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Oh.clear(),n.bh.Wi(o,r.jh,r.Kh),[4,Al(n,r.Wh)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this._i),[4,sl(this.Vh,this._i.qh)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Tp.prototype.zl=function(t){return new Ya},Tp.prototype.Kl=function(t){var e=sp(t.pl.U),n=(n=t.pl,new zl(n));return t=t.credentials,new Rf(t,n,e)},Tp.prototype.Gl=function(t){var e=this;return new wf(this.Wu,this.ju,t.os,function(t){return wl(e._i,t,0)},t=new(Wl.On()?Wl:Kl))},Tp.prototype.Hl=function(t){return e=this.Wu,n=this.Vh,r=this.ph,i=this.bh,o=t.Ql,s=t.Sh,u=!t.persistenceSettings.Wl||!t.persistenceSettings.synchronizeTabs,s=new dl(e,n,r,i,o,s),u&&(s.Bh=!0),s;var e,n,r,i,o,s,u},Tp.prototype.terminate=function(){return Kf(this.Vh)},Tp),yp=(_p.prototype.next=function(t){this.observer.next&&this.Jl(this.observer.next,t)},_p.prototype.error=function(t){this.observer.error?this.Jl(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},_p.prototype.Xl=function(){this.muted=!0},_p.prototype.Jl=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},_p),vp=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new _r(Er.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if($r("FieldPath","string",e,t[e]),0===t[e].length)throw new _r(Er.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Zl=new qr(t)},gp=(n(Ep,ap=vp),Ep.documentId=function(){return new Ep(qr.v().R())},Ep.prototype.isEqual=function(t){if(!(t instanceof Ep))throw ai("isEqual","FieldPath",1,t);return this.Zl.isEqual(t.Zl)},Ep),mp=new RegExp("[~\\*/\\[\\]]"),wp=function(t){this.t_=t},bp=(n(Ip,up=wp),Ip.prototype.e_=function(t){if(2!==t.n_)throw 1===t.n_?t.s_(this.t_+"() can only appear at the top level of your update data"):t.s_(this.t_+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},Ip.prototype.isEqual=function(t){return t instanceof Ip},Ip);function Ip(){return null!==up&&up.apply(this,arguments)||this}function Ep(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ap.call(this,t)||this}function _p(t){this.observer=t,this.muted=!1}function Tp(){}function Np(){return null!==cp&&cp.apply(this,arguments)||this}function Ap(t){var e=this;return(e=hp.call(this)||this).jl=t,e}function Sp(){}function Dp(t,e,n){return new $p({n_:3,i_:e.settings.i_,methodName:t.t_,r_:n},e.U,e.serializer,e.ignoreUndefinedProperties)}var Op,xp,Rp,kp,Lp=(n(Yp,kp=wp),Yp.prototype.e_=function(t){return new Bs(t.path,new Ss)},Yp.prototype.isEqual=function(t){return t instanceof Yp},Yp),Pp=(n(Qp,Rp=wp),Qp.prototype.e_=function(t){var e=Dp(this,t,!0),n=this.o_.map(function(t){return od(t,e)}),n=new Ds(n);return new Bs(t.path,n)},Qp.prototype.isEqual=function(t){return this===t},Qp),Vp=(n(Hp,xp=wp),Hp.prototype.e_=function(t){var e=Dp(this,t,!0),n=this.o_.map(function(t){return od(t,e)}),n=new Ls(n);return new Bs(t.path,n)},Hp.prototype.isEqual=function(t){return this===t},Hp),Cp=(n(Kp,Op=wp),Kp.prototype.e_=function(t){var e=new Us(t.serializer,es(t.serializer,this.a_));return new Bs(t.path,e)},Kp.prototype.isEqual=function(t){return this===t},Kp),Up=(Object.defineProperty(Wp.prototype,"latitude",{get:function(){return this.c_},enumerable:!1,configurable:!0}),Object.defineProperty(Wp.prototype,"longitude",{get:function(){return this.u_},enumerable:!1,configurable:!0}),Wp.prototype.isEqual=function(t){return this.c_===t.c_&&this.u_===t.u_},Wp.prototype.toJSON=function(){return{latitude:this.c_,longitude:this.u_}},Wp.prototype.H=function(t){return di(this.c_,t.c_)||di(this.u_,t.u_)},Wp),Mp=function(t){this.h_=t},jp=/^__.*__$/,Fp=function(t,e,n){this.l_=t,this.__=e,this.f_=n},qp=(zp.prototype.d_=function(t,e){var n=[];return null!==this.Qe?n.push(new tu(t,this.data,this.Qe,e)):n.push(new Zs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new ou(t,this.fieldTransforms)),n},zp),Bp=(Gp.prototype.d_=function(t,e){return e=[new tu(t,this.data,this.Qe,e)],0<this.fieldTransforms.length&&e.push(new ou(t,this.fieldTransforms)),e},Gp);function Gp(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function zp(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function Wp(t,e){if(Qr("GeoPoint",arguments,2),$r("GeoPoint","number",1,t),$r("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new _r(Er.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new _r(Er.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.c_=t,this.u_=e}function Kp(t,e){var n=this;return(n=Op.call(this,t)||this).a_=e,n}function Hp(t,e){var n=this;return(n=xp.call(this,t)||this).o_=e,n}function Qp(t,e){var n=this;return(n=Rp.call(this,t)||this).o_=e,n}function Yp(){return null!==kp&&kp.apply(this,arguments)||this}function Xp(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw kr()}}var $p=(Object.defineProperty(td.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(td.prototype,"n_",{get:function(){return this.settings.n_},enumerable:!1,configurable:!0}),td.prototype.m_=function(t){return new td(Object.assign(Object.assign({},this.settings),t),this.U,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},td.prototype.T_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.m_({path:e,r_:!1})).E_(t),e},td.prototype.I_=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.m_({path:t,r_:!1})).w_(),t},td.prototype.A_=function(t){return this.m_({path:void 0,r_:!0})},td.prototype.s_=function(t){return fd(t,this.settings.methodName,this.settings.R_||!1,this.path,this.settings.i_)},td.prototype.contains=function(e){return void 0!==this.Qe.find(function(t){return e.T(t)})||void 0!==this.fieldTransforms.find(function(t){return e.T(t.field)})},td.prototype.w_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.E_(this.path.get(t))},td.prototype.E_=function(t){if(0===t.length)throw this.s_("Document fields must not be empty");if(Xp(this.n_)&&jp.test(t))throw this.s_('Document fields cannot begin and end with "__"')},td),Jp=(Zp.prototype.P_=function(t,e,n,r){return void 0===r&&(r=!1),new $p({n_:t,methodName:e,i_:n,path:qr.g(),r_:!1,R_:r},this.U,this.serializer,this.ignoreUndefinedProperties)},Zp);function Zp(t,e,n){this.U=t,this.ignoreUndefinedProperties=e,this.serializer=n||sp(t)}function td(t,e,n,r,i,o){this.settings=t,this.U=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.w_(),this.fieldTransforms=i||[],this.Qe=o||[]}function ed(t,e,n,r,i,o){void 0===o&&(o={});var s=t.P_(o.merge||o.mergeFields?2:0,e,n,i);ad("Data must be an object, but it was:",s,r);var u,a,r=sd(r,s);if(o.merge)u=new qs(s.Qe),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=f[h],p=void 0;if(l instanceof vp)p=l.Zl;else{if("string"!=typeof l)throw kr();p=hd(e,l,n)}if(!s.contains(p))throw new _r(Er.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");ld(c,p)||c.push(p)}u=new qs(c),a=s.fieldTransforms.filter(function(t){return u.He(t.field)})}else u=null,a=s.fieldTransforms;return new qp(new lu(r),u,a)}function nd(t,r,i,e){var o=t.P_(1,r,i);ad("Data must be an object, but it was:",o,e);var s=[],u=new pu;return Vr(e,function(t,e){var n=hd(r,t,i),t=o.I_(n);e instanceof bp||e instanceof Mp&&e.h_ instanceof bp?s.push(n):null!=(t=od(e,t))&&(s.push(n),u.set(n,t))}),e=new qs(s),new Bp(u.Je(),e,o.fieldTransforms)}function rd(t,e,n,r,i,o){var s=t.P_(1,e,n),u=[cd(e,r,n)],a=[i];if(o.length%2!=0)throw new _r(Er.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(cd(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new pu,y=u.length-1;0<=y;--y)ld(p,u[y])||(h=u[y],f=a[y],l=s.I_(h),f instanceof bp||f instanceof Mp&&f.h_ instanceof bp?p.push(h):null!=(l=od(f,l))&&(p.push(h),d.set(h,l)));return i=new qs(p),new Bp(d.Je(),i,s.fieldTransforms)}function id(t,e,n,r){return void 0===r&&(r=!1),od(n,t.P_(r?4:3,e))}function od(s,t){if(s instanceof Mp&&(s=s.h_),ud(s))return ad("Unsupported field value:",t,s),sd(s,t);if(s instanceof wp)return function(t,e){if(!Xp(e.n_))throw e.s_(t.t_+"() can only be used with update() and set()");if(!e.path)throw e.s_(t.t_+"() is not currently supported inside arrays");(t=t.e_(e))&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.Qe.push(t.path),s instanceof Array){if(t.settings.r_&&4!==t.n_)throw t.s_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=od(i[r],t.A_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return es(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Di.fromDate(t);return{timestampValue:ns(e.serializer,n)}}if(t instanceof Di){var r=new Di(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:ns(e.serializer,r)}}if(t instanceof Up)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof wi)return{bytesValue:rs(e.serializer,t.q)};if(t instanceof Fp){if(n=e.U,!(r=t.l_).isEqual(n))throw e.s_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:os(t.l_||e.U,t.__.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.s_("Unsupported field value: "+oi(t))}(s,t)}function sd(t,n){var r={};return Cr(t)?n.path&&0<n.path.length&&n.Qe.push(n.path):Vr(t,function(t,e){null!=(e=od(e,n.T_(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function ud(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Di||t instanceof Up||t instanceof wi||t instanceof Fp||t instanceof wp)}function ad(t,e,n){if(!ud(n)||!ii(n))throw"an object"===(n=oi(n))?e.s_(t+" a custom object"):e.s_(t+" "+n)}function cd(t,e,n){if(e instanceof vp)return e.Zl;if("string"==typeof e)return hd(t,e);throw fd("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function hd(t,e,n){try{return function(e){if(0<=e.search(mp))throw new _r(Er.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(gp.bind.apply(gp,i([void 0],e.split("."))))}catch(t){throw new _r(Er.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Zl}catch(e){throw fd(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function fd(t,e,n,r,i){var o=r&&!r.m(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new _r(Er.INVALID_ARGUMENT,(e+=". ")+t+n)}function ld(t,e){return t.some(function(t){return t.isEqual(e)})}var pd=(md.prototype.b_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.v_(),0<this.mutations.length)throw new _r(Er.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var i,e,n,o,r;return v(this,function(t){switch(t.label){case 0:return e=fs((i=s).serializer)+"/documents",n={documents:u.map(function(t){return us(i.serializer,t)})},[4,i.xu("BatchGetDocuments",e,n)];case 1:return n=t.sent(),o=new Map,n.forEach(function(t){var e,n,r,t=(e=i.serializer,"found"in(t=t)?function(t,e){Lr(!!e.found),e.found.name,e.found.updateTime;var n=as(t,e.found.name),t=is(e.found.updateTime),e=new lu({mapValue:{fields:e.found.fields}});return new Iu(n,t,e,{})}(e,t):"missing"in t?(n=e,Lr(!!(r=t).missing),Lr(!!r.readTime),n=as(n,r.missing),r=is(r.readTime),new Eu(n,r)):kr());o.set(t.key.toString(),t)}),r=[],[2,(u.forEach(function(t){Lr(!!(t=o.get(t.toString()))),r.push(t)}),r)]}})})}(this.ju,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Eu||t instanceof Iu?n.S_(t):kr()}),e)]}})})},md.prototype.set=function(t,e){this.write(e.d_(t,this.Ke(t))),this.p_.add(t.toString())},md.prototype.update=function(t,e){try{this.write(e.d_(t,this.D_(t)))}catch(t){this.V_=t}this.p_.add(t.toString())},md.prototype.delete=function(t){this.write([new hu(t,this.Ke(t))]),this.p_.add(t.toString())},md.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.v_(),this.V_)throw this.V_;return e=this.g_,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=Br.D(e),n.mutations.push(new fu(e,n.Ke(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=fs((e=i).serializer)+"/documents",r={writes:o.map(function(t){return ds(e.serializer,t)})},[4,e.$u("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.ju,this.mutations)];case 1:return t.sent(),this.y_=!0,[2]}})})},md.prototype.S_=function(t){var e;if(t instanceof Iu)e=t.version;else{if(!(t instanceof Eu))throw kr();e=Oi.min()}var n=this.g_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new _r(Er.ABORTED,"Document version changed between two reads.")}else this.g_.set(t.key.toString(),e)},md.prototype.Ke=function(t){var e=this.g_.get(t.toString());return!this.p_.has(t.toString())&&e?Ws.updateTime(e):Ws.Ge()},md.prototype.D_=function(t){var e=this.g_.get(t.toString());if(this.p_.has(t.toString())||!e)return Ws.exists(!0);if(e.isEqual(Oi.min()))throw new _r(Er.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ws.updateTime(e)},md.prototype.write=function(t){this.v_(),this.mutations=this.mutations.concat(t)},md.prototype.v_=function(){},md),dd=(gd.prototype.run=function(){this.N_()},gd.prototype.N_=function(){var t=this;this.gs.Rn(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new pd(this.ju),(n=this.F_(e))&&n.then(function(t){r.os.ds(function(){return e.commit().then(function(){r.hs.resolve(t)}).catch(function(t){r.x_(t)})})}).catch(function(t){r.x_(t)}),[2]})})})},gd.prototype.F_=function(t){try{var e=this.updateFunction(t);return!Vi(e)&&e.catch&&e.then?e:(this.hs.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.hs.reject(t),null}},gd.prototype.x_=function(t){var e=this;0<this.C_&&this.k_(t)?(--this.C_,this.os.ds(function(){return e.N_(),Promise.resolve()})):this.hs.reject(t)},gd.prototype.k_=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!Hi(t))},gd),yd=(vd.prototype.start=function(t,e,n,r){var i=this;this.O_(),this.pl=t;var o=new Ia,s=!1;return this.credentials.zc(function(t){return s?void i.os.Ds(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).os.Fs(),Dr("RemoteStore","RemoteStore received new credentials"),n=Zf(e),e.Hu.add(3),[4,Wf(e)];case 1:return t.sent(),n&&e.Zu.set("Unknown"),[4,e.Ku.Yl(i)];case 2:return t.sent(),e.Hu.delete(3),[4,zf(e)];case 3:return t.sent(),[2]}})})}(i.Vh,t)}):(s=!0,Dr("FirestoreClient","Initializing. user=",t.uid),i.L_(e,n,r,t,o).then(i.M_.resolve,i.M_.reject))}),this.os.ds(function(){return i.M_.promise}),o.promise},vd.prototype.enableNetwork=function(){var e=this;return this.O_(),this.os.enqueue(function(){return e.persistence.Za(!0),(t=e.Vh).Hu.delete(0),zf(t);var t})},vd.prototype.L_=function(r,i,o,s,u){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={os:this.os,pl:this.pl,clientId:this.clientId,credentials:this.credentials,Ql:s,Sh:100,persistenceSettings:o},[4,r.initialize(e)];case 1:return t.sent(),[4,i.initialize(r,e)];case 2:return t.sent(),this.persistence=r.persistence,this.bh=r.bh,this.Wu=r.Wu,this.Bl=r.Bl,this.ju=i.ju,this.Vh=i.Vh,this._i=i._i,this.B_=i.ph,this.B_.qs=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=Ol(s),(o=e.Ch.get(u))?(n=o.targetId,e.bh.Mi(n),r=o.view.gh(),[3,4]):[3,1];case 1:return[4,pf(e.Wu,Cu(u))];case 2:return i=t.sent(),o=e.bh.Mi(i.targetId),n=i.targetId,[4,gl(e,u,n,"current"===o)];case 3:r=t.sent(),e.qh&&Hf(e.Vh,i),t.label=4;case 4:return[2,r]}})})}.bind(null,this._i),this.B_.Ws=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Ch.get(o),1<(r=e.Nh.get(n.targetId)).length?[2,(e.Nh.set(n.targetId,r.filter(function(t){return!Fu(t,o)})),void e.Ch.delete(o))]:e.qh?(e.bh.Li(n.targetId),e.bh.Ni(n.targetId)?[3,2]:[4,df(e.Wu,n.targetId,!1).then(function(){e.bh.qi(n.targetId),Qf(e.Vh,n.targetId),El(e,n.targetId)}).catch(gf)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return El(e,n.targetId),[4,df(e.Wu,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,this._i),this.persistence.Xa(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),u.resolve(),[3,4];case 3:if(e=t.sent(),u.reject(e),!this.q_(e))throw e;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),this.L_(new lp,new dp,{Wl:!1},s,u))];case 4:return[2]}})})},vd.prototype.q_=function(t){return"FirebaseError"===t.name?t.code===Er.FAILED_PRECONDITION||t.code===Er.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},vd.prototype.O_=function(){if(this.os.Vs)throw new _r(Er.FAILED_PRECONDITION,"The client has already been terminated.")},vd.prototype.disableNetwork=function(){var t=this;return this.O_(),this.os.enqueue(function(){return t.persistence.Za(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Hu.add(0),[4,Wf(e)];case 1:return t.sent(),e.Zu.set("Offline"),[2]}})})}(t.Vh)})},vd.prototype.terminate=function(){var t=this;this.os.Ss();var n=new Ia;return this.os.ps(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.Bl&&this.Bl.stop(),[4,Kf(this.Vh)];case 1:return t.sent(),[4,this.bh.Si()];case 2:return t.sent(),[4,this.persistence.Si()];case 3:return t.sent(),this.credentials.Hc(),n.resolve(),[3,5];case 4:return e=Ha(e=t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,5];case 5:return[2]}})})}),n.promise},vd.prototype.waitForPendingWrites=function(){var t=this;this.O_();var e=new Ia;return this.os.ds(function(){return function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:Zf((n=o).Vh)||Dr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Wu).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.vr.Bo(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Oh.get(r)||[]).push(s),n.Oh.set(r,i),[3,4]);case 3:return i=Ha(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}(t._i,e)}),e.promise},vd.prototype.listen=function(t,e,n){var r=this;this.O_();var i=new yp(n),o=new Za(t,i,e);return this.os.ds(function(){return Xa(r.B_,o)}),function(){i.Xl(),r.os.ds(function(){return $a(r.B_,o)})}},vd.prototype.U_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.O_(),[4,this.M_.promise];case 1:return t.sent(),e=new Ia,[2,(this.os.ds(function(){return function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.Dc.Dr(t,e)}))];case 1:return(r=t.sent())instanceof Iu?s.resolve(r):r instanceof Eu?s.resolve(null):s.reject(new _r(Er.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=Ha(r=t.sent(),"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(n.Wu,r,e)}),e.promise)]}})})},vd.prototype.Q_=function(c,h){return void 0===h&&(h={}),y(this,void 0,void 0,function(){var e,a=this;return v(this,function(t){switch(t.label){case 0:return this.O_(),[4,this.M_.promise];case 1:return t.sent(),e=new Ia,[2,(this.os.ds(function(){return n=a.B_,r=a.os,i=c,o=h,s=e,t=new yp({next:function(t){r.ds(function(){return $a(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new _r(Er.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new _r(Er.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Za(Ou(i.path),t,{includeMetadataChanges:!0,Js:!0}),Xa(n,u);var n,r,i,o,s,t,u}),e.promise)]}})})},vd.prototype.W_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.O_(),[4,this.M_.promise];case 1:return t.sent(),e=new Ia,[2,(this.os.ds(function(){return function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,yf(r,i,!0)];case 1:return n=t.sent(),e=new fl(i,n.Nc),n=e.dh(n.documents),n=e.gr(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=Ha(n=t.sent(),"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(n.Wu,r,e)}),e.promise)]}})})},vd.prototype.j_=function(c,h){return void 0===h&&(h={}),y(this,void 0,void 0,function(){var u,a=this;return v(this,function(t){switch(t.label){case 0:return this.O_(),[4,this.M_.promise];case 1:return t.sent(),u=new Ia,[2,(this.os.ds(function(){return e=a.B_,n=a.os,t=c,r=h,i=u,o=new yp({next:function(t){n.ds(function(){return $a(e,s)}),t.fromCache&&"server"===r.source?i.reject(new _r(Er.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Za(t,o,{includeMetadataChanges:!0,Js:!0}),Xa(e,s);var e,n,t,r,i,o,s}),u.promise)]}})})},vd.prototype.write=function(t){var e=this;this.O_();var n=new Ia;return this.os.ds(function(){return function(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=xl(l),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.Wu,a=p,h=i,f=Di.now(),o=a.reduce(function(t,e){return t.add(e.key)},ho()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Dc.$r(u,o).next(function(t){c=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=c.get(i.key),s instanceof ou?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Iu?t.field(i.field):void 0;null!=(o=Ts(i.transform,o||null))&&(e=(null==e?new pu:e).set(i.field,o))}return e?e.Je():null}(o):null);null!=o&&e.push(new tu(i.key,o,function s(t){var u=[];return Vr(t.fields||{},function(t,e){var n=new qr([t]);if(Yo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new qs(u)}(o.proto.mapValue),Ws.exists(!0)))}return h.vr.xo(u,f,e,a)})}).then(function(t){var e=t.hr(c);return{batchId:t.batchId,dr:e}}))];case 2:return s=t.sent(),u.bh.Fi(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e.Mh[e.currentUser.Zs()])||new Yi(di)).rt(n,r),e.Mh[e.currentUser.Zs()]=i,[4,Al(u,s.dr)];case 3:return t.sent(),[4,rl(u.Vh)];case 4:return t.sent(),[3,6];case 5:return u=Ha(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,f,o})})}(e._i,t,n)}),n.promise},vd.prototype.U=function(){return this.pl.U},vd.prototype.K_=function(t){var e=this;this.O_();var r=new yp(t);return this.os.ds(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,(e=this.B_,n=r,e.Bs.add(n),void n.next())];var e,n})})}),function(){r.Xl(),e.os.ds(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,void this.B_.Bs.delete(r)]})})})}},Object.defineProperty(vd.prototype,"G_",{get:function(){return this.os.Vs},enumerable:!1,configurable:!0}),vd.prototype.transaction=function(t){var e=this;this.O_();var n=new Ia;return this.os.ds(function(){return new dd(e.os,e.ju,t,n).run(),Promise.resolve()}),n.promise},vd);function vd(t,e){this.credentials=t,this.os=e,this.clientId=li.k(),this.M_=new Ia}function gd(t,e,n,r){this.os=t,this.ju=e,this.updateFunction=n,this.hs=r,this.C_=5,this.gs=new _a(this.os,"transaction_retry")}function md(t){this.ju=t,this.g_=new Map,this.mutations=[],this.y_=!1,this.V_=null,this.p_=new Set}function wd(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var bd,Id,Ed=(Fd.prototype.J_=function(t){switch(Vo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Bo(t.integerValue||t.doubleValue);case 3:return this.X_(t.timestampValue);case 4:return this.Z_(t);case 5:return t.stringValue;case 6:return this.Y_(Go(t.bytesValue));case 7:return this.tf(t.referenceValue);case 8:return this.ef(t.geoPointValue);case 9:return this.nf(t.arrayValue);case 10:return this.sf(t.mapValue);default:throw kr()}},Fd.prototype.sf=function(t){var n=this,r={};return Vr(t.fields||{},function(t,e){r[t]=n.J_(e)}),r},Fd.prototype.ef=function(t){return new Up(Bo(t.latitude),Bo(t.longitude))},Fd.prototype.nf=function(t){var e=this;return(t.values||[]).map(function(t){return e.J_(t)})},Fd.prototype.Z_=function(t){switch(this.z_){case"previous":var e=function t(e){return ko(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==e?null:this.J_(e);case"estimate":return this.X_(Lo(t));default:return null}},Fd.prototype.X_=function(t){return t=qo(t),t=new Di(t.seconds,t.nanos),this.timestampsInSnapshots?t:t.toDate()},Fd.prototype.tf=function(t){var e=jr.P(t);return Lr(_s(e)),t=new Ai(e.get(1),e.get(3)),e=new Br(e.u(5)),t.isEqual(this.U)||Or("Document "+e+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+this.U.projectId+"/"+this.U.database+") instead."),this.H_(e)},Fd),_d=Cc.uo,Td=(jd.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},jd),Nd=(Object.defineProperty(Md.prototype,"wf",{get:function(){return this.mf||(this.mf=new Jp(this.l_,this.df.ignoreUndefinedProperties)),this.mf},enumerable:!1,configurable:!0}),Md.prototype.settings=function(t){if(Qr("Firestore.settings",arguments,1),$r("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.df),t)).merge,t=new Td(t),this.hf&&!this.df.isEqual(t))throw new _r(Er.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.df=t).credentials&&(this.ff=function(t){if(!t)return new Nf;switch(t.type){case"gapi":var e=t.client;return Lr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Df(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new _r(Er.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Md.prototype.enableNetwork=function(){return this.uf(),this.hf.enableNetwork()},Md.prototype.disableNetwork=function(){return this.uf(),this.hf.disableNetwork()},Md.prototype.enablePersistence=function(t){var e;if(this.hf)throw new _r(Er.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var n=!1,r=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Or("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),n=null!==(e=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==e&&e,r=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,n&&r))throw new _r(Er.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Tf(this.if,this.rf,{Wl:!0,cacheSizeBytes:this.df.cacheSizeBytes,synchronizeTabs:n,xa:r})},Md.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){var n,e=this;return v(this,function(t){if(void 0!==this.hf&&!this.hf.G_)throw new _r(Er.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new Ia,[2,(this.cf.ps(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.if.clearPersistence(this.l_,this._f)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},Md.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Md.prototype,"Ef",{get:function(){return this.uf(),this.hf.G_},enumerable:!1,configurable:!0}),Md.prototype.waitForPendingWrites=function(){return this.uf(),this.hf.waitForPendingWrites()},Md.prototype.onSnapshotsInSync=function(t){return this.uf(),wd(t)||($r("Firestore.onSnapshotsInSync","function",1,t),t={next:t}),this.hf.K_(t)},Md.prototype.uf=function(){return this.hf||this.Tf(new lp,new dp,{Wl:!1}),this.hf},Md.prototype.If=function(){return new _i(this.l_,this._f,this.df.host,this.df.ssl,this.df.experimentalForceLongPolling)},Md.prototype.Tf=function(t,e,n){var r=this.If();return this.hf=new yd(this.ff,this.cf),this.hf.start(r,t,e,n)},Md.lf=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new _r(Er.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e;if(!(t=t.options.projectId)||"string"!=typeof t)throw new _r(Er.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Ai(t)},Object.defineProperty(Md.prototype,"app",{get:function(){if(!this.af)throw new _r(Er.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.af},enumerable:!1,configurable:!0}),Md.prototype.collection=function(t){return Qr("Firestore.collection",arguments,1),$r("Firestore.collection","non-empty string",1,t),this.uf(),new Qd(jr.P(t),this,null)},Md.prototype.doc=function(t){return Qr("Firestore.doc",arguments,1),$r("Firestore.doc","non-empty string",1,t),this.uf(),Dd.Af(jr.P(t),this,null)},Md.prototype.collectionGroup=function(t){if(Qr("Firestore.collectionGroup",arguments,1),$r("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new _r(Er.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.uf(),new Kd((t=t,new Tu(jr.g(),t)),this,null)},Md.prototype.runTransaction=function(e){var n=this;return Qr("Firestore.runTransaction",arguments,1),$r("Firestore.runTransaction","function",1,e),this.uf().transaction(function(t){return e(new Ad(n,t))})},Md.prototype.batch=function(){return this.uf(),new Sd(this)},Object.defineProperty(Md,"logLevel",{get:function(){switch(Sr()){case l.DEBUG:return"debug";case l.ERROR:return"error";case l.SILENT:return"silent";case l.WARN:return"warn";case l.INFO:return"info";case l.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),Md.setLogLevel=function(t){Qr("Firestore.setLogLevel",arguments,1),ni("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Nr.setLogLevel(t)},Md.prototype.Rf=function(){return this.df.timestampsInSnapshots},Md.prototype.Pf=function(){return this.df},Md),Ad=(Ud.prototype.get=function(t){var e=this;Qr("Transaction.get",arguments,1);var n=ey("Transaction.get",t,this.gf);return this.yf.b_([n.__]).then(function(t){if(!t||1!==t.length)return kr();if((t=t[0])instanceof Eu)return new xd(e.gf,n.__,null,!1,!1,n.f_);if(t instanceof Iu)return new xd(e.gf,n.__,t,!1,!1,n.f_);throw kr()})},Ud.prototype.set=function(t,e,n){return Xr("Transaction.set",arguments,2,3),t=ey("Transaction.set",t,this.gf),n=Jd("Transaction.set",n),e=ny(t.f_,e,n),n=ed(this.gf.wf,"Transaction.set",t.__,e,null!==t.f_,n),this.yf.set(t.__,n),this},Ud.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return e="string"==typeof e||e instanceof gp?(Yr("Transaction.update",arguments,3),r=ey("Transaction.update",t,this.gf),rd(this.gf.wf,"Transaction.update",r.__,e,n,i)):(Qr("Transaction.update",arguments,2),r=ey("Transaction.update",t,this.gf),nd(this.gf.wf,"Transaction.update",r.__,e)),this.yf.update(r.__,e),this},Ud.prototype.delete=function(t){return Qr("Transaction.delete",arguments,1),t=ey("Transaction.delete",t,this.gf),this.yf.delete(t.__),this},Ud),Sd=(Cd.prototype.set=function(t,e,n){return Xr("WriteBatch.set",arguments,2,3),this.bf(),t=ey("WriteBatch.set",t,this.gf),n=Jd("WriteBatch.set",n),e=ny(t.f_,e,n),n=ed(this.gf.wf,"WriteBatch.set",t.__,e,null!==t.f_,n),this.Vf=this.Vf.concat(n.d_(t.__,Ws.Ge())),this},Cd.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return this.bf(),e="string"==typeof e||e instanceof gp?(Yr("WriteBatch.update",arguments,3),r=ey("WriteBatch.update",t,this.gf),rd(this.gf.wf,"WriteBatch.update",r.__,e,n,i)):(Qr("WriteBatch.update",arguments,2),r=ey("WriteBatch.update",t,this.gf),nd(this.gf.wf,"WriteBatch.update",r.__,e)),this.Vf=this.Vf.concat(e.d_(r.__,Ws.exists(!0))),this},Cd.prototype.delete=function(t){return Qr("WriteBatch.delete",arguments,1),this.bf(),t=ey("WriteBatch.delete",t,this.gf),this.Vf=this.Vf.concat(new hu(t.__,Ws.Ge())),this},Cd.prototype.commit=function(){return this.bf(),this.pf=!0,0<this.Vf.length?this.gf.uf().write(this.Vf):Promise.resolve()},Cd.prototype.bf=function(){if(this.pf)throw new _r(Er.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Cd),Dd=(n(Vd,Id=Fp),Vd.Af=function(t,e,n){if(t.length%2!=0)throw new _r(Er.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.R()+" has "+t.length);return new Vd(new Br(t),e,n)},Object.defineProperty(Vd.prototype,"id",{get:function(){return this.__.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Vd.prototype,"parent",{get:function(){return new Qd(this.__.path.h(),this.firestore,this.f_)},enumerable:!1,configurable:!0}),Object.defineProperty(Vd.prototype,"path",{get:function(){return this.__.path.R()},enumerable:!1,configurable:!0}),Vd.prototype.collection=function(t){if(Qr("DocumentReference.collection",arguments,1),$r("DocumentReference.collection","non-empty string",1,t),!t)throw new _r(Er.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");return t=jr.P(t),new Qd(this.__.path.child(t),this.firestore,null)},Vd.prototype.isEqual=function(t){if(!(t instanceof Vd))throw ai("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.__.isEqual(t.__)&&this.f_===t.f_},Vd.prototype.set=function(t,e){return Xr("DocumentReference.set",arguments,1,2),e=Jd("DocumentReference.set",e),t=ny(this.f_,t,e),e=ed(this.firestore.wf,"DocumentReference.set",this.__,t,null!==this.f_,e),this.hf.write(e.d_(this.__,Ws.Ge()))},Vd.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return t="string"==typeof t||t instanceof gp?(Yr("DocumentReference.update",arguments,2),rd(this.firestore.wf,"DocumentReference.update",this.__,t,e,n)):(Qr("DocumentReference.update",arguments,1),nd(this.firestore.wf,"DocumentReference.update",this.__,t)),this.hf.write(t.d_(this.__,Ws.exists(!0)))},Vd.prototype.delete=function(){return Qr("DocumentReference.delete",arguments,0),this.hf.write([new hu(this.__,Ws.Ge())])},Vd.prototype.onSnapshot=function(){for(var e=this,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];Xr("DocumentReference.onSnapshot",arguments,1,4);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||wd(n[i])||(ui("DocumentReference.onSnapshot",r=n[i],["includeMetadataChanges"]),ti("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};wd(n[i])?(s=n[i],n[i]=null===(r=s.next)||void 0===r?void 0:r.bind(s),n[i+1]=null===(r=s.error)||void 0===r?void 0:r.bind(s),n[i+2]=null===(r=s.complete)||void 0===r?void 0:r.bind(s)):($r("DocumentReference.onSnapshot","function",i,n[i]),Jr("DocumentReference.onSnapshot","function",i+1,n[i+1]),Jr("DocumentReference.onSnapshot","function",i+2,n[i+2]));var s={next:function(t){n[i]&&n[i](e.vf(t))},error:n[i+1],complete:n[i+2]};return this.hf.listen(Ou(this.__.path),o,s)},Vd.prototype.get=function(t){var e=this;Xr("DocumentReference.get",arguments,0,1),ty("DocumentReference.get",t);var n=this.firestore.uf();return t&&"cache"===t.source?n.U_(this.__).then(function(t){return new xd(e.firestore,e.__,t,!0,t instanceof Iu&&t.Ye,e.f_)}):n.Q_(this.__,t).then(function(t){return e.vf(t)})},Vd.prototype.withConverter=function(t){return new Vd(this.__,this.firestore,t)},Vd.prototype.vf=function(t){var e=t.docs.get(this.__);return new xd(this.firestore,this.__,e,t.fromCache,t.hasPendingWrites,this.f_)},Vd),Od=(Pd.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Pd),xd=(Ld.prototype.data=function(t){var e=this;if(Xr("DocumentSnapshot.data",arguments,0,1),t=Zd("DocumentSnapshot.data",t),this.Sf){if(this.f_){var n=new Rd(this.gf,this.__,this.Sf,this.Df,this.Cf,null);return this.f_.fromFirestore(n,t)}return new Ed(this.gf.l_,this.gf.Rf(),t.serverTimestamps||"none",function(t){return new Dd(t,e.gf,null)},function(t){return new Ni(t)}).J_(this.Sf.sn())}},Ld.prototype.get=function(t,e){var n=this;if(Xr("DocumentSnapshot.get",arguments,1,2),e=Zd("DocumentSnapshot.get",e),this.Sf&&null!==(t=this.Sf.data().field(cd("DocumentSnapshot.get",t,this.__))))return new Ed(this.gf.l_,this.gf.Rf(),e.serverTimestamps||"none",function(t){return new Dd(t,n.gf,n.f_)},function(t){return new Ni(t)}).J_(t)},Object.defineProperty(Ld.prototype,"id",{get:function(){return this.__.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Ld.prototype,"ref",{get:function(){return new Dd(this.__,this.gf,this.f_)},enumerable:!1,configurable:!0}),Object.defineProperty(Ld.prototype,"exists",{get:function(){return null!==this.Sf},enumerable:!1,configurable:!0}),Object.defineProperty(Ld.prototype,"metadata",{get:function(){return new Od(this.Cf,this.Df)},enumerable:!1,configurable:!0}),Ld.prototype.isEqual=function(t){if(!(t instanceof Ld))throw ai("isEqual","DocumentSnapshot",1,t);return this.gf===t.gf&&this.Df===t.Df&&this.__.isEqual(t.__)&&(null===this.Sf?null===t.Sf:this.Sf.isEqual(t.Sf))&&this.f_===t.f_},Ld),Rd=(n(kd,bd=xd),kd.prototype.data=function(t){return bd.prototype.data.call(this,t)},kd);function kd(){return null!==bd&&bd.apply(this,arguments)||this}function Ld(t,e,n,r,i,o){this.gf=t,this.__=e,this.Sf=n,this.Df=r,this.Cf=i,this.f_=o}function Pd(t,e){this.hasPendingWrites=t,this.fromCache=e}function Vd(t,e,n){var r=this;return(r=Id.call(this,e.l_,t,n)||this).__=t,r.firestore=e,r.f_=n,r.hf=r.firestore.uf(),r}function Cd(t){this.gf=t,this.Vf=[],this.pf=!1}function Ud(t,e){this.gf=t,this.yf=e}function Md(t,e,n,r){var i=this;if(void 0===n&&(n=new lp),void 0===r&&(r=new dp),this.if=n,this.rf=r,this.af=null,this.cf=new za,this.INTERNAL={delete:function(){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.uf(),[4,this.hf.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options)r=t,this.af=r,this.l_=Md.lf(r),this._f=r.name,this.ff=new Af(e);else{if(!(t=t).projectId)throw new _r(Er.INVALID_ARGUMENT,"Must provide projectId");this.l_=new Ai(t.projectId,t.database),this._f="[DEFAULT]",this.ff=new Nf}this.df=new Td({})}function jd(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new _r(Er.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Zr("settings","non-empty string","host",t.host),this.host=t.host,ti("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(ui("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),ti("settings","object","credentials",t.credentials),this.credentials=t.credentials,ti("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),ti("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Or("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Or("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(e=t.timestampsInSnapshots)||void 0===e||e,this.ignoreUndefinedProperties=null!==(e=t.ignoreUndefinedProperties)&&void 0!==e&&e,ti("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Cc.lo;else{if(t.cacheSizeBytes!==_d&&t.cacheSizeBytes<Cc.ho)throw new _r(Er.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Cc.ho);this.cacheSizeBytes=t.cacheSizeBytes}ti("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(t=t.experimentalForceLongPolling)&&void 0!==t&&t}function Fd(t,e,n,r,i){this.U=t,this.timestampsInSnapshots=e,this.z_=n,this.H_=r,this.Y_=i}function qd(t,e,n){if("string"==typeof n){if(""===n)throw new _r(Er.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Pu(e)&&-1!==n.indexOf("/"))throw new _r(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(jr.P(n)),!Br.F(e))throw new _r(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return zo(t,new Br(e))}if(n instanceof Fp)return zo(t,n.__);throw new _r(Er.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+oi(n)+".")}function Bd(t,e){if(!Array.isArray(t)||0===t.length)throw new _r(Er.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new _r(Er.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new _r(Er.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new _r(Er.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function Gd(t,e,n){if(!n.isEqual(e))throw new _r(Er.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function zd(t){if(Ru(t)&&0===t.rn.length)throw new _r(Er.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Wd,Kd=($d.prototype.where=function(t,e,n){return Qr("Query.where",arguments,3),si("Query.where",3,n),e=ni("Query.where",["<","<=","==","!=",">=",">","array-contains","in","array-contains-any","not-in"],2,e),t=cd("Query.where",t),e=function(t,e,n,r,i,o){if(r.p()){if("array-contains"===i||"array-contains-any"===i)throw new _r(Er.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){Bd(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(qd(n,t,c))}h={arrayValue:{values:s}}}else h=qd(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Bd(o,i),h=id(e,"Query.where",o,"in"===i||"not-in"===i);var h=Ku.create(r,i,h);return function(t,e){if(e.un()){var n=Lu(t);if(null!==n&&!n.isEqual(e.field))throw new _r(Er.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=ku(t))&&Gd(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new _r(Er.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new _r(Er.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(this.Nf,this.firestore.wf,this.firestore.l_,t,e,n),new $d((e=(n=this.Nf).filters.concat([e]),new Tu(n.path,n.collectionGroup,n.rn.slice(),e,n.limit,n.on,n.startAt,n.endAt)),this.firestore,this.f_)},$d.prototype.orderBy=function(t,e){if(Xr("Query.orderBy",arguments,1,2),Jr("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new _r(Er.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=cd("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new _r(Er.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new _r(Er.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new ba(e,n);return e=r,null!==ku(n=t)||null!==(t=Lu(n))&&Gd(0,t,e.field),r}(this.Nf,t,n);return new $d((t=(n=this.Nf).rn.concat([t]),new Tu(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.on,n.startAt,n.endAt)),this.firestore,this.f_)},$d.prototype.limit=function(t){return Qr("Query.limit",arguments,1),$r("Query.limit","number",1,t),ci("Query.limit",1,t),new $d(Uu(this.Nf,t,"F"),this.firestore,this.f_)},$d.prototype.limitToLast=function(t){return Qr("Query.limitToLast",arguments,1),$r("Query.limitToLast","number",1,t),ci("Query.limitToLast",1,t),new $d(Uu(this.Nf,t,"L"),this.firestore,this.f_)},$d.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Yr("Query.startAt",arguments,1),t=this.Ff("Query.startAt",t,e,!0),new $d(Mu(this.Nf,t),this.firestore,this.f_)},$d.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Yr("Query.startAfter",arguments,1),t=this.Ff("Query.startAfter",t,e,!1),new $d(Mu(this.Nf,t),this.firestore,this.f_)},$d.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Yr("Query.endBefore",arguments,1),t=this.Ff("Query.endBefore",t,e,!0),new $d(ju(this.Nf,t),this.firestore,this.f_)},$d.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Yr("Query.endAt",arguments,1),t=this.Ff("Query.endAt",t,e,!1),new $d(ju(this.Nf,t),this.firestore,this.f_)},$d.prototype.isEqual=function(t){if(!(t instanceof $d))throw ai("isEqual","Query",1,t);return this.firestore===t.firestore&&Fu(this.Nf,t.Nf)&&this.f_===t.f_},$d.prototype.withConverter=function(t){return new $d(this.Nf,this.firestore,t)},$d.prototype.Ff=function(c,t,e,n){return si(c,1,t),t instanceof xd?(Qr(c,i([t],e),1),function(t,e,n,r){if(!n)throw new _r(Er.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=Vu(t);o<s.length;o++){var u=s[o];if(u.field.p())i.push(zo(e,n.key));else{var a=n.field(u.field);if(ko(a))throw new _r(Er.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.R(),new _r(Er.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new la(i,r)}(this.Nf,this.firestore.l_,t.Sf,n)):(e=[t].concat(e),function(t,e,n,r,i,o){var s=t.rn;if(i.length>s.length)throw new _r(Er.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.p()){if("string"!=typeof c)throw new _r(Er.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Pu(t)&&-1!==c.indexOf("/"))throw new _r(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(jr.P(c));if(!Br.F(h))throw new _r(Er.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new Br(h),u.push(zo(e,h))}else c=id(n,r,c),u.push(c)}return new la(u,o)}(this.Nf,this.firestore.l_,this.firestore.wf,c,e,n))},$d.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Xr("Query.onSnapshot",arguments,1,4);var i={},o=0;"object"!=typeof n[o]||wd(n[o])||(ui("Query.onSnapshot",i=n[o],["includeMetadataChanges"]),ti("Query.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),o++),wd(n[o])?(s=n[o],n[o]=null===(t=s.next)||void 0===t?void 0:t.bind(s),n[o+1]=null===(t=s.error)||void 0===t?void 0:t.bind(s),n[o+2]=null===(t=s.complete)||void 0===t?void 0:t.bind(s)):($r("Query.onSnapshot","function",o,n[o]),Jr("Query.onSnapshot","function",o+1,n[o+1]),Jr("Query.onSnapshot","function",o+2,n[o+2]));var s={next:function(t){n[o]&&n[o](new Hd(e.firestore,e.Nf,t,e.f_))},error:n[o+1],complete:n[o+2]};return zd(this.Nf),this.firestore.uf().listen(this.Nf,i,s)},$d.prototype.get=function(t){var e=this;Xr("Query.get",arguments,0,1),ty("Query.get",t),zd(this.Nf);var n=this.firestore.uf();return(t&&"cache"===t.source?n.W_(this.Nf):n.j_(this.Nf,t)).then(function(t){return new Hd(e.firestore,e.Nf,t,e.f_)})},$d),Hd=(Object.defineProperty(Xd.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Xd.prototype,"empty",{get:function(){return this.xf.docs.m()},enumerable:!1,configurable:!0}),Object.defineProperty(Xd.prototype,"size",{get:function(){return this.xf.docs.size},enumerable:!1,configurable:!0}),Xd.prototype.forEach=function(e,n){var r=this;Xr("QuerySnapshot.forEach",arguments,1,2),$r("QuerySnapshot.forEach","function",1,e),this.xf.docs.forEach(function(t){e.call(n,r.Of(t,r.metadata.fromCache,r.xf.Qt.has(t.key)))})},Object.defineProperty(Xd.prototype,"query",{get:function(){return new Kd(this.$f,this.gf,this.f_)},enumerable:!1,configurable:!0}),Xd.prototype.docChanges=function(t){if(t&&(ui("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),ti("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges)),(t=!(!t||!t.includeMetadataChanges))&&this.xf.jt)throw new _r(Er.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.kf&&this.Mf===t||(this.kf=function(i,e,o){if(i.Ut.m()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Ut;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return kr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.xf,t,this.Of.bind(this)),this.Mf=t),this.kf},Xd.prototype.isEqual=function(t){if(!(t instanceof Xd))throw ai("isEqual","QuerySnapshot",1,t);return this.gf===t.gf&&Fu(this.$f,t.$f)&&this.xf.isEqual(t.xf)&&this.f_===t.f_},Xd.prototype.Of=function(t,e,n){return new Rd(this.gf,t.key,t,e,n,this.f_)},Xd),Qd=(n(Yd,Wd=Kd),Object.defineProperty(Yd.prototype,"id",{get:function(){return this.Nf.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Yd.prototype,"parent",{get:function(){var t=this.Nf.path.h();return t.m()?null:new Dd(new Br(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Yd.prototype,"path",{get:function(){return this.Nf.path.R()},enumerable:!1,configurable:!0}),Yd.prototype.doc=function(t){return Xr("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=li.k()),$r("CollectionReference.doc","non-empty string",1,t),t=jr.P(t),Dd.Af(this.Nf.path.child(t),this.firestore,this.f_)},Yd.prototype.add=function(t){Qr("CollectionReference.add",arguments,1),$r("CollectionReference.add","object",1,t=this.f_?this.f_.toFirestore(t):t);var e=this.doc();return new Dd(e.__,this.firestore,null).set(t).then(function(){return e})},Yd.prototype.withConverter=function(t){return new Yd(this.Lf,this.firestore,t)},Yd);function Yd(t,e,n){var r=this;if(((r=Wd.call(this,Ou(t),e,n)||this).Lf=t).length%2!=1)throw new _r(Er.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.R()+" has "+t.length);return r}function Xd(t,e,n,r){this.gf=t,this.$f=e,this.xf=n,this.f_=r,this.kf=null,this.Mf=null,this.metadata=new Od(n.hasPendingWrites,n.fromCache)}function $d(t,e,n){this.Nf=t,this.firestore=e,this.f_=n}function Jd(t,e){if(void 0===e)return{merge:!1};if(ui(t,e,["merge","mergeFields"]),ti(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new _r(Er.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+oi(n));for(var r,i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof gp))throw new _r(Er.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+oi(n[i]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new _r(Er.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function Zd(t,e){return void 0===e?{}:(ui(t,e,["serverTimestamps"]),ei(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function ty(t,e){Jr(t,"object",1,e),e&&(ui(t,e,["source"]),ei(t,0,"source",e.source,["default","server","cache"]))}function ey(t,e,n){if(e instanceof Fp){if(e.firestore!==n)throw new _r(Er.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw ai(t,"DocumentReference",1,e)}function ny(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var ry,iy,Ie=(n(sy,ry=Mp),sy.serverTimestamp=function(){Hr("FieldValue.serverTimestamp",arguments);var t=new Lp("serverTimestamp");return t.t_="FieldValue.serverTimestamp",new sy(t)},sy.delete=function(){Hr("FieldValue.delete",arguments);var t=new bp("deleteField");return t.t_="FieldValue.delete",new sy(t)},sy.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Yr("FieldValue.arrayUnion",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Yr("arrayUnion()",arguments,1),new Pp("arrayUnion",t)}.apply(void 0,t);return n.t_="FieldValue.arrayUnion",new sy(n)},sy.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Yr("FieldValue.arrayRemove",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Yr("arrayRemove()",arguments,1),new Vp("arrayRemove",t)}.apply(void 0,t);return n.t_="FieldValue.arrayRemove",new sy(n)},sy.increment=function(t){return $r("FieldValue.increment","number",1,t),Qr("FieldValue.increment",arguments,1),(t=new Cp("increment",t)).t_="FieldValue.increment",new sy(t)},sy.prototype.isEqual=function(t){return this.h_.isEqual(t.h_)},sy),oy={Firestore:Nd,GeoPoint:Up,Timestamp:Di,Blob:Ni,Transaction:Ad,WriteBatch:Sd,DocumentReference:Dd,DocumentSnapshot:xd,Query:Kd,QueryDocumentSnapshot:Rd,QuerySnapshot:Hd,CollectionReference:Qd,FieldPath:gp,FieldValue:Ie,setLogLevel:Nd.setLogLevel,CACHE_SIZE_UNLIMITED:_d};function sy(){return null!==ry&&ry.apply(this,arguments)||this}(iy=e.default).INTERNAL.registerComponent(new wr("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),r=new dp,t=new pp(r),new Nd(e,n,t,r);var e,n,r},"PUBLIC").setServiceProps(Object.assign({},oy))),iy.registerVersion("@firebase/firestore","1.17.3-202096215419")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
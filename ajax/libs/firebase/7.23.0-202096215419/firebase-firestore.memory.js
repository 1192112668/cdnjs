!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Xf){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var u,e=t(Xf),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Ee=u=u||{})[Ee.DEBUG=0]="DEBUG",Ee[Ee.VERBOSE=1]="VERBOSE",Ee[Ee.INFO=2]="INFO",Ee[Ee.WARN=3]="WARN",Ee[Ee.ERROR=4]="ERROR",Ee[Ee.SILENT=5]="SILENT";function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var a={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},h=u.INFO,c=((Ie={})[u.DEBUG]="log",Ie[u.VERBOSE]="log",Ie[u.INFO]="info",Ie[u.WARN]="warn",Ie[u.ERROR]="error",Ie),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?a[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=h,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e){e=d.call(this,e)||this;return e.code=t,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").",s=new m(o,t),u=0,a=Object.keys(i);u<a.length;u++){var h=a[u];"_"!==h.slice(-1)&&(h in s&&console.warn('Overwriting FirebaseError base field "'+h+'" can cause unexpected behavior.'),s[h]=i[h])}return s},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,R="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S={},D=R||self;function L(){}function O(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function P(t){var e=O(t);return"array"==e||"object"==e&&"number"==typeof t.length}function k(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var U="closure_uid_"+(1e9*Math.random()>>>0),_=0;function V(t,e,n){return t.call.apply(t.bind,arguments)}function C(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function j(t,e,n){return(j=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?V:C).apply(null,arguments)}function M(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var x=Date.now;function q(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,U)&&t[U]||(t[U]=++_))},F.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var B=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function Q(){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function W(t){return/^[\s\xa0]*$/.test(t)}var H,X=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function K(t,e){return t<e?-1:e<t?1:0}t:{var J=D.navigator;if(J){J=J.userAgent;if(J){H=J;break t}}H=""}function Z(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function $(t){var e,n={};for(e in t)n[e]=t[e];return n}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<tt.length;i++)e=tt[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function nt(t){return nt[" "](t),t}nt[" "]=L;var rt,it=Y(H,"Opera"),ot=Y(H,"Trident")||Y(H,"MSIE"),st=Y(H,"Edge"),ut=st||ot,at=Y(H,"Gecko")&&!(Y(H.toLowerCase(),"webkit")&&!Y(H,"Edge"))&&!(Y(H,"Trident")||Y(H,"MSIE"))&&!Y(H,"Edge"),ht=Y(H.toLowerCase(),"webkit")&&!Y(H,"Edge");function ct(){var t=D.document;return t?t.documentMode:void 0}t:{var lt="",ft=(ft=H,at?/rv:([^\);]+)(\)|;)/.exec(ft):st?/Edge\/([\d\.]+)/.exec(ft):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ft):ht?/WebKit\/(\S+)/.exec(ft):it?/(?:Version)[ \/]?(\S+)/.exec(ft):void 0);if(ft&&(lt=ft?ft[1]:""),ot){ft=ct();if(null!=ft&&ft>parseFloat(lt)){rt=String(ft);break t}}rt=lt}var pt={};function dt(u){return t=u,e=function(){for(var t=0,e=X(String(rt)).split("."),n=X(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=K(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||K(0==o[2].length,0==s[2].length)||K(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=pt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var yt=D.document&&ot?ct()||(parseInt(rt,10)||void 0):void 0,vt=!ot||9<=Number(yt),gt=ot&&!dt("9"),mt=function(){if(!D.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{D.addEventListener("test",L,e),D.removeEventListener("test",L,e)}catch(t){}return t}();function wt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function bt(t,e){if(wt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(at){t:{try{nt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Et[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}wt.prototype.b=function(){this.defaultPrevented=!0},q(bt,wt);var Et={2:"touch",3:"pen",4:"mouse"};bt.prototype.b=function(){bt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,gt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var It="closure_listenable_"+(1e6*Math.random()|0),Tt=0;function At(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Tt,this.Y=this.Z=!1}function Nt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Rt(t){this.src=t,this.a={},this.b=0}function St(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=B(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Nt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Dt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Rt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Dt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new At(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Lt="closure_lm_"+(1e6*Math.random()|0),Ot={};function Pt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=xt(r);return e&&e[It]?e.wa(n,r,k(i)?!!i.capture:!!i,o):kt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Pt(t,e[o],n,r,i);return null}return n=xt(n),t&&t[It]?t.va(e,n,k(r)?!!r.capture:!!r,i):kt(t,e,n,!1,r,i)}function kt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=k(i)?!!i.capture:!!i;if(s&&!vt)return null;var u,a,h=jt(t);if(h||(t[Lt]=h=new Rt(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Ct,r=a=vt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)mt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(_t(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ut(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[It]?St(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(_t(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=jt(e))?(St(n,t),0==n.b&&(n.src=null,e[Lt]=null)):Nt(t)))}function _t(t){return t in Ot?Ot[t]:Ot[t]="on"+t}function Vt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Ut(t),n.call(r,e)}function Ct(t,e){if(t.Y)return!0;if(vt)return Vt(t,new bt(e,this));if(!e)t:{e=["window","event"];for(var n=D,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Vt(t,e=new bt(e,this))}function jt(t){return(t=t[Lt])instanceof Rt?t:null}var Mt="__closure_events_fn_"+(1e9*Math.random()>>>0);function xt(e){return"function"==O(e)?e:(e[Mt]||(e[Mt]=function(t){return e.handleEvent(t)}),e[Mt])}function qt(){F.call(this),this.c=new Rt(this),(this.J=this).C=null}function Ft(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&St(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}q(qt,F),qt.prototype[It]=!0,(N=qt.prototype).addEventListener=function(t,e,n,r){Pt(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=k(i)?!!i.capture:!!i,r=xt(r),e&&e[It]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Dt(s=e.a[n],r,i,o))&&(Nt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&jt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Dt(n,r,i,o)),(r=-1<e?n[e]:null)&&Ut(r))}(this,t,e,n,r)},N.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new wt(t,n):t instanceof wt?t.target=t.target||n:(s=t,et(t=new wt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=Ft(o,r,!0,t)&&s;if(s=Ft(o=t.a=n,r,!0,t)&&s,s=Ft(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Ft(o=t.a=e[i],r,!1,t)&&s;return s},N.G=function(){if(qt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Nt(n[r]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},N.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Bt=D.JSON.stringify;function Gt(){this.b=this.a=null}var Qt,zt=(Wt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Wt(function(){return new Ht},function(t){t.reset()},100));function Wt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Ht(){this.next=this.b=this.a=null}function Xt(t,e){var n;Qt||(n=D.Promise.resolve(void 0),Qt=function(){n.then(Jt)}),Yt||(Qt(),Yt=!0),Kt.add(t,e)}Gt.prototype.add=function(t,e){var n=zt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Ht.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Yt=!(Ht.prototype.reset=function(){this.next=this.b=this.a=null}),Kt=new Gt;function Jt(){for(var t,e;n=e=void 0,n=null,(e=Kt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){D.setTimeout(function(){throw t},0)}(t)}var n=zt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Yt=!1}function Zt(t,e){qt.call(this),this.b=t||1,this.a=e||D,this.f=j(this.Ya,this),this.g=x()}function $t(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function te(t,e,n){if("function"==O(t))n&&(t=j(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=j(t.handleEvent,t)}return 2147483647<Number(e)?-1:D.setTimeout(t,e||0)}q(Zt,qt),(N=Zt.prototype).aa=!1,N.M=null,N.Ya=function(){var t;this.aa&&(0<(t=x()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&($t(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=x())},N.G=function(){Zt.S.G.call(this),$t(this),delete this.a};var ee,ne,re,ie=(T(ne=se,re=ee=F),ne.prototype=null===re?Object.create(re):(oe.prototype=re.prototype,new oe),se.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=te(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},se.prototype.G=function(){ee.prototype.G.call(this),this.a&&(D.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},se);function oe(){this.constructor=ne}function se(t,e,n){var r=ee.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function ue(t){F.call(this),this.b=t,this.a={}}q(ue,F);var ae=[];function he(t,e,n,r){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var i=0;i<n.length;i++){var o=Pt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ce(t){Z(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ut(t)},t),t.a={}}function le(){this.a=!0}function fe(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Bt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ue.prototype.G=function(){ue.S.G.call(this),ce(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},le.prototype.info=function(){};var pe=null;function de(){return pe=pe||new qt}function ye(t){wt.call(this,"serverreachability",t)}function ve(t){var e=de();e.dispatchEvent(new ye(e))}function ge(t){wt.call(this,"statevent",t)}function me(t){var e=de();e.dispatchEvent(new ge(e))}function we(t){wt.call(this,"timingevent",t)}function be(t,e){if("function"!=O(t))throw Error("Fn must not be null and must be a function");return D.setTimeout(function(){t()},e)}q(ye,wt),q(ge,wt),q(we,wt);var Ee={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ie={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Te(){}function Ae(t){var e;return(e=t.a)||(e=t.a={}),e}function Ne(){}Te.prototype.a=null;var Re,R={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Se(){wt.call(this,"d")}function De(){wt.call(this,"c")}function Le(){}function Oe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new ue(this),this.P=Pe,t=ut?125:void 0,this.R=new Zt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}q(Se,wt),q(De,wt),q(Le,Te),Re=new Le;var Pe=45e3,ke={},Ue={};function _e(t,e,n){t.H=1,t.i=en(Ye(e)),t.j=n,t.I=!0,Ve(t,null)}function Ve(t,e){t.u=x(),je(t),t.l=Ye(t.i);var s,u,a,h,c,l,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),yn(n.b,"t",r),t.D=0,t.a=ar(t.g,t.g.C?e:null),0<t.O&&(t.F=new ie(j(t.Ca,t,t.a),t.O)),he(t.J,t.a,"readystatechange",t.Wa),e=t.B?$(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ve(1),s=t.c,u=t.m,a=t.l,h=t.f,c=t.T,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function Ce(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Ue:(i=Number(u.substring(i,o)),isNaN(i)?ke:(o+=1)+i>u.length?Ue:(u=u.substr(o,i),r.D=o+i,u)));if(u==Ue){4==e&&(t.h=4,me(14),s=!1),fe(t.c,t.f,null,"[Incomplete Response]");break}if(u==ke){t.h=4,me(15),fe(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}fe(t.c,t.f,u,null),Be(t,u)}4==e&&0==n.length&&(t.h=1,me(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),tr(e),e.F=!0)):(fe(t.c,t.f,n,"[Invalid Chunked Response]"),Fe(t),qe(t))}function je(t){t.U=x()+t.P,Me(t,t.P)}function Me(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=be(j(t.Ua,t),e)}function xe(t){t.o&&(D.clearTimeout(t.o),t.o=null)}function qe(t){0==t.g.v||t.A||rr(t.g,t)}function Fe(t){xe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,$t(t.R),ce(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Be(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||In(u.b,t)))if(u.I=t.N,!t.C&&In(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var h=a;if(0==h[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;nr(u),zn(u)}$n(u),me(18)}}else u.oa=h[1],0<u.oa-u.P&&h[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=be(j(u.Ra,u),6e3));if(En(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else or(u,11)}else if(!t.C&&u.a!=t||nr(u),!W(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){h=e[a],u.P=h[0],h=h[1],2==u.v?"c"==h[0]?(u.J=h[1],u.ga=h[2],null!=(r=h[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=h[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=h[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(Y(r,"spdy")||Y(r,"quic")||Y(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(Tn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,tn(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.V&&(u.N=x()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ur(n,n.C?n.ga:null,n.fa),i.C?(An(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(xe(o),je(o)),n.a=i):Zn(n),0<u.g.length&&Xn(u)):"stop"!=h[0]&&"close"!=h[0]||or(u,7):3==u.v&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?or(u,7):Qn(u):"noop"!=h[0]&&u.f&&u.f.sa(h),u.o=0)}ve(4)}catch(t){}}function Ge(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(P(t)||"string"==typeof t)G(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(P(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(P(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Qe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Qe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function ze(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];We(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)We(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function We(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=Oe.prototype).setTimeout=function(t){this.P=t},N.Wa=function(t){t=t.target;var e=this.F;e&&3==qn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=qn(this.a),n=this.a.ua(),r=this.a.X();if(!(e<3||3==e&&!ut&&!this.a.$())){this.A||4!=e||7==n||ve(8==n||r<=0?3:2),xe(this);var i=this.a.X();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,h=this.f,c=this.T,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+c+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.V&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!W(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,me(12),Fe(this),qe(this);break t}fe(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Be(this,s)}this.I?(Ce(this,e,n),ut&&this.b&&3==e&&(he(this.J,this.R,"tick",this.Va),this.R.start())):(fe(this.c,this.f,n,null),Be(this,n)),4==e&&Fe(this),this.b&&!this.A&&(4==e?rr(this.g,this):(this.b=!1,je(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,me(12)):(this.h=0,me(13)),Fe(this),qe(this)}}}catch(t){}var u,a,h,c,l,f},N.Va=function(){var t,e;this.a&&(t=qn(this.a),e=this.a.$(),this.D<e.length&&(xe(this),Ce(this,t,e),this.b&&4!=t&&je(this)))},N.cancel=function(){this.A=!0,Fe(this)},N.Ua=function(){this.o=null;var t,e,n=x();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ve(3),me(17)),Fe(this),this.h=2,qe(this)):Me(this,this.U-n)},(N=Qe.prototype).K=function(){ze(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return ze(this),this.a.concat()},N.get=function(t,e){return We(this.b,t)?this.b[t]:e},N.set=function(t,e){We(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var He=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Xe(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Xe?(this.a=void 0!==e?e:t.a,Ke(this,t.f),this.j=t.j,Je(this,t.c),Ze(this,t.h),this.g=t.g,e=t.b,(n=new ln).c=e.c,e.a&&(n.a=new Qe(e.a),n.b=e.b),$e(this,n),this.i=t.i):t&&(n=String(t).match(He))?(this.a=!!e,Ke(this,n[1]||"",!0),this.j=nn(n[2]||""),Je(this,n[3]||"",!0),Ze(this,n[4]),this.g=nn(n[5]||"",!0),$e(this,n[6]||"",!0),this.i=nn(n[7]||"")):(this.a=!!e,this.b=new ln(null,this.a))}function Ye(t){return new Xe(t)}function Ke(t,e,n){t.f=n?nn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Je(t,e,n){t.c=n?nn(e,!0):e}function Ze(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function $e(t,e,n){var r,i;e instanceof ln?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(fn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(pn(this,e),yn(this,n,t))},r)),r.f=i):(n||(e=rn(e,hn)),t.b=new ln(e,t.a))}function tn(t,e,n){t.b.set(e,n)}function en(t){return tn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^x()).toString(36)),t}function nn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function rn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,on),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function on(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Xe.prototype.toString=function(){var t=[],e=this.f;e&&t.push(rn(e,sn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(rn(e,sn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(rn(n,"/"==n.charAt(0)?an:un,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",rn(n,cn)),t.join("")};var sn=/[#\/\?@]/g,un=/[#\?:]/g,an=/[#\?]/g,hn=/[#\?@]/g,cn=/#/g;function ln(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function fn(n){n.a||(n.a=new Qe,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function pn(t,e){fn(t),e=vn(t,e),We(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,We((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&ze(t)))}function dn(t,e){return fn(t),e=vn(t,e),We(t.a.b,e)}function yn(t,e,n){pn(t,e),0<n.length&&(t.c=null,t.a.set(vn(t,e),z(n)),t.b+=n.length)}function vn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function gn(t,e){this.b=t,this.a=e}function mn(t){this.g=t||wn,t=D.PerformanceNavigationTiming?0<(t=D.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(D.ia&&D.ia.ya&&D.ia.ya()&&D.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(N=ln.prototype).add=function(t,e){fn(this),this.c=null,t=vn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,r){fn(this),this.a.forEach(function(t,e){G(t,function(t){n.call(r,t,e,this)},this)},this)},N.L=function(){fn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},N.K=function(t){fn(this);var e=[];if("string"==typeof t)dn(this,t)&&(e=Q(e,this.a.get(vn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=Q(e,t[n])}return e},N.set=function(t,e){return fn(this),this.c=null,dn(this,t=vn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var wn=10;function bn(t){return t.b||t.a&&t.a.size>=t.f}function En(t){return t.b?1:t.a?t.a.size:0}function In(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Tn(t,e){t.a?t.a.add(e):t.b=e}function An(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Nn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Rn(){}function Sn(){this.a=new Rn}function Dn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}mn.prototype.cancel=function(){var e,t;if(this.c=Nn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Rn.prototype.stringify=function(t){return D.JSON.stringify(t,void 0)},Rn.prototype.parse=function(t){return D.JSON.parse(t,void 0)};var Ln=D.JSON.parse;function On(t){qt.call(this),this.headers=new Qe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Pn,this.D=this.F=!1}q(On,qt);var Pn="",kn=/^https?$/i,Un=["POST","PUT"];function _n(t){return"content-type"==t.toLowerCase()}function Vn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Cn(t),Mn(t)}function Cn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function jn(t){if(t.b&&void 0!==S&&(!t.s[1]||4!=qn(t)||2!=t.X()))if(t.l&&4==qn(t))te(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==qn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(He)[1]||null)&&D.self&&D.self.location&&(i=(r=D.self.location.protocol).substr(0,r.length-1)),n=!kn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<qn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Cn(t)}}finally{Mn(t)}}}function Mn(t,e){if(t.a){xn(t);var n=t.a,r=t.s[0]?L:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function xn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(D.clearTimeout(t.m),t.m=null)}function qn(t){return t.a?t.a.readyState:0}function Fn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Z(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):tn(t,e,n))}function Bn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Gn(t){this.pa=0,this.g=[],this.c=new le,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Bn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Bn("baseRetryDelayMs",5e3,t),this.Ma=Bn("retryDelaySeedMs",1e4,t),this.Ja=Bn("forwardChannelMaxRetries",2,t),this.ma=Bn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new mn(t&&t.concurrentRequestLimit),this.ka=new Sn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Qn(t){var e,n;Wn(t),3==t.v&&(e=t.R++,tn(n=Ye(t.B),"SID",t.J),tn(n,"RID",e),tn(n,"TYPE","terminate"),Kn(t,n),(e=new Oe(t,t.c,e,void 0)).H=2,e.i=en(Ye(n)),n=!1,D.navigator&&D.navigator.sendBeacon&&(n=D.navigator.sendBeacon(e.i.toString(),"")),!n&&D.Image&&((new Image).src=e.i,n=!0),n||(e.a=ar(e.g,null),e.a.ba(e.i)),e.u=x(),je(e)),sr(t)}function zn(t){t.a&&(tr(t),t.a.cancel(),t.a=null)}function Wn(t){zn(t),t.j&&(D.clearTimeout(t.j),t.j=null),nr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&D.clearTimeout(t.h),t.h=null)}function Hn(t,e){t.g.push(new gn(t.La++,e)),3==t.v&&Xn(t)}function Xn(t){bn(t.b)||t.h||(t.h=!0,Xt(t.Ba,t),t.u=0)}function Yn(t,e){var n=e?e.f:t.R++,r=Ye(t.B);tn(r,"SID",t.J),tn(r,"RID",n),tn(r,"AID",t.P),Kn(t,r),t.i&&t.l&&Fn(r,t.i,t.l),n=new Oe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Jn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Tn(t.b,n),_e(n,r,e)}function Kn(t,n){t.f&&Ge({},function(t,e){tn(n,e,t)})}function Jn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?j(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{Ge(t,function(t,e){var n=t;k(t)&&(n=Bt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Zn(t){t.a||t.j||(t.U=1,Xt(t.Aa,t),t.o=0)}function $n(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=be(j(t.Aa,t),ir(t,t.o)),t.o++,1)}function tr(t){null!=t.s&&(D.clearTimeout(t.s),t.s=null)}function er(t){t.a=new Oe(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ye(t.la);tn(e,"RID","rpc"),tn(e,"SID",t.J),tn(e,"CI",t.H?"0":"1"),tn(e,"AID",t.P),Kn(t,e),tn(e,"TYPE","xmlhttp"),t.i&&t.l&&Fn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=en(Ye(e)),n.j=null,n.I=!0,Ve(n,t)}function nr(t){null!=t.m&&(D.clearTimeout(t.m),t.m=null)}function rr(t,e){var n,r=null;if(t.a==e){nr(t),tr(t),t.a=null;var i=2}else{if(!In(t.b,e))return;r=e.s,An(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=x()-e.u,n=t.u,(i=de()).dispatchEvent(new we(i)),Xn(t)):Zn(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(En(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=be(j(t.Ba,t,e),ir(t,t.u)),t.u++,1}}(t,e)||2==i&&$n(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:or(t,5);break;case 4:or(t,10);break;case 3:or(t,6);break;default:or(t,2)}}function ir(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function or(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=j(t.Xa,t),r||(r=new Xe("//www.google.com/images/cleardot.gif"),D.location&&"http"==D.location.protocol||Ke(r,"https"),en(r)),n=r.toString(),r=o,o=new le,D.Image?((i=new Image).onload=M(Dn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=M(Dn,o,i,"TestLoadImage: error",!1,r),i.onabort=M(Dn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=M(Dn,o,i,"TestLoadImage: timeout",!1,r),D.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):me(2),t.v=0,t.f&&t.f.ra(e),sr(t),Wn(t)}function sr(t){t.v=0,t.I=-1,t.f&&(0==Nn(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function ur(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Xe?Ye(s):new Xe(s,void 0);return""!=a.c?(e&&Je(a,e+"."+a.c),Ze(a,a.h)):(u=D.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Xe(null,void 0),r&&Ke(u,r),i&&Je(u,i),o&&Ze(u,o),s&&(u.g=s),a=u),t.W&&Z(t.W,function(t,e){tn(a,e,t)}),e=t.A,n=t.na,e&&n&&tn(a,e,n),tn(a,"VER",t.ha),Kn(t,a),a}function ar(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new On(t.Ka)).F=t.C,e}function hr(){}function cr(){if(ot&&!(10<=Number(yt)))throw Error("Environmental error: no available transport.")}function lr(t,e){qt.call(this),this.a=new Gn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!W(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!W(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new dr(this)}function fr(t){Se.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function pr(){De.call(this),this.status=1}function dr(t){this.a=t}(N=On.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ae(this.H):Ae(Re),this.a.onreadystatechange=j(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Vn(this,t)}t=n||"";var i,o=new Qe(this.headers);r&&Ge(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=_n,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=D.FormData&&t instanceof D.FormData,0<=B(Un,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{xn(this),0<this.o&&((this.D=(i=this.a,ot&&dt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=j(this.xa,this)):this.m=te(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Vn(this,t)}},N.xa=function(){void 0!==S&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Mn(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Mn(this,!0)),On.S.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?jn(this):this.Ta())},N.Ta=function(){jn(this)},N.X=function(){try{return 2<qn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Ln(e)}},N.ua=function(){return this.h},N.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=Gn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Oe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?et(r=$(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Jn(this,n,e),tn(i=Ye(this.B),"RID",t),tn(i,"CVER",22),this.A&&tn(i,"X-HTTP-Session-Id",this.A),Kn(this,i),this.i&&r&&Fn(i,this.i,r),Tn(this.b,n),this.Ga&&tn(i,"TYPE","init"),this.da?(tn(i,"$req",e),tn(i,"SID","null"),n.V=!0,_e(n,i,null)):_e(n,i,e),this.v=2}}else 3==this.v&&(t?Yn(this,t):0==this.g.length||bn(this.b)||Yn(this))},N.Aa=function(){var t;this.j=null,er(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=be(j(this.Sa,this),t))},N.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,zn(this),er(this))},N.Ra=function(){null!=this.m&&(this.m=null,zn(this),$n(this),me(19))},N.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),me(2)):(this.c.info("Failed to ping google.com"),me(1))},(N=hr.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ha=function(){},cr.prototype.a=function(t,e){return new lr(t,e)},q(lr,qt),(N=lr.prototype).addEventListener=function(t,e,n,r){lr.S.addEventListener.call(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){lr.S.removeEventListener.call(this,t,e,n,r)},N.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;me(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=ur(t,null,t.fa),Xn(t)},N.close=function(){Qn(this.a)},N.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Hn(this.a,e)):this.g?((e={}).__data__=Bt(t),Hn(this.a,e)):Hn(this.a,t)},N.G=function(){this.a.f=null,delete this.f,Qn(this.a),delete this.a,lr.S.G.call(this)},q(fr,Se),q(pr,De),q(dr,hr),dr.prototype.ta=function(){this.a.dispatchEvent("a")},dr.prototype.sa=function(t){this.a.dispatchEvent(new fr(t))},dr.prototype.ra=function(t){this.a.dispatchEvent(new pr)},dr.prototype.qa=function(){this.a.dispatchEvent("b")},cr.prototype.createWebChannel=cr.prototype.a,lr.prototype.send=lr.prototype.Pa,lr.prototype.open=lr.prototype.Oa,Ee.NO_ERROR=0,Ee.TIMEOUT=8,Ee.HTTP_ERROR=6,Ie.COMPLETE="complete",(Ne.EventType=R).OPEN="a",R.CLOSE="b",R.ERROR="c",R.MESSAGE="d",qt.prototype.listen=qt.prototype.va,On.prototype.listenOnce=On.prototype.wa,On.prototype.getLastError=On.prototype.Qa,On.prototype.getLastErrorCode=On.prototype.ua,On.prototype.getStatus=On.prototype.X,On.prototype.getResponseJson=On.prototype.Na,On.prototype.getResponseText=On.prototype.$,On.prototype.send=On.prototype.ba;var Ie={createWebChannelTransport:function(){return new cr},ErrorCode:Ee,EventType:Ie,WebChannel:Ne,XhrIo:On},yr=Ie.createWebChannelTransport,vr=Ie.ErrorCode,gr=Ie.EventType,mr=Ie.WebChannel,wr=Ie.XhrIo,br=(Er.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Er.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Er.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Er);function Er(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Ir,Tr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ar=(n(Sr,Ir=Error),Sr),Nr="7.23.0-202096215419",Rr=new l("@firebase/firestore");function Sr(t,e){var n=this;return(n=Ir.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Dr(){return Rr.logLevel}function Lr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Rr.logLevel<=u.DEBUG&&(e=n.map(kr),Rr.debug.apply(Rr,i(["Firestore ("+Nr+"): "+t],e)))}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Rr.logLevel<=u.ERROR&&(e=n.map(kr),Rr.error.apply(Rr,i(["Firestore ("+Nr+"): "+t],e)))}function Pr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Rr.logLevel<=u.WARN&&(e=n.map(kr),Rr.warn.apply(Rr,i(["Firestore ("+Nr+"): "+t],e)))}function kr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Ur(t){void 0===t&&(t="Unexpected state");t="FIRESTORE ("+Nr+") INTERNAL ASSERTION FAILED: "+t;throw Or(t),new Error(t)}function _r(t){t||Ur()}function Vr(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Cr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function jr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Mr,xr,l=(Object.defineProperty(Hr.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),Hr.prototype.isEqual=function(t){return 0===Hr.i(this,t)},Hr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Hr?t.forEach(function(t){e.push(t)}):e.push(t),this.o(e)},Hr.prototype.limit=function(){return this.offset+this.length},Hr.prototype.u=function(t){return t=void 0===t?1:t,this.o(this.segments,this.offset+t,this.length-t)},Hr.prototype.h=function(){return this.o(this.segments,this.offset,this.length-1)},Hr.prototype.l=function(){return this.segments[this.offset]},Hr.prototype._=function(){return this.get(this.length-1)},Hr.prototype.get=function(t){return this.segments[this.offset+t]},Hr.prototype.m=function(){return 0===this.length},Hr.prototype.T=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Hr.prototype.I=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Hr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Hr.prototype.A=function(){return this.segments.slice(this.offset,this.limit())},Hr.i=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Hr),qr=(n(Wr,xr=l),Wr.prototype.o=function(t,e,n){return new Wr(t,e,n)},Wr.prototype.R=function(){return this.A().join("/")},Wr.prototype.toString=function(){return this.R()},Wr.P=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new Wr(n)},Wr.p=function(){return new Wr([])},Wr),Fr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Br=(n(zr,Mr=l),zr.prototype.o=function(t,e,n){return new zr(t,e,n)},zr.g=function(t){return Fr.test(t)},zr.prototype.R=function(){return this.A().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),zr.g(t)||(t="`"+t+"`"),t}).join(".")},zr.prototype.toString=function(){return this.R()},zr.prototype.V=function(){return 1===this.length&&"__name__"===this.get(0)},zr.v=function(){return new zr(["__name__"])},zr.S=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Ar(Tr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Ar(Tr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Ar(Tr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new zr(e)},zr.p=function(){return new zr([])},zr),Gr=(Qr.C=function(t){return new Qr(qr.P(t))},Qr.D=function(t){return new Qr(qr.P(t).u(5))},Qr.prototype.F=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Qr.prototype.isEqual=function(t){return null!==t&&0===qr.i(this.path,t.path)},Qr.prototype.toString=function(){return this.path.toString()},Qr.i=function(t,e){return qr.i(t.path,e.path)},Qr.N=function(t){return t.length%2==0},Qr.$=function(t){return new Qr(new qr(t.slice()))},Qr);function Qr(t){this.path=t}function zr(){return null!==Mr&&Mr.apply(this,arguments)||this}function Wr(){return null!==xr&&xr.apply(this,arguments)||this}function Hr(t,e,n){void 0===e?e=0:e>t.length&&Ur(),void 0===n?n=t.length-e:n>t.length-e&&Ur(),this.segments=t,this.offset=e,this.t=n}function Xr(t,e){if(0!==e.length)throw new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+fi(e.length,"argument")+".")}function Yr(t,e,n){if(e.length!==n)throw new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() requires "+fi(n,"argument")+", but was called with "+fi(e.length,"argument")+".")}function Kr(t,e,n){if(e.length<n)throw new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+fi(n,"argument")+", but was called with "+fi(e.length,"argument")+".")}function Jr(t,e,n,r){if(e.length<n||e.length>r)throw new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+fi(e.length,"argument")+".")}function Zr(t,e,n,r){ii(t,e,li(n)+" argument",r)}function $r(t,e,n,r){void 0!==r&&Zr(t,e,n,r)}function ti(t,e,n,r){ii(t,e,n+" option",r)}function ei(t,e,n,r){void 0!==r&&ti(t,e,n,r)}function ni(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(si(s))}var u=si(n);throw new Ar(Tr.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function ri(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid value "+si(r)+" provided to function "+t+"() for its "+li(n)+" argument. Acceptable values: "+e.join(", "));return r}function ii(t,e,n,r){if(!("object"===e?oi(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){r=si(r);throw new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}}function oi(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function si(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Ur();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function ui(t,e,n){if(void 0===n)throw new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+li(e)+" argument, but it was undefined.")}function ai(n,t,r){Cr(t,function(t,e){if(r.indexOf(t)<0)throw new Ar(Tr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function hi(t,e,n,r){r=si(r);return new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() requires its "+li(n)+" argument to be a "+e+", but it was: "+r)}function ci(t,e,n){if(n<=0)throw new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() requires its "+li(e)+" argument to be a positive number, but it was: "+n+".")}function li(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function fi(t,e){return t+" "+e+(1===t?"":"s")}var pi=(di.k=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},di);function di(){}function yi(t,e){return t<e?-1:e<t?1:0}function vi(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var gi=(mi.fromBase64String=function(t){return new mi(atob(t))},mi.fromUint8Array=function(t){return new mi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},mi.prototype.toBase64=function(){return t=this.O,btoa(t);var t},mi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.O)},mi.prototype.M=function(){return 2*this.O.length},mi.prototype.L=function(t){return yi(this.O,t.O)},mi.prototype.isEqual=function(t){return this.O===t.O},mi);function mi(t){this.O=t}gi.q=new gi("");var wi=(bi.fromBase64String=function(t){try{return new bi(gi.fromBase64String(t))}catch(t){throw new Ar(Tr.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},bi.fromUint8Array=function(t){return new bi(gi.fromUint8Array(t))},bi.prototype.toBase64=function(){return this.U.toBase64()},bi.prototype.toUint8Array=function(){return this.U.toUint8Array()},bi.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},bi.prototype.isEqual=function(t){return this.U.isEqual(t.U)},bi);function bi(t){this.U=t}function Ei(){if("undefined"==typeof Uint8Array)throw new Ar(Tr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Ii(){if("undefined"==typeof atob)throw new Ar(Tr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function Ti(t,e,n,r,i){this.B=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var Ai,Ni=(n(_i,Ai=wi),_i.fromBase64String=function(t){Yr("Blob.fromBase64String",arguments,1),Zr("Blob.fromBase64String","string",1,t),Ii();try{return new _i(gi.fromBase64String(t))}catch(t){throw new Ar(Tr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},_i.fromUint8Array=function(t){if(Yr("Blob.fromUint8Array",arguments,1),Ei(),!(t instanceof Uint8Array))throw hi("Blob.fromUint8Array","Uint8Array",1,t);return new _i(gi.fromUint8Array(t))},_i.prototype.toBase64=function(){return Yr("Blob.toBase64",arguments,0),Ii(),Ai.prototype.toBase64.call(this)},_i.prototype.toUint8Array=function(){return Yr("Blob.toUint8Array",arguments,0),Ei(),Ai.prototype.toUint8Array.call(this)},_i.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},_i),Ri=(Object.defineProperty(Ui.prototype,"j",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Ui.prototype.isEqual=function(t){return t instanceof Ui&&t.projectId===this.projectId&&t.database===this.database},Ui.prototype.L=function(t){return yi(this.projectId,t.projectId)||yi(this.database,t.database)},Ui),Si=(ki.prototype.get=function(t){var e=this.W(t),e=this.K[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.G(o,t))return i}},ki.prototype.has=function(t){return void 0!==this.get(t)},ki.prototype.set=function(t,e){var n=this.W(t),r=this.K[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.G(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.K[n]=[[t,e]]},ki.prototype.delete=function(t){var e=this.W(t),n=this.K[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.G(n[r][0],t))return 1===n.length?delete this.K[e]:n.splice(r,1),!0;return!1},ki.prototype.forEach=function(s){Cr(this.K,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},ki.prototype.m=function(){return jr(this.K)},ki),Di=(Pi.now=function(){return Pi.fromMillis(Date.now())},Pi.fromDate=function(t){return Pi.fromMillis(t.getTime())},Pi.fromMillis=function(t){var e=Math.floor(t/1e3);return new Pi(e,1e6*(t-1e3*e))},Pi.prototype.toDate=function(){return new Date(this.toMillis())},Pi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Pi.prototype.H=function(t){return this.seconds===t.seconds?yi(this.nanoseconds,t.nanoseconds):yi(this.seconds,t.seconds)},Pi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Pi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Pi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},Pi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Pi),Li=(Oi.Y=function(t){return new Oi(t)},Oi.min=function(){return new Oi(new Di(0,0))},Oi.prototype.L=function(t){return this.timestamp.H(t.timestamp)},Oi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Oi.prototype.J=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Oi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Oi.prototype.X=function(){return this.timestamp},Oi);function Oi(t){this.timestamp=t}function Pi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Ar(Tr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Ar(Tr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Ar(Tr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Ar(Tr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function ki(t,e){this.W=t,this.G=e,this.K={}}function Ui(t,e){this.projectId=t,this.database=e||"(default)"}function _i(){return null!==Ai&&Ai.apply(this,arguments)||this}function Vi(t){return null==t}function Ci(t){return 0===t&&1/t==-1/0}var ji=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Z=null};function Mi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new ji(t,e,n,r,i,o,s)}function xi(t){var e=t;return null===e.Z&&(t=e.path.R(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.R()+t.op.toString()+xo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.R()+t.dir}).join(","),Vi(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=aa(e.startAt)),e.endAt&&(t+="|ub:",t+=aa(e.endAt)),e.Z=t),e.Z}function qi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Vo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ca(t.startAt,e.startAt)&&ca(t.endAt,e.endAt)}function Fi(t){return Gr.N(t.path)&&null===t.collectionGroup&&0===t.filters.length}function Bi(t){this.count=t}var Gi,Qi=(zi.prototype.nt=function(t){return new zi(this.target,this.targetId,this.tt,t,this.et,this.lastLimboFreeSnapshotVersion,this.resumeToken)},zi.prototype.st=function(t,e){return new zi(this.target,this.targetId,this.tt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},zi.prototype.it=function(t){return new zi(this.target,this.targetId,this.tt,this.sequenceNumber,this.et,t,this.resumeToken)},zi);function zi(t,e,n,r,i,o,s){void 0===i&&(i=Li.min()),void 0===o&&(o=Li.min()),void 0===s&&(s=gi.q),this.target=t,this.targetId=e,this.tt=n,this.sequenceNumber=r,this.et=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Wi(t){switch(t){case Tr.OK:return Ur(),0;case Tr.CANCELLED:case Tr.UNKNOWN:case Tr.DEADLINE_EXCEEDED:case Tr.RESOURCE_EXHAUSTED:case Tr.INTERNAL:case Tr.UNAVAILABLE:case Tr.UNAUTHENTICATED:return;case Tr.INVALID_ARGUMENT:case Tr.NOT_FOUND:case Tr.ALREADY_EXISTS:case Tr.PERMISSION_DENIED:case Tr.FAILED_PRECONDITION:case Tr.ABORTED:case Tr.OUT_OF_RANGE:case Tr.UNIMPLEMENTED:case Tr.DATA_LOSS:return 1;default:return Ur(),0}}function Hi(t){if(void 0===t)return Or("GRPC error has no .code"),Tr.UNKNOWN;switch(t){case Gi.OK:return Tr.OK;case Gi.CANCELLED:return Tr.CANCELLED;case Gi.UNKNOWN:return Tr.UNKNOWN;case Gi.DEADLINE_EXCEEDED:return Tr.DEADLINE_EXCEEDED;case Gi.RESOURCE_EXHAUSTED:return Tr.RESOURCE_EXHAUSTED;case Gi.INTERNAL:return Tr.INTERNAL;case Gi.UNAVAILABLE:return Tr.UNAVAILABLE;case Gi.UNAUTHENTICATED:return Tr.UNAUTHENTICATED;case Gi.INVALID_ARGUMENT:return Tr.INVALID_ARGUMENT;case Gi.NOT_FOUND:return Tr.NOT_FOUND;case Gi.ALREADY_EXISTS:return Tr.ALREADY_EXISTS;case Gi.PERMISSION_DENIED:return Tr.PERMISSION_DENIED;case Gi.FAILED_PRECONDITION:return Tr.FAILED_PRECONDITION;case Gi.ABORTED:return Tr.ABORTED;case Gi.OUT_OF_RANGE:return Tr.OUT_OF_RANGE;case Gi.UNIMPLEMENTED:return Tr.UNIMPLEMENTED;case Gi.DATA_LOSS:return Tr.DATA_LOSS;default:return Ur()}}(l=Gi=Gi||{})[l.OK=0]="OK",l[l.CANCELLED=1]="CANCELLED",l[l.UNKNOWN=2]="UNKNOWN",l[l.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",l[l.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",l[l.NOT_FOUND=5]="NOT_FOUND",l[l.ALREADY_EXISTS=6]="ALREADY_EXISTS",l[l.PERMISSION_DENIED=7]="PERMISSION_DENIED",l[l.UNAUTHENTICATED=16]="UNAUTHENTICATED",l[l.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",l[l.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",l[l.ABORTED=10]="ABORTED",l[l.OUT_OF_RANGE=11]="OUT_OF_RANGE",l[l.UNIMPLEMENTED=12]="UNIMPLEMENTED",l[l.INTERNAL=13]="INTERNAL",l[l.UNAVAILABLE=14]="UNAVAILABLE",l[l.DATA_LOSS=15]="DATA_LOSS";var Xi=($i.prototype.rt=function(t,e){return new $i(this.i,this.root.rt(t,e,this.i).copy(null,null,Ki.ot,null,null))},$i.prototype.remove=function(t){return new $i(this.i,this.root.remove(t,this.i).copy(null,null,Ki.ot,null,null))},$i.prototype.get=function(t){for(var e=this.root;!e.m();){var n=this.i(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},$i.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.m();){var r=this.i(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},$i.prototype.m=function(){return this.root.m()},Object.defineProperty($i.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),$i.prototype.ut=function(){return this.root.ut()},$i.prototype.ct=function(){return this.root.ct()},$i.prototype.at=function(t){return this.root.at(t)},$i.prototype.forEach=function(n){this.at(function(t,e){return n(t,e),!1})},$i.prototype.toString=function(){var n=[];return this.at(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},$i.prototype.ht=function(t){return this.root.ht(t)},$i.prototype.lt=function(){return new Yi(this.root,null,this.i,!1)},$i.prototype._t=function(t){return new Yi(this.root,t,this.i,!1)},$i.prototype.ft=function(){return new Yi(this.root,null,this.i,!0)},$i.prototype.dt=function(t){return new Yi(this.root,t,this.i,!0)},$i),Yi=(Zi.prototype.Et=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.m();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.m();)this.Tt.push(t),t=t.left;return e},Zi.prototype.It=function(){return 0<this.Tt.length},Zi.prototype.At=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},Zi),Ki=(Ji.prototype.copy=function(t,e,n,r,i){return new Ji(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ji.prototype.m=function(){return!1},Ji.prototype.at=function(t){return this.left.at(t)||t(this.key,this.value)||this.right.at(t)},Ji.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},Ji.prototype.min=function(){return this.left.m()?this:this.left.min()},Ji.prototype.ut=function(){return this.min().key},Ji.prototype.ct=function(){return this.right.m()?this.key:this.right.ct()},Ji.prototype.rt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.rt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.rt(t,e,n))).Rt()},Ji.prototype.yt=function(){if(this.left.m())return Ji.EMPTY;var t=this;return t.left.Pt()||t.left.left.Pt()||(t=t.gt()),(t=t.copy(null,null,null,t.left.yt(),null)).Rt()},Ji.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.m()||r.left.Pt()||r.left.left.Pt()||(r=r.gt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Pt()&&(r=r.Vt()),r.right.m()||r.right.Pt()||r.right.left.Pt()||(r=r.vt()),0===e(t,r.key)){if(r.right.m())return Ji.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.yt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Rt()},Ji.prototype.Pt=function(){return this.color},Ji.prototype.Rt=function(){var t=this;return t.right.Pt()&&!t.left.Pt()&&(t=t.bt()),t.left.Pt()&&t.left.left.Pt()&&(t=t.Vt()),t.left.Pt()&&t.right.Pt()&&(t=t.St()),t},Ji.prototype.gt=function(){var t=this.St();return t.right.left.Pt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Vt())).bt()).St()),t},Ji.prototype.vt=function(){var t=this.St();return t.left.left.Pt()&&(t=(t=t.Vt()).St()),t},Ji.prototype.bt=function(){var t=this.copy(null,null,Ji.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Ji.prototype.Vt=function(){var t=this.copy(null,null,Ji.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Ji.prototype.St=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Ji.prototype.Ct=function(){var t=this.Dt();return Math.pow(2,t)<=this.size+1},Ji.prototype.Dt=function(){if(this.Pt()&&this.left.Pt())throw Ur();if(this.right.Pt())throw Ur();var t=this.left.Dt();if(t!==this.right.Dt())throw Ur();return t+(this.Pt()?0:1)},Ji);function Ji(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Ji.RED,this.left=null!=r?r:Ji.EMPTY,this.right=null!=i?i:Ji.EMPTY,this.size=this.left.size+1+this.right.size}function Zi(t,e,n,r){this.wt=r,this.Tt=[];for(var i=1;!t.m();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.wt?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.wt?t.right:t.left}}function $i(t,e){this.i=t,this.root=e||Ki.EMPTY}function to(){this.size=0}Ki.EMPTY=null,Ki.RED=!0,Ki.ot=!1,Ki.EMPTY=(Object.defineProperty(to.prototype,"key",{get:function(){throw Ur()},enumerable:!1,configurable:!0}),Object.defineProperty(to.prototype,"value",{get:function(){throw Ur()},enumerable:!1,configurable:!0}),Object.defineProperty(to.prototype,"color",{get:function(){throw Ur()},enumerable:!1,configurable:!0}),Object.defineProperty(to.prototype,"left",{get:function(){throw Ur()},enumerable:!1,configurable:!0}),Object.defineProperty(to.prototype,"right",{get:function(){throw Ur()},enumerable:!1,configurable:!0}),to.prototype.copy=function(t,e,n,r,i){return this},to.prototype.rt=function(t,e,n){return new Ki(t,e)},to.prototype.remove=function(t,e){return this},to.prototype.m=function(){return!0},to.prototype.at=function(t){return!1},to.prototype.ht=function(t){return!1},to.prototype.ut=function(){return null},to.prototype.ct=function(){return null},to.prototype.Pt=function(){return!1},to.prototype.Ct=function(){return!0},to.prototype.Dt=function(){return 0},new to);var eo=(oo.prototype.has=function(t){return null!==this.data.get(t)},oo.prototype.first=function(){return this.data.ut()},oo.prototype.last=function(){return this.data.ct()},Object.defineProperty(oo.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),oo.prototype.indexOf=function(t){return this.data.indexOf(t)},oo.prototype.forEach=function(n){this.data.at(function(t,e){return n(t),!1})},oo.prototype.Ft=function(t,e){for(var n=this.data._t(t[0]);n.It();){var r=n.Et();if(0<=this.i(r.key,t[1]))return;e(r.key)}},oo.prototype.Nt=function(t,e){for(var n=void 0!==e?this.data._t(e):this.data.lt();n.It();)if(!t(n.Et().key))return},oo.prototype.$t=function(t){t=this.data._t(t);return t.It()?t.Et().key:null},oo.prototype.lt=function(){return new no(this.data.lt())},oo.prototype._t=function(t){return new no(this.data._t(t))},oo.prototype.add=function(t){return this.copy(this.data.remove(t).rt(t,!0))},oo.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},oo.prototype.m=function(){return this.data.m()},oo.prototype.kt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},oo.prototype.isEqual=function(t){if(!(t instanceof oo))return!1;if(this.size!==t.size)return!1;for(var e=this.data.lt(),n=t.data.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(0!==this.i(r,i))return!1}return!0},oo.prototype.A=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},oo.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},oo.prototype.copy=function(t){var e=new oo(this.i);return e.data=t,e},oo),no=(io.prototype.Et=function(){return this.xt.Et().key},io.prototype.It=function(){return this.xt.It()},io),ro=new Xi(Gr.i);function io(t){this.xt=t}function oo(t){this.i=t,this.data=new Xi(this.i)}var so=new Xi(Gr.i);var uo=new Xi(Gr.i),ao=new eo(Gr.i);function ho(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=ao,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var co=new eo(yi);var lo=(Do.Lt=function(t){return new Do(t.i)},Do.prototype.has=function(t){return null!=this.Ot.get(t)},Do.prototype.get=function(t){return this.Ot.get(t)},Do.prototype.first=function(){return this.Mt.ut()},Do.prototype.last=function(){return this.Mt.ct()},Do.prototype.m=function(){return this.Mt.m()},Do.prototype.indexOf=function(t){t=this.Ot.get(t);return t?this.Mt.indexOf(t):-1},Object.defineProperty(Do.prototype,"size",{get:function(){return this.Mt.size},enumerable:!1,configurable:!0}),Do.prototype.forEach=function(n){this.Mt.at(function(t,e){return n(t),!1})},Do.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ot.rt(t.key,t),e.Mt.rt(t,null))},Do.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ot.remove(t),this.Mt.remove(e)):this},Do.prototype.isEqual=function(t){if(!(t instanceof Do))return!1;if(this.size!==t.size)return!1;for(var e=this.Mt.lt(),n=t.Mt.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(!r.isEqual(i))return!1}return!0},Do.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Do.prototype.copy=function(t,e){var n=new Do;return n.i=this.i,n.Ot=t,n.Mt=e,n},Do),fo=(So.prototype.track=function(t){var e=t.doc.key,n=this.qt.get(e);!n||0!==t.type&&3===n.type?this.qt=this.qt.rt(e,t):3===t.type&&1!==n.type?this.qt=this.qt.rt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.qt=this.qt.rt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.qt=this.qt.rt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.qt=this.qt.remove(e):1===t.type&&2===n.type?this.qt=this.qt.rt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.qt=this.qt.rt(e,{type:2,doc:t.doc}):Ur()},So.prototype.Ut=function(){var n=[];return this.qt.at(function(t,e){n.push(e)}),n},So),po=(Ro.Gt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Ro(t,e,lo.Lt(e),i,n,r,!0,!1)},Object.defineProperty(Ro.prototype,"hasPendingWrites",{get:function(){return!this.Qt.m()},enumerable:!1,configurable:!0}),Ro.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.jt===t.jt&&this.Qt.isEqual(t.Qt)&&Pu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Bt.isEqual(t.Bt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Ro),yo=(No.Jt=function(t,e){var n=new Map;return n.set(t,vo.Xt(t,e)),new No(Li.min(),n,co,ro,ho())},No),vo=(Ao.Xt=function(t,e){return new Ao(gi.q,e,ho(),ho(),ho())},Ao),go=function(t,e,n,r){this.se=t,this.removedTargetIds=e,this.key=n,this.ie=r},mo=function(t,e){this.targetId=t,this.re=e},wo=function(t,e,n,r){void 0===n&&(n=gi.q),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},bo=(Object.defineProperty(To.prototype,"Zt",{get:function(){return this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(To.prototype,"resumeToken",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(To.prototype,"le",{get:function(){return 0!==this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(To.prototype,"_e",{get:function(){return this.he},enumerable:!1,configurable:!0}),To.prototype.fe=function(t){0<t.M()&&(this.he=!0,this.ce=t)},To.prototype.de=function(){var n=ho(),r=ho(),i=ho();return this.ue.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Ur()}}),new vo(this.ce,this.ae,n,r,i)},To.prototype.we=function(){this.he=!1,this.ue=Oo()},To.prototype.me=function(t,e){this.he=!0,this.ue=this.ue.rt(t,e)},To.prototype.Te=function(t){this.he=!0,this.ue=this.ue.remove(t)},To.prototype.Ee=function(){this.oe+=1},To.prototype.Ie=function(){--this.oe},To.prototype.Ae=function(){this.he=!0,this.ae=!0},To),Eo=(Io.prototype.Ve=function(t){for(var e=0,n=t.se;e<n.length;e++){var r=n[e];t.ie instanceof pu?this.ve(r,t.ie):t.ie instanceof du&&this.be(r,t.key,t.ie)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.be(s,t.key,t.ie)}},Io.prototype.Se=function(n){var r=this;this.Ce(n,function(t){var e=r.De(t);switch(n.state){case 0:r.Fe(t)&&e.fe(n.resumeToken);break;case 1:e.Ie(),e.le||e.we(),e.fe(n.resumeToken);break;case 2:e.Ie(),e.le||r.removeTarget(t);break;case 3:r.Fe(t)&&(e.Ae(),e.fe(n.resumeToken));break;case 4:r.Fe(t)&&(r.Ne(t),e.fe(n.resumeToken));break;default:Ur()}})},Io.prototype.Ce=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ye.forEach(function(t,e){r.Fe(e)&&n(e)})},Io.prototype.$e=function(t){var e=t.targetId,n=t.re.count,t=this.ke(e);t&&(Fi(t=t.target)?0===n?(t=new Gr(t.path),this.be(e,t,new du(t,Li.min()))):_r(1===n):this.xe(e)!==n&&(this.Ne(e),this.ge=this.ge.add(e)))},Io.prototype.Oe=function(r){var i=this,o=new Map;this.ye.forEach(function(t,e){var n=i.ke(e);n&&(t.Zt&&Fi(n.target)&&(n=new Gr(n.target.path),null!==i.Pe.get(n)||i.Me(e,n)||i.be(e,n,new du(n,r))),t._e&&(o.set(e,t.de()),t.we()))});var s=ho();this.pe.forEach(function(t,e){var n=!0;e.Nt(function(t){t=i.ke(t);return!t||2===t.tt||(n=!1)}),n&&(s=s.add(t))});var t=new yo(r,o,this.ge,this.Pe,s);return this.Pe=ro,this.pe=Lo(),this.ge=new eo(yi),t},Io.prototype.ve=function(t,e){var n;this.Fe(t)&&(n=this.Me(t,e.key)?2:0,this.De(t).me(e.key,n),this.Pe=this.Pe.rt(e.key,e),this.pe=this.pe.rt(e.key,this.Le(e.key).add(t)))},Io.prototype.be=function(t,e,n){var r;this.Fe(t)&&(r=this.De(t),this.Me(t,e)?r.me(e,1):r.Te(e),this.pe=this.pe.rt(e,this.Le(e).delete(t)),n&&(this.Pe=this.Pe.rt(e,n)))},Io.prototype.removeTarget=function(t){this.ye.delete(t)},Io.prototype.xe=function(t){var e=this.De(t).de();return this.Re.qe(t).size+e.te.size-e.ne.size},Io.prototype.Ee=function(t){this.De(t).Ee()},Io.prototype.De=function(t){var e=this.ye.get(t);return e||(e=new bo,this.ye.set(t,e)),e},Io.prototype.Le=function(t){var e=this.pe.get(t);return e||(e=new eo(yi),this.pe=this.pe.rt(t,e)),e},Io.prototype.Fe=function(t){var e=null!==this.ke(t);return e||Lr("WatchChangeAggregator","Detected inactive target",t),e},Io.prototype.ke=function(t){var e=this.ye.get(t);return e&&e.le?null:this.Re.Ue(t)},Io.prototype.Ne=function(e){var n=this;this.ye.set(e,new bo),this.Re.qe(e).forEach(function(t){n.be(e,t,null)})},Io.prototype.Me=function(t,e){return this.Re.qe(t).has(e)},Io);function Io(t){this.Re=t,this.ye=new Map,this.Pe=ro,this.pe=Lo(),this.ge=new eo(yi)}function To(){this.oe=0,this.ue=Oo(),this.ce=gi.q,this.ae=!1,this.he=!0}function Ao(t,e,n,r,i){this.resumeToken=t,this.Zt=e,this.te=n,this.ee=r,this.ne=i}function No(t,e,n,r,i){this.et=t,this.zt=e,this.Kt=n,this.Ht=r,this.Yt=i}function Ro(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Bt=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.jt=s,this.Wt=u}function So(){this.qt=new Xi(Gr.i)}function Do(n){this.i=n?function(t,e){return n(t,e)||Gr.i(t.key,e.key)}:function(t,e){return Gr.i(t.key,e.key)},this.Ot=so,this.Mt=new Xi(this.i)}function Lo(){return new Xi(Gr.i)}function Oo(){return new Xi(Gr.i)}function Po(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function ko(t){t=qo(t.mapValue.fields.__local_write_time__.timestampValue);return new Di(t.seconds,t.nanos)}var Uo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function _o(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Po(t)?4:10:Ur()}function Vo(r,i){var t,e=_o(r);if(e!==_o(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return ko(r).isEqual(ko(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=qo(r.timestampValue),t=qo(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Bo(r.bytesValue).isEqual(Bo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Fo((t=r).geoPointValue.latitude)===Fo(e.geoPointValue.latitude)&&Fo(t.geoPointValue.longitude)===Fo(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Fo(t.integerValue)===Fo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=Fo(t.doubleValue),e=Fo(e.doubleValue);return t===e?Ci(t)===Ci(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return vi(r.arrayValue.values||[],i.arrayValue.values||[],Vo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Vr(e)!==Vr(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Vo(e[t],n[t])))return!1;return!0}();default:return Ur()}}function Co(t,e){return void 0!==(t.values||[]).find(function(t){return Vo(t,e)})}function jo(t,e){var n,r,i=_o(t),o=_o(e);if(i!==o)return yi(i,o);switch(i){case 0:return 0;case 1:return yi(t.booleanValue,e.booleanValue);case 2:return n=e,r=Fo(t.integerValue||t.doubleValue),n=Fo(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return Mo(t.timestampValue,e.timestampValue);case 4:return Mo(ko(t),ko(e));case 5:return yi(t.stringValue,e.stringValue);case 6:return function(t,e){t=Bo(t),e=Bo(e);return t.L(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=yi(n[i],r[i]);if(0!==o)return o}return yi(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=yi(Fo(i.latitude),Fo(r.latitude)))?n:yi(Fo(i.longitude),Fo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=jo(n[i],r[i]);if(o)return o}return yi(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=yi(r[s],o[s]);if(0!==u)return u;u=jo(n[r[s]],i[o[s]]);if(0!==u)return u}return yi(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Ur()}}function Mo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return yi(t,e);var n=qo(t),t=qo(e),e=yi(n.seconds,t.seconds);return 0!==e?e:yi(n.nanos,t.nanos)}function xo(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=qo(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Bo(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,Gr.D(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):Ur();var e}(t)}function qo(t){if(_r(!!t),"string"!=typeof t)return{seconds:Fo(t.seconds),nanos:Fo(t.nanos)};var e=0,n=Uo.exec(t);_r(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Fo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Bo(t){return"string"==typeof t?gi.fromBase64String(t):gi.fromUint8Array(t)}function Go(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.R()}}function Qo(t){return t&&"integerValue"in t}function zo(t){return!!t&&"arrayValue"in t}function Wo(t){return t&&"nullValue"in t}function Ho(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Xo(t){return t&&"mapValue"in t}var Yo={asc:"ASCENDING",desc:"DESCENDING"},Ko={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Jo=function(t,e){this.B=t,this.Be=e};function Zo(t){return{integerValue:""+t}}function $o(t,e){if(t.Be){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ci(e)?"-0":e}}function ts(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!Ci(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Zo(e):$o(t,e);var n}function es(t,e){return t.Be?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function ns(t,e){return t.Be?e.toBase64():e.toUint8Array()}function rs(t){return _r(!!t),Li.Y((t=qo(t),new Di(t.seconds,t.nanos)))}function is(t,e){return new qr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).R()}function os(t,e){return is(t.B,e.path)}function ss(t,e){_r(ds(e=qr.P(e)));return _r(e.get(1)===t.B.projectId),_r(!e.get(3)&&!t.B.database||e.get(3)===t.B.database),new Gr((_r(4<(e=e).length&&"documents"===e.get(4)),e.u(5)))}function us(t,e){return is(t.B,e)}function as(t){return new qr(["projects",t.B.projectId,"databases",t.B.database]).R()}function hs(t,e,n){return{name:os(t,e),fields:n.proto.mapValue.fields}}function cs(t,e){var n,r,i;if(e instanceof zs)n={update:hs(t,e.key,e.value)};else if(e instanceof nu)n={delete:os(t,e.key)};else if(e instanceof Ws)n={update:hs(t,e.key,e.data),updateMask:(i=e.Qe,r=[],i.fields.forEach(function(t){return r.push(t.R())}),{fieldPaths:r})};else if(e instanceof Js)n={transform:{document:os(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof ms)return{fieldPath:t.field.R(),setToServerValue:"REQUEST_TIME"};if(e instanceof ws)return{fieldPath:t.field.R(),appendMissingElements:{values:e.elements}};if(e instanceof As)return{fieldPath:t.field.R(),removeAllFromArray:{values:e.elements}};if(e instanceof Ds)return{fieldPath:t.field.R(),increment:e.je};throw Ur()})}};else{if(!(e instanceof ru))return Ur();n={verify:os(t,e.key)}}return e.Ge.We||(n.currentDocument=void 0!==(i=e.Ge).updateTime?{updateTime:(e=t,t=i.updateTime,es(e,t.X()))}:void 0!==i.exists?{exists:i.exists}:Ur()),n}function ls(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=us(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=us(t,r.h()),n.structuredQuery.from=[{collectionId:r._()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(Ho(t.value))return{unaryFilter:{field:ps(t.field),op:"IS_NAN"}};if(Wo(t.value))return{unaryFilter:{field:ps(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Ho(t.value))return{unaryFilter:{field:ps(t.field),op:"IS_NOT_NAN"}};if(Wo(t.value))return{unaryFilter:{field:ps(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ps(t.field),op:(e=t.op,Ko[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:ps((t=t).field),direction:(t=t.dir,Yo[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.Be||Vi(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=fs(e.startAt)),e.endAt&&(n.structuredQuery.endAt=fs(e.endAt)),n}function fs(t){return{before:t.before,values:t.position}}function ps(t){return{fieldPath:t.R()}}function ds(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}l=function(){this.ze=void 0};function ys(t,e){return t instanceof Ds?Qo(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var vs,gs,ms=(n(Es,gs=l),Es),ws=(n(bs,vs=l),bs);function bs(t){var e=this;return(e=vs.call(this)||this).elements=t,e}function Es(){return null!==gs&&gs.apply(this,arguments)||this}function Is(t,e){for(var n=Ps(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Vo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var Ts,As=(n(Ns,Ts=l),Ns);function Ns(t){var e=this;return(e=Ts.call(this)||this).elements=t,e}function Rs(t,e){for(var n=Ps(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Vo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var Ss,Ds=(n(Ls,Ss=l),Ls);function Ls(t,e){var n=this;return(n=Ss.call(this)||this).serializer=t,n.je=e,n}function Os(t){return Fo(t.integerValue||t.doubleValue)}function Ps(t){return zo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function ks(t,e){this.field=t,this.transform=e}var Us=(_s.prototype.Ke=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].T(t))return!0;return!1},_s.prototype.isEqual=function(t){return vi(this.fields,t.fields,function(t,e){return t.isEqual(e)})},_s);function _s(t){(this.fields=t).sort(Br.i)}function Vs(t,e){this.version=t,this.transformResults=e}var Cs=(js.He=function(){return new js},js.exists=function(t){return new js(void 0,t)},js.updateTime=function(t){return new js(t)},Object.defineProperty(js.prototype,"We",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),js.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},js);function js(t,e){this.updateTime=t,this.exists=e}function Ms(t,e){return void 0!==t.updateTime?e instanceof pu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof pu}l=function(){};function xs(t,e,n){return t instanceof zs?new pu(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof Ws?function(t,e,n){if(!Ms(t.Ge,e))return new yu(t.key,n.version);e=Ys(t,e);return new pu(t.key,n.version,e,{hasCommittedMutations:!0})}(t,e,n):t instanceof Js?function(t,e,n){if(_r(null!=n.transformResults),!Ms(t.Ge,e))return new yu(t.key,n.version);var r=e,e=function(t,e,n){var r=[];_r(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof pu&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof ws?Is(o,s):o instanceof As?Rs(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=$s(t,r.data(),e);return new pu(t.key,n,e,{hasCommittedMutations:!0})}(t,e,n):new du(t.key,n.version,{hasCommittedMutations:!0})}function qs(t,e,n,r){return t instanceof zs?function(t,e){if(!Ms(t.Ge,e))return e;e=Bs(e);return new pu(t.key,e,t.value,{Ye:!0})}(t,e):t instanceof Ws?function(t,e){if(!Ms(t.Ge,e))return e;var n=Bs(e),e=Ys(t,e);return new pu(t.key,n,e,{Ye:!0})}(t,e):t instanceof Js?function(t,e,n,r){if(!Ms(t.Ge,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],h=a.transform,c=null;n instanceof pu&&(c=n.field(a.field)),null===c&&r instanceof pu&&(c=r.field(a.field)),o.push((i=c,a=e,c=void 0,(h=h)instanceof ms?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(c.fields.__previous_value__=i),{mapValue:c}):h instanceof ws?Is(h,i):h instanceof As?Rs(h,i):(h=ys(c=h,i),i=Os(h)+Os(c.je),Qo(h)&&Qo(c.je)?Zo(i):$o(c.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=$s(t,i.data(),r);return new pu(t.key,i.version,r,{Ye:!0})}(t,e,r,n):(e=e,Ms((t=t).Ge,e)?new du(t.key,Li.min()):e)}function Fs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ge.isEqual(e.Ge)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||vi(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof ws&&e instanceof ws||t instanceof As&&e instanceof As?vi(t.elements,e.elements,Vo):t instanceof Ds&&e instanceof Ds?Vo(t.je,e.je):t instanceof ms&&e instanceof ms)}))}function Bs(t){return t instanceof pu?t.version:Li.min()}var Gs,Qs,zs=(n(Xs,Qs=l),Xs),Ws=(n(Hs,Gs=l),Hs);function Hs(t,e,n,r){var i=this;return(i=Gs.call(this)||this).key=t,i.data=e,i.Qe=n,i.Ge=r,i.type=1,i}function Xs(t,e,n){var r=this;return(r=Qs.call(this)||this).key=t,r.value=e,r.Ge=n,r.type=0,r}function Ys(t,e){return n=t,e=e instanceof pu?e.data():iu.empty(),r=new ou(e),n.Qe.fields.forEach(function(t){var e;t.m()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Je();var n,r}var Ks,Js=(n(Zs,Ks=l),Zs);function Zs(t,e){var n=this;return(n=Ks.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ge=Cs.exists(!0),n}function $s(t,e,n){for(var r=new ou(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Je()}var tu,eu,nu=(n(hu,eu=l),hu),ru=(n(au,tu=l),au),iu=(uu.empty=function(){return new uu({mapValue:{}})},uu.prototype.field=function(t){if(t.m())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Xo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t._()])||null},uu.prototype.isEqual=function(t){return Vo(this.proto,t.proto)},uu),ou=(su.prototype.set=function(t,e){return this.tn(t,e),this},su.prototype.delete=function(t){return this.tn(t,null),this},su.prototype.tn=function(t,e){for(var n=this.Ze,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===_o(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t._(),e)},su.prototype.Je=function(){var t=this.en(Br.p(),this.Ze);return null!=t?new iu(t):this.Xe},su.prototype.en=function(r,t){var i=this,o=!1,e=this.Xe.field(r),s=Xo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.en(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},su);function su(t){void 0===t&&(t=iu.empty()),this.Xe=t,this.Ze=new Map}function uu(t){this.proto=t}function au(t,e){var n=this;return(n=tu.call(this)||this).key=t,n.Ge=e,n.type=4,n}function hu(t,e){var n=this;return(n=eu.call(this)||this).key=t,n.Ge=e,n.type=3,n}var cu,lu,fu,l=function(t,e){this.key=t,this.version=e},pu=(n(wu,fu=l),wu.prototype.field=function(t){return this.nn.field(t)},wu.prototype.data=function(){return this.nn},wu.prototype.sn=function(){return this.nn.proto},wu.prototype.isEqual=function(t){return t instanceof wu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ye===t.Ye&&this.hasCommittedMutations===t.hasCommittedMutations&&this.nn.isEqual(t.nn)},wu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.nn.toString()+", {hasLocalMutations: "+this.Ye+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(wu.prototype,"hasPendingWrites",{get:function(){return this.Ye||this.hasCommittedMutations},enumerable:!1,configurable:!0}),wu),du=(n(mu,lu=l),mu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(mu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),mu.prototype.isEqual=function(t){return t instanceof mu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},mu),yu=(n(gu,cu=l),gu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(gu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),gu.prototype.isEqual=function(t){return t instanceof gu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},gu),vu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.rn=n,this.filters=r,this.limit=i,this.on=o,this.startAt=s,this.endAt=u,this.un=null,this.cn=null,this.startAt,this.endAt};function gu(){return null!==cu&&cu.apply(this,arguments)||this}function mu(t,e,n){var r=this;return(r=lu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function wu(t,e,n,r){var i=this;return(i=fu.call(this,t,e)||this).nn=n,i.Ye=!!r.Ye,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function bu(t){return new vu(t)}function Eu(t){return!Vi(t.limit)&&"F"===t.on}function Iu(t){return!Vi(t.limit)&&"L"===t.on}function Tu(t){return 0<t.rn.length?t.rn[0].field:null}function Au(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.an())return r.field}return null}function Nu(t){return null!==t.collectionGroup}function Ru(t){var e=t;if(null===e.un){e.un=[];var n=Au(e),t=Tu(e);if(null!==n&&null===t)n.V()||e.un.push(new la(n)),e.un.push(new la(Br.v(),"asc"));else{for(var r=!1,i=0,o=e.rn;i<o.length;i++){var s=o[i];e.un.push(s),s.field.V()&&(r=!0)}r||(n=0<e.rn.length?e.rn[e.rn.length-1].dir:"asc",e.un.push(new la(Br.v(),n)))}}return e.un}function Su(t){var e=t;if(!e.cn)if("F"===e.on)e.cn=Mi(e.path,e.collectionGroup,Ru(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Ru(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new la(o.field,s))}var u=e.endAt?new ra(e.endAt.position,!e.endAt.before):null,t=e.startAt?new ra(e.startAt.position,!e.startAt.before):null;e.cn=Mi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.cn}function Du(t,e,n){return new vu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Lu(t,e){return new vu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,e,t.endAt)}function Ou(t,e){return new vu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,t.startAt,e)}function Pu(t,e){return qi(Su(t),Su(e))&&t.on===e.on}function ku(t){return xi(Su(t))+"|lt:"+t.on}function Uu(t){return"Query(target="+(e=Su(t),n=e.path.R(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.R()+" "+t.op+" "+xo(t.value)}).join(", ")+"]"),Vi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.R()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+aa(e.startAt)),e.endAt&&(n+=", endAt: "+aa(e.endAt)),"Target("+n+")")+"; limitType="+t.on+")";var e,n}function _u(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.F(e.collectionGroup)&&e.path.T(n):Gr.N(e.path)?e.path.isEqual(n):e.path.I(n))&&function(t){for(var e=0,n=i.rn;e<n.length;e++){var r=n[e];if(!r.field.V()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||ha(t.startAt,Ru(t),n))&&(!t.endAt||!ha(t.endAt,Ru(t),n)));var e,n}function Vu(u){return function(t,e){for(var n=!1,r=0,i=Ru(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.V()?Gr.i(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?jo(n,t):Ur()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return Ur()}}(o,t,e);if(0!==s)return s;n=n||o.field.V()}return 0}}var Cu,ju=(n(Mu,Cu=function(){}),Mu.create=function(t,e,n){if(t.V())return"in"===e||"not-in"===e?this.hn(t,e,n):new Bu(t,e,n);if(Wo(n)){if("=="!==e&&"!="!==e)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. Null only supports '==' and '!=' comparisons.");return new Mu(t,e,n)}if(Ho(n)){if("=="!==e&&"!="!==e)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. NaN only supports '==' and '!=' comparisons.");return new Mu(t,e,n)}return"array-contains"===e?new $u(t,n):"in"===e?new ta(t,n):"not-in"===e?new ea(t,n):"array-contains-any"===e?new na(t,n):new Mu(t,e,n)},Mu.hn=function(t,e,n){return new("in"===e?Gu:Qu)(t,n)},Mu.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this.ln(jo(t,this.value)):null!==t&&_o(this.value)===_o(t)&&this.ln(jo(t,this.value))},Mu.prototype.ln=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Ur()}},Mu.prototype.an=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Mu);function Mu(t,e,n){var r=this;return(r=Cu.call(this)||this).field=t,r.op=e,r.value=n,r}var xu,qu,Fu,Bu=(n(Hu,Fu=ju),Hu.prototype.matches=function(t){t=Gr.i(t.key,this.key);return this.ln(t)},Hu),Gu=(n(Wu,qu=ju),Wu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Wu),Qu=(n(zu,xu=ju),zu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},zu);function zu(t,e){var n=this;return(n=xu.call(this,t,"not-in",e)||this).keys=Xu(0,e),n}function Wu(t,e){var n=this;return(n=qu.call(this,t,"in",e)||this).keys=Xu(0,e),n}function Hu(t,e,n){var r=this;return(r=Fu.call(this,t,e,n)||this).key=Gr.D(n.referenceValue),r}function Xu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return Gr.D(t.referenceValue)})}var Yu,Ku,Ju,Zu,$u=(n(ua,Zu=ju),ua.prototype.matches=function(t){t=t.field(this.field);return zo(t)&&Co(t.arrayValue,this.value)},ua),ta=(n(sa,Ju=ju),sa.prototype.matches=function(t){t=t.field(this.field);return null!==t&&Co(this.value.arrayValue,t)},sa),ea=(n(oa,Ku=ju),oa.prototype.matches=function(t){if(Co(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!Co(this.value.arrayValue,t)},oa),na=(n(ia,Yu=ju),ia.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!zo(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return Co(e.value.arrayValue,t)})},ia),ra=function(t,e){this.position=t,this.before=e};function ia(t,e){return Yu.call(this,t,"array-contains-any",e)||this}function oa(t,e){return Ku.call(this,t,"not-in",e)||this}function sa(t,e){return Ju.call(this,t,"in",e)||this}function ua(t,e){return Zu.call(this,t,"array-contains",e)||this}function aa(t){return(t.before?"b":"a")+":"+t.position.map(xo).join(",")}function ha(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.V()?Gr.i(Gr.D(s.referenceValue),n.key):jo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function ca(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Vo(t.position[n],e.position[n]))return!1;return!0}var la=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function fa(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var pa=(va.prototype.reset=function(){this.Tn=0},va.prototype.An=function(){this.Tn=this.mn},va.prototype.Rn=function(t){var e=this;this.cancel();var n=Math.floor(this.Tn+this.yn()),r=Math.max(0,Date.now()-this.In),i=Math.max(0,n-r);0<i&&Lr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Tn+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.En=this._n.Pn(this.fn,i,function(){return e.In=Date.now(),t()}),this.Tn*=this.wn,this.Tn<this.dn&&(this.Tn=this.dn),this.Tn>this.mn&&(this.Tn=this.mn)},va.prototype.pn=function(){null!==this.En&&(this.En.gn(),this.En=null)},va.prototype.cancel=function(){null!==this.En&&(this.En.cancel(),this.En=null)},va.prototype.yn=function(){return(Math.random()-.5)*this.Tn},va),da=(ya.prototype.catch=function(t){return this.next(void 0,t)},ya.prototype.next=function(r,i){var o=this;return this.Sn&&Ur(),this.Sn=!0,this.bn?this.error?this.Cn(i,this.error):this.Dn(r,this.result):new ya(function(e,n){o.Vn=function(t){o.Dn(r,t).next(e,n)},o.vn=function(t){o.Cn(i,t).next(e,n)}})},ya.prototype.Fn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ya.prototype.Nn=function(t){try{var e=t();return e instanceof ya?e:ya.resolve(e)}catch(t){return ya.reject(t)}},ya.prototype.Dn=function(t,e){return t?this.Nn(function(){return t(e)}):ya.resolve(e)},ya.prototype.Cn=function(t,e){return t?this.Nn(function(){return t(e)}):ya.reject(e)},ya.resolve=function(n){return new ya(function(t,e){t(n)})},ya.reject=function(n){return new ya(function(t,e){e(n)})},ya.$n=function(t){return new ya(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ya.kn=function(t){for(var n=ya.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?ya.resolve(t):e()})}(r[e]);return n},ya.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.$n(i)},ya);function ya(t){var e=this;this.Vn=null,this.vn=null,this.result=void 0,this.error=void 0,this.bn=!1,this.Sn=!1,t(function(t){e.bn=!0,e.result=t,e.Vn&&e.Vn(t)},function(t){e.bn=!0,e.error=t,e.vn&&e.vn(t)})}function va(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this._n=t,this.fn=e,this.dn=n,this.wn=r,this.mn=i,this.Tn=0,this.En=null,this.In=Date.now(),this.reset()}function ga(t){return"IndexedDbTransactionError"===t.name}function ma(){return"undefined"!=typeof document?document:null}var wa=(Ia.qn=function(t,e,n,r,i){i=new Ia(t,e,Date.now()+n,r,i);return i.start(n),i},Ia.prototype.start=function(t){var e=this;this.Un=setTimeout(function(){return e.Bn()},t)},Ia.prototype.gn=function(){return this.Bn()},Ia.prototype.cancel=function(t){null!==this.Un&&(this.clearTimeout(),this.Ln.reject(new Ar(Tr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Ia.prototype.Bn=function(){var e=this;this.xn.Qn(function(){return null!==e.Un?(e.clearTimeout(),e.op().then(function(t){return e.Ln.resolve(t)})):Promise.resolve()})},Ia.prototype.clearTimeout=function(){null!==this.Un&&(this.Mn(this),clearTimeout(this.Un),this.Un=null)},Ia),ba=(Object.defineProperty(Ea.prototype,"Zn",{get:function(){return this.Gn},enumerable:!1,configurable:!0}),Ea.prototype.Qn=function(t){this.enqueue(t)},Ea.prototype.ts=function(t){this.es(),this.ns(t)},Ea.prototype.ss=function(){var t;this.Gn||(this.Gn=!0,(t=ma())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xn))},Ea.prototype.enqueue=function(t){return this.es(),this.Gn?new Promise(function(t){}):this.ns(t)},Ea.prototype.rs=function(t){var e=this;this.Wn.push(t),this.Qn(function(){return e.os()})},Ea.prototype.os=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Wn.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Wn[0]()];case 2:return t.sent(),this.Wn.shift(),this.Jn.reset(),[3,4];case 3:if(!ga(e=t.sent()))throw e;return Lr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Wn.length&&this.Jn.Rn(function(){return n.os()}),t.label=5;case 5:return[2]}})})},Ea.prototype.ns=function(t){var r=this,e=this.jn.then(function(){return r.Hn=!0,t().catch(function(t){throw r.Kn=t,r.Hn=!1,Or("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Hn=!1,t})});return this.jn=e},Ea.prototype.Pn=function(t,e,n){var r=this;this.es(),-1<this.Yn.indexOf(t)&&(e=0);n=wa.qn(this,t,e,n,function(t){return r.us(t)});return this.zn.push(n),n},Ea.prototype.es=function(){this.Kn&&Ur()},Ea.prototype.cs=function(){},Ea.prototype.hs=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.jn];case 1:t.sent(),t.label=2;case 2:if(e!==this.jn)return[3,0];t.label=3;case 3:return[2]}})})},Ea.prototype.ls=function(t){for(var e=0,n=this.zn;e<n.length;e++)if(n[e].fn===t)return!0;return!1},Ea.prototype._s=function(r){var i=this;return this.hs().then(function(){i.zn.sort(function(t,e){return t.On-e.On});for(var t=0,e=i.zn;t<e.length;t++){var n=e[t];if(n.gn(),"all"!==r&&n.fn===r)break}return i.hs()})},Ea.prototype.fs=function(t){this.Yn.push(t)},Ea.prototype.us=function(t){t=this.zn.indexOf(t);this.zn.splice(t,1)},Ea);function Ea(){var e=this;this.jn=Promise.resolve(),this.Wn=[],this.Gn=!1,this.zn=[],this.Kn=null,this.Hn=!1,this.Yn=[],this.Jn=new pa(this,"async_queue_retry"),this.Xn=function(){var t=ma();t&&Lr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.Jn.pn()};var t=ma();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Xn)}function Ia(t,e,n,r,i){this.xn=t,this.fn=e,this.On=n,this.op=r,this.Mn=i,this.Ln=new fa,this.then=this.Ln.promise.then.bind(this.Ln.promise),this.Ln.promise.catch(function(t){})}function Ta(t,e){if(Or("AsyncQueue",e+": "+t),ga(t))return new Ar(Tr.UNAVAILABLE,e+": "+t);throw t}function Aa(){this.ds=void 0,this.listeners=[]}function Na(){this.ws=new Si(ku,Pu),this.onlineState="Unknown",this.Ts=new Set}function Ra(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.ws.get(n))||(r=!0,i=new Aa),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Es(n)];case 2:return o.ds=t.sent(),[3,4];case 3:return o=t.sent(),o=Ta(o,"Initialization of query '"+Uu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.ws.set(n,i),i.listeners.push(u),u.Is(e.onlineState),i.ds&&u.As(i.ds)&&Da(e),[2]}})})}function Sa(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.ws.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.ws.delete(n),e.Rs(n))]:[2]})})}function Da(t){t.Ts.forEach(function(t){t.next()})}var La=(ka.prototype.As=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new po(t.query,t.docs,t.Bt,e,t.Qt,t.fromCache,t.jt,!0)}var o=!1;return this.Ps?this.gs(t)&&(this.ys.next(t),o=!0):this.Vs(t,this.onlineState)&&(this.vs(t),o=!0),this.ps=t,o},ka.prototype.onError=function(t){this.ys.error(t)},ka.prototype.Is=function(t){this.onlineState=t;var e=!1;return this.ps&&!this.Ps&&this.Vs(this.ps,t)&&(this.vs(this.ps),e=!0),e},ka.prototype.Vs=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.bs&&n||t.docs.m()&&"Offline"!==e)},ka.prototype.gs=function(t){if(0<t.docChanges.length)return!0;var e=this.ps&&this.ps.hasPendingWrites!==t.hasPendingWrites;return!(!t.jt&&!e)&&!0===this.options.includeMetadataChanges},ka.prototype.vs=function(t){t=po.Gt(t.query,t.docs,t.Qt,t.fromCache),this.Ps=!0,this.ys.next(t)},ka),Oa=(Pa.prototype.Ss=function(){return null!=this.uid},Pa.prototype.Cs=function(){return this.Ss()?"uid:"+this.uid:"anonymous-user"},Pa.prototype.isEqual=function(t){return t.uid===this.uid},Pa);function Pa(t){this.uid=t}function ka(t,e,n){this.query=t,this.ys=e,this.Ps=!1,this.ps=null,this.onlineState="Unknown",this.options=n||{}}Oa.UNAUTHENTICATED=new Oa(null),Oa.Ds=new Oa("google-credentials-uid"),Oa.Fs=new Oa("first-party-uid");var Ua=(_a.prototype.$s=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},_a.prototype.next=function(){var t=++this.previousValue;return this.ks&&this.ks(t),t},_a);function _a(t,e){var n=this;this.previousValue=t,e&&(e.Ns=function(t){return n.$s(t)},this.ks=function(t){return e.xs(t)})}Ua.Os=-1;var Va=(Xa.prototype.Ms=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Xa.prototype.Ls=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Xa.prototype.qs=function(){var t={activeTargetIds:this.activeTargetIds.A(),updateTimeMs:Date.now()};return JSON.stringify(t)},Xa),Ca=(Ha.prototype.js=function(t){},Ha.prototype.Ws=function(t,e,n){},Ha.prototype.Gs=function(t){return this.Us.Ms(t),this.Bs[t]||"not-current"},Ha.prototype.zs=function(t,e,n){this.Bs[t]=e},Ha.prototype.Ks=function(t){this.Us.Ls(t)},Ha.prototype.Hs=function(t){return this.Us.activeTargetIds.has(t)},Ha.prototype.Ys=function(t){delete this.Bs[t]},Ha.prototype.Js=function(){return this.Us.activeTargetIds},Ha.prototype.Xs=function(t){return this.Us.activeTargetIds.has(t)},Ha.prototype.start=function(){return this.Us=new Va,Promise.resolve()},Ha.prototype.Zs=function(t,e,n){},Ha.prototype.ti=function(t){},Ha.prototype.ei=function(){},Ha.prototype.xs=function(t){},Ha),ja=(Wa.prototype.si=function(t,e,n){for(var r=n.ii,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=xs(o,e,r[i]))}return e},Wa.prototype.ri=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=qs(i,e,e,this.ni))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=qs(a,e,o,this.ni))}return e},Wa.prototype.oi=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ri(t.key,n.get(t.key));e&&(i=i.rt(t.key,e))}),i},Wa.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},ho())},Wa.prototype.isEqual=function(t){return this.batchId===t.batchId&&vi(this.mutations,t.mutations,Fs)&&vi(this.baseMutations,t.baseMutations,Fs)},Wa),Ma=(za.from=function(t,e,n){_r(t.mutations.length===n.length);for(var r=uo,i=t.mutations,o=0;o<i.length;o++)r=r.rt(i[o].key,n[o].version);return new za(t,e,n,r)},za),xa=(Qa.prototype._i=function(e,n){var r=this;return this.hi.fi(e,n).next(function(t){return r.di(e,n,t)})},Qa.prototype.di=function(t,r,i){return this.ai.wi(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ri(r,t);return t})},Qa.prototype.mi=function(t,e,i){var o=ro;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ri(t,e);o=o.rt(t,e)}),o},Qa.prototype.Ti=function(e,t){var n=this;return this.ai.getEntries(e,t).next(function(t){return n.Ei(e,t)})},Qa.prototype.Ei=function(e,r){var i=this;return this.hi.Ii(e,r).next(function(t){var t=i.mi(e,r,t),n=ro;return t.forEach(function(t,e){e=e||new du(t,Li.min()),n=n.rt(t,e)}),n})},Qa.prototype.Ai=function(t,e,n){return r=e,Gr.N(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Ri(t,e.path):Nu(e)?this.yi(t,e,n):this.Pi(t,e,n);var r},Qa.prototype.Ri=function(t,e){return this._i(t,new Gr(e)).next(function(t){var e=so;return t instanceof pu&&(e=e.rt(t.key,t)),e})},Qa.prototype.yi=function(n,r,i){var o=this,s=r.collectionGroup,u=so;return this.li.pi(n,s).next(function(t){return da.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new vu(t,null,e.rn.slice(),e.filters.slice(),e.limit,e.on,e.startAt,e.endAt));return o.Pi(n,e,i).next(function(t){t.forEach(function(t,e){u=u.rt(t,e)})})}).next(function(){return u})})},Qa.prototype.Pi=function(e,n,t){var h,c,r=this;return this.ai.Ai(e,n,t).next(function(t){return h=t,r.hi.gi(e,n)}).next(function(t){return c=t,r.Vi(e,c,h).next(function(t){h=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=h.get(u),a=qs(s,a,a,r.ni);h=a instanceof pu?h.rt(u,a):h.remove(u)}})}).next(function(){return h.forEach(function(t,e){_u(n,e)||(h=h.remove(t))}),h})},Qa.prototype.Vi=function(t,e,n){for(var r=ho(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Ws&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.ai.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof pu&&(h=h.rt(t,e))}),h})},Qa),qa=(Ga.Si=function(t,e){for(var n=ho(),r=ho(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Ga(t,e.fromCache,n,r)},Ga),Fa=(Ba.Ni=function(t){return new Ba(t,Ba.$i,Ba.ki)},Ba);function Ba(t,e,n){this.Ci=t,this.Di=e,this.Fi=n}function Ga(t,e,n,r){this.targetId=t,this.fromCache=e,this.vi=n,this.bi=r}function Qa(t,e,n){this.ai=t,this.hi=e,this.li=n}function za(t,e,n,r){this.batch=t,this.ui=e,this.ii=n,this.ci=r}function Wa(t,e,n,r){this.batchId=t,this.ni=e,this.baseMutations=n,this.mutations=r}function Ha(){this.Us=new Va,this.Bs={},this.Qs=null,this.Ns=null}function Xa(){this.activeTargetIds=co}Fa.xi=-1,Fa.Oi=1048576,Fa.Mi=41943040,Fa.$i=10,Fa.ki=1e3,Fa.Li=new Fa(Fa.Mi,Fa.$i,Fa.ki),Fa.qi=new Fa(Fa.xi,0,0);var Ya=(nh.prototype.Bi=function(t,e){return this.Ui.add(e),da.resolve()},nh.prototype.pi=function(t,e){return da.resolve(this.Ui.getEntries(e))},nh),Ka=(eh.prototype.add=function(t){var e=t._(),n=t.h(),r=this.index[e]||new eo(qr.i),t=!r.has(n);return this.index[e]=r.add(n),t},eh.prototype.has=function(t){var e=t._(),t=t.h(),e=this.index[e];return e&&e.has(t)},eh.prototype.getEntries=function(t){return(this.index[t]||new eo(qr.i)).A()},eh),Ja=(th.prototype.next=function(){return this.Qi+=2,this.Qi},th.ji=function(){return new th(0)},th.Wi=function(){return new th(-1)},th),Za=($a.prototype.ir=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.rr(t,n.zi)})},$a);function $a(t,e,n){this.persistence=t,this.Gi=e,this.zi=new Xi(yi),this.Ki=new Si(xi,qi),this.Hi=Li.min(),this.hi=t.Yi(n),this.Ji=t.Xi(),this.Zi=t.tr(),this.er=new xa(this.Ji,this.hi,this.persistence.nr()),this.Gi.sr(this.er)}function th(t){this.Qi=t}function eh(){this.index={}}function nh(){this.Ui=new Ka}function rh(t,c){var l=t;return l.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=c.batch.keys(),h=l.Ji.ur({cr:!0});return e=l,r=t,o=h,s=(i=c).batch,n=s.keys(),u=da.resolve(),n.forEach(function(n){u=u.next(function(){return o.wi(r,n)}).next(function(t){var e=t,t=i.ci.get(n);_r(null!==t),(!e||e.version.L(t)<0)&&(e=s.si(n,e,i))&&o.ar(e,i.ui)})}),u.next(function(){return e.hi.hr(r,s)}).next(function(){return h.apply(t)}).next(function(){return l.hi.lr(t)}).next(function(){return l.er.Ti(t,a)})})}function ih(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Zi._r(t)})}function oh(t,a){var h=t,c=a.et,l=h.zi;return h.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var i=h.Ji.ur({cr:!0});l=h.zi;var u=[];a.zt.forEach(function(t,e){var n,r,i,o=l.get(e);o&&(u.push(h.Zi.dr(s,t.ne,e).next(function(){return h.Zi.wr(s,t.te,e)})),0<(i=t.resumeToken).M()&&(n=o.st(i,c).nt(s.mr),l=l.rt(e,n),r=o,i=t,_r(0<(o=n).resumeToken.M()),(0===r.resumeToken.M()||3e8<=o.et.J()-r.et.J()||0<i.te.size+i.ee.size+i.ne.size)&&u.push(h.Zi.Tr(s,n))))});var t,o=ro,n=ho();return a.Ht.forEach(function(t,e){n=n.add(t)}),u.push(i.getEntries(s,n).next(function(r){a.Ht.forEach(function(t,e){var n=r.get(t);e instanceof du&&e.version.isEqual(Li.min())?(i.Er(t,c),o=o.rt(t,e)):null==n||0<e.version.L(n.version)||0===e.version.L(n.version)&&n.hasPendingWrites?(i.ar(e,c),o=o.rt(t,e)):Lr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Yt.has(t)&&u.push(h.persistence.Ar.Ir(s,t))})})),c.isEqual(Li.min())||(t=h.Zi._r(s).next(function(t){return h.Zi.Rr(s,s.mr,c)}),u.push(t)),da.$n(u).next(function(){return i.apply(s)}).next(function(){return h.er.Ei(s,o)})}).then(function(t){return h.zi=l,t})}function sh(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).zi.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Ar.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!ga(r=t.sent()))throw r;return Lr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.zi=e.zi.remove(o),e.Ki.delete(n.target),[2]}})})}function uh(t,o,s){var u=t,a=Li.min(),h=ho();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=Su(o),(void 0!==(t=(i=t).Ki.get(r))?da.resolve(i.zi.get(t)):i.Zi.Pr(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.Zi.pr(e,t.targetId).next(function(t){h=t})}).next(function(){return u.Gi.Ai(e,o,s?a:Li.min(),s?h:ho())}).next(function(t){return{documents:t,gr:h}});var t,n,r,i})}function ah(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Tr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Lr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function hh(t,e){this.user=e,this.type="OAuth",this.Ur={},this.Ur.Authorization="Bearer "+t}function ch(t,e,n,r,i){var o=this;this.Bo=t,this.Qo=e,this.xn=n,this.jo={},this.Wo=[],this.Go=new Map,this.zo=new Set,this.Ko=[],this.Ho=i,this.Ho.Yo(function(t){n.Qn(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Qh(this)?(Lr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).zo.add(4),[4,Ch(e)];case 1:return t.sent(),e.Jo.set("Unknown"),e.zo.delete(4),[4,Vh(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Jo=new Th(n,r)}var lh,fh,ph,dh=(_h.prototype.m=function(){return this.Vr.m()},_h.prototype.Cr=function(t,e){e=new yh(t,e);this.Vr=this.Vr.add(e),this.br=this.br.add(e)},_h.prototype.Dr=function(t,e){var n=this;t.forEach(function(t){return n.Cr(t,e)})},_h.prototype.Fr=function(t,e){this.Nr(new yh(t,e))},_h.prototype.$r=function(t,e){var n=this;t.forEach(function(t){return n.Fr(t,e)})},_h.prototype.kr=function(t){var e=this,n=new Gr(new qr([])),r=new yh(n,t),t=new yh(n,t+1),i=[];return this.br.Ft([r,t],function(t){e.Nr(t),i.push(t.key)}),i},_h.prototype.Or=function(){var e=this;this.Vr.forEach(function(t){return e.Nr(t)})},_h.prototype.Nr=function(t){this.Vr=this.Vr.delete(t),this.br=this.br.delete(t)},_h.prototype.Mr=function(t){var e=new Gr(new qr([])),n=new yh(e,t),t=new yh(e,t+1),r=ho();return this.br.Ft([n,t],function(t){r=r.add(t.key)}),r},_h.prototype.Lr=function(t){var e=new yh(t,0),e=this.Vr.$t(e);return null!==e&&t.isEqual(e.key)},_h),yh=(Uh.vr=function(t,e){return Gr.i(t.key,e.key)||yi(t.qr,e.qr)},Uh.Sr=function(t,e){return yi(t.qr,e.qr)||Gr.i(t.key,e.key)},Uh),vh=(kh.prototype.getToken=function(){return Promise.resolve(null)},kh.prototype.Qr=function(){},kh.prototype.jr=function(t){(this.Br=t)(Oa.UNAUTHENTICATED)},kh.prototype.Wr=function(){this.Br=null},kh),gh=(Ph.prototype.getToken=function(){var e=this,n=this.Kr,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.Kr!==n?(Lr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(_r("string"==typeof t.accessToken),new hh(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Ph.prototype.Qr=function(){this.forceRefresh=!0},Ph.prototype.jr=function(t){this.Br=t,this.zr&&t(this.currentUser)},Ph.prototype.Wr=function(){this.auth&&this.auth.removeAuthTokenListener(this.Gr),this.Gr=null,this.Br=null},Ph.prototype.Hr=function(){var t=this.auth&&this.auth.getUid();return _r(null===t||"string"==typeof t),new Oa(t)},Ph),mh=(Object.defineProperty(Oh.prototype,"Ur",{get:function(){var t={"X-Goog-AuthUser":this.Jr},e=this.Yr.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Oh),wh=(Lh.prototype.getToken=function(){return Promise.resolve(new mh(this.Yr,this.Jr))},Lh.prototype.jr=function(t){t(Oa.Fs)},Lh.prototype.Wr=function(){},Lh.prototype.Qr=function(){},Lh),l=(Dh.prototype.io=function(){return 1===this.state||2===this.state||4===this.state},Dh.prototype.ro=function(){return 2===this.state},Dh.prototype.start=function(){3!==this.state?this.auth():this.oo()},Dh.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.io()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Dh.prototype.uo=function(){this.state=0,this.Jn.reset()},Dh.prototype.co=function(){var t=this;this.ro()&&null===this.so&&(this.so=this._n.Pn(this.Xr,6e4,function(){return t.ao()}))},Dh.prototype.ho=function(t){this.lo(),this.stream.send(t)},Dh.prototype.ao=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.ro()?[2,this.close(0)]:[2]})})},Dh.prototype.lo=function(){this.so&&(this.so.cancel(),this.so=null)},Dh.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.lo(),this.Jn.cancel(),this.no++,3!==e?this.Jn.reset():n&&n.code===Tr.RESOURCE_EXHAUSTED?(Or(n.toString()),Or("Using maximum backoff delay to prevent overloading the backend."),this.Jn.An()):n&&n.code===Tr.UNAUTHENTICATED&&this.eo.Qr(),null!==this.stream&&(this._o(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.fo(n)];case 1:return t.sent(),[2]}})})},Dh.prototype._o=function(){},Dh.prototype.auth=function(){var n=this;this.state=1;var t=this.do(this.no),e=this.no;this.eo.getToken().then(function(t){n.no===e&&n.wo(t)},function(e){t(function(){var t=new Ar(Tr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.mo(t)})})},Dh.prototype.wo=function(t){var e=this,n=this.do(this.no);this.stream=this.To(t),this.stream.Eo(function(){n(function(){return e.state=2,e.listener.Eo()})}),this.stream.fo(function(t){n(function(){return e.mo(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Dh.prototype.oo=function(){var t=this;this.state=4,this.Jn.Rn(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},Dh.prototype.mo=function(t){return Lr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Dh.prototype.do=function(e){var n=this;return function(t){n._n.Qn(function(){return n.no===e?t():(Lr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Dh),bh=(n(Sh,ph=l),Sh.prototype.To=function(t){return this.Zr.Io("Listen",t)},Sh.prototype.onMessage=function(t){this.Jn.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Ur(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Be?(_r(void 0===o||"string"==typeof o),gi.fromBase64String(o||"")):(_r(void 0===o||o instanceof Uint8Array),gi.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Tr.UNKNOWN:Hi(s.code),new Ar(o,s.message||"")),r=new wo(n,r,i,s||null)}else if("documentChange"in e){e.documentChange;var u=e.documentChange;u.document,u.document.name,u.document.updateTime;var i=ss(t,u.document.name),a=rs(u.document.updateTime),s=new iu({mapValue:{fields:u.document.fields}}),a=new pu(i,a,s,{}),s=u.targetIds||[],u=u.removedTargetIds||[];r=new go(s,u,a.key,a)}else if("documentDelete"in e){e.documentDelete;u=e.documentDelete;u.document;var a=ss(t,u.document),h=u.readTime?rs(u.readTime):Li.min(),h=new du(a,h),u=u.removedTargetIds||[];r=new go([],u,h.key,h)}else if("documentRemove"in e){e.documentRemove;h=e.documentRemove;h.document;var c=ss(t,h.document),h=h.removedTargetIds||[];r=new go([],h,c,null)}else{if(!("filter"in e))return Ur();e.filter;c=e.filter;c.targetId;e=c.count||0,e=new Bi(e),c=c.targetId;r=new mo(c,e)}return r}(this.serializer,t),t=function(t){if(!("targetChange"in t))return Li.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?rs(t.readTime):Li.min()}(t);return this.listener.Ao(e,t)},Sh.prototype.Ro=function(t){var e,n,r,i={};i.database=as(this.serializer),i.addTarget=(e=this.serializer,(r=Fi(r=(n=t).target)?{documents:{documents:[us(e,r.path)]}}:{query:ls(e,r)}).targetId=n.targetId,0<n.resumeToken.M()&&(r.resumeToken=ns(e,n.resumeToken)),r);var o,t=(this.serializer,o=t,null==(t=function(){switch(o.tt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Ur()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.ho(i)},Sh.prototype.yo=function(t){var e={};e.database=as(this.serializer),e.removeTarget=t,this.ho(e)},Sh),Eh=(n(Rh,fh=l),Object.defineProperty(Rh.prototype,"po",{get:function(){return this.Po},enumerable:!1,configurable:!0}),Rh.prototype.start=function(){this.Po=!1,this.lastStreamToken=void 0,fh.prototype.start.call(this)},Rh.prototype._o=function(){this.Po&&this.Vo([])},Rh.prototype.To=function(t){return this.Zr.Io("Write",t)},Rh.prototype.onMessage=function(t){if(_r(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Po){this.Jn.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(_r(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?rs(t.updateTime):rs(e);n.isEqual(Li.min())&&(n=rs(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new Vs(n,e)}(t,r)})):[]),n=rs(t.commitTime);return this.listener.vo(n,e)}var n,r;return _r(!t.writeResults||0===t.writeResults.length),this.Po=!0,this.listener.bo()},Rh.prototype.So=function(){var t={};t.database=as(this.serializer),this.ho(t)},Rh.prototype.Vo=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return cs(e.serializer,t)})};this.ho(t)},Rh),Ih=(n(Nh,lh=function(){}),Nh.prototype.Do=function(){if(this.Co)throw new Ar(Tr.FAILED_PRECONDITION,"The client has already been terminated.")},Nh.prototype.Fo=function(e,n,r){var i=this;return this.Do(),this.credentials.getToken().then(function(t){return i.Zr.Fo(e,n,r,t)}).catch(function(t){throw t.code===Tr.UNAUTHENTICATED&&i.credentials.Qr(),t})},Nh.prototype.No=function(e,n,r){var i=this;return this.Do(),this.credentials.getToken().then(function(t){return i.Zr.No(e,n,r,t)}).catch(function(t){throw t.code===Tr.UNAUTHENTICATED&&i.credentials.Qr(),t})},Nh.prototype.terminate=function(){this.Co=!1},Nh),Th=(Ah.prototype.Oo=function(){var t=this;0===this.$o&&(this.Mo("Unknown"),this.ko=this.xn.Pn("online_state_timeout",1e4,function(){return t.ko=null,t.Lo("Backend didn't respond within 10 seconds."),t.Mo("Offline"),Promise.resolve()}))},Ah.prototype.qo=function(t){"Online"===this.state?this.Mo("Unknown"):(this.$o++,1<=this.$o&&(this.Uo(),this.Lo("Connection failed 1 times. Most recent error: "+t.toString()),this.Mo("Offline")))},Ah.prototype.set=function(t){this.Uo(),this.$o=0,"Online"===t&&(this.xo=!1),this.Mo(t)},Ah.prototype.Mo=function(t){t!==this.state&&(this.state=t,this.Qs(t))},Ah.prototype.Lo=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.xo?(Or(t),this.xo=!1):Lr("OnlineStateTracker",t)},Ah.prototype.Uo=function(){null!==this.ko&&(this.ko.cancel(),this.ko=null)},Ah);function Ah(t,e){this.xn=t,this.Qs=e,this.state="Unknown",this.$o=0,this.ko=null,this.xo=!0}function Nh(t,e,n){var r=this;return(r=lh.call(this)||this).credentials=t,r.Zr=e,r.serializer=n,r.Co=!1,r}function Rh(t,e,n,r,i){var o=this;return(o=fh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Po=!1,o}function Sh(t,e,n,r,i){var o=this;return(o=ph.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Dh(t,e,n,r,i,o){this._n=t,this.Xr=n,this.Zr=r,this.eo=i,this.listener=o,this.state=0,this.no=0,this.so=null,this.stream=null,this.Jn=new pa(t,e)}function Lh(t,e){this.Yr=t,this.Jr=e}function Oh(t,e){this.Yr=t,this.Jr=e,this.type="FirstParty",this.user=Oa.Fs}function Ph(t){var e=this;this.Gr=null,this.currentUser=Oa.UNAUTHENTICATED,this.zr=!1,this.Kr=0,this.Br=null,this.forceRefresh=!1,this.Gr=function(){e.Kr++,e.currentUser=e.Hr(),e.zr=!0,e.Br&&e.Br(e.currentUser)},this.Kr=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Gr):(this.Gr(null),t.get().then(function(t){e.auth=t,e.Gr&&e.auth.addAuthTokenListener(e.Gr)},function(){}))}function kh(){this.Br=null}function Uh(t,e){this.key=t,this.qr=e}function _h(){this.Vr=new eo(yh.vr),this.br=new eo(yh.Sr)}function Vh(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!Qh(r))return[3,4];e=0,n=r.Ko,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Ch(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.Ko,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function jh(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Lr("RemoteStore","RemoteStore shutting down."),e.zo.add(5),[4,Ch(e)];case 1:return t.sent(),e.Ho.ei(),e.Jo.set("Unknown"),[2]}})})}function Mh(t,e){t.Go.has(e.targetId)||(t.Go.set(e.targetId,e),Gh(t)?Bh(t):Zh(t).ro()&&qh(t,e))}function xh(t,e){var n=t,t=Zh(n);n.Go.delete(e),t.ro()&&Fh(n,e),0===n.Go.size&&(t.ro()?t.co():Qh(n)&&n.Jo.set("Unknown"))}function qh(t,e){t.Xo.Ee(e.targetId),Zh(t).Ro(e)}function Fh(t,e){t.Xo.Ee(e),Zh(t).yo(e)}function Bh(e){e.Xo=new Eo({qe:function(t){return e.jo.qe(t)},Ue:function(t){return e.Go.get(t)||null}}),Zh(e).start(),e.Jo.Oo()}function Gh(t){return Qh(t)&&!Zh(t).io()&&0<t.Go.size}function Qh(t){return 0===t.zo.size}function zh(t){t.Xo=void 0}function Wh(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Jo.set("Online"),!(u instanceof wo&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Go.has(i)?[4,o.jo.Zo(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Go.delete(i),o.Xo.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Lr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,Hh(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof go?s.Xo.Ve(u):u instanceof mo?s.Xo.$e(u):s.Xo.Se(u),a.isEqual(Li.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,ih(s.Bo)];case 8:return o=t.sent(),0<=a.L(o)?[4,(i=a,(e=(r=s).Xo.Oe(i)).zt.forEach(function(t,e){var n;0<t.resumeToken.M()&&((n=r.Go.get(e))&&r.Go.set(e,n.st(t.resumeToken,i)))}),e.Kt.forEach(function(t){var e=r.Go.get(t);e&&(r.Go.set(t,e.st(gi.q,e.et)),Fh(r,t),e=new Qi(e.target,t,1,e.sequenceNumber),qh(r,e))}),r.jo.tu(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Lr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,Hh(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function Hh(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!ga(r))throw r;return n.zo.add(1),[4,Ch(n)];case 1:return t.sent(),n.Jo.set("Offline"),i=i||function(){return ih(n.Bo)},n.xn.rs(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Lr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.zo.delete(1),[4,Vh(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function Xh(e,n){return n().catch(function(t){return Hh(e,t,n)})}function Yh(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=$h(i=a),s=0<i.Wo.length?i.Wo[i.Wo.length-1].batchId:-1,t.label=1;case 1:if(!(Qh(i)&&i.Wo.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.Bo,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.hi.yr(t,n)}))];case 3:return null===(u=t.sent())?(0===i.Wo.length&&o.co(),[3,7]):(s=u.batchId,function(t,e){t.Wo.push(e);t=$h(t);t.ro()&&t.po&&t.Vo(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,Hh(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Kh(i)&&Jh(i),[2]}var e,n,r})})}function Kh(t){return Qh(t)&&!$h(t).io()&&0<t.Wo.length}function Jh(t){$h(t).start()}function Zh(n){var t,e,r,i=this;return n.su||(n.su=(t=n.Qo,e=n.xn,r={Eo:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Go.forEach(function(t,e){qh(n,t)}),[2]})})}.bind(null,n),fo:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return zh(e),Gh(e)?(e.Jo.qo(n),Bh(e)):e.Jo.set("Unknown"),[2]})})}.bind(null,n),Ao:Wh.bind(null,n)},t.Do(),new bh(e,t.Zr,t.credentials,t.serializer,r)),n.Ko.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.su.uo(),Gh(n)?Bh(n):n.Jo.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.su.stop()];case 2:t.sent(),zh(n),t.label=3;case 3:return[2]}})})})),n.su}function $h(n){var t,e,r,i=this;return n.iu||(n.iu=(t=n.Qo,e=n.xn,r={Eo:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return $h(e).So(),[2]})})}.bind(null,n),fo:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&$h(e).po?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Wi(n=i.code)&&n!==Tr.ABORTED?(e=r.Wo.shift(),$h(r).uo(),[4,Xh(r,function(){return r.jo.nu(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,Yh(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Kh(e)&&Jh(e),[2]}})})}.bind(null,n),bo:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=$h(o),n=0,r=o.Wo;n<r.length;n++)i=r[n],e.Vo(i.mutations);return[2]})})}.bind(null,n),vo:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Wo.shift(),n=Ma.from(e,i,o),[4,Xh(r,function(){return r.jo.eu(n)})];case 1:return t.sent(),[4,Yh(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Do(),new Eh(e,t.Zr,t.credentials,t.serializer,r)),n.Ko.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.iu.uo(),[4,Yh(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.iu.stop()];case 3:t.sent(),0<n.Wo.length&&(Lr("RemoteStore","Stopping write stream with "+n.Wo.length+" pending writes"),n.Wo=[]),t.label=4;case 4:return[2]}})})})),n.iu}function tc(t,e,n){this.query=t,this.targetId=e,this.view=n}var ec=function(t){this.key=t},nc=function(t){this.key=t},rc=(Object.defineProperty(uc.prototype,"hu",{get:function(){return this.ru},enumerable:!1,configurable:!0}),uc.prototype.lu=function(t,e){var s=this,u=e?e._u:new fo,a=(e||this).au,h=(e||this).Qt,c=a,l=!1,f=Eu(this.query)&&a.size===this.query.limit?a.last():null,p=Iu(this.query)&&a.size===this.query.limit?a.first():null;if(t.at(function(t,e){var n=a.get(t),r=(r=e instanceof pu?e:null)&&(_u(s.query,r)?r:null),i=!!n&&s.Qt.has(n.key),o=!!r&&(r.Ye||s.Qt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.fu(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.cu(r,f)||p&&s.cu(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(h=r?(c=c.add(r),o?h.add(t):h.delete(t)):(c=c.delete(t),h.delete(t)))}),Eu(this.query)||Iu(this.query))for(;c.size>this.query.limit;){var n=Eu(this.query)?c.last():c.first(),c=c.delete(n.key),h=h.delete(n.key);u.track({type:1,doc:n})}return{au:c,_u:u,du:l,Qt:h}},uc.prototype.fu=function(t,e){return t.Ye&&e.hasCommittedMutations&&!e.Ye},uc.prototype.wu=function(t,e,n){var o=this,r=this.au;this.au=t.au,this.Qt=t.Qt;var i=t._u.Ut();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.cu(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ur()}}var r,i}),this.mu(n);var s=e?this.Tu():[],n=0===this.uu.size&&this.Zt?1:0,e=n!==this.ou;return this.ou=n,0!==i.length||e?{snapshot:new po(this.query,t.au,r,i,t.Qt,0==n,e,!1),Eu:s}:{Eu:s}},uc.prototype.Is=function(t){return this.Zt&&"Offline"===t?(this.Zt=!1,this.wu({au:this.au,_u:new fo,Qt:this.Qt,du:!1},!1)):{Eu:[]}},uc.prototype.Iu=function(t){return!this.ru.has(t)&&!!this.au.has(t)&&!this.au.get(t).Ye},uc.prototype.mu=function(t){var e=this;t&&(t.te.forEach(function(t){return e.ru=e.ru.add(t)}),t.ee.forEach(function(t){}),t.ne.forEach(function(t){return e.ru=e.ru.delete(t)}),this.Zt=t.Zt)},uc.prototype.Tu=function(){var e=this;if(!this.Zt)return[];var n=this.uu;this.uu=ho(),this.au.forEach(function(t){e.Iu(t.key)&&(e.uu=e.uu.add(t.key))});var r=[];return n.forEach(function(t){e.uu.has(t)||r.push(new nc(t))}),this.uu.forEach(function(t){n.has(t)||r.push(new ec(t))}),r},uc.prototype.Au=function(t){this.ru=t.gr,this.uu=ho();t=this.lu(t.documents);return this.wu(t,!0)},uc.prototype.Ru=function(){return po.Gt(this.query,this.au,this.Qt,0===this.ou)},uc),ic=function(t){this.key=t,this.yu=!1},oc=(Object.defineProperty(sc.prototype,"Mu",{get:function(){return!0===this.Ou},enumerable:!1,configurable:!0}),sc);function sc(t,e,n,r,i,o){this.Bo=t,this.Pu=e,this.pu=n,this.gu=r,this.currentUser=i,this.Vu=o,this.vu={},this.bu=new Si(ku,Pu),this.Su=new Map,this.Cu=[],this.Du=new Xi(Gr.i),this.Fu=new Map,this.Nu=new dh,this.$u={},this.ku=new Map,this.xu=Ja.Wi(),this.onlineState="Unknown",this.Ou=void 0}function uc(t,e){this.query=t,this.ru=e,this.ou=null,this.Zt=!1,this.uu=ho(),this.Qt=ho(),this.cu=Vu(t),this.au=new lo(this.cu)}function ac(h,c){return y(this,void 0,void 0,function(){var n,o,s,u,a;return v(this,function(t){switch(t.label){case 0:return(e=h).Pu.jo.tu=cc.bind(null,e),e.Pu.jo.qe=function(t,e){var n=t,t=n.Fu.get(e);if(t&&t.yu)return ho().add(t.key);var r=ho(),e=n.Su.get(e);if(!e)return r;for(var i=0,o=e;i<o.length;i++){var s=o[i],s=n.bu.get(s);r=r.kt(s.view.hu)}return r}.bind(null,e),e.Pu.jo.Zo=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).gu.zs(s,"rejected",u),i=e.Fu.get(s),(n=i&&i.key)?(r=(r=new Xi(Gr.i)).rt(n,new du(n,Li.min())),i=ho().add(n),i=new yo(Li.min(),new Map,new eo(yi),r,i),[4,cc(e,i)]):[3,2];case 1:return t.sent(),e.Du=e.Du.remove(n),e.Fu.delete(s),gc(e),[3,4];case 2:return[4,sh(e.Bo,s,!1).then(function(){return dc(e,s,u)}).catch(ah)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.vu.Ao=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.ws.get(u);if(u){for(var a=0,h=u.listeners;a<h.length;a++)h[a].As(s)&&(r=!0);u.ds=s}}r&&Da(n)}.bind(null,e.pu),e.vu.Lu=function(t,e,n){var r=t;if(t=r.ws.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.ws.delete(e)}.bind(null,e.pu),(a=(n=e).bu.get(c))?(o=a.targetId,n.gu.Gs(o),s=a.view.Ru(),[3,4]):[3,1];case 1:return[4,(e=n.Bo,r=Su(c),(i=e).persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Zi.Pr(e,r).next(function(t){return t?(n=t,da.resolve(n)):i.Zi.qu(e).next(function(t){return n=new Qi(r,t,0,e.mr),i.Zi.Uu(e,n).next(function(){return n})})})}).then(function(t){var e=i.zi.get(t.targetId);return(null===e||0<t.et.L(e.et))&&(i.zi=i.zi.rt(t.targetId,t),i.Ki.set(r,t.targetId)),t}))];case 2:return u=t.sent(),a=n.gu.Gs(u.targetId),o=u.targetId,[4,function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Bu=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.lu(o)).du?[4,uh(r.Bo,i.query,!1).then(function(t){t=t.documents;return i.view.lu(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.zt.get(i.targetId),n=i.view.wu(e,r.Mu,n),[2,(vc(r,i.targetId,n.Eu),n.snapshot)]}})})}(i,t,e,n)},[4,uh(i.Bo,o,!0)];case 1:return n=t.sent(),r=new rc(o,n.gr),e=r.lu(n.documents),n=vo.Xt(s,u&&"Offline"!==i.onlineState),n=r.wu(e,i.Mu,n),vc(i,s,n.Eu),r=new tc(o,s,r),i.bu.set(o,r),i.Su.has(s)?i.Su.get(s).push(o):i.Su.set(s,[o]),[2,n.snapshot]}})})}(n,c,o,"current"===a)];case 3:s=t.sent(),n.Mu&&Mh(n.Pu,u),t.label=4;case 4:return[2,s]}var r,i,e})})}function hc(f,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:(o=f).Pu.jo.eu=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,rh(e.Bo,o)];case 2:return r=t.sent(),pc(e,n,null),fc(e,n),e.gu.Ws(n,"acknowledged"),[4,mc(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,ah(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,o),o.Pu.jo.nu=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Bo,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.hi.Wu(e,r).next(function(t){return _r(null!==t),n=t.keys(),i.hi.hr(e,t)}).next(function(){return i.hi.lr(e)}).next(function(){return i.er.Ti(e,n)})}))];case 2:return o=t.sent(),pc(n,u,a),fc(n,u),n.gu.Ws(u,"rejected",a),[4,mc(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,ah(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.Bo,a=p,c=r,l=Di.now(),i=a.reduce(function(t,e){return t.add(e.key)},ho()),c.persistence.runTransaction("Locally write mutations","readwrite",function(u){return c.er.Ti(u,i).next(function(t){h=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=h.get(i.key),s instanceof Js?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof pu?t.field(i.field):void 0,o=ys(i.transform,o||null);null!=o&&(e=(null==e?new ou:e).set(i.field,o))}return e?e.Je():null}(o):null);null!=o&&e.push(new Ws(i.key,o,function s(t){var u=[];return Cr(t.fields||{},function(t,e){var n=new Br([t]);if(Xo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Us(u)}(o.proto.mapValue),Cs.exists(!0)))}return c.hi.Qu(u,l,e,a)})}).then(function(t){var e=t.oi(h);return{batchId:t.batchId,ju:e}}))];case 2:return s=t.sent(),u.gu.js(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.$u[e.currentUser.Cs()])||new Xi(yi)).rt(n,o),e.$u[e.currentUser.Cs()]=r,[4,mc(u,s.ju)];case 3:return t.sent(),[4,Yh(u.Pu)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=Ta(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,h,c,l,i,o})})}function cc(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,oh(n.Bo,i)];case 2:return e=t.sent(),i.zt.forEach(function(t,e){e=n.Fu.get(e);e&&(_r(t.te.size+t.ee.size+t.ne.size<=1),0<t.te.size?e.yu=!0:0<t.ee.size?_r(e.yu):0<t.ne.size&&(_r(e.yu),e.yu=!1))}),[4,mc(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,ah(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function lc(t,n,e){var r,t=t;(t.Mu&&0===e||!t.Mu&&1===e)&&(r=[],t.bu.forEach(function(t,e){e=e.view.Is(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.ws.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Is(i)&&(o=!0)}),o&&Da(t)}(t.pu,n),r.length&&t.vu.Ao(r),t.onlineState=n,t.Mu&&t.gu.ti(n))}function fc(t,e){(t.ku.get(e)||[]).forEach(function(t){t.resolve()}),t.ku.delete(e)}function pc(t,e,n){var r=t,i=r.$u[r.currentUser.Cs()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.$u[r.currentUser.Cs()]=i)}function dc(e,t,n){void 0===n&&(n=null),e.gu.Ks(t);for(var r=0,i=e.Su.get(t);r<i.length;r++){var o=i[r];e.bu.delete(o),n&&e.vu.Lu(o,n)}e.Su.delete(t),e.Mu&&e.Nu.kr(t).forEach(function(t){e.Nu.Lr(t)||yc(e,t)})}function yc(t,e){var n=t.Du.get(e);null!==n&&(xh(t.Pu,n),t.Du=t.Du.remove(e),t.Fu.delete(n),gc(t))}function vc(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof ec?(t.Nu.Cr(o.key,e),function(t,e){e=e.key;t.Du.get(e)||(Lr("SyncEngine","New document in limbo: "+e),t.Cu.push(e),gc(t))}(t,o)):o instanceof nc?(Lr("SyncEngine","Document no longer in limbo: "+o.key),t.Nu.Fr(o.key,e),t.Nu.Lr(o.key)||yc(t,o.key)):Ur()}}function gc(t){for(;0<t.Cu.length&&t.Du.size<t.Vu;){var e=t.Cu.shift(),n=t.xu.next();t.Fu.set(n,new ic(e)),t.Du=t.Du.rt(e,n),Mh(t.Pu,new Qi(Su(bu(e.path)),n,2,Ua.Os))}}function mc(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).bu.m()?[3,3]:(n.bu.forEach(function(t,e){o.push(n.Bu(e,s,u).then(function(t){t&&(n.Mu&&n.gu.zs(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=qa.Si(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.vu.Ao(r),[4,function(a,h){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return da.forEach(h,function(e){return da.forEach(e.vi,function(t){return r.persistence.Ar.Cr(n,e.targetId,t)}).next(function(){return da.forEach(e.bi,function(t){return r.persistence.Ar.Fr(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!ga(e=t.sent()))throw e;return Lr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=h;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.zi.get(o),u=s.et,u=s.it(u),r.zi=r.zi.rt(o,u));return[2]}})})}(n.Bo,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function wc(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Lr("SyncEngine","User change. New user:",o.Cs()),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).hi,m=e.er,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.hi.zu(v).next(function(t){return g=t,n=e.persistence.Yi(o),m=new xa(e.Ji,n,e.persistence.nr()),n.zu(v)}).next(function(t){for(var e=[],n=[],r=ho(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Ti(v,r).next(function(t){return{Ku:t,Hu:e,Yu:n}})})})];case 1:return r=t.sent(),[2,(e.hi=n,e.er=m,e.Gi.sr(e.er),r)]}})})}(n.Bo,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).ku.forEach(function(t){t.forEach(function(t){t.reject(new Ar(Tr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.ku.clear(),n.gu.Zs(o,r.Hu,r.Yu),[4,mc(n,r.Ku)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}var bc,Ec,Ic,Tc=(Kc.prototype.sr=function(t){this.Ju=t},Kc.prototype.Ai=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.rn.length||1===r.rn.length&&r.rn[0].field.V())||i.isEqual(Li.min())?this.Xu(e,r):this.Ju.Ti(e,o).next(function(t){var n=s.Zu(r,t);return(Eu(r)||Iu(r))&&s.du(r.on,n,o,i)?s.Xu(e,r):(Dr()<=u.DEBUG&&Lr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Uu(r)),s.Ju.Ai(e,r,i).next(function(e){return n.forEach(function(t){e=e.rt(t.key,t)}),e}))})},Kc.prototype.Zu=function(n,t){var r=new eo(Vu(n));return t.forEach(function(t,e){e instanceof pu&&_u(n,e)&&(r=r.add(e))}),r},Kc.prototype.du=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.L(r))},Kc.prototype.Xu=function(t,e){return Dr()<=u.DEBUG&&Lr("IndexFreeQueryEngine","Using full collection scan to execute query:",Uu(e)),this.Ju.Ai(t,e,Li.min())},Kc),Ac=(Yc.prototype.nc=function(t){return da.resolve(0===this.hi.length)},Yc.prototype.Qu=function(t,e,n,r){var i=this.tc;this.tc++,0<this.hi.length&&this.hi[this.hi.length-1];n=new ja(i,e,n,r);this.hi.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.ec=this.ec.add(new yh(u.key,i)),this.li.Bi(t,u.key.path.h())}return da.resolve(n)},Yc.prototype.Wu=function(t,e){return da.resolve(this.sc(e))},Yc.prototype.yr=function(t,e){e+=1,e=this.ic(e),e=e<0?0:e;return da.resolve(this.hi.length>e?this.hi[e]:null)},Yc.prototype.Gu=function(){return da.resolve(0===this.hi.length?-1:this.tc-1)},Yc.prototype.zu=function(t){return da.resolve(this.hi.slice())},Yc.prototype.fi=function(t,e){var n=this,r=new yh(e,0),e=new yh(e,Number.POSITIVE_INFINITY),i=[];return this.ec.Ft([r,e],function(t){t=n.sc(t.qr);i.push(t)}),da.resolve(i)},Yc.prototype.Ii=function(t,e){var n=this,r=new eo(yi);return e.forEach(function(t){var e=new yh(t,0),t=new yh(t,Number.POSITIVE_INFINITY);n.ec.Ft([e,t],function(t){r=r.add(t.qr)})}),da.resolve(this.rc(r))},Yc.prototype.gi=function(t,e){var n=e.path,r=n.length+1,e=n;Gr.N(e)||(e=e.child(""));var e=new yh(new Gr(e),0),i=new eo(yi);return this.ec.Nt(function(t){var e=t.key.path;return!!n.T(e)&&(e.length===r&&(i=i.add(t.qr)),!0)},e),da.resolve(this.rc(i))},Yc.prototype.rc=function(t){var e=this,n=[];return t.forEach(function(t){t=e.sc(t);null!==t&&n.push(t)}),n},Yc.prototype.hr=function(n,r){var i=this;_r(0===this.oc(r.batchId,"removed")),this.hi.shift();var o=this.ec;return da.forEach(r.mutations,function(t){var e=new yh(t.key,r.batchId);return o=o.delete(e),i.Ar.uc(n,t.key)}).next(function(){i.ec=o})},Yc.prototype.cc=function(t){},Yc.prototype.Lr=function(t,e){var n=new yh(e,0),n=this.ec.$t(n);return da.resolve(e.isEqual(n&&n.key))},Yc.prototype.lr=function(t){return this.hi.length,da.resolve()},Yc.prototype.oc=function(t,e){return this.ic(t)},Yc.prototype.ic=function(t){return 0===this.hi.length?0:t-this.hi[0].batchId},Yc.prototype.sc=function(t){t=this.ic(t);return t<0||t>=this.hi.length?null:this.hi[t]},Yc),Nc=(Xc.prototype.ar=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.ac(e);return this.docs=this.docs.rt(r,{hc:e,size:i,readTime:n}),this.size+=i-o,this.li.Bi(t,r.path.h())},Xc.prototype.Er=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Xc.prototype.wi=function(t,e){e=this.docs.get(e);return da.resolve(e?e.hc:null)},Xc.prototype.getEntries=function(t,e){var n=this,r=ro;return e.forEach(function(t){var e=n.docs.get(t);r=r.rt(t,e?e.hc:null)}),da.resolve(r)},Xc.prototype.Ai=function(t,e,n){for(var r=so,i=new Gr(e.path.child("")),o=this.docs._t(i);o.It();){var s=o.Et(),u=s.key,a=s.value,s=a.hc,a=a.readTime;if(!e.path.T(u.path))break;a.L(n)<=0||s instanceof pu&&_u(e,s)&&(r=r.rt(s.key,s))}return da.resolve(r)},Xc.prototype.lc=function(t,e){return da.forEach(this.docs,function(t){return e(t)})},Xc.prototype.ur=function(t){return new Rc(this)},Xc.prototype._c=function(t){return da.resolve(this.size)},Xc),Rc=(Object.defineProperty(Hc.prototype,"readTime",{get:function(){return this.dc},set:function(t){this.dc=t},enumerable:!1,configurable:!0}),Hc.prototype.ar=function(t,e){this.wc(),this.readTime=e,this.ju.set(t.key,t)},Hc.prototype.Er=function(t,e){this.wc(),e&&(this.readTime=e),this.ju.set(t,null)},Hc.prototype.wi=function(t,e){this.wc();var n=this.ju.get(e);return void 0!==n?da.resolve(n):this.mc(t,e)},Hc.prototype.getEntries=function(t,e){return this.Tc(t,e)},Hc.prototype.apply=function(t){return this.wc(),this.fc=!0,this.wu(t)},Hc.prototype.wc=function(){},n(Wc,Ic=Hc),Wc.prototype.wu=function(n){var r=this,i=[];return this.ju.forEach(function(t,e){e?i.push(r.Ec.ar(n,e,r.readTime)):r.Ec.Er(t)}),da.$n(i)},Wc.prototype.mc=function(t,e){return this.Ec.wi(t,e)},Wc.prototype.Tc=function(t,e){return this.Ec.getEntries(t,e)},Wc),Sc=(zc.prototype.Ce=function(t,n){return this.Ic.forEach(function(t,e){return n(e)}),da.resolve()},zc.prototype._r=function(t){return da.resolve(this.lastRemoteSnapshotVersion)},zc.prototype.Pc=function(t){return da.resolve(this.Ac)},zc.prototype.qu=function(t){return this.highestTargetId=this.yc.next(),da.resolve(this.highestTargetId)},zc.prototype.Rr=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Ac&&(this.Ac=e),da.resolve()},zc.prototype.gc=function(t){this.Ic.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.yc=new Ja(e),this.highestTargetId=e),t.sequenceNumber>this.Ac&&(this.Ac=t.sequenceNumber)},zc.prototype.Uu=function(t,e){return this.gc(e),this.targetCount+=1,da.resolve()},zc.prototype.Tr=function(t,e){return this.gc(e),da.resolve()},zc.prototype.Vc=function(t,e){return this.Ic.delete(e.target),this.Rc.kr(e.targetId),--this.targetCount,da.resolve()},zc.prototype.vc=function(n,r,i){var o=this,s=0,u=[];return this.Ic.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Ic.delete(t),u.push(o.bc(n,e.targetId)),s++)}),da.$n(u).next(function(){return s})},zc.prototype.Sc=function(t){return da.resolve(this.targetCount)},zc.prototype.Pr=function(t,e){e=this.Ic.get(e)||null;return da.resolve(e)},zc.prototype.wr=function(t,e,n){return this.Rc.Dr(e,n),da.resolve()},zc.prototype.dr=function(e,t,n){this.Rc.$r(t,n);var r=this.persistence.Ar,i=[];return r&&t.forEach(function(t){i.push(r.uc(e,t))}),da.$n(i)},zc.prototype.bc=function(t,e){return this.Rc.kr(e),da.resolve()},zc.prototype.pr=function(t,e){e=this.Rc.Mr(e);return da.resolve(e)},zc.prototype.Lr=function(t,e){return da.resolve(this.Rc.Lr(e))},zc),Dc=(Qc.prototype.start=function(){return Promise.resolve()},Qc.prototype.ei=function(){return this.Fc=!1,Promise.resolve()},Object.defineProperty(Qc.prototype,"$c",{get:function(){return this.Fc},enumerable:!1,configurable:!0}),Qc.prototype.kc=function(){},Qc.prototype.xc=function(){},Qc.prototype.nr=function(){return this.li},Qc.prototype.Yi=function(t){var e=this.Cc[t.Cs()];return e||(e=new Ac(this.li,this.Ar),this.Cc[t.Cs()]=e),e},Qc.prototype.tr=function(){return this.Zi},Qc.prototype.Xi=function(){return this.ai},Qc.prototype.runTransaction=function(t,e,n){var r=this;Lr("MemoryPersistence","Starting transaction:",t);var i=new Lc(this.Dc.next());return this.Ar.Oc(),n(i).next(function(t){return r.Ar.Mc(i).next(function(){return t})}).Fn().then(function(t){return i.Lc(),t})},Qc.prototype.qc=function(e,n){return da.kn(Object.values(this.Cc).map(function(t){return function(){return t.Lr(e,n)}}))},Qc),Lc=(Gc.prototype.Bc=function(t){this.Uc.push(t)},Gc.prototype.Lc=function(){this.Uc.forEach(function(t){return t()})},n(Bc,Ec=Gc),Bc),Oc=(Fc.Wc=function(t){return new Fc(t)},Object.defineProperty(Fc.prototype,"Gc",{get:function(){if(this.jc)return this.jc;throw Ur()},enumerable:!1,configurable:!0}),Fc.prototype.Cr=function(t,e,n){return this.Qc.Cr(n,e),this.Gc.delete(n.toString()),da.resolve()},Fc.prototype.Fr=function(t,e,n){return this.Qc.Fr(n,e),this.Gc.add(n.toString()),da.resolve()},Fc.prototype.uc=function(t,e){return this.Gc.add(e.toString()),da.resolve()},Fc.prototype.removeTarget=function(t,e){var n=this;this.Qc.kr(e.targetId).forEach(function(t){return n.Gc.add(t.toString())});var r=this.persistence.tr();return r.pr(t,e.targetId).next(function(t){t.forEach(function(t){return n.Gc.add(t.toString())})}).next(function(){return r.Vc(t,e)})},Fc.prototype.Oc=function(){this.jc=new Set},Fc.prototype.Mc=function(n){var r=this,i=this.persistence.Xi().ur();return da.forEach(this.Gc,function(t){var e=Gr.C(t);return r.zc(n,e).next(function(t){t||i.Er(e)})}).next(function(){return r.jc=null,i.apply(n)})},Fc.prototype.Ir=function(t,e){var n=this;return this.zc(t,e).next(function(t){t?n.Gc.delete(e.toString()):n.Gc.add(e.toString())})},Fc.prototype.Nc=function(t){return 0},Fc.prototype.zc=function(t,e){var n=this;return da.kn([function(){return da.resolve(n.Qc.Lr(e))},function(){return n.persistence.tr().Lr(t,e)},function(){return n.persistence.qc(t,e)}])},Fc),Pc=(qc.prototype.Eo=function(t){this.Yc=t},qc.prototype.fo=function(t){this.Jc=t},qc.prototype.onMessage=function(t){this.Xc=t},qc.prototype.close=function(){this.Hc()},qc.prototype.send=function(t){this.Kc(t)},qc.prototype.Zc=function(){this.Yc()},qc.prototype.ta=function(t){this.Jc(t)},qc.prototype.ea=function(t){this.Xc(t)},qc),kc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Uc=(xc.prototype.Fo=function(e,t,n,r){var i=this.ra(e,t);Lr("RestConnection","Sending: ",i,n);t={};return this.oa(t,r),this.ua(e,i,t,n).then(function(t){return Lr("RestConnection","Received: ",t),t},function(t){throw Pr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},xc.prototype.No=function(t,e,n,r){return this.Fo(t,e,n,r)},xc.prototype.oa=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.23.0-202096215419",t["Content-Type"]="text/plain",e)for(var n in e.Ur)e.Ur.hasOwnProperty(n)&&(t[n]=e.Ur[n])},xc.prototype.ra=function(t,e){t=kc[t];return this.sa+"/v1/"+e+":"+t},n(Mc,bc=xc),Mc.prototype.ua=function(o,e,s,u){return new Promise(function(n,r){var i=new wr;i.listenOnce(gr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case vr.NO_ERROR:var t=i.getResponseJson();Lr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case vr.TIMEOUT:Lr("Connection",'RPC "'+o+'" timed out'),r(new Ar(Tr.DEADLINE_EXCEEDED,"Request time out"));break;case vr.HTTP_ERROR:var e=i.getStatus();Lr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Tr).indexOf(e)?e:Tr.UNKNOWN,r(new Ar(e,t.message))):r(new Ar(Tr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Ar(Tr.UNAVAILABLE,"Connection failed."));break;default:Ur()}}finally{Lr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Mc.prototype.Io=function(t,e){var n,r=[this.sa,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=yr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.B.projectId+"/databases/"+this.B.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.oa(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Lr("Connection","Creating WebChannel: "+r,t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new Pc({Kc:function(t){u?Lr("Connection","Not sending because WebChannel is closed:",t):(s||(Lr("Connection","Opening WebChannel transport."),o.open(),s=!0),Lr("Connection","WebChannel sending:",t),o.send(t))},Hc:function(){return o.close()}}),t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(mr.EventType.OPEN,function(){u||Lr("Connection","WebChannel transport opened.")}),t(mr.EventType.CLOSE,function(){u||(u=!0,Lr("Connection","WebChannel transport closed"),a.ta())}),t(mr.EventType.ERROR,function(t){u||(u=!0,Pr("Connection","WebChannel transport errored:",t),a.ta(new Ar(Tr.UNAVAILABLE,"The operation could not be completed")))}),t(mr.EventType.MESSAGE,function(t){var e,n,r,i;u||(_r(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Lr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Gi[r];if(void 0!==t)return Hi(t)}(),i=n.message,void 0===t&&(t=Tr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.ta(new Ar(t,i)),o.close()):(Lr("Connection","WebChannel received:",e),a.ea(e)))}),setTimeout(function(){a.Zc()},0),a},Mc),_c=(jc.prototype.Yo=function(t){this._a.push(t)},jc.prototype.ei=function(){window.removeEventListener("online",this.ca),window.removeEventListener("offline",this.ha)},jc.prototype.fa=function(){window.addEventListener("online",this.ca),window.addEventListener("offline",this.ha)},jc.prototype.aa=function(){Lr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this._a;t<e.length;t++)(0,e[t])(0)},jc.prototype.la=function(){Lr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this._a;t<e.length;t++)(0,e[t])(1)},jc.da=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},jc),Vc=(Cc.prototype.Yo=function(t){},Cc.prototype.ei=function(){},Cc);function Cc(){}function jc(){var t=this;this.ca=function(){return t.aa()},this.ha=function(){return t.la()},this._a=[],this.fa()}function Mc(t){var e=this;return(e=bc.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function xc(t){this.na=t,this.B=t.B;var e=t.ssl?"https":"http";this.sa=e+"://"+t.host,this.ia="projects/"+this.B.projectId+"/databases/"+this.B.database+"/documents"}function qc(t){this.Kc=t.Kc,this.Hc=t.Hc}function Fc(t){this.persistence=t,this.Qc=new dh,this.jc=null}function Bc(t){var e=this;return(e=Ec.call(this)||this).mr=t,e}function Gc(){this.Uc=[]}function Qc(t){var e=this;this.Cc={},this.Dc=new Ua(0),this.Fc=!1,this.Fc=!0,this.Ar=t(this),this.Zi=new Sc(this),this.li=new Ya,this.ai=(t=this.li,new Nc(t,function(t){return e.Ar.Nc(t)}))}function zc(t){this.persistence=t,this.Ic=new Si(xi,qi),this.lastRemoteSnapshotVersion=Li.min(),this.highestTargetId=0,this.Ac=0,this.Rc=new dh,this.targetCount=0,this.yc=Ja.ji()}function Wc(t){var e=this;return(e=Ic.call(this)||this).Ec=t,e}function Hc(){this.ju=new Si(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.fc=!1}function Xc(t,e){this.li=t,this.ac=e,this.docs=new Xi(Gr.i),this.size=0}function Yc(t,e){this.li=t,this.Ar=e,this.hi=[],this.tc=1,this.ec=new eo(yh.vr)}function Kc(){}function Jc(t){return new Jo(t,!0)}var Zc,$c,tl="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",el=(pl.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.gu=this.wa(e),this.persistence=this.ma(e),[4,this.persistence.start()];case 1:return t.sent(),this.Ta=this.Ea(e),this.Bo=this.Ia(e),[2]}})})},pl.prototype.Ea=function(t){return null},pl.prototype.Ia=function(t){return e=this.persistence,n=new Tc,t=t.Aa,new Za(e,n,t);var e,n},pl.prototype.ma=function(t){if(t.persistenceSettings.Ra)throw new Ar(Tr.FAILED_PRECONDITION,tl);return new Dc(Oc.Wc)},pl.prototype.wa=function(t){return new Ca},pl.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ta&&this.Ta.stop(),[4,this.gu.ei()];case 1:return t.sent(),[4,this.persistence.ei()];case 2:return t.sent(),[2]}})})},pl.prototype.clearPersistence=function(t,e){throw new Ar(Tr.FAILED_PRECONDITION,tl)},pl),nl=(fl.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Bo?[3,2]:(this.Bo=n.Bo,this.gu=n.gu,this.Qo=this.ya(r),this.Pu=this.Pa(r),this.pu=this.pa(r),this.ga=this.Va(r),this.gu.Qs=function(t){return lc(e.ga,t,1)},this.Pu.jo.va=wc.bind(null,this.ga),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.zo.delete(2),[4,Vh(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.zo.add(2),[4,Ch(e)]);case 3:t.sent(),e.Jo.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.Pu,this.ga.Mu)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},fl.prototype.pa=function(t){return new Na},fl.prototype.ya=function(t){var e=Jc(t.na.B),n=(n=t.na,new Uc(n));return t=t.credentials,new Ih(t,n,e)},fl.prototype.Pa=function(t){var e=this,n=this.Bo,r=this.Qo,i=t.xn,o=function(t){return lc(e.ga,t,0)},t=new(_c.da()?_c:Vc);return new ch(n,r,i,o,t)},fl.prototype.Va=function(t){return function(t,e,n,r,i,o,s){o=new oc(t,e,n,r,i,o);return s&&(o.Ou=!0),o}(this.Bo,this.Pu,this.pu,this.gu,t.Aa,t.Vu,!t.persistenceSettings.Ra||!t.persistenceSettings.synchronizeTabs)},fl.prototype.terminate=function(){return jh(this.Pu)},fl),rl=(ll.prototype.next=function(t){this.observer.next&&this.ba(this.observer.next,t)},ll.prototype.error=function(t){this.observer.error?this.ba(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},ll.prototype.Sa=function(){this.muted=!0},ll.prototype.ba=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},ll),il=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Ar(Tr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(Zr("FieldPath","string",e,t[e]),0===t[e].length)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Ca=new Br(t)},ol=(n(cl,$c=il),cl.documentId=function(){return new cl(Br.v().R())},cl.prototype.isEqual=function(t){if(!(t instanceof cl))throw hi("isEqual","FieldPath",1,t);return this.Ca.isEqual(t.Ca)},cl),sl=new RegExp("[~\\*/\\[\\]]"),ul=function(t){this.Da=t},al=(n(hl,Zc=ul),hl.prototype.Fa=function(t){if(2!==t.Na)throw 1===t.Na?t.$a(this.Da+"() can only appear at the top level of your update data"):t.$a(this.Da+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},hl.prototype.isEqual=function(t){return t instanceof hl},hl);function hl(){return null!==Zc&&Zc.apply(this,arguments)||this}function cl(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return $c.call(this,t)||this}function ll(t){this.observer=t,this.muted=!1}function fl(){}function pl(){}function dl(t,e,n){return new jl({Na:3,ka:e.settings.ka,methodName:t.Da,xa:n},e.B,e.serializer,e.ignoreUndefinedProperties)}var yl,vl,gl,ml,wl=(n(Vl,ml=ul),Vl.prototype.Fa=function(t){return new ks(t.path,new ms)},Vl.prototype.isEqual=function(t){return t instanceof Vl},Vl),bl=(n(_l,gl=ul),_l.prototype.Fa=function(t){var e=dl(this,t,!0),n=this.Oa.map(function(t){return zl(t,e)}),n=new ws(n);return new ks(t.path,n)},_l.prototype.isEqual=function(t){return this===t},_l),El=(n(Ul,vl=ul),Ul.prototype.Fa=function(t){var e=dl(this,t,!0),n=this.Oa.map(function(t){return zl(t,e)}),n=new As(n);return new ks(t.path,n)},Ul.prototype.isEqual=function(t){return this===t},Ul),Il=(n(kl,yl=ul),kl.prototype.Fa=function(t){var e=new Ds(t.serializer,ts(t.serializer,this.Ma));return new ks(t.path,e)},kl.prototype.isEqual=function(t){return this===t},kl),Tl=(Object.defineProperty(Pl.prototype,"latitude",{get:function(){return this.La},enumerable:!1,configurable:!0}),Object.defineProperty(Pl.prototype,"longitude",{get:function(){return this.qa},enumerable:!1,configurable:!0}),Pl.prototype.isEqual=function(t){return this.La===t.La&&this.qa===t.qa},Pl.prototype.toJSON=function(){return{latitude:this.La,longitude:this.qa}},Pl.prototype.H=function(t){return yi(this.La,t.La)||yi(this.qa,t.qa)},Pl),Al=function(t){this.Ua=t},Nl=/^__.*__$/,Rl=function(t,e,n){this.Ba=t,this.Qa=e,this.ja=n},Sl=(Ol.prototype.Wa=function(t,e){var n=[];return null!==this.Qe?n.push(new Ws(t,this.data,this.Qe,e)):n.push(new zs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Js(t,this.fieldTransforms)),n},Ol),Dl=(Ll.prototype.Wa=function(t,e){e=[new Ws(t,this.data,this.Qe,e)];return 0<this.fieldTransforms.length&&e.push(new Js(t,this.fieldTransforms)),e},Ll);function Ll(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function Ol(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function Pl(t,e){if(Yr("GeoPoint",arguments,2),Zr("GeoPoint","number",1,t),Zr("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Ar(Tr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Ar(Tr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.La=t,this.qa=e}function kl(t,e){var n=this;return(n=yl.call(this,t)||this).Ma=e,n}function Ul(t,e){var n=this;return(n=vl.call(this,t)||this).Oa=e,n}function _l(t,e){var n=this;return(n=gl.call(this,t)||this).Oa=e,n}function Vl(){return null!==ml&&ml.apply(this,arguments)||this}function Cl(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Ur()}}var jl=(Object.defineProperty(ql.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(ql.prototype,"Na",{get:function(){return this.settings.Na},enumerable:!1,configurable:!0}),ql.prototype.za=function(t){return new ql(Object.assign(Object.assign({},this.settings),t),this.B,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},ql.prototype.Ka=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.za({path:e,xa:!1});return e.Ha(t),e},ql.prototype.Ya=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.za({path:t,xa:!1});return t.Ga(),t},ql.prototype.Ja=function(t){return this.za({path:void 0,xa:!0})},ql.prototype.$a=function(t){return Jl(t,this.settings.methodName,this.settings.Xa||!1,this.path,this.settings.ka)},ql.prototype.contains=function(e){return void 0!==this.Qe.find(function(t){return e.T(t)})||void 0!==this.fieldTransforms.find(function(t){return e.T(t.field)})},ql.prototype.Ga=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Ha(this.path.get(t))},ql.prototype.Ha=function(t){if(0===t.length)throw this.$a("Document fields must not be empty");if(Cl(this.Na)&&Nl.test(t))throw this.$a('Document fields cannot begin and end with "__"')},ql),Ml=(xl.prototype.Za=function(t,e,n,r){return void 0===r&&(r=!1),new jl({Na:t,methodName:e,ka:n,path:Br.p(),xa:!1,Xa:r},this.B,this.serializer,this.ignoreUndefinedProperties)},xl);function xl(t,e,n){this.B=t,this.ignoreUndefinedProperties=e,this.serializer=n||Jc(t)}function ql(t,e,n,r,i,o){this.settings=t,this.B=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Ga(),this.fieldTransforms=i||[],this.Qe=o||[]}function Fl(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Za(o.merge||o.mergeFields?2:0,e,n,i);Xl("Data must be an object, but it was:",s,r);var u,a,r=Wl(r,s);if(o.merge)u=new Us(s.Qe),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],c=0,l=o.mergeFields;c<l.length;c++){var f=l[c],p=void 0;if(f instanceof il)p=f.Ca;else{if("string"!=typeof f)throw Ur();p=Kl(e,f,n)}if(!s.contains(p))throw new Ar(Tr.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Zl(h,p)||h.push(p)}u=new Us(h),a=s.fieldTransforms.filter(function(t){return u.Ke(t.field)})}else u=null,a=s.fieldTransforms;return new Sl(new iu(r),u,a)}function Bl(t,r,i,e){var o=t.Za(1,r,i);Xl("Data must be an object, but it was:",o,e);var s=[],u=new ou;Cr(e,function(t,e){var n=Kl(r,t,i),t=o.Ya(n);e instanceof al||e instanceof Al&&e.Ua instanceof al?s.push(n):null!=(t=zl(e,t))&&(s.push(n),u.set(n,t))});e=new Us(s);return new Dl(u.Je(),e,o.fieldTransforms)}function Gl(t,e,n,r,i,o){var s=t.Za(1,e,n),u=[Yl(e,r,n)],a=[i];if(o.length%2!=0)throw new Ar(Tr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(Yl(e,o[h])),a.push(o[h+1]);for(var c,l,f,p=[],d=new ou,y=u.length-1;0<=y;--y){Zl(p,u[y])||(c=u[y],l=a[y],f=s.Ya(c),l instanceof al||l instanceof Al&&l.Ua instanceof al?p.push(c):null!=(f=zl(l,f))&&(p.push(c),d.set(c,f)))}i=new Us(p);return new Dl(d.Je(),i,s.fieldTransforms)}function Ql(t,e,n,r){return void 0===r&&(r=!1),zl(n,t.Za(r?4:3,e))}function zl(s,t){if(s instanceof Al&&(s=s.Ua),Hl(s))return Xl("Unsupported field value:",t,s),Wl(s,t);if(s instanceof ul)return function(t,e){if(!Cl(e.Na))throw e.$a(t.Da+"() can only be used with update() and set()");if(!e.path)throw e.$a(t.Da+"() is not currently supported inside arrays");t=t.Fa(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.Qe.push(t.path),s instanceof Array){if(t.settings.xa&&4!==t.Na)throw t.$a("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=zl(i[r],t.Ja(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ts(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Di.fromDate(t);return{timestampValue:es(e.serializer,n)}}if(t instanceof Di){var r=new Di(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:es(e.serializer,r)}}if(t instanceof Tl)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof wi)return{bytesValue:ns(e.serializer,t.U)};if(t instanceof Rl){n=e.B,r=t.Ba;if(!r.isEqual(n))throw e.$a("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:is(t.Ba||e.B,t.Qa.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.$a("Unsupported field value: "+si(t))}(s,t)}function Wl(t,n){var r={};return jr(t)?n.path&&0<n.path.length&&n.Qe.push(n.path):Cr(t,function(t,e){e=zl(e,n.Ka(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function Hl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Di||t instanceof Tl||t instanceof wi||t instanceof Rl||t instanceof ul)}function Xl(t,e,n){if(!Hl(n)||!oi(n)){n=si(n);throw"an object"===n?e.$a(t+" a custom object"):e.$a(t+" "+n)}}function Yl(t,e,n){if(e instanceof il)return e.Ca;if("string"==typeof e)return Kl(t,e);throw Jl("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Kl(t,e,n){try{return function(e){if(0<=e.search(sl))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(ol.bind.apply(ol,i([void 0],e.split("."))))}catch(t){throw new Ar(Tr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Ca}catch(e){throw Jl(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Jl(t,e,n,r,i){var o=r&&!r.m(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Ar(Tr.INVALID_ARGUMENT,(e+=". ")+t+n)}function Zl(t,e){return t.some(function(t){return t.isEqual(e)})}var $l=(of.prototype.ih=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.rh(),0<this.mutations.length)throw new Ar(Tr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=as((n=s).serializer)+"/documents",r={documents:u.map(function(t){return os(n.serializer,t)})},[4,n.No("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.serializer,"found"in(t=t)?function(t,e){_r(!!e.found),e.found.name,e.found.updateTime;var n=ss(t,e.found.name),t=rs(e.found.updateTime),e=new iu({mapValue:{fields:e.found.fields}});return new pu(n,t,e,{})}(e,t):"missing"in t?function(t,e){_r(!!e.missing),_r(!!e.readTime);t=ss(t,e.missing),e=rs(e.readTime);return new du(t,e)}(e,t):Ur());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());_r(!!t),o.push(t)}),o)]}})})}(this.Qo,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof du||t instanceof pu?n.oh(t):Ur()}),e)]}})})},of.prototype.set=function(t,e){this.write(e.Wa(t,this.Ge(t))),this.sh.add(t.toString())},of.prototype.update=function(t,e){try{this.write(e.Wa(t,this.uh(t)))}catch(t){this.nh=t}this.sh.add(t.toString())},of.prototype.delete=function(t){this.write([new nu(t,this.Ge(t))]),this.sh.add(t.toString())},of.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.rh(),this.nh)throw this.nh;return e=this.th,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=Gr.C(e);n.mutations.push(new ru(e,n.Ge(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=as((e=i).serializer)+"/documents",r={writes:o.map(function(t){return cs(e.serializer,t)})},[4,e.Fo("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Qo,this.mutations)];case 1:return t.sent(),this.eh=!0,[2]}})})},of.prototype.oh=function(t){var e;if(t instanceof pu)e=t.version;else{if(!(t instanceof du))throw Ur();e=Li.min()}var n=this.th.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Ar(Tr.ABORTED,"Document version changed between two reads.")}else this.th.set(t.key.toString(),e)},of.prototype.Ge=function(t){var e=this.th.get(t.toString());return!this.sh.has(t.toString())&&e?Cs.updateTime(e):Cs.He()},of.prototype.uh=function(t){var e=this.th.get(t.toString());if(this.sh.has(t.toString())||!e)return Cs.exists(!0);if(e.isEqual(Li.min()))throw new Ar(Tr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Cs.updateTime(e)},of.prototype.write=function(t){this.rh(),this.mutations=this.mutations.concat(t)},of.prototype.rh=function(){},of),tf=(rf.prototype.run=function(){this.hh()},rf.prototype.hh=function(){var t=this;this.Jn.Rn(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new $l(this.Qo),(n=this.lh(e))&&n.then(function(t){r.xn.Qn(function(){return e.commit().then(function(){r.Ln.resolve(t)}).catch(function(t){r._h(t)})})}).catch(function(t){r._h(t)}),[2]})})})},rf.prototype.lh=function(t){try{var e=this.updateFunction(t);return!Vi(e)&&e.catch&&e.then?e:(this.Ln.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ln.reject(t),null}},rf.prototype._h=function(t){var e=this;0<this.ah&&this.fh(t)?(--this.ah,this.xn.Qn(function(){return e.hh(),Promise.resolve()})):this.Ln.reject(t)},rf.prototype.fh=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!Wi(t)},rf),ef=(nf.prototype.start=function(t,e,n,r){var i=this;this.wh(),this.na=t;var o=new fa,s=!1;return this.credentials.jr(function(t){return s?void i.xn.rs(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).xn.cs(),Lr("RemoteStore","RemoteStore received new credentials"),n=Qh(e),e.zo.add(3),[4,Ch(e)];case 1:return t.sent(),n&&e.Jo.set("Unknown"),[4,e.jo.va(i)];case 2:return t.sent(),e.zo.delete(3),[4,Vh(e)];case 3:return t.sent(),[2]}})})}(i.Pu,t)}):(s=!0,Lr("FirestoreClient","Initializing. user=",t.uid),i.mh(e,n,r,t,o).then(i.dh.resolve,i.dh.reject))}),this.xn.Qn(function(){return i.dh.promise}),o.promise},nf.prototype.enableNetwork=function(){var e=this;return this.wh(),this.xn.enqueue(function(){return e.persistence.xc(!0),(t=e.Pu).zo.delete(0),Vh(t);var t})},nf.prototype.mh=function(r,i,o,s,u){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={xn:this.xn,na:this.na,clientId:this.clientId,credentials:this.credentials,Aa:s,Vu:100,persistenceSettings:o},[4,r.initialize(e)];case 1:return t.sent(),[4,i.initialize(r,e)];case 2:return t.sent(),this.persistence=r.persistence,this.gu=r.gu,this.Bo=r.Bo,this.Ta=r.Ta,this.Qo=i.Qo,this.Pu=i.Pu,this.ga=i.ga,this.Th=i.pu,this.Th.Es=ac.bind(null,this.ga),this.Th.Rs=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).bu.get(o),1<(r=e.Su.get(n.targetId)).length?[2,(e.Su.set(n.targetId,r.filter(function(t){return!Pu(t,o)})),void e.bu.delete(o))]:e.Mu?(e.gu.Ks(n.targetId),e.gu.Xs(n.targetId)?[3,2]:[4,sh(e.Bo,n.targetId,!1).then(function(){e.gu.Ys(n.targetId),xh(e.Pu,n.targetId),dc(e,n.targetId)}).catch(ah)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return dc(e,n.targetId),[4,sh(e.Bo,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,this.ga),this.persistence.kc(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),u.resolve(),[3,4];case 3:if(e=t.sent(),u.reject(e),!this.Eh(e))throw e;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),this.mh(new el,new nl,{Ra:!1},s,u))];case 4:return[2]}})})},nf.prototype.Eh=function(t){return"FirebaseError"===t.name?t.code===Tr.FAILED_PRECONDITION||t.code===Tr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},nf.prototype.wh=function(){if(this.xn.Zn)throw new Ar(Tr.FAILED_PRECONDITION,"The client has already been terminated.")},nf.prototype.disableNetwork=function(){var t=this;return this.wh(),this.xn.enqueue(function(){return t.persistence.xc(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).zo.add(0),[4,Ch(e)];case 1:return t.sent(),e.Jo.set("Offline"),[2]}})})}(t.Pu)})},nf.prototype.terminate=function(){var t=this;this.xn.ss();var n=new fa;return this.xn.ts(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.Ta&&this.Ta.stop(),[4,jh(this.Pu)];case 1:return t.sent(),[4,this.gu.ei()];case 2:return t.sent(),[4,this.persistence.ei()];case 3:return t.sent(),this.credentials.Wr(),n.resolve(),[3,5];case 4:return e=t.sent(),e=Ta(e,"Failed to shutdown persistence"),n.reject(e),[3,5];case 5:return[2]}})})}),n.promise},nf.prototype.waitForPendingWrites=function(){var t=this;this.wh();var e=new fa;return this.xn.Qn(function(){return function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:Qh((n=o).Pu)||Lr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Bo).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.hi.Gu(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.ku.get(r)||[]).push(s),n.ku.set(r,i),[3,4]);case 3:return i=t.sent(),i=Ta(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}(t.ga,e)}),e.promise},nf.prototype.listen=function(t,e,n){var r=this;this.wh();var i=new rl(n),o=new La(t,i,e);return this.xn.Qn(function(){return Ra(r.Th,o)}),function(){i.Sa(),r.xn.Qn(function(){return Sa(r.Th,o)})}},nf.prototype.Ih=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.wh(),[4,this.dh.promise];case 1:return t.sent(),e=new fa,[2,(this.xn.Qn(function(){return function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.er._i(t,e)}))];case 1:return(r=t.sent())instanceof pu?s.resolve(r):r instanceof du?s.resolve(null):s.reject(new Ar(Tr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),r=Ta(r,"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(n.Bo,r,e)}),e.promise)]}})})},nf.prototype.Ah=function(h,c){return void 0===c&&(c={}),y(this,void 0,void 0,function(){var e,a=this;return v(this,function(t){switch(t.label){case 0:return this.wh(),[4,this.dh.promise];case 1:return t.sent(),e=new fa,[2,(this.xn.Qn(function(){return n=a.Th,r=a.xn,i=h,o=c,s=e,t=new rl({next:function(t){r.Qn(function(){return Sa(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Ar(Tr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Ar(Tr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new La(bu(i.path),t,{includeMetadataChanges:!0,bs:!0}),Ra(n,u);var n,r,i,o,s,t,u}),e.promise)]}})})},nf.prototype.Rh=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.wh(),[4,this.dh.promise];case 1:return t.sent(),e=new fa,[2,(this.xn.Qn(function(){return function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,uh(r,i,!0)];case 1:return n=t.sent(),e=new rc(i,n.gr),n=e.lu(n.documents),n=e.wu(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),n=Ta(n,"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(n.Bo,r,e)}),e.promise)]}})})},nf.prototype.yh=function(h,c){return void 0===c&&(c={}),y(this,void 0,void 0,function(){var u,a=this;return v(this,function(t){switch(t.label){case 0:return this.wh(),[4,this.dh.promise];case 1:return t.sent(),u=new fa,[2,(this.xn.Qn(function(){return e=a.Th,n=a.xn,t=h,r=c,i=u,o=new rl({next:function(t){n.Qn(function(){return Sa(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Ar(Tr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new La(t,o,{includeMetadataChanges:!0,bs:!0}),Ra(e,s);var e,n,t,r,i,o,s}),u.promise)]}})})},nf.prototype.write=function(t){var e=this;this.wh();var n=new fa;return this.xn.Qn(function(){return hc(e.ga,t,n)}),n.promise},nf.prototype.B=function(){return this.na.B},nf.prototype.Ph=function(t){var e=this;this.wh();var r=new rl(t);return this.xn.Qn(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,(e=this.Th,n=r,e.Ts.add(n),void n.next())];var e,n})})}),function(){r.Sa(),e.xn.Qn(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,void this.Th.Ts.delete(r)]})})})}},Object.defineProperty(nf.prototype,"ph",{get:function(){return this.xn.Zn},enumerable:!1,configurable:!0}),nf.prototype.transaction=function(t){var e=this;this.wh();var n=new fa;return this.xn.Qn(function(){return new tf(e.xn,e.Qo,t,n).run(),Promise.resolve()}),n.promise},nf);function nf(t,e){this.credentials=t,this.xn=e,this.clientId=pi.k(),this.dh=new fa}function rf(t,e,n,r){this.xn=t,this.Qo=e,this.updateFunction=n,this.Ln=r,this.ah=5,this.Jn=new pa(this.xn,"transaction_retry")}function of(t){this.Qo=t,this.th=new Map,this.mutations=[],this.eh=!1,this.nh=null,this.sh=new Set}function sf(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var uf,af,hf=(Sf.prototype.Sh=function(t){switch(_o(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Fo(t.integerValue||t.doubleValue);case 3:return this.Ch(t.timestampValue);case 4:return this.Dh(t);case 5:return t.stringValue;case 6:return this.bh(Bo(t.bytesValue));case 7:return this.Fh(t.referenceValue);case 8:return this.Nh(t.geoPointValue);case 9:return this.$h(t.arrayValue);case 10:return this.kh(t.mapValue);default:throw Ur()}},Sf.prototype.kh=function(t){var n=this,r={};return Cr(t.fields||{},function(t,e){r[t]=n.Sh(e)}),r},Sf.prototype.Nh=function(t){return new Tl(Fo(t.latitude),Fo(t.longitude))},Sf.prototype.$h=function(t){var e=this;return(t.values||[]).map(function(t){return e.Sh(t)})},Sf.prototype.Dh=function(t){switch(this.gh){case"previous":var e=function t(e){e=e.mapValue.fields.__previous_value__;return Po(e)?t(e):e}(t);return null==e?null:this.Sh(e);case"estimate":return this.Ch(ko(t));default:return null}},Sf.prototype.Ch=function(t){t=qo(t),t=new Di(t.seconds,t.nanos);return this.timestampsInSnapshots?t:t.toDate()},Sf.prototype.Fh=function(t){var e=qr.P(t);_r(ds(e));t=new Ri(e.get(1),e.get(3)),e=new Gr(e.u(5));return t.isEqual(this.B)||Or("Document "+e+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+this.B.projectId+"/"+this.B.database+") instead."),this.Vh(e)},Sf),cf=Fa.xi,lf=(Rf.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Rf),ff=(Object.defineProperty(Nf.prototype,"Gh",{get:function(){return this.zh||(this.zh=new Ml(this.Ba,this.Wh.ignoreUndefinedProperties)),this.zh},enumerable:!1,configurable:!0}),Nf.prototype.settings=function(t){Yr("Firestore.settings",arguments,1),Zr("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.Wh),t)).merge;t=new lf(t);if(this.Uh&&!this.Wh.isEqual(t))throw new Ar(Tr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Wh=t).credentials&&(this.jh=function(t){if(!t)return new vh;switch(t.type){case"gapi":var e=t.client;return _r(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new wh(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Ar(Tr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Nf.prototype.enableNetwork=function(){return this.qh(),this.Uh.enableNetwork()},Nf.prototype.disableNetwork=function(){return this.qh(),this.Uh.disableNetwork()},Nf.prototype.enablePersistence=function(t){var e;if(this.Uh)throw new Ar(Tr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var n=!1,r=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Or("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),n=null!==(e=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==e&&e,r=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,n&&r))throw new Ar(Tr.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Kh(this.xh,this.Oh,{Ra:!0,cacheSizeBytes:this.Wh.cacheSizeBytes,synchronizeTabs:n,Hh:r})},Nf.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){var n,e=this;return v(this,function(t){if(void 0!==this.Uh&&!this.Uh.ph)throw new Ar(Tr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new fa,[2,(this.Lh.ts(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.xh.clearPersistence(this.Ba,this.Qh)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},Nf.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Nf.prototype,"Yh",{get:function(){return this.qh(),this.Uh.ph},enumerable:!1,configurable:!0}),Nf.prototype.waitForPendingWrites=function(){return this.qh(),this.Uh.waitForPendingWrites()},Nf.prototype.onSnapshotsInSync=function(t){if(this.qh(),sf(t))return this.Uh.Ph(t);Zr("Firestore.onSnapshotsInSync","function",1,t);t={next:t};return this.Uh.Ph(t)},Nf.prototype.qh=function(){return this.Uh||this.Kh(new el,new nl,{Ra:!1}),this.Uh},Nf.prototype.Jh=function(){return new Ti(this.Ba,this.Qh,this.Wh.host,this.Wh.ssl,this.Wh.experimentalForceLongPolling)},Nf.prototype.Kh=function(t,e,n){var r=this.Jh();return this.Uh=new ef(this.jh,this.Lh),this.Uh.start(r,t,e,n)},Nf.Bh=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Ar(Tr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,t=t.options.projectId;if(!t||"string"!=typeof t)throw new Ar(Tr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Ri(t)},Object.defineProperty(Nf.prototype,"app",{get:function(){if(!this.Mh)throw new Ar(Tr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Mh},enumerable:!1,configurable:!0}),Nf.prototype.collection=function(t){return Yr("Firestore.collection",arguments,1),Zr("Firestore.collection","non-empty string",1,t),this.qh(),new Vf(qr.P(t),this,null)},Nf.prototype.doc=function(t){return Yr("Firestore.doc",arguments,1),Zr("Firestore.doc","non-empty string",1,t),this.qh(),yf.Xh(qr.P(t),this,null)},Nf.prototype.collectionGroup=function(t){if(Yr("Firestore.collectionGroup",arguments,1),Zr("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.qh(),new Uf((t=t,new vu(qr.p(),t)),this,null)},Nf.prototype.runTransaction=function(e){var n=this;return Yr("Firestore.runTransaction",arguments,1),Zr("Firestore.runTransaction","function",1,e),this.qh().transaction(function(t){return e(new pf(n,t))})},Nf.prototype.batch=function(){return this.qh(),new df(this)},Object.defineProperty(Nf,"logLevel",{get:function(){switch(Dr()){case u.DEBUG:return"debug";case u.ERROR:return"error";case u.SILENT:return"silent";case u.WARN:return"warn";case u.INFO:return"info";case u.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),Nf.setLogLevel=function(t){Yr("Firestore.setLogLevel",arguments,1),ri("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Rr.setLogLevel(t)},Nf.prototype.Zh=function(){return this.Wh.timestampsInSnapshots},Nf.prototype.tl=function(){return this.Wh},Nf),pf=(Af.prototype.get=function(t){var e=this;Yr("Transaction.get",arguments,1);var n=Bf("Transaction.get",t,this.el);return this.nl.ih([n.Qa]).then(function(t){if(!t||1!==t.length)return Ur();t=t[0];if(t instanceof du)return new gf(e.el,n.Qa,null,!1,!1,n.ja);if(t instanceof pu)return new gf(e.el,n.Qa,t,!1,!1,n.ja);throw Ur()})},Af.prototype.set=function(t,e,n){Jr("Transaction.set",arguments,2,3);t=Bf("Transaction.set",t,this.el);n=xf("Transaction.set",n);e=Gf(t.ja,e,n),n=Fl(this.el.Gh,"Transaction.set",t.Qa,e,null!==t.ja,n);return this.nl.set(t.Qa,n),this},Af.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return e="string"==typeof e||e instanceof ol?(Kr("Transaction.update",arguments,3),r=Bf("Transaction.update",t,this.el),Gl(this.el.Gh,"Transaction.update",r.Qa,e,n,i)):(Yr("Transaction.update",arguments,2),r=Bf("Transaction.update",t,this.el),Bl(this.el.Gh,"Transaction.update",r.Qa,e)),this.nl.update(r.Qa,e),this},Af.prototype.delete=function(t){Yr("Transaction.delete",arguments,1);t=Bf("Transaction.delete",t,this.el);return this.nl.delete(t.Qa),this},Af),df=(Tf.prototype.set=function(t,e,n){Jr("WriteBatch.set",arguments,2,3),this.rl();t=Bf("WriteBatch.set",t,this.el);n=xf("WriteBatch.set",n);e=Gf(t.ja,e,n),n=Fl(this.el.Gh,"WriteBatch.set",t.Qa,e,null!==t.ja,n);return this.sl=this.sl.concat(n.Wa(t.Qa,Cs.He())),this},Tf.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return this.rl(),e="string"==typeof e||e instanceof ol?(Kr("WriteBatch.update",arguments,3),r=Bf("WriteBatch.update",t,this.el),Gl(this.el.Gh,"WriteBatch.update",r.Qa,e,n,i)):(Yr("WriteBatch.update",arguments,2),r=Bf("WriteBatch.update",t,this.el),Bl(this.el.Gh,"WriteBatch.update",r.Qa,e)),this.sl=this.sl.concat(e.Wa(r.Qa,Cs.exists(!0))),this},Tf.prototype.delete=function(t){Yr("WriteBatch.delete",arguments,1),this.rl();t=Bf("WriteBatch.delete",t,this.el);return this.sl=this.sl.concat(new nu(t.Qa,Cs.He())),this},Tf.prototype.commit=function(){return this.rl(),this.il=!0,0<this.sl.length?this.el.qh().write(this.sl):Promise.resolve()},Tf.prototype.rl=function(){if(this.il)throw new Ar(Tr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Tf),yf=(n(If,af=Rl),If.Xh=function(t,e,n){if(t.length%2!=0)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.R()+" has "+t.length);return new If(new Gr(t),e,n)},Object.defineProperty(If.prototype,"id",{get:function(){return this.Qa.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(If.prototype,"parent",{get:function(){return new Vf(this.Qa.path.h(),this.firestore,this.ja)},enumerable:!1,configurable:!0}),Object.defineProperty(If.prototype,"path",{get:function(){return this.Qa.path.R()},enumerable:!1,configurable:!0}),If.prototype.collection=function(t){if(Yr("DocumentReference.collection",arguments,1),Zr("DocumentReference.collection","non-empty string",1,t),!t)throw new Ar(Tr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");t=qr.P(t);return new Vf(this.Qa.path.child(t),this.firestore,null)},If.prototype.isEqual=function(t){if(!(t instanceof If))throw hi("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Qa.isEqual(t.Qa)&&this.ja===t.ja},If.prototype.set=function(t,e){Jr("DocumentReference.set",arguments,1,2),e=xf("DocumentReference.set",e);t=Gf(this.ja,t,e),e=Fl(this.firestore.Gh,"DocumentReference.set",this.Qa,t,null!==this.ja,e);return this.Uh.write(e.Wa(this.Qa,Cs.He()))},If.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return t="string"==typeof t||t instanceof ol?(Kr("DocumentReference.update",arguments,2),Gl(this.firestore.Gh,"DocumentReference.update",this.Qa,t,e,n)):(Yr("DocumentReference.update",arguments,1),Bl(this.firestore.Gh,"DocumentReference.update",this.Qa,t)),this.Uh.write(t.Wa(this.Qa,Cs.exists(!0)))},If.prototype.delete=function(){return Yr("DocumentReference.delete",arguments,0),this.Uh.write([new nu(this.Qa,Cs.He())])},If.prototype.onSnapshot=function(){for(var e=this,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];Jr("DocumentReference.onSnapshot",arguments,1,4);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||sf(n[i])||(ai("DocumentReference.onSnapshot",r=n[i],["includeMetadataChanges"]),ei("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};sf(n[i])?(s=n[i],n[i]=null===(r=s.next)||void 0===r?void 0:r.bind(s),n[i+1]=null===(r=s.error)||void 0===r?void 0:r.bind(s),n[i+2]=null===(r=s.complete)||void 0===r?void 0:r.bind(s)):(Zr("DocumentReference.onSnapshot","function",i,n[i]),$r("DocumentReference.onSnapshot","function",i+1,n[i+1]),$r("DocumentReference.onSnapshot","function",i+2,n[i+2]));var s={next:function(t){n[i]&&n[i](e.ol(t))},error:n[i+1],complete:n[i+2]};return this.Uh.listen(bu(this.Qa.path),o,s)},If.prototype.get=function(t){var e=this;Jr("DocumentReference.get",arguments,0,1),Ff("DocumentReference.get",t);var n=this.firestore.qh();return t&&"cache"===t.source?n.Ih(this.Qa).then(function(t){return new gf(e.firestore,e.Qa,t,!0,t instanceof pu&&t.Ye,e.ja)}):n.Ah(this.Qa,t).then(function(t){return e.ol(t)})},If.prototype.withConverter=function(t){return new If(this.Qa,this.firestore,t)},If.prototype.ol=function(t){var e=t.docs.get(this.Qa);return new gf(this.firestore,this.Qa,e,t.fromCache,t.hasPendingWrites,this.ja)},If),vf=(Ef.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Ef),gf=(bf.prototype.data=function(t){var e=this;if(Jr("DocumentSnapshot.data",arguments,0,1),t=qf("DocumentSnapshot.data",t),this.ul){if(this.ja){var n=new mf(this.el,this.Qa,this.ul,this.cl,this.al,null);return this.ja.fromFirestore(n,t)}return new hf(this.el.Ba,this.el.Zh(),t.serverTimestamps||"none",function(t){return new yf(t,e.el,null)},function(t){return new Ni(t)}).Sh(this.ul.sn())}},bf.prototype.get=function(t,e){var n=this;if(Jr("DocumentSnapshot.get",arguments,1,2),e=qf("DocumentSnapshot.get",e),this.ul){t=this.ul.data().field(Yl("DocumentSnapshot.get",t,this.Qa));if(null!==t)return new hf(this.el.Ba,this.el.Zh(),e.serverTimestamps||"none",function(t){return new yf(t,n.el,n.ja)},function(t){return new Ni(t)}).Sh(t)}},Object.defineProperty(bf.prototype,"id",{get:function(){return this.Qa.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(bf.prototype,"ref",{get:function(){return new yf(this.Qa,this.el,this.ja)},enumerable:!1,configurable:!0}),Object.defineProperty(bf.prototype,"exists",{get:function(){return null!==this.ul},enumerable:!1,configurable:!0}),Object.defineProperty(bf.prototype,"metadata",{get:function(){return new vf(this.al,this.cl)},enumerable:!1,configurable:!0}),bf.prototype.isEqual=function(t){if(!(t instanceof bf))throw hi("isEqual","DocumentSnapshot",1,t);return this.el===t.el&&this.cl===t.cl&&this.Qa.isEqual(t.Qa)&&(null===this.ul?null===t.ul:this.ul.isEqual(t.ul))&&this.ja===t.ja},bf),mf=(n(wf,uf=gf),wf.prototype.data=function(t){return uf.prototype.data.call(this,t)},wf);function wf(){return null!==uf&&uf.apply(this,arguments)||this}function bf(t,e,n,r,i,o){this.el=t,this.Qa=e,this.ul=n,this.cl=r,this.al=i,this.ja=o}function Ef(t,e){this.hasPendingWrites=t,this.fromCache=e}function If(t,e,n){var r=this;return(r=af.call(this,e.Ba,t,n)||this).Qa=t,r.firestore=e,r.ja=n,r.Uh=r.firestore.qh(),r}function Tf(t){this.el=t,this.sl=[],this.il=!1}function Af(t,e){this.el=t,this.nl=e}function Nf(t,e,n,r){var i=this;if(void 0===n&&(n=new el),void 0===r&&(r=new nl),this.xh=n,this.Oh=r,this.Mh=null,this.Lh=new ba,this.INTERNAL={delete:function(){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.qh(),[4,this.Uh.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){r=t;this.Mh=r,this.Ba=Nf.Bh(r),this.Qh=r.name,this.jh=new gh(e)}else{t=t;if(!t.projectId)throw new Ar(Tr.INVALID_ARGUMENT,"Must provide projectId");this.Ba=new Ri(t.projectId,t.database),this.Qh="[DEFAULT]",this.jh=new vh}this.Wh=new lf({})}function Rf(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Ar(Tr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else ti("settings","non-empty string","host",t.host),this.host=t.host,ei("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(ai("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),ei("settings","object","credentials",t.credentials),this.credentials=t.credentials,ei("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),ei("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Or("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Or("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(e=t.timestampsInSnapshots)||void 0===e||e,this.ignoreUndefinedProperties=null!==(e=t.ignoreUndefinedProperties)&&void 0!==e&&e,ei("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Fa.Mi;else{if(t.cacheSizeBytes!==cf&&t.cacheSizeBytes<Fa.Oi)throw new Ar(Tr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Fa.Oi);this.cacheSizeBytes=t.cacheSizeBytes}ei("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(t=t.experimentalForceLongPolling)&&void 0!==t&&t}function Sf(t,e,n,r,i){this.B=t,this.timestampsInSnapshots=e,this.gh=n,this.Vh=r,this.bh=i}function Df(t,e,n){if("string"==typeof n){if(""===n)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Nu(e)&&-1!==n.indexOf("/"))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(qr.P(n));if(!Gr.N(e))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Go(t,new Gr(e))}if(n instanceof Rl)return Go(t,n.Qa);throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+si(n)+".")}function Lf(t,e){if(!Array.isArray(t)||0===t.length)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function Of(t,e,n){if(!n.isEqual(e))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Pf(t){if(Iu(t)&&0===t.rn.length)throw new Ar(Tr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var kf,Uf=(Mf.prototype.where=function(t,e,n){Yr("Query.where",arguments,3),ui("Query.where",3,n);e=ri("Query.where",["<","<=","==","!=",">=",">","array-contains","in","array-contains-any","not-in"],2,e),t=Yl("Query.where",t),e=function(t,e,n,r,i,o,s){if(i.V()){if("array-contains"===o||"array-contains-any"===o)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Lf(s,o);for(var u=[],a=0,h=s;a<h.length;a++){var c=h[a];u.push(Df(r,t,c))}l={arrayValue:{values:u}}}else l=Df(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Lf(s,o),l=Ql(n,e,s,"in"===o||"not-in"===o);var l=ju.create(i,o,l);return function(t,e){if(e.an()){var n=Au(t);if(null!==n&&!n.isEqual(e.field))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=Tu(t);null!==n&&Of(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new Ar(Tr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Ar(Tr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,l),l}(this.hl,"Query.where",this.firestore.Gh,this.firestore.Ba,t,e,n);return new Mf((n=this.hl,e=n.filters.concat([e]),new vu(n.path,n.collectionGroup,n.rn.slice(),e,n.limit,n.on,n.startAt,n.endAt)),this.firestore,this.ja)},Mf.prototype.orderBy=function(t,e){if(Jr("Query.orderBy",arguments,1,2),$r("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Ar(Tr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=Yl("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new la(e,n);return e=r,null!==Tu(n=t)||null!==(t=Au(n))&&Of(0,t,e.field),r}(this.hl,t,n);return new Mf((n=this.hl,t=n.rn.concat([t]),new vu(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.on,n.startAt,n.endAt)),this.firestore,this.ja)},Mf.prototype.limit=function(t){return Yr("Query.limit",arguments,1),Zr("Query.limit","number",1,t),ci("Query.limit",1,t),new Mf(Du(this.hl,t,"F"),this.firestore,this.ja)},Mf.prototype.limitToLast=function(t){return Yr("Query.limitToLast",arguments,1),Zr("Query.limitToLast","number",1,t),ci("Query.limitToLast",1,t),new Mf(Du(this.hl,t,"L"),this.firestore,this.ja)},Mf.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Kr("Query.startAt",arguments,1);t=this.ll("Query.startAt",t,e,!0);return new Mf(Lu(this.hl,t),this.firestore,this.ja)},Mf.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Kr("Query.startAfter",arguments,1);t=this.ll("Query.startAfter",t,e,!1);return new Mf(Lu(this.hl,t),this.firestore,this.ja)},Mf.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Kr("Query.endBefore",arguments,1);t=this.ll("Query.endBefore",t,e,!0);return new Mf(Ou(this.hl,t),this.firestore,this.ja)},Mf.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Kr("Query.endAt",arguments,1);t=this.ll("Query.endAt",t,e,!1);return new Mf(Ou(this.hl,t),this.firestore,this.ja)},Mf.prototype.isEqual=function(t){if(!(t instanceof Mf))throw hi("isEqual","Query",1,t);return this.firestore===t.firestore&&Pu(this.hl,t.hl)&&this.ja===t.ja},Mf.prototype.withConverter=function(t){return new Mf(this.hl,this.firestore,t)},Mf.prototype.ll=function(h,t,e,n){if(ui(h,1,t),t instanceof gf)return Yr(h,i([t],e),1),function(t,e,n,r){if(!n)throw new Ar(Tr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+h+"().");for(var i=[],o=0,s=Ru(t);o<s.length;o++){var u=s[o];if(u.field.V())i.push(Go(e,n.key));else{var a=n.field(u.field);if(Po(a))throw new Ar(Tr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.R();throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new ra(i,r)}(this.hl,this.firestore.Ba,t.ul,n);e=[t].concat(e);return function(t,e,n,r,i,o){var s=t.rn;if(i.length>s.length)throw new Ar(Tr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.V()){if("string"!=typeof h)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!Nu(t)&&-1!==h.indexOf("/"))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(qr.P(h));if(!Gr.N(c))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");c=new Gr(c);u.push(Go(e,c))}else{h=Ql(n,r,h);u.push(h)}}return new ra(u,o)}(this.hl,this.firestore.Ba,this.firestore.Gh,h,e,n)},Mf.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Jr("Query.onSnapshot",arguments,1,4);var i={},o=0;"object"!=typeof n[o]||sf(n[o])||(ai("Query.onSnapshot",i=n[o],["includeMetadataChanges"]),ei("Query.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),o++),sf(n[o])?(s=n[o],n[o]=null===(t=s.next)||void 0===t?void 0:t.bind(s),n[o+1]=null===(t=s.error)||void 0===t?void 0:t.bind(s),n[o+2]=null===(t=s.complete)||void 0===t?void 0:t.bind(s)):(Zr("Query.onSnapshot","function",o,n[o]),$r("Query.onSnapshot","function",o+1,n[o+1]),$r("Query.onSnapshot","function",o+2,n[o+2]));var s={next:function(t){n[o]&&n[o](new _f(e.firestore,e.hl,t,e.ja))},error:n[o+1],complete:n[o+2]};return Pf(this.hl),this.firestore.qh().listen(this.hl,i,s)},Mf.prototype.get=function(t){var e=this;Jr("Query.get",arguments,0,1),Ff("Query.get",t),Pf(this.hl);var n=this.firestore.qh();return(t&&"cache"===t.source?n.Rh(this.hl):n.yh(this.hl,t)).then(function(t){return new _f(e.firestore,e.hl,t,e.ja)})},Mf),_f=(Object.defineProperty(jf.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(jf.prototype,"empty",{get:function(){return this.fl.docs.m()},enumerable:!1,configurable:!0}),Object.defineProperty(jf.prototype,"size",{get:function(){return this.fl.docs.size},enumerable:!1,configurable:!0}),jf.prototype.forEach=function(e,n){var r=this;Jr("QuerySnapshot.forEach",arguments,1,2),Zr("QuerySnapshot.forEach","function",1,e),this.fl.docs.forEach(function(t){e.call(n,r.ml(t,r.metadata.fromCache,r.fl.Qt.has(t.key)))})},Object.defineProperty(jf.prototype,"query",{get:function(){return new Uf(this._l,this.el,this.ja)},enumerable:!1,configurable:!0}),jf.prototype.docChanges=function(t){t&&(ai("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),ei("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));t=!(!t||!t.includeMetadataChanges);if(t&&this.fl.Wt)throw new Ar(Tr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.dl&&this.wl===t||(this.dl=function(i,e,o){if(i.Bt.m()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Bt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ur()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this.fl,t,this.ml.bind(this)),this.wl=t),this.dl},jf.prototype.isEqual=function(t){if(!(t instanceof jf))throw hi("isEqual","QuerySnapshot",1,t);return this.el===t.el&&Pu(this._l,t._l)&&this.fl.isEqual(t.fl)&&this.ja===t.ja},jf.prototype.ml=function(t,e,n){return new mf(this.el,t.key,t,e,n,this.ja)},jf),Vf=(n(Cf,kf=Uf),Object.defineProperty(Cf.prototype,"id",{get:function(){return this.hl.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Cf.prototype,"parent",{get:function(){var t=this.hl.path.h();return t.m()?null:new yf(new Gr(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Cf.prototype,"path",{get:function(){return this.hl.path.R()},enumerable:!1,configurable:!0}),Cf.prototype.doc=function(t){Jr("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=pi.k()),Zr("CollectionReference.doc","non-empty string",1,t);t=qr.P(t);return yf.Xh(this.hl.path.child(t),this.firestore,this.ja)},Cf.prototype.add=function(t){Yr("CollectionReference.add",arguments,1);t=this.ja?this.ja.toFirestore(t):t;Zr("CollectionReference.add","object",1,t);var e=this.doc();return new yf(e.Qa,this.firestore,null).set(t).then(function(){return e})},Cf.prototype.withConverter=function(t){return new Cf(this.Tl,this.firestore,t)},Cf);function Cf(t,e,n){var r=this;if(((r=kf.call(this,bu(t),e,n)||this).Tl=t).length%2!=1)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.R()+" has "+t.length);return r}function jf(t,e,n,r){this.el=t,this._l=e,this.fl=n,this.ja=r,this.dl=null,this.wl=null,this.metadata=new vf(n.hasPendingWrites,n.fromCache)}function Mf(t,e,n){this.hl=t,this.firestore=e,this.ja=n}function xf(t,e){if(void 0===e)return{merge:!1};if(ai(t,e,["merge","mergeFields"]),ei(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n,r){if(!(n instanceof Array))throw new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+si(n));for(var i=0;i<n.length;++i)if(!r(n[i]))throw new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+si(n[i]))}(t,"mergeFields",n,function(t){return"string"==typeof t||t instanceof ol}),void 0!==e.mergeFields&&void 0!==e.merge)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function qf(t,e){return void 0===e?{}:(ai(t,e,["serverTimestamps"]),ni(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Ff(t,e){$r(t,"object",1,e),e&&(ai(t,e,["source"]),ni(t,0,"source",e.source,["default","server","cache"]))}function Bf(t,e,n){if(e instanceof Rl){if(e.firestore!==n)throw new Ar(Tr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw hi(t,"DocumentReference",1,e)}function Gf(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Qf,zf,l=(n(Hf,Qf=Al),Hf.serverTimestamp=function(){Xr("FieldValue.serverTimestamp",arguments);var t=new wl("serverTimestamp");return t.Da="FieldValue.serverTimestamp",new Hf(t)},Hf.delete=function(){Xr("FieldValue.delete",arguments);var t=new al("deleteField");return t.Da="FieldValue.delete",new Hf(t)},Hf.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Kr("FieldValue.arrayUnion",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Kr("arrayUnion()",arguments,1),new bl("arrayUnion",t)}.apply(void 0,t);return n.Da="FieldValue.arrayUnion",new Hf(n)},Hf.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Kr("FieldValue.arrayRemove",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Kr("arrayRemove()",arguments,1),new El("arrayRemove",t)}.apply(void 0,t);return n.Da="FieldValue.arrayRemove",new Hf(n)},Hf.increment=function(t){Zr("FieldValue.increment","number",1,t),Yr("FieldValue.increment",arguments,1);t=new Il("increment",t);return t.Da="FieldValue.increment",new Hf(t)},Hf.prototype.isEqual=function(t){return this.Ua.isEqual(t.Ua)},Hf),Wf={Firestore:ff,GeoPoint:Tl,Timestamp:Di,Blob:Ni,Transaction:pf,WriteBatch:df,DocumentReference:yf,DocumentSnapshot:gf,Query:Uf,QueryDocumentSnapshot:mf,QuerySnapshot:_f,CollectionReference:Vf,FieldPath:ol,FieldValue:l,setLogLevel:ff.setLogLevel,CACHE_SIZE_UNLIMITED:cf};function Hf(){return null!==Qf&&Qf.apply(this,arguments)||this}(zf=e.default).INTERNAL.registerComponent(new br("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new ff(e,t,new el,new nl);var e},"PUBLIC").setServiceProps(Object.assign({},Wf))),zf.registerVersion("@firebase/firestore","1.17.3-202096215419")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map

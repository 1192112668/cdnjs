!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(cp){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var e,u,n,r=t(cp),i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function o(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function w(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function b(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function a(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(n=u=u||{})[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT";function h(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=f[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,a(["["+i+"]  "+t.name+":"],n))}}var c={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},l=u.INFO,f=((e={})[u.DEBUG]="log",e[u.VERBOSE]="log",e[u.INFO]="info",e[u.WARN]="warn",e[u.ERROR]="error",e),p=(Object.defineProperty(d.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),d.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?c[t]:t},Object.defineProperty(d.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),d.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.DEBUG],t)),this._logHandler.apply(this,a([this,u.DEBUG],t))},d.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.VERBOSE],t)),this._logHandler.apply(this,a([this,u.VERBOSE],t))},d.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.INFO],t)),this._logHandler.apply(this,a([this,u.INFO],t))},d.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.WARN],t)),this._logHandler.apply(this,a([this,u.WARN],t))},d.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,a([this,u.ERROR],t)),this._logHandler.apply(this,a([this,u.ERROR],t))},d);function d(t){this.name=t,this._logLevel=l,this._logHandler=h,this._userLogHandler=null}function v(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var y,g="FirebaseError",m=(o(E,y=Error),E);function E(t,e){var n=y.call(this,e)||this;return n.code=t,n.name=g,Object.setPrototypeOf(n,E.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,I.prototype.create),n}var I=(T.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(r=i,s.replace(A,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new m(o,a),c=0,l=Object.keys(i);c<l.length;c++){var f=l[c];"_"!==f.slice(-1)&&(f in h&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),h[f]=i[f])}return h},T);function T(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var A=/\{\$([^}]+)}/g,N=function(t,e){return(N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function R(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var S,O="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},k={},L=O||self;function D(){}function P(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function _(t){var e=P(t);return"array"==e||"object"==e&&"number"==typeof t.length}function U(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var V="closure_uid_"+(1e9*Math.random()>>>0),C=0;function M(t,e,n){return t.call.apply(t.bind,arguments)}function j(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function x(t,e,n){return(x=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?M:j).apply(null,arguments)}function q(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var F=Date.now;function G(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function z(){this.j=this.j,this.i=this.i}z.prototype.j=!1,z.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,V)&&t[V]||(t[V]=++C))},z.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var B=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Q=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function W(t){return Array.prototype.concat.apply([],arguments)}function H(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function K(t){return/^[\s\xa0]*$/.test(t)}var Y,X=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function J(t,e){return-1!=t.indexOf(e)}function Z(t,e){return t<e?-1:e<t?1:0}t:{var $=L.navigator;if($){var tt=$.userAgent;if(tt){Y=tt;break t}}Y=""}function et(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function nt(t){var e,n={};for(e in t)n[e]=t[e];return n}var rt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function it(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<rt.length;o++)n=rt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function ot(t){return ot[" "](t),t}ot[" "]=D;var st,ut,at=J(Y,"Opera"),ht=J(Y,"Trident")||J(Y,"MSIE"),ct=J(Y,"Edge"),lt=ct||ht,ft=J(Y,"Gecko")&&!(J(Y.toLowerCase(),"webkit")&&!J(Y,"Edge"))&&!(J(Y,"Trident")||J(Y,"MSIE"))&&!J(Y,"Edge"),pt=J(Y.toLowerCase(),"webkit")&&!J(Y,"Edge");function dt(){var t=L.document;return t?t.documentMode:void 0}t:{var vt="",yt=(ut=Y,ft?/rv:([^\);]+)(\)|;)/.exec(ut):ct?/Edge\/([\d\.]+)/.exec(ut):ht?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ut):pt?/WebKit\/(\S+)/.exec(ut):at?/(?:Version)[ \/]?(\S+)/.exec(ut):void 0);if(yt&&(vt=yt?yt[1]:""),ht){var gt=dt();if(null!=gt&&gt>parseFloat(vt)){st=String(gt);break t}}st=vt}var mt={};function wt(u){return t=u,e=function(){for(var t=0,e=X(String(st)).split("."),n=X(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Z(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Z(0==o[2].length,0==s[2].length)||Z(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=mt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var bt=L.document&&ht?dt()||(parseInt(st,10)||void 0):void 0,Et=!ht||9<=Number(bt),It=ht&&!wt("9"),Tt=function(){if(!L.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{L.addEventListener("test",D,e),L.removeEventListener("test",D,e)}catch(t){}return t}();function At(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Nt(t,e){if(At.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ft){t:{try{ot(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Rt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}At.prototype.b=function(){this.defaultPrevented=!0},G(Nt,At);var Rt={2:"touch",3:"pen",4:"mouse"};Nt.prototype.b=function(){Nt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,It)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var St="closure_listenable_"+(1e6*Math.random()|0),Ot=0;function kt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Ot,this.Y=this.Z=!1}function Lt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Dt(t){this.src=t,this.a={},this.b=0}function Pt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=B(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Lt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function _t(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Dt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=_t(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new kt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Ut="closure_lm_"+(1e6*Math.random()|0),Vt={};function Ct(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=Bt(r);return e&&e[St]?e.wa(n,r,U(i)?!!i.capture:!!i,o):Mt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ct(t,e[o],n,r,i);return null}return n=Bt(n),t&&t[St]?t.va(e,n,U(r)?!!r.capture:!!r,i):Mt(t,e,n,!1,r,i)}function Mt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=U(i)?!!i.capture:!!i;if(s&&!Et)return null;var u,a,h=Gt(t);if(h||(t[Ut]=h=new Dt(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Ft,r=a=Et?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)Tt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(xt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function jt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[St]?Pt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(xt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Gt(e))?(Pt(n,t),0==n.b&&(n.src=null,e[Ut]=null)):Lt(t)))}function xt(t){return t in Vt?Vt[t]:Vt[t]="on"+t}function qt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&jt(t),n.call(r,e)}function Ft(t,e){if(t.Y)return!0;if(Et)return qt(t,new Nt(e,this));if(!e)t:{e=["window","event"];for(var n=L,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return qt(t,e=new Nt(e,this))}function Gt(t){return(t=t[Ut])instanceof Dt?t:null}var zt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Bt(e){return"function"==P(e)?e:(e[zt]||(e[zt]=function(t){return e.handleEvent(t)}),e[zt])}function Qt(){z.call(this),this.c=new Dt(this),(this.J=this).C=null}function Wt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Pt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}G(Qt,z),Qt.prototype[St]=!0,(S=Qt.prototype).addEventListener=function(t,e,n,r){Ct(this,t,e,n,r)},S.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=U(i)?!!i.capture:!!i,r=Bt(r),e&&e[St]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=_t(s=e.a[n],r,i,o))&&(Lt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Gt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=_t(n,r,i,o)),(r=-1<e?n[e]:null)&&jt(r))}(this,t,e,n,r)},S.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new At(t,n):t instanceof At?t.target=t.target||n:(s=t,it(t=new At(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=Wt(o,r,!0,t)&&s;if(s=Wt(o=t.a=n,r,!0,t)&&s,s=Wt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Wt(o=t.a=e[i],r,!1,t)&&s;return s},S.G=function(){if(Qt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Lt(n[r]);delete e.a[t],e.b--}}this.C=null},S.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},S.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ht=L.JSON.stringify;function Kt(){this.b=this.a=null}var Yt,Xt=(Jt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Jt(function(){return new Zt},function(t){t.reset()},100));function Jt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Zt(){this.next=this.b=this.a=null}function $t(t,e){var n;Yt||(n=L.Promise.resolve(void 0),Yt=function(){n.then(ne)}),te||(Yt(),te=!0),ee.add(t,e)}Kt.prototype.add=function(t,e){var n=Xt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Zt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var te=!(Zt.prototype.reset=function(){this.next=this.b=this.a=null}),ee=new Kt;function ne(){for(var t,e,n;n=e=void 0,n=null,(e=ee).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){L.setTimeout(function(){throw t},0)}(t)}var r=Xt;r.g(t),r.b<r.f&&(r.b++,t.next=r.a,r.a=t)}te=!1}function re(t,e){Qt.call(this),this.b=t||1,this.a=e||L,this.f=x(this.Ya,this),this.g=F()}function ie(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function oe(t,e,n){if("function"==P(t))n&&(t=x(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=x(t.handleEvent,t)}return 2147483647<Number(e)?-1:L.setTimeout(t,e||0)}G(re,Qt),(S=re.prototype).aa=!1,S.M=null,S.Ya=function(){var t;this.aa&&(0<(t=F()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(ie(this),this.start())))},S.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=F())},S.G=function(){re.S.G.call(this),ie(this),delete this.a};var se,ue,ae,he=(N(ue=le,ae=se=z),ue.prototype=null===ae?Object.create(ae):(ce.prototype=ae.prototype,new ce),le.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=oe(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},le.prototype.G=function(){se.prototype.G.call(this),this.a&&(L.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},le);function ce(){this.constructor=ue}function le(t,e,n){var r=se.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function fe(t){z.call(this),this.b=t,this.a={}}G(fe,z);var pe=[];function de(t,e,n,r){Array.isArray(n)||(n&&(pe[0]=n.toString()),n=pe);for(var i=0;i<n.length;i++){var o=Ct(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ve(t){et(t.a,function(t,e){this.a.hasOwnProperty(e)&&jt(t)},t),t.a={}}function ye(){this.a=!0}function ge(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Ht(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}fe.prototype.G=function(){fe.S.G.call(this),ve(this)},fe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ye.prototype.info=function(){};var me=null;function we(){return me=me||new Qt}function be(t){At.call(this,"serverreachability",t)}function Ee(t){var e=we();e.dispatchEvent(new be(e))}function Ie(t){At.call(this,"statevent",t)}function Te(t){var e=we();e.dispatchEvent(new Ie(e))}function Ae(t){At.call(this,"timingevent",t)}function Ne(t,e){if("function"!=P(t))throw Error("Fn must not be null and must be a function");return L.setTimeout(function(){t()},e)}G(be,At),G(Ie,At),G(Ae,At);var Re={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Se={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Oe(){}function ke(t){var e;return(e=t.a)||(e=t.a={}),e}function Le(){}Oe.prototype.a=null;var De,Pe={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function _e(){At.call(this,"d")}function Ue(){At.call(this,"c")}function Ve(){}function Ce(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new fe(this),this.P=Me,t=lt?125:void 0,this.R=new re(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}G(_e,At),G(Ue,At),G(Ve,Oe),De=new Ve;var Me=45e3,je={},xe={};function qe(t,e,n){t.H=1,t.i=an(en(e)),t.j=n,t.I=!0,Fe(t,null)}function Fe(t,e){t.u=F(),ze(t),t.l=en(t.i);var s,u,a,h,c,l,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),En(n.b,"t",r),t.D=0,t.a=dr(t.g,t.g.C?e:null),0<t.O&&(t.F=new he(x(t.Ca,t,t.a),t.O)),de(t.J,t.a,"readystatechange",t.Wa),e=t.B?nt(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),Ee(1),s=t.c,u=t.m,a=t.l,h=t.f,c=t.T,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function Ge(t,e,n){for(var r,i,o,s,u=!0;!t.A&&t.D<n.length;){var a=(i=n,s=o=void 0,o=(r=t).D,-1==(s=i.indexOf("\n",o))?xe:(o=Number(i.substring(o,s)),isNaN(o)?je:(s+=1)+o>i.length?xe:(i=i.substr(s,o),r.D=s+o,i)));if(a==xe){4==e&&(t.h=4,Te(14),u=!1),ge(t.c,t.f,null,"[Incomplete Response]");break}if(a==je){t.h=4,Te(15),ge(t.c,t.f,n,"[Invalid Chunk]"),u=!1;break}ge(t.c,t.f,a,null),Ke(t,a)}4==e&&0==n.length&&(t.h=1,Te(16),u=!1),t.b=t.b&&u,u?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),sr(e),e.F=!0)):(ge(t.c,t.f,n,"[Invalid Chunked Response]"),He(t),We(t))}function ze(t){t.U=F()+t.P,Be(t,t.P)}function Be(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ne(x(t.Ua,t),e)}function Qe(t){t.o&&(L.clearTimeout(t.o),t.o=null)}function We(t){0==t.g.v||t.A||hr(t.g,t)}function He(t){Qe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ie(t.R),ve(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ke(t,e){try{var n,r,i,o,s,u,a,h,c,l,f,p=t.g;if(0!=p.v&&(p.a==t||On(p.b,t)))if(p.I=t.N,!t.C&&On(p.b,t)&&3==p.v){try{var d=p.ka.a.parse(e)}catch(t){d=null}if(Array.isArray(d)&&3==d.length){var v=d;if(0==v[0]){t:if(!p.j){if(p.a){if(!(p.a.u+3e3<t.u))break t;ar(p),Jn(p)}or(p),Te(18)}}else p.oa=v[1],0<p.oa-p.P&&v[2]<37500&&p.H&&0==p.o&&!p.m&&(p.m=Ne(x(p.Ra,p),6e3));if(Sn(p.b)<=1&&p.ea){try{p.ea()}catch(t){}p.ea=void 0}}else lr(p,11)}else if(!t.C&&p.a!=t||ar(p),!K(e))for(e=d=p.ka.a.parse(e),d=0;d<e.length;d++){v=e[d],p.P=v[0],v=v[1],2==p.v?"c"==v[0]?(p.J=v[1],p.ga=v[2],null!=(n=v[3])&&(p.ha=n,p.c.info("VER="+p.ha)),null!=(r=v[4])&&(p.pa=r,p.c.info("SVER="+p.pa)),null!=(i=v[5])&&"number"==typeof i&&0<i&&(o=1.5*i,p.D=o,p.c.info("backChannelRequestTimeoutMs_="+o)),o=p,(s=t.a)&&(!(u=s.a?s.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(a=o.b).a&&(J(u,"spdy")||J(u,"quic")||J(u,"h2"))&&(a.f=a.g,a.a=new Set,a.b&&(kn(a,a.b),a.b=null)),!o.A||(h=s.a?s.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(o.na=h,un(o.B,o.A,h))),p.v=3,p.f&&p.f.ta(),p.V&&(p.N=F()-t.u,p.c.info("Handshake RTT: "+p.N+"ms")),c=t,(o=p).la=pr(o,o.C?o.ga:null,o.fa),c.C?(Ln(o.b,c),l=c,(f=o.D)&&l.setTimeout(f),l.o&&(Qe(l),ze(l)),o.a=c):ir(o),0<p.g.length&&tr(p)):"stop"!=v[0]&&"close"!=v[0]||lr(p,7):3==p.v&&("stop"==v[0]||"close"==v[0]?"stop"==v[0]?lr(p,7):Xn(p):"noop"!=v[0]&&p.f&&p.f.sa(v),p.o=0)}Ee(4)}catch(t){}}function Ye(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(_(t)||"string"==typeof t)Q(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(_(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(_(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Xe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Xe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Je(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ze(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Ze(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Ze(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(S=Ce.prototype).setTimeout=function(t){this.P=t},S.Wa=function(t){t=t.target;var e=this.F;e&&3==Wn(t)?e.f():this.Ca(t)},S.Ca=function(t){try{if(t==this.a)t:{var e=Wn(this.a),n=this.a.ua(),r=this.a.X();if(!(e<3||3==e&&!lt&&!this.a.$())){this.A||4!=e||7==n||Ee(8==n||r<=0?3:2),Qe(this);var i=this.a.X();this.N=i;var o=this.a.$();if(this.b=200==i,h=this.c,c=this.m,l=this.l,f=this.f,p=this.T,d=e,v=i,h.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+p+"]: "+c+"\n"+l+"\n"+d+" "+v}),this.b){if(this.V&&!this.C){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.h=3,Te(12),He(this),We(this);break t}ge(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ke(this,a)}this.I?(Ge(this,e,o),lt&&this.b&&3==e&&(de(this.J,this.R,"tick",this.Va),this.R.start())):(ge(this.c,this.f,o,null),Ke(this,o)),4==e&&He(this),this.b&&!this.A&&(4==e?hr(this.g,this):(this.b=!1,ze(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,Te(12)):(this.h=0,Te(13)),He(this),We(this)}}}catch(t){}var h,c,l,f,p,d,v},S.Va=function(){var t,e;this.a&&(t=Wn(this.a),e=this.a.$(),this.D<e.length&&(Qe(this),Ge(this,t,e),this.b&&4!=t&&ze(this)))},S.cancel=function(){this.A=!0,He(this)},S.Ua=function(){this.o=null;var t,e,n=F();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(Ee(3),Te(17)),He(this),this.h=2,We(this)):Be(this,this.U-n)},(S=Xe.prototype).K=function(){Je(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},S.L=function(){return Je(this),this.a.concat()},S.get=function(t,e){return Ze(this.b,t)?this.b[t]:e},S.set=function(t,e){Ze(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},S.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var $e=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function tn(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof tn?(this.a=void 0!==e?e:t.a,nn(this,t.f),this.j=t.j,rn(this,t.c),on(this,t.h),this.g=t.g,e=t.b,(n=new gn).c=e.c,e.a&&(n.a=new Xe(e.a),n.b=e.b),sn(this,n),this.i=t.i):t&&(n=String(t).match($e))?(this.a=!!e,nn(this,n[1]||"",!0),this.j=hn(n[2]||""),rn(this,n[3]||"",!0),on(this,n[4]),this.g=hn(n[5]||"",!0),sn(this,n[6]||"",!0),this.i=hn(n[7]||"")):(this.a=!!e,this.b=new gn(null,this.a))}function en(t){return new tn(t)}function nn(t,e,n){t.f=n?hn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function rn(t,e,n){t.c=n?hn(e,!0):e}function on(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function sn(t,e,n){var r,i;e instanceof gn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(mn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(wn(this,e),En(this,n,t))},r)),r.f=i):(n||(e=cn(e,vn)),t.b=new gn(e,t.a))}function un(t,e,n){t.b.set(e,n)}function an(t){return un(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^F()).toString(36)),t}function hn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function cn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,ln),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function ln(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}tn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(cn(e,fn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(cn(e,fn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(cn(n,"/"==n.charAt(0)?dn:pn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",cn(n,yn)),t.join("")};var fn=/[#\/\?@]/g,pn=/[#\?:]/g,dn=/[#\?]/g,vn=/[#\?@]/g,yn=/#/g;function gn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function mn(n){n.a||(n.a=new Xe,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function wn(t,e){mn(t),e=In(t,e),Ze(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ze((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Je(t)))}function bn(t,e){return mn(t),e=In(t,e),Ze(t.a.b,e)}function En(t,e,n){wn(t,e),0<n.length&&(t.c=null,t.a.set(In(t,e),H(n)),t.b+=n.length)}function In(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function Tn(t,e){this.b=t,this.a=e}function An(t){this.g=t||Nn,t=L.PerformanceNavigationTiming?0<(t=L.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(L.ia&&L.ia.ya&&L.ia.ya()&&L.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(S=gn.prototype).add=function(t,e){mn(this),this.c=null,t=In(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},S.forEach=function(n,r){mn(this),this.a.forEach(function(t,e){Q(t,function(t){n.call(r,t,e,this)},this)},this)},S.L=function(){mn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},S.K=function(t){mn(this);var e=[];if("string"==typeof t)bn(this,t)&&(e=W(e,this.a.get(In(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=W(e,t[n])}return e},S.set=function(t,e){return mn(this),this.c=null,bn(this,t=In(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},S.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},S.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var Nn=10;function Rn(t){return t.b||t.a&&t.a.size>=t.f}function Sn(t){return t.b?1:t.a?t.a.size:0}function On(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function kn(t,e){t.a?t.a.add(e):t.b=e}function Ln(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Dn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return H(t.c);var r=t.c;try{for(var i=R(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Pn(){}function _n(){this.a=new Pn}function Un(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}An.prototype.cancel=function(){var e,t;if(this.c=Dn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=R(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Pn.prototype.stringify=function(t){return L.JSON.stringify(t,void 0)},Pn.prototype.parse=function(t){return L.JSON.parse(t,void 0)};var Vn=L.JSON.parse;function Cn(t){Qt.call(this),this.headers=new Xe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Mn,this.D=this.F=!1}G(Cn,Qt);var Mn="",jn=/^https?$/i,xn=["POST","PUT"];function qn(t){return"content-type"==t.toLowerCase()}function Fn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Gn(t),Bn(t)}function Gn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function zn(t){if(t.b&&void 0!==k&&(!t.s[1]||4!=Wn(t)||2!=t.X()))if(t.l&&4==Wn(t))oe(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==Wn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match($e)[1]||null)&&L.self&&L.self.location&&(i=(r=L.self.location.protocol).substr(0,r.length-1)),n=!jn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Wn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Gn(t)}}finally{Bn(t)}}}function Bn(t,e){if(t.a){Qn(t);var n=t.a,r=t.s[0]?D:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Qn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(L.clearTimeout(t.m),t.m=null)}function Wn(t){return t.a?t.a.readyState:0}function Hn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",et(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):un(t,e,n))}function Kn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Yn(t){this.pa=0,this.g=[],this.c=new ye,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Kn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Kn("baseRetryDelayMs",5e3,t),this.Ma=Kn("retryDelaySeedMs",1e4,t),this.Ja=Kn("forwardChannelMaxRetries",2,t),this.ma=Kn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new An(t&&t.concurrentRequestLimit),this.ka=new _n,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Xn(t){var e,n;Zn(t),3==t.v&&(e=t.R++,un(n=en(t.B),"SID",t.J),un(n,"RID",e),un(n,"TYPE","terminate"),nr(t,n),(e=new Ce(t,t.c,e,void 0)).H=2,e.i=an(en(n)),n=!1,L.navigator&&L.navigator.sendBeacon&&(n=L.navigator.sendBeacon(e.i.toString(),"")),!n&&L.Image&&((new Image).src=e.i,n=!0),n||(e.a=dr(e.g,null),e.a.ba(e.i)),e.u=F(),ze(e)),fr(t)}function Jn(t){t.a&&(sr(t),t.a.cancel(),t.a=null)}function Zn(t){Jn(t),t.j&&(L.clearTimeout(t.j),t.j=null),ar(t),t.b.cancel(),t.h&&("number"==typeof t.h&&L.clearTimeout(t.h),t.h=null)}function $n(t,e){t.g.push(new Tn(t.La++,e)),3==t.v&&tr(t)}function tr(t){Rn(t.b)||t.h||(t.h=!0,$t(t.Ba,t),t.u=0)}function er(t,e){var n=e?e.f:t.R++,r=en(t.B);un(r,"SID",t.J),un(r,"RID",n),un(r,"AID",t.P),nr(t,r),t.i&&t.l&&Hn(r,t.i,t.l),n=new Ce(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=rr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),kn(t.b,n),qe(n,r,e)}function nr(t,n){t.f&&Ye({},function(t,e){un(n,e,t)})}function rr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?x(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{Ye(t,function(t,e){var n=t;U(t)&&(n=Ht(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function ir(t){t.a||t.j||(t.U=1,$t(t.Aa,t),t.o=0)}function or(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=Ne(x(t.Aa,t),cr(t,t.o)),t.o++,1)}function sr(t){null!=t.s&&(L.clearTimeout(t.s),t.s=null)}function ur(t){t.a=new Ce(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=en(t.la);un(e,"RID","rpc"),un(e,"SID",t.J),un(e,"CI",t.H?"0":"1"),un(e,"AID",t.P),nr(t,e),un(e,"TYPE","xmlhttp"),t.i&&t.l&&Hn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=an(en(e)),n.j=null,n.I=!0,Fe(n,t)}function ar(t){null!=t.m&&(L.clearTimeout(t.m),t.m=null)}function hr(t,e){var n,r=null;if(t.a==e){ar(t),sr(t),t.a=null;var i=2}else{if(!On(t.b,e))return;r=e.s,Ln(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=F()-e.u,n=t.u,(i=we()).dispatchEvent(new Ae(i)),tr(t)):ir(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(Sn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=Ne(x(t.Ba,t,e),cr(t,t.u)),t.u++,1}}(t,e)||2==i&&or(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:lr(t,5);break;case 4:lr(t,10);break;case 3:lr(t,6);break;default:lr(t,2)}}function cr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function lr(t,e){var n,r,i,o,s,u;t.c.info("Error code "+e),2==e?(n=null,t.f&&(n=null),r=x(t.Xa,t),n||(n=new tn("//www.google.com/images/cleardot.gif"),L.location&&"http"==L.location.protocol||nn(n,"https"),an(n)),i=n.toString(),o=r,u=new ye,L.Image?((s=new Image).onload=q(Un,u,s,"TestLoadImage: loaded",!0,o),s.onerror=q(Un,u,s,"TestLoadImage: error",!1,o),s.onabort=q(Un,u,s,"TestLoadImage: abort",!1,o),s.ontimeout=q(Un,u,s,"TestLoadImage: timeout",!1,o),L.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=i):o(!1)):Te(2),t.v=0,t.f&&t.f.ra(e),fr(t),Zn(t)}function fr(t){t.v=0,t.I=-1,t.f&&(0==Dn(t.b).length&&0==t.g.length||(t.b.c.length=0,H(t.g),t.g.length=0),t.f.qa())}function pr(t,e,n){var r,i,o,s,u,a,h,c=(r=n)instanceof tn?en(r):new tn(r,void 0);return""!=c.c?(e&&rn(c,e+"."+c.c),on(c,c.h)):(i=L.location,o=i.protocol,s=e?e+"."+i.hostname:i.hostname,u=+i.port,a=n,h=new tn(null,void 0),o&&nn(h,o),s&&rn(h,s),u&&on(h,u),a&&(h.g=a),c=h),t.W&&et(t.W,function(t,e){un(c,e,t)}),e=t.A,n=t.na,e&&n&&un(c,e,n),un(c,"VER",t.ha),nr(t,c),c}function dr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Cn(t.Ka)).F=t.C,e}function vr(){}function yr(){if(ht&&!(10<=Number(bt)))throw Error("Environmental error: no available transport.")}function gr(t,e){Qt.call(this),this.a=new Yn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!K(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!K(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new br(this)}function mr(t){_e.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function wr(){Ue.call(this),this.status=1}function br(t){this.a=t}(S=Cn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?ke(this.H):ke(De),this.a.onreadystatechange=x(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Fn(this,t)}t=n||"";var i,o=new Xe(this.headers);r&&Ye(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=qn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=L.FormData&&t instanceof L.FormData,0<=B(xn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Qn(this),0<this.o&&((this.D=(i=this.a,ht&&wt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=x(this.xa,this)):this.m=oe(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Fn(this,t)}},S.xa=function(){void 0!==k&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},S.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Bn(this))},S.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Bn(this,!0)),Cn.S.G.call(this)},S.za=function(){this.j||(this.A||this.l||this.g?zn(this):this.Ta())},S.Ta=function(){zn(this)},S.X=function(){try{return 2<Wn(this)?this.a.status:-1}catch(t){return-1}},S.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},S.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Vn(e)}},S.ua=function(){return this.h},S.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(S=Yn.prototype).ha=8,S.v=1,S.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ce(this,this.c,t,void 0),r=this.l;if(this.O&&(r?it(r=nt(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=rr(this,n,e),un(i=en(this.B),"RID",t),un(i,"CVER",22),this.A&&un(i,"X-HTTP-Session-Id",this.A),nr(this,i),this.i&&r&&Hn(i,this.i,r),kn(this.b,n),this.Ga&&un(i,"TYPE","init"),this.da?(un(i,"$req",e),un(i,"SID","null"),n.V=!0,qe(n,i,null)):qe(n,i,e),this.v=2}}else 3==this.v&&(t?er(this,t):0==this.g.length||Rn(this.b)||er(this))},S.Aa=function(){var t;this.j=null,ur(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Ne(x(this.Sa,this),t))},S.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Jn(this),ur(this))},S.Ra=function(){null!=this.m&&(this.m=null,Jn(this),or(this),Te(19))},S.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),Te(2)):(this.c.info("Failed to ping google.com"),Te(1))},(S=vr.prototype).ta=function(){},S.sa=function(){},S.ra=function(){},S.qa=function(){},S.Ha=function(){},yr.prototype.a=function(t,e){return new gr(t,e)},G(gr,Qt),(S=gr.prototype).addEventListener=function(t,e,n,r){gr.S.addEventListener.call(this,t,e,n,r)},S.removeEventListener=function(t,e,n,r){gr.S.removeEventListener.call(this,t,e,n,r)},S.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;Te(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=pr(t,null,t.fa),tr(t)},S.close=function(){Xn(this.a)},S.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,$n(this.a,e)):this.g?((e={}).__data__=Ht(t),$n(this.a,e)):$n(this.a,t)},S.G=function(){this.a.f=null,delete this.f,Xn(this.a),delete this.a,gr.S.G.call(this)},G(mr,_e),G(wr,Ue),G(br,vr),br.prototype.ta=function(){this.a.dispatchEvent("a")},br.prototype.sa=function(t){this.a.dispatchEvent(new mr(t))},br.prototype.ra=function(t){this.a.dispatchEvent(new wr)},br.prototype.qa=function(){this.a.dispatchEvent("b")},yr.prototype.createWebChannel=yr.prototype.a,gr.prototype.send=gr.prototype.Pa,gr.prototype.open=gr.prototype.Oa,Re.NO_ERROR=0,Re.TIMEOUT=8,Re.HTTP_ERROR=6,Se.COMPLETE="complete",(Le.EventType=Pe).OPEN="a",Pe.CLOSE="b",Pe.ERROR="c",Pe.MESSAGE="d",Qt.prototype.listen=Qt.prototype.va,Cn.prototype.listenOnce=Cn.prototype.wa,Cn.prototype.getLastError=Cn.prototype.Qa,Cn.prototype.getLastErrorCode=Cn.prototype.ua,Cn.prototype.getStatus=Cn.prototype.X,Cn.prototype.getResponseJson=Cn.prototype.Na,Cn.prototype.getResponseText=Cn.prototype.$,Cn.prototype.send=Cn.prototype.ba;var Er={createWebChannelTransport:function(){return new yr},ErrorCode:Re,EventType:Se,WebChannel:Le,XhrIo:Cn},Ir=Er.createWebChannelTransport,Tr=Er.ErrorCode,Ar=Er.EventType,Nr=Er.WebChannel,Rr=Er.XhrIo,Sr=(Or.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Or.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Or.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Or);function Or(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var kr,Lr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Dr=(o(Ur,kr=Error),Ur),Pr="7.20.0-202088235442",_r=new p("@firebase/firestore");function Ur(t,e){var n=this;return(n=kr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Vr(){return _r.logLevel}function Cr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];_r.logLevel<=u.DEBUG&&(e=n.map(xr),_r.debug.apply(_r,s(["Firestore ("+Pr+"): "+t],e)))}function Mr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];_r.logLevel<=u.ERROR&&(e=n.map(xr),_r.error.apply(_r,s(["Firestore ("+Pr+"): "+t],e)))}function jr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];_r.logLevel<=u.WARN&&(e=n.map(xr),_r.warn.apply(_r,s(["Firestore ("+Pr+"): "+t],e)))}function xr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function qr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+Pr+") INTERNAL ASSERTION FAILED: "+t;throw Mr(e),new Error(e)}function Fr(t){t||qr()}function Gr(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function zr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Br(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Qr,Wr,Hr=(Object.defineProperty(ei.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),ei.prototype.isEqual=function(t){return 0===ei.i(this,t)},ei.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ei?t.forEach(function(t){e.push(t)}):e.push(t),this.o(e)},ei.prototype.limit=function(){return this.offset+this.length},ei.prototype.u=function(t){return t=void 0===t?1:t,this.o(this.segments,this.offset+t,this.length-t)},ei.prototype.h=function(){return this.o(this.segments,this.offset,this.length-1)},ei.prototype.l=function(){return this.segments[this.offset]},ei.prototype._=function(){return this.get(this.length-1)},ei.prototype.get=function(t){return this.segments[this.offset+t]},ei.prototype.m=function(){return 0===this.length},ei.prototype.T=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ei.prototype.I=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ei.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ei.prototype.A=function(){return this.segments.slice(this.offset,this.limit())},ei.i=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ei),Kr=(o(ti,Wr=Hr),ti.prototype.o=function(t,e,n){return new ti(t,e,n)},ti.prototype.R=function(){return this.A().join("/")},ti.prototype.toString=function(){return this.R()},ti.P=function(t){if(0<=t.indexOf("//"))throw new Dr(Lr.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new ti(t.split("/").filter(function(t){return 0<t.length}))},ti.p=function(){return new ti([])},ti),Yr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Xr=(o($r,Qr=Hr),$r.prototype.o=function(t,e,n){return new $r(t,e,n)},$r.g=function(t){return Yr.test(t)},$r.prototype.R=function(){return this.A().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),$r.g(t)||(t="`"+t+"`"),t}).join(".")},$r.prototype.toString=function(){return this.R()},$r.prototype.V=function(){return 1===this.length&&"__name__"===this.get(0)},$r.v=function(){return new $r(["__name__"])},$r.S=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Dr(Lr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Dr(Lr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Dr(Lr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Dr(Lr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new $r(e)},$r.p=function(){return new $r([])},$r),Jr=(Zr.C=function(t){return new Zr(Kr.P(t))},Zr.D=function(t){return new Zr(Kr.P(t).u(5))},Zr.prototype.F=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Zr.prototype.isEqual=function(t){return null!==t&&0===Kr.i(this.path,t.path)},Zr.prototype.toString=function(){return this.path.toString()},Zr.i=function(t,e){return Kr.i(t.path,e.path)},Zr.$=function(t){return t.length%2==0},Zr.N=function(t){return new Zr(new Kr(t.slice()))},Zr);function Zr(t){this.path=t}function $r(){return null!==Qr&&Qr.apply(this,arguments)||this}function ti(){return null!==Wr&&Wr.apply(this,arguments)||this}function ei(t,e,n){void 0===e?e=0:e>t.length&&qr(),void 0===n?n=t.length-e:n>t.length-e&&qr(),this.segments=t,this.offset=e,this.t=n}function ni(t,e){if(0!==e.length)throw new Dr(Lr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+bi(e.length,"argument")+".")}function ri(t,e,n){if(e.length!==n)throw new Dr(Lr.INVALID_ARGUMENT,"Function "+t+"() requires "+bi(n,"argument")+", but was called with "+bi(e.length,"argument")+".")}function ii(t,e,n){if(e.length<n)throw new Dr(Lr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+bi(n,"argument")+", but was called with "+bi(e.length,"argument")+".")}function oi(t,e,n,r){if(e.length<n||e.length>r)throw new Dr(Lr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+bi(e.length,"argument")+".")}function si(t,e,n,r){fi(t,e,wi(n)+" argument",r)}function ui(t,e,n,r){void 0!==r&&si(t,e,n,r)}function ai(t,e,n,r){fi(t,e,n+" option",r)}function hi(t,e,n,r){void 0!==r&&ai(t,e,n,r)}function ci(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(di(s))}var u=di(n);throw new Dr(Lr.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function li(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Dr(Lr.INVALID_ARGUMENT,"Invalid value "+di(r)+" provided to function "+t+"() for its "+wi(n)+" argument. Acceptable values: "+e.join(", "));return r}function fi(t,e,n,r){if(!("object"===e?pi(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=di(r);throw new Dr(Lr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function pi(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function di(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":qr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function vi(t,e,n){if(void 0===n)throw new Dr(Lr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+wi(e)+" argument, but it was undefined.")}function yi(n,t,r){zr(t,function(t,e){if(r.indexOf(t)<0)throw new Dr(Lr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function gi(t,e,n,r){var i=di(r);return new Dr(Lr.INVALID_ARGUMENT,"Function "+t+"() requires its "+wi(n)+" argument to be a "+e+", but it was: "+i)}function mi(t,e,n){if(n<=0)throw new Dr(Lr.INVALID_ARGUMENT,"Function "+t+"() requires its "+wi(e)+" argument to be a positive number, but it was: "+n+".")}function wi(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function bi(t,e){return t+" "+e+(1===t?"":"s")}var Ei=(Ii.k=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Ii);function Ii(){}function Ti(t,e){return t<e?-1:e<t?1:0}function Ai(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var Ni=(Ri.fromBase64String=function(t){return new Ri(atob(t))},Ri.fromUint8Array=function(t){return new Ri(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Ri.prototype.toBase64=function(){return t=this.O,btoa(t);var t},Ri.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.O)},Ri.prototype.M=function(){return 2*this.O.length},Ri.prototype.q=function(t){return Ti(this.O,t.O)},Ri.prototype.isEqual=function(t){return this.O===t.O},Ri);function Ri(t){this.O=t}Ni.L=new Ni("");var Si=(Oi.fromBase64String=function(t){try{return new Oi(Ni.fromBase64String(t))}catch(t){throw new Dr(Lr.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},Oi.fromUint8Array=function(t){return new Oi(Ni.fromUint8Array(t))},Oi.prototype.toBase64=function(){return this.B.toBase64()},Oi.prototype.toUint8Array=function(){return this.B.toUint8Array()},Oi.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Oi.prototype.isEqual=function(t){return this.B.isEqual(t.B)},Oi);function Oi(t){this.B=t}function ki(){if("undefined"==typeof Uint8Array)throw new Dr(Lr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Li(){if("undefined"==typeof atob)throw new Dr(Lr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function Di(t,e,n,r,i){this.U=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var Pi,_i=(o(Gi,Pi=Si),Gi.fromBase64String=function(t){ri("Blob.fromBase64String",arguments,1),si("Blob.fromBase64String","string",1,t),Li();try{return new Gi(Ni.fromBase64String(t))}catch(t){throw new Dr(Lr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Gi.fromUint8Array=function(t){if(ri("Blob.fromUint8Array",arguments,1),ki(),!(t instanceof Uint8Array))throw gi("Blob.fromUint8Array","Uint8Array",1,t);return new Gi(Ni.fromUint8Array(t))},Gi.prototype.toBase64=function(){return ri("Blob.toBase64",arguments,0),Li(),Pi.prototype.toBase64.call(this)},Gi.prototype.toUint8Array=function(){return ri("Blob.toUint8Array",arguments,0),ki(),Pi.prototype.toUint8Array.call(this)},Gi.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Gi),Ui=(Object.defineProperty(Fi.prototype,"j",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Fi.prototype.isEqual=function(t){return t instanceof Fi&&t.projectId===this.projectId&&t.database===this.database},Fi.prototype.q=function(t){return Ti(this.projectId,t.projectId)||Ti(this.database,t.database)},Fi),Vi=(qi.prototype.get=function(t){var e=this.W(t),n=this.K[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.G(s,t))return u}},qi.prototype.has=function(t){return void 0!==this.get(t)},qi.prototype.set=function(t,e){var n=this.W(t),r=this.K[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.G(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.K[n]=[[t,e]]},qi.prototype.delete=function(t){var e=this.W(t),n=this.K[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.G(n[r][0],t))return 1===n.length?delete this.K[e]:n.splice(r,1),!0;return!1},qi.prototype.forEach=function(u){zr(this.K,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];u(o,s)}})},qi.prototype.m=function(){return Br(this.K)},qi),Ci=(xi.now=function(){return xi.fromMillis(Date.now())},xi.fromDate=function(t){return xi.fromMillis(t.getTime())},xi.fromMillis=function(t){var e=Math.floor(t/1e3);return new xi(e,1e6*(t-1e3*e))},xi.prototype.toDate=function(){return new Date(this.toMillis())},xi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},xi.prototype.H=function(t){return this.seconds===t.seconds?Ti(this.nanoseconds,t.nanoseconds):Ti(this.seconds,t.seconds)},xi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},xi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},xi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},xi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},xi),Mi=(ji.Y=function(t){return new ji(t)},ji.min=function(){return new ji(new Ci(0,0))},ji.prototype.q=function(t){return this.timestamp.H(t.timestamp)},ji.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},ji.prototype.J=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},ji.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},ji.prototype.X=function(){return this.timestamp},ji);function ji(t){this.timestamp=t}function xi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Dr(Lr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Dr(Lr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Dr(Lr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Dr(Lr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function qi(t,e){this.W=t,this.G=e,this.K={}}function Fi(t,e){this.projectId=t,this.database=e||"(default)"}function Gi(){return null!==Pi&&Pi.apply(this,arguments)||this}function zi(t){return null==t}function Bi(t){return-0===t&&1/t==-1/0}var Qi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Z=null};function Wi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Qi(t,e,n,r,i,o,s)}function Hi(t){var e,n=t;return null===n.Z&&(e=n.path.R(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.R()+e.op.toString()+Ko(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.R()+e.dir;var e}).join(","),zi(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=Ea(n.startAt)),n.endAt&&(e+="|ub:",e+=Ea(n.endAt)),n.Z=e),n.Z}function Ki(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Bo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ta(t.startAt,e.startAt)&&Ta(t.endAt,e.endAt)}function Yi(t){return Jr.$(t.path)&&null===t.collectionGroup&&0===t.filters.length}function Xi(t){this.count=t}var Ji,Zi,$i=(to.prototype.nt=function(t){return new to(this.target,this.targetId,this.tt,t,this.et,this.lastLimboFreeSnapshotVersion,this.resumeToken)},to.prototype.st=function(t,e){return new to(this.target,this.targetId,this.tt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},to.prototype.it=function(t){return new to(this.target,this.targetId,this.tt,this.sequenceNumber,this.et,t,this.resumeToken)},to);function to(t,e,n,r,i,o,s){void 0===i&&(i=Mi.min()),void 0===o&&(o=Mi.min()),void 0===s&&(s=Ni.L),this.target=t,this.targetId=e,this.tt=n,this.sequenceNumber=r,this.et=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function eo(t){switch(t){case Lr.OK:return qr(),0;case Lr.CANCELLED:case Lr.UNKNOWN:case Lr.DEADLINE_EXCEEDED:case Lr.RESOURCE_EXHAUSTED:case Lr.INTERNAL:case Lr.UNAVAILABLE:case Lr.UNAUTHENTICATED:return;case Lr.INVALID_ARGUMENT:case Lr.NOT_FOUND:case Lr.ALREADY_EXISTS:case Lr.PERMISSION_DENIED:case Lr.FAILED_PRECONDITION:case Lr.ABORTED:case Lr.OUT_OF_RANGE:case Lr.UNIMPLEMENTED:case Lr.DATA_LOSS:return 1;default:return qr(),0}}function no(t){if(void 0===t)return Mr("GRPC error has no .code"),Lr.UNKNOWN;switch(t){case Ji.OK:return Lr.OK;case Ji.CANCELLED:return Lr.CANCELLED;case Ji.UNKNOWN:return Lr.UNKNOWN;case Ji.DEADLINE_EXCEEDED:return Lr.DEADLINE_EXCEEDED;case Ji.RESOURCE_EXHAUSTED:return Lr.RESOURCE_EXHAUSTED;case Ji.INTERNAL:return Lr.INTERNAL;case Ji.UNAVAILABLE:return Lr.UNAVAILABLE;case Ji.UNAUTHENTICATED:return Lr.UNAUTHENTICATED;case Ji.INVALID_ARGUMENT:return Lr.INVALID_ARGUMENT;case Ji.NOT_FOUND:return Lr.NOT_FOUND;case Ji.ALREADY_EXISTS:return Lr.ALREADY_EXISTS;case Ji.PERMISSION_DENIED:return Lr.PERMISSION_DENIED;case Ji.FAILED_PRECONDITION:return Lr.FAILED_PRECONDITION;case Ji.ABORTED:return Lr.ABORTED;case Ji.OUT_OF_RANGE:return Lr.OUT_OF_RANGE;case Ji.UNIMPLEMENTED:return Lr.UNIMPLEMENTED;case Ji.DATA_LOSS:return Lr.DATA_LOSS;default:return qr()}}(Zi=Ji=Ji||{})[Zi.OK=0]="OK",Zi[Zi.CANCELLED=1]="CANCELLED",Zi[Zi.UNKNOWN=2]="UNKNOWN",Zi[Zi.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Zi[Zi.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Zi[Zi.NOT_FOUND=5]="NOT_FOUND",Zi[Zi.ALREADY_EXISTS=6]="ALREADY_EXISTS",Zi[Zi.PERMISSION_DENIED=7]="PERMISSION_DENIED",Zi[Zi.UNAUTHENTICATED=16]="UNAUTHENTICATED",Zi[Zi.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Zi[Zi.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Zi[Zi.ABORTED=10]="ABORTED",Zi[Zi.OUT_OF_RANGE=11]="OUT_OF_RANGE",Zi[Zi.UNIMPLEMENTED=12]="UNIMPLEMENTED",Zi[Zi.INTERNAL=13]="INTERNAL",Zi[Zi.UNAVAILABLE=14]="UNAVAILABLE",Zi[Zi.DATA_LOSS=15]="DATA_LOSS";var ro=(ao.prototype.rt=function(t,e){return new ao(this.i,this.root.rt(t,e,this.i).copy(null,null,oo.ot,null,null))},ao.prototype.remove=function(t){return new ao(this.i,this.root.remove(t,this.i).copy(null,null,oo.ot,null,null))},ao.prototype.get=function(t){for(var e=this.root;!e.m();){var n=this.i(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},ao.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.m();){var r=this.i(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},ao.prototype.m=function(){return this.root.m()},Object.defineProperty(ao.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),ao.prototype.ut=function(){return this.root.ut()},ao.prototype.ct=function(){return this.root.ct()},ao.prototype.at=function(t){return this.root.at(t)},ao.prototype.forEach=function(n){this.at(function(t,e){return n(t,e),!1})},ao.prototype.toString=function(){var n=[];return this.at(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},ao.prototype.ht=function(t){return this.root.ht(t)},ao.prototype.lt=function(){return new io(this.root,null,this.i,!1)},ao.prototype._t=function(t){return new io(this.root,t,this.i,!1)},ao.prototype.ft=function(){return new io(this.root,null,this.i,!0)},ao.prototype.dt=function(t){return new io(this.root,t,this.i,!0)},ao),io=(uo.prototype.Et=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.m();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.m();)this.Tt.push(t),t=t.left;return e},uo.prototype.It=function(){return 0<this.Tt.length},uo.prototype.At=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},uo),oo=(so.prototype.copy=function(t,e,n,r,i){return new so(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},so.prototype.m=function(){return!1},so.prototype.at=function(t){return this.left.at(t)||t(this.key,this.value)||this.right.at(t)},so.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},so.prototype.min=function(){return this.left.m()?this:this.left.min()},so.prototype.ut=function(){return this.min().key},so.prototype.ct=function(){return this.right.m()?this.key:this.right.ct()},so.prototype.rt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.rt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.rt(t,e,n))).Rt()},so.prototype.yt=function(){if(this.left.m())return so.EMPTY;var t=this;return t.left.Pt()||t.left.left.Pt()||(t=t.gt()),(t=t.copy(null,null,null,t.left.yt(),null)).Rt()},so.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.m()||r.left.Pt()||r.left.left.Pt()||(r=r.gt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Pt()&&(r=r.Vt()),r.right.m()||r.right.Pt()||r.right.left.Pt()||(r=r.vt()),0===e(t,r.key)){if(r.right.m())return so.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.yt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Rt()},so.prototype.Pt=function(){return this.color},so.prototype.Rt=function(){var t=this;return t.right.Pt()&&!t.left.Pt()&&(t=t.bt()),t.left.Pt()&&t.left.left.Pt()&&(t=t.Vt()),t.left.Pt()&&t.right.Pt()&&(t=t.St()),t},so.prototype.gt=function(){var t=this.St();return t.right.left.Pt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Vt())).bt()).St()),t},so.prototype.vt=function(){var t=this.St();return t.left.left.Pt()&&(t=(t=t.Vt()).St()),t},so.prototype.bt=function(){var t=this.copy(null,null,so.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},so.prototype.Vt=function(){var t=this.copy(null,null,so.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},so.prototype.St=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},so.prototype.Ct=function(){var t=this.Dt();return Math.pow(2,t)<=this.size+1},so.prototype.Dt=function(){if(this.Pt()&&this.left.Pt())throw qr();if(this.right.Pt())throw qr();var t=this.left.Dt();if(t!==this.right.Dt())throw qr();return t+(this.Pt()?0:1)},so);function so(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:so.RED,this.left=null!=r?r:so.EMPTY,this.right=null!=i?i:so.EMPTY,this.size=this.left.size+1+this.right.size}function uo(t,e,n,r){this.wt=r,this.Tt=[];for(var i=1;!t.m();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.wt?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.wt?t.right:t.left}}function ao(t,e){this.i=t,this.root=e||oo.EMPTY}function ho(){this.size=0}oo.EMPTY=null,oo.RED=!0,oo.ot=!1,oo.EMPTY=(Object.defineProperty(ho.prototype,"key",{get:function(){throw qr()},enumerable:!1,configurable:!0}),Object.defineProperty(ho.prototype,"value",{get:function(){throw qr()},enumerable:!1,configurable:!0}),Object.defineProperty(ho.prototype,"color",{get:function(){throw qr()},enumerable:!1,configurable:!0}),Object.defineProperty(ho.prototype,"left",{get:function(){throw qr()},enumerable:!1,configurable:!0}),Object.defineProperty(ho.prototype,"right",{get:function(){throw qr()},enumerable:!1,configurable:!0}),ho.prototype.copy=function(t,e,n,r,i){return this},ho.prototype.rt=function(t,e,n){return new oo(t,e)},ho.prototype.remove=function(t,e){return this},ho.prototype.m=function(){return!0},ho.prototype.at=function(t){return!1},ho.prototype.ht=function(t){return!1},ho.prototype.ut=function(){return null},ho.prototype.ct=function(){return null},ho.prototype.Pt=function(){return!1},ho.prototype.Ct=function(){return!0},ho.prototype.Dt=function(){return 0},new ho);var co=(vo.prototype.has=function(t){return null!==this.data.get(t)},vo.prototype.first=function(){return this.data.ut()},vo.prototype.last=function(){return this.data.ct()},Object.defineProperty(vo.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),vo.prototype.indexOf=function(t){return this.data.indexOf(t)},vo.prototype.forEach=function(n){this.data.at(function(t,e){return n(t),!1})},vo.prototype.Ft=function(t,e){for(var n=this.data._t(t[0]);n.It();){var r=n.Et();if(0<=this.i(r.key,t[1]))return;e(r.key)}},vo.prototype.$t=function(t,e){for(var n=void 0!==e?this.data._t(e):this.data.lt();n.It();)if(!t(n.Et().key))return},vo.prototype.Nt=function(t){var e=this.data._t(t);return e.It()?e.Et().key:null},vo.prototype.lt=function(){return new lo(this.data.lt())},vo.prototype._t=function(t){return new lo(this.data._t(t))},vo.prototype.add=function(t){return this.copy(this.data.remove(t).rt(t,!0))},vo.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},vo.prototype.m=function(){return this.data.m()},vo.prototype.xt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},vo.prototype.isEqual=function(t){if(!(t instanceof vo))return!1;if(this.size!==t.size)return!1;for(var e=this.data.lt(),n=t.data.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(0!==this.i(r,i))return!1}return!0},vo.prototype.A=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},vo.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},vo.prototype.copy=function(t){var e=new vo(this.i);return e.data=t,e},vo),lo=(po.prototype.Et=function(){return this.kt.Et().key},po.prototype.It=function(){return this.kt.It()},po),fo=new ro(Jr.i);function po(t){this.kt=t}function vo(t){this.i=t,this.data=new ro(this.i)}var yo=new ro(Jr.i);var go=new ro(Jr.i),mo=new co(Jr.i);function wo(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=mo,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var bo=new co(Ti);var Eo=(Mo.qt=function(t){return new Mo(t.i)},Mo.prototype.has=function(t){return null!=this.Ot.get(t)},Mo.prototype.get=function(t){return this.Ot.get(t)},Mo.prototype.first=function(){return this.Mt.ut()},Mo.prototype.last=function(){return this.Mt.ct()},Mo.prototype.m=function(){return this.Mt.m()},Mo.prototype.indexOf=function(t){var e=this.Ot.get(t);return e?this.Mt.indexOf(e):-1},Object.defineProperty(Mo.prototype,"size",{get:function(){return this.Mt.size},enumerable:!1,configurable:!0}),Mo.prototype.forEach=function(n){this.Mt.at(function(t,e){return n(t),!1})},Mo.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ot.rt(t.key,t),e.Mt.rt(t,null))},Mo.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ot.remove(t),this.Mt.remove(e)):this},Mo.prototype.isEqual=function(t){if(!(t instanceof Mo))return!1;if(this.size!==t.size)return!1;for(var e=this.Mt.lt(),n=t.Mt.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(!r.isEqual(i))return!1}return!0},Mo.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Mo.prototype.copy=function(t,e){var n=new Mo;return n.i=this.i,n.Ot=t,n.Mt=e,n},Mo),Io=(Co.prototype.track=function(t){var e=t.doc.key,n=this.Lt.get(e);!n||0!==t.type&&3===n.type?this.Lt=this.Lt.rt(e,t):3===t.type&&1!==n.type?this.Lt=this.Lt.rt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Lt=this.Lt.rt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Lt=this.Lt.rt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Lt=this.Lt.remove(e):1===t.type&&2===n.type?this.Lt=this.Lt.rt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Lt=this.Lt.rt(e,{type:2,doc:t.doc}):qr()},Co.prototype.Bt=function(){var n=[];return this.Lt.at(function(t,e){n.push(e)}),n},Co),To=(Vo.Gt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Vo(t,e,Eo.qt(e),i,n,r,!0,!1)},Object.defineProperty(Vo.prototype,"hasPendingWrites",{get:function(){return!this.Qt.m()},enumerable:!1,configurable:!0}),Vo.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.jt===t.jt&&this.Qt.isEqual(t.Qt)&&Bu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ut.isEqual(t.Ut)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Vo),Ao=(Uo.Jt=function(t,e){var n=new Map;return n.set(t,No.Xt(t,e)),new Uo(Mi.min(),n,bo,fo,wo())},Uo),No=(_o.Xt=function(t,e){return new _o(Ni.L,e,wo(),wo(),wo())},_o),Ro=function(t,e,n,r){this.se=t,this.removedTargetIds=e,this.key=n,this.ie=r},So=function(t,e){this.targetId=t,this.re=e},Oo=function(t,e,n,r){void 0===n&&(n=Ni.L),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},ko=(Object.defineProperty(Po.prototype,"Zt",{get:function(){return this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(Po.prototype,"resumeToken",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(Po.prototype,"le",{get:function(){return 0!==this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(Po.prototype,"_e",{get:function(){return this.he},enumerable:!1,configurable:!0}),Po.prototype.fe=function(t){0<t.M()&&(this.he=!0,this.ce=t)},Po.prototype.de=function(){var n=wo(),r=wo(),i=wo();return this.ue.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:qr()}}),new No(this.ce,this.ae,n,r,i)},Po.prototype.we=function(){this.he=!1,this.ue=xo()},Po.prototype.me=function(t,e){this.he=!0,this.ue=this.ue.rt(t,e)},Po.prototype.Te=function(t){this.he=!0,this.ue=this.ue.remove(t)},Po.prototype.Ee=function(){this.oe+=1},Po.prototype.Ie=function(){--this.oe},Po.prototype.Ae=function(){this.he=!0,this.ae=!0},Po),Lo=(Do.prototype.Ve=function(t){for(var e=0,n=t.se;e<n.length;e++){var r=n[e];t.ie instanceof Nu?this.ve(r,t.ie):t.ie instanceof Ru&&this.be(r,t.key,t.ie)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.be(s,t.key,t.ie)}},Do.prototype.Se=function(n){var r=this;this.Ce(n,function(t){var e=r.De(t);switch(n.state){case 0:r.Fe(t)&&e.fe(n.resumeToken);break;case 1:e.Ie(),e.le||e.we(),e.fe(n.resumeToken);break;case 2:e.Ie(),e.le||r.removeTarget(t);break;case 3:r.Fe(t)&&(e.Ae(),e.fe(n.resumeToken));break;case 4:r.Fe(t)&&(r.$e(t),e.fe(n.resumeToken));break;default:qr()}})},Do.prototype.Ce=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ye.forEach(function(t,e){r.Fe(e)&&n(e)})},Do.prototype.Ne=function(t){var e,n,r=t.targetId,i=t.re.count,o=this.xe(r);o&&(Yi(e=o.target)?0===i?(n=new Jr(e.path),this.be(r,n,new Ru(n,Mi.min()))):Fr(1===i):this.ke(r)!==i&&(this.$e(r),this.ge=this.ge.add(r)))},Do.prototype.Oe=function(i){var o=this,s=new Map;this.ye.forEach(function(t,e){var n,r=o.xe(e);r&&(t.Zt&&Yi(r.target)&&(n=new Jr(r.target.path),null!==o.Pe.get(n)||o.Me(e,n)||o.be(e,n,new Ru(n,i))),t._e&&(s.set(e,t.de()),t.we()))});var r=wo();this.pe.forEach(function(t,e){var n=!0;e.$t(function(t){var e=o.xe(t);return!e||2===e.tt||(n=!1)}),n&&(r=r.add(t))});var t=new Ao(i,s,this.ge,this.Pe,r);return this.Pe=fo,this.pe=jo(),this.ge=new co(Ti),t},Do.prototype.ve=function(t,e){var n;this.Fe(t)&&(n=this.Me(t,e.key)?2:0,this.De(t).me(e.key,n),this.Pe=this.Pe.rt(e.key,e),this.pe=this.pe.rt(e.key,this.qe(e.key).add(t)))},Do.prototype.be=function(t,e,n){var r;this.Fe(t)&&(r=this.De(t),this.Me(t,e)?r.me(e,1):r.Te(e),this.pe=this.pe.rt(e,this.qe(e).delete(t)),n&&(this.Pe=this.Pe.rt(e,n)))},Do.prototype.removeTarget=function(t){this.ye.delete(t)},Do.prototype.ke=function(t){var e=this.De(t).de();return this.Re.Le(t).size+e.te.size-e.ne.size},Do.prototype.Ee=function(t){this.De(t).Ee()},Do.prototype.De=function(t){var e=this.ye.get(t);return e||(e=new ko,this.ye.set(t,e)),e},Do.prototype.qe=function(t){var e=this.pe.get(t);return e||(e=new co(Ti),this.pe=this.pe.rt(t,e)),e},Do.prototype.Fe=function(t){var e=null!==this.xe(t);return e||Cr("WatchChangeAggregator","Detected inactive target",t),e},Do.prototype.xe=function(t){var e=this.ye.get(t);return e&&e.le?null:this.Re.Be(t)},Do.prototype.$e=function(e){var n=this;this.ye.set(e,new ko),this.Re.Le(e).forEach(function(t){n.be(e,t,null)})},Do.prototype.Me=function(t,e){return this.Re.Le(t).has(e)},Do);function Do(t){this.Re=t,this.ye=new Map,this.Pe=fo,this.pe=jo(),this.ge=new co(Ti)}function Po(){this.oe=0,this.ue=xo(),this.ce=Ni.L,this.ae=!1,this.he=!0}function _o(t,e,n,r,i){this.resumeToken=t,this.Zt=e,this.te=n,this.ee=r,this.ne=i}function Uo(t,e,n,r,i){this.et=t,this.Kt=e,this.zt=n,this.Ht=r,this.Yt=i}function Vo(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Ut=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.jt=s,this.Wt=u}function Co(){this.Lt=new ro(Jr.i)}function Mo(n){this.i=n?function(t,e){return n(t,e)||Jr.i(t.key,e.key)}:function(t,e){return Jr.i(t.key,e.key)},this.Ot=yo,this.Mt=new ro(this.i)}function jo(){return new ro(Jr.i)}function xo(){return new ro(Jr.i)}function qo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Fo(t){var e=Yo(t.mapValue.fields.__local_write_time__.timestampValue);return new Ci(e.seconds,e.nanos)}var Go=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function zo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?qo(t)?4:10:qr()}function Bo(r,i){var t,e,n,o=zo(r);if(o!==zo(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return Fo(r).isEqual(Fo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Yo(r.timestampValue),n=Yo(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return n=i,Jo(r.bytesValue).isEqual(Jo(n.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Xo((t=r).geoPointValue.latitude)===Xo(e.geoPointValue.latitude)&&Xo(t.geoPointValue.longitude)===Xo(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Xo(t.integerValue)===Xo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Xo(t.doubleValue),r=Xo(e.doubleValue);return n===r?Bi(n)===Bi(r):isNaN(n)&&isNaN(r)}return!1}(r,i);case 9:return Ai(r.arrayValue.values||[],i.arrayValue.values||[],Bo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Gr(e)!==Gr(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Bo(e[t],n[t])))return!1;return!0}();default:return qr()}}function Qo(t,e){return void 0!==(t.values||[]).find(function(t){return Bo(t,e)})}function Wo(t,e){var n,r,i,o,s,u,a,h,c,l,f=zo(t),p=zo(e);if(f!==p)return Ti(f,p);switch(f){case 0:return 0;case 1:return Ti(t.booleanValue,e.booleanValue);case 2:return h=e,c=Xo(t.integerValue||t.doubleValue),l=Xo(h.integerValue||h.doubleValue),c<l?-1:l<c?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1;case 3:return Ho(t.timestampValue,e.timestampValue);case 4:return Ho(Fo(t),Fo(e));case 5:return Ti(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=Jo(o),a=Jo(s),u.q(a);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Ti(n[i],r[i]);if(0!==o)return o}return Ti(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=Ti(Xo(n.latitude),Xo(r.latitude)))?i:Ti(Xo(n.longitude),Xo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Wo(n[i],r[i]);if(o)return o}return Ti(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Ti(r[s],o[s]);if(0!==u)return u;var a=Wo(n[r[s]],i[o[s]]);if(0!==a)return a}return Ti(r.length,o.length)}(t.mapValue,e.mapValue);default:throw qr()}}function Ho(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ti(t,e);var n=Yo(t),r=Yo(e),i=Ti(n.seconds,r.seconds);return 0!==i?i:Ti(n.nanos,r.nanos)}function Ko(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=Yo(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?Jo(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,Jr.D(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++){e?e=!1:t+=",",t+=s(r[n])}return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):qr();var t,e,n}(t)}function Yo(t){if(Fr(!!t),"string"!=typeof t)return{seconds:Xo(t.seconds),nanos:Xo(t.nanos)};var e,n=0,r=Go.exec(t);Fr(!!r),r[1]&&(e=((e=r[1])+"000000000").substr(0,9),n=Number(e));var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:n}}function Xo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Jo(t){return"string"==typeof t?Ni.fromBase64String(t):Ni.fromUint8Array(t)}function Zo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.R()}}function $o(t){return t&&"integerValue"in t}function ts(t){return!!t&&"arrayValue"in t}function es(t){return t&&"nullValue"in t}function ns(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function rs(t){return t&&"mapValue"in t}var is={asc:"ASCENDING",desc:"DESCENDING"},os={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ss=function(t,e){this.U=t,this.Ue=e};function us(t){return{integerValue:""+t}}function as(t,e){if(t.Ue){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Bi(e)?"-0":e}}function hs(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!Bi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?us(e):as(t,e);var n}function cs(t,e){return t.Ue?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function ls(t,e){return t.Ue?e.toBase64():e.toUint8Array()}function fs(t){return Fr(!!t),Mi.Y((e=Yo(t),new Ci(e.seconds,e.nanos)));var e}function ps(t,e){return new Kr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).R()}function ds(t,e){return ps(t.U,e.path)}function vs(t,e){var n,r,i=(Fr(Ts(r=Kr.P(e))),r);return Fr(i.get(1)===t.U.projectId),Fr(!i.get(3)&&!t.U.database||i.get(3)===t.U.database),new Jr((Fr(4<(n=i).length&&"documents"===n.get(4)),n.u(5)))}function ys(t,e){return ps(t.U,e)}function gs(t){return new Kr(["projects",t.U.projectId,"databases",t.U.database]).R()}function ms(t,e,n){return{name:ds(t,e),fields:n.proto.mapValue.fields}}function ws(t,e){var n,r,i,o,s,u;if(e instanceof nu)n={update:ms(t,e.key,e.value)};else if(e instanceof pu)n={delete:ds(t,e.key)};else if(e instanceof ru)n={update:ms(t,e.key,e.data),updateMask:(r=e.Qe,i=[],r.fields.forEach(function(t){return i.push(t.R())}),{fieldPaths:i})};else if(e instanceof au)n={transform:{document:ds(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Os)return{fieldPath:t.field.R(),setToServerValue:"REQUEST_TIME"};if(e instanceof ks)return{fieldPath:t.field.R(),appendMissingElements:{values:e.elements}};if(e instanceof Us)return{fieldPath:t.field.R(),removeAllFromArray:{values:e.elements}};if(e instanceof js)return{fieldPath:t.field.R(),increment:e.je};throw qr()})}};else{if(!(e instanceof du))return qr();n={verify:ds(t,e.key)}}return e.Ge.We||(n.currentDocument=void 0!==(o=e.Ge).updateTime?{updateTime:(s=t,u=o.updateTime,cs(s,u.X()))}:void 0!==o.exists?{exists:o.exists}:qr()),n}function bs(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=ys(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=ys(t,r.h()),n.structuredQuery.from=[{collectionId:r._()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){if("=="===t.op){if(ns(t.value))return{unaryFilter:{field:Is(t.field),op:"IS_NAN"}};if(es(t.value))return{unaryFilter:{field:Is(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(ns(t.value))return{unaryFilter:{field:Is(t.field),op:"IS_NOT_NAN"}};if(es(t.value))return{unaryFilter:{field:Is(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Is(t.field),op:(e=t.op,os[e]),value:t.value}};var e});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:Is((e=t).field),direction:(n=e.dir,is[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,u=(s=e.limit,t.Ue||zi(s)?s:{value:s});return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=Es(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Es(e.endAt)),n}function Es(t){return{before:t.before,values:t.position}}function Is(t){return{fieldPath:t.R()}}function Ts(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function As(){this.Ke=void 0}function Ns(t,e){return t instanceof js?$o(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var Rs,Ss,Os=(o(Ds,Ss=As),Ds),ks=(o(Ls,Rs=As),Ls);function Ls(t){var e=this;return(e=Rs.call(this)||this).elements=t,e}function Ds(){return null!==Ss&&Ss.apply(this,arguments)||this}function Ps(t,e){for(var n=Fs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Bo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var _s,Us=(o(Vs,_s=As),Vs);function Vs(t){var e=this;return(e=_s.call(this)||this).elements=t,e}function Cs(t,e){for(var n=Fs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Bo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var Ms,js=(o(xs,Ms=As),xs);function xs(t,e){var n=this;return(n=Ms.call(this)||this).serializer=t,n.je=e,n}function qs(t){return Xo(t.integerValue||t.doubleValue)}function Fs(t){return ts(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Gs(t,e){this.field=t,this.transform=e}var zs=(Bs.prototype.ze=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].T(t))return!0;return!1},Bs.prototype.isEqual=function(t){return Ai(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Bs);function Bs(t){(this.fields=t).sort(Xr.i)}function Qs(t,e){this.version=t,this.transformResults=e}var Ws=(Hs.He=function(){return new Hs},Hs.exists=function(t){return new Hs(void 0,t)},Hs.updateTime=function(t){return new Hs(t)},Object.defineProperty(Hs.prototype,"We",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Hs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Hs);function Hs(t,e){this.updateTime=t,this.exists=e}function Ks(t,e){return void 0!==t.updateTime?e instanceof Nu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Nu}function Ys(){}function Xs(t,e,n){return t instanceof nu?new Nu(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof ru?function(t,e,n){if(!Ks(t.Ge,e))return new Su(t.key,n.version);var r=su(t,e);return new Nu(t.key,n.version,r,{hasCommittedMutations:!0})}(t,e,n):t instanceof au?function(t,e,n){if(Fr(null!=n.transformResults),!Ks(t.Ge,e))return new Su(t.key,n.version);var r=e,i=function(t,e,n){var r=[];Fr(t.length===n.length);for(var i,o,s,u=0;u<n.length;u++){var a=t[u],h=a.transform,c=null;e instanceof Nu&&(c=e.field(a.field)),r.push((i=h,o=c,s=n[u],i instanceof ks?Ps(i,o):i instanceof Us?Cs(i,o):s))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=cu(t,r.data(),i);return new Nu(t.key,o,s,{hasCommittedMutations:!0})}(t,e,n):new Ru(t.key,n.version,{hasCommittedMutations:!0})}function Js(t,e,n,r){return t instanceof nu?function(t,e){if(!Ks(t.Ge,e))return e;var n=$s(e);return new Nu(t.key,n,t.value,{Ye:!0})}(t,e):t instanceof ru?function(t,e){if(!Ks(t.Ge,e))return e;var n=$s(e),r=su(t,e);return new Nu(t.key,n,r,{Ye:!0})}(t,e):t instanceof au?function(t,e,n,r){if(!Ks(t.Ge,e))return e;var i=e,o=function(t,e,n,r){for(var i,o,s,u,a,h,c,l=[],f=0,p=t;f<p.length;f++){var d=p[f],v=d.transform,y=null;n instanceof Nu&&(y=n.field(d.field)),null===y&&r instanceof Nu&&(y=r.field(d.field)),l.push((o=y,s=e,c=h=a=u=void 0,(i=v)instanceof Os?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}},o&&(c.fields.__previous_value__=o),{mapValue:c}):i instanceof ks?Ps(i,o):i instanceof Us?Cs(i,o):(a=Ns(u=i,o),h=qs(a)+qs(u.je),$o(a)&&$o(u.je)?us(h):as(u.serializer,h))))}return l}(t.fieldTransforms,n,e,r),s=cu(t,i.data(),o);return new Nu(t.key,i.version,s,{Ye:!0})}(t,e,r,n):(o=e,Ks((i=t).Ge,o)?new Ru(i.key,Mi.min()):o);var i,o}function Zs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ge.isEqual(e.Ge)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||Ai(t.fieldTransforms,t.fieldTransforms,function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof ks&&o instanceof ks||i instanceof Us&&o instanceof Us?Ai(i.elements,o.elements,Bo):i instanceof js&&o instanceof js?Bo(i.je,o.je):i instanceof Os&&o instanceof Os);var n,r,i,o}))}function $s(t){return t instanceof Nu?t.version:Mi.min()}var tu,eu,nu=(o(ou,eu=Ys),ou),ru=(o(iu,tu=Ys),iu);function iu(t,e,n,r){var i=this;return(i=tu.call(this)||this).key=t,i.data=e,i.Qe=n,i.Ge=r,i.type=1,i}function ou(t,e,n){var r=this;return(r=eu.call(this)||this).key=t,r.value=e,r.Ge=n,r.type=0,r}function su(t,e){return n=t,r=e instanceof Nu?e.data():vu.empty(),i=new yu(r),n.Qe.fields.forEach(function(t){var e;t.m()||(null!==(e=n.data.field(t))?i.set(t,e):i.delete(t))}),i.Je();var n,r,i}var uu,au=(o(hu,uu=Ys),hu);function hu(t,e){var n=this;return(n=uu.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ge=Ws.exists(!0),n}function cu(t,e,n){for(var r=new yu(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Je()}var lu,fu,pu=(o(bu,fu=Ys),bu),du=(o(wu,lu=Ys),wu),vu=(mu.empty=function(){return new mu({mapValue:{}})},mu.prototype.field=function(t){if(t.m())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!rs(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t._()])||null},mu.prototype.isEqual=function(t){return Bo(this.proto,t.proto)},mu),yu=(gu.prototype.set=function(t,e){return this.tn(t,e),this},gu.prototype.delete=function(t){return this.tn(t,null),this},gu.prototype.tn=function(t,e){for(var n=this.Ze,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===zo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t._(),e)},gu.prototype.Je=function(){var t=this.en(Xr.p(),this.Ze);return null!=t?new vu(t):this.Xe},gu.prototype.en=function(r,t){var i=this,o=!1,e=this.Xe.field(r),s=rs(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.en(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},gu);function gu(t){void 0===t&&(t=vu.empty()),this.Xe=t,this.Ze=new Map}function mu(t){this.proto=t}function wu(t,e){var n=this;return(n=lu.call(this)||this).key=t,n.Ge=e,n.type=4,n}function bu(t,e){var n=this;return(n=fu.call(this)||this).key=t,n.Ge=e,n.type=3,n}function Eu(t,e){this.key=t,this.version=e}var Iu,Tu,Au,Nu=(o(Lu,Au=Eu),Lu.prototype.field=function(t){return this.nn.field(t)},Lu.prototype.data=function(){return this.nn},Lu.prototype.sn=function(){return this.nn.proto},Lu.prototype.isEqual=function(t){return t instanceof Lu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ye===t.Ye&&this.hasCommittedMutations===t.hasCommittedMutations&&this.nn.isEqual(t.nn)},Lu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.nn.toString()+", {hasLocalMutations: "+this.Ye+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Lu.prototype,"hasPendingWrites",{get:function(){return this.Ye||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Lu),Ru=(o(ku,Tu=Eu),ku.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(ku.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),ku.prototype.isEqual=function(t){return t instanceof ku&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},ku),Su=(o(Ou,Iu=Eu),Ou.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Ou.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Ou.prototype.isEqual=function(t){return t instanceof Ou&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Ou);function Ou(){return null!==Iu&&Iu.apply(this,arguments)||this}function ku(t,e,n){var r=this;return(r=Tu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Lu(t,e,n,r){var i=this;return(i=Au.call(this,t,e)||this).nn=n,i.Ye=!!r.Ye,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Du(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new Dr(Lr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass '"+e.name+"' from a different Firestore SDK?"):new Dr(Lr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but was '"+t.constructor.name+"'");return t}var Pu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.rn=n,this.filters=r,this.limit=i,this.on=o,this.startAt=s,this.endAt=u,this.un=null,this.cn=null,this.startAt,this.endAt};function _u(t){return new Pu(t)}function Uu(t){return!zi(t.limit)&&"F"===t.on}function Vu(t){return!zi(t.limit)&&"L"===t.on}function Cu(t){return 0<t.rn.length?t.rn[0].field:null}function Mu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.an())return r.field}return null}function ju(t){return null!==t.collectionGroup}function xu(t){var e=Du(t,Pu);if(null===e.un){e.un=[];var n=Mu(e),r=Cu(e);if(null!==n&&null===r)n.V()||e.un.push(new Aa(n)),e.un.push(new Aa(Xr.v(),"asc"));else{for(var i,o=!1,s=0,u=e.rn;s<u.length;s++){var a=u[s];e.un.push(a),a.field.V()&&(o=!0)}o||(i=0<e.rn.length?e.rn[e.rn.length-1].dir:"asc",e.un.push(new Aa(Xr.v(),i)))}}return e.un}function qu(t){var e=Du(t,Pu);if(!e.cn)if("F"===e.on)e.cn=Wi(e.path,e.collectionGroup,xu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=xu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Aa(o.field,s))}var u=e.endAt?new ya(e.endAt.position,!e.endAt.before):null,a=e.startAt?new ya(e.startAt.position,!e.startAt.before):null;e.cn=Wi(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.cn}function Fu(t,e,n){return new Pu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Gu(t,e){return new Pu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,e,t.endAt)}function zu(t,e){return new Pu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,t.startAt,e)}function Bu(t,e){return Ki(qu(t),qu(e))&&t.on===e.on}function Qu(t){return Hi(qu(t))+"|lt:"+t.on}function Wu(t){return"Query(target="+(e=qu(t),n=e.path.R(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.R()+" "+e.op+" "+Ko(e.value);var e}).join(", ")+"]"),zi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.R()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Ea(e.startAt)),e.endAt&&(n+=", endAt: "+Ea(e.endAt)),"Target("+n+")")+"; limitType="+t.on+")";var e,n}function Hu(i,t){return r=i,o=t.key.path,(null!==r.collectionGroup?t.key.F(r.collectionGroup)&&r.path.T(o):Jr.$(r.path)?r.path.isEqual(o):r.path.I(o))&&function(t){for(var e=0,n=i.rn;e<n.length;e++){var r=n[e];if(!r.field.V()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=i).startAt||Ia(e.startAt,xu(e),n))&&(!e.endAt||!Ia(e.endAt,xu(e),n)));var e,n,r,o}function Ku(u){return function(t,e){for(var n=!1,r=0,i=xu(u);r<i.length;r++){var o=i[r],s=function(t,i,e){var n=t.field.V()?Jr.i(i.key,e.key):function(t,e){var n=i.field(t),r=e.field(t);return null!==n&&null!==r?Wo(n,r):qr()}(t.field,e);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return qr()}}(o,t,e);if(0!==s)return s;n=n||o.field.V()}return 0}}var Yu,Xu=(o(Ju,Yu=function(){}),Ju.create=function(t,e,n){if(t.V())return"in"===e||"not-in"===e?this.hn(t,e,n):new ea(t,e,n);if(es(n)){if("=="!==e&&"!="!==e)throw new Dr(Lr.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new Ju(t,e,n)}if(ns(n)){if("=="!==e&&"!="!==e)throw new Dr(Lr.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new Ju(t,e,n)}return"array-contains"===e?new fa(t,n):"in"===e?new pa(t,n):"not-in"===e?new da(t,n):"array-contains-any"===e?new va(t,n):new Ju(t,e,n)},Ju.hn=function(t,e,n){return new("in"===e?na:ra)(t,n)},Ju.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.ln(Wo(e,this.value)):null!==e&&zo(this.value)===zo(e)&&this.ln(Wo(e,this.value))},Ju.prototype.ln=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return qr()}},Ju.prototype.an=function(){return 0<=["<","<=",">",">=","!="].indexOf(this.op)},Ju);function Ju(t,e,n){var r=this;return(r=Yu.call(this)||this).field=t,r.op=e,r.value=n,r}var Zu,$u,ta,ea=(o(sa,ta=Xu),sa.prototype.matches=function(t){var e=Jr.i(t.key,this.key);return this.ln(e)},sa),na=(o(oa,$u=Xu),oa.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},oa),ra=(o(ia,Zu=Xu),ia.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},ia);function ia(t,e){var n=this;return(n=Zu.call(this,t,"not-in",e)||this).keys=ua(0,e),n}function oa(t,e){var n=this;return(n=$u.call(this,t,"in",e)||this).keys=ua(0,e),n}function sa(t,e,n){var r=this;return(r=ta.call(this,t,e,n)||this).key=Jr.D(n.referenceValue),r}function ua(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return Jr.D(t.referenceValue)})}var aa,ha,ca,la,fa=(o(ba,la=Xu),ba.prototype.matches=function(t){var e=t.field(this.field);return ts(e)&&Qo(e.arrayValue,this.value)},ba),pa=(o(wa,ca=Xu),wa.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Qo(this.value.arrayValue,e)},wa),da=(o(ma,ha=Xu),ma.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&!Qo(this.value.arrayValue,e)},ma),va=(o(ga,aa=Xu),ga.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!ts(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return Qo(e.value.arrayValue,t)})},ga),ya=function(t,e){this.position=t,this.before=e};function ga(t,e){return aa.call(this,t,"array-contains-any",e)||this}function ma(t,e){return ha.call(this,t,"not-in",e)||this}function wa(t,e){return ca.call(this,t,"in",e)||this}function ba(t,e){return la.call(this,t,"array-contains",e)||this}function Ea(t){return(t.before?"b":"a")+":"+t.position.map(Ko).join(",")}function Ia(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.V()?Jr.i(Jr.D(s.referenceValue),n.key):Wo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Ta(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Bo(t.position[n],e.position[n]))return!1;return!0}var Aa=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Na(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var Ra=(ka.prototype.reset=function(){this.Tn=0},ka.prototype.An=function(){this.Tn=this.mn},ka.prototype.Rn=function(t){var e=this;this.cancel();var n=Math.floor(this.Tn+this.yn()),r=Math.max(0,Date.now()-this.In),i=Math.max(0,n-r);0<i&&Cr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Tn+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.En=this._n.Pn(this.fn,i,function(){return e.In=Date.now(),t()}),this.Tn*=this.wn,this.Tn<this.dn&&(this.Tn=this.dn),this.Tn>this.mn&&(this.Tn=this.mn)},ka.prototype.pn=function(){null!==this.En&&(this.En.gn(),this.En=null)},ka.prototype.cancel=function(){null!==this.En&&(this.En.cancel(),this.En=null)},ka.prototype.yn=function(){return(Math.random()-.5)*this.Tn},ka),Sa=(Oa.prototype.catch=function(t){return this.next(void 0,t)},Oa.prototype.next=function(r,i){var o=this;return this.Sn&&qr(),this.Sn=!0,this.bn?this.error?this.Cn(i,this.error):this.Dn(r,this.result):new Oa(function(e,n){o.Vn=function(t){o.Dn(r,t).next(e,n)},o.vn=function(t){o.Cn(i,t).next(e,n)}})},Oa.prototype.Fn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Oa.prototype.$n=function(t){try{var e=t();return e instanceof Oa?e:Oa.resolve(e)}catch(t){return Oa.reject(t)}},Oa.prototype.Dn=function(t,e){return t?this.$n(function(){return t(e)}):Oa.resolve(e)},Oa.prototype.Cn=function(t,e){return t?this.$n(function(){return t(e)}):Oa.reject(e)},Oa.resolve=function(n){return new Oa(function(t,e){t(n)})},Oa.reject=function(n){return new Oa(function(t,e){e(n)})},Oa.Nn=function(t){return new Oa(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Oa.xn=function(t){for(var n=Oa.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Oa.resolve(t):e()})}(r[e]);return n},Oa.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Nn(i)},Oa);function Oa(t){var e=this;this.Vn=null,this.vn=null,this.result=void 0,this.error=void 0,this.bn=!1,this.Sn=!1,t(function(t){e.bn=!0,e.result=t,e.Vn&&e.Vn(t)},function(t){e.bn=!0,e.error=t,e.vn&&e.vn(t)})}function ka(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this._n=t,this.fn=e,this.dn=n,this.wn=r,this.mn=i,this.Tn=0,this.En=null,this.In=Date.now(),this.reset()}function La(t){return"IndexedDbTransactionError"===t.name}function Da(){return"undefined"!=typeof document?document:null}var Pa=(Va.Ln=function(t,e,n,r,i){var o=new Va(t,e,Date.now()+n,r,i);return o.start(n),o},Va.prototype.start=function(t){var e=this;this.Bn=setTimeout(function(){return e.Un()},t)},Va.prototype.gn=function(){return this.Un()},Va.prototype.cancel=function(t){null!==this.Bn&&(this.clearTimeout(),this.qn.reject(new Dr(Lr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Va.prototype.Un=function(){var e=this;this.kn.Qn(function(){return null!==e.Bn?(e.clearTimeout(),e.op().then(function(t){return e.qn.resolve(t)})):Promise.resolve()})},Va.prototype.clearTimeout=function(){null!==this.Bn&&(this.Mn(this),clearTimeout(this.Bn),this.Bn=null)},Va),_a=(Object.defineProperty(Ua.prototype,"Zn",{get:function(){return this.Gn},enumerable:!1,configurable:!0}),Ua.prototype.Qn=function(t){this.enqueue(t)},Ua.prototype.ts=function(t){this.es(),this.ns(t)},Ua.prototype.ss=function(){var t;this.Gn||(this.Gn=!0,(t=Da())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xn))},Ua.prototype.enqueue=function(t){return this.es(),this.Gn?new Promise(function(t){}):this.ns(t)},Ua.prototype.rs=function(t){var e=this;this.Wn.push(t),this.Qn(function(){return e.os()})},Ua.prototype.os=function(){return w(this,void 0,void 0,function(){var e,n=this;return b(this,function(t){switch(t.label){case 0:if(0===this.Wn.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Wn[0]()];case 2:return t.sent(),this.Wn.shift(),this.Jn.reset(),[3,4];case 3:if(!La(e=t.sent()))throw e;return Cr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Wn.length&&this.Jn.Rn(function(){return n.os()}),t.label=5;case 5:return[2]}})})},Ua.prototype.ns=function(t){var r=this,e=this.jn.then(function(){return r.Hn=!0,t().catch(function(t){throw r.zn=t,r.Hn=!1,Mr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Hn=!1,t})});return this.jn=e},Ua.prototype.Pn=function(t,e,n){var r=this;this.es(),-1<this.Yn.indexOf(t)&&(e=0);var i=Pa.Ln(this,t,e,n,function(t){return r.us(t)});return this.Kn.push(i),i},Ua.prototype.es=function(){this.zn&&qr()},Ua.prototype.cs=function(){},Ua.prototype.hs=function(){return w(this,void 0,void 0,function(){var e;return b(this,function(t){switch(t.label){case 0:return[4,e=this.jn];case 1:t.sent(),t.label=2;case 2:if(e!==this.jn)return[3,0];t.label=3;case 3:return[2]}})})},Ua.prototype.ls=function(t){for(var e=0,n=this.Kn;e<n.length;e++)if(n[e].fn===t)return!0;return!1},Ua.prototype._s=function(r){var i=this;return this.hs().then(function(){i.Kn.sort(function(t,e){return t.On-e.On});for(var t=0,e=i.Kn;t<e.length;t++){var n=e[t];if(n.gn(),"all"!==r&&n.fn===r)break}return i.hs()})},Ua.prototype.fs=function(t){this.Yn.push(t)},Ua.prototype.us=function(t){var e=this.Kn.indexOf(t);this.Kn.splice(e,1)},Ua);function Ua(){var e=this;this.jn=Promise.resolve(),this.Wn=[],this.Gn=!1,this.Kn=[],this.zn=null,this.Hn=!1,this.Yn=[],this.Jn=new Ra(this,"async_queue_retry"),this.Xn=function(){var t=Da();t&&Cr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.Jn.pn()};var t=Da();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Xn)}function Va(t,e,n,r,i){this.kn=t,this.fn=e,this.On=n,this.op=r,this.Mn=i,this.qn=new Na,this.then=this.qn.promise.then.bind(this.qn.promise),this.qn.promise.catch(function(t){})}function Ca(t,e){if(Mr("AsyncQueue",e+": "+t),La(t))return new Dr(Lr.UNAVAILABLE,e+": "+t);throw t}function Ma(){this.ws=new Vi(Qu,Bu),this.onlineState="Unknown",this.Ts=new Set}var ja=function(){this.ds=void 0,this.listeners=[]};function xa(a,h){return w(this,void 0,void 0,function(){var e,n,r,i,o,s,u;return b(this,function(t){switch(t.label){case 0:if(e=a,n=h.query,r=!1,(i=e.ws.get(n))||(r=!0,i=new ja),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Es(n)];case 2:return o.ds=t.sent(),[3,4];case 3:return s=t.sent(),u=Ca(s,"Initialization of query '"+Wu(h.query)+"' failed"),[2,void h.onError(u)];case 4:return e.ws.set(n,i),i.listeners.push(h),h.Is(e.onlineState),i.ds&&h.As(i.ds)&&Fa(e),[2]}})})}function qa(s,u){return w(this,void 0,void 0,function(){var e,n,r,i,o;return b(this,function(t){return e=s,n=u.query,r=!1,(i=e.ws.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.ws.delete(n),e.Rs(n))]:[2]})})}function Fa(t){t.Ts.forEach(function(t){t.next()})}var Ga=(Qa.prototype.As=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new To(t.query,t.docs,t.Ut,e,t.Qt,t.fromCache,t.jt,!0)}var o=!1;return this.Ps?this.gs(t)&&(this.ys.next(t),o=!0):this.Vs(t,this.onlineState)&&(this.vs(t),o=!0),this.ps=t,o},Qa.prototype.onError=function(t){this.ys.error(t)},Qa.prototype.Is=function(t){this.onlineState=t;var e=!1;return this.ps&&!this.Ps&&this.Vs(this.ps,t)&&(this.vs(this.ps),e=!0),e},Qa.prototype.Vs=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.bs&&n||t.docs.m()&&"Offline"!==e)},Qa.prototype.gs=function(t){if(0<t.docChanges.length)return!0;var e=this.ps&&this.ps.hasPendingWrites!==t.hasPendingWrites;return!(!t.jt&&!e)&&!0===this.options.includeMetadataChanges},Qa.prototype.vs=function(t){t=To.Gt(t.query,t.docs,t.Qt,t.fromCache),this.Ps=!0,this.ys.next(t)},Qa),za=(Ba.prototype.Ss=function(){return null!=this.uid},Ba.prototype.Cs=function(){return this.Ss()?"uid:"+this.uid:"anonymous-user"},Ba.prototype.isEqual=function(t){return t.uid===this.uid},Ba);function Ba(t){this.uid=t}function Qa(t,e,n){this.query=t,this.ys=e,this.Ps=!1,this.ps=null,this.onlineState="Unknown",this.options=n||{}}za.UNAUTHENTICATED=new za(null),za.Ds=new za("google-credentials-uid"),za.Fs=new za("first-party-uid");var Wa=(Ha.prototype.Ns=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Ha.prototype.next=function(){var t=++this.previousValue;return this.xs&&this.xs(t),t},Ha);function Ha(t,e){var n=this;this.previousValue=t,e&&(e.$s=function(t){return n.Ns(t)},this.xs=function(t){return e.ks(t)})}Wa.Os=-1;var Ka=(uh.prototype.Ms=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},uh.prototype.qs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},uh.prototype.Ls=function(){var t={activeTargetIds:this.activeTargetIds.A(),updateTimeMs:Date.now()};return JSON.stringify(t)},uh),Ya=(sh.prototype.js=function(t){},sh.prototype.Ws=function(t,e,n){},sh.prototype.Gs=function(t){return this.Bs.Ms(t),this.Us[t]||"not-current"},sh.prototype.Ks=function(t,e,n){this.Us[t]=e},sh.prototype.zs=function(t){this.Bs.qs(t)},sh.prototype.Hs=function(t){return this.Bs.activeTargetIds.has(t)},sh.prototype.Ys=function(t){delete this.Us[t]},sh.prototype.Js=function(){return this.Bs.activeTargetIds},sh.prototype.Xs=function(t){return this.Bs.activeTargetIds.has(t)},sh.prototype.start=function(){return this.Bs=new Ka,Promise.resolve()},sh.prototype.Zs=function(t,e,n){},sh.prototype.ti=function(t){},sh.prototype.ei=function(){},sh.prototype.ks=function(t){},sh),Xa=(oh.prototype.si=function(t,e,n){for(var r=n.ii,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Xs(o,e,r[i]))}return e},oh.prototype.ri=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Js(i,e,e,this.ni))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Js(a,e,o,this.ni))}return e},oh.prototype.oi=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ri(t.key,n.get(t.key));e&&(i=i.rt(t.key,e))}),i},oh.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},wo())},oh.prototype.isEqual=function(t){return this.batchId===t.batchId&&Ai(this.mutations,t.mutations,Zs)&&Ai(this.baseMutations,t.baseMutations,Zs)},oh),Ja=(ih.from=function(t,e,n){Fr(t.mutations.length===n.length);for(var r=go,i=t.mutations,o=0;o<i.length;o++)r=r.rt(i[o].key,n[o].version);return new ih(t,e,n,r)},ih),Za=(rh.prototype._i=function(e,n){var r=this;return this.hi.fi(e,n).next(function(t){return r.di(e,n,t)})},rh.prototype.di=function(t,r,i){return this.ai.wi(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ri(r,t);return t})},rh.prototype.mi=function(t,e,i){var o=fo;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ri(t,e);o=o.rt(t,e)}),o},rh.prototype.Ti=function(e,t){var n=this;return this.ai.getEntries(e,t).next(function(t){return n.Ei(e,t)})},rh.prototype.Ei=function(r,i){var o=this;return this.hi.Ii(r,i).next(function(t){var e=o.mi(r,i,t),n=fo;return e.forEach(function(t,e){e=e||new Ru(t,Mi.min()),n=n.rt(t,e)}),n})},rh.prototype.Ai=function(t,e,n){return r=e,Jr.$(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Ri(t,e.path):ju(e)?this.yi(t,e,n):this.Pi(t,e,n);var r},rh.prototype.Ri=function(t,e){return this._i(t,new Jr(e)).next(function(t){var e=yo;return t instanceof Nu&&(e=e.rt(t.key,t)),e})},rh.prototype.yi=function(i,o,s){var u=this,a=o.collectionGroup,h=yo;return this.li.pi(i,a).next(function(t){return Sa.forEach(t,function(t){var e,n,r=(e=o,n=t.child(a),new Pu(n,null,e.rn.slice(),e.filters.slice(),e.limit,e.on,e.startAt,e.endAt));return u.Pi(i,r,s).next(function(t){t.forEach(function(t,e){h=h.rt(t,e)})})}).next(function(){return h})})},rh.prototype.Pi=function(e,n,t){var c,l,r=this;return this.ai.Ai(e,n,t).next(function(t){return c=t,r.hi.gi(e,n)}).next(function(t){return l=t,r.Vi(e,l,c).next(function(t){c=t;for(var e=0,n=l;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),h=Js(s,a,a,r.ni);c=h instanceof Nu?c.rt(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){Hu(n,e)||(c=c.remove(t))}),c})},rh.prototype.Vi=function(t,e,n){for(var r=wo(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof ru&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.ai.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Nu&&(h=h.rt(t,e))}),h})},rh),$a=(nh.Si=function(t,e){for(var n=wo(),r=wo(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new nh(t,e.fromCache,n,r)},nh),th=(eh.$i=function(t){return new eh(t,eh.Ni,eh.xi)},eh);function eh(t,e,n){this.Ci=t,this.Di=e,this.Fi=n}function nh(t,e,n,r){this.targetId=t,this.fromCache=e,this.vi=n,this.bi=r}function rh(t,e,n){this.ai=t,this.hi=e,this.li=n}function ih(t,e,n,r){this.batch=t,this.ui=e,this.ii=n,this.ci=r}function oh(t,e,n,r){this.batchId=t,this.ni=e,this.baseMutations=n,this.mutations=r}function sh(){this.Bs=new Ka,this.Us={},this.Qs=null,this.$s=null}function uh(){this.activeTargetIds=bo}th.ki=-1,th.Oi=1048576,th.Mi=41943040,th.Ni=10,th.xi=1e3,th.qi=new th(th.Mi,th.Ni,th.xi),th.Li=new th(th.ki,0,0);var ah=(vh.prototype.Ui=function(t,e){return this.Bi.add(e),Sa.resolve()},vh.prototype.pi=function(t,e){return Sa.resolve(this.Bi.getEntries(e))},vh),hh=(dh.prototype.add=function(t){var e=t._(),n=t.h(),r=this.index[e]||new co(Kr.i),i=!r.has(n);return this.index[e]=r.add(n),i},dh.prototype.has=function(t){var e=t._(),n=t.h(),r=this.index[e];return r&&r.has(n)},dh.prototype.getEntries=function(t){return(this.index[t]||new co(Kr.i)).A()},dh),ch=(ph.prototype.next=function(){return this.Qi+=2,this.Qi},ph.ji=function(){return new ph(0)},ph.Wi=function(){return new ph(-1)},ph),lh=(fh.prototype.ir=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.rr(t,n.Ki)})},fh);function fh(t,e,n){this.persistence=t,this.Gi=e,this.Ki=new ro(Ti),this.zi=new Vi(Hi,Ki),this.Hi=Mi.min(),this.hi=t.Yi(n),this.Ji=t.Xi(),this.Zi=t.tr(),this.er=new Za(this.Ji,this.hi,this.persistence.nr()),this.Gi.sr(this.er)}function ph(t){this.Qi=t}function dh(){this.index={}}function vh(){this.Bi=new hh}function yh(t,c){var l=t;return l.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,n,i,o,s,r,u,a=c.batch.keys(),h=l.Ji.ur({cr:!0});return e=l,n=t,o=h,s=(i=c).batch,r=s.keys(),u=Sa.resolve(),r.forEach(function(r){u=u.next(function(){return o.wi(n,r)}).next(function(t){var e=t,n=i.ci.get(r);Fr(null!==n),(!e||e.version.q(n)<0)&&(e=s.si(r,e,i))&&o.ar(e,i.ui)})}),u.next(function(){return e.hi.hr(n,s)}).next(function(){return h.apply(t)}).next(function(){return l.hi.lr(t)}).next(function(){return l.er.Ti(t,a)})})}function gh(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Zi._r(t)})}function mh(t,s){var c=t,l=s.et,f=c.Ki;return c.persistence.runTransaction("Apply remote event","readwrite-primary",function(a){var i=c.Ji.ur({cr:!0});f=c.Ki;var h=[];s.Kt.forEach(function(t,e){var n,r,i,o,s,u=f.get(e);u&&(h.push(c.Zi.dr(a,t.ne,e).next(function(){return c.Zi.wr(a,t.te,e)})),0<(n=t.resumeToken).M()&&(r=u.st(n,l).nt(a.mr),f=f.rt(e,r),i=u,s=t,Fr(0<(o=r).resumeToken.M()),(0===i.resumeToken.M()||3e8<=o.et.J()-i.et.J()||0<s.te.size+s.ee.size+s.ne.size)&&h.push(c.Zi.Tr(a,r))))});var t,o=fo,n=wo();return s.Ht.forEach(function(t,e){n=n.add(t)}),h.push(i.getEntries(a,n).next(function(r){s.Ht.forEach(function(t,e){var n=r.get(t);e instanceof Ru&&e.version.isEqual(Mi.min())?(i.Er(t,l),o=o.rt(t,e)):null==n||0<e.version.q(n.version)||0===e.version.q(n.version)&&n.hasPendingWrites?(i.ar(e,l),o=o.rt(t,e)):Cr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),s.Yt.has(t)&&h.push(c.persistence.Ar.Ir(a,t))})})),l.isEqual(Mi.min())||(t=c.Zi._r(a).next(function(t){return c.Zi.Rr(a,a.mr,l)}),h.push(t)),Sa.Nn(h).next(function(){return i.apply(a)}).next(function(){return c.er.Ei(a,o)})}).then(function(t){return c.Ki=f,t})}function wh(o,s,u){return w(this,void 0,void 0,function(){var e,n,r,i;return b(this,function(t){switch(t.label){case 0:n=(e=o).Ki.get(s),r=u?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),u?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Ar.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!La(i=t.sent()))throw i;return Cr("LocalStore","Failed to update sequence numbers for target "+s+": "+i),[3,5];case 5:return e.Ki=e.Ki.remove(s),e.zi.delete(n.target),[2]}})})}function bh(t,s,u){var a=t,h=Mi.min(),c=wo();return a.persistence.runTransaction("Execute query","readonly",function(e){return t=a,n=e,r=qu(s),(void 0!==(o=(i=t).zi.get(r))?Sa.resolve(i.Ki.get(o)):i.Zi.Pr(n,r)).next(function(t){if(t)return h=t.lastLimboFreeSnapshotVersion,a.Zi.pr(e,t.targetId).next(function(t){c=t})}).next(function(){return a.Gi.Ai(e,s,u?h:Mi.min(),u?c:wo())}).next(function(t){return{documents:t,gr:c}});var t,n,r,i,o})}function Eh(e){return w(this,void 0,void 0,function(){return b(this,function(t){if(e.code!==Lr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Cr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Ih(t,e){this.user=e,this.type="OAuth",this.Br={},this.Br.Authorization="Bearer "+t}var Th,Ah,Nh,Rh=(Yh.prototype.m=function(){return this.Vr.m()},Yh.prototype.Cr=function(t,e){var n=new Sh(t,e);this.Vr=this.Vr.add(n),this.br=this.br.add(n)},Yh.prototype.Dr=function(t,e){var n=this;t.forEach(function(t){return n.Cr(t,e)})},Yh.prototype.Fr=function(t,e){this.$r(new Sh(t,e))},Yh.prototype.Nr=function(t,e){var n=this;t.forEach(function(t){return n.Fr(t,e)})},Yh.prototype.kr=function(t){var e=this,n=new Jr(new Kr([])),r=new Sh(n,t),i=new Sh(n,t+1),o=[];return this.br.Ft([r,i],function(t){e.$r(t),o.push(t.key)}),o},Yh.prototype.Or=function(){var e=this;this.Vr.forEach(function(t){return e.$r(t)})},Yh.prototype.$r=function(t){this.Vr=this.Vr.delete(t),this.br=this.br.delete(t)},Yh.prototype.Mr=function(t){var e=new Jr(new Kr([])),n=new Sh(e,t),r=new Sh(e,t+1),i=wo();return this.br.Ft([n,r],function(t){i=i.add(t.key)}),i},Yh.prototype.qr=function(t){var e=new Sh(t,0),n=this.Vr.Nt(e);return null!==n&&t.isEqual(n.key)},Yh),Sh=(Kh.vr=function(t,e){return Jr.i(t.key,e.key)||Ti(t.Lr,e.Lr)},Kh.Sr=function(t,e){return Ti(t.Lr,e.Lr)||Jr.i(t.key,e.key)},Kh),Oh=(Hh.prototype.getToken=function(){return Promise.resolve(null)},Hh.prototype.Qr=function(){},Hh.prototype.jr=function(t){(this.Ur=t)(za.UNAUTHENTICATED)},Hh.prototype.Wr=function(){this.Ur=null},Hh),kh=(Wh.prototype.getToken=function(){var e=this,n=this.zr,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.zr!==n?(Cr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Fr("string"==typeof t.accessToken),new Ih(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Wh.prototype.Qr=function(){this.forceRefresh=!0},Wh.prototype.jr=function(t){this.Ur=t,this.Kr&&t(this.currentUser)},Wh.prototype.Wr=function(){this.auth&&this.auth.removeAuthTokenListener(this.Gr),this.Gr=null,this.Ur=null},Wh.prototype.Hr=function(){var t=this.auth&&this.auth.getUid();return Fr(null===t||"string"==typeof t),new za(t)},Wh),Lh=(Object.defineProperty(Qh.prototype,"Br",{get:function(){var t={"X-Goog-AuthUser":this.Jr},e=this.Yr.auth.Xr([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Qh),Dh=(Bh.prototype.getToken=function(){return Promise.resolve(new Lh(this.Yr,this.Jr))},Bh.prototype.jr=function(t){t(za.Fs)},Bh.prototype.Wr=function(){},Bh.prototype.Qr=function(){},Bh),Ph=(zh.prototype.ro=function(){return 1===this.state||2===this.state||4===this.state},zh.prototype.oo=function(){return 2===this.state},zh.prototype.start=function(){3!==this.state?this.auth():this.uo()},zh.prototype.stop=function(){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return this.ro()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},zh.prototype.co=function(){this.state=0,this.Jn.reset()},zh.prototype.ao=function(){var t=this;this.oo()&&null===this.io&&(this.io=this._n.Pn(this.Zr,6e4,function(){return t.ho()}))},zh.prototype.lo=function(t){this._o(),this.stream.send(t)},zh.prototype.ho=function(){return w(this,void 0,void 0,function(){return b(this,function(t){return this.oo()?[2,this.close(0)]:[2]})})},zh.prototype._o=function(){this.io&&(this.io.cancel(),this.io=null)},zh.prototype.close=function(e,n){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return this._o(),this.Jn.cancel(),this.so++,3!==e?this.Jn.reset():n&&n.code===Lr.RESOURCE_EXHAUSTED?(Mr(n.toString()),Mr("Using maximum backoff delay to prevent overloading the backend."),this.Jn.An()):n&&n.code===Lr.UNAUTHENTICATED&&this.no.Qr(),null!==this.stream&&(this.fo(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.do(n)];case 1:return t.sent(),[2]}})})},zh.prototype.fo=function(){},zh.prototype.auth=function(){var n=this;this.state=1;var t=this.wo(this.so),e=this.so;this.no.getToken().then(function(t){n.so===e&&n.mo(t)},function(e){t(function(){var t=new Dr(Lr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.To(t)})})},zh.prototype.mo=function(t){var e=this,n=this.wo(this.so);this.stream=this.Eo(t),this.stream.Io(function(){n(function(){return e.state=2,e.listener.Io()})}),this.stream.do(function(t){n(function(){return e.To(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},zh.prototype.uo=function(){var t=this;this.state=4,this.Jn.Rn(function(){return w(t,void 0,void 0,function(){return b(this,function(t){return this.state=0,this.start(),[2]})})})},zh.prototype.To=function(t){return Cr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},zh.prototype.wo=function(e){var n=this;return function(t){n._n.Qn(function(){return n.so===e?t():(Cr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},zh),_h=(o(Gh,Nh=Ph),Gh.prototype.Eo=function(t){return this.eo.Ao("Listen",t)},Gh.prototype.onMessage=function(t){this.Jn.reset();var e=function(t,e){var n,r,i,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:qr(),u=e.targetChange.targetIds||[],a=(i=e.targetChange.resumeToken,t.Ue?(Fr(void 0===i||"string"==typeof i),Ni.fromBase64String(i||"")):(Fr(void 0===i||i instanceof Uint8Array),Ni.fromUint8Array(i||new Uint8Array))),h=e.targetChange.cause,c=h&&(r=void 0===(n=h).code?Lr.UNKNOWN:no(n.code),new Dr(r,n.message||"")),l=new Oo(s,u,a,c||null)}else if("documentChange"in e){e.documentChange;var f=e.documentChange;f.document,f.document.name,f.document.updateTime;var p=vs(t,f.document.name),d=fs(f.document.updateTime),v=new vu({mapValue:{fields:f.document.fields}}),y=new Nu(p,d,v,{}),g=f.targetIds||[],m=f.removedTargetIds||[];l=new Ro(g,m,y.key,y)}else if("documentDelete"in e){e.documentDelete;var w=e.documentDelete;w.document;var b=vs(t,w.document),E=w.readTime?fs(w.readTime):Mi.min(),I=new Ru(b,E),T=w.removedTargetIds||[];l=new Ro([],T,I.key,I)}else if("documentRemove"in e){e.documentRemove;var A=e.documentRemove;A.document;var N=vs(t,A.document),R=A.removedTargetIds||[];l=new Ro([],R,N,null)}else{if(!("filter"in e))return qr();e.filter;var S=e.filter;S.targetId;var O=S.count||0,k=new Xi(O),L=S.targetId;l=new So(L,k)}return l}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Mi.min();var e=t.targetChange;return(!e.targetIds||!e.targetIds.length)&&e.readTime?fs(e.readTime):Mi.min()}(t);return this.listener.Ro(e,n)},Gh.prototype.yo=function(t){var e,n,r,i,o={};o.database=gs(this.serializer),o.addTarget=(e=this.serializer,i=(n=t).target,(r=Yi(i)?{documents:{documents:[ys(e,i.path)]}}:{query:bs(e,i)}).targetId=n.targetId,0<n.resumeToken.M()&&(r.resumeToken=ls(e,n.resumeToken)),r);var s,u,a=(this.serializer,s=t,null==(u=function(){switch(s.tt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return qr()}}())?null:{"goog-listen-tags":u});a&&(o.labels=a),this.lo(o)},Gh.prototype.Po=function(t){var e={};e.database=gs(this.serializer),e.removeTarget=t,this.lo(e)},Gh),Uh=(o(Fh,Ah=Ph),Object.defineProperty(Fh.prototype,"Vo",{get:function(){return this.po},enumerable:!1,configurable:!0}),Fh.prototype.start=function(){this.po=!1,this.lastStreamToken=void 0,Ah.prototype.start.call(this)},Fh.prototype.fo=function(){this.po&&this.vo([])},Fh.prototype.Eo=function(t){return this.eo.Ao("Write",t)},Fh.prototype.onMessage=function(t){if(Fr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.po){this.Jn.reset();var e=(r=t.writeResults,i=t.commitTime,r&&0<r.length?(Fr(void 0!==i),r.map(function(t){return function(t,e){var n=t.updateTime?fs(t.updateTime):fs(e);n.isEqual(Mi.min())&&(n=fs(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new Qs(n,r)}(t,i)})):[]),n=fs(t.commitTime);return this.listener.bo(n,e)}var r,i;return Fr(!t.writeResults||0===t.writeResults.length),this.po=!0,this.listener.So()},Fh.prototype.Co=function(){var t={};t.database=gs(this.serializer),this.lo(t)},Fh.prototype.vo=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return ws(e.serializer,t)})};this.lo(n)},Fh),Vh=(o(qh,Th=function(){}),qh.prototype.Fo=function(){if(this.Do)throw new Dr(Lr.FAILED_PRECONDITION,"The client has already been terminated.")},qh.prototype.$o=function(e,n,r){var i=this;return this.Fo(),this.credentials.getToken().then(function(t){return i.eo.$o(e,n,r,t)}).catch(function(t){throw t.code===Lr.UNAUTHENTICATED&&i.credentials.Qr(),t})},qh.prototype.No=function(e,n,r){var i=this;return this.Fo(),this.credentials.getToken().then(function(t){return i.eo.No(e,n,r,t)}).catch(function(t){throw t.code===Lr.UNAUTHENTICATED&&i.credentials.Qr(),t})},qh.prototype.terminate=function(){this.Do=!1},qh),Ch=(xh.prototype.Mo=function(){var t=this;0===this.xo&&(this.qo("Unknown"),this.ko=this.kn.Pn("online_state_timeout",1e4,function(){return t.ko=null,t.Lo("Backend didn't respond within 10 seconds."),t.qo("Offline"),Promise.resolve()}))},xh.prototype.Bo=function(t){"Online"===this.state?this.qo("Unknown"):(this.xo++,1<=this.xo&&(this.Uo(),this.Lo("Connection failed 1 times. Most recent error: "+t.toString()),this.qo("Offline")))},xh.prototype.set=function(t){this.Uo(),this.xo=0,"Online"===t&&(this.Oo=!1),this.qo(t)},xh.prototype.qo=function(t){t!==this.state&&(this.state=t,this.Qs(t))},xh.prototype.Lo=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Oo?(Mr(e),this.Oo=!1):Cr("OnlineStateTracker",e)},xh.prototype.Uo=function(){null!==this.ko&&(this.ko.cancel(),this.ko=null)},xh),Mh=(jh.prototype.start=function(){return Xh(this)},jh);function jh(t,e,n,r,i){var o,s,u,a,h,c,l,f,p=this;this.Qo=t,this.jo=e,this.kn=n,this.Wo=[],this.Go=new Map,this.Ko=null,this.zo=new Set,this.Ho={},this.Yo=i,this.Yo.Jo(function(t){n.Qn(function(){return w(p,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return sc(this)?(Cr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return w(this,void 0,void 0,function(){var e;return b(this,function(t){switch(t.label){case 0:return(e=n).zo.add(4),[4,Zh(e)];case 1:return t.sent(),e.Xo.co(),e.Zo.co(),e.tu.set("Unknown"),e.zo.delete(4),[4,Jh(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.tu=new Ch(n,r),this.Zo=(h=this.jo,c=n,l={Io:function(n){return w(this,void 0,void 0,function(){return b(this,function(t){return n.Go.forEach(function(t,e){nc(n,t)}),[2]})})}.bind(null,this),do:function(e,n){return w(this,void 0,void 0,function(){return b(this,function(t){return uc(e),oc(e)?(e.tu.Bo(n),ic(e)):e.tu.set("Unknown"),[2]})})}.bind(null,this),Ro:function(u,a,h){return w(this,void 0,void 0,function(){var n,o,s;return b(this,function(t){switch(t.label){case 0:if(u.tu.set("Online"),!(a instanceof Oo&&2===a.state&&a.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return w(this,void 0,void 0,function(){var e,n,r,i;return b(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Go.has(i)?[4,o.Ho.eu(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Go.delete(i),o.Ko.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(u,a)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Cr("RemoteStore","Failed to remove targets %s: %s ",a.targetIds.join(","),n),[4,ac(u,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(a instanceof Ro?u.Ko.Ve(a):a instanceof So?u.Ko.Ne(a):u.Ko.Se(a),h.isEqual(Mi.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,gh(u.Qo)];case 8:return o=t.sent(),0<=h.q(o)?[4,(i=h,(e=(r=u).Ko.Oe(i)).Kt.forEach(function(t,e){var n;0<t.resumeToken.M()&&((n=r.Go.get(e))&&r.Go.set(e,n.st(t.resumeToken,i)))}),e.zt.forEach(function(t){var e,n=r.Go.get(t);n&&(r.Go.set(t,n.st(Ni.L,n.et)),rc(r,t),e=new $i(n.target,t,1,n.sequenceNumber),nc(r,e))}),r.Ho.nu(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Cr("RemoteStore","Failed to raise snapshot:",s=t.sent()),[4,ac(u,s)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,this)},(f=h).Fo(),new _h(c,f.eo,f.credentials,f.serializer,l)),this.Xo=(o=this.jo,s=n,u={Io:function(e){return w(this,void 0,void 0,function(){return b(this,function(t){return e.Xo.Co(),[2]})})}.bind(null,this),do:function(e,n){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return n&&e.Xo.Vo?[4,function(r,i){return w(this,void 0,void 0,function(){var e,n;return b(this,function(t){switch(t.label){case 0:return eo(n=i.code)&&n!==Lr.ABORTED?(e=r.Wo.shift(),r.Xo.co(),[4,hc(r,function(){return r.Ho.iu(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,cc(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return lc(e)&&fc(e),[2]}})})}.bind(null,this),So:function(i){return w(this,void 0,void 0,function(){var e,n,r;return b(this,function(t){for(e=0,n=i.Wo;e<n.length;e++)r=n[e],i.Xo.vo(r.mutations);return[2]})})}.bind(null,this),bo:function(r,i,o){return w(this,void 0,void 0,function(){var e,n;return b(this,function(t){switch(t.label){case 0:return e=r.Wo.shift(),n=Ja.from(e,i,o),[4,hc(r,function(){return r.Ho.su(n)})];case 1:return t.sent(),[4,cc(r)];case 2:return t.sent(),[2]}})})}.bind(null,this)},(a=o).Fo(),new Uh(s,a.eo,a.credentials,a.serializer,u))}function xh(t,e){this.kn=t,this.Qs=e,this.state="Unknown",this.xo=0,this.ko=null,this.Oo=!0}function qh(t,e,n){var r=this;return(r=Th.call(this)||this).credentials=t,r.eo=e,r.serializer=n,r.Do=!1,r}function Fh(t,e,n,r,i){var o=this;return(o=Ah.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.po=!1,o}function Gh(t,e,n,r,i){var o=this;return(o=Nh.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function zh(t,e,n,r,i,o){this._n=t,this.Zr=n,this.eo=r,this.no=i,this.listener=o,this.state=0,this.so=0,this.io=null,this.stream=null,this.Jn=new Ra(t,e)}function Bh(t,e){this.Yr=t,this.Jr=e}function Qh(t,e){this.Yr=t,this.Jr=e,this.type="FirstParty",this.user=za.Fs}function Wh(t){var e=this;this.Gr=null,this.currentUser=za.UNAUTHENTICATED,this.Kr=!1,this.zr=0,this.Ur=null,this.forceRefresh=!1,this.Gr=function(){e.zr++,e.currentUser=e.Hr(),e.Kr=!0,e.Ur&&e.Ur(e.currentUser)},this.zr=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Gr):(this.Gr(null),t.get().then(function(t){e.auth=t,e.Gr&&e.auth.addAuthTokenListener(e.Gr)},function(){}))}function Hh(){this.Ur=null}function Kh(t,e){this.key=t,this.Lr=e}function Yh(){this.Vr=new co(Sh.vr),this.br=new co(Sh.Sr)}function Xh(t){var e=t;return e.zo.delete(0),Jh(e)}function Jh(e){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return sc(e)?(oc(e)?ic(e):e.tu.set("Unknown"),[4,cc(e)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}function Zh(e){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return[4,e.Xo.stop()];case 1:return t.sent(),[4,e.Zo.stop()];case 2:return t.sent(),0<e.Wo.length&&(Cr("RemoteStore","Stopping write stream with "+e.Wo.length+" pending writes"),e.Wo=[]),uc(e),[2]}})})}function $h(n){return w(this,void 0,void 0,function(){var e;return b(this,function(t){switch(t.label){case 0:return e=n,Cr("RemoteStore","RemoteStore shutting down."),e.zo.add(5),[4,Zh(e)];case 1:return t.sent(),e.Yo.ei(),e.tu.set("Unknown"),[2]}})})}function tc(t,e){var n=t;n.Go.has(e.targetId)||(n.Go.set(e.targetId,e),oc(n)?ic(n):n.Zo.oo()&&nc(n,e))}function ec(t,e){var n=t;n.Go.delete(e),n.Zo.oo()&&rc(n,e),0===n.Go.size&&(n.Zo.oo()?n.Zo.ao():sc(n)&&n.tu.set("Unknown"))}function nc(t,e){t.Ko.Ee(e.targetId),t.Zo.yo(e)}function rc(t,e){t.Ko.Ee(e),t.Zo.Po(e)}function ic(e){e.Ko=new Lo({Le:function(t){return e.Ho.Le(t)},Be:function(t){return e.Go.get(t)||null}}),e.Zo.start(),e.tu.Mo()}function oc(t){return sc(t)&&!t.Zo.ro()&&0<t.Go.size}function sc(t){return 0===t.zo.size}function uc(t){t.Ko=null}function ac(n,r,i){return w(this,void 0,void 0,function(){var e=this;return b(this,function(t){switch(t.label){case 0:if(!La(r))throw r;return n.zo.add(1),[4,Zh(n)];case 1:return t.sent(),n.tu.set("Offline"),i=i||function(){return gh(n.Qo)},n.kn.rs(function(){return w(e,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return Cr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.zo.delete(1),[4,Jh(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function hc(e,n){return n().catch(function(t){return ac(e,t,n)})}function cc(c){return w(this,void 0,void 0,function(){var s,u,a,h;return b(this,function(t){switch(t.label){case 0:u=0<(s=c).Wo.length?s.Wo[s.Wo.length-1].batchId:-1,t.label=1;case 1:if(!(sc(s)&&s.Wo.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(r=s.Qo,i=u,(o=r).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===i&&(i=-1),o.hi.yr(t,i)}))];case 3:return null===(a=t.sent())?(0===s.Wo.length&&s.Xo.ao(),[3,7]):(u=a.batchId,n=a,(e=s).Wo.push(n),e.Xo.oo()&&e.Xo.Vo&&e.Xo.vo(n.mutations),[3,6]);case 4:return h=t.sent(),[4,ac(s,h)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return lc(s)&&fc(s),[2]}var e,n,r,i,o})})}function lc(t){return sc(t)&&!t.Xo.ro()&&0<t.Wo.length}function fc(t){t.Xo.start()}function pc(t,e,n){this.query=t,this.targetId=e,this.view=n}var dc=function(t){this.key=t},vc=function(t){this.key=t},yc=(Object.defineProperty(bc.prototype,"hu",{get:function(){return this.ru},enumerable:!1,configurable:!0}),bc.prototype.lu=function(t,e){var u=this,a=e?e._u:new Io,h=e?e.au:this.au,c=e?e.Qt:this.Qt,l=h,f=!1,p=Uu(this.query)&&h.size===this.query.limit?h.last():null,d=Vu(this.query)&&h.size===this.query.limit?h.first():null;if(t.at(function(t,e){var n=h.get(t),r=(r=e instanceof Nu?e:null)&&(Hu(u.query,r)?r:null),i=!!n&&u.Qt.has(n.key),o=!!r&&(r.Ye||u.Qt.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(a.track({type:3,doc:r}),s=!0):u.fu(n,r)||(a.track({type:2,doc:r}),s=!0,(p&&0<u.cu(r,p)||d&&u.cu(r,d)<0)&&(f=!0)):!n&&r?(a.track({type:0,doc:r}),s=!0):n&&!r&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(f=!0)),s&&(c=r?(l=l.add(r),o?c.add(t):c.delete(t)):(l=l.delete(t),c.delete(t)))}),Uu(this.query)||Vu(this.query))for(;l.size>this.query.limit;){var n=Uu(this.query)?l.last():l.first(),l=l.delete(n.key),c=c.delete(n.key);a.track({type:1,doc:n})}return{au:l,_u:a,du:f,Qt:c}},bc.prototype.fu=function(t,e){return t.Ye&&e.hasCommittedMutations&&!e.Ye},bc.prototype.wu=function(t,e,n){var o=this,r=this.au;this.au=t.au,this.Qt=t.Qt;var i=t._u.Bt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.cu(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return qr()}}var r,i}),this.mu(n);var s=e?this.Tu():[],u=0===this.uu.size&&this.Zt?1:0,a=u!==this.ou;return this.ou=u,0!==i.length||a?{snapshot:new To(this.query,t.au,r,i,t.Qt,0==u,a,!1),Eu:s}:{Eu:s}},bc.prototype.Is=function(t){return this.Zt&&"Offline"===t?(this.Zt=!1,this.wu({au:this.au,_u:new Io,Qt:this.Qt,du:!1},!1)):{Eu:[]}},bc.prototype.Iu=function(t){return!this.ru.has(t)&&!!this.au.has(t)&&!this.au.get(t).Ye},bc.prototype.mu=function(t){var e=this;t&&(t.te.forEach(function(t){return e.ru=e.ru.add(t)}),t.ee.forEach(function(t){}),t.ne.forEach(function(t){return e.ru=e.ru.delete(t)}),this.Zt=t.Zt)},bc.prototype.Tu=function(){var e=this;if(!this.Zt)return[];var n=this.uu;this.uu=wo(),this.au.forEach(function(t){e.Iu(t.key)&&(e.uu=e.uu.add(t.key))});var r=[];return n.forEach(function(t){e.uu.has(t)||r.push(new vc(t))}),this.uu.forEach(function(t){n.has(t)||r.push(new dc(t))}),r},bc.prototype.Au=function(t){this.ru=t.gr,this.uu=wo();var e=this.lu(t.documents);return this.wu(e,!0)},bc.prototype.Ru=function(){return To.Gt(this.query,this.au,this.Qt,0===this.ou)},bc),gc=function(t){this.key=t,this.yu=!1},mc=(Object.defineProperty(wc.prototype,"Ou",{get:function(){return!0===this.ku},enumerable:!1,configurable:!0}),wc.prototype.subscribe=function(t){this.Vu=t},wc.prototype.Mu=function(t){},wc);function wc(t,e,n,r,i){this.Qo=t,this.Pu=e,this.pu=n,this.currentUser=r,this.gu=i,this.Vu=null,this.vu=new Vi(Qu,Bu),this.bu=new Map,this.Su=[],this.Cu=new ro(Jr.i),this.Du=new Map,this.Fu=new Rh,this.$u={},this.Nu=new Map,this.xu=ch.Wi(),this.onlineState="Unknown",this.ku=void 0}function bc(t,e){this.query=t,this.ru=e,this.ou=null,this.Zt=!1,this.uu=wo(),this.Qt=wo(),this.cu=Ku(t),this.au=new Eo(this.cu)}function Ec(l,f){return w(this,void 0,void 0,function(){var o,s,u,a,h,c;return b(this,function(t){switch(t.label){case 0:return(n=l).Pu.Ho.nu=Tc.bind(null,n),n.Pu.Ho.Le=function(t,e){var n=t,r=n.Du.get(e);if(r&&r.yu)return wo().add(r.key);var i=wo(),o=n.bu.get(e);if(!o)return i;for(var s=0,u=o;s<u.length;s++){var a=u[s],h=n.vu.get(a);i=i.xt(h.view.hu)}return i}.bind(null,n),n.Pu.Ho.eu=function(u,a,h){return w(this,void 0,void 0,function(){var e,n,r,i,o,s;return b(this,function(t){switch(t.label){case 0:return(e=u).Mu("rejectListens()"),e.pu.Ks(a,"rejected",h),n=e.Du.get(a),(r=n&&n.key)?(i=(i=new ro(Jr.i)).rt(r,new Ru(r,Mi.min())),o=wo().add(r),s=new Ao(Mi.min(),new Map,new co(Ti),i,o),[4,Tc(e,s)]):[3,2];case 1:return t.sent(),e.Cu=e.Cu.remove(r),e.Du.delete(a),Lc(e),[3,4];case 2:return[4,wh(e.Qo,a,!1).then(function(){return Sc(e,a,h)}).catch(Eh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,n),(o=n).Mu("listen()"),(a=o.vu.get(f))?(s=a.targetId,o.pu.Gs(s),u=a.view.Ru(),[3,4]):[3,1];case 1:return[4,(e=o.Qo,r=qu(f),(i=e).persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Zi.Pr(e,r).next(function(t){return t?(n=t,Sa.resolve(n)):i.Zi.qu(e).next(function(t){return n=new $i(r,t,0,e.mr),i.Zi.Lu(e,n).next(function(){return n})})})}).then(function(t){var e=i.Ki.get(t.targetId);return(null===e||0<t.et.q(e.et))&&(i.Ki=i.Ki.rt(t.targetId,t),i.zi.set(r,t.targetId)),t}))];case 2:return h=t.sent(),c=o.pu.Gs(h.targetId),s=h.targetId,[4,function(u,a,h,c){return w(this,void 0,void 0,function(){var e,n,r,i,o,s;return b(this,function(t){switch(t.label){case 0:return u.Bu=function(t,e,n){return function(i,o,s,u){return w(this,void 0,void 0,function(){var n,e,r;return b(this,function(t){switch(t.label){case 0:return(n=o.view.lu(s)).du?[4,bh(i.Qo,o.query,!1).then(function(t){var e=t.documents;return o.view.lu(e,n)})]:[3,2];case 1:n=t.sent(),t.label=2;case 2:return e=u&&u.Kt.get(o.targetId),r=o.view.wu(n,i.Ou,e),[2,(kc(i,o.targetId,r.Eu),r.snapshot)]}})})}(u,t,e,n)},[4,bh(u.Qo,a,!0)];case 1:return e=t.sent(),n=new yc(a,e.gr),r=n.lu(e.documents),i=No.Xt(h,c&&"Offline"!==u.onlineState),o=n.wu(r,u.Ou,i),kc(u,h,o.Eu),s=new pc(a,h,n),u.vu.set(a,s),u.bu.has(h)?u.bu.get(h).push(a):u.bu.set(h,[a]),[2,o.snapshot]}})})}(o,f,s,"current"===c)];case 3:u=t.sent(),o.Ou&&tc(o.Pu,h),t.label=4;case 4:return[2,u]}var e,r,i,n})})}function Ic(y,g,m){return w(this,void 0,void 0,function(){var a,p,d,v;return b(this,function(t){switch(t.label){case 0:(u=y).Pu.Ho.su=function(i,o){return w(this,void 0,void 0,function(){var e,n,r;return b(this,function(t){switch(t.label){case 0:(e=i).Mu("applySuccessfulWrite()"),n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,yh(e.Qo,o)];case 2:return r=t.sent(),Rc(e,n,null),Nc(e,n),e.pu.Ws(n,"acknowledged"),[4,Dc(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,Eh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,u),u.Pu.Ho.iu=function(s,u,a){return w(this,void 0,void 0,function(){var n,o;return b(this,function(t){switch(t.label){case 0:(n=s).Mu("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Qo,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.hi.Wu(e,r).next(function(t){return Fr(null!==t),n=t.keys(),i.hi.hr(e,t)}).next(function(){return i.hi.lr(e)}).next(function(){return i.er.Ti(e,n)})}))];case 2:return o=t.sent(),Rc(n,u,a),Nc(n,u),n.pu.Ws(u,"rejected",a),[4,Dc(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Eh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,u),(a=u).Mu("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(o=a.Qo,h=g,l=o,f=Ci.now(),s=h.reduce(function(t,e){return t.add(e.key)},wo()),l.persistence.runTransaction("Locally write mutations","readwrite",function(a){return l.er.Ti(a,s).next(function(t){c=t;for(var u,e,n=[],r=0,i=h;r<i.length;r++){var o=i[r],s=(u=o,e=c.get(o.key),u instanceof au?function(t){for(var e=null,n=0,r=u.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Nu?t.field(i.field):void 0,s=Ns(i.transform,o||null);null!=s&&(e=null==e?(new yu).set(i.field,s):e.set(i.field,s))}return e?e.Je():null}(e):null);null!=s&&n.push(new ru(o.key,s,function u(t){var a=[];return zr(t.fields||{},function(t,e){var n=new Xr([t]);if(rs(e)){var r=u(e.mapValue).fields;if(0===r.length)a.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];a.push(n.child(s))}}else a.push(n)}),new zs(a)}(s.proto.mapValue),Ws.exists(!0)))}return l.hi.Uu(a,f,n,h)})}).then(function(t){var e=t.oi(c);return{batchId:t.batchId,Qu:e}}))];case 2:return p=t.sent(),a.pu.js(p.batchId),e=a,n=p.batchId,r=m,i=(i=(i=e.$u[e.currentUser.Cs()])||new ro(Ti)).rt(n,r),e.$u[e.currentUser.Cs()]=i,[4,Dc(a,p.Qu)];case 3:return t.sent(),[4,cc(a.Pu)];case 4:return t.sent(),[3,6];case 5:return d=t.sent(),v=Ca(d,"Failed to persist write"),m.reject(v),[3,6];case 6:return[2]}var e,n,r,i,o,h,c,l,f,s,u})})}function Tc(n,i){return w(this,void 0,void 0,function(){var r,e;return b(this,function(t){switch(t.label){case 0:(r=n).Mu("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,mh(r.Qo,i)];case 2:return e=t.sent(),i.Kt.forEach(function(t,e){var n=r.Du.get(e);n&&(Fr(t.te.size+t.ee.size+t.ne.size<=1),0<t.te.size?n.yu=!0:0<t.ee.size?Fr(n.yu):0<t.ne.size&&(Fr(n.yu),n.yu=!1))}),[4,Dc(r,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,Eh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function Ac(t,r,e){var i,n=t;(n.Ou&&0===e||!n.Ou&&1===e)&&(n.Mu("applyOnlineStateChange()"),i=[],n.vu.forEach(function(t,e){var n=e.view.Is(r);n.snapshot&&i.push(n.snapshot)}),n.Vu.ju(r),n.Vu.Ro(i),n.onlineState=r,n.Ou&&n.pu.ti(r))}function Nc(t,e){(t.Nu.get(e)||[]).forEach(function(t){t.resolve()}),t.Nu.delete(e)}function Rc(t,e,n){var r,i=t,o=i.$u[i.currentUser.Cs()];o&&((r=o.get(e))&&(n?r.reject(n):r.resolve(),o=o.remove(e)),i.$u[i.currentUser.Cs()]=o)}function Sc(e,t,n){void 0===n&&(n=null),e.pu.zs(t);for(var r=0,i=e.bu.get(t);r<i.length;r++){var o=i[r];e.vu.delete(o),n&&e.Vu.Ku(o,n)}e.bu.delete(t),e.Ou&&e.Fu.kr(t).forEach(function(t){e.Fu.qr(t)||Oc(e,t)})}function Oc(t,e){var n=t.Cu.get(e);null!==n&&(ec(t.Pu,n),t.Cu=t.Cu.remove(e),t.Du.delete(n),Lc(t))}function kc(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof dc?(t.Fu.Cr(u.key,e),r=t,i=void 0,i=u.key,r.Cu.get(i)||(Cr("SyncEngine","New document in limbo: "+i),r.Su.push(i),Lc(r))):u instanceof vc?(Cr("SyncEngine","Document no longer in limbo: "+u.key),t.Fu.Fr(u.key,e),t.Fu.qr(u.key)||Oc(t,u.key)):qr()}}function Lc(t){for(;0<t.Su.length&&t.Cu.size<t.gu;){var e=t.Su.shift(),n=t.xu.next();t.Du.set(n,new gc(e)),t.Cu=t.Cu.rt(e,n),tc(t.Pu,new $i(qu(_u(e.path)),n,2,Wa.Os))}}function Dc(n,s,u){return w(this,void 0,void 0,function(){var r,i,o,e;return b(this,function(t){switch(t.label){case 0:return i=[],o=[],e=[],(r=n).vu.forEach(function(t,n){e.push(r.Bu(n,s,u).then(function(t){var e;t&&(r.Ou&&r.pu.Ks(n.targetId,t.fromCache?"not-current":"current"),i.push(t),e=$a.Si(n.targetId,t),o.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),r.Vu.Ro(i),[4,function(c,l){return w(this,void 0,void 0,function(){var r,e,n,i,o,s,u,a,h;return b(this,function(t){switch(t.label){case 0:r=c,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Sa.forEach(l,function(e){return Sa.forEach(e.vi,function(t){return r.persistence.Ar.Cr(n,e.targetId,t)}).next(function(){return Sa.forEach(e.bi,function(t){return r.persistence.Ar.Fr(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!La(e=t.sent()))throw e;return Cr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=l;n<i.length;n++)o=i[n],s=o.targetId,o.fromCache||(u=r.Ki.get(s),a=u.et,h=u.it(a),r.Ki=r.Ki.rt(s,h));return[2]}})})}(r.Qo,o)];case 2:return t.sent(),[2]}})})}function Pc(i,o){return w(this,void 0,void 0,function(){var n,r;return b(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Cr("SyncEngine","User change. New user:",o.Cs()),[4,function(i,o){return w(this,void 0,void 0,function(){var e,n,m,r;return b(this,function(t){switch(t.label){case 0:return n=(e=i).hi,m=e.er,[4,e.persistence.runTransaction("Handle user change","readonly",function(y){var g;return e.hi.zu(y).next(function(t){return g=t,n=e.persistence.Yi(o),m=new Za(e.Ji,n,e.persistence.nr()),n.zu(y)}).next(function(t){for(var e=[],n=[],r=wo(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var v=d[p];r=r.add(v.key)}}return m.Ti(y,r).next(function(t){return{Hu:t,Yu:e,Ju:n}})})})];case 1:return r=t.sent(),[2,(e.hi=n,e.er=m,e.Gi.sr(e.er),r)]}})})}(n.Qo,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Nu.forEach(function(t){t.forEach(function(t){t.reject(new Dr(Lr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Nu.clear(),n.pu.Zs(o,r.Yu,r.Ju),[4,Dc(n,r.Hu)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}var _c,Uc=(xc.prototype.sr=function(t){this.Xu=t},xc.prototype.Ai=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.rn.length||1===r.rn.length&&r.rn[0].field.V())||i.isEqual(Mi.min())?this.Zu(e,r):this.Xu.Ti(e,o).next(function(t){var n=s.tc(r,t);return(Uu(r)||Vu(r))&&s.du(r.on,n,o,i)?s.Zu(e,r):(Vr()<=u.DEBUG&&Cr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Wu(r)),s.Xu.Ai(e,r,i).next(function(e){return n.forEach(function(t){e=e.rt(t.key,t)}),e}))})},xc.prototype.tc=function(n,t){var r=new co(Ku(n));return t.forEach(function(t,e){e instanceof Nu&&Hu(n,e)&&(r=r.add(e))}),r},xc.prototype.du=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.q(r))},xc.prototype.Zu=function(t,e){return Vr()<=u.DEBUG&&Cr("IndexFreeQueryEngine","Using full collection scan to execute query:",Wu(e)),this.Xu.Ai(t,e,Mi.min())},xc),Vc=(jc.prototype.sc=function(t){return Sa.resolve(0===this.hi.length)},jc.prototype.Uu=function(t,e,n,r){var i=this.ec;this.ec++,0<this.hi.length&&this.hi[this.hi.length-1];var o=new Xa(i,e,n,r);this.hi.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.nc=this.nc.add(new Sh(a.key,i)),this.li.Ui(t,a.key.path.h())}return Sa.resolve(o)},jc.prototype.Wu=function(t,e){return Sa.resolve(this.ic(e))},jc.prototype.yr=function(t,e){var n=e+1,r=this.rc(n),i=r<0?0:r;return Sa.resolve(this.hi.length>i?this.hi[i]:null)},jc.prototype.Gu=function(){return Sa.resolve(0===this.hi.length?-1:this.ec-1)},jc.prototype.zu=function(t){return Sa.resolve(this.hi.slice())},jc.prototype.fi=function(t,e){var n=this,r=new Sh(e,0),i=new Sh(e,Number.POSITIVE_INFINITY),o=[];return this.nc.Ft([r,i],function(t){var e=n.ic(t.Lr);o.push(e)}),Sa.resolve(o)},jc.prototype.Ii=function(t,e){var r=this,i=new co(Ti);return e.forEach(function(t){var e=new Sh(t,0),n=new Sh(t,Number.POSITIVE_INFINITY);r.nc.Ft([e,n],function(t){i=i.add(t.Lr)})}),Sa.resolve(this.oc(i))},jc.prototype.gi=function(t,e){var n=e.path,r=n.length+1,i=n;Jr.$(i)||(i=i.child(""));var o=new Sh(new Jr(i),0),s=new co(Ti);return this.nc.$t(function(t){var e=t.key.path;return!!n.T(e)&&(e.length===r&&(s=s.add(t.Lr)),!0)},o),Sa.resolve(this.oc(s))},jc.prototype.oc=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.ic(t);null!==e&&r.push(e)}),r},jc.prototype.hr=function(n,r){var i=this;Fr(0===this.uc(r.batchId,"removed")),this.hi.shift();var o=this.nc;return Sa.forEach(r.mutations,function(t){var e=new Sh(t.key,r.batchId);return o=o.delete(e),i.Ar.cc(n,t.key)}).next(function(){i.nc=o})},jc.prototype.ac=function(t){},jc.prototype.qr=function(t,e){var n=new Sh(e,0),r=this.nc.Nt(n);return Sa.resolve(e.isEqual(r&&r.key))},jc.prototype.lr=function(t){return this.hi.length,Sa.resolve()},jc.prototype.uc=function(t,e){return this.rc(t)},jc.prototype.rc=function(t){return 0===this.hi.length?0:t-this.hi[0].batchId},jc.prototype.ic=function(t){var e=this.rc(t);return e<0||e>=this.hi.length?null:this.hi[e]},jc),Cc=(Mc.prototype.ar=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.hc(e);return this.docs=this.docs.rt(r,{lc:e,size:s,readTime:n}),this.size+=s-o,this.li.Ui(t,r.path.h())},Mc.prototype.Er=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Mc.prototype.wi=function(t,e){var n=this.docs.get(e);return Sa.resolve(n?n.lc:null)},Mc.prototype.getEntries=function(t,e){var n=this,r=fo;return e.forEach(function(t){var e=n.docs.get(t);r=r.rt(t,e?e.lc:null)}),Sa.resolve(r)},Mc.prototype.Ai=function(t,e,n){for(var r=yo,i=new Jr(e.path.child("")),o=this.docs._t(i);o.It();){var s=o.Et(),u=s.key,a=s.value,h=a.lc,c=a.readTime;if(!e.path.T(u.path))break;c.q(n)<=0||h instanceof Nu&&Hu(e,h)&&(r=r.rt(h.key,h))}return Sa.resolve(r)},Mc.prototype._c=function(t,e){return Sa.forEach(this.docs,function(t){return e(t)})},Mc.prototype.ur=function(t){return new Mc.fc(this)},Mc.prototype.dc=function(t){return Sa.resolve(this.size)},Mc);function Mc(t,e){this.li=t,this.hc=e,this.docs=new ro(Jr.i),this.size=0}function jc(t,e){this.li=t,this.Ar=e,this.hi=[],this.ec=1,this.nc=new co(Sh.vr)}function xc(){}function qc(t){var e=this;return(e=_c.call(this)||this).Ac=t,e}function Fc(){this.Qu=new Vi(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.wc=!1}Cc.fc=(Object.defineProperty(Fc.prototype,"readTime",{get:function(){return this.mc},set:function(t){this.mc=t},enumerable:!1,configurable:!0}),Fc.prototype.ar=function(t,e){this.Tc(),this.readTime=e,this.Qu.set(t.key,t)},Fc.prototype.Er=function(t,e){this.Tc(),e&&(this.readTime=e),this.Qu.set(t,null)},Fc.prototype.wi=function(t,e){this.Tc();var n=this.Qu.get(e);return void 0!==n?Sa.resolve(n):this.Ec(t,e)},Fc.prototype.getEntries=function(t,e){return this.Ic(t,e)},Fc.prototype.apply=function(t){return this.Tc(),this.wc=!0,this.wu(t)},Fc.prototype.Tc=function(){},o(qc,_c=Fc),qc.prototype.wu=function(n){var r=this,i=[];return this.Qu.forEach(function(t,e){e?i.push(r.Ac.ar(n,e,r.readTime)):r.Ac.Er(t)}),Sa.Nn(i)},qc.prototype.Ec=function(t,e){return this.Ac.wi(t,e)},qc.prototype.Ic=function(t,e){return this.Ac.getEntries(t,e)},qc);var Gc,zc,Bc=(al.prototype.Ce=function(t,n){return this.Rc.forEach(function(t,e){return n(e)}),Sa.resolve()},al.prototype._r=function(t){return Sa.resolve(this.lastRemoteSnapshotVersion)},al.prototype.Vc=function(t){return Sa.resolve(this.yc)},al.prototype.qu=function(t){return this.highestTargetId=this.gc.next(),Sa.resolve(this.highestTargetId)},al.prototype.Rr=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.yc&&(this.yc=e),Sa.resolve()},al.prototype.vc=function(t){this.Rc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.gc=new ch(e),this.highestTargetId=e),t.sequenceNumber>this.yc&&(this.yc=t.sequenceNumber)},al.prototype.Lu=function(t,e){return this.vc(e),this.targetCount+=1,Sa.resolve()},al.prototype.Tr=function(t,e){return this.vc(e),Sa.resolve()},al.prototype.bc=function(t,e){return this.Rc.delete(e.target),this.Pc.kr(e.targetId),--this.targetCount,Sa.resolve()},al.prototype.Sc=function(n,r,i){var o=this,s=0,u=[];return this.Rc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Rc.delete(t),u.push(o.Cc(n,e.targetId)),s++)}),Sa.Nn(u).next(function(){return s})},al.prototype.Dc=function(t){return Sa.resolve(this.targetCount)},al.prototype.Pr=function(t,e){var n=this.Rc.get(e)||null;return Sa.resolve(n)},al.prototype.wr=function(t,e,n){return this.Pc.Dr(e,n),Sa.resolve()},al.prototype.dr=function(e,t,n){this.Pc.Nr(t,n);var r=this.persistence.Ar,i=[];return r&&t.forEach(function(t){i.push(r.cc(e,t))}),Sa.Nn(i)},al.prototype.Cc=function(t,e){return this.Pc.kr(e),Sa.resolve()},al.prototype.pr=function(t,e){var n=this.Pc.Mr(e);return Sa.resolve(n)},al.prototype.qr=function(t,e){return Sa.resolve(this.Pc.qr(e))},al),Qc=(ul.prototype.start=function(){return Promise.resolve()},ul.prototype.ei=function(){return this.Nc=!1,Promise.resolve()},Object.defineProperty(ul.prototype,"kc",{get:function(){return this.Nc},enumerable:!1,configurable:!0}),ul.prototype.Oc=function(){},ul.prototype.Mc=function(){},ul.prototype.nr=function(){return this.li},ul.prototype.Yi=function(t){var e=this.Fc[t.Cs()];return e||(e=new Vc(this.li,this.Ar),this.Fc[t.Cs()]=e),e},ul.prototype.tr=function(){return this.Zi},ul.prototype.Xi=function(){return this.ai},ul.prototype.runTransaction=function(t,e,n){var r=this;Cr("MemoryPersistence","Starting transaction:",t);var i=new Wc(this.$c.next());return this.Ar.qc(),n(i).next(function(t){return r.Ar.Lc(i).next(function(){return t})}).Fn().then(function(t){return i.Bc(),t})},ul.prototype.Uc=function(e,n){return Sa.xn(Object.values(this.Fc).map(function(t){return function(){return t.qr(e,n)}}))},ul),Wc=(sl.prototype.jc=function(t){this.Qc.push(t)},sl.prototype.Bc=function(){this.Qc.forEach(function(t){return t()})},o(ol,zc=sl),ol),Hc=(il.Kc=function(t){return new il(t)},Object.defineProperty(il.prototype,"zc",{get:function(){if(this.Gc)return this.Gc;throw qr()},enumerable:!1,configurable:!0}),il.prototype.Cr=function(t,e,n){return this.Wc.Cr(n,e),this.zc.delete(n.toString()),Sa.resolve()},il.prototype.Fr=function(t,e,n){return this.Wc.Fr(n,e),this.zc.add(n.toString()),Sa.resolve()},il.prototype.cc=function(t,e){return this.zc.add(e.toString()),Sa.resolve()},il.prototype.removeTarget=function(t,e){var n=this;this.Wc.kr(e.targetId).forEach(function(t){return n.zc.add(t.toString())});var r=this.persistence.tr();return r.pr(t,e.targetId).next(function(t){t.forEach(function(t){return n.zc.add(t.toString())})}).next(function(){return r.bc(t,e)})},il.prototype.qc=function(){this.Gc=new Set},il.prototype.Lc=function(n){var r=this,i=this.persistence.Xi().ur();return Sa.forEach(this.zc,function(t){var e=Jr.C(t);return r.Hc(n,e).next(function(t){t||i.Er(e)})}).next(function(){return r.Gc=null,i.apply(n)})},il.prototype.Ir=function(t,e){var n=this;return this.Hc(t,e).next(function(t){t?n.zc.delete(e.toString()):n.zc.add(e.toString())})},il.prototype.xc=function(t){return 0},il.prototype.Hc=function(t,e){var n=this;return Sa.xn([function(){return Sa.resolve(n.Wc.qr(e))},function(){return n.persistence.tr().qr(t,e)},function(){return n.persistence.Uc(t,e)}])},il),Kc=(rl.prototype.Io=function(t){this.Xc=t},rl.prototype.do=function(t){this.Zc=t},rl.prototype.onMessage=function(t){this.ta=t},rl.prototype.close=function(){this.Jc()},rl.prototype.send=function(t){this.Yc(t)},rl.prototype.ea=function(){this.Xc()},rl.prototype.na=function(t){this.Zc(t)},rl.prototype.sa=function(t){this.ta(t)},rl),Yc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Xc=(nl.prototype.$o=function(e,t,n,r){var i=this.ua(e,t);Cr("RestConnection","Sending: ",i,n);var o={};return this.ca(o,r),this.aa(e,i,o,n).then(function(t){return Cr("RestConnection","Received: ",t),t},function(t){throw jr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},nl.prototype.No=function(t,e,n,r){return this.$o(t,e,n,r)},nl.prototype.ca=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.20.0-202088235442",t["Content-Type"]="text/plain",e)for(var n in e.Br)e.Br.hasOwnProperty(n)&&(t[n]=e.Br[n])},nl.prototype.ua=function(t,e){var n=Yc[t];return this.ra+"/v1/"+e+":"+n},o(el,Gc=nl),el.prototype.aa=function(a,e,n,r){return new Promise(function(o,s){var u=new Rr;u.listenOnce(Ar.COMPLETE,function(){try{switch(u.getLastErrorCode()){case Tr.NO_ERROR:var t=u.getResponseJson();Cr("Connection","XHR received:",JSON.stringify(t)),o(t);break;case Tr.TIMEOUT:Cr("Connection",'RPC "'+a+'" timed out'),s(new Dr(Lr.DEADLINE_EXCEEDED,"Request time out"));break;case Tr.HTTP_ERROR:var e,n,r=u.getStatus();Cr("Connection",'RPC "'+a+'" failed with status:',r,"response text:",u.getResponseText()),0<r?(e=u.getResponseJson().error)&&e.status&&e.message?(i=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(Lr).indexOf(i)?i:Lr.UNKNOWN,s(new Dr(n,e.message))):s(new Dr(Lr.UNKNOWN,"Server responded with status "+u.getStatus())):s(new Dr(Lr.UNAVAILABLE,"Connection failed."));break;default:qr()}}finally{Cr("Connection",'RPC "'+a+'" completed.')}var i});var t=JSON.stringify(r);u.send(e,"POST",t,n,15)})},el.prototype.Ao=function(t,e){var n,r,i=[this.ra,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Ir(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.U.projectId+"/databases/"+this.U.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.ca(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(v())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=v().indexOf("Electron/")||(0<=(r=v()).indexOf("MSIE ")||0<=r.indexOf("Trident/"))||0<=v().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");Cr("Connection","Creating WebChannel: "+u,s);function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}var h=o.createWebChannel(u,s),c=!1,l=!1,f=new Kc({Yc:function(t){l?Cr("Connection","Not sending because WebChannel is closed:",t):(c||(Cr("Connection","Opening WebChannel transport."),h.open(),c=!0),Cr("Connection","WebChannel sending:",t),h.send(t))},Jc:function(){return h.close()}});return a(Nr.EventType.OPEN,function(){l||Cr("Connection","WebChannel transport opened.")}),a(Nr.EventType.CLOSE,function(){l||(l=!0,Cr("Connection","WebChannel transport closed"),f.na())}),a(Nr.EventType.ERROR,function(t){l||(l=!0,jr("Connection","WebChannel transport errored:",t),f.na(new Dr(Lr.UNAVAILABLE,"The operation could not be completed")))}),a(Nr.EventType.MESSAGE,function(t){var e,n,r,i,o,s;l||(Fr(!!(n=t.data[0])),(r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(Cr("Connection","WebChannel received error:",r),i=r.status,o=function(){var t=Ji[i];if(void 0!==t)return no(t)}(),s=r.message,void 0===o&&(o=Lr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),l=!0,f.na(new Dr(o,s)),h.close()):(Cr("Connection","WebChannel received:",n),f.sa(n)))}),setTimeout(function(){f.ea()},0),f},el),Jc=(tl.prototype.Jo=function(t){this.da.push(t)},tl.prototype.ei=function(){window.removeEventListener("online",this.ha),window.removeEventListener("offline",this._a)},tl.prototype.wa=function(){window.addEventListener("online",this.ha),window.addEventListener("offline",this._a)},tl.prototype.la=function(){Cr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.da;t<e.length;t++)(0,e[t])(0)},tl.prototype.fa=function(){Cr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.da;t<e.length;t++)(0,e[t])(1)},tl.ma=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},tl),Zc=($c.prototype.Jo=function(t){},$c.prototype.ei=function(){},$c);function $c(){}function tl(){var t=this;this.ha=function(){return t.la()},this._a=function(){return t.fa()},this.da=[],this.wa()}function el(t){var e=this;return(e=Gc.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function nl(t){this.ia=t,this.U=t.U;var e=t.ssl?"https":"http";this.ra=e+"://"+t.host,this.oa="projects/"+this.U.projectId+"/databases/"+this.U.database+"/documents"}function rl(t){this.Yc=t.Yc,this.Jc=t.Jc}function il(t){this.persistence=t,this.Wc=new Rh,this.Gc=null}function ol(t){var e=this;return(e=zc.call(this)||this).mr=t,e}function sl(){this.Qc=[]}function ul(t){var e=this;this.Fc={},this.$c=new Wa(0),this.Nc=!1,this.Nc=!0,this.Ar=t(this),this.Zi=new Bc(this),this.li=new ah,this.ai=new Cc(this.li,function(t){return e.Ar.xc(t)})}function al(t){this.persistence=t,this.Rc=new Vi(Hi,Ki),this.lastRemoteSnapshotVersion=Mi.min(),this.highestTargetId=0,this.yc=0,this.Pc=new Rh,this.targetCount=0,this.gc=ch.ji()}function hl(t){return new ss(t,!0)}var cl="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",ll=(dl.prototype.initialize=function(e){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return this.pu=this.Ta(e),this.persistence=this.Ea(e),[4,this.persistence.start()];case 1:return t.sent(),this.Ia=this.Aa(e),this.Qo=this.Ra(e),[2]}})})},dl.prototype.Aa=function(t){return null},dl.prototype.Ra=function(t){return e=this.persistence,n=new Uc,r=t.ya,new lh(e,n,r);var e,n,r},dl.prototype.Ea=function(t){if(t.pa.Pa)throw new Dr(Lr.FAILED_PRECONDITION,cl);return new Qc(Hc.Kc)},dl.prototype.Ta=function(t){return new Ya},dl.prototype.terminate=function(){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return this.Ia&&this.Ia.stop(),[4,this.pu.ei()];case 1:return t.sent(),[4,this.persistence.ei()];case 2:return t.sent(),[2]}})})},dl.prototype.clearPersistence=function(t,e){throw new Dr(Lr.FAILED_PRECONDITION,cl)},dl),fl=(pl.prototype.initialize=function(n,r){return w(this,void 0,void 0,function(){var e=this;return b(this,function(t){switch(t.label){case 0:return this.Qo?[3,2]:(this.Qo=n.Qo,this.pu=n.pu,this.jo=this.ga(r),this.Pu=this.Va(r),this.va=this.ba(r),this.Sa=this.Ca(r),this.va.subscribe({Ro:function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,a=n.ws.get(u);if(a){for(var h=0,c=a.listeners;h<c.length;h++)c[h].As(s)&&(r=!0);a.ds=s}}r&&Fa(n)}.bind(null,this.Sa),Ku:function(t,e,n){var r=t,i=r.ws.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.ws.delete(e)}.bind(null,this.Sa),ju:function(t,i){var e=t;e.onlineState=i;var o=!1;e.ws.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Is(i)&&(o=!0)}),o&&Fa(e)}.bind(null,this.Sa)}),this.pu.Qs=function(t){return Ac(e.va,t,1)},this.Pu.Ho.Da=Pc.bind(null,this.va),[4,function(n,r){return w(this,void 0,void 0,function(){var e;return b(this,function(t){switch(t.label){case 0:return e=n,r?(e.zo.delete(2),[4,Jh(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.zo.add(2),[4,Zh(e)]);case 3:t.sent(),e.tu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.Pu,this.va.Ou)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},pl.prototype.Ca=function(t){return new Ma},pl.prototype.ga=function(t){var e,n,r=hl(t.ia.U),i=(e=t.ia,new Xc(e));return n=t.credentials,new Vh(n,i,r)},pl.prototype.Va=function(t){var e=this,n=this.Qo,r=this.jo,i=t.kn,o=function(t){return Ac(e.va,t,0)},s=new(Jc.ma()?Jc:Zc);return new Mh(n,r,i,o,s)},pl.prototype.ba=function(t){return e=this.Qo,n=this.Pu,r=this.pu,i=t.ya,o=t.gu,s=!t.pa.Pa||!t.pa.synchronizeTabs,u=new mc(e,n,r,i,o),s&&(u.ku=!0),u;var e,n,r,i,o,s,u},pl.prototype.terminate=function(){return $h(this.Pu)},pl);function pl(){}function dl(){}function vl(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var yl,gl,ml=(Rl.prototype.next=function(t){this.observer.next&&this.Fa(this.observer.next,t)},Rl.prototype.error=function(t){this.observer.error?this.Fa(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Rl.prototype.$a=function(){this.muted=!0},Rl.prototype.Fa=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Rl),wl=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Dr(Lr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(si("FieldPath","string",e,t[e]),0===t[e].length)throw new Dr(Lr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Na=new Xr(t)},bl=(o(Nl,gl=wl),Nl.documentId=function(){return new Nl(Xr.v().R())},Nl.prototype.isEqual=function(t){if(!(t instanceof Nl))throw gi("isEqual","FieldPath",1,t);return this.Na.isEqual(t.Na)},Nl),El=new RegExp("[~\\*/\\[\\]]"),Il=function(){this.xa=this},Tl=(o(Al,yl=Il),Al.prototype.Oa=function(t){if(2!==t.Ma)throw 1===t.Ma?t.qa(this.ka+"() can only appear at the top level of your update data"):t.qa(this.ka+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},Al.prototype.isEqual=function(t){return t instanceof Al},Al);function Al(t){var e=this;return(e=yl.call(this)||this).ka=t,e}function Nl(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return gl.call(this,t)||this}function Rl(t){this.observer=t,this.muted=!1}function Sl(t,e,n){return new ef({Ma:3,La:e.settings.La,methodName:t.ka,Ba:n},e.U,e.serializer,e.ignoreUndefinedProperties)}var Ol,kl,Ll,Dl,Pl,_l,Ul=(o($l,_l=Il),$l.prototype.Oa=function(t){return new Gs(t.path,new Os)},$l.prototype.isEqual=function(t){return t instanceof $l},$l),Vl=(o(Zl,Pl=Il),Zl.prototype.Oa=function(t){var e=Sl(this,t,!0),n=this.Ua.map(function(t){return cf(t,e)}),r=new ks(n);return new Gs(t.path,r)},Zl.prototype.isEqual=function(t){return this===t},Zl),Cl=(o(Jl,Dl=Il),Jl.prototype.Oa=function(t){var e=Sl(this,t,!0),n=this.Ua.map(function(t){return cf(t,e)}),r=new Us(n);return new Gs(t.path,r)},Jl.prototype.isEqual=function(t){return this===t},Jl),Ml=(o(Xl,Ll=Il),Xl.prototype.Oa=function(t){var e=new js(t.serializer,hs(t.serializer,this.Qa));return new Gs(t.path,e)},Xl.prototype.isEqual=function(t){return this===t},Xl),jl=(o(Yl,kl=Il),Yl.delete=function(){return ni("FieldValue.delete",arguments),new xl(new Tl("FieldValue.delete"))},Yl.serverTimestamp=function(){return ni("FieldValue.serverTimestamp",arguments),new xl(new Ul("FieldValue.serverTimestamp"))},Yl.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ii("FieldValue.arrayUnion",arguments,1),new xl(new Vl("FieldValue.arrayUnion",t))},Yl.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ii("FieldValue.arrayRemove",arguments,1),new xl(new Cl("FieldValue.arrayRemove",t))},Yl.increment=function(t){return si("FieldValue.increment","number",1,t),ri("FieldValue.increment",arguments,1),new xl(new Ml("FieldValue.increment",t))},Yl),xl=(o(Kl,Ol=jl),Kl.prototype.Oa=function(t){return this.xa.Oa(t)},Kl.prototype.isEqual=function(t){return t instanceof Kl&&this.xa.isEqual(t.xa)},Kl),ql=(Object.defineProperty(Hl.prototype,"latitude",{get:function(){return this.ja},enumerable:!1,configurable:!0}),Object.defineProperty(Hl.prototype,"longitude",{get:function(){return this.Wa},enumerable:!1,configurable:!0}),Hl.prototype.isEqual=function(t){return this.ja===t.ja&&this.Wa===t.Wa},Hl.prototype.toJSON=function(){return{latitude:this.ja,longitude:this.Wa}},Hl.prototype.H=function(t){return Ti(this.ja,t.ja)||Ti(this.Wa,t.Wa)},Hl),Fl=/^__.*__$/,Gl=function(t,e,n){this.Ga=t,this.Ka=e,this.za=n},zl=(Wl.prototype.Ha=function(t,e){var n=[];return null!==this.Qe?n.push(new ru(t,this.data,this.Qe,e)):n.push(new nu(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new au(t,this.fieldTransforms)),n},Wl),Bl=(Ql.prototype.Ha=function(t,e){var n=[new ru(t,this.data,this.Qe,e)];return 0<this.fieldTransforms.length&&n.push(new au(t,this.fieldTransforms)),n},Ql);function Ql(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function Wl(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function Hl(t,e){if(ri("GeoPoint",arguments,2),si("GeoPoint","number",1,t),si("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Dr(Lr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Dr(Lr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.ja=t,this.Wa=e}function Kl(t){var e=this;return(e=Ol.call(this)||this).xa=t,e.ka=t.ka,e}function Yl(){return kl.call(this)||this}function Xl(t,e){var n=this;return(n=Ll.call(this)||this).ka=t,n.Qa=e,n}function Jl(t,e){var n=this;return(n=Dl.call(this)||this).ka=t,n.Ua=e,n}function Zl(t,e){var n=this;return(n=Pl.call(this)||this).ka=t,n.Ua=e,n}function $l(t){var e=this;return(e=_l.call(this)||this).ka=t,e}function tf(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw qr()}}var ef=(Object.defineProperty(of.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(of.prototype,"Ma",{get:function(){return this.settings.Ma},enumerable:!1,configurable:!0}),of.prototype.Ja=function(t){return new of(Object.assign(Object.assign({},this.settings),t),this.U,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},of.prototype.Xa=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Ja({path:n,Ba:!1});return r.Za(t),r},of.prototype.th=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Ja({path:n,Ba:!1});return r.Ya(),r},of.prototype.eh=function(t){return this.Ja({path:void 0,Ba:!0})},of.prototype.qa=function(t){return yf(t,this.settings.methodName,this.settings.nh||!1,this.path,this.settings.La)},of.prototype.contains=function(e){return void 0!==this.Qe.find(function(t){return e.T(t)})||void 0!==this.fieldTransforms.find(function(t){return e.T(t.field)})},of.prototype.Ya=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Za(this.path.get(t))},of.prototype.Za=function(t){if(0===t.length)throw this.qa("Document fields must not be empty");if(tf(this.Ma)&&Fl.test(t))throw this.qa('Document fields cannot begin and end with "__"')},of),nf=(rf.prototype.sh=function(t,e,n,r){return void 0===r&&(r=!1),new ef({Ma:t,methodName:e,La:n,path:Xr.p(),Ba:!1,nh:r},this.U,this.serializer,this.ignoreUndefinedProperties)},rf);function rf(t,e,n){this.U=t,this.ignoreUndefinedProperties=e,this.serializer=n||hl(t)}function of(t,e,n,r,i,o){this.settings=t,this.U=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Ya(),this.fieldTransforms=i||[],this.Qe=o||[]}function sf(t,e,n,r,i,o){void 0===o&&(o={});var s=t.sh(o.merge||o.mergeFields?2:0,e,n,i);pf("Data must be an object, but it was:",s,r);var u,a,h=lf(r,s);if(o.merge)u=new zs(s.Qe),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],l=0,f=o.mergeFields;l<f.length;l++){var p=f[l],d=void 0;if(p instanceof wl)d=p.Na;else{if("string"!=typeof p)throw qr();d=vf(e,p,n)}if(!s.contains(d))throw new Dr(Lr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");gf(c,d)||c.push(d)}u=new zs(c),a=s.fieldTransforms.filter(function(t){return u.ze(t.field)})}else u=null,a=s.fieldTransforms;return new zl(new vu(h),u,a)}function uf(t,o,s,e){var u=t.sh(1,o,s);pf("Data must be an object, but it was:",u,e);var a=[],h=new yu;zr(e,function(t,e){var n,r=vf(o,t,s),i=u.th(r);e instanceof Il&&e.xa instanceof Tl?a.push(r):null!=(n=cf(e,i))&&(a.push(r),h.set(r,n))});var n=new zs(a);return new Bl(h.Je(),n,u.fieldTransforms)}function af(t,e,n,r,i,o){var s=t.sh(1,e,n),u=[df(e,r,n)],a=[i];if(o.length%2!=0)throw new Dr(Lr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(df(e,o[h])),a.push(o[h+1]);for(var c,l,f,p,d=[],v=new yu,y=u.length-1;0<=y;--y){gf(d,u[y])||(c=u[y],l=a[y],f=s.th(c),l instanceof Il&&l.xa instanceof Tl?d.push(c):null!=(p=cf(l,f))&&(d.push(c),v.set(c,p)))}var g=new zs(d);return new Bl(v.Je(),g,s.fieldTransforms)}function hf(t,e,n,r){return void 0===r&&(r=!1),cf(n,t.sh(r?4:3,e))}function cf(s,t){if(ff(s))return pf("Unsupported field value:",t,s),lf(s,t);if(s instanceof Il)return function(t,e){if(!tf(e.Ma))throw e.qa(t.ka+"() can only be used with update() and set()");if(!e.path)throw e.qa(t.ka+"() is not currently supported inside arrays");var n=t.Oa(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Qe.push(t.path),s instanceof Array){if(t.settings.Ba&&4!==t.Ma)throw t.qa("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=cf(i[r],t.eh(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return hs(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Ci.fromDate(t);return{timestampValue:cs(e.serializer,n)}}if(t instanceof Ci){var r=new Ci(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:cs(e.serializer,r)}}if(t instanceof ql)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Si)return{bytesValue:ls(e.serializer,t.B)};if(t instanceof Gl){var i=e.U,o=t.Ga;if(!o.isEqual(i))throw e.qa("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:ps(t.Ga||e.U,t.Ka.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.qa("Unsupported field value: "+di(t))}(s,t)}function lf(t,r){var i={};return Br(t)?r.path&&0<r.path.length&&r.Qe.push(r.path):zr(t,function(t,e){var n=cf(e,r.Xa(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function ff(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Ci||t instanceof ql||t instanceof Si||t instanceof Gl||t instanceof Il)}function pf(t,e,n){if(!ff(n)||!pi(n)){var r=di(n);throw"an object"===r?e.qa(t+" a custom object"):e.qa(t+" "+r)}}function df(t,e,n){if(e instanceof wl)return e.Na;if("string"==typeof e)return vf(t,e);throw yf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function vf(t,e,n){try{return function(e){if(0<=e.search(El))throw new Dr(Lr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(bl.bind.apply(bl,s([void 0],e.split("."))))}catch(t){throw new Dr(Lr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Na}catch(e){throw yf(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function yf(t,e,n,r,i){var o=r&&!r.m(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new Dr(Lr.INVALID_ARGUMENT,(u+=". ")+t+a)}function gf(t,e){return t.some(function(t){return t.isEqual(e)})}var mf=(Tf.prototype.ah=function(r){return w(this,void 0,void 0,function(){var e,n=this;return b(this,function(t){switch(t.label){case 0:if(this.hh(),0<this.mutations.length)throw new Dr(Lr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(u,a){return w(this,void 0,void 0,function(){var i,e,n,r,o,s;return b(this,function(t){switch(t.label){case 0:return e=gs((i=u).serializer)+"/documents",n={documents:a.map(function(t){return ds(i.serializer,t)})},[4,i.No("BatchGetDocuments",e,n)];case 1:return r=t.sent(),o=new Map,r.forEach(function(t){var e,n,r=(e=i.serializer,"found"in(n=t)?function(t,e){Fr(!!e.found),e.found.name,e.found.updateTime;var n=vs(t,e.found.name),r=fs(e.found.updateTime),i=new vu({mapValue:{fields:e.found.fields}});return new Nu(n,r,i,{})}(e,n):"missing"in n?function(t,e){Fr(!!e.missing),Fr(!!e.readTime);var n=vs(t,e.missing),r=fs(e.readTime);return new Ru(n,r)}(e,n):qr());o.set(r.key.toString(),r)}),s=[],[2,(a.forEach(function(t){var e=o.get(t.toString());Fr(!!e),s.push(e)}),s)]}})})}(this.jo,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Ru||t instanceof Nu?n.lh(t):qr()}),e)]}})})},Tf.prototype.set=function(t,e){this.write(e.Ha(t,this.Ge(t))),this.uh.add(t.toString())},Tf.prototype.update=function(t,e){try{this.write(e.Ha(t,this._h(t)))}catch(t){this.oh=t}this.uh.add(t.toString())},Tf.prototype.delete=function(t){this.write([new pu(t,this.Ge(t))]),this.uh.add(t.toString())},Tf.prototype.commit=function(){return w(this,void 0,void 0,function(){var e,r=this;return b(this,function(t){switch(t.label){case 0:if(this.hh(),this.oh)throw this.oh;return e=this.ih,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=Jr.C(e);r.mutations.push(new du(n,r.Ge(n)))}),[4,function(i,o){return w(this,void 0,void 0,function(){var e,n,r;return b(this,function(t){switch(t.label){case 0:return n=gs((e=i).serializer)+"/documents",r={writes:o.map(function(t){return ws(e.serializer,t)})},[4,e.$o("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.jo,this.mutations)];case 1:return t.sent(),this.rh=!0,[2]}})})},Tf.prototype.lh=function(t){var e;if(t instanceof Nu)e=t.version;else{if(!(t instanceof Ru))throw qr();e=Mi.min()}var n=this.ih.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Dr(Lr.ABORTED,"Document version changed between two reads.")}else this.ih.set(t.key.toString(),e)},Tf.prototype.Ge=function(t){var e=this.ih.get(t.toString());return!this.uh.has(t.toString())&&e?Ws.updateTime(e):Ws.He()},Tf.prototype._h=function(t){var e=this.ih.get(t.toString());if(this.uh.has(t.toString())||!e)return Ws.exists(!0);if(e.isEqual(Mi.min()))throw new Dr(Lr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ws.updateTime(e)},Tf.prototype.write=function(t){this.hh(),this.mutations=this.mutations.concat(t)},Tf.prototype.hh=function(){},Tf),wf=(If.prototype.run=function(){this.dh()},If.prototype.dh=function(){var t=this;this.Jn.Rn(function(){return w(t,void 0,void 0,function(){var e,n,r=this;return b(this,function(t){return e=new mf(this.jo),(n=this.wh(e))&&n.then(function(t){r.kn.Qn(function(){return e.commit().then(function(){r.qn.resolve(t)}).catch(function(t){r.mh(t)})})}).catch(function(t){r.mh(t)}),[2]})})})},If.prototype.wh=function(t){try{var e=this.updateFunction(t);return!zi(e)&&e.catch&&e.then?e:(this.qn.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.qn.reject(t),null}},If.prototype.mh=function(t){var e=this;0<this.fh&&this.Th(t)?(--this.fh,this.kn.Qn(function(){return e.dh(),Promise.resolve()})):this.qn.reject(t)},If.prototype.Th=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!eo(e)},If),bf=(Ef.prototype.start=function(t,e,n,r){var i=this;this.Ih(),this.ia=t;var o=new Na,s=!1;return this.credentials.jr(function(t){return s?void i.kn.rs(function(){return function(r,i){return w(this,void 0,void 0,function(){var e,n;return b(this,function(t){switch(t.label){case 0:return(e=r).kn.cs(),Cr("RemoteStore","RemoteStore received new credentials"),n=sc(e),e.zo.add(3),[4,Zh(e)];case 1:return t.sent(),n&&e.tu.set("Unknown"),[4,e.Ho.Da(i)];case 2:return t.sent(),e.zo.delete(3),[4,Jh(e)];case 3:return t.sent(),[2]}})})}(i.Pu,t)}):(s=!0,Cr("FirestoreClient","Initializing. user=",t.uid),i.Ah(e,n,r,t,o).then(i.Eh.resolve,i.Eh.reject))}),this.kn.Qn(function(){return i.Eh.promise}),o.promise},Ef.prototype.enableNetwork=function(){var t=this;return this.Ih(),this.kn.enqueue(function(){return t.persistence.Mc(!0),Xh(t.Pu)})},Ef.prototype.Ah=function(i,o,s,u,a){return w(this,void 0,void 0,function(){var e,n,r=this;return b(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={kn:this.kn,ia:this.ia,clientId:this.clientId,credentials:this.credentials,ya:u,gu:100,pa:s},[4,i.initialize(e)];case 1:return t.sent(),[4,o.initialize(i,e)];case 2:return t.sent(),this.persistence=i.persistence,this.pu=i.pu,this.Qo=i.Qo,this.Ia=i.Ia,this.jo=o.jo,this.Pu=o.Pu,this.va=o.va,this.Rh=o.Sa,this.Rh.Es=Ec.bind(null,this.va),this.Rh.Rs=function(i,o){return w(this,void 0,void 0,function(){var e,n,r;return b(this,function(t){switch(t.label){case 0:return(e=i).Mu("unlisten()"),n=e.vu.get(o),1<(r=e.bu.get(n.targetId)).length?[2,(e.bu.set(n.targetId,r.filter(function(t){return!Bu(t,o)})),void e.vu.delete(o))]:e.Ou?(e.pu.zs(n.targetId),e.pu.Xs(n.targetId)?[3,2]:[4,wh(e.Qo,n.targetId,!1).then(function(){e.pu.Ys(n.targetId),ec(e.Pu,n.targetId),Sc(e,n.targetId)}).catch(Eh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Sc(e,n.targetId),[4,wh(e.Qo,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,this.va),this.persistence.Oc(function(){return w(r,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),a.resolve(),[3,4];case 3:if(n=t.sent(),a.reject(n),!this.yh(n))throw n;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+n),this.Ah(new ll,new fl,{Pa:!1},u,a))];case 4:return[2]}})})},Ef.prototype.yh=function(t){return"FirebaseError"===t.name?t.code===Lr.FAILED_PRECONDITION||t.code===Lr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Ef.prototype.Ih=function(){if(this.kn.Zn)throw new Dr(Lr.FAILED_PRECONDITION,"The client has already been terminated.")},Ef.prototype.disableNetwork=function(){var t=this;return this.Ih(),this.kn.enqueue(function(){return t.persistence.Mc(!1),function(n){return w(this,void 0,void 0,function(){var e;return b(this,function(t){switch(t.label){case 0:return(e=n).zo.add(0),[4,Zh(e)];case 1:return t.sent(),e.tu.set("Offline"),[2]}})})}(t.Pu)})},Ef.prototype.terminate=function(){var t=this;this.kn.ss();var r=new Na;return this.kn.ts(function(){return w(t,void 0,void 0,function(){var e,n;return b(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.Ia&&this.Ia.stop(),[4,$h(this.Pu)];case 1:return t.sent(),[4,this.pu.ei()];case 2:return t.sent(),[4,this.persistence.ei()];case 3:return t.sent(),this.credentials.Wr(),r.resolve(),[3,5];case 4:return e=t.sent(),n=Ca(e,"Failed to shutdown persistence"),r.reject(n),[3,5];case 5:return[2]}})})}),r.promise},Ef.prototype.waitForPendingWrites=function(){var t=this;this.Ih();var e=new Na;return this.kn.Qn(function(){return function(u,a){return w(this,void 0,void 0,function(){var n,r,i,o,s;return b(this,function(t){switch(t.label){case 0:sc((n=u).Pu)||Cr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Qo).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.hi.Gu(t)})];case 2:return-1===(r=t.sent())?[2,void a.resolve()]:((i=n.Nu.get(r)||[]).push(a),n.Nu.set(r,i),[3,4]);case 3:return o=t.sent(),s=Ca(o,"Initialization of waitForPendingWrites() operation failed"),a.reject(s),[3,4];case 4:return[2]}var e})})}(t.va,e)}),e.promise},Ef.prototype.listen=function(t,e,n){var r=this;this.Ih();var i=new ml(n),o=new Ga(t,i,e);return this.kn.Qn(function(){return xa(r.Rh,o)}),function(){i.$a(),r.kn.Qn(function(){return qa(r.Rh,o)})}},Ef.prototype.Ph=function(e){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return this.Ih(),[4,this.Eh.promise];case 1:return[2,(t.sent(),function(n,u,a){return w(this,void 0,void 0,function(){var s,e=this;return b(this,function(t){switch(t.label){case 0:return s=new Na,[4,n.enqueue(function(){return w(e,void 0,void 0,function(){var r,i,o;return b(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=a,(n=u).persistence.runTransaction("read document","readonly",function(t){return n.er._i(t,e)}))];case 1:return(r=t.sent())instanceof Nu?s.resolve(r):r instanceof Ru?s.resolve(null):s.reject(new Dr(Lr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return i=t.sent(),o=Ca(i,"Failed to get document '"+a+" from cache"),s.reject(o),[3,3];case 3:return[2]}var e,n})})})];case 1:return[2,(t.sent(),s.promise)]}})})}(this.kn,this.Qo,e))]}})})},Ef.prototype.ph=function(u,a){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return this.Ih(),[4,this.Eh.promise];case 1:return[2,(t.sent(),e=this.kn,n=this.Rh,r=u,i=a,o=new Na,s=Af(e,n,_u(r.path),{includeMetadataChanges:!0,bs:!0},{next:function(t){s();var e=t.docs.has(r);!e&&t.fromCache?o.reject(new Dr(Lr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&i&&"server"===i.source?o.reject(new Dr(Lr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,r,i,o,s})})},Ef.prototype.gh=function(e){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return this.Ih(),[4,this.Eh.promise];case 1:return[2,(t.sent(),function(n,a,h){return w(this,void 0,void 0,function(){var u,e=this;return b(this,function(t){switch(t.label){case 0:return u=new Na,[4,n.enqueue(function(){return w(e,void 0,void 0,function(){var e,n,r,i,o,s;return b(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,bh(a,h,!0)];case 1:return e=t.sent(),n=new yc(h,e.gr),r=n.lu(e.documents),i=n.wu(r,!1),u.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=Ca(o,"Failed to execute query '"+h+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})}(this.kn,this.Qo,e))]}})})},Ef.prototype.Vh=function(u,a){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return this.Ih(),[4,this.Eh.promise];case 1:return[2,(t.sent(),e=this.kn,n=this.Rh,r=u,i=a,o=new Na,s=Af(e,n,r,{includeMetadataChanges:!0,bs:!0},{next:function(t){s(),t.fromCache&&i&&"server"===i.source?o.reject(new Dr(Lr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,r,i,o,s})})},Ef.prototype.write=function(t){var e=this;this.Ih();var n=new Na;return this.kn.Qn(function(){return Ic(e.va,t,n)}),n.promise},Ef.prototype.U=function(){return this.ia.U},Ef.prototype.bh=function(t){var e=this;this.Ih();var r=new ml(t);return this.kn.Qn(function(){return w(e,void 0,void 0,function(){return b(this,function(t){return[2,(e=this.Rh,n=r,e.Ts.add(n),void n.next())];var e,n})})}),function(){r.$a(),e.kn.Qn(function(){return w(e,void 0,void 0,function(){return b(this,function(t){return[2,void this.Rh.Ts.delete(r)]})})})}},Object.defineProperty(Ef.prototype,"Sh",{get:function(){return this.kn.Zn},enumerable:!1,configurable:!0}),Ef.prototype.transaction=function(t){var e=this;this.Ih();var n=new Na;return this.kn.Qn(function(){return new wf(e.kn,e.jo,t,n).run(),Promise.resolve()}),n.promise},Ef);function Ef(t,e){this.credentials=t,this.kn=e,this.clientId=Ei.k(),this.Eh=new Na}function If(t,e,n,r){this.kn=t,this.jo=e,this.updateFunction=n,this.qn=r,this.fh=5,this.Jn=new Ra(this.kn,"transaction_retry")}function Tf(t){this.jo=t,this.ih=new Map,this.mutations=[],this.rh=!1,this.oh=null,this.uh=new Set}function Af(t,e,n,r,i){var o=new ml(i),s=new Ga(n,o,r);return t.Qn(function(){return xa(e,s)}),function(){o.$a(),t.Qn(function(){return qa(e,s)})}}var Nf,Rf,Sf=(Qf.prototype.$h=function(t){switch(zo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Xo(t.integerValue||t.doubleValue);case 3:return this.Nh(t.timestampValue);case 4:return this.xh(t);case 5:return t.stringValue;case 6:return this.Fh(Jo(t.bytesValue));case 7:return this.kh(t.referenceValue);case 8:return this.Oh(t.geoPointValue);case 9:return this.Mh(t.arrayValue);case 10:return this.qh(t.mapValue);default:throw qr()}},Qf.prototype.qh=function(t){var n=this,r={};return zr(t.fields||{},function(t,e){r[t]=n.$h(e)}),r},Qf.prototype.Oh=function(t){return new ql(Xo(t.latitude),Xo(t.longitude))},Qf.prototype.Mh=function(t){var e=this;return(t.values||[]).map(function(t){return e.$h(t)})},Qf.prototype.xh=function(t){switch(this.Ch){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return qo(n)?t(n):n}(t);return null==e?null:this.$h(e);case"estimate":return this.Nh(Fo(t));default:return null}},Qf.prototype.Nh=function(t){var e=Yo(t),n=new Ci(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},Qf.prototype.kh=function(t){var e=Kr.P(t);Fr(Ts(e));var n=new Ui(e.get(1),e.get(3)),r=new Jr(e.u(5));return n.isEqual(this.U)||Mr("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.U.projectId+"/"+this.U.database+") instead."),this.Dh(r)},Qf),Of=th.ki,kf=(Bf.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Bf),Lf=(Object.defineProperty(zf.prototype,"Yh",{get:function(){return this.Jh||(this.Jh=new nf(this.Ga,this.Hh.ignoreUndefinedProperties)),this.Jh},enumerable:!1,configurable:!0}),zf.prototype.settings=function(t){ri("Firestore.settings",arguments,1),si("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.Hh),t)).merge;var e=new kf(t);if(this.Wh&&!this.Hh.isEqual(e))throw new Dr(Lr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Hh=e).credentials&&(this.zh=function(t){if(!t)return new Oh;switch(t.type){case"gapi":var e=t.Xh;return Fr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Dh(e,t.Jr||"0");case"provider":return t.Xh;default:throw new Dr(Lr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},zf.prototype.enableNetwork=function(){return this.jh(),this.Wh.enableNetwork()},zf.prototype.disableNetwork=function(){return this.jh(),this.Wh.disableNetwork()},zf.prototype.enablePersistence=function(t){var e,n;if(this.Wh)throw new Dr(Lr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Mr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new Dr(Lr.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Zh(this.Lh,this.Bh,{Pa:!0,cacheSizeBytes:this.Hh.cacheSizeBytes,synchronizeTabs:r,tl:i})},zf.prototype.clearPersistence=function(){return w(this,void 0,void 0,function(){var n,e=this;return b(this,function(t){if(void 0!==this.Wh&&!this.Wh.Sh)throw new Dr(Lr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new Na,[2,(this.Qh.ts(function(){return w(e,void 0,void 0,function(){var e;return b(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Lh.clearPersistence(this.Ga,this.Kh)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},zf.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(zf.prototype,"el",{get:function(){return this.jh(),this.Wh.Sh},enumerable:!1,configurable:!0}),zf.prototype.waitForPendingWrites=function(){return this.jh(),this.Wh.waitForPendingWrites()},zf.prototype.onSnapshotsInSync=function(t){if(this.jh(),vl(t))return this.Wh.bh(t);si("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.Wh.bh(e)},zf.prototype.jh=function(){return this.Wh||this.Zh(new ll,new fl,{Pa:!1}),this.Wh},zf.prototype.nl=function(){return new Di(this.Ga,this.Kh,this.Hh.host,this.Hh.ssl,this.Hh.experimentalForceLongPolling)},zf.prototype.Zh=function(t,e,n){var r=this.nl();return this.Wh=new bf(this.zh,this.Qh),this.Wh.start(r,t,e,n)},zf.Gh=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Dr(Lr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Dr(Lr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Ui(n)},Object.defineProperty(zf.prototype,"app",{get:function(){if(!this.Uh)throw new Dr(Lr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Uh},enumerable:!1,configurable:!0}),zf.prototype.collection=function(t){return ri("Firestore.collection",arguments,1),si("Firestore.collection","non-empty string",1,t),this.jh(),new $f(Kr.P(t),this,null)},zf.prototype.doc=function(t){return ri("Firestore.doc",arguments,1),si("Firestore.doc","non-empty string",1,t),this.jh(),_f.sl(Kr.P(t),this,null)},zf.prototype.collectionGroup=function(t){if(ri("Firestore.collectionGroup",arguments,1),si("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Dr(Lr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.jh(),new Jf((e=t,new Pu(Kr.p(),e)),this,null);var e},zf.prototype.runTransaction=function(e){var n=this;return ri("Firestore.runTransaction",arguments,1),si("Firestore.runTransaction","function",1,e),this.jh().transaction(function(t){return e(new Df(n,t))})},zf.prototype.batch=function(){return this.jh(),new Pf(this)},Object.defineProperty(zf,"logLevel",{get:function(){switch(Vr()){case u.DEBUG:return"debug";case u.ERROR:return"error";case u.SILENT:return"silent";case u.WARN:return"warn";case u.INFO:return"info";case u.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),zf.setLogLevel=function(t){ri("Firestore.setLogLevel",arguments,1),li("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),_r.setLogLevel(t)},zf.prototype.il=function(){return this.Hh.timestampsInSnapshots},zf.prototype.rl=function(){return this.Hh},zf),Df=(Gf.prototype.get=function(t){var n=this;ri("Transaction.get",arguments,1);var r=sp("Transaction.get",t,this.ol);return this.ul.ah([r.Ka]).then(function(t){if(!t||1!==t.length)return qr();var e=t[0];if(e instanceof Ru)return new Vf(n.ol,r.Ka,null,!1,!1,r.za);if(e instanceof Nu)return new Vf(n.ol,r.Ka,e,!1,!1,r.za);throw qr()})},Gf.prototype.set=function(t,e,n){oi("Transaction.set",arguments,2,3);var r=sp("Transaction.set",t,this.ol);n=rp("Transaction.set",n);var i=up(r.za,e,n),o=sf(this.ol.Yh,"Transaction.set",r.Ka,i,null!==r.za,n);return this.ul.set(r.Ka,o),this},Gf.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof bl?(ii("Transaction.update",arguments,3),r=sp("Transaction.update",t,this.ol),af(this.ol.Yh,"Transaction.update",r.Ka,e,n,o)):(ri("Transaction.update",arguments,2),r=sp("Transaction.update",t,this.ol),uf(this.ol.Yh,"Transaction.update",r.Ka,e)),this.ul.update(r.Ka,i),this},Gf.prototype.delete=function(t){ri("Transaction.delete",arguments,1);var e=sp("Transaction.delete",t,this.ol);return this.ul.delete(e.Ka),this},Gf),Pf=(Ff.prototype.set=function(t,e,n){oi("WriteBatch.set",arguments,2,3),this.hl();var r=sp("WriteBatch.set",t,this.ol);n=rp("WriteBatch.set",n);var i=up(r.za,e,n),o=sf(this.ol.Yh,"WriteBatch.set",r.Ka,i,null!==r.za,n);return this.cl=this.cl.concat(o.Ha(r.Ka,Ws.He())),this},Ff.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.hl(),i="string"==typeof e||e instanceof bl?(ii("WriteBatch.update",arguments,3),r=sp("WriteBatch.update",t,this.ol),af(this.ol.Yh,"WriteBatch.update",r.Ka,e,n,o)):(ri("WriteBatch.update",arguments,2),r=sp("WriteBatch.update",t,this.ol),uf(this.ol.Yh,"WriteBatch.update",r.Ka,e)),this.cl=this.cl.concat(i.Ha(r.Ka,Ws.exists(!0))),this},Ff.prototype.delete=function(t){ri("WriteBatch.delete",arguments,1),this.hl();var e=sp("WriteBatch.delete",t,this.ol);return this.cl=this.cl.concat(new pu(e.Ka,Ws.He())),this},Ff.prototype.commit=function(){return this.hl(),this.al=!0,0<this.cl.length?this.ol.jh().write(this.cl):Promise.resolve()},Ff.prototype.hl=function(){if(this.al)throw new Dr(Lr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Ff),_f=(o(qf,Rf=Gl),qf.sl=function(t,e,n){if(t.length%2!=0)throw new Dr(Lr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.R()+" has "+t.length);return new qf(new Jr(t),e,n)},Object.defineProperty(qf.prototype,"id",{get:function(){return this.Ka.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(qf.prototype,"parent",{get:function(){return new $f(this.Ka.path.h(),this.firestore,this.za)},enumerable:!1,configurable:!0}),Object.defineProperty(qf.prototype,"path",{get:function(){return this.Ka.path.R()},enumerable:!1,configurable:!0}),qf.prototype.collection=function(t){if(ri("DocumentReference.collection",arguments,1),si("DocumentReference.collection","non-empty string",1,t),!t)throw new Dr(Lr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Kr.P(t);return new $f(this.Ka.path.child(e),this.firestore,null)},qf.prototype.isEqual=function(t){if(!(t instanceof qf))throw gi("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Ka.isEqual(t.Ka)&&this.za===t.za},qf.prototype.set=function(t,e){oi("DocumentReference.set",arguments,1,2),e=rp("DocumentReference.set",e);var n=up(this.za,t,e),r=sf(this.firestore.Yh,"DocumentReference.set",this.Ka,n,null!==this.za,e);return this.Wh.write(r.Ha(this.Ka,Ws.He()))},qf.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof bl?(ii("DocumentReference.update",arguments,2),af(this.firestore.Yh,"DocumentReference.update",this.Ka,t,e,r)):(ri("DocumentReference.update",arguments,1),uf(this.firestore.Yh,"DocumentReference.update",this.Ka,t)),this.Wh.write(n.Ha(this.Ka,Ws.exists(!0)))},qf.prototype.delete=function(){return ri("DocumentReference.delete",arguments,0),this.Wh.write([new pu(this.Ka,Ws.He())])},qf.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];oi("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||vl(i[u])||(yi("DocumentReference.onSnapshot",s=i[u],["includeMetadataChanges"]),hi("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++);var a,h={includeMetadataChanges:s.includeMetadataChanges};vl(i[u])?(a=i[u],i[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),i[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),i[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)):(si("DocumentReference.onSnapshot","function",u,i[u]),ui("DocumentReference.onSnapshot","function",u+1,i[u+1]),ui("DocumentReference.onSnapshot","function",u+2,i[u+2]));var c={next:function(t){i[u]&&i[u](r.ll(t))},error:i[u+1],complete:i[u+2]};return this.Wh.listen(_u(this.Ka.path),h,c)},qf.prototype.get=function(t){var e=this;oi("DocumentReference.get",arguments,0,1),op("DocumentReference.get",t);var n=this.firestore.jh();return t&&"cache"===t.source?n.Ph(this.Ka).then(function(t){return new Vf(e.firestore,e.Ka,t,!0,t instanceof Nu&&t.Ye,e.za)}):n.ph(this.Ka,t).then(function(t){return e.ll(t)})},qf.prototype.withConverter=function(t){return new qf(this.Ka,this.firestore,t)},qf.prototype.ll=function(t){var e=t.docs.get(this.Ka);return new Vf(this.firestore,this.Ka,e,t.fromCache,t.hasPendingWrites,this.za)},qf),Uf=(xf.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},xf),Vf=(jf.prototype.data=function(t){var e=this;if(oi("DocumentSnapshot.data",arguments,0,1),t=ip("DocumentSnapshot.data",t),this._l){if(this.za){var n=new Cf(this.ol,this.Ka,this._l,this.fl,this.dl,null);return this.za.fromFirestore(n,t)}return new Sf(this.ol.Ga,this.ol.il(),t.serverTimestamps||"none",function(t){return new _f(t,e.ol,null)},function(t){return new _i(t)}).$h(this._l.sn())}},jf.prototype.get=function(t,e){var n=this;if(oi("DocumentSnapshot.get",arguments,1,2),e=ip("DocumentSnapshot.get",e),this._l){var r=this._l.data().field(df("DocumentSnapshot.get",t,this.Ka));if(null!==r)return new Sf(this.ol.Ga,this.ol.il(),e.serverTimestamps||"none",function(t){return new _f(t,n.ol,n.za)},function(t){return new _i(t)}).$h(r)}},Object.defineProperty(jf.prototype,"id",{get:function(){return this.Ka.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(jf.prototype,"ref",{get:function(){return new _f(this.Ka,this.ol,this.za)},enumerable:!1,configurable:!0}),Object.defineProperty(jf.prototype,"exists",{get:function(){return null!==this._l},enumerable:!1,configurable:!0}),Object.defineProperty(jf.prototype,"metadata",{get:function(){return new Uf(this.dl,this.fl)},enumerable:!1,configurable:!0}),jf.prototype.isEqual=function(t){if(!(t instanceof jf))throw gi("isEqual","DocumentSnapshot",1,t);return this.ol===t.ol&&this.fl===t.fl&&this.Ka.isEqual(t.Ka)&&(null===this._l?null===t._l:this._l.isEqual(t._l))&&this.za===t.za},jf),Cf=(o(Mf,Nf=Vf),Mf.prototype.data=function(t){return Nf.prototype.data.call(this,t)},Mf);function Mf(){return null!==Nf&&Nf.apply(this,arguments)||this}function jf(t,e,n,r,i,o){this.ol=t,this.Ka=e,this._l=n,this.fl=r,this.dl=i,this.za=o}function xf(t,e){this.hasPendingWrites=t,this.fromCache=e}function qf(t,e,n){var r=this;return(r=Rf.call(this,e.Ga,t,n)||this).Ka=t,r.firestore=e,r.za=n,r.Wh=r.firestore.jh(),r}function Ff(t){this.ol=t,this.cl=[],this.al=!1}function Gf(t,e){this.ol=t,this.ul=e}function zf(t,e,n,r){var i=this;if(void 0===n&&(n=new ll),void 0===r&&(r=new fl),this.Lh=n,this.Bh=r,this.Uh=null,this.Qh=new _a,this.INTERNAL={delete:function(){return w(i,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return this.jh(),[4,this.Wh.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var o=t;this.Uh=o,this.Ga=zf.Gh(o),this.Kh=o.name,this.zh=new kh(e)}else{var s=t;if(!s.projectId)throw new Dr(Lr.INVALID_ARGUMENT,"Must provide projectId");this.Ga=new Ui(s.projectId,s.database),this.Kh="[DEFAULT]",this.zh=new Oh}this.Hh=new kf({})}function Bf(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new Dr(Lr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else ai("settings","non-empty string","host",t.host),this.host=t.host,hi("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(yi("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),hi("settings","object","credentials",t.credentials),this.credentials=t.credentials,hi("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),hi("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Mr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Mr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,hi("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=th.Mi;else{if(t.cacheSizeBytes!==Of&&t.cacheSizeBytes<th.Oi)throw new Dr(Lr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+th.Oi);this.cacheSizeBytes=t.cacheSizeBytes}hi("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}function Qf(t,e,n,r,i){this.U=t,this.timestampsInSnapshots=e,this.Ch=n,this.Dh=r,this.Fh=i}function Wf(t,e,n){if("string"==typeof n){if(""===n)throw new Dr(Lr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!ju(e)&&-1!==n.indexOf("/"))throw new Dr(Lr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Kr.P(n));if(!Jr.$(r))throw new Dr(Lr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Zo(t,new Jr(r))}if(n instanceof Gl)return Zo(t,n.Ka);throw new Dr(Lr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+di(n)+".")}function Hf(t,e){if(!Array.isArray(t)||0===t.length)throw new Dr(Lr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Dr(Lr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new Dr(Lr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Dr(Lr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function Kf(t,e,n){if(!n.isEqual(e))throw new Dr(Lr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Yf(t){if(Vu(t)&&0===t.rn.length)throw new Dr(Lr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Xf,Jf=(np.prototype.where=function(t,e,n){var r;ri("Query.where",arguments,3),vi("Query.where",3,n),r="not-in"===e||"!="===e?e:li("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e);var i,o,s=df("Query.where",t),u=function(t,e,n,r,i,o,s){var u;if(i.V()){if("array-contains"===o||"array-contains-any"===o)throw new Dr(Lr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Hf(s,o);for(var a=[],h=0,c=s;h<c.length;h++){var l=c[h];a.push(Wf(r,t,l))}u={arrayValue:{values:a}}}else u=Wf(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Hf(s,o),u=hf(n,e,s,"in"===o||"not-in"===o);var f=Xu.create(i,o,u);return function(t,e){if(e.an()){var n=Mu(t);if(null!==n&&!n.isEqual(e.field))throw new Dr(Lr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=Cu(t);null!==r&&Kf(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==i)throw i===e.op?new Dr(Lr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Dr(Lr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(this.wl,"Query.where",this.firestore.Yh,this.firestore.Ga,s,r,n);return new np((i=this.wl,o=i.filters.concat([u]),new Pu(i.path,i.collectionGroup,i.rn.slice(),o,i.limit,i.on,i.startAt,i.endAt)),this.firestore,this.za)},np.prototype.orderBy=function(t,e){var n;if(oi("Query.orderBy",arguments,1,2),ui("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Dr(Lr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var r,i,o=df("Query.orderBy",t),s=function(t,e,n){if(null!==t.startAt)throw new Dr(Lr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Dr(Lr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r,i,o,s=new Aa(e,n);return i=s,null!==Cu(r=t)||null!==(o=Mu(r))&&Kf(0,o,i.field),s}(this.wl,o,n);return new np((r=this.wl,i=r.rn.concat([s]),new Pu(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.on,r.startAt,r.endAt)),this.firestore,this.za)},np.prototype.limit=function(t){return ri("Query.limit",arguments,1),si("Query.limit","number",1,t),mi("Query.limit",1,t),new np(Fu(this.wl,t,"F"),this.firestore,this.za)},np.prototype.limitToLast=function(t){return ri("Query.limitToLast",arguments,1),si("Query.limitToLast","number",1,t),mi("Query.limitToLast",1,t),new np(Fu(this.wl,t,"L"),this.firestore,this.za)},np.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ii("Query.startAt",arguments,1);var r=this.ml("Query.startAt",t,e,!0);return new np(Gu(this.wl,r),this.firestore,this.za)},np.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ii("Query.startAfter",arguments,1);var r=this.ml("Query.startAfter",t,e,!1);return new np(Gu(this.wl,r),this.firestore,this.za)},np.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ii("Query.endBefore",arguments,1);var r=this.ml("Query.endBefore",t,e,!0);return new np(zu(this.wl,r),this.firestore,this.za)},np.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ii("Query.endAt",arguments,1);var r=this.ml("Query.endAt",t,e,!1);return new np(zu(this.wl,r),this.firestore,this.za)},np.prototype.isEqual=function(t){if(!(t instanceof np))throw gi("isEqual","Query",1,t);return this.firestore===t.firestore&&Bu(this.wl,t.wl)&&this.za===t.za},np.prototype.withConverter=function(t){return new np(this.wl,this.firestore,t)},np.prototype.ml=function(c,t,e,n){if(vi(c,1,t),t instanceof Vf)return ri(c,s([t],e),1),function(t,e,n,r){if(!n)throw new Dr(Lr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=xu(t);o<s.length;o++){var u=s[o];if(u.field.V())i.push(Zo(e,n.key));else{var a=n.field(u.field);if(qo(a))throw new Dr(Lr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){var h=u.field.R();throw new Dr(Lr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}i.push(a)}}return new ya(i,r)}(this.wl,this.firestore.Ga,t._l,n);var r=[t].concat(e);return function(t,e,n,r,i,o){var s=t.rn;if(i.length>s.length)throw new Dr(Lr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.V()){if("string"!=typeof h)throw new Dr(Lr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!ju(t)&&-1!==h.indexOf("/"))throw new Dr(Lr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(Kr.P(h));if(!Jr.$(c))throw new Dr(Lr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");var l=new Jr(c);u.push(Zo(e,l))}else{var f=hf(n,r,h);u.push(f)}}return new ya(u,o)}(this.wl,this.firestore.Ga,this.firestore.Yh,c,r,n)},np.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];oi("Query.onSnapshot",arguments,1,4);var s,u={},a=0;"object"!=typeof i[a]||vl(i[a])||(yi("Query.onSnapshot",u=i[a],["includeMetadataChanges"]),hi("Query.onSnapshot","boolean","includeMetadataChanges",u.includeMetadataChanges),a++),vl(i[a])?(s=i[a],i[a]=null===(t=s.next)||void 0===t?void 0:t.bind(s),i[a+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),i[a+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(si("Query.onSnapshot","function",a,i[a]),ui("Query.onSnapshot","function",a+1,i[a+1]),ui("Query.onSnapshot","function",a+2,i[a+2]));var h={next:function(t){i[a]&&i[a](new Zf(r.firestore,r.wl,t,r.za))},error:i[a+1],complete:i[a+2]};return Yf(this.wl),this.firestore.jh().listen(this.wl,u,h)},np.prototype.get=function(t){var e=this;oi("Query.get",arguments,0,1),op("Query.get",t),Yf(this.wl);var n=this.firestore.jh();return(t&&"cache"===t.source?n.gh(this.wl):n.Vh(this.wl,t)).then(function(t){return new Zf(e.firestore,e.wl,t,e.za)})},np),Zf=(Object.defineProperty(ep.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(ep.prototype,"empty",{get:function(){return this.El.docs.m()},enumerable:!1,configurable:!0}),Object.defineProperty(ep.prototype,"size",{get:function(){return this.El.docs.size},enumerable:!1,configurable:!0}),ep.prototype.forEach=function(e,n){var r=this;oi("QuerySnapshot.forEach",arguments,1,2),si("QuerySnapshot.forEach","function",1,e),this.El.docs.forEach(function(t){e.call(n,r.Rl(t,r.metadata.fromCache,r.El.Qt.has(t.key)))})},Object.defineProperty(ep.prototype,"query",{get:function(){return new Jf(this.Tl,this.ol,this.za)},enumerable:!1,configurable:!0}),ep.prototype.docChanges=function(t){t&&(yi("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),hi("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.El.Wt)throw new Dr(Lr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Il&&this.Al===e||(this.Il=function(i,e,o){if(i.Ut.m()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Ut;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return qr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this.El,e,this.Rl.bind(this)),this.Al=e),this.Il},ep.prototype.isEqual=function(t){if(!(t instanceof ep))throw gi("isEqual","QuerySnapshot",1,t);return this.ol===t.ol&&Bu(this.Tl,t.Tl)&&this.El.isEqual(t.El)&&this.za===t.za},ep.prototype.Rl=function(t,e,n){return new Cf(this.ol,t.key,t,e,n,this.za)},ep),$f=(o(tp,Xf=Jf),Object.defineProperty(tp.prototype,"id",{get:function(){return this.wl.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(tp.prototype,"parent",{get:function(){var t=this.wl.path.h();return t.m()?null:new _f(new Jr(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(tp.prototype,"path",{get:function(){return this.wl.path.R()},enumerable:!1,configurable:!0}),tp.prototype.doc=function(t){oi("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Ei.k()),si("CollectionReference.doc","non-empty string",1,t);var e=Kr.P(t);return _f.sl(this.wl.path.child(e),this.firestore,this.za)},tp.prototype.add=function(t){ri("CollectionReference.add",arguments,1),si("CollectionReference.add","object",1,this.za?this.za.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},tp.prototype.withConverter=function(t){return new tp(this.yl,this.firestore,t)},tp);function tp(t,e,n){var r=this;if(((r=Xf.call(this,_u(t),e,n)||this).yl=t).length%2!=1)throw new Dr(Lr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.R()+" has "+t.length);return r}function ep(t,e,n,r){this.ol=t,this.Tl=e,this.El=n,this.za=r,this.Il=null,this.Al=null,this.metadata=new Uf(n.hasPendingWrites,n.fromCache)}function np(t,e,n){this.wl=t,this.firestore=e,this.za=n}function rp(t,e){if(void 0===e)return{merge:!1};if(yi(t,e,["merge","mergeFields"]),hi(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n,r){if(!(n instanceof Array))throw new Dr(Lr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+di(n));for(var i=0;i<n.length;++i)if(!r(n[i]))throw new Dr(Lr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+di(n[i]))}(t,"mergeFields",n,function(t){return"string"==typeof t||t instanceof bl}),void 0!==e.mergeFields&&void 0!==e.merge)throw new Dr(Lr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function ip(t,e){return void 0===e?{}:(yi(t,e,["serverTimestamps"]),ci(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function op(t,e){ui(t,"object",1,e),e&&(yi(t,e,["source"]),ci(t,0,"source",e.source,["default","server","cache"]))}function sp(t,e,n){if(e instanceof Gl){if(e.firestore!==n)throw new Dr(Lr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw gi(t,"DocumentReference",1,e)}function up(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var ap,hp={Firestore:Lf,GeoPoint:ql,Timestamp:Ci,Blob:_i,Transaction:Df,WriteBatch:Pf,DocumentReference:_f,DocumentSnapshot:Vf,Query:Jf,QueryDocumentSnapshot:Cf,QuerySnapshot:Zf,CollectionReference:$f,FieldPath:bl,FieldValue:jl,setLogLevel:Lf.setLogLevel,CACHE_SIZE_UNLIMITED:Of};(ap=r.default).INTERNAL.registerComponent(new Sr("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new Lf(e,n,new ll,new fl);var e,n},"PUBLIC").setServiceProps(Object.assign({},hp))),ap.registerVersion("@firebase/firestore","1.16.7-202088235442")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map

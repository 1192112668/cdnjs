!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(rp){"use strict";try{(function(){var t,a,e,n,r=(n=rp)&&"object"==typeof n&&"default"in n?n:{default:n},i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function o(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function w(t,s,a,u){return new(a=a||Promise)(function(n,e){function r(t){try{o(u.next(t))}catch(t){e(t)}}function i(t){try{o(u.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(r,i)}o((u=u.apply(t,s||[])).next())})}function b(n,r){var i,o,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(n,a)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}function u(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}function h(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=f[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,u(["["+i+"]  "+t.name+":"],n))}}(e=a=a||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";var c={debug:a.DEBUG,verbose:a.VERBOSE,info:a.INFO,warn:a.WARN,error:a.ERROR,silent:a.SILENT},l=a.INFO,f=((t={})[a.DEBUG]="log",t[a.VERBOSE]="log",t[a.INFO]="info",t[a.WARN]="warn",t[a.ERROR]="error",t),p=(Object.defineProperty(d.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in a))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),d.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?c[t]:t},Object.defineProperty(d.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),d.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,a.DEBUG],t)),this._logHandler.apply(this,u([this,a.DEBUG],t))},d.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,a.VERBOSE],t)),this._logHandler.apply(this,u([this,a.VERBOSE],t))},d.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,a.INFO],t)),this._logHandler.apply(this,u([this,a.INFO],t))},d.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,a.WARN],t)),this._logHandler.apply(this,u([this,a.WARN],t))},d.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,a.ERROR],t)),this._logHandler.apply(this,u([this,a.ERROR],t))},d);function d(t){this.name=t,this._logLevel=l,this._logHandler=h,this._userLogHandler=null}function v(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var y,g="FirebaseError",m=(o(E,y=Error),E);function E(t,e){var n=y.call(this,e)||this;return n.code=t,n.name=g,Object.setPrototypeOf(n,E.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,I.prototype.create),n}var I=(T.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],a=s?(r=i,s.replace(A,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",u=this.serviceName+": "+a+" ("+o+").",h=new m(o,u),c=0,l=Object.keys(i);c<l.length;c++){var f=l[c];"_"!==f.slice(-1)&&(f in h&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),h[f]=i[f])}return h},T);function T(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var A=/\{\$([^}]+)}/g,N=function(t,e){return(N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function R(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var S,O="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},k=O||self;function L(){}function D(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function P(t){var e=D(t);return"array"==e||"object"==e&&"number"==typeof t.length}function _(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var U="closure_uid_"+(1e9*Math.random()>>>0),V=0;function C(t,e,n){return t.call.apply(t.bind,arguments)}function M(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function j(t,e,n){return(j=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?C:M).apply(null,arguments)}function x(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var q=Date.now;function F(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function G(){this.j=this.j,this.i=this.i}G.prototype.j=!1,G.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,U)&&this[U]||(this[U]=++V))},G.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var z=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function Q(t){return Array.prototype.concat.apply([],arguments)}function W(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var K,Y=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function J(t,e){return t<e?-1:e<t?1:0}t:{var Z=k.navigator;if(Z){var $=Z.userAgent;if($){K=$;break t}}K=""}function tt(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function et(t){var e,n={};for(e in t)n[e]=t[e];return n}var nt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function rt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<nt.length;o++)n=nt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function it(t){return it[" "](t),t}it[" "]=L;var ot,st,at=X(K,"Opera"),ut=X(K,"Trident")||X(K,"MSIE"),ht=X(K,"Edge"),ct=ht||ut,lt=X(K,"Gecko")&&!(X(K.toLowerCase(),"webkit")&&!X(K,"Edge"))&&!(X(K,"Trident")||X(K,"MSIE"))&&!X(K,"Edge"),ft=X(K.toLowerCase(),"webkit")&&!X(K,"Edge");function pt(){var t=k.document;return t?t.documentMode:void 0}t:{var dt="",vt=(st=K,lt?/rv:([^\);]+)(\)|;)/.exec(st):ht?/Edge\/([\d\.]+)/.exec(st):ut?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(st):ft?/WebKit\/(\S+)/.exec(st):at?/(?:Version)[ \/]?(\S+)/.exec(st):void 0);if(vt&&(dt=vt?vt[1]:""),ut){var yt=pt();if(null!=yt&&yt>parseFloat(dt)){ot=String(yt);break t}}ot=dt}var gt={};function mt(a){return t=a,e=function(){for(var t=0,e=Y(String(ot)).split("."),n=Y(String(a)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=J(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||J(0==o[2].length,0==s[2].length)||J(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=gt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var wt=k.document&&ut&&(pt()||parseInt(ot,10))||void 0,bt=!ut||9<=Number(wt),Et=ut&&!mt("9"),It=function(){if(!k.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{k.addEventListener("test",L,e),k.removeEventListener("test",L,e)}catch(t){}return t}();function Tt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function At(t,e){if(Tt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(lt){t:{try{it(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Nt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Tt.prototype.b=function(){this.defaultPrevented=!0},F(At,Tt);var Nt={2:"touch",3:"pen",4:"mouse"};At.prototype.b=function(){At.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Et)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Rt="closure_listenable_"+(1e6*Math.random()|0),St=0;function Ot(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++St,this.Y=this.Z=!1}function kt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Lt(t){this.src=t,this.a={},this.b=0}function Dt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=z(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(kt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Pt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Lt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Pt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Ot(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var _t="closure_lm_"+(1e6*Math.random()|0),Ut={};function Vt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=zt(r),e&&e[Rt]?e.wa(n,r,_(i)?!!i.capture:!!i,o):Ct(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Vt(t,e[o],n,r,i);return null}return n=zt(n),t&&t[Rt]?t.va(e,n,_(r)?!!r.capture:!!r,i):Ct(t,e,n,!1,r,i)}function Ct(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=_(i)?!!i.capture:!!i;if(s&&!bt)return null;var a,u,h=Ft(t);if(h||(t[_t]=h=new Lt(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(a=qt,r=u=bt?function(t){return a.call(u.src,u.listener,t)}:function(t){if(!(t=a.call(u.src,u.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)It||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(jt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Mt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Rt]?Dt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(jt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ft(e))?(Dt(n,t),0==n.b&&(n.src=null,e[_t]=null)):kt(t)))}function jt(t){return t in Ut?Ut[t]:Ut[t]="on"+t}function xt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Mt(t),n.call(r,e)}function qt(t,e){if(t.Y)return!0;if(bt)return xt(t,new At(e,this));if(!e)t:{e=["window","event"];for(var n=k,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return xt(t,e=new At(e,this))}function Ft(t){return(t=t[_t])instanceof Lt?t:null}var Gt="__closure_events_fn_"+(1e9*Math.random()>>>0);function zt(e){return"function"==D(e)?e:(e[Gt]||(e[Gt]=function(t){return e.handleEvent(t)}),e[Gt])}function Bt(){G.call(this),this.c=new Lt(this),(this.J=this).C=null}function Qt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,a,u=e[o];u&&!u.Y&&u.capture==n&&(s=u.listener,a=u.ca||u.src,u.Z&&Dt(t.c,u),i=!1!==s.call(a,r)&&i)}return i&&!r.defaultPrevented}F(Bt,G),Bt.prototype[Rt]=!0,(S=Bt.prototype).addEventListener=function(t,e,n,r){Vt(this,t,e,n,r)},S.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=_(i)?!!i.capture:!!i,r=zt(r),e&&e[Rt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Pt(s=e.a[n],r,i,o))&&(kt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ft(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Pt(n,r,i,o)),(r=-1<e?n[e]:null)&&Mt(r))}(this,t,e,n,r)},S.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new Tt(t,n):t instanceof Tt?t.target=t.target||n:(s=t,rt(t=new Tt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=Qt(o,r,!0,t)&&s;if(s=Qt(o=t.a=n,r,!0,t)&&s,s=Qt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Qt(o=t.a=e[i],r,!1,t)&&s;return s},S.G=function(){if(Bt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)kt(n[r]);delete e.a[t],e.b--}}this.C=null},S.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},S.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Wt=k.JSON.stringify;function Ht(){this.b=this.a=null}var Kt,Yt=(Xt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Xt(function(){return new Jt},function(t){t.reset()},100));function Xt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Jt(){this.next=this.b=this.a=null}function Zt(t,e){var n;Kt||(n=k.Promise.resolve(void 0),Kt=function(){n.then(ee)}),$t||(Kt(),$t=!0),te.add(t,e)}Ht.prototype.add=function(t,e){var n=Yt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Jt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var $t=!(Jt.prototype.reset=function(){this.next=this.b=this.a=null}),te=new Ht;function ee(){for(var t,e,n;n=e=void 0,n=null,(e=te).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){k.setTimeout(function(){throw t},0)}(t)}var r=Yt;r.g(t),r.b<r.f&&(r.b++,t.next=r.a,r.a=t)}$t=!1}function ne(t,e){Bt.call(this),this.b=t||1,this.a=e||k,this.f=j(this.Ya,this),this.g=q()}function re(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ie(t,e,n){if("function"==D(t))n&&(t=j(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=j(t.handleEvent,t)}return 2147483647<Number(e)?-1:k.setTimeout(t,e||0)}F(ne,Bt),(S=ne.prototype).aa=!1,S.M=null,S.Ya=function(){var t;this.aa&&(0<(t=q()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(re(this),this.start())))},S.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=q())},S.G=function(){ne.S.G.call(this),re(this),delete this.a};var oe,se,ae,ue=(N(se=ce,ae=oe=G),se.prototype=null===ae?Object.create(ae):(he.prototype=ae.prototype,new he),ce.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ie(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ce.prototype.G=function(){oe.prototype.G.call(this),this.a&&(k.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ce);function he(){this.constructor=se}function ce(t,e,n){var r=oe.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function le(t){G.call(this),this.b=t,this.a={}}F(le,G);var fe=[];function pe(t,e,n,r){Array.isArray(n)||(n&&(fe[0]=n.toString()),n=fe);for(var i=0;i<n.length;i++){var o=Vt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function de(t){tt(t.a,function(t,e){this.a.hasOwnProperty(e)&&Mt(t)},t),t.a={}}function ve(){this.a=!0}function ye(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Wt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}le.prototype.G=function(){le.S.G.call(this),de(this)},le.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ve.prototype.info=function(){};var ge=null;function me(){return ge=ge||new Bt}function we(t){Tt.call(this,"serverreachability",t)}function be(){var t=me();t.dispatchEvent(new we(t))}function Ee(t){Tt.call(this,"statevent",t)}function Ie(){var t=me();t.dispatchEvent(new Ee(t))}function Te(t){Tt.call(this,"timingevent",t)}function Ae(t,e){if("function"!=D(t))throw Error("Fn must not be null and must be a function");return k.setTimeout(function(){t()},e)}F(we,Tt),F(Ee,Tt),F(Te,Tt);var Ne={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Re={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Se(){}function Oe(t){var e;return(e=t.a)||(e=t.a={}),e}function ke(){}Se.prototype.a=null;var Le,De={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Pe(){Tt.call(this,"d")}function _e(){Tt.call(this,"c")}function Ue(){}function Ve(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new le(this),this.P=Ce,t=ct?125:void 0,this.R=new ne(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}F(Pe,Tt),F(_e,Tt),F(Ue,Se),Le=new Ue;var Ce=45e3,Me={},je={};function xe(t,e,n){t.H=1,t.i=an(tn(e)),t.j=n,t.I=!0,qe(t,null)}function qe(t,e){t.u=q(),Ge(t),t.l=tn(t.i);var s,a,u,h,c,l,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),bn(n.b,"t",r),t.D=0,t.a=pr(t.g,t.g.C?e:null),0<t.O&&(t.F=new ue(j(t.Ca,t,t.a),t.O)),pe(t.J,t.a,"readystatechange",t.Wa),e=t.B?et(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),be(),s=t.c,a=t.m,u=t.l,h=t.f,c=t.T,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+a+"\n"+u+"\n"+t})}function Fe(t,e,n){for(var r,i,o,s,a=!0;!t.A&&t.D<n.length;){var u=(i=n,s=o=void 0,o=(r=t).D,-1==(s=i.indexOf("\n",o))?je:(o=Number(i.substring(o,s)),isNaN(o)?Me:(s+=1)+o>i.length?je:(i=i.substr(s,o),r.D=s+o,i)));if(u==je){4==e&&(t.h=4,Ie(),a=!1),ye(t.c,t.f,null,"[Incomplete Response]");break}if(u==Me){t.h=4,Ie(),ye(t.c,t.f,n,"[Invalid Chunk]"),a=!1;break}ye(t.c,t.f,u,null),He(t,u)}4==e&&0==n.length&&(t.h=1,Ie(),a=!1),t.b=t.b&&a,a?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),or(e),e.F=!0)):(ye(t.c,t.f,n,"[Invalid Chunked Response]"),We(t),Qe(t))}function Ge(t){t.U=q()+t.P,ze(t,t.P)}function ze(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ae(j(t.Ua,t),e)}function Be(t){t.o&&(k.clearTimeout(t.o),t.o=null)}function Qe(t){0==t.g.v||t.A||ur(t.g,t)}function We(t){Be(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,re(t.R),de(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function He(t,e){try{var n,r,i,o,s,a,u,h,c,l,f,p=t.g;if(0!=p.v&&(p.a==t||Sn(p.b,t)))if(p.I=t.N,!t.C&&Sn(p.b,t)&&3==p.v){try{var d=p.ka.a.parse(e)}catch(t){d=null}if(Array.isArray(d)&&3==d.length){var v=d;if(0==v[0]){t:if(!p.j){if(p.a){if(!(p.a.u+3e3<t.u))break t;ar(p),Xn(p)}ir(p),Ie()}}else p.oa=v[1],0<p.oa-p.P&&v[2]<37500&&p.H&&0==p.o&&!p.m&&(p.m=Ae(j(p.Ra,p),6e3));if(Rn(p.b)<=1&&p.ea){try{p.ea()}catch(t){}p.ea=void 0}}else cr(p,11)}else if(!t.C&&p.a!=t||ar(p),!H(e))for(e=d=p.ka.a.parse(e),d=0;d<e.length;d++)v=e[d],p.P=v[0],v=v[1],2==p.v?"c"==v[0]?(p.J=v[1],p.ga=v[2],null!=(n=v[3])&&(p.ha=n,p.c.info("VER="+p.ha)),null!=(r=v[4])&&(p.pa=r,p.c.info("SVER="+p.pa)),null!=(i=v[5])&&"number"==typeof i&&0<i&&(o=1.5*i,p.D=o,p.c.info("backChannelRequestTimeoutMs_="+o)),o=p,(s=t.a)&&(!(a=s.a?s.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(u=o.b).a&&(X(a,"spdy")||X(a,"quic")||X(a,"h2"))&&(u.f=u.g,u.a=new Set,u.b&&(On(u,u.b),u.b=null)),!o.A||(h=s.a?s.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(o.na=h,sn(o.B,o.A,h))),p.v=3,p.f&&p.f.ta(),p.V&&(p.N=q()-t.u,p.c.info("Handshake RTT: "+p.N+"ms")),c=t,(o=p).la=fr(o,o.C?o.ga:null,o.fa),c.C?(kn(o.b,c),l=c,(f=o.D)&&l.setTimeout(f),l.o&&(Be(l),Ge(l)),o.a=c):rr(o),0<p.g.length&&$n(p)):"stop"!=v[0]&&"close"!=v[0]||cr(p,7):3==p.v&&("stop"==v[0]||"close"==v[0]?"stop"==v[0]?cr(p,7):Yn(p):"noop"!=v[0]&&p.f&&p.f.sa(v),p.o=0);be()}catch(t){}}function Ke(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(P(t)||"string"==typeof t)B(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(P(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(P(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ye(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ye)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Xe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Je(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Je(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Je(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(S=Ve.prototype).setTimeout=function(t){this.P=t},S.Wa=function(t){t=t.target;var e=this.F;e&&3==Qn(t)?e.f():this.Ca(t)},S.Ca=function(t){try{if(t==this.a)t:{var e=Qn(this.a),n=this.a.ua();this.a.X();if(!(e<3||3==e&&!ct&&!this.a.$())){this.A||4!=e||7==n||be(),Be(this);var r=this.a.X();this.N=r;var i=this.a.$();if(this.b=200==r,u=this.c,h=this.m,c=this.l,l=this.f,f=this.T,p=e,d=r,u.info(function(){return"XMLHTTP RESP ("+l+") [ attempt "+f+"]: "+h+"\n"+c+"\n"+p+" "+d}),this.b){if(this.V&&!this.C){e:{if(this.a){var o,s=this.a;if((o=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(o)){var a=o;break e}}a=null}if(!a){this.b=!1,this.h=3,Ie(),We(this),Qe(this);break t}ye(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,He(this,a)}this.I?(Fe(this,e,i),ct&&this.b&&3==e&&(pe(this.J,this.R,"tick",this.Va),this.R.start())):(ye(this.c,this.f,i,null),He(this,i)),4==e&&We(this),this.b&&!this.A&&(4==e?ur(this.g,this):(this.b=!1,Ge(this)))}else 400==r&&0<i.indexOf("Unknown SID")?this.h=3:this.h=0,Ie(),We(this),Qe(this)}}}catch(t){}var u,h,c,l,f,p,d},S.Va=function(){var t,e;this.a&&(t=Qn(this.a),e=this.a.$(),this.D<e.length&&(Be(this),Fe(this,t,e),this.b&&4!=t&&Ge(this)))},S.cancel=function(){this.A=!0,We(this)},S.Ua=function(){this.o=null;var t,e,n=q();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(be(),Ie()),We(this),this.h=2,Qe(this)):ze(this,this.U-n)},(S=Ye.prototype).K=function(){Xe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},S.L=function(){return Xe(this),this.a.concat()},S.get=function(t,e){return Je(this.b,t)?this.b[t]:e},S.set=function(t,e){Je(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},S.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ze=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function $e(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof $e?(this.a=void 0!==e?e:t.a,en(this,t.f),this.j=t.j,nn(this,t.c),rn(this,t.h),this.g=t.g,e=t.b,(n=new yn).c=e.c,e.a&&(n.a=new Ye(e.a),n.b=e.b),on(this,n),this.i=t.i):t&&(n=String(t).match(Ze))?(this.a=!!e,en(this,n[1]||"",!0),this.j=un(n[2]||""),nn(this,n[3]||"",!0),rn(this,n[4]),this.g=un(n[5]||"",!0),on(this,n[6]||"",!0),this.i=un(n[7]||"")):(this.a=!!e,this.b=new yn(null,this.a))}function tn(t){return new $e(t)}function en(t,e,n){t.f=n?un(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function nn(t,e,n){t.c=n?un(e,!0):e}function rn(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function on(t,e,n){var r,i;e instanceof yn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(gn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(mn(this,e),bn(this,n,t))},r)),r.f=i):(n||(e=hn(e,dn)),t.b=new yn(e,t.a))}function sn(t,e,n){t.b.set(e,n)}function an(t){return sn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^q()).toString(36)),t}function un(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function hn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,cn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function cn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}$e.prototype.toString=function(){var t=[],e=this.f;e&&t.push(hn(e,ln,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(hn(e,ln,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(hn(n,"/"==n.charAt(0)?pn:fn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",hn(n,vn)),t.join("")};var ln=/[#\/\?@]/g,fn=/[#\?:]/g,pn=/[#\?]/g,dn=/[#\?@]/g,vn=/#/g;function yn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function gn(a){a.a||(a.a=new Ye,a.b=0,a.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",a.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(a.c))}function mn(t,e){gn(t),e=En(t,e),Je(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Je((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Xe(t)))}function wn(t,e){return gn(t),e=En(t,e),Je(t.a.b,e)}function bn(t,e,n){mn(t,e),0<n.length&&(t.c=null,t.a.set(En(t,e),W(n)),t.b+=n.length)}function En(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function In(t,e){this.b=t,this.a=e}function Tn(t){this.g=t||An,t=k.PerformanceNavigationTiming?0<(t=k.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(k.ia&&k.ia.ya&&k.ia.ya()&&k.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(S=yn.prototype).add=function(t,e){gn(this),this.c=null,t=En(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},S.forEach=function(n,r){gn(this),this.a.forEach(function(t,e){B(t,function(t){n.call(r,t,e,this)},this)},this)},S.L=function(){gn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},S.K=function(t){gn(this);var e=[];if("string"==typeof t)wn(this,t)&&(e=Q(e,this.a.get(En(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=Q(e,t[n])}return e},S.set=function(t,e){return gn(this),this.c=null,wn(this,t=En(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},S.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},S.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var An=10;function Nn(t){return t.b||t.a&&t.a.size>=t.f}function Rn(t){return t.b?1:t.a?t.a.size:0}function Sn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function On(t,e){t.a?t.a.add(e):t.b=e}function kn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Ln(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return W(t.c);var r=t.c;try{for(var i=R(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Dn(){}function Pn(){this.a=new Dn}function _n(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}Tn.prototype.cancel=function(){var t,e;if(this.c=Ln(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=R(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Dn.prototype.stringify=function(t){return k.JSON.stringify(t,void 0)},Dn.prototype.parse=function(t){return k.JSON.parse(t,void 0)};var Un=k.JSON.parse;function Vn(t){Bt.call(this),this.headers=new Ye,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Cn,this.D=this.F=!1}F(Vn,Bt);var Cn="",Mn=/^https?$/i,jn=["POST","PUT"];function xn(t){return"content-type"==t.toLowerCase()}function qn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Fn(t),zn(t)}function Fn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Gn(t){if(t.b&&(!t.s[1]||4!=Qn(t)||2!=t.X()))if(t.l&&4==Qn(t))ie(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==Qn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Ze)[1]||null)&&k.self&&k.self.location&&(i=(r=k.self.location.protocol).substr(0,r.length-1)),n=!Mn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var a=2<Qn(t)?t.a.statusText:""}catch(t){a=""}t.f=a+" ["+t.X()+"]",Fn(t)}}finally{zn(t)}}}function zn(t,e){if(t.a){Bn(t);var n=t.a,r=t.s[0]?L:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Bn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(k.clearTimeout(t.m),t.m=null)}function Qn(t){return t.a?t.a.readyState:0}function Wn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",tt(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):sn(t,e,n))}function Hn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Kn(t){this.pa=0,this.g=[],this.c=new ve,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Hn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Hn("baseRetryDelayMs",5e3,t),this.Ma=Hn("retryDelaySeedMs",1e4,t),this.Ja=Hn("forwardChannelMaxRetries",2,t),this.ma=Hn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new Tn(t&&t.concurrentRequestLimit),this.ka=new Pn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Yn(t){var e,n;Jn(t),3==t.v&&(e=t.R++,sn(n=tn(t.B),"SID",t.J),sn(n,"RID",e),sn(n,"TYPE","terminate"),er(t,n),(e=new Ve(t,t.c,e,void 0)).H=2,e.i=an(tn(n)),n=!1,k.navigator&&k.navigator.sendBeacon&&(n=k.navigator.sendBeacon(e.i.toString(),"")),!n&&k.Image&&((new Image).src=e.i,n=!0),n||(e.a=pr(e.g,null),e.a.ba(e.i)),e.u=q(),Ge(e)),lr(t)}function Xn(t){t.a&&(or(t),t.a.cancel(),t.a=null)}function Jn(t){Xn(t),t.j&&(k.clearTimeout(t.j),t.j=null),ar(t),t.b.cancel(),t.h&&("number"==typeof t.h&&k.clearTimeout(t.h),t.h=null)}function Zn(t,e){t.g.push(new In(t.La++,e)),3==t.v&&$n(t)}function $n(t){Nn(t.b)||t.h||(t.h=!0,Zt(t.Ba,t),t.u=0)}function tr(t,e){var n=e?e.f:t.R++,r=tn(t.B);sn(r,"SID",t.J),sn(r,"RID",n),sn(r,"AID",t.P),er(t,r),t.i&&t.l&&Wn(r,t.i,t.l),n=new Ve(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=nr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),On(t.b,n),xe(n,r,e)}function er(t,n){t.f&&Ke({},function(t,e){sn(n,e,t)})}function nr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?j(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var h=i[u].b,c=i[u].a;if((h-=o)<0)o=Math.max(0,i[u].b-100),a=!1;else try{!function(t,r){var i="req"+h+"_"||"";try{Ke(t,function(t,e){var n=t;_(t)&&(n=Wt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s)}catch(t){r&&r(c)}}if(a){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function rr(t){t.a||t.j||(t.U=1,Zt(t.Aa,t),t.o=0)}function ir(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=Ae(j(t.Aa,t),hr(t,t.o)),t.o++,1)}function or(t){null!=t.s&&(k.clearTimeout(t.s),t.s=null)}function sr(t){t.a=new Ve(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=tn(t.la);sn(e,"RID","rpc"),sn(e,"SID",t.J),sn(e,"CI",t.H?"0":"1"),sn(e,"AID",t.P),er(t,e),sn(e,"TYPE","xmlhttp"),t.i&&t.l&&Wn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=an(tn(e)),n.j=null,n.I=!0,qe(n,t)}function ar(t){null!=t.m&&(k.clearTimeout(t.m),t.m=null)}function ur(t,e){var n,r=null;if(t.a==e){ar(t),or(t),t.a=null;var i=2}else{if(!Sn(t.b,e))return;r=e.s,kn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b)1==i?(r=e.j?e.j.length:0,e=q()-e.u,n=t.u,(i=me()).dispatchEvent(new Te(i)),$n(t)):rr(t);else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(Rn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=Ae(j(t.Ba,t,e),hr(t,t.u)),t.u++,1}}(t,e)||2==i&&ir(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:cr(t,5);break;case 4:cr(t,10);break;case 3:cr(t,6);break;default:cr(t,2)}}function hr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function cr(t,e){var n,r,i,o,s,a;t.c.info("Error code "+e),2==e?(n=null,t.f&&(n=null),r=j(t.Xa,t),n||(n=new $e("//www.google.com/images/cleardot.gif"),k.location&&"http"==k.location.protocol||en(n,"https"),an(n)),i=n.toString(),o=r,a=new ve,k.Image?((s=new Image).onload=x(_n,a,s,"TestLoadImage: loaded",!0,o),s.onerror=x(_n,a,s,"TestLoadImage: error",!1,o),s.onabort=x(_n,a,s,"TestLoadImage: abort",!1,o),s.ontimeout=x(_n,a,s,"TestLoadImage: timeout",!1,o),k.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=i):o(!1)):Ie(),t.v=0,t.f&&t.f.ra(e),lr(t),Jn(t)}function lr(t){t.v=0,t.I=-1,t.f&&(0==Ln(t.b).length&&0==t.g.length||(t.b.c.length=0,W(t.g),t.g.length=0),t.f.qa())}function fr(t,e,n){var r,i,o,s,a,u,h,c=(r=n)instanceof $e?tn(r):new $e(r,void 0);return""!=c.c?(e&&nn(c,e+"."+c.c),rn(c,c.h)):(o=(i=k.location).protocol,s=e?e+"."+i.hostname:i.hostname,a=+i.port,u=n,h=new $e(null,void 0),o&&en(h,o),s&&nn(h,s),a&&rn(h,a),u&&(h.g=u),c=h),t.W&&tt(t.W,function(t,e){sn(c,e,t)}),e=t.A,n=t.na,e&&n&&sn(c,e,n),sn(c,"VER",t.ha),er(t,c),c}function pr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Vn(t.Ka)).F=t.C,e}function dr(){}function vr(){if(ut&&!(10<=Number(wt)))throw Error("Environmental error: no available transport.")}function yr(t,e){Bt.call(this),this.a=new Kn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new wr(this)}function gr(t){Pe.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function mr(){_e.call(this),this.status=1}function wr(t){this.a=t}(S=Vn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Oe(this.H):Oe(Le),this.a.onreadystatechange=j(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void qn(this,t)}t=n||"";var i,o=new Ye(this.headers);r&&Ke(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=xn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=k.FormData&&t instanceof k.FormData,0<=z(jn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Bn(this),0<this.o&&((this.D=(i=this.a,ut&&mt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=j(this.xa,this)):this.m=ie(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){qn(this,t)}},S.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},S.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),zn(this))},S.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),zn(this,!0)),Vn.S.G.call(this)},S.za=function(){this.j||(this.A||this.l||this.g?Gn(this):this.Ta())},S.Ta=function(){Gn(this)},S.X=function(){try{return 2<Qn(this)?this.a.status:-1}catch(t){return-1}},S.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},S.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Un(e)}},S.ua=function(){return this.h},S.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(S=Kn.prototype).ha=8,S.v=1,S.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ve(this,this.c,t,void 0),r=this.l;if(this.O&&(r?rt(r=et(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=nr(this,n,e),sn(i=tn(this.B),"RID",t),sn(i,"CVER",22),this.A&&sn(i,"X-HTTP-Session-Id",this.A),er(this,i),this.i&&r&&Wn(i,this.i,r),On(this.b,n),this.Ga&&sn(i,"TYPE","init"),this.da?(sn(i,"$req",e),sn(i,"SID","null"),n.V=!0,xe(n,i,null)):xe(n,i,e),this.v=2}}else 3==this.v&&(t?tr(this,t):0==this.g.length||Nn(this.b)||tr(this))},S.Aa=function(){var t;this.j=null,sr(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Ae(j(this.Sa,this),t))},S.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Xn(this),sr(this))},S.Ra=function(){null!=this.m&&(this.m=null,Xn(this),ir(this),Ie())},S.Xa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),Ie()},(S=dr.prototype).ta=function(){},S.sa=function(){},S.ra=function(){},S.qa=function(){},S.Ha=function(){},vr.prototype.a=function(t,e){return new yr(t,e)},F(yr,Bt),(S=yr.prototype).addEventListener=function(t,e,n,r){yr.S.addEventListener.call(this,t,e,n,r)},S.removeEventListener=function(t,e,n,r){yr.S.removeEventListener.call(this,t,e,n,r)},S.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;Ie(),t.fa=e,t.W=n||{},t.H=t.T,t.B=fr(t,null,t.fa),$n(t)},S.close=function(){Yn(this.a)},S.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Zn(this.a,e)):this.g?((e={}).__data__=Wt(t),Zn(this.a,e)):Zn(this.a,t)},S.G=function(){this.a.f=null,delete this.f,Yn(this.a),delete this.a,yr.S.G.call(this)},F(gr,Pe),F(mr,_e),F(wr,dr),wr.prototype.ta=function(){this.a.dispatchEvent("a")},wr.prototype.sa=function(t){this.a.dispatchEvent(new gr(t))},wr.prototype.ra=function(t){this.a.dispatchEvent(new mr)},wr.prototype.qa=function(){this.a.dispatchEvent("b")},vr.prototype.createWebChannel=vr.prototype.a,yr.prototype.send=yr.prototype.Pa,yr.prototype.open=yr.prototype.Oa,Ne.NO_ERROR=0,Ne.TIMEOUT=8,Ne.HTTP_ERROR=6,Re.COMPLETE="complete",(ke.EventType=De).OPEN="a",De.CLOSE="b",De.ERROR="c",De.MESSAGE="d",Bt.prototype.listen=Bt.prototype.va,Vn.prototype.listenOnce=Vn.prototype.wa,Vn.prototype.getLastError=Vn.prototype.Qa,Vn.prototype.getLastErrorCode=Vn.prototype.ua,Vn.prototype.getStatus=Vn.prototype.X,Vn.prototype.getResponseJson=Vn.prototype.Na,Vn.prototype.getResponseText=Vn.prototype.$,Vn.prototype.send=Vn.prototype.ba;var br={createWebChannelTransport:function(){return new vr},ErrorCode:Ne,EventType:Re,WebChannel:ke,XhrIo:Vn},Er=br.createWebChannelTransport,Ir=br.ErrorCode,Tr=br.EventType,Ar=br.WebChannel,Nr=br.XhrIo,Rr=(Sr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Sr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Sr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Sr);function Sr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Or,kr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Lr=(o(_r,Or=Error),_r),Dr="7.20.0-202088235442",Pr=new p("@firebase/firestore");function _r(t,e){var n=this;return(n=Or.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Ur(){return Pr.logLevel}function Vr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Pr.logLevel<=a.DEBUG&&(e=n.map(jr),Pr.debug.apply(Pr,s(["Firestore ("+Dr+"): "+t],e)))}function Cr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Pr.logLevel<=a.ERROR&&(e=n.map(jr),Pr.error.apply(Pr,s(["Firestore ("+Dr+"): "+t],e)))}function Mr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Pr.logLevel<=a.WARN&&(e=n.map(jr),Pr.warn.apply(Pr,s(["Firestore ("+Dr+"): "+t],e)))}function jr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function xr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+Dr+") INTERNAL ASSERTION FAILED: "+t;throw Cr(e),new Error(e)}function qr(t){t||xr()}function Fr(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Gr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function zr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Br,Qr,Wr=(Object.defineProperty(ti.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),ti.prototype.isEqual=function(t){return 0===ti.i(this,t)},ti.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ti?t.forEach(function(t){e.push(t)}):e.push(t),this.o(e)},ti.prototype.limit=function(){return this.offset+this.length},ti.prototype.u=function(t){return t=void 0===t?1:t,this.o(this.segments,this.offset+t,this.length-t)},ti.prototype.h=function(){return this.o(this.segments,this.offset,this.length-1)},ti.prototype.l=function(){return this.segments[this.offset]},ti.prototype._=function(){return this.get(this.length-1)},ti.prototype.get=function(t){return this.segments[this.offset+t]},ti.prototype.m=function(){return 0===this.length},ti.prototype.T=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ti.prototype.I=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ti.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ti.prototype.A=function(){return this.segments.slice(this.offset,this.limit())},ti.i=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ti),Hr=(o($r,Qr=Wr),$r.prototype.o=function(t,e,n){return new $r(t,e,n)},$r.prototype.R=function(){return this.A().join("/")},$r.prototype.toString=function(){return this.R()},$r.P=function(t){if(0<=t.indexOf("//"))throw new Lr(kr.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new $r(t.split("/").filter(function(t){return 0<t.length}))},$r.p=function(){return new $r([])},$r),Kr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Yr=(o(Zr,Br=Wr),Zr.prototype.o=function(t,e,n){return new Zr(t,e,n)},Zr.g=function(t){return Kr.test(t)},Zr.prototype.R=function(){return this.A().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),Zr.g(t)||(t="`"+t+"`"),t}).join(".")},Zr.prototype.toString=function(){return this.R()},Zr.prototype.V=function(){return 1===this.length&&"__name__"===this.get(0)},Zr.v=function(){return new Zr(["__name__"])},Zr.S=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Lr(kr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Lr(kr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[r+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new Lr(kr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=a,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Lr(kr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Zr(e)},Zr.p=function(){return new Zr([])},Zr),Xr=(Jr.C=function(t){return new Jr(Hr.P(t))},Jr.D=function(t){return new Jr(Hr.P(t).u(5))},Jr.prototype.F=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Jr.prototype.isEqual=function(t){return null!==t&&0===Hr.i(this.path,t.path)},Jr.prototype.toString=function(){return this.path.toString()},Jr.i=function(t,e){return Hr.i(t.path,e.path)},Jr.$=function(t){return t.length%2==0},Jr.N=function(t){return new Jr(new Hr(t.slice()))},Jr);function Jr(t){this.path=t}function Zr(){return null!==Br&&Br.apply(this,arguments)||this}function $r(){return null!==Qr&&Qr.apply(this,arguments)||this}function ti(t,e,n){void 0===e?e=0:e>t.length&&xr(),void 0===n?n=t.length-e:n>t.length-e&&xr(),this.segments=t,this.offset=e,this.t=n}function ei(t,e){if(0!==e.length)throw new Lr(kr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+wi(e.length,"argument")+".")}function ni(t,e,n){if(e.length!==n)throw new Lr(kr.INVALID_ARGUMENT,"Function "+t+"() requires "+wi(n,"argument")+", but was called with "+wi(e.length,"argument")+".")}function ri(t,e,n){if(e.length<n)throw new Lr(kr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+wi(n,"argument")+", but was called with "+wi(e.length,"argument")+".")}function ii(t,e,n,r){if(e.length<n||e.length>r)throw new Lr(kr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+wi(e.length,"argument")+".")}function oi(t,e,n,r){li(t,e,mi(n)+" argument",r)}function si(t,e,n,r){void 0!==r&&oi(t,e,n,r)}function ai(t,e,n,r){li(t,e,n+" option",r)}function ui(t,e,n,r){void 0!==r&&ai(t,e,n,r)}function hi(t,e,n,r,u){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=u;i<o.length;i++){var s=o[i];if(s===n)return;r.push(pi(s))}var a=pi(n);throw new Lr(kr.INVALID_ARGUMENT,"Invalid value "+a+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function ci(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Lr(kr.INVALID_ARGUMENT,"Invalid value "+pi(r)+" provided to function "+t+"() for its "+mi(n)+" argument. Acceptable values: "+e.join(", "));return r}function li(t,e,n,r){if(!("object"===e?fi(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=pi(r);throw new Lr(kr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function fi(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function pi(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":xr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function di(t,e,n){if(void 0===n)throw new Lr(kr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+mi(e)+" argument, but it was undefined.")}function vi(n,t,r){Gr(t,function(t,e){if(r.indexOf(t)<0)throw new Lr(kr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function yi(t,e,n,r){var i=pi(r);return new Lr(kr.INVALID_ARGUMENT,"Function "+t+"() requires its "+mi(n)+" argument to be a "+e+", but it was: "+i)}function gi(t,e,n){if(n<=0)throw new Lr(kr.INVALID_ARGUMENT,"Function "+t+"() requires its "+mi(e)+" argument to be a positive number, but it was: "+n+".")}function mi(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function wi(t,e){return t+" "+e+(1===t?"":"s")}var bi=(Ei.k=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Ei);function Ei(){}function Ii(t,e){return t<e?-1:e<t?1:0}function Ti(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var Ai=(Ni.fromBase64String=function(t){return new Ni(atob(t))},Ni.fromUint8Array=function(t){return new Ni(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Ni.prototype.toBase64=function(){return t=this.O,btoa(t);var t},Ni.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.O)},Ni.prototype.M=function(){return 2*this.O.length},Ni.prototype.q=function(t){return Ii(this.O,t.O)},Ni.prototype.isEqual=function(t){return this.O===t.O},Ni);function Ni(t){this.O=t}Ai.L=new Ai("");var Ri=(Si.fromBase64String=function(t){try{return new Si(Ai.fromBase64String(t))}catch(t){throw new Lr(kr.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},Si.fromUint8Array=function(t){return new Si(Ai.fromUint8Array(t))},Si.prototype.toBase64=function(){return this.B.toBase64()},Si.prototype.toUint8Array=function(){return this.B.toUint8Array()},Si.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Si.prototype.isEqual=function(t){return this.B.isEqual(t.B)},Si);function Si(t){this.B=t}function Oi(){if("undefined"==typeof Uint8Array)throw new Lr(kr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function ki(){if("undefined"==typeof atob)throw new Lr(kr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function Li(t,e,n,r,i){this.U=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var Di,Pi=(o(Fi,Di=Ri),Fi.fromBase64String=function(t){ni("Blob.fromBase64String",arguments,1),oi("Blob.fromBase64String","string",1,t),ki();try{return new Fi(Ai.fromBase64String(t))}catch(t){throw new Lr(kr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Fi.fromUint8Array=function(t){if(ni("Blob.fromUint8Array",arguments,1),Oi(),!(t instanceof Uint8Array))throw yi("Blob.fromUint8Array","Uint8Array",1,t);return new Fi(Ai.fromUint8Array(t))},Fi.prototype.toBase64=function(){return ni("Blob.toBase64",arguments,0),ki(),Di.prototype.toBase64.call(this)},Fi.prototype.toUint8Array=function(){return ni("Blob.toUint8Array",arguments,0),Oi(),Di.prototype.toUint8Array.call(this)},Fi.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Fi),_i=(Object.defineProperty(qi.prototype,"j",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),qi.prototype.isEqual=function(t){return t instanceof qi&&t.projectId===this.projectId&&t.database===this.database},qi.prototype.q=function(t){return Ii(this.projectId,t.projectId)||Ii(this.database,t.database)},qi),Ui=(xi.prototype.get=function(t){var e=this.W(t),n=this.K[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(this.G(s,t))return a}},xi.prototype.has=function(t){return void 0!==this.get(t)},xi.prototype.set=function(t,e){var n=this.W(t),r=this.K[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.G(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.K[n]=[[t,e]]},xi.prototype.delete=function(t){var e=this.W(t),n=this.K[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.G(n[r][0],t))return 1===n.length?delete this.K[e]:n.splice(r,1),!0;return!1},xi.prototype.forEach=function(a){Gr(this.K,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];a(o,s)}})},xi.prototype.m=function(){return zr(this.K)},xi),Vi=(ji.now=function(){return ji.fromMillis(Date.now())},ji.fromDate=function(t){return ji.fromMillis(t.getTime())},ji.fromMillis=function(t){var e=Math.floor(t/1e3);return new ji(e,1e6*(t-1e3*e))},ji.prototype.toDate=function(){return new Date(this.toMillis())},ji.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},ji.prototype.H=function(t){return this.seconds===t.seconds?Ii(this.nanoseconds,t.nanoseconds):Ii(this.seconds,t.seconds)},ji.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},ji.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},ji.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},ji.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},ji),Ci=(Mi.Y=function(t){return new Mi(t)},Mi.min=function(){return new Mi(new Vi(0,0))},Mi.prototype.q=function(t){return this.timestamp.H(t.timestamp)},Mi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Mi.prototype.J=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Mi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Mi.prototype.X=function(){return this.timestamp},Mi);function Mi(t){this.timestamp=t}function ji(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Lr(kr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Lr(kr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Lr(kr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Lr(kr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function xi(t,e){this.W=t,this.G=e,this.K={}}function qi(t,e){this.projectId=t,this.database=e||"(default)"}function Fi(){return null!==Di&&Di.apply(this,arguments)||this}function Gi(t){return null==t}function zi(t){return-0===t&&1/t==-1/0}var Bi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Z=null};function Qi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Bi(t,e,n,r,i,o,s)}function Wi(t){var e,n=t;return null===n.Z&&(e=n.path.R(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.R()+e.op.toString()+Ho(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.R()+e.dir;var e}).join(","),Gi(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=mu(n.startAt)),n.endAt&&(e+="|ub:",e+=mu(n.endAt)),n.Z=e),n.Z}function Hi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,a=0;a<t.filters.length;a++)if(o=t.filters[a],s=e.filters[a],o.op!==s.op||!o.field.isEqual(s.field)||!zo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!bu(t.startAt,e.startAt)&&bu(t.endAt,e.endAt)}function Ki(t){return Xr.$(t.path)&&null===t.collectionGroup&&0===t.filters.length}function Yi(t){this.count=t}var Xi,Ji,Zi=($i.prototype.nt=function(t){return new $i(this.target,this.targetId,this.tt,t,this.et,this.lastLimboFreeSnapshotVersion,this.resumeToken)},$i.prototype.st=function(t,e){return new $i(this.target,this.targetId,this.tt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},$i.prototype.it=function(t){return new $i(this.target,this.targetId,this.tt,this.sequenceNumber,this.et,t,this.resumeToken)},$i);function $i(t,e,n,r,i,o,s){void 0===i&&(i=Ci.min()),void 0===o&&(o=Ci.min()),void 0===s&&(s=Ai.L),this.target=t,this.targetId=e,this.tt=n,this.sequenceNumber=r,this.et=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function to(t){switch(t){case kr.OK:return xr(),0;case kr.CANCELLED:case kr.UNKNOWN:case kr.DEADLINE_EXCEEDED:case kr.RESOURCE_EXHAUSTED:case kr.INTERNAL:case kr.UNAVAILABLE:case kr.UNAUTHENTICATED:return;case kr.INVALID_ARGUMENT:case kr.NOT_FOUND:case kr.ALREADY_EXISTS:case kr.PERMISSION_DENIED:case kr.FAILED_PRECONDITION:case kr.ABORTED:case kr.OUT_OF_RANGE:case kr.UNIMPLEMENTED:case kr.DATA_LOSS:return 1;default:return xr(),0}}function eo(t){if(void 0===t)return Cr("GRPC error has no .code"),kr.UNKNOWN;switch(t){case Xi.OK:return kr.OK;case Xi.CANCELLED:return kr.CANCELLED;case Xi.UNKNOWN:return kr.UNKNOWN;case Xi.DEADLINE_EXCEEDED:return kr.DEADLINE_EXCEEDED;case Xi.RESOURCE_EXHAUSTED:return kr.RESOURCE_EXHAUSTED;case Xi.INTERNAL:return kr.INTERNAL;case Xi.UNAVAILABLE:return kr.UNAVAILABLE;case Xi.UNAUTHENTICATED:return kr.UNAUTHENTICATED;case Xi.INVALID_ARGUMENT:return kr.INVALID_ARGUMENT;case Xi.NOT_FOUND:return kr.NOT_FOUND;case Xi.ALREADY_EXISTS:return kr.ALREADY_EXISTS;case Xi.PERMISSION_DENIED:return kr.PERMISSION_DENIED;case Xi.FAILED_PRECONDITION:return kr.FAILED_PRECONDITION;case Xi.ABORTED:return kr.ABORTED;case Xi.OUT_OF_RANGE:return kr.OUT_OF_RANGE;case Xi.UNIMPLEMENTED:return kr.UNIMPLEMENTED;case Xi.DATA_LOSS:return kr.DATA_LOSS;default:return xr()}}(Ji=Xi=Xi||{})[Ji.OK=0]="OK",Ji[Ji.CANCELLED=1]="CANCELLED",Ji[Ji.UNKNOWN=2]="UNKNOWN",Ji[Ji.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ji[Ji.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ji[Ji.NOT_FOUND=5]="NOT_FOUND",Ji[Ji.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ji[Ji.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ji[Ji.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ji[Ji.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ji[Ji.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ji[Ji.ABORTED=10]="ABORTED",Ji[Ji.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ji[Ji.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ji[Ji.INTERNAL=13]="INTERNAL",Ji[Ji.UNAVAILABLE=14]="UNAVAILABLE",Ji[Ji.DATA_LOSS=15]="DATA_LOSS";var no=(ao.prototype.rt=function(t,e){return new ao(this.i,this.root.rt(t,e,this.i).copy(null,null,io.ot,null,null))},ao.prototype.remove=function(t){return new ao(this.i,this.root.remove(t,this.i).copy(null,null,io.ot,null,null))},ao.prototype.get=function(t){for(var e=this.root;!e.m();){var n=this.i(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},ao.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.m();){var r=this.i(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},ao.prototype.m=function(){return this.root.m()},Object.defineProperty(ao.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),ao.prototype.ut=function(){return this.root.ut()},ao.prototype.ct=function(){return this.root.ct()},ao.prototype.at=function(t){return this.root.at(t)},ao.prototype.forEach=function(n){this.at(function(t,e){return n(t,e),!1})},ao.prototype.toString=function(){var n=[];return this.at(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},ao.prototype.ht=function(t){return this.root.ht(t)},ao.prototype.lt=function(){return new ro(this.root,null,this.i,!1)},ao.prototype._t=function(t){return new ro(this.root,t,this.i,!1)},ao.prototype.ft=function(){return new ro(this.root,null,this.i,!0)},ao.prototype.dt=function(t){return new ro(this.root,t,this.i,!0)},ao),ro=(so.prototype.Et=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.m();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.m();)this.Tt.push(t),t=t.left;return e},so.prototype.It=function(){return 0<this.Tt.length},so.prototype.At=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},so),io=(oo.prototype.copy=function(t,e,n,r,i){return new oo(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},oo.prototype.m=function(){return!1},oo.prototype.at=function(t){return this.left.at(t)||t(this.key,this.value)||this.right.at(t)},oo.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},oo.prototype.min=function(){return this.left.m()?this:this.left.min()},oo.prototype.ut=function(){return this.min().key},oo.prototype.ct=function(){return this.right.m()?this.key:this.right.ct()},oo.prototype.rt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.rt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.rt(t,e,n))).Rt()},oo.prototype.yt=function(){if(this.left.m())return oo.EMPTY;var t=this;return t.left.Pt()||t.left.left.Pt()||(t=t.gt()),(t=t.copy(null,null,null,t.left.yt(),null)).Rt()},oo.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.m()||r.left.Pt()||r.left.left.Pt()||(r=r.gt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Pt()&&(r=r.Vt()),r.right.m()||r.right.Pt()||r.right.left.Pt()||(r=r.vt()),0===e(t,r.key)){if(r.right.m())return oo.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.yt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Rt()},oo.prototype.Pt=function(){return this.color},oo.prototype.Rt=function(){var t=this;return t.right.Pt()&&!t.left.Pt()&&(t=t.bt()),t.left.Pt()&&t.left.left.Pt()&&(t=t.Vt()),t.left.Pt()&&t.right.Pt()&&(t=t.St()),t},oo.prototype.gt=function(){var t=this.St();return t.right.left.Pt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Vt())).bt()).St()),t},oo.prototype.vt=function(){var t=this.St();return t.left.left.Pt()&&(t=(t=t.Vt()).St()),t},oo.prototype.bt=function(){var t=this.copy(null,null,oo.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},oo.prototype.Vt=function(){var t=this.copy(null,null,oo.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},oo.prototype.St=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},oo.prototype.Ct=function(){var t=this.Dt();return Math.pow(2,t)<=this.size+1},oo.prototype.Dt=function(){if(this.Pt()&&this.left.Pt())throw xr();if(this.right.Pt())throw xr();var t=this.left.Dt();if(t!==this.right.Dt())throw xr();return t+(this.Pt()?0:1)},oo);function oo(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:oo.RED,this.left=null!=r?r:oo.EMPTY,this.right=null!=i?i:oo.EMPTY,this.size=this.left.size+1+this.right.size}function so(t,e,n,r){this.wt=r,this.Tt=[];for(var i=1;!t.m();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.wt?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.wt?t.right:t.left}}function ao(t,e){this.i=t,this.root=e||io.EMPTY}function uo(){this.size=0}io.EMPTY=null,io.RED=!0,io.ot=!1,io.EMPTY=(Object.defineProperty(uo.prototype,"key",{get:function(){throw xr()},enumerable:!1,configurable:!0}),Object.defineProperty(uo.prototype,"value",{get:function(){throw xr()},enumerable:!1,configurable:!0}),Object.defineProperty(uo.prototype,"color",{get:function(){throw xr()},enumerable:!1,configurable:!0}),Object.defineProperty(uo.prototype,"left",{get:function(){throw xr()},enumerable:!1,configurable:!0}),Object.defineProperty(uo.prototype,"right",{get:function(){throw xr()},enumerable:!1,configurable:!0}),uo.prototype.copy=function(t,e,n,r,i){return this},uo.prototype.rt=function(t,e,n){return new io(t,e)},uo.prototype.remove=function(t,e){return this},uo.prototype.m=function(){return!0},uo.prototype.at=function(t){return!1},uo.prototype.ht=function(t){return!1},uo.prototype.ut=function(){return null},uo.prototype.ct=function(){return null},uo.prototype.Pt=function(){return!1},uo.prototype.Ct=function(){return!0},uo.prototype.Dt=function(){return 0},new uo);var ho=(po.prototype.has=function(t){return null!==this.data.get(t)},po.prototype.first=function(){return this.data.ut()},po.prototype.last=function(){return this.data.ct()},Object.defineProperty(po.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),po.prototype.indexOf=function(t){return this.data.indexOf(t)},po.prototype.forEach=function(n){this.data.at(function(t,e){return n(t),!1})},po.prototype.Ft=function(t,e){for(var n=this.data._t(t[0]);n.It();){var r=n.Et();if(0<=this.i(r.key,t[1]))return;e(r.key)}},po.prototype.$t=function(t,e){for(var n=void 0!==e?this.data._t(e):this.data.lt();n.It();)if(!t(n.Et().key))return},po.prototype.Nt=function(t){var e=this.data._t(t);return e.It()?e.Et().key:null},po.prototype.lt=function(){return new co(this.data.lt())},po.prototype._t=function(t){return new co(this.data._t(t))},po.prototype.add=function(t){return this.copy(this.data.remove(t).rt(t,!0))},po.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},po.prototype.m=function(){return this.data.m()},po.prototype.xt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},po.prototype.isEqual=function(t){if(!(t instanceof po))return!1;if(this.size!==t.size)return!1;for(var e=this.data.lt(),n=t.data.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(0!==this.i(r,i))return!1}return!0},po.prototype.A=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},po.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},po.prototype.copy=function(t){var e=new po(this.i);return e.data=t,e},po),co=(fo.prototype.Et=function(){return this.kt.Et().key},fo.prototype.It=function(){return this.kt.It()},fo),lo=new no(Xr.i);function fo(t){this.kt=t}function po(t){this.i=t,this.data=new no(this.i)}var vo=new no(Xr.i),yo=new no(Xr.i),go=new ho(Xr.i);function mo(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=go,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}function wo(t,e,n,r){this.se=t,this.removedTargetIds=e,this.key=n,this.ie=r}function bo(t,e){this.targetId=t,this.re=e}function Eo(t,e,n,r){void 0===n&&(n=Ai.L),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}var Io=new ho(Ii),To=(Co.qt=function(t){return new Co(t.i)},Co.prototype.has=function(t){return null!=this.Ot.get(t)},Co.prototype.get=function(t){return this.Ot.get(t)},Co.prototype.first=function(){return this.Mt.ut()},Co.prototype.last=function(){return this.Mt.ct()},Co.prototype.m=function(){return this.Mt.m()},Co.prototype.indexOf=function(t){var e=this.Ot.get(t);return e?this.Mt.indexOf(e):-1},Object.defineProperty(Co.prototype,"size",{get:function(){return this.Mt.size},enumerable:!1,configurable:!0}),Co.prototype.forEach=function(n){this.Mt.at(function(t,e){return n(t),!1})},Co.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ot.rt(t.key,t),e.Mt.rt(t,null))},Co.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ot.remove(t),this.Mt.remove(e)):this},Co.prototype.isEqual=function(t){if(!(t instanceof Co))return!1;if(this.size!==t.size)return!1;for(var e=this.Mt.lt(),n=t.Mt.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(!r.isEqual(i))return!1}return!0},Co.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Co.prototype.copy=function(t,e){var n=new Co;return n.i=this.i,n.Ot=t,n.Mt=e,n},Co),Ao=(Vo.prototype.track=function(t){var e=t.doc.key,n=this.Lt.get(e);!n||0!==t.type&&3===n.type?this.Lt=this.Lt.rt(e,t):3===t.type&&1!==n.type?this.Lt=this.Lt.rt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Lt=this.Lt.rt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Lt=this.Lt.rt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Lt=this.Lt.remove(e):1===t.type&&2===n.type?this.Lt=this.Lt.rt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Lt=this.Lt.rt(e,{type:2,doc:t.doc}):xr()},Vo.prototype.Bt=function(){var n=[];return this.Lt.at(function(t,e){n.push(e)}),n},Vo),No=(Uo.Gt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Uo(t,e,To.qt(e),i,n,r,!0,!1)},Object.defineProperty(Uo.prototype,"hasPendingWrites",{get:function(){return!this.Qt.m()},enumerable:!1,configurable:!0}),Uo.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.jt===t.jt&&this.Qt.isEqual(t.Qt)&&Fa(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ut.isEqual(t.Ut)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Uo),Ro=(_o.Jt=function(t,e){var n=new Map;return n.set(t,So.Xt(t,e)),new _o(Ci.min(),n,Io,lo,mo())},_o),So=(Po.Xt=function(t,e){return new Po(Ai.L,e,mo(),mo(),mo())},Po),Oo=(Object.defineProperty(Do.prototype,"Zt",{get:function(){return this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(Do.prototype,"resumeToken",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(Do.prototype,"le",{get:function(){return 0!==this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(Do.prototype,"_e",{get:function(){return this.he},enumerable:!1,configurable:!0}),Do.prototype.fe=function(t){0<t.M()&&(this.he=!0,this.ce=t)},Do.prototype.de=function(){var n=mo(),r=mo(),i=mo();return this.ue.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:xr()}}),new So(this.ce,this.ae,n,r,i)},Do.prototype.we=function(){this.he=!1,this.ue=jo()},Do.prototype.me=function(t,e){this.he=!0,this.ue=this.ue.rt(t,e)},Do.prototype.Te=function(t){this.he=!0,this.ue=this.ue.remove(t)},Do.prototype.Ee=function(){this.oe+=1},Do.prototype.Ie=function(){--this.oe},Do.prototype.Ae=function(){this.he=!0,this.ae=!0},Do),ko=(Lo.prototype.Ve=function(t){for(var e=0,n=t.se;e<n.length;e++){var r=n[e];t.ie instanceof Ia?this.ve(r,t.ie):t.ie instanceof Ta&&this.be(r,t.key,t.ie)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.be(s,t.key,t.ie)}},Lo.prototype.Se=function(n){var r=this;this.Ce(n,function(t){var e=r.De(t);switch(n.state){case 0:r.Fe(t)&&e.fe(n.resumeToken);break;case 1:e.Ie(),e.le||e.we(),e.fe(n.resumeToken);break;case 2:e.Ie(),e.le||r.removeTarget(t);break;case 3:r.Fe(t)&&(e.Ae(),e.fe(n.resumeToken));break;case 4:r.Fe(t)&&(r.$e(t),e.fe(n.resumeToken));break;default:xr()}})},Lo.prototype.Ce=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ye.forEach(function(t,e){r.Fe(e)&&n(e)})},Lo.prototype.Ne=function(t){var e,n,r=t.targetId,i=t.re.count,o=this.xe(r);o&&(Ki(e=o.target)?0===i?(n=new Xr(e.path),this.be(r,n,new Ta(n,Ci.min()))):qr(1===i):this.ke(r)!==i&&(this.$e(r),this.ge=this.ge.add(r)))},Lo.prototype.Oe=function(i){var o=this,s=new Map;this.ye.forEach(function(t,e){var n,r=o.xe(e);r&&(t.Zt&&Ki(r.target)&&(n=new Xr(r.target.path),null!==o.Pe.get(n)||o.Me(e,n)||o.be(e,n,new Ta(n,i))),t._e&&(s.set(e,t.de()),t.we()))});var r=mo();this.pe.forEach(function(t,e){var n=!0;e.$t(function(t){var e=o.xe(t);return!e||2===e.tt||(n=!1)}),n&&(r=r.add(t))});var t=new Ro(i,s,this.ge,this.Pe,r);return this.Pe=lo,this.pe=Mo(),this.ge=new ho(Ii),t},Lo.prototype.ve=function(t,e){var n;this.Fe(t)&&(n=this.Me(t,e.key)?2:0,this.De(t).me(e.key,n),this.Pe=this.Pe.rt(e.key,e),this.pe=this.pe.rt(e.key,this.qe(e.key).add(t)))},Lo.prototype.be=function(t,e,n){var r;this.Fe(t)&&(r=this.De(t),this.Me(t,e)?r.me(e,1):r.Te(e),this.pe=this.pe.rt(e,this.qe(e).delete(t)),n&&(this.Pe=this.Pe.rt(e,n)))},Lo.prototype.removeTarget=function(t){this.ye.delete(t)},Lo.prototype.ke=function(t){var e=this.De(t).de();return this.Re.Le(t).size+e.te.size-e.ne.size},Lo.prototype.Ee=function(t){this.De(t).Ee()},Lo.prototype.De=function(t){var e=this.ye.get(t);return e||(e=new Oo,this.ye.set(t,e)),e},Lo.prototype.qe=function(t){var e=this.pe.get(t);return e||(e=new ho(Ii),this.pe=this.pe.rt(t,e)),e},Lo.prototype.Fe=function(t){var e=null!==this.xe(t);return e||Vr("WatchChangeAggregator","Detected inactive target",t),e},Lo.prototype.xe=function(t){var e=this.ye.get(t);return e&&e.le?null:this.Re.Be(t)},Lo.prototype.$e=function(e){var n=this;this.ye.set(e,new Oo),this.Re.Le(e).forEach(function(t){n.be(e,t,null)})},Lo.prototype.Me=function(t,e){return this.Re.Le(t).has(e)},Lo);function Lo(t){this.Re=t,this.ye=new Map,this.Pe=lo,this.pe=Mo(),this.ge=new ho(Ii)}function Do(){this.oe=0,this.ue=jo(),this.ce=Ai.L,this.ae=!1,this.he=!0}function Po(t,e,n,r,i){this.resumeToken=t,this.Zt=e,this.te=n,this.ee=r,this.ne=i}function _o(t,e,n,r,i){this.et=t,this.Kt=e,this.zt=n,this.Ht=r,this.Yt=i}function Uo(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.Ut=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.jt=s,this.Wt=a}function Vo(){this.Lt=new no(Xr.i)}function Co(n){this.i=n?function(t,e){return n(t,e)||Xr.i(t.key,e.key)}:function(t,e){return Xr.i(t.key,e.key)},this.Ot=vo,this.Mt=new no(this.i)}function Mo(){return new no(Xr.i)}function jo(){return new no(Xr.i)}function xo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function qo(t){var e=Ko(t.mapValue.fields.__local_write_time__.timestampValue);return new Vi(e.seconds,e.nanos)}var Fo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Go(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?xo(t)?4:10:xr()}function zo(r,i){var t,e,n,o=Go(r);if(o!==Go(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return qo(r).isEqual(qo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Ko(r.timestampValue),n=Ko(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return n=i,Xo(r.bytesValue).isEqual(Xo(n.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Yo((t=r).geoPointValue.latitude)===Yo(e.geoPointValue.latitude)&&Yo(t.geoPointValue.longitude)===Yo(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Yo(t.integerValue)===Yo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Yo(t.doubleValue),r=Yo(e.doubleValue);return n===r?zi(n)===zi(r):isNaN(n)&&isNaN(r)}return!1}(r,i);case 9:return Ti(r.arrayValue.values||[],i.arrayValue.values||[],zo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Fr(e)!==Fr(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!zo(e[t],n[t])))return!1;return!0}();default:return xr()}}function Bo(t,e){return void 0!==(t.values||[]).find(function(t){return zo(t,e)})}function Qo(t,e){var n,r,i,o,s,a,u,h,c,l,f=Go(t),p=Go(e);if(f!==p)return Ii(f,p);switch(f){case 0:return 0;case 1:return Ii(t.booleanValue,e.booleanValue);case 2:return h=e,(c=Yo(t.integerValue||t.doubleValue))<(l=Yo(h.integerValue||h.doubleValue))?-1:l<c?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1;case 3:return Wo(t.timestampValue,e.timestampValue);case 4:return Wo(qo(t),qo(e));case 5:return Ii(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,a=Xo(o),u=Xo(s),a.q(u);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Ii(n[i],r[i]);if(0!==o)return o}return Ii(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=Ii(Yo(n.latitude),Yo(r.latitude)))?i:Ii(Yo(n.longitude),Yo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Qo(n[i],r[i]);if(o)return o}return Ii(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=Ii(r[s],o[s]);if(0!==a)return a;var u=Qo(n[r[s]],i[o[s]]);if(0!==u)return u}return Ii(r.length,o.length)}(t.mapValue,e.mapValue);default:throw xr()}}function Wo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ii(t,e);var n=Ko(t),r=Ko(e),i=Ii(n.seconds,r.seconds);return 0!==i?i:Ii(n.nanos,r.nanos)}function Ho(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=Ko(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?Xo(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,Xr.D(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):xr();var t,e,n}(t)}function Ko(t){if(qr(!!t),"string"!=typeof t)return{seconds:Yo(t.seconds),nanos:Yo(t.nanos)};var e,n=0,r=Fo.exec(t);qr(!!r),r[1]&&(e=((e=r[1])+"000000000").substr(0,9),n=Number(e));var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:n}}function Yo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Xo(t){return"string"==typeof t?Ai.fromBase64String(t):Ai.fromUint8Array(t)}function Jo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.R()}}function Zo(t){return t&&"integerValue"in t}function $o(t){return!!t&&"arrayValue"in t}function ts(t){return t&&"nullValue"in t}function es(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ns(t){return t&&"mapValue"in t}var rs={asc:"ASCENDING",desc:"DESCENDING"},is={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},os=function(t,e){this.U=t,this.Ue=e};function ss(t){return{integerValue:""+t}}function as(t,e){if(t.Ue){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:zi(e)?"-0":e}}function us(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!zi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?ss(e):as(t,e);var n}function hs(t,e){return t.Ue?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function cs(t,e){return t.Ue?e.toBase64():e.toUint8Array()}function ls(t){return qr(!!t),Ci.Y((e=Ko(t),new Vi(e.seconds,e.nanos)));var e}function fs(t,e){return new Hr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).R()}function ps(t,e){return fs(t.U,e.path)}function ds(t,e){var n,r,i=(qr(Es(r=Hr.P(e))),r);return qr(i.get(1)===t.U.projectId),qr(!i.get(3)&&!t.U.database||i.get(3)===t.U.database),new Xr((qr(4<(n=i).length&&"documents"===n.get(4)),n.u(5)))}function vs(t,e){return fs(t.U,e)}function ys(t){return new Hr(["projects",t.U.projectId,"databases",t.U.database]).R()}function gs(t,e,n){return{name:ps(t,e),fields:n.proto.mapValue.fields}}function ms(t,e){var n,r,i,o;if(e instanceof $s)n={update:gs(t,e.key,e.value)};else if(e instanceof ca)n={delete:ps(t,e.key)};else if(e instanceof ta)n={update:gs(t,e.key,e.data),updateMask:(r=e.Qe,i=[],r.fields.forEach(function(t){return i.push(t.R())}),{fieldPaths:i})};else if(e instanceof oa)n={transform:{document:ps(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Rs)return{fieldPath:t.field.R(),setToServerValue:"REQUEST_TIME"};if(e instanceof Ss)return{fieldPath:t.field.R(),appendMissingElements:{values:e.elements}};if(e instanceof Ps)return{fieldPath:t.field.R(),removeAllFromArray:{values:e.elements}};if(e instanceof Cs)return{fieldPath:t.field.R(),increment:e.je};throw xr()})}};else{if(!(e instanceof la))return xr();n={verify:ps(t,e.key)}}return e.Ge.We||(n.currentDocument=void 0!==(o=e.Ge).updateTime?{updateTime:hs(t,o.updateTime.X())}:void 0!==o.exists?{exists:o.exists}:xr()),n}function ws(t){return{before:t.before,values:t.position}}function bs(t){return{fieldPath:t.R()}}function Es(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function Is(){this.Ke=void 0}function Ts(t,e){return t instanceof Cs?Zo(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var As,Ns,Rs=(o(ks,Ns=Is),ks),Ss=(o(Os,As=Is),Os);function Os(t){var e=this;return(e=As.call(this)||this).elements=t,e}function ks(){return null!==Ns&&Ns.apply(this,arguments)||this}function Ls(t,e){for(var n=xs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return zo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var Ds,Ps=(o(_s,Ds=Is),_s);function _s(t){var e=this;return(e=Ds.call(this)||this).elements=t,e}function Us(t,e){for(var n=xs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!zo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var Vs,Cs=(o(Ms,Vs=Is),Ms);function Ms(t,e){var n=this;return(n=Vs.call(this)||this).serializer=t,n.je=e,n}function js(t){return Yo(t.integerValue||t.doubleValue)}function xs(t){return $o(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function qs(t,e){this.field=t,this.transform=e}var Fs=(Gs.prototype.ze=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].T(t))return!0;return!1},Gs.prototype.isEqual=function(t){return Ti(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Gs);function Gs(t){(this.fields=t).sort(Yr.i)}function zs(t,e){this.version=t,this.transformResults=e}var Bs=(Qs.He=function(){return new Qs},Qs.exists=function(t){return new Qs(void 0,t)},Qs.updateTime=function(t){return new Qs(t)},Object.defineProperty(Qs.prototype,"We",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Qs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Qs);function Qs(t,e){this.updateTime=t,this.exists=e}function Ws(t,e){return void 0!==t.updateTime?e instanceof Ia&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Ia}function Hs(){}function Ks(t,e,n,r){return t instanceof $s?function(t,e){if(!Ws(t.Ge,e))return e;var n=Xs(e);return new Ia(t.key,n,t.value,{Ye:!0})}(t,e):t instanceof ta?function(t,e){if(!Ws(t.Ge,e))return e;var n=Xs(e),r=ra(t,e);return new Ia(t.key,n,r,{Ye:!0})}(t,e):t instanceof oa?function(t,e,n,r){if(!Ws(t.Ge,e))return e;var i=e,o=function(t,e,n,r){for(var i,o,s,a,u,h,c=[],l=0,f=t;l<f.length;l++){var p=f[l],d=p.transform,v=null;n instanceof Ia&&(v=n.field(p.field)),null===v&&r instanceof Ia&&(v=r.field(p.field)),c.push((o=v,h=u=a=s=void 0,(i=d)instanceof Rs?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},o&&(h.fields.__previous_value__=o),{mapValue:h}):i instanceof Ss?Ls(i,o):i instanceof Ps?Us(i,o):(u=js(a=Ts(s=i,o))+js(s.je),Zo(a)&&Zo(s.je)?ss(u):as(s.serializer,u))))}return c}(t.fieldTransforms,n,e,r),s=aa(t,i.data(),o);return new Ia(t.key,i.version,s,{Ye:!0})}(t,e,r,n):(o=e,Ws((i=t).Ge,o)?new Ta(i.key,Ci.min()):o);var i,o}function Ys(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ge.isEqual(e.Ge)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||Ti(t.fieldTransforms,t.fieldTransforms,function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof Ss&&o instanceof Ss||i instanceof Ps&&o instanceof Ps?Ti(i.elements,o.elements,zo):i instanceof Cs&&o instanceof Cs?zo(i.je,o.je):i instanceof Rs&&o instanceof Rs);var n,r,i,o}))}function Xs(t){return t instanceof Ia?t.version:Ci.min()}var Js,Zs,$s=(o(na,Zs=Hs),na),ta=(o(ea,Js=Hs),ea);function ea(t,e,n,r){var i=this;return(i=Js.call(this)||this).key=t,i.data=e,i.Qe=n,i.Ge=r,i.type=1,i}function na(t,e,n){var r=this;return(r=Zs.call(this)||this).key=t,r.value=e,r.Ge=n,r.type=0,r}function ra(t,e){return n=t,r=e instanceof Ia?e.data():fa.empty(),i=new pa(r),n.Qe.fields.forEach(function(t){var e;t.m()||(null!==(e=n.data.field(t))?i.set(t,e):i.delete(t))}),i.Je();var n,r,i}var ia,oa=(o(sa,ia=Hs),sa);function sa(t,e){var n=this;return(n=ia.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ge=Bs.exists(!0),n}function aa(t,e,n){for(var r=new pa(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Je()}var ua,ha,ca=(o(ga,ha=Hs),ga),la=(o(ya,ua=Hs),ya),fa=(va.empty=function(){return new va({mapValue:{}})},va.prototype.field=function(t){if(t.m())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!ns(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t._()])||null},va.prototype.isEqual=function(t){return zo(this.proto,t.proto)},va),pa=(da.prototype.set=function(t,e){return this.tn(t,e),this},da.prototype.delete=function(t){return this.tn(t,null),this},da.prototype.tn=function(t,e){for(var n=this.Ze,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===Go(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t._(),e)},da.prototype.Je=function(){var t=this.en(Yr.p(),this.Ze);return null!=t?new fa(t):this.Xe},da.prototype.en=function(r,t){var i=this,o=!1,e=this.Xe.field(r),s=ns(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.en(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},da);function da(t){void 0===t&&(t=fa.empty()),this.Xe=t,this.Ze=new Map}function va(t){this.proto=t}function ya(t,e){var n=this;return(n=ua.call(this)||this).key=t,n.Ge=e,n.type=4,n}function ga(t,e){var n=this;return(n=ha.call(this)||this).key=t,n.Ge=e,n.type=3,n}function ma(t,e){this.key=t,this.version=e}var wa,ba,Ea,Ia=(o(Sa,Ea=ma),Sa.prototype.field=function(t){return this.nn.field(t)},Sa.prototype.data=function(){return this.nn},Sa.prototype.sn=function(){return this.nn.proto},Sa.prototype.isEqual=function(t){return t instanceof Sa&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ye===t.Ye&&this.hasCommittedMutations===t.hasCommittedMutations&&this.nn.isEqual(t.nn)},Sa.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.nn.toString()+", {hasLocalMutations: "+this.Ye+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Sa.prototype,"hasPendingWrites",{get:function(){return this.Ye||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Sa),Ta=(o(Ra,ba=ma),Ra.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Ra.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Ra.prototype.isEqual=function(t){return t instanceof Ra&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Ra),Aa=(o(Na,wa=ma),Na.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Na.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Na.prototype.isEqual=function(t){return t instanceof Na&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Na);function Na(){return null!==wa&&wa.apply(this,arguments)||this}function Ra(t,e,n){var r=this;return(r=ba.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Sa(t,e,n,r){var i=this;return(i=Ea.call(this,t,e)||this).nn=n,i.Ye=!!r.Ye,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Oa(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new Lr(kr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass '"+e.name+"' from a different Firestore SDK?"):new Lr(kr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but was '"+t.constructor.name+"'");return t}var ka=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.rn=n,this.filters=r,this.limit=i,this.on=o,this.startAt=s,this.endAt=a,this.un=null,this.cn=null,this.startAt,this.endAt};function La(t){return new ka(t)}function Da(t){return!Gi(t.limit)&&"F"===t.on}function Pa(t){return!Gi(t.limit)&&"L"===t.on}function _a(t){return 0<t.rn.length?t.rn[0].field:null}function Ua(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.an())return r.field}return null}function Va(t){return null!==t.collectionGroup}function Ca(t){var e=Oa(t,ka);if(null===e.un){e.un=[];var n=Ua(e),r=_a(e);if(null!==n&&null===r)n.V()||e.un.push(new Eu(n)),e.un.push(new Eu(Yr.v(),"asc"));else{for(var i,o=!1,s=0,a=e.rn;s<a.length;s++){var u=a[s];e.un.push(u),u.field.V()&&(o=!0)}o||(i=0<e.rn.length?e.rn[e.rn.length-1].dir:"asc",e.un.push(new Eu(Yr.v(),i)))}}return e.un}function Ma(t){var e=Oa(t,ka);if(!e.cn)if("F"===e.on)e.cn=Qi(e.path,e.collectionGroup,Ca(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Ca(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Eu(o.field,s))}var a=e.endAt?new pu(e.endAt.position,!e.endAt.before):null,u=e.startAt?new pu(e.startAt.position,!e.startAt.before):null;e.cn=Qi(e.path,e.collectionGroup,n,e.filters,e.limit,a,u)}return e.cn}function ja(t,e,n){return new ka(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function xa(t,e){return new ka(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,e,t.endAt)}function qa(t,e){return new ka(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,t.startAt,e)}function Fa(t,e){return Hi(Ma(t),Ma(e))&&t.on===e.on}function Ga(t){return Wi(Ma(t))+"|lt:"+t.on}function za(t){return"Query(target="+(n=(e=Ma(t)).path.R(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.R()+" "+e.op+" "+Ho(e.value);var e}).join(", ")+"]"),Gi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.R()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+mu(e.startAt)),e.endAt&&(n+=", endAt: "+mu(e.endAt)),"Target("+n+")")+"; limitType="+t.on+")";var e,n}function Ba(i,t){return r=i,o=t.key.path,(null!==r.collectionGroup?t.key.F(r.collectionGroup)&&r.path.T(o):Xr.$(r.path)?r.path.isEqual(o):r.path.I(o))&&function(t){for(var e=0,n=i.rn;e<n.length;e++){var r=n[e];if(!r.field.V()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=i).startAt||wu(e.startAt,Ca(e),n))&&(!e.endAt||!wu(e.endAt,Ca(e),n)));var e,n,r,o}function Qa(a){return function(t,e){for(var n=!1,r=0,i=Ca(a);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i,o,s,a=t.field.V()?Xr.i(e.key,n.key):(r=t.field,i=n,o=e.field(r),s=i.field(r),null!==o&&null!==s?Qo(o,s):xr());switch(t.dir){case"asc":return a;case"desc":return-1*a;default:return xr()}}(o,t,e);if(0!==s)return s;n=n||o.field.V()}return 0}}var Wa,Ha=(o(Ka,Wa=function(){}),Ka.create=function(t,e,n){if(t.V())return"in"===e||"not-in"===e?this.hn(t,e,n):new Za(t,e,n);if(ts(n)){if("=="!==e&&"!="!==e)throw new Lr(kr.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new Ka(t,e,n)}if(es(n)){if("=="!==e&&"!="!==e)throw new Lr(kr.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new Ka(t,e,n)}return"array-contains"===e?new hu(t,n):"in"===e?new cu(t,n):"not-in"===e?new lu(t,n):"array-contains-any"===e?new fu(t,n):new Ka(t,e,n)},Ka.hn=function(t,e,n){return new("in"===e?$a:tu)(t,n)},Ka.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.ln(Qo(e,this.value)):null!==e&&Go(this.value)===Go(e)&&this.ln(Qo(e,this.value))},Ka.prototype.ln=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return xr()}},Ka.prototype.an=function(){return 0<=["<","<=",">",">=","!="].indexOf(this.op)},Ka);function Ka(t,e,n){var r=this;return(r=Wa.call(this)||this).field=t,r.op=e,r.value=n,r}var Ya,Xa,Ja,Za=(o(ru,Ja=Ha),ru.prototype.matches=function(t){var e=Xr.i(t.key,this.key);return this.ln(e)},ru),$a=(o(nu,Xa=Ha),nu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},nu),tu=(o(eu,Ya=Ha),eu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},eu);function eu(t,e){var n=this;return(n=Ya.call(this,t,"not-in",e)||this).keys=iu(0,e),n}function nu(t,e){var n=this;return(n=Xa.call(this,t,"in",e)||this).keys=iu(0,e),n}function ru(t,e,n){var r=this;return(r=Ja.call(this,t,e,n)||this).key=Xr.D(n.referenceValue),r}function iu(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return Xr.D(t.referenceValue)})}var ou,su,au,uu,hu=(o(gu,uu=Ha),gu.prototype.matches=function(t){var e=t.field(this.field);return $o(e)&&Bo(e.arrayValue,this.value)},gu),cu=(o(yu,au=Ha),yu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Bo(this.value.arrayValue,e)},yu),lu=(o(vu,su=Ha),vu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&!Bo(this.value.arrayValue,e)},vu),fu=(o(du,ou=Ha),du.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!$o(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return Bo(e.value.arrayValue,t)})},du),pu=function(t,e){this.position=t,this.before=e};function du(t,e){return ou.call(this,t,"array-contains-any",e)||this}function vu(t,e){return su.call(this,t,"not-in",e)||this}function yu(t,e){return au.call(this,t,"in",e)||this}function gu(t,e){return uu.call(this,t,"array-contains",e)||this}function mu(t){return(t.before?"b":"a")+":"+t.position.map(Ho).join(",")}function wu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.V()?Xr.i(Xr.D(s.referenceValue),n.key):Qo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function bu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!zo(t.position[n],e.position[n]))return!1;return!0}var Eu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Iu(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var Tu=(Ru.prototype.reset=function(){this.Tn=0},Ru.prototype.An=function(){this.Tn=this.mn},Ru.prototype.Rn=function(t){var e=this;this.cancel();var n=Math.floor(this.Tn+this.yn()),r=Math.max(0,Date.now()-this.In),i=Math.max(0,n-r);0<i&&Vr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Tn+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.En=this._n.Pn(this.fn,i,function(){return e.In=Date.now(),t()}),this.Tn*=this.wn,this.Tn<this.dn&&(this.Tn=this.dn),this.Tn>this.mn&&(this.Tn=this.mn)},Ru.prototype.pn=function(){null!==this.En&&(this.En.gn(),this.En=null)},Ru.prototype.cancel=function(){null!==this.En&&(this.En.cancel(),this.En=null)},Ru.prototype.yn=function(){return(Math.random()-.5)*this.Tn},Ru),Au=(Nu.prototype.catch=function(t){return this.next(void 0,t)},Nu.prototype.next=function(r,i){var o=this;return this.Sn&&xr(),this.Sn=!0,this.bn?this.error?this.Cn(i,this.error):this.Dn(r,this.result):new Nu(function(e,n){o.Vn=function(t){o.Dn(r,t).next(e,n)},o.vn=function(t){o.Cn(i,t).next(e,n)}})},Nu.prototype.Fn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Nu.prototype.$n=function(t){try{var e=t();return e instanceof Nu?e:Nu.resolve(e)}catch(t){return Nu.reject(t)}},Nu.prototype.Dn=function(t,e){return t?this.$n(function(){return t(e)}):Nu.resolve(e)},Nu.prototype.Cn=function(t,e){return t?this.$n(function(){return t(e)}):Nu.reject(e)},Nu.resolve=function(n){return new Nu(function(t,e){t(n)})},Nu.reject=function(n){return new Nu(function(t,e){e(n)})},Nu.Nn=function(t){return new Nu(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Nu.xn=function(t){for(var n=Nu.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Nu.resolve(t):e()})}(r[e]);return n},Nu.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Nn(i)},Nu);function Nu(t){var e=this;this.Vn=null,this.vn=null,this.result=void 0,this.error=void 0,this.bn=!1,this.Sn=!1,t(function(t){e.bn=!0,e.result=t,e.Vn&&e.Vn(t)},function(t){e.bn=!0,e.error=t,e.vn&&e.vn(t)})}function Ru(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this._n=t,this.fn=e,this.dn=n,this.wn=r,this.mn=i,this.Tn=0,this.En=null,this.In=Date.now(),this.reset()}function Su(t){return"IndexedDbTransactionError"===t.name}function Ou(){return"undefined"!=typeof document?document:null}var ku=(Pu.Ln=function(t,e,n,r,i){var o=new Pu(t,e,Date.now()+n,r,i);return o.start(n),o},Pu.prototype.start=function(t){var e=this;this.Bn=setTimeout(function(){return e.Un()},t)},Pu.prototype.gn=function(){return this.Un()},Pu.prototype.cancel=function(t){null!==this.Bn&&(this.clearTimeout(),this.qn.reject(new Lr(kr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Pu.prototype.Un=function(){var e=this;this.kn.Qn(function(){return null!==e.Bn?(e.clearTimeout(),e.op().then(function(t){return e.qn.resolve(t)})):Promise.resolve()})},Pu.prototype.clearTimeout=function(){null!==this.Bn&&(this.Mn(this),clearTimeout(this.Bn),this.Bn=null)},Pu),Lu=(Object.defineProperty(Du.prototype,"Zn",{get:function(){return this.Gn},enumerable:!1,configurable:!0}),Du.prototype.Qn=function(t){this.enqueue(t)},Du.prototype.ts=function(t){this.es(),this.ns(t)},Du.prototype.ss=function(){var t;this.Gn||(this.Gn=!0,(t=Ou())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xn))},Du.prototype.enqueue=function(t){return this.es(),this.Gn?new Promise(function(t){}):this.ns(t)},Du.prototype.rs=function(t){var e=this;this.Wn.push(t),this.Qn(function(){return e.os()})},Du.prototype.os=function(){return w(this,void 0,void 0,function(){var e,n=this;return b(this,function(t){switch(t.label){case 0:if(0===this.Wn.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Wn[0]()];case 2:return t.sent(),this.Wn.shift(),this.Jn.reset(),[3,4];case 3:if(!Su(e=t.sent()))throw e;return Vr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Wn.length&&this.Jn.Rn(function(){return n.os()}),t.label=5;case 5:return[2]}})})},Du.prototype.ns=function(t){var r=this,e=this.jn.then(function(){return r.Hn=!0,t().catch(function(t){throw r.zn=t,r.Hn=!1,Cr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Hn=!1,t})});return this.jn=e},Du.prototype.Pn=function(t,e,n){var r=this;this.es(),-1<this.Yn.indexOf(t)&&(e=0);var i=ku.Ln(this,t,e,n,function(t){return r.us(t)});return this.Kn.push(i),i},Du.prototype.es=function(){this.zn&&xr()},Du.prototype.cs=function(){},Du.prototype.hs=function(){return w(this,void 0,void 0,function(){var e;return b(this,function(t){switch(t.label){case 0:return[4,e=this.jn];case 1:t.sent(),t.label=2;case 2:if(e!==this.jn)return[3,0];t.label=3;case 3:return[2]}})})},Du.prototype.ls=function(t){for(var e=0,n=this.Kn;e<n.length;e++)if(n[e].fn===t)return!0;return!1},Du.prototype._s=function(r){var i=this;return this.hs().then(function(){i.Kn.sort(function(t,e){return t.On-e.On});for(var t=0,e=i.Kn;t<e.length;t++){var n=e[t];if(n.gn(),"all"!==r&&n.fn===r)break}return i.hs()})},Du.prototype.fs=function(t){this.Yn.push(t)},Du.prototype.us=function(t){var e=this.Kn.indexOf(t);this.Kn.splice(e,1)},Du);function Du(){var e=this;this.jn=Promise.resolve(),this.Wn=[],this.Gn=!1,this.Kn=[],this.zn=null,this.Hn=!1,this.Yn=[],this.Jn=new Tu(this,"async_queue_retry"),this.Xn=function(){var t=Ou();t&&Vr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.Jn.pn()};var t=Ou();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Xn)}function Pu(t,e,n,r,i){this.kn=t,this.fn=e,this.On=n,this.op=r,this.Mn=i,this.qn=new Iu,this.then=this.qn.promise.then.bind(this.qn.promise),this.qn.promise.catch(function(t){})}function _u(t,e){if(Cr("AsyncQueue",e+": "+t),Su(t))return new Lr(kr.UNAVAILABLE,e+": "+t);throw t}function Uu(){this.ws=new Ui(Ga,Fa),this.onlineState="Unknown",this.Ts=new Set}var Vu=function(){this.ds=void 0,this.listeners=[]};function Cu(u,h){return w(this,void 0,void 0,function(){var e,n,r,i,o,s,a;return b(this,function(t){switch(t.label){case 0:if(e=u,n=h.query,r=!1,(i=e.ws.get(n))||(r=!0,i=new Vu),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Es(n)];case 2:return o.ds=t.sent(),[3,4];case 3:return s=t.sent(),a=_u(s,"Initialization of query '"+za(h.query)+"' failed"),[2,void h.onError(a)];case 4:return e.ws.set(n,i),i.listeners.push(h),h.Is(e.onlineState),i.ds&&h.As(i.ds)&&ju(e),[2]}})})}function Mu(s,a){return w(this,void 0,void 0,function(){var e,n,r,i,o;return b(this,function(t){return e=s,n=a.query,r=!1,(i=e.ws.get(n))&&0<=(o=i.listeners.indexOf(a))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.ws.delete(n),e.Rs(n))]:[2]})})}function ju(t){t.Ts.forEach(function(t){t.next()})}var xu=(Gu.prototype.As=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new No(t.query,t.docs,t.Ut,e,t.Qt,t.fromCache,t.jt,!0)}var o=!1;return this.Ps?this.gs(t)&&(this.ys.next(t),o=!0):this.Vs(t,this.onlineState)&&(this.vs(t),o=!0),this.ps=t,o},Gu.prototype.onError=function(t){this.ys.error(t)},Gu.prototype.Is=function(t){this.onlineState=t;var e=!1;return this.ps&&!this.Ps&&this.Vs(this.ps,t)&&(this.vs(this.ps),e=!0),e},Gu.prototype.Vs=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.bs&&n||t.docs.m()&&"Offline"!==e)},Gu.prototype.gs=function(t){if(0<t.docChanges.length)return!0;var e=this.ps&&this.ps.hasPendingWrites!==t.hasPendingWrites;return!(!t.jt&&!e)&&!0===this.options.includeMetadataChanges},Gu.prototype.vs=function(t){t=No.Gt(t.query,t.docs,t.Qt,t.fromCache),this.Ps=!0,this.ys.next(t)},Gu),qu=(Fu.prototype.Ss=function(){return null!=this.uid},Fu.prototype.Cs=function(){return this.Ss()?"uid:"+this.uid:"anonymous-user"},Fu.prototype.isEqual=function(t){return t.uid===this.uid},Fu);function Fu(t){this.uid=t}function Gu(t,e,n){this.query=t,this.ys=e,this.Ps=!1,this.ps=null,this.onlineState="Unknown",this.options=n||{}}qu.UNAUTHENTICATED=new qu(null),qu.Ds=new qu("google-credentials-uid"),qu.Fs=new qu("first-party-uid");var zu=(Bu.prototype.Ns=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Bu.prototype.next=function(){var t=++this.previousValue;return this.xs&&this.xs(t),t},Bu);function Bu(t,e){var n=this;this.previousValue=t,e&&(e.$s=function(t){return n.Ns(t)},this.xs=function(t){return e.ks(t)})}zu.Os=-1;var Qu=(ih.prototype.Ms=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},ih.prototype.qs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},ih.prototype.Ls=function(){var t={activeTargetIds:this.activeTargetIds.A(),updateTimeMs:Date.now()};return JSON.stringify(t)},ih),Wu=(rh.prototype.js=function(t){},rh.prototype.Ws=function(t,e,n){},rh.prototype.Gs=function(t){return this.Bs.Ms(t),this.Us[t]||"not-current"},rh.prototype.Ks=function(t,e,n){this.Us[t]=e},rh.prototype.zs=function(t){this.Bs.qs(t)},rh.prototype.Hs=function(t){return this.Bs.activeTargetIds.has(t)},rh.prototype.Ys=function(t){delete this.Us[t]},rh.prototype.Js=function(){return this.Bs.activeTargetIds},rh.prototype.Xs=function(t){return this.Bs.activeTargetIds.has(t)},rh.prototype.start=function(){return this.Bs=new Qu,Promise.resolve()},rh.prototype.Zs=function(t,e,n){},rh.prototype.ti=function(t){},rh.prototype.ei=function(){},rh.prototype.ks=function(t){},rh),Hu=(nh.prototype.si=function(t,e,n){for(var r,i,o,s=n.ii,a=0;a<this.mutations.length;a++){var u=this.mutations[a];u.key.isEqual(t)&&(r=u,i=e,o=s[a],e=r instanceof $s?new Ia(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof ta?function(t,e,n){if(!Ws(t.Ge,e))return new Aa(t.key,n.version);var r=ra(t,e);return new Ia(t.key,n.version,r,{hasCommittedMutations:!0})}(r,i,o):r instanceof oa?function(t,e,n){if(qr(null!=n.transformResults),!Ws(t.Ge,e))return new Aa(t.key,n.version);var r=e,i=function(t,e,n){var r=[];qr(t.length===n.length);for(var i,o,s,a=0;a<n.length;a++){var u=t[a],h=u.transform,c=null;e instanceof Ia&&(c=e.field(u.field)),r.push((i=h,o=c,s=n[a],i instanceof Ss?Ls(i,o):i instanceof Ps?Us(i,o):s))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=aa(t,r.data(),i);return new Ia(t.key,o,s,{hasCommittedMutations:!0})}(r,i,o):new Ta(r.key,o.version,{hasCommittedMutations:!0}))}return e},nh.prototype.ri=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Ks(i,e,e,this.ni))}for(var o=e,s=0,a=this.mutations;s<a.length;s++){var u=a[s];u.key.isEqual(t)&&(e=Ks(u,e,o,this.ni))}return e},nh.prototype.oi=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ri(t.key,n.get(t.key));e&&(i=i.rt(t.key,e))}),i},nh.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},mo())},nh.prototype.isEqual=function(t){return this.batchId===t.batchId&&Ti(this.mutations,t.mutations,Ys)&&Ti(this.baseMutations,t.baseMutations,Ys)},nh),Ku=(eh.from=function(t,e,n){qr(t.mutations.length===n.length);for(var r=yo,i=t.mutations,o=0;o<i.length;o++)r=r.rt(i[o].key,n[o].version);return new eh(t,e,n,r)},eh),Yu=(th.prototype._i=function(e,n){var r=this;return this.hi.fi(e,n).next(function(t){return r.di(e,n,t)})},th.prototype.di=function(t,r,i){return this.ai.wi(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ri(r,t);return t})},th.prototype.mi=function(t,e,i){var o=lo;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ri(t,e);o=o.rt(t,e)}),o},th.prototype.Ti=function(e,t){var n=this;return this.ai.getEntries(e,t).next(function(t){return n.Ei(e,t)})},th.prototype.Ei=function(r,i){var o=this;return this.hi.Ii(r,i).next(function(t){var e=o.mi(r,i,t),n=lo;return e.forEach(function(t,e){e=e||new Ta(t,Ci.min()),n=n.rt(t,e)}),n})},th.prototype.Ai=function(t,e,n){return r=e,Xr.$(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Ri(t,e.path):Va(e)?this.yi(t,e,n):this.Pi(t,e,n);var r},th.prototype.Ri=function(t,e){return this._i(t,new Xr(e)).next(function(t){var e=vo;return t instanceof Ia&&(e=e.rt(t.key,t)),e})},th.prototype.yi=function(i,o,s){var a=this,u=o.collectionGroup,h=vo;return this.li.pi(i,u).next(function(t){return Au.forEach(t,function(t){var e,n,r=(e=o,n=t.child(u),new ka(n,null,e.rn.slice(),e.filters.slice(),e.limit,e.on,e.startAt,e.endAt));return a.Pi(i,r,s).next(function(t){t.forEach(function(t,e){h=h.rt(t,e)})})}).next(function(){return h})})},th.prototype.Pi=function(e,n,t){var c,l,r=this;return this.ai.Ai(e,n,t).next(function(t){return c=t,r.hi.gi(e,n)}).next(function(t){return l=t,r.Vi(e,l,c).next(function(t){c=t;for(var e=0,n=l;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],a=s.key,u=c.get(a),h=Ks(s,u,u,r.ni);c=h instanceof Ia?c.rt(a,h):c.remove(a)}})}).next(function(){return c.forEach(function(t,e){Ba(n,e)||(c=c.remove(t))}),c})},th.prototype.Vi=function(t,e,n){for(var r=mo(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof ta&&null===n.get(u.key)&&(r=r.add(u.key))}var h=n;return this.ai.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Ia&&(h=h.rt(t,e))}),h})},th),Xu=($u.Si=function(t,e){for(var n=mo(),r=mo(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new $u(t,e.fromCache,n,r)},$u),Ju=(Zu.$i=function(t){return new Zu(t,Zu.Ni,Zu.xi)},Zu);function Zu(t,e,n){this.Ci=t,this.Di=e,this.Fi=n}function $u(t,e,n,r){this.targetId=t,this.fromCache=e,this.vi=n,this.bi=r}function th(t,e,n){this.ai=t,this.hi=e,this.li=n}function eh(t,e,n,r){this.batch=t,this.ui=e,this.ii=n,this.ci=r}function nh(t,e,n,r){this.batchId=t,this.ni=e,this.baseMutations=n,this.mutations=r}function rh(){this.Bs=new Qu,this.Us={},this.Qs=null,this.$s=null}function ih(){this.activeTargetIds=Io}Ju.ki=-1,Ju.Oi=1048576,Ju.Mi=41943040,Ju.Ni=10,Ju.xi=1e3,Ju.qi=new Ju(Ju.Mi,Ju.Ni,Ju.xi),Ju.Li=new Ju(Ju.ki,0,0);var oh=(fh.prototype.Ui=function(t,e){return this.Bi.add(e),Au.resolve()},fh.prototype.pi=function(t,e){return Au.resolve(this.Bi.getEntries(e))},fh),sh=(lh.prototype.add=function(t){var e=t._(),n=t.h(),r=this.index[e]||new ho(Hr.i),i=!r.has(n);return this.index[e]=r.add(n),i},lh.prototype.has=function(t){var e=t._(),n=t.h(),r=this.index[e];return r&&r.has(n)},lh.prototype.getEntries=function(t){return(this.index[t]||new ho(Hr.i)).A()},lh),ah=(ch.prototype.next=function(){return this.Qi+=2,this.Qi},ch.ji=function(){return new ch(0)},ch.Wi=function(){return new ch(-1)},ch),uh=(hh.prototype.ir=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.rr(t,n.Ki)})},hh);function hh(t,e,n){this.persistence=t,this.Gi=e,this.Ki=new no(Ii),this.zi=new Ui(Wi,Hi),this.Hi=Ci.min(),this.hi=t.Yi(n),this.Ji=t.Xi(),this.Zi=t.tr(),this.er=new Yu(this.Ji,this.hi,this.persistence.nr()),this.Gi.sr(this.er)}function ch(t){this.Qi=t}function lh(){this.index={}}function fh(){this.Bi=new sh}function ph(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Zi._r(t)})}function dh(o,s,a){return w(this,void 0,void 0,function(){var e,n,r,i;return b(this,function(t){switch(t.label){case 0:n=(e=o).Ki.get(s),r=a?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),a?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Ar.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Su(i=t.sent()))throw i;return Vr("LocalStore","Failed to update sequence numbers for target "+s+": "+i),[3,5];case 5:return e.Ki=e.Ki.remove(s),e.zi.delete(n.target),[2]}})})}function vh(t,s,a){var u=t,h=Ci.min(),c=mo();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=Ma(s),(void 0!==(o=(i=t).zi.get(r))?Au.resolve(i.Ki.get(o)):i.Zi.Pr(n,r)).next(function(t){if(t)return h=t.lastLimboFreeSnapshotVersion,u.Zi.pr(e,t.targetId).next(function(t){c=t})}).next(function(){return u.Gi.Ai(e,s,a?h:Ci.min(),a?c:mo())}).next(function(t){return{documents:t,gr:c}});var t,n,r,i,o})}function yh(e){return w(this,void 0,void 0,function(){return b(this,function(t){if(e.code!==kr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Vr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function gh(t,e){this.user=e,this.type="OAuth",this.Br={},this.Br.Authorization="Bearer "+t}var mh,wh,bh,Eh=(Bh.prototype.m=function(){return this.Vr.m()},Bh.prototype.Cr=function(t,e){var n=new Ih(t,e);this.Vr=this.Vr.add(n),this.br=this.br.add(n)},Bh.prototype.Dr=function(t,e){var n=this;t.forEach(function(t){return n.Cr(t,e)})},Bh.prototype.Fr=function(t,e){this.$r(new Ih(t,e))},Bh.prototype.Nr=function(t,e){var n=this;t.forEach(function(t){return n.Fr(t,e)})},Bh.prototype.kr=function(t){var e=this,n=new Xr(new Hr([])),r=new Ih(n,t),i=new Ih(n,t+1),o=[];return this.br.Ft([r,i],function(t){e.$r(t),o.push(t.key)}),o},Bh.prototype.Or=function(){var e=this;this.Vr.forEach(function(t){return e.$r(t)})},Bh.prototype.$r=function(t){this.Vr=this.Vr.delete(t),this.br=this.br.delete(t)},Bh.prototype.Mr=function(t){var e=new Xr(new Hr([])),n=new Ih(e,t),r=new Ih(e,t+1),i=mo();return this.br.Ft([n,r],function(t){i=i.add(t.key)}),i},Bh.prototype.qr=function(t){var e=new Ih(t,0),n=this.Vr.Nt(e);return null!==n&&t.isEqual(n.key)},Bh),Ih=(zh.vr=function(t,e){return Xr.i(t.key,e.key)||Ii(t.Lr,e.Lr)},zh.Sr=function(t,e){return Ii(t.Lr,e.Lr)||Xr.i(t.key,e.key)},zh),Th=(Gh.prototype.getToken=function(){return Promise.resolve(null)},Gh.prototype.Qr=function(){},Gh.prototype.jr=function(t){(this.Ur=t)(qu.UNAUTHENTICATED)},Gh.prototype.Wr=function(){this.Ur=null},Gh),Ah=(Fh.prototype.getToken=function(){var e=this,n=this.zr,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.zr!==n?(Vr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(qr("string"==typeof t.accessToken),new gh(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Fh.prototype.Qr=function(){this.forceRefresh=!0},Fh.prototype.jr=function(t){this.Ur=t,this.Kr&&t(this.currentUser)},Fh.prototype.Wr=function(){this.auth&&this.auth.removeAuthTokenListener(this.Gr),this.Gr=null,this.Ur=null},Fh.prototype.Hr=function(){var t=this.auth&&this.auth.getUid();return qr(null===t||"string"==typeof t),new qu(t)},Fh),Nh=(Object.defineProperty(qh.prototype,"Br",{get:function(){var t={"X-Goog-AuthUser":this.Jr},e=this.Yr.auth.Xr([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),qh),Rh=(xh.prototype.getToken=function(){return Promise.resolve(new Nh(this.Yr,this.Jr))},xh.prototype.jr=function(t){t(qu.Fs)},xh.prototype.Wr=function(){},xh.prototype.Qr=function(){},xh),Sh=(jh.prototype.ro=function(){return 1===this.state||2===this.state||4===this.state},jh.prototype.oo=function(){return 2===this.state},jh.prototype.start=function(){3!==this.state?this.auth():this.uo()},jh.prototype.stop=function(){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return this.ro()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},jh.prototype.co=function(){this.state=0,this.Jn.reset()},jh.prototype.ao=function(){var t=this;this.oo()&&null===this.io&&(this.io=this._n.Pn(this.Zr,6e4,function(){return t.ho()}))},jh.prototype.lo=function(t){this._o(),this.stream.send(t)},jh.prototype.ho=function(){return w(this,void 0,void 0,function(){return b(this,function(t){return this.oo()?[2,this.close(0)]:[2]})})},jh.prototype._o=function(){this.io&&(this.io.cancel(),this.io=null)},jh.prototype.close=function(e,n){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return this._o(),this.Jn.cancel(),this.so++,3!==e?this.Jn.reset():n&&n.code===kr.RESOURCE_EXHAUSTED?(Cr(n.toString()),Cr("Using maximum backoff delay to prevent overloading the backend."),this.Jn.An()):n&&n.code===kr.UNAUTHENTICATED&&this.no.Qr(),null!==this.stream&&(this.fo(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.do(n)];case 1:return t.sent(),[2]}})})},jh.prototype.fo=function(){},jh.prototype.auth=function(){var n=this;this.state=1;var t=this.wo(this.so),e=this.so;this.no.getToken().then(function(t){n.so===e&&n.mo(t)},function(e){t(function(){var t=new Lr(kr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.To(t)})})},jh.prototype.mo=function(t){var e=this,n=this.wo(this.so);this.stream=this.Eo(t),this.stream.Io(function(){n(function(){return e.state=2,e.listener.Io()})}),this.stream.do(function(t){n(function(){return e.To(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},jh.prototype.uo=function(){var t=this;this.state=4,this.Jn.Rn(function(){return w(t,void 0,void 0,function(){return b(this,function(t){return this.state=0,this.start(),[2]})})})},jh.prototype.To=function(t){return Vr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},jh.prototype.wo=function(e){var n=this;return function(t){n._n.Qn(function(){return n.so===e?t():(Vr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},jh),Oh=(o(Mh,bh=Sh),Mh.prototype.Eo=function(t){return this.eo.Ao("Listen",t)},Mh.prototype.onMessage=function(t){this.Jn.reset();var e=function(t,e){var n,r,i,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:xr(),a=e.targetChange.targetIds||[],u=(i=e.targetChange.resumeToken,t.Ue?(qr(void 0===i||"string"==typeof i),Ai.fromBase64String(i||"")):(qr(void 0===i||i instanceof Uint8Array),Ai.fromUint8Array(i||new Uint8Array))),h=e.targetChange.cause,c=h&&(r=void 0===(n=h).code?kr.UNKNOWN:eo(n.code),new Lr(r,n.message||"")),l=new Eo(s,a,u,c||null)}else if("documentChange"in e){e.documentChange;var f=e.documentChange;f.document,f.document.name,f.document.updateTime;var p=ds(t,f.document.name),d=ls(f.document.updateTime),v=new fa({mapValue:{fields:f.document.fields}}),y=new Ia(p,d,v,{}),g=f.targetIds||[],m=f.removedTargetIds||[],l=new wo(g,m,y.key,y)}else if("documentDelete"in e){e.documentDelete;var w=e.documentDelete;w.document;var b=ds(t,w.document),E=w.readTime?ls(w.readTime):Ci.min(),I=new Ta(b,E),T=w.removedTargetIds||[];l=new wo([],T,I.key,I)}else if("documentRemove"in e){e.documentRemove;var A=e.documentRemove;A.document;var N=ds(t,A.document),R=A.removedTargetIds||[];l=new wo([],R,N,null)}else{if(!("filter"in e))return xr();e.filter;var S=e.filter;S.targetId;var O=new Yi(S.count||0),k=S.targetId;l=new bo(k,O)}return l}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Ci.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Ci.min():ls(e.readTime)}(t);return this.listener.Ro(e,n)},Mh.prototype.yo=function(t){var e,n,r,i,o={};o.database=ys(this.serializer),o.addTarget=(e=this.serializer,(r=Ki(i=(n=t).target)?{documents:{documents:[vs(e,i.path)]}}:{query:function(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=vs(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=vs(t,r.h()),n.structuredQuery.from=[{collectionId:r._()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){if("=="===t.op){if(es(t.value))return{unaryFilter:{field:bs(t.field),op:"IS_NAN"}};if(ts(t.value))return{unaryFilter:{field:bs(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(es(t.value))return{unaryFilter:{field:bs(t.field),op:"IS_NOT_NAN"}};if(ts(t.value))return{unaryFilter:{field:bs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:bs(t.field),op:(e=t.op,is[e]),value:t.value}};var e});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:bs((e=t).field),direction:(n=e.dir,rs[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,a=(s=e.limit,t.Ue||Gi(s)?s:{value:s});return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=ws(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ws(e.endAt)),n}(e,i)}).targetId=n.targetId,0<n.resumeToken.M()&&(r.resumeToken=cs(e,n.resumeToken)),r);var s,a,u=(this.serializer,s=t,null==(a=function(){switch(s.tt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return xr()}}())?null:{"goog-listen-tags":a});u&&(o.labels=u),this.lo(o)},Mh.prototype.Po=function(t){var e={};e.database=ys(this.serializer),e.removeTarget=t,this.lo(e)},Mh),kh=(o(Ch,wh=Sh),Object.defineProperty(Ch.prototype,"Vo",{get:function(){return this.po},enumerable:!1,configurable:!0}),Ch.prototype.start=function(){this.po=!1,this.lastStreamToken=void 0,wh.prototype.start.call(this)},Ch.prototype.fo=function(){this.po&&this.vo([])},Ch.prototype.Eo=function(t){return this.eo.Ao("Write",t)},Ch.prototype.onMessage=function(t){if(qr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.po){this.Jn.reset();var e=(r=t.writeResults,i=t.commitTime,r&&0<r.length?(qr(void 0!==i),r.map(function(t){return function(t,e){var n=t.updateTime?ls(t.updateTime):ls(e);n.isEqual(Ci.min())&&(n=ls(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new zs(n,r)}(t,i)})):[]),n=ls(t.commitTime);return this.listener.bo(n,e)}var r,i;return qr(!t.writeResults||0===t.writeResults.length),this.po=!0,this.listener.So()},Ch.prototype.Co=function(){var t={};t.database=ys(this.serializer),this.lo(t)},Ch.prototype.vo=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return ms(e.serializer,t)})};this.lo(n)},Ch),Lh=(o(Vh,mh=function(){}),Vh.prototype.Fo=function(){if(this.Do)throw new Lr(kr.FAILED_PRECONDITION,"The client has already been terminated.")},Vh.prototype.$o=function(e,n,r){var i=this;return this.Fo(),this.credentials.getToken().then(function(t){return i.eo.$o(e,n,r,t)}).catch(function(t){throw t.code===kr.UNAUTHENTICATED&&i.credentials.Qr(),t})},Vh.prototype.No=function(e,n,r){var i=this;return this.Fo(),this.credentials.getToken().then(function(t){return i.eo.No(e,n,r,t)}).catch(function(t){throw t.code===kr.UNAUTHENTICATED&&i.credentials.Qr(),t})},Vh.prototype.terminate=function(){this.Do=!1},Vh),Dh=(Uh.prototype.Mo=function(){var t=this;0===this.xo&&(this.qo("Unknown"),this.ko=this.kn.Pn("online_state_timeout",1e4,function(){return t.ko=null,t.Lo("Backend didn't respond within 10 seconds."),t.qo("Offline"),Promise.resolve()}))},Uh.prototype.Bo=function(t){"Online"===this.state?this.qo("Unknown"):(this.xo++,1<=this.xo&&(this.Uo(),this.Lo("Connection failed 1 times. Most recent error: "+t.toString()),this.qo("Offline")))},Uh.prototype.set=function(t){this.Uo(),this.xo=0,"Online"===t&&(this.Oo=!1),this.qo(t)},Uh.prototype.qo=function(t){t!==this.state&&(this.state=t,this.Qs(t))},Uh.prototype.Lo=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Oo?(Cr(e),this.Oo=!1):Vr("OnlineStateTracker",e)},Uh.prototype.Uo=function(){null!==this.ko&&(this.ko.cancel(),this.ko=null)},Uh),Ph=(_h.prototype.start=function(){return Qh(this)},_h);function _h(t,e,n,r,i){var o,s,a,u,h,c,l,f,p=this;this.Qo=t,this.jo=e,this.kn=n,this.Wo=[],this.Go=new Map,this.Ko=null,this.zo=new Set,this.Ho={},this.Yo=i,this.Yo.Jo(function(t){n.Qn(function(){return w(p,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return ec(this)?(Vr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return w(this,void 0,void 0,function(){var e;return b(this,function(t){switch(t.label){case 0:return(e=n).zo.add(4),[4,Hh(e)];case 1:return t.sent(),e.Xo.co(),e.Zo.co(),e.tu.set("Unknown"),e.zo.delete(4),[4,Wh(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.tu=new Dh(n,r),this.Zo=(h=this.jo,c=n,l={Io:function(n){return w(this,void 0,void 0,function(){return b(this,function(t){return n.Go.forEach(function(t,e){Jh(n,t)}),[2]})})}.bind(null,this),do:function(e,n){return w(this,void 0,void 0,function(){return b(this,function(t){return nc(e),tc(e)?(e.tu.Bo(n),$h(e)):e.tu.set("Unknown"),[2]})})}.bind(null,this),Ro:function(a,u,h){return w(this,void 0,void 0,function(){var n,o,s;return b(this,function(t){switch(t.label){case 0:if(a.tu.set("Online"),!(u instanceof Eo&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return w(this,void 0,void 0,function(){var e,n,r,i;return b(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Go.has(i)?[4,o.Ho.eu(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Go.delete(i),o.Ko.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(a,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Vr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,rc(a,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof wo?a.Ko.Ve(u):u instanceof bo?a.Ko.Ne(u):a.Ko.Se(u),h.isEqual(Ci.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,ph(a.Qo)];case 8:return o=t.sent(),0<=h.q(o)?[4,(i=h,(e=(r=a).Ko.Oe(i)).Kt.forEach(function(t,e){var n;0<t.resumeToken.M()&&(n=r.Go.get(e))&&r.Go.set(e,n.st(t.resumeToken,i))}),e.zt.forEach(function(t){var e,n=r.Go.get(t);n&&(r.Go.set(t,n.st(Ai.L,n.et)),Zh(r,t),e=new Zi(n.target,t,1,n.sequenceNumber),Jh(r,e))}),r.Ho.nu(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Vr("RemoteStore","Failed to raise snapshot:",s=t.sent()),[4,rc(a,s)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,this)},(f=h).Fo(),new Oh(c,f.eo,f.credentials,f.serializer,l)),this.Xo=(o=this.jo,s=n,a={Io:function(e){return w(this,void 0,void 0,function(){return b(this,function(t){return e.Xo.Co(),[2]})})}.bind(null,this),do:function(e,n){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return n&&e.Xo.Vo?[4,function(r,i){return w(this,void 0,void 0,function(){var e,n;return b(this,function(t){switch(t.label){case 0:return to(n=i.code)&&n!==kr.ABORTED?(e=r.Wo.shift(),r.Xo.co(),[4,ic(r,function(){return r.Ho.iu(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,oc(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return sc(e)&&ac(e),[2]}})})}.bind(null,this),So:function(i){return w(this,void 0,void 0,function(){var e,n,r;return b(this,function(t){for(e=0,n=i.Wo;e<n.length;e++)r=n[e],i.Xo.vo(r.mutations);return[2]})})}.bind(null,this),bo:function(r,i,o){return w(this,void 0,void 0,function(){var e,n;return b(this,function(t){switch(t.label){case 0:return e=r.Wo.shift(),n=Ku.from(e,i,o),[4,ic(r,function(){return r.Ho.su(n)})];case 1:return t.sent(),[4,oc(r)];case 2:return t.sent(),[2]}})})}.bind(null,this)},(u=o).Fo(),new kh(s,u.eo,u.credentials,u.serializer,a))}function Uh(t,e){this.kn=t,this.Qs=e,this.state="Unknown",this.xo=0,this.ko=null,this.Oo=!0}function Vh(t,e,n){var r=this;return(r=mh.call(this)||this).credentials=t,r.eo=e,r.serializer=n,r.Do=!1,r}function Ch(t,e,n,r,i){var o=this;return(o=wh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.po=!1,o}function Mh(t,e,n,r,i){var o=this;return(o=bh.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function jh(t,e,n,r,i,o){this._n=t,this.Zr=n,this.eo=r,this.no=i,this.listener=o,this.state=0,this.so=0,this.io=null,this.stream=null,this.Jn=new Tu(t,e)}function xh(t,e){this.Yr=t,this.Jr=e}function qh(t,e){this.Yr=t,this.Jr=e,this.type="FirstParty",this.user=qu.Fs}function Fh(t){var e=this;this.Gr=null,this.currentUser=qu.UNAUTHENTICATED,this.Kr=!1,this.zr=0,this.Ur=null,this.forceRefresh=!1,this.Gr=function(){e.zr++,e.currentUser=e.Hr(),e.Kr=!0,e.Ur&&e.Ur(e.currentUser)},this.zr=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Gr):(this.Gr(null),t.get().then(function(t){e.auth=t,e.Gr&&e.auth.addAuthTokenListener(e.Gr)},function(){}))}function Gh(){this.Ur=null}function zh(t,e){this.key=t,this.Lr=e}function Bh(){this.Vr=new ho(Ih.vr),this.br=new ho(Ih.Sr)}function Qh(t){var e=t;return e.zo.delete(0),Wh(e)}function Wh(e){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return ec(e)?(tc(e)?$h(e):e.tu.set("Unknown"),[4,oc(e)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}function Hh(e){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return[4,e.Xo.stop()];case 1:return t.sent(),[4,e.Zo.stop()];case 2:return t.sent(),0<e.Wo.length&&(Vr("RemoteStore","Stopping write stream with "+e.Wo.length+" pending writes"),e.Wo=[]),nc(e),[2]}})})}function Kh(n){return w(this,void 0,void 0,function(){var e;return b(this,function(t){switch(t.label){case 0:return e=n,Vr("RemoteStore","RemoteStore shutting down."),e.zo.add(5),[4,Hh(e)];case 1:return t.sent(),e.Yo.ei(),e.tu.set("Unknown"),[2]}})})}function Yh(t,e){var n=t;n.Go.has(e.targetId)||(n.Go.set(e.targetId,e),tc(n)?$h(n):n.Zo.oo()&&Jh(n,e))}function Xh(t,e){var n=t;n.Go.delete(e),n.Zo.oo()&&Zh(n,e),0===n.Go.size&&(n.Zo.oo()?n.Zo.ao():ec(n)&&n.tu.set("Unknown"))}function Jh(t,e){t.Ko.Ee(e.targetId),t.Zo.yo(e)}function Zh(t,e){t.Ko.Ee(e),t.Zo.Po(e)}function $h(e){e.Ko=new ko({Le:function(t){return e.Ho.Le(t)},Be:function(t){return e.Go.get(t)||null}}),e.Zo.start(),e.tu.Mo()}function tc(t){return ec(t)&&!t.Zo.ro()&&0<t.Go.size}function ec(t){return 0===t.zo.size}function nc(t){t.Ko=null}function rc(n,r,i){return w(this,void 0,void 0,function(){var e=this;return b(this,function(t){switch(t.label){case 0:if(!Su(r))throw r;return n.zo.add(1),[4,Hh(n)];case 1:return t.sent(),n.tu.set("Offline"),i=i||function(){return ph(n.Qo)},n.kn.rs(function(){return w(e,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return Vr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.zo.delete(1),[4,Wh(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function ic(e,n){return n().catch(function(t){return rc(e,t,n)})}function oc(c){return w(this,void 0,void 0,function(){var s,a,u,h;return b(this,function(t){switch(t.label){case 0:a=0<(s=c).Wo.length?s.Wo[s.Wo.length-1].batchId:-1,t.label=1;case 1:if(!(ec(s)&&s.Wo.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(r=s.Qo,i=a,(o=r).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===i&&(i=-1),o.hi.yr(t,i)}))];case 3:return null===(u=t.sent())?(0===s.Wo.length&&s.Xo.ao(),[3,7]):(a=u.batchId,n=u,(e=s).Wo.push(n),e.Xo.oo()&&e.Xo.Vo&&e.Xo.vo(n.mutations),[3,6]);case 4:return h=t.sent(),[4,rc(s,h)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return sc(s)&&ac(s),[2]}var e,n,r,i,o})})}function sc(t){return ec(t)&&!t.Xo.ro()&&0<t.Wo.length}function ac(t){t.Xo.start()}function uc(t,e,n){this.query=t,this.targetId=e,this.view=n}var hc=function(t){this.key=t},cc=function(t){this.key=t},lc=(Object.defineProperty(vc.prototype,"hu",{get:function(){return this.ru},enumerable:!1,configurable:!0}),vc.prototype.lu=function(t,e){var a=this,u=e?e._u:new Ao,h=e?e.au:this.au,c=e?e.Qt:this.Qt,l=h,f=!1,p=Da(this.query)&&h.size===this.query.limit?h.last():null,d=Pa(this.query)&&h.size===this.query.limit?h.first():null;if(t.at(function(t,e){var n=h.get(t),r=(r=e instanceof Ia?e:null)&&(Ba(a.query,r)?r:null),i=!!n&&a.Qt.has(n.key),o=!!r&&(r.Ye||a.Qt.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),s=!0):a.fu(n,r)||(u.track({type:2,doc:r}),s=!0,(p&&0<a.cu(r,p)||d&&a.cu(r,d)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),s=!0):n&&!r&&(u.track({type:1,doc:n}),s=!0,(p||d)&&(f=!0)),s&&(c=r?(l=l.add(r),o?c.add(t):c.delete(t)):(l=l.delete(t),c.delete(t)))}),Da(this.query)||Pa(this.query))for(;l.size>this.query.limit;){var n=Da(this.query)?l.last():l.first(),l=l.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{au:l,_u:u,du:f,Qt:c}},vc.prototype.fu=function(t,e){return t.Ye&&e.hasCommittedMutations&&!e.Ye},vc.prototype.wu=function(t,e,n){var o=this,r=this.au;this.au=t.au,this.Qt=t.Qt;var i=t._u.Bt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.cu(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return xr()}}var r,i}),this.mu(n);var s=e?this.Tu():[],a=0===this.uu.size&&this.Zt?1:0,u=a!==this.ou;return this.ou=a,0!==i.length||u?{snapshot:new No(this.query,t.au,r,i,t.Qt,0==a,u,!1),Eu:s}:{Eu:s}},vc.prototype.Is=function(t){return this.Zt&&"Offline"===t?(this.Zt=!1,this.wu({au:this.au,_u:new Ao,Qt:this.Qt,du:!1},!1)):{Eu:[]}},vc.prototype.Iu=function(t){return!this.ru.has(t)&&!!this.au.has(t)&&!this.au.get(t).Ye},vc.prototype.mu=function(t){var e=this;t&&(t.te.forEach(function(t){return e.ru=e.ru.add(t)}),t.ee.forEach(function(t){}),t.ne.forEach(function(t){return e.ru=e.ru.delete(t)}),this.Zt=t.Zt)},vc.prototype.Tu=function(){var e=this;if(!this.Zt)return[];var n=this.uu;this.uu=mo(),this.au.forEach(function(t){e.Iu(t.key)&&(e.uu=e.uu.add(t.key))});var r=[];return n.forEach(function(t){e.uu.has(t)||r.push(new cc(t))}),this.uu.forEach(function(t){n.has(t)||r.push(new hc(t))}),r},vc.prototype.Au=function(t){this.ru=t.gr,this.uu=mo();var e=this.lu(t.documents);return this.wu(e,!0)},vc.prototype.Ru=function(){return No.Gt(this.query,this.au,this.Qt,0===this.ou)},vc),fc=function(t){this.key=t,this.yu=!1},pc=(Object.defineProperty(dc.prototype,"Ou",{get:function(){return!0===this.ku},enumerable:!1,configurable:!0}),dc.prototype.subscribe=function(t){this.Vu=t},dc.prototype.Mu=function(t){},dc);function dc(t,e,n,r,i){this.Qo=t,this.Pu=e,this.pu=n,this.currentUser=r,this.gu=i,this.Vu=null,this.vu=new Ui(Ga,Fa),this.bu=new Map,this.Su=[],this.Cu=new no(Xr.i),this.Du=new Map,this.Fu=new Eh,this.$u={},this.Nu=new Map,this.xu=ah.Wi(),this.onlineState="Unknown",this.ku=void 0}function vc(t,e){this.query=t,this.ru=e,this.ou=null,this.Zt=!1,this.uu=mo(),this.Qt=mo(),this.cu=Qa(t),this.au=new To(this.cu)}function yc(y,g,m){return w(this,void 0,void 0,function(){var u,p,d,v;return b(this,function(t){switch(t.label){case 0:(a=y).Pu.Ho.su=function(o,s){return w(this,void 0,void 0,function(){var n,r,i;return b(this,function(t){switch(t.label){case 0:(n=o).Mu("applySuccessfulWrite()"),r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Qo,c=s,(l=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var i,e=c.batch.keys(),n=l.Ji.ur({cr:!0}),r=l,o=t,s=n,a=(i=c).batch,u=a.keys(),h=Au.resolve();return u.forEach(function(r){h=h.next(function(){return s.wi(o,r)}).next(function(t){var e=t,n=i.ci.get(r);qr(null!==n),(!e||e.version.q(n)<0)&&(e=a.si(r,e,i))&&s.ar(e,i.ui)})}),h.next(function(){return r.hi.hr(o,a)}).next(function(){return n.apply(t)}).next(function(){return l.hi.lr(t)}).next(function(){return l.er.Ti(t,e)})}))];case 2:return i=t.sent(),bc(n,r,null),wc(n,r),n.pu.Ws(r,"acknowledged"),[4,Nc(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,yh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,c,l})})}.bind(null,a),a.Pu.Ho.iu=function(s,a,u){return w(this,void 0,void 0,function(){var n,o;return b(this,function(t){switch(t.label){case 0:(n=s).Mu("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Qo,r=a,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.hi.Wu(e,r).next(function(t){return qr(null!==t),n=t.keys(),i.hi.hr(e,t)}).next(function(){return i.hi.lr(e)}).next(function(){return i.er.Ti(e,n)})}))];case 2:return o=t.sent(),bc(n,a,u),wc(n,a),n.pu.Ws(a,"rejected",u),[4,Nc(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,yh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,a),(u=a).Mu("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(o=u.Qo,h=g,l=o,f=Vi.now(),s=h.reduce(function(t,e){return t.add(e.key)},mo()),l.persistence.runTransaction("Locally write mutations","readwrite",function(u){return l.er.Ti(u,s).next(function(t){c=t;for(var a,e,n=[],r=0,i=h;r<i.length;r++){var o=i[r],s=(a=o,e=c.get(o.key),a instanceof oa?function(t){for(var e=null,n=0,r=a.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Ia?t.field(i.field):void 0,s=Ts(i.transform,o||null);null!=s&&(e=null==e?(new pa).set(i.field,s):e.set(i.field,s))}return e?e.Je():null}(e):null);null!=s&&n.push(new ta(o.key,s,function a(t){var u=[];return Gr(t.fields||{},function(t,e){var n=new Yr([t]);if(ns(e)){var r=a(e.mapValue).fields;if(0===r.length)u.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];u.push(n.child(s))}}else u.push(n)}),new Fs(u)}(s.proto.mapValue),Bs.exists(!0)))}return l.hi.Uu(u,f,n,h)})}).then(function(t){var e=t.oi(c);return{batchId:t.batchId,Qu:e}}))];case 2:return p=t.sent(),u.pu.js(p.batchId),e=u,n=p.batchId,r=m,i=(i=(i=e.$u[e.currentUser.Cs()])||new no(Ii)).rt(n,r),e.$u[e.currentUser.Cs()]=i,[4,Nc(u,p.Qu)];case 3:return t.sent(),[4,oc(u.Pu)];case 4:return t.sent(),[3,6];case 5:return d=t.sent(),v=_u(d,"Failed to persist write"),m.reject(v),[3,6];case 6:return[2]}var e,n,r,i,o,h,c,l,f,s,a})})}function gc(i,o){return w(this,void 0,void 0,function(){var r,n;return b(this,function(t){switch(t.label){case 0:(r=i).Mu("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=r.Qo,c=e,l=(s=o).et,f=c.Ki,c.persistence.runTransaction("Apply remote event","readwrite-primary",function(u){var i=c.Ji.ur({cr:!0});f=c.Ki;var h=[];s.Kt.forEach(function(t,e){var n,r,i,o,s,a=f.get(e);a&&(h.push(c.Zi.dr(u,t.ne,e).next(function(){return c.Zi.wr(u,t.te,e)})),0<(n=t.resumeToken).M()&&(r=a.st(n,l).nt(u.mr),f=f.rt(e,r),i=a,s=t,qr(0<(o=r).resumeToken.M()),(0===i.resumeToken.M()||3e8<=o.et.J()-i.et.J()||0<s.te.size+s.ee.size+s.ne.size)&&h.push(c.Zi.Tr(u,r))))});var t,o=lo,n=mo();return s.Ht.forEach(function(t,e){n=n.add(t)}),h.push(i.getEntries(u,n).next(function(r){s.Ht.forEach(function(t,e){var n=r.get(t);e instanceof Ta&&e.version.isEqual(Ci.min())?(i.Er(t,l),o=o.rt(t,e)):null==n||0<e.version.q(n.version)||0===e.version.q(n.version)&&n.hasPendingWrites?(i.ar(e,l),o=o.rt(t,e)):Vr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),s.Yt.has(t)&&h.push(c.persistence.Ar.Ir(u,t))})})),l.isEqual(Ci.min())||(t=c.Zi._r(u).next(function(t){return c.Zi.Rr(u,u.mr,l)}),h.push(t)),Au.Nn(h).next(function(){return i.apply(u)}).next(function(){return c.er.Ei(u,o)})}).then(function(t){return c.Ki=f,t}))];case 2:return n=t.sent(),o.Kt.forEach(function(t,e){var n=r.Du.get(e);n&&(qr(t.te.size+t.ee.size+t.ne.size<=1),0<t.te.size?n.yu=!0:0<t.ee.size?qr(n.yu):0<t.ne.size&&(qr(n.yu),n.yu=!1))}),[4,Nc(r,n,o)];case 3:return t.sent(),[3,6];case 4:return[4,yh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,s,c,l,f})})}function mc(t,r,e){var i,n=t;(n.Ou&&0===e||!n.Ou&&1===e)&&(n.Mu("applyOnlineStateChange()"),i=[],n.vu.forEach(function(t,e){var n=e.view.Is(r);n.snapshot&&i.push(n.snapshot)}),n.Vu.ju(r),n.Vu.Ro(i),n.onlineState=r,n.Ou&&n.pu.ti(r))}function wc(t,e){(t.Nu.get(e)||[]).forEach(function(t){t.resolve()}),t.Nu.delete(e)}function bc(t,e,n){var r,i=t,o=i.$u[i.currentUser.Cs()];o&&((r=o.get(e))&&(n?r.reject(n):r.resolve(),o=o.remove(e)),i.$u[i.currentUser.Cs()]=o)}function Ec(e,t,n){void 0===n&&(n=null),e.pu.zs(t);for(var r=0,i=e.bu.get(t);r<i.length;r++){var o=i[r];e.vu.delete(o),n&&e.Vu.Ku(o,n)}e.bu.delete(t),e.Ou&&e.Fu.kr(t).forEach(function(t){e.Fu.qr(t)||Ic(e,t)})}function Ic(t,e){var n=t.Cu.get(e);null!==n&&(Xh(t.Pu,n),t.Cu=t.Cu.remove(e),t.Du.delete(n),Ac(t))}function Tc(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var a=s[o];a instanceof hc?(t.Fu.Cr(a.key,e),r=t,i=a.key,r.Cu.get(i)||(Vr("SyncEngine","New document in limbo: "+i),r.Su.push(i),Ac(r))):a instanceof cc?(Vr("SyncEngine","Document no longer in limbo: "+a.key),t.Fu.Fr(a.key,e),t.Fu.qr(a.key)||Ic(t,a.key)):xr()}}function Ac(t){for(;0<t.Su.length&&t.Cu.size<t.gu;){var e=t.Su.shift(),n=t.xu.next();t.Du.set(n,new fc(e)),t.Cu=t.Cu.rt(e,n),Yh(t.Pu,new Zi(Ma(La(e.path)),n,2,zu.Os))}}function Nc(n,s,a){return w(this,void 0,void 0,function(){var r,i,o,e;return b(this,function(t){switch(t.label){case 0:return i=[],o=[],e=[],(r=n).vu.forEach(function(t,n){e.push(r.Bu(n,s,a).then(function(t){var e;t&&(r.Ou&&r.pu.Ks(n.targetId,t.fromCache?"not-current":"current"),i.push(t),e=Xu.Si(n.targetId,t),o.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),r.Vu.Ro(i),[4,function(c,l){return w(this,void 0,void 0,function(){var r,e,n,i,o,s,a,u,h;return b(this,function(t){switch(t.label){case 0:r=c,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Au.forEach(l,function(e){return Au.forEach(e.vi,function(t){return r.persistence.Ar.Cr(n,e.targetId,t)}).next(function(){return Au.forEach(e.bi,function(t){return r.persistence.Ar.Fr(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Su(e=t.sent()))throw e;return Vr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=l;n<i.length;n++)o=i[n],s=o.targetId,o.fromCache||(a=r.Ki.get(s),u=a.et,h=a.it(u),r.Ki=r.Ki.rt(s,h));return[2]}})})}(r.Qo,o)];case 2:return t.sent(),[2]}})})}var Rc,Sc=(Pc.prototype.sr=function(t){this.Xu=t},Pc.prototype.Ai=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.rn.length||1===r.rn.length&&r.rn[0].field.V())||i.isEqual(Ci.min())?this.Zu(e,r):this.Xu.Ti(e,o).next(function(t){var n=s.tc(r,t);return(Da(r)||Pa(r))&&s.du(r.on,n,o,i)?s.Zu(e,r):(Ur()<=a.DEBUG&&Vr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),za(r)),s.Xu.Ai(e,r,i).next(function(e){return n.forEach(function(t){e=e.rt(t.key,t)}),e}))})},Pc.prototype.tc=function(n,t){var r=new ho(Qa(n));return t.forEach(function(t,e){e instanceof Ia&&Ba(n,e)&&(r=r.add(e))}),r},Pc.prototype.du=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.q(r))},Pc.prototype.Zu=function(t,e){return Ur()<=a.DEBUG&&Vr("IndexFreeQueryEngine","Using full collection scan to execute query:",za(e)),this.Xu.Ai(t,e,Ci.min())},Pc),Oc=(Dc.prototype.sc=function(t){return Au.resolve(0===this.hi.length)},Dc.prototype.Uu=function(t,e,n,r){var i=this.ec;this.ec++,0<this.hi.length&&this.hi[this.hi.length-1];var o=new Hu(i,e,n,r);this.hi.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.nc=this.nc.add(new Ih(u.key,i)),this.li.Ui(t,u.key.path.h())}return Au.resolve(o)},Dc.prototype.Wu=function(t,e){return Au.resolve(this.ic(e))},Dc.prototype.yr=function(t,e){var n=e+1,r=this.rc(n),i=r<0?0:r;return Au.resolve(this.hi.length>i?this.hi[i]:null)},Dc.prototype.Gu=function(){return Au.resolve(0===this.hi.length?-1:this.ec-1)},Dc.prototype.zu=function(t){return Au.resolve(this.hi.slice())},Dc.prototype.fi=function(t,e){var n=this,r=new Ih(e,0),i=new Ih(e,Number.POSITIVE_INFINITY),o=[];return this.nc.Ft([r,i],function(t){var e=n.ic(t.Lr);o.push(e)}),Au.resolve(o)},Dc.prototype.Ii=function(t,e){var r=this,i=new ho(Ii);return e.forEach(function(t){var e=new Ih(t,0),n=new Ih(t,Number.POSITIVE_INFINITY);r.nc.Ft([e,n],function(t){i=i.add(t.Lr)})}),Au.resolve(this.oc(i))},Dc.prototype.gi=function(t,e){var n=e.path,r=n.length+1,i=n;Xr.$(i)||(i=i.child(""));var o=new Ih(new Xr(i),0),s=new ho(Ii);return this.nc.$t(function(t){var e=t.key.path;return!!n.T(e)&&(e.length===r&&(s=s.add(t.Lr)),!0)},o),Au.resolve(this.oc(s))},Dc.prototype.oc=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.ic(t);null!==e&&r.push(e)}),r},Dc.prototype.hr=function(n,r){var i=this;qr(0===this.uc(r.batchId,"removed")),this.hi.shift();var o=this.nc;return Au.forEach(r.mutations,function(t){var e=new Ih(t.key,r.batchId);return o=o.delete(e),i.Ar.cc(n,t.key)}).next(function(){i.nc=o})},Dc.prototype.ac=function(t){},Dc.prototype.qr=function(t,e){var n=new Ih(e,0),r=this.nc.Nt(n);return Au.resolve(e.isEqual(r&&r.key))},Dc.prototype.lr=function(t){return this.hi.length,Au.resolve()},Dc.prototype.uc=function(t,e){return this.rc(t)},Dc.prototype.rc=function(t){return 0===this.hi.length?0:t-this.hi[0].batchId},Dc.prototype.ic=function(t){var e=this.rc(t);return e<0||e>=this.hi.length?null:this.hi[e]},Dc),kc=(Lc.prototype.ar=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.hc(e);return this.docs=this.docs.rt(r,{lc:e,size:s,readTime:n}),this.size+=s-o,this.li.Ui(t,r.path.h())},Lc.prototype.Er=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Lc.prototype.wi=function(t,e){var n=this.docs.get(e);return Au.resolve(n?n.lc:null)},Lc.prototype.getEntries=function(t,e){var n=this,r=lo;return e.forEach(function(t){var e=n.docs.get(t);r=r.rt(t,e?e.lc:null)}),Au.resolve(r)},Lc.prototype.Ai=function(t,e,n){for(var r=vo,i=new Xr(e.path.child("")),o=this.docs._t(i);o.It();){var s=o.Et(),a=s.key,u=s.value,h=u.lc,c=u.readTime;if(!e.path.T(a.path))break;c.q(n)<=0||h instanceof Ia&&Ba(e,h)&&(r=r.rt(h.key,h))}return Au.resolve(r)},Lc.prototype._c=function(t,e){return Au.forEach(this.docs,function(t){return e(t)})},Lc.prototype.ur=function(t){return new Lc.fc(this)},Lc.prototype.dc=function(t){return Au.resolve(this.size)},Lc);function Lc(t,e){this.li=t,this.hc=e,this.docs=new no(Xr.i),this.size=0}function Dc(t,e){this.li=t,this.Ar=e,this.hi=[],this.ec=1,this.nc=new ho(Ih.vr)}function Pc(){}function _c(t){var e=this;return(e=Rc.call(this)||this).Ac=t,e}function Uc(){this.Qu=new Ui(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.wc=!1}kc.fc=(Object.defineProperty(Uc.prototype,"readTime",{get:function(){return this.mc},set:function(t){this.mc=t},enumerable:!1,configurable:!0}),Uc.prototype.ar=function(t,e){this.Tc(),this.readTime=e,this.Qu.set(t.key,t)},Uc.prototype.Er=function(t,e){this.Tc(),e&&(this.readTime=e),this.Qu.set(t,null)},Uc.prototype.wi=function(t,e){this.Tc();var n=this.Qu.get(e);return void 0!==n?Au.resolve(n):this.Ec(t,e)},Uc.prototype.getEntries=function(t,e){return this.Ic(t,e)},Uc.prototype.apply=function(t){return this.Tc(),this.wc=!0,this.wu(t)},Uc.prototype.Tc=function(){},o(_c,Rc=Uc),_c.prototype.wu=function(n){var r=this,i=[];return this.Qu.forEach(function(t,e){e?i.push(r.Ac.ar(n,e,r.readTime)):r.Ac.Er(t)}),Au.Nn(i)},_c.prototype.Ec=function(t,e){return this.Ac.wi(t,e)},_c.prototype.Ic=function(t,e){return this.Ac.getEntries(t,e)},_c);var Vc,Cc,Mc=(el.prototype.Ce=function(t,n){return this.Rc.forEach(function(t,e){return n(e)}),Au.resolve()},el.prototype._r=function(t){return Au.resolve(this.lastRemoteSnapshotVersion)},el.prototype.Vc=function(t){return Au.resolve(this.yc)},el.prototype.qu=function(t){return this.highestTargetId=this.gc.next(),Au.resolve(this.highestTargetId)},el.prototype.Rr=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.yc&&(this.yc=e),Au.resolve()},el.prototype.vc=function(t){this.Rc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.gc=new ah(e),this.highestTargetId=e),t.sequenceNumber>this.yc&&(this.yc=t.sequenceNumber)},el.prototype.Lu=function(t,e){return this.vc(e),this.targetCount+=1,Au.resolve()},el.prototype.Tr=function(t,e){return this.vc(e),Au.resolve()},el.prototype.bc=function(t,e){return this.Rc.delete(e.target),this.Pc.kr(e.targetId),--this.targetCount,Au.resolve()},el.prototype.Sc=function(n,r,i){var o=this,s=0,a=[];return this.Rc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Rc.delete(t),a.push(o.Cc(n,e.targetId)),s++)}),Au.Nn(a).next(function(){return s})},el.prototype.Dc=function(t){return Au.resolve(this.targetCount)},el.prototype.Pr=function(t,e){var n=this.Rc.get(e)||null;return Au.resolve(n)},el.prototype.wr=function(t,e,n){return this.Pc.Dr(e,n),Au.resolve()},el.prototype.dr=function(e,t,n){this.Pc.Nr(t,n);var r=this.persistence.Ar,i=[];return r&&t.forEach(function(t){i.push(r.cc(e,t))}),Au.Nn(i)},el.prototype.Cc=function(t,e){return this.Pc.kr(e),Au.resolve()},el.prototype.pr=function(t,e){var n=this.Pc.Mr(e);return Au.resolve(n)},el.prototype.qr=function(t,e){return Au.resolve(this.Pc.qr(e))},el),jc=(tl.prototype.start=function(){return Promise.resolve()},tl.prototype.ei=function(){return this.Nc=!1,Promise.resolve()},Object.defineProperty(tl.prototype,"kc",{get:function(){return this.Nc},enumerable:!1,configurable:!0}),tl.prototype.Oc=function(){},tl.prototype.Mc=function(){},tl.prototype.nr=function(){return this.li},tl.prototype.Yi=function(t){var e=this.Fc[t.Cs()];return e||(e=new Oc(this.li,this.Ar),this.Fc[t.Cs()]=e),e},tl.prototype.tr=function(){return this.Zi},tl.prototype.Xi=function(){return this.ai},tl.prototype.runTransaction=function(t,e,n){var r=this;Vr("MemoryPersistence","Starting transaction:",t);var i=new xc(this.$c.next());return this.Ar.qc(),n(i).next(function(t){return r.Ar.Lc(i).next(function(){return t})}).Fn().then(function(t){return i.Bc(),t})},tl.prototype.Uc=function(e,n){return Au.xn(Object.values(this.Fc).map(function(t){return function(){return t.qr(e,n)}}))},tl),xc=($c.prototype.jc=function(t){this.Qc.push(t)},$c.prototype.Bc=function(){this.Qc.forEach(function(t){return t()})},o(Zc,Cc=$c),Zc),qc=(Jc.Kc=function(t){return new Jc(t)},Object.defineProperty(Jc.prototype,"zc",{get:function(){if(this.Gc)return this.Gc;throw xr()},enumerable:!1,configurable:!0}),Jc.prototype.Cr=function(t,e,n){return this.Wc.Cr(n,e),this.zc.delete(n.toString()),Au.resolve()},Jc.prototype.Fr=function(t,e,n){return this.Wc.Fr(n,e),this.zc.add(n.toString()),Au.resolve()},Jc.prototype.cc=function(t,e){return this.zc.add(e.toString()),Au.resolve()},Jc.prototype.removeTarget=function(t,e){var n=this;this.Wc.kr(e.targetId).forEach(function(t){return n.zc.add(t.toString())});var r=this.persistence.tr();return r.pr(t,e.targetId).next(function(t){t.forEach(function(t){return n.zc.add(t.toString())})}).next(function(){return r.bc(t,e)})},Jc.prototype.qc=function(){this.Gc=new Set},Jc.prototype.Lc=function(n){var r=this,i=this.persistence.Xi().ur();return Au.forEach(this.zc,function(t){var e=Xr.C(t);return r.Hc(n,e).next(function(t){t||i.Er(e)})}).next(function(){return r.Gc=null,i.apply(n)})},Jc.prototype.Ir=function(t,e){var n=this;return this.Hc(t,e).next(function(t){t?n.zc.delete(e.toString()):n.zc.add(e.toString())})},Jc.prototype.xc=function(t){return 0},Jc.prototype.Hc=function(t,e){var n=this;return Au.xn([function(){return Au.resolve(n.Wc.qr(e))},function(){return n.persistence.tr().qr(t,e)},function(){return n.persistence.Uc(t,e)}])},Jc),Fc=(Xc.prototype.Io=function(t){this.Xc=t},Xc.prototype.do=function(t){this.Zc=t},Xc.prototype.onMessage=function(t){this.ta=t},Xc.prototype.close=function(){this.Jc()},Xc.prototype.send=function(t){this.Yc(t)},Xc.prototype.ea=function(){this.Xc()},Xc.prototype.na=function(t){this.Zc(t)},Xc.prototype.sa=function(t){this.ta(t)},Xc),Gc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},zc=(Yc.prototype.$o=function(e,t,n,r){var i=this.ua(e,t);Vr("RestConnection","Sending: ",i,n);var o={};return this.ca(o,r),this.aa(e,i,o,n).then(function(t){return Vr("RestConnection","Received: ",t),t},function(t){throw Mr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Yc.prototype.No=function(t,e,n,r){return this.$o(t,e,n,r)},Yc.prototype.ca=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.20.0-202088235442",t["Content-Type"]="text/plain",e)for(var n in e.Br)e.Br.hasOwnProperty(n)&&(t[n]=e.Br[n])},Yc.prototype.ua=function(t,e){var n=Gc[t];return this.ra+"/v1/"+e+":"+n},o(Kc,Vc=Yc),Kc.prototype.aa=function(u,e,n,r){return new Promise(function(o,s){var a=new Nr;a.listenOnce(Tr.COMPLETE,function(){try{switch(a.getLastErrorCode()){case Ir.NO_ERROR:var t=a.getResponseJson();Vr("Connection","XHR received:",JSON.stringify(t)),o(t);break;case Ir.TIMEOUT:Vr("Connection",'RPC "'+u+'" timed out'),s(new Lr(kr.DEADLINE_EXCEEDED,"Request time out"));break;case Ir.HTTP_ERROR:var e,n,r=a.getStatus();Vr("Connection",'RPC "'+u+'" failed with status:',r,"response text:",a.getResponseText()),0<r?(e=a.getResponseJson().error)&&e.status&&e.message?(i=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(kr).indexOf(i)?i:kr.UNKNOWN,s(new Lr(n,e.message))):s(new Lr(kr.UNKNOWN,"Server responded with status "+a.getStatus())):s(new Lr(kr.UNAVAILABLE,"Connection failed."));break;default:xr()}}finally{Vr("Connection",'RPC "'+u+'" completed.')}var i});var t=JSON.stringify(r);a.send(e,"POST",t,n,15)})},Kc.prototype.Ao=function(t,e){var n,r,i=[this.ra,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Er(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.U.projectId+"/databases/"+this.U.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.ca(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(v())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=v().indexOf("Electron/")||0<=(r=v()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=v().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var a=i.join("");function u(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Vr("Connection","Creating WebChannel: "+a,s);var h=o.createWebChannel(a,s),c=!1,l=!1,f=new Fc({Yc:function(t){l?Vr("Connection","Not sending because WebChannel is closed:",t):(c||(Vr("Connection","Opening WebChannel transport."),h.open(),c=!0),Vr("Connection","WebChannel sending:",t),h.send(t))},Jc:function(){return h.close()}});return u(Ar.EventType.OPEN,function(){l||Vr("Connection","WebChannel transport opened.")}),u(Ar.EventType.CLOSE,function(){l||(l=!0,Vr("Connection","WebChannel transport closed"),f.na())}),u(Ar.EventType.ERROR,function(t){l||(l=!0,Mr("Connection","WebChannel transport errored:",t),f.na(new Lr(kr.UNAVAILABLE,"The operation could not be completed")))}),u(Ar.EventType.MESSAGE,function(t){var e,n,r,i,o,s;l||(qr(!!(n=t.data[0])),(r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(Vr("Connection","WebChannel received error:",r),i=r.status,o=function(){var t=Xi[i];if(void 0!==t)return eo(t)}(),s=r.message,void 0===o&&(o=kr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),l=!0,f.na(new Lr(o,s)),h.close()):(Vr("Connection","WebChannel received:",n),f.sa(n)))}),setTimeout(function(){f.ea()},0),f},Kc),Bc=(Hc.prototype.Jo=function(t){this.da.push(t)},Hc.prototype.ei=function(){window.removeEventListener("online",this.ha),window.removeEventListener("offline",this._a)},Hc.prototype.wa=function(){window.addEventListener("online",this.ha),window.addEventListener("offline",this._a)},Hc.prototype.la=function(){Vr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.da;t<e.length;t++)(0,e[t])(0)},Hc.prototype.fa=function(){Vr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.da;t<e.length;t++)(0,e[t])(1)},Hc.ma=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Hc),Qc=(Wc.prototype.Jo=function(t){},Wc.prototype.ei=function(){},Wc);function Wc(){}function Hc(){var t=this;this.ha=function(){return t.la()},this._a=function(){return t.fa()},this.da=[],this.wa()}function Kc(t){var e=this;return(e=Vc.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function Yc(t){this.ia=t,this.U=t.U;var e=t.ssl?"https":"http";this.ra=e+"://"+t.host,this.oa="projects/"+this.U.projectId+"/databases/"+this.U.database+"/documents"}function Xc(t){this.Yc=t.Yc,this.Jc=t.Jc}function Jc(t){this.persistence=t,this.Wc=new Eh,this.Gc=null}function Zc(t){var e=this;return(e=Cc.call(this)||this).mr=t,e}function $c(){this.Qc=[]}function tl(t){var e=this;this.Fc={},this.$c=new zu(0),this.Nc=!1,this.Nc=!0,this.Ar=t(this),this.Zi=new Mc(this),this.li=new oh,this.ai=new kc(this.li,function(t){return e.Ar.xc(t)})}function el(t){this.persistence=t,this.Rc=new Ui(Wi,Hi),this.lastRemoteSnapshotVersion=Ci.min(),this.highestTargetId=0,this.yc=0,this.Pc=new Eh,this.targetCount=0,this.gc=ah.ji()}function nl(t){return new os(t,!0)}var rl="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",il=(al.prototype.initialize=function(e){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return this.pu=this.Ta(e),this.persistence=this.Ea(e),[4,this.persistence.start()];case 1:return t.sent(),this.Ia=this.Aa(e),this.Qo=this.Ra(e),[2]}})})},al.prototype.Aa=function(t){return null},al.prototype.Ra=function(t){return e=this.persistence,n=new Sc,r=t.ya,new uh(e,n,r);var e,n,r},al.prototype.Ea=function(t){if(t.pa.Pa)throw new Lr(kr.FAILED_PRECONDITION,rl);return new jc(qc.Kc)},al.prototype.Ta=function(t){return new Wu},al.prototype.terminate=function(){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return this.Ia&&this.Ia.stop(),[4,this.pu.ei()];case 1:return t.sent(),[4,this.persistence.ei()];case 2:return t.sent(),[2]}})})},al.prototype.clearPersistence=function(t,e){throw new Lr(kr.FAILED_PRECONDITION,rl)},al),ol=(sl.prototype.initialize=function(n,r){return w(this,void 0,void 0,function(){var e=this;return b(this,function(t){switch(t.label){case 0:return this.Qo?[3,2]:(this.Qo=n.Qo,this.pu=n.pu,this.jo=this.ga(r),this.Pu=this.Va(r),this.va=this.ba(r),this.Sa=this.Ca(r),this.va.subscribe({Ro:function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=s.query,u=n.ws.get(a);if(u){for(var h=0,c=u.listeners;h<c.length;h++)c[h].As(s)&&(r=!0);u.ds=s}}r&&ju(n)}.bind(null,this.Sa),Ku:function(t,e,n){var r=t,i=r.ws.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.ws.delete(e)}.bind(null,this.Sa),ju:function(t,i){var e=t;e.onlineState=i;var o=!1;e.ws.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Is(i)&&(o=!0)}),o&&ju(e)}.bind(null,this.Sa)}),this.pu.Qs=function(t){return mc(e.va,t,1)},this.Pu.Ho.Da=function(i,o){return w(this,void 0,void 0,function(){var n,r;return b(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Vr("SyncEngine","User change. New user:",o.Cs()),[4,function(i,o){return w(this,void 0,void 0,function(){var e,n,m,r;return b(this,function(t){switch(t.label){case 0:return n=(e=i).hi,m=e.er,[4,e.persistence.runTransaction("Handle user change","readonly",function(y){var g;return e.hi.zu(y).next(function(t){return g=t,n=e.persistence.Yi(o),m=new Yu(e.Ji,n,e.persistence.nr()),n.zu(y)}).next(function(t){for(var e=[],n=[],r=mo(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var a=0,u=s.mutations;a<u.length;a++)var h=u[a],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var v=d[p];r=r.add(v.key)}}return m.Ti(y,r).next(function(t){return{Hu:t,Yu:e,Ju:n}})})})];case 1:return r=t.sent(),[2,(e.hi=n,e.er=m,e.Gi.sr(e.er),r)]}})})}(n.Qo,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Nu.forEach(function(t){t.forEach(function(t){t.reject(new Lr(kr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Nu.clear(),n.pu.Zs(o,r.Yu,r.Ju),[4,Nc(n,r.Hu)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this.va),[4,function(n,r){return w(this,void 0,void 0,function(){var e;return b(this,function(t){switch(t.label){case 0:return e=n,r?(e.zo.delete(2),[4,Wh(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.zo.add(2),[4,Hh(e)]);case 3:t.sent(),e.tu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.Pu,this.va.Ou)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},sl.prototype.Ca=function(t){return new Uu},sl.prototype.ga=function(t){var e,n=nl(t.ia.U),r=(e=t.ia,new zc(e)),i=t.credentials;return new Lh(i,r,n)},sl.prototype.Va=function(t){var e=this,n=this.Qo,r=this.jo,i=t.kn,o=new(Bc.ma()?Bc:Qc);return new Ph(n,r,i,function(t){return mc(e.va,t,0)},o)},sl.prototype.ba=function(t){return e=this.Qo,n=this.Pu,r=this.pu,i=t.ya,o=t.gu,s=!t.pa.Pa||!t.pa.synchronizeTabs,a=new pc(e,n,r,i,o),s&&(a.ku=!0),a;var e,n,r,i,o,s,a},sl.prototype.terminate=function(){return Kh(this.Pu)},sl);function sl(){}function al(){}function ul(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var hl,cl,ll=(wl.prototype.next=function(t){this.observer.next&&this.Fa(this.observer.next,t)},wl.prototype.error=function(t){this.observer.error?this.Fa(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},wl.prototype.$a=function(){this.muted=!0},wl.prototype.Fa=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},wl),fl=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Lr(kr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(oi("FieldPath","string",e,t[e]),0===t[e].length)throw new Lr(kr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Na=new Yr(t)},pl=(o(ml,cl=fl),ml.documentId=function(){return new ml(Yr.v().R())},ml.prototype.isEqual=function(t){if(!(t instanceof ml))throw yi("isEqual","FieldPath",1,t);return this.Na.isEqual(t.Na)},ml),dl=new RegExp("[~\\*/\\[\\]]"),vl=function(){this.xa=this},yl=(o(gl,hl=vl),gl.prototype.Oa=function(t){if(2!==t.Ma)throw 1===t.Ma?t.qa(this.ka+"() can only appear at the top level of your update data"):t.qa(this.ka+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},gl.prototype.isEqual=function(t){return t instanceof gl},gl);function gl(t){var e=this;return(e=hl.call(this)||this).ka=t,e}function ml(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return cl.call(this,t)||this}function wl(t){this.observer=t,this.muted=!1}function bl(t,e,n){return new Kl({Ma:3,La:e.settings.La,methodName:t.ka,Ba:n},e.U,e.serializer,e.ignoreUndefinedProperties)}var El,Il,Tl,Al,Nl,Rl,Sl=(o(Wl,Rl=vl),Wl.prototype.Oa=function(t){return new qs(t.path,new Rs)},Wl.prototype.isEqual=function(t){return t instanceof Wl},Wl),Ol=(o(Ql,Nl=vl),Ql.prototype.Oa=function(t){var e=bl(this,t,!0),n=this.Ua.map(function(t){return nf(t,e)}),r=new Ss(n);return new qs(t.path,r)},Ql.prototype.isEqual=function(t){return this===t},Ql),kl=(o(Bl,Al=vl),Bl.prototype.Oa=function(t){var e=bl(this,t,!0),n=this.Ua.map(function(t){return nf(t,e)}),r=new Ps(n);return new qs(t.path,r)},Bl.prototype.isEqual=function(t){return this===t},Bl),Ll=(o(zl,Tl=vl),zl.prototype.Oa=function(t){var e=new Cs(t.serializer,us(t.serializer,this.Qa));return new qs(t.path,e)},zl.prototype.isEqual=function(t){return this===t},zl),Dl=(o(Gl,Il=vl),Gl.delete=function(){return ei("FieldValue.delete",arguments),new Pl(new yl("FieldValue.delete"))},Gl.serverTimestamp=function(){return ei("FieldValue.serverTimestamp",arguments),new Pl(new Sl("FieldValue.serverTimestamp"))},Gl.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ri("FieldValue.arrayUnion",arguments,1),new Pl(new Ol("FieldValue.arrayUnion",t))},Gl.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ri("FieldValue.arrayRemove",arguments,1),new Pl(new kl("FieldValue.arrayRemove",t))},Gl.increment=function(t){return oi("FieldValue.increment","number",1,t),ni("FieldValue.increment",arguments,1),new Pl(new Ll("FieldValue.increment",t))},Gl),Pl=(o(Fl,El=Dl),Fl.prototype.Oa=function(t){return this.xa.Oa(t)},Fl.prototype.isEqual=function(t){return t instanceof Fl&&this.xa.isEqual(t.xa)},Fl),_l=(Object.defineProperty(ql.prototype,"latitude",{get:function(){return this.ja},enumerable:!1,configurable:!0}),Object.defineProperty(ql.prototype,"longitude",{get:function(){return this.Wa},enumerable:!1,configurable:!0}),ql.prototype.isEqual=function(t){return this.ja===t.ja&&this.Wa===t.Wa},ql.prototype.toJSON=function(){return{latitude:this.ja,longitude:this.Wa}},ql.prototype.H=function(t){return Ii(this.ja,t.ja)||Ii(this.Wa,t.Wa)},ql),Ul=/^__.*__$/,Vl=function(t,e,n){this.Ga=t,this.Ka=e,this.za=n},Cl=(xl.prototype.Ha=function(t,e){var n=[];return null!==this.Qe?n.push(new ta(t,this.data,this.Qe,e)):n.push(new $s(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new oa(t,this.fieldTransforms)),n},xl),Ml=(jl.prototype.Ha=function(t,e){var n=[new ta(t,this.data,this.Qe,e)];return 0<this.fieldTransforms.length&&n.push(new oa(t,this.fieldTransforms)),n},jl);function jl(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function xl(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function ql(t,e){if(ni("GeoPoint",arguments,2),oi("GeoPoint","number",1,t),oi("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Lr(kr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Lr(kr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.ja=t,this.Wa=e}function Fl(t){var e=this;return(e=El.call(this)||this).xa=t,e.ka=t.ka,e}function Gl(){return Il.call(this)||this}function zl(t,e){var n=this;return(n=Tl.call(this)||this).ka=t,n.Qa=e,n}function Bl(t,e){var n=this;return(n=Al.call(this)||this).ka=t,n.Ua=e,n}function Ql(t,e){var n=this;return(n=Nl.call(this)||this).ka=t,n.Ua=e,n}function Wl(t){var e=this;return(e=Rl.call(this)||this).ka=t,e}function Hl(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw xr()}}var Kl=(Object.defineProperty(Jl.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Jl.prototype,"Ma",{get:function(){return this.settings.Ma},enumerable:!1,configurable:!0}),Jl.prototype.Ja=function(t){return new Jl(Object.assign(Object.assign({},this.settings),t),this.U,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},Jl.prototype.Xa=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Ja({path:n,Ba:!1});return r.Za(t),r},Jl.prototype.th=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Ja({path:n,Ba:!1});return r.Ya(),r},Jl.prototype.eh=function(t){return this.Ja({path:void 0,Ba:!0})},Jl.prototype.qa=function(t){return hf(t,this.settings.methodName,this.settings.nh||!1,this.path,this.settings.La)},Jl.prototype.contains=function(e){return void 0!==this.Qe.find(function(t){return e.T(t)})||void 0!==this.fieldTransforms.find(function(t){return e.T(t.field)})},Jl.prototype.Ya=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Za(this.path.get(t))},Jl.prototype.Za=function(t){if(0===t.length)throw this.qa("Document fields must not be empty");if(Hl(this.Ma)&&Ul.test(t))throw this.qa('Document fields cannot begin and end with "__"')},Jl),Yl=(Xl.prototype.sh=function(t,e,n,r){return void 0===r&&(r=!1),new Kl({Ma:t,methodName:e,La:n,path:Yr.p(),Ba:!1,nh:r},this.U,this.serializer,this.ignoreUndefinedProperties)},Xl);function Xl(t,e,n){this.U=t,this.ignoreUndefinedProperties=e,this.serializer=n||nl(t)}function Jl(t,e,n,r,i,o){this.settings=t,this.U=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Ya(),this.fieldTransforms=i||[],this.Qe=o||[]}function Zl(t,e,n,r,i,o){void 0===o&&(o={});var s=t.sh(o.merge||o.mergeFields?2:0,e,n,i);sf("Data must be an object, but it was:",s,r);var a,u,h=rf(r,s);if(o.merge)a=new Fs(s.Qe),u=s.fieldTransforms;else if(o.mergeFields){for(var c=[],l=0,f=o.mergeFields;l<f.length;l++){var p=f[l],d=void 0;if(p instanceof fl)d=p.Na;else{if("string"!=typeof p)throw xr();d=uf(e,p,n)}if(!s.contains(d))throw new Lr(kr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");cf(c,d)||c.push(d)}a=new Fs(c),u=s.fieldTransforms.filter(function(t){return a.ze(t.field)})}else a=null,u=s.fieldTransforms;return new Cl(new fa(h),a,u)}function $l(t,o,s,e){var a=t.sh(1,o,s);sf("Data must be an object, but it was:",a,e);var u=[],h=new pa;Gr(e,function(t,e){var n,r=uf(o,t,s),i=a.th(r);e instanceof vl&&e.xa instanceof yl?u.push(r):null!=(n=nf(e,i))&&(u.push(r),h.set(r,n))});var n=new Fs(u);return new Ml(h.Je(),n,a.fieldTransforms)}function tf(t,e,n,r,i,o){var s=t.sh(1,e,n),a=[af(e,r,n)],u=[i];if(o.length%2!=0)throw new Lr(kr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)a.push(af(e,o[h])),u.push(o[h+1]);for(var c,l,f,p,d=[],v=new pa,y=a.length-1;0<=y;--y)cf(d,a[y])||(c=a[y],l=u[y],f=s.th(c),l instanceof vl&&l.xa instanceof yl?d.push(c):null!=(p=nf(l,f))&&(d.push(c),v.set(c,p)));var g=new Fs(d);return new Ml(v.Je(),g,s.fieldTransforms)}function ef(t,e,n,r){return void 0===r&&(r=!1),nf(n,t.sh(r?4:3,e))}function nf(s,t){if(of(s))return sf("Unsupported field value:",t,s),rf(s,t);if(s instanceof vl)return function(t,e){if(!Hl(e.Ma))throw e.qa(t.ka+"() can only be used with update() and set()");if(!e.path)throw e.qa(t.ka+"() is not currently supported inside arrays");var n=t.Oa(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Qe.push(t.path),s instanceof Array){if(t.settings.Ba&&4!==t.Ma)throw t.qa("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=nf(i[r],t.eh(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return us(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Vi.fromDate(t);return{timestampValue:hs(e.serializer,n)}}if(t instanceof Vi){var r=new Vi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:hs(e.serializer,r)}}if(t instanceof _l)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Ri)return{bytesValue:cs(e.serializer,t.B)};if(t instanceof Vl){var i=e.U,o=t.Ga;if(!o.isEqual(i))throw e.qa("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:fs(t.Ga||e.U,t.Ka.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.qa("Unsupported field value: "+pi(t))}(s,t)}function rf(t,r){var i={};return zr(t)?r.path&&0<r.path.length&&r.Qe.push(r.path):Gr(t,function(t,e){var n=nf(e,r.Xa(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function of(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Vi||t instanceof _l||t instanceof Ri||t instanceof Vl||t instanceof vl)}function sf(t,e,n){if(!of(n)||!fi(n)){var r=pi(n);throw"an object"===r?e.qa(t+" a custom object"):e.qa(t+" "+r)}}function af(t,e,n){if(e instanceof fl)return e.Na;if("string"==typeof e)return uf(t,e);throw hf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function uf(t,e,n){try{return function(e){if(0<=e.search(dl))throw new Lr(kr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(pl.bind.apply(pl,s([void 0],e.split("."))))}catch(t){throw new Lr(kr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Na}catch(e){throw hf(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function hf(t,e,n,r,i){var o=r&&!r.m(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new Lr(kr.INVALID_ARGUMENT,(a+=". ")+t+u)}function cf(t,e){return t.some(function(t){return t.isEqual(e)})}var lf=(yf.prototype.ah=function(r){return w(this,void 0,void 0,function(){var e,n=this;return b(this,function(t){switch(t.label){case 0:if(this.hh(),0<this.mutations.length)throw new Lr(kr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(a,u){return w(this,void 0,void 0,function(){var i,e,n,r,o,s;return b(this,function(t){switch(t.label){case 0:return e=ys((i=a).serializer)+"/documents",n={documents:u.map(function(t){return ps(i.serializer,t)})},[4,i.No("BatchGetDocuments",e,n)];case 1:return r=t.sent(),o=new Map,r.forEach(function(t){var e,n,r=(e=i.serializer,"found"in(n=t)?function(t,e){qr(!!e.found),e.found.name,e.found.updateTime;var n=ds(t,e.found.name),r=ls(e.found.updateTime),i=new fa({mapValue:{fields:e.found.fields}});return new Ia(n,r,i,{})}(e,n):"missing"in n?function(t,e){qr(!!e.missing),qr(!!e.readTime);var n=ds(t,e.missing),r=ls(e.readTime);return new Ta(n,r)}(e,n):xr());o.set(r.key.toString(),r)}),s=[],[2,(u.forEach(function(t){var e=o.get(t.toString());qr(!!e),s.push(e)}),s)]}})})}(this.jo,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Ta||t instanceof Ia?n.lh(t):xr()}),e)]}})})},yf.prototype.set=function(t,e){this.write(e.Ha(t,this.Ge(t))),this.uh.add(t.toString())},yf.prototype.update=function(t,e){try{this.write(e.Ha(t,this._h(t)))}catch(t){this.oh=t}this.uh.add(t.toString())},yf.prototype.delete=function(t){this.write([new ca(t,this.Ge(t))]),this.uh.add(t.toString())},yf.prototype.commit=function(){return w(this,void 0,void 0,function(){var e,r=this;return b(this,function(t){switch(t.label){case 0:if(this.hh(),this.oh)throw this.oh;return e=this.ih,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=Xr.C(e);r.mutations.push(new la(n,r.Ge(n)))}),[4,function(i,o){return w(this,void 0,void 0,function(){var e,n,r;return b(this,function(t){switch(t.label){case 0:return n=ys((e=i).serializer)+"/documents",r={writes:o.map(function(t){return ms(e.serializer,t)})},[4,e.$o("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.jo,this.mutations)];case 1:return t.sent(),this.rh=!0,[2]}})})},yf.prototype.lh=function(t){var e;if(t instanceof Ia)e=t.version;else{if(!(t instanceof Ta))throw xr();e=Ci.min()}var n=this.ih.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Lr(kr.ABORTED,"Document version changed between two reads.")}else this.ih.set(t.key.toString(),e)},yf.prototype.Ge=function(t){var e=this.ih.get(t.toString());return!this.uh.has(t.toString())&&e?Bs.updateTime(e):Bs.He()},yf.prototype._h=function(t){var e=this.ih.get(t.toString());if(this.uh.has(t.toString())||!e)return Bs.exists(!0);if(e.isEqual(Ci.min()))throw new Lr(kr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Bs.updateTime(e)},yf.prototype.write=function(t){this.hh(),this.mutations=this.mutations.concat(t)},yf.prototype.hh=function(){},yf),ff=(vf.prototype.run=function(){this.dh()},vf.prototype.dh=function(){var t=this;this.Jn.Rn(function(){return w(t,void 0,void 0,function(){var e,n,r=this;return b(this,function(t){return e=new lf(this.jo),(n=this.wh(e))&&n.then(function(t){r.kn.Qn(function(){return e.commit().then(function(){r.qn.resolve(t)}).catch(function(t){r.mh(t)})})}).catch(function(t){r.mh(t)}),[2]})})})},vf.prototype.wh=function(t){try{var e=this.updateFunction(t);return!Gi(e)&&e.catch&&e.then?e:(this.qn.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.qn.reject(t),null}},vf.prototype.mh=function(t){var e=this;0<this.fh&&this.Th(t)?(--this.fh,this.kn.Qn(function(){return e.dh(),Promise.resolve()})):this.qn.reject(t)},vf.prototype.Th=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!to(e)},vf),pf=(df.prototype.start=function(t,e,n,r){var i=this;this.Ih(),this.ia=t;var o=new Iu,s=!1;return this.credentials.jr(function(t){return s?void i.kn.rs(function(){return function(r,i){return w(this,void 0,void 0,function(){var e,n;return b(this,function(t){switch(t.label){case 0:return(e=r).kn.cs(),Vr("RemoteStore","RemoteStore received new credentials"),n=ec(e),e.zo.add(3),[4,Hh(e)];case 1:return t.sent(),n&&e.tu.set("Unknown"),[4,e.Ho.Da(i)];case 2:return t.sent(),e.zo.delete(3),[4,Wh(e)];case 3:return t.sent(),[2]}})})}(i.Pu,t)}):(s=!0,Vr("FirestoreClient","Initializing. user=",t.uid),i.Ah(e,n,r,t,o).then(i.Eh.resolve,i.Eh.reject))}),this.kn.Qn(function(){return i.Eh.promise}),o.promise},df.prototype.enableNetwork=function(){var t=this;return this.Ih(),this.kn.enqueue(function(){return t.persistence.Mc(!0),Qh(t.Pu)})},df.prototype.Ah=function(i,o,s,a,u){return w(this,void 0,void 0,function(){var e,n,r=this;return b(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={kn:this.kn,ia:this.ia,clientId:this.clientId,credentials:this.credentials,ya:a,gu:100,pa:s},[4,i.initialize(e)];case 1:return t.sent(),[4,o.initialize(i,e)];case 2:return t.sent(),this.persistence=i.persistence,this.pu=i.pu,this.Qo=i.Qo,this.Ia=i.Ia,this.jo=o.jo,this.Pu=o.Pu,this.va=o.va,this.Rh=o.Sa,this.Rh.Es=function(l,f){return w(this,void 0,void 0,function(){var o,s,a,u,h,c;return b(this,function(t){switch(t.label){case 0:return(n=l).Pu.Ho.nu=gc.bind(null,n),n.Pu.Ho.Le=function(t,e){var n=t,r=n.Du.get(e);if(r&&r.yu)return mo().add(r.key);var i=mo(),o=n.bu.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++)var u=a[s],h=n.vu.get(u),i=i.xt(h.view.hu);return i}.bind(null,n),n.Pu.Ho.eu=function(a,u,h){return w(this,void 0,void 0,function(){var e,n,r,i,o,s;return b(this,function(t){switch(t.label){case 0:return(e=a).Mu("rejectListens()"),e.pu.Ks(u,"rejected",h),n=e.Du.get(u),(r=n&&n.key)?(i=(i=new no(Xr.i)).rt(r,new Ta(r,Ci.min())),o=mo().add(r),s=new Ro(Ci.min(),new Map,new ho(Ii),i,o),[4,gc(e,s)]):[3,2];case 1:return t.sent(),e.Cu=e.Cu.remove(r),e.Du.delete(u),Ac(e),[3,4];case 2:return[4,dh(e.Qo,u,!1).then(function(){return Ec(e,u,h)}).catch(yh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,n),(o=n).Mu("listen()"),(u=o.vu.get(f))?(s=u.targetId,o.pu.Gs(s),a=u.view.Ru(),[3,4]):[3,1];case 1:return[4,(e=o.Qo,r=Ma(f),(i=e).persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Zi.Pr(e,r).next(function(t){return t?(n=t,Au.resolve(n)):i.Zi.qu(e).next(function(t){return n=new Zi(r,t,0,e.mr),i.Zi.Lu(e,n).next(function(){return n})})})}).then(function(t){var e=i.Ki.get(t.targetId);return(null===e||0<t.et.q(e.et))&&(i.Ki=i.Ki.rt(t.targetId,t),i.zi.set(r,t.targetId)),t}))];case 2:return h=t.sent(),c=o.pu.Gs(h.targetId),s=h.targetId,[4,function(a,u,h,c){return w(this,void 0,void 0,function(){var e,n,r,i,o,s;return b(this,function(t){switch(t.label){case 0:return a.Bu=function(t,e,n){return function(i,o,s,a){return w(this,void 0,void 0,function(){var n,e,r;return b(this,function(t){switch(t.label){case 0:return(n=o.view.lu(s)).du?[4,vh(i.Qo,o.query,!1).then(function(t){var e=t.documents;return o.view.lu(e,n)})]:[3,2];case 1:n=t.sent(),t.label=2;case 2:return e=a&&a.Kt.get(o.targetId),r=o.view.wu(n,i.Ou,e),[2,(Tc(i,o.targetId,r.Eu),r.snapshot)]}})})}(a,t,e,n)},[4,vh(a.Qo,u,!0)];case 1:return e=t.sent(),n=new lc(u,e.gr),r=n.lu(e.documents),i=So.Xt(h,c&&"Offline"!==a.onlineState),o=n.wu(r,a.Ou,i),Tc(a,h,o.Eu),s=new uc(u,h,n),a.vu.set(u,s),a.bu.has(h)?a.bu.get(h).push(u):a.bu.set(h,[u]),[2,o.snapshot]}})})}(o,f,s,"current"===c)];case 3:a=t.sent(),o.Ou&&Yh(o.Pu,h),t.label=4;case 4:return[2,a]}var e,r,i,n})})}.bind(null,this.va),this.Rh.Rs=function(i,o){return w(this,void 0,void 0,function(){var e,n,r;return b(this,function(t){switch(t.label){case 0:return(e=i).Mu("unlisten()"),n=e.vu.get(o),1<(r=e.bu.get(n.targetId)).length?[2,(e.bu.set(n.targetId,r.filter(function(t){return!Fa(t,o)})),void e.vu.delete(o))]:e.Ou?(e.pu.zs(n.targetId),e.pu.Xs(n.targetId)?[3,2]:[4,dh(e.Qo,n.targetId,!1).then(function(){e.pu.Ys(n.targetId),Xh(e.Pu,n.targetId),Ec(e,n.targetId)}).catch(yh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Ec(e,n.targetId),[4,dh(e.Qo,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,this.va),this.persistence.Oc(function(){return w(r,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),u.resolve(),[3,4];case 3:if(n=t.sent(),u.reject(n),!this.yh(n))throw n;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+n),this.Ah(new il,new ol,{Pa:!1},a,u))];case 4:return[2]}})})},df.prototype.yh=function(t){return"FirebaseError"===t.name?t.code===kr.FAILED_PRECONDITION||t.code===kr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},df.prototype.Ih=function(){if(this.kn.Zn)throw new Lr(kr.FAILED_PRECONDITION,"The client has already been terminated.")},df.prototype.disableNetwork=function(){var t=this;return this.Ih(),this.kn.enqueue(function(){return t.persistence.Mc(!1),function(n){return w(this,void 0,void 0,function(){var e;return b(this,function(t){switch(t.label){case 0:return(e=n).zo.add(0),[4,Hh(e)];case 1:return t.sent(),e.tu.set("Offline"),[2]}})})}(t.Pu)})},df.prototype.terminate=function(){var t=this;this.kn.ss();var r=new Iu;return this.kn.ts(function(){return w(t,void 0,void 0,function(){var e,n;return b(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.Ia&&this.Ia.stop(),[4,Kh(this.Pu)];case 1:return t.sent(),[4,this.pu.ei()];case 2:return t.sent(),[4,this.persistence.ei()];case 3:return t.sent(),this.credentials.Wr(),r.resolve(),[3,5];case 4:return e=t.sent(),n=_u(e,"Failed to shutdown persistence"),r.reject(n),[3,5];case 5:return[2]}})})}),r.promise},df.prototype.waitForPendingWrites=function(){var t=this;this.Ih();var e=new Iu;return this.kn.Qn(function(){return function(a,u){return w(this,void 0,void 0,function(){var n,r,i,o,s;return b(this,function(t){switch(t.label){case 0:ec((n=a).Pu)||Vr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Qo).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.hi.Gu(t)})];case 2:return-1===(r=t.sent())?[2,void u.resolve()]:((i=n.Nu.get(r)||[]).push(u),n.Nu.set(r,i),[3,4]);case 3:return o=t.sent(),s=_u(o,"Initialization of waitForPendingWrites() operation failed"),u.reject(s),[3,4];case 4:return[2]}var e})})}(t.va,e)}),e.promise},df.prototype.listen=function(t,e,n){var r=this;this.Ih();var i=new ll(n),o=new xu(t,i,e);return this.kn.Qn(function(){return Cu(r.Rh,o)}),function(){i.$a(),r.kn.Qn(function(){return Mu(r.Rh,o)})}},df.prototype.Ph=function(e){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return this.Ih(),[4,this.Eh.promise];case 1:return[2,(t.sent(),function(n,a,u){return w(this,void 0,void 0,function(){var s,e=this;return b(this,function(t){switch(t.label){case 0:return s=new Iu,[4,n.enqueue(function(){return w(e,void 0,void 0,function(){var r,i,o;return b(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=u,(n=a).persistence.runTransaction("read document","readonly",function(t){return n.er._i(t,e)}))];case 1:return(r=t.sent())instanceof Ia?s.resolve(r):r instanceof Ta?s.resolve(null):s.reject(new Lr(kr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return i=t.sent(),o=_u(i,"Failed to get document '"+u+" from cache"),s.reject(o),[3,3];case 3:return[2]}var e,n})})})];case 1:return[2,(t.sent(),s.promise)]}})})}(this.kn,this.Qo,e))]}})})},df.prototype.ph=function(a,u){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return this.Ih(),[4,this.Eh.promise];case 1:return[2,(t.sent(),e=this.kn,n=this.Rh,r=a,i=u,o=new Iu,s=gf(e,n,La(r.path),{includeMetadataChanges:!0,bs:!0},{next:function(t){s();var e=t.docs.has(r);!e&&t.fromCache?o.reject(new Lr(kr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&i&&"server"===i.source?o.reject(new Lr(kr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,r,i,o,s})})},df.prototype.gh=function(e){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return this.Ih(),[4,this.Eh.promise];case 1:return[2,(t.sent(),function(n,u,h){return w(this,void 0,void 0,function(){var a,e=this;return b(this,function(t){switch(t.label){case 0:return a=new Iu,[4,n.enqueue(function(){return w(e,void 0,void 0,function(){var e,n,r,i,o,s;return b(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,vh(u,h,!0)];case 1:return e=t.sent(),n=new lc(h,e.gr),r=n.lu(e.documents),i=n.wu(r,!1),a.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=_u(o,"Failed to execute query '"+h+" against cache"),a.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),a.promise)]}})})}(this.kn,this.Qo,e))]}})})},df.prototype.Vh=function(a,u){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return this.Ih(),[4,this.Eh.promise];case 1:return[2,(t.sent(),e=this.kn,n=this.Rh,r=a,i=u,o=new Iu,s=gf(e,n,r,{includeMetadataChanges:!0,bs:!0},{next:function(t){s(),t.fromCache&&i&&"server"===i.source?o.reject(new Lr(kr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,r,i,o,s})})},df.prototype.write=function(t){var e=this;this.Ih();var n=new Iu;return this.kn.Qn(function(){return yc(e.va,t,n)}),n.promise},df.prototype.U=function(){return this.ia.U},df.prototype.bh=function(t){var e=this;this.Ih();var r=new ll(t);return this.kn.Qn(function(){return w(e,void 0,void 0,function(){return b(this,function(t){return[2,(e=this.Rh,n=r,e.Ts.add(n),void n.next())];var e,n})})}),function(){r.$a(),e.kn.Qn(function(){return w(e,void 0,void 0,function(){return b(this,function(t){return[2,void this.Rh.Ts.delete(r)]})})})}},Object.defineProperty(df.prototype,"Sh",{get:function(){return this.kn.Zn},enumerable:!1,configurable:!0}),df.prototype.transaction=function(t){var e=this;this.Ih();var n=new Iu;return this.kn.Qn(function(){return new ff(e.kn,e.jo,t,n).run(),Promise.resolve()}),n.promise},df);function df(t,e){this.credentials=t,this.kn=e,this.clientId=bi.k(),this.Eh=new Iu}function vf(t,e,n,r){this.kn=t,this.jo=e,this.updateFunction=n,this.qn=r,this.fh=5,this.Jn=new Tu(this.kn,"transaction_retry")}function yf(t){this.jo=t,this.ih=new Map,this.mutations=[],this.rh=!1,this.oh=null,this.uh=new Set}function gf(t,e,n,r,i){var o=new ll(i),s=new xu(n,o,r);return t.Qn(function(){return Cu(e,s)}),function(){o.$a(),t.Qn(function(){return Mu(e,s)})}}var mf,wf,bf=(jf.prototype.$h=function(t){switch(Go(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Yo(t.integerValue||t.doubleValue);case 3:return this.Nh(t.timestampValue);case 4:return this.xh(t);case 5:return t.stringValue;case 6:return this.Fh(Xo(t.bytesValue));case 7:return this.kh(t.referenceValue);case 8:return this.Oh(t.geoPointValue);case 9:return this.Mh(t.arrayValue);case 10:return this.qh(t.mapValue);default:throw xr()}},jf.prototype.qh=function(t){var n=this,r={};return Gr(t.fields||{},function(t,e){r[t]=n.$h(e)}),r},jf.prototype.Oh=function(t){return new _l(Yo(t.latitude),Yo(t.longitude))},jf.prototype.Mh=function(t){var e=this;return(t.values||[]).map(function(t){return e.$h(t)})},jf.prototype.xh=function(t){switch(this.Ch){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return xo(n)?t(n):n}(t);return null==e?null:this.$h(e);case"estimate":return this.Nh(qo(t));default:return null}},jf.prototype.Nh=function(t){var e=Ko(t),n=new Vi(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},jf.prototype.kh=function(t){var e=Hr.P(t);qr(Es(e));var n=new _i(e.get(1),e.get(3)),r=new Xr(e.u(5));return n.isEqual(this.U)||Cr("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.U.projectId+"/"+this.U.database+") instead."),this.Dh(r)},jf),Ef=Ju.ki,If=(Mf.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Mf),Tf=(Object.defineProperty(Cf.prototype,"Yh",{get:function(){return this.Jh||(this.Jh=new Yl(this.Ga,this.Hh.ignoreUndefinedProperties)),this.Jh},enumerable:!1,configurable:!0}),Cf.prototype.settings=function(t){ni("Firestore.settings",arguments,1),oi("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.Hh),t)).merge;var e=new If(t);if(this.Wh&&!this.Hh.isEqual(e))throw new Lr(kr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Hh=e).credentials&&(this.zh=function(t){if(!t)return new Th;switch(t.type){case"gapi":var e=t.Xh;return qr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Rh(e,t.Jr||"0");case"provider":return t.Xh;default:throw new Lr(kr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},Cf.prototype.enableNetwork=function(){return this.jh(),this.Wh.enableNetwork()},Cf.prototype.disableNetwork=function(){return this.jh(),this.Wh.disableNetwork()},Cf.prototype.enablePersistence=function(t){var e,n;if(this.Wh)throw new Lr(kr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Cr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new Lr(kr.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Zh(this.Lh,this.Bh,{Pa:!0,cacheSizeBytes:this.Hh.cacheSizeBytes,synchronizeTabs:r,tl:i})},Cf.prototype.clearPersistence=function(){return w(this,void 0,void 0,function(){var n,e=this;return b(this,function(t){if(void 0!==this.Wh&&!this.Wh.Sh)throw new Lr(kr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new Iu,[2,(this.Qh.ts(function(){return w(e,void 0,void 0,function(){var e;return b(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Lh.clearPersistence(this.Ga,this.Kh)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},Cf.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Cf.prototype,"el",{get:function(){return this.jh(),this.Wh.Sh},enumerable:!1,configurable:!0}),Cf.prototype.waitForPendingWrites=function(){return this.jh(),this.Wh.waitForPendingWrites()},Cf.prototype.onSnapshotsInSync=function(t){if(this.jh(),ul(t))return this.Wh.bh(t);oi("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.Wh.bh(e)},Cf.prototype.jh=function(){return this.Wh||this.Zh(new il,new ol,{Pa:!1}),this.Wh},Cf.prototype.nl=function(){return new Li(this.Ga,this.Kh,this.Hh.host,this.Hh.ssl,this.Hh.experimentalForceLongPolling)},Cf.prototype.Zh=function(t,e,n){var r=this.nl();return this.Wh=new pf(this.zh,this.Qh),this.Wh.start(r,t,e,n)},Cf.Gh=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Lr(kr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Lr(kr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new _i(n)},Object.defineProperty(Cf.prototype,"app",{get:function(){if(!this.Uh)throw new Lr(kr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Uh},enumerable:!1,configurable:!0}),Cf.prototype.collection=function(t){return ni("Firestore.collection",arguments,1),oi("Firestore.collection","non-empty string",1,t),this.jh(),new Wf(Hr.P(t),this,null)},Cf.prototype.doc=function(t){return ni("Firestore.doc",arguments,1),oi("Firestore.doc","non-empty string",1,t),this.jh(),Rf.sl(Hr.P(t),this,null)},Cf.prototype.collectionGroup=function(t){if(ni("Firestore.collectionGroup",arguments,1),oi("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Lr(kr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.jh(),new Bf((e=t,new ka(Hr.p(),e)),this,null);var e},Cf.prototype.runTransaction=function(e){var n=this;return ni("Firestore.runTransaction",arguments,1),oi("Firestore.runTransaction","function",1,e),this.jh().transaction(function(t){return e(new Af(n,t))})},Cf.prototype.batch=function(){return this.jh(),new Nf(this)},Object.defineProperty(Cf,"logLevel",{get:function(){switch(Ur()){case a.DEBUG:return"debug";case a.ERROR:return"error";case a.SILENT:return"silent";case a.WARN:return"warn";case a.INFO:return"info";case a.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),Cf.setLogLevel=function(t){ni("Firestore.setLogLevel",arguments,1),ci("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Pr.setLogLevel(t)},Cf.prototype.il=function(){return this.Hh.timestampsInSnapshots},Cf.prototype.rl=function(){return this.Hh},Cf),Af=(Vf.prototype.get=function(t){var n=this;ni("Transaction.get",arguments,1);var r=$f("Transaction.get",t,this.ol);return this.ul.ah([r.Ka]).then(function(t){if(!t||1!==t.length)return xr();var e=t[0];if(e instanceof Ta)return new Of(n.ol,r.Ka,null,!1,!1,r.za);if(e instanceof Ia)return new Of(n.ol,r.Ka,e,!1,!1,r.za);throw xr()})},Vf.prototype.set=function(t,e,n){ii("Transaction.set",arguments,2,3);var r=$f("Transaction.set",t,this.ol);n=Xf("Transaction.set",n);var i=tp(r.za,e,n),o=Zl(this.ol.Yh,"Transaction.set",r.Ka,i,null!==r.za,n);return this.ul.set(r.Ka,o),this},Vf.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof pl?(ri("Transaction.update",arguments,3),r=$f("Transaction.update",t,this.ol),tf(this.ol.Yh,"Transaction.update",r.Ka,e,n,o)):(ni("Transaction.update",arguments,2),r=$f("Transaction.update",t,this.ol),$l(this.ol.Yh,"Transaction.update",r.Ka,e)),this.ul.update(r.Ka,i),this},Vf.prototype.delete=function(t){ni("Transaction.delete",arguments,1);var e=$f("Transaction.delete",t,this.ol);return this.ul.delete(e.Ka),this},Vf),Nf=(Uf.prototype.set=function(t,e,n){ii("WriteBatch.set",arguments,2,3),this.hl();var r=$f("WriteBatch.set",t,this.ol);n=Xf("WriteBatch.set",n);var i=tp(r.za,e,n),o=Zl(this.ol.Yh,"WriteBatch.set",r.Ka,i,null!==r.za,n);return this.cl=this.cl.concat(o.Ha(r.Ka,Bs.He())),this},Uf.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.hl(),i="string"==typeof e||e instanceof pl?(ri("WriteBatch.update",arguments,3),r=$f("WriteBatch.update",t,this.ol),tf(this.ol.Yh,"WriteBatch.update",r.Ka,e,n,o)):(ni("WriteBatch.update",arguments,2),r=$f("WriteBatch.update",t,this.ol),$l(this.ol.Yh,"WriteBatch.update",r.Ka,e)),this.cl=this.cl.concat(i.Ha(r.Ka,Bs.exists(!0))),this},Uf.prototype.delete=function(t){ni("WriteBatch.delete",arguments,1),this.hl();var e=$f("WriteBatch.delete",t,this.ol);return this.cl=this.cl.concat(new ca(e.Ka,Bs.He())),this},Uf.prototype.commit=function(){return this.hl(),this.al=!0,0<this.cl.length?this.ol.jh().write(this.cl):Promise.resolve()},Uf.prototype.hl=function(){if(this.al)throw new Lr(kr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Uf),Rf=(o(_f,wf=Vl),_f.sl=function(t,e,n){if(t.length%2!=0)throw new Lr(kr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.R()+" has "+t.length);return new _f(new Xr(t),e,n)},Object.defineProperty(_f.prototype,"id",{get:function(){return this.Ka.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(_f.prototype,"parent",{get:function(){return new Wf(this.Ka.path.h(),this.firestore,this.za)},enumerable:!1,configurable:!0}),Object.defineProperty(_f.prototype,"path",{get:function(){return this.Ka.path.R()},enumerable:!1,configurable:!0}),_f.prototype.collection=function(t){if(ni("DocumentReference.collection",arguments,1),oi("DocumentReference.collection","non-empty string",1,t),!t)throw new Lr(kr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Hr.P(t);return new Wf(this.Ka.path.child(e),this.firestore,null)},_f.prototype.isEqual=function(t){if(!(t instanceof _f))throw yi("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Ka.isEqual(t.Ka)&&this.za===t.za},_f.prototype.set=function(t,e){ii("DocumentReference.set",arguments,1,2),e=Xf("DocumentReference.set",e);var n=tp(this.za,t,e),r=Zl(this.firestore.Yh,"DocumentReference.set",this.Ka,n,null!==this.za,e);return this.Wh.write(r.Ha(this.Ka,Bs.He()))},_f.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof pl?(ri("DocumentReference.update",arguments,2),tf(this.firestore.Yh,"DocumentReference.update",this.Ka,t,e,r)):(ni("DocumentReference.update",arguments,1),$l(this.firestore.Yh,"DocumentReference.update",this.Ka,t)),this.Wh.write(n.Ha(this.Ka,Bs.exists(!0)))},_f.prototype.delete=function(){return ni("DocumentReference.delete",arguments,0),this.Wh.write([new ca(this.Ka,Bs.He())])},_f.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];ii("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||ul(i[a])||(vi("DocumentReference.onSnapshot",s=i[a],["includeMetadataChanges"]),ui("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),a++);var u,h={includeMetadataChanges:s.includeMetadataChanges};ul(i[a])?(u=i[a],i[a]=null===(t=u.next)||void 0===t?void 0:t.bind(u),i[a+1]=null===(e=u.error)||void 0===e?void 0:e.bind(u),i[a+2]=null===(n=u.complete)||void 0===n?void 0:n.bind(u)):(oi("DocumentReference.onSnapshot","function",a,i[a]),si("DocumentReference.onSnapshot","function",a+1,i[a+1]),si("DocumentReference.onSnapshot","function",a+2,i[a+2]));var c={next:function(t){i[a]&&i[a](r.ll(t))},error:i[a+1],complete:i[a+2]};return this.Wh.listen(La(this.Ka.path),h,c)},_f.prototype.get=function(t){var e=this;ii("DocumentReference.get",arguments,0,1),Zf("DocumentReference.get",t);var n=this.firestore.jh();return t&&"cache"===t.source?n.Ph(this.Ka).then(function(t){return new Of(e.firestore,e.Ka,t,!0,t instanceof Ia&&t.Ye,e.za)}):n.ph(this.Ka,t).then(function(t){return e.ll(t)})},_f.prototype.withConverter=function(t){return new _f(this.Ka,this.firestore,t)},_f.prototype.ll=function(t){var e=t.docs.get(this.Ka);return new Of(this.firestore,this.Ka,e,t.fromCache,t.hasPendingWrites,this.za)},_f),Sf=(Pf.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Pf),Of=(Df.prototype.data=function(t){var e=this;if(ii("DocumentSnapshot.data",arguments,0,1),t=Jf("DocumentSnapshot.data",t),this._l){if(this.za){var n=new kf(this.ol,this.Ka,this._l,this.fl,this.dl,null);return this.za.fromFirestore(n,t)}return new bf(this.ol.Ga,this.ol.il(),t.serverTimestamps||"none",function(t){return new Rf(t,e.ol,null)},function(t){return new Pi(t)}).$h(this._l.sn())}},Df.prototype.get=function(t,e){var n=this;if(ii("DocumentSnapshot.get",arguments,1,2),e=Jf("DocumentSnapshot.get",e),this._l){var r=this._l.data().field(af("DocumentSnapshot.get",t,this.Ka));if(null!==r)return new bf(this.ol.Ga,this.ol.il(),e.serverTimestamps||"none",function(t){return new Rf(t,n.ol,n.za)},function(t){return new Pi(t)}).$h(r)}},Object.defineProperty(Df.prototype,"id",{get:function(){return this.Ka.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Df.prototype,"ref",{get:function(){return new Rf(this.Ka,this.ol,this.za)},enumerable:!1,configurable:!0}),Object.defineProperty(Df.prototype,"exists",{get:function(){return null!==this._l},enumerable:!1,configurable:!0}),Object.defineProperty(Df.prototype,"metadata",{get:function(){return new Sf(this.dl,this.fl)},enumerable:!1,configurable:!0}),Df.prototype.isEqual=function(t){if(!(t instanceof Df))throw yi("isEqual","DocumentSnapshot",1,t);return this.ol===t.ol&&this.fl===t.fl&&this.Ka.isEqual(t.Ka)&&(null===this._l?null===t._l:this._l.isEqual(t._l))&&this.za===t.za},Df),kf=(o(Lf,mf=Of),Lf.prototype.data=function(t){return mf.prototype.data.call(this,t)},Lf);function Lf(){return null!==mf&&mf.apply(this,arguments)||this}function Df(t,e,n,r,i,o){this.ol=t,this.Ka=e,this._l=n,this.fl=r,this.dl=i,this.za=o}function Pf(t,e){this.hasPendingWrites=t,this.fromCache=e}function _f(t,e,n){var r=this;return(r=wf.call(this,e.Ga,t,n)||this).Ka=t,r.firestore=e,r.za=n,r.Wh=r.firestore.jh(),r}function Uf(t){this.ol=t,this.cl=[],this.al=!1}function Vf(t,e){this.ol=t,this.ul=e}function Cf(t,e,n,r){var i=this;if(void 0===n&&(n=new il),void 0===r&&(r=new ol),this.Lh=n,this.Bh=r,this.Uh=null,this.Qh=new Lu,this.INTERNAL={delete:function(){return w(i,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return this.jh(),[4,this.Wh.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var o=t;this.Uh=o,this.Ga=Cf.Gh(o),this.Kh=o.name,this.zh=new Ah(e)}else{var s=t;if(!s.projectId)throw new Lr(kr.INVALID_ARGUMENT,"Must provide projectId");this.Ga=new _i(s.projectId,s.database),this.Kh="[DEFAULT]",this.zh=new Th}this.Hh=new If({})}function Mf(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new Lr(kr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else ai("settings","non-empty string","host",t.host),this.host=t.host,ui("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(vi("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),ui("settings","object","credentials",t.credentials),this.credentials=t.credentials,ui("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),ui("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Cr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Cr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,ui("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Ju.Mi;else{if(t.cacheSizeBytes!==Ef&&t.cacheSizeBytes<Ju.Oi)throw new Lr(kr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Ju.Oi);this.cacheSizeBytes=t.cacheSizeBytes}ui("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}function jf(t,e,n,r,i){this.U=t,this.timestampsInSnapshots=e,this.Ch=n,this.Dh=r,this.Fh=i}function xf(t,e,n){if("string"==typeof n){if(""===n)throw new Lr(kr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Va(e)&&-1!==n.indexOf("/"))throw new Lr(kr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Hr.P(n));if(!Xr.$(r))throw new Lr(kr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Jo(t,new Xr(r))}if(n instanceof Vl)return Jo(t,n.Ka);throw new Lr(kr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+pi(n)+".")}function qf(t,e){if(!Array.isArray(t)||0===t.length)throw new Lr(kr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Lr(kr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new Lr(kr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Lr(kr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function Ff(t,e,n){if(!n.isEqual(e))throw new Lr(kr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Gf(t){if(Pa(t)&&0===t.rn.length)throw new Lr(kr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var zf,Bf=(Yf.prototype.where=function(t,e,n){var r;ni("Query.where",arguments,3),di("Query.where",3,n),r="not-in"===e||"!="===e?e:ci("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e);var i,o,s=af("Query.where",t),a=function(t,e,n,r,i,o){var s;if(r.V()){if("array-contains"===i||"array-contains-any"===i)throw new Lr(kr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){qf(o,i);for(var a=[],u=0,h=o;u<h.length;u++){var c=h[u];a.push(xf(n,t,c))}s={arrayValue:{values:a}}}else s=xf(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||qf(o,i),s=ef(e,"Query.where",o,"in"===i||"not-in"===i);var l=Ha.create(r,i,s);return function(t,e){if(e.an()){var n=Ua(t);if(null!==n&&!n.isEqual(e.field))throw new Lr(kr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=_a(t);null!==r&&Ff(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==i)throw i===e.op?new Lr(kr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Lr(kr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,l),l}(this.wl,this.firestore.Yh,this.firestore.Ga,s,r,n);return new Yf((o=(i=this.wl).filters.concat([a]),new ka(i.path,i.collectionGroup,i.rn.slice(),o,i.limit,i.on,i.startAt,i.endAt)),this.firestore,this.za)},Yf.prototype.orderBy=function(t,e){var n;if(ii("Query.orderBy",arguments,1,2),si("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Lr(kr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var r,i,o=af("Query.orderBy",t),s=function(t,e,n){if(null!==t.startAt)throw new Lr(kr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Lr(kr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r,i,o=new Eu(e,n),s=o;return null!==_a(r=t)||null!==(i=Ua(r))&&Ff(0,i,s.field),o}(this.wl,o,n);return new Yf((i=(r=this.wl).rn.concat([s]),new ka(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.on,r.startAt,r.endAt)),this.firestore,this.za)},Yf.prototype.limit=function(t){return ni("Query.limit",arguments,1),oi("Query.limit","number",1,t),gi("Query.limit",1,t),new Yf(ja(this.wl,t,"F"),this.firestore,this.za)},Yf.prototype.limitToLast=function(t){return ni("Query.limitToLast",arguments,1),oi("Query.limitToLast","number",1,t),gi("Query.limitToLast",1,t),new Yf(ja(this.wl,t,"L"),this.firestore,this.za)},Yf.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ri("Query.startAt",arguments,1);var r=this.ml("Query.startAt",t,e,!0);return new Yf(xa(this.wl,r),this.firestore,this.za)},Yf.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ri("Query.startAfter",arguments,1);var r=this.ml("Query.startAfter",t,e,!1);return new Yf(xa(this.wl,r),this.firestore,this.za)},Yf.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ri("Query.endBefore",arguments,1);var r=this.ml("Query.endBefore",t,e,!0);return new Yf(qa(this.wl,r),this.firestore,this.za)},Yf.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ri("Query.endAt",arguments,1);var r=this.ml("Query.endAt",t,e,!1);return new Yf(qa(this.wl,r),this.firestore,this.za)},Yf.prototype.isEqual=function(t){if(!(t instanceof Yf))throw yi("isEqual","Query",1,t);return this.firestore===t.firestore&&Fa(this.wl,t.wl)&&this.za===t.za},Yf.prototype.withConverter=function(t){return new Yf(this.wl,this.firestore,t)},Yf.prototype.ml=function(c,t,e,n){if(di(c,1,t),t instanceof Of)return ni(c,s([t],e),1),function(t,e,n,r){if(!n)throw new Lr(kr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=Ca(t);o<s.length;o++){var a=s[o];if(a.field.V())i.push(Jo(e,n.key));else{var u=n.field(a.field);if(xo(u))throw new Lr(kr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===u){var h=a.field.R();throw new Lr(kr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}i.push(u)}}return new pu(i,r)}(this.wl,this.firestore.Ga,t._l,n);var r=[t].concat(e);return function(t,e,n,r,i,o){var s=t.rn;if(i.length>s.length)throw new Lr(kr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var h=i[u];if(s[u].field.V()){if("string"!=typeof h)throw new Lr(kr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!Va(t)&&-1!==h.indexOf("/"))throw new Lr(kr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(Hr.P(h));if(!Xr.$(c))throw new Lr(kr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");var l=new Xr(c);a.push(Jo(e,l))}else{var f=ef(n,r,h);a.push(f)}}return new pu(a,o)}(this.wl,this.firestore.Ga,this.firestore.Yh,c,r,n)},Yf.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];ii("Query.onSnapshot",arguments,1,4);var s,a={},u=0;"object"!=typeof i[u]||ul(i[u])||(vi("Query.onSnapshot",a=i[u],["includeMetadataChanges"]),ui("Query.onSnapshot","boolean","includeMetadataChanges",a.includeMetadataChanges),u++),ul(i[u])?(s=i[u],i[u]=null===(t=s.next)||void 0===t?void 0:t.bind(s),i[u+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),i[u+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(oi("Query.onSnapshot","function",u,i[u]),si("Query.onSnapshot","function",u+1,i[u+1]),si("Query.onSnapshot","function",u+2,i[u+2]));var h={next:function(t){i[u]&&i[u](new Qf(r.firestore,r.wl,t,r.za))},error:i[u+1],complete:i[u+2]};return Gf(this.wl),this.firestore.jh().listen(this.wl,a,h)},Yf.prototype.get=function(t){var e=this;ii("Query.get",arguments,0,1),Zf("Query.get",t),Gf(this.wl);var n=this.firestore.jh();return(t&&"cache"===t.source?n.gh(this.wl):n.Vh(this.wl,t)).then(function(t){return new Qf(e.firestore,e.wl,t,e.za)})},Yf),Qf=(Object.defineProperty(Kf.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Kf.prototype,"empty",{get:function(){return this.El.docs.m()},enumerable:!1,configurable:!0}),Object.defineProperty(Kf.prototype,"size",{get:function(){return this.El.docs.size},enumerable:!1,configurable:!0}),Kf.prototype.forEach=function(e,n){var r=this;ii("QuerySnapshot.forEach",arguments,1,2),oi("QuerySnapshot.forEach","function",1,e),this.El.docs.forEach(function(t){e.call(n,r.Rl(t,r.metadata.fromCache,r.El.Qt.has(t.key)))})},Object.defineProperty(Kf.prototype,"query",{get:function(){return new Bf(this.Tl,this.ol,this.za)},enumerable:!1,configurable:!0}),Kf.prototype.docChanges=function(t){t&&(vi("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),ui("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.El.Wt)throw new Lr(kr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Il&&this.Al===e||(this.Il=function(i,e,o){if(i.Ut.m()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Ut;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return xr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.El,e,this.Rl.bind(this)),this.Al=e),this.Il},Kf.prototype.isEqual=function(t){if(!(t instanceof Kf))throw yi("isEqual","QuerySnapshot",1,t);return this.ol===t.ol&&Fa(this.Tl,t.Tl)&&this.El.isEqual(t.El)&&this.za===t.za},Kf.prototype.Rl=function(t,e,n){return new kf(this.ol,t.key,t,e,n,this.za)},Kf),Wf=(o(Hf,zf=Bf),Object.defineProperty(Hf.prototype,"id",{get:function(){return this.wl.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Hf.prototype,"parent",{get:function(){var t=this.wl.path.h();return t.m()?null:new Rf(new Xr(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Hf.prototype,"path",{get:function(){return this.wl.path.R()},enumerable:!1,configurable:!0}),Hf.prototype.doc=function(t){ii("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=bi.k()),oi("CollectionReference.doc","non-empty string",1,t);var e=Hr.P(t);return Rf.sl(this.wl.path.child(e),this.firestore,this.za)},Hf.prototype.add=function(t){ni("CollectionReference.add",arguments,1),oi("CollectionReference.add","object",1,this.za?this.za.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},Hf.prototype.withConverter=function(t){return new Hf(this.yl,this.firestore,t)},Hf);function Hf(t,e,n){var r=this;if(((r=zf.call(this,La(t),e,n)||this).yl=t).length%2!=1)throw new Lr(kr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.R()+" has "+t.length);return r}function Kf(t,e,n,r){this.ol=t,this.Tl=e,this.El=n,this.za=r,this.Il=null,this.Al=null,this.metadata=new Sf(n.hasPendingWrites,n.fromCache)}function Yf(t,e,n){this.wl=t,this.firestore=e,this.za=n}function Xf(t,e){if(void 0===e)return{merge:!1};if(vi(t,e,["merge","mergeFields"]),ui(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Lr(kr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+pi(n));for(var r,i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof pl))throw new Lr(kr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+pi(n[i]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Lr(kr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function Jf(t,e){return void 0===e?{}:(vi(t,e,["serverTimestamps"]),hi(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Zf(t,e){si(t,"object",1,e),e&&(vi(t,e,["source"]),hi(t,0,"source",e.source,["default","server","cache"]))}function $f(t,e,n){if(e instanceof Vl){if(e.firestore!==n)throw new Lr(kr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw yi(t,"DocumentReference",1,e)}function tp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var ep,np={Firestore:Tf,GeoPoint:_l,Timestamp:Vi,Blob:Pi,Transaction:Af,WriteBatch:Nf,DocumentReference:Rf,DocumentSnapshot:Of,Query:Bf,QueryDocumentSnapshot:kf,QuerySnapshot:Qf,CollectionReference:Wf,FieldPath:pl,FieldValue:Dl,setLogLevel:Tf.setLogLevel,CACHE_SIZE_UNLIMITED:Ef};(ep=r.default).INTERNAL.registerComponent(new Rr("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new Tf(e,n,new il,new ol);var e,n},"PUBLIC").setServiceProps(Object.assign({},np))),ep.registerVersion("@firebase/firestore","1.16.7-202088235442")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t=t||self).firebase)}(this,function(fp){"use strict";try{(function(){fp=fp&&Object.prototype.hasOwnProperty.call(fp,"default")?fp.default:fp;var t,p,e,r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function d(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function i(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=a[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(e=p=p||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";var o={debug:p.DEBUG,verbose:p.VERBOSE,info:p.INFO,warn:p.WARN,error:p.ERROR,silent:p.SILENT},u=p.INFO,a=((t={})[p.DEBUG]="log",t[p.VERBOSE]="log",t[p.INFO]="info",t[p.WARN]="warn",t[p.ERROR]="error",t),h=(Object.defineProperty(c.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in p))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!0,configurable:!0}),c.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(c.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!0,configurable:!0}),c.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.DEBUG],t)),this._logHandler.apply(this,s([this,p.DEBUG],t))},c.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.VERBOSE],t)),this._logHandler.apply(this,s([this,p.VERBOSE],t))},c.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.INFO],t)),this._logHandler.apply(this,s([this,p.INFO],t))},c.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.WARN],t)),this._logHandler.apply(this,s([this,p.WARN],t))},c.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.ERROR],t)),this._logHandler.apply(this,s([this,p.ERROR],t))},c);function c(t){this.name=t,this._logLevel=u,this._logHandler=i,this._userLogHandler=null}function g(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var f,m=(n(l,f=Error),l);function l(t,e){var n=f.call(this,e)||this;return n.code=t,n.name="FirebaseError",Object.setPrototypeOf(n,l.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,w.prototype.create),n}var w=(b.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(r=i,s.replace(E,function(t,e){var n=r[e];return null!=n?n.toString():"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new m(o,a),c=0,f=Object.keys(i);c<f.length;c++){var l=f[c];"_"!==l.slice(-1)&&(l in h&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),h[l]=i[l])}return h},b);function b(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g,T=(I.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},I.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},I.prototype.setServiceProps=function(t){return this.serviceProps=t,this},I);function I(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}function N(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,_="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S=S||{},R=_||self;function D(){}function P(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function x(t){var e=P(t);return"array"==e||"object"==e&&"number"==typeof t.length}function O(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var k="closure_uid_"+(1e9*Math.random()>>>0),L=0;function V(t,e,n){return t.call.apply(t.bind,arguments)}function C(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function M(t,e,n){return(M=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?V:C).apply(null,arguments)}function U(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var j=Date.now||function(){return+new Date};function F(t,e){function n(){}n.prototype=e.prototype,t.M=e.prototype,t.prototype=new n,t.prototype.constructor=t}function q(){this.j=this.j,this.i=this.i}q.prototype.j=!1,q.prototype.da=function(){!this.j&&(this.j=!0,this.C(),0)&&(Object.prototype.hasOwnProperty.call(this,k)&&this[k]||(this[k]=++L))},q.prototype.C=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var B=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function z(t){return Array.prototype.concat.apply([],arguments)}function W(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function Q(t){return/^[\s\xa0]*$/.test(t)}var K,Y=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function H(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}t:{var J=R.navigator;if(J){var $=J.userAgent;if($){K=$;break t}}K=""}function Z(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function tt(t){var e={};for(var n in t)e[n]=t[n];return e}var et="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function nt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<et.length;o++)n=et[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function rt(t){return rt[" "](t),t}rt[" "]=D;var it,ot,st=H(K,"Opera"),ut=H(K,"Trident")||H(K,"MSIE"),at=H(K,"Edge"),ht=at||ut,ct=H(K,"Gecko")&&!(H(K.toLowerCase(),"webkit")&&!H(K,"Edge"))&&!(H(K,"Trident")||H(K,"MSIE"))&&!H(K,"Edge"),ft=H(K.toLowerCase(),"webkit")&&!H(K,"Edge");function lt(){var t=R.document;return t?t.documentMode:void 0}t:{var pt="",dt=(ot=K,ct?/rv:([^\);]+)(\)|;)/.exec(ot):at?/Edge\/([\d\.]+)/.exec(ot):ut?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ot):ft?/WebKit\/(\S+)/.exec(ot):st?/(?:Version)[ \/]?(\S+)/.exec(ot):void 0);if(dt&&(pt=dt?dt[1]:""),ut){var yt=lt();if(null!=yt&&yt>parseFloat(pt)){it=String(yt);break t}}it=pt}var vt={};function gt(u){return t=u,e=function(){for(var t=0,e=Y(String(it)).split("."),n=Y(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=vt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var mt=R.document&&ut&&(lt()||parseInt(it,10))||void 0,wt=!ut||9<=Number(mt),bt=ut&&!gt("9"),Et=function(){if(!R.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{R.addEventListener("test",D,e),R.removeEventListener("test",D,e)}catch(t){}return t}();function Tt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function It(t,e){if(Tt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ct){t:{try{rt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Nt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Tt.prototype.b=function(){this.defaultPrevented=!0},F(It,Tt);var Nt={2:"touch",3:"pen",4:"mouse"};It.prototype.b=function(){It.M.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,bt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var At="closure_listenable_"+(1e6*Math.random()|0),_t=0;function St(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.aa=i,this.key=++_t,this.V=this.X=!1}function Rt(t){t.V=!0,t.listener=null,t.proxy=null,t.src=null,t.aa=null}function Dt(t){this.src=t,this.a={},this.b=0}function Pt(t,e){var n,r,i,o=e.type;o in t.a&&(r=t.a[o],(n=0<=(i=B(r,e)))&&Array.prototype.splice.call(r,i,1),n&&(Rt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function xt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.V&&o.listener==e&&o.capture==!!n&&o.aa==r)return i}return-1}Dt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=xt(t,e,r,i);return-1<s?(e=t[s],n||(e.X=!1)):((e=new St(e,this.src,o,!!r,i)).X=n,t.push(e)),e};var Ot="closure_lm_"+(1e6*Math.random()|0),kt={};function Lt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Bt(r),e&&e[At]?e.sa(n,r,O(i)?!!i.capture:!!i,o):Vt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Lt(t,e[o],n,r,i);return null}return n=Bt(n),t&&t[At]?t.ra(e,n,O(r)?!!r.capture:!!r,i):Vt(t,e,n,!1,r,i)}function Vt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=O(i)?!!i.capture:!!i;if(s&&!wt)return null;var u,a,h=Ft(t);if(h||(t[Ot]=h=new Dt(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=jt,r=a=wt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)Et||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Mt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ct(t){var e,n,r;"number"!=typeof t&&t&&!t.V&&((e=t.src)&&e[At]?Pt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Mt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ft(e))?(Pt(n,t),0==n.b&&(n.src=null,e[Ot]=null)):Rt(t)))}function Mt(t){return t in kt?kt[t]:kt[t]="on"+t}function Ut(t,e){var n=t.listener,r=t.aa||t.src;return t.X&&Ct(t),n.call(r,e)}function jt(t,e){if(t.V)return!0;if(wt)return Ut(t,new It(e,this));if(!e)t:{e=["window","event"];for(var n=R,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ut(t,e=new It(e,this))}function Ft(t){return(t=t[Ot])instanceof Dt?t:null}var qt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Bt(e){return"function"==P(e)?e:(e[qt]||(e[qt]=function(t){return e.handleEvent(t)}),e[qt])}function Gt(){q.call(this),this.c=new Dt(this),(this.J=this).A=null}function zt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.V&&a.capture==n&&(s=a.listener,u=a.aa||a.src,a.X&&Pt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}F(Gt,q),Gt.prototype[At]=!0,(A=Gt.prototype).addEventListener=function(t,e,n,r){Lt(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=O(i)?!!i.capture:!!i,r=Bt(r),e&&e[At]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=xt(s=e.a[n],r,i,o))&&(Rt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ft(e))&&(n=e.a[n.toString()],e=-1,n&&(e=xt(n,r,i,o)),(r=-1<e?n[e]:null)&&Ct(r))}(this,t,e,n,r)},A.dispatchEvent=function(t){var e,n=this.A;if(n)for(e=[];n;n=n.A)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new Tt(t,n):t instanceof Tt?t.target=t.target||n:(s=t,nt(t=new Tt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=zt(o,r,!0,t)&&s;if(s=zt(o=t.a=n,r,!0,t)&&s,s=zt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=zt(o=t.a=e[i],r,!1,t)&&s;return s},A.C=function(){if(Gt.M.C.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Rt(n[r]);delete e.a[t],e.b--}}this.A=null},A.ra=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.sa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Wt=R.JSON.stringify;function Qt(){this.b=this.a=null}var Kt,Yt=(Ht.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Ht(function(){return new Xt},function(t){t.reset()},100));function Ht(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Xt(){this.next=this.b=this.a=null}function Jt(t){R.setTimeout(function(){throw t},0)}function $t(t,e){var n;Kt||(n=R.Promise.resolve(void 0),Kt=function(){n.then(ee)}),Zt||(Kt(),Zt=!0),te.add(t,e)}Qt.prototype.add=function(t,e){var n=Yt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Xt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Zt=!(Xt.prototype.reset=function(){this.next=this.b=this.a=null}),te=new Qt;function ee(){for(var t,e,n;n=e=void 0,n=null,(e=te).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){Jt(t)}var r=Yt;r.g(t),r.b<r.f&&(r.b++,t.next=r.a,r.a=t)}Zt=!1}function ne(t,e){Gt.call(this),this.b=t||1,this.a=e||R,this.f=M(this.Ua,this),this.g=j()}function re(t){t.Z=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function ie(t,e,n){if("function"==P(t))n&&(t=M(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=M(t.handleEvent,t)}return 2147483647<Number(e)?-1:R.setTimeout(t,e||0)}function oe(t,e,n){q.call(this),this.f=null!=n?M(t,n):t,this.c=e,this.b=M(this.Pa,this),this.a=[]}function se(t){t.T=ie(t.b,t.c),t.f.apply(null,t.a)}function ue(t){q.call(this),this.b=t,this.a={}}F(ne,Gt),(A=ne.prototype).Z=!1,A.L=null,A.Ua=function(){var t;this.Z&&(0<(t=j()-this.g)&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.Z&&(re(this),this.start())))},A.start=function(){this.Z=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=j())},A.C=function(){ne.M.C.call(this),re(this),delete this.a},F(oe,q),(A=oe.prototype).ba=!1,A.T=null,A.Ia=function(t){this.a=arguments,this.T?this.ba=!0:se(this)},A.C=function(){oe.M.C.call(this),this.T&&(R.clearTimeout(this.T),this.T=null,this.ba=!1,this.a=[])},A.Pa=function(){this.T=null,this.ba&&(this.ba=!1,se(this))},F(ue,q);var ae=[];function he(t,e,n,r){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var i=0;i<n.length;i++){var o=Lt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ce(t){Z(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ct(t)},t),t.a={}}function fe(){}ue.prototype.C=function(){ue.M.C.call(this),ce(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var le=null;function pe(){return le=le||new Gt}function de(t){Tt.call(this,"serverreachability",t)}function ye(){var t=pe();t.dispatchEvent(new de(t))}function ve(t){Tt.call(this,"statevent",t)}function ge(){var t=pe();t.dispatchEvent(new ve(t))}function me(t){Tt.call(this,"timingevent",t)}function we(t,e){if("function"!=P(t))throw Error("Fn must not be null and must be a function");return R.setTimeout(function(){t()},e)}F(de,Tt),F(ve,Tt),F(me,Tt);var be={NO_ERROR:0,Va:1,bb:2,ab:3,Ya:4,$a:5,cb:6,za:7,TIMEOUT:8,gb:9},Ee={Xa:"complete",kb:"success",Aa:"error",za:"abort",ib:"ready",jb:"readystatechange",TIMEOUT:"timeout",eb:"incrementaldata",hb:"progress",Za:"downloadprogress",lb:"uploadprogress"};function Te(){}function Ie(t){var e;return(e=t.a)||(e=t.a={}),e}function Ne(){}Te.prototype.a=null;var Ae,_e={OPEN:"a",Wa:"b",Aa:"c",fb:"d"};function Se(){Tt.call(this,"d")}function Re(){Tt.call(this,"c")}function De(){}function Pe(t,e,n){this.g=t,this.W=e,this.U=n||1,this.G=new ue(this),this.N=xe,t=ht?125:void 0,this.O=new ne(t),this.m=null,this.b=!1,this.j=this.A=this.f=this.B=this.s=this.P=this.h=null,this.i=[],this.a=null,this.w=0,this.c=this.v=null,this.H=-1,this.l=!1,this.J=0,this.D=null,this.o=this.R=this.F=!1}F(Se,Tt),F(Re,Tt),F(De,Te),Ae=new De;var xe=45e3,Oe={},ke={};function Le(t,e,n){t.B=1,t.f=en(He(e)),t.j=n,t.F=!0,Ve(t,null)}function Ve(t,e){t.s=j(),Me(t),t.A=He(t.f);var n=t.A,r=t.U;Array.isArray(r)||(r=[String(r)]),yn(n.b,"t",r),t.w=0,t.a=sr(t.g,t.g.w?e:null),0<t.J&&(t.D=new oe(M(t.ya,t,t.a),t.J)),he(t.G,t.a,"readystatechange",t.Sa),e=t.m?tt(t.m):{},t.j?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.$(t.A,t.v,t.j,e)):(t.v="GET",t.a.$(t.A,t.v,null,e)),ye()}function Ce(t,e,n){for(var r,i,o,s,u=!0;!t.l&&t.w<n.length;){var a=(i=n,s=o=void 0,o=(r=t).w,-1==(s=i.indexOf("\n",o))?ke:(o=Number(i.substring(o,s)),isNaN(o)?Oe:(s+=1)+o>i.length?ke:(i=i.substr(s,o),r.w=s+o,i)));if(a==ke){4==e&&(t.c=4,ge(),u=!1);break}if(a==Oe){t.c=4,ge(),u=!1;break}Be(t,a)}4==e&&0==n.length&&(t.c=1,ge(),u=!1),t.b=t.b&&u,u||(qe(t),Fe(t))}function Me(t){t.P=j()+t.N,Ue(t,t.N)}function Ue(t,e){if(null!=t.h)throw Error("WatchDog timer not null");t.h=we(M(t.Qa,t),e)}function je(t){t.h&&(R.clearTimeout(t.h),t.h=null)}function Fe(t){0==t.g.u||t.l||er(t.g,t)}function qe(t){je(t);var e=t.D;e&&"function"==typeof e.da&&e.da(),t.D=null,re(t.O),ce(t.G),t.a&&(e=t.a,t.a=null,e.abort(),e.da())}function Be(t,e){try{var n,r,i,o,s,u,a,h,c,f,l=t.g;if(0!=l.u&&(l.a==t||Tn(l.b,t)))if(l.A=t.H,!t.o&&Tn(l.b,t)&&3==l.u){try{var p=l.ja.a.parse(e)}catch(t){p=null}if(Array.isArray(p)&&3==p.length){var d=p;if(0==d[0]){t:if(!l.i){if(l.a){if(!(l.a.s+3e3<t.s))break t;tr(l),l.a.cancel(),l.a=null}Zn(l),ge()}}else l.ia=d[1],0<l.ia-l.G&&d[2]<37500&&l.U&&0==l.m&&!l.l&&(l.l=we(M(l.Na,l),6e3));if(En(l.b)<=1&&l.O){try{l.O()}catch(t){}l.O=void 0}}else rr(l,11)}else if(!t.o&&l.a!=t||tr(l),!Q(e))for(e=p=l.ja.a.parse(e),p=0;p<e.length;p++){d=e[p],l.G=d[0],d=d[1],2==l.u?"c"==d[0]?(l.B=d[1],l.R=d[2],null!=(n=d[3])&&(l.oa=n),null!=(r=d[5])&&"number"==typeof r&&0<r&&(l.D=1.5*r),i=l,(o=t.a)&&(!(s=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(u=i.b).a&&(H(s,"spdy")||H(s,"quic")||H(s,"h2"))&&(u.f=u.g,u.a=new Set,u.b&&(In(u,u.b),u.b=null)),!i.s||(a=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(i.ha=a,tn(i.v,i.s,a))),l.u=3,l.c&&l.c.na(),h=t,(i=l).ea=or(i,i.w?i.R:null,i.P),h.o?(Nn(i.b,h),c=h,(f=i.D)&&c.setTimeout(f),c.h&&(je(c),Me(c)),i.a=h):$n(i),0<l.f.length&&Yn(l)):"stop"!=d[0]&&"close"!=d[0]||rr(l,7):3==l.u&&("stop"==d[0]||"close"==d[0]?"stop"==d[0]?rr(l,7):Wn(l):"noop"!=d[0]&&l.c&&l.c.ma(d),l.m=0)}ye()}catch(t){}}function Ge(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(x(t)||"string"==typeof t)G(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.I&&"function"==typeof t.I)n=void 0;else if(x(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.I&&"function"==typeof t.I)return t.I();if("string"==typeof t)return t.split("");if(x(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function ze(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof ze)for(n=t.K(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function We(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Qe(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Qe(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Qe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=Pe.prototype).setTimeout=function(t){this.N=t},A.Sa=function(t){t=t.target;var e=this.D;e&&3==qn(t)?e.Ia():this.ya(t)},A.ya=function(t){try{if(t==this.a)t:{var e=qn(this.a),n=this.a.qa();this.a.S();if(!(e<3||3==e&&!ht&&!this.a.Y())){this.l||4!=e||7==n||ye(),je(this);var r=this.a.S();this.H=r;var i=this.a.Y();if(this.b=200==r){if(this.R&&!this.o){e:{if(this.a){var o,s=this.a;if((o=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Q(o)){var u=o;break e}}u=null}if(!u){this.b=!1,this.c=3,ge(),qe(this),Fe(this);break t}this.o=!0,Be(this,u)}this.F?(Ce(this,e,i),ht&&this.b&&3==e&&(he(this.G,this.O,"tick",this.Ra),this.O.start())):Be(this,i),4==e&&qe(this),this.b&&!this.l&&(4==e?er(this.g,this):(this.b=!1,Me(this)))}else 400==r&&0<i.indexOf("Unknown SID")?this.c=3:this.c=0,ge(),qe(this),Fe(this)}}}catch(t){}},A.Ra=function(){var t,e;this.a&&(t=qn(this.a),e=this.a.Y(),this.w<e.length&&(je(this),Ce(this,t,e),this.b&&4!=t&&Me(this)))},A.cancel=function(){this.l=!0,qe(this)},A.Qa=function(){this.h=null;var t=j();0<=t-this.P?(2!=this.B&&(ye(),ge()),qe(this),this.c=2,Fe(this)):Ue(this,this.P-t)},(A=ze.prototype).I=function(){We(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.K=function(){return We(this),this.a.concat()},A.get=function(t,e){return Qe(this.b,t)?this.b[t]:e},A.set=function(t,e){Qe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ke=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ye(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ye?(this.a=void 0!==e?e:t.a,Xe(this,t.f),this.j=t.j,Je(this,t.c),$e(this,t.h),this.g=t.g,e=t.b,(n=new fn).c=e.c,e.a&&(n.a=new ze(e.a),n.b=e.b),Ze(this,n),this.i=t.i):t&&(n=String(t).match(Ke))?(this.a=!!e,Xe(this,n[1]||"",!0),this.j=nn(n[2]||""),Je(this,n[3]||"",!0),$e(this,n[4]),this.g=nn(n[5]||"",!0),Ze(this,n[6]||"",!0),this.i=nn(n[7]||"")):(this.a=!!e,this.b=new fn(null,this.a))}function He(t){return new Ye(t)}function Xe(t,e,n){t.f=n?nn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Je(t,e,n){t.c=n?nn(e,!0):e}function $e(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ze(t,e,n){var r,i;e instanceof fn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(ln(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(pn(this,e),yn(this,n,t))},r)),r.f=i):(n||(e=rn(e,hn)),t.b=new fn(e,t.a))}function tn(t,e,n){t.b.set(e,n)}function en(t){return tn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^j()).toString(36)),t}function nn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function rn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,on),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function on(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ye.prototype.toString=function(){var t=[],e=this.f;e&&t.push(rn(e,sn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(rn(e,sn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(rn(n,"/"==n.charAt(0)?an:un,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",rn(n,cn)),t.join("")};var sn=/[#\/\?@]/g,un=/[#\?:]/g,an=/[#\?]/g,hn=/[#\?@]/g,cn=/#/g;function fn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function ln(u){u.a||(u.a=new ze,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function pn(t,e){ln(t),e=vn(t,e),Qe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Qe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&We(t)))}function dn(t,e){return ln(t),e=vn(t,e),Qe(t.a.b,e)}function yn(t,e,n){pn(t,e),0<n.length&&(t.c=null,t.a.set(vn(t,e),W(n)),t.b+=n.length)}function vn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function gn(t,e){this.b=t,this.a=e}function mn(t){this.g=t||wn,t=R.PerformanceNavigationTiming?0<(t=R.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(R.ca&&R.ca.ua&&R.ca.ua()&&R.ca.ua().mb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(A=fn.prototype).add=function(t,e){ln(this),this.c=null,t=vn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){ln(this),this.a.forEach(function(t,e){G(t,function(t){n.call(r,t,e,this)},this)},this)},A.K=function(){ln(this);for(var t=this.a.I(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.I=function(t){ln(this);var e=[];if("string"==typeof t)dn(this,t)&&(e=z(e,this.a.get(vn(this,t))));else{t=this.a.I();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},A.set=function(t,e){return ln(this),this.c=null,dn(this,t=vn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.I(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.I(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var wn=10;function bn(t){return t.b||t.a&&t.a.size>=t.f}function En(t){return t.b?1:t.a?t.a.size:0}function Tn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function In(t,e){t.a?t.a.add(e):t.b=e}function Nn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function An(t){var e,n;if(null!=t.b)return t.c.concat(t.b.i);if(null==t.a||0===t.a.size)return W(t.c);var r=t.c;try{for(var i=N(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.i)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function _n(){}function Sn(){this.a=new _n}function Rn(t,r,e){var i=e||"";try{Ge(t,function(t,e){var n=t;O(t)&&(n=Wt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}function Dn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}mn.prototype.cancel=function(){var t,e;if(this.c=An(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=N(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},_n.prototype.stringify=function(t){return R.JSON.stringify(t,void 0)},_n.prototype.parse=function(t){return R.JSON.parse(t,void 0)};var Pn=R.JSON.parse;function xn(t){Gt.call(this),this.headers=new ze,this.G=t||null,this.b=!1,this.s=this.a=null,this.D="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.H=On,this.B=this.F=!1}F(xn,Gt);var On="",kn=/^https?$/i,Ln=["POST","PUT"];function Vn(t){return"content-type"==t.toLowerCase()}function Cn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Mn(t),jn(t)}function Mn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Un(t){if(t.b&&void 0!==S&&(!t.s[1]||4!=qn(t)||2!=t.S()))if(t.l&&4==qn(t))ie(t.va,0,t);else if(t.dispatchEvent("readystatechange"),4==qn(t)){t.b=!1;try{var e,n,r,i,o=t.S();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.D).match(Ke)[1]||null)&&R.self&&R.self.location&&(i=(r=R.self.location.protocol).substr(0,r.length-1)),n=!kn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<qn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.S()+"]",Mn(t)}}finally{jn(t)}}}function jn(t,e){if(t.a){Fn(t);var n=t.a,r=t.s[0]?D:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Fn(t){t.a&&t.B&&(t.a.ontimeout=null),t.m&&(R.clearTimeout(t.m),t.m=null)}function qn(t){return t.a?t.a.readyState:0}function Bn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Z(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):tn(t,e,n))}function Gn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function zn(t){this.f=[],this.R=this.ea=this.v=this.P=this.a=this.ha=this.s=this.N=this.h=this.F=this.j=null,this.Fa=this.H=0,this.Ca=Gn("failFast",!1,t),this.U=this.l=this.i=this.g=this.c=null,this.W=!0,this.A=this.ia=this.G=-1,this.J=this.m=this.o=0,this.Ba=Gn("baseRetryDelayMs",5e3,t),this.Ga=Gn("retryDelaySeedMs",1e4,t),this.Da=Gn("forwardChannelMaxRetries",2,t),this.ga=Gn("forwardChannelRequestTimeoutMs",2e4,t),this.Ea=t&&t.nb||void 0,this.D=void 0,this.w=t&&t.supportsCrossDomainXhr||!1,this.B="",this.b=new mn(t&&t.concurrentRequestLimit),this.ja=new Sn,this.fa=t&&t.fastHandshake||!1,t&&t.forceLongPolling&&(this.W=!1),this.O=void 0}function Wn(t){var e,n;Qn(t),3==t.u&&(e=t.H++,tn(n=He(t.v),"SID",t.B),tn(n,"RID",e),tn(n,"TYPE","terminate"),Xn(t,n),(e=new Pe(t,e,void 0)).B=2,e.f=en(He(n)),n=!1,R.navigator&&R.navigator.sendBeacon&&(n=R.navigator.sendBeacon(e.f.toString(),"")),!n&&R.Image&&((new Image).src=e.f,n=!0),n||(e.a=sr(e.g,null),e.a.$(e.f)),e.s=j(),Me(e)),ir(t)}function Qn(t){t.a&&(t.a.cancel(),t.a=null),t.i&&(R.clearTimeout(t.i),t.i=null),tr(t),t.b.cancel(),t.g&&("number"==typeof t.g&&R.clearTimeout(t.g),t.g=null)}function Kn(t,e){t.f.push(new gn(t.Fa++,e)),3==t.u&&Yn(t)}function Yn(t){bn(t.b)||t.g||(t.g=!0,$t(t.xa,t),t.o=0)}function Hn(t,e){var n=e?e.W:t.H++,r=He(t.v);tn(r,"SID",t.B),tn(r,"RID",n),tn(r,"AID",t.G),Xn(t,r),t.h&&t.j&&Bn(r,t.h,t.j),n=new Pe(t,n,t.o+1),null===t.h&&(n.m=t.j),e&&(t.f=e.i.concat(t.f)),e=Jn(t,n,1e3),n.setTimeout(Math.round(.5*t.ga)+Math.round(.5*t.ga*Math.random())),In(t.b,n),Le(n,r,e)}function Xn(t,n){t.c&&Ge({},function(t,e){tn(n,e,t)})}function Jn(t,e,n){n=Math.min(t.f.length,n);var r=t.c?M(t.c.Ha,t.c,t):null;t:for(var i=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{Rn(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.f.splice(0,n),e.i=t,r}function $n(t){t.a||t.i||(t.J=1,$t(t.wa,t),t.m=0)}function Zn(t){return!(t.a||t.i||3<=t.m)&&(t.J++,t.i=we(M(t.wa,t),nr(t,t.m)),t.m++,1)}function tr(t){null!=t.l&&(R.clearTimeout(t.l),t.l=null)}function er(t,e){var n,r=null;if(t.a==e){tr(t),t.a=null;var i=2}else{if(!Tn(t.b,e))return;r=e.i,Nn(t.b,e),i=1}if(t.A=e.H,0!=t.u)if(e.b){1==i?(r=e.j?e.j.length:0,e=j()-e.s,n=t.o,(i=pe()).dispatchEvent(new me(i)),Yn(t)):$n(t)}else if(3==(n=e.c)||0==n&&0<t.A||!(1==i&&function(t,e){if(!(En(t.b)>=t.b.f-(t.g?1:0))){if(t.g)return t.f=e.i.concat(t.f),1;if(!(1==t.u||2==t.u||t.o>=(t.Ca?0:t.Da)))return t.g=we(M(t.xa,t,e),nr(t,t.o)),t.o++,1}}(t,e)||2==i&&Zn(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:rr(t,5);break;case 4:rr(t,10);break;case 3:rr(t,6);break;default:rr(t,2)}}function nr(t,e){var n=t.Ba+Math.floor(Math.random()*t.Ga);return t.c||(n*=2),n*e}function rr(t,e){var n,r,i,o,s,u;2==e?(n=null,t.c&&(n=null),r=M(t.Ta,t),n||(n=new Ye("//www.google.com/images/cleardot.gif"),R.location&&"http"==R.location.protocol||Xe(n,"https"),en(n)),i=n.toString(),o=r,u=new fe,R.Image?((s=new Image).onload=U(Dn,u,s,"TestLoadImage: loaded",!0,o),s.onerror=U(Dn,u,s,"TestLoadImage: error",!1,o),s.onabort=U(Dn,u,s,"TestLoadImage: abort",!1,o),s.ontimeout=U(Dn,u,s,"TestLoadImage: timeout",!1,o),R.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=i):o(!1)):ge(),t.u=0,t.c&&t.c.la(e),ir(t),Qn(t)}function ir(t){t.u=0,t.A=-1,t.c&&(0==An(t.b).length&&0==t.f.length||(t.b.c.length=0,W(t.f),t.f.length=0),t.c.ka())}function or(t,e,n){var r,i,o,s,u,a,h,c=(r=n)instanceof Ye?He(r):new Ye(r,void 0);return""!=c.c?(e&&Je(c,e+"."+c.c),$e(c,c.h)):(o=(i=R.location).protocol,s=e?e+"."+i.hostname:i.hostname,u=+i.port,a=n,h=new Ye(null,void 0),o&&Xe(h,o),s&&Je(h,s),u&&$e(h,u),a&&(h.g=a),c=h),t.N&&Z(t.N,function(t,e){tn(c,e,t)}),e=t.s,n=t.ha,e&&n&&tn(c,e,n),tn(c,"VER",t.oa),Xn(t,c),c}function sr(t,e){if(e&&!t.w)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new xn(t.Ea)).F=t.w,e}function ur(){}function ar(){if(ut&&!(10<=Number(mt)))throw Error("Environmental error: no available transport.")}function hr(t,e){Gt.call(this),this.a=new zn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.j=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.pa&&(t?t["X-WebChannel-Client-Profile"]=e.pa:t={"X-WebChannel-Client-Profile":e.pa}),this.a.F=t,(t=e&&e.httpHeadersOverwriteParam)&&!Q(t)&&(this.a.h=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Q(e)&&(this.a.s=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new lr(this)}function cr(t){Se.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function fr(){Re.call(this),this.status=1}function lr(t){this.a=t}(A=xn.prototype).$=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.G?Ie(this.G):Ie(Ae),this.a.onreadystatechange=M(this.va,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void Cn(this,t)}t=n||"";var i,o=new ze(this.headers);r&&Ge(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Vn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.K()),n=R.FormData&&t instanceof R.FormData,0<=B(Ln,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.H&&(this.a.responseType=this.H),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Fn(this),0<this.o&&((this.B=(i=this.a,ut&&gt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=M(this.ta,this)):this.m=ie(this.ta,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Cn(this,t)}},A.ta=function(){void 0!==S&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),jn(this))},A.C=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),jn(this,!0)),xn.M.C.call(this)},A.va=function(){this.j||(this.w||this.l||this.g?Un(this):this.Oa())},A.Oa=function(){Un(this)},A.S=function(){try{return 2<qn(this)?this.a.status:-1}catch(t){return-1}},A.Y=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Ja=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Pn(e)}},A.qa=function(){return this.h},A.Ma=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=zn.prototype).oa=8,A.u=1,A.xa=function(t){if(this.g)if(this.g=null,1==this.u){if(!t){this.H=Math.floor(1e5*Math.random()),t=this.H++;var e,n=new Pe(this,t,void 0),r=this.j;if(this.F&&(r?nt(r=tt(r),this.F):r=this.F),null===this.h&&(n.m=r),this.fa)t:{for(var i=e=0;i<this.f.length;i++){var o=this.f[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.f.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Jn(this,n,e),tn(i=He(this.v),"RID",t),tn(i,"CVER",22),this.s&&tn(i,"X-HTTP-Session-Id",this.s),Xn(this,i),this.h&&r&&Bn(i,this.h,r),In(this.b,n),this.fa?(tn(i,"$req",e),tn(i,"SID","null"),n.R=!0,Le(n,i,null)):Le(n,i,e),this.u=2}}else 3==this.u&&(t?Hn(this,t):0==this.f.length||bn(this.b)||Hn(this))},A.wa=function(){this.i=null,this.a=new Pe(this,"rpc",this.J),null===this.h&&(this.a.m=this.j),this.a.J=0;var t=He(this.ea);tn(t,"RID","rpc"),tn(t,"SID",this.B),tn(t,"CI",this.U?"0":"1"),tn(t,"AID",this.G),Xn(this,t),tn(t,"TYPE","xmlhttp"),this.h&&this.j&&Bn(t,this.h,this.j),this.D&&this.a.setTimeout(this.D);var e=this.a,n=this.R;e.B=1,e.f=en(He(t)),e.j=null,e.F=!0,Ve(e,n)},A.Na=function(){null!=this.l&&(this.l=null,this.a.cancel(),this.a=null,Zn(this),ge())},A.Ta=function(t){ge()},(A=ur.prototype).na=function(){},A.ma=function(){},A.la=function(){},A.ka=function(){},A.Ha=function(){},ar.prototype.a=function(t,e){return new hr(t,e)},F(hr,Gt),(A=hr.prototype).addEventListener=function(t,e,n,r){hr.M.addEventListener.call(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){hr.M.removeEventListener.call(this,t,e,n,r)},A.Ka=function(){this.a.c=this.f,this.h&&(this.a.w=!0);var t=this.a,e=this.l,n=this.b||void 0;ge(),t.P=e,t.N=n||{},t.U=t.W,t.v=or(t,null,t.P),Yn(t)},A.close=function(){Wn(this.a)},A.La=function(t){var e;"string"==typeof t?((e={}).__data__=t,Kn(this.a,e)):this.g?((e={}).__data__=Wt(t),Kn(this.a,e)):Kn(this.a,t)},A.C=function(){this.a.c=null,delete this.f,Wn(this.a),delete this.a,hr.M.C.call(this)},F(cr,Se),F(fr,Re),F(lr,ur),lr.prototype.na=function(){this.a.dispatchEvent("a")},lr.prototype.ma=function(t){this.a.dispatchEvent(new cr(t))},lr.prototype.la=function(t){this.a.dispatchEvent(new fr)},lr.prototype.ka=function(){this.a.dispatchEvent("b")},ar.prototype.createWebChannel=ar.prototype.a,hr.prototype.send=hr.prototype.La,hr.prototype.open=hr.prototype.Ka,hr.prototype.close=hr.prototype.close,be.NO_ERROR=0,be.TIMEOUT=8,be.HTTP_ERROR=6,Ee.COMPLETE="complete",(Ne.EventType=_e).OPEN="a",_e.CLOSE="b",_e.ERROR="c",_e.MESSAGE="d",Gt.prototype.listen=Gt.prototype.ra,xn.prototype.listenOnce=xn.prototype.sa,xn.prototype.getLastError=xn.prototype.Ma,xn.prototype.getLastErrorCode=xn.prototype.qa,xn.prototype.getStatus=xn.prototype.S,xn.prototype.getResponseJson=xn.prototype.Ja,xn.prototype.getResponseText=xn.prototype.Y,xn.prototype.send=xn.prototype.$;var pr={createWebChannelTransport:function(){return new ar},ErrorCode:be,EventType:Ee,WebChannel:Ne,XhrIo:xn},dr=pr.createWebChannelTransport,yr=pr.ErrorCode,vr=pr.EventType,gr=pr.WebChannel,mr=pr.XhrIo,wr=fp.SDK_VERSION,br=(Er.prototype.t=function(){return null!=this.uid},Er.prototype.s=function(){return this.t()?"uid:"+this.uid:"anonymous-user"},Er.prototype.isEqual=function(t){return t.uid===this.uid},Er);function Er(t){this.uid=t}function Tr(t,e){this.user=e,this.type="OAuth",this.o={},this.o.Authorization="Bearer "+t}br.UNAUTHENTICATED=new br(null),br.i=new br("google-credentials-uid"),br.h=new br("first-party-uid");var Ir,Nr,Ar={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},_r=(n(Gr,Nr=Error),Gr),Sr=(Br.prototype.getToken=function(){return Promise.resolve(null)},Br.prototype._=function(){},Br.prototype.l=function(t){(this.u=t)(br.UNAUTHENTICATED)},Br.prototype.T=function(){this.u=null},Br),Rr=(qr.prototype.getToken=function(){var e=this,n=this.A,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){if(e.A!==n)throw new _r(Ar.ABORTED,"getToken aborted due to token change.");return t?(Ws("string"==typeof t.accessToken),new Tr(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},qr.prototype._=function(){this.forceRefresh=!0},qr.prototype.l=function(t){this.u=t,this.R&&t(this.currentUser)},qr.prototype.T=function(){this.auth&&this.auth.removeAuthTokenListener(this.I),this.I=null,this.u=null},qr.prototype.m=function(){var t=this.auth&&this.auth.getUid();return Ws(null===t||"string"==typeof t),new br(t)},qr),Dr=(Object.defineProperty(Fr.prototype,"o",{get:function(){var t={"X-Goog-AuthUser":this.V},e=this.P.auth.g([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),Fr),Pr=(jr.prototype.getToken=function(){return Promise.resolve(new Dr(this.P,this.V))},jr.prototype.l=function(t){t(br.h)},jr.prototype.T=function(){},jr.prototype._=function(){},jr),xr=(Ur.now=function(){return Ur.fromMillis(Date.now())},Ur.fromDate=function(t){return Ur.fromMillis(t.getTime())},Ur.fromMillis=function(t){var e=Math.floor(t/1e3);return new Ur(e,1e6*(t-1e3*e))},Ur.prototype.toDate=function(){return new Date(this.toMillis())},Ur.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Ur.prototype.p=function(t){return this.seconds===t.seconds?Ys(this.nanoseconds,t.nanoseconds):Ys(this.seconds,t.seconds)},Ur.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Ur.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Ur.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Ur),Or=(Mr.v=function(t){return new Mr(t)},Mr.min=function(){return new Mr(new xr(0,0))},Mr.prototype.S=function(t){return this.timestamp.p(t.timestamp)},Mr.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Mr.prototype.D=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Mr.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Mr.prototype.C=function(){return this.timestamp},Mr),kr=(Object.defineProperty(Cr.prototype,"length",{get:function(){return this.F},enumerable:!0,configurable:!0}),Cr.prototype.isEqual=function(t){return 0===Cr.N(this,t)},Cr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Cr?t.forEach(function(t){e.push(t)}):e.push(t),this.$(e)},Cr.prototype.limit=function(){return this.offset+this.length},Cr.prototype.k=function(t){return t=void 0===t?1:t,this.$(this.segments,this.offset+t,this.length-t)},Cr.prototype.M=function(){return this.$(this.segments,this.offset,this.length-1)},Cr.prototype.L=function(){return this.segments[this.offset]},Cr.prototype.O=function(){return this.get(this.length-1)},Cr.prototype.get=function(t){return this.segments[this.offset+t]},Cr.prototype.B=function(){return 0===this.length},Cr.prototype.q=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Cr.prototype.U=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Cr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Cr.prototype.W=function(){return this.segments.slice(this.offset,this.limit())},Cr.N=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Cr),Lr=(n(Vr,Ir=kr),Vr.prototype.$=function(t,e,n){return new Vr(t,e,n)},Vr.prototype.j=function(){return this.W().join("/")},Vr.prototype.toString=function(){return this.j()},Vr.K=function(t){if(0<=t.indexOf("//"))throw new _r(Ar.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new Vr(t.split("/").filter(function(t){return 0<t.length}))},Vr);function Vr(){return null!==Ir&&Ir.apply(this,arguments)||this}function Cr(t,e,n){void 0===e?e=0:e>t.length&&zs(),void 0===n?n=t.length-e:n>t.length-e&&zs(),this.segments=t,this.offset=e,this.F=n}function Mr(t){this.timestamp=t}function Ur(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new _r(Ar.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new _r(Ar.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new _r(Ar.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new _r(Ar.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function jr(t,e){this.P=t,this.V=e}function Fr(t,e){this.P=t,this.V=e,this.type="FirstParty",this.user=br.h}function qr(t){var e=this;this.I=null,this.currentUser=br.UNAUTHENTICATED,this.R=!1,this.A=0,this.u=null,this.forceRefresh=!1,this.I=function(){e.A++,e.currentUser=e.m(),e.R=!0,e.u&&e.u(e.currentUser)},this.A=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.I):(this.I(null),t.get().then(function(t){e.auth=t,e.I&&e.auth.addAuthTokenListener(e.I)},function(){}))}function Br(){this.u=null}function Gr(t,e){var n=this;return(n=Nr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}Lr.G=new Lr([]);var zr,Wr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Qr=(n(Kr,zr=kr),Kr.prototype.$=function(t,e,n){return new Kr(t,e,n)},Kr.H=function(t){return Wr.test(t)},Kr.prototype.j=function(){return this.W().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),Kr.H(t)||(t="`"+t+"`"),t}).join(".")},Kr.prototype.toString=function(){return this.j()},Kr.prototype.Y=function(){return 1===this.length&&"__name__"===this.get(0)},Kr.J=function(){return new Kr(["__name__"])},Kr.X=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new _r(Ar.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new _r(Ar.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new _r(Ar.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new _r(Ar.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Kr(e)},Kr);function Kr(){return null!==zr&&zr.apply(this,arguments)||this}Qr.G=new Qr([]);var Yr=(Hr.Z=function(t){return new Hr(Lr.K(t).k(5))},Hr.prototype.tt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Hr.prototype.isEqual=function(t){return null!==t&&0===Lr.N(this.path,t.path)},Hr.prototype.toString=function(){return this.path.toString()},Hr.N=function(t,e){return Lr.N(t.path,e.path)},Hr.et=function(t){return t.length%2==0},Hr.st=function(t){return new Hr(new Lr(t.slice()))},Hr);function Hr(t){this.path=t}function Xr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Jr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function $r(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}Yr.EMPTY=new Yr(new Lr([]));var Zr=(ti.fromBase64String=function(t){return new ti(Ms.nt().atob(t))},ti.fromUint8Array=function(t){return new ti(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},ti.prototype.toBase64=function(){return Ms.nt().btoa(this.it)},ti.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.it)},ti.prototype.rt=function(){return 2*this.it.length},ti.prototype.S=function(t){return Ys(this.it,t.it)},ti.prototype.isEqual=function(t){return this.it===t.it},ti);function ti(t){this.it=t}function ei(t){return null==t}function ni(t){return-0===t&&1/t==-1/0}function ri(t){return"number"==typeof t&&Number.isInteger(t)&&!ni(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function ii(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function oi(t){var e=pi(t.mapValue.fields.__local_write_time__.timestampValue);return new xr(e.seconds,e.nanos)}Zr.ht=new Zr("");var si=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ui(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ii(t)?4:10:zs()}function ai(r,i){var t,e,n,o=ui(r);if(o!==ui(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return oi(r).isEqual(oi(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=pi(r.timestampValue),n=pi(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return n=i,yi(r.bytesValue).isEqual(yi(n.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,di((t=r).geoPointValue.latitude)===di(e.geoPointValue.latitude)&&di(t.geoPointValue.longitude)===di(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return di(t.integerValue)===di(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=di(t.doubleValue),r=di(e.doubleValue);return n===r?ni(n)===ni(r):isNaN(n)&&isNaN(r)}return!1}(r,i);case 9:return Hs(r.arrayValue.values||[],i.arrayValue.values||[],ai);case 10:return function(){var t=r.mapValue.fields||{},e=i.mapValue.fields||{};if(Xr(t)!==Xr(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!ai(t[n],e[n])))return!1;return!0}();default:return zs()}}function hi(t,e){return void 0!==(t.values||[]).find(function(t){return ai(t,e)})}function ci(t,e){var n,r,i,o,s,u,a,h,c,f,l=ui(t),p=ui(e);if(l!==p)return Ys(l,p);switch(l){case 0:return 0;case 1:return Ys(t.booleanValue,e.booleanValue);case 2:return h=e,(c=di(t.integerValue||t.doubleValue))<(f=di(h.integerValue||h.doubleValue))?-1:f<c?1:c===f?0:isNaN(c)?isNaN(f)?0:-1:1;case 3:return fi(t.timestampValue,e.timestampValue);case 4:return fi(oi(t),oi(e));case 5:return Ys(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=yi(o),a=yi(s),u.S(a);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Ys(n[i],r[i]);if(0!==o)return o}return Ys(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=Ys(di(n.latitude),di(r.latitude)))?i:Ys(di(n.longitude),di(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=ci(n[i],r[i]);if(o)return o}return Ys(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Ys(r[s],o[s]);if(0!==u)return u;var a=ci(n[r[s]],i[o[s]]);if(0!==a)return a}return Ys(r.length,o.length)}(t.mapValue,e.mapValue);default:throw zs()}}function fi(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ys(t,e);var n=pi(t),r=pi(e),i=Ys(n.seconds,r.seconds);return 0!==i?i:Ys(n.nanos,r.nanos)}function li(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=pi(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?yi(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,Yr.Z(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):zs();var t,e,n}(t)}function pi(t){if(Ws(!!t),"string"!=typeof t)return{seconds:di(t.seconds),nanos:di(t.nanos)};var e,n=0,r=si.exec(t);Ws(!!r),r[1]&&(e=((e=r[1])+"000000000").substr(0,9),n=Number(e));var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:n}}function di(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function yi(t){return"string"==typeof t?Zr.fromBase64String(t):Zr.fromUint8Array(t)}function vi(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.j()}}function gi(t){return t&&"integerValue"in t}function mi(t){return!!t&&"arrayValue"in t}function wi(t){return t&&"nullValue"in t}function bi(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ei(t){return t&&"mapValue"in t}var Ti=(Ii.prototype.ot=function(t,e){return n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},t&&(n.fields.__previous_value__=t),{mapValue:n};var n},Ii.prototype.at=function(t,e){return e},Ii.prototype.ut=function(t){return null},Ii.prototype.isEqual=function(t){return t instanceof Ii},Ii);function Ii(){}Ti.instance=new Ti;var Ni=(Di.prototype.ot=function(t,e){return this.apply(t)},Di.prototype.at=function(t,e){return this.apply(t)},Di.prototype.apply=function(t){for(var n=Pi(t),e=function(e){n.some(function(t){return ai(t,e)})||n.push(e)},r=0,i=this.elements;r<i.length;r++)e(i[r]);return{arrayValue:{values:n}}},Di.prototype.ut=function(t){return null},Di.prototype.isEqual=function(t){return t instanceof Di&&Hs(this.elements,t.elements,ai)},Di),Ai=(Ri.prototype.ot=function(t,e){return this.apply(t)},Ri.prototype.at=function(t,e){return this.apply(t)},Ri.prototype.apply=function(t){for(var n=Pi(t),e=function(e){n=n.filter(function(t){return!ai(t,e)})},r=0,i=this.elements;r<i.length;r++)e(i[r]);return{arrayValue:{values:n}}},Ri.prototype.ut=function(t){return null},Ri.prototype.isEqual=function(t){return t instanceof Ri&&Hs(this.elements,t.elements,ai)},Ri),_i=(Si.prototype.ot=function(t,e){var n=this.ut(t),r=this.asNumber(n)+this.asNumber(this.ct);return gi(n)&&gi(this.ct)?this.serializer._t(r):this.serializer.lt(r)},Si.prototype.at=function(t,e){return e},Si.prototype.ut=function(t){return gi(e=t)||e&&"doubleValue"in e?t:{integerValue:0};var e},Si.prototype.isEqual=function(t){return t instanceof Si&&ai(this.ct,t.ct)},Si.prototype.asNumber=function(t){return di(t.integerValue||t.doubleValue)},Si);function Si(t,e){this.serializer=t,this.ct=e}function Ri(t){this.elements=t}function Di(t){this.elements=t}function Pi(t){return mi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function xi(t,e){this.version=t,this.transformResults=e}var Oi,ki,Li,Vi,Ci,Mi=(io.prototype.dt=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].q(t))return!0;return!1},io.prototype.isEqual=function(t){return Hs(this.fields,t.fields,function(t,e){return t.isEqual(e)})},io),Ui=(ro.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},ro),ji=(no.ft=function(){return new no},no.exists=function(t){return new no(void 0,t)},no.updateTime=function(t){return new no(t)},Object.defineProperty(no.prototype,"Tt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),no.prototype.Et=function(t){return void 0!==this.updateTime?t instanceof bo&&t.version.isEqual(this.updateTime):void 0===this.exists||this.exists===t instanceof bo},no.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},no),Fi=(eo.prototype.wt=function(t){},eo.It=function(t){return t instanceof bo?t.version:Or.min()},eo),qi=(n(to,Ci=Fi),to.prototype.at=function(t,e){this.wt(t);var n=e.version;return new bo(this.key,n,this.value,{hasCommittedMutations:!0})},to.prototype.ot=function(t,e,n){if(this.wt(t),!this.Rt.Et(t))return t;var r=Fi.It(t);return new bo(this.key,r,this.value,{At:!0})},to.prototype.Pt=function(t){return null},to.prototype.isEqual=function(t){return t instanceof to&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.Rt.isEqual(t.Rt)},to),Bi=(n(Zi,Vi=Fi),Zi.prototype.at=function(t,e){if(this.wt(t),!this.Rt.Et(t))return new To(this.key,e.version);var n=this.gt(t);return new bo(this.key,e.version,n,{hasCommittedMutations:!0})},Zi.prototype.ot=function(t,e,n){if(this.wt(t),!this.Rt.Et(t))return t;var r=Fi.It(t),i=this.gt(t);return new bo(this.key,r,i,{At:!0})},Zi.prototype.Pt=function(t){return null},Zi.prototype.isEqual=function(t){return t instanceof Zi&&this.key.isEqual(t.key)&&this.Vt.isEqual(t.Vt)&&this.Rt.isEqual(t.Rt)},Zi.prototype.gt=function(t){var e=t instanceof bo?t.data():Qi.empty();return this.pt(e)},Zi.prototype.pt=function(t){var n=this,r=new Ki(t);return this.Vt.fields.forEach(function(t){var e;t.B()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.yt()},Zi),Gi=(n($i,Li=Fi),$i.prototype.at=function(t,e){if(this.wt(t),Ws(null!=e.transformResults),!this.Rt.Et(t))return new To(this.key,e.version);var n=this.bt(t),r=this.vt(t,e.transformResults),i=e.version,o=this.St(n.data(),r);return new bo(this.key,i,o,{hasCommittedMutations:!0})},$i.prototype.ot=function(t,e,n){if(this.wt(t),!this.Rt.Et(t))return t;var r=this.bt(t),i=this.Dt(n,t,e),o=this.St(r.data(),i);return new bo(this.key,r.version,o,{At:!0})},$i.prototype.Pt=function(t){for(var e=null,n=0,r=this.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof bo?t.field(i.field):void 0,s=i.transform.ut(o||null);null!=s&&(e=null==e?(new Ki).set(i.field,s):e.set(i.field,s))}return e?e.yt():null},$i.prototype.isEqual=function(t){return t instanceof $i&&this.key.isEqual(t.key)&&Hs(this.fieldTransforms,t.fieldTransforms,function(t,e){return t.isEqual(e)})&&this.Rt.isEqual(t.Rt)},$i.prototype.bt=function(t){return t},$i.prototype.vt=function(t,e){var n=[];Ws(this.fieldTransforms.length===e.length);for(var r=0;r<e.length;r++){var i=this.fieldTransforms[r],o=i.transform,s=null;t instanceof bo&&(s=t.field(i.field)),n.push(o.at(s,e[r]))}return n},$i.prototype.Dt=function(t,e,n){for(var r=[],i=0,o=this.fieldTransforms;i<o.length;i++){var s=o[i],u=s.transform,a=null;e instanceof bo&&(a=e.field(s.field)),null===a&&n instanceof bo&&(a=n.field(s.field)),r.push(u.ot(a,t))}return r},$i.prototype.St=function(t,e){for(var n=new Ki(t),r=0;r<this.fieldTransforms.length;r++){var i=this.fieldTransforms[r].field;n.set(i,e[r])}return n.yt()},$i),zi=(n(Ji,ki=Fi),Ji.prototype.at=function(t,e){return this.wt(t),new Eo(this.key,e.version,{hasCommittedMutations:!0})},Ji.prototype.ot=function(t,e,n){return this.wt(t),this.Rt.Et(t)?new Eo(this.key,Or.min()):t},Ji.prototype.Pt=function(t){return null},Ji.prototype.isEqual=function(t){return t instanceof Ji&&this.key.isEqual(t.key)&&this.Rt.isEqual(t.Rt)},Ji),Wi=(n(Xi,Oi=Fi),Xi.prototype.at=function(t,e){zs()},Xi.prototype.ot=function(t,e,n){zs()},Xi.prototype.Pt=function(t){zs()},Xi.prototype.isEqual=function(t){return t instanceof Xi&&this.key.isEqual(t.key)&&this.Rt.isEqual(t.Rt)},Xi),Qi=(Hi.empty=function(){return new Hi({mapValue:{}})},Hi.prototype.field=function(t){if(t.B())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Ei(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.O()])||null},Hi.prototype.isEqual=function(t){return ai(this.proto,t.proto)},Hi),Ki=(Yi.prototype.set=function(t,e){return this.Nt(t,e),this},Yi.prototype.delete=function(t){return this.Nt(t,null),this},Yi.prototype.Nt=function(t,e){for(var n=this.Ft,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map||(o=o&&10===ui(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),n=o}n.set(t.O(),e)},Yi.prototype.yt=function(){var t=this.$t(Qr.G,this.Ft);return null!=t?new Qi(t):this.Ct},Yi.prototype.$t=function(r,t){var i=this,o=!1,e=this.Ct.field(r),s=Ei(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.$t(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Yi);function Yi(t){void 0===t&&(t=Qi.empty()),this.Ct=t,this.Ft=new Map}function Hi(t){this.proto=t}function Xi(t,e){var n=this;return(n=Oi.call(this)||this).key=t,n.Rt=e,n.type=4,n}function Ji(t,e){var n=this;return(n=ki.call(this)||this).key=t,n.Rt=e,n.type=3,n}function $i(t,e){var n=this;return(n=Li.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Rt=ji.exists(!0),n}function Zi(t,e,n,r){var i=this;return(i=Vi.call(this)||this).key=t,i.data=e,i.Vt=n,i.Rt=r,i.type=1,i}function to(t,e,n){var r=this;return(r=Ci.call(this)||this).key=t,r.value=e,r.Rt=n,r.type=0,r}function eo(){}function no(t,e){this.updateTime=t,this.exists=e}function ro(t,e){this.field=t,this.transform=e}function io(t){(this.fields=t).sort(Qr.N)}function oo(t){var u=[];return Jr(t.fields||{},function(t,e){var n=new Qr([t]);if(Ei(e)){var r=oo(e.mapValue).fields;if(0===r.length)u.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];u.push(n.child(s))}}else u.push(n)}),new Mi(u)}function so(t,e){this.key=t,this.version=e}function uo(t){this.count=t}var ao,ho,co,fo,lo,po,yo,vo,go,mo,wo,bo=(n(Ko,wo=so),Ko.prototype.field=function(t){return this.kt.field(t)},Ko.prototype.data=function(){return this.kt},Ko.prototype.Mt=function(){return this.kt.proto},Ko.prototype.isEqual=function(t){return t instanceof Ko&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.At===t.At&&this.hasCommittedMutations===t.hasCommittedMutations&&this.kt.isEqual(t.kt)},Ko.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.kt.toString()+", {hasLocalMutations: "+this.At+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Ko.prototype,"hasPendingWrites",{get:function(){return this.At||this.hasCommittedMutations},enumerable:!0,configurable:!0}),Ko),Eo=(n(Qo,mo=so),Qo.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Qo.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),Qo.prototype.isEqual=function(t){return t instanceof Qo&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Qo),To=(n(Wo,go=so),Wo.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Wo.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),Wo.prototype.isEqual=function(t){return t instanceof Wo&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Wo),Io=(zo.prototype.canonicalId=function(){var t;return null===this.xt&&(t=this.path.j(),null!==this.collectionGroup&&(t+="|cg:"+this.collectionGroup),t+="|f:",t+=this.filters.map(function(t){return t.canonicalId()}).join(","),t+="|ob:",t+=this.orderBy.map(function(t){return t.canonicalId()}).join(","),ei(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.xt=t),this.xt},zo.prototype.toString=function(){var t=this.path.j();return null!==this.collectionGroup&&(t+=" collectionGroup="+this.collectionGroup),0<this.filters.length&&(t+=", filters: ["+this.filters.join(", ")+"]"),ei(this.limit)||(t+=", limit: "+this.limit),0<this.orderBy.length&&(t+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),"Target("+t+")"},zo.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(var n=0;n<this.filters.length;n++)if(!this.filters[n].isEqual(t.filters[n]))return!1;return this.collectionGroup===t.collectionGroup&&!!this.path.isEqual(t.path)&&!!(null!==this.startAt?this.startAt.isEqual(t.startAt):null===t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)},zo.prototype.Lt=function(){return Yr.et(this.path)&&null===this.collectionGroup&&0===this.filters.length},zo),No=(Go.Wt=function(t){return new Go(t)},Object.defineProperty(Go.prototype,"orderBy",{get:function(){if(null===this.qt){this.qt=[];var t=this.jt(),e=this.Kt();if(null!==t&&null===e)t.Y()||this.qt.push(new Oo(t)),this.qt.push(new Oo(Qr.J(),"asc"));else{for(var n,r=!1,i=0,o=this.Ot;i<o.length;i++){var s=o[i];this.qt.push(s),s.field.Y()&&(r=!0)}r||(n=0<this.Ot.length?this.Ot[this.Ot.length-1].dir:"asc",this.qt.push(new Oo(Qr.J(),n)))}}return this.qt},enumerable:!0,configurable:!0}),Go.prototype.Gt=function(t){var e=this.filters.concat([t]);return new Go(this.path,this.collectionGroup,this.Ot.slice(),e,this.limit,this.Bt,this.startAt,this.endAt)},Go.prototype.zt=function(t){var e=this.Ot.concat([t]);return new Go(this.path,this.collectionGroup,e,this.filters.slice(),this.limit,this.Bt,this.startAt,this.endAt)},Go.prototype.Ht=function(t){return new Go(this.path,this.collectionGroup,this.Ot.slice(),this.filters.slice(),t,"F",this.startAt,this.endAt)},Go.prototype.Yt=function(t){return new Go(this.path,this.collectionGroup,this.Ot.slice(),this.filters.slice(),t,"L",this.startAt,this.endAt)},Go.prototype.Jt=function(t){return new Go(this.path,this.collectionGroup,this.Ot.slice(),this.filters.slice(),this.limit,this.Bt,t,this.endAt)},Go.prototype.Xt=function(t){return new Go(this.path,this.collectionGroup,this.Ot.slice(),this.filters.slice(),this.limit,this.Bt,this.startAt,t)},Go.prototype.Zt=function(t){return new Go(t,null,this.Ot.slice(),this.filters.slice(),this.limit,this.Bt,this.startAt,this.endAt)},Go.prototype.te=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.Ot.length||1===this.Ot.length&&this.Ot[0].field.Y())},Go.prototype.canonicalId=function(){return this.ee().canonicalId()+"|lt:"+this.Bt},Go.prototype.toString=function(){return"Query(target="+this.ee().toString()+"; limitType="+this.Bt+")"},Go.prototype.isEqual=function(t){return this.ee().isEqual(t.ee())&&this.Bt===t.Bt},Go.prototype.se=function(t,e){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],s=o.compare(t,e);if(0!==s)return s;n=n||o.field.Y()}return 0},Go.prototype.matches=function(t){return this.ie(t)&&this.ne(t)&&this.re(t)&&this.he(t)},Go.prototype.oe=function(){return!ei(this.limit)&&"F"===this.Bt},Go.prototype.ae=function(){return!ei(this.limit)&&"L"===this.Bt},Go.prototype.Kt=function(){return 0<this.Ot.length?this.Ot[0].field:null},Go.prototype.jt=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof Ao&&n.ue())return n.field}return null},Go.prototype.ce=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(r instanceof Ao&&0<=t.indexOf(r.op))return r.op}return null},Go.prototype.Lt=function(){return this.ee().Lt()},Go.prototype._e=function(){return null!==this.collectionGroup},Go.prototype.ee=function(){if(!this.Ut)if("F"===this.Bt)this.Ut=new Io(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var r=n[e],i="desc"===r.dir?"asc":"desc";t.push(new Oo(r.field,i))}var o=this.endAt?new xo(this.endAt.position,!this.endAt.before):null,s=this.startAt?new xo(this.startAt.position,!this.startAt.before):null;this.Ut=new Io(this.path,this.collectionGroup,t,this.filters,this.limit,o,s)}return this.Ut},Go.prototype.ie=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.tt(this.collectionGroup)&&this.path.q(e):Yr.et(this.path)?this.path.isEqual(e):this.path.U(e)},Go.prototype.ne=function(t){for(var e=0,n=this.Ot;e<n.length;e++){var r=n[e];if(!r.field.Y()&&null===t.field(r.field))return!1}return!0},Go.prototype.re=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},Go.prototype.he=function(t){return!(this.startAt&&!this.startAt.le(this.orderBy,t)||this.endAt&&this.endAt.le(this.orderBy,t))},Go.prototype.Qt=function(t){},Go),Ao=(n(Bo,vo=function(){}),Bo.create=function(t,e,n){if(t.Y())return"in"===e?new So(t,n):new _o(t,e,n);if(wi(n)){if("=="!==e)throw new _r(Ar.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new Bo(t,e,n)}if(bi(n)){if("=="!==e)throw new _r(Ar.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new Bo(t,e,n)}return"array-contains"===e?new Ro(t,n):"in"===e?new Do(t,n):"array-contains-any"===e?new Po(t,n):new Bo(t,e,n)},Bo.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&ui(this.value)===ui(e)&&this.de(ci(e,this.value))},Bo.prototype.de=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return 0<t;case">=":return 0<=t;default:return zs()}},Bo.prototype.ue=function(){return 0<=["<","<=",">",">="].indexOf(this.op)},Bo.prototype.canonicalId=function(){return this.field.j()+this.op.toString()+li(this.value)},Bo.prototype.isEqual=function(t){return t instanceof Bo&&this.op===t.op&&this.field.isEqual(t.field)&&ai(this.value,t.value)},Bo.prototype.toString=function(){return this.field.j()+" "+this.op+" "+li(this.value)},Bo),_o=(n(qo,yo=Ao),qo.prototype.matches=function(t){var e=Yr.N(t.key,this.key);return this.de(e)},qo),So=(n(Fo,po=Ao),Fo.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Fo),Ro=(n(jo,lo=Ao),jo.prototype.matches=function(t){var e=t.field(this.field);return mi(e)&&hi(e.arrayValue,this.value)},jo),Do=(n(Uo,fo=Ao),Uo.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&hi(this.value.arrayValue,e)},Uo),Po=(n(Mo,co=Ao),Mo.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!mi(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return hi(e.value.arrayValue,t)})},Mo),xo=(Co.prototype.canonicalId=function(){return(this.before?"b":"a")+":"+this.position.map(li).join(",")},Co.prototype.le=function(t,e){for(var n=0,r=0;r<this.position.length;r++){var i=t[r],o=this.position[r],n=i.field.Y()?Yr.N(Yr.Z(o.referenceValue),e.key):ci(o,e.field(i.field));if("desc"===i.dir&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},Co.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++)if(!ai(this.position[e],t.position[e]))return!1;return!0},Co),Oo=(Vo.prototype.compare=function(t,e){var n,r,i,o,s=this.fe?Yr.N(t.key,e.key):(n=this.field,r=e,i=t.field(n),o=r.field(n),null!==i&&null!==o?ci(i,o):zs());switch(this.dir){case"asc":return s;case"desc":return-1*s;default:return zs()}},Vo.prototype.canonicalId=function(){return this.field.j()+this.dir.toString()},Vo.prototype.toString=function(){return this.field.j()+" ("+this.dir+")"},Vo.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},Vo),ko=(Lo.prototype.we=function(t){return new Lo(this.target,this.targetId,this.Te,t,this.Ee,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Lo.prototype.Ie=function(t,e){return new Lo(this.target,this.targetId,this.Te,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Lo.prototype.Re=function(t){return new Lo(this.target,this.targetId,this.Te,this.sequenceNumber,this.Ee,t,this.resumeToken)},Lo);function Lo(t,e,n,r,i,o,s){void 0===i&&(i=Or.min()),void 0===o&&(o=Or.min()),void 0===s&&(s=Zr.ht),this.target=t,this.targetId=e,this.Te=n,this.sequenceNumber=r,this.Ee=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Vo(t,e){this.field=t,void 0===e&&(e="asc"),this.dir=e,this.fe=t.Y()}function Co(t,e){this.position=t,this.before=e}function Mo(t,e){return co.call(this,t,"array-contains-any",e)||this}function Uo(t,e){return fo.call(this,t,"in",e)||this}function jo(t,e){return lo.call(this,t,"array-contains",e)||this}function Fo(t,e){var n=this;return(n=po.call(this,t,"in",e)||this).keys=(e.arrayValue.values||[]).map(function(t){return Yr.Z(t.referenceValue)}),n}function qo(t,e,n){var r=this;return(r=yo.call(this,t,e,n)||this).key=Yr.Z(n.referenceValue),r}function Bo(t,e,n){var r=this;return(r=vo.call(this)||this).field=t,r.op=e,r.value=n,r}function Go(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Ot=n,this.filters=r,this.limit=i,this.Bt=o,this.startAt=s,this.endAt=u,this.qt=null,this.Ut=null,this.startAt&&this.Qt(this.startAt),this.endAt&&this.Qt(this.endAt)}function zo(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.xt=null}function Wo(){return null!==go&&go.apply(this,arguments)||this}function Qo(t,e,n){var r=this;return(r=mo.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Ko(t,e,n,r){var i=this;return(i=wo.call(this,t,e)||this).kt=n,i.At=!!r.At,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Yo(t){switch(t){case Ar.OK:return zs();case Ar.CANCELLED:case Ar.UNKNOWN:case Ar.DEADLINE_EXCEEDED:case Ar.RESOURCE_EXHAUSTED:case Ar.INTERNAL:case Ar.UNAVAILABLE:case Ar.UNAUTHENTICATED:return;case Ar.INVALID_ARGUMENT:case Ar.NOT_FOUND:case Ar.ALREADY_EXISTS:case Ar.PERMISSION_DENIED:case Ar.FAILED_PRECONDITION:case Ar.ABORTED:case Ar.OUT_OF_RANGE:case Ar.UNIMPLEMENTED:case Ar.DATA_LOSS:return 1;default:return zs()}}function Ho(t){if(void 0===t)return Bs("GRPC error has no .code"),Ar.UNKNOWN;switch(t){case ao.OK:return Ar.OK;case ao.CANCELLED:return Ar.CANCELLED;case ao.UNKNOWN:return Ar.UNKNOWN;case ao.DEADLINE_EXCEEDED:return Ar.DEADLINE_EXCEEDED;case ao.RESOURCE_EXHAUSTED:return Ar.RESOURCE_EXHAUSTED;case ao.INTERNAL:return Ar.INTERNAL;case ao.UNAVAILABLE:return Ar.UNAVAILABLE;case ao.UNAUTHENTICATED:return Ar.UNAUTHENTICATED;case ao.INVALID_ARGUMENT:return Ar.INVALID_ARGUMENT;case ao.NOT_FOUND:return Ar.NOT_FOUND;case ao.ALREADY_EXISTS:return Ar.ALREADY_EXISTS;case ao.PERMISSION_DENIED:return Ar.PERMISSION_DENIED;case ao.FAILED_PRECONDITION:return Ar.FAILED_PRECONDITION;case ao.ABORTED:return Ar.ABORTED;case ao.OUT_OF_RANGE:return Ar.OUT_OF_RANGE;case ao.UNIMPLEMENTED:return Ar.UNIMPLEMENTED;case ao.DATA_LOSS:return Ar.DATA_LOSS;default:return zs()}}(ho=ao=ao||{})[ho.OK=0]="OK",ho[ho.CANCELLED=1]="CANCELLED",ho[ho.UNKNOWN=2]="UNKNOWN",ho[ho.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ho[ho.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ho[ho.NOT_FOUND=5]="NOT_FOUND",ho[ho.ALREADY_EXISTS=6]="ALREADY_EXISTS",ho[ho.PERMISSION_DENIED=7]="PERMISSION_DENIED",ho[ho.UNAUTHENTICATED=16]="UNAUTHENTICATED",ho[ho.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ho[ho.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ho[ho.ABORTED=10]="ABORTED",ho[ho.OUT_OF_RANGE=11]="OUT_OF_RANGE",ho[ho.UNIMPLEMENTED=12]="UNIMPLEMENTED",ho[ho.INTERNAL=13]="INTERNAL",ho[ho.UNAVAILABLE=14]="UNAVAILABLE",ho[ho.DATA_LOSS=15]="DATA_LOSS";var Xo=(es.prototype.Ae=function(t,e){return new es(this.N,this.root.Ae(t,e,this.N).me(null,null,$o.Pe,null,null))},es.prototype.remove=function(t){return new es(this.N,this.root.remove(t,this.N).me(null,null,$o.Pe,null,null))},es.prototype.get=function(t){for(var e=this.root;!e.B();){var n=this.N(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},es.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.B();){var r=this.N(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},es.prototype.B=function(){return this.root.B()},Object.defineProperty(es.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),es.prototype.Ve=function(){return this.root.Ve()},es.prototype.ge=function(){return this.root.ge()},es.prototype.pe=function(t){return this.root.pe(t)},es.prototype.forEach=function(n){this.pe(function(t,e){return n(t,e),!1})},es.prototype.toString=function(){var n=[];return this.pe(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},es.prototype.ye=function(t){return this.root.ye(t)},es.prototype.be=function(){return new Jo(this.root,null,this.N,!1)},es.prototype.ve=function(t){return new Jo(this.root,t,this.N,!1)},es.prototype.Se=function(){return new Jo(this.root,null,this.N,!0)},es.prototype.De=function(t){return new Jo(this.root,t,this.N,!0)},es),Jo=(ts.prototype.Ne=function(){var t=this.Fe.pop(),e={key:t.key,value:t.value};if(this.Ce)for(t=t.left;!t.B();)this.Fe.push(t),t=t.right;else for(t=t.right;!t.B();)this.Fe.push(t),t=t.left;return e},ts.prototype.$e=function(){return 0<this.Fe.length},ts.prototype.ke=function(){if(0===this.Fe.length)return null;var t=this.Fe[this.Fe.length-1];return{key:t.key,value:t.value}},ts),$o=(Zo.prototype.me=function(t,e,n,r,i){return new Zo(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Zo.prototype.B=function(){return!1},Zo.prototype.pe=function(t){return this.left.pe(t)||t(this.key,this.value)||this.right.pe(t)},Zo.prototype.ye=function(t){return this.right.ye(t)||t(this.key,this.value)||this.left.ye(t)},Zo.prototype.min=function(){return this.left.B()?this:this.left.min()},Zo.prototype.Ve=function(){return this.min().key},Zo.prototype.ge=function(){return this.right.B()?this.key:this.right.ge()},Zo.prototype.Ae=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.me(null,null,null,r.left.Ae(t,e,n),null):0===i?r.me(null,e,null,null,null):r.me(null,null,null,null,r.right.Ae(t,e,n))).Me()},Zo.prototype.xe=function(){if(this.left.B())return Zo.EMPTY;var t=this;return t.left.Le()||t.left.left.Le()||(t=t.Oe()),(t=t.me(null,null,null,t.left.xe(),null)).Me()},Zo.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.B()||r.left.Le()||r.left.left.Le()||(r=r.Oe()),r=r.me(null,null,null,r.left.remove(t,e),null);else{if(r.left.Le()&&(r=r.Be()),r.right.B()||r.right.Le()||r.right.left.Le()||(r=r.qe()),0===e(t,r.key)){if(r.right.B())return Zo.EMPTY;n=r.right.min(),r=r.me(n.key,n.value,null,null,r.right.xe())}r=r.me(null,null,null,null,r.right.remove(t,e))}return r.Me()},Zo.prototype.Le=function(){return this.color},Zo.prototype.Me=function(){var t=this;return t.right.Le()&&!t.left.Le()&&(t=t.Ue()),t.left.Le()&&t.left.left.Le()&&(t=t.Be()),t.left.Le()&&t.right.Le()&&(t=t.Qe()),t},Zo.prototype.Oe=function(){var t=this.Qe();return t.right.left.Le()&&(t=(t=(t=t.me(null,null,null,null,t.right.Be())).Ue()).Qe()),t},Zo.prototype.qe=function(){var t=this.Qe();return t.left.left.Le()&&(t=(t=t.Be()).Qe()),t},Zo.prototype.Ue=function(){var t=this.me(null,null,Zo.RED,null,this.right.left);return this.right.me(null,null,this.color,t,null)},Zo.prototype.Be=function(){var t=this.me(null,null,Zo.RED,this.left.right,null);return this.left.me(null,null,this.color,null,t)},Zo.prototype.Qe=function(){var t=this.left.me(null,null,!this.left.color,null,null),e=this.right.me(null,null,!this.right.color,null,null);return this.me(null,null,!this.color,t,e)},Zo.prototype.We=function(){var t=this.je();return Math.pow(2,t)<=this.size+1},Zo.prototype.je=function(){if(this.Le()&&this.left.Le())throw zs();if(this.right.Le())throw zs();var t=this.left.je();if(t!==this.right.je())throw zs();return t+(this.Le()?0:1)},Zo);function Zo(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Zo.RED,this.left=null!=r?r:Zo.EMPTY,this.right=null!=i?i:Zo.EMPTY,this.size=this.left.size+1+this.right.size}function ts(t,e,n,r){this.Ce=r,this.Fe=[];for(var i=1;!t.B();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Ce?t.left:t.right;else{if(0===i){this.Fe.push(t);break}this.Fe.push(t),t=this.Ce?t.right:t.left}}function es(t,e){this.N=t,this.root=e||$o.EMPTY}function ns(){this.size=0}$o.EMPTY=null,$o.RED=!0,$o.Pe=!1,$o.EMPTY=(Object.defineProperty(ns.prototype,"key",{get:function(){throw zs()},enumerable:!0,configurable:!0}),Object.defineProperty(ns.prototype,"value",{get:function(){throw zs()},enumerable:!0,configurable:!0}),Object.defineProperty(ns.prototype,"color",{get:function(){throw zs()},enumerable:!0,configurable:!0}),Object.defineProperty(ns.prototype,"left",{get:function(){throw zs()},enumerable:!0,configurable:!0}),Object.defineProperty(ns.prototype,"right",{get:function(){throw zs()},enumerable:!0,configurable:!0}),ns.prototype.me=function(t,e,n,r,i){return this},ns.prototype.Ae=function(t,e,n){return new $o(t,e)},ns.prototype.remove=function(t,e){return this},ns.prototype.B=function(){return!0},ns.prototype.pe=function(t){return!1},ns.prototype.ye=function(t){return!1},ns.prototype.Ve=function(){return null},ns.prototype.ge=function(){return null},ns.prototype.Le=function(){return!1},ns.prototype.We=function(){return!0},ns.prototype.je=function(){return 0},new ns);var rs=(us.prototype.has=function(t){return null!==this.data.get(t)},us.prototype.first=function(){return this.data.Ve()},us.prototype.last=function(){return this.data.ge()},Object.defineProperty(us.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),us.prototype.indexOf=function(t){return this.data.indexOf(t)},us.prototype.forEach=function(n){this.data.pe(function(t,e){return n(t),!1})},us.prototype.Ke=function(t,e){for(var n=this.data.ve(t[0]);n.$e();){var r=n.Ne();if(0<=this.N(r.key,t[1]))return;e(r.key)}},us.prototype.Ge=function(t,e){for(var n=void 0!==e?this.data.ve(e):this.data.be();n.$e();)if(!t(n.Ne().key))return},us.prototype.ze=function(t){var e=this.data.ve(t);return e.$e()?e.Ne().key:null},us.prototype.be=function(){return new is(this.data.be())},us.prototype.ve=function(t){return new is(this.data.ve(t))},us.prototype.add=function(t){return this.me(this.data.remove(t).Ae(t,!0))},us.prototype.delete=function(t){return this.has(t)?this.me(this.data.remove(t)):this},us.prototype.B=function(){return this.data.B()},us.prototype.He=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},us.prototype.isEqual=function(t){if(!(t instanceof us))return!1;if(this.size!==t.size)return!1;for(var e=this.data.be(),n=t.data.be();e.$e();){var r=e.Ne().key,i=n.Ne().key;if(0!==this.N(r,i))return!1}return!0},us.prototype.W=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},us.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},us.prototype.me=function(t){var e=new us(this.N);return e.data=t,e},us),is=(ss.prototype.Ne=function(){return this.Ye.Ne().key},ss.prototype.$e=function(){return this.Ye.$e()},ss),os=new Xo(Yr.N);function ss(t){this.Ye=t}function us(t){this.N=t,this.data=new Xo(this.N)}var as=new Xo(Yr.N);var hs=new Xo(Yr.N),cs=new rs(Yr.N);function fs(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=cs,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var ls=new rs(Ys);function ps(t,e,n,r){this.Is=t,this.removedTargetIds=e,this.key=n,this.Rs=r}function ds(t,e){this.targetId=t,this.As=e}function ys(t,e,n,r){void 0===n&&(n=Zr.ht),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}var vs=(Ds.Ze=function(t){return new Ds(t.N)},Ds.prototype.has=function(t){return null!=this.Je.get(t)},Ds.prototype.get=function(t){return this.Je.get(t)},Ds.prototype.first=function(){return this.Xe.Ve()},Ds.prototype.last=function(){return this.Xe.ge()},Ds.prototype.B=function(){return this.Xe.B()},Ds.prototype.indexOf=function(t){var e=this.Je.get(t);return e?this.Xe.indexOf(e):-1},Object.defineProperty(Ds.prototype,"size",{get:function(){return this.Xe.size},enumerable:!0,configurable:!0}),Ds.prototype.forEach=function(n){this.Xe.pe(function(t,e){return n(t),!1})},Ds.prototype.add=function(t){var e=this.delete(t.key);return e.me(e.Je.Ae(t.key,t),e.Xe.Ae(t,null))},Ds.prototype.delete=function(t){var e=this.get(t);return e?this.me(this.Je.remove(t),this.Xe.remove(e)):this},Ds.prototype.isEqual=function(t){if(!(t instanceof Ds))return!1;if(this.size!==t.size)return!1;for(var e=this.Xe.be(),n=t.Xe.be();e.$e();){var r=e.Ne().key,i=n.Ne().key;if(!r.isEqual(i))return!1}return!0},Ds.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Ds.prototype.me=function(t,e){var n=new Ds;return n.N=this.N,n.Je=t,n.Xe=e,n},Ds),gs=(Rs.prototype.track=function(t){var e=t.doc.key,n=this.ts.get(e);!n||0!==t.type&&3===n.type?this.ts=this.ts.Ae(e,t):3===t.type&&1!==n.type?this.ts=this.ts.Ae(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ts=this.ts.Ae(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ts=this.ts.Ae(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ts=this.ts.remove(e):1===t.type&&2===n.type?this.ts=this.ts.Ae(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ts=this.ts.Ae(e,{type:2,doc:t.doc}):zs()},Rs.prototype.es=function(){var n=[];return this.ts.pe(function(t,e){n.push(e)}),n},Rs),ms=(Ss.os=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Ss(t,e,vs.Ze(e),i,n,r,!0,!1)},Object.defineProperty(Ss.prototype,"hasPendingWrites",{get:function(){return!this.ns.B()},enumerable:!0,configurable:!0}),Ss.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.rs===t.rs&&this.ns.isEqual(t.ns)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.ss.isEqual(t.ss)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Ss),ws=(_s.ls=function(t,e){var n=new Map;return n.set(t,bs.ds(t,e)),new _s(Or.min(),n,ls,os,fs())},_s),bs=(As.ds=function(t,e){return new As(Zr.ht,e,fs(),fs(),fs())},As),Es=(Object.defineProperty(Ns.prototype,"fs",{get:function(){return this.gs},enumerable:!0,configurable:!0}),Object.defineProperty(Ns.prototype,"resumeToken",{get:function(){return this.Vs},enumerable:!0,configurable:!0}),Object.defineProperty(Ns.prototype,"ys",{get:function(){return 0!==this.ms},enumerable:!0,configurable:!0}),Object.defineProperty(Ns.prototype,"bs",{get:function(){return this.ps},enumerable:!0,configurable:!0}),Ns.prototype.vs=function(t){0<t.rt()&&(this.ps=!0,this.Vs=t)},Ns.prototype.Ss=function(){var n=fs(),r=fs(),i=fs();return this.Ps.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:zs()}}),new bs(this.Vs,this.gs,n,r,i)},Ns.prototype.Ds=function(){this.ps=!1,this.Ps=xs()},Ns.prototype.Cs=function(t,e){this.ps=!0,this.Ps=this.Ps.Ae(t,e)},Ns.prototype.Fs=function(t){this.ps=!0,this.Ps=this.Ps.remove(t)},Ns.prototype.Ns=function(){this.ms+=1},Ns.prototype.$s=function(){--this.ms},Ns.prototype.ks=function(){this.ps=!0,this.gs=!0},Ns),Ts=(Is.prototype.qs=function(t){for(var e=0,n=t.Is;e<n.length;e++){var r=n[e];t.Rs instanceof bo?this.Us(r,t.Rs):t.Rs instanceof Eo&&this.Qs(r,t.key,t.Rs)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Qs(s,t.key,t.Rs)}},Is.prototype.Ws=function(n){var r=this;this.js(n,function(t){var e=r.Ks(t);switch(n.state){case 0:r.Gs(t)&&e.vs(n.resumeToken);break;case 1:e.$s(),e.ys||e.Ds(),e.vs(n.resumeToken);break;case 2:e.$s(),e.ys||r.removeTarget(t);break;case 3:r.Gs(t)&&(e.ks(),e.vs(n.resumeToken));break;case 4:r.Gs(t)&&(r.zs(t),e.vs(n.resumeToken));break;default:zs()}})},Is.prototype.js=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.xs.forEach(function(t,e){r.Gs(e)&&n(e)})},Is.prototype.Hs=function(t){var e,n,r=t.targetId,i=t.As.count,o=this.Ys(r);o&&((e=o.target).Lt()?0===i?(n=new Yr(e.path),this.Qs(r,n,new Eo(n,Or.min()))):Ws(1===i):this.Js(r)!==i&&(this.zs(r),this.Bs=this.Bs.add(r)))},Is.prototype.Xs=function(i){var o=this,s=new Map;this.xs.forEach(function(t,e){var n,r=o.Ys(e);r&&(t.fs&&r.target.Lt()&&(n=new Yr(r.target.path),null!==o.Ls.get(n)||o.Zs(e,n)||o.Qs(e,n,new Eo(n,i))),t.bs&&(s.set(e,t.Ss()),t.Ds()))});var r=fs();this.Os.forEach(function(t,e){var n=!0;e.Ge(function(t){var e=o.Ys(t);return!e||2===e.Te||(n=!1)}),n&&(r=r.add(t))});var t=new ws(i,s,this.Bs,this.Ls,r);return this.Ls=os,this.Os=Ps(),this.Bs=new rs(Ys),t},Is.prototype.Us=function(t,e){var n;this.Gs(t)&&(n=this.Zs(t,e.key)?2:0,this.Ks(t).Cs(e.key,n),this.Ls=this.Ls.Ae(e.key,e),this.Os=this.Os.Ae(e.key,this.ti(e.key).add(t)))},Is.prototype.Qs=function(t,e,n){var r;this.Gs(t)&&(r=this.Ks(t),this.Zs(t,e)?r.Cs(e,1):r.Fs(e),this.Os=this.Os.Ae(e,this.ti(e).delete(t)),n&&(this.Ls=this.Ls.Ae(e,n)))},Is.prototype.removeTarget=function(t){this.xs.delete(t)},Is.prototype.Js=function(t){var e=this.Ks(t).Ss();return this.Ms.ei(t).size+e.Ts.size-e.ws.size},Is.prototype.Ns=function(t){this.Ks(t).Ns()},Is.prototype.Ks=function(t){var e=this.xs.get(t);return e||(e=new Es,this.xs.set(t,e)),e},Is.prototype.ti=function(t){var e=this.Os.get(t);return e||(e=new rs(Ys),this.Os=this.Os.Ae(t,e)),e},Is.prototype.Gs=function(t){var e=null!==this.Ys(t);return e||qs("WatchChangeAggregator","Detected inactive target",t),e},Is.prototype.Ys=function(t){var e=this.xs.get(t);return e&&e.ys?null:this.Ms.si(t)},Is.prototype.zs=function(e){var n=this;this.xs.set(e,new Es),this.Ms.ei(e).forEach(function(t){n.Qs(e,t,null)})},Is.prototype.Zs=function(t,e){return this.Ms.ei(t).has(e)},Is);function Is(t){this.Ms=t,this.xs=new Map,this.Ls=os,this.Os=Ps(),this.Bs=new rs(Ys)}function Ns(){this.ms=0,this.Ps=xs(),this.Vs=Zr.ht,this.gs=!1,this.ps=!0}function As(t,e,n,r,i){this.resumeToken=t,this.fs=e,this.Ts=n,this.Es=r,this.ws=i}function _s(t,e,n,r,i){this.Ee=t,this.as=e,this.us=n,this.cs=r,this._s=i}function Ss(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.ss=n,this.docChanges=r,this.ns=i,this.fromCache=o,this.rs=s,this.hs=u}function Rs(){this.ts=new Xo(Yr.N)}function Ds(n){this.N=n?function(t,e){return n(t,e)||Yr.N(t.key,e.key)}:function(t,e){return Yr.N(t.key,e.key)},this.Je=as,this.Xe=new Xo(this.N)}function Ps(){return new Xo(Yr.N)}function xs(){return new Xo(Yr.N)}var Os={asc:"ASCENDING",desc:"DESCENDING"},ks={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ls=(Vs.prototype.ni=function(t){var e=void 0===t.code?Ar.UNKNOWN:Ho(t.code);return new _r(e,t.message||"")},Vs.prototype.ri=function(t){return this.options.hi||ei(t)?t:{value:t}},Vs.prototype.oi=function(t){var e;return ei(e="object"==typeof t?t.value:t)?null:e},Vs.prototype._t=function(t){return{integerValue:""+t}},Vs.prototype.lt=function(t){if(this.options.hi){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ni(t)?"-0":t}},Vs.prototype.ai=function(t){return ri(t)?this._t(t):this.lt(t)},Vs.prototype.C=function(t){return this.options.hi?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}},Vs.prototype.v=function(t){var e=pi(t);return new xr(e.seconds,e.nanos)},Vs.prototype.ui=function(t){return this.options.hi?t.toBase64():t.toUint8Array()},Vs.prototype.ci=function(t){return this.options.hi?(Ws(void 0===t||"string"==typeof t),Zr.fromBase64String(t||"")):(Ws(void 0===t||t instanceof Uint8Array),Zr.fromUint8Array(t||new Uint8Array))},Vs.prototype.toVersion=function(t){return this.C(t.C())},Vs.prototype.fromVersion=function(t){return Ws(!!t),Or.v(this.v(t))},Vs.prototype._i=function(t,e){return this.li(e||this.ii).child("documents").child(t).j()},Vs.prototype.di=function(t){var e=Lr.K(t);return Ws(Cs(e)),e},Vs.prototype.fi=function(t){return this._i(t.path)},Vs.prototype.Z=function(t){var e=this.di(t);return Ws(e.get(1)===this.ii.projectId),Ws(!e.get(3)&&!this.ii.database||e.get(3)===this.ii.database),new Yr(this.Ti(e))},Vs.prototype.Ei=function(t){return this._i(t)},Vs.prototype.wi=function(t){var e=this.di(t);return 4===e.length?Lr.G:this.Ti(e)},Object.defineProperty(Vs.prototype,"Ii",{get:function(){return new Lr(["projects",this.ii.projectId,"databases",this.ii.database]).j()},enumerable:!0,configurable:!0}),Vs.prototype.li=function(t){return new Lr(["projects",t.projectId,"databases",t.database])},Vs.prototype.Ti=function(t){return Ws(4<t.length&&"documents"===t.get(4)),t.k(5)},Vs.prototype.Ri=function(t,e){return{name:this.fi(t),fields:e.proto.mapValue.fields}},Vs.prototype.Ai=function(t){return{name:this.fi(t.key),fields:t.Mt().mapValue.fields,updateTime:this.C(t.version.C())}},Vs.prototype.mi=function(t,e){var n=this.Z(t.name),r=this.fromVersion(t.updateTime),i=new Qi({mapValue:{fields:t.fields}});return new bo(n,r,i,{hasCommittedMutations:!!e})},Vs.prototype.Pi=function(t){Ws(!!t.found),t.found.name,t.found.updateTime;var e=this.Z(t.found.name),n=this.fromVersion(t.found.updateTime),r=new Qi({mapValue:{fields:t.found.fields}});return new bo(e,n,r,{})},Vs.prototype.Vi=function(t){Ws(!!t.missing),Ws(!!t.readTime);var e=this.Z(t.missing),n=this.fromVersion(t.readTime);return new Eo(e,n)},Vs.prototype.gi=function(t){return"found"in t?this.Pi(t):"missing"in t?this.Vi(t):zs()},Vs.prototype.pi=function(t){if("targetChange"in t){t.targetChange;var e=this.yi(t.targetChange.targetChangeType||"NO_CHANGE"),n=t.targetChange.targetIds||[],r=this.ci(t.targetChange.resumeToken),i=t.targetChange.cause,o=new ys(e,n,r,i&&this.ni(i)||null)}else if("documentChange"in t){t.documentChange;var s=t.documentChange;s.document,s.document.name,s.document.updateTime;var u=this.Z(s.document.name),a=this.fromVersion(s.document.updateTime),h=new Qi({mapValue:{fields:s.document.fields}}),c=new bo(u,a,h,{});o=new ps(s.targetIds||[],s.removedTargetIds||[],c.key,c)}else if("documentDelete"in t){t.documentDelete;var f=t.documentDelete;f.document;var l=this.Z(f.document),p=f.readTime?this.fromVersion(f.readTime):Or.min(),d=new Eo(l,p);o=new ps([],f.removedTargetIds||[],d.key,d)}else if("documentRemove"in t){t.documentRemove;var y=t.documentRemove;y.document;var v=this.Z(y.document);o=new ps([],y.removedTargetIds||[],v,null)}else{if(!("filter"in t))return zs();t.filter;var g=t.filter;g.targetId;var m=new uo(g.count||0);o=new ds(g.targetId,m)}return o},Vs.prototype.yi=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:zs()},Vs.prototype.bi=function(t){if(!("targetChange"in t))return Or.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Or.min():this.fromVersion(e.readTime)},Vs.prototype.vi=function(t){var e,n=this;if(t instanceof qi)e={update:this.Ri(t.key,t.value)};else if(t instanceof zi)e={delete:this.fi(t.key)};else if(t instanceof Bi)e={update:this.Ri(t.key,t.data),updateMask:this.Si(t.Vt)};else if(t instanceof Gi)e={transform:{document:this.fi(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.Di(t)})}};else{if(!(t instanceof Wi))return zs();e={verify:this.fi(t.key)}}return t.Rt.Tt||(e.currentDocument=this.Ci(t.Rt)),e},Vs.prototype.Fi=function(t){var e=this,n=t.currentDocument?this.Ni(t.currentDocument):ji.ft();if(t.update){t.update.name;var r=this.Z(t.update.name),i=new Qi({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=this.$i(t.updateMask);return new Bi(r,i,o,n)}return new qi(r,i,n)}if(t.delete){var s=this.Z(t.delete);return new zi(s,n)}if(t.transform){var u=this.Z(t.transform.document),a=t.transform.fieldTransforms.map(function(t){return e.ki(t)});return Ws(!0===n.exists),new Gi(u,a)}if(t.verify){var h=this.Z(t.verify);return new Wi(h,n)}return zs()},Vs.prototype.Ci=function(t){return void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:zs()},Vs.prototype.Ni=function(t){return void 0!==t.updateTime?ji.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?ji.exists(t.exists):ji.ft()},Vs.prototype.Mi=function(t,e){var n=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e);n.isEqual(Or.min())&&(n=this.fromVersion(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new xi(n,r)},Vs.prototype.xi=function(t,e){var n=this;return t&&0<t.length?(Ws(void 0!==e),t.map(function(t){return n.Mi(t,e)})):[]},Vs.prototype.Di=function(t){var e=t.transform;if(e instanceof Ti)return{fieldPath:t.field.j(),setToServerValue:"REQUEST_TIME"};if(e instanceof Ni)return{fieldPath:t.field.j(),appendMissingElements:{values:e.elements}};if(e instanceof Ai)return{fieldPath:t.field.j(),removeAllFromArray:{values:e.elements}};if(e instanceof _i)return{fieldPath:t.field.j(),increment:e.ct};throw zs()},Vs.prototype.ki=function(t){var e,n,r=null;"setToServerValue"in t?(Ws("REQUEST_TIME"===t.setToServerValue),r=Ti.instance):"appendMissingElements"in t?(e=t.appendMissingElements.values||[],r=new Ni(e)):"removeAllFromArray"in t?(n=t.removeAllFromArray.values||[],r=new Ai(n)):"increment"in t?r=new _i(this,t.increment):zs();var i=Qr.X(t.fieldPath);return new Ui(i,r)},Vs.prototype.Li=function(t){return{documents:[this.Ei(t.path)]}},Vs.prototype.Oi=function(t){Ws(1===t.documents.length);var e=t.documents[0];return No.Wt(this.wi(e)).ee()},Vs.prototype.Bi=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(e.parent=this.Ei(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=this.Ei(n.M()),e.structuredQuery.from=[{collectionId:n.O()}]);var r=this.qi(t.filters);r&&(e.structuredQuery.where=r);var i=this.Ui(t.orderBy);i&&(e.structuredQuery.orderBy=i);var o=this.ri(t.limit);return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.Qi(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.Qi(t.endAt)),e},Vs.prototype.Wi=function(t){var e,n=this.wi(t.parent),r=t.structuredQuery,i=r.from?r.from.length:0,o=null;0<i&&(Ws(1===i),(e=r.from[0]).allDescendants?o=e.collectionId:n=n.child(e.collectionId));var s=[];r.where&&(s=this.ji(r.where));var u=[];r.orderBy&&(u=this.Ki(r.orderBy));var a=null;r.limit&&(a=this.oi(r.limit));var h=null;r.startAt&&(h=this.Gi(r.startAt));var c=null;return r.endAt&&(c=this.Gi(r.endAt)),new No(n,o,u,s,a,"F",h,c).ee()},Vs.prototype.zi=function(t){var e=this.Hi(t.Te);return null==e?null:{"goog-listen-tags":e}},Vs.prototype.Hi=function(t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return zs()}},Vs.prototype.ee=function(t){var e,n=t.target;return(e=n.Lt()?{documents:this.Li(n)}:{query:this.Bi(n)}).targetId=t.targetId,0<t.resumeToken.rt()&&(e.resumeToken=this.ui(t.resumeToken)),e},Vs.prototype.qi=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof Ao?e.Yi(t):zs()});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},Vs.prototype.ji=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.Ji(t)]:void 0!==t.fieldFilter?[this.Xi(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.ji(t)}).reduce(function(t,e){return t.concat(e)}):zs():[]},Vs.prototype.Ui=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.Zi(t)})},Vs.prototype.Ki=function(t){var e=this;return t.map(function(t){return e.tn(t)})},Vs.prototype.Qi=function(t){return{before:t.before,values:t.position}},Vs.prototype.Gi=function(t){var e=!!t.before,n=t.values||[];return new xo(n,e)},Vs.prototype.en=function(t){return Os[t]},Vs.prototype.sn=function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}},Vs.prototype.nn=function(t){return ks[t]},Vs.prototype.rn=function(t){switch(t){case"EQUAL":return"==";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return zs()}},Vs.prototype.hn=function(t){return{fieldPath:t.j()}},Vs.prototype.on=function(t){return Qr.X(t.fieldPath)},Vs.prototype.Zi=function(t){return{field:this.hn(t.field),direction:this.en(t.dir)}},Vs.prototype.tn=function(t){return new Oo(this.on(t.field),this.sn(t.direction))},Vs.prototype.Xi=function(t){return Ao.create(this.on(t.fieldFilter.field),this.rn(t.fieldFilter.op),t.fieldFilter.value)},Vs.prototype.Yi=function(t){if("=="===t.op){if(bi(t.value))return{unaryFilter:{field:this.hn(t.field),op:"IS_NAN"}};if(wi(t.value))return{unaryFilter:{field:this.hn(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.hn(t.field),op:this.nn(t.op),value:t.value}}},Vs.prototype.Ji=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.on(t.unaryFilter.field);return Ao.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=this.on(t.unaryFilter.field);return Ao.create(n,"==",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return zs()}},Vs.prototype.Si=function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.j())}),{fieldPaths:e}},Vs.prototype.$i=function(t){var e=t.fieldPaths||[];return new Mi(e.map(function(t){return Qr.X(t)}))},Vs);function Vs(t,e){this.ii=t,this.options=e}function Cs(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var Ms=(js.an=function(t){js.platform&&zs(),js.platform=t},js.nt=function(){return js.platform||zs(),js.platform},js),Us=new h("@firebase/firestore");function js(){}function Fs(){return Us.logLevel}function qs(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Us.logLevel<=p.DEBUG&&(e=n.map(Gs),Us.debug.apply(Us,d(["Firestore ("+wr+"): "+t],e)))}function Bs(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Us.logLevel<=p.ERROR&&(e=n.map(Gs),Us.error.apply(Us,d(["Firestore ("+wr+"): "+t],e)))}function Gs(t){if("string"==typeof t)return t;var e=Ms.nt();try{return e.un(t)}catch(e){return t}}function zs(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+wr+") INTERNAL ASSERTION FAILED: "+t;throw Bs(e),new Error(e)}function Ws(t){t||zs()}var Qs=(Ks.cn=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Ms.nt()._n(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Ks);function Ks(){}function Ys(t,e){return t<e?-1:e<t?1:0}function Hs(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Xs(t){return t+"\0"}function Js(t,e,n,r,i){this.ii=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var $s=(Object.defineProperty(mu.prototype,"ln",{get:function(){return"(default)"===this.database},enumerable:!0,configurable:!0}),mu.prototype.isEqual=function(t){return t instanceof mu&&t.projectId===this.projectId&&t.database===this.database},mu.prototype.S=function(t){return Ys(this.projectId,t.projectId)||Ys(this.database,t.database)},mu),Zs=(gu.prototype.get=function(t){var e=this.dn(t),n=this.fn[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(s.isEqual(t))return u}},gu.prototype.has=function(t){return void 0!==this.get(t)},gu.prototype.set=function(t,e){var n=this.dn(t),r=this.fn[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(t))return void(r[i]=[t,e]);r.push([t,e])}else this.fn[n]=[[t,e]]},gu.prototype.delete=function(t){var e=this.dn(t),n=this.fn[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(t))return 1===n.length?delete this.fn[e]:n.splice(r,1),!0;return!1},gu.prototype.forEach=function(u){Jr(this.fn,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];u(o,s)}})},gu.prototype.B=function(){return $r(this.fn)},gu),tu=(vu.prototype.at=function(t,e,n){for(var r=n.En,i=0;i<this.mutations.length;i++){var o,s=this.mutations[i];s.key.isEqual(t)&&(o=r[i],e=s.at(e,o))}return e},vu.prototype.ot=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=i.ot(e,e,this.Tn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=a.ot(e,o,this.Tn))}return e},vu.prototype.wn=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ot(t.key,n.get(t.key));e&&(i=i.Ae(t.key,e))}),i},vu.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},fs())},vu.prototype.isEqual=function(t){return this.batchId===t.batchId&&Hs(this.mutations,t.mutations,function(t,e){return t.isEqual(e)})&&Hs(this.baseMutations,t.baseMutations,function(t,e){return t.isEqual(e)})},vu),eu=(yu.from=function(t,e,n){Ws(t.mutations.length===n.length);for(var r=hs,i=t.mutations,o=0;o<i.length;o++)r=r.Ae(i[o].key,n[o].version);return new yu(t,e,n,r)},yu),nu=(du.prototype.catch=function(t){return this.next(void 0,t)},du.prototype.next=function(r,i){var o=this;return this.Vn&&zs(),this.Vn=!0,this.Pn?this.error?this.gn(i,this.error):this.pn(r,this.result):new du(function(e,n){o.An=function(t){o.pn(r,t).next(e,n)},o.mn=function(t){o.gn(i,t).next(e,n)}})},du.prototype.yn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},du.prototype.bn=function(t){try{var e=t();return e instanceof du?e:du.resolve(e)}catch(t){return du.reject(t)}},du.prototype.pn=function(t,e){return t?this.bn(function(){return t(e)}):du.resolve(e)},du.prototype.gn=function(t,e){return t?this.bn(function(){return t(e)}):du.reject(e)},du.resolve=function(n){return new du(function(t,e){t(n)})},du.reject=function(n){return new du(function(t,e){e(n)})},du.vn=function(t){return new du(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},du.Sn=function(t){for(var n=du.resolve(!1),e=function(e){n=n.next(function(t){return t?du.resolve(t):e()})},r=0,i=t;r<i.length;r++)e(i[r]);return n},du.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.vn(i)},du),ru=(Object.defineProperty(pu.prototype,"readTime",{get:function(){return this.Fn},set:function(t){this.Fn=t},enumerable:!0,configurable:!0}),pu.prototype.Nn=function(t,e){this.$n(),this.readTime=e,this.Dn.set(t.key,t)},pu.prototype.kn=function(t,e){this.$n(),e&&(this.readTime=e),this.Dn.set(t,null)},pu.prototype.Mn=function(t,e){this.$n();var n=this.Dn.get(e);return void 0!==n?nu.resolve(n):this.xn(t,e)},pu.prototype.getEntries=function(t,e){return this.Ln(t,e)},pu.prototype.apply=function(t){return this.$n(),this.Cn=!0,this.On(t)},pu.prototype.$n=function(){},pu),iu="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ou=(lu.prototype.qn=function(t){this.Bn.push(t)},lu.prototype.Un=function(){this.Bn.forEach(function(t){return t()})},lu),su=(fu.prototype.Kn=function(e,n){var r=this;return this.Wn.Gn(e,n).next(function(t){return r.zn(e,n,t)})},fu.prototype.zn=function(t,r,i){return this.Qn.Mn(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ot(r,t);return t})},fu.prototype.Hn=function(t,e,i){var o=os;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ot(t,e);o=o.Ae(t,e)}),o},fu.prototype.Yn=function(e,t){var n=this;return this.Qn.getEntries(e,t).next(function(t){return n.Jn(e,t)})},fu.prototype.Jn=function(r,i){var o=this;return this.Wn.Xn(r,i).next(function(t){var e=o.Hn(r,i,t),n=os;return e.forEach(function(t,e){e=e||new Eo(t,Or.min()),n=n.Ae(t,e)}),n})},fu.prototype.Zn=function(t,e,n){return e.Lt()?this.tr(t,e.path):e._e()?this.er(t,e,n):this.sr(t,e,n)},fu.prototype.tr=function(t,e){return this.Kn(t,new Yr(e)).next(function(t){var e=as;return t instanceof bo&&(e=e.Ae(t.key,t)),e})},fu.prototype.er=function(n,r,i){var o=this,s=r.collectionGroup,u=as;return this.jn.ir(n,s).next(function(t){return nu.forEach(t,function(t){var e=r.Zt(t.child(s));return o.sr(n,e,i).next(function(t){t.forEach(function(t,e){u=u.Ae(t,e)})})}).next(function(){return u})})},fu.prototype.sr=function(e,n,t){var c,f,r=this;return this.Qn.Zn(e,n,t).next(function(t){return c=t,r.Wn.nr(e,n)}).next(function(t){return f=t,r.rr(e,f,c).next(function(t){c=t;for(var e=0,n=f;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),h=s.ot(a,a,r.Tn);c=h instanceof bo?c.Ae(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){n.matches(e)||(c=c.remove(t))}),c})},fu.prototype.rr=function(t,e,n){for(var r=fs(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Bi&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.Qn.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof bo&&(h=h.Ae(t,e))}),h})},fu),uu=(cu.ar=function(t,e){for(var n=fs(),r=fs(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new cu(t,e.fromCache,n,r)},cu),au=(hu.prototype.cr=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},hu.prototype.next=function(){var t=++this.previousValue;return this._r&&this._r(t),t},hu);function hu(t,e){var n=this;this.previousValue=t,e&&(e.ur=function(t){return n.cr(t)},this._r=function(t){return e.lr(t)})}function cu(t,e,n,r){this.targetId=t,this.fromCache=e,this.hr=n,this.or=r}function fu(t,e,n){this.Qn=t,this.Wn=e,this.jn=n}function lu(){this.Bn=[]}function pu(){this.Dn=new Zs(function(t){return t.toString()}),this.Cn=!1}function du(t){var e=this;this.An=null,this.mn=null,this.result=void 0,this.error=void 0,this.Pn=!1,this.Vn=!1,t(function(t){e.Pn=!0,e.result=t,e.An&&e.An(t)},function(t){e.Pn=!0,e.error=t,e.mn&&e.mn(t)})}function yu(t,e,n,r){this.batch=t,this.In=e,this.En=n,this.Rn=r}function vu(t,e,n,r){this.batchId=t,this.Tn=e,this.baseMutations=n,this.mutations=r}function gu(t){this.dn=t,this.fn={}}function mu(t,e){this.projectId=t,this.database=e||"(default)"}function wu(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}au.dr=-1;var bu=(Eu.prototype.reset=function(){this.Ar=0},Eu.prototype.Vr=function(){this.Ar=this.Rr},Eu.prototype.gr=function(t){var e=this;this.cancel();var n=Math.floor(this.Ar+this.pr()),r=Math.max(0,Date.now()-this.Pr),i=Math.max(0,n-r);0<i&&qs("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Ar+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.mr=this.Tr.yr(this.Er,i,function(){return e.Pr=Date.now(),t()}),this.Ar*=this.Ir,this.Ar<this.wr&&(this.Ar=this.wr),this.Ar>this.Rr&&(this.Ar=this.Rr)},Eu.prototype.br=function(){null!==this.mr&&(this.mr.vr(),this.mr=null)},Eu.prototype.cancel=function(){null!==this.mr&&(this.mr.cancel(),this.mr=null)},Eu.prototype.pr=function(){return(Math.random()-.5)*this.Ar},Eu);function Eu(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Tr=t,this.Er=e,this.wr=n,this.Ir=r,this.Rr=i,this.Ar=0,this.mr=null,this.Pr=Date.now(),this.reset()}function Tu(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=Nu(e)),e=Iu(t.get(n),e);return Nu(e)}function Iu(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function Nu(t){return t+""}function Au(t){var e=t.length;if(Ws(2<=e),2===e)return Ws(""===t.charAt(0)&&""===t.charAt(1)),Lr.G;for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&zs(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:zs()}o=s+2}return new Lr(r)}var _u=(xu.prototype.Dr=function(t,e){return this.Sr.add(e),nu.resolve()},xu.prototype.ir=function(t,e){return nu.resolve(this.Sr.getEntries(e))},xu),Su=(Pu.prototype.add=function(t){var e=t.O(),n=t.M(),r=this.index[e]||new rs(Lr.N),i=!r.has(n);return this.index[e]=r.add(n),i},Pu.prototype.has=function(t){var e=t.O(),n=t.M(),r=this.index[e];return r&&r.has(n)},Pu.prototype.getEntries=function(t){return(this.index[t]||new rs(Lr.N)).W()},Pu),Ru=(Du.prototype.Dr=function(t,e){var n=this;if(this.Cr.has(e))return nu.resolve();var r=e.O(),i=e.M();t.qn(function(){n.Cr.add(e)});var o={collectionId:r,parent:Tu(i)};return Ou(t).put(o)},Du.prototype.ir=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Xs(i),""],!1,!0);return Ou(t).Fr(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(Au(r.parent))}return o})},Du);function Du(){this.Cr=new Su}function Pu(){this.index={}}function xu(){this.Sr=new Su}function Ou(t){return $u.Nr(t,Pa.store)}var ku,Lu=(Vu.prototype.Nn=function(t,e,n){return Mu(t).put(Uu(e),n)},Vu.prototype.kn=function(t,e){var n=Mu(t),r=Uu(e);return n.delete(r)},Vu.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.$r(e,t)})},Vu.prototype.Mn=function(t,e){var n=this;return Mu(t).get(Uu(e)).next(function(t){return n.kr(t)})},Vu.prototype.Mr=function(t,e){var n=this;return Mu(t).get(Uu(e)).next(function(t){var e=n.kr(t);return e?{xr:e,size:ju(t)}:null})},Vu.prototype.getEntries=function(t,e){var r=this,i=os;return this.Lr(t,e,function(t,e){var n=r.kr(e);i=i.Ae(t,n)}).next(function(){return i})},Vu.prototype.Or=function(t,e){var r=this,i=os,o=new Xo(Yr.N);return this.Lr(t,e,function(t,e){var n=r.kr(e);o=n?(i=i.Ae(t,n),o.Ae(t,ju(e))):(i=i.Ae(t,null),o.Ae(t,0))}).next(function(){return{Br:i,qr:o}})},Vu.prototype.Lr=function(t,e,i){if(e.B())return nu.resolve();var n=IDBKeyRange.bound(e.first().path.W(),e.last().path.W()),o=e.be(),s=o.Ne();return Mu(t).Ur({range:n},function(t,e,n){for(var r=Yr.st(t);s&&Yr.N(s,r)<0;)i(s,null),s=o.Ne();s&&s.isEqual(r)&&(i(s,e),s=o.$e()?o.Ne():null),s?n.Qr(s.path.W()):n.done()}).next(function(){for(;s;)i(s,null),s=o.$e()?o.Ne():null})},Vu.prototype.Zn=function(t,i,e){var n,r,o,s=this,u=as,a=i.path.length+1,h={};return e.isEqual(Or.min())?(n=i.path.W(),h.range=IDBKeyRange.lowerBound(n)):(r=i.path.W(),o=this.serializer.Wr(e),h.range=IDBKeyRange.lowerBound([r,o],!0),h.index=Aa.collectionReadTimeIndex),Mu(t).Ur(h,function(t,e,n){var r;t.length===a&&(r=s.serializer.jr(e),i.path.q(r.key.path)?r instanceof bo&&i.matches(r)&&(u=u.Ae(r.key,r)):n.done())}).next(function(){return u})},Vu.prototype.Kr=function(t,e){var r=this,i=os,o=this.serializer.Wr(e),n=Mu(t),s=IDBKeyRange.lowerBound(o,!0);return n.Ur({index:Aa.readTimeIndex,range:s},function(t,e){var n=r.serializer.jr(e);i=i.Ae(n.key,n),o=e.readTime}).next(function(){return{Gr:i,readTime:r.serializer.zr(o)}})},Vu.prototype.Hr=function(t){var r=this,e=Mu(t),i=Or.min();return e.Ur({index:Aa.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(i=r.serializer.zr(e.readTime)),n.done()}).next(function(){return i})},Vu.prototype.Yr=function(t){return new Vu.Jr(this,!!t&&t.Xr)},Vu.prototype.Zr=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Vu.prototype.getMetadata=function(t){return Cu(t).get(_a.key).next(function(t){return Ws(!!t),t})},Vu.prototype.$r=function(t,e){return Cu(t).put(_a.key,e)},Vu.prototype.kr=function(t){if(t){var e=this.serializer.jr(t);return e instanceof Eo&&e.version.isEqual(Or.min())?null:e}return null},Vu);function Vu(t,e){this.serializer=t,this.jn=e}function Cu(t){return $u.Nr(t,_a.store)}function Mu(t){return $u.Nr(t,Aa.store)}function Uu(t){return t.path.W()}function ju(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw zs();e=t.noDocument}return JSON.stringify(e).length}function Fu(t,e){var n=this;return(n=ku.call(this)||this).th=t,n.Xr=e,n.eh=new Zs(function(t){return t.toString()}),n}Lu.Jr=(n(Fu,ku=ru),Fu.prototype.On=function(s){var u=this,a=[],h=0,c=new rs(function(t,e){return Ys(t.j(),e.j())});return this.Dn.forEach(function(t,e){var n,r,i,o=u.eh.get(t);e?(n=u.th.serializer.sh(e,u.readTime),c=c.add(t.path.M()),r=ju(n),h+=r-o,a.push(u.th.Nn(s,t,n))):(h-=o,u.Xr?(i=u.th.serializer.sh(new Eo(t,Or.min()),u.readTime),a.push(u.th.Nn(s,t,i))):a.push(u.th.kn(s,t)))}),c.forEach(function(t){a.push(u.th.jn.Dr(s,t))}),a.push(this.th.updateMetadata(s,h)),nu.vn(a)},Fu.prototype.xn=function(t,e){var n=this;return this.th.Mr(t,e).next(function(t){return null===t?(n.eh.set(e,0),null):(n.eh.set(e,t.size),t.xr)})},Fu.prototype.Ln=function(t,e){var n=this;return this.th.Or(t,e).next(function(t){var e=t.Br;return t.qr.forEach(function(t,e){n.eh.set(t,e)}),e})},Fu);var qu=(zu.prototype.next=function(){return this.ih+=2,this.ih},zu.nh=function(){return new zu(0)},zu.rh=function(){return new zu(-1)},zu),Bu=(Gu.prototype.oh=function(n){var r=this;return this.ah(n).next(function(t){var e=new qu(t.highestTargetId);return t.highestTargetId=e.next(),r.uh(n,t).next(function(){return t.highestTargetId})})},Gu.prototype._h=function(t){return this.ah(t).next(function(t){return Or.v(new xr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},Gu.prototype.lh=function(t){return this.ah(t).next(function(t){return t.highestListenSequenceNumber})},Gu.prototype.dh=function(e,n,r){var i=this;return this.ah(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.C()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.uh(e,t)})},Gu.prototype.fh=function(e,n){var r=this;return this.Th(e,n).next(function(){return r.ah(e).next(function(t){return t.targetCount+=1,r.Eh(n,t),r.uh(e,t)})})},Gu.prototype.wh=function(t,e){return this.Th(t,e)},Gu.prototype.Ih=function(e,t){var n=this;return this.Rh(e,t.targetId).next(function(){return Wu(e).delete(t.targetId)}).next(function(){return n.ah(e)}).next(function(t){return Ws(0<t.targetCount),--t.targetCount,n.uh(e,t)})},Gu.prototype.Ah=function(r,i,o){var s=this,u=0,a=[];return Wu(r).Ur(function(t,e){var n=s.serializer.mh(e);n.sequenceNumber<=i&&null===o.get(n.targetId)&&(u++,a.push(s.Ih(r,n)))}).next(function(){return nu.vn(a)}).next(function(){return u})},Gu.prototype.js=function(t,r){var i=this;return Wu(t).Ur(function(t,e){var n=i.serializer.mh(e);r(n)})},Gu.prototype.ah=function(t){return Qu(t).get(Da.key).next(function(t){return Ws(null!==t),t})},Gu.prototype.uh=function(t,e){return Qu(t).put(Da.key,e)},Gu.prototype.Th=function(t,e){return Wu(t).put(this.serializer.Ph(e))},Gu.prototype.Eh=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},Gu.prototype.Vh=function(t){return this.ah(t).next(function(t){return t.targetCount})},Gu.prototype.gh=function(t,i){var o=this,e=i.canonicalId(),n=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),s=null;return Wu(t).Ur({range:n,index:Sa.queryTargetsIndexName},function(t,e,n){var r=o.serializer.mh(e);i.isEqual(r.target)&&(s=r,n.done())}).next(function(){return s})},Gu.prototype.ph=function(n,t,r){var i=this,o=[],s=Ku(n);return t.forEach(function(t){var e=Tu(t.path);o.push(s.put(new Ra(r,e))),o.push(i.hh.yh(n,r,t))}),nu.vn(o)},Gu.prototype.bh=function(n,t,r){var i=this,o=Ku(n);return nu.forEach(t,function(t){var e=Tu(t.path);return nu.vn([o.delete([r,e]),i.hh.vh(n,r,t)])})},Gu.prototype.Rh=function(t,e){var n=Ku(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},Gu.prototype.Sh=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Ku(t),o=fs();return r.Ur({range:n,Dh:!0},function(t,e,n){var r=Au(t[1]),i=new Yr(r);o=o.add(i)}).next(function(){return o})},Gu.prototype.Ch=function(t,e){var n=Tu(e.path),r=IDBKeyRange.bound([n],[Xs(n)],!1,!0),i=0;return Ku(t).Ur({index:Ra.documentTargetsIndex,Dh:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},Gu.prototype.si=function(t,e){var n=this;return Wu(t).get(e).next(function(t){return t?n.serializer.mh(t):null})},Gu);function Gu(t,e){this.hh=t,this.serializer=e}function zu(t){this.ih=t}function Wu(t){return $u.Nr(t,Sa.store)}function Qu(t){return $u.Nr(t,Da.store)}function Ku(t){return $u.Nr(t,Ra.store)}var Yu,Hu=(ea.prototype.jr=function(t){if(t.document)return this.Fh.mi(t.document,!!t.hasCommittedMutations);if(t.noDocument){var e=Yr.st(t.noDocument.path),n=this.Nh(t.noDocument.readTime);return new Eo(e,n,{hasCommittedMutations:!!t.hasCommittedMutations})}if(t.unknownDocument){var r=Yr.st(t.unknownDocument.path),i=this.Nh(t.unknownDocument.version);return new To(r,i)}return zs()},ea.prototype.sh=function(t,e){var n=this.Wr(e),r=t.key.path.M().W();if(t instanceof bo){var i=this.Fh.Ai(t),o=t.hasCommittedMutations;return new Aa(null,null,i,o,n,r)}if(t instanceof Eo){var s=t.key.path.W(),u=this.$h(t.version),a=t.hasCommittedMutations;return new Aa(null,new Ia(s,u),null,a,n,r)}if(t instanceof To){var h=t.key.path.W(),c=this.$h(t.version);return new Aa(new Na(h,c),null,null,!0,n,r)}return zs()},ea.prototype.Wr=function(t){var e=t.C();return[e.seconds,e.nanoseconds]},ea.prototype.zr=function(t){var e=new xr(t[0],t[1]);return Or.v(e)},ea.prototype.$h=function(t){var e=t.C();return new va(e.seconds,e.nanoseconds)},ea.prototype.Nh=function(t){var e=new xr(t.seconds,t.nanoseconds);return Or.v(e)},ea.prototype.kh=function(t,e){var n=this,r=e.baseMutations.map(function(t){return n.Fh.vi(t)}),i=e.mutations.map(function(t){return n.Fh.vi(t)});return new ba(t,e.batchId,e.Tn.toMillis(),r,i)},ea.prototype.Mh=function(t){var e=this,n=(t.baseMutations||[]).map(function(t){return e.Fh.Fi(t)}),r=t.mutations.map(function(t){return e.Fh.Fi(t)}),i=xr.fromMillis(t.localWriteTimeMs);return new tu(t.batchId,i,n,r)},ea.prototype.mh=function(t){var e=this.Nh(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?this.Nh(t.lastLimboFreeSnapshotVersion):Or.min(),r=void 0!==t.query.documents?this.Fh.Oi(t.query):this.Fh.Wi(t.query);return new ko(r,t.targetId,0,t.lastListenSequenceNumber,e,n,Zr.fromBase64String(t.resumeToken))},ea.prototype.Ph=function(t){var e=this.$h(t.Ee),n=this.$h(t.lastLimboFreeSnapshotVersion),r=t.target.Lt()?this.Fh.Li(t.target):this.Fh.Bi(t.target),i=t.resumeToken.toBase64();return new Sa(t.targetId,t.target.canonicalId(),e,i,t.sequenceNumber,n,r)},ea),Xu="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Ju=(n(ta,Yu=ou),ta),$u=(Zu.Nr=function(t,e){if(t instanceof Ju)return Va.Nr(t.xh,e);throw zs()},Zu.prototype.start=function(){var e=this;return Va.Zh(this.Hh,da,new ya(this.serializer)).then(function(t){return e.to=t,e.eo(e.Bh)}).then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new _r(Ar.FAILED_PRECONDITION,Xu);return e.so(),e.io(),e.no(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.Jh.lh(t)})}).then(function(t){e.qh=new au(t,e.Oh)}).then(function(){e.Uh=!0}).catch(function(t){return e.to&&e.to.close(),Promise.reject(t)})},Zu.prototype.ro=function(n){var t=this;return this.Gh=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.ho?[2,n(e)]:[2]})})},n(this.isPrimary)},Zu.prototype.oo=function(n){var t=this;this.to.ao(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},Zu.prototype.uo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Tr.co(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.ho?[4,this.eo()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},Zu.prototype.eo=function(t){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return ra(e).put(new Oa(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n._o(e).next(function(t){t||(n.isPrimary=!1,n.Tr.lo(function(){return n.Gh(!1)}))})}).next(function(){return n.do(e)}).next(function(t){return n.isPrimary&&!t?n.fo(e).next(function(){return!1}):!!t&&n.To(e).next(function(){return!0})})}).catch(function(t){if(n.allowTabSynchronization)return qs("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1;if(qa(t))return qs("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;throw t}).then(function(t){n.isPrimary!==t&&n.Tr.lo(function(){return n.Gh(t)}),n.isPrimary=t})},Zu.prototype._o=function(t){var e=this;return na(t).get(ga.key).next(function(t){return nu.resolve(e.Eo(t))})},Zu.prototype.wo=function(t){return ra(t).delete(this.clientId)},Zu.prototype.Io=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.Ro(this.Kh,18e5)?[3,2]:(this.Kh=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=Zu.Nr(t,Oa.store);return r.Fr().next(function(t){var e=o.Ao(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return nu.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.Xh)for(n=0,r=e;n<r.length;n++)i=r[n],this.Xh.removeItem(this.mo(i.clientId));t.label=2;case 2:return[2]}})})},Zu.prototype.no=function(){var t=this;this.jh=this.Tr.yr("client_metadata_refresh",4e3,function(){return t.eo().then(function(){return t.Io()}).then(function(){return t.no()})})},Zu.prototype.Eo=function(t){return!!t&&t.ownerId===this.clientId},Zu.prototype.do=function(e){var i=this;return this.Bh?nu.resolve(!0):na(e).get(ga.key).next(function(t){if(null!==t&&i.Ro(t.leaseTimestampMs,5e3)&&!i.Po(t.ownerId)){if(i.Eo(t)&&i.networkEnabled)return!0;if(!i.Eo(t)){if(!t.allowTabSynchronization)throw new _r(Ar.FAILED_PRECONDITION,Xu);return!1}}return!(!i.networkEnabled||!i.inForeground)||ra(e).Fr().next(function(t){return void 0===i.Ao(t,5e3).find(function(t){if(i.clientId!==t.clientId){var e=!i.networkEnabled&&t.networkEnabled,n=!i.inForeground&&t.inForeground,r=i.networkEnabled===t.networkEnabled;if(e||n&&r)return!0}return!1})})}).next(function(t){return i.isPrimary!==t&&qs("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},Zu.prototype.Vo=function(){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Uh=!1,this.po(),this.jh&&(this.jh.cancel(),this.jh=null),this.yo(),this.bo(),[4,this.runTransaction("shutdown","readwrite",function(t){return e.fo(t).next(function(){return e.wo(t)})}).catch(function(t){qs("IndexedDbPersistence","Proceeding with shutdown despite failure: ",t)})];case 1:return t.sent(),this.to.close(),this.vo(),[2]}})})},Zu.prototype.Ao=function(t,e){var n=this;return t.filter(function(t){return n.Ro(t.updateTimeMs,e)&&!n.Po(t.clientId)})},Zu.prototype.So=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return ra(t).Fr().next(function(t){return e.Ao(t,18e5).map(function(t){return t.clientId})})})},Zu.clearPersistence=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return Zu.zh()?(e=n+Zu.Yh,[4,Va.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})},Object.defineProperty(Zu.prototype,"ho",{get:function(){return this.Uh},enumerable:!0,configurable:!0}),Zu.prototype.Do=function(t){return ua.Co(t,this.serializer,this.jn,this.hh)},Zu.prototype.Fo=function(){return this.Jh},Zu.prototype.No=function(){return this.Qn},Zu.prototype.$o=function(){return this.jn},Zu.prototype.runTransaction=function(e,n,r){var i=this;qs("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.to.runTransaction(t,La,function(t){return o=new Ju(t,i.qh?i.qh.next():au.dr),"readwrite-primary"===n?i._o(o).next(function(t){return!!t||i.do(o)}).next(function(t){if(!t)throw Bs("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.Tr.lo(function(){return i.Gh(!1)}),new _r(Ar.FAILED_PRECONDITION,iu);return r(o)}).next(function(t){return i.To(o).next(function(){return t})}):i.ko(o).next(function(){return r(o)})}).then(function(t){return o.Un(),t})},Zu.prototype.ko=function(t){var e=this;return na(t).get(ga.key).next(function(t){if(null!==t&&e.Ro(t.leaseTimestampMs,5e3)&&!e.Po(t.ownerId)&&!e.Eo(t)&&!(e.Bh||e.allowTabSynchronization&&t.allowTabSynchronization))throw new _r(Ar.FAILED_PRECONDITION,Xu)})},Zu.prototype.To=function(t){var e=new ga(this.clientId,this.allowTabSynchronization,Date.now());return na(t).put(ga.key,e)},Zu.zh=function(){return Va.zh()},Zu.Mo=function(t){var e=t.ii.projectId;return t.ii.ln||(e+="."+t.ii.database),"firestore/"+t.persistenceKey+"/"+e+"/"},Zu.prototype.fo=function(t){var e=this,n=na(t);return n.get(ga.key).next(function(t){return e.Eo(t)?(qs("IndexedDbPersistence","Releasing primary lease."),n.delete(ga.key)):nu.resolve()})},Zu.prototype.Ro=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Bs("Detected an update time that is in the future: "+t+" > "+n),1))},Zu.prototype.so=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Wh=function(){t.Tr.co(function(){return t.inForeground="visible"===t.document.visibilityState,t.eo()})},this.document.addEventListener("visibilitychange",this.Wh),this.inForeground="visible"===this.document.visibilityState)},Zu.prototype.yo=function(){this.Wh&&(this.document.removeEventListener("visibilitychange",this.Wh),this.Wh=null)},Zu.prototype.io=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Qh=function(){e.po(),e.Tr.co(function(){return e.Vo()})},this.window.addEventListener("unload",this.Qh))},Zu.prototype.bo=function(){this.Qh&&(this.window.removeEventListener("unload",this.Qh),this.Qh=null)},Zu.prototype.Po=function(t){var e;try{var n=null!==(null===(e=this.Xh)||void 0===e?void 0:e.getItem(this.mo(t)));return qs("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Bs("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},Zu.prototype.po=function(){if(this.Xh)try{this.Xh.setItem(this.mo(this.clientId),String(Date.now()))}catch(t){Bs("Failed to set zombie client id.",t)}},Zu.prototype.vo=function(){if(this.Xh)try{this.Xh.removeItem(this.mo(this.clientId))}catch(t){}},Zu.prototype.mo=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},Zu);function Zu(t,e,n,r,i,o,s,u,a){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Tr=o,this.Oh=u,this.Bh=a,this.qh=null,this.Uh=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Qh=null,this.inForeground=!1,this.Wh=null,this.jh=null,this.Kh=Number.NEGATIVE_INFINITY,this.Gh=function(t){return Promise.resolve()},!Zu.zh())throw new _r(Ar.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.hh=new ia(this,i),this.Hh=e+Zu.Yh,this.serializer=new Hu(s),this.document=r.document,this.Jh=new Bu(this.hh,this.serializer),this.jn=new Ru,this.Qn=new Lu(this.serializer,this.jn),this.window=r.window,r.window&&r.window.localStorage?this.Xh=r.window.localStorage:(this.Xh=null,!1===a&&Bs("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function ta(t,e){var n=this;return(n=Yu.call(this)||this).xh=t,n.Lh=e,n}function ea(t){this.Fh=t}function na(t){return $u.Nr(t,ga.store)}function ra(t){return $u.Nr(t,Oa.store)}$u.Yh="main";var ia=(oa.prototype.Lo=function(t){var n=this.Oo(t);return this.db.Fo().Vh(t).next(function(e){return n.next(function(t){return e+t})})},oa.prototype.Oo=function(t){var e=0;return this.Bo(t,function(t){e++}).next(function(){return e})},oa.prototype.js=function(t,e){return this.db.Fo().js(t,e)},oa.prototype.Bo=function(t,n){return this.qo(t,function(t,e){return n(e)})},oa.prototype.yh=function(t,e,n){return sa(t,n)},oa.prototype.vh=function(t,e,n){return sa(t,n)},oa.prototype.Ah=function(t,e,n){return this.db.Fo().Ah(t,e,n)},oa.prototype.Uo=sa,oa.prototype.Qo=function(t,e){return r=e,i=!1,pa(n=t).Wo(function(t){return ha(n,t,r).next(function(t){return t&&(i=!0),nu.resolve(!t)})}).next(function(){return i});var n,r,i},oa.prototype.jo=function(r,i){var o=this,s=this.db.No().Yr(),u=[],a=0;return this.qo(r,function(e,t){var n;t<=i&&(n=o.Qo(r,e).next(function(t){if(!t)return a++,s.Mn(r,e).next(function(){return s.kn(e),Ku(r).delete([0,Tu(e.path)])})}),u.push(n))}).next(function(){return nu.vn(u)}).next(function(){return s.apply(r)}).next(function(){return a})},oa.prototype.removeTarget=function(t,e){var n=e.we(t.Lh);return this.db.Fo().wh(t,n)},oa.prototype.Ko=sa,oa.prototype.qo=function(t,o){var s,e=Ku(t),u=au.dr;return e.Ur({index:Ra.documentTargetsIndex},function(t,e){var n=t[0],r=(t[1],e.path),i=e.sequenceNumber;0===n?(u!==au.dr&&o(new Yr(Au(s)),u),u=i,s=r):u=au.dr}).next(function(){u!==au.dr&&o(new Yr(Au(s)),u)})},oa.prototype.Go=function(t){return this.db.No().Zr(t)},oa);function oa(t,e){this.db=t,this.xo=new uh(this,e)}function sa(t,e){return Ku(t).put((n=t.Lh,new Ra(0,Tu(e.path),n)));var n}var ua=(aa.Co=function(t,e,n,r){return Ws(""!==t.uid),new aa(t.t()?t.uid:"",e,n,r)},aa.prototype.Ho=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return fa(t).Ur({index:ba.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},aa.prototype.Yo=function(h,c,f,l){var p=this,d=la(h),y=fa(h);return y.add({}).next(function(t){Ws("number"==typeof t);for(var e=new tu(t,c,f,l),n=p.serializer.kh(p.userId,e),r=[],i=new rs(function(t,e){return Ys(t.j(),e.j())}),o=0,s=l;o<s.length;o++){var u=s[o],a=Ea.key(p.userId,u.key.path,t),i=i.add(u.key.path.M());r.push(y.put(n)),r.push(d.put(a,Ea.PLACEHOLDER))}return i.forEach(function(t){r.push(p.jn.Dr(h,t))}),h.qn(function(){p.zo[t]=e.keys()}),nu.vn(r).next(function(){return e})})},aa.prototype.Jo=function(t,e){var n=this;return fa(t).get(e).next(function(t){return t?(Ws(t.userId===n.userId),n.serializer.Mh(t)):null})},aa.prototype.Xo=function(t,n){var r=this;return this.zo[n]?nu.resolve(this.zo[n]):this.Jo(t,n).next(function(t){if(t){var e=t.keys();return r.zo[n]=e}return null})},aa.prototype.Zo=function(t,e){var r=this,i=e+1,n=IDBKeyRange.lowerBound([this.userId,i]),o=null;return fa(t).Ur({index:ba.userMutationsIndex,range:n},function(t,e,n){e.userId===r.userId&&(Ws(e.batchId>=i),o=r.serializer.Mh(e)),n.done()}).next(function(){return o})},aa.prototype.ta=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return fa(t).Ur({index:ba.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},aa.prototype.ea=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return fa(t).Fr(ba.userMutationsIndex,n).next(function(t){return t.map(function(t){return e.serializer.Mh(t)})})},aa.prototype.Gn=function(u,a){var h=this,t=Ea.prefixForPath(this.userId,a.path),e=IDBKeyRange.lowerBound(t),c=[];return la(u).Ur({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=Au(i);if(r===h.userId&&a.path.isEqual(s))return fa(u).get(o).next(function(t){if(!t)throw zs();Ws(t.userId===h.userId),c.push(h.serializer.Mh(t))});n.done()}).next(function(){return c})},aa.prototype.Xn=function(r,t){var a=this,h=new rs(Ys),i=[];return t.forEach(function(u){var t=Ea.prefixForPath(a.userId,u.path),e=IDBKeyRange.lowerBound(t),n=la(r).Ur({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=Au(i);r===a.userId&&u.path.isEqual(s)?h=h.add(o):n.done()});i.push(n)}),nu.vn(i).next(function(){return a.sa(r,h)})},aa.prototype.nr=function(t,e){var u=this,a=e.path,h=a.length+1,n=Ea.prefixForPath(this.userId,a),r=IDBKeyRange.lowerBound(n),c=new rs(Ys);return la(t).Ur({range:r},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=Au(i);r===u.userId&&a.q(s)?s.length===h&&(c=c.add(o)):n.done()}).next(function(){return u.sa(t,c)})},aa.prototype.sa=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(fa(e).get(t).next(function(t){if(null===t)throw zs();Ws(t.userId===n.userId),r.push(n.serializer.Mh(t))}))}),nu.vn(i).next(function(){return r})},aa.prototype.ia=function(e,n){var r=this;return ca(e.xh,this.userId,n).next(function(t){return e.qn(function(){r.na(n.batchId)}),nu.forEach(t,function(t){return r.hh.Uo(e,t)})})},aa.prototype.na=function(t){delete this.zo[t]},aa.prototype.ra=function(n){var o=this;return this.Ho(n).next(function(t){if(!t)return nu.resolve();var e=IDBKeyRange.lowerBound(Ea.prefixForUser(o.userId)),i=[];return la(n).Ur({range:e},function(t,e,n){var r;t[0]===o.userId?(r=Au(t[1]),i.push(r)):n.done()}).next(function(){Ws(0===i.length)})})},aa.prototype.Ch=function(t,e){return ha(t,this.userId,e)},aa.prototype.ha=function(t){var e=this;return pa(t).get(this.userId).next(function(t){return t||new wa(e.userId,-1,"")})},aa);function aa(t,e,n,r){this.userId=t,this.serializer=e,this.jn=n,this.hh=r,this.zo={}}function ha(t,o,e){var n=Ea.prefixForPath(o,e.path),s=n[1],r=IDBKeyRange.lowerBound(n),u=!1;return la(t).Ur({range:r,Dh:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function ca(t,e,n){var r=t.store(ba.store),i=t.store(Ea.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.Ur({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){Ws(1===u)}));for(var h=[],c=0,f=n.mutations;c<f.length;c++){var l=f[c],p=Ea.key(e,l.key.path,n.batchId);o.push(i.delete(p)),h.push(l.key)}return nu.vn(o).next(function(){return h})}function fa(t){return $u.Nr(t,ba.store)}function la(t){return $u.Nr(t,Ea.store)}function pa(t){return $u.Nr(t,wa.store)}var da=10,ya=(ma.prototype.createOrUpgrade=function(n,r,t,e){var i=this;Ws(t<e&&0<=t&&e<=da);var o,s=new Ba(r);t<1&&1<=e&&(n.createObjectStore(ga.store),(o=n).createObjectStore(wa.store,{keyPath:wa.keyPath}),o.createObjectStore(ba.store,{keyPath:ba.keyPath,autoIncrement:!0}).createIndex(ba.userMutationsIndex,ba.userMutationsKeyPath,{unique:!0}),o.createObjectStore(Ea.store),xa(n),n.createObjectStore(Aa.store));var u,a=nu.resolve();return t<3&&3<=e&&(0!==t&&((u=n).deleteObjectStore(Ra.store),u.deleteObjectStore(Sa.store),u.deleteObjectStore(Da.store),xa(n)),a=a.next(function(){return t=s.store(Da.store),e=new Da(0,0,Or.min().C(),0),t.put(Da.key,e);var t,e})),t<4&&4<=e&&(0!==t&&(a=a.next(function(){return r=n,(i=s).store(ba.store).Fr().next(function(t){r.deleteObjectStore(ba.store),r.createObjectStore(ba.store,{keyPath:ba.keyPath,autoIncrement:!0}).createIndex(ba.userMutationsIndex,ba.userMutationsKeyPath,{unique:!0});var e=i.store(ba.store),n=t.map(function(t){return e.put(t)});return nu.vn(n)});var r,i})),a=a.next(function(){n.createObjectStore(Oa.store,{keyPath:Oa.keyPath})})),t<5&&5<=e&&(a=a.next(function(){return i.removeAcknowledgedMutations(s)})),t<6&&6<=e&&(a=a.next(function(){return n.createObjectStore(_a.store),i.addDocumentGlobal(s)})),t<7&&7<=e&&(a=a.next(function(){return i.ensureSequenceNumbers(s)})),t<8&&8<=e&&(a=a.next(function(){return i.createCollectionParentIndex(n,s)})),t<9&&9<=e&&(a=a.next(function(){var t,e;(e=n).objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges"),(t=r.objectStore(Aa.store)).createIndex(Aa.readTimeIndex,Aa.readTimeIndexPath,{unique:!1}),t.createIndex(Aa.collectionReadTimeIndex,Aa.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=e&&(a=a.next(function(){return i.rewriteCanonicalIds(s)})),a},ma.prototype.addDocumentGlobal=function(e){var n=0;return e.store(Aa.store).Ur(function(t,e){n+=ju(e)}).next(function(){var t=new _a(n);return e.store(_a.store).put(_a.key,t)})},ma.prototype.removeAcknowledgedMutations=function(r){var i=this,t=r.store(wa.store),e=r.store(ba.store);return t.Fr().next(function(t){return nu.forEach(t,function(n){var t=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return e.Fr(ba.userMutationsIndex,t).next(function(t){return nu.forEach(t,function(t){Ws(t.userId===n.userId);var e=i.serializer.Mh(t);return ca(r,n.userId,e).next(function(){})})})})})},ma.prototype.ensureSequenceNumbers=function(t){var s=t.store(Ra.store),e=t.store(Aa.store);return t.store(Da.store).get(Da.key).next(function(i){var o=[];return e.Ur(function(t,e){var n=new Lr(t),r=[0,Tu(n)];o.push(s.get(r).next(function(t){return t?nu.resolve():s.put(new Ra(0,Tu(n),i.highestListenSequenceNumber))}))}).next(function(){return nu.vn(o)})})},ma.prototype.createCollectionParentIndex=function(t,e){function r(t){if(o.add(t)){var e=t.O(),n=t.M();return i.put({collectionId:e,parent:Tu(n)})}}t.createObjectStore(Pa.store,{keyPath:Pa.keyPath});var i=e.store(Pa.store),o=new Su;return e.store(Aa.store).Ur({Dh:!0},function(t,e){return r(new Lr(t).M())}).next(function(){return e.store(Ea.store).Ur({Dh:!0},function(t,e){t[0];var n=t[1];return r((t[2],Au(n)).M())})})},ma.prototype.rewriteCanonicalIds=function(t){var i=this,o=t.store(Sa.store);return o.Ur(function(t,e){var n=i.serializer.mh(e),r=i.serializer.Ph(n);return o.put(r)})},ma),va=function(t,e){this.seconds=t,this.nanoseconds=e},ga=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function ma(t){this.serializer=t}ga.store="owner",ga.key="owner";var wa=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};wa.store="mutationQueues",wa.keyPath="userId";var ba=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};ba.store="mutations",ba.keyPath="batchId",ba.userMutationsIndex="userMutationsIndex",ba.userMutationsKeyPath=["userId","batchId"];var Ea=(Ta.prefixForUser=function(t){return[t]},Ta.prefixForPath=function(t,e){return[t,Tu(e)]},Ta.key=function(t,e,n){return[t,Tu(e),n]},Ta);function Ta(){}Ea.store="documentMutations",Ea.PLACEHOLDER=new Ea;var Ia=function(t,e){this.path=t,this.readTime=e},Na=function(t,e){this.path=t,this.version=e},Aa=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Aa.store="remoteDocuments",Aa.readTimeIndex="readTimeIndex",Aa.readTimeIndexPath="readTime",Aa.collectionReadTimeIndex="collectionReadTimeIndex",Aa.collectionReadTimeIndexPath=["parentPath","readTime"];var _a=function(t){this.byteSize=t};_a.store="remoteDocumentGlobal",_a.key="remoteDocumentGlobalKey";var Sa=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Sa.store="targets",Sa.keyPath="targetId",Sa.queryTargetsIndexName="queryTargetsIndex",Sa.queryTargetsKeyPath=["canonicalId","targetId"];var Ra=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Ra.store="targetDocuments",Ra.keyPath=["targetId","path"],Ra.documentTargetsIndex="documentTargetsIndex",Ra.documentTargetsKeyPath=["path","targetId"];var Da=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Da.key="targetGlobalKey",Da.store="targetGlobal";var Pa=function(t,e){this.collectionId=t,this.parent=e};function xa(t){t.createObjectStore(Ra.store,{keyPath:Ra.keyPath}).createIndex(Ra.documentTargetsIndex,Ra.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Sa.store,{keyPath:Sa.keyPath}).createIndex(Sa.queryTargetsIndexName,Sa.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Da.store)}Pa.store="collectionParents",Pa.keyPath=["collectionId","parent"];var Oa=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Oa.store="clientMetadata",Oa.keyPath="clientId";var ka,La=d(d(d([wa.store,ba.store,Ea.store,Aa.store,Sa.store,ga.store,Da.store,Ra.store],[Oa.store]),[_a.store]),[Pa.store]),Va=(Fa.Zh=function(o,t,s){return qs("SimpleDb","Opening database:",o),new nu(function(n,r){var i=indexedDB.open(o,t);i.onsuccess=function(t){var e=t.target.result;n(new Fa(e))},i.onblocked=function(){r(new _r(Ar.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(t){var e=t.target.error;"VersionError"===e.name?r(new _r(Ar.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(e)},i.onupgradeneeded=function(t){qs("SimpleDb",'Database "'+o+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;s.createOrUpgrade(e,i.transaction,t.oldVersion,da).next(function(){qs("SimpleDb","Database upgrade to version "+da+" complete")})}}).yn()},Fa.delete=function(t){return qs("SimpleDb","Removing database:",t),Qa(window.indexedDB.deleteDatabase(t)).yn()},Fa.zh=function(){if("undefined"==typeof indexedDB)return!1;if(Fa.aa())return!0;var t=g(),e=Fa.oa(t),n=0<e&&e<10,r=Fa.ua(t),i=0<r&&r<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||i)},Fa.aa=function(){var t;return"undefined"!=typeof __PRIVATE_process&&"YES"===(null===(t=__PRIVATE_process.__PRIVATE_env)||void 0===t?void 0:t.ca)},Fa.Nr=function(t,e){return t.store(e)},Fa.oa=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},Fa.ua=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},Fa.prototype.ao=function(e){this.db.onversionchange=function(t){return e(t)}},Fa.prototype.runTransaction=function(r,h,c){return y(this,void 0,void 0,function(){var s,u,e,a,n;return v(this,function(t){switch(t.label){case 0:s="readonly"===r,u=0,e=function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:++u,e=Ba.open(a.db,s?"readonly":"readwrite",h),t.label=1;case 1:return t.trys.push([1,3,,4]),n=c(e).catch(function(t){return e.abort(t),nu.reject(t)}).yn(),r={},n.catch(function(){}),[4,e._a];case 2:return[2,(r.value=(t.sent(),n),r)];case 3:return i=t.sent(),o="FirebaseError"!==i.name&&u<3,qs("SimpleDb","Transaction failed with error: %s. Retrying: %s.",i.message,o),o?[3,4]:[2,{value:Promise.reject(i)}];case 4:return[2]}})},a=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(n=t.sent()))return[2,n.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},Fa.prototype.close=function(){this.db.close()},Fa),Ca=(Object.defineProperty(ja.prototype,"Pn",{get:function(){return this.da},enumerable:!0,configurable:!0}),Object.defineProperty(ja.prototype,"Ta",{get:function(){return this.fa},enumerable:!0,configurable:!0}),Object.defineProperty(ja.prototype,"cursor",{set:function(t){this.la=t},enumerable:!0,configurable:!0}),ja.prototype.done=function(){this.da=!0},ja.prototype.Qr=function(t){this.fa=t},ja.prototype.delete=function(){return Qa(this.la.delete())},ja),Ma=(n(Ua,ka=_r),Ua);function Ua(t){var e=this;return(e=ka.call(this,Ar.UNAVAILABLE,"IndexedDB transaction failed: "+t)||this).name="IndexedDbTransactionError",e}function ja(t){this.la=t,this.da=!1,this.fa=null}function Fa(t){this.db=t,12.2===Fa.oa(g())&&Bs("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function qa(t){return"IndexedDbTransactionError"===t.name}var Ba=(Wa.open=function(t,e,n){return new Wa(t.transaction(n,e))},Object.defineProperty(Wa.prototype,"_a",{get:function(){return this.Ea.promise},enumerable:!0,configurable:!0}),Wa.prototype.abort=function(t){t&&this.Ea.reject(t),this.aborted||(qs("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Wa.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Ga(e)},Wa),Ga=(za.prototype.put=function(t,e){return Qa(void 0!==e?(qs("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(qs("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},za.prototype.add=function(t){return qs("SimpleDb","ADD",this.store.name,t,t),Qa(this.store.add(t))},za.prototype.get=function(e){var n=this;return Qa(this.store.get(e)).next(function(t){return void 0===t&&(t=null),qs("SimpleDb","GET",n.store.name,e,t),t})},za.prototype.delete=function(t){return qs("SimpleDb","DELETE",this.store.name,t),Qa(this.store.delete(t))},za.prototype.count=function(){return qs("SimpleDb","COUNT",this.store.name),Qa(this.store.count())},za.prototype.Fr=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.wa(n,function(t,e){r.push(e)}).next(function(){return r})},za.prototype.Ia=function(t,e){qs("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.Dh=!1;var r=this.cursor(n);return this.wa(r,function(t,e,n){return n.delete()})},za.prototype.Ur=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.wa(r,e)},za.prototype.Wo=function(i){var t=this.cursor({});return new nu(function(n,r){t.onerror=function(t){var e=Ya(t.target.error);r(e)},t.onsuccess=function(t){var e=t.target.result;e?i(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},za.prototype.wa=function(t,s){var u=[];return new nu(function(o,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n,r,i=t.target.result;i?(e=new Ca(i),(n=s(i.primaryKey,i.value,e))instanceof nu&&(r=n.catch(function(t){return e.done(),nu.reject(t)}),u.push(r)),e.Pn?o():null===e.Ta?i.continue():i.continue(e.Ta)):o()}}).next(function(){return nu.vn(u)})},za.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},za.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Dh?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},za);function za(t){this.store=t}function Wa(t){var n=this;this.transaction=t,this.aborted=!1,this.Ea=new wu,this.transaction.oncomplete=function(){n.Ea.resolve()},this.transaction.onabort=function(){t.error?n.Ea.reject(new Ma(t.error)):n.Ea.resolve()},this.transaction.onerror=function(t){var e=Ya(t.target.error);n.Ea.reject(new Ma(e))}}function Qa(t){return new nu(function(n,r){t.onsuccess=function(t){var e=t.target.result;n(e)},t.onerror=function(t){var e=Ya(t.target.error);r(e)}})}var Ka=!1;function Ya(t){var e=Va.oa(g());if(12.2<=e&&e<13){var n="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(n)){var r=new _r("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Ka||(Ka=!0,setTimeout(function(){throw r},0)),r}}return t}var Ha=($a.Va=function(t,e,n,r,i){var o=new $a(t,e,Date.now()+n,r,i);return o.start(n),o},$a.prototype.start=function(t){var e=this;this.ga=setTimeout(function(){return e.pa()},t)},$a.prototype.vr=function(){return this.pa()},$a.prototype.cancel=function(t){null!==this.ga&&(this.clearTimeout(),this.Pa.reject(new _r(Ar.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},$a.prototype.pa=function(){var e=this;this.Ra.co(function(){return null!==e.ga?(e.clearTimeout(),e.op().then(function(t){return e.Pa.resolve(t)})):Promise.resolve()})},$a.prototype.clearTimeout=function(){null!==this.ga&&(this.ma(this),clearTimeout(this.ga),this.ga=null)},$a),Xa=(Object.defineProperty(Ja.prototype,"ka",{get:function(){return this.va},enumerable:!0,configurable:!0}),Ja.prototype.co=function(t){this.enqueue(t)},Ja.prototype.Ma=function(t){this.xa(),this.La(t)},Ja.prototype.Oa=function(t){return this.xa(),this.La(t)},Ja.prototype.Ba=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.xa(),this.va?[3,2]:(this.va=!0,(e=Ms.nt().window)&&e.removeEventListener("visibilitychange",this.$a),[4,this.Oa(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Ja.prototype.enqueue=function(t){return this.xa(),this.va?new Promise(function(t){}):this.La(t)},Ja.prototype.lo=function(i){var t=this;this.xa(),this.va||(this.ba=this.ba.then(function(){var n=new wu,r=function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,i()];case 1:return t.sent(),n.resolve(),this.Na.reset(),[3,3];case 2:if(!qa(e=t.sent()))throw n.resolve(),e;return qs("AsyncQueue","Operation failed with retryable error: "+e),this.Na.gr(r),[3,3];case 3:return[2]}})})};return t.co(r),n.promise}))},Ja.prototype.La=function(t){var r=this,e=this.ya.then(function(){return r.Ca=!0,t().catch(function(t){throw r.Da=t,r.Ca=!1,Bs("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Ca=!1,t})});return this.ya=e},Ja.prototype.yr=function(t,e,n){var r=this;this.xa(),-1<this.Fa.indexOf(t)&&(e=0);var i=Ha.Va(this,t,e,n,function(t){return r.qa(t)});return this.Sa.push(i),i},Ja.prototype.xa=function(){this.Da&&zs()},Ja.prototype.Ua=function(){},Ja.prototype.Qa=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.ya];case 1:t.sent(),t.label=2;case 2:if(e!==this.ya)return[3,0];t.label=3;case 3:return[2]}})})},Ja.prototype.Wa=function(t){for(var e=0,n=this.Sa;e<n.length;e++)if(n[e].Er===t)return!0;return!1},Ja.prototype.ja=function(r){var i=this;return this.Qa().then(function(){i.Sa.sort(function(t,e){return t.Aa-e.Aa});for(var t=0,e=i.Sa;t<e.length;t++){var n=e[t];if(n.vr(),"all"!==r&&n.Er===r)break}return i.Qa()})},Ja.prototype.Ka=function(t){this.Fa.push(t)},Ja.prototype.qa=function(t){var e=this.Sa.indexOf(t);this.Sa.splice(e,1)},Ja);function Ja(){var t=this;this.ya=Promise.resolve(),this.ba=Promise.resolve(),this.va=!1,this.Sa=[],this.Da=null,this.Ca=!1,this.Fa=[],this.Na=new bu(this,"async_queue_retry"),this.$a=function(){return t.Na.br()};var e=Ms.nt().window;e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.$a)}function $a(t,e,n,r,i){this.Ra=t,this.Er=e,this.Aa=n,this.op=r,this.ma=i,this.Pa=new wu,this.then=this.Pa.promise.then.bind(this.Pa.promise),this.Pa.promise.catch(function(t){})}function Za(t,e){if(Bs("AsyncQueue",e+": "+t),qa(t))return new _r(Ar.UNAVAILABLE,e+": "+t);throw t}function th(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Ys(n,i);return 0===s?Ys(r,o):s}var eh=(oh.prototype.Ha=function(){return++this.za},oh.prototype.Ya=function(t){var e,n=[t,this.Ha()];this.buffer.size<this.Ga?this.buffer=this.buffer.add(n):th(n,e=this.buffer.last())<0&&(this.buffer=this.buffer.delete(e).add(n))},Object.defineProperty(oh.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),oh),nh={Ja:!1,Xa:0,Za:0,tu:0},rh=(ih.nu=function(t){return new ih(t,ih.ru,ih.hu)},ih);function ih(t,e,n){this.eu=t,this.su=e,this.iu=n}function oh(t){this.Ga=t,this.buffer=new rs(th),this.za=0}rh.ou=-1,rh.au=1048576,rh.uu=41943040,rh.ru=10,rh.hu=1e3,rh.cu=new rh(rh.uu,rh.ru,rh.hu),rh.DISABLED=new rh(rh.ou,0,0);var sh=(fh.prototype.start=function(t){this.xo.du.eu!==rh.ou&&this.fu(t)},fh.prototype.stop=function(){this.lu&&(this.lu.cancel(),this.lu=null)},Object.defineProperty(fh.prototype,"ho",{get:function(){return null!==this.lu},enumerable:!0,configurable:!0}),fh.prototype.fu=function(n){var t=this,e=this._u?3e5:6e4;qs("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.lu=this.Ra.yr("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.lu=null,this._u=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.Tu(this.xo)];case 2:return t.sent(),[3,7];case 3:return qa(e=t.sent())?(qs("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,yh(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.fu(n)];case 8:return t.sent(),[2]}})})})},fh),uh=(ch.prototype.wu=function(t,e){return this.Eu.Lo(t).next(function(t){return Math.floor(e/100*t)})},ch.prototype.Iu=function(t,e){var n=this;if(0===e)return nu.resolve(au.dr);var r=new eh(e);return this.Eu.js(t,function(t){return r.Ya(t.sequenceNumber)}).next(function(){return n.Eu.Bo(t,function(t){return r.Ya(t)})}).next(function(){return r.maxValue})},ch.prototype.Ah=function(t,e,n){return this.Eu.Ah(t,e,n)},ch.prototype.jo=function(t,e){return this.Eu.jo(t,e)},ch.prototype.Ru=function(e,n){var r=this;return this.du.eu===rh.ou?(qs("LruGarbageCollector","Garbage collection skipped; disabled"),nu.resolve(nh)):this.Go(e).next(function(t){return t<r.du.eu?(qs("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.du.eu),nh):r.Au(e,n)})},ch.prototype.Go=function(t){return this.Eu.Go(t)},ch.prototype.Au=function(e,n){var r,i,o,s,u,a,h,c=this,f=Date.now();return this.wu(e,this.du.su).next(function(t){return i=t>c.du.iu?(qs("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.du.iu+" from "+t),c.du.iu):t,s=Date.now(),c.Iu(e,i)}).next(function(t){return r=t,u=Date.now(),c.Ah(e,r,n)}).next(function(t){return o=t,a=Date.now(),c.jo(e,r)}).next(function(t){return h=Date.now(),Fs()<=p.DEBUG&&qs("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(h-a)+"ms\nTotal Duration: "+(h-f)+"ms"),nu.resolve({Ja:!0,Xa:i,Za:o,tu:t})})},ch),ah=(hh.prototype.start=function(){return Promise.resolve()},hh.prototype.vu=function(i){return y(this,void 0,void 0,function(){var e,m,n,r=this;return v(this,function(t){switch(t.label){case 0:return e=this.Wn,m=this.yu,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return r.Wn.ea(v).next(function(t){return g=t,e=r.persistence.Do(i),m=new su(r.pu,e,r.persistence.$o()),e.ea(v)}).next(function(t){for(var e=[],n=[],r=fs(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,f=t;c<f.length;c++){var l=f[c];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Yn(v,r).next(function(t){return{Su:t,Du:e,Cu:n}})})})];case 1:return n=t.sent(),[2,(this.Wn=e,this.yu=m,this.mu.bu(this.yu),n)]}})})},hh.prototype.Fu=function(u){var a,h=this,c=xr.now(),t=u.reduce(function(t,e){return t.add(e.key)},fs());return this.persistence.runTransaction("Locally write mutations","readwrite",function(s){return h.yu.Yn(s,t).next(function(t){a=t;for(var e=[],n=0,r=u;n<r.length;n++){var i=r[n],o=i.Pt(a.get(i.key));null!=o&&e.push(new Bi(i.key,o,oo(o.proto.mapValue),ji.exists(!0)))}return h.Wn.Yo(s,c,e,u)})}).then(function(t){var e=t.wn(a);return{batchId:t.batchId,Dn:e}})},hh.prototype.Nu=function(r){var i=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=r.batch.keys(),n=i.pu.Yr({Xr:!0});return i.$u(t,r,n).next(function(){return n.apply(t)}).next(function(){return i.Wn.ra(t)}).next(function(){return i.yu.Yn(t,e)})})},hh.prototype.ku=function(t){var r=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return r.Wn.Jo(e,t).next(function(t){return Ws(null!==t),n=t.keys(),r.Wn.ia(e,t)}).next(function(){return r.Wn.ra(e)}).next(function(){return r.yu.Yn(e,n)})})},hh.prototype.ta=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Wn.ta(t)})},hh.prototype._h=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Jh._h(t)})},hh.prototype.Mu=function(a){var h=this,c=a.Ee,f=this.Pu;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var i=h.pu.Yr({Xr:!0});f=h.Pu;var s=[];a.as.forEach(function(t,e){var n,r,i=f.get(e);i&&(s.push(h.Jh.bh(o,t.ws,e).next(function(){return h.Jh.ph(o,t.Ts,e)})),0<(n=t.resumeToken).rt()&&(r=i.Ie(n,c).we(o.Lh),f=f.Ae(e,r),hh.xu(i,r,t)&&s.push(h.Jh.wh(o,r))))});var t,u=os,n=fs();return a.cs.forEach(function(t,e){n=n.add(t)}),s.push(i.getEntries(o,n).next(function(r){a.cs.forEach(function(t,e){var n=r.get(t);e instanceof Eo&&e.version.isEqual(Or.min())?(i.kn(t,c),u=u.Ae(t,e)):null==n||0<e.version.S(n.version)||0===e.version.S(n.version)&&n.hasPendingWrites?(i.Nn(e,c),u=u.Ae(t,e)):qs("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a._s.has(t)&&s.push(h.persistence.hh.Ko(o,t))})})),c.isEqual(Or.min())||(t=h.Jh._h(o).next(function(t){return h.Jh.dh(o,o.Lh,c)}),s.push(t)),nu.vn(s).next(function(){return i.apply(o)}).next(function(){return h.yu.Jn(o,u)})}).then(function(t){return h.Pu=f,t})},hh.xu=function(t,e,n){return Ws(0<e.resumeToken.rt()),0===t.resumeToken.rt()||e.Ee.D()-t.Ee.D()>=this.Lu||0<n.Ts.size+n.Es.size+n.ws.size},hh.prototype.Ou=function(c){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return nu.forEach(c,function(e){return nu.forEach(e.hr,function(t){return h.persistence.hh.yh(n,e.targetId,t)}).next(function(){return nu.forEach(e.or,function(t){return h.persistence.hh.vh(n,e.targetId,t)})})})})];case 1:return t.sent(),[3,3];case 2:if(!qa(e=t.sent()))throw e;return qs("LocalStore","Failed to update sequence numbers: "+e),[3,3];case 3:for(n=0,r=c;n<r.length;n++)i=r[n],o=i.targetId,i.fromCache||(s=this.Pu.get(o),u=s.Ee,a=s.Re(u),this.Pu=this.Pu.Ae(o,a));return[2]}})})},hh.prototype.Bu=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Wn.Zo(t,e)})},hh.prototype.qu=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.yu.Kn(t,e)})},hh.prototype.Uu=function(r){var i=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Jh.gh(e,r).next(function(t){return t?(n=t,nu.resolve(n)):i.Jh.oh(e).next(function(t){return n=new ko(r,t,0,e.Lh),i.Jh.fh(e,n).next(function(){return n})})})}).then(function(t){var e=i.Pu.get(t.targetId);return(null===e||0<t.Ee.S(e.Ee))&&(i.Pu=i.Pu.Ae(t.targetId,t),i.Vu.set(r,t.targetId)),t})},hh.prototype.gh=function(t,e){var n=this.Vu.get(e);return void 0!==n?nu.resolve(this.Pu.get(n)):this.Jh.gh(t,e)},hh.prototype.Qu=function(t,e){var n=this,r=this.Pu.get(t),i=e?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release target",i,function(t){return e?nu.resolve():n.persistence.hh.removeTarget(t,r)}).then(function(){n.Pu=n.Pu.remove(t),n.Vu.delete(r.target)})},hh.prototype.Wu=function(t,n){var r=this,i=Or.min(),o=fs();return this.persistence.runTransaction("Execute query","readonly",function(e){return r.gh(e,t.ee()).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.Jh.Sh(e,t.targetId).next(function(t){o=t})}).next(function(){return r.mu.Zn(e,t,n?i:Or.min(),n?o:fs())}).next(function(t){return{documents:t,ju:o}})})},hh.prototype.$u=function(t,i,o){var e=this,s=i.batch,n=s.keys(),u=nu.resolve();return n.forEach(function(r){u=u.next(function(){return o.Mn(t,r)}).next(function(t){var e=t,n=i.Rn.get(r);Ws(null!==n),(!e||e.version.S(n)<0)&&(e=s.at(r,e,i))&&o.Nn(e,i.In)})}),u.next(function(){return e.Wn.ia(t,s)})},hh.prototype.Tu=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Ru(t,n.Pu)})},hh);function hh(t,e,n){this.persistence=t,this.mu=e,this.Pu=new Xo(Ys),this.Vu=new Zs(function(t){return t.canonicalId()}),this.gu=Or.min(),this.Wn=t.Do(n),this.pu=t.No(),this.Jh=t.Fo(),this.yu=new su(this.pu,this.Wn,this.persistence.$o()),this.mu.bu(this.yu)}function ch(t,e){this.Eu=t,this.du=e}function fh(t,e){this.xo=t,this.Ra=e,this._u=!1,this.lu=null}ah.Lu=3e8;var lh,ph=(n(dh,lh=ah),dh.prototype.start=function(){return this.Ku()},dh.prototype.Gu=function(t){var n=this;return this.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return n.Wn.Xo(e,t).next(function(t){return t?n.yu.Yn(e,t):nu.resolve(null)})})},dh.prototype.zu=function(t){this.Wn.na(t)},dh.prototype.uo=function(t){this.persistence.uo(t)},dh.prototype.So=function(){return this.persistence.So()},dh.prototype.Hu=function(e){var n=this,t=this.Pu.get(e);return t?Promise.resolve(t.target):this.persistence.runTransaction("Get target data","readonly",function(t){return n.Jh.si(t,e).next(function(t){return t?t.target:null})})},dh.prototype.Kr=function(){var r=this;return this.persistence.runTransaction("Get new document changes","readonly",function(t){return r.pu.Kr(t,r.gu)}).then(function(t){var e=t.Gr,n=t.readTime;return r.gu=n,e})},dh.prototype.Ku=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,(e=this).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return n.pu.Hr(t)})];case 1:return e.gu=t.sent(),[2]}})})},dh);function dh(t,e,n){var r=this;return(r=lh.call(this,t,e,n)||this).persistence=t,r.Wn=t.Do(n),r.pu=t.No(),r.Jh=t.Fo(),r}function yh(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Ar.FAILED_PRECONDITION||e.message!==iu)throw e;return qs("LocalStore","Unexpectedly lost primary lease"),[2]})})}var vh=(wh.prototype.B=function(){return this.Yu.B()},wh.prototype.yh=function(t,e){var n=new gh(t,e);this.Yu=this.Yu.add(n),this.Xu=this.Xu.add(n)},wh.prototype.tc=function(t,e){var n=this;t.forEach(function(t){return n.yh(t,e)})},wh.prototype.vh=function(t,e){this.ec(new gh(t,e))},wh.prototype.sc=function(t,e){var n=this;t.forEach(function(t){return n.vh(t,e)})},wh.prototype.ic=function(t){var e=this,n=Yr.EMPTY,r=new gh(n,t),i=new gh(n,t+1),o=[];return this.Xu.Ke([r,i],function(t){e.ec(t),o.push(t.key)}),o},wh.prototype.nc=function(){var e=this;this.Yu.forEach(function(t){return e.ec(t)})},wh.prototype.ec=function(t){this.Yu=this.Yu.delete(t),this.Xu=this.Xu.delete(t)},wh.prototype.rc=function(t){var e=Yr.EMPTY,n=new gh(e,t),r=new gh(e,t+1),i=fs();return this.Xu.Ke([n,r],function(t){i=i.add(t.key)}),i},wh.prototype.Ch=function(t){var e=new gh(t,0),n=this.Yu.ze(e);return null!==n&&t.isEqual(n.key)},wh),gh=(mh.Ju=function(t,e){return Yr.N(t.key,e.key)||Ys(t.hc,e.hc)},mh.Zu=function(t,e){return Ys(t.hc,e.hc)||Yr.N(t.key,e.key)},mh);function mh(t,e){this.key=t,this.hc=e}function wh(){this.Yu=new rs(gh.Ju),this.Xu=new rs(gh.Zu)}function bh(t,e){if(0!==e.length)throw new _r(Ar.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Uh(e.length,"argument")+".")}function Eh(t,e,n){if(e.length!==n)throw new _r(Ar.INVALID_ARGUMENT,"Function "+t+"() requires "+Uh(n,"argument")+", but was called with "+Uh(e.length,"argument")+".")}function Th(t,e,n){if(e.length<n)throw new _r(Ar.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Uh(n,"argument")+", but was called with "+Uh(e.length,"argument")+".")}function Ih(t,e,n,r){if(e.length<n||e.length>r)throw new _r(Ar.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+Uh(e.length,"argument")+".")}function Nh(t,e,n,r){Ph(t,e,Mh(n)+" argument",r)}function Ah(t,e,n,r){void 0!==r&&Nh(t,e,n,r)}function _h(t,e,n,r){Ph(t,e,n+" option",r)}function Sh(t,e,n,r){void 0!==r&&_h(t,e,n,r)}function Rh(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(Oh(s))}var u=Oh(n);throw new _r(Ar.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function Dh(t,e,n,r){if(!e.some(function(t){return t===r}))throw new _r(Ar.INVALID_ARGUMENT,"Invalid value "+Oh(r)+" provided to function "+t+"() for its "+Mh(n)+" argument. Acceptable values: "+e.join(", "));return r}function Ph(t,e,n,r){if(!("object"===e?xh(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=Oh(r);throw new _r(Ar.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function xh(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Oh(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":zs();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function kh(t,e,n){if(void 0===n)throw new _r(Ar.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Mh(e)+" argument, but it was undefined.")}function Lh(n,t,r){Jr(t,function(t,e){if(r.indexOf(t)<0)throw new _r(Ar.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function Vh(t,e,n,r){var i=Oh(r);return new _r(Ar.INVALID_ARGUMENT,"Function "+t+"() requires its "+Mh(n)+" argument to be a "+e+", but it was: "+i)}function Ch(t,e,n){if(n<=0)throw new _r(Ar.INVALID_ARGUMENT,"Function "+t+"() requires its "+Mh(e)+" argument to be a positive number, but it was: "+n+".")}function Mh(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Uh(t,e){return t+" "+e+(1===t?"":"s")}function jh(){if("undefined"==typeof Uint8Array)throw new _r(Ar.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Fh(){if(!Ms.nt().oc)throw new _r(Ar.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var qh=(zh.fromBase64String=function(t){Eh("Blob.fromBase64String",arguments,1),Nh("Blob.fromBase64String","string",1,t),Fh();try{return new zh(Zr.fromBase64String(t))}catch(t){throw new _r(Ar.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},zh.fromUint8Array=function(t){if(Eh("Blob.fromUint8Array",arguments,1),jh(),!(t instanceof Uint8Array))throw Vh("Blob.fromUint8Array","Uint8Array",1,t);return new zh(Zr.fromUint8Array(t))},zh.prototype.toBase64=function(){return Eh("Blob.toBase64",arguments,0),Fh(),this.ac.toBase64()},zh.prototype.toUint8Array=function(){return Eh("Blob.toUint8Array",arguments,0),jh(),this.ac.toUint8Array()},zh.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},zh.prototype.isEqual=function(t){return this.ac.isEqual(t.ac)},zh),Bh=(Gh.documentId=function(){return Gh.cc},Gh.prototype.isEqual=function(t){if(!(t instanceof Gh))throw Vh("isEqual","FieldPath",1,t);return this.uc.isEqual(t.uc)},Gh);function Gh(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(){if(!(t instanceof Array)||t.length<1)throw new _r(Ar.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var n=0;n<t.length;++n)if(Nh("FieldPath","string",n,t[n]),0===t[n].length)throw new _r(Ar.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.uc=new Qr(t)}function zh(t){Fh(),this.ac=t}Bh.cc=new Bh(Qr.J().j());var Wh,Qh,Kh,Yh,Hh,Xh,Jh,$h=new RegExp("[~\\*/\\[\\]]"),Zh=function(){this._c=this},tc=(n(Ec,Jh=Zh),Ec.prototype.dc=function(t){if(2!==t.fc)throw 1===t.fc?t.Tc(this.lc+"() can only appear at the top level of your update data"):t.Tc(this.lc+"() cannot be used with set() unless you pass {merge:true}");return t.Vt.push(t.path),null},Ec.prototype.isEqual=function(t){return t instanceof Ec},Ec),ec=(n(bc,Xh=Zh),bc.prototype.dc=function(t){return new Ui(t.path,Ti.instance)},bc.prototype.isEqual=function(t){return t instanceof bc},bc),nc=(n(wc,Hh=Zh),wc.prototype.dc=function(t){var e=new Ic({fc:3,methodName:this.lc,wc:!0},t.ii,t.serializer,t.ignoreUndefinedProperties),n=this.Ec.map(function(t){return Sc(t,e)}),r=new Ni(n);return new Ui(t.path,r)},wc.prototype.isEqual=function(t){return this===t},wc),rc=(n(mc,Yh=Zh),mc.prototype.dc=function(t){var e=new Ic({fc:3,methodName:this.lc,wc:!0},t.ii,t.serializer,t.ignoreUndefinedProperties),n=this.Ec.map(function(t){return Sc(t,e)}),r=new Ai(n);return new Ui(t.path,r)},mc.prototype.isEqual=function(t){return this===t},mc),ic=(n(gc,Kh=Zh),gc.prototype.dc=function(t){var e=new Ic({fc:3,methodName:this.lc},t.ii,t.serializer,t.ignoreUndefinedProperties),n=Sc(this.Ic,e),r=new _i(t.serializer,n);return new Ui(t.path,r)},gc.prototype.isEqual=function(t){return this===t},gc),oc=(n(vc,Qh=Zh),vc.delete=function(){return bh("FieldValue.delete",arguments),new sc(new tc("FieldValue.delete"))},vc.serverTimestamp=function(){return bh("FieldValue.serverTimestamp",arguments),new sc(new ec("FieldValue.serverTimestamp"))},vc.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Th("FieldValue.arrayUnion",arguments,1),new sc(new nc("FieldValue.arrayUnion",t))},vc.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Th("FieldValue.arrayRemove",arguments,1),new sc(new rc("FieldValue.arrayRemove",t))},vc.increment=function(t){return Nh("FieldValue.increment","number",1,t),Eh("FieldValue.increment",arguments,1),new sc(new ic("FieldValue.increment",t))},vc),sc=(n(yc,Wh=oc),yc.prototype.dc=function(t){return this._c.dc(t)},yc.prototype.isEqual=function(t){return t instanceof yc&&this._c.isEqual(t._c)},yc),uc=(Object.defineProperty(dc.prototype,"latitude",{get:function(){return this.Rc},enumerable:!0,configurable:!0}),Object.defineProperty(dc.prototype,"longitude",{get:function(){return this.Ac},enumerable:!0,configurable:!0}),dc.prototype.isEqual=function(t){return this.Rc===t.Rc&&this.Ac===t.Ac},dc.prototype.p=function(t){return Ys(this.Rc,t.Rc)||Ys(this.Ac,t.Ac)},dc),ac=/^__.*__$/,hc=function(t,e,n){this.mc=t,this.Pc=e,this.Vc=n},cc=(pc.prototype.gc=function(t,e){var n=[];return null!==this.Vt?n.push(new Bi(t,this.data,this.Vt,e)):n.push(new qi(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Gi(t,this.fieldTransforms)),n},pc),fc=(lc.prototype.gc=function(t,e){var n=[new Bi(t,this.data,this.Vt,e)];return 0<this.fieldTransforms.length&&n.push(new Gi(t,this.fieldTransforms)),n},lc);function lc(t,e,n){this.data=t,this.Vt=e,this.fieldTransforms=n}function pc(t,e,n){this.data=t,this.Vt=e,this.fieldTransforms=n}function dc(t,e){if(Eh("GeoPoint",arguments,2),Nh("GeoPoint","number",1,t),Nh("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new _r(Ar.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new _r(Ar.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Rc=t,this.Ac=e}function yc(t){var e=this;return(e=Wh.call(this)||this)._c=t,e.lc=t.lc,e}function vc(){return null!==Qh&&Qh.apply(this,arguments)||this}function gc(t,e){var n=this;return(n=Kh.call(this)||this).lc=t,n.Ic=e,n}function mc(t,e){var n=this;return(n=Yh.call(this)||this).lc=t,n.Ec=e,n}function wc(t,e){var n=this;return(n=Hh.call(this)||this).lc=t,n.Ec=e,n}function bc(t){var e=this;return(e=Xh.call(this)||this).lc=t,e}function Ec(t){var e=this;return(e=Jh.call(this)||this).lc=t,e}function Tc(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw zs()}}var Ic=(Object.defineProperty(_c.prototype,"path",{get:function(){return this.settings.path},enumerable:!0,configurable:!0}),Object.defineProperty(_c.prototype,"fc",{get:function(){return this.settings.fc},enumerable:!0,configurable:!0}),_c.prototype.yc=function(t){return new _c(Object.assign(Object.assign({},this.settings),t),this.ii,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Vt)},_c.prototype.bc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.yc({path:n,wc:!1});return r.vc(t),r},_c.prototype.Sc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.yc({path:n,wc:!1});return r.pc(),r},_c.prototype.Dc=function(t){return this.yc({path:void 0,wc:!0})},_c.prototype.Tc=function(t){var e=!this.path||this.path.B()?"":" (found in field "+this.path.toString()+")";return new _r(Ar.INVALID_ARGUMENT,"Function "+this.settings.methodName+"() called with invalid data. "+t+e)},_c.prototype.contains=function(e){return void 0!==this.Vt.find(function(t){return e.q(t)})||void 0!==this.fieldTransforms.find(function(t){return e.q(t.field)})},_c.prototype.pc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.vc(this.path.get(t))},_c.prototype.vc=function(t){if(0===t.length)throw this.Tc("Document fields must not be empty");if(Tc(this.fc)&&ac.test(t))throw this.Tc('Document fields cannot begin and end with "__"')},_c),Nc=(Ac.prototype.Fc=function(t,e){var n=this.Nc(0,t);Pc("Data must be an object, but it was:",n,e);var r=Rc(e,n);return new cc(new Qi(r),null,n.fieldTransforms)},Ac.prototype.$c=function(t,e,n){var r=this.Nc(2,t);Pc("Data must be an object, but it was:",r,e);var i,o,s=Rc(e,r);if(n){for(var u=[],a=0,h=n;a<h.length;a++){var c=h[a],f=void 0;if(c instanceof Bh)f=c.uc;else{if("string"!=typeof c)throw zs();f=Oc(t,c)}if(!r.contains(f))throw new _r(Ar.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");kc(u,f)||u.push(f)}i=new Mi(u),o=r.fieldTransforms.filter(function(t){return i.dt(t.field)})}else i=new Mi(r.Vt),o=r.fieldTransforms;return new cc(new Qi(s),i,o)},Ac.prototype.kc=function(o,t){var s=this.Nc(1,o);Pc("Data must be an object, but it was:",s,t);var u=[],a=new Ki;Jr(t,function(t,e){var n,r=Oc(o,t),i=s.Sc(r);e instanceof Zh&&e._c instanceof tc?u.push(r):null!=(n=Sc(e,i))&&(u.push(r),a.set(r,n))});var e=new Mi(u);return new fc(a.yt(),e,s.fieldTransforms)},Ac.prototype.Mc=function(t,e,n,r){var i=this.Nc(1,t),o=[xc(t,e)],s=[n];if(r.length%2!=0)throw new _r(Ar.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var u=0;u<r.length;u+=2)o.push(xc(t,r[u])),s.push(r[u+1]);for(var a,h,c,f,l=[],p=new Ki,d=o.length-1;0<=d;--d){kc(l,o[d])||(a=o[d],h=s[d],c=i.Sc(a),h instanceof Zh&&h._c instanceof tc?l.push(a):null!=(f=Sc(h,c))&&(l.push(a),p.set(a,f)))}var y=new Mi(l);return new fc(p.yt(),y,i.fieldTransforms)},Ac.prototype.Nc=function(t,e){return new Ic({fc:t,methodName:e,path:Qr.G,wc:!1},this.ii,this.serializer,this.ignoreUndefinedProperties)},Ac.prototype.xc=function(t,e,n){return void 0===n&&(n=!1),Sc(e,this.Nc(n?4:3,t))},Ac);function Ac(t,e,n){this.ii=t,this.ignoreUndefinedProperties=e,this.serializer=n||Ms.nt().Cc(t)}function _c(t,e,n,r,i,o){this.settings=t,this.ii=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.pc(),this.fieldTransforms=i||[],this.Vt=o||[]}function Sc(s,t){if(Dc(s))return Pc("Unsupported field value:",t,s),Rc(s,t);if(s instanceof Zh)return function(t,e){if(!Tc(e.fc))throw e.Tc(t.lc+"() can only be used with update() and set()");if(null===e.path)throw e.Tc(t.lc+"() is not currently supported inside arrays");var n=t.dc(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Vt.push(t.path),s instanceof Array){if(t.settings.wc&&4!==t.fc)throw t.Tc("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Sc(i[r],t.Dc(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return e.serializer.ai(t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=xr.fromDate(t);return{timestampValue:e.serializer.C(n)}}if(t instanceof xr){var r=new xr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:e.serializer.C(r)}}if(t instanceof uc)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof qh)return{bytesValue:e.serializer.ui(t)};if(t instanceof hc){var i=e.ii,o=t.mc;if(!o.isEqual(i))throw e.Tc("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:e.serializer._i(t.Pc.path,t.mc)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Tc("Unsupported field value: "+Oh(t))}(s,t)}function Rc(t,r){var i={};return $r(t)?r.path&&0<r.path.length&&r.Vt.push(r.path):Jr(t,function(t,e){var n=Sc(e,r.bc(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function Dc(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof xr||t instanceof uc||t instanceof qh||t instanceof hc||t instanceof Zh)}function Pc(t,e,n){if(!Dc(n)||!xh(n)){var r=Oh(n);throw"an object"===r?e.Tc(t+" a custom object"):e.Tc(t+" "+r)}}function xc(t,e){if(e instanceof Bh)return e.uc;if("string"==typeof e)return Oc(t,e);throw new _r(Ar.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function Oc(t,e){try{return function(e){if(0<=e.search($h))throw new _r(Ar.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Bh.bind.apply(Bh,d([void 0],e.split("."))))}catch(t){throw new _r(Ar.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).uc}catch(e){var n=e instanceof Error?e.message:e.toString();throw new _r(Ar.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function kc(t,e){return t.some(function(t){return t.isEqual(e)})}var Lc,Vc,Cc,Mc=(Xc.prototype.Qc=function(){return 1===this.state||2===this.state||4===this.state},Xc.prototype.Wc=function(){return 2===this.state},Xc.prototype.start=function(){3!==this.state?this.auth():this.jc()},Xc.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Qc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Xc.prototype.Kc=function(){this.state=0,this.Na.reset()},Xc.prototype.Gc=function(){var t=this;this.Wc()&&null===this.Uc&&(this.Uc=this.Tr.yr(this.Lc,6e4,function(){return t.zc()}))},Xc.prototype.Hc=function(t){this.Yc(),this.stream.send(t)},Xc.prototype.zc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.Wc()?[2,this.close(0)]:[2]})})},Xc.prototype.Yc=function(){this.Uc&&(this.Uc.cancel(),this.Uc=null)},Xc.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Yc(),this.Na.cancel(),this.qc++,3!==e?this.Na.reset():n&&n.code===Ar.RESOURCE_EXHAUSTED?(Bs(n.toString()),Bs("Using maximum backoff delay to prevent overloading the backend."),this.Na.Vr()):n&&n.code===Ar.UNAUTHENTICATED&&this.Bc._(),null!==this.stream&&(this.Jc(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Xc(n)];case 1:return t.sent(),[2]}})})},Xc.prototype.Jc=function(){},Xc.prototype.auth=function(){var n=this;this.state=1;var t=this.Zc(this.qc),e=this.qc;this.Bc.getToken().then(function(t){n.qc===e&&n.t_(t)},function(e){t(function(){var t=new _r(Ar.UNKNOWN,"Fetching auth token failed: "+e.message);return n.e_(t)})})},Xc.prototype.t_=function(t){var e=this,n=this.Zc(this.qc);this.stream=this.s_(t),this.stream.i_(function(){n(function(){return e.state=2,e.listener.i_()})}),this.stream.Xc(function(t){n(function(){return e.e_(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Xc.prototype.jc=function(){var t=this;this.state=4,this.Na.gr(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},Xc.prototype.e_=function(t){return qs("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Xc.prototype.Zc=function(e){var n=this;return function(t){n.Tr.co(function(){return n.qc===e?t():(qs("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Xc),Uc=(n(Hc,Cc=Mc),Hc.prototype.s_=function(t){return this.Oc.n_("Listen",t)},Hc.prototype.onMessage=function(t){this.Na.reset();var e=this.serializer.pi(t),n=this.serializer.bi(t);return this.listener.r_(e,n)},Hc.prototype.h_=function(t){var e={};e.database=this.serializer.Ii,e.addTarget=this.serializer.ee(t);var n=this.serializer.zi(t);n&&(e.labels=n),this.Hc(e)},Hc.prototype.o_=function(t){var e={};e.database=this.serializer.Ii,e.removeTarget=t,this.Hc(e)},Hc),jc=(n(Yc,Vc=Mc),Object.defineProperty(Yc.prototype,"u_",{get:function(){return this.a_},enumerable:!0,configurable:!0}),Yc.prototype.start=function(){this.a_=!1,this.lastStreamToken=Zr.ht,Vc.prototype.start.call(this)},Yc.prototype.Jc=function(){this.a_&&this.c_([])},Yc.prototype.s_=function(t){return this.Oc.n_("Write",t)},Yc.prototype.onMessage=function(t){if(Ws(!!t.streamToken),this.lastStreamToken=this.serializer.ci(t.streamToken),this.a_){this.Na.reset();var e=this.serializer.xi(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.__(n,e)}return Ws(!t.writeResults||0===t.writeResults.length),this.a_=!0,this.listener.l_()},Yc.prototype.d_=function(){var t={};t.database=this.serializer.Ii,this.Hc(t)},Yc.prototype.c_=function(t){var e=this,n={streamToken:this.serializer.ui(this.lastStreamToken),writes:t.map(function(t){return e.serializer.vi(t)})};this.Hc(n)},Yc),Fc=(n(Kc,Lc=function(){this.f_=void 0}),Kc.prototype.T_=function(e,n){var r=this;return this.credentials.getToken().then(function(t){return r.Oc.T_(e,n,t)}).catch(function(t){throw t.code===Ar.UNAUTHENTICATED&&r.credentials._(),t})},Kc.prototype.E_=function(e,n){var r=this;return this.credentials.getToken().then(function(t){return r.Oc.E_(e,n,t)}).catch(function(t){throw t.code===Ar.UNAUTHENTICATED&&r.credentials._(),t})},Kc),qc=(Qc.prototype.P_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.V_(),0<this.mutations.length)throw new _r(Ar.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e={database:(n=s).serializer.Ii,documents:u.map(function(t){return n.serializer.fi(t)})},[4,n.E_("BatchGetDocuments",e)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e=n.serializer.gi(t);i.set(e.key.toString(),e)}),o=[],[2,(u.forEach(function(t){var e=i.get(t.toString());Ws(!!e),o.push(e)}),o)]}})})}(this.w_,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Eo||t instanceof bo?n.g_(t):zs()}),e)]}})})},Qc.prototype.set=function(t,e){this.write(e.gc(t,this.Rt(t))),this.m_.add(t)},Qc.prototype.update=function(t,e){try{this.write(e.gc(t,this.p_(t)))}catch(t){this.A_=t}this.m_.add(t)},Qc.prototype.delete=function(t){this.write([new zi(t,this.Rt(t))]),this.m_.add(t)},Qc.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,r=this;return v(this,function(t){switch(t.label){case 0:if(this.V_(),this.A_)throw this.A_;return e=this.I_,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=new Yr(Lr.K(e));r.mutations.push(new Wi(n,r.Rt(n)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n={database:(e=i).serializer.Ii,writes:o.map(function(t){return e.serializer.vi(t)})},[4,e.T_("Commit",n)];case 1:return r=t.sent(),[2,e.serializer.xi(r.writeResults,r.commitTime)]}})})}(this.w_,this.mutations)];case 1:return t.sent(),this.R_=!0,[2]}})})},Qc.prototype.g_=function(t){var e;if(t instanceof bo)e=t.version;else{if(!(t instanceof Eo))throw zs();e=Or.min()}var n=this.I_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new _r(Ar.ABORTED,"Document version changed between two reads.")}else this.I_.set(t.key.toString(),e)},Qc.prototype.Rt=function(t){var e=this.I_.get(t.toString());return!this.m_.has(t)&&e?ji.updateTime(e):ji.ft()},Qc.prototype.p_=function(t){var e=this.I_.get(t.toString());if(this.m_.has(t)||!e)return ji.exists(!0);if(e.isEqual(Or.min()))throw new _r(Ar.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ji.updateTime(e)},Qc.prototype.write=function(t){this.V_(),this.mutations=this.mutations.concat(t)},Qc.prototype.V_=function(){},Qc),Bc=(Wc.prototype.D_=function(){var t=this;0===this.b_&&(this.C_("Unknown"),this.v_=this.Ra.yr("online_state_timeout",1e4,function(){return t.v_=null,t.F_("Backend didn't respond within 10 seconds."),t.C_("Offline"),Promise.resolve()}))},Wc.prototype.N_=function(t){"Online"===this.state?this.C_("Unknown"):(this.b_++,1<=this.b_&&(this.k_(),this.F_("Connection failed 1 times. Most recent error: "+t.toString()),this.C_("Offline")))},Wc.prototype.set=function(t){this.k_(),this.b_=0,"Online"===t&&(this.S_=!1),this.C_(t)},Wc.prototype.C_=function(t){t!==this.state&&(this.state=t,this.y_(t))},Wc.prototype.F_=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.S_?(Bs(e),this.S_=!1):qs("OnlineStateTracker",e)},Wc.prototype.k_=function(){null!==this.v_&&(this.v_.cancel(),this.v_=null)},Wc),Gc=(zc.prototype.start=function(){return this.enableNetwork()},zc.prototype.enableNetwork=function(){return this.networkEnabled=!0,this.tl()},zc.prototype.tl=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Q_()?(this.el()?this.sl():this.j_.set("Unknown"),[4,this.il()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},zc.prototype.disableNetwork=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.nl()];case 1:return t.sent(),this.j_.set("Offline"),[2]}})})},zc.prototype.nl=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.Y_.stop()];case 1:return t.sent(),[4,this.K_.stop()];case 2:return t.sent(),0<this.x_.length&&(qs("RemoteStore","Stopping write stream with "+this.x_.length+" pending writes"),this.x_=[]),this.rl(),[2]}})})},zc.prototype.Vo=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return qs("RemoteStore","RemoteStore shutting down."),this.networkEnabled=!1,[4,this.nl()];case 1:return t.sent(),this.q_.Vo(),this.j_.set("Unknown"),[2]}})})},zc.prototype.listen=function(t){this.L_.has(t.targetId)||(this.L_.set(t.targetId,t),this.el()?this.sl():this.K_.Wc()&&this.hl(t))},zc.prototype.ol=function(t){this.L_.delete(t),this.K_.Wc()&&this.al(t),0===this.L_.size&&(this.K_.Wc()?this.K_.Gc():this.Q_()&&this.j_.set("Unknown"))},zc.prototype.si=function(t){return this.L_.get(t)||null},zc.prototype.ei=function(t){return this.ul.ei(t)},zc.prototype.hl=function(t){this.O_.Ns(t.targetId),this.K_.h_(t)},zc.prototype.al=function(t){this.O_.Ns(t),this.K_.o_(t)},zc.prototype.sl=function(){this.O_=new Ts(this),this.K_.start(),this.j_.D_()},zc.prototype.el=function(){return this.Q_()&&!this.K_.Qc()&&0<this.L_.size},zc.prototype.Q_=function(){return!this.B_&&this.isPrimary&&this.networkEnabled},zc.prototype.rl=function(){this.O_=null},zc.prototype.G_=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){return this.L_.forEach(function(t,e){n.hl(t)}),[2]})})},zc.prototype.z_=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return this.rl(),this.el()?(this.j_.N_(e),this.sl()):this.j_.set("Unknown"),[2]})})},zc.prototype.H_=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:if(this.j_.set("Online"),!(i instanceof ys&&2===i.state&&i.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.cl(i)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),qs("RemoteStore","Failed to remove targets %s: %s ",i.targetIds.join(","),e),[4,this._l(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(i instanceof ps?this.O_.qs(i):i instanceof ds?this.O_.Hs(i):this.O_.Ws(i),o.isEqual(Or.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,this.M_._h()];case 8:return n=t.sent(),0<=o.S(n)?[4,this.ll(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return qs("RemoteStore","Failed to raise snapshot:",r=t.sent()),[4,this._l(r)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},zc.prototype._l=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!qa(n))throw n;return this.B_=!0,[4,this.nl()];case 1:return t.sent(),this.j_.set("Offline"),r=r||function(){return e.M_._h()},this.Ra.lo(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return qs("RemoteStore","Retrying IndexedDB access"),[4,r()];case 1:return t.sent(),this.B_=!1,[4,this.tl()];case 2:return t.sent(),[2]}})})}),[2]}})})},zc.prototype.dl=function(e){var n=this;return e().catch(function(t){return n._l(t,e)})},zc.prototype.ll=function(r){var i=this,t=this.O_.Xs(r);return t.as.forEach(function(t,e){var n;0<t.resumeToken.rt()&&((n=i.L_.get(e))&&i.L_.set(e,n.Ie(t.resumeToken,r)))}),t.us.forEach(function(t){var e,n=i.L_.get(t);n&&(i.L_.set(t,n.Ie(Zr.ht,n.Ee)),i.al(t),e=new ko(n.target,t,1,n.sequenceNumber),i.hl(e))}),this.ul.Mu(t)},zc.prototype.cl=function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=o.cause,n=0,r=o.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],this.L_.has(i)?[4,this.ul.fl(i,e)]:[3,3]):[3,5];case 2:t.sent(),this.L_.delete(i),this.O_.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},zc.prototype.il=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=0<this.x_.length?this.x_[this.x_.length-1].batchId:-1,t.label=1;case 1:if(!this.Tl())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,this.M_.Bu(e)];case 3:return null===(n=t.sent())?(0===this.x_.length&&this.Y_.Gc(),[3,7]):(e=n.batchId,this.El(n),[3,6]);case 4:return r=t.sent(),[4,this._l(r)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.wl()&&this.Il(),[2]}})})},zc.prototype.Tl=function(){return this.Q_()&&this.x_.length<10},zc.prototype.Rl=function(){return this.x_.length},zc.prototype.El=function(t){this.x_.push(t),this.Y_.Wc()&&this.Y_.u_&&this.Y_.c_(t.mutations)},zc.prototype.wl=function(){return this.Q_()&&!this.Y_.Qc()&&0<this.x_.length},zc.prototype.Il=function(){this.Y_.start()},zc.prototype.J_=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.Y_.d_(),[2]})})},zc.prototype.Z_=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){for(e=0,n=this.x_;e<n.length;e++)r=n[e],this.Y_.c_(r.mutations);return[2]})})},zc.prototype.__=function(i,o){return y(this,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){switch(t.label){case 0:return e=this.x_.shift(),n=eu.from(e,i,o),[4,this.dl(function(){return r.ul.Al(n)})];case 1:return t.sent(),[4,this.il()];case 2:return t.sent(),[2]}})})},zc.prototype.X_=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e&&this.Y_.u_?[4,this.ml(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.wl()&&this.Il(),[2]}})})},zc.prototype.ml=function(i){return y(this,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){switch(t.label){case 0:return Yo(n=i.code)&&n!==Ar.ABORTED?(e=this.x_.shift(),this.Y_.Kc(),[4,this.dl(function(){return r.ul.Pl(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,this.il()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},zc.prototype.Vl=function(){return new qc(this.w_)},zc.prototype.W_=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.nl()];case 1:return t.sent(),this.j_.set("Unknown"),[4,this.enableNetwork()];case 2:return t.sent(),[2]}})})},zc.prototype.gl=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Q_()?(qs("RemoteStore","RemoteStore restarting streams for new credential"),[4,this.W_()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},zc.prototype.pl=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return(this.isPrimary=e)&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:[4,this.nl()];case 3:t.sent(),this.j_.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},zc);function zc(t,e,n,r,i){var o,s,u,a,h,c,f=this;this.M_=t,this.w_=e,this.Ra=n,this.x_=[],this.L_=new Map,this.O_=null,this.networkEnabled=!1,this.isPrimary=!1,this.B_=!1,this.q_=i,this.q_.U_(function(t){n.co(function(){return y(f,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Q_()?(qs("RemoteStore","Restarting streams for network reachability change."),[4,this.W_()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.j_=new Bc(n,r),this.K_=(a=this.w_,h=n,c={i_:this.G_.bind(this),Xc:this.z_.bind(this),r_:this.H_.bind(this)},new Uc(h,a.Oc,a.credentials,a.serializer,c)),this.Y_=(o=this.w_,s=n,u={i_:this.J_.bind(this),Xc:this.X_.bind(this),l_:this.Z_.bind(this),__:this.__.bind(this)},new jc(s,o.Oc,o.credentials,o.serializer,u))}function Wc(t,e){this.Ra=t,this.y_=e,this.state="Unknown",this.b_=0,this.v_=null,this.S_=!0}function Qc(t){this.w_=t,this.I_=new Map,this.mutations=[],this.R_=!1,this.A_=null,this.m_=new Set}function Kc(t,e,n){var r=this;return(r=Lc.call(this)||this).Oc=t,r.credentials=e,r.serializer=n,r}function Yc(t,e,n,r,i){var o=this;return(o=Vc.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.a_=!1,o.lastStreamToken=Zr.ht,o}function Hc(t,e,n,r,i){var o=this;return(o=Cc.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Xc(t,e,n,r,i,o){this.Tr=t,this.Lc=n,this.Oc=r,this.Bc=i,this.listener=o,this.state=0,this.qc=0,this.Uc=null,this.stream=null,this.Na=new bu(t,e)}function Jc(t,e){return"firestore_clients_"+t+"_"+e}function $c(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.t()&&(r+="_"+e.uid),r}function Zc(t,e){return"firestore_targets_"+t+"_"+e}function tf(t){this.key=t}function ef(t){this.key=t}function nf(t,e,n){this.query=t,this.targetId=e,this.view=n}function rf(t){this.key=t,this.Ud=!1}function of(){this.yf=void 0,this.bf=[]}var sf,uf,af=(jf.yl=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new _r(r.error.code,r.error.message)),i?new jf(t,e,r.state,o):(Bs("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},jf.prototype.bl=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},jf),hf=(Uf.yl=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new _r(n.error.code,n.error.message)),r?new Uf(t,n.state,i):(Bs("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},Uf.prototype.bl=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Uf),cf=(Mf.yl=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=ls,o=0;r&&o<n.activeTargetIds.length;++o)r=ri(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new Mf(t,i):(Bs("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},Mf),ff=(Cf.yl=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Cf(e.clientId,e.onlineState):(Bs("SharedClientState","Failed to parse online state: "+t),null)},Cf),lf=(Vf.prototype.vl=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Vf.prototype.Sl=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Vf.prototype.bl=function(){var t={activeTargetIds:this.activeTargetIds.W(),updateTimeMs:Date.now()};return JSON.stringify(t)},Vf),pf=(Lf.zh=function(t){return!(!t.window||null==t.window.localStorage)},Lf.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f,l=this;return v(this,function(t){switch(t.label){case 0:return[4,this.ul.So()];case 1:for(e=t.sent(),n=0,r=e;n<r.length;n++)(i=r[n])!==this.Dl&&(o=this.getItem(Jc(this.persistenceKey,i)))&&(s=cf.yl(i,o))&&(this.Nl=this.Nl.Ae(s.clientId,s));for(this.ql(),(u=this.storage.getItem(this.Bl))&&(a=this.Ul(u))&&this.Ql(a),h=0,c=this.$l;h<c.length;h++)f=c[h],this.Fl(f);return this.$l=[],this.platform.window.addEventListener("unload",function(){return l.Vo()}),this.ho=!0,[2]}})})},Lf.prototype.lr=function(t){this.setItem(this.Ml,JSON.stringify(t))},Lf.prototype.Wl=function(){return this.jl(this.Nl)},Lf.prototype.Kl=function(n){var r=!1;return this.Nl.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},Lf.prototype.Gl=function(t){this.zl(t,"pending")},Lf.prototype.Hl=function(t,e,n){this.zl(t,e,n),this.Yl(t)},Lf.prototype.Jl=function(t){var e,n,r="not-current";return this.Kl(t)&&(!(e=this.storage.getItem(Zc(this.persistenceKey,t)))||(n=hf.yl(t,e))&&(r=n.state)),this.Xl.vl(t),this.ql(),r},Lf.prototype.Zl=function(t){this.Xl.Sl(t),this.ql()},Lf.prototype.td=function(t){return this.Xl.activeTargetIds.has(t)},Lf.prototype.ed=function(t){this.removeItem(Zc(this.persistenceKey,t))},Lf.prototype.sd=function(t,e,n){this.nd(t,e,n)},Lf.prototype.vu=function(t,e,n){var r=this;e.forEach(function(t){r.Yl(t)}),this.currentUser=t,n.forEach(function(t){r.Gl(t)})},Lf.prototype.rd=function(t){this.hd(t)},Lf.prototype.Vo=function(){this.ho&&(this.platform.window.removeEventListener("storage",this.Cl),this.removeItem(this.kl),this.ho=!1)},Lf.prototype.getItem=function(t){var e=this.storage.getItem(t);return qs("SharedClientState","READ",t,e),e},Lf.prototype.setItem=function(t,e){qs("SharedClientState","SET",t,e),this.storage.setItem(t,e)},Lf.prototype.removeItem=function(t){qs("SharedClientState","REMOVE",t),this.storage.removeItem(t)},Lf.prototype.Fl=function(u){var t=this;if(u.storageArea===this.storage){if(qs("SharedClientState","EVENT",u.key,u.newValue),u.key===this.kl)return void Bs("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Tr.lo(function(){return y(t,void 0,void 0,function(){var e,n,r,i,o,s;return v(this,function(t){if(this.ho){if(null!==u.key)if(this.xl.test(u.key)){if(null==u.newValue)return e=this.od(u.key),[2,this.ad(e,null)];if(n=this.ud(u.key,u.newValue))return[2,this.ad(n.clientId,n)]}else if(this.Ll.test(u.key)){if(null!==u.newValue&&(r=this._d(u.key,u.newValue)))return[2,this.ld(r)]}else if(this.Ol.test(u.key)){if(null!==u.newValue&&(i=this.dd(u.key,u.newValue)))return[2,this.fd(i)]}else if(u.key===this.Bl){if(null!==u.newValue&&(o=this.Ul(u.newValue)))return[2,this.Ql(o)]}else u.key===this.Ml&&(s=function(t){var e=au.dr;if(null!=t)try{var n=JSON.parse(t);Ws("number"==typeof n),e=n}catch(t){Bs("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(u.newValue))!==au.dr&&this.ur(s)}else this.$l.push(u);return[2]})})})}},Object.defineProperty(Lf.prototype,"Xl",{get:function(){return this.Nl.get(this.Dl)},enumerable:!0,configurable:!0}),Lf.prototype.ql=function(){this.setItem(this.kl,this.Xl.bl())},Lf.prototype.zl=function(t,e,n){var r=new af(this.currentUser,t,e,n),i=$c(this.persistenceKey,this.currentUser,t);this.setItem(i,r.bl())},Lf.prototype.Yl=function(t){var e=$c(this.persistenceKey,this.currentUser,t);this.removeItem(e)},Lf.prototype.hd=function(t){var e={clientId:this.Dl,onlineState:t};this.storage.setItem(this.Bl,JSON.stringify(e))},Lf.prototype.nd=function(t,e,n){var r=Zc(this.persistenceKey,t),i=new hf(t,e,n);this.setItem(r,i.bl())},Lf.prototype.od=function(t){var e=this.xl.exec(t);return e?e[1]:null},Lf.prototype.ud=function(t,e){var n=this.od(t);return cf.yl(n,e)},Lf.prototype._d=function(t,e){var n=this.Ll.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return af.yl(new br(i),r,e)},Lf.prototype.dd=function(t,e){var n=this.Ol.exec(t),r=Number(n[1]);return hf.yl(r,e)},Lf.prototype.Ul=function(t){return ff.yl(t)},Lf.prototype.ld=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.ul.Td(e.batchId,e.state,e.error)]:(qs("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},Lf.prototype.fd=function(t){return this.ul.Ed(t.targetId,t.state,t.error)},Lf.prototype.ad=function(t,e){var n=this,r=e?this.Nl.Ae(t,e):this.Nl.remove(t),i=this.jl(this.Nl),o=this.jl(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.ul.wd(s,u).then(function(){n.Nl=r})},Lf.prototype.Ql=function(t){this.Nl.get(t.clientId)&&this.y_(t.onlineState)},Lf.prototype.jl=function(t){var n=ls;return t.forEach(function(t,e){n=n.He(e.activeTargetIds)}),n},Lf),df=(kf.prototype.Gl=function(t){},kf.prototype.Hl=function(t,e,n){},kf.prototype.Jl=function(t){return this.Id.vl(t),this.Rd[t]||"not-current"},kf.prototype.sd=function(t,e,n){this.Rd[t]=e},kf.prototype.Zl=function(t){this.Id.Sl(t)},kf.prototype.td=function(t){return this.Id.activeTargetIds.has(t)},kf.prototype.ed=function(t){delete this.Rd[t]},kf.prototype.Wl=function(){return this.Id.activeTargetIds},kf.prototype.Kl=function(t){return this.Id.activeTargetIds.has(t)},kf.prototype.start=function(){return this.Id=new lf,Promise.resolve()},kf.prototype.vu=function(t,e,n){},kf.prototype.rd=function(t){},kf.prototype.Vo=function(){},kf.prototype.lr=function(t){},kf),yf=(Object.defineProperty(Of.prototype,"gd",{get:function(){return this.Ad},enumerable:!0,configurable:!0}),Of.prototype.pd=function(t,e){var u=this,a=e?e.yd:new gs,h=e?e.Vd:this.Vd,c=e?e.ns:this.ns,f=h,l=!1,p=this.query.oe()&&h.size===this.query.limit?h.last():null,d=this.query.ae()&&h.size===this.query.limit?h.first():null;if(t.pe(function(t,e){var n=h.get(t),r=(r=e instanceof bo?e:null)&&(u.query.matches(r)?r:null),i=!!n&&u.ns.has(n.key),o=!!r&&(r.At||u.ns.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(a.track({type:3,doc:r}),s=!0):u.bd(n,r)||(a.track({type:2,doc:r}),s=!0,(p&&0<u.query.se(r,p)||d&&u.query.se(r,d)<0)&&(l=!0)):!n&&r?(a.track({type:0,doc:r}),s=!0):n&&!r&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(l=!0)),s&&(c=r?(f=f.add(r),o?c.add(t):c.delete(t)):(f=f.delete(t),c.delete(t)))}),this.query.oe()||this.query.ae())for(;f.size>this.query.limit;){var n=this.query.oe()?f.last():f.first(),f=f.delete(n.key),c=c.delete(n.key);a.track({type:1,doc:n})}return{Vd:f,yd:a,vd:l,ns:c}},Of.prototype.bd=function(t,e){return t.At&&e.hasCommittedMutations&&!e.At},Of.prototype.On=function(t,e,n){var o=this,r=this.Vd;this.Vd=t.Vd,this.ns=t.ns;var i=t.yd.es();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.query.se(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return zs()}}var r,i}),this.Sd(n);var s=e?this.Dd():[],u=0===this.Pd.size&&this.fs?1:0,a=u!==this.md;return this.md=u,0!==i.length||a?{snapshot:new ms(this.query,t.Vd,r,i,t.ns,0==u,a,!1),Cd:s}:{Cd:s}},Of.prototype.Fd=function(t){return this.fs&&"Offline"===t?(this.fs=!1,this.On({Vd:this.Vd,yd:new gs,ns:this.ns,vd:!1},!1)):{Cd:[]}},Of.prototype.Nd=function(t){return!this.Ad.has(t)&&!!this.Vd.has(t)&&!this.Vd.get(t).At},Of.prototype.Sd=function(t){var e=this;t&&(t.Ts.forEach(function(t){return e.Ad=e.Ad.add(t)}),t.Es.forEach(function(t){}),t.ws.forEach(function(t){return e.Ad=e.Ad.delete(t)}),this.fs=t.fs)},Of.prototype.Dd=function(){var e=this;if(!this.fs)return[];var n=this.Pd;this.Pd=fs(),this.Vd.forEach(function(t){e.Nd(t.key)&&(e.Pd=e.Pd.add(t.key))});var r=[];return n.forEach(function(t){e.Pd.has(t)||r.push(new ef(t))}),this.Pd.forEach(function(t){n.has(t)||r.push(new tf(t))}),r},Of.prototype.$d=function(t){this.Ad=t.ju,this.Pd=fs();var e=this.pd(t.documents);return this.On(e,!0)},Of.prototype.kd=function(){return ms.os(this.query,this.Vd,this.ns,0===this.md)},Of),vf=(xf.prototype.xd=function(){this.Ld()},xf.prototype.Ld=function(){var t=this;this.Na.gr(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new qc(this.w_),(n=this.Od(e))&&n.then(function(t){r.Ra.co(function(){return e.commit().then(function(){r.Pa.resolve(t)}).catch(function(t){r.Bd(t)})})}).catch(function(t){r.Bd(t)}),[2]})})})},xf.prototype.Od=function(t){try{var e=this.updateFunction(t);return!ei(e)&&e.catch&&e.then?e:(this.Pa.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Pa.reject(t),null}},xf.prototype.Bd=function(t){var e=this;0<this.Md&&this.qd(t)?(--this.Md,this.Ra.co(function(){return e.Ld(),Promise.resolve()})):this.Pa.reject(t)},xf.prototype.qd=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Yo(e)},xf),gf=(Object.defineProperty(Pf.prototype,"sf",{get:function(){return!0},enumerable:!0,configurable:!0}),Pf.prototype.subscribe=function(t){this.Kd=t},Pf.prototype.listen=function(s){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return this.if("listen()"),(r=this.Gd.get(s))?(e=r.targetId,this.Wd.Jl(e),n=r.view.kd(),[3,4]):[3,1];case 1:return[4,this.M_.Uu(s.ee())];case 2:return i=t.sent(),o=this.Wd.Jl(i.targetId),e=i.targetId,[4,this.nf(s,e,"current"===o)];case 3:n=t.sent(),this.sf&&this.Qd.listen(i),t.label=4;case 4:return[2,n]}})})},Pf.prototype.nf=function(u,a,h){return y(this,void 0,void 0,function(){var e,n,r,i,o,s;return v(this,function(t){switch(t.label){case 0:return[4,this.M_.Wu(u,!0)];case 1:return e=t.sent(),n=new yf(u,e.ju),r=n.pd(e.documents),i=bs.ds(a,h&&"Offline"!==this.onlineState),o=n.On(r,this.sf,i),this.rf(a,o.Cd),s=new nf(u,a,n),[2,(this.Gd.set(u,s),this.zd.has(a)?this.zd.get(a).push(u):this.zd.set(a,[u]),o.snapshot)]}})})},Pf.prototype.ol=function(i){return y(this,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){switch(t.label){case 0:return this.if("unlisten()"),e=this.Gd.get(i),1<(n=this.zd.get(e.targetId)).length?[2,(this.zd.set(e.targetId,n.filter(function(t){return!t.isEqual(i)})),void this.Gd.delete(i))]:this.sf?(this.Wd.Zl(e.targetId),this.Wd.Kl(e.targetId)?[3,2]:[4,this.M_.Qu(e.targetId,!1).then(function(){r.Wd.ed(e.targetId),r.Qd.ol(e.targetId),r.hf(e.targetId)}).catch(yh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.hf(e.targetId),[4,this.M_.Qu(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},Pf.prototype.write=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:this.if("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,this.M_.Fu(i)];case 2:return e=t.sent(),this.Wd.Gl(e.batchId),this.af(e.batchId,o),[4,this.uf(e.Dn)];case 3:return t.sent(),[4,this.Qd.il()];case 4:return t.sent(),[3,6];case 5:return n=t.sent(),r=Za(n,"Failed to persist write"),o.reject(r),[3,6];case 6:return[2]}})})},Pf.prototype.runTransaction=function(t,e,n){new vf(t,this.w_,e,n).xd()},Pf.prototype.Mu=function(n){return y(this,void 0,void 0,function(){var e,r=this;return v(this,function(t){switch(t.label){case 0:this.if("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.M_.Mu(n)];case 2:return e=t.sent(),n.as.forEach(function(t,e){var n=r.Jd.get(e);n&&(Ws(t.Ts.size+t.Es.size+t.ws.size<=1),0<t.Ts.size?n.Ud=!0:0<t.Es.size?Ws(n.Ud):0<t.ws.size&&(Ws(n.Ud),n.Ud=!1))}),[4,this.uf(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,yh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Pf.prototype.Fd=function(r,t){this.if("applyOnlineStateChange()");var i=[];this.Gd.forEach(function(t,e){var n=e.view.Fd(r);n.snapshot&&i.push(n.snapshot)}),this.Kd.cf(r),this.Kd.r_(i),this.onlineState=r},Pf.prototype.fl=function(u,a){return y(this,void 0,void 0,function(){var e,n,r,i,o,s=this;return v(this,function(t){switch(t.label){case 0:return this.if("rejectListens()"),this.Wd.sd(u,"rejected",a),e=this.Jd.get(u),(n=e&&e.key)?(r=(r=new Xo(Yr.N)).Ae(n,new Eo(n,Or.min())),i=fs().add(n),o=new ws(Or.min(),new Map,new rs(Ys),r,i),[4,this.Mu(o)]):[3,2];case 1:return t.sent(),this.Yd=this.Yd.remove(n),this.Jd.delete(u),this._f(),[3,4];case 2:return[4,this.M_.Qu(u,!1).then(function(){return s.hf(u,a)}).catch(yh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},Pf.prototype.Al=function(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:this.if("applySuccessfulWrite()"),e=r.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.M_.Nu(r)];case 2:return n=t.sent(),this.lf(e,null),this.df(e),this.Wd.Hl(e,"acknowledged"),[4,this.uf(n)];case 3:return t.sent(),[3,6];case 4:return[4,yh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Pf.prototype.Pl=function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.if("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.M_.ku(n)];case 2:return e=t.sent(),this.lf(n,r),this.df(n),this.Wd.Hl(n,"rejected",r),[4,this.uf(e)];case 3:return t.sent(),[3,6];case 4:return[4,yh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Pf.prototype.ff=function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:this.Qd.Q_()||qs("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.M_.ta()];case 2:return-1===(e=t.sent())?[2,void o.resolve()]:((n=this.tf.get(e)||[]).push(o),this.tf.set(e,n),[3,4]);case 3:return r=t.sent(),i=Za(r,"Initialization of waitForPendingWrites() operation failed"),o.reject(i),[3,4];case 4:return[2]}})})},Pf.prototype.df=function(t){(this.tf.get(t)||[]).forEach(function(t){t.resolve()}),this.tf.delete(t)},Pf.prototype.Tf=function(e){this.tf.forEach(function(t){t.forEach(function(t){t.reject(new _r(Ar.CANCELLED,e))})}),this.tf.clear()},Pf.prototype.af=function(t,e){var n=(n=(n=this.Zd[this.currentUser.s()])||new Xo(Ys)).Ae(t,e);this.Zd[this.currentUser.s()]=n},Pf.prototype.lf=function(t,e){var n,r=this.Zd[this.currentUser.s()];r&&((n=r.get(t))&&(e?n.reject(e):n.resolve(),r=r.remove(t)),this.Zd[this.currentUser.s()]=r)},Pf.prototype.hf=function(t,e){var n=this;void 0===e&&(e=null),this.Wd.Zl(t);for(var r=0,i=this.zd.get(t);r<i.length;r++){var o=i[r];this.Gd.delete(o),e&&this.Kd.Ef(o,e)}this.zd.delete(t),this.sf&&this.Xd.ic(t).forEach(function(t){n.Xd.Ch(t)||n.wf(t)})},Pf.prototype.wf=function(t){var e=this.Yd.get(t);null!==e&&(this.Qd.ol(e),this.Yd=this.Yd.remove(t),this.Jd.delete(e),this._f())},Pf.prototype.rf=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof tf?(this.Xd.yh(i.key,t),this.If(i)):i instanceof ef?(qs("SyncEngine","Document no longer in limbo: "+i.key),this.Xd.vh(i.key,t),this.Xd.Ch(i.key)||this.wf(i.key)):zs()}},Pf.prototype.If=function(t){var e=t.key;this.Yd.get(e)||(qs("SyncEngine","New document in limbo: "+e),this.Hd.push(e),this._f())},Pf.prototype._f=function(){for(;0<this.Hd.length&&this.Yd.size<this.jd;){var t=this.Hd.shift(),e=this.ef.next();this.Jd.set(e,new rf(t)),this.Yd=this.Yd.Ae(t,e),this.Qd.listen(new ko(No.Wt(t.path).ee(),e,2,au.dr))}},Pf.prototype.Rf=function(){return this.Yd},Pf.prototype.Af=function(){return this.Hd},Pf.prototype.uf=function(r,a){return y(this,void 0,void 0,function(){var o,s,e,u=this;return v(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.Gd.forEach(function(t,i){e.push(Promise.resolve().then(function(){var n=i.view.pd(r);return n.vd?u.M_.Wu(i.query,!1).then(function(t){var e=t.documents;return i.view.pd(e,n)}):n}).then(function(t){var e,n=a&&a.as.get(i.targetId),r=i.view.On(t,u.sf,n);u.rf(i.targetId,r.Cd),r.snapshot&&(u.sf&&u.Wd.sd(i.targetId,r.snapshot.fromCache?"not-current":"current"),o.push(r.snapshot),e=uu.ar(i.targetId,r.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.Kd.r_(o),[4,this.M_.Ou(s)];case 2:return t.sent(),[2]}})})},Pf.prototype.if=function(t){},Pf.prototype.gl=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:[4,this.M_.vu(n)];case 1:return e=t.sent(),this.currentUser=n,this.Tf("'waitForPendingWrites' promise is rejected due to a user change."),this.Wd.vu(n,e.Du,e.Cu),[4,this.uf(e.Su)];case 2:t.sent(),t.label=3;case 3:return[4,this.Qd.gl()];case 4:return t.sent(),[2]}})})},Pf.prototype.enableNetwork=function(){return this.Qd.enableNetwork()},Pf.prototype.disableNetwork=function(){return this.Qd.disableNetwork()},Pf.prototype.ei=function(t){var e=this.Jd.get(t);if(e&&e.Ud)return fs().add(e.key);var n=fs(),r=this.zd.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++)var s=o[i],u=this.Gd.get(s),n=n.He(u.view.gd);return n},Pf),mf=(n(Df,sf=gf),Object.defineProperty(Df.prototype,"sf",{get:function(){return!0===this.mf},enumerable:!0,configurable:!0}),Df.prototype.enableNetwork=function(){return this.M_.uo(!0),sf.prototype.enableNetwork.call(this)},Df.prototype.disableNetwork=function(){return this.M_.uo(!1),sf.prototype.disableNetwork.call(this)},Df.prototype.Pf=function(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.M_.Wu(r.query,!0)];case 1:return e=t.sent(),n=r.view.$d(e),[2,(this.mf&&this.rf(r.targetId,n.Cd),n)]}})})},Df.prototype.Fd=function(t,e){this.sf&&0===e&&(sf.prototype.Fd.call(this,t,e),this.Wd.rd(t)),this.sf||1!==e||sf.prototype.Fd.call(this,t,e)},Df.prototype.Td=function(n,r,i){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.if("applyBatchState()"),[4,this.M_.Gu(n)];case 1:return null===(e=t.sent())?[3,6]:"pending"!==r?[3,3]:[4,this.Qd.il()];case 2:return t.sent(),[3,4];case 3:"acknowledged"===r||"rejected"===r?(this.lf(n,i||null),this.M_.zu(n)):zs(),t.label=4;case 4:return[4,this.uf(e)];case 5:return t.sent(),[3,7];case 6:qs("SyncEngine","Cannot apply mutation batch with id: "+n),t.label=7;case 7:return[2]}})})},Df.prototype.pl=function(h){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a=this;return v(this,function(t){switch(t.label){case 0:return!0!==h||!0===this.mf?[3,3]:(e=this.Wd.Wl(),[4,this.Vf(e.W(),!0)]);case 1:return n=t.sent(),this.mf=!0,[4,this.Qd.pl(!0)];case 2:for(t.sent(),r=0,i=n;r<i.length;r++)o=i[r],this.Qd.listen(o);return[3,7];case 3:return!1!==h||!1===this.mf?[3,7]:(s=[],u=Promise.resolve(),this.zd.forEach(function(t,e){a.Wd.td(e)?s.push(e):u=u.then(function(){return a.hf(e),a.M_.Qu(e,!0)}),a.Qd.ol(e)}),[4,u]);case 4:return t.sent(),[4,this.Vf(s,!1)];case 5:return t.sent(),this.gf(),this.mf=!1,[4,this.Qd.pl(!1)];case 6:t.sent(),t.label=7;case 7:return[2]}})})},Df.prototype.gf=function(){var n=this;this.Jd.forEach(function(t,e){n.Qd.ol(e)}),this.Xd.nc(),this.Jd=new Map,this.Yd=new Xo(Yr.N)},Df.prototype.Vf=function(d,t){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f,l,p;return v(this,function(t){switch(t.label){case 0:e=[],n=[],r=0,i=d,t.label=1;case 1:return r<i.length?(o=i[r],s=void 0,(u=this.zd.get(o))&&0!==u.length?[4,this.M_.Uu(u[0].ee())]:[3,7]):[3,13];case 2:s=t.sent(),a=0,h=u,t.label=3;case 3:return a<h.length?(c=h[a],f=this.Gd.get(c),[4,this.Pf(f)]):[3,6];case 4:(l=t.sent()).snapshot&&n.push(l.snapshot),t.label=5;case 5:return a++,[3,3];case 6:return[3,11];case 7:return[4,this.M_.Hu(o)];case 8:return p=t.sent(),[4,this.M_.Uu(p)];case 9:return s=t.sent(),[4,this.nf(this.pf(p),o,!1)];case 10:t.sent(),t.label=11;case 11:e.push(s),t.label=12;case 12:return r++,[3,1];case 13:return[2,(this.Kd.r_(n),e)]}})})},Df.prototype.pf=function(t){return new No(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)},Df.prototype.So=function(){return this.M_.So()},Df.prototype.Ed=function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.mf?(qs("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!this.zd.has(r))return[3,8];switch(i){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,this.M_.Kr()];case 3:return e=t.sent(),n=ws.ls(r,"current"===i),[4,this.uf(e,n)];case 4:return t.sent(),[3,8];case 5:return[4,this.M_.Qu(r,!0)];case 6:return t.sent(),this.hf(r,o),[3,8];case 7:zs(),t.label=8;case 8:return[2]}})})},Df.prototype.wd=function(l,p){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f=this;return v(this,function(t){switch(t.label){case 0:if(!this.mf)return[3,10];e=0,n=l,t.label=1;case 1:return e<n.length?(r=n[e],this.zd.has(r)?(qs("SyncEngine","Adding an already active target "+r),[3,5]):[4,this.M_.Hu(r)]):[3,6];case 2:return i=t.sent(),[4,this.M_.Uu(i)];case 3:return o=t.sent(),[4,this.nf(this.pf(i),o.targetId,!1)];case 4:t.sent(),this.Qd.listen(o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return u.zd.has(e)?[4,u.M_.Qu(e,!1).then(function(){f.Qd.ol(e),f.hf(e)}).catch(yh)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=this,a=0,h=p,t.label=7;case 7:return a<h.length?(c=h[a],[5,s(c)]):[3,10];case 8:t.sent(),t.label=9;case 9:return a++,[3,7];case 10:return[2]}})})},Df),wf=(Rf.prototype.listen=function(u){return y(this,void 0,void 0,function(){var e,n,r,i,o,s;return v(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(r=this.vf.get(e))||(n=!0,r=new of),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),i=r,[4,this.ul.listen(e)];case 2:return i.yf=t.sent(),[3,4];case 3:return o=t.sent(),s=Za(o,"Initialization of query '"+u.query+"' failed"),[2,void u.onError(s)];case 4:return this.vf.set(e,r),r.bf.push(u),u.Fd(this.onlineState),r.yf&&u.Df(r.yf)&&this.Cf(),[2]}})})},Rf.prototype.ol=function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){return e=o.query,n=!1,(r=this.vf.get(e))&&0<=(i=r.bf.indexOf(o))&&(r.bf.splice(i,1),n=0===r.bf.length),n?[2,(this.vf.delete(e),this.ul.ol(e))]:[2]})})},Rf.prototype.r_=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.vf.get(o);if(s){for(var u=0,a=s.bf;u<a.length;u++)a[u].Df(i)&&(e=!0);s.yf=i}}e&&this.Cf()},Rf.prototype.Ef=function(t,e){var n=this.vf.get(t);if(n)for(var r=0,i=n.bf;r<i.length;r++)i[r].onError(e);this.vf.delete(t)},Rf.prototype.cf=function(i){this.onlineState=i;var o=!1;this.vf.forEach(function(t,e){for(var n=0,r=e.bf;n<r.length;n++)r[n].Fd(i)&&(o=!0)}),o&&this.Cf()},Rf.prototype.Ff=function(t){this.Sf.add(t),t.next()},Rf.prototype.Nf=function(t){this.Sf.delete(t)},Rf.prototype.Cf=function(){this.Sf.forEach(function(t){t.next()})},Rf),bf=(Sf.prototype.Df=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new ms(t.query,t.docs,t.ss,e,t.ns,t.fromCache,t.rs,!0)}var o=!1;return this.kf?this.xf(t)&&(this.$f.next(t),o=!0):this.Lf(t,this.onlineState)&&(this.Of(t),o=!0),this.Mf=t,o},Sf.prototype.onError=function(t){this.$f.error(t)},Sf.prototype.Fd=function(t){this.onlineState=t;var e=!1;return this.Mf&&!this.kf&&this.Lf(this.Mf,t)&&(this.Of(this.Mf),e=!0),e},Sf.prototype.Lf=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Bf&&n||t.docs.B()&&"Offline"!==e)},Sf.prototype.xf=function(t){if(0<t.docChanges.length)return!0;var e=this.Mf&&this.Mf.hasPendingWrites!==t.hasPendingWrites;return!(!t.rs&&!e)&&!0===this.options.includeMetadataChanges},Sf.prototype.Of=function(t){t=ms.os(t.query,t.docs,t.ns,t.fromCache),this.kf=!0,this.$f.next(t)},Sf),Ef=(_f.prototype.bu=function(t){this.qf=t},_f.prototype.Zn=function(e,r,i,o){var s=this;return r.te()||i.isEqual(Or.min())?this.Uf(e,r):this.qf.Yn(e,o).next(function(t){var n=s.Qf(r,t);return(r.oe()||r.ae())&&s.vd(r.Bt,n,o,i)?s.Uf(e,r):(Fs()<=p.DEBUG&&qs("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),r.toString()),s.qf.Zn(e,r,i).next(function(e){return n.forEach(function(t){e=e.Ae(t.key,t)}),e}))})},_f.prototype.Qf=function(n,t){var r=new rs(function(t,e){return n.se(t,e)});return t.forEach(function(t,e){e instanceof bo&&n.matches(e)&&(r=r.add(e))}),r},_f.prototype.vd=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.S(r))},_f.prototype.Uf=function(t,e){return Fs()<=p.DEBUG&&qs("IndexFreeQueryEngine","Using full collection scan to execute query:",e.toString()),this.qf.Zn(t,e,Or.min())},_f),Tf=(Af.prototype.Ho=function(t){return nu.resolve(0===this.Wn.length)},Af.prototype.Yo=function(t,e,n,r){var i=this.Wf;this.Wf++,0<this.Wn.length&&this.Wn[this.Wn.length-1];var o=new tu(i,e,n,r);this.Wn.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.jf=this.jf.add(new gh(a.key,i)),this.jn.Dr(t,a.key.path.M())}return nu.resolve(o)},Af.prototype.Jo=function(t,e){return nu.resolve(this.Kf(e))},Af.prototype.Zo=function(t,e){var n=e+1,r=this.Gf(n),i=r<0?0:r;return nu.resolve(this.Wn.length>i?this.Wn[i]:null)},Af.prototype.ta=function(){return nu.resolve(0===this.Wn.length?-1:this.Wf-1)},Af.prototype.ea=function(t){return nu.resolve(this.Wn.slice())},Af.prototype.Gn=function(t,e){var n=this,r=new gh(e,0),i=new gh(e,Number.POSITIVE_INFINITY),o=[];return this.jf.Ke([r,i],function(t){var e=n.Kf(t.hc);o.push(e)}),nu.resolve(o)},Af.prototype.Xn=function(t,e){var r=this,i=new rs(Ys);return e.forEach(function(t){var e=new gh(t,0),n=new gh(t,Number.POSITIVE_INFINITY);r.jf.Ke([e,n],function(t){i=i.add(t.hc)})}),nu.resolve(this.zf(i))},Af.prototype.nr=function(t,e){var n=e.path,r=n.length+1,i=n;Yr.et(i)||(i=i.child(""));var o=new gh(new Yr(i),0),s=new rs(Ys);return this.jf.Ge(function(t){var e=t.key.path;return!!n.q(e)&&(e.length===r&&(s=s.add(t.hc)),!0)},o),nu.resolve(this.zf(s))},Af.prototype.zf=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.Kf(t);null!==e&&r.push(e)}),r},Af.prototype.ia=function(n,r){var i=this;Ws(0===this.Hf(r.batchId,"removed")),this.Wn.shift();var o=this.jf;return nu.forEach(r.mutations,function(t){var e=new gh(t.key,r.batchId);return o=o.delete(e),i.hh.Uo(n,t.key)}).next(function(){i.jf=o})},Af.prototype.na=function(t){},Af.prototype.Ch=function(t,e){var n=new gh(e,0),r=this.jf.ze(n);return nu.resolve(e.isEqual(r&&r.key))},Af.prototype.ra=function(t){return this.Wn.length,nu.resolve()},Af.prototype.Hf=function(t,e){return this.Gf(t)},Af.prototype.Gf=function(t){return 0===this.Wn.length?0:t-this.Wn[0].batchId},Af.prototype.Kf=function(t){var e=this.Gf(t);return e<0||e>=this.Wn.length?null:this.Wn[e]},Af),If=(Nf.prototype.Nn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.Yf(e);return this.docs=this.docs.Ae(r,{xr:e,size:s,readTime:n}),this.size+=s-o,this.jn.Dr(t,r.path.M())},Nf.prototype.kn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Nf.prototype.Mn=function(t,e){var n=this.docs.get(e);return nu.resolve(n?n.xr:null)},Nf.prototype.getEntries=function(t,e){var n=this,r=os;return e.forEach(function(t){var e=n.docs.get(t);r=r.Ae(t,e?e.xr:null)}),nu.resolve(r)},Nf.prototype.Zn=function(t,e,n){for(var r=as,i=new Yr(e.path.child("")),o=this.docs.ve(i);o.$e();){var s=o.Ne(),u=s.key,a=s.value,h=a.xr,c=a.readTime;if(!e.path.q(u.path))break;c.S(n)<=0||h instanceof bo&&e.matches(h)&&(r=r.Ae(h.key,h))}return nu.resolve(r)},Nf.prototype.Jf=function(t,e){return nu.forEach(this.docs,function(t){return e(t)})},Nf.prototype.Yr=function(t){return new Nf.Jr(this)},Nf.prototype.Zr=function(t){return nu.resolve(this.size)},Nf);function Nf(t,e){this.jn=t,this.Yf=e,this.docs=new Xo(Yr.N),this.size=0}function Af(t,e){this.jn=t,this.hh=e,this.Wn=[],this.Wf=1,this.jf=new rs(gh.Ju)}function _f(){}function Sf(t,e,n){this.query=t,this.$f=e,this.kf=!1,this.Mf=null,this.onlineState="Unknown",this.options=n||{}}function Rf(t){this.ul=t,this.vf=new Zs(function(t){return t.canonicalId()}),this.onlineState="Unknown",this.Sf=new Set,this.ul.subscribe(this)}function Df(t,e,n,r,i,o){var s=this;return(s=sf.call(this,t,e,n,r,i,o)||this).M_=t,s.mf=void 0,s}function Pf(t,e,n,r,i,o){this.M_=t,this.Qd=e,this.w_=n,this.Wd=r,this.currentUser=i,this.jd=o,this.Kd=null,this.Gd=new Zs(function(t){return t.canonicalId()}),this.zd=new Map,this.Hd=[],this.Yd=new Xo(Yr.N),this.Jd=new Map,this.Xd=new vh,this.Zd={},this.tf=new Map,this.ef=qu.rh(),this.onlineState="Unknown"}function xf(t,e,n,r){this.Ra=t,this.w_=e,this.updateFunction=n,this.Pa=r,this.Md=5,this.Na=new bu(this.Ra,"transaction_retry")}function Of(t,e){this.query=t,this.Ad=e,this.md=null,this.fs=!1,this.Pd=fs(),this.ns=fs(),this.Vd=new vs(t.se.bind(t))}function kf(){this.Id=new lf,this.Rd={},this.ul=null,this.y_=null,this.ur=null}function Lf(t,e,n,r,i){if(this.Tr=t,this.platform=e,this.persistenceKey=n,this.Dl=r,this.ul=null,this.y_=null,this.ur=null,this.Cl=this.Fl.bind(this),this.Nl=new Xo(Ys),this.ho=!1,this.$l=[],!Lf.zh(this.platform))throw new _r(Ar.UNIMPLEMENTED,"LocalStorage is not available on this platform.");var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.platform.window.localStorage,this.currentUser=i,this.kl=Jc(this.persistenceKey,this.Dl),this.Ml="firestore_sequence_number_"+this.persistenceKey,this.Nl=this.Nl.Ae(this.Dl,new lf),this.xl=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Ll=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Ol=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Bl="firestore_online_state_"+this.persistenceKey,this.platform.window.addEventListener("storage",this.Cl)}function Vf(){this.activeTargetIds=ls}function Cf(t,e){this.clientId=t,this.onlineState=e}function Mf(t,e){this.clientId=t,this.activeTargetIds=e}function Uf(t,e,n){this.targetId=t,this.state=e,this.error=n}function jf(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function Ff(t){var e=this;return(e=uf.call(this)||this).th=t,e}If.Jr=(n(Ff,uf=ru),Ff.prototype.On=function(n){var r=this,i=[];return this.Dn.forEach(function(t,e){e?i.push(r.th.Nn(n,e,r.readTime)):r.th.kn(t)}),nu.vn(i)},Ff.prototype.xn=function(t,e){return this.th.Mn(t,e)},Ff.prototype.Ln=function(t,e){return this.th.getEntries(t,e)},Ff);var qf,Bf,Gf=(ol.prototype.js=function(t,n){return this.Xf.forEach(function(t,e){return n(e)}),nu.resolve()},ol.prototype._h=function(t){return nu.resolve(this.lastRemoteSnapshotVersion)},ol.prototype.lh=function(t){return nu.resolve(this.Zf)},ol.prototype.oh=function(t){return this.highestTargetId=this.eT.next(),nu.resolve(this.highestTargetId)},ol.prototype.dh=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Zf&&(this.Zf=e),nu.resolve()},ol.prototype.Th=function(t){this.Xf.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.eT=new qu(e),this.highestTargetId=e),t.sequenceNumber>this.Zf&&(this.Zf=t.sequenceNumber)},ol.prototype.fh=function(t,e){return this.Th(e),this.targetCount+=1,nu.resolve()},ol.prototype.wh=function(t,e){return this.Th(e),nu.resolve()},ol.prototype.Ih=function(t,e){return this.Xf.delete(e.target),this.tT.ic(e.targetId),--this.targetCount,nu.resolve()},ol.prototype.Ah=function(n,r,i){var o=this,s=0,u=[];return this.Xf.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Xf.delete(t),u.push(o.Rh(n,e.targetId)),s++)}),nu.vn(u).next(function(){return s})},ol.prototype.Vh=function(t){return nu.resolve(this.targetCount)},ol.prototype.gh=function(t,e){var n=this.Xf.get(e)||null;return nu.resolve(n)},ol.prototype.ph=function(t,e,n){return this.tT.tc(e,n),nu.resolve()},ol.prototype.bh=function(e,t,n){this.tT.sc(t,n);var r=this.persistence.hh,i=[];return r&&t.forEach(function(t){i.push(r.Uo(e,t))}),nu.vn(i)},ol.prototype.Rh=function(t,e){return this.tT.ic(e),nu.resolve()},ol.prototype.Sh=function(t,e){var n=this.tT.rc(e);return nu.resolve(n)},ol.prototype.Ch=function(t,e){return nu.resolve(this.tT.Ch(e))},ol),zf=(il.prototype.start=function(){return Promise.resolve()},il.prototype.Vo=function(){return this.Uh=!1,Promise.resolve()},Object.defineProperty(il.prototype,"ho",{get:function(){return this.Uh},enumerable:!0,configurable:!0}),il.prototype.oo=function(){},il.prototype.$o=function(){return this.jn},il.prototype.Do=function(t){var e=this.sT[t.s()];return e||(e=new Tf(this.jn,this.hh),this.sT[t.s()]=e),e},il.prototype.Fo=function(){return this.Jh},il.prototype.No=function(){return this.Qn},il.prototype.runTransaction=function(t,e,n){var r=this;qs("MemoryPersistence","Starting transaction:",t);var i=new Wf(this.qh.next());return this.hh.nT(),n(i).next(function(t){return r.hh.rT(i).next(function(){return t})}).yn().then(function(t){return i.Un(),t})},il.prototype.hT=function(e,n){return nu.Sn(Object.values(this.sT).map(function(t){return function(){return t.Ch(e,n)}}))},il),Wf=(n(rl,Bf=ou),rl),Qf=(nl.uT=function(t){return new nl(t)},Object.defineProperty(nl.prototype,"cT",{get:function(){if(this.aT)return this.aT;throw zs()},enumerable:!0,configurable:!0}),nl.prototype.yh=function(t,e,n){return this.oT.yh(n,e),this.cT.delete(n),nu.resolve()},nl.prototype.vh=function(t,e,n){return this.oT.vh(n,e),this.cT.add(n),nu.resolve()},nl.prototype.Uo=function(t,e){return this.cT.add(e),nu.resolve()},nl.prototype.removeTarget=function(t,e){var n=this;this.oT.ic(e.targetId).forEach(function(t){return n.cT.add(t)});var r=this.persistence.Fo();return r.Sh(t,e.targetId).next(function(t){t.forEach(function(t){return n.cT.add(t)})}).next(function(){return r.Ih(t,e)})},nl.prototype.nT=function(){this.aT=new Set},nl.prototype.rT=function(t){var n=this,r=this.persistence.No().Yr();return nu.forEach(this.cT,function(e){return n._T(t,e).next(function(t){t||r.kn(e)})}).next(function(){return n.aT=null,r.apply(t)})},nl.prototype.Ko=function(t,e){var n=this;return this._T(t,e).next(function(t){t?n.cT.delete(e):n.cT.add(e)})},nl.prototype.iT=function(t){return 0},nl.prototype._T=function(t,e){var n=this;return nu.Sn([function(){return nu.resolve(n.oT.Ch(e))},function(){return n.persistence.Fo().Ch(t,e)},function(){return n.persistence.hT(t,e)}])},nl),Kf="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Yf=(el.prototype.initialize=function(n){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Wd=this.lT(n),this.persistence=this.dT(n),[4,this.persistence.start()];case 1:return t.sent(),this.fT=this.TT(n),this.M_=this.ET(n),this.Qd=this.wT(n),this.ul=this.IT(n),this.RT=this.AT(n),this.Wd.y_=function(t){return e.ul.Fd(t,1)},this.Qd.ul=this.ul,[4,this.M_.start()];case 2:return t.sent(),[4,this.Wd.start()];case 3:return t.sent(),[4,this.Qd.start()];case 4:return t.sent(),[4,this.Qd.pl(this.ul.sf)];case 5:return t.sent(),[2]}})})},el.prototype.AT=function(t){return new wf(this.ul)},el.prototype.TT=function(t){return null},el.prototype.ET=function(t){return new ah(this.persistence,new Ef,t.mT)},el.prototype.dT=function(t){if(t.VT.PT)throw new _r(Ar.FAILED_PRECONDITION,Kf);return new zf(Qf.uT)},el.prototype.wT=function(t){var e=this;return new Gc(this.M_,t.w_,t.Ra,function(t){return e.ul.Fd(t,0)},t.platform.gT())},el.prototype.lT=function(t){return new df},el.prototype.IT=function(t){return new gf(this.M_,this.Qd,t.w_,this.Wd,t.mT,t.jd)},el.prototype.clearPersistence=function(t){throw new _r(Ar.FAILED_PRECONDITION,Kf)},el),Hf=(n(tl,qf=Yf),tl.prototype.initialize=function(e){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return[4,qf.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,this.persistence.ro(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.ul.pl(e)];case 1:return t.sent(),this.fT&&(e&&!this.fT.ho?this.fT.start(this.M_):e||this.fT.stop()),[2]}})})})];case 2:return t.sent(),[2]}})})},tl.prototype.ET=function(t){return new ph(this.persistence,new Ef,t.mT)},tl.prototype.IT=function(t){var e=new mf(this.M_,this.Qd,t.w_,this.Wd,t.mT,t.jd);return this.Wd instanceof pf&&(this.Wd.ul=e),e},tl.prototype.TT=function(t){var e=this.persistence.hh.xo;return new sh(e,t.Ra)},tl.prototype.dT=function(t){var e=$u.Mo(t.pT),n=t.platform.Cc(t.pT.ii);return new $u(t.VT.synchronizeTabs,e,t.clientId,t.platform,rh.nu(t.VT.cacheSizeBytes),t.Ra,n,this.Wd,t.VT.Bh)},tl.prototype.lT=function(t){if(t.VT.PT&&t.VT.synchronizeTabs){if(!pf.zh(t.platform))throw new _r(Ar.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var e=$u.Mo(t.pT);return new pf(t.Ra,t.platform,e,t.clientId,t.mT)}return new df},tl.prototype.clearPersistence=function(t){var e=$u.Mo(t);return $u.clearPersistence(e)},tl),Xf=(Zf.prototype.start=function(e,n){var r=this;this.yT();var i=new wu,o=new wu,s=!1;return this.credentials.l(function(t){if(!s)return s=!0,qs("FirestoreClient","Initializing. user=",t.uid),r.bT(e,n,t,o).then(i.resolve,i.reject);r.Ra.lo(function(){return r.gl(t)})}),this.Ra.co(function(){return i.promise}),o.promise},Zf.prototype.enableNetwork=function(){var t=this;return this.yT(),this.Ra.enqueue(function(){return t.ul.enableNetwork()})},Zf.prototype.bT=function(u,a,h,c){return y(this,void 0,void 0,function(){var n,r,i,o,s=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,this.platform.vT(this.pT)];case 1:return n=t.sent(),r=this.platform.Cc(this.pT.ii),e=this.credentials,i=new Fc(n,e,r),[4,u.initialize({Ra:this.Ra,pT:this.pT,platform:this.platform,w_:i,clientId:this.clientId,mT:h,jd:100,VT:a})];case 2:return t.sent(),this.persistence=u.persistence,this.Wd=u.Wd,this.M_=u.M_,this.Qd=u.Qd,this.ul=u.ul,this.fT=u.fT,this.ST=u.RT,this.persistence.oo(function(){return y(s,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),c.resolve(),[3,4];case 3:if(o=t.sent(),c.reject(o),!this.DT(o))throw o;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+o),this.bT(new Yf,{PT:!1},h,c))];case 4:return[2]}var e})})},Zf.prototype.DT=function(t){return"FirebaseError"===t.name?t.code===Ar.FAILED_PRECONDITION||t.code===Ar.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Zf.prototype.yT=function(){if(this.Ra.ka)throw new _r(Ar.FAILED_PRECONDITION,"The client has already been terminated.")},Zf.prototype.gl=function(t){return this.Ra.Ua(),qs("FirestoreClient","Credential Changed. Current user: "+t.uid),this.ul.gl(t)},Zf.prototype.disableNetwork=function(){var t=this;return this.yT(),this.Ra.enqueue(function(){return t.ul.disableNetwork()})},Zf.prototype.terminate=function(){var t=this;return this.Ra.Ba(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.fT&&this.fT.stop(),[4,this.Qd.Vo()];case 1:return t.sent(),[4,this.Wd.Vo()];case 2:return t.sent(),[4,this.persistence.Vo()];case 3:return t.sent(),this.credentials.T(),[2]}})})})},Zf.prototype.waitForPendingWrites=function(){var t=this;this.yT();var e=new wu;return this.Ra.co(function(){return t.ul.ff(e)}),e.promise},Zf.prototype.listen=function(t,e,n){var r=this;this.yT();var i=new bf(t,e,n);return this.Ra.co(function(){return r.ST.listen(i)}),i},Zf.prototype.ol=function(t){var e=this;this.CT||this.Ra.co(function(){return e.ST.ol(t)})},Zf.prototype.FT=function(o){return y(this,void 0,void 0,function(){var i,e=this;return v(this,function(t){switch(t.label){case 0:return this.yT(),i=new wu,[4,this.Ra.enqueue(function(){return y(e,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.M_.qu(o)];case 1:return(e=t.sent())instanceof bo?i.resolve(e):e instanceof Eo?i.resolve(null):i.reject(new _r(Ar.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return n=t.sent(),r=Za(n,"Failed to get document '"+o+" from cache"),i.reject(r),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),i.promise)]}})})},Zf.prototype.NT=function(a){return y(this,void 0,void 0,function(){var u,e=this;return v(this,function(t){switch(t.label){case 0:return this.yT(),u=new wu,[4,this.Ra.enqueue(function(){return y(e,void 0,void 0,function(){var e,n,r,i,o,s;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.M_.Wu(a,!0)];case 1:return e=t.sent(),n=new yf(a,e.ju),r=n.pd(e.documents),i=n.On(r,!1),u.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=Za(o,"Failed to execute query '"+a+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})},Zf.prototype.write=function(t){var e=this;this.yT();var n=new wu;return this.Ra.co(function(){return e.ul.write(t,n)}),n.promise},Zf.prototype.ii=function(){return this.pT.ii},Zf.prototype.Ff=function(t){var e=this;this.yT(),this.Ra.co(function(){return e.ST.Ff(t),Promise.resolve()})},Zf.prototype.Nf=function(t){var e=this;this.CT||this.Ra.co(function(){return e.ST.Nf(t),Promise.resolve()})},Object.defineProperty(Zf.prototype,"CT",{get:function(){return this.Ra.ka},enumerable:!0,configurable:!0}),Zf.prototype.transaction=function(t){var e=this;this.yT();var n=new wu;return this.Ra.co(function(){return e.ul.runTransaction(e.Ra,t,n),Promise.resolve()}),n.promise},Zf),Jf=($f.prototype.next=function(t){this.$T(this.observer.next,t)},$f.prototype.error=function(t){this.$T(this.observer.error,t)},$f.prototype.kT=function(){this.muted=!0},$f.prototype.$T=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},$f);function $f(t){this.observer=t,this.muted=!1}function Zf(t,e,n,r){this.platform=t,this.pT=e,this.credentials=n,this.Ra=r,this.clientId=Qs.cn()}function tl(){return null!==qf&&qf.apply(this,arguments)||this}function el(){}function nl(t){this.persistence=t,this.oT=new vh,this.aT=null}function rl(t){var e=this;return(e=Bf.call(this)||this).Lh=t,e}function il(t){var e=this;this.sT={},this.qh=new au(0),this.Uh=!1,this.Uh=!0,this.hh=t(this),this.Jh=new Gf(this),this.jn=new _u,this.Qn=new If(this.jn,function(t){return e.hh.iT(t)})}function ol(t){this.persistence=t,this.Xf=new Zs(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=Or.min(),this.highestTargetId=0,this.Zf=0,this.tT=new vh,this.targetCount=0,this.eT=qu.nh()}function sl(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var ul,al,hl,cl=(Ll.prototype.LT=function(t){switch(ui(t)){case 0:return null;case 1:return t.booleanValue;case 2:return di(t.integerValue||t.doubleValue);case 3:return this.OT(t.timestampValue);case 4:return this.BT(t);case 5:return t.stringValue;case 6:return new qh(yi(t.bytesValue));case 7:return this.qT(t.referenceValue);case 8:return this.UT(t.geoPointValue);case 9:return this.QT(t.arrayValue);case 10:return this.WT(t.mapValue);default:throw zs()}},Ll.prototype.WT=function(t){var n=this,r={};return Jr(t.fields||{},function(t,e){r[t]=n.LT(e)}),r},Ll.prototype.UT=function(t){return new uc(di(t.latitude),di(t.longitude))},Ll.prototype.QT=function(t){var e=this;return(t.values||[]).map(function(t){return e.LT(t)})},Ll.prototype.BT=function(t){switch(this.MT){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return ii(n)?t(n):n}(t);return null==e?null:this.LT(e);case"estimate":return this.OT(oi(t));default:return null}},Ll.prototype.OT=function(t){var e=pi(t),n=new xr(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},Ll.prototype.qT=function(t){var e=Lr.K(t);Ws(Cs(e));var n=new $s(e.get(1),e.get(3)),r=new Yr(e.k(5));return n.isEqual(this.ii)||Bs("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.ii.projectId+"/"+this.ii.database+") instead."),this.xT(r)},Ll),fl=rh.ou,ll=(kl.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},kl),pl=(Object.defineProperty(Ol.prototype,"tE",{get:function(){return this.eE||(this.eE=new Nc(this.mc,this.ZT.ignoreUndefinedProperties)),this.eE},enumerable:!0,configurable:!0}),Ol.prototype.settings=function(t){Eh("Firestore.settings",arguments,1),Nh("Firestore.settings","object",1,t);var e=new ll(t);if(this.zT&&!this.ZT.isEqual(e))throw new _r(Ar.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.ZT=e).credentials&&(this.JT=function(t){if(!t)return new Sr;switch(t.type){case"gapi":var e=t.sE;return Ws(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Pr(e,t.V||"0");case"provider":return t.sE;default:throw new _r(Ar.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},Ol.prototype.enableNetwork=function(){return this.GT(),this.zT.enableNetwork()},Ol.prototype.disableNetwork=function(){return this.GT(),this.zT.disableNetwork()},Ol.prototype.enablePersistence=function(t){var e,n;if(this.zT)throw new _r(Ar.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Bs("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new _r(Ar.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.iE(this.XT,{PT:!0,cacheSizeBytes:this.ZT.cacheSizeBytes,synchronizeTabs:r,Bh:i})},Ol.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){var r,e=this;return v(this,function(t){if(void 0!==this.zT&&!this.zT.CT)throw new _r(Ar.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return r=new wu,[2,(this.KT.Ma(function(){return y(e,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),e=this.nE(),[4,this.XT.clearPersistence(e)];case 1:return t.sent(),r.resolve(),[3,3];case 2:return n=t.sent(),r.reject(n),[3,3];case 3:return[2]}})})}),r.promise)]})})},Ol.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Ol.prototype,"rE",{get:function(){return this.GT(),this.zT.CT},enumerable:!0,configurable:!0}),Ol.prototype.waitForPendingWrites=function(){return this.GT(),this.zT.waitForPendingWrites()},Ol.prototype.onSnapshotsInSync=function(t){if(this.GT(),sl(t))return this.hE(t);Nh("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.hE(e)},Ol.prototype.hE=function(t){var e=this,n=new Jf({next:function(){t.next&&t.next()},error:function(t){throw zs()}});return this.zT.Ff(n),function(){n.kT(),e.zT.Nf(n)}},Ol.prototype.GT=function(){return this.zT||this.iE(new Yf,{PT:!1}),this.zT},Ol.prototype.nE=function(){return new Js(this.mc,this.YT,this.ZT.host,this.ZT.ssl,this.ZT.forceLongPolling)},Ol.prototype.iE=function(t,e){var n=this.nE();return this.zT=new Xf(Ms.nt(),n,this.JT,this.KT),this.zT.start(t,e)},Ol.HT=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new _r(Ar.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new _r(Ar.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new $s(n)},Object.defineProperty(Ol.prototype,"app",{get:function(){if(!this.jT)throw new _r(Ar.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.jT},enumerable:!0,configurable:!0}),Ol.prototype.collection=function(t){return Eh("Firestore.collection",arguments,1),Nh("Firestore.collection","non-empty string",1,t),this.GT(),new Tl(Lr.K(t),this)},Ol.prototype.doc=function(t){return Eh("Firestore.doc",arguments,1),Nh("Firestore.doc","non-empty string",1,t),this.GT(),vl.oE(Lr.K(t),this)},Ol.prototype.collectionGroup=function(t){if(Eh("Firestore.collectionGroup",arguments,1),Nh("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new _r(Ar.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.GT(),new bl(new No(Lr.G,t),this)},Ol.prototype.runTransaction=function(e){var n=this;return Eh("Firestore.runTransaction",arguments,1),Nh("Firestore.runTransaction","function",1,e),this.GT().transaction(function(t){return e(new dl(n,t))})},Ol.prototype.batch=function(){return this.GT(),new yl(this)},Object.defineProperty(Ol,"logLevel",{get:function(){switch(Fs()){case p.DEBUG:return"debug";case p.ERROR:return"error";case p.SILENT:return"silent";case p.WARN:return"warn";case p.INFO:return"info";case p.VERBOSE:return"verbose";default:return"error"}},enumerable:!0,configurable:!0}),Ol.setLogLevel=function(t){Eh("Firestore.setLogLevel",arguments,1),Dh("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Us.setLogLevel(t)},Ol.prototype.aE=function(){return this.ZT.timestampsInSnapshots},Ol),dl=(xl.prototype.get=function(t){var n=this;Eh("Transaction.get",arguments,1);var r=Ul("Transaction.get",t,this.uE);return this.cE.P_([r.Pc]).then(function(t){if(!t||1!==t.length)return zs();var e=t[0];if(e instanceof Eo)return new ml(n.uE,r.Pc,null,!1,!1,r.Vc);if(e instanceof bo)return new ml(n.uE,r.Pc,e,!1,!1,r.Vc);throw zs()})},xl.prototype.set=function(t,e,n){Ih("Transaction.set",arguments,2,3);var r=Ul("Transaction.set",t,this.uE);n=Vl("Transaction.set",n);var i=jl(r.Vc,e,"Transaction.set"),o=i[0],s=i[1],u=n.merge||n.mergeFields?this.uE.tE.$c(s,o,n.mergeFields):this.uE.tE.Fc(s,o);return this.cE.set(r.Pc,u),this},xl.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof Bh?(Th("Transaction.update",arguments,3),r=Ul("Transaction.update",t,this.uE),this.uE.tE.Mc("Transaction.update",e,n,o)):(Eh("Transaction.update",arguments,2),r=Ul("Transaction.update",t,this.uE),this.uE.tE.kc("Transaction.update",e)),this.cE.update(r.Pc,i),this},xl.prototype.delete=function(t){Eh("Transaction.delete",arguments,1);var e=Ul("Transaction.delete",t,this.uE);return this.cE.delete(e.Pc),this},xl),yl=(Pl.prototype.set=function(t,e,n){Ih("WriteBatch.set",arguments,2,3),this.dE();var r=Ul("WriteBatch.set",t,this.uE);n=Vl("WriteBatch.set",n);var i=jl(r.Vc,e,"WriteBatch.set"),o=i[0],s=i[1],u=n.merge||n.mergeFields?this.uE.tE.$c(s,o,n.mergeFields):this.uE.tE.Fc(s,o);return this._E=this._E.concat(u.gc(r.Pc,ji.ft())),this},Pl.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.dE(),i="string"==typeof e||e instanceof Bh?(Th("WriteBatch.update",arguments,3),r=Ul("WriteBatch.update",t,this.uE),this.uE.tE.Mc("WriteBatch.update",e,n,o)):(Eh("WriteBatch.update",arguments,2),r=Ul("WriteBatch.update",t,this.uE),this.uE.tE.kc("WriteBatch.update",e)),this._E=this._E.concat(i.gc(r.Pc,ji.exists(!0))),this},Pl.prototype.delete=function(t){Eh("WriteBatch.delete",arguments,1),this.dE();var e=Ul("WriteBatch.delete",t,this.uE);return this._E=this._E.concat(new zi(e.Pc,ji.ft())),this},Pl.prototype.commit=function(){return this.dE(),this.lE=!0,0<this._E.length?this.uE.GT().write(this._E):Promise.resolve()},Pl.prototype.dE=function(){if(this.lE)throw new _r(Ar.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Pl),vl=(n(Dl,hl=hc),Dl.oE=function(t,e,n){if(t.length%2!=0)throw new _r(Ar.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.j()+" has "+t.length);return new Dl(new Yr(t),e,n)},Object.defineProperty(Dl.prototype,"id",{get:function(){return this.Pc.path.O()},enumerable:!0,configurable:!0}),Object.defineProperty(Dl.prototype,"parent",{get:function(){return new Tl(this.Pc.path.M(),this.firestore,this.Vc)},enumerable:!0,configurable:!0}),Object.defineProperty(Dl.prototype,"path",{get:function(){return this.Pc.path.j()},enumerable:!0,configurable:!0}),Dl.prototype.collection=function(t){if(Eh("DocumentReference.collection",arguments,1),Nh("DocumentReference.collection","non-empty string",1,t),!t)throw new _r(Ar.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Lr.K(t);return new Tl(this.Pc.path.child(e),this.firestore)},Dl.prototype.isEqual=function(t){if(!(t instanceof Dl))throw Vh("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Pc.isEqual(t.Pc)&&this.Vc===t.Vc},Dl.prototype.set=function(t,e){Ih("DocumentReference.set",arguments,1,2),e=Vl("DocumentReference.set",e);var n=jl(this.Vc,t,"DocumentReference.set"),r=n[0],i=n[1],o=e.merge||e.mergeFields?this.firestore.tE.$c(i,r,e.mergeFields):this.firestore.tE.Fc(i,r);return this.zT.write(o.gc(this.Pc,ji.ft()))},Dl.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof Bh?(Th("DocumentReference.update",arguments,2),this.firestore.tE.Mc("DocumentReference.update",t,e,r)):(Eh("DocumentReference.update",arguments,1),this.firestore.tE.kc("DocumentReference.update",t)),this.zT.write(n.gc(this.Pc,ji.exists(!0)))},Dl.prototype.delete=function(){return Eh("DocumentReference.delete",arguments,0),this.zT.write([new zi(this.Pc,ji.ft())])},Dl.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Ih("DocumentReference.onSnapshot",arguments,1,4);var n={includeMetadataChanges:!1},r=0;"object"!=typeof t[r]||sl(t[r])||(Lh("DocumentReference.onSnapshot",n=t[r],["includeMetadataChanges"]),Sh("DocumentReference.onSnapshot","boolean","includeMetadataChanges",n.includeMetadataChanges),r++);var i={includeMetadataChanges:n.includeMetadataChanges},o=sl(t[r])?t[r]:(Nh("DocumentReference.onSnapshot","function",r,t[r]),Ah("DocumentReference.onSnapshot","function",r+1,t[r+1]),Ah("DocumentReference.onSnapshot","function",r+2,t[r+2]),{next:t[r],error:t[r+1],complete:t[r+2]});return this.fE(i,o)},Dl.prototype.fE=function(t,n){var r=this,e=function(t){console.error("Uncaught Error in onSnapshot:",t)};n.error&&(e=n.error.bind(n));var i=new Jf({next:function(t){var e;n.next&&(e=t.docs.get(r.Pc),n.next(new ml(r.firestore,r.Pc,e,t.fromCache,t.hasPendingWrites,r.Vc)))},error:e}),o=this.zT.listen(No.Wt(this.Pc.path),i,t);return function(){i.kT(),r.zT.ol(o)}},Dl.prototype.get=function(n){var r=this;return Ih("DocumentReference.get",arguments,0,1),Ml("DocumentReference.get",n),new Promise(function(e,t){n&&"cache"===n.source?r.firestore.GT().FT(r.Pc).then(function(t){e(new ml(r.firestore,r.Pc,t,!0,t instanceof bo&&t.At,r.Vc))},t):r.TE(e,t,n)})},Dl.prototype.TE=function(e,n,r){var i=this.fE({includeMetadataChanges:!0,Bf:!0},{next:function(t){i(),!t.exists&&t.metadata.fromCache?n(new _r(Ar.UNAVAILABLE,"Failed to get document because the client is offline.")):t.exists&&t.metadata.fromCache&&r&&"server"===r.source?n(new _r(Ar.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):e(t)},error:n})},Dl.prototype.withConverter=function(t){return new Dl(this.Pc,this.firestore,t)},Dl),gl=(Rl.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Rl),ml=(Sl.prototype.data=function(t){var e=this;if(Ih("DocumentSnapshot.data",arguments,0,1),t=Cl("DocumentSnapshot.data",t),this.EE){if(this.Vc){var n=new wl(this.uE,this.Pc,this.EE,this.wE,this.IE);return this.Vc.fromFirestore(n,t)}return new cl(this.uE.mc,this.uE.aE(),t.serverTimestamps||"none",function(t){return new vl(t,e.uE)}).LT(this.EE.Mt())}},Sl.prototype.get=function(t,e){var n=this;if(Ih("DocumentSnapshot.get",arguments,1,2),e=Cl("DocumentSnapshot.get",e),this.EE){var r=this.EE.data().field(xc("DocumentSnapshot.get",t));if(null!==r)return new cl(this.uE.mc,this.uE.aE(),e.serverTimestamps||"none",function(t){return new vl(t,n.uE,n.Vc)}).LT(r)}},Object.defineProperty(Sl.prototype,"id",{get:function(){return this.Pc.path.O()},enumerable:!0,configurable:!0}),Object.defineProperty(Sl.prototype,"ref",{get:function(){return new vl(this.Pc,this.uE,this.Vc)},enumerable:!0,configurable:!0}),Object.defineProperty(Sl.prototype,"exists",{get:function(){return null!==this.EE},enumerable:!0,configurable:!0}),Object.defineProperty(Sl.prototype,"metadata",{get:function(){return new gl(this.IE,this.wE)},enumerable:!0,configurable:!0}),Sl.prototype.isEqual=function(t){if(!(t instanceof Sl))throw Vh("isEqual","DocumentSnapshot",1,t);return this.uE===t.uE&&this.wE===t.wE&&this.Pc.isEqual(t.Pc)&&(null===this.EE?null===t.EE:this.EE.isEqual(t.EE))&&this.Vc===t.Vc},Sl),wl=(n(_l,al=ml),_l.prototype.data=function(t){return al.prototype.data.call(this,t)},_l),bl=(Al.prototype.where=function(t,e,n){Eh("Query.where",arguments,3),kh("Query.where",3,n);var r,i=Dh("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e),o=xc("Query.where",t);if(o.Y()){if("array-contains"===i||"array-contains-any"===i)throw new _r(Ar.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i){this.AE(n,i);for(var s=[],u=0,a=n;u<a.length;u++){var h=a[u];s.push(this.mE(h))}r={arrayValue:{values:s}}}else r=this.mE(n)}else"in"!==i&&"array-contains-any"!==i||this.AE(n,i),r=this.firestore.tE.xc("Query.where",n,"in"===i);var c=Ao.create(o,i,r);return this.PE(c),new Al(this.RE.Gt(c),this.firestore,this.Vc)},Al.prototype.orderBy=function(t,e){var n;if(Ih("Query.orderBy",arguments,1,2),Ah("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new _r(Ar.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}if(null!==this.RE.startAt)throw new _r(Ar.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.RE.endAt)throw new _r(Ar.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var r=xc("Query.orderBy",t),i=new Oo(r,n);return this.VE(i),new Al(this.RE.zt(i),this.firestore,this.Vc)},Al.prototype.limit=function(t){return Eh("Query.limit",arguments,1),Nh("Query.limit","number",1,t),Ch("Query.limit",1,t),new Al(this.RE.Ht(t),this.firestore,this.Vc)},Al.prototype.limitToLast=function(t){return Eh("Query.limitToLast",arguments,1),Nh("Query.limitToLast","number",1,t),Ch("Query.limitToLast",1,t),new Al(this.RE.Yt(t),this.firestore,this.Vc)},Al.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Th("Query.startAt",arguments,1);var r=this.gE("Query.startAt",t,e,!0);return new Al(this.RE.Jt(r),this.firestore,this.Vc)},Al.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Th("Query.startAfter",arguments,1);var r=this.gE("Query.startAfter",t,e,!1);return new Al(this.RE.Jt(r),this.firestore,this.Vc)},Al.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Th("Query.endBefore",arguments,1);var r=this.gE("Query.endBefore",t,e,!0);return new Al(this.RE.Xt(r),this.firestore,this.Vc)},Al.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Th("Query.endAt",arguments,1);var r=this.gE("Query.endAt",t,e,!1);return new Al(this.RE.Xt(r),this.firestore,this.Vc)},Al.prototype.isEqual=function(t){if(!(t instanceof Al))throw Vh("isEqual","Query",1,t);return this.firestore===t.firestore&&this.RE.isEqual(t.RE)},Al.prototype.withConverter=function(t){return new Al(this.RE,this.firestore,t)},Al.prototype.gE=function(t,e,n,r){if(kh(t,1,e),e instanceof ml){if(0<n.length)throw new _r(Ar.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var i=e;if(!i.exists)throw new _r(Ar.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.pE(i.EE,r)}var o=[e].concat(n);return this.yE(t,o,r)},Al.prototype.pE=function(t,e){for(var n=[],r=0,i=this.RE.orderBy;r<i.length;r++){var o=i[r];if(o.field.Y())n.push(vi(this.firestore.mc,t.key));else{var s=t.field(o.field);if(ii(s))throw new _r(Ar.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===s){var u=o.field.j();throw new _r(Ar.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}n.push(s)}}return new xo(n,e)},Al.prototype.yE=function(t,e,n){var r=this.RE.Ot;if(e.length>r.length)throw new _r(Ar.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<e.length;o++){var s=e[o];if(r[o].field.Y()){if("string"!=typeof s)throw new _r(Ar.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof s);if(!this.RE._e()&&-1!==s.indexOf("/"))throw new _r(Ar.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+s+"' contains a slash.");var u=this.RE.path.child(Lr.K(s));if(!Yr.et(u))throw new _r(Ar.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+u+"' is not because it contains an odd number of segments.");var a=new Yr(u);i.push(vi(this.firestore.mc,a))}else{var h=this.firestore.tE.xc(t,s);i.push(h)}}return new xo(i,n)},Al.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Ih("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!=typeof t[i]||sl(t[i])||(Lh("Query.onSnapshot",r=t[i],["includeMetadataChanges"]),Sh("Query.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++),n=sl(t[i])?t[i]:(Nh("Query.onSnapshot","function",i,t[i]),Ah("Query.onSnapshot","function",i+1,t[i+1]),Ah("Query.onSnapshot","function",i+2,t[i+2]),{next:t[i],error:t[i+1],complete:t[i+2]}),this.bE(this.RE),this.fE(r,n)},Al.prototype.fE=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Jf({next:function(t){e.next&&e.next(new El(n.firestore,n.RE,t,n.Vc))},error:r}),o=this.firestore.GT(),s=o.listen(this.RE,i,t);return function(){i.kT(),o.ol(s)}},Al.prototype.bE=function(t){if(t.ae()&&0===t.Ot.length)throw new _r(Ar.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},Al.prototype.get=function(n){var r=this;return Ih("Query.get",arguments,0,1),Ml("Query.get",n),this.bE(this.RE),new Promise(function(e,t){n&&"cache"===n.source?r.firestore.GT().NT(r.RE).then(function(t){e(new El(r.firestore,r.RE,t,r.Vc))},t):r.TE(e,t,n)})},Al.prototype.TE=function(e,n,r){var i=this.fE({includeMetadataChanges:!0,Bf:!0},{next:function(t){i(),t.metadata.fromCache&&r&&"server"===r.source?n(new _r(Ar.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):e(t)},error:n})},Al.prototype.mE=function(t){if("string"==typeof t){if(""===t)throw new _r(Ar.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.RE._e()&&-1!==t.indexOf("/"))throw new _r(Ar.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this.RE.path.child(Lr.K(t));if(!Yr.et(e))throw new _r(Ar.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return vi(this.firestore.mc,new Yr(e))}if(t instanceof vl)return vi(this.firestore.mc,t.Pc);throw new _r(Ar.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Oh(t)+".")},Al.prototype.AE=function(t,e){if(!Array.isArray(t)||0===t.length)throw new _r(Ar.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new _r(Ar.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new _r(Ar.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new _r(Ar.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},Al.prototype.PE=function(t){if(t instanceof Ao){var e=["array-contains","array-contains-any"],n=["in","array-contains-any"],r=0<=e.indexOf(t.op),i=0<=n.indexOf(t.op);if(t.ue()){var o=this.RE.jt();if(null!==o&&!o.isEqual(t.field))throw new _r(Ar.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var s=this.RE.Kt();null!==s&&this.vE(t.field,s)}else if(i||r){var u=null;if(i&&(u=this.RE.ce(n)),null===u&&r&&(u=this.RE.ce(e)),null!=u)throw u===t.op?new _r(Ar.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new _r(Ar.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+u.toString()+"' filters.")}}},Al.prototype.VE=function(t){var e;null!==this.RE.Kt()||null!==(e=this.RE.jt())&&this.vE(e,t.field)},Al.prototype.vE=function(t,e){if(!e.isEqual(t))throw new _r(Ar.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},Al),El=(Object.defineProperty(Nl.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!0,configurable:!0}),Object.defineProperty(Nl.prototype,"empty",{get:function(){return this.DE.docs.B()},enumerable:!0,configurable:!0}),Object.defineProperty(Nl.prototype,"size",{get:function(){return this.DE.docs.size},enumerable:!0,configurable:!0}),Nl.prototype.forEach=function(e,n){var r=this;Ih("QuerySnapshot.forEach",arguments,1,2),Nh("QuerySnapshot.forEach","function",1,e),this.DE.docs.forEach(function(t){e.call(n,r.NE(t))})},Object.defineProperty(Nl.prototype,"query",{get:function(){return new bl(this.SE,this.uE,this.Vc)},enumerable:!0,configurable:!0}),Nl.prototype.docChanges=function(t){t&&(Lh("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Sh("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.DE.hs)throw new _r(Ar.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.CE&&this.FE===e||(this.CE=function(i,e,o,s){if(o.ss.B()){var n=0;return o.docChanges.map(function(t){var e=new wl(i,t.doc.key,t.doc,o.fromCache,o.ns.has(t.doc.key),s);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var u=o.ss;return o.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new wl(i,t.doc.key,t.doc,o.fromCache,o.ns.has(t.doc.key),s),n=-1,r=-1;return 0!==t.type&&(n=u.indexOf(t.doc.key),u=u.delete(t.doc.key)),1!==t.type&&(r=(u=u.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return zs()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.uE,e,this.DE,this.Vc),this.FE=e),this.CE},Nl.prototype.isEqual=function(t){if(!(t instanceof Nl))throw Vh("isEqual","QuerySnapshot",1,t);return this.uE===t.uE&&this.SE.isEqual(t.SE)&&this.DE.isEqual(t.DE)&&this.Vc===t.Vc},Nl.prototype.NE=function(t){return new wl(this.uE,t.key,t,this.metadata.fromCache,this.DE.ns.has(t.key),this.Vc)},Nl),Tl=(n(Il,ul=bl),Object.defineProperty(Il.prototype,"id",{get:function(){return this.RE.path.O()},enumerable:!0,configurable:!0}),Object.defineProperty(Il.prototype,"parent",{get:function(){var t=this.RE.path.M();return t.B()?null:new vl(new Yr(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(Il.prototype,"path",{get:function(){return this.RE.path.j()},enumerable:!0,configurable:!0}),Il.prototype.doc=function(t){Ih("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Qs.cn()),Nh("CollectionReference.doc","non-empty string",1,t);var e=Lr.K(t);return vl.oE(this.RE.path.child(e),this.firestore,this.Vc)},Il.prototype.add=function(t){Eh("CollectionReference.add",arguments,1),Nh("CollectionReference.add","object",1,this.Vc?this.Vc.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},Il.prototype.withConverter=function(t){return new Il(this.$E,this.firestore,t)},Il);function Il(t,e,n){var r=this;if(((r=ul.call(this,No.Wt(t),e,n)||this).$E=t).length%2!=1)throw new _r(Ar.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.j()+" has "+t.length);return r}function Nl(t,e,n,r){this.uE=t,this.SE=e,this.DE=n,this.Vc=r,this.CE=null,this.FE=null,this.metadata=new gl(n.hasPendingWrites,n.fromCache)}function Al(t,e,n){this.RE=t,this.firestore=e,this.Vc=n}function _l(){return null!==al&&al.apply(this,arguments)||this}function Sl(t,e,n,r,i,o){this.uE=t,this.Pc=e,this.EE=n,this.wE=r,this.IE=i,this.Vc=o}function Rl(t,e){this.hasPendingWrites=t,this.fromCache=e}function Dl(t,e,n){var r=this;return(r=hl.call(this,e.mc,t,n)||this).Pc=t,r.firestore=e,r.Vc=n,r.zT=r.firestore.GT(),r}function Pl(t){this.uE=t,this._E=[],this.lE=!1}function xl(t,e){this.uE=t,this.cE=e}function Ol(t,e,n){var r=this;if(void 0===n&&(n=new Yf),this.jT=null,this.KT=new Xa,this.INTERNAL={delete:function(){return y(r,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.GT(),[4,this.zT.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var i=t;this.jT=i,this.mc=Ol.HT(i),this.YT=i.name,this.JT=new Rr(e)}else{var o=t;if(!o.projectId)throw new _r(Ar.INVALID_ARGUMENT,"Must provide projectId");this.mc=new $s(o.projectId,o.database),this.YT="[DEFAULT]",this.JT=new Sr}this.XT=n,this.ZT=new ll({})}function kl(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new _r(Ar.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else _h("settings","non-empty string","host",t.host),this.host=t.host,Sh("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(Lh("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),Sh("settings","object","credentials",t.credentials),this.credentials=t.credentials,Sh("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),Sh("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Bs("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Bs("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,Sh("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=rh.uu;else{if(t.cacheSizeBytes!==fl&&t.cacheSizeBytes<rh.au)throw new _r(Ar.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+rh.au);this.cacheSizeBytes=t.cacheSizeBytes}Sh("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}function Ll(t,e,n,r){this.ii=t,this.timestampsInSnapshots=e,this.MT=n,this.xT=r}function Vl(t,e){if(void 0===e)return{merge:!1};if(Lh(t,e,["merge","mergeFields"]),Sh(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new _r(Ar.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Oh(n));for(var r,i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof Bh))throw new _r(Ar.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+Oh(n[i]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new _r(Ar.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function Cl(t,e){return void 0===e?{}:(Lh(t,e,["serverTimestamps"]),Rh(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Ml(t,e){Ah(t,"object",1,e),e&&(Lh(t,e,["source"]),Rh(t,0,"source",e.source,["default","server","cache"]))}function Ul(t,e,n){if(e instanceof hc){if(e.firestore!==n)throw new _r(Ar.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Vh(t,"DocumentReference",1,e)}function jl(t,e,n){var r;return t?(r=t.toFirestore(e),n="toFirestore() in "+n):r=e,[r,n]}function Fl(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new _r(Ar.INVALID_ARGUMENT,t)}return n.prototype=t.prototype,Object.assign(n,t),n}var ql,Bl=Fl(pl,"Use firebase.firestore() instead."),Gl=Fl(dl,"Use firebase.firestore().runTransaction() instead."),zl=Fl(yl,"Use firebase.firestore().batch() instead."),Wl=Fl(vl,"Use firebase.firestore().doc() instead."),Ql=Fl(ml),Kl=Fl(wl),Yl=Fl(bl),Hl=Fl(El),Xl=Fl(Tl,"Use firebase.firestore().collection() instead."),Jl=Fl(oc,"Use FieldValue.<field>() instead."),$l=Fl(qh,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),Zl={Firestore:Bl,GeoPoint:uc,Timestamp:xr,Blob:$l,Transaction:Gl,WriteBatch:zl,DocumentReference:Wl,DocumentSnapshot:Ql,Query:Yl,QueryDocumentSnapshot:Kl,QuerySnapshot:Hl,CollectionReference:Xl,FieldPath:Bh,FieldValue:Jl,setLogLevel:pl.setLogLevel,CACHE_SIZE_UNLIMITED:fl},tp=(hp.prototype.U_=function(t){},hp.prototype.Vo=function(){},hp),ep=(ap.prototype.U_=function(t){this.OE.push(t)},ap.prototype.Vo=function(){window.removeEventListener("online",this.kE),window.removeEventListener("offline",this.xE)},ap.prototype.BE=function(){window.addEventListener("online",this.kE),window.addEventListener("offline",this.xE)},ap.prototype.ME=function(){qs("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.OE;t<e.length;t++)(0,e[t])(0)},ap.prototype.LE=function(){qs("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.OE;t<e.length;t++)(0,e[t])(1)},ap.zh=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},ap),np=(up.prototype.i_=function(t){this.QE=t},up.prototype.Xc=function(t){this.WE=t},up.prototype.onMessage=function(t){this.jE=t},up.prototype.close=function(){this.UE()},up.prototype.send=function(t){this.qE(t)},up.prototype.KE=function(){this.QE()},up.prototype.GE=function(t){this.WE(t)},up.prototype.zE=function(t){this.jE(t)},up),rp={BatchGetDocuments:"batchGet",Commit:"commit"},ip="gl-js/ fire/"+wr,op=(sp.prototype.YE=function(t,e){if(e)for(var n in e.o)e.o.hasOwnProperty(n)&&(t[n]=e.o[n]);t["X-Goog-Api-Client"]=ip},sp.prototype.T_=function(a,r,i){var h=this,c=this.JE(a);return new Promise(function(o,s){var u=new mr;u.listenOnce(vr.COMPLETE,function(){try{switch(u.getLastErrorCode()){case yr.NO_ERROR:var t=u.getResponseJson();qs("Connection","XHR received:",JSON.stringify(t)),o(t);break;case yr.TIMEOUT:qs("Connection",'RPC "'+a+'" timed out'),s(new _r(Ar.DEADLINE_EXCEEDED,"Request time out"));break;case yr.HTTP_ERROR:var e,n,r=u.getStatus();qs("Connection",'RPC "'+a+'" failed with status:',r,"response text:",u.getResponseText()),0<r?(e=u.getResponseJson().error)&&e.status&&e.message?(i=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(Ar).indexOf(i)?i:Ar.UNKNOWN,s(new _r(n,e.message))):s(new _r(Ar.UNKNOWN,"Server responded with status "+u.getStatus())):(qs("Connection",'RPC "'+a+'" failed'),s(new _r(Ar.UNAVAILABLE,"Connection failed.")));break;default:zs()}}finally{qs("Connection",'RPC "'+a+'" completed.')}var i});var t=Object.assign({},r);delete t.database;var e=JSON.stringify(t);qs("Connection","XHR sending: ",c+" "+e);var n={"Content-Type":"text/plain"};h.YE(n,i),u.send(c,"POST",e,n,15)})},sp.prototype.E_=function(t,e,n){return this.T_(t,e,n)},sp.prototype.n_=function(t,e){var n,r,i=[this.HE,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=dr(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.ii.projectId+"/databases/"+this.ii.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.YE(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(g())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=g().indexOf("Electron/")||0<=(r=g()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=g().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}qs("Connection","Creating WebChannel: "+u+" "+s);var h=o.createWebChannel(u,s),c=!1,f=!1,l=new np({qE:function(t){f?qs("Connection","Not sending because WebChannel is closed:",t):(c||(qs("Connection","Opening WebChannel transport."),h.open(),c=!0),qs("Connection","WebChannel sending:",t),h.send(t))},UE:function(){return h.close()}});return a(gr.EventType.OPEN,function(){f||qs("Connection","WebChannel transport opened.")}),a(gr.EventType.CLOSE,function(){f||(f=!0,qs("Connection","WebChannel transport closed"),l.GE())}),a(gr.EventType.ERROR,function(t){f||(f=!0,function(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Us.logLevel<=p.WARN&&(e=n.map(Gs),Us.warn.apply(Us,d(["Firestore ("+wr+"): Connection"],e)))}("Connection","WebChannel transport errored:",t),l.GE(new _r(Ar.UNAVAILABLE,"The operation could not be completed")))}),a(gr.EventType.MESSAGE,function(t){var e,n,r,i,o,s;f||(Ws(!!(n=t.data[0])),(r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(qs("Connection","WebChannel received error:",r),i=r.status,o=function(){var t=ao[i];if(void 0!==t)return Ho(t)}(),s=r.message,void 0===o&&(o=Ar.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),f=!0,l.GE(new _r(o,s)),h.close()):(qs("Connection","WebChannel received:",n),l.zE(n)))}),setTimeout(function(){l.KE()},0),l},sp.prototype.JE=function(t){var e=rp[t];return this.HE+"/v1/projects/"+this.ii.projectId+"/databases/"+this.ii.database+"/documents:"+e},sp);function sp(t){this.ii=t.ii;var e=t.ssl?"https":"http";this.HE=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function up(t){this.qE=t.qE,this.UE=t.UE}function ap(){var t=this;this.kE=function(){return t.ME()},this.xE=function(){return t.LE()},this.OE=[],this.BE()}function hp(){}function cp(){this.oc="undefined"!=typeof atob}Ms.an((Object.defineProperty(cp.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(cp.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),cp.prototype.vT=function(t){return Promise.resolve(new op(t))},cp.prototype.gT=function(){return new(ep.zh()?ep:tp)},cp.prototype.Cc=function(t){return new Ls(t,{hi:!0})},cp.prototype.un=function(t){return JSON.stringify(t)},cp.prototype.atob=function(t){return atob(t)},cp.prototype.btoa=function(t){return btoa(t)},cp.prototype._n=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n},new cp)),(ql=fp).INTERNAL.registerComponent(new T("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new pl(e,n,new Hf);var e,n},"PUBLIC").setServiceProps(Object.assign({},Zl))),ql.registerVersion("@firebase/firestore","1.15.0-0")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
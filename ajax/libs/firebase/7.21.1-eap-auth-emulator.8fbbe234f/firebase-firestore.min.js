!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Ev){"use strict";try{(function(){var t,l,e,n,r=(n=Ev)&&"object"==typeof n&&"default"in n?n:{default:n},i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function o(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function m(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function w(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function u(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function a(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=f[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,u(["["+i+"]  "+t.name+":"],n))}}(e=l=l||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";var c={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},h=l.INFO,f=((t={})[l.DEBUG]="log",t[l.VERBOSE]="log",t[l.INFO]="info",t[l.WARN]="warn",t[l.ERROR]="error",t),p=(Object.defineProperty(d.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),d.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?c[t]:t},Object.defineProperty(d.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),d.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.DEBUG],t)),this._logHandler.apply(this,u([this,l.DEBUG],t))},d.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.VERBOSE],t)),this._logHandler.apply(this,u([this,l.VERBOSE],t))},d.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.INFO],t)),this._logHandler.apply(this,u([this,l.INFO],t))},d.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.WARN],t)),this._logHandler.apply(this,u([this,l.WARN],t))},d.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.ERROR],t)),this._logHandler.apply(this,u([this,l.ERROR],t))},d);function d(t){this.name=t,this._logLevel=h,this._logHandler=a,this._userLogHandler=null}function v(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var y,g="FirebaseError",b=(o(I,y=Error),I);function I(t,e){var n=y.call(this,e)||this;return n.code=t,n.name=g,Object.setPrototypeOf(n,I.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,E.prototype.create),n}var E=(_.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(r=i,s.replace(T,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",c=new b(o,a),h=0,f=Object.keys(i);h<f.length;h++){var l=f[h];"_"!==l.slice(-1)&&(l in c&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),c[l]=i[l])}return c},_);function _(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var T=/\{\$([^}]+)}/g,N=function(t,e){return(N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var S,D="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},O=D||self;function x(){}function R(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function k(t){var e=R(t);return"array"==e||"object"==e&&"number"==typeof t.length}function L(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),V=0;function C(t,e,n){return t.call.apply(t.bind,arguments)}function U(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function M(t,e,n){return(M=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?C:U).apply(null,arguments)}function j(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var F=Date.now;function q(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function B(){this.j=this.j,this.i=this.i}B.prototype.j=!1,B.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,P)&&this[P]||(this[P]=++V))},B.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var G=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},z=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function W(t){return Array.prototype.concat.apply([],arguments)}function K(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var Q,Y=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function $(t,e){return t<e?-1:e<t?1:0}t:{var J=O.navigator;if(J){var Z=J.userAgent;if(Z){Q=Z;break t}}Q=""}function tt(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function et(t){var e,n={};for(e in t)n[e]=t[e];return n}var nt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function rt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<nt.length;o++)n=nt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function it(t){return it[" "](t),t}it[" "]=x;var ot,st,ut=X(Q,"Opera"),at=X(Q,"Trident")||X(Q,"MSIE"),ct=X(Q,"Edge"),ht=ct||at,ft=X(Q,"Gecko")&&!(X(Q.toLowerCase(),"webkit")&&!X(Q,"Edge"))&&!(X(Q,"Trident")||X(Q,"MSIE"))&&!X(Q,"Edge"),lt=X(Q.toLowerCase(),"webkit")&&!X(Q,"Edge");function pt(){var t=O.document;return t?t.documentMode:void 0}t:{var dt="",vt=(st=Q,ft?/rv:([^\);]+)(\)|;)/.exec(st):ct?/Edge\/([\d\.]+)/.exec(st):at?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(st):lt?/WebKit\/(\S+)/.exec(st):ut?/(?:Version)[ \/]?(\S+)/.exec(st):void 0);if(vt&&(dt=vt?vt[1]:""),at){var yt=pt();if(null!=yt&&yt>parseFloat(dt)){ot=String(yt);break t}}ot=dt}var gt={};function mt(u){return t=u,e=function(){for(var t=0,e=Y(String(ot)).split("."),n=Y(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=$(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||$(0==o[2].length,0==s[2].length)||$(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=gt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var wt=O.document&&at&&(pt()||parseInt(ot,10))||void 0,bt=!at||9<=Number(wt),It=at&&!mt("9"),Et=function(){if(!O.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{O.addEventListener("test",x,e),O.removeEventListener("test",x,e)}catch(t){}return t}();function _t(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Tt(t,e){if(_t.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ft){t:{try{it(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Nt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}_t.prototype.b=function(){this.defaultPrevented=!0},q(Tt,_t);var Nt={2:"touch",3:"pen",4:"mouse"};Tt.prototype.b=function(){Tt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,It)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var At="closure_listenable_"+(1e6*Math.random()|0),St=0;function Dt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++St,this.Y=this.Z=!1}function Ot(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function xt(t){this.src=t,this.a={},this.b=0}function Rt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=G(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Ot(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function kt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}xt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=kt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Dt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Lt="closure_lm_"+(1e6*Math.random()|0),Pt={};function Vt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Gt(r),e&&e[At]?e.wa(n,r,L(i)?!!i.capture:!!i,o):Ct(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Vt(t,e[o],n,r,i);return null}return n=Gt(n),t&&t[At]?t.va(e,n,L(r)?!!r.capture:!!r,i):Ct(t,e,n,!1,r,i)}function Ct(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=L(i)?!!i.capture:!!i;if(s&&!bt)return null;var u,a,c=qt(t);if(c||(t[Lt]=c=new xt(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Ft,r=a=bt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)Et||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Mt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ut(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[At]?Rt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Mt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=qt(e))?(Rt(n,t),0==n.b&&(n.src=null,e[Lt]=null)):Ot(t)))}function Mt(t){return t in Pt?Pt[t]:Pt[t]="on"+t}function jt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Ut(t),n.call(r,e)}function Ft(t,e){if(t.Y)return!0;if(bt)return jt(t,new Tt(e,this));if(!e)t:{e=["window","event"];for(var n=O,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return jt(t,e=new Tt(e,this))}function qt(t){return(t=t[Lt])instanceof xt?t:null}var Bt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Gt(e){return"function"==R(e)?e:(e[Bt]||(e[Bt]=function(t){return e.handleEvent(t)}),e[Bt])}function zt(){B.call(this),this.c=new xt(this),(this.J=this).C=null}function Wt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Rt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}q(zt,B),zt.prototype[At]=!0,(S=zt.prototype).addEventListener=function(t,e,n,r){Vt(this,t,e,n,r)},S.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=L(i)?!!i.capture:!!i,r=Gt(r),e&&e[At]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=kt(s=e.a[n],r,i,o))&&(Ot(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&qt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=kt(n,r,i,o)),(r=-1<e?n[e]:null)&&Ut(r))}(this,t,e,n,r)},S.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new _t(t,n):t instanceof _t?t.target=t.target||n:(s=t,rt(t=new _t(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=Wt(o,r,!0,t)&&s;if(s=Wt(o=t.a=n,r,!0,t)&&s,s=Wt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Wt(o=t.a=e[i],r,!1,t)&&s;return s},S.G=function(){if(zt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Ot(n[r]);delete e.a[t],e.b--}}this.C=null},S.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},S.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Kt=O.JSON.stringify;function Ht(){this.b=this.a=null}var Qt,Yt=(Xt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Xt(function(){return new $t},function(t){t.reset()},100));function Xt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function $t(){this.next=this.b=this.a=null}function Jt(t,e){var n;Qt||(n=O.Promise.resolve(void 0),Qt=function(){n.then(ee)}),Zt||(Qt(),Zt=!0),te.add(t,e)}Ht.prototype.add=function(t,e){var n=Yt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},$t.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Zt=!($t.prototype.reset=function(){this.next=this.b=this.a=null}),te=new Ht;function ee(){for(var t,e,n;n=e=void 0,n=null,(e=te).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){O.setTimeout(function(){throw t},0)}(t)}var r=Yt;r.g(t),r.b<r.f&&(r.b++,t.next=r.a,r.a=t)}Zt=!1}function ne(t,e){zt.call(this),this.b=t||1,this.a=e||O,this.f=M(this.Ya,this),this.g=F()}function re(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ie(t,e,n){if("function"==R(t))n&&(t=M(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=M(t.handleEvent,t)}return 2147483647<Number(e)?-1:O.setTimeout(t,e||0)}q(ne,zt),(S=ne.prototype).aa=!1,S.M=null,S.Ya=function(){var t;this.aa&&(0<(t=F()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(re(this),this.start())))},S.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=F())},S.G=function(){ne.S.G.call(this),re(this),delete this.a};var oe,se,ue,ae=(N(se=he,ue=oe=B),se.prototype=null===ue?Object.create(ue):(ce.prototype=ue.prototype,new ce),he.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ie(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},he.prototype.G=function(){oe.prototype.G.call(this),this.a&&(O.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},he);function ce(){this.constructor=se}function he(t,e,n){var r=oe.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function fe(t){B.call(this),this.b=t,this.a={}}q(fe,B);var le=[];function pe(t,e,n,r){Array.isArray(n)||(n&&(le[0]=n.toString()),n=le);for(var i=0;i<n.length;i++){var o=Vt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function de(t){tt(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ut(t)},t),t.a={}}function ve(){this.a=!0}function ye(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Kt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}fe.prototype.G=function(){fe.S.G.call(this),de(this)},fe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ve.prototype.info=function(){};var ge=null;function me(){return ge=ge||new zt}function we(t){_t.call(this,"serverreachability",t)}function be(){var t=me();t.dispatchEvent(new we(t))}function Ie(t){_t.call(this,"statevent",t)}function Ee(){var t=me();t.dispatchEvent(new Ie(t))}function _e(t){_t.call(this,"timingevent",t)}function Te(t,e){if("function"!=R(t))throw Error("Fn must not be null and must be a function");return O.setTimeout(function(){t()},e)}q(we,_t),q(Ie,_t),q(_e,_t);var Ne={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ae={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Se(){}function De(t){var e;return(e=t.a)||(e=t.a={}),e}function Oe(){}Se.prototype.a=null;var xe,Re={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function ke(){_t.call(this,"d")}function Le(){_t.call(this,"c")}function Pe(){}function Ve(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new fe(this),this.P=Ce,t=ht?125:void 0,this.R=new ne(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}q(ke,_t),q(Le,_t),q(Pe,Se),xe=new Pe;var Ce=45e3,Ue={},Me={};function je(t,e,n){t.H=1,t.i=un(tn(e)),t.j=n,t.I=!0,Fe(t,null)}function Fe(t,e){t.u=F(),Be(t),t.l=tn(t.i);var s,u,a,c,h,f,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),bn(n.b,"t",r),t.D=0,t.a=pr(t.g,t.g.C?e:null),0<t.O&&(t.F=new ae(M(t.Ca,t,t.a),t.O)),pe(t.J,t.a,"readystatechange",t.Wa),e=t.B?et(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),be(),s=t.c,u=t.m,a=t.l,c=t.f,h=t.T,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function qe(t,e,n){for(var r,i,o,s,u=!0;!t.A&&t.D<n.length;){var a=(i=n,s=o=void 0,o=(r=t).D,-1==(s=i.indexOf("\n",o))?Me:(o=Number(i.substring(o,s)),isNaN(o)?Ue:(s+=1)+o>i.length?Me:(i=i.substr(s,o),r.D=s+o,i)));if(a==Me){4==e&&(t.h=4,Ee(),u=!1),ye(t.c,t.f,null,"[Incomplete Response]");break}if(a==Ue){t.h=4,Ee(),ye(t.c,t.f,n,"[Invalid Chunk]"),u=!1;break}ye(t.c,t.f,a,null),He(t,a)}4==e&&0==n.length&&(t.h=1,Ee(),u=!1),t.b=t.b&&u,u?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),or(e),e.F=!0)):(ye(t.c,t.f,n,"[Invalid Chunked Response]"),Ke(t),We(t))}function Be(t){t.U=F()+t.P,Ge(t,t.P)}function Ge(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Te(M(t.Ua,t),e)}function ze(t){t.o&&(O.clearTimeout(t.o),t.o=null)}function We(t){0==t.g.v||t.A||ar(t.g,t)}function Ke(t){ze(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,re(t.R),de(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function He(t,e){try{var n,r,i,o,s,u,a,c,h,f,l,p=t.g;if(0!=p.v&&(p.a==t||Sn(p.b,t)))if(p.I=t.N,!t.C&&Sn(p.b,t)&&3==p.v){try{var d=p.ka.a.parse(e)}catch(t){d=null}if(Array.isArray(d)&&3==d.length){var v=d;if(0==v[0]){t:if(!p.j){if(p.a){if(!(p.a.u+3e3<t.u))break t;ur(p),Xn(p)}ir(p),Ee()}}else p.oa=v[1],0<p.oa-p.P&&v[2]<37500&&p.H&&0==p.o&&!p.m&&(p.m=Te(M(p.Ra,p),6e3));if(An(p.b)<=1&&p.ea){try{p.ea()}catch(t){}p.ea=void 0}}else hr(p,11)}else if(!t.C&&p.a!=t||ur(p),!H(e))for(e=d=p.ka.a.parse(e),d=0;d<e.length;d++)v=e[d],p.P=v[0],v=v[1],2==p.v?"c"==v[0]?(p.J=v[1],p.ga=v[2],null!=(n=v[3])&&(p.ha=n,p.c.info("VER="+p.ha)),null!=(r=v[4])&&(p.pa=r,p.c.info("SVER="+p.pa)),null!=(i=v[5])&&"number"==typeof i&&0<i&&(o=1.5*i,p.D=o,p.c.info("backChannelRequestTimeoutMs_="+o)),o=p,(s=t.a)&&(!(u=s.a?s.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(a=o.b).a&&(X(u,"spdy")||X(u,"quic")||X(u,"h2"))&&(a.f=a.g,a.a=new Set,a.b&&(Dn(a,a.b),a.b=null)),!o.A||(c=s.a?s.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(o.na=c,sn(o.B,o.A,c))),p.v=3,p.f&&p.f.ta(),p.V&&(p.N=F()-t.u,p.c.info("Handshake RTT: "+p.N+"ms")),h=t,(o=p).la=lr(o,o.C?o.ga:null,o.fa),h.C?(On(o.b,h),f=h,(l=o.D)&&f.setTimeout(l),f.o&&(ze(f),Be(f)),o.a=h):rr(o),0<p.g.length&&Zn(p)):"stop"!=v[0]&&"close"!=v[0]||hr(p,7):3==p.v&&("stop"==v[0]||"close"==v[0]?"stop"==v[0]?hr(p,7):Yn(p):"noop"!=v[0]&&p.f&&p.f.sa(v),p.o=0);be()}catch(t){}}function Qe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(k(t)||"string"==typeof t)z(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(k(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(k(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ye(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ye)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Xe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];$e(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)$e(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function $e(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(S=Ve.prototype).setTimeout=function(t){this.P=t},S.Wa=function(t){t=t.target;var e=this.F;e&&3==Wn(t)?e.f():this.Ca(t)},S.Ca=function(t){try{if(t==this.a)t:{var e=Wn(this.a),n=this.a.ua();this.a.X();if(!(e<3||3==e&&!ht&&!this.a.$())){this.A||4!=e||7==n||be(),ze(this);var r=this.a.X();this.N=r;var i=this.a.$();if(this.b=200==r,a=this.c,c=this.m,h=this.l,f=this.f,l=this.T,p=e,d=r,a.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+l+"]: "+c+"\n"+h+"\n"+p+" "+d}),this.b){if(this.V&&!this.C){e:{if(this.a){var o,s=this.a;if((o=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(o)){var u=o;break e}}u=null}if(!u){this.b=!1,this.h=3,Ee(),Ke(this),We(this);break t}ye(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,He(this,u)}this.I?(qe(this,e,i),ht&&this.b&&3==e&&(pe(this.J,this.R,"tick",this.Va),this.R.start())):(ye(this.c,this.f,i,null),He(this,i)),4==e&&Ke(this),this.b&&!this.A&&(4==e?ar(this.g,this):(this.b=!1,Be(this)))}else 400==r&&0<i.indexOf("Unknown SID")?this.h=3:this.h=0,Ee(),Ke(this),We(this)}}}catch(t){}var a,c,h,f,l,p,d},S.Va=function(){var t,e;this.a&&(t=Wn(this.a),e=this.a.$(),this.D<e.length&&(ze(this),qe(this,t,e),this.b&&4!=t&&Be(this)))},S.cancel=function(){this.A=!0,Ke(this)},S.Ua=function(){this.o=null;var t,e,n=F();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(be(),Ee()),Ke(this),this.h=2,We(this)):Ge(this,this.U-n)},(S=Ye.prototype).K=function(){Xe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},S.L=function(){return Xe(this),this.a.concat()},S.get=function(t,e){return $e(this.b,t)?this.b[t]:e},S.set=function(t,e){$e(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},S.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Je=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ze(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ze?(this.a=void 0!==e?e:t.a,en(this,t.f),this.j=t.j,nn(this,t.c),rn(this,t.h),this.g=t.g,e=t.b,(n=new yn).c=e.c,e.a&&(n.a=new Ye(e.a),n.b=e.b),on(this,n),this.i=t.i):t&&(n=String(t).match(Je))?(this.a=!!e,en(this,n[1]||"",!0),this.j=an(n[2]||""),nn(this,n[3]||"",!0),rn(this,n[4]),this.g=an(n[5]||"",!0),on(this,n[6]||"",!0),this.i=an(n[7]||"")):(this.a=!!e,this.b=new yn(null,this.a))}function tn(t){return new Ze(t)}function en(t,e,n){t.f=n?an(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function nn(t,e,n){t.c=n?an(e,!0):e}function rn(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function on(t,e,n){var r,i;e instanceof yn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(gn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(mn(this,e),bn(this,n,t))},r)),r.f=i):(n||(e=cn(e,dn)),t.b=new yn(e,t.a))}function sn(t,e,n){t.b.set(e,n)}function un(t){return sn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^F()).toString(36)),t}function an(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function cn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,hn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function hn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ze.prototype.toString=function(){var t=[],e=this.f;e&&t.push(cn(e,fn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(cn(e,fn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(cn(n,"/"==n.charAt(0)?pn:ln,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",cn(n,vn)),t.join("")};var fn=/[#\/\?@]/g,ln=/[#\?:]/g,pn=/[#\?]/g,dn=/[#\?@]/g,vn=/#/g;function yn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function gn(u){u.a||(u.a=new Ye,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function mn(t,e){gn(t),e=In(t,e),$e(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,$e((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Xe(t)))}function wn(t,e){return gn(t),e=In(t,e),$e(t.a.b,e)}function bn(t,e,n){mn(t,e),0<n.length&&(t.c=null,t.a.set(In(t,e),K(n)),t.b+=n.length)}function In(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function En(t,e){this.b=t,this.a=e}function _n(t){this.g=t||Tn,t=O.PerformanceNavigationTiming?0<(t=O.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(O.ia&&O.ia.ya&&O.ia.ya()&&O.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(S=yn.prototype).add=function(t,e){gn(this),this.c=null,t=In(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},S.forEach=function(n,r){gn(this),this.a.forEach(function(t,e){z(t,function(t){n.call(r,t,e,this)},this)},this)},S.L=function(){gn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},S.K=function(t){gn(this);var e=[];if("string"==typeof t)wn(this,t)&&(e=W(e,this.a.get(In(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=W(e,t[n])}return e},S.set=function(t,e){return gn(this),this.c=null,wn(this,t=In(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},S.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},S.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var Tn=10;function Nn(t){return t.b||t.a&&t.a.size>=t.f}function An(t){return t.b?1:t.a?t.a.size:0}function Sn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Dn(t,e){t.a?t.a.add(e):t.b=e}function On(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function xn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return K(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Rn(){}function kn(){this.a=new Rn}function Ln(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}_n.prototype.cancel=function(){var t,e;if(this.c=xn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Rn.prototype.stringify=function(t){return O.JSON.stringify(t,void 0)},Rn.prototype.parse=function(t){return O.JSON.parse(t,void 0)};var Pn=O.JSON.parse;function Vn(t){zt.call(this),this.headers=new Ye,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Cn,this.D=this.F=!1}q(Vn,zt);var Cn="",Un=/^https?$/i,Mn=["POST","PUT"];function jn(t){return"content-type"==t.toLowerCase()}function Fn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,qn(t),Gn(t)}function qn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Bn(t){if(t.b&&(!t.s[1]||4!=Wn(t)||2!=t.X()))if(t.l&&4==Wn(t))ie(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==Wn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Je)[1]||null)&&O.self&&O.self.location&&(i=(r=O.self.location.protocol).substr(0,r.length-1)),n=!Un.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Wn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",qn(t)}}finally{Gn(t)}}}function Gn(t,e){if(t.a){zn(t);var n=t.a,r=t.s[0]?x:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function zn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(O.clearTimeout(t.m),t.m=null)}function Wn(t){return t.a?t.a.readyState:0}function Kn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",tt(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):sn(t,e,n))}function Hn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Qn(t){this.pa=0,this.g=[],this.c=new ve,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Hn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Hn("baseRetryDelayMs",5e3,t),this.Ma=Hn("retryDelaySeedMs",1e4,t),this.Ja=Hn("forwardChannelMaxRetries",2,t),this.ma=Hn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new _n(t&&t.concurrentRequestLimit),this.ka=new kn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Yn(t){var e,n;$n(t),3==t.v&&(e=t.R++,sn(n=tn(t.B),"SID",t.J),sn(n,"RID",e),sn(n,"TYPE","terminate"),er(t,n),(e=new Ve(t,t.c,e,void 0)).H=2,e.i=un(tn(n)),n=!1,O.navigator&&O.navigator.sendBeacon&&(n=O.navigator.sendBeacon(e.i.toString(),"")),!n&&O.Image&&((new Image).src=e.i,n=!0),n||(e.a=pr(e.g,null),e.a.ba(e.i)),e.u=F(),Be(e)),fr(t)}function Xn(t){t.a&&(or(t),t.a.cancel(),t.a=null)}function $n(t){Xn(t),t.j&&(O.clearTimeout(t.j),t.j=null),ur(t),t.b.cancel(),t.h&&("number"==typeof t.h&&O.clearTimeout(t.h),t.h=null)}function Jn(t,e){t.g.push(new En(t.La++,e)),3==t.v&&Zn(t)}function Zn(t){Nn(t.b)||t.h||(t.h=!0,Jt(t.Ba,t),t.u=0)}function tr(t,e){var n=e?e.f:t.R++,r=tn(t.B);sn(r,"SID",t.J),sn(r,"RID",n),sn(r,"AID",t.P),er(t,r),t.i&&t.l&&Kn(r,t.i,t.l),n=new Ve(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=nr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Dn(t.b,n),je(n,r,e)}function er(t,n){t.f&&Qe({},function(t,e){sn(n,e,t)})}function nr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?M(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+c+"_"||"";try{Qe(t,function(t,e){var n=t;L(t)&&(n=Kt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s)}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function rr(t){t.a||t.j||(t.U=1,Jt(t.Aa,t),t.o=0)}function ir(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=Te(M(t.Aa,t),cr(t,t.o)),t.o++,1)}function or(t){null!=t.s&&(O.clearTimeout(t.s),t.s=null)}function sr(t){t.a=new Ve(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=tn(t.la);sn(e,"RID","rpc"),sn(e,"SID",t.J),sn(e,"CI",t.H?"0":"1"),sn(e,"AID",t.P),er(t,e),sn(e,"TYPE","xmlhttp"),t.i&&t.l&&Kn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=un(tn(e)),n.j=null,n.I=!0,Fe(n,t)}function ur(t){null!=t.m&&(O.clearTimeout(t.m),t.m=null)}function ar(t,e){var n,r=null;if(t.a==e){ur(t),or(t),t.a=null;var i=2}else{if(!Sn(t.b,e))return;r=e.s,On(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b)1==i?(r=e.j?e.j.length:0,e=F()-e.u,n=t.u,(i=me()).dispatchEvent(new _e(i)),Zn(t)):rr(t);else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(An(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=Te(M(t.Ba,t,e),cr(t,t.u)),t.u++,1}}(t,e)||2==i&&ir(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:hr(t,5);break;case 4:hr(t,10);break;case 3:hr(t,6);break;default:hr(t,2)}}function cr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function hr(t,e){var n,r,i,o,s,u;t.c.info("Error code "+e),2==e?(n=null,t.f&&(n=null),r=M(t.Xa,t),n||(n=new Ze("//www.google.com/images/cleardot.gif"),O.location&&"http"==O.location.protocol||en(n,"https"),un(n)),i=n.toString(),o=r,u=new ve,O.Image?((s=new Image).onload=j(Ln,u,s,"TestLoadImage: loaded",!0,o),s.onerror=j(Ln,u,s,"TestLoadImage: error",!1,o),s.onabort=j(Ln,u,s,"TestLoadImage: abort",!1,o),s.ontimeout=j(Ln,u,s,"TestLoadImage: timeout",!1,o),O.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=i):o(!1)):Ee(),t.v=0,t.f&&t.f.ra(e),fr(t),$n(t)}function fr(t){t.v=0,t.I=-1,t.f&&(0==xn(t.b).length&&0==t.g.length||(t.b.c.length=0,K(t.g),t.g.length=0),t.f.qa())}function lr(t,e,n){var r,i,o,s,u,a,c,h=(r=n)instanceof Ze?tn(r):new Ze(r,void 0);return""!=h.c?(e&&nn(h,e+"."+h.c),rn(h,h.h)):(o=(i=O.location).protocol,s=e?e+"."+i.hostname:i.hostname,u=+i.port,a=n,c=new Ze(null,void 0),o&&en(c,o),s&&nn(c,s),u&&rn(c,u),a&&(c.g=a),h=c),t.W&&tt(t.W,function(t,e){sn(h,e,t)}),e=t.A,n=t.na,e&&n&&sn(h,e,n),sn(h,"VER",t.ha),er(t,h),h}function pr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Vn(t.Ka)).F=t.C,e}function dr(){}function vr(){if(at&&!(10<=Number(wt)))throw Error("Environmental error: no available transport.")}function yr(t,e){zt.call(this),this.a=new Qn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new wr(this)}function gr(t){ke.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function mr(){Le.call(this),this.status=1}function wr(t){this.a=t}(S=Vn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?De(this.H):De(xe),this.a.onreadystatechange=M(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Fn(this,t)}t=n||"";var i,o=new Ye(this.headers);r&&Qe(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=jn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=O.FormData&&t instanceof O.FormData,0<=G(Mn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{zn(this),0<this.o&&((this.D=(i=this.a,at&&mt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=M(this.xa,this)):this.m=ie(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Fn(this,t)}},S.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},S.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Gn(this))},S.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Gn(this,!0)),Vn.S.G.call(this)},S.za=function(){this.j||(this.A||this.l||this.g?Bn(this):this.Ta())},S.Ta=function(){Bn(this)},S.X=function(){try{return 2<Wn(this)?this.a.status:-1}catch(t){return-1}},S.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},S.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Pn(e)}},S.ua=function(){return this.h},S.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(S=Qn.prototype).ha=8,S.v=1,S.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ve(this,this.c,t,void 0),r=this.l;if(this.O&&(r?rt(r=et(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=nr(this,n,e),sn(i=tn(this.B),"RID",t),sn(i,"CVER",22),this.A&&sn(i,"X-HTTP-Session-Id",this.A),er(this,i),this.i&&r&&Kn(i,this.i,r),Dn(this.b,n),this.Ga&&sn(i,"TYPE","init"),this.da?(sn(i,"$req",e),sn(i,"SID","null"),n.V=!0,je(n,i,null)):je(n,i,e),this.v=2}}else 3==this.v&&(t?tr(this,t):0==this.g.length||Nn(this.b)||tr(this))},S.Aa=function(){var t;this.j=null,sr(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Te(M(this.Sa,this),t))},S.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Xn(this),sr(this))},S.Ra=function(){null!=this.m&&(this.m=null,Xn(this),ir(this),Ee())},S.Xa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),Ee()},(S=dr.prototype).ta=function(){},S.sa=function(){},S.ra=function(){},S.qa=function(){},S.Ha=function(){},vr.prototype.a=function(t,e){return new yr(t,e)},q(yr,zt),(S=yr.prototype).addEventListener=function(t,e,n,r){yr.S.addEventListener.call(this,t,e,n,r)},S.removeEventListener=function(t,e,n,r){yr.S.removeEventListener.call(this,t,e,n,r)},S.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;Ee(),t.fa=e,t.W=n||{},t.H=t.T,t.B=lr(t,null,t.fa),Zn(t)},S.close=function(){Yn(this.a)},S.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Jn(this.a,e)):this.g?((e={}).__data__=Kt(t),Jn(this.a,e)):Jn(this.a,t)},S.G=function(){this.a.f=null,delete this.f,Yn(this.a),delete this.a,yr.S.G.call(this)},q(gr,ke),q(mr,Le),q(wr,dr),wr.prototype.ta=function(){this.a.dispatchEvent("a")},wr.prototype.sa=function(t){this.a.dispatchEvent(new gr(t))},wr.prototype.ra=function(t){this.a.dispatchEvent(new mr)},wr.prototype.qa=function(){this.a.dispatchEvent("b")},vr.prototype.createWebChannel=vr.prototype.a,yr.prototype.send=yr.prototype.Pa,yr.prototype.open=yr.prototype.Oa,Ne.NO_ERROR=0,Ne.TIMEOUT=8,Ne.HTTP_ERROR=6,Ae.COMPLETE="complete",(Oe.EventType=Re).OPEN="a",Re.CLOSE="b",Re.ERROR="c",Re.MESSAGE="d",zt.prototype.listen=zt.prototype.va,Vn.prototype.listenOnce=Vn.prototype.wa,Vn.prototype.getLastError=Vn.prototype.Qa,Vn.prototype.getLastErrorCode=Vn.prototype.ua,Vn.prototype.getStatus=Vn.prototype.X,Vn.prototype.getResponseJson=Vn.prototype.Na,Vn.prototype.getResponseText=Vn.prototype.$,Vn.prototype.send=Vn.prototype.ba;var br={createWebChannelTransport:function(){return new vr},ErrorCode:Ne,EventType:Ae,WebChannel:Oe,XhrIo:Vn},Ir=br.createWebChannelTransport,Er=br.ErrorCode,_r=br.EventType,Tr=br.WebChannel,Nr=br.XhrIo,Ar=(Sr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Sr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Sr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Sr);function Sr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Dr,Or={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},xr=(o(Lr,Dr=Error),Lr),Rr="7.21.1-eap-auth-emulator.8fbbe234f",kr=new p("@firebase/firestore");function Lr(t,e){var n=this;return(n=Dr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Pr(){return kr.logLevel}function Vr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];kr.logLevel<=l.DEBUG&&(e=n.map(Mr),kr.debug.apply(kr,s(["Firestore ("+Rr+"): "+t],e)))}function Cr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];kr.logLevel<=l.ERROR&&(e=n.map(Mr),kr.error.apply(kr,s(["Firestore ("+Rr+"): "+t],e)))}function Ur(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];kr.logLevel<=l.WARN&&(e=n.map(Mr),kr.warn.apply(kr,s(["Firestore ("+Rr+"): "+t],e)))}function Mr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function jr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+Rr+") INTERNAL ASSERTION FAILED: "+t;throw Cr(e),new Error(e)}function Fr(t){t||jr()}function qr(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Br(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Gr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var zr,Wr,Kr=(Object.defineProperty(ti.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),ti.prototype.isEqual=function(t){return 0===ti.i(this,t)},ti.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ti?t.forEach(function(t){e.push(t)}):e.push(t),this.o(e)},ti.prototype.limit=function(){return this.offset+this.length},ti.prototype.u=function(t){return t=void 0===t?1:t,this.o(this.segments,this.offset+t,this.length-t)},ti.prototype.h=function(){return this.o(this.segments,this.offset,this.length-1)},ti.prototype.l=function(){return this.segments[this.offset]},ti.prototype._=function(){return this.get(this.length-1)},ti.prototype.get=function(t){return this.segments[this.offset+t]},ti.prototype.m=function(){return 0===this.length},ti.prototype.T=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ti.prototype.I=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ti.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ti.prototype.A=function(){return this.segments.slice(this.offset,this.limit())},ti.i=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ti),Hr=(o(Zr,Wr=Kr),Zr.prototype.o=function(t,e,n){return new Zr(t,e,n)},Zr.prototype.R=function(){return this.A().join("/")},Zr.prototype.toString=function(){return this.R()},Zr.P=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new xr(Or.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new Zr(n)},Zr.g=function(){return new Zr([])},Zr),Qr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Yr=(o(Jr,zr=Kr),Jr.prototype.o=function(t,e,n){return new Jr(t,e,n)},Jr.V=function(t){return Qr.test(t)},Jr.prototype.R=function(){return this.A().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),Jr.V(t)||(t="`"+t+"`"),t}).join(".")},Jr.prototype.toString=function(){return this.R()},Jr.prototype.p=function(){return 1===this.length&&"__name__"===this.get(0)},Jr.v=function(){return new Jr(["__name__"])},Jr.S=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new xr(Or.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new xr(Or.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new xr(Or.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new xr(Or.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Jr(e)},Jr.g=function(){return new Jr([])},Jr),Xr=($r.D=function(t){return new $r(Hr.P(t))},$r.C=function(t){return new $r(Hr.P(t).u(5))},$r.prototype.N=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},$r.prototype.isEqual=function(t){return null!==t&&0===Hr.i(this.path,t.path)},$r.prototype.toString=function(){return this.path.toString()},$r.i=function(t,e){return Hr.i(t.path,e.path)},$r.F=function(t){return t.length%2==0},$r.$=function(t){return new $r(new Hr(t.slice()))},$r);function $r(t){this.path=t}function Jr(){return null!==zr&&zr.apply(this,arguments)||this}function Zr(){return null!==Wr&&Wr.apply(this,arguments)||this}function ti(t,e,n){void 0===e?e=0:e>t.length&&jr(),void 0===n?n=t.length-e:n>t.length-e&&jr(),this.segments=t,this.offset=e,this.t=n}function ei(t,e){if(0!==e.length)throw new xr(Or.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+wi(e.length,"argument")+".")}function ni(t,e,n){if(e.length!==n)throw new xr(Or.INVALID_ARGUMENT,"Function "+t+"() requires "+wi(n,"argument")+", but was called with "+wi(e.length,"argument")+".")}function ri(t,e,n){if(e.length<n)throw new xr(Or.INVALID_ARGUMENT,"Function "+t+"() requires at least "+wi(n,"argument")+", but was called with "+wi(e.length,"argument")+".")}function ii(t,e,n,r){if(e.length<n||e.length>r)throw new xr(Or.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+wi(e.length,"argument")+".")}function oi(t,e,n,r){fi(t,e,mi(n)+" argument",r)}function si(t,e,n,r){void 0!==r&&oi(t,e,n,r)}function ui(t,e,n,r){fi(t,e,n+" option",r)}function ai(t,e,n,r){void 0!==r&&ui(t,e,n,r)}function ci(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(pi(s))}var u=pi(n);throw new xr(Or.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function hi(t,e,n,r){if(!e.some(function(t){return t===r}))throw new xr(Or.INVALID_ARGUMENT,"Invalid value "+pi(r)+" provided to function "+t+"() for its "+mi(n)+" argument. Acceptable values: "+e.join(", "));return r}function fi(t,e,n,r){if(!("object"===e?li(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=pi(r);throw new xr(Or.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function li(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function pi(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":jr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function di(t,e,n){if(void 0===n)throw new xr(Or.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+mi(e)+" argument, but it was undefined.")}function vi(n,t,r){Br(t,function(t,e){if(r.indexOf(t)<0)throw new xr(Or.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function yi(t,e,n,r){var i=pi(r);return new xr(Or.INVALID_ARGUMENT,"Function "+t+"() requires its "+mi(n)+" argument to be a "+e+", but it was: "+i)}function gi(t,e,n){if(n<=0)throw new xr(Or.INVALID_ARGUMENT,"Function "+t+"() requires its "+mi(e)+" argument to be a positive number, but it was: "+n+".")}function mi(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function wi(t,e){return t+" "+e+(1===t?"":"s")}var bi=(Ii.k=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Ii);function Ii(){}function Ei(t,e){return t<e?-1:e<t?1:0}function _i(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Ti(t){return t+"\0"}var Ni=(Ai.fromBase64String=function(t){return new Ai(atob(t))},Ai.fromUint8Array=function(t){return new Ai(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Ai.prototype.toBase64=function(){return t=this.M,btoa(t);var t},Ai.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.M)},Ai.prototype.O=function(){return 2*this.M.length},Ai.prototype.L=function(t){return Ei(this.M,t.M)},Ai.prototype.isEqual=function(t){return this.M===t.M},Ai);function Ai(t){this.M=t}Ni.B=new Ni("");var Si=(Di.fromBase64String=function(t){try{return new Di(Ni.fromBase64String(t))}catch(t){throw new xr(Or.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},Di.fromUint8Array=function(t){return new Di(Ni.fromUint8Array(t))},Di.prototype.toBase64=function(){return this.q.toBase64()},Di.prototype.toUint8Array=function(){return this.q.toUint8Array()},Di.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Di.prototype.isEqual=function(t){return this.q.isEqual(t.q)},Di);function Di(t){this.q=t}function Oi(){if("undefined"==typeof Uint8Array)throw new xr(Or.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function xi(){if("undefined"==typeof atob)throw new xr(Or.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function Ri(t,e,n,r,i){this.U=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var ki,Li=(o(Bi,ki=Si),Bi.fromBase64String=function(t){ni("Blob.fromBase64String",arguments,1),oi("Blob.fromBase64String","string",1,t),xi();try{return new Bi(Ni.fromBase64String(t))}catch(t){throw new xr(Or.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Bi.fromUint8Array=function(t){if(ni("Blob.fromUint8Array",arguments,1),Oi(),!(t instanceof Uint8Array))throw yi("Blob.fromUint8Array","Uint8Array",1,t);return new Bi(Ni.fromUint8Array(t))},Bi.prototype.toBase64=function(){return ni("Blob.toBase64",arguments,0),xi(),ki.prototype.toBase64.call(this)},Bi.prototype.toUint8Array=function(){return ni("Blob.toUint8Array",arguments,0),Oi(),ki.prototype.toUint8Array.call(this)},Bi.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Bi),Pi=(Object.defineProperty(qi.prototype,"W",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),qi.prototype.isEqual=function(t){return t instanceof qi&&t.projectId===this.projectId&&t.database===this.database},qi.prototype.L=function(t){return Ei(this.projectId,t.projectId)||Ei(this.database,t.database)},qi),Vi=(Fi.prototype.get=function(t){var e=this.j(t),n=this.G[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.K(s,t))return u}},Fi.prototype.has=function(t){return void 0!==this.get(t)},Fi.prototype.set=function(t,e){var n=this.j(t),r=this.G[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.K(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.G[n]=[[t,e]]},Fi.prototype.delete=function(t){var e=this.j(t),n=this.G[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.K(n[r][0],t))return 1===n.length?delete this.G[e]:n.splice(r,1),!0;return!1},Fi.prototype.forEach=function(u){Br(this.G,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];u(o,s)}})},Fi.prototype.m=function(){return Gr(this.G)},Fi),Ci=(ji.now=function(){return ji.fromMillis(Date.now())},ji.fromDate=function(t){return ji.fromMillis(t.getTime())},ji.fromMillis=function(t){var e=Math.floor(t/1e3);return new ji(e,1e6*(t-1e3*e))},ji.prototype.toDate=function(){return new Date(this.toMillis())},ji.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},ji.prototype.H=function(t){return this.seconds===t.seconds?Ei(this.nanoseconds,t.nanoseconds):Ei(this.seconds,t.seconds)},ji.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},ji.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},ji.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},ji.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},ji),Ui=(Mi.Y=function(t){return new Mi(t)},Mi.min=function(){return new Mi(new Ci(0,0))},Mi.prototype.L=function(t){return this.timestamp.H(t.timestamp)},Mi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Mi.prototype.J=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Mi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Mi.prototype.X=function(){return this.timestamp},Mi);function Mi(t){this.timestamp=t}function ji(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new xr(Or.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new xr(Or.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new xr(Or.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new xr(Or.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Fi(t,e){this.j=t,this.K=e,this.G={}}function qi(t,e){this.projectId=t,this.database=e||"(default)"}function Bi(){return null!==ki&&ki.apply(this,arguments)||this}function Gi(t){return null==t}function zi(t){return 0===t&&1/t==-1/0}function Wi(t){return"number"==typeof t&&Number.isInteger(t)&&!zi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Ki=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Z=null};function Hi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Ki(t,e,n,r,i,o,s)}function Qi(t){var e,n=t;return null===n.Z&&(e=n.path.R(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.R()+e.op.toString()+Yo(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.R()+e.dir;var e}).join(","),Gi(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=Da(n.startAt)),n.endAt&&(e+="|ub:",e+=Da(n.endAt)),n.Z=e),n.Z}function Yi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Wo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!xa(t.startAt,e.startAt)&&xa(t.endAt,e.endAt)}function Xi(t){return Xr.F(t.path)&&null===t.collectionGroup&&0===t.filters.length}function $i(t){this.count=t}var Ji,Zi,to=(eo.prototype.nt=function(t){return new eo(this.target,this.targetId,this.tt,t,this.et,this.lastLimboFreeSnapshotVersion,this.resumeToken)},eo.prototype.st=function(t,e){return new eo(this.target,this.targetId,this.tt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},eo.prototype.it=function(t){return new eo(this.target,this.targetId,this.tt,this.sequenceNumber,this.et,t,this.resumeToken)},eo);function eo(t,e,n,r,i,o,s){void 0===i&&(i=Ui.min()),void 0===o&&(o=Ui.min()),void 0===s&&(s=Ni.B),this.target=t,this.targetId=e,this.tt=n,this.sequenceNumber=r,this.et=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function no(t){switch(t){case Or.OK:return jr(),0;case Or.CANCELLED:case Or.UNKNOWN:case Or.DEADLINE_EXCEEDED:case Or.RESOURCE_EXHAUSTED:case Or.INTERNAL:case Or.UNAVAILABLE:case Or.UNAUTHENTICATED:return;case Or.INVALID_ARGUMENT:case Or.NOT_FOUND:case Or.ALREADY_EXISTS:case Or.PERMISSION_DENIED:case Or.FAILED_PRECONDITION:case Or.ABORTED:case Or.OUT_OF_RANGE:case Or.UNIMPLEMENTED:case Or.DATA_LOSS:return 1;default:return jr(),0}}function ro(t){if(void 0===t)return Cr("GRPC error has no .code"),Or.UNKNOWN;switch(t){case Ji.OK:return Or.OK;case Ji.CANCELLED:return Or.CANCELLED;case Ji.UNKNOWN:return Or.UNKNOWN;case Ji.DEADLINE_EXCEEDED:return Or.DEADLINE_EXCEEDED;case Ji.RESOURCE_EXHAUSTED:return Or.RESOURCE_EXHAUSTED;case Ji.INTERNAL:return Or.INTERNAL;case Ji.UNAVAILABLE:return Or.UNAVAILABLE;case Ji.UNAUTHENTICATED:return Or.UNAUTHENTICATED;case Ji.INVALID_ARGUMENT:return Or.INVALID_ARGUMENT;case Ji.NOT_FOUND:return Or.NOT_FOUND;case Ji.ALREADY_EXISTS:return Or.ALREADY_EXISTS;case Ji.PERMISSION_DENIED:return Or.PERMISSION_DENIED;case Ji.FAILED_PRECONDITION:return Or.FAILED_PRECONDITION;case Ji.ABORTED:return Or.ABORTED;case Ji.OUT_OF_RANGE:return Or.OUT_OF_RANGE;case Ji.UNIMPLEMENTED:return Or.UNIMPLEMENTED;case Ji.DATA_LOSS:return Or.DATA_LOSS;default:return jr()}}(Zi=Ji=Ji||{})[Zi.OK=0]="OK",Zi[Zi.CANCELLED=1]="CANCELLED",Zi[Zi.UNKNOWN=2]="UNKNOWN",Zi[Zi.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Zi[Zi.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Zi[Zi.NOT_FOUND=5]="NOT_FOUND",Zi[Zi.ALREADY_EXISTS=6]="ALREADY_EXISTS",Zi[Zi.PERMISSION_DENIED=7]="PERMISSION_DENIED",Zi[Zi.UNAUTHENTICATED=16]="UNAUTHENTICATED",Zi[Zi.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Zi[Zi.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Zi[Zi.ABORTED=10]="ABORTED",Zi[Zi.OUT_OF_RANGE=11]="OUT_OF_RANGE",Zi[Zi.UNIMPLEMENTED=12]="UNIMPLEMENTED",Zi[Zi.INTERNAL=13]="INTERNAL",Zi[Zi.UNAVAILABLE=14]="UNAVAILABLE",Zi[Zi.DATA_LOSS=15]="DATA_LOSS";var io=(co.prototype.rt=function(t,e){return new co(this.i,this.root.rt(t,e,this.i).copy(null,null,so.ot,null,null))},co.prototype.remove=function(t){return new co(this.i,this.root.remove(t,this.i).copy(null,null,so.ot,null,null))},co.prototype.get=function(t){for(var e=this.root;!e.m();){var n=this.i(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},co.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.m();){var r=this.i(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},co.prototype.m=function(){return this.root.m()},Object.defineProperty(co.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),co.prototype.at=function(){return this.root.at()},co.prototype.ct=function(){return this.root.ct()},co.prototype.ut=function(t){return this.root.ut(t)},co.prototype.forEach=function(n){this.ut(function(t,e){return n(t,e),!1})},co.prototype.toString=function(){var n=[];return this.ut(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},co.prototype.ht=function(t){return this.root.ht(t)},co.prototype.lt=function(){return new oo(this.root,null,this.i,!1)},co.prototype._t=function(t){return new oo(this.root,t,this.i,!1)},co.prototype.ft=function(){return new oo(this.root,null,this.i,!0)},co.prototype.dt=function(t){return new oo(this.root,t,this.i,!0)},co),oo=(ao.prototype.Et=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.m();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.m();)this.Tt.push(t),t=t.left;return e},ao.prototype.It=function(){return 0<this.Tt.length},ao.prototype.At=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},ao),so=(uo.prototype.copy=function(t,e,n,r,i){return new uo(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},uo.prototype.m=function(){return!1},uo.prototype.ut=function(t){return this.left.ut(t)||t(this.key,this.value)||this.right.ut(t)},uo.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},uo.prototype.min=function(){return this.left.m()?this:this.left.min()},uo.prototype.at=function(){return this.min().key},uo.prototype.ct=function(){return this.right.m()?this.key:this.right.ct()},uo.prototype.rt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.rt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.rt(t,e,n))).Rt()},uo.prototype.Pt=function(){if(this.left.m())return uo.EMPTY;var t=this;return t.left.gt()||t.left.left.gt()||(t=t.yt()),(t=t.copy(null,null,null,t.left.Pt(),null)).Rt()},uo.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.m()||r.left.gt()||r.left.left.gt()||(r=r.yt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.gt()&&(r=r.Vt()),r.right.m()||r.right.gt()||r.right.left.gt()||(r=r.bt()),0===e(t,r.key)){if(r.right.m())return uo.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Pt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Rt()},uo.prototype.gt=function(){return this.color},uo.prototype.Rt=function(){var t=this;return t.right.gt()&&!t.left.gt()&&(t=t.vt()),t.left.gt()&&t.left.left.gt()&&(t=t.Vt()),t.left.gt()&&t.right.gt()&&(t=t.St()),t},uo.prototype.yt=function(){var t=this.St();return t.right.left.gt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Vt())).vt()).St()),t},uo.prototype.bt=function(){var t=this.St();return t.left.left.gt()&&(t=(t=t.Vt()).St()),t},uo.prototype.vt=function(){var t=this.copy(null,null,uo.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},uo.prototype.Vt=function(){var t=this.copy(null,null,uo.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},uo.prototype.St=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},uo.prototype.Dt=function(){var t=this.Ct();return Math.pow(2,t)<=this.size+1},uo.prototype.Ct=function(){if(this.gt()&&this.left.gt())throw jr();if(this.right.gt())throw jr();var t=this.left.Ct();if(t!==this.right.Ct())throw jr();return t+(this.gt()?0:1)},uo);function uo(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:uo.RED,this.left=null!=r?r:uo.EMPTY,this.right=null!=i?i:uo.EMPTY,this.size=this.left.size+1+this.right.size}function ao(t,e,n,r){this.wt=r,this.Tt=[];for(var i=1;!t.m();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.wt?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.wt?t.right:t.left}}function co(t,e){this.i=t,this.root=e||so.EMPTY}function ho(){this.size=0}so.EMPTY=null,so.RED=!0,so.ot=!1,so.EMPTY=(Object.defineProperty(ho.prototype,"key",{get:function(){throw jr()},enumerable:!1,configurable:!0}),Object.defineProperty(ho.prototype,"value",{get:function(){throw jr()},enumerable:!1,configurable:!0}),Object.defineProperty(ho.prototype,"color",{get:function(){throw jr()},enumerable:!1,configurable:!0}),Object.defineProperty(ho.prototype,"left",{get:function(){throw jr()},enumerable:!1,configurable:!0}),Object.defineProperty(ho.prototype,"right",{get:function(){throw jr()},enumerable:!1,configurable:!0}),ho.prototype.copy=function(t,e,n,r,i){return this},ho.prototype.rt=function(t,e,n){return new so(t,e)},ho.prototype.remove=function(t,e){return this},ho.prototype.m=function(){return!0},ho.prototype.ut=function(t){return!1},ho.prototype.ht=function(t){return!1},ho.prototype.at=function(){return null},ho.prototype.ct=function(){return null},ho.prototype.gt=function(){return!1},ho.prototype.Dt=function(){return!0},ho.prototype.Ct=function(){return 0},new ho);var fo=(yo.prototype.has=function(t){return null!==this.data.get(t)},yo.prototype.first=function(){return this.data.at()},yo.prototype.last=function(){return this.data.ct()},Object.defineProperty(yo.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),yo.prototype.indexOf=function(t){return this.data.indexOf(t)},yo.prototype.forEach=function(n){this.data.ut(function(t,e){return n(t),!1})},yo.prototype.Nt=function(t,e){for(var n=this.data._t(t[0]);n.It();){var r=n.Et();if(0<=this.i(r.key,t[1]))return;e(r.key)}},yo.prototype.Ft=function(t,e){for(var n=void 0!==e?this.data._t(e):this.data.lt();n.It();)if(!t(n.Et().key))return},yo.prototype.$t=function(t){var e=this.data._t(t);return e.It()?e.Et().key:null},yo.prototype.lt=function(){return new lo(this.data.lt())},yo.prototype._t=function(t){return new lo(this.data._t(t))},yo.prototype.add=function(t){return this.copy(this.data.remove(t).rt(t,!0))},yo.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},yo.prototype.m=function(){return this.data.m()},yo.prototype.xt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},yo.prototype.isEqual=function(t){if(!(t instanceof yo))return!1;if(this.size!==t.size)return!1;for(var e=this.data.lt(),n=t.data.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(0!==this.i(r,i))return!1}return!0},yo.prototype.A=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},yo.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},yo.prototype.copy=function(t){var e=new yo(this.i);return e.data=t,e},yo),lo=(vo.prototype.Et=function(){return this.kt.Et().key},vo.prototype.It=function(){return this.kt.It()},vo),po=new io(Xr.i);function vo(t){this.kt=t}function yo(t){this.i=t,this.data=new io(this.i)}var go=new io(Xr.i),mo=new io(Xr.i),wo=new fo(Xr.i);function bo(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=wo,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Io=new fo(Ei),Eo=(Mo.Lt=function(t){return new Mo(t.i)},Mo.prototype.has=function(t){return null!=this.Mt.get(t)},Mo.prototype.get=function(t){return this.Mt.get(t)},Mo.prototype.first=function(){return this.Ot.at()},Mo.prototype.last=function(){return this.Ot.ct()},Mo.prototype.m=function(){return this.Ot.m()},Mo.prototype.indexOf=function(t){var e=this.Mt.get(t);return e?this.Ot.indexOf(e):-1},Object.defineProperty(Mo.prototype,"size",{get:function(){return this.Ot.size},enumerable:!1,configurable:!0}),Mo.prototype.forEach=function(n){this.Ot.ut(function(t,e){return n(t),!1})},Mo.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Mt.rt(t.key,t),e.Ot.rt(t,null))},Mo.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Mt.remove(t),this.Ot.remove(e)):this},Mo.prototype.isEqual=function(t){if(!(t instanceof Mo))return!1;if(this.size!==t.size)return!1;for(var e=this.Ot.lt(),n=t.Ot.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(!r.isEqual(i))return!1}return!0},Mo.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Mo.prototype.copy=function(t,e){var n=new Mo;return n.i=this.i,n.Mt=t,n.Ot=e,n},Mo),_o=(Uo.prototype.track=function(t){var e=t.doc.key,n=this.Bt.get(e);!n||0!==t.type&&3===n.type?this.Bt=this.Bt.rt(e,t):3===t.type&&1!==n.type?this.Bt=this.Bt.rt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Bt=this.Bt.rt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Bt=this.Bt.remove(e):1===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):jr()},Uo.prototype.qt=function(){var n=[];return this.Bt.ut(function(t,e){n.push(e)}),n},Uo),To=(Co.Kt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Co(t,e,Eo.Lt(e),i,n,r,!0,!1)},Object.defineProperty(Co.prototype,"hasPendingWrites",{get:function(){return!this.Qt.m()},enumerable:!1,configurable:!0}),Co.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Wt===t.Wt&&this.Qt.isEqual(t.Qt)&&$u(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ut.isEqual(t.Ut)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Co),No=(Vo.Jt=function(t,e){var n=new Map;return n.set(t,Ao.Xt(t,e)),new Vo(Ui.min(),n,Io,po,bo())},Vo),Ao=(Po.Xt=function(t,e){return new Po(Ni.B,e,bo(),bo(),bo())},Po),So=function(t,e,n,r){this.se=t,this.removedTargetIds=e,this.key=n,this.ie=r},Do=function(t,e){this.targetId=t,this.re=e},Oo=function(t,e,n,r){void 0===n&&(n=Ni.B),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},xo=(Object.defineProperty(Lo.prototype,"Zt",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(Lo.prototype,"resumeToken",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(Lo.prototype,"le",{get:function(){return 0!==this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(Lo.prototype,"_e",{get:function(){return this.he},enumerable:!1,configurable:!0}),Lo.prototype.fe=function(t){0<t.O()&&(this.he=!0,this.ce=t)},Lo.prototype.de=function(){var n=bo(),r=bo(),i=bo();return this.ae.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:jr()}}),new Ao(this.ce,this.ue,n,r,i)},Lo.prototype.we=function(){this.he=!1,this.ae=Fo()},Lo.prototype.me=function(t,e){this.he=!0,this.ae=this.ae.rt(t,e)},Lo.prototype.Te=function(t){this.he=!0,this.ae=this.ae.remove(t)},Lo.prototype.Ee=function(){this.oe+=1},Lo.prototype.Ie=function(){--this.oe},Lo.prototype.Ae=function(){this.he=!0,this.ue=!0},Lo),Ro=(ko.prototype.pe=function(t){for(var e=0,n=t.se;e<n.length;e++){var r=n[e];t.ie instanceof ku?this.be(r,t.ie):t.ie instanceof Lu&&this.ve(r,t.key,t.ie)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.ve(s,t.key,t.ie)}},ko.prototype.Se=function(n){var r=this;this.De(n,function(t){var e=r.Ce(t);switch(n.state){case 0:r.Ne(t)&&e.fe(n.resumeToken);break;case 1:e.Ie(),e.le||e.we(),e.fe(n.resumeToken);break;case 2:e.Ie(),e.le||r.removeTarget(t);break;case 3:r.Ne(t)&&(e.Ae(),e.fe(n.resumeToken));break;case 4:r.Ne(t)&&(r.Fe(t),e.fe(n.resumeToken));break;default:jr()}})},ko.prototype.De=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Pe.forEach(function(t,e){r.Ne(e)&&n(e)})},ko.prototype.$e=function(t){var e,n,r=t.targetId,i=t.re.count,o=this.xe(r);o&&(Xi(e=o.target)?0===i?(n=new Xr(e.path),this.ve(r,n,new Lu(n,Ui.min()))):Fr(1===i):this.ke(r)!==i&&(this.Fe(r),this.Ve=this.Ve.add(r)))},ko.prototype.Me=function(i){var o=this,s=new Map;this.Pe.forEach(function(t,e){var n,r=o.xe(e);r&&(t.Zt&&Xi(r.target)&&(n=new Xr(r.target.path),null!==o.ge.get(n)||o.Oe(e,n)||o.ve(e,n,new Lu(n,i))),t._e&&(s.set(e,t.de()),t.we()))});var r=bo();this.ye.forEach(function(t,e){var n=!0;e.Ft(function(t){var e=o.xe(t);return!e||2===e.tt||(n=!1)}),n&&(r=r.add(t))});var t=new No(i,s,this.Ve,this.ge,r);return this.ge=po,this.ye=jo(),this.Ve=new fo(Ei),t},ko.prototype.be=function(t,e){var n;this.Ne(t)&&(n=this.Oe(t,e.key)?2:0,this.Ce(t).me(e.key,n),this.ge=this.ge.rt(e.key,e),this.ye=this.ye.rt(e.key,this.Le(e.key).add(t)))},ko.prototype.ve=function(t,e,n){var r;this.Ne(t)&&(r=this.Ce(t),this.Oe(t,e)?r.me(e,1):r.Te(e),this.ye=this.ye.rt(e,this.Le(e).delete(t)),n&&(this.ge=this.ge.rt(e,n)))},ko.prototype.removeTarget=function(t){this.Pe.delete(t)},ko.prototype.ke=function(t){var e=this.Ce(t).de();return this.Re.Be(t).size+e.te.size-e.ne.size},ko.prototype.Ee=function(t){this.Ce(t).Ee()},ko.prototype.Ce=function(t){var e=this.Pe.get(t);return e||(e=new xo,this.Pe.set(t,e)),e},ko.prototype.Le=function(t){var e=this.ye.get(t);return e||(e=new fo(Ei),this.ye=this.ye.rt(t,e)),e},ko.prototype.Ne=function(t){var e=null!==this.xe(t);return e||Vr("WatchChangeAggregator","Detected inactive target",t),e},ko.prototype.xe=function(t){var e=this.Pe.get(t);return e&&e.le?null:this.Re.qe(t)},ko.prototype.Fe=function(e){var n=this;this.Pe.set(e,new xo),this.Re.Be(e).forEach(function(t){n.ve(e,t,null)})},ko.prototype.Oe=function(t,e){return this.Re.Be(t).has(e)},ko);function ko(t){this.Re=t,this.Pe=new Map,this.ge=po,this.ye=jo(),this.Ve=new fo(Ei)}function Lo(){this.oe=0,this.ae=Fo(),this.ce=Ni.B,this.ue=!1,this.he=!0}function Po(t,e,n,r,i){this.resumeToken=t,this.Zt=e,this.te=n,this.ee=r,this.ne=i}function Vo(t,e,n,r,i){this.et=t,this.Gt=e,this.zt=n,this.Ht=r,this.Yt=i}function Co(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Ut=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.Wt=s,this.jt=u}function Uo(){this.Bt=new io(Xr.i)}function Mo(n){this.i=n?function(t,e){return n(t,e)||Xr.i(t.key,e.key)}:function(t,e){return Xr.i(t.key,e.key)},this.Mt=go,this.Ot=new io(this.i)}function jo(){return new io(Xr.i)}function Fo(){return new io(Xr.i)}function qo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Bo(t){var e=Xo(t.mapValue.fields.__local_write_time__.timestampValue);return new Ci(e.seconds,e.nanos)}var Go=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function zo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?qo(t)?4:10:jr()}function Wo(r,i){var t,e,n,o=zo(r);if(o!==zo(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return Bo(r).isEqual(Bo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Xo(r.timestampValue),n=Xo(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return n=i,Jo(r.bytesValue).isEqual(Jo(n.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,$o((t=r).geoPointValue.latitude)===$o(e.geoPointValue.latitude)&&$o(t.geoPointValue.longitude)===$o(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return $o(t.integerValue)===$o(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=$o(t.doubleValue),r=$o(e.doubleValue);return n===r?zi(n)===zi(r):isNaN(n)&&isNaN(r)}return!1}(r,i);case 9:return _i(r.arrayValue.values||[],i.arrayValue.values||[],Wo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(qr(e)!==qr(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Wo(e[t],n[t])))return!1;return!0}();default:return jr()}}function Ko(t,e){return void 0!==(t.values||[]).find(function(t){return Wo(t,e)})}function Ho(t,e){var n,r,i,o,s,u,a,c,h,f,l=zo(t),p=zo(e);if(l!==p)return Ei(l,p);switch(l){case 0:return 0;case 1:return Ei(t.booleanValue,e.booleanValue);case 2:return c=e,(h=$o(t.integerValue||t.doubleValue))<(f=$o(c.integerValue||c.doubleValue))?-1:f<h?1:h===f?0:isNaN(h)?isNaN(f)?0:-1:1;case 3:return Qo(t.timestampValue,e.timestampValue);case 4:return Qo(Bo(t),Bo(e));case 5:return Ei(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=Jo(o),a=Jo(s),u.L(a);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Ei(n[i],r[i]);if(0!==o)return o}return Ei(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=Ei($o(n.latitude),$o(r.latitude)))?i:Ei($o(n.longitude),$o(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Ho(n[i],r[i]);if(o)return o}return Ei(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Ei(r[s],o[s]);if(0!==u)return u;var a=Ho(n[r[s]],i[o[s]]);if(0!==a)return a}return Ei(r.length,o.length)}(t.mapValue,e.mapValue);default:throw jr()}}function Qo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ei(t,e);var n=Xo(t),r=Xo(e),i=Ei(n.seconds,r.seconds);return 0!==i?i:Ei(n.nanos,r.nanos)}function Yo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=Xo(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?Jo(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,Xr.C(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):jr();var t,e,n}(t)}function Xo(t){if(Fr(!!t),"string"!=typeof t)return{seconds:$o(t.seconds),nanos:$o(t.nanos)};var e,n=0,r=Go.exec(t);Fr(!!r),r[1]&&(e=((e=r[1])+"000000000").substr(0,9),n=Number(e));var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:n}}function $o(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Jo(t){return"string"==typeof t?Ni.fromBase64String(t):Ni.fromUint8Array(t)}function Zo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.R()}}function ts(t){return t&&"integerValue"in t}function es(t){return!!t&&"arrayValue"in t}function ns(t){return t&&"nullValue"in t}function rs(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function is(t){return t&&"mapValue"in t}var os={asc:"ASCENDING",desc:"DESCENDING"},ss={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},us=function(t,e){this.U=t,this.Ue=e};function as(t){return{integerValue:""+t}}function cs(t,e){if(t.Ue){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:zi(e)?"-0":e}}function hs(t,e){return Wi(e)?as(e):cs(t,e)}function fs(t,e){return t.Ue?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function ls(t,e){return t.Ue?e.toBase64():e.toUint8Array()}function ps(t){return Fr(!!t),Ui.Y((e=Xo(t),new Ci(e.seconds,e.nanos)));var e}function ds(t,e){return new Hr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).R()}function vs(t){var e=Hr.P(t);return Fr(Rs(e)),e}function ys(t,e){return ds(t.U,e.path)}function gs(t,e){var n=vs(e);return Fr(n.get(1)===t.U.projectId),Fr(!n.get(3)&&!t.U.database||n.get(3)===t.U.database),new Xr(Is(n))}function ms(t,e){return ds(t.U,e)}function ws(t){var e=vs(t);return 4===e.length?Hr.g():Is(e)}function bs(t){return new Hr(["projects",t.U.projectId,"databases",t.U.database]).R()}function Is(t){return Fr(4<t.length&&"documents"===t.get(4)),t.u(5)}function Es(t,e,n){return{name:ys(t,e),fields:n.proto.mapValue.fields}}function _s(t,e){var n,r,i,o;if(e instanceof cu)n={update:Es(t,e.key,e.value)};else if(e instanceof bu)n={delete:ys(t,e.key)};else if(e instanceof hu)n={update:Es(t,e.key,e.data),updateMask:(r=e.Qe,i=[],r.fields.forEach(function(t){return i.push(t.R())}),{fieldPaths:i})};else if(e instanceof vu)n={transform:{document:ys(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Cs)return{fieldPath:t.field.R(),setToServerValue:"REQUEST_TIME"};if(e instanceof Us)return{fieldPath:t.field.R(),appendMissingElements:{values:e.elements}};if(e instanceof Bs)return{fieldPath:t.field.R(),removeAllFromArray:{values:e.elements}};if(e instanceof Ks)return{fieldPath:t.field.R(),increment:e.We};throw jr()})}};else{if(!(e instanceof Iu))return jr();n={verify:ys(t,e.key)}}return e.Ke.je||(n.currentDocument=void 0!==(o=e.Ke).updateTime?{updateTime:fs(t,o.updateTime.X())}:void 0!==o.exists?{exists:o.exists}:jr()),n}function Ts(e,t){var n,r,i=t.currentDocument?void 0!==(n=t.currentDocument).updateTime?tu.updateTime(ps(n.updateTime)):void 0!==n.exists?tu.exists(n.exists):tu.Ge():tu.Ge();if(t.update){t.update.name;var o=gs(e,t.update.name),s=new Eu({mapValue:{fields:t.update.fields}});if(t.updateMask){var u=(r=t.updateMask.fieldPaths||[],new Xs(r.map(function(t){return Yr.S(t)})));return new hu(o,s,u,i)}return new cu(o,s,i)}if(t.delete){var a=gs(e,t.delete);return new bu(a,i)}if(t.transform){var c=gs(e,t.transform.document),h=t.transform.fieldTransforms.map(function(t){return function(t,e){var n,r,i=null;"setToServerValue"in e?(Fr("REQUEST_TIME"===e.setToServerValue),i=new Cs):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],i=new Us(n)):"removeAllFromArray"in e?(r=e.removeAllFromArray.values||[],i=new Bs(r)):"increment"in e?i=new Ks(t,e.increment):jr();var o=Yr.S(e.fieldPath);return new $s(o,i)}(e,t)});return Fr(!0===i.exists),new vu(c,h)}if(t.verify){var f=gs(e,t.verify);return new Iu(f,i)}return jr()}function Ns(t,e){return{documents:[ms(t,e.path)]}}function As(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=ms(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=ms(t,r.h()),n.structuredQuery.from=[{collectionId:r._()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){if("=="===t.op){if(rs(t.value))return{unaryFilter:{field:Os(t.field),op:"IS_NAN"}};if(ns(t.value))return{unaryFilter:{field:Os(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(rs(t.value))return{unaryFilter:{field:Os(t.field),op:"IS_NOT_NAN"}};if(ns(t.value))return{unaryFilter:{field:Os(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Os(t.field),op:(e=t.op,ss[e]),value:t.value}};var e});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:Os((e=t).field),direction:(n=e.dir,os[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,u=(s=e.limit,t.Ue||Gi(s)?s:{value:s});return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=Ss(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Ss(e.endAt)),n}function Ss(t){return{before:t.before,values:t.position}}function Ds(t){var e=!!t.before,n=t.values||[];return new _a(n,e)}function Os(t){return{fieldPath:t.R()}}function xs(t){return Yr.S(t.fieldPath)}function Rs(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function ks(){this.ze=void 0}function Ls(t,e){return t instanceof Ks?ts(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var Ps,Vs,Cs=(o(js,Vs=ks),js),Us=(o(Ms,Ps=ks),Ms);function Ms(t){var e=this;return(e=Ps.call(this)||this).elements=t,e}function js(){return null!==Vs&&Vs.apply(this,arguments)||this}function Fs(t,e){for(var n=Ys(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Wo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var qs,Bs=(o(Gs,qs=ks),Gs);function Gs(t){var e=this;return(e=qs.call(this)||this).elements=t,e}function zs(t,e){for(var n=Ys(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Wo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var Ws,Ks=(o(Hs,Ws=ks),Hs);function Hs(t,e){var n=this;return(n=Ws.call(this)||this).serializer=t,n.We=e,n}function Qs(t){return $o(t.integerValue||t.doubleValue)}function Ys(t){return es(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Xs=(Js.prototype.He=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].T(t))return!0;return!1},Js.prototype.isEqual=function(t){return _i(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Js),$s=function(t,e){this.field=t,this.transform=e};function Js(t){(this.fields=t).sort(Yr.i)}function Zs(t,e){this.version=t,this.transformResults=e}var tu=(eu.Ge=function(){return new eu},eu.exists=function(t){return new eu(void 0,t)},eu.updateTime=function(t){return new eu(t)},Object.defineProperty(eu.prototype,"je",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),eu.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},eu);function eu(t,e){this.updateTime=t,this.exists=e}function nu(t,e){return void 0!==t.updateTime?e instanceof ku&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof ku}function ru(){}function iu(t,e,n,r){return t instanceof cu?function(t,e){if(!nu(t.Ke,e))return e;var n=su(e);return new ku(t.key,n,t.value,{Ye:!0})}(t,e):t instanceof hu?function(t,e){if(!nu(t.Ke,e))return e;var n=su(e),r=pu(t,e);return new ku(t.key,n,r,{Ye:!0})}(t,e):t instanceof vu?function(t,e,n,r){if(!nu(t.Ke,e))return e;var i=e,o=function(t,e,n,r){for(var i,o,s,u,a,c,h=[],f=0,l=t;f<l.length;f++){var p=l[f],d=p.transform,v=null;n instanceof ku&&(v=n.field(p.field)),null===v&&r instanceof ku&&(v=r.field(p.field)),h.push((o=v,c=a=u=s=void 0,(i=d)instanceof Cs?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},o&&(c.fields.__previous_value__=o),{mapValue:c}):i instanceof Us?Fs(i,o):i instanceof Bs?zs(i,o):(a=Qs(u=Ls(s=i,o))+Qs(s.We),ts(u)&&ts(s.We)?as(a):cs(s.serializer,a))))}return h}(t.fieldTransforms,n,e,r),s=gu(t,i.data(),o);return new ku(t.key,i.version,s,{Ye:!0})}(t,e,r,n):(o=e,nu((i=t).Ke,o)?new Lu(i.key,Ui.min()):o);var i,o}function ou(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ke.isEqual(e.Ke)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||_i(t.fieldTransforms,t.fieldTransforms,function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof Us&&o instanceof Us||i instanceof Bs&&o instanceof Bs?_i(i.elements,o.elements,Wo):i instanceof Ks&&o instanceof Ks?Wo(i.We,o.We):i instanceof Cs&&o instanceof Cs);var n,r,i,o}))}function su(t){return t instanceof ku?t.version:Ui.min()}var uu,au,cu=(o(lu,au=ru),lu),hu=(o(fu,uu=ru),fu);function fu(t,e,n,r){var i=this;return(i=uu.call(this)||this).key=t,i.data=e,i.Qe=n,i.Ke=r,i.type=1,i}function lu(t,e,n){var r=this;return(r=au.call(this)||this).key=t,r.value=e,r.Ke=n,r.type=0,r}function pu(t,e){return n=t,r=e instanceof ku?e.data():Eu.empty(),i=new _u(r),n.Qe.fields.forEach(function(t){var e;t.m()||(null!==(e=n.data.field(t))?i.set(t,e):i.delete(t))}),i.Je();var n,r,i}var du,vu=(o(yu,du=ru),yu);function yu(t,e){var n=this;return(n=du.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ke=tu.exists(!0),n}function gu(t,e,n){for(var r=new _u(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Je()}var mu,wu,bu=(o(Su,wu=ru),Su),Iu=(o(Au,mu=ru),Au),Eu=(Nu.empty=function(){return new Nu({mapValue:{}})},Nu.prototype.field=function(t){if(t.m())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!is(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t._()])||null},Nu.prototype.isEqual=function(t){return Wo(this.proto,t.proto)},Nu),_u=(Tu.prototype.set=function(t,e){return this.tn(t,e),this},Tu.prototype.delete=function(t){return this.tn(t,null),this},Tu.prototype.tn=function(t,e){for(var n=this.Ze,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===zo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t._(),e)},Tu.prototype.Je=function(){var t=this.en(Yr.g(),this.Ze);return null!=t?new Eu(t):this.Xe},Tu.prototype.en=function(r,t){var i=this,o=!1,e=this.Xe.field(r),s=is(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.en(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Tu);function Tu(t){void 0===t&&(t=Eu.empty()),this.Xe=t,this.Ze=new Map}function Nu(t){this.proto=t}function Au(t,e){var n=this;return(n=mu.call(this)||this).key=t,n.Ke=e,n.type=4,n}function Su(t,e){var n=this;return(n=wu.call(this)||this).key=t,n.Ke=e,n.type=3,n}function Du(t,e){this.key=t,this.version=e}var Ou,xu,Ru,ku=(o(Mu,Ru=Du),Mu.prototype.field=function(t){return this.nn.field(t)},Mu.prototype.data=function(){return this.nn},Mu.prototype.sn=function(){return this.nn.proto},Mu.prototype.isEqual=function(t){return t instanceof Mu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ye===t.Ye&&this.hasCommittedMutations===t.hasCommittedMutations&&this.nn.isEqual(t.nn)},Mu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.nn.toString()+", {hasLocalMutations: "+this.Ye+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Mu.prototype,"hasPendingWrites",{get:function(){return this.Ye||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Mu),Lu=(o(Uu,xu=Du),Uu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Uu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Uu.prototype.isEqual=function(t){return t instanceof Uu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Uu),Pu=(o(Cu,Ou=Du),Cu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Cu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Cu.prototype.isEqual=function(t){return t instanceof Cu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Cu),Vu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.rn=n,this.filters=r,this.limit=i,this.on=o,this.startAt=s,this.endAt=u,this.an=null,this.cn=null,this.startAt,this.endAt};function Cu(){return null!==Ou&&Ou.apply(this,arguments)||this}function Uu(t,e,n){var r=this;return(r=xu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Mu(t,e,n,r){var i=this;return(i=Ru.call(this,t,e)||this).nn=n,i.Ye=!!r.Ye,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function ju(t,e,n,r,i,o,s,u){return new Vu(t,e,n,r,i,o,s,u)}function Fu(t){return new Vu(t)}function qu(t){return!Gi(t.limit)&&"F"===t.on}function Bu(t){return!Gi(t.limit)&&"L"===t.on}function Gu(t){return 0<t.rn.length?t.rn[0].field:null}function zu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.un())return r.field}return null}function Wu(t){return null!==t.collectionGroup}function Ku(t){var e=t;if(null===e.an){e.an=[];var n=zu(e),r=Gu(e);if(null!==n&&null===r)n.p()||e.an.push(new Ra(n)),e.an.push(new Ra(Yr.v(),"asc"));else{for(var i,o=!1,s=0,u=e.rn;s<u.length;s++){var a=u[s];e.an.push(a),a.field.p()&&(o=!0)}o||(i=0<e.rn.length?e.rn[e.rn.length-1].dir:"asc",e.an.push(new Ra(Yr.v(),i)))}}return e.an}function Hu(t){var e=t;if(!e.cn)if("F"===e.on)e.cn=Hi(e.path,e.collectionGroup,Ku(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Ku(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Ra(o.field,s))}var u=e.endAt?new _a(e.endAt.position,!e.endAt.before):null,a=e.startAt?new _a(e.startAt.position,!e.startAt.before):null;e.cn=Hi(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.cn}function Qu(t,e,n){return new Vu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Yu(t,e){return new Vu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,e,t.endAt)}function Xu(t,e){return new Vu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,t.startAt,e)}function $u(t,e){return Yi(Hu(t),Hu(e))&&t.on===e.on}function Ju(t){return Qi(Hu(t))+"|lt:"+t.on}function Zu(t){return"Query(target="+(n=(e=Hu(t)).path.R(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.R()+" "+e.op+" "+Yo(e.value);var e}).join(", ")+"]"),Gi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.R()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Da(e.startAt)),e.endAt&&(n+=", endAt: "+Da(e.endAt)),"Target("+n+")")+"; limitType="+t.on+")";var e,n}function ta(i,t){return r=i,o=t.key.path,(null!==r.collectionGroup?t.key.N(r.collectionGroup)&&r.path.T(o):Xr.F(r.path)?r.path.isEqual(o):r.path.I(o))&&function(t){for(var e=0,n=i.rn;e<n.length;e++){var r=n[e];if(!r.field.p()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=i).startAt||Oa(e.startAt,Ku(e),n))&&(!e.endAt||!Oa(e.endAt,Ku(e),n)));var e,n,r,o}function ea(u){return function(t,e){for(var n=!1,r=0,i=Ku(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i,o,s,u=t.field.p()?Xr.i(e.key,n.key):(r=t.field,i=n,o=e.field(r),s=i.field(r),null!==o&&null!==s?Ho(o,s):jr());switch(t.dir){case"asc":return u;case"desc":return-1*u;default:return jr()}}(o,t,e);if(0!==s)return s;n=n||o.field.p()}return 0}}var na,ra=(o(ia,na=function(){}),ia.create=function(t,e,n){if(t.p())return"in"===e||"not-in"===e?this.hn(t,e,n):new aa(t,e,n);if(ns(n)){if("=="!==e&&"!="!==e)throw new xr(Or.INVALID_ARGUMENT,"Invalid query. Null only supports '==' and '!=' comparisons.");return new ia(t,e,n)}if(rs(n)){if("=="!==e&&"!="!==e)throw new xr(Or.INVALID_ARGUMENT,"Invalid query. NaN only supports '==' and '!=' comparisons.");return new ia(t,e,n)}return"array-contains"===e?new wa(t,n):"in"===e?new ba(t,n):"not-in"===e?new Ia(t,n):"array-contains-any"===e?new Ea(t,n):new ia(t,e,n)},ia.hn=function(t,e,n){return new("in"===e?ca:ha)(t,n)},ia.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.ln(Ho(e,this.value)):null!==e&&zo(this.value)===zo(e)&&this.ln(Ho(e,this.value))},ia.prototype.ln=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return jr()}},ia.prototype.un=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},ia);function ia(t,e,n){var r=this;return(r=na.call(this)||this).field=t,r.op=e,r.value=n,r}var oa,sa,ua,aa=(o(pa,ua=ra),pa.prototype.matches=function(t){var e=Xr.i(t.key,this.key);return this.ln(e)},pa),ca=(o(la,sa=ra),la.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},la),ha=(o(fa,oa=ra),fa.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},fa);function fa(t,e){var n=this;return(n=oa.call(this,t,"not-in",e)||this).keys=da(0,e),n}function la(t,e){var n=this;return(n=sa.call(this,t,"in",e)||this).keys=da(0,e),n}function pa(t,e,n){var r=this;return(r=ua.call(this,t,e,n)||this).key=Xr.C(n.referenceValue),r}function da(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return Xr.C(t.referenceValue)})}var va,ya,ga,ma,wa=(o(Sa,ma=ra),Sa.prototype.matches=function(t){var e=t.field(this.field);return es(e)&&Ko(e.arrayValue,this.value)},Sa),ba=(o(Aa,ga=ra),Aa.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Ko(this.value.arrayValue,e)},Aa),Ia=(o(Na,ya=ra),Na.prototype.matches=function(t){if(Ko(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!Ko(this.value.arrayValue,e)},Na),Ea=(o(Ta,va=ra),Ta.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!es(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return Ko(e.value.arrayValue,t)})},Ta),_a=function(t,e){this.position=t,this.before=e};function Ta(t,e){return va.call(this,t,"array-contains-any",e)||this}function Na(t,e){return ya.call(this,t,"not-in",e)||this}function Aa(t,e){return ga.call(this,t,"in",e)||this}function Sa(t,e){return ma.call(this,t,"array-contains",e)||this}function Da(t){return(t.before?"b":"a")+":"+t.position.map(Yo).join(",")}function Oa(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.p()?Xr.i(Xr.C(s.referenceValue),n.key):Ho(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function xa(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Wo(t.position[n],e.position[n]))return!1;return!0}var Ra=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function ka(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var La,Pa=(Ga.prototype.reset=function(){this.Tn=0},Ga.prototype.An=function(){this.Tn=this.mn},Ga.prototype.Rn=function(t){var e=this;this.cancel();var n=Math.floor(this.Tn+this.Pn()),r=Math.max(0,Date.now()-this.In),i=Math.max(0,n-r);0<i&&Vr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Tn+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.En=this._n.gn(this.fn,i,function(){return e.In=Date.now(),t()}),this.Tn*=this.wn,this.Tn<this.dn&&(this.Tn=this.dn),this.Tn>this.mn&&(this.Tn=this.mn)},Ga.prototype.yn=function(){null!==this.En&&(this.En.Vn(),this.En=null)},Ga.prototype.cancel=function(){null!==this.En&&(this.En.cancel(),this.En=null)},Ga.prototype.Pn=function(){return(Math.random()-.5)*this.Tn},Ga),Va=(Ba.prototype.catch=function(t){return this.next(void 0,t)},Ba.prototype.next=function(r,i){var o=this;return this.Sn&&jr(),this.Sn=!0,this.vn?this.error?this.Dn(i,this.error):this.Cn(r,this.result):new Ba(function(e,n){o.pn=function(t){o.Cn(r,t).next(e,n)},o.bn=function(t){o.Dn(i,t).next(e,n)}})},Ba.prototype.Nn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Ba.prototype.Fn=function(t){try{var e=t();return e instanceof Ba?e:Ba.resolve(e)}catch(t){return Ba.reject(t)}},Ba.prototype.Cn=function(t,e){return t?this.Fn(function(){return t(e)}):Ba.resolve(e)},Ba.prototype.Dn=function(t,e){return t?this.Fn(function(){return t(e)}):Ba.reject(e)},Ba.resolve=function(n){return new Ba(function(t,e){t(n)})},Ba.reject=function(n){return new Ba(function(t,e){e(n)})},Ba.$n=function(t){return new Ba(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Ba.xn=function(t){for(var n=Ba.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Ba.resolve(t):e()})}(r[e]);return n},Ba.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.$n(i)},Ba),Ca=(qa.delete=function(t){return Vr("SimpleDb","Removing database:",t),Ya(window.indexedDB.deleteDatabase(t)).Nn()},qa.On=function(){if("undefined"==typeof indexedDB)return!1;if(qa.Ln())return!0;var t=v(),e=qa.Mn(t),n=0<e&&e<10,r=qa.Bn(t),i=0<r&&r<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||i)},qa.Ln=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.qn)},qa.Un=function(t,e){return t.store(e)},qa.Mn=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},qa.Bn=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},qa.prototype.Qn=function(s){return m(this,void 0,void 0,function(){var e,o=this;return w(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Vr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(n,r){var i=indexedDB.open(o.name,o.version);i.onsuccess=function(t){var e=t.target.result;n(e)},i.onblocked=function(){r(new Ma(s,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(t){var e=t.target.error;"VersionError"===e.name?r(new xr(Or.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new Ma(s,e))},i.onupgradeneeded=function(t){Vr("SimpleDb",'Database "'+o.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;o.kn.createOrUpgrade(e,i.transaction,t.oldVersion,o.version).next(function(){Vr("SimpleDb","Database upgrade to version "+o.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.Wn&&(this.db.onversionchange=function(t){return o.Wn(t)}),this.db)]}})})},qa.prototype.jn=function(e){this.Wn=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},qa.prototype.runTransaction=function(c,r,h,f){return m(this,void 0,void 0,function(){var s,u,e,a,n;return w(this,function(t){switch(t.label){case 0:s="readonly"===r,u=0,e=function(){var e,n,r,i,o;return w(this,function(t){switch(t.label){case 0:++u,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,a.Qn(c)];case 2:return a.db=t.sent(),e=Wa.open(a.db,c,s?"readonly":"readwrite",h),n=f(e).catch(function(t){return e.abort(t),Va.reject(t)}).Nn(),r={},n.catch(function(){}),[4,e.Kn];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return i=t.sent(),o="FirebaseError"!==i.name&&u<3,Vr("SimpleDb","Transaction failed with error:",i.message,"Retrying:",o),a.close(),o?[3,5]:[2,{value:Promise.reject(i)}];case 5:return[2]}})},a=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(n=t.sent()))return[2,n.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},qa.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},qa),Ua=(Object.defineProperty(Fa.prototype,"vn",{get:function(){return this.zn},enumerable:!1,configurable:!0}),Object.defineProperty(Fa.prototype,"Yn",{get:function(){return this.Hn},enumerable:!1,configurable:!0}),Object.defineProperty(Fa.prototype,"cursor",{set:function(t){this.Gn=t},enumerable:!1,configurable:!0}),Fa.prototype.done=function(){this.zn=!0},Fa.prototype.Jn=function(t){this.Hn=t},Fa.prototype.delete=function(){return Ya(this.Gn.delete())},Fa),Ma=(o(ja,La=xr),ja);function ja(t,e){var n=this;return(n=La.call(this,Or.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function Fa(t){this.Gn=t,this.zn=!1,this.Hn=null}function qa(t,e,n){this.name=t,this.version=e,this.kn=n,12.2===qa.Mn(v())&&Cr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function Ba(t){var e=this;this.pn=null,this.bn=null,this.result=void 0,this.error=void 0,this.vn=!1,this.Sn=!1,t(function(t){e.vn=!0,e.result=t,e.pn&&e.pn(t)},function(t){e.vn=!0,e.error=t,e.bn&&e.bn(t)})}function Ga(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this._n=t,this.fn=e,this.dn=n,this.wn=r,this.mn=i,this.Tn=0,this.En=null,this.In=Date.now(),this.reset()}function za(t){return"IndexedDbTransactionError"===t.name}var Wa=(Qa.open=function(t,e,n,r){try{return new Qa(e,t.transaction(r,n))}catch(t){throw new Ma(e,t)}},Object.defineProperty(Qa.prototype,"Kn",{get:function(){return this.Xn.promise},enumerable:!1,configurable:!0}),Qa.prototype.abort=function(t){t&&this.Xn.reject(t),this.aborted||(Vr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Qa.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Ka(e)},Qa),Ka=(Ha.prototype.put=function(t,e){return Ya(void 0!==e?(Vr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Vr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},Ha.prototype.add=function(t){return Vr("SimpleDb","ADD",this.store.name,t,t),Ya(this.store.add(t))},Ha.prototype.get=function(e){var n=this;return Ya(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Vr("SimpleDb","GET",n.store.name,e,t),t})},Ha.prototype.delete=function(t){return Vr("SimpleDb","DELETE",this.store.name,t),Ya(this.store.delete(t))},Ha.prototype.count=function(){return Vr("SimpleDb","COUNT",this.store.name),Ya(this.store.count())},Ha.prototype.Zn=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.ts(n,function(t,e){r.push(e)}).next(function(){return r})},Ha.prototype.es=function(t,e){Vr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.ns=!1;var r=this.cursor(n);return this.ts(r,function(t,e,n){return n.delete()})},Ha.prototype.ss=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.ts(r,e)},Ha.prototype.rs=function(i){var t=this.cursor({});return new Va(function(n,r){t.onerror=function(t){var e=$a(t.target.error);r(e)},t.onsuccess=function(t){var e=t.target.result;e?i(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},Ha.prototype.ts=function(t,s){var u=[];return new Va(function(o,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n,r,i=t.target.result;i?(e=new Ua(i),(n=s(i.primaryKey,i.value,e))instanceof Va&&(r=n.catch(function(t){return e.done(),Va.reject(t)}),u.push(r)),e.vn?o():null===e.Yn?i.continue():i.continue(e.Yn)):o()}}).next(function(){return Va.$n(u)})},Ha.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Ha.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.ns?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Ha);function Ha(t){this.store=t}function Qa(n,t){var r=this;this.action=n,this.transaction=t,this.aborted=!1,this.Xn=new ka,this.transaction.oncomplete=function(){r.Xn.resolve()},this.transaction.onabort=function(){t.error?r.Xn.reject(new Ma(n,t.error)):r.Xn.resolve()},this.transaction.onerror=function(t){var e=$a(t.target.error);r.Xn.reject(new Ma(n,e))}}function Ya(t){return new Va(function(n,r){t.onsuccess=function(t){var e=t.target.result;n(e)},t.onerror=function(t){var e=$a(t.target.error);r(e)}})}var Xa=!1;function $a(t){var e=Ca.Mn(v());if(12.2<=e&&e<13){var n="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(n)){var r=new xr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Xa||(Xa=!0,setTimeout(function(){throw r},0)),r}}return t}function Ja(){return"undefined"!=typeof window?window:null}function Za(){return"undefined"!=typeof document?document:null}var tc=(rc.ls=function(t,e,n,r,i){var o=new rc(t,e,Date.now()+n,r,i);return o.start(n),o},rc.prototype.start=function(t){var e=this;this._s=setTimeout(function(){return e.fs()},t)},rc.prototype.Vn=function(){return this.fs()},rc.prototype.cancel=function(t){null!==this._s&&(this.clearTimeout(),this.hs.reject(new xr(Or.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},rc.prototype.fs=function(){var e=this;this.os.ds(function(){return null!==e._s?(e.clearTimeout(),e.op().then(function(t){return e.hs.resolve(t)})):Promise.resolve()})},rc.prototype.clearTimeout=function(){null!==this._s&&(this.us(this),clearTimeout(this._s),this._s=null)},rc),ec=(Object.defineProperty(nc.prototype,"Vs",{get:function(){return this.Es},enumerable:!1,configurable:!0}),nc.prototype.ds=function(t){this.enqueue(t)},nc.prototype.ps=function(t){this.bs(),this.vs(t)},nc.prototype.Ss=function(){var t;this.Es||(this.Es=!0,(t=Za())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.ys))},nc.prototype.enqueue=function(t){return this.bs(),this.Es?new Promise(function(t){}):this.vs(t)},nc.prototype.Ds=function(t){var e=this;this.Ts.push(t),this.ds(function(){return e.Cs()})},nc.prototype.Cs=function(){return m(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(0===this.Ts.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Ts[0]()];case 2:return t.sent(),this.Ts.shift(),this.gs.reset(),[3,4];case 3:if(!za(e=t.sent()))throw e;return Vr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Ts.length&&this.gs.Rn(function(){return n.Cs()}),t.label=5;case 5:return[2]}})})},nc.prototype.vs=function(t){var r=this,e=this.ws.then(function(){return r.Rs=!0,t().catch(function(t){throw r.As=t,r.Rs=!1,Cr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Rs=!1,t})});return this.ws=e},nc.prototype.gn=function(t,e,n){var r=this;this.bs(),-1<this.Ps.indexOf(t)&&(e=0);var i=tc.ls(this,t,e,n,function(t){return r.Ns(t)});return this.Is.push(i),i},nc.prototype.bs=function(){this.As&&jr()},nc.prototype.Fs=function(){},nc.prototype.$s=function(){return m(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return[4,e=this.ws];case 1:t.sent(),t.label=2;case 2:if(e!==this.ws)return[3,0];t.label=3;case 3:return[2]}})})},nc.prototype.xs=function(t){for(var e=0,n=this.Is;e<n.length;e++)if(n[e].fn===t)return!0;return!1},nc.prototype.ks=function(r){var i=this;return this.$s().then(function(){i.Is.sort(function(t,e){return t.cs-e.cs});for(var t=0,e=i.Is;t<e.length;t++){var n=e[t];if(n.Vn(),"all"!==r&&n.fn===r)break}return i.$s()})},nc.prototype.Ms=function(t){this.Ps.push(t)},nc.prototype.Ns=function(t){var e=this.Is.indexOf(t);this.Is.splice(e,1)},nc);function nc(){var e=this;this.ws=Promise.resolve(),this.Ts=[],this.Es=!1,this.Is=[],this.As=null,this.Rs=!1,this.Ps=[],this.gs=new Pa(this,"async_queue_retry"),this.ys=function(){var t=Za();t&&Vr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.gs.yn()};var t=Za();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.ys)}function rc(t,e,n,r,i){this.os=t,this.fn=e,this.cs=n,this.op=r,this.us=i,this.hs=new ka,this.then=this.hs.promise.then.bind(this.hs.promise),this.hs.promise.catch(function(t){})}function ic(t,e){if(Cr("AsyncQueue",e+": "+t),za(t))return new xr(Or.UNAVAILABLE,e+": "+t);throw t}function oc(){this.Os=void 0,this.listeners=[]}function sc(){this.Ls=new Vi(Ju,$u),this.onlineState="Unknown",this.Bs=new Set}function uc(a,c){return m(this,void 0,void 0,function(){var e,n,r,i,o,s,u;return w(this,function(t){switch(t.label){case 0:if(e=a,n=c.query,r=!1,(i=e.Ls.get(n))||(r=!0,i=new oc),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.qs(n)];case 2:return o.Os=t.sent(),[3,4];case 3:return s=t.sent(),u=ic(s,"Initialization of query '"+Zu(c.query)+"' failed"),[2,void c.onError(u)];case 4:return e.Ls.set(n,i),i.listeners.push(c),c.Us(e.onlineState),i.Os&&c.Qs(i.Os)&&cc(e),[2]}})})}function ac(s,u){return m(this,void 0,void 0,function(){var e,n,r,i,o;return w(this,function(t){return e=s,n=u.query,r=!1,(i=e.Ls.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.Ls.delete(n),e.Ws(n))]:[2]})})}function cc(t){t.Bs.forEach(function(t){t.next()})}var hc=(pc.prototype.Qs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new To(t.query,t.docs,t.Ut,e,t.Qt,t.fromCache,t.Wt,!0)}var o=!1;return this.Ks?this.zs(t)&&(this.js.next(t),o=!0):this.Hs(t,this.onlineState)&&(this.Ys(t),o=!0),this.Gs=t,o},pc.prototype.onError=function(t){this.js.error(t)},pc.prototype.Us=function(t){this.onlineState=t;var e=!1;return this.Gs&&!this.Ks&&this.Hs(this.Gs,t)&&(this.Ys(this.Gs),e=!0),e},pc.prototype.Hs=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Js&&n||t.docs.m()&&"Offline"!==e)},pc.prototype.zs=function(t){if(0<t.docChanges.length)return!0;var e=this.Gs&&this.Gs.hasPendingWrites!==t.hasPendingWrites;return!(!t.Wt&&!e)&&!0===this.options.includeMetadataChanges},pc.prototype.Ys=function(t){t=To.Kt(t.query,t.docs,t.Qt,t.fromCache),this.Ks=!0,this.js.next(t)},pc),fc=(lc.prototype.Xs=function(){return null!=this.uid},lc.prototype.Zs=function(){return this.Xs()?"uid:"+this.uid:"anonymous-user"},lc.prototype.isEqual=function(t){return t.uid===this.uid},lc);function lc(t){this.uid=t}function pc(t,e,n){this.query=t,this.js=e,this.Ks=!1,this.Gs=null,this.onlineState="Unknown",this.options=n||{}}fc.UNAUTHENTICATED=new fc(null),fc.ti=new fc("google-credentials-uid"),fc.ei=new fc("first-party-uid");var dc=(vc.prototype.si=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},vc.prototype.next=function(){var t=++this.previousValue;return this.ii&&this.ii(t),t},vc);function vc(t,e){var n=this;this.previousValue=t,e&&(e.ni=function(t){return n.si(t)},this.ii=function(t){return e.ri(t)})}function yc(t,e){return"firestore_clients_"+t+"_"+e}function gc(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.Xs()&&(r+="_"+e.uid),r}function mc(t,e){return"firestore_targets_"+t+"_"+e}dc.oi=-1;var wc=(Wc.ai=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new xr(r.error.code,r.error.message)),i?new Wc(t,e,r.state,o):(Cr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},Wc.prototype.ci=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Wc),bc=(zc.ai=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new xr(n.error.code,n.error.message)),r?new zc(t,n.state,i):(Cr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},zc.prototype.ci=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},zc),Ic=(Gc.ai=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Io,o=0;r&&o<n.activeTargetIds.length;++o)r=Wi(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new Gc(t,i):(Cr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},Gc),Ec=(Bc.ai=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Bc(e.clientId,e.onlineState):(Cr("SharedClientState","Failed to parse online state: "+t),null)},Bc),_c=(qc.prototype.ui=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},qc.prototype.hi=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},qc.prototype.ci=function(){var t={activeTargetIds:this.activeTargetIds.A(),updateTimeMs:Date.now()};return JSON.stringify(t)},qc),Tc=(Fc.On=function(t){return!(!t||!t.localStorage)},Fc.prototype.start=function(){return m(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l=this;return w(this,function(t){switch(t.label){case 0:return[4,this._i.Vi()];case 1:for(e=t.sent(),n=0,r=e;n<r.length;n++)(i=r[n])!==this.li&&(o=this.getItem(yc(this.persistenceKey,i)))&&(s=Ic.ai(i,o))&&(this.mi=this.mi.rt(s.clientId,s));for(this.pi(),(u=this.storage.getItem(this.yi))&&(a=this.bi(u))&&this.vi(a),c=0,h=this.Ei;c<h.length;c++)f=h[c],this.wi(f);return this.Ei=[],this.window.addEventListener("unload",function(){return l.Si()}),this.Ti=!0,[2]}})})},Fc.prototype.ri=function(t){this.setItem(this.Ai,JSON.stringify(t))},Fc.prototype.Di=function(){return this.Ci(this.mi)},Fc.prototype.Ni=function(n){var r=!1;return this.mi.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},Fc.prototype.Fi=function(t){this.$i(t,"pending")},Fc.prototype.xi=function(t,e,n){this.$i(t,e,n),this.ki(t)},Fc.prototype.Mi=function(t){var e,n,r="not-current";return this.Ni(t)&&(!(e=this.storage.getItem(mc(this.persistenceKey,t)))||(n=bc.ai(t,e))&&(r=n.state)),this.Oi.ui(t),this.pi(),r},Fc.prototype.Li=function(t){this.Oi.hi(t),this.pi()},Fc.prototype.Bi=function(t){return this.Oi.activeTargetIds.has(t)},Fc.prototype.qi=function(t){this.removeItem(mc(this.persistenceKey,t))},Fc.prototype.Ui=function(t,e,n){this.Qi(t,e,n)},Fc.prototype.Wi=function(t,e,n){var r=this;e.forEach(function(t){r.ki(t)}),this.currentUser=t,n.forEach(function(t){r.Fi(t)})},Fc.prototype.ji=function(t){this.Ki(t)},Fc.prototype.Si=function(){this.Ti&&(this.window.removeEventListener("storage",this.di),this.removeItem(this.Ii),this.Ti=!1)},Fc.prototype.getItem=function(t){var e=this.storage.getItem(t);return Vr("SharedClientState","READ",t,e),e},Fc.prototype.setItem=function(t,e){Vr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},Fc.prototype.removeItem=function(t){Vr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},Fc.prototype.wi=function(t){var e=this,u=t;if(u.storageArea===this.storage){if(Vr("SharedClientState","EVENT",u.key,u.newValue),u.key===this.Ii)return void Cr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this._n.Ds(function(){return m(e,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){if(this.Ti){if(null!==u.key)if(this.Ri.test(u.key)){if(null==u.newValue)return e=this.Gi(u.key),[2,this.zi(e,null)];if(n=this.Hi(u.key,u.newValue))return[2,this.zi(n.clientId,n)]}else if(this.Pi.test(u.key)){if(null!==u.newValue&&(r=this.Yi(u.key,u.newValue)))return[2,this.Ji(r)]}else if(this.gi.test(u.key)){if(null!==u.newValue&&(i=this.Xi(u.key,u.newValue)))return[2,this.Zi(i)]}else if(u.key===this.yi){if(null!==u.newValue&&(o=this.bi(u.newValue)))return[2,this.vi(o)]}else u.key===this.Ai&&(s=function(t){var e=dc.oi;if(null!=t)try{var n=JSON.parse(t);Fr("number"==typeof n),e=n}catch(t){Cr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(u.newValue))!==dc.oi&&this.ni(s)}else this.Ei.push(u);return[2]})})})}},Object.defineProperty(Fc.prototype,"Oi",{get:function(){return this.mi.get(this.li)},enumerable:!1,configurable:!0}),Fc.prototype.pi=function(){this.setItem(this.Ii,this.Oi.ci())},Fc.prototype.$i=function(t,e,n){var r=new wc(this.currentUser,t,e,n),i=gc(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ci())},Fc.prototype.ki=function(t){var e=gc(this.persistenceKey,this.currentUser,t);this.removeItem(e)},Fc.prototype.Ki=function(t){var e={clientId:this.li,onlineState:t};this.storage.setItem(this.yi,JSON.stringify(e))},Fc.prototype.Qi=function(t,e,n){var r=mc(this.persistenceKey,t),i=new bc(t,e,n);this.setItem(r,i.ci())},Fc.prototype.Gi=function(t){var e=this.Ri.exec(t);return e?e[1]:null},Fc.prototype.Hi=function(t,e){var n=this.Gi(t);return Ic.ai(n,e)},Fc.prototype.Yi=function(t,e){var n=this.Pi.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return wc.ai(new fc(i),r,e)},Fc.prototype.Xi=function(t,e){var n=this.gi.exec(t),r=Number(n[1]);return bc.ai(r,e)},Fc.prototype.bi=function(t){return Ec.ai(t)},Fc.prototype.Ji=function(e){return m(this,void 0,void 0,function(){return w(this,function(t){return e.user.uid===this.currentUser.uid?[2,this._i.tr(e.batchId,e.state,e.error)]:(Vr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},Fc.prototype.Zi=function(t){return this._i.er(t.targetId,t.state,t.error)},Fc.prototype.zi=function(t,e){var n=this,r=e?this.mi.rt(t,e):this.mi.remove(t),i=this.Ci(this.mi),o=this.Ci(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this._i.nr(s,u).then(function(){n.mi=r})},Fc.prototype.vi=function(t){this.mi.get(t.clientId)&&this.fi(t.onlineState)},Fc.prototype.Ci=function(t){var n=Io;return t.forEach(function(t,e){n=n.xt(e.activeTargetIds)}),n},Fc),Nc=(jc.prototype.Fi=function(t){},jc.prototype.xi=function(t,e,n){},jc.prototype.Mi=function(t){return this.sr.ui(t),this.ir[t]||"not-current"},jc.prototype.Ui=function(t,e,n){this.ir[t]=e},jc.prototype.Li=function(t){this.sr.hi(t)},jc.prototype.Bi=function(t){return this.sr.activeTargetIds.has(t)},jc.prototype.qi=function(t){delete this.ir[t]},jc.prototype.Di=function(){return this.sr.activeTargetIds},jc.prototype.Ni=function(t){return this.sr.activeTargetIds.has(t)},jc.prototype.start=function(){return this.sr=new _c,Promise.resolve()},jc.prototype.Wi=function(t,e,n){},jc.prototype.ji=function(t){},jc.prototype.Si=function(){},jc.prototype.ri=function(t){},jc),Ac=(Mc.prototype.ar=function(t,e,n){for(var r,i,o,s=n.cr,u=0;u<this.mutations.length;u++){var a=this.mutations[u];a.key.isEqual(t)&&(r=a,i=e,o=s[u],e=r instanceof cu?new ku(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof hu?function(t,e,n){if(!nu(t.Ke,e))return new Pu(t.key,n.version);var r=pu(t,e);return new ku(t.key,n.version,r,{hasCommittedMutations:!0})}(r,i,o):r instanceof vu?function(t,e,n){if(Fr(null!=n.transformResults),!nu(t.Ke,e))return new Pu(t.key,n.version);var r=e,i=function(t,e,n){var r=[];Fr(t.length===n.length);for(var i,o,s,u=0;u<n.length;u++){var a=t[u],c=a.transform,h=null;e instanceof ku&&(h=e.field(a.field)),r.push((i=c,o=h,s=n[u],i instanceof Us?Fs(i,o):i instanceof Bs?zs(i,o):s))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=gu(t,r.data(),i);return new ku(t.key,o,s,{hasCommittedMutations:!0})}(r,i,o):new Lu(r.key,o.version,{hasCommittedMutations:!0}))}return e},Mc.prototype.ur=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=iu(i,e,e,this.rr))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=iu(a,e,o,this.rr))}return e},Mc.prototype.hr=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ur(t.key,n.get(t.key));e&&(i=i.rt(t.key,e))}),i},Mc.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},bo())},Mc.prototype.isEqual=function(t){return this.batchId===t.batchId&&_i(this.mutations,t.mutations,ou)&&_i(this.baseMutations,t.baseMutations,ou)},Mc),Sc=(Uc.from=function(t,e,n){Fr(t.mutations.length===n.length);for(var r=mo,i=t.mutations,o=0;o<i.length;o++)r=r.rt(i[o].key,n[o].version);return new Uc(t,e,n,r)},Uc),Dc=(Object.defineProperty(Cc.prototype,"readTime",{get:function(){return this.mr},set:function(t){this.mr=t},enumerable:!1,configurable:!0}),Cc.prototype.Tr=function(t,e){this.Er(),this.readTime=e,this.dr.set(t.key,t)},Cc.prototype.Ir=function(t,e){this.Er(),e&&(this.readTime=e),this.dr.set(t,null)},Cc.prototype.Ar=function(t,e){this.Er();var n=this.dr.get(e);return void 0!==n?Va.resolve(n):this.Rr(t,e)},Cc.prototype.getEntries=function(t,e){return this.Pr(t,e)},Cc.prototype.apply=function(t){return this.Er(),this.wr=!0,this.gr(t)},Cc.prototype.Er=function(){},Cc),Oc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",xc=(Vc.prototype.Vr=function(t){this.yr.push(t)},Vc.prototype.pr=function(){this.yr.forEach(function(t){return t()})},Vc),Rc=(Pc.prototype.Dr=function(e,n){var r=this;return this.vr.Cr(e,n).next(function(t){return r.Nr(e,n,t)})},Pc.prototype.Nr=function(t,r,i){return this.br.Ar(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ur(r,t);return t})},Pc.prototype.Fr=function(t,e,i){var o=po;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ur(t,e);o=o.rt(t,e)}),o},Pc.prototype.$r=function(e,t){var n=this;return this.br.getEntries(e,t).next(function(t){return n.kr(e,t)})},Pc.prototype.kr=function(r,i){var o=this;return this.vr.Mr(r,i).next(function(t){var e=o.Fr(r,i,t),n=po;return e.forEach(function(t,e){e=e||new Lu(t,Ui.min()),n=n.rt(t,e)}),n})},Pc.prototype.Or=function(t,e,n){return r=e,Xr.F(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Lr(t,e.path):Wu(e)?this.Br(t,e,n):this.qr(t,e,n);var r},Pc.prototype.Lr=function(t,e){return this.Dr(t,new Xr(e)).next(function(t){var e=go;return t instanceof ku&&(e=e.rt(t.key,t)),e})},Pc.prototype.Br=function(i,o,s){var u=this,a=o.collectionGroup,c=go;return this.Sr.Ur(i,a).next(function(t){return Va.forEach(t,function(t){var e,n,r=(e=o,n=t.child(a),new Vu(n,null,e.rn.slice(),e.filters.slice(),e.limit,e.on,e.startAt,e.endAt));return u.qr(i,r,s).next(function(t){t.forEach(function(t,e){c=c.rt(t,e)})})}).next(function(){return c})})},Pc.prototype.qr=function(e,n,t){var h,f,r=this;return this.br.Or(e,n,t).next(function(t){return h=t,r.vr.Qr(e,n)}).next(function(t){return f=t,r.Wr(e,f,h).next(function(t){h=t;for(var e=0,n=f;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=h.get(u),c=iu(s,a,a,r.rr);h=c instanceof ku?h.rt(u,c):h.remove(u)}})}).next(function(){return h.forEach(function(t,e){ta(n,e)||(h=h.remove(t))}),h})},Pc.prototype.Wr=function(t,e,n){for(var r=bo(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof hu&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.br.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof ku&&(c=c.rt(t,e))}),c})},Pc),kc=(Lc.Gr=function(t,e){for(var n=bo(),r=bo(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Lc(t,e.fromCache,n,r)},Lc);function Lc(t,e,n,r){this.targetId=t,this.fromCache=e,this.jr=n,this.Kr=r}function Pc(t,e,n){this.br=t,this.vr=e,this.Sr=n}function Vc(){this.yr=[]}function Cc(){this.dr=new Vi(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.wr=!1}function Uc(t,e,n,r){this.batch=t,this.lr=e,this.cr=n,this._r=r}function Mc(t,e,n,r){this.batchId=t,this.rr=e,this.baseMutations=n,this.mutations=r}function jc(){this.sr=new _c,this.ir={},this.fi=null,this.ni=null}function Fc(t,e,n,r,i){this.window=t,this._n=e,this.persistenceKey=n,this.li=r,this._i=null,this.fi=null,this.ni=null,this.di=this.wi.bind(this),this.mi=new io(Ei),this.Ti=!1,this.Ei=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ii=yc(this.persistenceKey,this.li),this.Ai="firestore_sequence_number_"+this.persistenceKey,this.mi=this.mi.rt(this.li,new _c),this.Ri=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Pi=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.gi=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.yi="firestore_online_state_"+this.persistenceKey,this.window.addEventListener("storage",this.di)}function qc(){this.activeTargetIds=Io}function Bc(t,e){this.clientId=t,this.onlineState=e}function Gc(t,e){this.clientId=t,this.activeTargetIds=e}function zc(t,e,n){this.targetId=t,this.state=e,this.error=n}function Wc(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function Kc(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Ei(n,i);return 0===s?Ei(r,o):s}var Hc=($c.prototype.Yr=function(){return++this.Hr},$c.prototype.Jr=function(t){var e,n=[t,this.Yr()];this.buffer.size<this.zr?this.buffer=this.buffer.add(n):Kc(n,e=this.buffer.last())<0&&(this.buffer=this.buffer.delete(e).add(n))},Object.defineProperty($c.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),$c),Qc={Xr:!1,Zr:0,eo:0,no:0},Yc=(Xc.oo=function(t){return new Xc(t,Xc.ao,Xc.co)},Xc);function Xc(t,e,n){this.so=t,this.io=e,this.ro=n}function $c(t){this.zr=t,this.buffer=new fo(Kc),this.Hr=0}Yc.uo=-1,Yc.ho=1048576,Yc.lo=41943040,Yc.ao=10,Yc.co=1e3,Yc._o=new Yc(Yc.lo,Yc.ao,Yc.co),Yc.fo=new Yc(Yc.uo,0,0);var Jc=(eh.prototype.start=function(t){this.do.params.so!==Yc.uo&&this.To(t)},eh.prototype.stop=function(){this.mo&&(this.mo.cancel(),this.mo=null)},Object.defineProperty(eh.prototype,"Ti",{get:function(){return null!==this.mo},enumerable:!1,configurable:!0}),eh.prototype.To=function(n){var t=this,e=this.wo?3e5:6e4;Vr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.mo=this.os.gn("lru_garbage_collection",e,function(){return m(t,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:this.mo=null,this.wo=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.Eo(this.do)];case 2:return t.sent(),[3,7];case 3:return za(e=t.sent())?(Vr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,xf(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.To(n)];case 8:return t.sent(),[2]}})})})},eh),Zc=(th.prototype.Ao=function(t,e){return this.Io.Ro(t).next(function(t){return Math.floor(e/100*t)})},th.prototype.Po=function(t,e){var n=this;if(0===e)return Va.resolve(dc.oi);var r=new Hc(e);return this.Io.De(t,function(t){return r.Jr(t.sequenceNumber)}).next(function(){return n.Io.yo(t,function(t){return r.Jr(t)})}).next(function(){return r.maxValue})},th.prototype.Vo=function(t,e,n){return this.Io.Vo(t,e,n)},th.prototype.po=function(t,e){return this.Io.po(t,e)},th.prototype.bo=function(e,n){var r=this;return this.params.so===Yc.uo?(Vr("LruGarbageCollector","Garbage collection skipped; disabled"),Va.resolve(Qc)):this.vo(e).next(function(t){return t<r.params.so?(Vr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.so),Qc):r.So(e,n)})},th.prototype.vo=function(t){return this.Io.vo(t)},th.prototype.So=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.Ao(e,this.params.io).next(function(t){return i=t>h.params.ro?(Vr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.ro+" from "+t),h.params.ro):t,s=Date.now(),h.Po(e,i)}).next(function(t){return r=t,u=Date.now(),h.Vo(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.po(e,r)}).next(function(t){return c=Date.now(),Pr()<=l.DEBUG&&Vr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),Va.resolve({Xr:!0,Zr:i,eo:o,no:t})})},th);function th(t,e){this.Io=t,this.params=e}function eh(t,e){this.do=t,this.os=e,this.wo=!1,this.mo=null}function nh(t){for(var o="",e=0;e<t.length;e++)0<o.length&&(o=rh(o)),o=function(t){for(var e=o,n=t.length,r=0;r<n;r++){var i=t.charAt(r);switch(i){case"\0":e+="";break;case"":e+="";break;default:e+=i}}return e}(t.get(e));return rh(o)}function rh(t){return t+""}function ih(t){var e=t.length;if(Fr(2<=e),2===e)return Fr(""===t.charAt(0)&&""===t.charAt(1)),Hr.g();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&jr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:jr()}o=s+2}return new Hr(r)}var oh=function(t){this.Do=t};function sh(t,e){if(e.document)return n=t.Do,r=e.document,i=!!e.hasCommittedMutations,o=gs(n,r.name),s=ps(r.updateTime),u=new Eu({mapValue:{fields:r.fields}}),new ku(o,s,u,{hasCommittedMutations:!!i});var n,r,i,o,s,u;if(e.noDocument){var a=Xr.$(e.noDocument.path),c=fh(e.noDocument.readTime);return new Lu(a,c,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var h=Xr.$(e.unknownDocument.path),f=fh(e.unknownDocument.version);return new Pu(h,f)}return jr()}function uh(t,e,n){var r,i,o=ah(n),s=e.key.path.h().A();if(e instanceof ku){var u={name:ys(r=t.Do,(i=e).key),fields:i.sn().mapValue.fields,updateTime:fs(r,i.version.X())},a=e.hasCommittedMutations;return new Wh(null,null,u,a,o,s)}if(e instanceof Lu){var c=e.key.path.A(),h=hh(e.version),f=e.hasCommittedMutations;return new Wh(null,new Gh(c,h),null,f,o,s)}if(e instanceof Pu){var l=e.key.path.A(),p=hh(e.version);return new Wh(new zh(l,p),null,null,!0,o,s)}return jr()}function ah(t){var e=t.X();return[e.seconds,e.nanoseconds]}function ch(t){var e=new Ci(t[0],t[1]);return Ui.Y(e)}function hh(t){var e=t.X();return new Ph(e.seconds,e.nanoseconds)}function fh(t){var e=new Ci(t.seconds,t.nanoseconds);return Ui.Y(e)}function lh(e,t){var n=(t.baseMutations||[]).map(function(t){return Ts(e.Do,t)}),r=t.mutations.map(function(t){return Ts(e.Do,t)}),i=Ci.fromMillis(t.localWriteTimeMs);return new Ac(t.batchId,i,n,r)}function ph(t){var e,n=fh(t.readTime),r=void 0!==t.lastLimboFreeSnapshotVersion?fh(t.lastLimboFreeSnapshotVersion):Ui.min(),i=void 0!==t.query.documents?(Fr(1===(e=t.query).documents.length),Hu(Fu(ws(e.documents[0])))):function(t){var e,n=ws(t.parent),r=t.structuredQuery,i=r.from?r.from.length:0,o=null;0<i&&(Fr(1===i),(e=r.from[0]).allDescendants?o=e.collectionId:n=n.child(e.collectionId));var s=[];r.where&&(s=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=xs(t.unaryFilter.field);return ra.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=xs(t.unaryFilter.field);return ra.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=xs(t.unaryFilter.field);return ra.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=xs(t.unaryFilter.field);return ra.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return jr()}}(e)]:void 0!==e.fieldFilter?[(n=e,ra.create(xs(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return jr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):jr():[];var n}(r.where));var u=[];r.orderBy&&(u=r.orderBy.map(function(t){return new Ra(xs((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));var a,c,h=null;r.limit&&(h=Gi(c="object"==typeof(a=r.limit)?a.value:a)?null:c);var f=null;r.startAt&&(f=Ds(r.startAt));var l=null;return r.endAt&&(l=Ds(r.endAt)),Hu(ju(n,o,u,s,h,"F",f,l))}(t.query);return new to(i,t.targetId,0,t.lastListenSequenceNumber,n,r,Ni.fromBase64String(t.resumeToken))}function dh(t,e){var n=hh(e.et),r=hh(e.lastLimboFreeSnapshotVersion),i=(Xi(e.target)?Ns:As)(t.Do,e.target),o=e.resumeToken.toBase64();return new Hh(e.targetId,Qi(e.target),n,o,e.sequenceNumber,r,i)}var vh=(yh.Fo=function(t,e,n,r){return Fr(""!==t.uid),new yh(t.Xs()?t.uid:"",e,n,r)},yh.prototype.$o=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return wh(t).ss({index:Fh.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},yh.prototype.xo=function(d,v,y,g){var m=this,w=bh(d),b=wh(d);return b.add({}).next(function(t){Fr("number"==typeof t);for(var e,n,r,i,o,s=new Ac(t,v,y,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return _s(e.Do,t)}),o=r.mutations.map(function(t){return _s(e.Do,t)}),new Fh(n,r.batchId,r.rr.toMillis(),i,o)),a=[],c=new fo(function(t,e){return Ei(t.R(),e.R())}),h=0,f=g;h<f.length;h++){var l=f[h],p=qh.key(m.userId,l.key.path,t),c=c.add(l.key.path.h());a.push(b.put(u)),a.push(w.put(p,qh.PLACEHOLDER))}return c.forEach(function(t){a.push(m.Sr.ko(d,t))}),d.Vr(function(){m.No[t]=s.keys()}),Va.$n(a).next(function(){return s})})},yh.prototype.Mo=function(t,e){var n=this;return wh(t).get(e).next(function(t){return t?(Fr(t.userId===n.userId),lh(n.serializer,t)):null})},yh.prototype.Oo=function(t,n){var r=this;return this.No[n]?Va.resolve(this.No[n]):this.Mo(t,n).next(function(t){if(t){var e=t.keys();return r.No[n]=e}return null})},yh.prototype.Lo=function(t,e){var r=this,i=e+1,n=IDBKeyRange.lowerBound([this.userId,i]),o=null;return wh(t).ss({index:Fh.userMutationsIndex,range:n},function(t,e,n){e.userId===r.userId&&(Fr(e.batchId>=i),o=lh(r.serializer,e)),n.done()}).next(function(){return o})},yh.prototype.Bo=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return wh(t).ss({index:Fh.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},yh.prototype.qo=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return wh(t).Zn(Fh.userMutationsIndex,n).next(function(t){return t.map(function(t){return lh(e.serializer,t)})})},yh.prototype.Cr=function(u,a){var c=this,t=qh.prefixForPath(this.userId,a.path),e=IDBKeyRange.lowerBound(t),h=[];return bh(u).ss({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=ih(i);if(r===c.userId&&a.path.isEqual(s))return wh(u).get(o).next(function(t){if(!t)throw jr();Fr(t.userId===c.userId),h.push(lh(c.serializer,t))});n.done()}).next(function(){return h})},yh.prototype.Mr=function(r,t){var a=this,c=new fo(Ei),i=[];return t.forEach(function(u){var t=qh.prefixForPath(a.userId,u.path),e=IDBKeyRange.lowerBound(t),n=bh(r).ss({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=ih(i);r===a.userId&&u.path.isEqual(s)?c=c.add(o):n.done()});i.push(n)}),Va.$n(i).next(function(){return a.Uo(r,c)})},yh.prototype.Qr=function(t,e){var u=this,a=e.path,c=a.length+1,n=qh.prefixForPath(this.userId,a),r=IDBKeyRange.lowerBound(n),h=new fo(Ei);return bh(t).ss({range:r},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=ih(i);r===u.userId&&a.T(s)?s.length===c&&(h=h.add(o)):n.done()}).next(function(){return u.Uo(t,h)})},yh.prototype.Uo=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(wh(e).get(t).next(function(t){if(null===t)throw jr();Fr(t.userId===n.userId),r.push(lh(n.serializer,t))}))}),Va.$n(i).next(function(){return r})},yh.prototype.Qo=function(e,n){var r=this;return mh(e.Wo,this.userId,n).next(function(t){return e.Vr(function(){r.jo(n.batchId)}),Va.forEach(t,function(t){return r.Co.Ko(e,t)})})},yh.prototype.jo=function(t){delete this.No[t]},yh.prototype.Go=function(n){var o=this;return this.$o(n).next(function(t){if(!t)return Va.resolve();var e=IDBKeyRange.lowerBound(qh.prefixForUser(o.userId)),i=[];return bh(n).ss({range:e},function(t,e,n){var r;t[0]===o.userId?(r=ih(t[1]),i.push(r)):n.done()}).next(function(){Fr(0===i.length)})})},yh.prototype.zo=function(t,e){return gh(t,this.userId,e)},yh.prototype.Ho=function(t){var e=this;return Ih(t).get(this.userId).next(function(t){return t||new jh(e.userId,-1,"")})},yh);function yh(t,e,n,r){this.userId=t,this.serializer=e,this.Sr=n,this.Co=r,this.No={}}function gh(t,o,e){var n=qh.prefixForPath(o,e.path),s=n[1],r=IDBKeyRange.lowerBound(n),u=!1;return bh(t).ss({range:r,ns:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function mh(t,e,n){var r=t.store(Fh.store),i=t.store(qh.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.ss({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){Fr(1===u)}));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=qh.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return Va.$n(o).next(function(){return c})}function wh(t){return df.Un(t,Fh.store)}function bh(t){return df.Un(t,qh.store)}function Ih(t){return df.Un(t,jh.store)}var Eh,_h=(Ah.prototype.Tr=function(t,e,n){return Dh(t).put(Oh(e),n)},Ah.prototype.Ir=function(t,e){var n=Dh(t),r=Oh(e);return n.delete(r)},Ah.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.Yo(e,t)})},Ah.prototype.Ar=function(t,e){var n=this;return Dh(t).get(Oh(e)).next(function(t){return n.Jo(t)})},Ah.prototype.Xo=function(t,e){var n=this;return Dh(t).get(Oh(e)).next(function(t){var e=n.Jo(t);return e?{Zo:e,size:xh(t)}:null})},Ah.prototype.getEntries=function(t,e){var r=this,i=po;return this.ta(t,e,function(t,e){var n=r.Jo(e);i=i.rt(t,n)}).next(function(){return i})},Ah.prototype.ea=function(t,e){var r=this,i=po,o=new io(Xr.i);return this.ta(t,e,function(t,e){var n=r.Jo(e);o=n?(i=i.rt(t,n),o.rt(t,xh(e))):(i=i.rt(t,null),o.rt(t,0))}).next(function(){return{na:i,sa:o}})},Ah.prototype.ta=function(t,e,i){if(e.m())return Va.resolve();var n=IDBKeyRange.bound(e.first().path.A(),e.last().path.A()),o=e.lt(),s=o.Et();return Dh(t).ss({range:n},function(t,e,n){for(var r=Xr.$(t);s&&Xr.i(s,r)<0;)i(s,null),s=o.Et();s&&s.isEqual(r)&&(i(s,e),s=o.It()?o.Et():null),s?n.Jn(s.path.A()):n.done()}).next(function(){for(;s;)i(s,null),s=o.It()?o.Et():null})},Ah.prototype.Or=function(t,i,e){var n,r,o,s=this,u=go,a=i.path.length+1,c={};return e.isEqual(Ui.min())?(n=i.path.A(),c.range=IDBKeyRange.lowerBound(n)):(r=i.path.A(),o=ah(e),c.range=IDBKeyRange.lowerBound([r,o],!0),c.index=Wh.collectionReadTimeIndex),Dh(t).ss(c,function(t,e,n){var r;t.length===a&&(r=sh(s.serializer,e),i.path.T(r.key.path)?r instanceof ku&&ta(i,r)&&(u=u.rt(r.key,r)):n.done())}).next(function(){return u})},Ah.prototype.ia=function(t){return new Th(this,!!t&&t.ra)},Ah.prototype.oa=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Ah.prototype.getMetadata=function(t){return Sh(t).get(Kh.key).next(function(t){return Fr(!!t),t})},Ah.prototype.Yo=function(t,e){return Sh(t).put(Kh.key,e)},Ah.prototype.Jo=function(t){if(t){var e=sh(this.serializer,t);return e instanceof Lu&&e.version.isEqual(Ui.min())?null:e}return null},Ah),Th=(o(Nh,Eh=Dc),Nh.prototype.gr=function(s){var u=this,a=[],c=0,h=new fo(function(t,e){return Ei(t.R(),e.R())});return this.dr.forEach(function(t,e){var n,r,i,o=u.ca.get(t);e?(n=uh(u.aa.serializer,e,u.readTime),h=h.add(t.path.h()),r=xh(n),c+=r-o,a.push(u.aa.Tr(s,t,n))):(c-=o,u.ra?(i=uh(u.aa.serializer,new Lu(t,Ui.min()),u.readTime),a.push(u.aa.Tr(s,t,i))):a.push(u.aa.Ir(s,t)))}),h.forEach(function(t){a.push(u.aa.Sr.ko(s,t))}),a.push(this.aa.updateMetadata(s,c)),Va.$n(a)},Nh.prototype.Rr=function(t,e){var n=this;return this.aa.Xo(t,e).next(function(t){return null===t?(n.ca.set(e,0),null):(n.ca.set(e,t.size),t.Zo)})},Nh.prototype.Pr=function(t,e){var n=this;return this.aa.ea(t,e).next(function(t){var e=t.na;return t.sa.forEach(function(t,e){n.ca.set(t,e)}),e})},Nh);function Nh(t,e){var n=this;return(n=Eh.call(this)||this).aa=t,n.ra=e,n.ca=new Vi(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function Ah(t,e){this.serializer=t,this.Sr=e}function Sh(t){return df.Un(t,Kh.store)}function Dh(t){return df.Un(t,Wh.store)}function Oh(t){return t.path.A()}function xh(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw jr();e=t.noDocument}return JSON.stringify(e).length}var Rh=(Mh.prototype.ko=function(t,e){return this.ua.add(e),Va.resolve()},Mh.prototype.Ur=function(t,e){return Va.resolve(this.ua.getEntries(e))},Mh),kh=(Uh.prototype.add=function(t){var e=t._(),n=t.h(),r=this.index[e]||new fo(Hr.i),i=!r.has(n);return this.index[e]=r.add(n),i},Uh.prototype.has=function(t){var e=t._(),n=t.h(),r=this.index[e];return r&&r.has(n)},Uh.prototype.getEntries=function(t){return(this.index[t]||new fo(Hr.i)).A()},Uh),Lh=(Ch.prototype.createOrUpgrade=function(n,r,t,e){var i=this;Fr(t<e&&0<=t&&e<=10);var o,s=new Wa("createOrUpgrade",r);t<1&&1<=e&&(n.createObjectStore(Vh.store),(o=n).createObjectStore(jh.store,{keyPath:jh.keyPath}),o.createObjectStore(Fh.store,{keyPath:Fh.keyPath,autoIncrement:!0}).createIndex(Fh.userMutationsIndex,Fh.userMutationsKeyPath,{unique:!0}),o.createObjectStore(qh.store),$h(n),n.createObjectStore(Wh.store));var u,a=Va.resolve();return t<3&&3<=e&&(0!==t&&((u=n).deleteObjectStore(Qh.store),u.deleteObjectStore(Hh.store),u.deleteObjectStore(Yh.store),$h(n)),a=a.next(function(){return t=s.store(Yh.store),e=new Yh(0,0,Ui.min().X(),0),t.put(Yh.key,e);var t,e})),t<4&&4<=e&&(0!==t&&(a=a.next(function(){return r=n,(i=s).store(Fh.store).Zn().next(function(t){r.deleteObjectStore(Fh.store),r.createObjectStore(Fh.store,{keyPath:Fh.keyPath,autoIncrement:!0}).createIndex(Fh.userMutationsIndex,Fh.userMutationsKeyPath,{unique:!0});var e=i.store(Fh.store),n=t.map(function(t){return e.put(t)});return Va.$n(n)});var r,i})),a=a.next(function(){n.createObjectStore(Jh.store,{keyPath:Jh.keyPath})})),t<5&&5<=e&&(a=a.next(function(){return i.removeAcknowledgedMutations(s)})),t<6&&6<=e&&(a=a.next(function(){return n.createObjectStore(Kh.store),i.addDocumentGlobal(s)})),t<7&&7<=e&&(a=a.next(function(){return i.ensureSequenceNumbers(s)})),t<8&&8<=e&&(a=a.next(function(){return i.createCollectionParentIndex(n,s)})),t<9&&9<=e&&(a=a.next(function(){var t,e;(e=n).objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges"),(t=r.objectStore(Wh.store)).createIndex(Wh.readTimeIndex,Wh.readTimeIndexPath,{unique:!1}),t.createIndex(Wh.collectionReadTimeIndex,Wh.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=e&&(a=a.next(function(){return i.rewriteCanonicalIds(s)})),a},Ch.prototype.addDocumentGlobal=function(e){var n=0;return e.store(Wh.store).ss(function(t,e){n+=xh(e)}).next(function(){var t=new Kh(n);return e.store(Kh.store).put(Kh.key,t)})},Ch.prototype.removeAcknowledgedMutations=function(r){var i=this,t=r.store(jh.store),e=r.store(Fh.store);return t.Zn().next(function(t){return Va.forEach(t,function(n){var t=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return e.Zn(Fh.userMutationsIndex,t).next(function(t){return Va.forEach(t,function(t){Fr(t.userId===n.userId);var e=lh(i.serializer,t);return mh(r,n.userId,e).next(function(){})})})})})},Ch.prototype.ensureSequenceNumbers=function(t){var s=t.store(Qh.store),e=t.store(Wh.store);return t.store(Yh.store).get(Yh.key).next(function(i){var o=[];return e.ss(function(t,e){var n=new Hr(t),r=[0,nh(n)];o.push(s.get(r).next(function(t){return t?Va.resolve():s.put(new Qh(0,nh(n),i.highestListenSequenceNumber))}))}).next(function(){return Va.$n(o)})})},Ch.prototype.createCollectionParentIndex=function(t,e){function r(t){if(o.add(t)){var e=t._(),n=t.h();return i.put({collectionId:e,parent:nh(n)})}}t.createObjectStore(Xh.store,{keyPath:Xh.keyPath});var i=e.store(Xh.store),o=new kh;return e.store(Wh.store).ss({ns:!0},function(t,e){return r(new Hr(t).h())}).next(function(){return e.store(qh.store).ss({ns:!0},function(t,e){t[0];var n=t[1];return r((t[2],ih(n)).h())})})},Ch.prototype.rewriteCanonicalIds=function(t){var i=this,o=t.store(Hh.store);return o.ss(function(t,e){var n=ph(e),r=dh(i.serializer,n);return o.put(r)})},Ch),Ph=function(t,e){this.seconds=t,this.nanoseconds=e},Vh=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function Ch(t){this.serializer=t}function Uh(){this.index={}}function Mh(){this.ua=new kh}Vh.store="owner",Vh.key="owner";var jh=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};jh.store="mutationQueues",jh.keyPath="userId";var Fh=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Fh.store="mutations",Fh.keyPath="batchId",Fh.userMutationsIndex="userMutationsIndex",Fh.userMutationsKeyPath=["userId","batchId"];var qh=(Bh.prefixForUser=function(t){return[t]},Bh.prefixForPath=function(t,e){return[t,nh(e)]},Bh.key=function(t,e,n){return[t,nh(e),n]},Bh);function Bh(){}qh.store="documentMutations",qh.PLACEHOLDER=new qh;var Gh=function(t,e){this.path=t,this.readTime=e},zh=function(t,e){this.path=t,this.version=e},Wh=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Wh.store="remoteDocuments",Wh.readTimeIndex="readTimeIndex",Wh.readTimeIndexPath="readTime",Wh.collectionReadTimeIndex="collectionReadTimeIndex",Wh.collectionReadTimeIndexPath=["parentPath","readTime"];var Kh=function(t){this.byteSize=t};Kh.store="remoteDocumentGlobal",Kh.key="remoteDocumentGlobalKey";var Hh=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Hh.store="targets",Hh.keyPath="targetId",Hh.queryTargetsIndexName="queryTargetsIndex",Hh.queryTargetsKeyPath=["canonicalId","targetId"];var Qh=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Qh.store="targetDocuments",Qh.keyPath=["targetId","path"],Qh.documentTargetsIndex="documentTargetsIndex",Qh.documentTargetsKeyPath=["path","targetId"];var Yh=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Yh.key="targetGlobalKey",Yh.store="targetGlobal";var Xh=function(t,e){this.collectionId=t,this.parent=e};function $h(t){t.createObjectStore(Qh.store,{keyPath:Qh.keyPath}).createIndex(Qh.documentTargetsIndex,Qh.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Hh.store,{keyPath:Hh.keyPath}).createIndex(Hh.queryTargetsIndexName,Hh.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Yh.store)}Xh.store="collectionParents",Xh.keyPath=["collectionId","parent"];var Jh=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Jh.store="clientMetadata",Jh.keyPath="clientId";var Zh=s(s(s([jh.store,Fh.store,qh.store,Wh.store,Hh.store,Vh.store,Yh.store,Qh.store],[Jh.store]),[Kh.store]),[Xh.store]),tf=(ef.prototype.ko=function(t,e){var n=this;if(this.ha.has(e))return Va.resolve();var r=e._(),i=e.h();t.Vr(function(){n.ha.add(e)});var o={collectionId:r,parent:nh(i)};return nf(t).put(o)},ef.prototype.Ur=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Ti(i),""],!1,!0);return nf(t).Zn(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(ih(r.parent))}return o})},ef);function ef(){this.ha=new kh}function nf(t){return df.Un(t,Xh.store)}var rf=(uf.prototype.next=function(){return this.la+=2,this.la},uf._a=function(){return new uf(0)},uf.fa=function(){return new uf(-1)},uf),of=(sf.prototype.da=function(n){var r=this;return this.wa(n).next(function(t){var e=new rf(t.highestTargetId);return t.highestTargetId=e.next(),r.ma(n,t).next(function(){return t.highestTargetId})})},sf.prototype.Ta=function(t){return this.wa(t).next(function(t){return Ui.Y(new Ci(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},sf.prototype.Ea=function(t){return this.wa(t).next(function(t){return t.highestListenSequenceNumber})},sf.prototype.Ia=function(e,n,r){var i=this;return this.wa(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.X()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.ma(e,t)})},sf.prototype.Aa=function(e,n){var r=this;return this.Ra(e,n).next(function(){return r.wa(e).next(function(t){return t.targetCount+=1,r.Pa(n,t),r.ma(e,t)})})},sf.prototype.ga=function(t,e){return this.Ra(t,e)},sf.prototype.ya=function(e,t){var n=this;return this.Va(e,t.targetId).next(function(){return af(e).delete(t.targetId)}).next(function(){return n.wa(e)}).next(function(t){return Fr(0<t.targetCount),--t.targetCount,n.ma(e,t)})},sf.prototype.Vo=function(r,i,o){var s=this,u=0,a=[];return af(r).ss(function(t,e){var n=ph(e);n.sequenceNumber<=i&&null===o.get(n.targetId)&&(u++,a.push(s.ya(r,n)))}).next(function(){return Va.$n(a)}).next(function(){return u})},sf.prototype.De=function(t,r){return af(t).ss(function(t,e){var n=ph(e);r(n)})},sf.prototype.wa=function(t){return cf(t).get(Yh.key).next(function(t){return Fr(null!==t),t})},sf.prototype.ma=function(t,e){return cf(t).put(Yh.key,e)},sf.prototype.Ra=function(t,e){return af(t).put(dh(this.serializer,e))},sf.prototype.Pa=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},sf.prototype.pa=function(t){return this.wa(t).next(function(t){return t.targetCount})},sf.prototype.ba=function(t,i){var e=Qi(i),n=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),o=null;return af(t).ss({range:n,index:Hh.queryTargetsIndexName},function(t,e,n){var r=ph(e);Yi(i,r.target)&&(o=r,n.done())}).next(function(){return o})},sf.prototype.va=function(n,t,r){var i=this,o=[],s=hf(n);return t.forEach(function(t){var e=nh(t.path);o.push(s.put(new Qh(r,e))),o.push(i.Co.Sa(n,r,t))}),Va.$n(o)},sf.prototype.Da=function(n,t,r){var i=this,o=hf(n);return Va.forEach(t,function(t){var e=nh(t.path);return Va.$n([o.delete([r,e]),i.Co.Ca(n,r,t)])})},sf.prototype.Va=function(t,e){var n=hf(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},sf.prototype.Na=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=hf(t),o=bo();return r.ss({range:n,ns:!0},function(t,e,n){var r=ih(t[1]),i=new Xr(r);o=o.add(i)}).next(function(){return o})},sf.prototype.zo=function(t,e){var n=nh(e.path),r=IDBKeyRange.bound([n],[Ti(n)],!1,!0),i=0;return hf(t).ss({index:Qh.documentTargetsIndex,ns:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},sf.prototype.qe=function(t,e){return af(t).get(e).next(function(t){return t?ph(t):null})},sf);function sf(t,e){this.Co=t,this.serializer=e}function uf(t){this.la=t}function af(t){return df.Un(t,Hh.store)}function cf(t){return df.Un(t,Yh.store)}function hf(t){return df.Un(t,Qh.store)}var ff,lf="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",pf=(o(yf,ff=xc),yf),df=(vf.Un=function(t,e){if(t instanceof pf)return Ca.Un(t.Wo,e);throw jr()},vf.prototype.start=function(){var e=this;return this.Ga().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new xr(Or.FAILED_PRECONDITION,lf);return e.za(),e.Ha(),e.Ya(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.ja.Ea(t)})}).then(function(t){e.ka=new dc(t,e.$a)}).then(function(){e.Ma=!0}).catch(function(t){return e.Wa&&e.Wa.close(),Promise.reject(t)})},vf.prototype.Ja=function(n){var t=this;return this.Ua=function(e){return m(t,void 0,void 0,function(){return w(this,function(t){return this.Ti?[2,n(e)]:[2]})})},n(this.isPrimary)},vf.prototype.Xa=function(n){var t=this;this.Wa.jn(function(e){return m(t,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},vf.prototype.Za=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this._n.ds(function(){return m(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Ti?[4,this.Ga()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},vf.prototype.Ga=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return mf(e).put(new Jh(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.tc(e).next(function(t){t||(n.isPrimary=!1,n._n.Ds(function(){return n.Ua(!1)}))})}).next(function(){return n.ec(e)}).next(function(t){return n.isPrimary&&!t?n.nc(e).next(function(){return!1}):!!t&&n.sc(e).next(function(){return!0})})}).catch(function(t){if(za(t))return Vr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Vr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n._n.Ds(function(){return n.Ua(t)}),n.isPrimary=t})},vf.prototype.tc=function(t){var e=this;return gf(t).get(Vh.key).next(function(t){return Va.resolve(e.ic(t))})},vf.prototype.rc=function(t){return mf(t).delete(this.clientId)},vf.prototype.oc=function(){return m(this,void 0,void 0,function(){var e,n,r,i,o=this;return w(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.ac(this.qa,18e5)?[3,2]:(this.qa=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=vf.Un(t,Jh.store);return r.Zn().next(function(t){var e=o.cc(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return Va.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.Ka)for(n=0,r=e;n<r.length;n++)i=r[n],this.Ka.removeItem(this.uc(i.clientId));t.label=2;case 2:return[2]}})})},vf.prototype.Ya=function(){var t=this;this.Ba=this._n.gn("client_metadata_refresh",4e3,function(){return t.Ga().then(function(){return t.oc()}).then(function(){return t.Ya()})})},vf.prototype.ic=function(t){return!!t&&t.ownerId===this.clientId},vf.prototype.ec=function(e){var i=this;return this.xa?Va.resolve(!0):gf(e).get(Vh.key).next(function(t){if(null!==t&&i.ac(t.leaseTimestampMs,5e3)&&!i.hc(t.ownerId)){if(i.ic(t)&&i.networkEnabled)return!0;if(!i.ic(t)){if(!t.allowTabSynchronization)throw new xr(Or.FAILED_PRECONDITION,lf);return!1}}return!(!i.networkEnabled||!i.inForeground)||mf(e).Zn().next(function(t){return void 0===i.cc(t,5e3).find(function(t){if(i.clientId!==t.clientId){var e=!i.networkEnabled&&t.networkEnabled,n=!i.inForeground&&t.inForeground,r=i.networkEnabled===t.networkEnabled;if(e||n&&r)return!0}return!1})})}).next(function(t){return i.isPrimary!==t&&Vr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},vf.prototype.Si=function(){return m(this,void 0,void 0,function(){var n=this;return w(this,function(t){switch(t.label){case 0:return this.Ma=!1,this.lc(),this.Ba&&(this.Ba.cancel(),this.Ba=null),this._c(),this.fc(),[4,this.Wa.runTransaction("shutdown","readwrite",[Vh.store,Jh.store],function(t){var e=new pf(t,dc.oi);return n.nc(e).next(function(){return n.rc(e)})})];case 1:return t.sent(),this.Wa.close(),this.dc(),[2]}})})},vf.prototype.cc=function(t,e){var n=this;return t.filter(function(t){return n.ac(t.updateTimeMs,e)&&!n.hc(t.clientId)})},vf.prototype.Vi=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return mf(t).Zn().next(function(t){return e.cc(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(vf.prototype,"Ti",{get:function(){return this.Ma},enumerable:!1,configurable:!0}),vf.prototype.wc=function(t){return vh.Fo(t,this.serializer,this.Sr,this.Co)},vf.prototype.mc=function(){return this.ja},vf.prototype.Tc=function(){return this.br},vf.prototype.Ec=function(){return this.Sr},vf.prototype.runTransaction=function(e,n,r){var i=this;Vr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Wa.runTransaction(e,t,Zh,function(t){return o=new pf(t,i.ka?i.ka.next():dc.oi),"readwrite-primary"===n?i.tc(o).next(function(t){return!!t||i.ec(o)}).next(function(t){if(!t)throw Cr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i._n.Ds(function(){return i.Ua(!1)}),new xr(Or.FAILED_PRECONDITION,Oc);return r(o)}).next(function(t){return i.sc(o).next(function(){return t})}):i.Ic(o).next(function(){return r(o)})}).then(function(t){return o.pr(),t})},vf.prototype.Ic=function(t){var e=this;return gf(t).get(Vh.key).next(function(t){if(null!==t&&e.ac(t.leaseTimestampMs,5e3)&&!e.hc(t.ownerId)&&!e.ic(t)&&!(e.xa||e.allowTabSynchronization&&t.allowTabSynchronization))throw new xr(Or.FAILED_PRECONDITION,lf)})},vf.prototype.sc=function(t){var e=new Vh(this.clientId,this.allowTabSynchronization,Date.now());return gf(t).put(Vh.key,e)},vf.On=function(){return Ca.On()},vf.prototype.nc=function(t){var e=this,n=gf(t);return n.get(Vh.key).next(function(t){return e.ic(t)?(Vr("IndexedDbPersistence","Releasing primary lease."),n.delete(Vh.key)):Va.resolve()})},vf.prototype.ac=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Cr("Detected an update time that is in the future: "+t+" > "+n),1))},vf.prototype.za=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.La=function(){t._n.ds(function(){return t.inForeground="visible"===t.document.visibilityState,t.Ga()})},this.document.addEventListener("visibilitychange",this.La),this.inForeground="visible"===this.document.visibilityState)},vf.prototype._c=function(){this.La&&(this.document.removeEventListener("visibilitychange",this.La),this.La=null)},vf.prototype.Ha=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Oa=function(){e.lc(),e._n.ds(function(){return e.Si()})},this.window.addEventListener("unload",this.Oa))},vf.prototype.fc=function(){this.Oa&&(this.window.removeEventListener("unload",this.Oa),this.Oa=null)},vf.prototype.hc=function(t){var e;try{var n=null!==(null===(e=this.Ka)||void 0===e?void 0:e.getItem(this.uc(t)));return Vr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Cr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},vf.prototype.lc=function(){if(this.Ka)try{this.Ka.setItem(this.uc(this.clientId),String(Date.now()))}catch(t){Cr("Failed to set zombie client id.",t)}},vf.prototype.dc=function(){if(this.Ka)try{this.Ka.removeItem(this.uc(this.clientId))}catch(t){}},vf.prototype.uc=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},vf);function vf(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this._n=i,this.window=o,this.document=s,this.$a=a,this.xa=c,this.ka=null,this.Ma=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Oa=null,this.inForeground=!1,this.La=null,this.Ba=null,this.qa=Number.NEGATIVE_INFINITY,this.Ua=function(t){return Promise.resolve()},!vf.On())throw new xr(Or.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");var h,f;this.Co=new wf(this,r),this.Qa=e+"main",this.serializer=new oh(u),this.Wa=new Ca(this.Qa,10,new Lh(this.serializer)),this.ja=new of(this.Co,this.serializer),this.Sr=new tf,this.br=(h=this.serializer,f=this.Sr,new _h(h,f)),this.window&&this.window.localStorage?this.Ka=this.window.localStorage:(this.Ka=null,!1===c&&Cr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function yf(t,e){var n=this;return(n=ff.call(this)||this).Wo=t,n.Fa=e,n}function gf(t){return df.Un(t,Vh.store)}function mf(t){return df.Un(t,Jh.store)}var wf=(bf.prototype.Ro=function(t){var n=this.Ac(t);return this.db.mc().pa(t).next(function(e){return n.next(function(t){return e+t})})},bf.prototype.Ac=function(t){var e=0;return this.yo(t,function(t){e++}).next(function(){return e})},bf.prototype.De=function(t,e){return this.db.mc().De(t,e)},bf.prototype.yo=function(t,n){return this.Rc(t,function(t,e){return n(e)})},bf.prototype.Sa=function(t,e,n){return If(t,n)},bf.prototype.Ca=function(t,e,n){return If(t,n)},bf.prototype.Vo=function(t,e,n){return this.db.mc().Vo(t,e,n)},bf.prototype.Ko=If,bf.prototype.Pc=function(t,e){return r=e,i=!1,Ih(n=t).rs(function(t){return gh(n,t,r).next(function(t){return t&&(i=!0),Va.resolve(!t)})}).next(function(){return i});var n,r,i},bf.prototype.po=function(r,i){var o=this,s=this.db.Tc().ia(),u=[],a=0;return this.Rc(r,function(e,t){var n;t<=i&&(n=o.Pc(r,e).next(function(t){if(!t)return a++,s.Ar(r,e).next(function(){return s.Ir(e),hf(r).delete([0,nh(e.path)])})}),u.push(n))}).next(function(){return Va.$n(u)}).next(function(){return s.apply(r)}).next(function(){return a})},bf.prototype.removeTarget=function(t,e){var n=e.nt(t.Fa);return this.db.mc().ga(t,n)},bf.prototype.gc=If,bf.prototype.Rc=function(t,o){var s,e=hf(t),u=dc.oi;return e.ss({index:Qh.documentTargetsIndex},function(t,e){var n=t[0],r=(t[1],e.path),i=e.sequenceNumber;0===n?(u!==dc.oi&&o(new Xr(ih(s)),u),u=i,s=r):u=dc.oi}).next(function(){u!==dc.oi&&o(new Xr(ih(s)),u)})},bf.prototype.vo=function(t){return this.db.Tc().oa(t)},bf);function bf(t,e){this.db=t,this.do=new Zc(this,e)}function If(t,e){return hf(t).put((n=t.Fa,new Qh(0,nh(e.path),n)));var n}function Ef(t,e){var n=t.projectId;return t.W||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var _f=(Tf.prototype.Eo=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.bo(t,n.Vc)})},Tf);function Tf(t,e,n){this.persistence=t,this.yc=e,this.Vc=new io(Ei),this.bc=new Vi(Qi,Yi),this.vc=Ui.min(),this.vr=t.wc(n),this.Sc=t.Tc(),this.ja=t.mc(),this.Dc=new Rc(this.Sc,this.vr,this.persistence.Ec()),this.yc.Cc(this.Dc)}function Nf(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.ja.Ta(t)})}function Af(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.ja.ba(e,r).next(function(t){return t?(n=t,Va.resolve(n)):i.ja.da(e).next(function(t){return n=new to(r,t,0,e.Fa),i.ja.Aa(e,n).next(function(){return n})})})}).then(function(t){var e=i.Vc.get(t.targetId);return(null===e||0<t.et.L(e.et))&&(i.Vc=i.Vc.rt(t.targetId,t),i.bc.set(r,t.targetId)),t})}function Sf(o,s,u){return m(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:n=(e=o).Vc.get(s),r=u?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),u?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Co.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!za(i=t.sent()))throw i;return Vr("LocalStore","Failed to update sequence numbers for target "+s+": "+i),[3,5];case 5:return e.Vc=e.Vc.remove(s),e.bc.delete(n.target),[2]}})})}function Df(t,s,u){var a=t,c=Ui.min(),h=bo();return a.persistence.runTransaction("Execute query","readonly",function(e){return t=a,n=e,r=Hu(s),(void 0!==(o=(i=t).bc.get(r))?Va.resolve(i.Vc.get(o)):i.ja.ba(n,r)).next(function(t){if(t)return c=t.lastLimboFreeSnapshotVersion,a.ja.Na(e,t.targetId).next(function(t){h=t})}).next(function(){return a.yc.Or(e,s,u?c:Ui.min(),u?h:bo())}).next(function(t){return{documents:t,Nc:h}});var t,n,r,i,o})}function Of(t,e){var n=t,r=n.ja,i=n.Vc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.qe(t,e).next(function(t){return t?t.target:null})})}function xf(e){return m(this,void 0,void 0,function(){return w(this,function(t){if(e.code!==Or.FAILED_PRECONDITION||e.message!==Oc)throw e;return Vr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Rf(t,e){this.user=e,this.type="OAuth",this.jc={},this.jc.Authorization="Bearer "+t}function kf(t,e,n,r,i){var o=this;this.Wu=t,this.ju=e,this.os=n,this.Ku={},this.Gu=[],this.zu=new Map,this.Hu=new Set,this.Yu=[],this.Ju=i,this.Ju.Xu(function(t){n.ds(function(){return m(o,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return pl(this)?(Vr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return m(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return(e=n).Hu.add(4),[4,ol(e)];case 1:return t.sent(),e.Zu.set("Unknown"),e.Hu.delete(4),[4,il(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Zu=new Kf(n,r)}var Lf,Pf,Vf,Cf=(rl.prototype.m=function(){return this.$c.m()},rl.prototype.Sa=function(t,e){var n=new Uf(t,e);this.$c=this.$c.add(n),this.kc=this.kc.add(n)},rl.prototype.Oc=function(t,e){var n=this;t.forEach(function(t){return n.Sa(t,e)})},rl.prototype.Ca=function(t,e){this.Lc(new Uf(t,e))},rl.prototype.Bc=function(t,e){var n=this;t.forEach(function(t){return n.Ca(t,e)})},rl.prototype.qc=function(t){var e=this,n=new Xr(new Hr([])),r=new Uf(n,t),i=new Uf(n,t+1),o=[];return this.kc.Nt([r,i],function(t){e.Lc(t),o.push(t.key)}),o},rl.prototype.Uc=function(){var e=this;this.$c.forEach(function(t){return e.Lc(t)})},rl.prototype.Lc=function(t){this.$c=this.$c.delete(t),this.kc=this.kc.delete(t)},rl.prototype.Qc=function(t){var e=new Xr(new Hr([])),n=new Uf(e,t),r=new Uf(e,t+1),i=bo();return this.kc.Nt([n,r],function(t){i=i.add(t.key)}),i},rl.prototype.zo=function(t){var e=new Uf(t,0),n=this.$c.$t(e);return null!==n&&t.isEqual(n.key)},rl),Uf=(nl.xc=function(t,e){return Xr.i(t.key,e.key)||Ei(t.Wc,e.Wc)},nl.Mc=function(t,e){return Ei(t.Wc,e.Wc)||Xr.i(t.key,e.key)},nl),Mf=(el.prototype.getToken=function(){return Promise.resolve(null)},el.prototype.Gc=function(){},el.prototype.zc=function(t){(this.Kc=t)(fc.UNAUTHENTICATED)},el.prototype.Hc=function(){this.Kc=null},el),jf=(tl.prototype.getToken=function(){var e=this,n=this.Xc,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.Xc!==n?(Vr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Fr("string"==typeof t.accessToken),new Rf(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},tl.prototype.Gc=function(){this.forceRefresh=!0},tl.prototype.zc=function(t){this.Kc=t,this.Jc&&t(this.currentUser)},tl.prototype.Hc=function(){this.auth&&this.auth.removeAuthTokenListener(this.Yc),this.Yc=null,this.Kc=null},tl.prototype.Zc=function(){var t=this.auth&&this.auth.getUid();return Fr(null===t||"string"==typeof t),new fc(t)},tl),Ff=(Object.defineProperty(Zf.prototype,"jc",{get:function(){var t={"X-Goog-AuthUser":this.eu},e=this.tu.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Zf),qf=(Jf.prototype.getToken=function(){return Promise.resolve(new Ff(this.tu,this.eu))},Jf.prototype.zc=function(t){t(fc.ei)},Jf.prototype.Hc=function(){},Jf.prototype.Gc=function(){},Jf),Bf=($f.prototype.au=function(){return 1===this.state||2===this.state||4===this.state},$f.prototype.cu=function(){return 2===this.state},$f.prototype.start=function(){3!==this.state?this.auth():this.uu()},$f.prototype.stop=function(){return m(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.au()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},$f.prototype.hu=function(){this.state=0,this.gs.reset()},$f.prototype.lu=function(){var t=this;this.cu()&&null===this.ou&&(this.ou=this._n.gn(this.nu,6e4,function(){return t._u()}))},$f.prototype.fu=function(t){this.du(),this.stream.send(t)},$f.prototype._u=function(){return m(this,void 0,void 0,function(){return w(this,function(t){return this.cu()?[2,this.close(0)]:[2]})})},$f.prototype.du=function(){this.ou&&(this.ou.cancel(),this.ou=null)},$f.prototype.close=function(e,n){return m(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.du(),this.gs.cancel(),this.ru++,3!==e?this.gs.reset():n&&n.code===Or.RESOURCE_EXHAUSTED?(Cr(n.toString()),Cr("Using maximum backoff delay to prevent overloading the backend."),this.gs.An()):n&&n.code===Or.UNAUTHENTICATED&&this.iu.Gc(),null!==this.stream&&(this.wu(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.mu(n)];case 1:return t.sent(),[2]}})})},$f.prototype.wu=function(){},$f.prototype.auth=function(){var n=this;this.state=1;var t=this.Tu(this.ru),e=this.ru;this.iu.getToken().then(function(t){n.ru===e&&n.Eu(t)},function(e){t(function(){var t=new xr(Or.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Iu(t)})})},$f.prototype.Eu=function(t){var e=this,n=this.Tu(this.ru);this.stream=this.Au(t),this.stream.Ru(function(){n(function(){return e.state=2,e.listener.Ru()})}),this.stream.mu(function(t){n(function(){return e.Iu(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},$f.prototype.uu=function(){var t=this;this.state=4,this.gs.Rn(function(){return m(t,void 0,void 0,function(){return w(this,function(t){return this.state=0,this.start(),[2]})})})},$f.prototype.Iu=function(t){return Vr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},$f.prototype.Tu=function(e){var n=this;return function(t){n._n.ds(function(){return n.ru===e?t():(Vr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},$f),Gf=(o(Xf,Vf=Bf),Xf.prototype.Au=function(t){return this.su.Pu("Listen",t)},Xf.prototype.onMessage=function(t){this.gs.reset();var e=function(t,e){var n,r,i,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:jr(),u=e.targetChange.targetIds||[],a=(i=e.targetChange.resumeToken,t.Ue?(Fr(void 0===i||"string"==typeof i),Ni.fromBase64String(i||"")):(Fr(void 0===i||i instanceof Uint8Array),Ni.fromUint8Array(i||new Uint8Array))),c=e.targetChange.cause,h=c&&(r=void 0===(n=c).code?Or.UNKNOWN:ro(n.code),new xr(r,n.message||"")),f=new Oo(s,u,a,h||null)}else if("documentChange"in e){e.documentChange;var l=e.documentChange;l.document,l.document.name,l.document.updateTime;var p=gs(t,l.document.name),d=ps(l.document.updateTime),v=new Eu({mapValue:{fields:l.document.fields}}),y=new ku(p,d,v,{}),g=l.targetIds||[],m=l.removedTargetIds||[],f=new So(g,m,y.key,y)}else if("documentDelete"in e){e.documentDelete;var w=e.documentDelete;w.document;var b=gs(t,w.document),I=w.readTime?ps(w.readTime):Ui.min(),E=new Lu(b,I),_=w.removedTargetIds||[];f=new So([],_,E.key,E)}else if("documentRemove"in e){e.documentRemove;var T=e.documentRemove;T.document;var N=gs(t,T.document),A=T.removedTargetIds||[];f=new So([],A,N,null)}else{if(!("filter"in e))return jr();e.filter;var S=e.filter;S.targetId;var D=new $i(S.count||0),O=S.targetId;f=new Do(O,D)}return f}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Ui.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Ui.min():ps(e.readTime)}(t);return this.listener.gu(e,n)},Xf.prototype.yu=function(t){var e,n,r,i,o={};o.database=bs(this.serializer),o.addTarget=(e=this.serializer,(r=Xi(i=(n=t).target)?{documents:Ns(e,i)}:{query:As(e,i)}).targetId=n.targetId,0<n.resumeToken.O()&&(r.resumeToken=ls(e,n.resumeToken)),r);var s,u,a=(this.serializer,s=t,null==(u=function(){switch(s.tt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return jr()}}())?null:{"goog-listen-tags":u});a&&(o.labels=a),this.fu(o)},Xf.prototype.Vu=function(t){var e={};e.database=bs(this.serializer),e.removeTarget=t,this.fu(e)},Xf),zf=(o(Yf,Pf=Bf),Object.defineProperty(Yf.prototype,"bu",{get:function(){return this.pu},enumerable:!1,configurable:!0}),Yf.prototype.start=function(){this.pu=!1,this.lastStreamToken=void 0,Pf.prototype.start.call(this)},Yf.prototype.wu=function(){this.pu&&this.vu([])},Yf.prototype.Au=function(t){return this.su.Pu("Write",t)},Yf.prototype.onMessage=function(t){if(Fr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.pu){this.gs.reset();var e=(r=t.writeResults,i=t.commitTime,r&&0<r.length?(Fr(void 0!==i),r.map(function(t){return function(t,e){var n=t.updateTime?ps(t.updateTime):ps(e);n.isEqual(Ui.min())&&(n=ps(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new Zs(n,r)}(t,i)})):[]),n=ps(t.commitTime);return this.listener.Su(n,e)}var r,i;return Fr(!t.writeResults||0===t.writeResults.length),this.pu=!0,this.listener.Du()},Yf.prototype.Cu=function(){var t={};t.database=bs(this.serializer),this.fu(t)},Yf.prototype.vu=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return _s(e.serializer,t)})};this.fu(n)},Yf),Wf=(o(Qf,Lf=function(){}),Qf.prototype.Fu=function(){if(this.Nu)throw new xr(Or.FAILED_PRECONDITION,"The client has already been terminated.")},Qf.prototype.$u=function(e,n,r){var i=this;return this.Fu(),this.credentials.getToken().then(function(t){return i.su.$u(e,n,r,t)}).catch(function(t){throw t.code===Or.UNAUTHENTICATED&&i.credentials.Gc(),t})},Qf.prototype.xu=function(e,n,r){var i=this;return this.Fu(),this.credentials.getToken().then(function(t){return i.su.xu(e,n,r,t)}).catch(function(t){throw t.code===Or.UNAUTHENTICATED&&i.credentials.Gc(),t})},Qf.prototype.terminate=function(){this.Nu=!1},Qf),Kf=(Hf.prototype.Lu=function(){var t=this;0===this.ku&&(this.Bu("Unknown"),this.Mu=this.os.gn("online_state_timeout",1e4,function(){return t.Mu=null,t.qu("Backend didn't respond within 10 seconds."),t.Bu("Offline"),Promise.resolve()}))},Hf.prototype.Uu=function(t){"Online"===this.state?this.Bu("Unknown"):(this.ku++,1<=this.ku&&(this.Qu(),this.qu("Connection failed 1 times. Most recent error: "+t.toString()),this.Bu("Offline")))},Hf.prototype.set=function(t){this.Qu(),this.ku=0,"Online"===t&&(this.Ou=!1),this.Bu(t)},Hf.prototype.Bu=function(t){t!==this.state&&(this.state=t,this.fi(t))},Hf.prototype.qu=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Ou?(Cr(e),this.Ou=!1):Vr("OnlineStateTracker",e)},Hf.prototype.Qu=function(){null!==this.Mu&&(this.Mu.cancel(),this.Mu=null)},Hf);function Hf(t,e){this.os=t,this.fi=e,this.state="Unknown",this.ku=0,this.Mu=null,this.Ou=!0}function Qf(t,e,n){var r=this;return(r=Lf.call(this)||this).credentials=t,r.su=e,r.serializer=n,r.Nu=!1,r}function Yf(t,e,n,r,i){var o=this;return(o=Pf.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.pu=!1,o}function Xf(t,e,n,r,i){var o=this;return(o=Vf.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function $f(t,e,n,r,i,o){this._n=t,this.nu=n,this.su=r,this.iu=i,this.listener=o,this.state=0,this.ru=0,this.ou=null,this.stream=null,this.gs=new Pa(t,e)}function Jf(t,e){this.tu=t,this.eu=e}function Zf(t,e){this.tu=t,this.eu=e,this.type="FirstParty",this.user=fc.ei}function tl(t){var e=this;this.Yc=null,this.currentUser=fc.UNAUTHENTICATED,this.Jc=!1,this.Xc=0,this.Kc=null,this.forceRefresh=!1,this.Yc=function(){e.Xc++,e.currentUser=e.Zc(),e.Jc=!0,e.Kc&&e.Kc(e.currentUser)},this.Xc=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Yc):(this.Yc(null),t.get().then(function(t){e.auth=t,e.Yc&&e.auth.addAuthTokenListener(e.Yc)},function(){}))}function el(){this.Kc=null}function nl(t,e){this.key=t,this.Wc=e}function rl(){this.$c=new fo(Uf.xc),this.kc=new fo(Uf.Mc)}function il(r){return m(this,void 0,void 0,function(){var e,n;return w(this,function(t){switch(t.label){case 0:if(!pl(r))return[3,4];e=0,n=r.Yu,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function ol(r){return m(this,void 0,void 0,function(){var e,n;return w(this,function(t){switch(t.label){case 0:e=0,n=r.Yu,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function sl(n){return m(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return e=n,Vr("RemoteStore","RemoteStore shutting down."),e.Hu.add(5),[4,ol(e)];case 1:return t.sent(),e.Ju.Si(),e.Zu.set("Unknown"),[2]}})})}function ul(t,e){var n=t;n.zu.has(e.targetId)||(n.zu.set(e.targetId,e),ll(n)?fl(n):Il(n).cu()&&cl(n,e))}function al(t,e){var n=t,r=Il(n);n.zu.delete(e),r.cu()&&hl(n,e),0===n.zu.size&&(r.cu()?r.lu():pl(n)&&n.Zu.set("Unknown"))}function cl(t,e){t.th.Ee(e.targetId),Il(t).yu(e)}function hl(t,e){t.th.Ee(e),Il(t).Vu(e)}function fl(e){e.th=new Ro({Be:function(t){return e.Ku.Be(t)},qe:function(t){return e.zu.get(t)||null}}),Il(e).start(),e.Zu.Lu()}function ll(t){return pl(t)&&!Il(t).au()&&0<t.zu.size}function pl(t){return 0===t.Hu.size}function dl(t){t.th=void 0}function vl(n,r,i){return m(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:if(!za(r))throw r;return n.Hu.add(1),[4,ol(n)];case 1:return t.sent(),n.Zu.set("Offline"),i=i||function(){return Nf(n.Wu)},n.os.Ds(function(){return m(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return Vr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Hu.delete(1),[4,il(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function yl(e,n){return n().catch(function(t){return vl(e,t,n)})}function gl(c){return m(this,void 0,void 0,function(){var i,o,s,u,a;return w(this,function(t){switch(t.label){case 0:o=El(i=c),s=0<i.Gu.length?i.Gu[i.Gu.length-1].batchId:-1,t.label=1;case 1:if(!(pl(i)&&i.Gu.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.Wu,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.vr.Lo(t,n)}))];case 3:return null===(u=t.sent())?(0===i.Gu.length&&o.lu(),[3,7]):(s=u.batchId,function(t,e){t.Gu.push(e);var n=El(t);n.cu()&&n.bu&&n.vu(e.mutations)}(i,u),[3,6]);case 4:return a=t.sent(),[4,vl(i,a)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return ml(i)&&wl(i),[2]}var e,n,r})})}function ml(t){return pl(t)&&!El(t).au()&&0<t.Gu.length}function wl(t){El(t).start()}function bl(n,r){return m(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return e=n,r?(e.Hu.delete(2),[4,il(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Hu.add(2),[4,ol(e)]);case 3:t.sent(),e.Zu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function Il(n){var t,e,r,i,o=this;return n.rh||(n.rh=(t=n.ju,e=n.os,r={Ru:function(n){return m(this,void 0,void 0,function(){return w(this,function(t){return n.zu.forEach(function(t,e){cl(n,t)}),[2]})})}.bind(null,n),mu:function(e,n){return m(this,void 0,void 0,function(){return w(this,function(t){return dl(e),ll(e)?(e.Zu.Uu(n),fl(e)):e.Zu.set("Unknown"),[2]})})}.bind(null,n),gu:function(u,a,c){return m(this,void 0,void 0,function(){var n,o,s;return w(this,function(t){switch(t.label){case 0:if(u.Zu.set("Online"),!(a instanceof Oo&&2===a.state&&a.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return m(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.zu.has(i)?[4,o.Ku.eh(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.zu.delete(i),o.th.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(u,a)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Vr("RemoteStore","Failed to remove targets %s: %s ",a.targetIds.join(","),n),[4,vl(u,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(a instanceof So?u.th.pe(a):a instanceof Do?u.th.$e(a):u.th.Se(a),c.isEqual(Ui.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Nf(u.Wu)];case 8:return o=t.sent(),0<=c.L(o)?[4,(i=c,(e=(r=u).th.Me(i)).Gt.forEach(function(t,e){var n;0<t.resumeToken.O()&&(n=r.zu.get(e))&&r.zu.set(e,n.st(t.resumeToken,i))}),e.zt.forEach(function(t){var e,n=r.zu.get(t);n&&(r.zu.set(t,n.st(Ni.B,n.et)),hl(r,t),e=new to(n.target,t,1,n.sequenceNumber),cl(r,e))}),r.Ku.nh(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Vr("RemoteStore","Failed to raise snapshot:",s=t.sent()),[4,vl(u,s)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},(i=t).Fu(),new Gf(e,i.su,i.credentials,i.serializer,r)),n.Yu.push(function(e){return m(o,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e?(n.rh.hu(),ll(n)?fl(n):n.Zu.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.rh.stop()];case 2:t.sent(),dl(n),t.label=3;case 3:return[2]}})})})),n.rh}function El(n){var t,e,r,i,o=this;return n.oh||(n.oh=(t=n.ju,e=n.os,r={Ru:function(e){return m(this,void 0,void 0,function(){return w(this,function(t){return El(e).Cu(),[2]})})}.bind(null,n),mu:function(e,n){return m(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return n&&El(e).bu?[4,function(r,i){return m(this,void 0,void 0,function(){var e,n;return w(this,function(t){switch(t.label){case 0:return no(n=i.code)&&n!==Or.ABORTED?(e=r.Gu.shift(),El(r).hu(),[4,yl(r,function(){return r.Ku.ih(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,gl(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return ml(e)&&wl(e),[2]}})})}.bind(null,n),Du:function(o){return m(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){for(e=El(o),n=0,r=o.Gu;n<r.length;n++)i=r[n],e.vu(i.mutations);return[2]})})}.bind(null,n),Su:function(r,i,o){return m(this,void 0,void 0,function(){var e,n;return w(this,function(t){switch(t.label){case 0:return e=r.Gu.shift(),n=Sc.from(e,i,o),[4,yl(r,function(){return r.Ku.sh(n)})];case 1:return t.sent(),[4,gl(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},(i=t).Fu(),new zf(e,i.su,i.credentials,i.serializer,r)),n.Yu.push(function(e){return m(o,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e?(n.oh.hu(),[4,gl(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.oh.stop()];case 3:t.sent(),0<n.Gu.length&&(Vr("RemoteStore","Stopping write stream with "+n.Gu.length+" pending writes"),n.Gu=[]),t.label=4;case 4:return[2]}})})})),n.oh}var _l=function(t){this.key=t},Tl=function(t){this.key=t},Nl=(Object.defineProperty(xl.prototype,"fh",{get:function(){return this.ah},enumerable:!1,configurable:!0}),xl.prototype.dh=function(t,e){var u=this,a=e?e.wh:new _o,c=e?e._h:this._h,h=e?e.Qt:this.Qt,f=c,l=!1,p=qu(this.query)&&c.size===this.query.limit?c.last():null,d=Bu(this.query)&&c.size===this.query.limit?c.first():null;if(t.ut(function(t,e){var n=c.get(t),r=(r=e instanceof ku?e:null)&&(ta(u.query,r)?r:null),i=!!n&&u.Qt.has(n.key),o=!!r&&(r.Ye||u.Qt.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(a.track({type:3,doc:r}),s=!0):u.mh(n,r)||(a.track({type:2,doc:r}),s=!0,(p&&0<u.lh(r,p)||d&&u.lh(r,d)<0)&&(l=!0)):!n&&r?(a.track({type:0,doc:r}),s=!0):n&&!r&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(l=!0)),s&&(h=r?(f=f.add(r),o?h.add(t):h.delete(t)):(f=f.delete(t),h.delete(t)))}),qu(this.query)||Bu(this.query))for(;f.size>this.query.limit;){var n=qu(this.query)?f.last():f.first(),f=f.delete(n.key),h=h.delete(n.key);a.track({type:1,doc:n})}return{_h:f,wh:a,Th:l,Qt:h}},xl.prototype.mh=function(t,e){return t.Ye&&e.hasCommittedMutations&&!e.Ye},xl.prototype.gr=function(t,e,n){var o=this,r=this._h;this._h=t._h,this.Qt=t.Qt;var i=t.wh.qt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.lh(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return jr()}}var r,i}),this.Eh(n);var s=e?this.Ih():[],u=0===this.hh.size&&this.Zt?1:0,a=u!==this.uh;return this.uh=u,0!==i.length||a?{snapshot:new To(this.query,t._h,r,i,t.Qt,0==u,a,!1),Ah:s}:{Ah:s}},xl.prototype.Us=function(t){return this.Zt&&"Offline"===t?(this.Zt=!1,this.gr({_h:this._h,wh:new _o,Qt:this.Qt,Th:!1},!1)):{Ah:[]}},xl.prototype.Rh=function(t){return!this.ah.has(t)&&!!this._h.has(t)&&!this._h.get(t).Ye},xl.prototype.Eh=function(t){var e=this;t&&(t.te.forEach(function(t){return e.ah=e.ah.add(t)}),t.ee.forEach(function(t){}),t.ne.forEach(function(t){return e.ah=e.ah.delete(t)}),this.Zt=t.Zt)},xl.prototype.Ih=function(){var e=this;if(!this.Zt)return[];var n=this.hh;this.hh=bo(),this._h.forEach(function(t){e.Rh(t.key)&&(e.hh=e.hh.add(t.key))});var r=[];return n.forEach(function(t){e.hh.has(t)||r.push(new Tl(t))}),this.hh.forEach(function(t){n.has(t)||r.push(new _l(t))}),r},xl.prototype.Ph=function(t){this.ah=t.Nc,this.hh=bo();var e=this.dh(t.documents);return this.gr(e,!0)},xl.prototype.gh=function(){return To.Kt(this.query,this._h,this.Qt,0===this.uh)},xl),Al=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Sl=function(t){this.key=t,this.yh=!1},Dl=(Object.defineProperty(Ol.prototype,"qh",{get:function(){return!0===this.Bh},enumerable:!1,configurable:!0}),Ol);function Ol(t,e,n,r,i,o){this.Wu=t,this.Vh=e,this.ph=n,this.bh=r,this.currentUser=i,this.Sh=o,this.Dh={},this.Ch=new Vi(Ju,$u),this.Nh=new Map,this.Fh=[],this.$h=new io(Xr.i),this.xh=new Map,this.kh=new Cf,this.Mh={},this.Oh=new Map,this.Lh=rf.fa(),this.onlineState="Unknown",this.Bh=void 0}function xl(t,e){this.query=t,this.ah=e,this.uh=null,this.Zt=!1,this.hh=bo(),this.Qt=bo(),this.lh=ea(t),this._h=new Eo(this.lh)}function Rl(u,a,c,h){return m(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return u.Uh=function(t,e,n){return function(i,o,s,u){return m(this,void 0,void 0,function(){var n,e,r;return w(this,function(t){switch(t.label){case 0:return(n=o.view.dh(s)).Th?[4,Df(i.Wu,o.query,!1).then(function(t){var e=t.documents;return o.view.dh(e,n)})]:[3,2];case 1:n=t.sent(),t.label=2;case 2:return e=u&&u.Gt.get(o.targetId),r=o.view.gr(n,i.qh,e),[2,(Ml(i,o.targetId,r.Ah),r.snapshot)]}})})}(u,t,e,n)},[4,Df(u.Wu,a,!0)];case 1:return e=t.sent(),n=new Nl(a,e.Nc),r=n.dh(e.documents),i=Ao.Xt(c,h&&"Offline"!==u.onlineState),o=n.gr(r,u.qh,i),Ml(u,c,o.Ah),s=new Al(a,c,n),[2,(u.Ch.set(a,s),u.Nh.has(c)?u.Nh.get(c).push(a):u.Nh.set(c,[a]),o.snapshot)]}})})}function kl(i,o){return m(this,void 0,void 0,function(){var r,n;return w(this,function(t){switch(t.label){case 0:r=i,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=r.Wu,h=e,f=(s=o).et,l=h.Vc,h.persistence.runTransaction("Apply remote event","readwrite-primary",function(a){var i=h.Sc.ia({ra:!0});l=h.Vc;var c=[];s.Gt.forEach(function(t,e){var n,r,i,o,s,u=l.get(e);u&&(c.push(h.ja.Da(a,t.ne,e).next(function(){return h.ja.va(a,t.te,e)})),0<(n=t.resumeToken).O()&&(r=u.st(n,f).nt(a.Fa),l=l.rt(e,r),i=u,s=t,Fr(0<(o=r).resumeToken.O()),(0===i.resumeToken.O()||3e8<=o.et.J()-i.et.J()||0<s.te.size+s.ee.size+s.ne.size)&&c.push(h.ja.ga(a,r))))});var t,o=po,n=bo();return s.Ht.forEach(function(t,e){n=n.add(t)}),c.push(i.getEntries(a,n).next(function(r){s.Ht.forEach(function(t,e){var n=r.get(t);e instanceof Lu&&e.version.isEqual(Ui.min())?(i.Ir(t,f),o=o.rt(t,e)):null==n||0<e.version.L(n.version)||0===e.version.L(n.version)&&n.hasPendingWrites?(i.Tr(e,f),o=o.rt(t,e)):Vr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),s.Yt.has(t)&&c.push(h.persistence.Co.gc(a,t))})})),f.isEqual(Ui.min())||(t=h.ja.Ta(a).next(function(t){return h.ja.Ia(a,a.Fa,f)}),c.push(t)),Va.$n(c).next(function(){return i.apply(a)}).next(function(){return h.Dc.kr(a,o)})}).then(function(t){return h.Vc=l,t}))];case 2:return n=t.sent(),o.Gt.forEach(function(t,e){var n=r.xh.get(e);n&&(Fr(t.te.size+t.ee.size+t.ne.size<=1),0<t.te.size?n.yh=!0:0<t.ee.size?Fr(n.yh):0<t.ne.size&&(Fr(n.yh),n.yh=!1))}),[4,Fl(r,n,o)];case 3:return t.sent(),[3,6];case 4:return[4,xf(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,s,h,f,l})})}function Ll(t,r,e){var i,n=t;(n.qh&&0===e||!n.qh&&1===e)&&(i=[],n.Ch.forEach(function(t,e){var n=e.view.Us(r);n.snapshot&&i.push(n.snapshot)}),function(t,i){var e=t;e.onlineState=i;var o=!1;e.Ls.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Us(i)&&(o=!0)}),o&&cc(e)}(n.ph,r),i.length&&n.Dh.gu(i),n.onlineState=r,n.qh&&n.bh.ji(r))}function Pl(t,e){(t.Oh.get(e)||[]).forEach(function(t){t.resolve()}),t.Oh.delete(e)}function Vl(t,e,n){var r,i=t,o=i.Mh[i.currentUser.Zs()];o&&((r=o.get(e))&&(n?r.reject(n):r.resolve(),o=o.remove(e)),i.Mh[i.currentUser.Zs()]=o)}function Cl(e,t,n){void 0===n&&(n=null),e.bh.Li(t);for(var r=0,i=e.Nh.get(t);r<i.length;r++){var o=i[r];e.Ch.delete(o),n&&e.Dh.Qh(o,n)}e.Nh.delete(t),e.qh&&e.kh.qc(t).forEach(function(t){e.kh.zo(t)||Ul(e,t)})}function Ul(t,e){var n=t.$h.get(e);null!==n&&(al(t.Vh,n),t.$h=t.$h.remove(e),t.xh.delete(n),jl(t))}function Ml(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof _l?(t.kh.Sa(u.key,e),r=t,i=u.key,r.$h.get(i)||(Vr("SyncEngine","New document in limbo: "+i),r.Fh.push(i),jl(r))):u instanceof Tl?(Vr("SyncEngine","Document no longer in limbo: "+u.key),t.kh.Ca(u.key,e),t.kh.zo(u.key)||Ul(t,u.key)):jr()}}function jl(t){for(;0<t.Fh.length&&t.$h.size<t.Sh;){var e=t.Fh.shift(),n=t.Lh.next();t.xh.set(n,new Sl(e)),t.$h=t.$h.rt(e,n),ul(t.Vh,new to(Hu(Fu(e.path)),n,2,dc.oi))}}function Fl(n,s,u){return m(this,void 0,void 0,function(){var r,i,o,e;return w(this,function(t){switch(t.label){case 0:return i=[],o=[],e=[],(r=n).Ch.m()?[3,3]:(r.Ch.forEach(function(t,n){e.push(r.Uh(n,s,u).then(function(t){var e;t&&(r.qh&&r.bh.Ui(n.targetId,t.fromCache?"not-current":"current"),i.push(t),e=kc.Gr(n.targetId,t),o.push(e))}))}),[4,Promise.all(e)]);case 1:return t.sent(),r.Dh.gu(i),[4,function(h,f){return m(this,void 0,void 0,function(){var r,e,n,i,o,s,u,a,c;return w(this,function(t){switch(t.label){case 0:r=h,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Va.forEach(f,function(e){return Va.forEach(e.jr,function(t){return r.persistence.Co.Sa(n,e.targetId,t)}).next(function(){return Va.forEach(e.Kr,function(t){return r.persistence.Co.Ca(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!za(e=t.sent()))throw e;return Vr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=f;n<i.length;n++)o=i[n],s=o.targetId,o.fromCache||(u=r.Vc.get(s),a=u.et,c=u.it(a),r.Vc=r.Vc.rt(s,c));return[2]}})})}(r.Wu,o)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function ql(v,y){return m(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l,p,d;return w(this,function(t){switch(t.label){case 0:e=v,n=[],r=[],i=0,o=y,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.Nh.get(s))&&0!==a.length?[4,Af(e.Wu,Hu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],l=e.Ch.get(f),[4,function(i,o){return m(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return[4,Df((e=i).Wu,o.query,!0)];case 1:return n=t.sent(),r=o.view.Ph(n),[2,(e.qh&&Ml(e,o.targetId,r.Ah),r)]}})})}(e,l)]):[3,6];case 4:(p=t.sent()).snapshot&&r.push(p.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,Of(e.Wu,s)];case 8:return d=t.sent(),[4,Af(e.Wu,d)];case 9:return u=t.sent(),[4,Rl(e,Bl(d),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.Dh.gu(r),n)]}})})}function Bl(t){return ju(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Gl(t){var e=t;return e.Vh.Ku.nh=kl.bind(null,e),e.Vh.Ku.Be=function(t,e){var n=t,r=n.xh.get(e);if(r&&r.yh)return bo().add(r.key);var i=bo(),o=n.Nh.get(e);if(!o)return i;for(var s=0,u=o;s<u.length;s++)var a=u[s],c=n.Ch.get(a),i=i.xt(c.view.fh);return i}.bind(null,e),e.Vh.Ku.eh=function(u,a,c){return m(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return(e=u).bh.Ui(a,"rejected",c),n=e.xh.get(a),(r=n&&n.key)?(i=(i=new io(Xr.i)).rt(r,new Lu(r,Ui.min())),o=bo().add(r),s=new No(Ui.min(),new Map,new fo(Ei),i,o),[4,kl(e,s)]):[3,2];case 1:return t.sent(),e.$h=e.$h.remove(r),e.xh.delete(a),jl(e),[3,4];case 2:return[4,Sf(e.Wu,a,!1).then(function(){return Cl(e,a,c)}).catch(xf)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.Dh.gu=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,a=n.Ls.get(u);if(a){for(var c=0,h=a.listeners;c<h.length;c++)h[c].Qs(s)&&(r=!0);a.Os=s}}r&&cc(n)}.bind(null,e.ph),e.Dh.Qh=function(t,e,n){var r=t,i=r.Ls.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.Ls.delete(e)}.bind(null,e.ph),e}function zl(t){var e=t;return e.Vh.Ku.sh=function(o,s){return m(this,void 0,void 0,function(){var n,r,i;return w(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Wu,h=s,(f=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var i,e=h.batch.keys(),n=f.Sc.ia({ra:!0}),r=f,o=t,s=n,u=(i=h).batch,a=u.keys(),c=Va.resolve();return a.forEach(function(r){c=c.next(function(){return s.Ar(o,r)}).next(function(t){var e=t,n=i._r.get(r);Fr(null!==n),(!e||e.version.L(n)<0)&&(e=u.ar(r,e,i))&&s.Tr(e,i.lr)})}),c.next(function(){return r.vr.Qo(o,u)}).next(function(){return n.apply(t)}).next(function(){return f.vr.Go(t)}).next(function(){return f.Dc.$r(t,e)})}))];case 2:return i=t.sent(),Vl(n,r,null),Pl(n,r),n.bh.xi(r,"acknowledged"),[4,Fl(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,xf(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,h,f})})}.bind(null,e),e.Vh.Ku.ih=function(s,u,a){return m(this,void 0,void 0,function(){var n,o;return w(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Wu,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.vr.Mo(e,r).next(function(t){return Fr(null!==t),n=t.keys(),i.vr.Qo(e,t)}).next(function(){return i.vr.Go(e)}).next(function(){return i.Dc.$r(e,n)})}))];case 2:return o=t.sent(),Vl(n,u,a),Pl(n,u),n.bh.xi(u,"rejected",a),[4,Fl(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,xf(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,e),e}var Wl,Kl,Hl,Ql=(wp.prototype.Cc=function(t){this.Gh=t},wp.prototype.Or=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.rn.length||1===r.rn.length&&r.rn[0].field.p())||i.isEqual(Ui.min())?this.zh(e,r):this.Gh.$r(e,o).next(function(t){var n=s.Hh(r,t);return(qu(r)||Bu(r))&&s.Th(r.on,n,o,i)?s.zh(e,r):(Pr()<=l.DEBUG&&Vr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Zu(r)),s.Gh.Or(e,r,i).next(function(e){return n.forEach(function(t){e=e.rt(t.key,t)}),e}))})},wp.prototype.Hh=function(n,t){var r=new fo(ea(n));return t.forEach(function(t,e){e instanceof ku&&ta(n,e)&&(r=r.add(e))}),r},wp.prototype.Th=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.L(r))},wp.prototype.zh=function(t,e){return Pr()<=l.DEBUG&&Vr("IndexFreeQueryEngine","Using full collection scan to execute query:",Zu(e)),this.Gh.Or(t,e,Ui.min())},wp),Yl=(mp.prototype.$o=function(t){return Va.resolve(0===this.vr.length)},mp.prototype.xo=function(t,e,n,r){var i=this.Yh;this.Yh++,0<this.vr.length&&this.vr[this.vr.length-1];var o=new Ac(i,e,n,r);this.vr.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.Jh=this.Jh.add(new Uf(a.key,i)),this.Sr.ko(t,a.key.path.h())}return Va.resolve(o)},mp.prototype.Mo=function(t,e){return Va.resolve(this.Xh(e))},mp.prototype.Lo=function(t,e){var n=e+1,r=this.Zh(n),i=r<0?0:r;return Va.resolve(this.vr.length>i?this.vr[i]:null)},mp.prototype.Bo=function(){return Va.resolve(0===this.vr.length?-1:this.Yh-1)},mp.prototype.qo=function(t){return Va.resolve(this.vr.slice())},mp.prototype.Cr=function(t,e){var n=this,r=new Uf(e,0),i=new Uf(e,Number.POSITIVE_INFINITY),o=[];return this.Jh.Nt([r,i],function(t){var e=n.Xh(t.Wc);o.push(e)}),Va.resolve(o)},mp.prototype.Mr=function(t,e){var r=this,i=new fo(Ei);return e.forEach(function(t){var e=new Uf(t,0),n=new Uf(t,Number.POSITIVE_INFINITY);r.Jh.Nt([e,n],function(t){i=i.add(t.Wc)})}),Va.resolve(this.tl(i))},mp.prototype.Qr=function(t,e){var n=e.path,r=n.length+1,i=n;Xr.F(i)||(i=i.child(""));var o=new Uf(new Xr(i),0),s=new fo(Ei);return this.Jh.Ft(function(t){var e=t.key.path;return!!n.T(e)&&(e.length===r&&(s=s.add(t.Wc)),!0)},o),Va.resolve(this.tl(s))},mp.prototype.tl=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.Xh(t);null!==e&&r.push(e)}),r},mp.prototype.Qo=function(n,r){var i=this;Fr(0===this.el(r.batchId,"removed")),this.vr.shift();var o=this.Jh;return Va.forEach(r.mutations,function(t){var e=new Uf(t.key,r.batchId);return o=o.delete(e),i.Co.Ko(n,t.key)}).next(function(){i.Jh=o})},mp.prototype.jo=function(t){},mp.prototype.zo=function(t,e){var n=new Uf(e,0),r=this.Jh.$t(n);return Va.resolve(e.isEqual(r&&r.key))},mp.prototype.Go=function(t){return this.vr.length,Va.resolve()},mp.prototype.el=function(t,e){return this.Zh(t)},mp.prototype.Zh=function(t){return 0===this.vr.length?0:t-this.vr[0].batchId},mp.prototype.Xh=function(t){var e=this.Zh(t);return e<0||e>=this.vr.length?null:this.vr[e]},mp),Xl=(gp.prototype.Tr=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.nl(e);return this.docs=this.docs.rt(r,{Zo:e,size:s,readTime:n}),this.size+=s-o,this.Sr.ko(t,r.path.h())},gp.prototype.Ir=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},gp.prototype.Ar=function(t,e){var n=this.docs.get(e);return Va.resolve(n?n.Zo:null)},gp.prototype.getEntries=function(t,e){var n=this,r=po;return e.forEach(function(t){var e=n.docs.get(t);r=r.rt(t,e?e.Zo:null)}),Va.resolve(r)},gp.prototype.Or=function(t,e,n){for(var r=go,i=new Xr(e.path.child("")),o=this.docs._t(i);o.It();){var s=o.Et(),u=s.key,a=s.value,c=a.Zo,h=a.readTime;if(!e.path.T(u.path))break;h.L(n)<=0||c instanceof ku&&ta(e,c)&&(r=r.rt(c.key,c))}return Va.resolve(r)},gp.prototype.sl=function(t,e){return Va.forEach(this.docs,function(t){return e(t)})},gp.prototype.ia=function(t){return new $l(this)},gp.prototype.oa=function(t){return Va.resolve(this.size)},gp),$l=(o(yp,Hl=Dc),yp.prototype.gr=function(n){var r=this,i=[];return this.dr.forEach(function(t,e){e?i.push(r.aa.Tr(n,e,r.readTime)):r.aa.Ir(t)}),Va.$n(i)},yp.prototype.Rr=function(t,e){return this.aa.Ar(t,e)},yp.prototype.Pr=function(t,e){return this.aa.getEntries(t,e)},yp),Jl=(vp.prototype.De=function(t,n){return this.il.forEach(function(t,e){return n(e)}),Va.resolve()},vp.prototype.Ta=function(t){return Va.resolve(this.lastRemoteSnapshotVersion)},vp.prototype.Ea=function(t){return Va.resolve(this.rl)},vp.prototype.da=function(t){return this.highestTargetId=this.al.next(),Va.resolve(this.highestTargetId)},vp.prototype.Ia=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.rl&&(this.rl=e),Va.resolve()},vp.prototype.Ra=function(t){this.il.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.al=new rf(e),this.highestTargetId=e),t.sequenceNumber>this.rl&&(this.rl=t.sequenceNumber)},vp.prototype.Aa=function(t,e){return this.Ra(e),this.targetCount+=1,Va.resolve()},vp.prototype.ga=function(t,e){return this.Ra(e),Va.resolve()},vp.prototype.ya=function(t,e){return this.il.delete(e.target),this.ol.qc(e.targetId),--this.targetCount,Va.resolve()},vp.prototype.Vo=function(n,r,i){var o=this,s=0,u=[];return this.il.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.il.delete(t),u.push(o.Va(n,e.targetId)),s++)}),Va.$n(u).next(function(){return s})},vp.prototype.pa=function(t){return Va.resolve(this.targetCount)},vp.prototype.ba=function(t,e){var n=this.il.get(e)||null;return Va.resolve(n)},vp.prototype.va=function(t,e,n){return this.ol.Oc(e,n),Va.resolve()},vp.prototype.Da=function(e,t,n){this.ol.Bc(t,n);var r=this.persistence.Co,i=[];return r&&t.forEach(function(t){i.push(r.Ko(e,t))}),Va.$n(i)},vp.prototype.Va=function(t,e){return this.ol.qc(e),Va.resolve()},vp.prototype.Na=function(t,e){var n=this.ol.Qc(e);return Va.resolve(n)},vp.prototype.zo=function(t,e){return Va.resolve(this.ol.zo(e))},vp),Zl=(dp.prototype.start=function(){return Promise.resolve()},dp.prototype.Si=function(){return this.Ma=!1,Promise.resolve()},Object.defineProperty(dp.prototype,"Ti",{get:function(){return this.Ma},enumerable:!1,configurable:!0}),dp.prototype.Xa=function(){},dp.prototype.Za=function(){},dp.prototype.Ec=function(){return this.Sr},dp.prototype.wc=function(t){var e=this.cl[t.Zs()];return e||(e=new Yl(this.Sr,this.Co),this.cl[t.Zs()]=e),e},dp.prototype.mc=function(){return this.ja},dp.prototype.Tc=function(){return this.br},dp.prototype.runTransaction=function(t,e,n){var r=this;Vr("MemoryPersistence","Starting transaction:",t);var i=new tp(this.ka.next());return this.Co.hl(),n(i).next(function(t){return r.Co.ll(i).next(function(){return t})}).Nn().then(function(t){return i.pr(),t})},dp.prototype._l=function(e,n){return Va.xn(Object.values(this.cl).map(function(t){return function(){return t.zo(e,n)}}))},dp),tp=(o(pp,Kl=xc),pp),ep=(lp.wl=function(t){return new lp(t)},Object.defineProperty(lp.prototype,"ml",{get:function(){if(this.dl)return this.dl;throw jr()},enumerable:!1,configurable:!0}),lp.prototype.Sa=function(t,e,n){return this.fl.Sa(n,e),this.ml.delete(n.toString()),Va.resolve()},lp.prototype.Ca=function(t,e,n){return this.fl.Ca(n,e),this.ml.add(n.toString()),Va.resolve()},lp.prototype.Ko=function(t,e){return this.ml.add(e.toString()),Va.resolve()},lp.prototype.removeTarget=function(t,e){var n=this;this.fl.qc(e.targetId).forEach(function(t){return n.ml.add(t.toString())});var r=this.persistence.mc();return r.Na(t,e.targetId).next(function(t){t.forEach(function(t){return n.ml.add(t.toString())})}).next(function(){return r.ya(t,e)})},lp.prototype.hl=function(){this.dl=new Set},lp.prototype.ll=function(n){var r=this,i=this.persistence.Tc().ia();return Va.forEach(this.ml,function(t){var e=Xr.D(t);return r.Tl(n,e).next(function(t){t||i.Ir(e)})}).next(function(){return r.dl=null,i.apply(n)})},lp.prototype.gc=function(t,e){var n=this;return this.Tl(t,e).next(function(t){t?n.ml.delete(e.toString()):n.ml.add(e.toString())})},lp.prototype.ul=function(t){return 0},lp.prototype.Tl=function(t,e){var n=this;return Va.xn([function(){return Va.resolve(n.fl.zo(e))},function(){return n.persistence.mc().zo(t,e)},function(){return n.persistence._l(t,e)}])},lp),np=(fp.prototype.Ru=function(t){this.Al=t},fp.prototype.mu=function(t){this.Rl=t},fp.prototype.onMessage=function(t){this.Pl=t},fp.prototype.close=function(){this.Il()},fp.prototype.send=function(t){this.El(t)},fp.prototype.gl=function(){this.Al()},fp.prototype.yl=function(t){this.Rl(t)},fp.prototype.Vl=function(t){this.Pl(t)},fp),rp={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},ip=(hp.prototype.$u=function(e,t,n,r){var i=this.Sl(e,t);Vr("RestConnection","Sending: ",i,n);var o={};return this.Dl(o,r),this.Cl(e,i,o,n).then(function(t){return Vr("RestConnection","Received: ",t),t},function(t){throw Ur("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},hp.prototype.xu=function(t,e,n,r){return this.$u(t,e,n,r)},hp.prototype.Dl=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.21.1-eap-auth-emulator.8fbbe234f",t["Content-Type"]="text/plain",e)for(var n in e.jc)e.jc.hasOwnProperty(n)&&(t[n]=e.jc[n])},hp.prototype.Sl=function(t,e){var n=rp[t];return this.bl+"/v1/"+e+":"+n},o(cp,Wl=hp),cp.prototype.Cl=function(a,e,n,r){return new Promise(function(o,s){var u=new Nr;u.listenOnce(_r.COMPLETE,function(){try{switch(u.getLastErrorCode()){case Er.NO_ERROR:var t=u.getResponseJson();Vr("Connection","XHR received:",JSON.stringify(t)),o(t);break;case Er.TIMEOUT:Vr("Connection",'RPC "'+a+'" timed out'),s(new xr(Or.DEADLINE_EXCEEDED,"Request time out"));break;case Er.HTTP_ERROR:var e,n,r=u.getStatus();Vr("Connection",'RPC "'+a+'" failed with status:',r,"response text:",u.getResponseText()),0<r?(e=u.getResponseJson().error)&&e.status&&e.message?(i=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(Or).indexOf(i)?i:Or.UNKNOWN,s(new xr(n,e.message))):s(new xr(Or.UNKNOWN,"Server responded with status "+u.getStatus())):s(new xr(Or.UNAVAILABLE,"Connection failed."));break;default:jr()}}finally{Vr("Connection",'RPC "'+a+'" completed.')}var i});var t=JSON.stringify(r);u.send(e,"POST",t,n,15)})},cp.prototype.Pu=function(t,e){var n,r,i=[this.bl,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Ir(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.U.projectId+"/databases/"+this.U.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.Dl(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(v())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=v().indexOf("Electron/")||0<=(r=v()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=v().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");function a(t,e){c.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Vr("Connection","Creating WebChannel: "+u,s);var c=o.createWebChannel(u,s),h=!1,f=!1,l=new np({El:function(t){f?Vr("Connection","Not sending because WebChannel is closed:",t):(h||(Vr("Connection","Opening WebChannel transport."),c.open(),h=!0),Vr("Connection","WebChannel sending:",t),c.send(t))},Il:function(){return c.close()}});return a(Tr.EventType.OPEN,function(){f||Vr("Connection","WebChannel transport opened.")}),a(Tr.EventType.CLOSE,function(){f||(f=!0,Vr("Connection","WebChannel transport closed"),l.yl())}),a(Tr.EventType.ERROR,function(t){f||(f=!0,Ur("Connection","WebChannel transport errored:",t),l.yl(new xr(Or.UNAVAILABLE,"The operation could not be completed")))}),a(Tr.EventType.MESSAGE,function(t){var e,n,r,i,o,s;f||(Fr(!!(n=t.data[0])),(r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(Vr("Connection","WebChannel received error:",r),i=r.status,o=function(){var t=Ji[i];if(void 0!==t)return ro(t)}(),s=r.message,void 0===o&&(o=Or.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),f=!0,l.yl(new xr(o,s)),c.close()):(Vr("Connection","WebChannel received:",n),l.Vl(n)))}),setTimeout(function(){l.gl()},0),l},cp),op=(ap.prototype.Xu=function(t){this.kl.push(t)},ap.prototype.Si=function(){window.removeEventListener("online",this.Nl),window.removeEventListener("offline",this.$l)},ap.prototype.Ml=function(){window.addEventListener("online",this.Nl),window.addEventListener("offline",this.$l)},ap.prototype.Fl=function(){Vr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.kl;t<e.length;t++)(0,e[t])(0)},ap.prototype.xl=function(){Vr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.kl;t<e.length;t++)(0,e[t])(1)},ap.On=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},ap),sp=(up.prototype.Xu=function(t){},up.prototype.Si=function(){},up);function up(){}function ap(){var t=this;this.Nl=function(){return t.Fl()},this.$l=function(){return t.xl()},this.kl=[],this.Ml()}function cp(t){var e=this;return(e=Wl.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function hp(t){this.pl=t,this.U=t.U;var e=t.ssl?"https":"http";this.bl=e+"://"+t.host,this.vl="projects/"+this.U.projectId+"/databases/"+this.U.database+"/documents"}function fp(t){this.El=t.El,this.Il=t.Il}function lp(t){this.persistence=t,this.fl=new Cf,this.dl=null}function pp(t){var e=this;return(e=Kl.call(this)||this).Fa=t,e}function dp(t){var e,n=this;this.cl={},this.ka=new dc(0),this.Ma=!1,this.Ma=!0,this.Co=t(this),this.ja=new Jl(this),this.Sr=new Rh,this.br=(e=this.Sr,new Xl(e,function(t){return n.Co.ul(t)}))}function vp(t){this.persistence=t,this.il=new Vi(Qi,Yi),this.lastRemoteSnapshotVersion=Ui.min(),this.highestTargetId=0,this.rl=0,this.ol=new Cf,this.targetCount=0,this.al=rf._a()}function yp(t){var e=this;return(e=Hl.call(this)||this).aa=t,e}function gp(t,e){this.Sr=t,this.nl=e,this.docs=new io(Xr.i),this.size=0}function mp(t,e){this.Sr=t,this.Co=e,this.vr=[],this.Yh=1,this.Jh=new fo(Uf.xc)}function wp(){}function bp(t){return new us(t,!0)}var Ip,Ep,_p,Tp,Np="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Ap=(qp.prototype.initialize=function(e){return m(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.bh=this.Ol(e),this.persistence=this.Ll(e),[4,this.persistence.start()];case 1:return t.sent(),this.Bl=this.ql(e),this.Wu=this.Ul(e),[2]}})})},qp.prototype.ql=function(t){return null},qp.prototype.Ul=function(t){return e=this.persistence,n=new Ql,r=t.Ql,new _f(e,n,r);var e,n,r},qp.prototype.Ll=function(t){if(t.persistenceSettings.Wl)throw new xr(Or.FAILED_PRECONDITION,Np);return new Zl(ep.wl)},qp.prototype.Ol=function(t){return new Nc},qp.prototype.terminate=function(){return m(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Bl&&this.Bl.stop(),[4,this.bh.Si()];case 1:return t.sent(),[4,this.persistence.Si()];case 2:return t.sent(),[2]}})})},qp.prototype.clearPersistence=function(t,e){throw new xr(Or.FAILED_PRECONDITION,Np)},qp),Sp=(o(Fp,Tp=Ap),Fp.prototype.initialize=function(e){return m(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,Tp.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,function(n){return m(this,void 0,void 0,function(){var e;return w(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return e=Dh(t),r=Ui.min(),e.ss({index:Wh.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=ch(e.readTime)),n.done()}).next(function(){return r});var e,r}).then(function(t){e.vc=t})]})})}(this.Wu)];case 2:return t.sent(),[4,this.jl.initialize(this,e)];case 3:return t.sent(),[4,zl(this.jl._i)];case 4:return t.sent(),[4,gl(this.jl.Vh)];case 5:return t.sent(),[2]}})})},Fp.prototype.ql=function(t){var e=this.persistence.Co.do;return new Jc(e,t.os)},Fp.prototype.Ll=function(t){var e=Ef(t.pl.U,t.pl.persistenceKey),n=bp(t.pl.U);return new df(t.persistenceSettings.synchronizeTabs,e,t.clientId,Yc.oo(t.persistenceSettings.cacheSizeBytes),t.os,Ja(),Za(),n,this.bh,t.persistenceSettings.xa)},Fp.prototype.Ol=function(t){return new Nc},Fp.prototype.clearPersistence=function(t,e){return function(n){return m(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return Ca.On()?(e=n+"main",[4,Ca.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(Ef(t,e))},o(jp,_p=Fp),jp.prototype.initialize=function(r){return m(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:return[4,_p.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.jl._i,this.bh instanceof Tc?(this.bh._i={tr:function(u,a,c,h){return m(this,void 0,void 0,function(){var o,s;return w(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).Wu,n=a,i=(r=e).vr,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Oo(e,n).next(function(t){return t?r.Dc.$r(e,t):Va.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,gl(o.Vh)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(Vl(o,a,h||null),Pl(o,a),o.Wu.vr.jo(a)):jr(),t.label=4;case 4:return[4,Fl(o,s)];case 5:return t.sent(),[3,7];case 6:Vr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}.bind(null,e),er:function(o,s,u,a){return m(this,void 0,void 0,function(){var n,r,i;return w(this,function(t){switch(t.label){case 0:return(n=o).Bh?(Vr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!n.Nh.has(s))return[3,8];switch(u){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,(e=n.Wu,(c=e).persistence.runTransaction("Get new document changes","readonly",function(t){return e=c.Sc,n=t,r=c.vc,i=e,o=po,s=ah(r),u=Dh(n),a=IDBKeyRange.lowerBound(s,!0),u.ss({index:Wh.readTimeIndex,range:a},function(t,e){var n=sh(i.serializer,e);o=o.rt(n.key,n),s=e.readTime}).next(function(){return{Fc:o,readTime:ch(s)}});var e,n,r,i,o,s,u,a}).then(function(t){var e=t.Fc,n=t.readTime;return c.vc=n,e}))];case 3:return r=t.sent(),i=No.Jt(s,"current"===u),[4,Fl(n,r,i)];case 4:return t.sent(),[3,8];case 5:return[4,Sf(n.Wu,s,!0)];case 6:return t.sent(),Cl(n,s,a),[3,8];case 7:jr(),t.label=8;case 8:return[2]}var e,c})})}.bind(null,e),nr:function(f,l,p){return m(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a,c,h;return w(this,function(t){switch(t.label){case 0:if(!(n=Gl(f)).Bh)return[3,10];e=0,r=l,t.label=1;case 1:return e<r.length?(i=r[e],n.Nh.has(i)?(Vr("SyncEngine","Adding an already active target "+i),[3,5]):[4,Of(n.Wu,i)]):[3,6];case 2:return o=t.sent(),[4,Af(n.Wu,o)];case 3:return s=t.sent(),[4,Rl(n,Bl(o),s.targetId,!1)];case 4:t.sent(),ul(n.Vh,s),t.label=5;case 5:return e++,[3,1];case 6:u=function(e){return w(this,function(t){switch(t.label){case 0:return n.Nh.has(e)?[4,Sf(n.Wu,e,!1).then(function(){al(n.Vh,e),Cl(n,e)}).catch(xf)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},a=0,c=p,t.label=7;case 7:return a<c.length?(h=c[a],[5,u(h)]):[3,10];case 8:t.sent(),t.label=9;case 9:return a++,[3,7];case 10:return[2]}})})}.bind(null,e),Vi:function(t){return t.Wu.persistence.Vi()}.bind(null,e)},[4,this.bh.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.Ja(function(e){return m(n,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,function(h,f){return m(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return w(this,function(t){switch(t.label){case 0:return Gl(r=h),zl(r),!0!==f||!0===r.Bh?[3,3]:(e=r.bh.Di(),[4,ql(r,e.A())]);case 1:return i=t.sent(),r.Bh=!0,[4,bl(r.Vh,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],ul(r.Vh,u);return[3,7];case 3:return!1!==f||!1===r.Bh?[3,7]:(a=[],c=Promise.resolve(),r.Nh.forEach(function(t,e){r.bh.Bi(e)?a.push(e):c=c.then(function(){return Cl(r,e),Sf(r.Wu,e,!0)}),al(r.Vh,e)}),[4,c]);case 4:return t.sent(),[4,ql(r,a)];case 5:return t.sent(),(n=r).xh.forEach(function(t,e){al(n.Vh,e)}),n.kh.Uc(),n.xh=new Map,n.$h=new io(Xr.i),r.Bh=!1,[4,bl(r.Vh,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}(this.jl._i,e)];case 1:return t.sent(),this.Bl&&(e&&!this.Bl.Ti?this.Bl.start(this.Wu):e||this.Bl.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},jp.prototype.Ol=function(t){if(t.persistenceSettings.Wl&&t.persistenceSettings.synchronizeTabs){var e=Ja();if(!Tc.On(e))throw new xr(Or.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Ef(t.pl.U,t.pl.persistenceKey);return new Tc(e,t.os,n,t.clientId,t.Ql)}return new Nc},jp),Dp=(Mp.prototype.initialize=function(n,r){return m(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:return this.Wu?[3,2]:(this.Wu=n.Wu,this.bh=n.bh,this.ju=this.Kl(r),this.Vh=this.Gl(r),this.ph=this.zl(r),this._i=this.Hl(r),this.bh.fi=function(t){return Ll(e._i,t,1)},this.Vh.Ku.Yl=function(i,o){return m(this,void 0,void 0,function(){var n,r;return w(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Vr("SyncEngine","User change. New user:",o.Zs()),[4,function(i,o){return m(this,void 0,void 0,function(){var e,n,m,r;return w(this,function(t){switch(t.label){case 0:return n=(e=i).vr,m=e.Dc,[4,e.persistence.runTransaction("Handle user change","readonly",function(y){var g;return e.vr.qo(y).next(function(t){return g=t,n=e.persistence.wc(o),m=new Rc(e.Sc,n,e.persistence.Ec()),n.qo(y)}).next(function(t){for(var e=[],n=[],r=bo(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var v=d[p];r=r.add(v.key)}}return m.$r(y,r).next(function(t){return{Wh:t,jh:e,Kh:n}})})})];case 1:return r=t.sent(),[2,(e.vr=n,e.Dc=m,e.yc.Cc(e.Dc),r)]}})})}(n.Wu,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Oh.forEach(function(t){t.forEach(function(t){t.reject(new xr(Or.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Oh.clear(),n.bh.Wi(o,r.jh,r.Kh),[4,Fl(n,r.Wh)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this._i),[4,bl(this.Vh,this._i.qh)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Mp.prototype.zl=function(t){return new sc},Mp.prototype.Kl=function(t){var e,n=bp(t.pl.U),r=(e=t.pl,new ip(e)),i=t.credentials;return new Wf(i,r,n)},Mp.prototype.Gl=function(t){var e=this;return new kf(this.Wu,this.ju,t.os,function(t){return Ll(e._i,t,0)},new(op.On()?op:sp))},Mp.prototype.Hl=function(t){return e=this.Wu,n=this.Vh,r=this.ph,i=this.bh,o=t.Ql,s=t.Sh,u=!t.persistenceSettings.Wl||!t.persistenceSettings.synchronizeTabs,a=new Dl(e,n,r,i,o,s),u&&(a.Bh=!0),a;var e,n,r,i,o,s,u,a},Mp.prototype.terminate=function(){return sl(this.Vh)},Mp),Op=(Up.prototype.next=function(t){this.observer.next&&this.Jl(this.observer.next,t)},Up.prototype.error=function(t){this.observer.error?this.Jl(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Up.prototype.Xl=function(){this.muted=!0},Up.prototype.Jl=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Up),xp=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new xr(Or.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(oi("FieldPath","string",e,t[e]),0===t[e].length)throw new xr(Or.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Zl=new Yr(t)},Rp=(o(Cp,Ep=xp),Cp.documentId=function(){return new Cp(Yr.v().R())},Cp.prototype.isEqual=function(t){if(!(t instanceof Cp))throw yi("isEqual","FieldPath",1,t);return this.Zl.isEqual(t.Zl)},Cp),kp=new RegExp("[~\\*/\\[\\]]"),Lp=function(t){this.t_=t},Pp=(o(Vp,Ip=Lp),Vp.prototype.e_=function(t){if(2!==t.n_)throw 1===t.n_?t.s_(this.t_+"() can only appear at the top level of your update data"):t.s_(this.t_+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},Vp.prototype.isEqual=function(t){return t instanceof Vp},Vp);function Vp(){return null!==Ip&&Ip.apply(this,arguments)||this}function Cp(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Ep.call(this,t)||this}function Up(t){this.observer=t,this.muted=!1}function Mp(){}function jp(){return null!==_p&&_p.apply(this,arguments)||this}function Fp(t){var e=this;return(e=Tp.call(this)||this).jl=t,e}function qp(){}function Bp(t,e,n){return new fd({n_:3,i_:e.settings.i_,methodName:t.t_,r_:n},e.U,e.serializer,e.ignoreUndefinedProperties)}var Gp,zp,Wp,Kp,Hp=(o(cd,Kp=Lp),cd.prototype.e_=function(t){return new $s(t.path,new Cs)},cd.prototype.isEqual=function(t){return t instanceof cd},cd),Qp=(o(ad,Wp=Lp),ad.prototype.e_=function(t){var e=Bp(this,t,!0),n=this.o_.map(function(t){return wd(t,e)}),r=new Us(n);return new $s(t.path,r)},ad.prototype.isEqual=function(t){return this===t},ad),Yp=(o(ud,zp=Lp),ud.prototype.e_=function(t){var e=Bp(this,t,!0),n=this.o_.map(function(t){return wd(t,e)}),r=new Bs(n);return new $s(t.path,r)},ud.prototype.isEqual=function(t){return this===t},ud),Xp=(o(sd,Gp=Lp),sd.prototype.e_=function(t){var e=new Ks(t.serializer,hs(t.serializer,this.a_));return new $s(t.path,e)},sd.prototype.isEqual=function(t){return this===t},sd),$p=(Object.defineProperty(od.prototype,"latitude",{get:function(){return this.c_},enumerable:!1,configurable:!0}),Object.defineProperty(od.prototype,"longitude",{get:function(){return this.u_},enumerable:!1,configurable:!0}),od.prototype.isEqual=function(t){return this.c_===t.c_&&this.u_===t.u_},od.prototype.toJSON=function(){return{latitude:this.c_,longitude:this.u_}},od.prototype.H=function(t){return Ei(this.c_,t.c_)||Ei(this.u_,t.u_)},od),Jp=function(t){this.h_=t},Zp=/^__.*__$/,td=function(t,e,n){this.l_=t,this.__=e,this.f_=n},ed=(id.prototype.d_=function(t,e){var n=[];return null!==this.Qe?n.push(new hu(t,this.data,this.Qe,e)):n.push(new cu(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new vu(t,this.fieldTransforms)),n},id),nd=(rd.prototype.d_=function(t,e){var n=[new hu(t,this.data,this.Qe,e)];return 0<this.fieldTransforms.length&&n.push(new vu(t,this.fieldTransforms)),n},rd);function rd(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function id(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function od(t,e){if(ni("GeoPoint",arguments,2),oi("GeoPoint","number",1,t),oi("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new xr(Or.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new xr(Or.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.c_=t,this.u_=e}function sd(t,e){var n=this;return(n=Gp.call(this,t)||this).a_=e,n}function ud(t,e){var n=this;return(n=zp.call(this,t)||this).o_=e,n}function ad(t,e){var n=this;return(n=Wp.call(this,t)||this).o_=e,n}function cd(){return null!==Kp&&Kp.apply(this,arguments)||this}function hd(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw jr()}}var fd=(Object.defineProperty(dd.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(dd.prototype,"n_",{get:function(){return this.settings.n_},enumerable:!1,configurable:!0}),dd.prototype.m_=function(t){return new dd(Object.assign(Object.assign({},this.settings),t),this.U,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},dd.prototype.T_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.m_({path:n,r_:!1});return r.E_(t),r},dd.prototype.I_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.m_({path:n,r_:!1});return r.w_(),r},dd.prototype.A_=function(t){return this.m_({path:void 0,r_:!0})},dd.prototype.s_=function(t){return Nd(t,this.settings.methodName,this.settings.R_||!1,this.path,this.settings.i_)},dd.prototype.contains=function(e){return void 0!==this.Qe.find(function(t){return e.T(t)})||void 0!==this.fieldTransforms.find(function(t){return e.T(t.field)})},dd.prototype.w_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.E_(this.path.get(t))},dd.prototype.E_=function(t){if(0===t.length)throw this.s_("Document fields must not be empty");if(hd(this.n_)&&Zp.test(t))throw this.s_('Document fields cannot begin and end with "__"')},dd),ld=(pd.prototype.P_=function(t,e,n,r){return void 0===r&&(r=!1),new fd({n_:t,methodName:e,i_:n,path:Yr.g(),r_:!1,R_:r},this.U,this.serializer,this.ignoreUndefinedProperties)},pd);function pd(t,e,n){this.U=t,this.ignoreUndefinedProperties=e,this.serializer=n||bp(t)}function dd(t,e,n,r,i,o){this.settings=t,this.U=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.w_(),this.fieldTransforms=i||[],this.Qe=o||[]}function vd(t,e,n,r,i,o){void 0===o&&(o={});var s=t.P_(o.merge||o.mergeFields?2:0,e,n,i);Ed("Data must be an object, but it was:",s,r);var u,a,c=bd(r,s);if(o.merge)u=new Xs(s.Qe),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=l[f],d=void 0;if(p instanceof xp)d=p.Zl;else{if("string"!=typeof p)throw jr();d=Td(e,p,n)}if(!s.contains(d))throw new xr(Or.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Ad(h,d)||h.push(d)}u=new Xs(h),a=s.fieldTransforms.filter(function(t){return u.He(t.field)})}else u=null,a=s.fieldTransforms;return new ed(new Eu(c),u,a)}function yd(t,o,s,e){var u=t.P_(1,o,s);Ed("Data must be an object, but it was:",u,e);var a=[],c=new _u;Br(e,function(t,e){var n,r=Td(o,t,s),i=u.I_(r);e instanceof Pp||e instanceof Jp&&e.h_ instanceof Pp?a.push(r):null!=(n=wd(e,i))&&(a.push(r),c.set(r,n))});var n=new Xs(a);return new nd(c.Je(),n,u.fieldTransforms)}function gd(t,e,n,r,i,o){var s=t.P_(1,e,n),u=[_d(e,r,n)],a=[i];if(o.length%2!=0)throw new xr(Or.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(_d(e,o[c])),a.push(o[c+1]);for(var h,f,l,p,d=[],v=new _u,y=u.length-1;0<=y;--y)Ad(d,u[y])||(h=u[y],f=a[y],l=s.I_(h),f instanceof Pp||f instanceof Jp&&f.h_ instanceof Pp?d.push(h):null!=(p=wd(f,l))&&(d.push(h),v.set(h,p)));var g=new Xs(d);return new nd(v.Je(),g,s.fieldTransforms)}function md(t,e,n,r){return void 0===r&&(r=!1),wd(n,t.P_(r?4:3,e))}function wd(s,t){if(s instanceof Jp&&(s=s.h_),Id(s))return Ed("Unsupported field value:",t,s),bd(s,t);if(s instanceof Lp)return function(t,e){if(!hd(e.n_))throw e.s_(t.t_+"() can only be used with update() and set()");if(!e.path)throw e.s_(t.t_+"() is not currently supported inside arrays");var n=t.e_(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Qe.push(t.path),s instanceof Array){if(t.settings.r_&&4!==t.n_)throw t.s_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=wd(i[r],t.A_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return hs(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Ci.fromDate(t);return{timestampValue:fs(e.serializer,n)}}if(t instanceof Ci){var r=new Ci(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:fs(e.serializer,r)}}if(t instanceof $p)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Si)return{bytesValue:ls(e.serializer,t.q)};if(t instanceof td){var i=e.U,o=t.l_;if(!o.isEqual(i))throw e.s_("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:ds(t.l_||e.U,t.__.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.s_("Unsupported field value: "+pi(t))}(s,t)}function bd(t,r){var i={};return Gr(t)?r.path&&0<r.path.length&&r.Qe.push(r.path):Br(t,function(t,e){var n=wd(e,r.T_(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function Id(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Ci||t instanceof $p||t instanceof Si||t instanceof td||t instanceof Lp)}function Ed(t,e,n){if(!Id(n)||!li(n)){var r=pi(n);throw"an object"===r?e.s_(t+" a custom object"):e.s_(t+" "+r)}}function _d(t,e,n){if(e instanceof xp)return e.Zl;if("string"==typeof e)return Td(t,e);throw Nd("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Td(t,e,n){try{return function(e){if(0<=e.search(kp))throw new xr(Or.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Rp.bind.apply(Rp,s([void 0],e.split("."))))}catch(t){throw new xr(Or.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Zl}catch(e){throw Nd(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Nd(t,e,n,r,i){var o=r&&!r.m(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new xr(Or.INVALID_ARGUMENT,(u+=". ")+t+a)}function Ad(t,e){return t.some(function(t){return t.isEqual(e)})}var Sd=(kd.prototype.b_=function(r){return m(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(this.v_(),0<this.mutations.length)throw new xr(Or.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(u,a){return m(this,void 0,void 0,function(){var i,e,n,r,o,s;return w(this,function(t){switch(t.label){case 0:return e=bs((i=u).serializer)+"/documents",n={documents:a.map(function(t){return ys(i.serializer,t)})},[4,i.xu("BatchGetDocuments",e,n)];case 1:return r=t.sent(),o=new Map,r.forEach(function(t){var e,n,r=(e=i.serializer,"found"in(n=t)?function(t,e){Fr(!!e.found),e.found.name,e.found.updateTime;var n=gs(t,e.found.name),r=ps(e.found.updateTime),i=new Eu({mapValue:{fields:e.found.fields}});return new ku(n,r,i,{})}(e,n):"missing"in n?function(t,e){Fr(!!e.missing),Fr(!!e.readTime);var n=gs(t,e.missing),r=ps(e.readTime);return new Lu(n,r)}(e,n):jr());o.set(r.key.toString(),r)}),s=[],[2,(a.forEach(function(t){var e=o.get(t.toString());Fr(!!e),s.push(e)}),s)]}})})}(this.ju,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Lu||t instanceof ku?n.S_(t):jr()}),e)]}})})},kd.prototype.set=function(t,e){this.write(e.d_(t,this.Ke(t))),this.p_.add(t.toString())},kd.prototype.update=function(t,e){try{this.write(e.d_(t,this.D_(t)))}catch(t){this.V_=t}this.p_.add(t.toString())},kd.prototype.delete=function(t){this.write([new bu(t,this.Ke(t))]),this.p_.add(t.toString())},kd.prototype.commit=function(){return m(this,void 0,void 0,function(){var e,r=this;return w(this,function(t){switch(t.label){case 0:if(this.v_(),this.V_)throw this.V_;return e=this.g_,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=Xr.D(e);r.mutations.push(new Iu(n,r.Ke(n)))}),[4,function(i,o){return m(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return n=bs((e=i).serializer)+"/documents",r={writes:o.map(function(t){return _s(e.serializer,t)})},[4,e.$u("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.ju,this.mutations)];case 1:return t.sent(),this.y_=!0,[2]}})})},kd.prototype.S_=function(t){var e;if(t instanceof ku)e=t.version;else{if(!(t instanceof Lu))throw jr();e=Ui.min()}var n=this.g_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new xr(Or.ABORTED,"Document version changed between two reads.")}else this.g_.set(t.key.toString(),e)},kd.prototype.Ke=function(t){var e=this.g_.get(t.toString());return!this.p_.has(t.toString())&&e?tu.updateTime(e):tu.Ge()},kd.prototype.D_=function(t){var e=this.g_.get(t.toString());if(this.p_.has(t.toString())||!e)return tu.exists(!0);if(e.isEqual(Ui.min()))throw new xr(Or.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return tu.updateTime(e)},kd.prototype.write=function(t){this.v_(),this.mutations=this.mutations.concat(t)},kd.prototype.v_=function(){},kd),Dd=(Rd.prototype.run=function(){this.N_()},Rd.prototype.N_=function(){var t=this;this.gs.Rn(function(){return m(t,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){return e=new Sd(this.ju),(n=this.F_(e))&&n.then(function(t){r.os.ds(function(){return e.commit().then(function(){r.hs.resolve(t)}).catch(function(t){r.x_(t)})})}).catch(function(t){r.x_(t)}),[2]})})})},Rd.prototype.F_=function(t){try{var e=this.updateFunction(t);return!Gi(e)&&e.catch&&e.then?e:(this.hs.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.hs.reject(t),null}},Rd.prototype.x_=function(t){var e=this;0<this.C_&&this.k_(t)?(--this.C_,this.os.ds(function(){return e.N_(),Promise.resolve()})):this.hs.reject(t)},Rd.prototype.k_=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!no(e)},Rd),Od=(xd.prototype.start=function(t,e,n,r){var i=this;this.O_(),this.pl=t;var o=new ka,s=!1;return this.credentials.zc(function(t){return s?void i.os.Ds(function(){return function(r,i){return m(this,void 0,void 0,function(){var e,n;return w(this,function(t){switch(t.label){case 0:return(e=r).os.Fs(),Vr("RemoteStore","RemoteStore received new credentials"),n=pl(e),e.Hu.add(3),[4,ol(e)];case 1:return t.sent(),n&&e.Zu.set("Unknown"),[4,e.Ku.Yl(i)];case 2:return t.sent(),e.Hu.delete(3),[4,il(e)];case 3:return t.sent(),[2]}})})}(i.Vh,t)}):(s=!0,Vr("FirestoreClient","Initializing. user=",t.uid),i.L_(e,n,r,t,o).then(i.M_.resolve,i.M_.reject))}),this.os.ds(function(){return i.M_.promise}),o.promise},xd.prototype.enableNetwork=function(){var e=this;return this.O_(),this.os.enqueue(function(){return e.persistence.Za(!0),(t=e.Vh).Hu.delete(0),il(t);var t})},xd.prototype.L_=function(i,o,s,u,a){return m(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={os:this.os,pl:this.pl,clientId:this.clientId,credentials:this.credentials,Ql:u,Sh:100,persistenceSettings:s},[4,i.initialize(e)];case 1:return t.sent(),[4,o.initialize(i,e)];case 2:return t.sent(),this.persistence=i.persistence,this.bh=i.bh,this.Wu=i.Wu,this.Bl=i.Bl,this.ju=o.ju,this.Vh=o.Vh,this._i=o._i,this.B_=o.ph,this.B_.qs=function(u,a){return m(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return e=Gl(u),(i=e.Ch.get(a))?(n=i.targetId,e.bh.Mi(n),r=i.view.gh(),[3,4]):[3,1];case 1:return[4,Af(e.Wu,Hu(a))];case 2:return o=t.sent(),s=e.bh.Mi(o.targetId),n=o.targetId,[4,Rl(e,a,n,"current"===s)];case 3:r=t.sent(),e.qh&&ul(e.Vh,o),t.label=4;case 4:return[2,r]}})})}.bind(null,this._i),this.B_.Ws=function(i,o){return m(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return n=(e=i).Ch.get(o),1<(r=e.Nh.get(n.targetId)).length?[2,(e.Nh.set(n.targetId,r.filter(function(t){return!$u(t,o)})),void e.Ch.delete(o))]:e.qh?(e.bh.Li(n.targetId),e.bh.Ni(n.targetId)?[3,2]:[4,Sf(e.Wu,n.targetId,!1).then(function(){e.bh.qi(n.targetId),al(e.Vh,n.targetId),Cl(e,n.targetId)}).catch(xf)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Cl(e,n.targetId),[4,Sf(e.Wu,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,this._i),this.persistence.Xa(function(){return m(r,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),a.resolve(),[3,4];case 3:if(n=t.sent(),a.reject(n),!this.q_(n))throw n;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+n),this.L_(new Ap,new Dp,{Wl:!1},u,a))];case 4:return[2]}})})},xd.prototype.q_=function(t){return"FirebaseError"===t.name?t.code===Or.FAILED_PRECONDITION||t.code===Or.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},xd.prototype.O_=function(){if(this.os.Vs)throw new xr(Or.FAILED_PRECONDITION,"The client has already been terminated.")},xd.prototype.disableNetwork=function(){var t=this;return this.O_(),this.os.enqueue(function(){return t.persistence.Za(!1),function(n){return m(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return(e=n).Hu.add(0),[4,ol(e)];case 1:return t.sent(),e.Zu.set("Offline"),[2]}})})}(t.Vh)})},xd.prototype.terminate=function(){var t=this;this.os.Ss();var r=new ka;return this.os.ps(function(){return m(t,void 0,void 0,function(){var e,n;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.Bl&&this.Bl.stop(),[4,sl(this.Vh)];case 1:return t.sent(),[4,this.bh.Si()];case 2:return t.sent(),[4,this.persistence.Si()];case 3:return t.sent(),this.credentials.Hc(),r.resolve(),[3,5];case 4:return e=t.sent(),n=ic(e,"Failed to shutdown persistence"),r.reject(n),[3,5];case 5:return[2]}})})}),r.promise},xd.prototype.waitForPendingWrites=function(){var t=this;this.O_();var e=new ka;return this.os.ds(function(){return function(u,a){return m(this,void 0,void 0,function(){var n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:pl((n=u).Vh)||Vr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Wu).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.vr.Bo(t)})];case 2:return-1===(r=t.sent())?[2,void a.resolve()]:((i=n.Oh.get(r)||[]).push(a),n.Oh.set(r,i),[3,4]);case 3:return o=t.sent(),s=ic(o,"Initialization of waitForPendingWrites() operation failed"),a.reject(s),[3,4];case 4:return[2]}var e})})}(t._i,e)}),e.promise},xd.prototype.listen=function(t,e,n){var r=this;this.O_();var i=new Op(n),o=new hc(t,i,e);return this.os.ds(function(){return uc(r.B_,o)}),function(){i.Xl(),r.os.ds(function(){return ac(r.B_,o)})}},xd.prototype.U_=function(r){return m(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:return this.O_(),[4,this.M_.promise];case 1:return t.sent(),e=new ka,[2,(this.os.ds(function(){return function(s,u,a){return m(this,void 0,void 0,function(){var r,i,o;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=u,(n=s).persistence.runTransaction("read document","readonly",function(t){return n.Dc.Dr(t,e)}))];case 1:return(r=t.sent())instanceof ku?a.resolve(r):r instanceof Lu?a.resolve(null):a.reject(new xr(Or.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return i=t.sent(),o=ic(i,"Failed to get document '"+u+" from cache"),a.reject(o),[3,3];case 3:return[2]}var e,n})})}(n.Wu,r,e)}),e.promise)]}})})},xd.prototype.Q_=function(c,h){return void 0===h&&(h={}),m(this,void 0,void 0,function(){var e,a=this;return w(this,function(t){switch(t.label){case 0:return this.O_(),[4,this.M_.promise];case 1:return t.sent(),e=new ka,[2,(this.os.ds(function(){return n=a.B_,r=a.os,i=c,o=h,s=e,t=new Op({next:function(t){r.ds(function(){return ac(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new xr(Or.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new xr(Or.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new hc(Fu(i.path),t,{includeMetadataChanges:!0,Js:!0}),uc(n,u);var n,r,i,o,s,t,u}),e.promise)]}})})},xd.prototype.W_=function(r){return m(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:return this.O_(),[4,this.M_.promise];case 1:return t.sent(),e=new ka,[2,(this.os.ds(function(){return function(u,a,c){return m(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Df(u,a,!0)];case 1:return e=t.sent(),n=new Nl(a,e.Nc),r=n.dh(e.documents),i=n.gr(r,!1),c.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=ic(o,"Failed to execute query '"+a+" against cache"),c.reject(s),[3,3];case 3:return[2]}})})}(n.Wu,r,e)}),e.promise)]}})})},xd.prototype.j_=function(c,h){return void 0===h&&(h={}),m(this,void 0,void 0,function(){var u,a=this;return w(this,function(t){switch(t.label){case 0:return this.O_(),[4,this.M_.promise];case 1:return t.sent(),u=new ka,[2,(this.os.ds(function(){return e=a.B_,n=a.os,t=c,r=h,i=u,o=new Op({next:function(t){n.ds(function(){return ac(e,s)}),t.fromCache&&"server"===r.source?i.reject(new xr(Or.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new hc(t,o,{includeMetadataChanges:!0,Js:!0}),uc(e,s);var e,n,t,r,i,o,s}),u.promise)]}})})},xd.prototype.write=function(t){var e=this;this.O_();var n=new ka;return this.os.ds(function(){return function(v,y,g){return m(this,void 0,void 0,function(){var u,a,p,d;return w(this,function(t){switch(t.label){case 0:u=zl(v),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(o=u.Wu,c=y,f=o,l=Ci.now(),s=c.reduce(function(t,e){return t.add(e.key)},bo()),f.persistence.runTransaction("Locally write mutations","readwrite",function(a){return f.Dc.$r(a,s).next(function(t){h=t;for(var u,e,n=[],r=0,i=c;r<i.length;r++){var o=i[r],s=(u=o,e=h.get(o.key),u instanceof vu?function(t){for(var e=null,n=0,r=u.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof ku?t.field(i.field):void 0,s=Ls(i.transform,o||null);null!=s&&(e=null==e?(new _u).set(i.field,s):e.set(i.field,s))}return e?e.Je():null}(e):null);null!=s&&n.push(new hu(o.key,s,function u(t){var a=[];return Br(t.fields||{},function(t,e){var n=new Yr([t]);if(is(e)){var r=u(e.mapValue).fields;if(0===r.length)a.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];a.push(n.child(s))}}else a.push(n)}),new Xs(a)}(s.proto.mapValue),tu.exists(!0)))}return f.vr.xo(a,l,n,c)})}).then(function(t){var e=t.hr(h);return{batchId:t.batchId,dr:e}}))];case 2:return a=t.sent(),u.bh.Fi(a.batchId),e=u,n=a.batchId,r=g,i=(i=(i=e.Mh[e.currentUser.Zs()])||new io(Ei)).rt(n,r),e.Mh[e.currentUser.Zs()]=i,[4,Fl(u,a.dr)];case 3:return t.sent(),[4,gl(u.Vh)];case 4:return t.sent(),[3,6];case 5:return p=t.sent(),d=ic(p,"Failed to persist write"),g.reject(d),[3,6];case 6:return[2]}var e,n,r,i,o,c,h,f,l,s})})}(e._i,t,n)}),n.promise},xd.prototype.U=function(){return this.pl.U},xd.prototype.K_=function(t){var e=this;this.O_();var r=new Op(t);return this.os.ds(function(){return m(e,void 0,void 0,function(){return w(this,function(t){return[2,(e=this.B_,n=r,e.Bs.add(n),void n.next())];var e,n})})}),function(){r.Xl(),e.os.ds(function(){return m(e,void 0,void 0,function(){return w(this,function(t){return[2,void this.B_.Bs.delete(r)]})})})}},Object.defineProperty(xd.prototype,"G_",{get:function(){return this.os.Vs},enumerable:!1,configurable:!0}),xd.prototype.transaction=function(t){var e=this;this.O_();var n=new ka;return this.os.ds(function(){return new Dd(e.os,e.ju,t,n).run(),Promise.resolve()}),n.promise},xd);function xd(t,e){this.credentials=t,this.os=e,this.clientId=bi.k(),this.M_=new ka}function Rd(t,e,n,r){this.os=t,this.ju=e,this.updateFunction=n,this.hs=r,this.C_=5,this.gs=new Pa(this.os,"transaction_retry")}function kd(t){this.ju=t,this.g_=new Map,this.mutations=[],this.y_=!1,this.V_=null,this.p_=new Set}function Ld(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Pd,Vd,Cd=(tv.prototype.J_=function(t){switch(zo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return $o(t.integerValue||t.doubleValue);case 3:return this.X_(t.timestampValue);case 4:return this.Z_(t);case 5:return t.stringValue;case 6:return this.Y_(Jo(t.bytesValue));case 7:return this.tf(t.referenceValue);case 8:return this.ef(t.geoPointValue);case 9:return this.nf(t.arrayValue);case 10:return this.sf(t.mapValue);default:throw jr()}},tv.prototype.sf=function(t){var n=this,r={};return Br(t.fields||{},function(t,e){r[t]=n.J_(e)}),r},tv.prototype.ef=function(t){return new $p($o(t.latitude),$o(t.longitude))},tv.prototype.nf=function(t){var e=this;return(t.values||[]).map(function(t){return e.J_(t)})},tv.prototype.Z_=function(t){switch(this.z_){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return qo(n)?t(n):n}(t);return null==e?null:this.J_(e);case"estimate":return this.X_(Bo(t));default:return null}},tv.prototype.X_=function(t){var e=Xo(t),n=new Ci(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},tv.prototype.tf=function(t){var e=Hr.P(t);Fr(Rs(e));var n=new Pi(e.get(1),e.get(3)),r=new Xr(e.u(5));return n.isEqual(this.U)||Cr("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.U.projectId+"/"+this.U.database+") instead."),this.H_(r)},tv),Ud=Yc.uo,Md=(Zd.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Zd),jd=(Object.defineProperty(Jd.prototype,"wf",{get:function(){return this.mf||(this.mf=new ld(this.l_,this.df.ignoreUndefinedProperties)),this.mf},enumerable:!1,configurable:!0}),Jd.prototype.settings=function(t){ni("Firestore.settings",arguments,1),oi("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.df),t)).merge;var e=new Md(t);if(this.hf&&!this.df.isEqual(e))throw new xr(Or.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.df=e).credentials&&(this.ff=function(t){if(!t)return new Mf;switch(t.type){case"gapi":var e=t.client;return Fr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new qf(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new xr(Or.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},Jd.prototype.enableNetwork=function(){return this.uf(),this.hf.enableNetwork()},Jd.prototype.disableNetwork=function(){return this.uf(),this.hf.disableNetwork()},Jd.prototype.enablePersistence=function(t){var e,n;if(this.hf)throw new xr(Or.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Cr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new xr(Or.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Tf(this.if,this.rf,{Wl:!0,cacheSizeBytes:this.df.cacheSizeBytes,synchronizeTabs:r,xa:i})},Jd.prototype.clearPersistence=function(){return m(this,void 0,void 0,function(){var n,e=this;return w(this,function(t){if(void 0!==this.hf&&!this.hf.G_)throw new xr(Or.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new ka,[2,(this.cf.ps(function(){return m(e,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.if.clearPersistence(this.l_,this._f)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},Jd.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Jd.prototype,"Ef",{get:function(){return this.uf(),this.hf.G_},enumerable:!1,configurable:!0}),Jd.prototype.waitForPendingWrites=function(){return this.uf(),this.hf.waitForPendingWrites()},Jd.prototype.onSnapshotsInSync=function(t){if(this.uf(),Ld(t))return this.hf.K_(t);oi("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.hf.K_(e)},Jd.prototype.uf=function(){return this.hf||this.Tf(new Ap,new Dp,{Wl:!1}),this.hf},Jd.prototype.If=function(){return new Ri(this.l_,this._f,this.df.host,this.df.ssl,this.df.experimentalForceLongPolling)},Jd.prototype.Tf=function(t,e,n){var r=this.If();return this.hf=new Od(this.ff,this.cf),this.hf.start(r,t,e,n)},Jd.lf=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new xr(Or.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new xr(Or.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Pi(n)},Object.defineProperty(Jd.prototype,"app",{get:function(){if(!this.af)throw new xr(Or.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.af},enumerable:!1,configurable:!0}),Jd.prototype.collection=function(t){return ni("Firestore.collection",arguments,1),oi("Firestore.collection","non-empty string",1,t),this.uf(),new av(Hr.P(t),this,null)},Jd.prototype.doc=function(t){return ni("Firestore.doc",arguments,1),oi("Firestore.doc","non-empty string",1,t),this.uf(),Bd.Af(Hr.P(t),this,null)},Jd.prototype.collectionGroup=function(t){if(ni("Firestore.collectionGroup",arguments,1),oi("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new xr(Or.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.uf(),new sv((e=t,new Vu(Hr.g(),e)),this,null);var e},Jd.prototype.runTransaction=function(e){var n=this;return ni("Firestore.runTransaction",arguments,1),oi("Firestore.runTransaction","function",1,e),this.uf().transaction(function(t){return e(new Fd(n,t))})},Jd.prototype.batch=function(){return this.uf(),new qd(this)},Object.defineProperty(Jd,"logLevel",{get:function(){switch(Pr()){case l.DEBUG:return"debug";case l.ERROR:return"error";case l.SILENT:return"silent";case l.WARN:return"warn";case l.INFO:return"info";case l.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),Jd.setLogLevel=function(t){ni("Firestore.setLogLevel",arguments,1),hi("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),kr.setLogLevel(t)},Jd.prototype.Rf=function(){return this.df.timestampsInSnapshots},Jd.prototype.Pf=function(){return this.df},Jd),Fd=($d.prototype.get=function(t){var n=this;ni("Transaction.get",arguments,1);var r=vv("Transaction.get",t,this.gf);return this.yf.b_([r.__]).then(function(t){if(!t||1!==t.length)return jr();var e=t[0];if(e instanceof Lu)return new zd(n.gf,r.__,null,!1,!1,r.f_);if(e instanceof ku)return new zd(n.gf,r.__,e,!1,!1,r.f_);throw jr()})},$d.prototype.set=function(t,e,n){ii("Transaction.set",arguments,2,3);var r=vv("Transaction.set",t,this.gf);n=lv("Transaction.set",n);var i=yv(r.f_,e,n),o=vd(this.gf.wf,"Transaction.set",r.__,i,null!==r.f_,n);return this.yf.set(r.__,o),this},$d.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof Rp?(ri("Transaction.update",arguments,3),r=vv("Transaction.update",t,this.gf),gd(this.gf.wf,"Transaction.update",r.__,e,n,o)):(ni("Transaction.update",arguments,2),r=vv("Transaction.update",t,this.gf),yd(this.gf.wf,"Transaction.update",r.__,e)),this.yf.update(r.__,i),this},$d.prototype.delete=function(t){ni("Transaction.delete",arguments,1);var e=vv("Transaction.delete",t,this.gf);return this.yf.delete(e.__),this},$d),qd=(Xd.prototype.set=function(t,e,n){ii("WriteBatch.set",arguments,2,3),this.bf();var r=vv("WriteBatch.set",t,this.gf);n=lv("WriteBatch.set",n);var i=yv(r.f_,e,n),o=vd(this.gf.wf,"WriteBatch.set",r.__,i,null!==r.f_,n);return this.Vf=this.Vf.concat(o.d_(r.__,tu.Ge())),this},Xd.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.bf(),i="string"==typeof e||e instanceof Rp?(ri("WriteBatch.update",arguments,3),r=vv("WriteBatch.update",t,this.gf),gd(this.gf.wf,"WriteBatch.update",r.__,e,n,o)):(ni("WriteBatch.update",arguments,2),r=vv("WriteBatch.update",t,this.gf),yd(this.gf.wf,"WriteBatch.update",r.__,e)),this.Vf=this.Vf.concat(i.d_(r.__,tu.exists(!0))),this},Xd.prototype.delete=function(t){ni("WriteBatch.delete",arguments,1),this.bf();var e=vv("WriteBatch.delete",t,this.gf);return this.Vf=this.Vf.concat(new bu(e.__,tu.Ge())),this},Xd.prototype.commit=function(){return this.bf(),this.pf=!0,0<this.Vf.length?this.gf.uf().write(this.Vf):Promise.resolve()},Xd.prototype.bf=function(){if(this.pf)throw new xr(Or.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Xd),Bd=(o(Yd,Vd=td),Yd.Af=function(t,e,n){if(t.length%2!=0)throw new xr(Or.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.R()+" has "+t.length);return new Yd(new Xr(t),e,n)},Object.defineProperty(Yd.prototype,"id",{get:function(){return this.__.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Yd.prototype,"parent",{get:function(){return new av(this.__.path.h(),this.firestore,this.f_)},enumerable:!1,configurable:!0}),Object.defineProperty(Yd.prototype,"path",{get:function(){return this.__.path.R()},enumerable:!1,configurable:!0}),Yd.prototype.collection=function(t){if(ni("DocumentReference.collection",arguments,1),oi("DocumentReference.collection","non-empty string",1,t),!t)throw new xr(Or.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Hr.P(t);return new av(this.__.path.child(e),this.firestore,null)},Yd.prototype.isEqual=function(t){if(!(t instanceof Yd))throw yi("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.__.isEqual(t.__)&&this.f_===t.f_},Yd.prototype.set=function(t,e){ii("DocumentReference.set",arguments,1,2),e=lv("DocumentReference.set",e);var n=yv(this.f_,t,e),r=vd(this.firestore.wf,"DocumentReference.set",this.__,n,null!==this.f_,e);return this.hf.write(r.d_(this.__,tu.Ge()))},Yd.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof Rp?(ri("DocumentReference.update",arguments,2),gd(this.firestore.wf,"DocumentReference.update",this.__,t,e,r)):(ni("DocumentReference.update",arguments,1),yd(this.firestore.wf,"DocumentReference.update",this.__,t)),this.hf.write(n.d_(this.__,tu.exists(!0)))},Yd.prototype.delete=function(){return ni("DocumentReference.delete",arguments,0),this.hf.write([new bu(this.__,tu.Ge())])},Yd.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];ii("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||Ld(i[u])||(vi("DocumentReference.onSnapshot",s=i[u],["includeMetadataChanges"]),ai("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++);var a,c={includeMetadataChanges:s.includeMetadataChanges};Ld(i[u])?(a=i[u],i[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),i[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),i[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)):(oi("DocumentReference.onSnapshot","function",u,i[u]),si("DocumentReference.onSnapshot","function",u+1,i[u+1]),si("DocumentReference.onSnapshot","function",u+2,i[u+2]));var h={next:function(t){i[u]&&i[u](r.vf(t))},error:i[u+1],complete:i[u+2]};return this.hf.listen(Fu(this.__.path),c,h)},Yd.prototype.get=function(t){var e=this;ii("DocumentReference.get",arguments,0,1),dv("DocumentReference.get",t);var n=this.firestore.uf();return t&&"cache"===t.source?n.U_(this.__).then(function(t){return new zd(e.firestore,e.__,t,!0,t instanceof ku&&t.Ye,e.f_)}):n.Q_(this.__,t).then(function(t){return e.vf(t)})},Yd.prototype.withConverter=function(t){return new Yd(this.__,this.firestore,t)},Yd.prototype.vf=function(t){var e=t.docs.get(this.__);return new zd(this.firestore,this.__,e,t.fromCache,t.hasPendingWrites,this.f_)},Yd),Gd=(Qd.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Qd),zd=(Hd.prototype.data=function(t){var e=this;if(ii("DocumentSnapshot.data",arguments,0,1),t=pv("DocumentSnapshot.data",t),this.Sf){if(this.f_){var n=new Wd(this.gf,this.__,this.Sf,this.Df,this.Cf,null);return this.f_.fromFirestore(n,t)}return new Cd(this.gf.l_,this.gf.Rf(),t.serverTimestamps||"none",function(t){return new Bd(t,e.gf,null)},function(t){return new Li(t)}).J_(this.Sf.sn())}},Hd.prototype.get=function(t,e){var n=this;if(ii("DocumentSnapshot.get",arguments,1,2),e=pv("DocumentSnapshot.get",e),this.Sf){var r=this.Sf.data().field(_d("DocumentSnapshot.get",t,this.__));if(null!==r)return new Cd(this.gf.l_,this.gf.Rf(),e.serverTimestamps||"none",function(t){return new Bd(t,n.gf,n.f_)},function(t){return new Li(t)}).J_(r)}},Object.defineProperty(Hd.prototype,"id",{get:function(){return this.__.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Hd.prototype,"ref",{get:function(){return new Bd(this.__,this.gf,this.f_)},enumerable:!1,configurable:!0}),Object.defineProperty(Hd.prototype,"exists",{get:function(){return null!==this.Sf},enumerable:!1,configurable:!0}),Object.defineProperty(Hd.prototype,"metadata",{get:function(){return new Gd(this.Cf,this.Df)},enumerable:!1,configurable:!0}),Hd.prototype.isEqual=function(t){if(!(t instanceof Hd))throw yi("isEqual","DocumentSnapshot",1,t);return this.gf===t.gf&&this.Df===t.Df&&this.__.isEqual(t.__)&&(null===this.Sf?null===t.Sf:this.Sf.isEqual(t.Sf))&&this.f_===t.f_},Hd),Wd=(o(Kd,Pd=zd),Kd.prototype.data=function(t){return Pd.prototype.data.call(this,t)},Kd);function Kd(){return null!==Pd&&Pd.apply(this,arguments)||this}function Hd(t,e,n,r,i,o){this.gf=t,this.__=e,this.Sf=n,this.Df=r,this.Cf=i,this.f_=o}function Qd(t,e){this.hasPendingWrites=t,this.fromCache=e}function Yd(t,e,n){var r=this;return(r=Vd.call(this,e.l_,t,n)||this).__=t,r.firestore=e,r.f_=n,r.hf=r.firestore.uf(),r}function Xd(t){this.gf=t,this.Vf=[],this.pf=!1}function $d(t,e){this.gf=t,this.yf=e}function Jd(t,e,n,r){var i=this;if(void 0===n&&(n=new Ap),void 0===r&&(r=new Dp),this.if=n,this.rf=r,this.af=null,this.cf=new ec,this.INTERNAL={delete:function(){return m(i,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.uf(),[4,this.hf.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var o=t;this.af=o,this.l_=Jd.lf(o),this._f=o.name,this.ff=new jf(e)}else{var s=t;if(!s.projectId)throw new xr(Or.INVALID_ARGUMENT,"Must provide projectId");this.l_=new Pi(s.projectId,s.database),this._f="[DEFAULT]",this.ff=new Mf}this.df=new Md({})}function Zd(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new xr(Or.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else ui("settings","non-empty string","host",t.host),this.host=t.host,ai("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(vi("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),ai("settings","object","credentials",t.credentials),this.credentials=t.credentials,ai("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),ai("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Cr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Cr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,ai("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Yc.lo;else{if(t.cacheSizeBytes!==Ud&&t.cacheSizeBytes<Yc.ho)throw new xr(Or.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Yc.ho);this.cacheSizeBytes=t.cacheSizeBytes}ai("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}function tv(t,e,n,r,i){this.U=t,this.timestampsInSnapshots=e,this.z_=n,this.H_=r,this.Y_=i}function ev(t,e,n){if("string"==typeof n){if(""===n)throw new xr(Or.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Wu(e)&&-1!==n.indexOf("/"))throw new xr(Or.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Hr.P(n));if(!Xr.F(r))throw new xr(Or.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Zo(t,new Xr(r))}if(n instanceof td)return Zo(t,n.__);throw new xr(Or.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+pi(n)+".")}function nv(t,e){if(!Array.isArray(t)||0===t.length)throw new xr(Or.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new xr(Or.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new xr(Or.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new xr(Or.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function rv(t,e,n){if(!n.isEqual(e))throw new xr(Or.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function iv(t){if(Bu(t)&&0===t.rn.length)throw new xr(Or.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var ov,sv=(fv.prototype.where=function(t,e,n){ni("Query.where",arguments,3),di("Query.where",3,n);var r,i,o=hi("Query.where",["<","<=","==","!=",">=",">","array-contains","in","array-contains-any","not-in"],2,e),s=_d("Query.where",t),u=function(t,e,n,r,i,o){var s;if(r.p()){if("array-contains"===i||"array-contains-any"===i)throw new xr(Or.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){nv(o,i);for(var u=[],a=0,c=o;a<c.length;a++){var h=c[a];u.push(ev(n,t,h))}s={arrayValue:{values:u}}}else s=ev(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||nv(o,i),s=md(e,"Query.where",o,"in"===i||"not-in"===i);var f=ra.create(r,i,s);return function(t,e){if(e.un()){var n=zu(t);if(null!==n&&!n.isEqual(e.field))throw new xr(Or.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=Gu(t);null!==r&&rv(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==i)throw i===e.op?new xr(Or.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new xr(Or.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(this.Nf,this.firestore.wf,this.firestore.l_,s,o,n);return new fv((i=(r=this.Nf).filters.concat([u]),new Vu(r.path,r.collectionGroup,r.rn.slice(),i,r.limit,r.on,r.startAt,r.endAt)),this.firestore,this.f_)},fv.prototype.orderBy=function(t,e){var n;if(ii("Query.orderBy",arguments,1,2),si("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new xr(Or.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var r,i,o=_d("Query.orderBy",t),s=function(t,e,n){if(null!==t.startAt)throw new xr(Or.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new xr(Or.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r,i,o=new Ra(e,n),s=o;return null!==Gu(r=t)||null!==(i=zu(r))&&rv(0,i,s.field),o}(this.Nf,o,n);return new fv((i=(r=this.Nf).rn.concat([s]),new Vu(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.on,r.startAt,r.endAt)),this.firestore,this.f_)},fv.prototype.limit=function(t){return ni("Query.limit",arguments,1),oi("Query.limit","number",1,t),gi("Query.limit",1,t),new fv(Qu(this.Nf,t,"F"),this.firestore,this.f_)},fv.prototype.limitToLast=function(t){return ni("Query.limitToLast",arguments,1),oi("Query.limitToLast","number",1,t),gi("Query.limitToLast",1,t),new fv(Qu(this.Nf,t,"L"),this.firestore,this.f_)},fv.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ri("Query.startAt",arguments,1);var r=this.Ff("Query.startAt",t,e,!0);return new fv(Yu(this.Nf,r),this.firestore,this.f_)},fv.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ri("Query.startAfter",arguments,1);var r=this.Ff("Query.startAfter",t,e,!1);return new fv(Yu(this.Nf,r),this.firestore,this.f_)},fv.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ri("Query.endBefore",arguments,1);var r=this.Ff("Query.endBefore",t,e,!0);return new fv(Xu(this.Nf,r),this.firestore,this.f_)},fv.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ri("Query.endAt",arguments,1);var r=this.Ff("Query.endAt",t,e,!1);return new fv(Xu(this.Nf,r),this.firestore,this.f_)},fv.prototype.isEqual=function(t){if(!(t instanceof fv))throw yi("isEqual","Query",1,t);return this.firestore===t.firestore&&$u(this.Nf,t.Nf)&&this.f_===t.f_},fv.prototype.withConverter=function(t){return new fv(this.Nf,this.firestore,t)},fv.prototype.Ff=function(h,t,e,n){if(di(h,1,t),t instanceof zd)return ni(h,s([t],e),1),function(t,e,n,r){if(!n)throw new xr(Or.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+h+"().");for(var i=[],o=0,s=Ku(t);o<s.length;o++){var u=s[o];if(u.field.p())i.push(Zo(e,n.key));else{var a=n.field(u.field);if(qo(a))throw new xr(Or.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){var c=u.field.R();throw new xr(Or.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+c+"' (used as the orderBy) does not exist.")}i.push(a)}}return new _a(i,r)}(this.Nf,this.firestore.l_,t.Sf,n);var r=[t].concat(e);return function(t,e,n,r,i,o){var s=t.rn;if(i.length>s.length)throw new xr(Or.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.p()){if("string"!=typeof c)throw new xr(Or.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Wu(t)&&-1!==c.indexOf("/"))throw new xr(Or.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Hr.P(c));if(!Xr.F(h))throw new xr(Or.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new Xr(h);u.push(Zo(e,f))}else{var l=md(n,r,c);u.push(l)}}return new _a(u,o)}(this.Nf,this.firestore.l_,this.firestore.wf,h,r,n)},fv.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];ii("Query.onSnapshot",arguments,1,4);var s,u={},a=0;"object"!=typeof i[a]||Ld(i[a])||(vi("Query.onSnapshot",u=i[a],["includeMetadataChanges"]),ai("Query.onSnapshot","boolean","includeMetadataChanges",u.includeMetadataChanges),a++),Ld(i[a])?(s=i[a],i[a]=null===(t=s.next)||void 0===t?void 0:t.bind(s),i[a+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),i[a+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(oi("Query.onSnapshot","function",a,i[a]),si("Query.onSnapshot","function",a+1,i[a+1]),si("Query.onSnapshot","function",a+2,i[a+2]));var c={next:function(t){i[a]&&i[a](new uv(r.firestore,r.Nf,t,r.f_))},error:i[a+1],complete:i[a+2]};return iv(this.Nf),this.firestore.uf().listen(this.Nf,u,c)},fv.prototype.get=function(t){var e=this;ii("Query.get",arguments,0,1),dv("Query.get",t),iv(this.Nf);var n=this.firestore.uf();return(t&&"cache"===t.source?n.W_(this.Nf):n.j_(this.Nf,t)).then(function(t){return new uv(e.firestore,e.Nf,t,e.f_)})},fv),uv=(Object.defineProperty(hv.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(hv.prototype,"empty",{get:function(){return this.xf.docs.m()},enumerable:!1,configurable:!0}),Object.defineProperty(hv.prototype,"size",{get:function(){return this.xf.docs.size},enumerable:!1,configurable:!0}),hv.prototype.forEach=function(e,n){var r=this;ii("QuerySnapshot.forEach",arguments,1,2),oi("QuerySnapshot.forEach","function",1,e),this.xf.docs.forEach(function(t){e.call(n,r.Of(t,r.metadata.fromCache,r.xf.Qt.has(t.key)))})},Object.defineProperty(hv.prototype,"query",{get:function(){return new sv(this.$f,this.gf,this.f_)},enumerable:!1,configurable:!0}),hv.prototype.docChanges=function(t){t&&(vi("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),ai("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.xf.jt)throw new xr(Or.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.kf&&this.Mf===e||(this.kf=function(i,e,o){if(i.Ut.m()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Ut;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return jr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.xf,e,this.Of.bind(this)),this.Mf=e),this.kf},hv.prototype.isEqual=function(t){if(!(t instanceof hv))throw yi("isEqual","QuerySnapshot",1,t);return this.gf===t.gf&&$u(this.$f,t.$f)&&this.xf.isEqual(t.xf)&&this.f_===t.f_},hv.prototype.Of=function(t,e,n){return new Wd(this.gf,t.key,t,e,n,this.f_)},hv),av=(o(cv,ov=sv),Object.defineProperty(cv.prototype,"id",{get:function(){return this.Nf.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(cv.prototype,"parent",{get:function(){var t=this.Nf.path.h();return t.m()?null:new Bd(new Xr(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(cv.prototype,"path",{get:function(){return this.Nf.path.R()},enumerable:!1,configurable:!0}),cv.prototype.doc=function(t){ii("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=bi.k()),oi("CollectionReference.doc","non-empty string",1,t);var e=Hr.P(t);return Bd.Af(this.Nf.path.child(e),this.firestore,this.f_)},cv.prototype.add=function(t){ni("CollectionReference.add",arguments,1);var e=this.f_?this.f_.toFirestore(t):t;oi("CollectionReference.add","object",1,e);var n=this.doc();return new Bd(n.__,this.firestore,null).set(e).then(function(){return n})},cv.prototype.withConverter=function(t){return new cv(this.Lf,this.firestore,t)},cv);function cv(t,e,n){var r=this;if(((r=ov.call(this,Fu(t),e,n)||this).Lf=t).length%2!=1)throw new xr(Or.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.R()+" has "+t.length);return r}function hv(t,e,n,r){this.gf=t,this.$f=e,this.xf=n,this.f_=r,this.kf=null,this.Mf=null,this.metadata=new Gd(n.hasPendingWrites,n.fromCache)}function fv(t,e,n){this.Nf=t,this.firestore=e,this.f_=n}function lv(t,e){if(void 0===e)return{merge:!1};if(vi(t,e,["merge","mergeFields"]),ai(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new xr(Or.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+pi(n));for(var r,i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof Rp))throw new xr(Or.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+pi(n[i]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new xr(Or.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function pv(t,e){return void 0===e?{}:(vi(t,e,["serverTimestamps"]),ci(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function dv(t,e){si(t,"object",1,e),e&&(vi(t,e,["source"]),ci(t,0,"source",e.source,["default","server","cache"]))}function vv(t,e,n){if(e instanceof td){if(e.firestore!==n)throw new xr(Or.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw yi(t,"DocumentReference",1,e)}function yv(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var gv,mv,wv=(o(Iv,gv=Jp),Iv.serverTimestamp=function(){ei("FieldValue.serverTimestamp",arguments);var t=new Hp("serverTimestamp");return t.t_="FieldValue.serverTimestamp",new Iv(t)},Iv.delete=function(){ei("FieldValue.delete",arguments);var t=new Pp("deleteField");return t.t_="FieldValue.delete",new Iv(t)},Iv.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];ri("FieldValue.arrayUnion",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ri("arrayUnion()",arguments,1),new Qp("arrayUnion",t)}.apply(void 0,t);return n.t_="FieldValue.arrayUnion",new Iv(n)},Iv.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];ri("FieldValue.arrayRemove",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ri("arrayRemove()",arguments,1),new Yp("arrayRemove",t)}.apply(void 0,t);return n.t_="FieldValue.arrayRemove",new Iv(n)},Iv.increment=function(t){oi("FieldValue.increment","number",1,t),ni("FieldValue.increment",arguments,1);var e=new Xp("increment",t);return e.t_="FieldValue.increment",new Iv(e)},Iv.prototype.isEqual=function(t){return this.h_.isEqual(t.h_)},Iv),bv={Firestore:jd,GeoPoint:$p,Timestamp:Ci,Blob:Li,Transaction:Fd,WriteBatch:qd,DocumentReference:Bd,DocumentSnapshot:zd,Query:sv,QueryDocumentSnapshot:Wd,QuerySnapshot:uv,CollectionReference:av,FieldPath:Rp,FieldValue:wv,setLogLevel:jd.setLogLevel,CACHE_SIZE_UNLIMITED:Ud};function Iv(){return null!==gv&&gv.apply(this,arguments)||this}(mv=r.default).INTERNAL.registerComponent(new Ar("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),r=new Dp,i=new Sp(r),new jd(e,n,i,r);var e,n,r,i},"PUBLIC").setServiceProps(Object.assign({},bv))),mv.registerVersion("@firebase/firestore","1.17.1-eap-auth-emulator.8fbbe234f")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Qy){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var f,e=t(Qy),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Ee=f=f||{})[Ee.DEBUG=0]="DEBUG",Ee[Ee.VERBOSE=1]="VERBOSE",Ee[Ee.INFO=2]="INFO",Ee[Ee.WARN=3]="WARN",Ee[Ee.ERROR=4]="ERROR",Ee[Ee.SILENT=5]="SILENT";function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var u={debug:f.DEBUG,verbose:f.VERBOSE,info:f.INFO,warn:f.WARN,error:f.ERROR,silent:f.SILENT},a=f.INFO,c=((Ie={})[f.DEBUG]="log",Ie[f.VERBOSE]="log",Ie[f.INFO]="info",Ie[f.WARN]="warn",Ie[f.ERROR]="error",Ie),h=(Object.defineProperty(l.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in f))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),l.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?u[t]:t},Object.defineProperty(l.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),l.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.DEBUG],t)),this._logHandler.apply(this,s([this,f.DEBUG],t))},l.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.VERBOSE],t)),this._logHandler.apply(this,s([this,f.VERBOSE],t))},l.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.INFO],t)),this._logHandler.apply(this,s([this,f.INFO],t))},l.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.WARN],t)),this._logHandler.apply(this,s([this,f.WARN],t))},l.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.ERROR],t)),this._logHandler.apply(this,s([this,f.ERROR],t))},l);function l(t){this.name=t,this._logLevel=a,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e){e=d.call(this,e)||this;return e.code=t,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").",s=new m(o,t),u=0,a=Object.keys(i);u<a.length;u++){var c=a[u];"_"!==c.slice(-1)&&(c in s&&console.warn('Overwriting FirebaseError base field "'+c+'" can cause unexpected behavior.'),s[c]=i[c])}return s},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function _(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S={},D=N||self;function R(){}function O(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function x(t){var e=O(t);return"array"==e||"object"==e&&"number"==typeof t.length}function k(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var L="closure_uid_"+(1e9*Math.random()>>>0),P=0;function U(t,e,n){return t.call.apply(t.bind,arguments)}function C(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function V(t,e,n){return(V=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?U:C).apply(null,arguments)}function M(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var F=Date.now;function j(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function G(){this.j=this.j,this.i=this.i}G.prototype.j=!1,G.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,L)&&t[L]||(t[L]=++P))},G.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var q=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function z(){return Array.prototype.concat.apply([],arguments)}function K(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function Q(t){return/^[\s\xa0]*$/.test(t)}var H,W=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function Y(t,e){return t<e?-1:e<t?1:0}t:{var J=D.navigator;if(J){J=J.userAgent;if(J){H=J;break t}}H=""}function Z(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function $(t){var e,n={};for(e in t)n[e]=t[e];return n}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<tt.length;i++)e=tt[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function nt(t){return nt[" "](t),t}nt[" "]=R;var rt,it=X(H,"Opera"),ot=X(H,"Trident")||X(H,"MSIE"),st=X(H,"Edge"),ut=st||ot,at=X(H,"Gecko")&&!(X(H.toLowerCase(),"webkit")&&!X(H,"Edge"))&&!(X(H,"Trident")||X(H,"MSIE"))&&!X(H,"Edge"),ct=X(H.toLowerCase(),"webkit")&&!X(H,"Edge");function ht(){var t=D.document;return t?t.documentMode:void 0}t:{var lt="",ft=(ft=H,at?/rv:([^\);]+)(\)|;)/.exec(ft):st?/Edge\/([\d\.]+)/.exec(ft):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ft):ct?/WebKit\/(\S+)/.exec(ft):it?/(?:Version)[ \/]?(\S+)/.exec(ft):void 0);if(ft&&(lt=ft?ft[1]:""),ot){ft=ht();if(null!=ft&&ft>parseFloat(lt)){rt=String(ft);break t}}rt=lt}var pt={};function dt(u){return t=u,e=function(){for(var t=0,e=W(String(rt)).split("."),n=W(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Y(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Y(0==o[2].length,0==s[2].length)||Y(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=pt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var yt=D.document&&ot?ht()||(parseInt(rt,10)||void 0):void 0,vt=!ot||9<=Number(yt),gt=ot&&!dt("9"),mt=function(){if(!D.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{D.addEventListener("test",R,e),D.removeEventListener("test",R,e)}catch(t){}return t}();function wt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function bt(t,e){if(wt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(at){t:{try{nt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Et[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}wt.prototype.b=function(){this.defaultPrevented=!0},j(bt,wt);var Et={2:"touch",3:"pen",4:"mouse"};bt.prototype.b=function(){bt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,gt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var It="closure_listenable_"+(1e6*Math.random()|0),Tt=0;function _t(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Tt,this.Y=this.Z=!1}function At(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Nt(t){this.src=t,this.a={},this.b=0}function St(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=q(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(At(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Dt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Nt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Dt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new _t(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Rt="closure_lm_"+(1e6*Math.random()|0),Ot={};function xt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=Ft(r);return e&&e[It]?e.wa(n,r,k(i)?!!i.capture:!!i,o):kt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)xt(t,e[o],n,r,i);return null}return n=Ft(n),t&&t[It]?t.va(e,n,k(r)?!!r.capture:!!r,i):kt(t,e,n,!1,r,i)}function kt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=k(i)?!!i.capture:!!i;if(s&&!vt)return null;var u,a,c=Vt(t);if(c||(t[Rt]=c=new Nt(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Ct,r=a=vt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)mt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Pt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Lt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[It]?St(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Pt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Vt(e))?(St(n,t),0==n.b&&(n.src=null,e[Rt]=null)):At(t)))}function Pt(t){return t in Ot?Ot[t]:Ot[t]="on"+t}function Ut(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Lt(t),n.call(r,e)}function Ct(t,e){if(t.Y)return!0;if(vt)return Ut(t,new bt(e,this));if(!e)t:{e=["window","event"];for(var n=D,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ut(t,e=new bt(e,this))}function Vt(t){return(t=t[Rt])instanceof Nt?t:null}var Mt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ft(e){return"function"==O(e)?e:(e[Mt]||(e[Mt]=function(t){return e.handleEvent(t)}),e[Mt])}function jt(){G.call(this),this.c=new Nt(this),(this.J=this).C=null}function Gt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&St(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}j(jt,G),jt.prototype[It]=!0,(A=jt.prototype).addEventListener=function(t,e,n,r){xt(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=k(i)?!!i.capture:!!i,r=Ft(r),e&&e[It]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Dt(s=e.a[n],r,i,o))&&(At(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Vt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Dt(n,r,i,o)),(r=-1<e?n[e]:null)&&Lt(r))}(this,t,e,n,r)},A.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new wt(t,n):t instanceof wt?t.target=t.target||n:(s=t,et(t=new wt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=Gt(o,r,!0,t)&&s;if(s=Gt(o=t.a=n,r,!0,t)&&s,s=Gt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Gt(o=t.a=e[i],r,!1,t)&&s;return s},A.G=function(){if(jt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)At(n[r]);delete e.a[t],e.b--}}this.C=null},A.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var qt=D.JSON.stringify;function Bt(){this.b=this.a=null}var zt,Kt=(Qt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Qt(function(){return new Ht},function(t){t.reset()},100));function Qt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Ht(){this.next=this.b=this.a=null}function Wt(t,e){var n;zt||(n=D.Promise.resolve(void 0),zt=function(){n.then(Jt)}),Xt||(zt(),Xt=!0),Yt.add(t,e)}Bt.prototype.add=function(t,e){var n=Kt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Ht.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Xt=!(Ht.prototype.reset=function(){this.next=this.b=this.a=null}),Yt=new Bt;function Jt(){for(var t,e;n=e=void 0,n=null,(e=Yt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){D.setTimeout(function(){throw t},0)}(t)}var n=Kt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Xt=!1}function Zt(t,e){jt.call(this),this.b=t||1,this.a=e||D,this.f=V(this.Ya,this),this.g=F()}function $t(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function te(t,e,n){if("function"==O(t))n&&(t=V(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=V(t.handleEvent,t)}return 2147483647<Number(e)?-1:D.setTimeout(t,e||0)}j(Zt,jt),(A=Zt.prototype).aa=!1,A.M=null,A.Ya=function(){var t;this.aa&&(0<(t=F()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&($t(this),this.start())))},A.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=F())},A.G=function(){Zt.S.G.call(this),$t(this),delete this.a};var ee,ne,re,ie=(T(ne=se,re=ee=G),ne.prototype=null===re?Object.create(re):(oe.prototype=re.prototype,new oe),se.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=te(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},se.prototype.G=function(){ee.prototype.G.call(this),this.a&&(D.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},se);function oe(){this.constructor=ne}function se(t,e,n){var r=ee.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function ue(t){G.call(this),this.b=t,this.a={}}j(ue,G);var ae=[];function ce(t,e,n,r){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var i=0;i<n.length;i++){var o=xt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function he(t){Z(t.a,function(t,e){this.a.hasOwnProperty(e)&&Lt(t)},t),t.a={}}function le(){this.a=!0}function fe(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return qt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ue.prototype.G=function(){ue.S.G.call(this),he(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},le.prototype.info=function(){};var pe=null;function de(){return pe=pe||new jt}function ye(t){wt.call(this,"serverreachability",t)}function ve(t){var e=de();e.dispatchEvent(new ye(e))}function ge(t){wt.call(this,"statevent",t)}function me(t){var e=de();e.dispatchEvent(new ge(e))}function we(t){wt.call(this,"timingevent",t)}function be(t,e){if("function"!=O(t))throw Error("Fn must not be null and must be a function");return D.setTimeout(function(){t()},e)}j(ye,wt),j(ge,wt),j(we,wt);var Ee={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ie={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Te(){}function _e(t){var e;return(e=t.a)||(e=t.a={}),e}function Ae(){}Te.prototype.a=null;var Ne,N={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Se(){wt.call(this,"d")}function De(){wt.call(this,"c")}function Re(){}function Oe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new ue(this),this.P=xe,t=ut?125:void 0,this.R=new Zt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}j(Se,wt),j(De,wt),j(Re,Te),Ne=new Re;var xe=45e3,ke={},Le={};function Pe(t,e,n){t.H=1,t.i=en(Xe(e)),t.j=n,t.I=!0,Ue(t,null)}function Ue(t,e){t.u=F(),Ve(t),t.l=Xe(t.i);var s,u,a,c,h,l,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),yn(n.b,"t",r),t.D=0,t.a=ar(t.g,t.g.C?e:null),0<t.O&&(t.F=new ie(V(t.Ca,t,t.a),t.O)),ce(t.J,t.a,"readystatechange",t.Wa),e=t.B?$(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ve(1),s=t.c,u=t.m,a=t.l,c=t.f,h=t.T,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Ce(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Le:(i=Number(u.substring(i,o)),isNaN(i)?ke:(o+=1)+i>u.length?Le:(u=u.substr(o,i),r.D=o+i,u)));if(u==Le){4==e&&(t.h=4,me(14),s=!1),fe(t.c,t.f,null,"[Incomplete Response]");break}if(u==ke){t.h=4,me(15),fe(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}fe(t.c,t.f,u,null),qe(t,u)}4==e&&0==n.length&&(t.h=1,me(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),tr(e),e.F=!0)):(fe(t.c,t.f,n,"[Invalid Chunked Response]"),Ge(t),je(t))}function Ve(t){t.U=F()+t.P,Me(t,t.P)}function Me(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=be(V(t.Ua,t),e)}function Fe(t){t.o&&(D.clearTimeout(t.o),t.o=null)}function je(t){0==t.g.v||t.A||rr(t.g,t)}function Ge(t){Fe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,$t(t.R),he(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function qe(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||In(u.b,t)))if(u.I=t.N,!t.C&&In(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;nr(u),Kn(u)}$n(u),me(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=be(V(u.Ra,u),6e3));if(En(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else or(u,11)}else if(!t.C&&u.a!=t||nr(u),!Q(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(X(r,"spdy")||X(r,"quic")||X(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(Tn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,tn(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.V&&(u.N=F()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ur(n,n.C?n.ga:null,n.fa),i.C?(_n(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Fe(o),Ve(o)),n.a=i):Zn(n),0<u.g.length&&Wn(u)):"stop"!=c[0]&&"close"!=c[0]||or(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?or(u,7):zn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0)}ve(4)}catch(t){}}function Be(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(x(t)||"string"==typeof t)B(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(x(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(x(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function ze(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof ze)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Ke(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Qe(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Qe(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Qe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=Oe.prototype).setTimeout=function(t){this.P=t},A.Wa=function(t){t=t.target;var e=this.F;e&&3==jn(t)?e.f():this.Ca(t)},A.Ca=function(t){try{if(t==this.a)t:{var e=jn(this.a),n=this.a.ua(),r=this.a.X();if(!(e<3||3==e&&!ut&&!this.a.$())){this.A||4!=e||7==n||ve(8==n||r<=0?3:2),Fe(this);var i=this.a.X();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.T,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.V&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Q(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,me(12),Ge(this),je(this);break t}fe(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,qe(this,s)}this.I?(Ce(this,e,n),ut&&this.b&&3==e&&(ce(this.J,this.R,"tick",this.Va),this.R.start())):(fe(this.c,this.f,n,null),qe(this,n)),4==e&&Ge(this),this.b&&!this.A&&(4==e?rr(this.g,this):(this.b=!1,Ve(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,me(12)):(this.h=0,me(13)),Ge(this),je(this)}}}catch(t){}var u,a,c,h,l,f},A.Va=function(){var t,e;this.a&&(t=jn(this.a),e=this.a.$(),this.D<e.length&&(Fe(this),Ce(this,t,e),this.b&&4!=t&&Ve(this)))},A.cancel=function(){this.A=!0,Ge(this)},A.Ua=function(){this.o=null;var t,e,n=F();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ve(3),me(17)),Ge(this),this.h=2,je(this)):Me(this,this.U-n)},(A=ze.prototype).K=function(){Ke(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.L=function(){return Ke(this),this.a.concat()},A.get=function(t,e){return Qe(this.b,t)?this.b[t]:e},A.set=function(t,e){Qe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var He=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function We(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof We?(this.a=void 0!==e?e:t.a,Ye(this,t.f),this.j=t.j,Je(this,t.c),Ze(this,t.h),this.g=t.g,e=t.b,(n=new ln).c=e.c,e.a&&(n.a=new ze(e.a),n.b=e.b),$e(this,n),this.i=t.i):t&&(n=String(t).match(He))?(this.a=!!e,Ye(this,n[1]||"",!0),this.j=nn(n[2]||""),Je(this,n[3]||"",!0),Ze(this,n[4]),this.g=nn(n[5]||"",!0),$e(this,n[6]||"",!0),this.i=nn(n[7]||"")):(this.a=!!e,this.b=new ln(null,this.a))}function Xe(t){return new We(t)}function Ye(t,e,n){t.f=n?nn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Je(t,e,n){t.c=n?nn(e,!0):e}function Ze(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function $e(t,e,n){var r,i;e instanceof ln?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(fn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(pn(this,e),yn(this,n,t))},r)),r.f=i):(n||(e=rn(e,cn)),t.b=new ln(e,t.a))}function tn(t,e,n){t.b.set(e,n)}function en(t){return tn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^F()).toString(36)),t}function nn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function rn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,on),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function on(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}We.prototype.toString=function(){var t=[],e=this.f;e&&t.push(rn(e,sn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(rn(e,sn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(rn(n,"/"==n.charAt(0)?an:un,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",rn(n,hn)),t.join("")};var sn=/[#\/\?@]/g,un=/[#\?:]/g,an=/[#\?]/g,cn=/[#\?@]/g,hn=/#/g;function ln(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function fn(n){n.a||(n.a=new ze,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function pn(t,e){fn(t),e=vn(t,e),Qe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Qe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Ke(t)))}function dn(t,e){return fn(t),e=vn(t,e),Qe(t.a.b,e)}function yn(t,e,n){pn(t,e),0<n.length&&(t.c=null,t.a.set(vn(t,e),K(n)),t.b+=n.length)}function vn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function gn(t,e){this.b=t,this.a=e}function mn(t){this.g=t||wn,t=D.PerformanceNavigationTiming?0<(t=D.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(D.ia&&D.ia.ya&&D.ia.ya()&&D.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(A=ln.prototype).add=function(t,e){fn(this),this.c=null,t=vn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){fn(this),this.a.forEach(function(t,e){B(t,function(t){n.call(r,t,e,this)},this)},this)},A.L=function(){fn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.K=function(t){fn(this);var e=[];if("string"==typeof t)dn(this,t)&&(e=z(e,this.a.get(vn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},A.set=function(t,e){return fn(this),this.c=null,dn(this,t=vn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var wn=10;function bn(t){return t.b||t.a&&t.a.size>=t.f}function En(t){return t.b?1:t.a?t.a.size:0}function In(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Tn(t,e){t.a?t.a.add(e):t.b=e}function _n(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function An(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return K(t.c);var r=t.c;try{for(var i=_(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Nn(){}function Sn(){this.a=new Nn}function Dn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}mn.prototype.cancel=function(){var e,t;if(this.c=An(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=_(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Nn.prototype.stringify=function(t){return D.JSON.stringify(t,void 0)},Nn.prototype.parse=function(t){return D.JSON.parse(t,void 0)};var Rn=D.JSON.parse;function On(t){jt.call(this),this.headers=new ze,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=xn,this.D=this.F=!1}j(On,jt);var xn="",kn=/^https?$/i,Ln=["POST","PUT"];function Pn(t){return"content-type"==t.toLowerCase()}function Un(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Cn(t),Mn(t)}function Cn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Vn(t){if(t.b&&void 0!==S&&(!t.s[1]||4!=jn(t)||2!=t.X()))if(t.l&&4==jn(t))te(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==jn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(He)[1]||null)&&D.self&&D.self.location&&(i=(r=D.self.location.protocol).substr(0,r.length-1)),n=!kn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<jn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Cn(t)}}finally{Mn(t)}}}function Mn(t,e){if(t.a){Fn(t);var n=t.a,r=t.s[0]?R:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Fn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(D.clearTimeout(t.m),t.m=null)}function jn(t){return t.a?t.a.readyState:0}function Gn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Z(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):tn(t,e,n))}function qn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Bn(t){this.pa=0,this.g=[],this.c=new le,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=qn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=qn("baseRetryDelayMs",5e3,t),this.Ma=qn("retryDelaySeedMs",1e4,t),this.Ja=qn("forwardChannelMaxRetries",2,t),this.ma=qn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new mn(t&&t.concurrentRequestLimit),this.ka=new Sn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function zn(t){var e,n;Qn(t),3==t.v&&(e=t.R++,tn(n=Xe(t.B),"SID",t.J),tn(n,"RID",e),tn(n,"TYPE","terminate"),Yn(t,n),(e=new Oe(t,t.c,e,void 0)).H=2,e.i=en(Xe(n)),n=!1,D.navigator&&D.navigator.sendBeacon&&(n=D.navigator.sendBeacon(e.i.toString(),"")),!n&&D.Image&&((new Image).src=e.i,n=!0),n||(e.a=ar(e.g,null),e.a.ba(e.i)),e.u=F(),Ve(e)),sr(t)}function Kn(t){t.a&&(tr(t),t.a.cancel(),t.a=null)}function Qn(t){Kn(t),t.j&&(D.clearTimeout(t.j),t.j=null),nr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&D.clearTimeout(t.h),t.h=null)}function Hn(t,e){t.g.push(new gn(t.La++,e)),3==t.v&&Wn(t)}function Wn(t){bn(t.b)||t.h||(t.h=!0,Wt(t.Ba,t),t.u=0)}function Xn(t,e){var n=e?e.f:t.R++,r=Xe(t.B);tn(r,"SID",t.J),tn(r,"RID",n),tn(r,"AID",t.P),Yn(t,r),t.i&&t.l&&Gn(r,t.i,t.l),n=new Oe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Jn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Tn(t.b,n),Pe(n,r,e)}function Yn(t,n){t.f&&Be({},function(t,e){tn(n,e,t)})}function Jn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?V(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{Be(t,function(t,e){var n=t;k(t)&&(n=qt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Zn(t){t.a||t.j||(t.U=1,Wt(t.Aa,t),t.o=0)}function $n(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=be(V(t.Aa,t),ir(t,t.o)),t.o++,1)}function tr(t){null!=t.s&&(D.clearTimeout(t.s),t.s=null)}function er(t){t.a=new Oe(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Xe(t.la);tn(e,"RID","rpc"),tn(e,"SID",t.J),tn(e,"CI",t.H?"0":"1"),tn(e,"AID",t.P),Yn(t,e),tn(e,"TYPE","xmlhttp"),t.i&&t.l&&Gn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=en(Xe(e)),n.j=null,n.I=!0,Ue(n,t)}function nr(t){null!=t.m&&(D.clearTimeout(t.m),t.m=null)}function rr(t,e){var n,r=null;if(t.a==e){nr(t),tr(t),t.a=null;var i=2}else{if(!In(t.b,e))return;r=e.s,_n(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=F()-e.u,n=t.u,(i=de()).dispatchEvent(new we(i)),Wn(t)):Zn(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(En(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=be(V(t.Ba,t,e),ir(t,t.u)),t.u++,1}}(t,e)||2==i&&$n(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:or(t,5);break;case 4:or(t,10);break;case 3:or(t,6);break;default:or(t,2)}}function ir(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function or(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=V(t.Xa,t),r||(r=new We("//www.google.com/images/cleardot.gif"),D.location&&"http"==D.location.protocol||Ye(r,"https"),en(r)),n=r.toString(),r=o,o=new le,D.Image?((i=new Image).onload=M(Dn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=M(Dn,o,i,"TestLoadImage: error",!1,r),i.onabort=M(Dn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=M(Dn,o,i,"TestLoadImage: timeout",!1,r),D.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):me(2),t.v=0,t.f&&t.f.ra(e),sr(t),Qn(t)}function sr(t){t.v=0,t.I=-1,t.f&&(0==An(t.b).length&&0==t.g.length||(t.b.c.length=0,K(t.g),t.g.length=0),t.f.qa())}function ur(t,e,n){var r,i,o,s,u,a=(s=n)instanceof We?Xe(s):new We(s,void 0);return""!=a.c?(e&&Je(a,e+"."+a.c),Ze(a,a.h)):(u=D.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new We(null,void 0),r&&Ye(u,r),i&&Je(u,i),o&&Ze(u,o),s&&(u.g=s),a=u),t.W&&Z(t.W,function(t,e){tn(a,e,t)}),e=t.A,n=t.na,e&&n&&tn(a,e,n),tn(a,"VER",t.ha),Yn(t,a),a}function ar(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new On(t.Ka)).F=t.C,e}function cr(){}function hr(){if(ot&&!(10<=Number(yt)))throw Error("Environmental error: no available transport.")}function lr(t,e){jt.call(this),this.a=new Bn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!Q(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Q(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new dr(this)}function fr(t){Se.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function pr(){De.call(this),this.status=1}function dr(t){this.a=t}(A=On.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?_e(this.H):_e(Ne),this.a.onreadystatechange=V(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Un(this,t)}t=n||"";var i,o=new ze(this.headers);r&&Be(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Pn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=D.FormData&&t instanceof D.FormData,0<=q(Ln,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Fn(this),0<this.o&&((this.D=(i=this.a,ot&&dt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=V(this.xa,this)):this.m=te(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Un(this,t)}},A.xa=function(){void 0!==S&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Mn(this))},A.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Mn(this,!0)),On.S.G.call(this)},A.za=function(){this.j||(this.A||this.l||this.g?Vn(this):this.Ta())},A.Ta=function(){Vn(this)},A.X=function(){try{return 2<jn(this)?this.a.status:-1}catch(t){return-1}},A.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Rn(e)}},A.ua=function(){return this.h},A.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=Bn.prototype).ha=8,A.v=1,A.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Oe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?et(r=$(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Jn(this,n,e),tn(i=Xe(this.B),"RID",t),tn(i,"CVER",22),this.A&&tn(i,"X-HTTP-Session-Id",this.A),Yn(this,i),this.i&&r&&Gn(i,this.i,r),Tn(this.b,n),this.Ga&&tn(i,"TYPE","init"),this.da?(tn(i,"$req",e),tn(i,"SID","null"),n.V=!0,Pe(n,i,null)):Pe(n,i,e),this.v=2}}else 3==this.v&&(t?Xn(this,t):0==this.g.length||bn(this.b)||Xn(this))},A.Aa=function(){var t;this.j=null,er(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=be(V(this.Sa,this),t))},A.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Kn(this),er(this))},A.Ra=function(){null!=this.m&&(this.m=null,Kn(this),$n(this),me(19))},A.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),me(2)):(this.c.info("Failed to ping google.com"),me(1))},(A=cr.prototype).ta=function(){},A.sa=function(){},A.ra=function(){},A.qa=function(){},A.Ha=function(){},hr.prototype.a=function(t,e){return new lr(t,e)},j(lr,jt),(A=lr.prototype).addEventListener=function(t,e,n,r){lr.S.addEventListener.call(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){lr.S.removeEventListener.call(this,t,e,n,r)},A.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;me(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=ur(t,null,t.fa),Wn(t)},A.close=function(){zn(this.a)},A.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Hn(this.a,e)):this.g?((e={}).__data__=qt(t),Hn(this.a,e)):Hn(this.a,t)},A.G=function(){this.a.f=null,delete this.f,zn(this.a),delete this.a,lr.S.G.call(this)},j(fr,Se),j(pr,De),j(dr,cr),dr.prototype.ta=function(){this.a.dispatchEvent("a")},dr.prototype.sa=function(t){this.a.dispatchEvent(new fr(t))},dr.prototype.ra=function(t){this.a.dispatchEvent(new pr)},dr.prototype.qa=function(){this.a.dispatchEvent("b")},hr.prototype.createWebChannel=hr.prototype.a,lr.prototype.send=lr.prototype.Pa,lr.prototype.open=lr.prototype.Oa,Ee.NO_ERROR=0,Ee.TIMEOUT=8,Ee.HTTP_ERROR=6,Ie.COMPLETE="complete",(Ae.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",jt.prototype.listen=jt.prototype.va,On.prototype.listenOnce=On.prototype.wa,On.prototype.getLastError=On.prototype.Qa,On.prototype.getLastErrorCode=On.prototype.ua,On.prototype.getStatus=On.prototype.X,On.prototype.getResponseJson=On.prototype.Na,On.prototype.getResponseText=On.prototype.$,On.prototype.send=On.prototype.ba;var Ee={createWebChannelTransport:function(){return new hr},ErrorCode:Ee,EventType:Ie,WebChannel:Ae,XhrIo:On},yr=Ee.createWebChannelTransport,vr=Ee.ErrorCode,gr=Ee.EventType,mr=Ee.WebChannel,wr=Ee.XhrIo,br=(Er.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Er.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Er.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Er);function Er(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Ir,Tr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},_r=(n(Sr,Ir=Error),Sr),Ar="7.22.1-alpha.6b865e005",Nr=new h("@firebase/firestore");function Sr(t,e){var n=this;return(n=Ir.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Dr(){return Nr.logLevel}function Rr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=f.DEBUG&&(e=n.map(kr),Nr.debug.apply(Nr,i(["Firestore ("+Ar+"): "+t],e)))}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=f.ERROR&&(e=n.map(kr),Nr.error.apply(Nr,i(["Firestore ("+Ar+"): "+t],e)))}function xr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=f.WARN&&(e=n.map(kr),Nr.warn.apply(Nr,i(["Firestore ("+Ar+"): "+t],e)))}function kr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Lr(t){void 0===t&&(t="Unexpected state");t="FIRESTORE ("+Ar+") INTERNAL ASSERTION FAILED: "+t;throw Or(t),new Error(t)}function Pr(t){t||Lr()}function Ur(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Cr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Vr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Mr,Fr,Ie=(Object.defineProperty(Hr.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),Hr.prototype.isEqual=function(t){return 0===Hr.i(this,t)},Hr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Hr?t.forEach(function(t){e.push(t)}):e.push(t),this.o(e)},Hr.prototype.limit=function(){return this.offset+this.length},Hr.prototype.u=function(t){return t=void 0===t?1:t,this.o(this.segments,this.offset+t,this.length-t)},Hr.prototype.h=function(){return this.o(this.segments,this.offset,this.length-1)},Hr.prototype.l=function(){return this.segments[this.offset]},Hr.prototype._=function(){return this.get(this.length-1)},Hr.prototype.get=function(t){return this.segments[this.offset+t]},Hr.prototype.m=function(){return 0===this.length},Hr.prototype.T=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Hr.prototype.I=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Hr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Hr.prototype.A=function(){return this.segments.slice(this.offset,this.limit())},Hr.i=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Hr),jr=(n(Qr,Fr=Ie),Qr.prototype.o=function(t,e,n){return new Qr(t,e,n)},Qr.prototype.R=function(){return this.A().join("/")},Qr.prototype.toString=function(){return this.R()},Qr.P=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new _r(Tr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new Qr(n)},Qr.g=function(){return new Qr([])},Qr),Gr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,qr=(n(Kr,Mr=Ie),Kr.prototype.o=function(t,e,n){return new Kr(t,e,n)},Kr.V=function(t){return Gr.test(t)},Kr.prototype.R=function(){return this.A().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),Kr.V(t)||(t="`"+t+"`"),t}).join(".")},Kr.prototype.toString=function(){return this.R()},Kr.prototype.p=function(){return 1===this.length&&"__name__"===this.get(0)},Kr.v=function(){return new Kr(["__name__"])},Kr.S=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new _r(Tr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new _r(Tr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new _r(Tr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new _r(Tr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Kr(e)},Kr.g=function(){return new Kr([])},Kr),Br=(zr.D=function(t){return new zr(jr.P(t))},zr.C=function(t){return new zr(jr.P(t).u(5))},zr.prototype.N=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},zr.prototype.isEqual=function(t){return null!==t&&0===jr.i(this.path,t.path)},zr.prototype.toString=function(){return this.path.toString()},zr.i=function(t,e){return jr.i(t.path,e.path)},zr.F=function(t){return t.length%2==0},zr.$=function(t){return new zr(new jr(t.slice()))},zr);function zr(t){this.path=t}function Kr(){return null!==Mr&&Mr.apply(this,arguments)||this}function Qr(){return null!==Fr&&Fr.apply(this,arguments)||this}function Hr(t,e,n){void 0===e?e=0:e>t.length&&Lr(),void 0===n?n=t.length-e:n>t.length-e&&Lr(),this.segments=t,this.offset=e,this.t=n}function Wr(t,e){if(0!==e.length)throw new _r(Tr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+fi(e.length,"argument")+".")}function Xr(t,e,n){if(e.length!==n)throw new _r(Tr.INVALID_ARGUMENT,"Function "+t+"() requires "+fi(n,"argument")+", but was called with "+fi(e.length,"argument")+".")}function Yr(t,e,n){if(e.length<n)throw new _r(Tr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+fi(n,"argument")+", but was called with "+fi(e.length,"argument")+".")}function Jr(t,e,n,r){if(e.length<n||e.length>r)throw new _r(Tr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+fi(e.length,"argument")+".")}function Zr(t,e,n,r){ii(t,e,li(n)+" argument",r)}function $r(t,e,n,r){void 0!==r&&Zr(t,e,n,r)}function ti(t,e,n,r){ii(t,e,n+" option",r)}function ei(t,e,n,r){void 0!==r&&ti(t,e,n,r)}function ni(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(si(s))}var u=si(n);throw new _r(Tr.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function ri(t,e,n,r){if(!e.some(function(t){return t===r}))throw new _r(Tr.INVALID_ARGUMENT,"Invalid value "+si(r)+" provided to function "+t+"() for its "+li(n)+" argument. Acceptable values: "+e.join(", "));return r}function ii(t,e,n,r){if(!("object"===e?oi(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){r=si(r);throw new _r(Tr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}}function oi(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function si(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Lr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function ui(t,e,n){if(void 0===n)throw new _r(Tr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+li(e)+" argument, but it was undefined.")}function ai(n,t,r){Cr(t,function(t,e){if(r.indexOf(t)<0)throw new _r(Tr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function ci(t,e,n,r){r=si(r);return new _r(Tr.INVALID_ARGUMENT,"Function "+t+"() requires its "+li(n)+" argument to be a "+e+", but it was: "+r)}function hi(t,e,n){if(n<=0)throw new _r(Tr.INVALID_ARGUMENT,"Function "+t+"() requires its "+li(e)+" argument to be a positive number, but it was: "+n+".")}function li(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function fi(t,e){return t+" "+e+(1===t?"":"s")}var pi=(di.k=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},di);function di(){}function yi(t,e){return t<e?-1:e<t?1:0}function vi(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function gi(t){return t+"\0"}var mi=(wi.fromBase64String=function(t){return new wi(atob(t))},wi.fromUint8Array=function(t){return new wi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},wi.prototype.toBase64=function(){return t=this.M,btoa(t);var t},wi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.M)},wi.prototype.O=function(){return 2*this.M.length},wi.prototype.L=function(t){return yi(this.M,t.M)},wi.prototype.isEqual=function(t){return this.M===t.M},wi);function wi(t){this.M=t}mi.B=new mi("");var bi=(Ei.fromBase64String=function(t){try{return new Ei(mi.fromBase64String(t))}catch(t){throw new _r(Tr.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},Ei.fromUint8Array=function(t){return new Ei(mi.fromUint8Array(t))},Ei.prototype.toBase64=function(){return this.q.toBase64()},Ei.prototype.toUint8Array=function(){return this.q.toUint8Array()},Ei.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Ei.prototype.isEqual=function(t){return this.q.isEqual(t.q)},Ei);function Ei(t){this.q=t}function Ii(){if("undefined"==typeof Uint8Array)throw new _r(Tr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Ti(){if("undefined"==typeof atob)throw new _r(Tr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function _i(t,e,n,r,i){this.U=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var Ai,Ni=(n(Ui,Ai=bi),Ui.fromBase64String=function(t){Xr("Blob.fromBase64String",arguments,1),Zr("Blob.fromBase64String","string",1,t),Ti();try{return new Ui(mi.fromBase64String(t))}catch(t){throw new _r(Tr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Ui.fromUint8Array=function(t){if(Xr("Blob.fromUint8Array",arguments,1),Ii(),!(t instanceof Uint8Array))throw ci("Blob.fromUint8Array","Uint8Array",1,t);return new Ui(mi.fromUint8Array(t))},Ui.prototype.toBase64=function(){return Xr("Blob.toBase64",arguments,0),Ti(),Ai.prototype.toBase64.call(this)},Ui.prototype.toUint8Array=function(){return Xr("Blob.toUint8Array",arguments,0),Ii(),Ai.prototype.toUint8Array.call(this)},Ui.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Ui),Si=(Object.defineProperty(Pi.prototype,"W",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Pi.prototype.isEqual=function(t){return t instanceof Pi&&t.projectId===this.projectId&&t.database===this.database},Pi.prototype.L=function(t){return yi(this.projectId,t.projectId)||yi(this.database,t.database)},Pi),Di=(Li.prototype.get=function(t){var e=this.j(t),e=this.G[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.K(o,t))return i}},Li.prototype.has=function(t){return void 0!==this.get(t)},Li.prototype.set=function(t,e){var n=this.j(t),r=this.G[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.K(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.G[n]=[[t,e]]},Li.prototype.delete=function(t){var e=this.j(t),n=this.G[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.K(n[r][0],t))return 1===n.length?delete this.G[e]:n.splice(r,1),!0;return!1},Li.prototype.forEach=function(s){Cr(this.G,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},Li.prototype.m=function(){return Vr(this.G)},Li),Ri=(ki.now=function(){return ki.fromMillis(Date.now())},ki.fromDate=function(t){return ki.fromMillis(t.getTime())},ki.fromMillis=function(t){var e=Math.floor(t/1e3);return new ki(e,1e6*(t-1e3*e))},ki.prototype.toDate=function(){return new Date(this.toMillis())},ki.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},ki.prototype.H=function(t){return this.seconds===t.seconds?yi(this.nanoseconds,t.nanoseconds):yi(this.seconds,t.seconds)},ki.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},ki.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},ki.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},ki.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},ki),Oi=(xi.J=function(t){return new xi(t)},xi.min=function(){return new xi(new Ri(0,0))},xi.prototype.L=function(t){return this.timestamp.H(t.timestamp)},xi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},xi.prototype.Y=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},xi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},xi.prototype.X=function(){return this.timestamp},xi);function xi(t){this.timestamp=t}function ki(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new _r(Tr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new _r(Tr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new _r(Tr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new _r(Tr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Li(t,e){this.j=t,this.K=e,this.G={}}function Pi(t,e){this.projectId=t,this.database=e||"(default)"}function Ui(){return null!==Ai&&Ai.apply(this,arguments)||this}function Ci(t){return null==t}function Vi(t){return 0===t&&1/t==-1/0}function Mi(t){return"number"==typeof t&&Number.isInteger(t)&&!Vi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Fi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Z=null};function ji(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Fi(t,e,n,r,i,o,s)}function Gi(t){var e=t;return null===e.Z&&(t=e.path.R(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.R()+t.op.toString()+Go(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.R()+t.dir}).join(","),Ci(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Ea(e.startAt)),e.endAt&&(t+="|ub:",t+=Ea(e.endAt)),e.Z=t),e.Z}function qi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Vo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ta(t.startAt,e.startAt)&&Ta(t.endAt,e.endAt)}function Bi(t){return Br.F(t.path)&&null===t.collectionGroup&&0===t.filters.length}function zi(t){this.count=t}var Ki,Qi=(Hi.prototype.nt=function(t){return new Hi(this.target,this.targetId,this.tt,t,this.et,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Hi.prototype.st=function(t,e){return new Hi(this.target,this.targetId,this.tt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Hi.prototype.it=function(t){return new Hi(this.target,this.targetId,this.tt,this.sequenceNumber,this.et,t,this.resumeToken)},Hi);function Hi(t,e,n,r,i,o,s){void 0===i&&(i=Oi.min()),void 0===o&&(o=Oi.min()),void 0===s&&(s=mi.B),this.target=t,this.targetId=e,this.tt=n,this.sequenceNumber=r,this.et=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Wi(t){switch(t){case Tr.OK:return Lr(),0;case Tr.CANCELLED:case Tr.UNKNOWN:case Tr.DEADLINE_EXCEEDED:case Tr.RESOURCE_EXHAUSTED:case Tr.INTERNAL:case Tr.UNAVAILABLE:case Tr.UNAUTHENTICATED:return;case Tr.INVALID_ARGUMENT:case Tr.NOT_FOUND:case Tr.ALREADY_EXISTS:case Tr.PERMISSION_DENIED:case Tr.FAILED_PRECONDITION:case Tr.ABORTED:case Tr.OUT_OF_RANGE:case Tr.UNIMPLEMENTED:case Tr.DATA_LOSS:return 1;default:return Lr(),0}}function Xi(t){if(void 0===t)return Or("GRPC error has no .code"),Tr.UNKNOWN;switch(t){case Ki.OK:return Tr.OK;case Ki.CANCELLED:return Tr.CANCELLED;case Ki.UNKNOWN:return Tr.UNKNOWN;case Ki.DEADLINE_EXCEEDED:return Tr.DEADLINE_EXCEEDED;case Ki.RESOURCE_EXHAUSTED:return Tr.RESOURCE_EXHAUSTED;case Ki.INTERNAL:return Tr.INTERNAL;case Ki.UNAVAILABLE:return Tr.UNAVAILABLE;case Ki.UNAUTHENTICATED:return Tr.UNAUTHENTICATED;case Ki.INVALID_ARGUMENT:return Tr.INVALID_ARGUMENT;case Ki.NOT_FOUND:return Tr.NOT_FOUND;case Ki.ALREADY_EXISTS:return Tr.ALREADY_EXISTS;case Ki.PERMISSION_DENIED:return Tr.PERMISSION_DENIED;case Ki.FAILED_PRECONDITION:return Tr.FAILED_PRECONDITION;case Ki.ABORTED:return Tr.ABORTED;case Ki.OUT_OF_RANGE:return Tr.OUT_OF_RANGE;case Ki.UNIMPLEMENTED:return Tr.UNIMPLEMENTED;case Ki.DATA_LOSS:return Tr.DATA_LOSS;default:return Lr()}}(Ee=Ki=Ki||{})[Ee.OK=0]="OK",Ee[Ee.CANCELLED=1]="CANCELLED",Ee[Ee.UNKNOWN=2]="UNKNOWN",Ee[Ee.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ee[Ee.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ee[Ee.NOT_FOUND=5]="NOT_FOUND",Ee[Ee.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ee[Ee.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ee[Ee.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ee[Ee.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ee[Ee.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ee[Ee.ABORTED=10]="ABORTED",Ee[Ee.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ee[Ee.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ee[Ee.INTERNAL=13]="INTERNAL",Ee[Ee.UNAVAILABLE=14]="UNAVAILABLE",Ee[Ee.DATA_LOSS=15]="DATA_LOSS";var Yi=(eo.prototype.rt=function(t,e){return new eo(this.i,this.root.rt(t,e,this.i).copy(null,null,Zi.ot,null,null))},eo.prototype.remove=function(t){return new eo(this.i,this.root.remove(t,this.i).copy(null,null,Zi.ot,null,null))},eo.prototype.get=function(t){for(var e=this.root;!e.m();){var n=this.i(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},eo.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.m();){var r=this.i(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},eo.prototype.m=function(){return this.root.m()},Object.defineProperty(eo.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),eo.prototype.at=function(){return this.root.at()},eo.prototype.ut=function(){return this.root.ut()},eo.prototype.ct=function(t){return this.root.ct(t)},eo.prototype.forEach=function(n){this.ct(function(t,e){return n(t,e),!1})},eo.prototype.toString=function(){var n=[];return this.ct(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},eo.prototype.ht=function(t){return this.root.ht(t)},eo.prototype.lt=function(){return new Ji(this.root,null,this.i,!1)},eo.prototype._t=function(t){return new Ji(this.root,t,this.i,!1)},eo.prototype.ft=function(){return new Ji(this.root,null,this.i,!0)},eo.prototype.dt=function(t){return new Ji(this.root,t,this.i,!0)},eo),Ji=(to.prototype.Et=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.m();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.m();)this.Tt.push(t),t=t.left;return e},to.prototype.It=function(){return 0<this.Tt.length},to.prototype.At=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},to),Zi=($i.prototype.copy=function(t,e,n,r,i){return new $i(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},$i.prototype.m=function(){return!1},$i.prototype.ct=function(t){return this.left.ct(t)||t(this.key,this.value)||this.right.ct(t)},$i.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},$i.prototype.min=function(){return this.left.m()?this:this.left.min()},$i.prototype.at=function(){return this.min().key},$i.prototype.ut=function(){return this.right.m()?this.key:this.right.ut()},$i.prototype.rt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.rt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.rt(t,e,n))).Rt()},$i.prototype.Pt=function(){if(this.left.m())return $i.EMPTY;var t=this;return t.left.yt()||t.left.left.yt()||(t=t.gt()),(t=t.copy(null,null,null,t.left.Pt(),null)).Rt()},$i.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.m()||r.left.yt()||r.left.left.yt()||(r=r.gt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.yt()&&(r=r.Vt()),r.right.m()||r.right.yt()||r.right.left.yt()||(r=r.bt()),0===e(t,r.key)){if(r.right.m())return $i.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Pt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Rt()},$i.prototype.yt=function(){return this.color},$i.prototype.Rt=function(){var t=this;return t.right.yt()&&!t.left.yt()&&(t=t.vt()),t.left.yt()&&t.left.left.yt()&&(t=t.Vt()),t.left.yt()&&t.right.yt()&&(t=t.St()),t},$i.prototype.gt=function(){var t=this.St();return t.right.left.yt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Vt())).vt()).St()),t},$i.prototype.bt=function(){var t=this.St();return t.left.left.yt()&&(t=(t=t.Vt()).St()),t},$i.prototype.vt=function(){var t=this.copy(null,null,$i.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},$i.prototype.Vt=function(){var t=this.copy(null,null,$i.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},$i.prototype.St=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},$i.prototype.Dt=function(){var t=this.Ct();return Math.pow(2,t)<=this.size+1},$i.prototype.Ct=function(){if(this.yt()&&this.left.yt())throw Lr();if(this.right.yt())throw Lr();var t=this.left.Ct();if(t!==this.right.Ct())throw Lr();return t+(this.yt()?0:1)},$i);function $i(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:$i.RED,this.left=null!=r?r:$i.EMPTY,this.right=null!=i?i:$i.EMPTY,this.size=this.left.size+1+this.right.size}function to(t,e,n,r){this.wt=r,this.Tt=[];for(var i=1;!t.m();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.wt?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.wt?t.right:t.left}}function eo(t,e){this.i=t,this.root=e||Zi.EMPTY}function no(){this.size=0}Zi.EMPTY=null,Zi.RED=!0,Zi.ot=!1,Zi.EMPTY=(Object.defineProperty(no.prototype,"key",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(no.prototype,"value",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(no.prototype,"color",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(no.prototype,"left",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(no.prototype,"right",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),no.prototype.copy=function(t,e,n,r,i){return this},no.prototype.rt=function(t,e,n){return new Zi(t,e)},no.prototype.remove=function(t,e){return this},no.prototype.m=function(){return!0},no.prototype.ct=function(t){return!1},no.prototype.ht=function(t){return!1},no.prototype.at=function(){return null},no.prototype.ut=function(){return null},no.prototype.yt=function(){return!1},no.prototype.Dt=function(){return!0},no.prototype.Ct=function(){return 0},new no);var ro=(uo.prototype.has=function(t){return null!==this.data.get(t)},uo.prototype.first=function(){return this.data.at()},uo.prototype.last=function(){return this.data.ut()},Object.defineProperty(uo.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),uo.prototype.indexOf=function(t){return this.data.indexOf(t)},uo.prototype.forEach=function(n){this.data.ct(function(t,e){return n(t),!1})},uo.prototype.Nt=function(t,e){for(var n=this.data._t(t[0]);n.It();){var r=n.Et();if(0<=this.i(r.key,t[1]))return;e(r.key)}},uo.prototype.Ft=function(t,e){for(var n=void 0!==e?this.data._t(e):this.data.lt();n.It();)if(!t(n.Et().key))return},uo.prototype.$t=function(t){t=this.data._t(t);return t.It()?t.Et().key:null},uo.prototype.lt=function(){return new io(this.data.lt())},uo.prototype._t=function(t){return new io(this.data._t(t))},uo.prototype.add=function(t){return this.copy(this.data.remove(t).rt(t,!0))},uo.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},uo.prototype.m=function(){return this.data.m()},uo.prototype.xt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},uo.prototype.isEqual=function(t){if(!(t instanceof uo))return!1;if(this.size!==t.size)return!1;for(var e=this.data.lt(),n=t.data.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(0!==this.i(r,i))return!1}return!0},uo.prototype.A=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},uo.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},uo.prototype.copy=function(t){var e=new uo(this.i);return e.data=t,e},uo),io=(so.prototype.Et=function(){return this.kt.Et().key},so.prototype.It=function(){return this.kt.It()},so),oo=new Yi(Br.i);function so(t){this.kt=t}function uo(t){this.i=t,this.data=new Yi(this.i)}var ao=new Yi(Br.i);var co=new Yi(Br.i);var ho=new ro(Br.i);function lo(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=ho,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var fo=new ro(yi);var po=(Oo.Lt=function(t){return new Oo(t.i)},Oo.prototype.has=function(t){return null!=this.Mt.get(t)},Oo.prototype.get=function(t){return this.Mt.get(t)},Oo.prototype.first=function(){return this.Ot.at()},Oo.prototype.last=function(){return this.Ot.ut()},Oo.prototype.m=function(){return this.Ot.m()},Oo.prototype.indexOf=function(t){t=this.Mt.get(t);return t?this.Ot.indexOf(t):-1},Object.defineProperty(Oo.prototype,"size",{get:function(){return this.Ot.size},enumerable:!1,configurable:!0}),Oo.prototype.forEach=function(n){this.Ot.ct(function(t,e){return n(t),!1})},Oo.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Mt.rt(t.key,t),e.Ot.rt(t,null))},Oo.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Mt.remove(t),this.Ot.remove(e)):this},Oo.prototype.isEqual=function(t){if(!(t instanceof Oo))return!1;if(this.size!==t.size)return!1;for(var e=this.Ot.lt(),n=t.Ot.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(!r.isEqual(i))return!1}return!0},Oo.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Oo.prototype.copy=function(t,e){var n=new Oo;return n.i=this.i,n.Mt=t,n.Ot=e,n},Oo),yo=(Ro.prototype.track=function(t){var e=t.doc.key,n=this.Bt.get(e);!n||0!==t.type&&3===n.type?this.Bt=this.Bt.rt(e,t):3===t.type&&1!==n.type?this.Bt=this.Bt.rt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Bt=this.Bt.rt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Bt=this.Bt.remove(e):1===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):Lr()},Ro.prototype.qt=function(){var n=[];return this.Bt.ct(function(t,e){n.push(e)}),n},Ro),vo=(Do.Kt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Do(t,e,po.Lt(e),i,n,r,!0,!1)},Object.defineProperty(Do.prototype,"hasPendingWrites",{get:function(){return!this.Qt.m()},enumerable:!1,configurable:!0}),Do.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Wt===t.Wt&&this.Qt.isEqual(t.Qt)&&zu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ut.isEqual(t.Ut)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Do),go=(So.Yt=function(t,e){var n=new Map;return n.set(t,mo.Xt(t,e)),new So(Oi.min(),n,fo,oo,lo())},So),mo=(No.Xt=function(t,e){return new No(mi.B,e,lo(),lo(),lo())},No),wo=function(t,e,n,r){this.se=t,this.removedTargetIds=e,this.key=n,this.ie=r},bo=function(t,e){this.targetId=t,this.re=e},Eo=function(t,e,n,r){void 0===n&&(n=mi.B),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Io=(Object.defineProperty(Ao.prototype,"Zt",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(Ao.prototype,"resumeToken",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(Ao.prototype,"le",{get:function(){return 0!==this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(Ao.prototype,"_e",{get:function(){return this.he},enumerable:!1,configurable:!0}),Ao.prototype.fe=function(t){0<t.O()&&(this.he=!0,this.ue=t)},Ao.prototype.de=function(){var n=lo(),r=lo(),i=lo();return this.ae.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Lr()}}),new mo(this.ue,this.ce,n,r,i)},Ao.prototype.we=function(){this.he=!1,this.ae=ko()},Ao.prototype.me=function(t,e){this.he=!0,this.ae=this.ae.rt(t,e)},Ao.prototype.Te=function(t){this.he=!0,this.ae=this.ae.remove(t)},Ao.prototype.Ee=function(){this.oe+=1},Ao.prototype.Ie=function(){--this.oe},Ao.prototype.Ae=function(){this.he=!0,this.ce=!0},Ao),To=(_o.prototype.pe=function(t){for(var e=0,n=t.se;e<n.length;e++){var r=n[e];t.ie instanceof Au?this.be(r,t.ie):t.ie instanceof Nu&&this.ve(r,t.key,t.ie)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.ve(s,t.key,t.ie)}},_o.prototype.Se=function(n){var r=this;this.De(n,function(t){var e=r.Ce(t);switch(n.state){case 0:r.Ne(t)&&e.fe(n.resumeToken);break;case 1:e.Ie(),e.le||e.we(),e.fe(n.resumeToken);break;case 2:e.Ie(),e.le||r.removeTarget(t);break;case 3:r.Ne(t)&&(e.Ae(),e.fe(n.resumeToken));break;case 4:r.Ne(t)&&(r.Fe(t),e.fe(n.resumeToken));break;default:Lr()}})},_o.prototype.De=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Pe.forEach(function(t,e){r.Ne(e)&&n(e)})},_o.prototype.$e=function(t){var e=t.targetId,n=t.re.count,t=this.xe(e);t&&(Bi(t=t.target)?0===n?(t=new Br(t.path),this.ve(e,t,new Nu(t,Oi.min()))):Pr(1===n):this.ke(e)!==n&&(this.Fe(e),this.Ve=this.Ve.add(e)))},_o.prototype.Me=function(r){var i=this,o=new Map;this.Pe.forEach(function(t,e){var n=i.xe(e);n&&(t.Zt&&Bi(n.target)&&(n=new Br(n.target.path),null!==i.ye.get(n)||i.Oe(e,n)||i.ve(e,n,new Nu(n,r))),t._e&&(o.set(e,t.de()),t.we()))});var s=lo();this.ge.forEach(function(t,e){var n=!0;e.Ft(function(t){t=i.xe(t);return!t||2===t.tt||(n=!1)}),n&&(s=s.add(t))});var t=new go(r,o,this.Ve,this.ye,s);return this.ye=oo,this.ge=xo(),this.Ve=new ro(yi),t},_o.prototype.be=function(t,e){var n;this.Ne(t)&&(n=this.Oe(t,e.key)?2:0,this.Ce(t).me(e.key,n),this.ye=this.ye.rt(e.key,e),this.ge=this.ge.rt(e.key,this.Le(e.key).add(t)))},_o.prototype.ve=function(t,e,n){var r;this.Ne(t)&&(r=this.Ce(t),this.Oe(t,e)?r.me(e,1):r.Te(e),this.ge=this.ge.rt(e,this.Le(e).delete(t)),n&&(this.ye=this.ye.rt(e,n)))},_o.prototype.removeTarget=function(t){this.Pe.delete(t)},_o.prototype.ke=function(t){var e=this.Ce(t).de();return this.Re.Be(t).size+e.te.size-e.ne.size},_o.prototype.Ee=function(t){this.Ce(t).Ee()},_o.prototype.Ce=function(t){var e=this.Pe.get(t);return e||(e=new Io,this.Pe.set(t,e)),e},_o.prototype.Le=function(t){var e=this.ge.get(t);return e||(e=new ro(yi),this.ge=this.ge.rt(t,e)),e},_o.prototype.Ne=function(t){var e=null!==this.xe(t);return e||Rr("WatchChangeAggregator","Detected inactive target",t),e},_o.prototype.xe=function(t){var e=this.Pe.get(t);return e&&e.le?null:this.Re.qe(t)},_o.prototype.Fe=function(e){var n=this;this.Pe.set(e,new Io),this.Re.Be(e).forEach(function(t){n.ve(e,t,null)})},_o.prototype.Oe=function(t,e){return this.Re.Be(t).has(e)},_o);function _o(t){this.Re=t,this.Pe=new Map,this.ye=oo,this.ge=xo(),this.Ve=new ro(yi)}function Ao(){this.oe=0,this.ae=ko(),this.ue=mi.B,this.ce=!1,this.he=!0}function No(t,e,n,r,i){this.resumeToken=t,this.Zt=e,this.te=n,this.ee=r,this.ne=i}function So(t,e,n,r,i){this.et=t,this.Gt=e,this.zt=n,this.Ht=r,this.Jt=i}function Do(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Ut=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.Wt=s,this.jt=u}function Ro(){this.Bt=new Yi(Br.i)}function Oo(n){this.i=n?function(t,e){return n(t,e)||Br.i(t.key,e.key)}:function(t,e){return Br.i(t.key,e.key)},this.Mt=ao,this.Ot=new Yi(this.i)}function xo(){return new Yi(Br.i)}function ko(){return new Yi(Br.i)}function Lo(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Po(t){t=qo(t.mapValue.fields.__local_write_time__.timestampValue);return new Ri(t.seconds,t.nanos)}var Uo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Co(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Lo(t)?4:10:Lr()}function Vo(r,i){var t,e=Co(r);if(e!==Co(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return Po(r).isEqual(Po(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=qo(r.timestampValue),t=qo(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,zo(r.bytesValue).isEqual(zo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Bo((t=r).geoPointValue.latitude)===Bo(e.geoPointValue.latitude)&&Bo(t.geoPointValue.longitude)===Bo(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Bo(t.integerValue)===Bo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=Bo(t.doubleValue),e=Bo(e.doubleValue);return t===e?Vi(t)===Vi(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return vi(r.arrayValue.values||[],i.arrayValue.values||[],Vo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Ur(e)!==Ur(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Vo(e[t],n[t])))return!1;return!0}();default:return Lr()}}function Mo(t,e){return void 0!==(t.values||[]).find(function(t){return Vo(t,e)})}function Fo(t,e){var n,r,i=Co(t),o=Co(e);if(i!==o)return yi(i,o);switch(i){case 0:return 0;case 1:return yi(t.booleanValue,e.booleanValue);case 2:return n=e,r=Bo(t.integerValue||t.doubleValue),n=Bo(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return jo(t.timestampValue,e.timestampValue);case 4:return jo(Po(t),Po(e));case 5:return yi(t.stringValue,e.stringValue);case 6:return function(t,e){t=zo(t),e=zo(e);return t.L(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=yi(n[i],r[i]);if(0!==o)return o}return yi(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=yi(Bo(i.latitude),Bo(r.latitude)))?n:yi(Bo(i.longitude),Bo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Fo(n[i],r[i]);if(o)return o}return yi(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=yi(r[s],o[s]);if(0!==u)return u;u=Fo(n[r[s]],i[o[s]]);if(0!==u)return u}return yi(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Lr()}}function jo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return yi(t,e);var n=qo(t),t=qo(e),e=yi(n.seconds,t.seconds);return 0!==e?e:yi(n.nanos,t.nanos)}function Go(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=qo(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?zo(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,Br.C(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):Lr();var e}(t)}function qo(t){if(Pr(!!t),"string"!=typeof t)return{seconds:Bo(t.seconds),nanos:Bo(t.nanos)};var e=0,n=Uo.exec(t);Pr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Bo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function zo(t){return"string"==typeof t?mi.fromBase64String(t):mi.fromUint8Array(t)}function Ko(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.R()}}function Qo(t){return t&&"integerValue"in t}function Ho(t){return!!t&&"arrayValue"in t}function Wo(t){return t&&"nullValue"in t}function Xo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Yo(t){return t&&"mapValue"in t}var Jo={asc:"ASCENDING",desc:"DESCENDING"},Zo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},$o=function(t,e){this.U=t,this.Ue=e};function ts(t){return{integerValue:""+t}}function es(t,e){if(t.Ue){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Vi(e)?"-0":e}}function ns(t,e){return Mi(e)?ts(e):es(t,e)}function rs(t,e){return t.Ue?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function is(t,e){return t.Ue?e.toBase64():e.toUint8Array()}function os(t){return Pr(!!t),Oi.J((t=qo(t),new Ri(t.seconds,t.nanos)))}function ss(t,e){return new jr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).R()}function us(t){t=jr.P(t);return Pr(Ns(t)),t}function as(t,e){return ss(t.U,e.path)}function cs(t,e){e=us(e);return Pr(e.get(1)===t.U.projectId),Pr(!e.get(3)&&!t.U.database||e.get(3)===t.U.database),new Br(ps(e))}function hs(t,e){return ss(t.U,e)}function ls(t){t=us(t);return 4===t.length?jr.g():ps(t)}function fs(t){return new jr(["projects",t.U.projectId,"databases",t.U.database]).R()}function ps(t){return Pr(4<t.length&&"documents"===t.get(4)),t.u(5)}function ds(t,e,n){return{name:as(t,e),fields:n.proto.mapValue.fields}}function ys(t,e,n){var r=cs(t,e.name),t=os(e.updateTime),e=new vu({mapValue:{fields:e.fields}});return new Au(r,t,e,{hasCommittedMutations:!!n})}function vs(t,e){var n,r,i;if(e instanceof ru)n={update:ds(t,e.key,e.value)};else if(e instanceof du)n={delete:as(t,e.key)};else if(e instanceof iu)n={update:ds(t,e.key,e.data),updateMask:(i=e.Qe,r=[],i.fields.forEach(function(t){return r.push(t.R())}),{fieldPaths:r})};else if(e instanceof cu)n={transform:{document:as(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Os)return{fieldPath:t.field.R(),setToServerValue:"REQUEST_TIME"};if(e instanceof xs)return{fieldPath:t.field.R(),appendMissingElements:{values:e.elements}};if(e instanceof Cs)return{fieldPath:t.field.R(),removeAllFromArray:{values:e.elements}};if(e instanceof js)return{fieldPath:t.field.R(),increment:e.We};throw Lr()})}};else{if(!(e instanceof yu))return Lr();n={verify:as(t,e.key)}}return e.Ke.je||(n.currentDocument=void 0!==(i=e.Ke).updateTime?{updateTime:(e=t,t=i.updateTime,rs(e,t.X()))}:void 0!==i.exists?{exists:i.exists}:Lr()),n}function gs(e,t){var n=t.currentDocument?void 0!==(o=t.currentDocument).updateTime?Ws.updateTime(os(o.updateTime)):void 0!==o.exists?Ws.exists(o.exists):Ws.Ge():Ws.Ge();if(t.update){t.update.name;var r=cs(e,t.update.name),i=new vu({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=(o=t.updateMask.fieldPaths||[],new zs(o.map(function(t){return qr.S(t)})));return new iu(r,i,o,n)}return new ru(r,i,n)}if(t.delete){var s=cs(e,t.delete);return new du(s,n)}if(t.transform){i=cs(e,t.transform.document),s=t.transform.fieldTransforms.map(function(t){return function(t,e){var n,r=null;"setToServerValue"in e?(Pr("REQUEST_TIME"===e.setToServerValue),r=new Os):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],r=new xs(n)):"removeAllFromArray"in e?(n=e.removeAllFromArray.values||[],r=new Cs(n)):"increment"in e?r=new js(t,e.increment):Lr();e=qr.S(e.fieldPath);return new Ks(e,r)}(e,t)});return Pr(!0===n.exists),new cu(i,s)}if(t.verify){t=cs(e,t.verify);return new yu(t,n)}return Lr()}function ms(t,e){return{documents:[hs(t,e.path)]}}function ws(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=hs(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=hs(t,r.h()),n.structuredQuery.from=[{collectionId:r._()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(Xo(t.value))return{unaryFilter:{field:Ts(t.field),op:"IS_NAN"}};if(Wo(t.value))return{unaryFilter:{field:Ts(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Xo(t.value))return{unaryFilter:{field:Ts(t.field),op:"IS_NOT_NAN"}};if(Wo(t.value))return{unaryFilter:{field:Ts(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ts(t.field),op:(e=t.op,Zo[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:Ts((t=t).field),direction:(t=t.dir,Jo[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.Ue||Ci(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=Es(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Es(e.endAt)),n}function bs(t){var e=ls(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(Pr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[As(t)]:void 0!==t.fieldFilter?[(n=t,Yu.create(_s(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Lr()}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):Lr():[];var n}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new _a(_s((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=Ci(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=Is(n.startAt));var u=null;return n.endAt&&(u=Is(n.endAt)),ku(e,i,t,o,r,"F",s,u)}function Es(t){return{before:t.before,values:t.position}}function Is(t){var e=!!t.before,t=t.values||[];return new va(t,e)}function Ts(t){return{fieldPath:t.R()}}function _s(t){return qr.S(t.fieldPath)}function As(t){switch(t.unaryFilter.op){case"IS_NAN":var e=_s(t.unaryFilter.field);return Yu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=_s(t.unaryFilter.field);return Yu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":n=_s(t.unaryFilter.field);return Yu.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":t=_s(t.unaryFilter.field);return Yu.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Lr()}}function Ns(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}h=function(){this.ze=void 0};function Ss(t,e){return t instanceof js?Qo(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var Ds,Rs,Os=(n(Ls,Rs=h),Ls),xs=(n(ks,Ds=h),ks);function ks(t){var e=this;return(e=Ds.call(this)||this).elements=t,e}function Ls(){return null!==Rs&&Rs.apply(this,arguments)||this}function Ps(t,e){for(var n=Bs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Vo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var Us,Cs=(n(Vs,Us=h),Vs);function Vs(t){var e=this;return(e=Us.call(this)||this).elements=t,e}function Ms(t,e){for(var n=Bs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Vo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var Fs,js=(n(Gs,Fs=h),Gs);function Gs(t,e){var n=this;return(n=Fs.call(this)||this).serializer=t,n.We=e,n}function qs(t){return Bo(t.integerValue||t.doubleValue)}function Bs(t){return Ho(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var zs=(Qs.prototype.He=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].T(t))return!0;return!1},Qs.prototype.isEqual=function(t){return vi(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Qs),Ks=function(t,e){this.field=t,this.transform=e};function Qs(t){(this.fields=t).sort(qr.i)}function Hs(t,e){this.version=t,this.transformResults=e}var Ws=(Xs.Ge=function(){return new Xs},Xs.exists=function(t){return new Xs(void 0,t)},Xs.updateTime=function(t){return new Xs(t)},Object.defineProperty(Xs.prototype,"je",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Xs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Xs);function Xs(t,e){this.updateTime=t,this.exists=e}function Ys(t,e){return void 0!==t.updateTime?e instanceof Au&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Au}Ie=function(){};function Js(t,e,n){return t instanceof ru?new Au(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof iu?function(t,e,n){if(!Ys(t.Ke,e))return new Su(t.key,n.version);e=uu(t,e);return new Au(t.key,n.version,e,{hasCommittedMutations:!0})}(t,e,n):t instanceof cu?function(t,e,n){if(Pr(null!=n.transformResults),!Ys(t.Ke,e))return new Su(t.key,n.version);var r=e,e=function(t,e,n){var r=[];Pr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Au&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof xs?Ps(o,s):o instanceof Cs?Ms(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=lu(t,r.data(),e);return new Au(t.key,n,e,{hasCommittedMutations:!0})}(t,e,n):new Nu(t.key,n.version,{hasCommittedMutations:!0})}function Zs(t,e,n,r){return t instanceof ru?function(t,e){if(!Ys(t.Ke,e))return e;e=tu(e);return new Au(t.key,e,t.value,{Je:!0})}(t,e):t instanceof iu?function(t,e){if(!Ys(t.Ke,e))return e;var n=tu(e),e=uu(t,e);return new Au(t.key,n,e,{Je:!0})}(t,e):t instanceof cu?function(t,e,n,r){if(!Ys(t.Ke,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof Au&&(h=n.field(a.field)),null===h&&r instanceof Au&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,(c=c)instanceof Os?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof xs?Ps(c,i):c instanceof Cs?Ms(c,i):(c=Ss(h=c,i),i=qs(c)+qs(h.We),Qo(c)&&Qo(h.We)?ts(i):es(h.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=lu(t,i.data(),r);return new Au(t.key,i.version,r,{Je:!0})}(t,e,r,n):(e=e,Ys((t=t).Ke,e)?new Nu(t.key,Oi.min()):e)}function $s(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ke.isEqual(e.Ke)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||vi(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof xs&&e instanceof xs||t instanceof Cs&&e instanceof Cs?vi(t.elements,e.elements,Vo):t instanceof js&&e instanceof js?Vo(t.We,e.We):t instanceof Os&&e instanceof Os)}))}function tu(t){return t instanceof Au?t.version:Oi.min()}var eu,nu,ru=(n(su,nu=Ie),su),iu=(n(ou,eu=Ie),ou);function ou(t,e,n,r){var i=this;return(i=eu.call(this)||this).key=t,i.data=e,i.Qe=n,i.Ke=r,i.type=1,i}function su(t,e,n){var r=this;return(r=nu.call(this)||this).key=t,r.value=e,r.Ke=n,r.type=0,r}function uu(t,e){return n=t,e=e instanceof Au?e.data():vu.empty(),r=new gu(e),n.Qe.fields.forEach(function(t){var e;t.m()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Ye();var n,r}var au,cu=(n(hu,au=Ie),hu);function hu(t,e){var n=this;return(n=au.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ke=Ws.exists(!0),n}function lu(t,e,n){for(var r=new gu(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Ye()}var fu,pu,du=(n(Eu,pu=Ie),Eu),yu=(n(bu,fu=Ie),bu),vu=(wu.empty=function(){return new wu({mapValue:{}})},wu.prototype.field=function(t){if(t.m())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Yo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t._()])||null},wu.prototype.isEqual=function(t){return Vo(this.proto,t.proto)},wu),gu=(mu.prototype.set=function(t,e){return this.tn(t,e),this},mu.prototype.delete=function(t){return this.tn(t,null),this},mu.prototype.tn=function(t,e){for(var n=this.Ze,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===Co(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t._(),e)},mu.prototype.Ye=function(){var t=this.en(qr.g(),this.Ze);return null!=t?new vu(t):this.Xe},mu.prototype.en=function(r,t){var i=this,o=!1,e=this.Xe.field(r),s=Yo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.en(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},mu);function mu(t){void 0===t&&(t=vu.empty()),this.Xe=t,this.Ze=new Map}function wu(t){this.proto=t}function bu(t,e){var n=this;return(n=fu.call(this)||this).key=t,n.Ke=e,n.type=4,n}function Eu(t,e){var n=this;return(n=pu.call(this)||this).key=t,n.Ke=e,n.type=3,n}var Iu,Tu,_u,Ee=function(t,e){this.key=t,this.version=e},Au=(n(xu,_u=Ee),xu.prototype.field=function(t){return this.nn.field(t)},xu.prototype.data=function(){return this.nn},xu.prototype.sn=function(){return this.nn.proto},xu.prototype.isEqual=function(t){return t instanceof xu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Je===t.Je&&this.hasCommittedMutations===t.hasCommittedMutations&&this.nn.isEqual(t.nn)},xu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.nn.toString()+", {hasLocalMutations: "+this.Je+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(xu.prototype,"hasPendingWrites",{get:function(){return this.Je||this.hasCommittedMutations},enumerable:!1,configurable:!0}),xu),Nu=(n(Ou,Tu=Ee),Ou.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Ou.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Ou.prototype.isEqual=function(t){return t instanceof Ou&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Ou),Su=(n(Ru,Iu=Ee),Ru.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Ru.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Ru.prototype.isEqual=function(t){return t instanceof Ru&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Ru),Du=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.rn=n,this.filters=r,this.limit=i,this.on=o,this.startAt=s,this.endAt=u,this.an=null,this.un=null,this.startAt,this.endAt};function Ru(){return null!==Iu&&Iu.apply(this,arguments)||this}function Ou(t,e,n){var r=this;return(r=Tu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function xu(t,e,n,r){var i=this;return(i=_u.call(this,t,e)||this).nn=n,i.Je=!!r.Je,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function ku(t,e,n,r,i,o,s,u){return new Du(t,e,n,r,i,o,s,u)}function Lu(t){return new Du(t)}function Pu(t){return!Ci(t.limit)&&"F"===t.on}function Uu(t){return!Ci(t.limit)&&"L"===t.on}function Cu(t){return 0<t.rn.length?t.rn[0].field:null}function Vu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.cn())return r.field}return null}function Mu(t){return null!==t.collectionGroup}function Fu(t){var e=t;if(null===e.an){e.an=[];var n=Vu(e),t=Cu(e);if(null!==n&&null===t)n.p()||e.an.push(new _a(n)),e.an.push(new _a(qr.v(),"asc"));else{for(var r=!1,i=0,o=e.rn;i<o.length;i++){var s=o[i];e.an.push(s),s.field.p()&&(r=!0)}r||(n=0<e.rn.length?e.rn[e.rn.length-1].dir:"asc",e.an.push(new _a(qr.v(),n)))}}return e.an}function ju(t){var e=t;if(!e.un)if("F"===e.on)e.un=ji(e.path,e.collectionGroup,Fu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Fu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new _a(o.field,s))}var u=e.endAt?new va(e.endAt.position,!e.endAt.before):null,t=e.startAt?new va(e.startAt.position,!e.startAt.before):null;e.un=ji(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.un}function Gu(t,e,n){return new Du(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function qu(t,e){return new Du(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,e,t.endAt)}function Bu(t,e){return new Du(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,t.startAt,e)}function zu(t,e){return qi(ju(t),ju(e))&&t.on===e.on}function Ku(t){return Gi(ju(t))+"|lt:"+t.on}function Qu(t){return"Query(target="+(e=ju(t),n=e.path.R(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.R()+" "+t.op+" "+Go(t.value)}).join(", ")+"]"),Ci(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.R()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Ea(e.startAt)),e.endAt&&(n+=", endAt: "+Ea(e.endAt)),"Target("+n+")")+"; limitType="+t.on+")";var e,n}function Hu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.N(e.collectionGroup)&&e.path.T(n):Br.F(e.path)?e.path.isEqual(n):e.path.I(n))&&function(t){for(var e=0,n=i.rn;e<n.length;e++){var r=n[e];if(!r.field.p()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||Ia(t.startAt,Fu(t),n))&&(!t.endAt||!Ia(t.endAt,Fu(t),n)));var e,n}function Wu(u){return function(t,e){for(var n=!1,r=0,i=Fu(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.p()?Br.i(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?Fo(n,t):Lr()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return Lr()}}(o,t,e);if(0!==s)return s;n=n||o.field.p()}return 0}}var Xu,Yu=(n(Ju,Xu=function(){}),Ju.create=function(t,e,n){if(t.p())return"in"===e||"not-in"===e?this.hn(t,e,n):new ea(t,e,n);if(Wo(n)){if("=="!==e&&"!="!==e)throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. Null only supports '==' and '!=' comparisons.");return new Ju(t,e,n)}if(Xo(n)){if("=="!==e&&"!="!==e)throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. NaN only supports '==' and '!=' comparisons.");return new Ju(t,e,n)}return"array-contains"===e?new fa(t,n):"in"===e?new pa(t,n):"not-in"===e?new da(t,n):"array-contains-any"===e?new ya(t,n):new Ju(t,e,n)},Ju.hn=function(t,e,n){return new("in"===e?na:ra)(t,n)},Ju.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this.ln(Fo(t,this.value)):null!==t&&Co(this.value)===Co(t)&&this.ln(Fo(t,this.value))},Ju.prototype.ln=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Lr()}},Ju.prototype.cn=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Ju);function Ju(t,e,n){var r=this;return(r=Xu.call(this)||this).field=t,r.op=e,r.value=n,r}var Zu,$u,ta,ea=(n(sa,ta=Yu),sa.prototype.matches=function(t){t=Br.i(t.key,this.key);return this.ln(t)},sa),na=(n(oa,$u=Yu),oa.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},oa),ra=(n(ia,Zu=Yu),ia.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},ia);function ia(t,e){var n=this;return(n=Zu.call(this,t,"not-in",e)||this).keys=ua(0,e),n}function oa(t,e){var n=this;return(n=$u.call(this,t,"in",e)||this).keys=ua(0,e),n}function sa(t,e,n){var r=this;return(r=ta.call(this,t,e,n)||this).key=Br.C(n.referenceValue),r}function ua(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return Br.C(t.referenceValue)})}var aa,ca,ha,la,fa=(n(ba,la=Yu),ba.prototype.matches=function(t){t=t.field(this.field);return Ho(t)&&Mo(t.arrayValue,this.value)},ba),pa=(n(wa,ha=Yu),wa.prototype.matches=function(t){t=t.field(this.field);return null!==t&&Mo(this.value.arrayValue,t)},wa),da=(n(ma,ca=Yu),ma.prototype.matches=function(t){if(Mo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!Mo(this.value.arrayValue,t)},ma),ya=(n(ga,aa=Yu),ga.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!Ho(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return Mo(e.value.arrayValue,t)})},ga),va=function(t,e){this.position=t,this.before=e};function ga(t,e){return aa.call(this,t,"array-contains-any",e)||this}function ma(t,e){return ca.call(this,t,"not-in",e)||this}function wa(t,e){return ha.call(this,t,"in",e)||this}function ba(t,e){return la.call(this,t,"array-contains",e)||this}function Ea(t){return(t.before?"b":"a")+":"+t.position.map(Go).join(",")}function Ia(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.p()?Br.i(Br.C(s.referenceValue),n.key):Fo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Ta(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Vo(t.position[n],e.position[n]))return!1;return!0}var _a=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Aa(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var Na,Sa=(Ca.prototype.reset=function(){this.Tn=0},Ca.prototype.An=function(){this.Tn=this.mn},Ca.prototype.Rn=function(t){var e=this;this.cancel();var n=Math.floor(this.Tn+this.Pn()),r=Math.max(0,Date.now()-this.In),i=Math.max(0,n-r);0<i&&Rr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Tn+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.En=this._n.yn(this.fn,i,function(){return e.In=Date.now(),t()}),this.Tn*=this.wn,this.Tn<this.dn&&(this.Tn=this.dn),this.Tn>this.mn&&(this.Tn=this.mn)},Ca.prototype.gn=function(){null!==this.En&&(this.En.Vn(),this.En=null)},Ca.prototype.cancel=function(){null!==this.En&&(this.En.cancel(),this.En=null)},Ca.prototype.Pn=function(){return(Math.random()-.5)*this.Tn},Ca),Da=(Ua.prototype.catch=function(t){return this.next(void 0,t)},Ua.prototype.next=function(r,i){var o=this;return this.Sn&&Lr(),this.Sn=!0,this.vn?this.error?this.Dn(i,this.error):this.Cn(r,this.result):new Ua(function(e,n){o.pn=function(t){o.Cn(r,t).next(e,n)},o.bn=function(t){o.Dn(i,t).next(e,n)}})},Ua.prototype.Nn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Ua.prototype.Fn=function(t){try{var e=t();return e instanceof Ua?e:Ua.resolve(e)}catch(t){return Ua.reject(t)}},Ua.prototype.Cn=function(t,e){return t?this.Fn(function(){return t(e)}):Ua.resolve(e)},Ua.prototype.Dn=function(t,e){return t?this.Fn(function(){return t(e)}):Ua.reject(e)},Ua.resolve=function(n){return new Ua(function(t,e){t(n)})},Ua.reject=function(n){return new Ua(function(t,e){e(n)})},Ua.$n=function(t){return new Ua(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Ua.xn=function(t){for(var n=Ua.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Ua.resolve(t):e()})}(r[e]);return n},Ua.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.$n(i)},Ua),Ra=(Pa.delete=function(t){return Rr("SimpleDb","Removing database:",t),qa(window.indexedDB.deleteDatabase(t)).Nn()},Pa.On=function(){if("undefined"==typeof indexedDB)return!1;if(Pa.Ln())return!0;var t=p(),e=Pa.Mn(t),n=0<e&&e<10,e=Pa.Bn(t),e=0<e&&e<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||e)},Pa.Ln=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.qn)},Pa.Un=function(t,e){return t.store(e)},Pa.Mn=function(t){t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),t=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(t)},Pa.Bn=function(t){t=t.match(/Android ([\d.]+)/i),t=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(t)},Pa.prototype.Qn=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Rr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result;e(t)},r.onblocked=function(){n(new xa(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){t=t.target.error;"VersionError"===t.name?n(new _r(Tr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new xa(o,t))},r.onupgradeneeded=function(t){Rr("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.kn.createOrUpgrade(e,r.transaction,t.oldVersion,i.version).next(function(){Rr("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.Wn&&(this.db.onversionchange=function(t){return i.Wn(t)}),this.db)]}})})},Pa.prototype.jn=function(e){this.Wn=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},Pa.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.Qn(u)];case 2:return s.db=t.sent(),e=Ma.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),Da.reject(t)}).Nn(),r={},n.catch(function(){}),[4,e.Kn];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,Rr("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},Pa.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},Pa),Oa=(Object.defineProperty(La.prototype,"vn",{get:function(){return this.zn},enumerable:!1,configurable:!0}),Object.defineProperty(La.prototype,"Jn",{get:function(){return this.Hn},enumerable:!1,configurable:!0}),Object.defineProperty(La.prototype,"cursor",{set:function(t){this.Gn=t},enumerable:!1,configurable:!0}),La.prototype.done=function(){this.zn=!0},La.prototype.Yn=function(t){this.Hn=t},La.prototype.delete=function(){return qa(this.Gn.delete())},La),xa=(n(ka,Na=_r),ka);function ka(t,e){var n=this;return(n=Na.call(this,Tr.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function La(t){this.Gn=t,this.zn=!1,this.Hn=null}function Pa(t,e,n){this.name=t,this.version=e,this.kn=n,12.2===Pa.Mn(p())&&Or("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function Ua(t){var e=this;this.pn=null,this.bn=null,this.result=void 0,this.error=void 0,this.vn=!1,this.Sn=!1,t(function(t){e.vn=!0,e.result=t,e.pn&&e.pn(t)},function(t){e.vn=!0,e.error=t,e.bn&&e.bn(t)})}function Ca(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this._n=t,this.fn=e,this.dn=n,this.wn=r,this.mn=i,this.Tn=0,this.En=null,this.In=Date.now(),this.reset()}function Va(t){return"IndexedDbTransactionError"===t.name}var Ma=(Ga.open=function(t,e,n,r){try{return new Ga(e,t.transaction(r,n))}catch(t){throw new xa(e,t)}},Object.defineProperty(Ga.prototype,"Kn",{get:function(){return this.Xn.promise},enumerable:!1,configurable:!0}),Ga.prototype.abort=function(t){t&&this.Xn.reject(t),this.aborted||(Rr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Ga.prototype.store=function(t){t=this.transaction.objectStore(t);return new Fa(t)},Ga),Fa=(ja.prototype.put=function(t,e){t=void 0!==e?(Rr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Rr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t));return qa(t)},ja.prototype.add=function(t){return Rr("SimpleDb","ADD",this.store.name,t,t),qa(this.store.add(t))},ja.prototype.get=function(e){var n=this;return qa(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Rr("SimpleDb","GET",n.store.name,e,t),t})},ja.prototype.delete=function(t){return Rr("SimpleDb","DELETE",this.store.name,t),qa(this.store.delete(t))},ja.prototype.count=function(){return Rr("SimpleDb","COUNT",this.store.name),qa(this.store.count())},ja.prototype.Zn=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.ts(e,function(t,e){n.push(e)}).next(function(){return n})},ja.prototype.es=function(t,e){Rr("SimpleDb","DELETE ALL",this.store.name);e=this.options(t,e);e.ns=!1;e=this.cursor(e);return this.ts(e,function(t,e,n){return n.delete()})},ja.prototype.ss=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.ts(n,e)},ja.prototype.rs=function(r){var t=this.cursor({});return new Da(function(n,e){t.onerror=function(t){t=za(t.target.error);e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},ja.prototype.ts=function(t,i){var o=[];return new Da(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new Oa(n),(t=i(n.primaryKey,n.value,e))instanceof Da&&(t=t.catch(function(t){return e.done(),Da.reject(t)}),o.push(t)),e.vn?r():null===e.Jn?n.continue():n.continue(e.Jn)):r()}}).next(function(){return Da.$n(o)})},ja.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},ja.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.ns?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},ja);function ja(t){this.store=t}function Ga(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.Xn=new Aa,this.transaction.oncomplete=function(){n.Xn.resolve()},this.transaction.onabort=function(){t.error?n.Xn.reject(new xa(e,t.error)):n.Xn.resolve()},this.transaction.onerror=function(t){t=za(t.target.error);n.Xn.reject(new xa(e,t))}}function qa(t){return new Da(function(e,n){t.onsuccess=function(t){t=t.target.result;e(t)},t.onerror=function(t){t=za(t.target.error);n(t)}})}var Ba=!1;function za(t){var e=Ra.Mn(p());if(12.2<=e&&e<13){e="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(e)){var n=new _r("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Ba||(Ba=!0,setTimeout(function(){throw n},0)),n}}return t}function Ka(){return"undefined"!=typeof window?window:null}function Qa(){return"undefined"!=typeof document?document:null}var Ha=(Ya.ls=function(t,e,n,r,i){i=new Ya(t,e,Date.now()+n,r,i);return i.start(n),i},Ya.prototype.start=function(t){var e=this;this._s=setTimeout(function(){return e.fs()},t)},Ya.prototype.Vn=function(){return this.fs()},Ya.prototype.cancel=function(t){null!==this._s&&(this.clearTimeout(),this.hs.reject(new _r(Tr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Ya.prototype.fs=function(){var e=this;this.os.ds(function(){return null!==e._s?(e.clearTimeout(),e.op().then(function(t){return e.hs.resolve(t)})):Promise.resolve()})},Ya.prototype.clearTimeout=function(){null!==this._s&&(this.cs(this),clearTimeout(this._s),this._s=null)},Ya),Wa=(Object.defineProperty(Xa.prototype,"Vs",{get:function(){return this.Es},enumerable:!1,configurable:!0}),Xa.prototype.ds=function(t){this.enqueue(t)},Xa.prototype.ps=function(t){this.bs(),this.vs(t)},Xa.prototype.Ss=function(){var t;this.Es||(this.Es=!0,(t=Qa())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.gs))},Xa.prototype.enqueue=function(t){return this.bs(),this.Es?new Promise(function(t){}):this.vs(t)},Xa.prototype.Ds=function(t){var e=this;this.Ts.push(t),this.ds(function(){return e.Cs()})},Xa.prototype.Cs=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Ts.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Ts[0]()];case 2:return t.sent(),this.Ts.shift(),this.ys.reset(),[3,4];case 3:if(!Va(e=t.sent()))throw e;return Rr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Ts.length&&this.ys.Rn(function(){return n.Cs()}),t.label=5;case 5:return[2]}})})},Xa.prototype.vs=function(t){var r=this,e=this.ws.then(function(){return r.Rs=!0,t().catch(function(t){throw r.As=t,r.Rs=!1,Or("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Rs=!1,t})});return this.ws=e},Xa.prototype.yn=function(t,e,n){var r=this;this.bs(),-1<this.Ps.indexOf(t)&&(e=0);n=Ha.ls(this,t,e,n,function(t){return r.Ns(t)});return this.Is.push(n),n},Xa.prototype.bs=function(){this.As&&Lr()},Xa.prototype.Fs=function(){},Xa.prototype.$s=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.ws];case 1:t.sent(),t.label=2;case 2:if(e!==this.ws)return[3,0];t.label=3;case 3:return[2]}})})},Xa.prototype.xs=function(t){for(var e=0,n=this.Is;e<n.length;e++)if(n[e].fn===t)return!0;return!1},Xa.prototype.ks=function(r){var i=this;return this.$s().then(function(){i.Is.sort(function(t,e){return t.us-e.us});for(var t=0,e=i.Is;t<e.length;t++){var n=e[t];if(n.Vn(),"all"!==r&&n.fn===r)break}return i.$s()})},Xa.prototype.Ms=function(t){this.Ps.push(t)},Xa.prototype.Ns=function(t){t=this.Is.indexOf(t);this.Is.splice(t,1)},Xa);function Xa(){var e=this;this.ws=Promise.resolve(),this.Ts=[],this.Es=!1,this.Is=[],this.As=null,this.Rs=!1,this.Ps=[],this.ys=new Sa(this,"async_queue_retry"),this.gs=function(){var t=Qa();t&&Rr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.ys.gn()};var t=Qa();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.gs)}function Ya(t,e,n,r,i){this.os=t,this.fn=e,this.us=n,this.op=r,this.cs=i,this.hs=new Aa,this.then=this.hs.promise.then.bind(this.hs.promise),this.hs.promise.catch(function(t){})}function Ja(t,e){if(Or("AsyncQueue",e+": "+t),Va(t))return new _r(Tr.UNAVAILABLE,e+": "+t);throw t}function Za(){this.Os=void 0,this.listeners=[]}function $a(){this.Ls=new Di(Ku,zu),this.onlineState="Unknown",this.Bs=new Set}function tc(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.Ls.get(n))||(r=!0,i=new Za),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.qs(n)];case 2:return o.Os=t.sent(),[3,4];case 3:return o=t.sent(),o=Ja(o,"Initialization of query '"+Qu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.Ls.set(n,i),i.listeners.push(u),u.Us(e.onlineState),i.Os&&u.Qs(i.Os)&&nc(e),[2]}})})}function ec(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.Ls.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.Ls.delete(n),e.Ws(n))]:[2]})})}function nc(t){t.Bs.forEach(function(t){t.next()})}var rc=(sc.prototype.Qs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new vo(t.query,t.docs,t.Ut,e,t.Qt,t.fromCache,t.Wt,!0)}var o=!1;return this.Ks?this.zs(t)&&(this.js.next(t),o=!0):this.Hs(t,this.onlineState)&&(this.Js(t),o=!0),this.Gs=t,o},sc.prototype.onError=function(t){this.js.error(t)},sc.prototype.Us=function(t){this.onlineState=t;var e=!1;return this.Gs&&!this.Ks&&this.Hs(this.Gs,t)&&(this.Js(this.Gs),e=!0),e},sc.prototype.Hs=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Ys&&n||t.docs.m()&&"Offline"!==e)},sc.prototype.zs=function(t){if(0<t.docChanges.length)return!0;var e=this.Gs&&this.Gs.hasPendingWrites!==t.hasPendingWrites;return!(!t.Wt&&!e)&&!0===this.options.includeMetadataChanges},sc.prototype.Js=function(t){t=vo.Kt(t.query,t.docs,t.Qt,t.fromCache),this.Ks=!0,this.js.next(t)},sc),ic=(oc.prototype.Xs=function(){return null!=this.uid},oc.prototype.Zs=function(){return this.Xs()?"uid:"+this.uid:"anonymous-user"},oc.prototype.isEqual=function(t){return t.uid===this.uid},oc);function oc(t){this.uid=t}function sc(t,e,n){this.query=t,this.js=e,this.Ks=!1,this.Gs=null,this.onlineState="Unknown",this.options=n||{}}ic.UNAUTHENTICATED=new ic(null),ic.ti=new ic("google-credentials-uid"),ic.ei=new ic("first-party-uid");var uc=(ac.prototype.si=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},ac.prototype.next=function(){var t=++this.previousValue;return this.ii&&this.ii(t),t},ac);function ac(t,e){var n=this;this.previousValue=t,e&&(e.ni=function(t){return n.si(t)},this.ii=function(t){return e.ri(t)})}function cc(t,e){return"firestore_clients_"+t+"_"+e}function hc(t,e,n){n="firestore_mutations_"+t+"_"+n;return e.Xs()&&(n+="_"+e.uid),n}function lc(t,e){return"firestore_targets_"+t+"_"+e}uc.oi=-1;var fc=(Oc.ai=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new _r(r.error.code,r.error.message)),i?new Oc(t,e,r.state,o):(Or("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},Oc.prototype.ui=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Oc),pc=(Rc.ai=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new _r(n.error.code,n.error.message)),r?new Rc(t,n.state,i):(Or("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},Rc.prototype.ui=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Rc),dc=(Dc.ai=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=fo,o=0;r&&o<n.activeTargetIds.length;++o)r=Mi(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new Dc(t,i):(Or("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},Dc),yc=(Sc.ai=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Sc(e.clientId,e.onlineState):(Or("SharedClientState","Failed to parse online state: "+t),null)},Sc),vc=(Nc.prototype.ci=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Nc.prototype.hi=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Nc.prototype.ui=function(){var t={activeTargetIds:this.activeTargetIds.A(),updateTimeMs:Date.now()};return JSON.stringify(t)},Nc),gc=(Ac.On=function(t){return!(!t||!t.localStorage)},Ac.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,l=this;return v(this,function(t){switch(t.label){case 0:return[4,this._i.pi()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this.li&&(i=this.getItem(cc(this.persistenceKey,r)))&&(o=dc.ai(r,i))&&(this.mi=this.mi.rt(o.clientId,o));for(this.bi(),(s=this.storage.getItem(this.gi))&&(u=this.vi(s))&&this.Si(u),a=0,c=this.Ei;a<c.length;a++)h=c[a],this.wi(h);return this.Ei=[],this.window.addEventListener("unload",function(){return l.Di()}),this.Ti=!0,[2]}})})},Ac.prototype.ri=function(t){this.setItem(this.Ai,JSON.stringify(t))},Ac.prototype.Ci=function(){return this.Ni(this.mi)},Ac.prototype.Fi=function(n){var r=!1;return this.mi.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},Ac.prototype.$i=function(t){this.xi(t,"pending")},Ac.prototype.ki=function(t,e,n){this.xi(t,e,n),this.Mi(t)},Ac.prototype.Oi=function(t){var e,n="not-current";return this.Fi(t)&&(!(e=this.storage.getItem(lc(this.persistenceKey,t)))||(e=pc.ai(t,e))&&(n=e.state)),this.Li.ci(t),this.bi(),n},Ac.prototype.Bi=function(t){this.Li.hi(t),this.bi()},Ac.prototype.qi=function(t){return this.Li.activeTargetIds.has(t)},Ac.prototype.Ui=function(t){this.removeItem(lc(this.persistenceKey,t))},Ac.prototype.Qi=function(t,e,n){this.Wi(t,e,n)},Ac.prototype.ji=function(t,e,n){var r=this;e.forEach(function(t){r.Mi(t)}),this.currentUser=t,n.forEach(function(t){r.$i(t)})},Ac.prototype.Ki=function(t){this.Gi(t)},Ac.prototype.zi=function(){this.Hi()},Ac.prototype.Di=function(){this.Ti&&(this.window.removeEventListener("storage",this.di),this.removeItem(this.Ii),this.Ti=!1)},Ac.prototype.getItem=function(t){var e=this.storage.getItem(t);return Rr("SharedClientState","READ",t,e),e},Ac.prototype.setItem=function(t,e){Rr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},Ac.prototype.removeItem=function(t){Rr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},Ac.prototype.wi=function(t){var e=this,o=t;if(o.storageArea===this.storage){if(Rr("SharedClientState","EVENT",o.key,o.newValue),o.key===this.Ii)return void Or("Received WebStorage notification for local change. Another client might have garbage-collected our state");this._n.Ds(function(){return y(e,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){if(this.Ti){if(null!==o.key)if(this.Ri.test(o.key)){if(null==o.newValue)return e=this.Ji(o.key),[2,this.Yi(e,null)];if(e=this.Xi(o.key,o.newValue))return[2,this.Yi(e.clientId,e)]}else if(this.Pi.test(o.key)){if(null!==o.newValue&&(n=this.Zi(o.key,o.newValue)))return[2,this.tr(n)]}else if(this.yi.test(o.key)){if(null!==o.newValue&&(r=this.er(o.key,o.newValue)))return[2,this.nr(r)]}else if(o.key===this.gi){if(null!==o.newValue&&(i=this.vi(o.newValue)))return[2,this.Si(i)]}else if(o.key===this.Ai)(i=function(t){var e=uc.oi;if(null!=t)try{var n=JSON.parse(t);Pr("number"==typeof n),e=n}catch(t){Or("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(o.newValue))!==uc.oi&&this.ni(i);else if(o.key===this.Vi)return[2,this._i.sr()]}else this.Ei.push(o);return[2]})})})}},Object.defineProperty(Ac.prototype,"Li",{get:function(){return this.mi.get(this.li)},enumerable:!1,configurable:!0}),Ac.prototype.bi=function(){this.setItem(this.Ii,this.Li.ui())},Ac.prototype.xi=function(t,e,n){n=new fc(this.currentUser,t,e,n),t=hc(this.persistenceKey,this.currentUser,t);this.setItem(t,n.ui())},Ac.prototype.Mi=function(t){t=hc(this.persistenceKey,this.currentUser,t);this.removeItem(t)},Ac.prototype.Gi=function(t){t={clientId:this.li,onlineState:t};this.storage.setItem(this.gi,JSON.stringify(t))},Ac.prototype.Wi=function(t,e,n){var r=lc(this.persistenceKey,t),n=new pc(t,e,n);this.setItem(r,n.ui())},Ac.prototype.Hi=function(){this.setItem(this.Vi,"value-not-used")},Ac.prototype.Ji=function(t){t=this.Ri.exec(t);return t?t[1]:null},Ac.prototype.Xi=function(t,e){t=this.Ji(t);return dc.ai(t,e)},Ac.prototype.Zi=function(t,e){var n=this.Pi.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return fc.ai(new ic(n),t,e)},Ac.prototype.er=function(t,e){t=this.yi.exec(t),t=Number(t[1]);return pc.ai(t,e)},Ac.prototype.vi=function(t){return yc.ai(t)},Ac.prototype.tr=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this._i.ir(e.batchId,e.state,e.error)]:(Rr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},Ac.prototype.nr=function(t){return this._i.rr(t.targetId,t.state,t.error)},Ac.prototype.Yi=function(t,e){var n=this,r=e?this.mi.rt(t,e):this.mi.remove(t),i=this.Ni(this.mi),o=this.Ni(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this._i.ar(s,u).then(function(){n.mi=r})},Ac.prototype.Si=function(t){this.mi.get(t.clientId)&&this.fi(t.onlineState)},Ac.prototype.Ni=function(t){var n=fo;return t.forEach(function(t,e){n=n.xt(e.activeTargetIds)}),n},Ac),mc=(_c.prototype.$i=function(t){},_c.prototype.ki=function(t,e,n){},_c.prototype.Oi=function(t){return this.ur.ci(t),this.cr[t]||"not-current"},_c.prototype.Qi=function(t,e,n){this.cr[t]=e},_c.prototype.Bi=function(t){this.ur.hi(t)},_c.prototype.qi=function(t){return this.ur.activeTargetIds.has(t)},_c.prototype.Ui=function(t){delete this.cr[t]},_c.prototype.Ci=function(){return this.ur.activeTargetIds},_c.prototype.Fi=function(t){return this.ur.activeTargetIds.has(t)},_c.prototype.start=function(){return this.ur=new vc,Promise.resolve()},_c.prototype.ji=function(t,e,n){},_c.prototype.Ki=function(t){},_c.prototype.Di=function(){},_c.prototype.ri=function(t){},_c.prototype.zi=function(){},_c),wc=(Tc.prototype.lr=function(t,e,n){for(var r=n._r,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=Js(o,e,r[i]))}return e},Tc.prototype.dr=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Zs(i,e,e,this.hr))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Zs(a,e,o,this.hr))}return e},Tc.prototype.wr=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.dr(t.key,n.get(t.key));e&&(i=i.rt(t.key,e))}),i},Tc.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},lo())},Tc.prototype.isEqual=function(t){return this.batchId===t.batchId&&vi(this.mutations,t.mutations,$s)&&vi(this.baseMutations,t.baseMutations,$s)},Tc),bc=(Ic.from=function(t,e,n){Pr(t.mutations.length===n.length);for(var r=co,i=t.mutations,o=0;o<i.length;o++)r=r.rt(i[o].key,n[o].version);return new Ic(t,e,n,r)},Ic),h=(Ec.prototype.Ar=function(t){t=this.Er.get(t);return t?t.readTime:Oi.min()},Ec.prototype.Rr=function(t,e){this.Pr(),this.Er.set(t.key,{yr:t,readTime:e})},Ec.prototype.gr=function(t,e){void 0===e&&(e=null),this.Pr(),this.Er.set(t,{yr:null,readTime:e})},Ec.prototype.Vr=function(t,e){this.Pr();var n=this.Er.get(e);return void 0!==n?Da.resolve(n.yr):this.pr(t,e)},Ec.prototype.getEntries=function(t,e){return this.br(t,e)},Ec.prototype.apply=function(t){return this.Pr(),this.Ir=!0,this.vr(t)},Ec.prototype.Pr=function(){},Ec);function Ec(){this.Er=new Di(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Ir=!1}function Ic(t,e,n,r){this.batch=t,this.mr=e,this._r=n,this.Tr=r}function Tc(t,e,n,r){this.batchId=t,this.hr=e,this.baseMutations=n,this.mutations=r}function _c(){this.ur=new vc,this.cr={},this.fi=null,this.ni=null}function Ac(t,e,n,r,i){this.window=t,this._n=e,this.persistenceKey=n,this.li=r,this._i=null,this.fi=null,this.ni=null,this.di=this.wi.bind(this),this.mi=new Yi(yi),this.Ti=!1,this.Ei=[];n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ii=cc(this.persistenceKey,this.li),this.Ai="firestore_sequence_number_"+this.persistenceKey,this.mi=this.mi.rt(this.li,new vc),this.Ri=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.Pi=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.yi=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.gi="firestore_online_state_"+this.persistenceKey,this.Vi="firestore_bundle_loaded_"+this.persistenceKey,this.window.addEventListener("storage",this.di)}function Nc(){this.activeTargetIds=fo}function Sc(t,e){this.clientId=t,this.onlineState=e}function Dc(t,e){this.clientId=t,this.activeTargetIds=e}function Rc(t,e,n){this.targetId=t,this.state=e,this.error=n}function Oc(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function xc(n,r){void 0===r&&(r=10240);var i=0;return{read:function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return i<n.byteLength?(e={value:n.slice(i,i+r),done:!1},[2,(i+=r,e)]):[2,{value:void 0,done:!0}]})})},cancel:function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2]})})},releaseLock:function(){}}}function kc(t,e){if(t instanceof Uint8Array)return xc(t,e);if(t instanceof ArrayBuffer)return xc(new Uint8Array(t),e);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}function Lc(t){return new $o(t,!0)}var Pc=(Fc.prototype.Sr=function(){return"metadata"in this.payload},Fc),Uc=(Mc.Fr=function(t,e){return new Mc(kc(t,10240),e)},Mc.prototype.close=function(){return this.Dr.cancel()},Mc.prototype.getMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.metadata.promise]})})},Mc.prototype.$r=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Nr())]}})})},Mc.prototype.Nr=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return[4,this.kr()];case 1:return null===(e=t.sent())?[2,null]:(r=this.Cr.decode(e),n=Number(r),isNaN(n)&&this.Mr("length string ("+r+") is not valid number"),[4,this.Or(n)]);case 2:return r=t.sent(),[2,new Pc(JSON.parse(r),e.length+n)]}})})},Mc.prototype.Lr=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},Mc.prototype.kr=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.Lr()<0?[4,this.Br()]:[3,3];case 1:if(t.sent())return[3,3];t.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.Lr())<0&&this.Mr("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),n)])}})})},Mc.prototype.Or=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.buffer.length<n?[4,this.Br()]:[3,3];case 1:t.sent()&&this.Mr("Reached the end of bundle when more is expected."),t.label=2;case 2:return[3,0];case 3:return e=this.Cr.decode(this.buffer.slice(0,n)),[2,(this.buffer=this.buffer.slice(n),e)]}})})},Mc.prototype.Mr=function(t){throw this.Dr.cancel(),new Error("Invalid bundle format: "+t)},Mc.prototype.Br=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.Dr.read()];case 1:return(e=t.sent()).done||((n=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n),[2,e.done]}})})},Mc),Cc=(Vc.prototype.qr=function(t){return cs(this.serializer,t)},Vc.prototype.Ur=function(t){return t.metadata.exists?ys(this.serializer,t.document,!1):new Nu(this.qr(t.metadata.name),this.Qr(t.metadata.readTime))},Vc.prototype.Qr=os,Vc);function Vc(t){this.serializer=t}function Mc(t,e){var n=this;this.Dr=t,this.serializer=e,this.metadata=new Aa,this.buffer=new Uint8Array,this.Cr=new TextDecoder("utf-8"),this.Nr().then(function(t){t&&t.Sr()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function Fc(t,e){this.payload=t,this.byteLength=e}function jc(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}function Gc(t,e){this.progress=t,this.Wr=e}var qc=(Xc.prototype.Gr=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.Ls.push(t.payload.namedQuery):t.payload.zr?(this.documents.push({metadata:t.payload.zr}),t.payload.zr.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},Xc.prototype.Hr=function(t){for(var e=new Map,n=new Cc(this.serializer),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.Ls)for(var s=n.qr(o.metadata.name),u=0,a=o.metadata.Ls;u<a.length;u++){var c=a[u],h=(e.get(c)||lo()).add(s);e.set(c,h)}}return e},Xc.prototype.complete=function(){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return[4,function(f,p,d){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a,c,h,l;return v(this,function(t){switch(t.label){case 0:for(e=new Cc((n=f).serializer),r=lo(),i=oo,o=co,s=0,u=p;s<u.length;s++)a=u[s],c=e.qr(a.metadata.name),a.document&&(r=r.add(c)),i=i.rt(c,e.Ur(a)),o=o.rt(c,e.Qr(a.metadata.readTime));return h=n.Yr.Jr({Xr:!0}),[4,jl(n,ju(Lu(jr.P("__bundle__/docs/"+d))))];case 1:return l=t.sent(),[2,n.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return Fl(e,h,i,Oi.min(),o).next(function(t){return h.apply(e),t}).next(function(t){return n.eo.Zr(e,l.targetId).next(function(){return n.eo.no(e,r,l.targetId)}).next(function(){return n.io.so(e,t)})})})]}})})}(this.Kr,this.documents,this.jr.id)];case 1:e=t.sent(),n=this.Hr(this.documents),r=0,i=this.Ls,t.label=2;case 2:return r<i.length?(i=i[r],[4,function(e,i,o){return void 0===o&&(o=lo()),y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return[4,jl(e,ju(wh(i.bundledQuery)))];case 1:return n=t.sent(),[2,(r=e).persistence.runTransaction("Save named query","readwrite",function(t){var e=os(i.readTime);if(0<=n.et.L(e))return r.yu.Qa(t,i);e=n.st(mi.B,e);return r.ic=r.ic.rt(e.targetId,e),r.eo.su(t,e).next(function(){return r.eo.Zr(t,n.targetId)}).next(function(){return r.eo.no(t,o,n.targetId)}).next(function(){return r.yu.Qa(t,i)})})]}})})}(this.Kr,i,n.get(i.name))]):[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Gc(Object.assign({},this.progress),e))]}})})},Xc),Bc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ie=(Wc.prototype.oo=function(t){this.ro.push(t)},Wc.prototype.ao=function(){this.ro.forEach(function(t){return t()})},Wc),zc=(Hc.prototype.lo=function(e,n){var r=this;return this.co._o(e,n).next(function(t){return r.fo(e,n,t)})},Hc.prototype.fo=function(t,r,i){return this.uo.Vr(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].dr(r,t);return t})},Hc.prototype.wo=function(t,e,i){var o=oo;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].dr(t,e);o=o.rt(t,e)}),o},Hc.prototype.mo=function(e,t){var n=this;return this.uo.getEntries(e,t).next(function(t){return n.so(e,t)})},Hc.prototype.so=function(e,r){var i=this;return this.co.To(e,r).next(function(t){var t=i.wo(e,r,t),n=oo;return t.forEach(function(t,e){e=e||new Nu(t,Oi.min()),n=n.rt(t,e)}),n})},Hc.prototype.Eo=function(t,e,n){return r=e,Br.F(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Io(t,e.path):Mu(e)?this.Ao(t,e,n):this.Ro(t,e,n);var r},Hc.prototype.Io=function(t,e){return this.lo(t,new Br(e)).next(function(t){var e=ao;return t instanceof Au&&(e=e.rt(t.key,t)),e})},Hc.prototype.Ao=function(n,r,i){var o=this,s=r.collectionGroup,u=ao;return this.ho.Po(n,s).next(function(t){return Da.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new Du(t,null,e.rn.slice(),e.filters.slice(),e.limit,e.on,e.startAt,e.endAt));return o.Ro(n,e,i).next(function(t){t.forEach(function(t,e){u=u.rt(t,e)})})}).next(function(){return u})})},Hc.prototype.Ro=function(e,n,t){var c,h,r=this;return this.uo.Eo(e,n,t).next(function(t){return c=t,r.co.yo(e,n)}).next(function(t){return h=t,r.Vo(e,h,c).next(function(t){c=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),a=Zs(s,a,a,r.hr);c=a instanceof Au?c.rt(u,a):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){Hu(n,e)||(c=c.remove(t))}),c})},Hc.prototype.Vo=function(t,e,n){for(var r=lo(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof iu&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.uo.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Au&&(c=c.rt(t,e))}),c})},Hc),Kc=(Qc.vo=function(t,e){for(var n=lo(),r=lo(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Qc(t,e.fromCache,n,r)},Qc);function Qc(t,e,n,r){this.targetId=t,this.fromCache=e,this.po=n,this.bo=r}function Hc(t,e,n){this.uo=t,this.co=e,this.ho=n}function Wc(){this.ro=[]}function Xc(t,e,n){this.jr=t,this.Kr=e,this.serializer=n,this.Ls=[],this.documents=[],this.progress=jc(t)}function Yc(t,e){var n=t[0],r=t[1],t=e[0],e=e[1],t=yi(n,t);return 0===t?yi(r,e):t}var Jc=(eh.prototype.Co=function(){return++this.Do},eh.prototype.No=function(t){var e=[t,this.Co()];this.buffer.size<this.So?this.buffer=this.buffer.add(e):Yc(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(eh.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),eh),Zc={Fo:!1,$o:0,xo:0,ko:0},$c=(th.Bo=function(t){return new th(t,th.qo,th.Uo)},th);function th(t,e,n){this.Mo=t,this.Oo=e,this.Lo=n}function eh(t){this.So=t,this.buffer=new ro(Yc),this.Do=0}$c.Qo=-1,$c.Wo=1048576,$c.jo=41943040,$c.qo=10,$c.Uo=1e3,$c.Ko=new $c($c.jo,$c.qo,$c.Uo),$c.Go=new $c($c.Qo,0,0);var nh=(oh.prototype.start=function(t){this.zo.params.Mo!==$c.Qo&&this.Yo(t)},oh.prototype.stop=function(){this.Jo&&(this.Jo.cancel(),this.Jo=null)},Object.defineProperty(oh.prototype,"Ti",{get:function(){return null!==this.Jo},enumerable:!1,configurable:!0}),oh.prototype.Yo=function(n){var t=this,e=this.Ho?3e5:6e4;Rr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.Jo=this.os.yn("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.Jo=null,this.Ho=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.Xo(this.zo)];case 2:return t.sent(),[3,7];case 3:return Va(e=t.sent())?(Rr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Ql(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.Yo(n)];case 8:return t.sent(),[2]}})})})},oh),rh=(ih.prototype.ta=function(t,e){return this.Zo.ea(t).next(function(t){return Math.floor(e/100*t)})},ih.prototype.na=function(t,e){var n=this;if(0===e)return Da.resolve(uc.oi);var r=new Jc(e);return this.Zo.De(t,function(t){return r.No(t.sequenceNumber)}).next(function(){return n.Zo.sa(t,function(t){return r.No(t)})}).next(function(){return r.maxValue})},ih.prototype.ia=function(t,e,n){return this.Zo.ia(t,e,n)},ih.prototype.ra=function(t,e){return this.Zo.ra(t,e)},ih.prototype.oa=function(e,n){var r=this;return this.params.Mo===$c.Qo?(Rr("LruGarbageCollector","Garbage collection skipped; disabled"),Da.resolve(Zc)):this.aa(e).next(function(t){return t<r.params.Mo?(Rr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.Mo),Zc):r.ua(e,n)})},ih.prototype.aa=function(t){return this.Zo.aa(t)},ih.prototype.ua=function(e,n){var r,i,o,s,u,a,c,h=this,l=Date.now();return this.ta(e,this.params.Oo).next(function(t){return i=t>h.params.Lo?(Rr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.Lo+" from "+t),h.params.Lo):t,s=Date.now(),h.na(e,i)}).next(function(t){return r=t,u=Date.now(),h.ia(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.ra(e,r)}).next(function(t){return c=Date.now(),Dr()<=f.DEBUG&&Rr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-l)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-l)+"ms"),Da.resolve({Fo:!0,$o:i,xo:o,ko:t})})},ih);function ih(t,e){this.Zo=t,this.params=e}function oh(t,e){this.zo=t,this.os=e,this.Ho=!1,this.Jo=null}function sh(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=uh(e)),e=function(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}(t.get(n),e);return uh(e)}function uh(t){return t+"\x01\x01"}function ah(t){var e=t.length;if(Pr(2<=e),2===e)return Pr("\x01"===t.charAt(0)&&"\x01"===t.charAt(1)),jr.g();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("\x01",o);switch((s<0||n<s)&&Lr(),t.charAt(s+1)){case"\x01":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"\x10":i+=t.substring(o,s),i+="\0";break;case"\x11":i+=t.substring(o,s+1);break;default:Lr()}o=s+2}return new jr(r)}var ch=function(t){this.ca=t};function hh(t,e){if(e.document)return ys(t.ca,e.document,!!e.hasCommittedMutations);if(e.noDocument){var t=Br.$(e.noDocument.path),n=yh(e.noDocument.readTime);return new Nu(t,n,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){n=Br.$(e.unknownDocument.path),e=yh(e.unknownDocument.version);return new Su(n,e)}return Lr()}function lh(t,e,n){var r=fh(n),n=e.key.path.h().A();if(e instanceof Au){var i={name:as(i=t.ca,(o=e).key),fields:o.sn().mapValue.fields,updateTime:rs(i,o.version.X())},o=e.hasCommittedMutations;return new Yh(null,null,i,o,r,n)}if(e instanceof Nu){var i=e.key.path.A(),o=dh(e.version),s=e.hasCommittedMutations;return new Yh(null,new Wh(i,o),null,s,r,n)}if(e instanceof Su){s=e.key.path.A(),e=dh(e.version);return new Yh(new Xh(s,e),null,null,!0,r,n)}return Lr()}function fh(t){t=t.X();return[t.seconds,t.nanoseconds]}function ph(t){t=new Ri(t[0],t[1]);return Oi.J(t)}function dh(t){t=t.X();return new Fh(t.seconds,t.nanoseconds)}function yh(t){t=new Ri(t.seconds,t.nanoseconds);return Oi.J(t)}function vh(e,t){var n=(t.baseMutations||[]).map(function(t){return gs(e.ca,t)}),r=t.mutations.map(function(t){return gs(e.ca,t)}),i=Ri.fromMillis(t.localWriteTimeMs);return new wc(t.batchId,i,n,r)}function gh(t){var e=yh(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?yh(t.lastLimboFreeSnapshotVersion):Oi.min(),r=void 0!==t.query.documents?(Pr(1===(r=t.query).documents.length),ju(Lu(ls(r.documents[0])))):ju(bs(t.query));return new Qi(r,t.targetId,0,t.lastListenSequenceNumber,e,n,mi.fromBase64String(t.resumeToken))}function mh(t,e){var n=dh(e.et),r=dh(e.lastLimboFreeSnapshotVersion),i=(Bi(e.target)?ms:ws)(t.ca,e.target),t=e.resumeToken.toBase64();return new Zh(e.targetId,Gi(e.target),n,t,e.sequenceNumber,r,i)}function wh(t){var e=bs({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.on?Gu(e,e.limit,"L"):e}var bh=(Eh._a=function(t,e,n,r){return Pr(""!==t.uid),new Eh(t.Xs()?t.uid:"",e,n,r)},Eh.prototype.fa=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return _h(t).ss({index:Kh.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},Eh.prototype.da=function(d,y,v,g){var m=this,w=Ah(d),b=_h(d);return b.add({}).next(function(t){Pr("number"==typeof t);for(var e,n,r,i,o,s=new wc(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return vs(e.ca,t)}),o=r.mutations.map(function(t){return vs(e.ca,t)}),new Kh(n,r.batchId,r.hr.toMillis(),i,o)),a=[],c=new ro(function(t,e){return yi(t.R(),e.R())}),h=0,l=g;h<l.length;h++){var f=l[h],p=Qh.key(m.userId,f.key.path,t),c=c.add(f.key.path.h());a.push(b.put(u)),a.push(w.put(p,Qh.PLACEHOLDER))}return c.forEach(function(t){a.push(m.ho.wa(d,t))}),d.oo(function(){m.la[t]=s.keys()}),Da.$n(a).next(function(){return s})})},Eh.prototype.ma=function(t,e){var n=this;return _h(t).get(e).next(function(t){return t?(Pr(t.userId===n.userId),vh(n.serializer,t)):null})},Eh.prototype.Ta=function(t,e){var n=this;return this.la[e]?Da.resolve(this.la[e]):this.ma(t,e).next(function(t){if(t){t=t.keys();return n.la[e]=t}return null})},Eh.prototype.Ea=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return _h(t).ss({index:Kh.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(Pr(e.batchId>=i),o=vh(r.serializer,e)),n.done()}).next(function(){return o})},Eh.prototype.Ia=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return _h(t).ss({index:Kh.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},Eh.prototype.Aa=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return _h(t).Zn(Kh.userMutationsIndex,n).next(function(t){return t.map(function(t){return vh(e.serializer,t)})})},Eh.prototype._o=function(o,s){var u=this,t=Qh.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return Ah(o).ss({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=ah(i);if(r===u.userId&&s.path.isEqual(i))return _h(o).get(t).next(function(t){if(!t)throw Lr();Pr(t.userId===u.userId),a.push(vh(u.serializer,t))});n.done()}).next(function(){return a})},Eh.prototype.To=function(e,t){var s=this,u=new ro(yi),n=[];return t.forEach(function(o){var t=Qh.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=Ah(e).ss({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=ah(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),Da.$n(n).next(function(){return s.Ra(e,u)})},Eh.prototype.yo=function(t,e){var o=this,s=e.path,u=s.length+1,e=Qh.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new ro(yi);return Ah(t).ss({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=ah(i);r===o.userId&&s.T(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.Ra(t,a)})},Eh.prototype.Ra=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(_h(e).get(t).next(function(t){if(null===t)throw Lr();Pr(t.userId===n.userId),r.push(vh(n.serializer,t))}))}),Da.$n(i).next(function(){return r})},Eh.prototype.Pa=function(e,n){var r=this;return Th(e.ya,this.userId,n).next(function(t){return e.oo(function(){r.ga(n.batchId)}),Da.forEach(t,function(t){return r.ha.Va(e,t)})})},Eh.prototype.ga=function(t){delete this.la[t]},Eh.prototype.pa=function(e){var i=this;return this.fa(e).next(function(t){if(!t)return Da.resolve();var t=IDBKeyRange.lowerBound(Qh.prefixForUser(i.userId)),r=[];return Ah(e).ss({range:t},function(t,e,n){t[0]===i.userId?(t=ah(t[1]),r.push(t)):n.done()}).next(function(){Pr(0===r.length)})})},Eh.prototype.ba=function(t,e){return Ih(t,this.userId,e)},Eh.prototype.va=function(t){var e=this;return Nh(t).get(this.userId).next(function(t){return t||new zh(e.userId,-1,"")})},Eh);function Eh(t,e,n,r){this.userId=t,this.serializer=e,this.ho=n,this.ha=r,this.la={}}function Ih(t,o,e){var e=Qh.prefixForPath(o,e.path),s=e[1],e=IDBKeyRange.lowerBound(e),u=!1;return Ah(t).ss({range:e,ns:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function Th(t,e,n){var r=t.store(Kh.store),i=t.store(Qh.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r.ss({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){Pr(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],l=Qh.key(e,h.key.path,n.batchId);o.push(i.delete(l)),u.push(h.key)}return Da.$n(o).next(function(){return u})}function _h(t){return _l.Un(t,Kh.store)}function Ah(t){return _l.Un(t,Qh.store)}function Nh(t){return _l.Un(t,zh.store)}var Sh,Dh=(xh.prototype.Rr=function(t,e,n){return Lh(t).put(Ph(e),n)},xh.prototype.gr=function(t,e){t=Lh(t),e=Ph(e);return t.delete(e)},xh.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.Sa(e,t)})},xh.prototype.Vr=function(t,e){var n=this;return Lh(t).get(Ph(e)).next(function(t){return n.Da(t)})},xh.prototype.Ca=function(t,e){var n=this;return Lh(t).get(Ph(e)).next(function(t){var e=n.Da(t);return e?{yr:e,size:Uh(t)}:null})},xh.prototype.getEntries=function(t,e){var n=this,r=oo;return this.Na(t,e,function(t,e){e=n.Da(e);r=r.rt(t,e)}).next(function(){return r})},xh.prototype.Fa=function(t,e){var r=this,i=oo,o=new Yi(Br.i);return this.Na(t,e,function(t,e){var n=r.Da(e);o=n?(i=i.rt(t,n),o.rt(t,Uh(e))):(i=i.rt(t,null),o.rt(t,0))}).next(function(){return{$a:i,xa:o}})},xh.prototype.Na=function(t,e,i){if(e.m())return Da.resolve();var n=IDBKeyRange.bound(e.first().path.A(),e.last().path.A()),o=e.lt(),s=o.Et();return Lh(t).ss({range:n},function(t,e,n){for(var r=Br.$(t);s&&Br.i(s,r)<0;)i(s,null),s=o.Et();s&&s.isEqual(r)&&(i(s,e),s=o.It()?o.Et():null),s?n.Yn(s.path.A()):n.done()}).next(function(){for(;s;)i(s,null),s=o.It()?o.Et():null})},xh.prototype.Eo=function(t,r,e){var n,i=this,o=ao,s=r.path.length+1,u={};return e.isEqual(Oi.min())?(n=r.path.A(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.A(),e=fh(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=Yh.collectionReadTimeIndex),Lh(t).ss(u,function(t,e,n){t.length===s&&(e=hh(i.serializer,e),r.path.T(e.key.path)?e instanceof Au&&Hu(r,e)&&(o=o.rt(e.key,e)):n.done())}).next(function(){return o})},xh.prototype.Jr=function(t){return new Rh(this,!!t&&t.Xr)},xh.prototype.ka=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},xh.prototype.getMetadata=function(t){return kh(t).get(Jh.key).next(function(t){return Pr(!!t),t})},xh.prototype.Sa=function(t,e){return kh(t).put(Jh.key,e)},xh.prototype.Da=function(t){if(t){t=hh(this.serializer,t);return t instanceof Nu&&t.version.isEqual(Oi.min())?null:t}return null},xh),Rh=(n(Oh,Sh=h),Oh.prototype.vr=function(i){var o=this,s=[],u=0,a=new ro(function(t,e){return yi(t.R(),e.R())});return this.Er.forEach(function(t,e){var n,r=o.Oa.get(t);e.yr?(n=lh(o.Ma.serializer,e.yr,o.Ar(t)),a=a.add(t.path.h()),e=Uh(n),u+=e-r,s.push(o.Ma.Rr(i,t,n))):(u-=r,o.Xr?(r=lh(o.Ma.serializer,new Nu(t,Oi.min()),o.Ar(t)),s.push(o.Ma.Rr(i,t,r))):s.push(o.Ma.gr(i,t)))}),a.forEach(function(t){s.push(o.Ma.ho.wa(i,t))}),s.push(this.Ma.updateMetadata(i,u)),Da.$n(s)},Oh.prototype.pr=function(t,e){var n=this;return this.Ma.Ca(t,e).next(function(t){return null===t?(n.Oa.set(e,0),null):(n.Oa.set(e,t.size),t.yr)})},Oh.prototype.br=function(t,e){var n=this;return this.Ma.Fa(t,e).next(function(t){var e=t.$a;return t.xa.forEach(function(t,e){n.Oa.set(t,e)}),e})},Oh);function Oh(t,e){var n=this;return(n=Sh.call(this)||this).Ma=t,n.Xr=e,n.Oa=new Di(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function xh(t,e){this.serializer=t,this.ho=e}function kh(t){return _l.Un(t,Jh.store)}function Lh(t){return _l.Un(t,Yh.store)}function Ph(t){return t.path.A()}function Uh(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Lr();e=t.noDocument}return JSON.stringify(e).length}var Ch=(Bh.prototype.wa=function(t,e){return this.La.add(e),Da.resolve()},Bh.prototype.Po=function(t,e){return Da.resolve(this.La.getEntries(e))},Bh),Vh=(qh.prototype.add=function(t){var e=t._(),n=t.h(),r=this.index[e]||new ro(jr.i),t=!r.has(n);return this.index[e]=r.add(n),t},qh.prototype.has=function(t){var e=t._(),t=t.h(),e=this.index[e];return e&&e.has(t)},qh.prototype.getEntries=function(t){return(this.index[t]||new ro(jr.i)).A()},qh),Mh=(Gh.prototype.createOrUpgrade=function(e,n,t,r){var i=this;Pr(t<r&&0<=t&&r<=11);var o=new Ma("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(jh.store),(s=e).createObjectStore(zh.store,{keyPath:zh.keyPath}),s.createObjectStore(Kh.store,{keyPath:Kh.keyPath,autoIncrement:!0}).createIndex(Kh.userMutationsIndex,Kh.userMutationsKeyPath,{unique:!0}),s.createObjectStore(Qh.store),nl(e),e.createObjectStore(Yh.store));var s,u=Da.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore($h.store),s.deleteObjectStore(Zh.store),s.deleteObjectStore(tl.store),nl(e)),u=u.next(function(){return t=o.store(tl.store),e=new tl(0,0,Oi.min().X(),0),t.put(tl.key,e);var t,e})),t<4&&4<=r&&(0!==t&&(u=u.next(function(){return n=e,(r=o).store(Kh.store).Zn().next(function(t){n.deleteObjectStore(Kh.store),n.createObjectStore(Kh.store,{keyPath:Kh.keyPath,autoIncrement:!0}).createIndex(Kh.userMutationsIndex,Kh.userMutationsKeyPath,{unique:!0});var e=r.store(Kh.store),t=t.map(function(t){return e.put(t)});return Da.$n(t)});var n,r})),u=u.next(function(){e.createObjectStore(rl.store,{keyPath:rl.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.removeAcknowledgedMutations(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(Jh.store),i.addDocumentGlobal(o)})),t<7&&7<=r&&(u=u.next(function(){return i.ensureSequenceNumbers(o)})),t<8&&8<=r&&(u=u.next(function(){return i.createCollectionParentIndex(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(Yh.store)).createIndex(Yh.readTimeIndex,Yh.readTimeIndexPath,{unique:!1}),t.createIndex(Yh.collectionReadTimeIndex,Yh.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.rewriteCanonicalIds(o)})),t<11&&11<=r&&(u=u.next(function(){e.createObjectStore(il.store,{keyPath:il.keyPath}),e.createObjectStore(ol.store,{keyPath:ol.keyPath})})),u},Gh.prototype.addDocumentGlobal=function(e){var n=0;return e.store(Yh.store).ss(function(t,e){n+=Uh(e)}).next(function(){var t=new Jh(n);return e.store(Jh.store).put(Jh.key,t)})},Gh.prototype.removeAcknowledgedMutations=function(n){var r=this,t=n.store(zh.store),i=n.store(Kh.store);return t.Zn().next(function(t){return Da.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.Zn(Kh.userMutationsIndex,t).next(function(t){return Da.forEach(t,function(t){Pr(t.userId===e.userId);t=vh(r.serializer,t);return Th(n,e.userId,t).next(function(){})})})})})},Gh.prototype.ensureSequenceNumbers=function(t){var o=t.store($h.store),e=t.store(Yh.store);return t.store(tl.store).get(tl.key).next(function(r){var i=[];return e.ss(function(t,e){var n=new jr(t),t=[0,sh(n)];i.push(o.get(t).next(function(t){return t?Da.resolve():o.put(new $h(0,sh(n),r.highestListenSequenceNumber))}))}).next(function(){return Da.$n(i)})})},Gh.prototype.createCollectionParentIndex=function(t,e){t.createObjectStore(el.store,{keyPath:el.keyPath});function r(t){if(i.add(t)){var e=t._(),t=t.h();return n.put({collectionId:e,parent:sh(t)})}}var n=e.store(el.store),i=new Vh;return e.store(Yh.store).ss({ns:!0},function(t,e){t=new jr(t);return r(t.h())}).next(function(){return e.store(Qh.store).ss({ns:!0},function(t,e){t[0];var n=t[1],n=(t[2],ah(n));return r(n.h())})})},Gh.prototype.rewriteCanonicalIds=function(t){var n=this,r=t.store(Zh.store);return r.ss(function(t,e){e=gh(e),e=mh(n.serializer,e);return r.put(e)})},Gh),Fh=function(t,e){this.seconds=t,this.nanoseconds=e},jh=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function Gh(t){this.serializer=t}function qh(){this.index={}}function Bh(){this.La=new Vh}jh.store="owner",jh.key="owner";var zh=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};zh.store="mutationQueues",zh.keyPath="userId";var Kh=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Kh.store="mutations",Kh.keyPath="batchId",Kh.userMutationsIndex="userMutationsIndex",Kh.userMutationsKeyPath=["userId","batchId"];var Qh=(Hh.prefixForUser=function(t){return[t]},Hh.prefixForPath=function(t,e){return[t,sh(e)]},Hh.key=function(t,e,n){return[t,sh(e),n]},Hh);function Hh(){}Qh.store="documentMutations",Qh.PLACEHOLDER=new Qh;var Wh=function(t,e){this.path=t,this.readTime=e},Xh=function(t,e){this.path=t,this.version=e},Yh=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Yh.store="remoteDocuments",Yh.readTimeIndex="readTimeIndex",Yh.readTimeIndexPath="readTime",Yh.collectionReadTimeIndex="collectionReadTimeIndex",Yh.collectionReadTimeIndexPath=["parentPath","readTime"];var Jh=function(t){this.byteSize=t};Jh.store="remoteDocumentGlobal",Jh.key="remoteDocumentGlobalKey";var Zh=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Zh.store="targets",Zh.keyPath="targetId",Zh.queryTargetsIndexName="queryTargetsIndex",Zh.queryTargetsKeyPath=["canonicalId","targetId"];var $h=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};$h.store="targetDocuments",$h.keyPath=["targetId","path"],$h.documentTargetsIndex="documentTargetsIndex",$h.documentTargetsKeyPath=["path","targetId"];var tl=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};tl.key="targetGlobalKey",tl.store="targetGlobal";var el=function(t,e){this.collectionId=t,this.parent=e};function nl(t){t.createObjectStore($h.store,{keyPath:$h.keyPath}).createIndex($h.documentTargetsIndex,$h.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Zh.store,{keyPath:Zh.keyPath}).createIndex(Zh.queryTargetsIndexName,Zh.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(tl.store)}el.store="collectionParents",el.keyPath=["collectionId","parent"];var rl=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};rl.store="clientMetadata",rl.keyPath="clientId";var il=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};il.store="bundles",il.keyPath="bundleId";var ol=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};ol.store="namedQueries",ol.keyPath="name";var sl=i(i(i(i([zh.store,Kh.store,Qh.store,Yh.store,Zh.store,jh.store,tl.store,$h.store],[rl.store]),[Jh.store]),[el.store]),[il.store,ol.store]),ul=(al.prototype.Ba=function(t,e){return cl(t).get(e).next(function(t){if(t)return{id:(t=t).bundleId,createTime:yh(t.createTime),version:t.version}})},al.prototype.qa=function(t,e){return cl(t).put({bundleId:(e=e).id,createTime:dh(os(e.createTime)),version:e.version})},al.prototype.Ua=function(t,e){return hl(t).get(e).next(function(t){if(t)return{name:(t=t).name,query:wh(t.bundledQuery),readTime:yh(t.readTime)}})},al.prototype.Qa=function(t,e){return hl(t).put({name:(e=e).name,readTime:dh(os(e.readTime)),bundledQuery:e.bundledQuery})},al);function al(t){this.serializer=t}function cl(t){return _l.Un(t,il.store)}function hl(t){return _l.Un(t,ol.store)}var ll=(fl.prototype.wa=function(t,e){var n=this;if(this.Wa.has(e))return Da.resolve();var r=e._(),i=e.h();t.oo(function(){n.Wa.add(e)});i={collectionId:r,parent:sh(i)};return pl(t).put(i)},fl.prototype.Po=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[gi(i),""],!1,!0);return pl(t).Zn(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(ah(r.parent))}return o})},fl);function fl(){this.Wa=new Vh}function pl(t){return _l.Un(t,el.store)}var dl=(gl.prototype.next=function(){return this.ja+=2,this.ja},gl.Ka=function(){return new gl(0)},gl.Ga=function(){return new gl(-1)},gl),yl=(vl.prototype.za=function(n){var r=this;return this.Ha(n).next(function(t){var e=new dl(t.highestTargetId);return t.highestTargetId=e.next(),r.Ja(n,t).next(function(){return t.highestTargetId})})},vl.prototype.Ya=function(t){return this.Ha(t).next(function(t){return Oi.J(new Ri(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},vl.prototype.Xa=function(t){return this.Ha(t).next(function(t){return t.highestListenSequenceNumber})},vl.prototype.Za=function(e,n,r){var i=this;return this.Ha(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.X()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.Ja(e,t)})},vl.prototype.tu=function(e,n){var r=this;return this.eu(e,n).next(function(){return r.Ha(e).next(function(t){return t.targetCount+=1,r.nu(n,t),r.Ja(e,t)})})},vl.prototype.su=function(t,e){return this.eu(t,e)},vl.prototype.iu=function(e,t){var n=this;return this.Zr(e,t.targetId).next(function(){return ml(e).delete(t.targetId)}).next(function(){return n.Ha(e)}).next(function(t){return Pr(0<t.targetCount),--t.targetCount,n.Ja(e,t)})},vl.prototype.ia=function(n,r,i){var o=this,s=0,u=[];return ml(n).ss(function(t,e){e=gh(e);e.sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.iu(n,e)))}).next(function(){return Da.$n(u)}).next(function(){return s})},vl.prototype.De=function(t,n){return ml(t).ss(function(t,e){e=gh(e);n(e)})},vl.prototype.Ha=function(t){return wl(t).get(tl.key).next(function(t){return Pr(null!==t),t})},vl.prototype.Ja=function(t,e){return wl(t).put(tl.key,e)},vl.prototype.eu=function(t,e){return ml(t).put(mh(this.serializer,e))},vl.prototype.nu=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},vl.prototype.ru=function(t){return this.Ha(t).next(function(t){return t.targetCount})},vl.prototype.ou=function(t,r){var e=Gi(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return ml(t).ss({range:e,index:Zh.queryTargetsIndexName},function(t,e,n){e=gh(e);qi(r,e.target)&&(i=e,n.done())}).next(function(){return i})},vl.prototype.no=function(n,t,r){var i=this,o=[],s=bl(n);return t.forEach(function(t){var e=sh(t.path);o.push(s.put(new $h(r,e))),o.push(i.ha.au(n,r,t))}),Da.$n(o)},vl.prototype.uu=function(n,t,r){var i=this,o=bl(n);return Da.forEach(t,function(t){var e=sh(t.path);return Da.$n([o.delete([r,e]),i.ha.cu(n,r,t)])})},vl.prototype.Zr=function(t,e){t=bl(t),e=IDBKeyRange.bound([e],[e+1],!1,!0);return t.delete(e)},vl.prototype.hu=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=bl(t),r=lo();return t.ss({range:e,ns:!0},function(t,e,n){t=ah(t[1]),t=new Br(t);r=r.add(t)}).next(function(){return r})},vl.prototype.ba=function(t,e){var e=sh(e.path),e=IDBKeyRange.bound([e],[gi(e)],!1,!0),i=0;return bl(t).ss({index:$h.documentTargetsIndex,ns:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},vl.prototype.qe=function(t,e){return ml(t).get(e).next(function(t){return t?gh(t):null})},vl);function vl(t,e){this.ha=t,this.serializer=e}function gl(t){this.ja=t}function ml(t){return _l.Un(t,Zh.store)}function wl(t){return _l.Un(t,tl.store)}function bl(t){return _l.Un(t,$h.store)}var El,Il="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Tl=(n(Nl,El=Ie),Nl),_l=(Al.Un=function(t,e){if(t instanceof Tl)return Ra.Un(t.ya,e);throw Lr()},Al.prototype.start=function(){var e=this;return this.Vu().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new _r(Tr.FAILED_PRECONDITION,Il);return e.pu(),e.bu(),e.vu(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.eo.Xa(t)})}).then(function(t){e.du=new uc(t,e._u)}).then(function(){e.wu=!0}).catch(function(t){return e.Pu&&e.Pu.close(),Promise.reject(t)})},Al.prototype.Su=function(n){var t=this;return this.Au=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.Ti?[2,n(e)]:[2]})})},n(this.isPrimary)},Al.prototype.Du=function(n){var t=this;this.Pu.jn(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},Al.prototype.Cu=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this._n.ds(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ti?[4,this.Vu()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},Al.prototype.Vu=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Dl(e).put(new rl(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.Nu(e).next(function(t){t||(n.isPrimary=!1,n._n.Ds(function(){return n.Au(!1)}))})}).next(function(){return n.Fu(e)}).next(function(t){return n.isPrimary&&!t?n.$u(e).next(function(){return!1}):!!t&&n.xu(e).next(function(){return!0})})}).catch(function(t){if(Va(t))return Rr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Rr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n._n.Ds(function(){return n.Au(t)}),n.isPrimary=t})},Al.prototype.Nu=function(t){var e=this;return Sl(t).get(jh.key).next(function(t){return Da.resolve(e.ku(t))})},Al.prototype.Mu=function(t){return Dl(t).delete(this.clientId)},Al.prototype.Ou=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.Lu(this.Iu,18e5)?[3,2]:(this.Iu=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=Al.Un(t,rl.store);return r.Zn().next(function(t){var e=o.Bu(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return Da.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.gu)for(n=0,r=e;n<r.length;n++)i=r[n],this.gu.removeItem(this.qu(i.clientId));t.label=2;case 2:return[2]}})})},Al.prototype.vu=function(){var t=this;this.Eu=this._n.yn("client_metadata_refresh",4e3,function(){return t.Vu().then(function(){return t.Ou()}).then(function(){return t.vu()})})},Al.prototype.ku=function(t){return!!t&&t.ownerId===this.clientId},Al.prototype.Fu=function(e){var r=this;return this.fu?Da.resolve(!0):Sl(e).get(jh.key).next(function(t){if(null!==t&&r.Lu(t.leaseTimestampMs,5e3)&&!r.Uu(t.ownerId)){if(r.ku(t)&&r.networkEnabled)return!0;if(!r.ku(t)){if(!t.allowTabSynchronization)throw new _r(Tr.FAILED_PRECONDITION,Il);return!1}}return!(!r.networkEnabled||!r.inForeground)||Dl(e).Zn().next(function(t){return void 0===r.Bu(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&Rr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},Al.prototype.Di=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this.wu=!1,this.Qu(),this.Eu&&(this.Eu.cancel(),this.Eu=null),this.Wu(),this.ju(),[4,this.Pu.runTransaction("shutdown","readwrite",[jh.store,rl.store],function(t){var e=new Tl(t,uc.oi);return n.$u(e).next(function(){return n.Mu(e)})})];case 1:return t.sent(),this.Pu.close(),this.Ku(),[2]}})})},Al.prototype.Bu=function(t,e){var n=this;return t.filter(function(t){return n.Lu(t.updateTimeMs,e)&&!n.Uu(t.clientId)})},Al.prototype.pi=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return Dl(t).Zn().next(function(t){return e.Bu(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(Al.prototype,"Ti",{get:function(){return this.wu},enumerable:!1,configurable:!0}),Al.prototype.Gu=function(t){return bh._a(t,this.serializer,this.ho,this.ha)},Al.prototype.zu=function(){return this.eo},Al.prototype.Hu=function(){return this.uo},Al.prototype.Ju=function(){return this.ho},Al.prototype.Yu=function(){return this.yu},Al.prototype.runTransaction=function(e,n,r){var i=this;Rr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Pu.runTransaction(e,t,sl,function(t){return o=new Tl(t,i.du?i.du.next():uc.oi),"readwrite-primary"===n?i.Nu(o).next(function(t){return!!t||i.Fu(o)}).next(function(t){if(!t)throw Or("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i._n.Ds(function(){return i.Au(!1)}),new _r(Tr.FAILED_PRECONDITION,Bc);return r(o)}).next(function(t){return i.xu(o).next(function(){return t})}):i.Xu(o).next(function(){return r(o)})}).then(function(t){return o.ao(),t})},Al.prototype.Xu=function(t){var e=this;return Sl(t).get(jh.key).next(function(t){if(null!==t&&e.Lu(t.leaseTimestampMs,5e3)&&!e.Uu(t.ownerId)&&!e.ku(t)&&!(e.fu||e.allowTabSynchronization&&t.allowTabSynchronization))throw new _r(Tr.FAILED_PRECONDITION,Il)})},Al.prototype.xu=function(t){var e=new jh(this.clientId,this.allowTabSynchronization,Date.now());return Sl(t).put(jh.key,e)},Al.On=function(){return Ra.On()},Al.prototype.$u=function(t){var e=this,n=Sl(t);return n.get(jh.key).next(function(t){return e.ku(t)?(Rr("IndexedDbPersistence","Releasing primary lease."),n.delete(jh.key)):Da.resolve()})},Al.prototype.Lu=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Or("Detected an update time that is in the future: "+t+" > "+n),1))},Al.prototype.pu=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Tu=function(){t._n.ds(function(){return t.inForeground="visible"===t.document.visibilityState,t.Vu()})},this.document.addEventListener("visibilitychange",this.Tu),this.inForeground="visible"===this.document.visibilityState)},Al.prototype.Wu=function(){this.Tu&&(this.document.removeEventListener("visibilitychange",this.Tu),this.Tu=null)},Al.prototype.bu=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.mu=function(){e.Qu(),e._n.ds(function(){return e.Di()})},this.window.addEventListener("unload",this.mu))},Al.prototype.ju=function(){this.mu&&(this.window.removeEventListener("unload",this.mu),this.mu=null)},Al.prototype.Uu=function(t){try{var e=null!==(null===(e=this.gu)||void 0===e?void 0:e.getItem(this.qu(t)));return Rr("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return Or("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},Al.prototype.Qu=function(){if(this.gu)try{this.gu.setItem(this.qu(this.clientId),String(Date.now()))}catch(t){Or("Failed to set zombie client id.",t)}},Al.prototype.Ku=function(){if(this.gu)try{this.gu.removeItem(this.qu(this.clientId))}catch(t){}},Al.prototype.qu=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},Al);function Al(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this._n=i,this.window=o,this.document=s,this._u=a,this.fu=c,this.du=null,this.wu=!1,this.isPrimary=!1,this.networkEnabled=!0,this.mu=null,this.inForeground=!1,this.Tu=null,this.Eu=null,this.Iu=Number.NEGATIVE_INFINITY,this.Au=function(t){return Promise.resolve()},!Al.On())throw new _r(Tr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.ha=new Rl(this,r),this.Ru=e+"main",this.serializer=new ch(u),this.Pu=new Ra(this.Ru,11,new Mh(this.serializer)),this.eo=new yl(this.ha,this.serializer),this.ho=new ll,this.uo=(e=this.serializer,u=this.ho,new Dh(e,u)),this.yu=new ul(this.serializer),this.window&&this.window.localStorage?this.gu=this.window.localStorage:(this.gu=null,!1===c&&Or("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function Nl(t,e){var n=this;return(n=El.call(this)||this).ya=t,n.lu=e,n}function Sl(t){return _l.Un(t,jh.store)}function Dl(t){return _l.Un(t,rl.store)}var Rl=(Ol.prototype.ea=function(t){var n=this.Zu(t);return this.db.zu().ru(t).next(function(e){return n.next(function(t){return e+t})})},Ol.prototype.Zu=function(t){var e=0;return this.sa(t,function(t){e++}).next(function(){return e})},Ol.prototype.De=function(t,e){return this.db.zu().De(t,e)},Ol.prototype.sa=function(t,n){return this.tc(t,function(t,e){return n(e)})},Ol.prototype.au=function(t,e,n){return xl(t,n)},Ol.prototype.cu=function(t,e,n){return xl(t,n)},Ol.prototype.ia=function(t,e,n){return this.db.zu().ia(t,e,n)},Ol.prototype.Va=xl,Ol.prototype.ec=function(t,e){return r=e,i=!1,Nh(n=t).rs(function(t){return Ih(n,t,r).next(function(t){return t&&(i=!0),Da.resolve(!t)})}).next(function(){return i});var n,r,i},Ol.prototype.ra=function(n,r){var i=this,o=this.db.Hu().Jr(),s=[],u=0;return this.tc(n,function(e,t){t<=r&&(t=i.ec(n,e).next(function(t){if(!t)return u++,o.Vr(n,e).next(function(){return o.gr(e),bl(n).delete([0,sh(e.path)])})}),s.push(t))}).next(function(){return Da.$n(s)}).next(function(){return o.apply(n)}).next(function(){return u})},Ol.prototype.removeTarget=function(t,e){e=e.nt(t.lu);return this.db.zu().su(t,e)},Ol.prototype.nc=xl,Ol.prototype.tc=function(t,r){var i,t=bl(t),o=uc.oi;return t.ss({index:$h.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==uc.oi&&r(new Br(ah(i)),o),o=e,i=t):o=uc.oi}).next(function(){o!==uc.oi&&r(new Br(ah(i)),o)})},Ol.prototype.aa=function(t){return this.db.Hu().ka(t)},Ol);function Ol(t,e){this.db=t,this.zo=new rh(this,e)}function xl(t,e){return bl(t).put((t=t.lu,new $h(0,sh(e.path),t)))}function kl(t,e){var n=t.projectId;return t.W||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Ll=(Pl.prototype.Xo=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.oa(t,n.ic)})},Pl);function Pl(t,e,n,r){this.persistence=t,this.sc=e,this.serializer=r,this.ic=new Yi(yi),this.rc=new Di(Gi,qi),this.oc=Oi.min(),this.co=t.Gu(n),this.Yr=t.Hu(),this.eo=t.zu(),this.io=new zc(this.Yr,this.co,this.persistence.Ju()),this.yu=t.Yu(),this.sc.ac(this.io)}function Ul(t,e,n,r){return new Ll(t,e,n,r)}function Cl(t,h){var l=t;return l.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=h.batch.keys(),c=l.Yr.Jr({Xr:!0});return e=l,r=t,o=c,s=(i=h).batch,n=s.keys(),u=Da.resolve(),n.forEach(function(n){u=u.next(function(){return o.Vr(r,n)}).next(function(t){var e=t,t=i.Tr.get(n);Pr(null!==t),(!e||e.version.L(t)<0)&&(e=s.lr(n,e,i))&&o.Rr(e,i.mr)})}),u.next(function(){return e.co.Pa(r,s)}).next(function(){return c.apply(t)}).next(function(){return l.co.pa(t)}).next(function(){return l.io.mo(t,a)})})}function Vl(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.eo.Ya(t)})}function Ml(t,r){var a=t,c=r.et,h=a.ic;return a.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=a.Yr.Jr({Xr:!0});h=a.ic;var u=[];r.Gt.forEach(function(t,e){var n,r,i,o=h.get(e);o&&(u.push(a.eo.uu(s,t.ne,e).next(function(){return a.eo.no(s,t.te,e)})),0<(i=t.resumeToken).O()&&(n=o.st(i,c).nt(s.lu),h=h.rt(e,n),r=o,i=t,Pr(0<(o=n).resumeToken.O()),(0===r.resumeToken.O()||3e8<=o.et.Y()-r.et.Y()||0<i.te.size+i.ee.size+i.ne.size)&&u.push(a.eo.su(s,n))))});var e,n=oo;return r.Ht.forEach(function(t,e){r.Jt.has(t)&&u.push(a.persistence.ha.nc(s,t))}),u.push(Fl(s,t,r.Ht,c,void 0).next(function(t){n=t})),c.isEqual(Oi.min())||(e=a.eo.Ya(s).next(function(t){return a.eo.Za(s,s.lu,c)}),u.push(e)),Da.$n(u).next(function(){return t.apply(s)}).next(function(){return a.io.so(s,n)})}).then(function(t){return a.ic=h,t})}function Fl(t,s,e,u,a){var n=lo();return e.forEach(function(t){return n=n.add(t)}),s.getEntries(t,n).next(function(i){var o=oo;return e.forEach(function(t,e){var n=i.get(t),r=(null==a?void 0:a.get(t))||u;e instanceof Nu&&e.version.isEqual(Oi.min())?(s.gr(t,r),o=o.rt(t,e)):null==n||0<e.version.L(n.version)||0===e.version.L(n.version)&&n.hasPendingWrites?(s.Rr(e,r),o=o.rt(t,e)):Rr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o})}function jl(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.eo.ou(e,r).next(function(t){return t?(n=t,Da.resolve(n)):i.eo.za(e).next(function(t){return n=new Qi(r,t,0,e.lu),i.eo.tu(e,n).next(function(){return n})})})}).then(function(t){var e=i.ic.get(t.targetId);return(null===e||0<t.et.L(e.et))&&(i.ic=i.ic.rt(t.targetId,t),i.rc.set(r,t.targetId)),t})}function Gl(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).ic.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.ha.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Va(r=t.sent()))throw r;return Rr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.ic=e.ic.remove(o),e.rc.delete(n.target),[2]}})})}function ql(t,o,s){var u=t,a=Oi.min(),c=lo();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=ju(o),(void 0!==(t=(i=t).rc.get(r))?Da.resolve(i.ic.get(t)):i.eo.ou(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.eo.hu(e,t.targetId).next(function(t){c=t})}).next(function(){return u.sc.Eo(e,o,s?a:Oi.min(),s?c:lo())}).next(function(t){return{documents:t,uc:c}});var t,n,r,i})}function Bl(t,e){var n=t,r=n.eo,t=n.ic.get(e);return t?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.qe(t,e).next(function(t){return t?t.target:null})})}function zl(t){var s=t;return s.persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.Yr,n=t,t=s.oc,r=e,i=oo,o=fh(t),t=Lh(n),n=IDBKeyRange.lowerBound(o,!0),t.ss({index:Yh.readTimeIndex,range:n},function(t,e){var n=hh(r.serializer,e);i=i.rt(n.key,n),o=e.readTime}).next(function(){return{Wr:i,readTime:ph(o)}});var e,n,r,i,o}).then(function(t){var e=t.Wr,t=t.readTime;return s.oc=t,e})}function Kl(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=Lh(t),r=Oi.min(),t.ss({index:Yh.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=ph(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.oc=t})]})})}function Ql(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Tr.FAILED_PRECONDITION||e.message!==Bc)throw e;return Rr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Hl(t,e){this.user=e,this.type="OAuth",this.Ac={},this.Ac.Authorization="Bearer "+t}function Wl(t,e,n,r,i){var o=this;this.Kr=t,this.Rh=e,this.os=n,this.Ph={},this.yh=[],this.gh=new Map,this.Vh=new Set,this.ph=[],this.bh=i,this.bh.Sh(function(t){n.ds(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Rf(this)?(Rr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Vh.add(4),[4,Ef(e)];case 1:return t.sent(),e.Dh.set("Unknown"),e.Vh.delete(4),[4,bf(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Dh=new af(n,r)}var Xl,Yl,Jl,Zl=(wf.prototype.m=function(){return this.cc.m()},wf.prototype.au=function(t,e){e=new $l(t,e);this.cc=this.cc.add(e),this.lc=this.lc.add(e)},wf.prototype.fc=function(t,e){var n=this;t.forEach(function(t){return n.au(t,e)})},wf.prototype.cu=function(t,e){this.dc(new $l(t,e))},wf.prototype.wc=function(t,e){var n=this;t.forEach(function(t){return n.cu(t,e)})},wf.prototype.mc=function(t){var e=this,n=new Br(new jr([])),r=new $l(n,t),t=new $l(n,t+1),i=[];return this.lc.Nt([r,t],function(t){e.dc(t),i.push(t.key)}),i},wf.prototype.Tc=function(){var e=this;this.cc.forEach(function(t){return e.dc(t)})},wf.prototype.dc=function(t){this.cc=this.cc.delete(t),this.lc=this.lc.delete(t)},wf.prototype.Ec=function(t){var e=new Br(new jr([])),n=new $l(e,t),t=new $l(e,t+1),r=lo();return this.lc.Nt([n,t],function(t){r=r.add(t.key)}),r},wf.prototype.ba=function(t){var e=new $l(t,0),e=this.cc.$t(e);return null!==e&&t.isEqual(e.key)},wf),$l=(mf.hc=function(t,e){return Br.i(t.key,e.key)||yi(t.Ic,e.Ic)},mf._c=function(t,e){return yi(t.Ic,e.Ic)||Br.i(t.key,e.key)},mf),tf=(gf.prototype.getToken=function(){return Promise.resolve(null)},gf.prototype.Pc=function(){},gf.prototype.yc=function(t){(this.Rc=t)(ic.UNAUTHENTICATED)},gf.prototype.gc=function(){this.Rc=null},gf),ef=(vf.prototype.getToken=function(){var e=this,n=this.vc,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.vc!==n?(Rr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Pr("string"==typeof t.accessToken),new Hl(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},vf.prototype.Pc=function(){this.forceRefresh=!0},vf.prototype.yc=function(t){this.Rc=t,this.bc&&t(this.currentUser)},vf.prototype.gc=function(){this.auth&&this.auth.removeAuthTokenListener(this.Vc),this.Vc=null,this.Rc=null},vf.prototype.Sc=function(){var t=this.auth&&this.auth.getUid();return Pr(null===t||"string"==typeof t),new ic(t)},vf),nf=(Object.defineProperty(yf.prototype,"Ac",{get:function(){var t={"X-Goog-AuthUser":this.Cc},e=this.Dc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),yf),rf=(df.prototype.getToken=function(){return Promise.resolve(new nf(this.Dc,this.Cc))},df.prototype.yc=function(t){t(ic.ei)},df.prototype.gc=function(){},df.prototype.Pc=function(){},df),Ee=(pf.prototype.Mc=function(){return 1===this.state||2===this.state||4===this.state},pf.prototype.Oc=function(){return 2===this.state},pf.prototype.start=function(){3!==this.state?this.auth():this.Lc()},pf.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Mc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},pf.prototype.Bc=function(){this.state=0,this.ys.reset()},pf.prototype.qc=function(){var t=this;this.Oc()&&null===this.kc&&(this.kc=this._n.yn(this.Nc,6e4,function(){return t.Uc()}))},pf.prototype.Qc=function(t){this.Wc(),this.stream.send(t)},pf.prototype.Uc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.Oc()?[2,this.close(0)]:[2]})})},pf.prototype.Wc=function(){this.kc&&(this.kc.cancel(),this.kc=null)},pf.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Wc(),this.ys.cancel(),this.xc++,3!==e?this.ys.reset():n&&n.code===Tr.RESOURCE_EXHAUSTED?(Or(n.toString()),Or("Using maximum backoff delay to prevent overloading the backend."),this.ys.An()):n&&n.code===Tr.UNAUTHENTICATED&&this.$c.Pc(),null!==this.stream&&(this.jc(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Kc(n)];case 1:return t.sent(),[2]}})})},pf.prototype.jc=function(){},pf.prototype.auth=function(){var n=this;this.state=1;var t=this.Gc(this.xc),e=this.xc;this.$c.getToken().then(function(t){n.xc===e&&n.zc(t)},function(e){t(function(){var t=new _r(Tr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Hc(t)})})},pf.prototype.zc=function(t){var e=this,n=this.Gc(this.xc);this.stream=this.Jc(t),this.stream.Yc(function(){n(function(){return e.state=2,e.listener.Yc()})}),this.stream.Kc(function(t){n(function(){return e.Hc(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},pf.prototype.Lc=function(){var t=this;this.state=4,this.ys.Rn(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},pf.prototype.Hc=function(t){return Rr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},pf.prototype.Gc=function(e){var n=this;return function(t){n._n.ds(function(){return n.xc===e?t():(Rr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},pf),of=(n(ff,Jl=Ee),ff.prototype.Jc=function(t){return this.Fc.Xc("Listen",t)},ff.prototype.onMessage=function(t){this.ys.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Lr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Ue?(Pr(void 0===o||"string"==typeof o),mi.fromBase64String(o||"")):(Pr(void 0===o||o instanceof Uint8Array),mi.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Tr.UNKNOWN:Xi(s.code),new _r(o,s.message||"")),r=new Eo(n,r,i,s||null)}else if("documentChange"in e){e.documentChange;var u=e.documentChange;u.document,u.document.name,u.document.updateTime;var i=cs(t,u.document.name),a=os(u.document.updateTime),s=new vu({mapValue:{fields:u.document.fields}}),a=new Au(i,a,s,{}),s=u.targetIds||[],u=u.removedTargetIds||[];r=new wo(s,u,a.key,a)}else if("documentDelete"in e){e.documentDelete;u=e.documentDelete;u.document;var a=cs(t,u.document),c=u.readTime?os(u.readTime):Oi.min(),c=new Nu(a,c),u=u.removedTargetIds||[];r=new wo([],u,c.key,c)}else if("documentRemove"in e){e.documentRemove;c=e.documentRemove;c.document;var h=cs(t,c.document),c=c.removedTargetIds||[];r=new wo([],c,h,null)}else{if(!("filter"in e))return Lr();e.filter;h=e.filter;h.targetId;e=h.count||0,e=new zi(e),h=h.targetId;r=new bo(h,e)}return r}(this.serializer,t),t=function(t){if(!("targetChange"in t))return Oi.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?os(t.readTime):Oi.min()}(t);return this.listener.Zc(e,t)},ff.prototype.th=function(t){var e,n,r,i={};i.database=fs(this.serializer),i.addTarget=(e=this.serializer,(r=Bi(r=(n=t).target)?{documents:ms(e,r)}:{query:ws(e,r)}).targetId=n.targetId,0<n.resumeToken.O()?r.resumeToken=is(e,n.resumeToken):0<n.et.L(Oi.min())&&(r.readTime=rs(e,n.et.X())),r);var o,t=(this.serializer,o=t,null==(t=function(){switch(o.tt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Lr()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.Qc(i)},ff.prototype.eh=function(t){var e={};e.database=fs(this.serializer),e.removeTarget=t,this.Qc(e)},ff),sf=(n(lf,Yl=Ee),Object.defineProperty(lf.prototype,"sh",{get:function(){return this.nh},enumerable:!1,configurable:!0}),lf.prototype.start=function(){this.nh=!1,this.lastStreamToken=void 0,Yl.prototype.start.call(this)},lf.prototype.jc=function(){this.nh&&this.ih([])},lf.prototype.Jc=function(t){return this.Fc.Xc("Write",t)},lf.prototype.onMessage=function(t){if(Pr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.nh){this.ys.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Pr(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?os(t.updateTime):os(e);n.isEqual(Oi.min())&&(n=os(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new Hs(n,e)}(t,r)})):[]),n=os(t.commitTime);return this.listener.rh(n,e)}var n,r;return Pr(!t.writeResults||0===t.writeResults.length),this.nh=!0,this.listener.oh()},lf.prototype.ah=function(){var t={};t.database=fs(this.serializer),this.Qc(t)},lf.prototype.ih=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return vs(e.serializer,t)})};this.Qc(t)},lf),uf=(n(hf,Xl=function(){}),hf.prototype.hh=function(){if(this.uh)throw new _r(Tr.FAILED_PRECONDITION,"The client has already been terminated.")},hf.prototype.lh=function(e,n,r){var i=this;return this.hh(),this.credentials.getToken().then(function(t){return i.Fc.lh(e,n,r,t)}).catch(function(t){throw t.code===Tr.UNAUTHENTICATED&&i.credentials.Pc(),t})},hf.prototype._h=function(e,n,r){var i=this;return this.hh(),this.credentials.getToken().then(function(t){return i.Fc._h(e,n,r,t)}).catch(function(t){throw t.code===Tr.UNAUTHENTICATED&&i.credentials.Pc(),t})},hf.prototype.terminate=function(){this.uh=!1},hf),af=(cf.prototype.mh=function(){var t=this;0===this.fh&&(this.Th("Unknown"),this.dh=this.os.yn("online_state_timeout",1e4,function(){return t.dh=null,t.Eh("Backend didn't respond within 10 seconds."),t.Th("Offline"),Promise.resolve()}))},cf.prototype.Ih=function(t){"Online"===this.state?this.Th("Unknown"):(this.fh++,1<=this.fh&&(this.Ah(),this.Eh("Connection failed 1 times. Most recent error: "+t.toString()),this.Th("Offline")))},cf.prototype.set=function(t){this.Ah(),this.fh=0,"Online"===t&&(this.wh=!1),this.Th(t)},cf.prototype.Th=function(t){t!==this.state&&(this.state=t,this.fi(t))},cf.prototype.Eh=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.wh?(Or(t),this.wh=!1):Rr("OnlineStateTracker",t)},cf.prototype.Ah=function(){null!==this.dh&&(this.dh.cancel(),this.dh=null)},cf);function cf(t,e){this.os=t,this.fi=e,this.state="Unknown",this.fh=0,this.dh=null,this.wh=!0}function hf(t,e,n){var r=this;return(r=Xl.call(this)||this).credentials=t,r.Fc=e,r.serializer=n,r.uh=!1,r}function lf(t,e,n,r,i){var o=this;return(o=Yl.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.nh=!1,o}function ff(t,e,n,r,i){var o=this;return(o=Jl.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function pf(t,e,n,r,i,o){this._n=t,this.Nc=n,this.Fc=r,this.$c=i,this.listener=o,this.state=0,this.xc=0,this.kc=null,this.stream=null,this.ys=new Sa(t,e)}function df(t,e){this.Dc=t,this.Cc=e}function yf(t,e){this.Dc=t,this.Cc=e,this.type="FirstParty",this.user=ic.ei}function vf(t){var e=this;this.Vc=null,this.currentUser=ic.UNAUTHENTICATED,this.bc=!1,this.vc=0,this.Rc=null,this.forceRefresh=!1,this.Vc=function(){e.vc++,e.currentUser=e.Sc(),e.bc=!0,e.Rc&&e.Rc(e.currentUser)},this.vc=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Vc):(this.Vc(null),t.get().then(function(t){e.auth=t,e.Vc&&e.auth.addAuthTokenListener(e.Vc)},function(){}))}function gf(){this.Rc=null}function mf(t,e){this.key=t,this.Ic=e}function wf(){this.cc=new ro($l.hc),this.lc=new ro($l._c)}function bf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!Rf(r))return[3,4];e=0,n=r.ph,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Ef(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.ph,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function If(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Rr("RemoteStore","RemoteStore shutting down."),e.Vh.add(5),[4,Ef(e)];case 1:return t.sent(),e.bh.Di(),e.Dh.set("Unknown"),[2]}})})}function Tf(t,e){t.gh.has(e.targetId)||(t.gh.set(e.targetId,e),Df(t)?Sf(t):Mf(t).Oc()&&Af(t,e))}function _f(t,e){var n=t,t=Mf(n);n.gh.delete(e),t.Oc()&&Nf(n,e),0===n.gh.size&&(t.Oc()?t.qc():Rf(n)&&n.Dh.set("Unknown"))}function Af(t,e){t.Ch.Ee(e.targetId),Mf(t).th(e)}function Nf(t,e){t.Ch.Ee(e),Mf(t).eh(e)}function Sf(e){e.Ch=new To({Be:function(t){return e.Ph.Be(t)},qe:function(t){return e.gh.get(t)||null}}),Mf(e).start(),e.Dh.mh()}function Df(t){return Rf(t)&&!Mf(t).Mc()&&0<t.gh.size}function Rf(t){return 0===t.Vh.size}function Of(t){t.Ch=void 0}function xf(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Dh.set("Online"),!(u instanceof Eo&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.gh.has(i)?[4,o.Ph.Nh(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.gh.delete(i),o.Ch.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Rr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,kf(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof wo?s.Ch.pe(u):u instanceof bo?s.Ch.$e(u):s.Ch.Se(u),a.isEqual(Oi.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Vl(s.Kr)];case 8:return o=t.sent(),0<=a.L(o)?[4,(i=a,(e=(r=s).Ch.Me(i)).Gt.forEach(function(t,e){var n;0<t.resumeToken.O()&&((n=r.gh.get(e))&&r.gh.set(e,n.st(t.resumeToken,i)))}),e.zt.forEach(function(t){var e=r.gh.get(t);e&&(r.gh.set(t,e.st(mi.B,e.et)),Nf(r,t),e=new Qi(e.target,t,1,e.sequenceNumber),Af(r,e))}),r.Ph.Fh(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Rr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,kf(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function kf(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!Va(r))throw r;return n.Vh.add(1),[4,Ef(n)];case 1:return t.sent(),n.Dh.set("Offline"),i=i||function(){return Vl(n.Kr)},n.os.Ds(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Rr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Vh.delete(1),[4,bf(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function Lf(e,n){return n().catch(function(t){return kf(e,t,n)})}function Pf(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=Ff(i=a),s=0<i.yh.length?i.yh[i.yh.length-1].batchId:-1,t.label=1;case 1:if(!(Rf(i)&&i.yh.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.Kr,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.co.Ea(t,n)}))];case 3:return null===(u=t.sent())?(0===i.yh.length&&o.qc(),[3,7]):(s=u.batchId,function(t,e){t.yh.push(e);t=Ff(t);t.Oc()&&t.sh&&t.ih(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,kf(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Uf(i)&&Cf(i),[2]}var e,n,r})})}function Uf(t){return Rf(t)&&!Ff(t).Mc()&&0<t.yh.length}function Cf(t){Ff(t).start()}function Vf(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Vh.delete(2),[4,bf(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Vh.add(2),[4,Ef(e)]);case 3:t.sent(),e.Dh.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function Mf(n){var t,e,r,i=this;return n.kh||(n.kh=(t=n.Rh,e=n.os,r={Yc:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.gh.forEach(function(t,e){Af(n,t)}),[2]})})}.bind(null,n),Kc:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return Of(e),Df(e)?(e.Dh.Ih(n),Sf(e)):e.Dh.set("Unknown"),[2]})})}.bind(null,n),Zc:xf.bind(null,n)},t.hh(),new of(e,t.Fc,t.credentials,t.serializer,r)),n.ph.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.kh.Bc(),Df(n)?Sf(n):n.Dh.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.kh.stop()];case 2:t.sent(),Of(n),t.label=3;case 3:return[2]}})})})),n.kh}function Ff(n){var t,e,r,i=this;return n.Mh||(n.Mh=(t=n.Rh,e=n.os,r={Yc:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Ff(e).ah(),[2]})})}.bind(null,n),Kc:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Ff(e).sh?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Wi(n=i.code)&&n!==Tr.ABORTED?(e=r.yh.shift(),Ff(r).Bc(),[4,Lf(r,function(){return r.Ph.xh(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,Pf(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Uf(e)&&Cf(e),[2]}})})}.bind(null,n),oh:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Ff(o),n=0,r=o.yh;n<r.length;n++)i=r[n],e.ih(i.mutations);return[2]})})}.bind(null,n),rh:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.yh.shift(),n=bc.from(e,i,o),[4,Lf(r,function(){return r.Ph.$h(n)})];case 1:return t.sent(),[4,Pf(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.hh(),new sf(e,t.Fc,t.credentials,t.serializer,r)),n.ph.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Mh.Bc(),[4,Pf(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Mh.stop()];case 3:t.sent(),0<n.yh.length&&(Rr("RemoteStore","Stopping write stream with "+n.yh.length+" pending writes"),n.yh=[]),t.label=4;case 4:return[2]}})})})),n.Mh}var jf=function(t){this.key=t},Gf=function(t){this.key=t},qf=(Object.defineProperty(Hf.prototype,"Qh",{get:function(){return this.Oh},enumerable:!1,configurable:!0}),Hf.prototype.Wh=function(t,e){var s=this,u=e?e.jh:new yo,a=(e||this).Uh,c=(e||this).Qt,h=a,l=!1,f=Pu(this.query)&&a.size===this.query.limit?a.last():null,p=Uu(this.query)&&a.size===this.query.limit?a.first():null;if(t.ct(function(t,e){var n=a.get(t),r=(r=e instanceof Au?e:null)&&(Hu(s.query,r)?r:null),i=!!n&&s.Qt.has(n.key),o=!!r&&(r.Je||s.Qt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.Kh(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.qh(r,f)||p&&s.qh(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),Pu(this.query)||Uu(this.query))for(;h.size>this.query.limit;){var n=Pu(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{Uh:h,jh:u,Gh:l,Qt:c}},Hf.prototype.Kh=function(t,e){return t.Je&&e.hasCommittedMutations&&!e.Je},Hf.prototype.vr=function(t,e,n){var o=this,r=this.Uh;this.Uh=t.Uh,this.Qt=t.Qt;var i=t.jh.qt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.qh(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Lr()}}var r,i}),this.zh(n);var s=e?this.Hh():[],n=0===this.Bh.size&&this.Zt?1:0,e=n!==this.Lh;return this.Lh=n,0!==i.length||e?{snapshot:new vo(this.query,t.Uh,r,i,t.Qt,0==n,e,!1),Jh:s}:{Jh:s}},Hf.prototype.Us=function(t){return this.Zt&&"Offline"===t?(this.Zt=!1,this.vr({Uh:this.Uh,jh:new yo,Qt:this.Qt,Gh:!1},!1)):{Jh:[]}},Hf.prototype.Yh=function(t){return!this.Oh.has(t)&&!!this.Uh.has(t)&&!this.Uh.get(t).Je},Hf.prototype.zh=function(t){var e=this;t&&(t.te.forEach(function(t){return e.Oh=e.Oh.add(t)}),t.ee.forEach(function(t){}),t.ne.forEach(function(t){return e.Oh=e.Oh.delete(t)}),this.Zt=t.Zt)},Hf.prototype.Hh=function(){var e=this;if(!this.Zt)return[];var n=this.Bh;this.Bh=lo(),this.Uh.forEach(function(t){e.Yh(t.key)&&(e.Bh=e.Bh.add(t.key))});var r=[];return n.forEach(function(t){e.Bh.has(t)||r.push(new Gf(t))}),this.Bh.forEach(function(t){n.has(t)||r.push(new jf(t))}),r},Hf.prototype.Xh=function(t){this.Oh=t.uc,this.Bh=lo();t=this.Wh(t.documents);return this.vr(t,!0)},Hf.prototype.Zh=function(){return vo.Kt(this.query,this.Uh,this.Qt,0===this.Lh)},Hf),Bf=function(t,e,n){this.query=t,this.targetId=e,this.view=n},zf=function(t){this.key=t,this.tl=!1},Kf=(Object.defineProperty(Qf.prototype,"ml",{get:function(){return!0===this.wl},enumerable:!1,configurable:!0}),Qf);function Qf(t,e,n,r,i,o){this.Kr=t,this.el=e,this.nl=n,this.sl=r,this.currentUser=i,this.il=o,this.rl={},this.ol=new Di(Ku,zu),this.al=new Map,this.ul=[],this.cl=new Yi(Br.i),this.hl=new Map,this.ll=new Zl,this._l={},this.fl=new Map,this.dl=dl.Ga(),this.onlineState="Unknown",this.wl=void 0}function Hf(t,e){this.query=t,this.Oh=e,this.Lh=null,this.Zt=!1,this.Bh=lo(),this.Qt=lo(),this.qh=Wu(t),this.Uh=new po(this.qh)}function Wf(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Tl=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.Wh(o)).Gh?[4,ql(r.Kr,i.query,!1).then(function(t){t=t.documents;return i.view.Wh(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.Gt.get(i.targetId),n=i.view.vr(e,r.ml,n),[2,(np(r,i.targetId,n.Jh),n.snapshot)]}})})}(i,t,e,n)},[4,ql(i.Kr,o,!0)];case 1:return n=t.sent(),r=new qf(o,n.uc),e=r.Wh(n.documents),n=mo.Xt(s,u&&"Offline"!==i.onlineState),n=r.vr(e,i.ml,n),np(i,s,n.Jh),r=new Bf(o,s,r),[2,(i.ol.set(o,r),i.al.has(s)?i.al.get(s).push(o):i.al.set(s,[o]),n.snapshot)]}})})}function Xf(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Ml(n.Kr,i)];case 2:return e=t.sent(),i.Gt.forEach(function(t,e){e=n.hl.get(e);e&&(Pr(t.te.size+t.ee.size+t.ne.size<=1),0<t.te.size?e.tl=!0:0<t.ee.size?Pr(e.tl):0<t.ne.size&&(Pr(e.tl),e.tl=!1))}),[4,ip(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,Ql(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function Yf(t,n,e){var r,t=t;(t.ml&&0===e||!t.ml&&1===e)&&(r=[],t.ol.forEach(function(t,e){e=e.view.Us(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.Ls.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Us(i)&&(o=!0)}),o&&nc(t)}(t.nl,n),r.length&&t.rl.Zc(r),t.onlineState=n,t.ml&&t.sl.Ki(n))}function Jf(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Kr,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.co.ma(e,r).next(function(t){return Pr(null!==t),n=t.keys(),i.co.Pa(e,t)}).next(function(){return i.co.pa(e)}).next(function(){return i.io.mo(e,n)})}))];case 2:return o=t.sent(),$f(n,u,a),Zf(n,u),n.sl.ki(u,"rejected",a),[4,ip(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Ql(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}function Zf(t,e){(t.fl.get(e)||[]).forEach(function(t){t.resolve()}),t.fl.delete(e)}function $f(t,e,n){var r=t,i=r._l[r.currentUser.Zs()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r._l[r.currentUser.Zs()]=i)}function tp(e,t,n){void 0===n&&(n=null),e.sl.Bi(t);for(var r=0,i=e.al.get(t);r<i.length;r++){var o=i[r];e.ol.delete(o),n&&e.rl.El(o,n)}e.al.delete(t),e.ml&&e.ll.mc(t).forEach(function(t){e.ll.ba(t)||ep(e,t)})}function ep(t,e){var n=t.cl.get(e);null!==n&&(_f(t.el,n),t.cl=t.cl.remove(e),t.hl.delete(n),rp(t))}function np(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof jf?(t.ll.au(o.key,e),function(t,e){e=e.key;t.cl.get(e)||(Rr("SyncEngine","New document in limbo: "+e),t.ul.push(e),rp(t))}(t,o)):o instanceof Gf?(Rr("SyncEngine","Document no longer in limbo: "+o.key),t.ll.cu(o.key,e),t.ll.ba(o.key)||ep(t,o.key)):Lr()}}function rp(t){for(;0<t.ul.length&&t.cl.size<t.il;){var e=t.ul.shift(),n=t.dl.next();t.hl.set(n,new zf(e)),t.cl=t.cl.rt(e,n),Tf(t.el,new Qi(ju(Lu(e.path)),n,2,uc.oi))}}function ip(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).ol.m()?[3,3]:(n.ol.forEach(function(t,e){o.push(n.Tl(e,s,u).then(function(t){t&&(n.ml&&n.sl.Qi(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=Kc.vo(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.rl.Zc(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Da.forEach(c,function(e){return Da.forEach(e.po,function(t){return r.persistence.ha.au(n,e.targetId,t)}).next(function(){return Da.forEach(e.bo,function(t){return r.persistence.ha.cu(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Va(e=t.sent()))throw e;return Rr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.ic.get(o),u=s.et,u=s.it(u),r.ic=r.ic.rt(o,u));return[2]}})})}(n.Kr,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function op(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Rr("SyncEngine","User change. New user:",o.Zs()),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).co,m=e.io,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.co.Aa(v).next(function(t){return g=t,n=e.persistence.Gu(o),m=new zc(e.Yr,n,e.persistence.Ju()),n.Aa(v)}).next(function(t){for(var e=[],n=[],r=lo(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,l=t;h<l.length;h++){var f=l[h];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.mo(v,r).next(function(t){return{Il:t,Al:e,Rl:n}})})})];case 1:return r=t.sent(),[2,(e.co=n,e.io=m,e.sc.ac(e.io),r)]}})})}(n.Kr,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).fl.forEach(function(t){t.forEach(function(t){t.reject(new _r(Tr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.fl.clear(),n.sl.ji(o,r.Al,r.Rl),[4,ip(n,r.Il)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}function sp(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).Kr,n=a,i=(r=e).co,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Ta(e,n).next(function(t){return t?r.io.mo(e,t):Da.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,Pf(o.el)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?($f(o,a,h||null),Zf(o,a),o.Kr.co.ga(a)):Lr(),t.label=4;case 4:return[4,ip(o,s)];case 5:return t.sent(),[3,7];case 6:Rr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}function up(h,l){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return hp(r=h),lp(r),!0!==l||!0===r.wl?[3,3]:(e=r.sl.Ci(),[4,ap(r,e.A())]);case 1:return i=t.sent(),r.wl=!0,[4,Vf(r.el,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],Tf(r.el,u);return[3,7];case 3:return!1!==l||!1===r.wl?[3,7]:(a=[],c=Promise.resolve(),r.al.forEach(function(t,e){r.sl.qi(e)?a.push(e):c=c.then(function(){return tp(r,e),Gl(r.Kr,e,!0)}),_f(r.el,e)}),[4,c]);case 4:return t.sent(),[4,ap(r,a)];case 5:return t.sent(),(n=r).hl.forEach(function(t,e){_f(n.el,e)}),n.ll.Tc(),n.hl=new Map,n.cl=new Yi(Br.i),r.wl=!1,[4,Vf(r.el,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}function ap(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,l,f;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.al.get(s))&&0!==a.length?[4,jl(e.Kr,ju(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(l=h[c],l=e.ol.get(l),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,ql((e=r).Kr,i.query,!0)];case 1:return n=t.sent(),n=i.view.Xh(n),[2,(e.ml&&np(e,i.targetId,n.Jh),n)]}})})}(e,l)]):[3,6];case 4:(l=t.sent()).snapshot&&r.push(l.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,Bl(e.Kr,s)];case 8:return f=t.sent(),[4,jl(e.Kr,f)];case 9:return u=t.sent(),[4,Wf(e,cp(f),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.rl.Zc(r),n)]}})})}function cp(t){return ku(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function hp(t){return t.el.Ph.Fh=Xf.bind(null,t),t.el.Ph.Be=function(t,e){var n=t;if((t=n.hl.get(e))&&t.tl)return lo().add(t.key);var r=lo();if(!(e=n.al.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.ol.get(s),r=r.xt(s.view.Qh);return r}.bind(null,t),t.el.Ph.Nh=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).sl.Qi(s,"rejected",u),i=e.hl.get(s),(n=i&&i.key)?(r=(r=new Yi(Br.i)).rt(n,new Nu(n,Oi.min())),i=lo().add(n),i=new go(Oi.min(),new Map,new ro(yi),r,i),[4,Xf(e,i)]):[3,2];case 1:return t.sent(),e.cl=e.cl.remove(n),e.hl.delete(s),rp(e),[3,4];case 2:return[4,Gl(e.Kr,s,!1).then(function(){return tp(e,s,u)}).catch(Ql)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.rl.Zc=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.Ls.get(u);if(u){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Qs(s)&&(r=!0);u.Os=s}}r&&nc(n)}.bind(null,t.nl),t.rl.El=function(t,e,n){var r=t;if(t=r.Ls.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.Ls.delete(e)}.bind(null,t.nl),t}function lp(t){return t.el.Ph.$h=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Cl(e.Kr,o)];case 2:return r=t.sent(),$f(e,n,null),Zf(e,n),e.sl.ki(n,"acknowledged"),[4,ip(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,Ql(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,t),t.el.Ph.xh=Jf.bind(null,t),t}function fp(t,e,n){var r=t;(function(f,p,d){return y(this,void 0,void 0,function(){var u,a,c,h,l;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,14,,15]),[4,p.getMetadata()];case 1:return u=t.sent(),[4,(r=f.Kr,i=u,s=new Cc((o=r).serializer).Qr(i.createTime),o.persistence.runTransaction("hasNewerBundle","readonly",function(t){return o.yu.Ba(t,i.id)}).then(function(t){return!!t&&0<=t.createTime.L(s)}))];case 2:return t.sent()?[4,p.close()]:[3,4];case 3:return[2,(t.sent(),void d.Pl({taskState:"Success",documentsLoaded:u.totalDocuments,bytesLoaded:u.totalBytes,totalDocuments:u.totalDocuments,totalBytes:u.totalBytes}))];case 4:return d.yl(jc(u)),a=new qc(u,f.Kr,p.serializer),[4,p.$r()];case 5:c=t.sent(),t.label=6;case 6:return c?[4,a.Gr(c)]:[3,10];case 7:return(h=t.sent())&&d.yl(h),[4,p.$r()];case 8:c=t.sent(),t.label=9;case 9:return[3,6];case 10:return[4,a.complete()];case 11:return l=t.sent(),[4,ip(f,l.Wr,void 0)];case 12:return t.sent(),[4,(r=f.Kr,e=u,(n=r).persistence.runTransaction("Save bundle","readwrite",function(t){return n.yu.qa(t,e)}))];case 13:return t.sent(),d.Pl(l.progress),[3,15];case 14:return l=t.sent(),d.gl(l),[3,15];case 15:return[2]}var e,n,r,i,o,s})})})(r,e,n).then(function(){r.sl.zi()})}var pp,dp,yp,vp,gp,mp,wp,bp=(hd.prototype.ac=function(t){this.Vl=t},hd.prototype.Eo=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.rn.length||1===r.rn.length&&r.rn[0].field.p())||i.isEqual(Oi.min())?this.pl(e,r):this.Vl.mo(e,o).next(function(t){var n=s.bl(r,t);return(Pu(r)||Uu(r))&&s.Gh(r.on,n,o,i)?s.pl(e,r):(Dr()<=f.DEBUG&&Rr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Qu(r)),s.Vl.Eo(e,r,i).next(function(e){return n.forEach(function(t){e=e.rt(t.key,t)}),e}))})},hd.prototype.bl=function(n,t){var r=new ro(Wu(n));return t.forEach(function(t,e){e instanceof Au&&Hu(n,e)&&(r=r.add(e))}),r},hd.prototype.Gh=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.L(r))},hd.prototype.pl=function(t,e){return Dr()<=f.DEBUG&&Rr("IndexFreeQueryEngine","Using full collection scan to execute query:",Qu(e)),this.Vl.Eo(t,e,Oi.min())},hd),Ep=(cd.prototype.fa=function(t){return Da.resolve(0===this.co.length)},cd.prototype.da=function(t,e,n,r){var i=this.vl;this.vl++,0<this.co.length&&this.co[this.co.length-1];n=new wc(i,e,n,r);this.co.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Sl=this.Sl.add(new $l(u.key,i)),this.ho.wa(t,u.key.path.h())}return Da.resolve(n)},cd.prototype.ma=function(t,e){return Da.resolve(this.Dl(e))},cd.prototype.Ea=function(t,e){e+=1,e=this.Cl(e),e=e<0?0:e;return Da.resolve(this.co.length>e?this.co[e]:null)},cd.prototype.Ia=function(){return Da.resolve(0===this.co.length?-1:this.vl-1)},cd.prototype.Aa=function(t){return Da.resolve(this.co.slice())},cd.prototype._o=function(t,e){var n=this,r=new $l(e,0),e=new $l(e,Number.POSITIVE_INFINITY),i=[];return this.Sl.Nt([r,e],function(t){t=n.Dl(t.Ic);i.push(t)}),Da.resolve(i)},cd.prototype.To=function(t,e){var n=this,r=new ro(yi);return e.forEach(function(t){var e=new $l(t,0),t=new $l(t,Number.POSITIVE_INFINITY);n.Sl.Nt([e,t],function(t){r=r.add(t.Ic)})}),Da.resolve(this.Nl(r))},cd.prototype.yo=function(t,e){var n=e.path,r=n.length+1,e=n;Br.F(e)||(e=e.child(""));var e=new $l(new Br(e),0),i=new ro(yi);return this.Sl.Ft(function(t){var e=t.key.path;return!!n.T(e)&&(e.length===r&&(i=i.add(t.Ic)),!0)},e),Da.resolve(this.Nl(i))},cd.prototype.Nl=function(t){var e=this,n=[];return t.forEach(function(t){t=e.Dl(t);null!==t&&n.push(t)}),n},cd.prototype.Pa=function(n,r){var i=this;Pr(0===this.Fl(r.batchId,"removed")),this.co.shift();var o=this.Sl;return Da.forEach(r.mutations,function(t){var e=new $l(t.key,r.batchId);return o=o.delete(e),i.ha.Va(n,t.key)}).next(function(){i.Sl=o})},cd.prototype.ga=function(t){},cd.prototype.ba=function(t,e){var n=new $l(e,0),n=this.Sl.$t(n);return Da.resolve(e.isEqual(n&&n.key))},cd.prototype.pa=function(t){return this.co.length,Da.resolve()},cd.prototype.Fl=function(t,e){return this.Cl(t)},cd.prototype.Cl=function(t){return 0===this.co.length?0:t-this.co[0].batchId},cd.prototype.Dl=function(t){t=this.Cl(t);return t<0||t>=this.co.length?null:this.co[t]},cd),Ip=(ad.prototype.Rr=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.$l(e);return this.docs=this.docs.rt(r,{yr:e,size:i,readTime:n}),this.size+=i-o,this.ho.wa(t,r.path.h())},ad.prototype.gr=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},ad.prototype.Vr=function(t,e){e=this.docs.get(e);return Da.resolve(e?e.yr:null)},ad.prototype.getEntries=function(t,e){var n=this,r=oo;return e.forEach(function(t){var e=n.docs.get(t);r=r.rt(t,e?e.yr:null)}),Da.resolve(r)},ad.prototype.Eo=function(t,e,n){for(var r=ao,i=new Br(e.path.child("")),o=this.docs._t(i);o.It();){var s=o.Et(),u=s.key,a=s.value,s=a.yr,a=a.readTime;if(!e.path.T(u.path))break;a.L(n)<=0||s instanceof Au&&Hu(e,s)&&(r=r.rt(s.key,s))}return Da.resolve(r)},ad.prototype.xl=function(t,e){return Da.forEach(this.docs,function(t){return e(t)})},ad.prototype.Jr=function(t){return new Tp(this)},ad.prototype.ka=function(t){return Da.resolve(this.size)},ad),Tp=(n(ud,wp=h),ud.prototype.vr=function(n){var r=this,i=[];return this.Er.forEach(function(t,e){e&&e.yr?i.push(r.Ma.Rr(n,e.yr,r.Ar(t))):r.Ma.gr(t)}),Da.$n(i)},ud.prototype.pr=function(t,e){return this.Ma.Vr(t,e)},ud.prototype.br=function(t,e){return this.Ma.getEntries(t,e)},ud),_p=(sd.prototype.De=function(t,n){return this.kl.forEach(function(t,e){return n(e)}),Da.resolve()},sd.prototype.Ya=function(t){return Da.resolve(this.lastRemoteSnapshotVersion)},sd.prototype.Xa=function(t){return Da.resolve(this.Ml)},sd.prototype.za=function(t){return this.highestTargetId=this.Ll.next(),Da.resolve(this.highestTargetId)},sd.prototype.Za=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Ml&&(this.Ml=e),Da.resolve()},sd.prototype.eu=function(t){this.kl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Ll=new dl(e),this.highestTargetId=e),t.sequenceNumber>this.Ml&&(this.Ml=t.sequenceNumber)},sd.prototype.tu=function(t,e){return this.eu(e),this.targetCount+=1,Da.resolve()},sd.prototype.su=function(t,e){return this.eu(e),Da.resolve()},sd.prototype.iu=function(t,e){return this.kl.delete(e.target),this.Ol.mc(e.targetId),--this.targetCount,Da.resolve()},sd.prototype.ia=function(n,r,i){var o=this,s=0,u=[];return this.kl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.kl.delete(t),u.push(o.Zr(n,e.targetId)),s++)}),Da.$n(u).next(function(){return s})},sd.prototype.ru=function(t){return Da.resolve(this.targetCount)},sd.prototype.ou=function(t,e){e=this.kl.get(e)||null;return Da.resolve(e)},sd.prototype.no=function(t,e,n){return this.Ol.fc(e,n),Da.resolve()},sd.prototype.uu=function(e,t,n){this.Ol.wc(t,n);var r=this.persistence.ha,i=[];return r&&t.forEach(function(t){i.push(r.Va(e,t))}),Da.$n(i)},sd.prototype.Zr=function(t,e){return this.Ol.mc(e),Da.resolve()},sd.prototype.hu=function(t,e){e=this.Ol.Ec(e);return Da.resolve(e)},sd.prototype.ba=function(t,e){return Da.resolve(this.Ol.ba(e))},sd),Ap=(od.prototype.Ba=function(t,e){return Da.resolve(this.Bl.get(e))},od.prototype.qa=function(t,e){return this.Bl.set(e.id,{id:e.id,version:e.version,createTime:os(e.createTime)}),Da.resolve()},od.prototype.Ua=function(t,e){return Da.resolve(this.ql.get(e))},od.prototype.Qa=function(t,e){return this.ql.set(e.name,{name:(e=e).name,query:wh(e.bundledQuery),readTime:os(e.readTime)}),Da.resolve()},od),Np=(id.prototype.start=function(){return Promise.resolve()},id.prototype.Di=function(){return this.wu=!1,Promise.resolve()},Object.defineProperty(id.prototype,"Ti",{get:function(){return this.wu},enumerable:!1,configurable:!0}),id.prototype.Du=function(){},id.prototype.Cu=function(){},id.prototype.Ju=function(){return this.ho},id.prototype.Gu=function(t){var e=this.Ul[t.Zs()];return e||(e=new Ep(this.ho,this.ha),this.Ul[t.Zs()]=e),e},id.prototype.zu=function(){return this.eo},id.prototype.Hu=function(){return this.uo},id.prototype.Yu=function(){return this.yu},id.prototype.runTransaction=function(t,e,n){var r=this;Rr("MemoryPersistence","Starting transaction:",t);var i=new Sp(this.du.next());return this.ha.Wl(),n(i).next(function(t){return r.ha.jl(i).next(function(){return t})}).Nn().then(function(t){return i.ao(),t})},id.prototype.Kl=function(e,n){return Da.xn(Object.values(this.Ul).map(function(t){return function(){return t.ba(e,n)}}))},id),Sp=(n(rd,mp=Ie),rd),Dp=(nd.Hl=function(t){return new nd(t)},Object.defineProperty(nd.prototype,"Jl",{get:function(){if(this.zl)return this.zl;throw Lr()},enumerable:!1,configurable:!0}),nd.prototype.au=function(t,e,n){return this.Gl.au(n,e),this.Jl.delete(n.toString()),Da.resolve()},nd.prototype.cu=function(t,e,n){return this.Gl.cu(n,e),this.Jl.add(n.toString()),Da.resolve()},nd.prototype.Va=function(t,e){return this.Jl.add(e.toString()),Da.resolve()},nd.prototype.removeTarget=function(t,e){var n=this;this.Gl.mc(e.targetId).forEach(function(t){return n.Jl.add(t.toString())});var r=this.persistence.zu();return r.hu(t,e.targetId).next(function(t){t.forEach(function(t){return n.Jl.add(t.toString())})}).next(function(){return r.iu(t,e)})},nd.prototype.Wl=function(){this.zl=new Set},nd.prototype.jl=function(n){var r=this,i=this.persistence.Hu().Jr();return Da.forEach(this.Jl,function(t){var e=Br.D(t);return r.Yl(n,e).next(function(t){t||i.gr(e)})}).next(function(){return r.zl=null,i.apply(n)})},nd.prototype.nc=function(t,e){var n=this;return this.Yl(t,e).next(function(t){t?n.Jl.delete(e.toString()):n.Jl.add(e.toString())})},nd.prototype.Ql=function(t){return 0},nd.prototype.Yl=function(t,e){var n=this;return Da.xn([function(){return Da.resolve(n.Gl.ba(e))},function(){return n.persistence.zu().ba(t,e)},function(){return n.persistence.Kl(t,e)}])},nd),Rp=(ed.prototype.Yc=function(t){this.t_=t},ed.prototype.Kc=function(t){this.e_=t},ed.prototype.onMessage=function(t){this.n_=t},ed.prototype.close=function(){this.Zl()},ed.prototype.send=function(t){this.Xl(t)},ed.prototype.s_=function(){this.t_()},ed.prototype.i_=function(t){this.e_(t)},ed.prototype.r_=function(t){this.n_(t)},ed),Op={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},xp=(td.prototype.lh=function(e,t,n,r){var i=this.c_(e,t);Rr("RestConnection","Sending: ",i,n);t={};return this.h_(t,r),this.l_(e,i,t,n).then(function(t){return Rr("RestConnection","Received: ",t),t},function(t){throw xr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},td.prototype._h=function(t,e,n,r){return this.lh(t,e,n,r)},td.prototype.h_=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.22.1-alpha.6b865e005",t["Content-Type"]="text/plain",e)for(var n in e.Ac)e.Ac.hasOwnProperty(n)&&(t[n]=e.Ac[n])},td.prototype.c_=function(t,e){t=Op[t];return this.a_+"/v1/"+e+":"+t},n($p,gp=td),$p.prototype.l_=function(o,e,s,u){return new Promise(function(n,r){var i=new wr;i.listenOnce(gr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case vr.NO_ERROR:var t=i.getResponseJson();Rr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case vr.TIMEOUT:Rr("Connection",'RPC "'+o+'" timed out'),r(new _r(Tr.DEADLINE_EXCEEDED,"Request time out"));break;case vr.HTTP_ERROR:var e=i.getStatus();Rr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Tr).indexOf(e)?e:Tr.UNKNOWN,r(new _r(e,t.message))):r(new _r(Tr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new _r(Tr.UNAVAILABLE,"Connection failed."));break;default:Lr()}}finally{Rr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},$p.prototype.Xc=function(t,e){var n,r=[this.a_,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=yr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.U.projectId+"/databases/"+this.U.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.h_(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Rr("Connection","Creating WebChannel: "+r,t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new Rp({Xl:function(t){u?Rr("Connection","Not sending because WebChannel is closed:",t):(s||(Rr("Connection","Opening WebChannel transport."),o.open(),s=!0),Rr("Connection","WebChannel sending:",t),o.send(t))},Zl:function(){return o.close()}}),t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(mr.EventType.OPEN,function(){u||Rr("Connection","WebChannel transport opened.")}),t(mr.EventType.CLOSE,function(){u||(u=!0,Rr("Connection","WebChannel transport closed"),a.i_())}),t(mr.EventType.ERROR,function(t){u||(u=!0,xr("Connection","WebChannel transport errored:",t),a.i_(new _r(Tr.UNAVAILABLE,"The operation could not be completed")))}),t(mr.EventType.MESSAGE,function(t){var e,n,r,i;u||(Pr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Rr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Ki[r];if(void 0!==t)return Xi(t)}(),i=n.message,void 0===t&&(t=Tr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.i_(new _r(t,i)),o.close()):(Rr("Connection","WebChannel received:",e),a.r_(e)))}),setTimeout(function(){a.s_()},0),a},$p),kp=(Zp.prototype.Sh=function(t){this.m_.push(t)},Zp.prototype.Di=function(){window.removeEventListener("online",this.__),window.removeEventListener("offline",this.d_)},Zp.prototype.T_=function(){window.addEventListener("online",this.__),window.addEventListener("offline",this.d_)},Zp.prototype.f_=function(){Rr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.m_;t<e.length;t++)(0,e[t])(0)},Zp.prototype.w_=function(){Rr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.m_;t<e.length;t++)(0,e[t])(1)},Zp.On=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Zp),Lp=(Jp.prototype.Sh=function(t){},Jp.prototype.Di=function(){},Jp),Pp="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Up=(Yp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.serializer=Lc(e.o_.U),this.sl=this.E_(e),this.persistence=this.I_(e),[4,this.persistence.start()];case 1:return t.sent(),this.A_=this.R_(e),this.Kr=this.P_(e),[2]}})})},Yp.prototype.R_=function(t){return null},Yp.prototype.P_=function(t){return Ul(this.persistence,new bp,t.y_,this.serializer)},Yp.prototype.I_=function(t){if(t.persistenceSettings.g_)throw new _r(Tr.FAILED_PRECONDITION,Pp);return new Np(Dp.Hl,this.serializer)},Yp.prototype.E_=function(t){return new mc},Yp.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.A_&&this.A_.stop(),[4,this.sl.Di()];case 1:return t.sent(),[4,this.persistence.Di()];case 2:return t.sent(),[2]}})})},Yp.prototype.clearPersistence=function(t,e){throw new _r(Tr.FAILED_PRECONDITION,Pp)},Yp),Cp=(n(Xp,vp=Up),Xp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,vp.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,Kl(this.Kr)];case 2:return t.sent(),[4,this.V_.initialize(this,e)];case 3:return t.sent(),[4,lp(this.V_._i)];case 4:return t.sent(),[4,Pf(this.V_.el)];case 5:return t.sent(),[2]}})})},Xp.prototype.P_=function(t){return Ul(this.persistence,new bp,t.y_,this.serializer)},Xp.prototype.R_=function(t){var e=this.persistence.ha.zo;return new nh(e,t.os)},Xp.prototype.I_=function(t){var e=kl(t.o_.U,t.o_.persistenceKey);return new _l(t.persistenceSettings.synchronizeTabs,e,t.clientId,$c.Bo(t.persistenceSettings.cacheSizeBytes),t.os,Ka(),Qa(),this.serializer,this.sl,t.persistenceSettings.fu)},Xp.prototype.E_=function(t){return new mc},Xp.prototype.clearPersistence=function(t,e){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return Ra.On()?(e=n+"main",[4,Ra.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(kl(t,e))},n(Wp,yp=Xp),Wp.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,yp.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.V_._i,this.sl instanceof gc?(this.sl._i={ir:sp.bind(null,e),rr:function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return(e=i).wl?(Rr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!e.al.has(o))return[3,8];switch(s){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,zl(e.Kr)];case 3:return n=t.sent(),r=go.Yt(o,"current"===s),[4,ip(e,n,r)];case 4:return t.sent(),[3,8];case 5:return[4,Gl(e.Kr,o,!0)];case 6:return t.sent(),tp(e,o,u),[3,8];case 7:Lr(),t.label=8;case 8:return[2]}})})}.bind(null,e),ar:function(c,h,l){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=hp(c)).wl)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.al.has(r)?(Rr("SyncEngine","Adding an already active target "+r),[3,5]):[4,Bl(n.Kr,r)]):[3,6];case 2:return i=t.sent(),[4,jl(n.Kr,i)];case 3:return o=t.sent(),[4,Wf(n,cp(i),o.targetId,!1)];case 4:t.sent(),Tf(n.el,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.al.has(e)?[4,Gl(n.Kr,e,!1).then(function(){_f(n.el,e),tp(n,e)}).catch(Ql)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=l,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),pi:function(t){return t.Kr.persistence.pi()}.bind(null,e),sr:function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,zl((e=n).Kr).then(function(t){return ip(e,t)})]})})}.bind(null,e)},[4,this.sl.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.Su(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,up(this.V_._i,e)];case 1:return t.sent(),this.A_&&(e&&!this.A_.Ti?this.A_.start(this.Kr):e||this.A_.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},Wp.prototype.E_=function(t){if(t.persistenceSettings.g_&&t.persistenceSettings.synchronizeTabs){var e=Ka();if(!gc.On(e))throw new _r(Tr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=kl(t.o_.U,t.o_.persistenceKey);return new gc(e,t.os,n,t.clientId,t.y_)}return new mc},Wp),Vp=(Hp.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Kr?[3,2]:(this.Kr=n.Kr,this.sl=n.sl,this.Rh=this.p_(r),this.el=this.b_(r),this.nl=this.v_(r),this._i=this.S_(r),this.sl.fi=function(t){return Yf(e._i,t,1)},this.el.Ph.D_=op.bind(null,this._i),[4,Vf(this.el,this._i.ml)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Hp.prototype.v_=function(t){return new $a},Hp.prototype.p_=function(t){var e=Lc(t.o_.U),n=(n=t.o_,new xp(n));return t=t.credentials,new uf(t,n,e)},Hp.prototype.b_=function(t){var e=this,n=this.Kr,r=this.Rh,i=t.os,o=function(t){return Yf(e._i,t,0)},t=new(kp.On()?kp:Lp);return new Wl(n,r,i,o,t)},Hp.prototype.S_=function(t){return function(t,e,n,r,i,o,s){o=new Kf(t,e,n,r,i,o);return s&&(o.wl=!0),o}(this.Kr,this.el,this.nl,this.sl,t.y_,t.il,!t.persistenceSettings.g_||!t.persistenceSettings.synchronizeTabs)},Hp.prototype.terminate=function(){return If(this.el)},Hp),Mp=(Qp.prototype.next=function(t){this.observer.next&&this.C_(this.observer.next,t)},Qp.prototype.error=function(t){this.observer.error?this.C_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Qp.prototype.N_=function(){this.muted=!0},Qp.prototype.C_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Qp),Fp=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new _r(Tr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(Zr("FieldPath","string",e,t[e]),0===t[e].length)throw new _r(Tr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.F_=new qr(t)},jp=(n(Kp,dp=Fp),Kp.documentId=function(){return new Kp(qr.v().R())},Kp.prototype.isEqual=function(t){if(!(t instanceof Kp))throw ci("isEqual","FieldPath",1,t);return this.F_.isEqual(t.F_)},Kp),Gp=new RegExp("[~\\*/\\[\\]]"),qp=function(t){this.x_=t},Bp=(n(zp,pp=qp),zp.prototype.k_=function(t){if(2!==t.M_)throw 1===t.M_?t.O_(this.x_+"() can only appear at the top level of your update data"):t.O_(this.x_+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},zp.prototype.isEqual=function(t){return t instanceof zp},zp);function zp(){return null!==pp&&pp.apply(this,arguments)||this}function Kp(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return dp.call(this,t)||this}function Qp(t){this.observer=t,this.muted=!1}function Hp(){}function Wp(){return null!==yp&&yp.apply(this,arguments)||this}function Xp(t){var e=this;return(e=vp.call(this)||this).V_=t,e}function Yp(){}function Jp(){}function Zp(){var t=this;this.__=function(){return t.f_()},this.d_=function(){return t.w_()},this.m_=[],this.T_()}function $p(t){var e=this;return(e=gp.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function td(t){this.o_=t,this.U=t.U;var e=t.ssl?"https":"http";this.a_=e+"://"+t.host,this.u_="projects/"+this.U.projectId+"/databases/"+this.U.database+"/documents"}function ed(t){this.Xl=t.Xl,this.Zl=t.Zl}function nd(t){this.persistence=t,this.Gl=new Zl,this.zl=null}function rd(t){var e=this;return(e=mp.call(this)||this).lu=t,e}function id(t,e){var n=this;this.Ul={},this.du=new uc(0),this.wu=!1,this.wu=!0,this.ha=t(this),this.eo=new _p(this),this.ho=new Ch,this.uo=(t=this.ho,new Ip(t,function(t){return n.ha.Ql(t)})),this.serializer=new ch(e),this.yu=new Ap(this.serializer)}function od(t){this.serializer=t,this.Bl=new Map,this.ql=new Map}function sd(t){this.persistence=t,this.kl=new Di(Gi,qi),this.lastRemoteSnapshotVersion=Oi.min(),this.highestTargetId=0,this.Ml=0,this.Ol=new Zl,this.targetCount=0,this.Ll=dl.Ka()}function ud(t){var e=this;return(e=wp.call(this)||this).Ma=t,e}function ad(t,e){this.ho=t,this.$l=e,this.docs=new Yi(Br.i),this.size=0}function cd(t,e){this.ho=t,this.ha=e,this.co=[],this.vl=1,this.Sl=new ro($l.hc)}function hd(){}function ld(t,e,n){return new Pd({M_:3,L_:e.settings.L_,methodName:t.x_,B_:n},e.U,e.serializer,e.ignoreUndefinedProperties)}var fd,pd,dd,yd,vd=(n(kd,yd=qp),kd.prototype.k_=function(t){return new Ks(t.path,new Os)},kd.prototype.isEqual=function(t){return t instanceof kd},kd),gd=(n(xd,dd=qp),xd.prototype.k_=function(t){var e=ld(this,t,!0),n=this.q_.map(function(t){return qd(t,e)}),n=new xs(n);return new Ks(t.path,n)},xd.prototype.isEqual=function(t){return this===t},xd),md=(n(Od,pd=qp),Od.prototype.k_=function(t){var e=ld(this,t,!0),n=this.q_.map(function(t){return qd(t,e)}),n=new Cs(n);return new Ks(t.path,n)},Od.prototype.isEqual=function(t){return this===t},Od),wd=(n(Rd,fd=qp),Rd.prototype.k_=function(t){var e=new js(t.serializer,ns(t.serializer,this.U_));return new Ks(t.path,e)},Rd.prototype.isEqual=function(t){return this===t},Rd),bd=(Object.defineProperty(Dd.prototype,"latitude",{get:function(){return this.Q_},enumerable:!1,configurable:!0}),Object.defineProperty(Dd.prototype,"longitude",{get:function(){return this.W_},enumerable:!1,configurable:!0}),Dd.prototype.isEqual=function(t){return this.Q_===t.Q_&&this.W_===t.W_},Dd.prototype.toJSON=function(){return{latitude:this.Q_,longitude:this.W_}},Dd.prototype.H=function(t){return yi(this.Q_,t.Q_)||yi(this.W_,t.W_)},Dd),Ed=function(t){this.j_=t},Id=/^__.*__$/,Td=function(t,e,n){this.K_=t,this.G_=e,this.z_=n},_d=(Sd.prototype.H_=function(t,e){var n=[];return null!==this.Qe?n.push(new iu(t,this.data,this.Qe,e)):n.push(new ru(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new cu(t,this.fieldTransforms)),n},Sd),Ad=(Nd.prototype.H_=function(t,e){e=[new iu(t,this.data,this.Qe,e)];return 0<this.fieldTransforms.length&&e.push(new cu(t,this.fieldTransforms)),e},Nd);function Nd(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function Sd(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function Dd(t,e){if(Xr("GeoPoint",arguments,2),Zr("GeoPoint","number",1,t),Zr("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new _r(Tr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new _r(Tr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Q_=t,this.W_=e}function Rd(t,e){var n=this;return(n=fd.call(this,t)||this).U_=e,n}function Od(t,e){var n=this;return(n=pd.call(this,t)||this).q_=e,n}function xd(t,e){var n=this;return(n=dd.call(this,t)||this).q_=e,n}function kd(){return null!==yd&&yd.apply(this,arguments)||this}function Ld(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Lr()}}var Pd=(Object.defineProperty(Vd.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Vd.prototype,"M_",{get:function(){return this.settings.M_},enumerable:!1,configurable:!0}),Vd.prototype.Y_=function(t){return new Vd(Object.assign(Object.assign({},this.settings),t),this.U,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},Vd.prototype.X_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.Y_({path:e,B_:!1});return e.Z_(t),e},Vd.prototype.tf=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.Y_({path:t,B_:!1});return t.J_(),t},Vd.prototype.ef=function(t){return this.Y_({path:void 0,B_:!0})},Vd.prototype.O_=function(t){return Wd(t,this.settings.methodName,this.settings.nf||!1,this.path,this.settings.L_)},Vd.prototype.contains=function(e){return void 0!==this.Qe.find(function(t){return e.T(t)})||void 0!==this.fieldTransforms.find(function(t){return e.T(t.field)})},Vd.prototype.J_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Z_(this.path.get(t))},Vd.prototype.Z_=function(t){if(0===t.length)throw this.O_("Document fields must not be empty");if(Ld(this.M_)&&Id.test(t))throw this.O_('Document fields cannot begin and end with "__"')},Vd),Ud=(Cd.prototype.sf=function(t,e,n,r){return void 0===r&&(r=!1),new Pd({M_:t,methodName:e,L_:n,path:qr.g(),B_:!1,nf:r},this.U,this.serializer,this.ignoreUndefinedProperties)},Cd);function Cd(t,e,n){this.U=t,this.ignoreUndefinedProperties=e,this.serializer=n||Lc(t)}function Vd(t,e,n,r,i,o){this.settings=t,this.U=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.J_(),this.fieldTransforms=i||[],this.Qe=o||[]}function Md(t,e,n,r,i,o){void 0===o&&(o={});var s=t.sf(o.merge||o.mergeFields?2:0,e,n,i);Kd("Data must be an object, but it was:",s,r);var u,a,r=Bd(r,s);if(o.merge)u=new zs(s.Qe),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,l=o.mergeFields;h<l.length;h++){var f=l[h],p=void 0;if(f instanceof Fp)p=f.F_;else{if("string"!=typeof f)throw Lr();p=Hd(e,f,n)}if(!s.contains(p))throw new _r(Tr.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Xd(c,p)||c.push(p)}u=new zs(c),a=s.fieldTransforms.filter(function(t){return u.He(t.field)})}else u=null,a=s.fieldTransforms;return new _d(new vu(r),u,a)}function Fd(t,r,i,e){var o=t.sf(1,r,i);Kd("Data must be an object, but it was:",o,e);var s=[],u=new gu;Cr(e,function(t,e){var n=Hd(r,t,i),t=o.tf(n);e instanceof Bp||e instanceof Ed&&e.j_ instanceof Bp?s.push(n):null!=(t=qd(e,t))&&(s.push(n),u.set(n,t))});e=new zs(s);return new Ad(u.Ye(),e,o.fieldTransforms)}function jd(t,e,n,r,i,o){var s=t.sf(1,e,n),u=[Qd(e,r,n)],a=[i];if(o.length%2!=0)throw new _r(Tr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Qd(e,o[c])),a.push(o[c+1]);for(var h,l,f,p=[],d=new gu,y=u.length-1;0<=y;--y){Xd(p,u[y])||(h=u[y],l=a[y],f=s.tf(h),l instanceof Bp||l instanceof Ed&&l.j_ instanceof Bp?p.push(h):null!=(f=qd(l,f))&&(p.push(h),d.set(h,f)))}i=new zs(p);return new Ad(d.Ye(),i,s.fieldTransforms)}function Gd(t,e,n,r){return void 0===r&&(r=!1),qd(n,t.sf(r?4:3,e))}function qd(s,t){if(s instanceof Ed&&(s=s.j_),zd(s))return Kd("Unsupported field value:",t,s),Bd(s,t);if(s instanceof qp)return function(t,e){if(!Ld(e.M_))throw e.O_(t.x_+"() can only be used with update() and set()");if(!e.path)throw e.O_(t.x_+"() is not currently supported inside arrays");t=t.k_(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.Qe.push(t.path),s instanceof Array){if(t.settings.B_&&4!==t.M_)throw t.O_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=qd(i[r],t.ef(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ns(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Ri.fromDate(t);return{timestampValue:rs(e.serializer,n)}}if(t instanceof Ri){var r=new Ri(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:rs(e.serializer,r)}}if(t instanceof bd)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof bi)return{bytesValue:is(e.serializer,t.q)};if(t instanceof Td){n=e.U,r=t.K_;if(!r.isEqual(n))throw e.O_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:ss(t.K_||e.U,t.G_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.O_("Unsupported field value: "+si(t))}(s,t)}function Bd(t,n){var r={};return Vr(t)?n.path&&0<n.path.length&&n.Qe.push(n.path):Cr(t,function(t,e){e=qd(e,n.X_(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function zd(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Ri||t instanceof bd||t instanceof bi||t instanceof Td||t instanceof qp)}function Kd(t,e,n){if(!zd(n)||!oi(n)){n=si(n);throw"an object"===n?e.O_(t+" a custom object"):e.O_(t+" "+n)}}function Qd(t,e,n){if(e instanceof Fp)return e.F_;if("string"==typeof e)return Hd(t,e);throw Wd("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Hd(t,e,n){try{return function(e){if(0<=e.search(Gp))throw new _r(Tr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(jp.bind.apply(jp,i([void 0],e.split("."))))}catch(t){throw new _r(Tr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).F_}catch(e){throw Wd(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Wd(t,e,n,r,i){var o=r&&!r.m(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new _r(Tr.INVALID_ARGUMENT,(e+=". ")+t+n)}function Xd(t,e){return t.some(function(t){return t.isEqual(e)})}var Yd=(ey.prototype.cf=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.hf(),0<this.mutations.length)throw new _r(Tr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=fs((n=s).serializer)+"/documents",r={documents:u.map(function(t){return as(n.serializer,t)})},[4,n._h("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.serializer,"found"in(t=t)?function(t,e){Pr(!!e.found),e.found.name,e.found.updateTime;var n=cs(t,e.found.name),t=os(e.found.updateTime),e=new vu({mapValue:{fields:e.found.fields}});return new Au(n,t,e,{})}(e,t):"missing"in t?function(t,e){Pr(!!e.missing),Pr(!!e.readTime);t=cs(t,e.missing),e=os(e.readTime);return new Nu(t,e)}(e,t):Lr());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());Pr(!!t),o.push(t)}),o)]}})})}(this.Rh,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Nu||t instanceof Au?n.lf(t):Lr()}),e)]}})})},ey.prototype.set=function(t,e){this.write(e.H_(t,this.Ke(t))),this.uf.add(t.toString())},ey.prototype.update=function(t,e){try{this.write(e.H_(t,this._f(t)))}catch(t){this.af=t}this.uf.add(t.toString())},ey.prototype.delete=function(t){this.write([new du(t,this.Ke(t))]),this.uf.add(t.toString())},ey.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.hf(),this.af)throw this.af;return e=this.if,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=Br.D(e);n.mutations.push(new yu(e,n.Ke(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=fs((e=i).serializer)+"/documents",r={writes:o.map(function(t){return vs(e.serializer,t)})},[4,e.lh("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Rh,this.mutations)];case 1:return t.sent(),this.rf=!0,[2]}})})},ey.prototype.lf=function(t){var e;if(t instanceof Au)e=t.version;else{if(!(t instanceof Nu))throw Lr();e=Oi.min()}var n=this.if.get(t.key.toString());if(n){if(!e.isEqual(n))throw new _r(Tr.ABORTED,"Document version changed between two reads.")}else this.if.set(t.key.toString(),e)},ey.prototype.Ke=function(t){var e=this.if.get(t.toString());return!this.uf.has(t.toString())&&e?Ws.updateTime(e):Ws.Ge()},ey.prototype._f=function(t){var e=this.if.get(t.toString());if(this.uf.has(t.toString())||!e)return Ws.exists(!0);if(e.isEqual(Oi.min()))throw new _r(Tr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ws.updateTime(e)},ey.prototype.write=function(t){this.hf(),this.mutations=this.mutations.concat(t)},ey.prototype.hf=function(){},ey),Jd=(ty.prototype.run=function(){this.df()},ty.prototype.df=function(){var t=this;this.ys.Rn(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Yd(this.Rh),(n=this.wf(e))&&n.then(function(t){r.os.ds(function(){return e.commit().then(function(){r.hs.resolve(t)}).catch(function(t){r.mf(t)})})}).catch(function(t){r.mf(t)}),[2]})})})},ty.prototype.wf=function(t){try{var e=this.updateFunction(t);return!Ci(e)&&e.catch&&e.then?e:(this.hs.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.hs.reject(t),null}},ty.prototype.mf=function(t){var e=this;0<this.ff&&this.Tf(t)?(--this.ff,this.os.ds(function(){return e.df(),Promise.resolve()})):this.hs.reject(t)},ty.prototype.Tf=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!Wi(t)},ty),Zd=($d.prototype.start=function(t,e,n,r){var i=this;this.If(),this.o_=t;var o=new Aa,s=!1;return this.credentials.yc(function(t){return s?void i.os.Ds(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).os.Fs(),Rr("RemoteStore","RemoteStore received new credentials"),n=Rf(e),e.Vh.add(3),[4,Ef(e)];case 1:return t.sent(),n&&e.Dh.set("Unknown"),[4,e.Ph.D_(i)];case 2:return t.sent(),e.Vh.delete(3),[4,bf(e)];case 3:return t.sent(),[2]}})})}(i.el,t)}):(s=!0,Rr("FirestoreClient","Initializing. user=",t.uid),i.Af(e,n,r,t,o).then(i.Ef.resolve,i.Ef.reject))}),this.os.ds(function(){return i.Ef.promise}),o.promise},$d.prototype.enableNetwork=function(){var e=this;return this.If(),this.os.enqueue(function(){return e.persistence.Cu(!0),(t=e.el).Vh.delete(0),bf(t);var t})},$d.prototype.Af=function(r,i,o,s,u){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={os:this.os,o_:this.o_,clientId:this.clientId,credentials:this.credentials,y_:s,il:100,persistenceSettings:o},[4,r.initialize(e)];case 1:return t.sent(),[4,i.initialize(r,e)];case 2:return t.sent(),this.persistence=r.persistence,this.sl=r.sl,this.Kr=r.Kr,this.A_=r.A_,this.Rh=i.Rh,this.el=i.el,this._i=i._i,this.Rf=i.nl,this.Rf.qs=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=hp(s),(o=e.ol.get(u))?(n=o.targetId,e.sl.Oi(n),r=o.view.Zh(),[3,4]):[3,1];case 1:return[4,jl(e.Kr,ju(u))];case 2:return i=t.sent(),o=e.sl.Oi(i.targetId),n=i.targetId,[4,Wf(e,u,n,"current"===o)];case 3:r=t.sent(),e.ml&&Tf(e.el,i),t.label=4;case 4:return[2,r]}})})}.bind(null,this._i),this.Rf.Ws=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).ol.get(o),1<(r=e.al.get(n.targetId)).length?[2,(e.al.set(n.targetId,r.filter(function(t){return!zu(t,o)})),void e.ol.delete(o))]:e.ml?(e.sl.Bi(n.targetId),e.sl.Fi(n.targetId)?[3,2]:[4,Gl(e.Kr,n.targetId,!1).then(function(){e.sl.Ui(n.targetId),_f(e.el,n.targetId),tp(e,n.targetId)}).catch(Ql)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return tp(e,n.targetId),[4,Gl(e.Kr,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,this._i),this.persistence.Du(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),u.resolve(),[3,4];case 3:if(e=t.sent(),u.reject(e),!this.Pf(e))throw e;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),this.Af(new Up,new Vp,{g_:!1},s,u))];case 4:return[2]}})})},$d.prototype.Pf=function(t){return"FirebaseError"===t.name?t.code===Tr.FAILED_PRECONDITION||t.code===Tr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},$d.prototype.If=function(){if(this.os.Vs)throw new _r(Tr.FAILED_PRECONDITION,"The client has already been terminated.")},$d.prototype.disableNetwork=function(){var t=this;return this.If(),this.os.enqueue(function(){return t.persistence.Cu(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Vh.add(0),[4,Ef(e)];case 1:return t.sent(),e.Dh.set("Offline"),[2]}})})}(t.el)})},$d.prototype.terminate=function(){var t=this;this.os.Ss();var n=new Aa;return this.os.ps(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.A_&&this.A_.stop(),[4,If(this.el)];case 1:return t.sent(),[4,this.sl.Di()];case 2:return t.sent(),[4,this.persistence.Di()];case 3:return t.sent(),this.credentials.gc(),n.resolve(),[3,5];case 4:return e=t.sent(),e=Ja(e,"Failed to shutdown persistence"),n.reject(e),[3,5];case 5:return[2]}})})}),n.promise},$d.prototype.waitForPendingWrites=function(){var t=this;this.If();var e=new Aa;return this.os.ds(function(){return function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:Rf((n=o).el)||Rr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Kr).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.co.Ia(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.fl.get(r)||[]).push(s),n.fl.set(r,i),[3,4]);case 3:return i=t.sent(),i=Ja(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}(t._i,e)}),e.promise},$d.prototype.listen=function(t,e,n){var r=this;this.If();var i=new Mp(n),o=new rc(t,i,e);return this.os.ds(function(){return tc(r.Rf,o)}),function(){i.N_(),r.os.ds(function(){return ec(r.Rf,o)})}},$d.prototype.yf=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.If(),[4,this.Ef.promise];case 1:return t.sent(),e=new Aa,[2,(this.os.ds(function(){return function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.io.lo(t,e)}))];case 1:return(r=t.sent())instanceof Au?s.resolve(r):r instanceof Nu?s.resolve(null):s.reject(new _r(Tr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),r=Ja(r,"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(n.Kr,r,e)}),e.promise)]}})})},$d.prototype.gf=function(c,h){return void 0===h&&(h={}),y(this,void 0,void 0,function(){var e,a=this;return v(this,function(t){switch(t.label){case 0:return this.If(),[4,this.Ef.promise];case 1:return t.sent(),e=new Aa,[2,(this.os.ds(function(){return n=a.Rf,r=a.os,i=c,o=h,s=e,t=new Mp({next:function(t){r.ds(function(){return ec(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new _r(Tr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new _r(Tr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new rc(Lu(i.path),t,{includeMetadataChanges:!0,Ys:!0}),tc(n,u);var n,r,i,o,s,t,u}),e.promise)]}})})},$d.prototype.Vf=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.If(),[4,this.Ef.promise];case 1:return t.sent(),e=new Aa,[2,(this.os.ds(function(){return function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,ql(r,i,!0)];case 1:return n=t.sent(),e=new qf(i,n.uc),n=e.Wh(n.documents),n=e.vr(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),n=Ja(n,"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(n.Kr,r,e)}),e.promise)]}})})},$d.prototype.pf=function(c,h){return void 0===h&&(h={}),y(this,void 0,void 0,function(){var u,a=this;return v(this,function(t){switch(t.label){case 0:return this.If(),[4,this.Ef.promise];case 1:return t.sent(),u=new Aa,[2,(this.os.ds(function(){return e=a.Rf,n=a.os,t=c,r=h,i=u,o=new Mp({next:function(t){n.ds(function(){return ec(e,s)}),t.fromCache&&"server"===r.source?i.reject(new _r(Tr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new rc(t,o,{includeMetadataChanges:!0,Ys:!0}),tc(e,s);var e,n,t,r,i,o,s}),u.promise)]}})})},$d.prototype.write=function(t){var e=this;this.If();var n=new Aa;return this.os.ds(function(){return function(f,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=lp(f),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.Kr,a=p,h=i,l=Ri.now(),o=a.reduce(function(t,e){return t.add(e.key)},lo()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.io.mo(u,o).next(function(t){c=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=c.get(i.key),s instanceof cu?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Au?t.field(i.field):void 0,o=Ss(i.transform,o||null);null!=o&&(e=(null==e?new gu:e).set(i.field,o))}return e?e.Ye():null}(o):null);null!=o&&e.push(new iu(i.key,o,function s(t){var u=[];return Cr(t.fields||{},function(t,e){var n=new qr([t]);if(Yo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new zs(u)}(o.proto.mapValue),Ws.exists(!0)))}return h.co.da(u,l,e,a)})}).then(function(t){var e=t.wr(c);return{batchId:t.batchId,Er:e}}))];case 2:return s=t.sent(),u.sl.$i(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e._l[e.currentUser.Zs()])||new Yi(yi)).rt(n,r),e._l[e.currentUser.Zs()]=i,[4,ip(u,s.Er)];case 3:return t.sent(),[4,Pf(u.el)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=Ja(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,l,o})})}(e._i,t,n)}),n.promise},$d.prototype.U=function(){return this.o_.U},$d.prototype.bf=function(t){var e=this;this.If();var r=new Mp(t);return this.os.ds(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,(e=this.Rf,n=r,e.Bs.add(n),void n.next())];var e,n})})}),function(){r.N_(),e.os.ds(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,void this.Rf.Bs.delete(r)]})})})}},Object.defineProperty($d.prototype,"vf",{get:function(){return this.os.Vs},enumerable:!1,configurable:!0}),$d.prototype.transaction=function(t){var e=this;this.If();var n=new Aa;return this.os.ds(function(){return new Jd(e.os,e.Rh,t,n).run(),Promise.resolve()}),n.promise},$d.prototype.loadBundle=function(t,e){var n=this;this.If();var r=function(t,e){t="string"==typeof t?(new TextEncoder).encode(t):t;return new Uc(kc(t),e)}(t,Lc(this.o_.U));this.os.ds(function(){return y(n,void 0,void 0,function(){return v(this,function(t){return[2,(fp(this._i,r,e),e.catch(function(t){xr("FirestoreClient","Loading bundle failed with "+t)}))]})})})},$d.prototype.Ua=function(t){return this.If(),e=this.Kr,n=t,(r=e).persistence.runTransaction("Get named query","readonly",function(t){return r.yu.Ua(t,n)});var e,n,r},$d);function $d(t,e){this.credentials=t,this.os=e,this.clientId=pi.k(),this.Ef=new Aa}function ty(t,e,n,r){this.os=t,this.Rh=e,this.updateFunction=n,this.hs=r,this.ff=5,this.ys=new Sa(this.os,"transaction_retry")}function ey(t){this.Rh=t,this.if=new Map,this.mutations=[],this.rf=!1,this.af=null,this.uf=new Set}function ny(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var ry,iy,oy=(Ay.prototype.Nf=function(t){switch(Co(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Bo(t.integerValue||t.doubleValue);case 3:return this.Ff(t.timestampValue);case 4:return this.$f(t);case 5:return t.stringValue;case 6:return this.Cf(zo(t.bytesValue));case 7:return this.xf(t.referenceValue);case 8:return this.kf(t.geoPointValue);case 9:return this.Mf(t.arrayValue);case 10:return this.Of(t.mapValue);default:throw Lr()}},Ay.prototype.Of=function(t){var n=this,r={};return Cr(t.fields||{},function(t,e){r[t]=n.Nf(e)}),r},Ay.prototype.kf=function(t){return new bd(Bo(t.latitude),Bo(t.longitude))},Ay.prototype.Mf=function(t){var e=this;return(t.values||[]).map(function(t){return e.Nf(t)})},Ay.prototype.$f=function(t){switch(this.Sf){case"previous":var e=function t(e){e=e.mapValue.fields.__previous_value__;return Lo(e)?t(e):e}(t);return null==e?null:this.Nf(e);case"estimate":return this.Ff(Po(t));default:return null}},Ay.prototype.Ff=function(t){t=qo(t),t=new Ri(t.seconds,t.nanos);return this.timestampsInSnapshots?t:t.toDate()},Ay.prototype.xf=function(t){var e=jr.P(t);Pr(Ns(e));t=new Si(e.get(1),e.get(3)),e=new Br(e.u(5));return t.isEqual(this.U)||Or("Document "+e+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+this.U.projectId+"/"+this.U.database+") instead."),this.Df(e)},Ay),sy=(_y.prototype.onProgress=function(t,e,n){this.Lf={next:t,error:e,complete:n}},_y.prototype.catch=function(t){return this.Bf.promise.catch(t)},_y.prototype.then=function(t,e){return this.Bf.promise.then(t,e)},_y.prototype.Pl=function(t){this.yl(t),this.Lf.complete&&this.Lf.complete(),this.Bf.resolve(t)},_y.prototype.gl=function(t){this.qf.taskState="Error",this.Lf.next&&this.Lf.next(this.qf),this.Lf.error&&this.Lf.error(t),this.Bf.reject(t)},_y.prototype.yl=function(t){this.qf=t,this.Lf.next&&this.Lf.next(t)},_y),uy=$c.Qo,ay=(Ty.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Ty),cy=(Object.defineProperty(Iy.prototype,"Xf",{get:function(){return this.Zf||(this.Zf=new Ud(this.K_,this.Yf.ignoreUndefinedProperties)),this.Zf},enumerable:!1,configurable:!0}),Iy.prototype.settings=function(t){Xr("Firestore.settings",arguments,1),Zr("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.Yf),t)).merge;t=new ay(t);if(this.Gf&&!this.Yf.isEqual(t))throw new _r(Tr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Yf=t).credentials&&(this.Jf=function(t){if(!t)return new tf;switch(t.type){case"gapi":var e=t.client;return Pr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new rf(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new _r(Tr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Iy.prototype.enableNetwork=function(){return this.Kf(),this.Gf.enableNetwork()},Iy.prototype.disableNetwork=function(){return this.Kf(),this.Gf.disableNetwork()},Iy.prototype.enablePersistence=function(t){var e;if(this.Gf)throw new _r(Tr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var n=!1,r=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Or("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),n=null!==(e=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==e&&e,r=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,n&&r))throw new _r(Tr.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.td(this.Uf,this.Qf,{g_:!0,cacheSizeBytes:this.Yf.cacheSizeBytes,synchronizeTabs:n,fu:r})},Iy.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){var n,e=this;return v(this,function(t){if(void 0!==this.Gf&&!this.Gf.vf)throw new _r(Tr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new Aa,[2,(this.jf.ps(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Uf.clearPersistence(this.K_,this.Hf)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},Iy.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Iy.prototype,"ed",{get:function(){return this.Kf(),this.Gf.vf},enumerable:!1,configurable:!0}),Iy.prototype.waitForPendingWrites=function(){return this.Kf(),this.Gf.waitForPendingWrites()},Iy.prototype.onSnapshotsInSync=function(t){if(this.Kf(),ny(t))return this.Gf.bf(t);Zr("Firestore.onSnapshotsInSync","function",1,t);t={next:t};return this.Gf.bf(t)},Iy.prototype.loadBundle=function(t){this.Kf();var e=new sy;return this.Gf.loadBundle(t,e),e},Iy.prototype.namedQuery=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.Kf(),[4,this.Gf.Ua(n)];case 1:return[2,(e=t.sent())?new xy(e.query,this,null):null]}})})},Iy.prototype.Kf=function(){return this.Gf||this.td(new Up,new Vp,{g_:!1}),this.Gf},Iy.prototype.nd=function(){return new _i(this.K_,this.Hf,this.Yf.host,this.Yf.ssl,this.Yf.experimentalForceLongPolling)},Iy.prototype.td=function(t,e,n){var r=this.nd();return this.Gf=new Zd(this.Jf,this.jf),this.Gf.start(r,t,e,n)},Iy.zf=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new _r(Tr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,t=t.options.projectId;if(!t||"string"!=typeof t)throw new _r(Tr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Si(t)},Object.defineProperty(Iy.prototype,"app",{get:function(){if(!this.Wf)throw new _r(Tr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Wf},enumerable:!1,configurable:!0}),Iy.prototype.collection=function(t){return Xr("Firestore.collection",arguments,1),Zr("Firestore.collection","non-empty string",1,t),this.Kf(),new Ly(jr.P(t),this,null)},Iy.prototype.doc=function(t){return Xr("Firestore.doc",arguments,1),Zr("Firestore.doc","non-empty string",1,t),this.Kf(),fy.sd(jr.P(t),this,null)},Iy.prototype.collectionGroup=function(t){if(Xr("Firestore.collectionGroup",arguments,1),Zr("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new _r(Tr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.Kf(),new xy((t=t,new Du(jr.g(),t)),this,null)},Iy.prototype.runTransaction=function(e){var n=this;return Xr("Firestore.runTransaction",arguments,1),Zr("Firestore.runTransaction","function",1,e),this.Kf().transaction(function(t){return e(new hy(n,t))})},Iy.prototype.batch=function(){return this.Kf(),new ly(this)},Object.defineProperty(Iy,"logLevel",{get:function(){switch(Dr()){case f.DEBUG:return"debug";case f.ERROR:return"error";case f.SILENT:return"silent";case f.WARN:return"warn";case f.INFO:return"info";case f.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),Iy.setLogLevel=function(t){Xr("Firestore.setLogLevel",arguments,1),ri("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Nr.setLogLevel(t)},Iy.prototype.rd=function(){return this.Yf.timestampsInSnapshots},Iy.prototype.od=function(){return this.Yf},Iy),hy=(Ey.prototype.get=function(t){var e=this;Xr("Transaction.get",arguments,1);var n=jy("Transaction.get",t,this.ad);return this.ud.cf([n.G_]).then(function(t){if(!t||1!==t.length)return Lr();t=t[0];if(t instanceof Nu)return new dy(e.ad,n.G_,null,!1,!1,n.z_);if(t instanceof Au)return new dy(e.ad,n.G_,t,!1,!1,n.z_);throw Lr()})},Ey.prototype.set=function(t,e,n){Jr("Transaction.set",arguments,2,3);t=jy("Transaction.set",t,this.ad);n=Vy("Transaction.set",n);e=Gy(t.z_,e,n),n=Md(this.ad.Xf,"Transaction.set",t.G_,e,null!==t.z_,n);return this.ud.set(t.G_,n),this},Ey.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return e="string"==typeof e||e instanceof jp?(Yr("Transaction.update",arguments,3),r=jy("Transaction.update",t,this.ad),jd(this.ad.Xf,"Transaction.update",r.G_,e,n,i)):(Xr("Transaction.update",arguments,2),r=jy("Transaction.update",t,this.ad),Fd(this.ad.Xf,"Transaction.update",r.G_,e)),this.ud.update(r.G_,e),this},Ey.prototype.delete=function(t){Xr("Transaction.delete",arguments,1);t=jy("Transaction.delete",t,this.ad);return this.ud.delete(t.G_),this},Ey),ly=(by.prototype.set=function(t,e,n){Jr("WriteBatch.set",arguments,2,3),this._d();t=jy("WriteBatch.set",t,this.ad);n=Vy("WriteBatch.set",n);e=Gy(t.z_,e,n),n=Md(this.ad.Xf,"WriteBatch.set",t.G_,e,null!==t.z_,n);return this.hd=this.hd.concat(n.H_(t.G_,Ws.Ge())),this},by.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return this._d(),e="string"==typeof e||e instanceof jp?(Yr("WriteBatch.update",arguments,3),r=jy("WriteBatch.update",t,this.ad),jd(this.ad.Xf,"WriteBatch.update",r.G_,e,n,i)):(Xr("WriteBatch.update",arguments,2),r=jy("WriteBatch.update",t,this.ad),Fd(this.ad.Xf,"WriteBatch.update",r.G_,e)),this.hd=this.hd.concat(e.H_(r.G_,Ws.exists(!0))),this},by.prototype.delete=function(t){Xr("WriteBatch.delete",arguments,1),this._d();t=jy("WriteBatch.delete",t,this.ad);return this.hd=this.hd.concat(new du(t.G_,Ws.Ge())),this},by.prototype.commit=function(){return this._d(),this.ld=!0,0<this.hd.length?this.ad.Kf().write(this.hd):Promise.resolve()},by.prototype._d=function(){if(this.ld)throw new _r(Tr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},by),fy=(n(wy,iy=Td),wy.sd=function(t,e,n){if(t.length%2!=0)throw new _r(Tr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.R()+" has "+t.length);return new wy(new Br(t),e,n)},Object.defineProperty(wy.prototype,"id",{get:function(){return this.G_.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(wy.prototype,"parent",{get:function(){return new Ly(this.G_.path.h(),this.firestore,this.z_)},enumerable:!1,configurable:!0}),Object.defineProperty(wy.prototype,"path",{get:function(){return this.G_.path.R()},enumerable:!1,configurable:!0}),wy.prototype.collection=function(t){if(Xr("DocumentReference.collection",arguments,1),Zr("DocumentReference.collection","non-empty string",1,t),!t)throw new _r(Tr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");t=jr.P(t);return new Ly(this.G_.path.child(t),this.firestore,null)},wy.prototype.isEqual=function(t){if(!(t instanceof wy))throw ci("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.G_.isEqual(t.G_)&&this.z_===t.z_},wy.prototype.set=function(t,e){Jr("DocumentReference.set",arguments,1,2),e=Vy("DocumentReference.set",e);t=Gy(this.z_,t,e),e=Md(this.firestore.Xf,"DocumentReference.set",this.G_,t,null!==this.z_,e);return this.Gf.write(e.H_(this.G_,Ws.Ge()))},wy.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return t="string"==typeof t||t instanceof jp?(Yr("DocumentReference.update",arguments,2),jd(this.firestore.Xf,"DocumentReference.update",this.G_,t,e,n)):(Xr("DocumentReference.update",arguments,1),Fd(this.firestore.Xf,"DocumentReference.update",this.G_,t)),this.Gf.write(t.H_(this.G_,Ws.exists(!0)))},wy.prototype.delete=function(){return Xr("DocumentReference.delete",arguments,0),this.Gf.write([new du(this.G_,Ws.Ge())])},wy.prototype.onSnapshot=function(){for(var e=this,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];Jr("DocumentReference.onSnapshot",arguments,1,4);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||ny(n[i])||(ai("DocumentReference.onSnapshot",r=n[i],["includeMetadataChanges"]),ei("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};ny(n[i])?(s=n[i],n[i]=null===(r=s.next)||void 0===r?void 0:r.bind(s),n[i+1]=null===(r=s.error)||void 0===r?void 0:r.bind(s),n[i+2]=null===(r=s.complete)||void 0===r?void 0:r.bind(s)):(Zr("DocumentReference.onSnapshot","function",i,n[i]),$r("DocumentReference.onSnapshot","function",i+1,n[i+1]),$r("DocumentReference.onSnapshot","function",i+2,n[i+2]));var s={next:function(t){n[i]&&n[i](e.fd(t))},error:n[i+1],complete:n[i+2]};return this.Gf.listen(Lu(this.G_.path),o,s)},wy.prototype.get=function(t){var e=this;Jr("DocumentReference.get",arguments,0,1),Fy("DocumentReference.get",t);var n=this.firestore.Kf();return t&&"cache"===t.source?n.yf(this.G_).then(function(t){return new dy(e.firestore,e.G_,t,!0,t instanceof Au&&t.Je,e.z_)}):n.gf(this.G_,t).then(function(t){return e.fd(t)})},wy.prototype.withConverter=function(t){return new wy(this.G_,this.firestore,t)},wy.prototype.fd=function(t){var e=t.docs.get(this.G_);return new dy(this.firestore,this.G_,e,t.fromCache,t.hasPendingWrites,this.z_)},wy),py=(my.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},my),dy=(gy.prototype.data=function(t){var e=this;if(Jr("DocumentSnapshot.data",arguments,0,1),t=My("DocumentSnapshot.data",t),this.dd){if(this.z_){var n=new yy(this.ad,this.G_,this.dd,this.wd,this.md,null);return this.z_.fromFirestore(n,t)}return new oy(this.ad.K_,this.ad.rd(),t.serverTimestamps||"none",function(t){return new fy(t,e.ad,null)},function(t){return new Ni(t)}).Nf(this.dd.sn())}},gy.prototype.get=function(t,e){var n=this;if(Jr("DocumentSnapshot.get",arguments,1,2),e=My("DocumentSnapshot.get",e),this.dd){t=this.dd.data().field(Qd("DocumentSnapshot.get",t,this.G_));if(null!==t)return new oy(this.ad.K_,this.ad.rd(),e.serverTimestamps||"none",function(t){return new fy(t,n.ad,n.z_)},function(t){return new Ni(t)}).Nf(t)}},Object.defineProperty(gy.prototype,"id",{get:function(){return this.G_.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(gy.prototype,"ref",{get:function(){return new fy(this.G_,this.ad,this.z_)},enumerable:!1,configurable:!0}),Object.defineProperty(gy.prototype,"exists",{get:function(){return null!==this.dd},enumerable:!1,configurable:!0}),Object.defineProperty(gy.prototype,"metadata",{get:function(){return new py(this.md,this.wd)},enumerable:!1,configurable:!0}),gy.prototype.isEqual=function(t){if(!(t instanceof gy))throw ci("isEqual","DocumentSnapshot",1,t);return this.ad===t.ad&&this.wd===t.wd&&this.G_.isEqual(t.G_)&&(null===this.dd?null===t.dd:this.dd.isEqual(t.dd))&&this.z_===t.z_},gy),yy=(n(vy,ry=dy),vy.prototype.data=function(t){return ry.prototype.data.call(this,t)},vy);function vy(){return null!==ry&&ry.apply(this,arguments)||this}function gy(t,e,n,r,i,o){this.ad=t,this.G_=e,this.dd=n,this.wd=r,this.md=i,this.z_=o}function my(t,e){this.hasPendingWrites=t,this.fromCache=e}function wy(t,e,n){var r=this;return(r=iy.call(this,e.K_,t,n)||this).G_=t,r.firestore=e,r.z_=n,r.Gf=r.firestore.Kf(),r}function by(t){this.ad=t,this.hd=[],this.ld=!1}function Ey(t,e){this.ad=t,this.ud=e}function Iy(t,e,n,r){var i=this;if(void 0===n&&(n=new Up),void 0===r&&(r=new Vp),this.Uf=n,this.Qf=r,this.Wf=null,this.jf=new Wa,this.INTERNAL={delete:function(){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Kf(),[4,this.Gf.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){r=t;this.Wf=r,this.K_=Iy.zf(r),this.Hf=r.name,this.Jf=new ef(e)}else{t=t;if(!t.projectId)throw new _r(Tr.INVALID_ARGUMENT,"Must provide projectId");this.K_=new Si(t.projectId,t.database),this.Hf="[DEFAULT]",this.Jf=new tf}this.Yf=new ay({})}function Ty(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new _r(Tr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else ti("settings","non-empty string","host",t.host),this.host=t.host,ei("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(ai("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),ei("settings","object","credentials",t.credentials),this.credentials=t.credentials,ei("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),ei("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Or("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Or("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(e=t.timestampsInSnapshots)||void 0===e||e,this.ignoreUndefinedProperties=null!==(e=t.ignoreUndefinedProperties)&&void 0!==e&&e,ei("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=$c.jo;else{if(t.cacheSizeBytes!==uy&&t.cacheSizeBytes<$c.Wo)throw new _r(Tr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+$c.Wo);this.cacheSizeBytes=t.cacheSizeBytes}ei("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(t=t.experimentalForceLongPolling)&&void 0!==t&&t}function _y(){this.Lf={},this.Bf=new Aa,this.qf={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function Ay(t,e,n,r,i){this.U=t,this.timestampsInSnapshots=e,this.Sf=n,this.Df=r,this.Cf=i}function Ny(t,e,n){if("string"==typeof n){if(""===n)throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Mu(e)&&-1!==n.indexOf("/"))throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(jr.P(n));if(!Br.F(e))throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Ko(t,new Br(e))}if(n instanceof Td)return Ko(t,n.G_);throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+si(n)+".")}function Sy(t,e){if(!Array.isArray(t)||0===t.length)throw new _r(Tr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new _r(Tr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new _r(Tr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new _r(Tr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function Dy(t,e,n){if(!n.isEqual(e))throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Ry(t){if(Uu(t)&&0===t.rn.length)throw new _r(Tr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Oy,xy=(Cy.prototype.where=function(t,e,n){Xr("Query.where",arguments,3),ui("Query.where",3,n);e=ri("Query.where",["<","<=","==","!=",">=",">","array-contains","in","array-contains-any","not-in"],2,e),t=Qd("Query.where",t),e=function(t,e,n,r,i,o,s){if(i.p()){if("array-contains"===o||"array-contains-any"===o)throw new _r(Tr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Sy(s,o);for(var u=[],a=0,c=s;a<c.length;a++){var h=c[a];u.push(Ny(r,t,h))}l={arrayValue:{values:u}}}else l=Ny(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Sy(s,o),l=Gd(n,e,s,"in"===o||"not-in"===o);var l=Yu.create(i,o,l);return function(t,e){if(e.cn()){var n=Vu(t);if(null!==n&&!n.isEqual(e.field))throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=Cu(t);null!==n&&Dy(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new _r(Tr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new _r(Tr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,l),l}(this.Td,"Query.where",this.firestore.Xf,this.firestore.K_,t,e,n);return new Cy((n=this.Td,e=n.filters.concat([e]),new Du(n.path,n.collectionGroup,n.rn.slice(),e,n.limit,n.on,n.startAt,n.endAt)),this.firestore,this.z_)},Cy.prototype.orderBy=function(t,e){if(Jr("Query.orderBy",arguments,1,2),$r("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new _r(Tr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=Qd("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new _a(e,n);return e=r,null!==Cu(n=t)||null!==(t=Vu(n))&&Dy(0,t,e.field),r}(this.Td,t,n);return new Cy((n=this.Td,t=n.rn.concat([t]),new Du(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.on,n.startAt,n.endAt)),this.firestore,this.z_)},Cy.prototype.limit=function(t){return Xr("Query.limit",arguments,1),Zr("Query.limit","number",1,t),hi("Query.limit",1,t),new Cy(Gu(this.Td,t,"F"),this.firestore,this.z_)},Cy.prototype.limitToLast=function(t){return Xr("Query.limitToLast",arguments,1),Zr("Query.limitToLast","number",1,t),hi("Query.limitToLast",1,t),new Cy(Gu(this.Td,t,"L"),this.firestore,this.z_)},Cy.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Yr("Query.startAt",arguments,1);t=this.Ed("Query.startAt",t,e,!0);return new Cy(qu(this.Td,t),this.firestore,this.z_)},Cy.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Yr("Query.startAfter",arguments,1);t=this.Ed("Query.startAfter",t,e,!1);return new Cy(qu(this.Td,t),this.firestore,this.z_)},Cy.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Yr("Query.endBefore",arguments,1);t=this.Ed("Query.endBefore",t,e,!0);return new Cy(Bu(this.Td,t),this.firestore,this.z_)},Cy.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Yr("Query.endAt",arguments,1);t=this.Ed("Query.endAt",t,e,!1);return new Cy(Bu(this.Td,t),this.firestore,this.z_)},Cy.prototype.isEqual=function(t){if(!(t instanceof Cy))throw ci("isEqual","Query",1,t);return this.firestore===t.firestore&&zu(this.Td,t.Td)&&this.z_===t.z_},Cy.prototype.withConverter=function(t){return new Cy(this.Td,this.firestore,t)},Cy.prototype.Ed=function(c,t,e,n){if(ui(c,1,t),t instanceof dy)return Xr(c,i([t],e),1),function(t,e,n,r){if(!n)throw new _r(Tr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=Fu(t);o<s.length;o++){var u=s[o];if(u.field.p())i.push(Ko(e,n.key));else{var a=n.field(u.field);if(Lo(a))throw new _r(Tr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.R();throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new va(i,r)}(this.Td,this.firestore.K_,t.dd,n);e=[t].concat(e);return function(t,e,n,r,i,o){var s=t.rn;if(i.length>s.length)throw new _r(Tr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.p()){if("string"!=typeof c)throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Mu(t)&&-1!==c.indexOf("/"))throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(jr.P(c));if(!Br.F(h))throw new _r(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new Br(h);u.push(Ko(e,h))}else{c=Gd(n,r,c);u.push(c)}}return new va(u,o)}(this.Td,this.firestore.K_,this.firestore.Xf,c,e,n)},Cy.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Jr("Query.onSnapshot",arguments,1,4);var i={},o=0;"object"!=typeof n[o]||ny(n[o])||(ai("Query.onSnapshot",i=n[o],["includeMetadataChanges"]),ei("Query.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),o++),ny(n[o])?(s=n[o],n[o]=null===(t=s.next)||void 0===t?void 0:t.bind(s),n[o+1]=null===(t=s.error)||void 0===t?void 0:t.bind(s),n[o+2]=null===(t=s.complete)||void 0===t?void 0:t.bind(s)):(Zr("Query.onSnapshot","function",o,n[o]),$r("Query.onSnapshot","function",o+1,n[o+1]),$r("Query.onSnapshot","function",o+2,n[o+2]));var s={next:function(t){n[o]&&n[o](new ky(e.firestore,e.Td,t,e.z_))},error:n[o+1],complete:n[o+2]};return Ry(this.Td),this.firestore.Kf().listen(this.Td,i,s)},Cy.prototype.get=function(t){var e=this;Jr("Query.get",arguments,0,1),Fy("Query.get",t),Ry(this.Td);var n=this.firestore.Kf();return(t&&"cache"===t.source?n.Vf(this.Td):n.pf(this.Td,t)).then(function(t){return new ky(e.firestore,e.Td,t,e.z_)})},Cy),ky=(Object.defineProperty(Uy.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Uy.prototype,"empty",{get:function(){return this.Ad.docs.m()},enumerable:!1,configurable:!0}),Object.defineProperty(Uy.prototype,"size",{get:function(){return this.Ad.docs.size},enumerable:!1,configurable:!0}),Uy.prototype.forEach=function(e,n){var r=this;Jr("QuerySnapshot.forEach",arguments,1,2),Zr("QuerySnapshot.forEach","function",1,e),this.Ad.docs.forEach(function(t){e.call(n,r.yd(t,r.metadata.fromCache,r.Ad.Qt.has(t.key)))})},Object.defineProperty(Uy.prototype,"query",{get:function(){return new xy(this.Id,this.ad,this.z_)},enumerable:!1,configurable:!0}),Uy.prototype.docChanges=function(t){t&&(ai("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),ei("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));t=!(!t||!t.includeMetadataChanges);if(t&&this.Ad.jt)throw new _r(Tr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Rd&&this.Pd===t||(this.Rd=function(i,e,o){if(i.Ut.m()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Ut;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Lr()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this.Ad,t,this.yd.bind(this)),this.Pd=t),this.Rd},Uy.prototype.isEqual=function(t){if(!(t instanceof Uy))throw ci("isEqual","QuerySnapshot",1,t);return this.ad===t.ad&&zu(this.Id,t.Id)&&this.Ad.isEqual(t.Ad)&&this.z_===t.z_},Uy.prototype.yd=function(t,e,n){return new yy(this.ad,t.key,t,e,n,this.z_)},Uy),Ly=(n(Py,Oy=xy),Object.defineProperty(Py.prototype,"id",{get:function(){return this.Td.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Py.prototype,"parent",{get:function(){var t=this.Td.path.h();return t.m()?null:new fy(new Br(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Py.prototype,"path",{get:function(){return this.Td.path.R()},enumerable:!1,configurable:!0}),Py.prototype.doc=function(t){Jr("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=pi.k()),Zr("CollectionReference.doc","non-empty string",1,t);t=jr.P(t);return fy.sd(this.Td.path.child(t),this.firestore,this.z_)},Py.prototype.add=function(t){Xr("CollectionReference.add",arguments,1);t=this.z_?this.z_.toFirestore(t):t;Zr("CollectionReference.add","object",1,t);var e=this.doc();return new fy(e.G_,this.firestore,null).set(t).then(function(){return e})},Py.prototype.withConverter=function(t){return new Py(this.gd,this.firestore,t)},Py);function Py(t,e,n){var r=this;if(((r=Oy.call(this,Lu(t),e,n)||this).gd=t).length%2!=1)throw new _r(Tr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.R()+" has "+t.length);return r}function Uy(t,e,n,r){this.ad=t,this.Id=e,this.Ad=n,this.z_=r,this.Rd=null,this.Pd=null,this.metadata=new py(n.hasPendingWrites,n.fromCache)}function Cy(t,e,n){this.Td=t,this.firestore=e,this.z_=n}function Vy(t,e){if(void 0===e)return{merge:!1};if(ai(t,e,["merge","mergeFields"]),ei(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n,r){if(!(n instanceof Array))throw new _r(Tr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+si(n));for(var i=0;i<n.length;++i)if(!r(n[i]))throw new _r(Tr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+si(n[i]))}(t,"mergeFields",n,function(t){return"string"==typeof t||t instanceof jp}),void 0!==e.mergeFields&&void 0!==e.merge)throw new _r(Tr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function My(t,e){return void 0===e?{}:(ai(t,e,["serverTimestamps"]),ni(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Fy(t,e){$r(t,"object",1,e),e&&(ai(t,e,["source"]),ni(t,0,"source",e.source,["default","server","cache"]))}function jy(t,e,n){if(e instanceof Td){if(e.firestore!==n)throw new _r(Tr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw ci(t,"DocumentReference",1,e)}function Gy(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var qy,By,Ie=(n(Ky,qy=Ed),Ky.serverTimestamp=function(){Wr("FieldValue.serverTimestamp",arguments);var t=new vd("serverTimestamp");return t.x_="FieldValue.serverTimestamp",new Ky(t)},Ky.delete=function(){Wr("FieldValue.delete",arguments);var t=new Bp("deleteField");return t.x_="FieldValue.delete",new Ky(t)},Ky.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Yr("FieldValue.arrayUnion",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Yr("arrayUnion()",arguments,1),new gd("arrayUnion",t)}.apply(void 0,t);return n.x_="FieldValue.arrayUnion",new Ky(n)},Ky.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Yr("FieldValue.arrayRemove",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Yr("arrayRemove()",arguments,1),new md("arrayRemove",t)}.apply(void 0,t);return n.x_="FieldValue.arrayRemove",new Ky(n)},Ky.increment=function(t){Zr("FieldValue.increment","number",1,t),Xr("FieldValue.increment",arguments,1);t=new wd("increment",t);return t.x_="FieldValue.increment",new Ky(t)},Ky.prototype.isEqual=function(t){return this.j_.isEqual(t.j_)},Ky),zy={Firestore:cy,GeoPoint:bd,Timestamp:Ri,Blob:Ni,Transaction:hy,WriteBatch:ly,DocumentReference:fy,DocumentSnapshot:dy,Query:xy,QueryDocumentSnapshot:yy,QuerySnapshot:ky,CollectionReference:Ly,FieldPath:jp,FieldValue:Ie,setLogLevel:cy.setLogLevel,CACHE_SIZE_UNLIMITED:uy};function Ky(){return null!==qy&&qy.apply(this,arguments)||this}(By=e.default).INTERNAL.registerComponent(new br("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),r=new Vp,t=new Cp(r),new cy(e,n,t,r);var e,n,r},"PUBLIC").setServiceProps(Object.assign({},zy))),By.registerVersion("@firebase/firestore","1.17.2-alpha.6b865e005")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.js.map

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(tp){"use strict";try{(function(){var t,a,e,n,r=(n=tp)&&"object"==typeof n&&"default"in n?n:{default:n},i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function o(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function w(t,s,a,u){return new(a=a||Promise)(function(n,e){function r(t){try{o(u.next(t))}catch(t){e(t)}}function i(t){try{o(u.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(r,i)}o((u=u.apply(t,s||[])).next())})}function b(n,r){var i,o,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(n,a)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}function u(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}function h(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=f[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,u(["["+i+"]  "+t.name+":"],n))}}(e=a=a||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";var c={debug:a.DEBUG,verbose:a.VERBOSE,info:a.INFO,warn:a.WARN,error:a.ERROR,silent:a.SILENT},l=a.INFO,f=((t={})[a.DEBUG]="log",t[a.VERBOSE]="log",t[a.INFO]="info",t[a.WARN]="warn",t[a.ERROR]="error",t),p=(Object.defineProperty(d.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in a))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),d.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?c[t]:t},Object.defineProperty(d.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),d.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,a.DEBUG],t)),this._logHandler.apply(this,u([this,a.DEBUG],t))},d.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,a.VERBOSE],t)),this._logHandler.apply(this,u([this,a.VERBOSE],t))},d.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,a.INFO],t)),this._logHandler.apply(this,u([this,a.INFO],t))},d.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,a.WARN],t)),this._logHandler.apply(this,u([this,a.WARN],t))},d.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,a.ERROR],t)),this._logHandler.apply(this,u([this,a.ERROR],t))},d);function d(t){this.name=t,this._logLevel=l,this._logHandler=h,this._userLogHandler=null}function v(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var y,g="FirebaseError",m=(o(E,y=Error),E);function E(t,e){var n=y.call(this,e)||this;return n.code=t,n.name=g,Object.setPrototypeOf(n,E.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,I.prototype.create),n}var I=(T.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],a=s?(r=i,s.replace(A,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",u=this.serviceName+": "+a+" ("+o+").",h=new m(o,u),c=0,l=Object.keys(i);c<l.length;c++){var f=l[c];"_"!==f.slice(-1)&&(f in h&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),h[f]=i[f])}return h},T);function T(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var A=/\{\$([^}]+)}/g,N=function(t,e){return(N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function R(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var S,L="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},k=L||self;function O(){}function D(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function P(t){var e=D(t);return"array"==e||"object"==e&&"number"==typeof t.length}function V(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var _="closure_uid_"+(1e9*Math.random()>>>0),C=0;function U(t,e,n){return t.call.apply(t.bind,arguments)}function M(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function j(t,e,n){return(j=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?U:M).apply(null,arguments)}function G(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var x=Date.now;function F(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function q(){this.j=this.j,this.i=this.i}q.prototype.j=!1,q.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,_)&&this[_]||(this[_]=++C))},q.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var B=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Q=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function z(t){return Array.prototype.concat.apply([],arguments)}function W(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var K,X=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function J(t,e){return t<e?-1:e<t?1:0}t:{var Z=k.navigator;if(Z){var $=Z.userAgent;if($){K=$;break t}}K=""}function tt(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function et(t){var e,n={};for(e in t)n[e]=t[e];return n}var nt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function rt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<nt.length;o++)n=nt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function it(t){return it[" "](t),t}it[" "]=O;var ot,st,at=Y(K,"Opera"),ut=Y(K,"Trident")||Y(K,"MSIE"),ht=Y(K,"Edge"),ct=ht||ut,lt=Y(K,"Gecko")&&!(Y(K.toLowerCase(),"webkit")&&!Y(K,"Edge"))&&!(Y(K,"Trident")||Y(K,"MSIE"))&&!Y(K,"Edge"),ft=Y(K.toLowerCase(),"webkit")&&!Y(K,"Edge");function pt(){var t=k.document;return t?t.documentMode:void 0}t:{var dt="",vt=(st=K,lt?/rv:([^\);]+)(\)|;)/.exec(st):ht?/Edge\/([\d\.]+)/.exec(st):ut?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(st):ft?/WebKit\/(\S+)/.exec(st):at?/(?:Version)[ \/]?(\S+)/.exec(st):void 0);if(vt&&(dt=vt?vt[1]:""),ut){var yt=pt();if(null!=yt&&yt>parseFloat(dt)){ot=String(yt);break t}}ot=dt}var gt={};function mt(a){return t=a,e=function(){for(var t=0,e=X(String(ot)).split("."),n=X(String(a)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=J(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||J(0==o[2].length,0==s[2].length)||J(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=gt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var wt=k.document&&ut&&(pt()||parseInt(ot,10))||void 0,bt=!ut||9<=Number(wt),Et=ut&&!mt("9"),It=function(){if(!k.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{k.addEventListener("test",O,e),k.removeEventListener("test",O,e)}catch(t){}return t}();function Tt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function At(t,e){if(Tt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(lt){t:{try{it(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Nt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Tt.prototype.b=function(){this.defaultPrevented=!0},F(At,Tt);var Nt={2:"touch",3:"pen",4:"mouse"};At.prototype.b=function(){At.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Et)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Rt="closure_listenable_"+(1e6*Math.random()|0),St=0;function Lt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++St,this.Y=this.Z=!1}function kt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Ot(t){this.src=t,this.a={},this.b=0}function Dt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=B(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(kt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Pt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Ot.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Pt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Lt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Vt="closure_lm_"+(1e6*Math.random()|0),_t={};function Ct(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Bt(r),e&&e[Rt]?e.wa(n,r,V(i)?!!i.capture:!!i,o):Ut(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ct(t,e[o],n,r,i);return null}return n=Bt(n),t&&t[Rt]?t.va(e,n,V(r)?!!r.capture:!!r,i):Ut(t,e,n,!1,r,i)}function Ut(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=V(i)?!!i.capture:!!i;if(s&&!bt)return null;var a,u,h=Ft(t);if(h||(t[Vt]=h=new Ot(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(a=xt,r=u=bt?function(t){return a.call(u.src,u.listener,t)}:function(t){if(!(t=a.call(u.src,u.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)It||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(jt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Mt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Rt]?Dt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(jt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ft(e))?(Dt(n,t),0==n.b&&(n.src=null,e[Vt]=null)):kt(t)))}function jt(t){return t in _t?_t[t]:_t[t]="on"+t}function Gt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Mt(t),n.call(r,e)}function xt(t,e){if(t.Y)return!0;if(bt)return Gt(t,new At(e,this));if(!e)t:{e=["window","event"];for(var n=k,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Gt(t,e=new At(e,this))}function Ft(t){return(t=t[Vt])instanceof Ot?t:null}var qt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Bt(e){return"function"==D(e)?e:(e[qt]||(e[qt]=function(t){return e.handleEvent(t)}),e[qt])}function Qt(){q.call(this),this.c=new Ot(this),(this.J=this).C=null}function zt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,a,u=e[o];u&&!u.Y&&u.capture==n&&(s=u.listener,a=u.ca||u.src,u.Z&&Dt(t.c,u),i=!1!==s.call(a,r)&&i)}return i&&!r.defaultPrevented}F(Qt,q),Qt.prototype[Rt]=!0,(S=Qt.prototype).addEventListener=function(t,e,n,r){Ct(this,t,e,n,r)},S.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=V(i)?!!i.capture:!!i,r=Bt(r),e&&e[Rt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Pt(s=e.a[n],r,i,o))&&(kt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ft(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Pt(n,r,i,o)),(r=-1<e?n[e]:null)&&Mt(r))}(this,t,e,n,r)},S.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new Tt(t,n):t instanceof Tt?t.target=t.target||n:(s=t,rt(t=new Tt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=zt(o,r,!0,t)&&s;if(s=zt(o=t.a=n,r,!0,t)&&s,s=zt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=zt(o=t.a=e[i],r,!1,t)&&s;return s},S.G=function(){if(Qt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)kt(n[r]);delete e.a[t],e.b--}}this.C=null},S.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},S.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Wt=k.JSON.stringify;function Ht(){this.b=this.a=null}var Kt,Xt=(Yt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Yt(function(){return new Jt},function(t){t.reset()},100));function Yt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Jt(){this.next=this.b=this.a=null}function Zt(t,e){var n;Kt||(n=k.Promise.resolve(void 0),Kt=function(){n.then(ee)}),$t||(Kt(),$t=!0),te.add(t,e)}Ht.prototype.add=function(t,e){var n=Xt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Jt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var $t=!(Jt.prototype.reset=function(){this.next=this.b=this.a=null}),te=new Ht;function ee(){for(var t,e,n;n=e=void 0,n=null,(e=te).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){k.setTimeout(function(){throw t},0)}(t)}var r=Xt;r.g(t),r.b<r.f&&(r.b++,t.next=r.a,r.a=t)}$t=!1}function ne(t,e){Qt.call(this),this.b=t||1,this.a=e||k,this.f=j(this.Ya,this),this.g=x()}function re(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ie(t,e,n){if("function"==D(t))n&&(t=j(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=j(t.handleEvent,t)}return 2147483647<Number(e)?-1:k.setTimeout(t,e||0)}F(ne,Qt),(S=ne.prototype).aa=!1,S.M=null,S.Ya=function(){var t;this.aa&&(0<(t=x()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(re(this),this.start())))},S.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=x())},S.G=function(){ne.S.G.call(this),re(this),delete this.a};var oe,se,ae,ue=(N(se=ce,ae=oe=q),se.prototype=null===ae?Object.create(ae):(he.prototype=ae.prototype,new he),ce.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ie(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ce.prototype.G=function(){oe.prototype.G.call(this),this.a&&(k.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ce);function he(){this.constructor=se}function ce(t,e,n){var r=oe.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function le(t){q.call(this),this.b=t,this.a={}}F(le,q);var fe=[];function pe(t,e,n,r){Array.isArray(n)||(n&&(fe[0]=n.toString()),n=fe);for(var i=0;i<n.length;i++){var o=Ct(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function de(t){tt(t.a,function(t,e){this.a.hasOwnProperty(e)&&Mt(t)},t),t.a={}}function ve(){this.a=!0}function ye(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Wt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}le.prototype.G=function(){le.S.G.call(this),de(this)},le.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ve.prototype.info=function(){};var ge=null;function me(){return ge=ge||new Qt}function we(t){Tt.call(this,"serverreachability",t)}function be(){var t=me();t.dispatchEvent(new we(t))}function Ee(t){Tt.call(this,"statevent",t)}function Ie(){var t=me();t.dispatchEvent(new Ee(t))}function Te(t){Tt.call(this,"timingevent",t)}function Ae(t,e){if("function"!=D(t))throw Error("Fn must not be null and must be a function");return k.setTimeout(function(){t()},e)}F(we,Tt),F(Ee,Tt),F(Te,Tt);var Ne={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Re={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Se(){}function Le(t){var e;return(e=t.a)||(e=t.a={}),e}function ke(){}Se.prototype.a=null;var Oe,De={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Pe(){Tt.call(this,"d")}function Ve(){Tt.call(this,"c")}function _e(){}function Ce(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new le(this),this.P=Ue,t=ct?125:void 0,this.R=new ne(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}F(Pe,Tt),F(Ve,Tt),F(_e,Se),Oe=new _e;var Ue=45e3,Me={},je={};function Ge(t,e,n){t.H=1,t.i=an(tn(e)),t.j=n,t.I=!0,xe(t,null)}function xe(t,e){t.u=x(),qe(t),t.l=tn(t.i);var s,a,u,h,c,l,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),bn(n.b,"t",r),t.D=0,t.a=pr(t.g,t.g.C?e:null),0<t.O&&(t.F=new ue(j(t.Ca,t,t.a),t.O)),pe(t.J,t.a,"readystatechange",t.Wa),e=t.B?et(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),be(),s=t.c,a=t.m,u=t.l,h=t.f,c=t.T,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+a+"\n"+u+"\n"+t})}function Fe(t,e,n){for(var r,i,o,s,a=!0;!t.A&&t.D<n.length;){var u=(i=n,s=o=void 0,o=(r=t).D,-1==(s=i.indexOf("\n",o))?je:(o=Number(i.substring(o,s)),isNaN(o)?Me:(s+=1)+o>i.length?je:(i=i.substr(s,o),r.D=s+o,i)));if(u==je){4==e&&(t.h=4,Ie(),a=!1),ye(t.c,t.f,null,"[Incomplete Response]");break}if(u==Me){t.h=4,Ie(),ye(t.c,t.f,n,"[Invalid Chunk]"),a=!1;break}ye(t.c,t.f,u,null),He(t,u)}4==e&&0==n.length&&(t.h=1,Ie(),a=!1),t.b=t.b&&a,a?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),or(e),e.F=!0)):(ye(t.c,t.f,n,"[Invalid Chunked Response]"),We(t),ze(t))}function qe(t){t.U=x()+t.P,Be(t,t.P)}function Be(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ae(j(t.Ua,t),e)}function Qe(t){t.o&&(k.clearTimeout(t.o),t.o=null)}function ze(t){0==t.g.v||t.A||ur(t.g,t)}function We(t){Qe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,re(t.R),de(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function He(t,e){try{var n,r,i,o,s,a,u,h,c,l,f,p=t.g;if(0!=p.v&&(p.a==t||Sn(p.b,t)))if(p.I=t.N,!t.C&&Sn(p.b,t)&&3==p.v){try{var d=p.ka.a.parse(e)}catch(t){d=null}if(Array.isArray(d)&&3==d.length){var v=d;if(0==v[0]){t:if(!p.j){if(p.a){if(!(p.a.u+3e3<t.u))break t;ar(p),Yn(p)}ir(p),Ie()}}else p.oa=v[1],0<p.oa-p.P&&v[2]<37500&&p.H&&0==p.o&&!p.m&&(p.m=Ae(j(p.Ra,p),6e3));if(Rn(p.b)<=1&&p.ea){try{p.ea()}catch(t){}p.ea=void 0}}else cr(p,11)}else if(!t.C&&p.a!=t||ar(p),!H(e))for(e=d=p.ka.a.parse(e),d=0;d<e.length;d++)v=e[d],p.P=v[0],v=v[1],2==p.v?"c"==v[0]?(p.J=v[1],p.ga=v[2],null!=(n=v[3])&&(p.ha=n,p.c.info("VER="+p.ha)),null!=(r=v[4])&&(p.pa=r,p.c.info("SVER="+p.pa)),null!=(i=v[5])&&"number"==typeof i&&0<i&&(o=1.5*i,p.D=o,p.c.info("backChannelRequestTimeoutMs_="+o)),o=p,(s=t.a)&&(!(a=s.a?s.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(u=o.b).a&&(Y(a,"spdy")||Y(a,"quic")||Y(a,"h2"))&&(u.f=u.g,u.a=new Set,u.b&&(Ln(u,u.b),u.b=null)),!o.A||(h=s.a?s.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(o.na=h,sn(o.B,o.A,h))),p.v=3,p.f&&p.f.ta(),p.V&&(p.N=x()-t.u,p.c.info("Handshake RTT: "+p.N+"ms")),c=t,(o=p).la=fr(o,o.C?o.ga:null,o.fa),c.C?(kn(o.b,c),l=c,(f=o.D)&&l.setTimeout(f),l.o&&(Qe(l),qe(l)),o.a=c):rr(o),0<p.g.length&&$n(p)):"stop"!=v[0]&&"close"!=v[0]||cr(p,7):3==p.v&&("stop"==v[0]||"close"==v[0]?"stop"==v[0]?cr(p,7):Xn(p):"noop"!=v[0]&&p.f&&p.f.sa(v),p.o=0);be()}catch(t){}}function Ke(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(P(t)||"string"==typeof t)Q(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(P(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(P(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Xe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Xe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Ye(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Je(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Je(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Je(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(S=Ce.prototype).setTimeout=function(t){this.P=t},S.Wa=function(t){t=t.target;var e=this.F;e&&3==zn(t)?e.f():this.Ca(t)},S.Ca=function(t){try{if(t==this.a)t:{var e=zn(this.a),n=this.a.ua();this.a.X();if(!(e<3||3==e&&!ct&&!this.a.$())){this.A||4!=e||7==n||be(),Qe(this);var r=this.a.X();this.N=r;var i=this.a.$();if(this.b=200==r,u=this.c,h=this.m,c=this.l,l=this.f,f=this.T,p=e,d=r,u.info(function(){return"XMLHTTP RESP ("+l+") [ attempt "+f+"]: "+h+"\n"+c+"\n"+p+" "+d}),this.b){if(this.V&&!this.C){e:{if(this.a){var o,s=this.a;if((o=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(o)){var a=o;break e}}a=null}if(!a){this.b=!1,this.h=3,Ie(),We(this),ze(this);break t}ye(this.c,this.f,a,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,He(this,a)}this.I?(Fe(this,e,i),ct&&this.b&&3==e&&(pe(this.J,this.R,"tick",this.Va),this.R.start())):(ye(this.c,this.f,i,null),He(this,i)),4==e&&We(this),this.b&&!this.A&&(4==e?ur(this.g,this):(this.b=!1,qe(this)))}else 400==r&&0<i.indexOf("Unknown SID")?this.h=3:this.h=0,Ie(),We(this),ze(this)}}}catch(t){}var u,h,c,l,f,p,d},S.Va=function(){var t,e;this.a&&(t=zn(this.a),e=this.a.$(),this.D<e.length&&(Qe(this),Fe(this,t,e),this.b&&4!=t&&qe(this)))},S.cancel=function(){this.A=!0,We(this)},S.Ua=function(){this.o=null;var t,e,n=x();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(be(),Ie()),We(this),this.h=2,ze(this)):Be(this,this.U-n)},(S=Xe.prototype).K=function(){Ye(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},S.L=function(){return Ye(this),this.a.concat()},S.get=function(t,e){return Je(this.b,t)?this.b[t]:e},S.set=function(t,e){Je(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},S.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ze=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function $e(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof $e?(this.a=void 0!==e?e:t.a,en(this,t.f),this.j=t.j,nn(this,t.c),rn(this,t.h),this.g=t.g,e=t.b,(n=new yn).c=e.c,e.a&&(n.a=new Xe(e.a),n.b=e.b),on(this,n),this.i=t.i):t&&(n=String(t).match(Ze))?(this.a=!!e,en(this,n[1]||"",!0),this.j=un(n[2]||""),nn(this,n[3]||"",!0),rn(this,n[4]),this.g=un(n[5]||"",!0),on(this,n[6]||"",!0),this.i=un(n[7]||"")):(this.a=!!e,this.b=new yn(null,this.a))}function tn(t){return new $e(t)}function en(t,e,n){t.f=n?un(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function nn(t,e,n){t.c=n?un(e,!0):e}function rn(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function on(t,e,n){var r,i;e instanceof yn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(gn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(mn(this,e),bn(this,n,t))},r)),r.f=i):(n||(e=hn(e,dn)),t.b=new yn(e,t.a))}function sn(t,e,n){t.b.set(e,n)}function an(t){return sn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^x()).toString(36)),t}function un(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function hn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,cn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function cn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}$e.prototype.toString=function(){var t=[],e=this.f;e&&t.push(hn(e,ln,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(hn(e,ln,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(hn(n,"/"==n.charAt(0)?pn:fn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",hn(n,vn)),t.join("")};var ln=/[#\/\?@]/g,fn=/[#\?:]/g,pn=/[#\?]/g,dn=/[#\?@]/g,vn=/#/g;function yn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function gn(a){a.a||(a.a=new Xe,a.b=0,a.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",a.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(a.c))}function mn(t,e){gn(t),e=En(t,e),Je(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Je((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Ye(t)))}function wn(t,e){return gn(t),e=En(t,e),Je(t.a.b,e)}function bn(t,e,n){mn(t,e),0<n.length&&(t.c=null,t.a.set(En(t,e),W(n)),t.b+=n.length)}function En(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function In(t,e){this.b=t,this.a=e}function Tn(t){this.g=t||An,t=k.PerformanceNavigationTiming?0<(t=k.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(k.ia&&k.ia.ya&&k.ia.ya()&&k.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(S=yn.prototype).add=function(t,e){gn(this),this.c=null,t=En(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},S.forEach=function(n,r){gn(this),this.a.forEach(function(t,e){Q(t,function(t){n.call(r,t,e,this)},this)},this)},S.L=function(){gn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},S.K=function(t){gn(this);var e=[];if("string"==typeof t)wn(this,t)&&(e=z(e,this.a.get(En(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},S.set=function(t,e){return gn(this),this.c=null,wn(this,t=En(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},S.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},S.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var An=10;function Nn(t){return t.b||t.a&&t.a.size>=t.f}function Rn(t){return t.b?1:t.a?t.a.size:0}function Sn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Ln(t,e){t.a?t.a.add(e):t.b=e}function kn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function On(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return W(t.c);var r=t.c;try{for(var i=R(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Dn(){}function Pn(){this.a=new Dn}function Vn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}Tn.prototype.cancel=function(){var t,e;if(this.c=On(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=R(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Dn.prototype.stringify=function(t){return k.JSON.stringify(t,void 0)},Dn.prototype.parse=function(t){return k.JSON.parse(t,void 0)};var _n=k.JSON.parse;function Cn(t){Qt.call(this),this.headers=new Xe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Un,this.D=this.F=!1}F(Cn,Qt);var Un="",Mn=/^https?$/i,jn=["POST","PUT"];function Gn(t){return"content-type"==t.toLowerCase()}function xn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Fn(t),Bn(t)}function Fn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function qn(t){if(t.b&&(!t.s[1]||4!=zn(t)||2!=t.X()))if(t.l&&4==zn(t))ie(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==zn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Ze)[1]||null)&&k.self&&k.self.location&&(i=(r=k.self.location.protocol).substr(0,r.length-1)),n=!Mn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var a=2<zn(t)?t.a.statusText:""}catch(t){a=""}t.f=a+" ["+t.X()+"]",Fn(t)}}finally{Bn(t)}}}function Bn(t,e){if(t.a){Qn(t);var n=t.a,r=t.s[0]?O:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Qn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(k.clearTimeout(t.m),t.m=null)}function zn(t){return t.a?t.a.readyState:0}function Wn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",tt(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):sn(t,e,n))}function Hn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Kn(t){this.pa=0,this.g=[],this.c=new ve,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Hn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Hn("baseRetryDelayMs",5e3,t),this.Ma=Hn("retryDelaySeedMs",1e4,t),this.Ja=Hn("forwardChannelMaxRetries",2,t),this.ma=Hn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new Tn(t&&t.concurrentRequestLimit),this.ka=new Pn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Xn(t){var e,n;Jn(t),3==t.v&&(e=t.R++,sn(n=tn(t.B),"SID",t.J),sn(n,"RID",e),sn(n,"TYPE","terminate"),er(t,n),(e=new Ce(t,t.c,e,void 0)).H=2,e.i=an(tn(n)),n=!1,k.navigator&&k.navigator.sendBeacon&&(n=k.navigator.sendBeacon(e.i.toString(),"")),!n&&k.Image&&((new Image).src=e.i,n=!0),n||(e.a=pr(e.g,null),e.a.ba(e.i)),e.u=x(),qe(e)),lr(t)}function Yn(t){t.a&&(or(t),t.a.cancel(),t.a=null)}function Jn(t){Yn(t),t.j&&(k.clearTimeout(t.j),t.j=null),ar(t),t.b.cancel(),t.h&&("number"==typeof t.h&&k.clearTimeout(t.h),t.h=null)}function Zn(t,e){t.g.push(new In(t.La++,e)),3==t.v&&$n(t)}function $n(t){Nn(t.b)||t.h||(t.h=!0,Zt(t.Ba,t),t.u=0)}function tr(t,e){var n=e?e.f:t.R++,r=tn(t.B);sn(r,"SID",t.J),sn(r,"RID",n),sn(r,"AID",t.P),er(t,r),t.i&&t.l&&Wn(r,t.i,t.l),n=new Ce(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=nr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Ln(t.b,n),Ge(n,r,e)}function er(t,n){t.f&&Ke({},function(t,e){sn(n,e,t)})}function nr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?j(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var h=i[u].b,c=i[u].a;if((h-=o)<0)o=Math.max(0,i[u].b-100),a=!1;else try{!function(t,r){var i="req"+h+"_"||"";try{Ke(t,function(t,e){var n=t;V(t)&&(n=Wt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s)}catch(t){r&&r(c)}}if(a){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function rr(t){t.a||t.j||(t.U=1,Zt(t.Aa,t),t.o=0)}function ir(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=Ae(j(t.Aa,t),hr(t,t.o)),t.o++,1)}function or(t){null!=t.s&&(k.clearTimeout(t.s),t.s=null)}function sr(t){t.a=new Ce(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=tn(t.la);sn(e,"RID","rpc"),sn(e,"SID",t.J),sn(e,"CI",t.H?"0":"1"),sn(e,"AID",t.P),er(t,e),sn(e,"TYPE","xmlhttp"),t.i&&t.l&&Wn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=an(tn(e)),n.j=null,n.I=!0,xe(n,t)}function ar(t){null!=t.m&&(k.clearTimeout(t.m),t.m=null)}function ur(t,e){var n,r=null;if(t.a==e){ar(t),or(t),t.a=null;var i=2}else{if(!Sn(t.b,e))return;r=e.s,kn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b)1==i?(r=e.j?e.j.length:0,e=x()-e.u,n=t.u,(i=me()).dispatchEvent(new Te(i)),$n(t)):rr(t);else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(Rn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=Ae(j(t.Ba,t,e),hr(t,t.u)),t.u++,1}}(t,e)||2==i&&ir(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:cr(t,5);break;case 4:cr(t,10);break;case 3:cr(t,6);break;default:cr(t,2)}}function hr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function cr(t,e){var n,r,i,o,s,a;t.c.info("Error code "+e),2==e?(n=null,t.f&&(n=null),r=j(t.Xa,t),n||(n=new $e("//www.google.com/images/cleardot.gif"),k.location&&"http"==k.location.protocol||en(n,"https"),an(n)),i=n.toString(),o=r,a=new ve,k.Image?((s=new Image).onload=G(Vn,a,s,"TestLoadImage: loaded",!0,o),s.onerror=G(Vn,a,s,"TestLoadImage: error",!1,o),s.onabort=G(Vn,a,s,"TestLoadImage: abort",!1,o),s.ontimeout=G(Vn,a,s,"TestLoadImage: timeout",!1,o),k.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=i):o(!1)):Ie(),t.v=0,t.f&&t.f.ra(e),lr(t),Jn(t)}function lr(t){t.v=0,t.I=-1,t.f&&(0==On(t.b).length&&0==t.g.length||(t.b.c.length=0,W(t.g),t.g.length=0),t.f.qa())}function fr(t,e,n){var r,i,o,s,a,u,h,c=(r=n)instanceof $e?tn(r):new $e(r,void 0);return""!=c.c?(e&&nn(c,e+"."+c.c),rn(c,c.h)):(o=(i=k.location).protocol,s=e?e+"."+i.hostname:i.hostname,a=+i.port,u=n,h=new $e(null,void 0),o&&en(h,o),s&&nn(h,s),a&&rn(h,a),u&&(h.g=u),c=h),t.W&&tt(t.W,function(t,e){sn(c,e,t)}),e=t.A,n=t.na,e&&n&&sn(c,e,n),sn(c,"VER",t.ha),er(t,c),c}function pr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Cn(t.Ka)).F=t.C,e}function dr(){}function vr(){if(ut&&!(10<=Number(wt)))throw Error("Environmental error: no available transport.")}function yr(t,e){Qt.call(this),this.a=new Kn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new wr(this)}function gr(t){Pe.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function mr(){Ve.call(this),this.status=1}function wr(t){this.a=t}(S=Cn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Le(this.H):Le(Oe),this.a.onreadystatechange=j(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void xn(this,t)}t=n||"";var i,o=new Xe(this.headers);r&&Ke(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Gn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=k.FormData&&t instanceof k.FormData,0<=B(jn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Qn(this),0<this.o&&((this.D=(i=this.a,ut&&mt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=j(this.xa,this)):this.m=ie(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){xn(this,t)}},S.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},S.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Bn(this))},S.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Bn(this,!0)),Cn.S.G.call(this)},S.za=function(){this.j||(this.A||this.l||this.g?qn(this):this.Ta())},S.Ta=function(){qn(this)},S.X=function(){try{return 2<zn(this)?this.a.status:-1}catch(t){return-1}},S.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},S.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),_n(e)}},S.ua=function(){return this.h},S.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(S=Kn.prototype).ha=8,S.v=1,S.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ce(this,this.c,t,void 0),r=this.l;if(this.O&&(r?rt(r=et(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=nr(this,n,e),sn(i=tn(this.B),"RID",t),sn(i,"CVER",22),this.A&&sn(i,"X-HTTP-Session-Id",this.A),er(this,i),this.i&&r&&Wn(i,this.i,r),Ln(this.b,n),this.Ga&&sn(i,"TYPE","init"),this.da?(sn(i,"$req",e),sn(i,"SID","null"),n.V=!0,Ge(n,i,null)):Ge(n,i,e),this.v=2}}else 3==this.v&&(t?tr(this,t):0==this.g.length||Nn(this.b)||tr(this))},S.Aa=function(){var t;this.j=null,sr(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Ae(j(this.Sa,this),t))},S.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Yn(this),sr(this))},S.Ra=function(){null!=this.m&&(this.m=null,Yn(this),ir(this),Ie())},S.Xa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),Ie()},(S=dr.prototype).ta=function(){},S.sa=function(){},S.ra=function(){},S.qa=function(){},S.Ha=function(){},vr.prototype.a=function(t,e){return new yr(t,e)},F(yr,Qt),(S=yr.prototype).addEventListener=function(t,e,n,r){yr.S.addEventListener.call(this,t,e,n,r)},S.removeEventListener=function(t,e,n,r){yr.S.removeEventListener.call(this,t,e,n,r)},S.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;Ie(),t.fa=e,t.W=n||{},t.H=t.T,t.B=fr(t,null,t.fa),$n(t)},S.close=function(){Xn(this.a)},S.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Zn(this.a,e)):this.g?((e={}).__data__=Wt(t),Zn(this.a,e)):Zn(this.a,t)},S.G=function(){this.a.f=null,delete this.f,Xn(this.a),delete this.a,yr.S.G.call(this)},F(gr,Pe),F(mr,Ve),F(wr,dr),wr.prototype.ta=function(){this.a.dispatchEvent("a")},wr.prototype.sa=function(t){this.a.dispatchEvent(new gr(t))},wr.prototype.ra=function(t){this.a.dispatchEvent(new mr)},wr.prototype.qa=function(){this.a.dispatchEvent("b")},vr.prototype.createWebChannel=vr.prototype.a,yr.prototype.send=yr.prototype.Pa,yr.prototype.open=yr.prototype.Oa,Ne.NO_ERROR=0,Ne.TIMEOUT=8,Ne.HTTP_ERROR=6,Re.COMPLETE="complete",(ke.EventType=De).OPEN="a",De.CLOSE="b",De.ERROR="c",De.MESSAGE="d",Qt.prototype.listen=Qt.prototype.va,Cn.prototype.listenOnce=Cn.prototype.wa,Cn.prototype.getLastError=Cn.prototype.Qa,Cn.prototype.getLastErrorCode=Cn.prototype.ua,Cn.prototype.getStatus=Cn.prototype.X,Cn.prototype.getResponseJson=Cn.prototype.Na,Cn.prototype.getResponseText=Cn.prototype.$,Cn.prototype.send=Cn.prototype.ba;var br={createWebChannelTransport:function(){return new vr},ErrorCode:Ne,EventType:Re,WebChannel:ke,XhrIo:Cn},Er=br.createWebChannelTransport,Ir=br.ErrorCode,Tr=br.EventType,Ar=br.WebChannel,Nr=br.XhrIo,Rr=(Sr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Sr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Sr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Sr);function Sr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Lr,kr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Or=(o(Pr,Lr=Error),Pr),Dr=new p("@firebase/firestore");function Pr(t,e){var n=this;return(n=Lr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Vr(){return Dr.logLevel}function _r(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Dr.logLevel<=a.DEBUG&&(e=n.map(Mr),Dr.debug.apply(Dr,s(["Firestore (7.21.0): "+t],e)))}function Cr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Dr.logLevel<=a.ERROR&&(e=n.map(Mr),Dr.error.apply(Dr,s(["Firestore (7.21.0): "+t],e)))}function Ur(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Dr.logLevel<=a.WARN&&(e=n.map(Mr),Dr.warn.apply(Dr,s(["Firestore (7.21.0): "+t],e)))}function Mr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function jr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (7.21.0) INTERNAL ASSERTION FAILED: "+t;throw Cr(e),new Error(e)}function Gr(t){t||jr()}function xr(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Fr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function qr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Br,Qr,zr=(Object.defineProperty($r.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),$r.prototype.isEqual=function(t){return 0===$r.i(this,t)},$r.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof $r?t.forEach(function(t){e.push(t)}):e.push(t),this.o(e)},$r.prototype.limit=function(){return this.offset+this.length},$r.prototype.u=function(t){return t=void 0===t?1:t,this.o(this.segments,this.offset+t,this.length-t)},$r.prototype.h=function(){return this.o(this.segments,this.offset,this.length-1)},$r.prototype.l=function(){return this.segments[this.offset]},$r.prototype._=function(){return this.get(this.length-1)},$r.prototype.get=function(t){return this.segments[this.offset+t]},$r.prototype.m=function(){return 0===this.length},$r.prototype.T=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},$r.prototype.I=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},$r.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},$r.prototype.A=function(){return this.segments.slice(this.offset,this.limit())},$r.i=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},$r),Wr=(o(Zr,Qr=zr),Zr.prototype.o=function(t,e,n){return new Zr(t,e,n)},Zr.prototype.R=function(){return this.A().join("/")},Zr.prototype.toString=function(){return this.R()},Zr.P=function(t){if(0<=t.indexOf("//"))throw new Or(kr.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new Zr(t.split("/").filter(function(t){return 0<t.length}))},Zr.p=function(){return new Zr([])},Zr),Hr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Kr=(o(Jr,Br=zr),Jr.prototype.o=function(t,e,n){return new Jr(t,e,n)},Jr.g=function(t){return Hr.test(t)},Jr.prototype.R=function(){return this.A().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),Jr.g(t)||(t="`"+t+"`"),t}).join(".")},Jr.prototype.toString=function(){return this.R()},Jr.prototype.V=function(){return 1===this.length&&"__name__"===this.get(0)},Jr.v=function(){return new Jr(["__name__"])},Jr.S=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Or(kr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Or(kr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[r+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new Or(kr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=a,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Or(kr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Jr(e)},Jr.p=function(){return new Jr([])},Jr),Xr=(Yr.C=function(t){return new Yr(Wr.P(t))},Yr.D=function(t){return new Yr(Wr.P(t).u(5))},Yr.prototype.F=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Yr.prototype.isEqual=function(t){return null!==t&&0===Wr.i(this.path,t.path)},Yr.prototype.toString=function(){return this.path.toString()},Yr.i=function(t,e){return Wr.i(t.path,e.path)},Yr.N=function(t){return t.length%2==0},Yr.$=function(t){return new Yr(new Wr(t.slice()))},Yr);function Yr(t){this.path=t}function Jr(){return null!==Br&&Br.apply(this,arguments)||this}function Zr(){return null!==Qr&&Qr.apply(this,arguments)||this}function $r(t,e,n){void 0===e?e=0:e>t.length&&jr(),void 0===n?n=t.length-e:n>t.length-e&&jr(),this.segments=t,this.offset=e,this.t=n}function ti(t,e){if(0!==e.length)throw new Or(kr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+mi(e.length,"argument")+".")}function ei(t,e,n){if(e.length!==n)throw new Or(kr.INVALID_ARGUMENT,"Function "+t+"() requires "+mi(n,"argument")+", but was called with "+mi(e.length,"argument")+".")}function ni(t,e,n){if(e.length<n)throw new Or(kr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+mi(n,"argument")+", but was called with "+mi(e.length,"argument")+".")}function ri(t,e,n,r){if(e.length<n||e.length>r)throw new Or(kr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+mi(e.length,"argument")+".")}function ii(t,e,n,r){ci(t,e,gi(n)+" argument",r)}function oi(t,e,n,r){void 0!==r&&ii(t,e,n,r)}function si(t,e,n,r){ci(t,e,n+" option",r)}function ai(t,e,n,r){void 0!==r&&si(t,e,n,r)}function ui(t,e,n,r,u){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=u;i<o.length;i++){var s=o[i];if(s===n)return;r.push(fi(s))}var a=fi(n);throw new Or(kr.INVALID_ARGUMENT,"Invalid value "+a+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function hi(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Or(kr.INVALID_ARGUMENT,"Invalid value "+fi(r)+" provided to function "+t+"() for its "+gi(n)+" argument. Acceptable values: "+e.join(", "));return r}function ci(t,e,n,r){if(!("object"===e?li(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=fi(r);throw new Or(kr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function li(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function fi(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":jr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function pi(t,e,n){if(void 0===n)throw new Or(kr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+gi(e)+" argument, but it was undefined.")}function di(n,t,r){Fr(t,function(t,e){if(r.indexOf(t)<0)throw new Or(kr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function vi(t,e,n,r){var i=fi(r);return new Or(kr.INVALID_ARGUMENT,"Function "+t+"() requires its "+gi(n)+" argument to be a "+e+", but it was: "+i)}function yi(t,e,n){if(n<=0)throw new Or(kr.INVALID_ARGUMENT,"Function "+t+"() requires its "+gi(e)+" argument to be a positive number, but it was: "+n+".")}function gi(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function mi(t,e){return t+" "+e+(1===t?"":"s")}var wi=(bi.k=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},bi);function bi(){}function Ei(t,e){return t<e?-1:e<t?1:0}function Ii(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var Ti=(Ai.fromBase64String=function(t){return new Ai(atob(t))},Ai.fromUint8Array=function(t){return new Ai(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Ai.prototype.toBase64=function(){return t=this.O,btoa(t);var t},Ai.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.O)},Ai.prototype.M=function(){return 2*this.O.length},Ai.prototype.L=function(t){return Ei(this.O,t.O)},Ai.prototype.isEqual=function(t){return this.O===t.O},Ai);function Ai(t){this.O=t}Ti.q=new Ti("");var Ni=(Ri.fromBase64String=function(t){try{return new Ri(Ti.fromBase64String(t))}catch(t){throw new Or(kr.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},Ri.fromUint8Array=function(t){return new Ri(Ti.fromUint8Array(t))},Ri.prototype.toBase64=function(){return this.U.toBase64()},Ri.prototype.toUint8Array=function(){return this.U.toUint8Array()},Ri.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Ri.prototype.isEqual=function(t){return this.U.isEqual(t.U)},Ri);function Ri(t){this.U=t}function Si(){if("undefined"==typeof Uint8Array)throw new Or(kr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Li(){if("undefined"==typeof atob)throw new Or(kr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function ki(t,e,n,r,i){this.B=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var Oi,Di=(o(xi,Oi=Ni),xi.fromBase64String=function(t){ei("Blob.fromBase64String",arguments,1),ii("Blob.fromBase64String","string",1,t),Li();try{return new xi(Ti.fromBase64String(t))}catch(t){throw new Or(kr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},xi.fromUint8Array=function(t){if(ei("Blob.fromUint8Array",arguments,1),Si(),!(t instanceof Uint8Array))throw vi("Blob.fromUint8Array","Uint8Array",1,t);return new xi(Ti.fromUint8Array(t))},xi.prototype.toBase64=function(){return ei("Blob.toBase64",arguments,0),Li(),Oi.prototype.toBase64.call(this)},xi.prototype.toUint8Array=function(){return ei("Blob.toUint8Array",arguments,0),Si(),Oi.prototype.toUint8Array.call(this)},xi.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},xi),Pi=(Object.defineProperty(Gi.prototype,"j",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Gi.prototype.isEqual=function(t){return t instanceof Gi&&t.projectId===this.projectId&&t.database===this.database},Gi.prototype.L=function(t){return Ei(this.projectId,t.projectId)||Ei(this.database,t.database)},Gi),Vi=(ji.prototype.get=function(t){var e=this.W(t),n=this.K[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(this.G(s,t))return a}},ji.prototype.has=function(t){return void 0!==this.get(t)},ji.prototype.set=function(t,e){var n=this.W(t),r=this.K[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.G(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.K[n]=[[t,e]]},ji.prototype.delete=function(t){var e=this.W(t),n=this.K[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.G(n[r][0],t))return 1===n.length?delete this.K[e]:n.splice(r,1),!0;return!1},ji.prototype.forEach=function(a){Fr(this.K,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];a(o,s)}})},ji.prototype.m=function(){return qr(this.K)},ji),_i=(Mi.now=function(){return Mi.fromMillis(Date.now())},Mi.fromDate=function(t){return Mi.fromMillis(t.getTime())},Mi.fromMillis=function(t){var e=Math.floor(t/1e3);return new Mi(e,1e6*(t-1e3*e))},Mi.prototype.toDate=function(){return new Date(this.toMillis())},Mi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Mi.prototype.H=function(t){return this.seconds===t.seconds?Ei(this.nanoseconds,t.nanoseconds):Ei(this.seconds,t.seconds)},Mi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Mi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Mi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},Mi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Mi),Ci=(Ui.Y=function(t){return new Ui(t)},Ui.min=function(){return new Ui(new _i(0,0))},Ui.prototype.L=function(t){return this.timestamp.H(t.timestamp)},Ui.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Ui.prototype.J=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Ui.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Ui.prototype.X=function(){return this.timestamp},Ui);function Ui(t){this.timestamp=t}function Mi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Or(kr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Or(kr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Or(kr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Or(kr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function ji(t,e){this.W=t,this.G=e,this.K={}}function Gi(t,e){this.projectId=t,this.database=e||"(default)"}function xi(){return null!==Oi&&Oi.apply(this,arguments)||this}function Fi(t){return null==t}function qi(t){return-0===t&&1/t==-1/0}var Bi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Z=null};function Qi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Bi(t,e,n,r,i,o,s)}function zi(t){var e,n=t;return null===n.Z&&(e=n.path.R(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.R()+e.op.toString()+Wo(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.R()+e.dir;var e}).join(","),Fi(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=yu(n.startAt)),n.endAt&&(e+="|ub:",e+=yu(n.endAt)),n.Z=e),n.Z}function Wi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,a=0;a<t.filters.length;a++)if(o=t.filters[a],s=e.filters[a],o.op!==s.op||!o.field.isEqual(s.field)||!qo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!mu(t.startAt,e.startAt)&&mu(t.endAt,e.endAt)}function Hi(t){return Xr.N(t.path)&&null===t.collectionGroup&&0===t.filters.length}function Ki(t){this.count=t}var Xi,Yi,Ji=(Zi.prototype.nt=function(t){return new Zi(this.target,this.targetId,this.tt,t,this.et,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Zi.prototype.st=function(t,e){return new Zi(this.target,this.targetId,this.tt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Zi.prototype.it=function(t){return new Zi(this.target,this.targetId,this.tt,this.sequenceNumber,this.et,t,this.resumeToken)},Zi);function Zi(t,e,n,r,i,o,s){void 0===i&&(i=Ci.min()),void 0===o&&(o=Ci.min()),void 0===s&&(s=Ti.q),this.target=t,this.targetId=e,this.tt=n,this.sequenceNumber=r,this.et=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function $i(t){switch(t){case kr.OK:return jr(),0;case kr.CANCELLED:case kr.UNKNOWN:case kr.DEADLINE_EXCEEDED:case kr.RESOURCE_EXHAUSTED:case kr.INTERNAL:case kr.UNAVAILABLE:case kr.UNAUTHENTICATED:return;case kr.INVALID_ARGUMENT:case kr.NOT_FOUND:case kr.ALREADY_EXISTS:case kr.PERMISSION_DENIED:case kr.FAILED_PRECONDITION:case kr.ABORTED:case kr.OUT_OF_RANGE:case kr.UNIMPLEMENTED:case kr.DATA_LOSS:return 1;default:return jr(),0}}function to(t){if(void 0===t)return Cr("GRPC error has no .code"),kr.UNKNOWN;switch(t){case Xi.OK:return kr.OK;case Xi.CANCELLED:return kr.CANCELLED;case Xi.UNKNOWN:return kr.UNKNOWN;case Xi.DEADLINE_EXCEEDED:return kr.DEADLINE_EXCEEDED;case Xi.RESOURCE_EXHAUSTED:return kr.RESOURCE_EXHAUSTED;case Xi.INTERNAL:return kr.INTERNAL;case Xi.UNAVAILABLE:return kr.UNAVAILABLE;case Xi.UNAUTHENTICATED:return kr.UNAUTHENTICATED;case Xi.INVALID_ARGUMENT:return kr.INVALID_ARGUMENT;case Xi.NOT_FOUND:return kr.NOT_FOUND;case Xi.ALREADY_EXISTS:return kr.ALREADY_EXISTS;case Xi.PERMISSION_DENIED:return kr.PERMISSION_DENIED;case Xi.FAILED_PRECONDITION:return kr.FAILED_PRECONDITION;case Xi.ABORTED:return kr.ABORTED;case Xi.OUT_OF_RANGE:return kr.OUT_OF_RANGE;case Xi.UNIMPLEMENTED:return kr.UNIMPLEMENTED;case Xi.DATA_LOSS:return kr.DATA_LOSS;default:return jr()}}(Yi=Xi=Xi||{})[Yi.OK=0]="OK",Yi[Yi.CANCELLED=1]="CANCELLED",Yi[Yi.UNKNOWN=2]="UNKNOWN",Yi[Yi.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Yi[Yi.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Yi[Yi.NOT_FOUND=5]="NOT_FOUND",Yi[Yi.ALREADY_EXISTS=6]="ALREADY_EXISTS",Yi[Yi.PERMISSION_DENIED=7]="PERMISSION_DENIED",Yi[Yi.UNAUTHENTICATED=16]="UNAUTHENTICATED",Yi[Yi.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Yi[Yi.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Yi[Yi.ABORTED=10]="ABORTED",Yi[Yi.OUT_OF_RANGE=11]="OUT_OF_RANGE",Yi[Yi.UNIMPLEMENTED=12]="UNIMPLEMENTED",Yi[Yi.INTERNAL=13]="INTERNAL",Yi[Yi.UNAVAILABLE=14]="UNAVAILABLE",Yi[Yi.DATA_LOSS=15]="DATA_LOSS";var eo=(so.prototype.rt=function(t,e){return new so(this.i,this.root.rt(t,e,this.i).copy(null,null,ro.ot,null,null))},so.prototype.remove=function(t){return new so(this.i,this.root.remove(t,this.i).copy(null,null,ro.ot,null,null))},so.prototype.get=function(t){for(var e=this.root;!e.m();){var n=this.i(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},so.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.m();){var r=this.i(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},so.prototype.m=function(){return this.root.m()},Object.defineProperty(so.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),so.prototype.ut=function(){return this.root.ut()},so.prototype.ct=function(){return this.root.ct()},so.prototype.at=function(t){return this.root.at(t)},so.prototype.forEach=function(n){this.at(function(t,e){return n(t,e),!1})},so.prototype.toString=function(){var n=[];return this.at(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},so.prototype.ht=function(t){return this.root.ht(t)},so.prototype.lt=function(){return new no(this.root,null,this.i,!1)},so.prototype._t=function(t){return new no(this.root,t,this.i,!1)},so.prototype.ft=function(){return new no(this.root,null,this.i,!0)},so.prototype.dt=function(t){return new no(this.root,t,this.i,!0)},so),no=(oo.prototype.Et=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.m();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.m();)this.Tt.push(t),t=t.left;return e},oo.prototype.It=function(){return 0<this.Tt.length},oo.prototype.At=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},oo),ro=(io.prototype.copy=function(t,e,n,r,i){return new io(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},io.prototype.m=function(){return!1},io.prototype.at=function(t){return this.left.at(t)||t(this.key,this.value)||this.right.at(t)},io.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},io.prototype.min=function(){return this.left.m()?this:this.left.min()},io.prototype.ut=function(){return this.min().key},io.prototype.ct=function(){return this.right.m()?this.key:this.right.ct()},io.prototype.rt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.rt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.rt(t,e,n))).Rt()},io.prototype.yt=function(){if(this.left.m())return io.EMPTY;var t=this;return t.left.Pt()||t.left.left.Pt()||(t=t.gt()),(t=t.copy(null,null,null,t.left.yt(),null)).Rt()},io.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.m()||r.left.Pt()||r.left.left.Pt()||(r=r.gt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Pt()&&(r=r.Vt()),r.right.m()||r.right.Pt()||r.right.left.Pt()||(r=r.vt()),0===e(t,r.key)){if(r.right.m())return io.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.yt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Rt()},io.prototype.Pt=function(){return this.color},io.prototype.Rt=function(){var t=this;return t.right.Pt()&&!t.left.Pt()&&(t=t.bt()),t.left.Pt()&&t.left.left.Pt()&&(t=t.Vt()),t.left.Pt()&&t.right.Pt()&&(t=t.St()),t},io.prototype.gt=function(){var t=this.St();return t.right.left.Pt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Vt())).bt()).St()),t},io.prototype.vt=function(){var t=this.St();return t.left.left.Pt()&&(t=(t=t.Vt()).St()),t},io.prototype.bt=function(){var t=this.copy(null,null,io.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},io.prototype.Vt=function(){var t=this.copy(null,null,io.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},io.prototype.St=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},io.prototype.Ct=function(){var t=this.Dt();return Math.pow(2,t)<=this.size+1},io.prototype.Dt=function(){if(this.Pt()&&this.left.Pt())throw jr();if(this.right.Pt())throw jr();var t=this.left.Dt();if(t!==this.right.Dt())throw jr();return t+(this.Pt()?0:1)},io);function io(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:io.RED,this.left=null!=r?r:io.EMPTY,this.right=null!=i?i:io.EMPTY,this.size=this.left.size+1+this.right.size}function oo(t,e,n,r){this.wt=r,this.Tt=[];for(var i=1;!t.m();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.wt?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.wt?t.right:t.left}}function so(t,e){this.i=t,this.root=e||ro.EMPTY}function ao(){this.size=0}ro.EMPTY=null,ro.RED=!0,ro.ot=!1,ro.EMPTY=(Object.defineProperty(ao.prototype,"key",{get:function(){throw jr()},enumerable:!1,configurable:!0}),Object.defineProperty(ao.prototype,"value",{get:function(){throw jr()},enumerable:!1,configurable:!0}),Object.defineProperty(ao.prototype,"color",{get:function(){throw jr()},enumerable:!1,configurable:!0}),Object.defineProperty(ao.prototype,"left",{get:function(){throw jr()},enumerable:!1,configurable:!0}),Object.defineProperty(ao.prototype,"right",{get:function(){throw jr()},enumerable:!1,configurable:!0}),ao.prototype.copy=function(t,e,n,r,i){return this},ao.prototype.rt=function(t,e,n){return new ro(t,e)},ao.prototype.remove=function(t,e){return this},ao.prototype.m=function(){return!0},ao.prototype.at=function(t){return!1},ao.prototype.ht=function(t){return!1},ao.prototype.ut=function(){return null},ao.prototype.ct=function(){return null},ao.prototype.Pt=function(){return!1},ao.prototype.Ct=function(){return!0},ao.prototype.Dt=function(){return 0},new ao);var uo=(fo.prototype.has=function(t){return null!==this.data.get(t)},fo.prototype.first=function(){return this.data.ut()},fo.prototype.last=function(){return this.data.ct()},Object.defineProperty(fo.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),fo.prototype.indexOf=function(t){return this.data.indexOf(t)},fo.prototype.forEach=function(n){this.data.at(function(t,e){return n(t),!1})},fo.prototype.Ft=function(t,e){for(var n=this.data._t(t[0]);n.It();){var r=n.Et();if(0<=this.i(r.key,t[1]))return;e(r.key)}},fo.prototype.Nt=function(t,e){for(var n=void 0!==e?this.data._t(e):this.data.lt();n.It();)if(!t(n.Et().key))return},fo.prototype.$t=function(t){var e=this.data._t(t);return e.It()?e.Et().key:null},fo.prototype.lt=function(){return new ho(this.data.lt())},fo.prototype._t=function(t){return new ho(this.data._t(t))},fo.prototype.add=function(t){return this.copy(this.data.remove(t).rt(t,!0))},fo.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},fo.prototype.m=function(){return this.data.m()},fo.prototype.xt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},fo.prototype.isEqual=function(t){if(!(t instanceof fo))return!1;if(this.size!==t.size)return!1;for(var e=this.data.lt(),n=t.data.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(0!==this.i(r,i))return!1}return!0},fo.prototype.A=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},fo.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},fo.prototype.copy=function(t){var e=new fo(this.i);return e.data=t,e},fo),ho=(lo.prototype.Et=function(){return this.kt.Et().key},lo.prototype.It=function(){return this.kt.It()},lo),co=new eo(Xr.i);function lo(t){this.kt=t}function fo(t){this.i=t,this.data=new eo(this.i)}var po=new eo(Xr.i),vo=new eo(Xr.i),yo=new uo(Xr.i);function go(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=yo,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var mo=new uo(Ei),wo=(Co.Lt=function(t){return new Co(t.i)},Co.prototype.has=function(t){return null!=this.Ot.get(t)},Co.prototype.get=function(t){return this.Ot.get(t)},Co.prototype.first=function(){return this.Mt.ut()},Co.prototype.last=function(){return this.Mt.ct()},Co.prototype.m=function(){return this.Mt.m()},Co.prototype.indexOf=function(t){var e=this.Ot.get(t);return e?this.Mt.indexOf(e):-1},Object.defineProperty(Co.prototype,"size",{get:function(){return this.Mt.size},enumerable:!1,configurable:!0}),Co.prototype.forEach=function(n){this.Mt.at(function(t,e){return n(t),!1})},Co.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ot.rt(t.key,t),e.Mt.rt(t,null))},Co.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ot.remove(t),this.Mt.remove(e)):this},Co.prototype.isEqual=function(t){if(!(t instanceof Co))return!1;if(this.size!==t.size)return!1;for(var e=this.Mt.lt(),n=t.Mt.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(!r.isEqual(i))return!1}return!0},Co.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Co.prototype.copy=function(t,e){var n=new Co;return n.i=this.i,n.Ot=t,n.Mt=e,n},Co),bo=(_o.prototype.track=function(t){var e=t.doc.key,n=this.qt.get(e);!n||0!==t.type&&3===n.type?this.qt=this.qt.rt(e,t):3===t.type&&1!==n.type?this.qt=this.qt.rt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.qt=this.qt.rt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.qt=this.qt.rt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.qt=this.qt.remove(e):1===t.type&&2===n.type?this.qt=this.qt.rt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.qt=this.qt.rt(e,{type:2,doc:t.doc}):jr()},_o.prototype.Ut=function(){var n=[];return this.qt.at(function(t,e){n.push(e)}),n},_o),Eo=(Vo.Gt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Vo(t,e,wo.Lt(e),i,n,r,!0,!1)},Object.defineProperty(Vo.prototype,"hasPendingWrites",{get:function(){return!this.Qt.m()},enumerable:!1,configurable:!0}),Vo.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.jt===t.jt&&this.Qt.isEqual(t.Qt)&&Ga(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Bt.isEqual(t.Bt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Vo),Io=(Po.Jt=function(t,e){var n=new Map;return n.set(t,To.Xt(t,e)),new Po(Ci.min(),n,mo,co,go())},Po),To=(Do.Xt=function(t,e){return new Do(Ti.q,e,go(),go(),go())},Do),Ao=function(t,e,n,r){this.se=t,this.removedTargetIds=e,this.key=n,this.ie=r},No=function(t,e){this.targetId=t,this.re=e},Ro=function(t,e,n,r){void 0===n&&(n=Ti.q),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},So=(Object.defineProperty(Oo.prototype,"Zt",{get:function(){return this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(Oo.prototype,"resumeToken",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(Oo.prototype,"le",{get:function(){return 0!==this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(Oo.prototype,"_e",{get:function(){return this.he},enumerable:!1,configurable:!0}),Oo.prototype.fe=function(t){0<t.M()&&(this.he=!0,this.ce=t)},Oo.prototype.de=function(){var n=go(),r=go(),i=go();return this.ue.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:jr()}}),new To(this.ce,this.ae,n,r,i)},Oo.prototype.we=function(){this.he=!1,this.ue=Mo()},Oo.prototype.me=function(t,e){this.he=!0,this.ue=this.ue.rt(t,e)},Oo.prototype.Te=function(t){this.he=!0,this.ue=this.ue.remove(t)},Oo.prototype.Ee=function(){this.oe+=1},Oo.prototype.Ie=function(){--this.oe},Oo.prototype.Ae=function(){this.he=!0,this.ae=!0},Oo),Lo=(ko.prototype.Ve=function(t){for(var e=0,n=t.se;e<n.length;e++){var r=n[e];t.ie instanceof Ea?this.ve(r,t.ie):t.ie instanceof Ia&&this.be(r,t.key,t.ie)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.be(s,t.key,t.ie)}},ko.prototype.Se=function(n){var r=this;this.Ce(n,function(t){var e=r.De(t);switch(n.state){case 0:r.Fe(t)&&e.fe(n.resumeToken);break;case 1:e.Ie(),e.le||e.we(),e.fe(n.resumeToken);break;case 2:e.Ie(),e.le||r.removeTarget(t);break;case 3:r.Fe(t)&&(e.Ae(),e.fe(n.resumeToken));break;case 4:r.Fe(t)&&(r.Ne(t),e.fe(n.resumeToken));break;default:jr()}})},ko.prototype.Ce=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ye.forEach(function(t,e){r.Fe(e)&&n(e)})},ko.prototype.$e=function(t){var e,n,r=t.targetId,i=t.re.count,o=this.xe(r);o&&(Hi(e=o.target)?0===i?(n=new Xr(e.path),this.be(r,n,new Ia(n,Ci.min()))):Gr(1===i):this.ke(r)!==i&&(this.Ne(r),this.ge=this.ge.add(r)))},ko.prototype.Oe=function(i){var o=this,s=new Map;this.ye.forEach(function(t,e){var n,r=o.xe(e);r&&(t.Zt&&Hi(r.target)&&(n=new Xr(r.target.path),null!==o.Pe.get(n)||o.Me(e,n)||o.be(e,n,new Ia(n,i))),t._e&&(s.set(e,t.de()),t.we()))});var r=go();this.pe.forEach(function(t,e){var n=!0;e.Nt(function(t){var e=o.xe(t);return!e||2===e.tt||(n=!1)}),n&&(r=r.add(t))});var t=new Io(i,s,this.ge,this.Pe,r);return this.Pe=co,this.pe=Uo(),this.ge=new uo(Ei),t},ko.prototype.ve=function(t,e){var n;this.Fe(t)&&(n=this.Me(t,e.key)?2:0,this.De(t).me(e.key,n),this.Pe=this.Pe.rt(e.key,e),this.pe=this.pe.rt(e.key,this.Le(e.key).add(t)))},ko.prototype.be=function(t,e,n){var r;this.Fe(t)&&(r=this.De(t),this.Me(t,e)?r.me(e,1):r.Te(e),this.pe=this.pe.rt(e,this.Le(e).delete(t)),n&&(this.Pe=this.Pe.rt(e,n)))},ko.prototype.removeTarget=function(t){this.ye.delete(t)},ko.prototype.ke=function(t){var e=this.De(t).de();return this.Re.qe(t).size+e.te.size-e.ne.size},ko.prototype.Ee=function(t){this.De(t).Ee()},ko.prototype.De=function(t){var e=this.ye.get(t);return e||(e=new So,this.ye.set(t,e)),e},ko.prototype.Le=function(t){var e=this.pe.get(t);return e||(e=new uo(Ei),this.pe=this.pe.rt(t,e)),e},ko.prototype.Fe=function(t){var e=null!==this.xe(t);return e||_r("WatchChangeAggregator","Detected inactive target",t),e},ko.prototype.xe=function(t){var e=this.ye.get(t);return e&&e.le?null:this.Re.Ue(t)},ko.prototype.Ne=function(e){var n=this;this.ye.set(e,new So),this.Re.qe(e).forEach(function(t){n.be(e,t,null)})},ko.prototype.Me=function(t,e){return this.Re.qe(t).has(e)},ko);function ko(t){this.Re=t,this.ye=new Map,this.Pe=co,this.pe=Uo(),this.ge=new uo(Ei)}function Oo(){this.oe=0,this.ue=Mo(),this.ce=Ti.q,this.ae=!1,this.he=!0}function Do(t,e,n,r,i){this.resumeToken=t,this.Zt=e,this.te=n,this.ee=r,this.ne=i}function Po(t,e,n,r,i){this.et=t,this.zt=e,this.Kt=n,this.Ht=r,this.Yt=i}function Vo(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.Bt=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.jt=s,this.Wt=a}function _o(){this.qt=new eo(Xr.i)}function Co(n){this.i=n?function(t,e){return n(t,e)||Xr.i(t.key,e.key)}:function(t,e){return Xr.i(t.key,e.key)},this.Ot=po,this.Mt=new eo(this.i)}function Uo(){return new eo(Xr.i)}function Mo(){return new eo(Xr.i)}function jo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Go(t){var e=Ho(t.mapValue.fields.__local_write_time__.timestampValue);return new _i(e.seconds,e.nanos)}var xo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Fo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?jo(t)?4:10:jr()}function qo(r,i){var t,e,n,o=Fo(r);if(o!==Fo(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return Go(r).isEqual(Go(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Ho(r.timestampValue),n=Ho(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return n=i,Xo(r.bytesValue).isEqual(Xo(n.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Ko((t=r).geoPointValue.latitude)===Ko(e.geoPointValue.latitude)&&Ko(t.geoPointValue.longitude)===Ko(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Ko(t.integerValue)===Ko(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Ko(t.doubleValue),r=Ko(e.doubleValue);return n===r?qi(n)===qi(r):isNaN(n)&&isNaN(r)}return!1}(r,i);case 9:return Ii(r.arrayValue.values||[],i.arrayValue.values||[],qo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(xr(e)!==xr(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!qo(e[t],n[t])))return!1;return!0}();default:return jr()}}function Bo(t,e){return void 0!==(t.values||[]).find(function(t){return qo(t,e)})}function Qo(t,e){var n,r,i,o,s,a,u,h,c,l,f=Fo(t),p=Fo(e);if(f!==p)return Ei(f,p);switch(f){case 0:return 0;case 1:return Ei(t.booleanValue,e.booleanValue);case 2:return h=e,(c=Ko(t.integerValue||t.doubleValue))<(l=Ko(h.integerValue||h.doubleValue))?-1:l<c?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1;case 3:return zo(t.timestampValue,e.timestampValue);case 4:return zo(Go(t),Go(e));case 5:return Ei(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,a=Xo(o),u=Xo(s),a.L(u);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Ei(n[i],r[i]);if(0!==o)return o}return Ei(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=Ei(Ko(n.latitude),Ko(r.latitude)))?i:Ei(Ko(n.longitude),Ko(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Qo(n[i],r[i]);if(o)return o}return Ei(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var a=Ei(r[s],o[s]);if(0!==a)return a;var u=Qo(n[r[s]],i[o[s]]);if(0!==u)return u}return Ei(r.length,o.length)}(t.mapValue,e.mapValue);default:throw jr()}}function zo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ei(t,e);var n=Ho(t),r=Ho(e),i=Ei(n.seconds,r.seconds);return 0!==i?i:Ei(n.nanos,r.nanos)}function Wo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=Ho(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?Xo(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,Xr.D(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):jr();var t,e,n}(t)}function Ho(t){if(Gr(!!t),"string"!=typeof t)return{seconds:Ko(t.seconds),nanos:Ko(t.nanos)};var e,n=0,r=xo.exec(t);Gr(!!r),r[1]&&(e=((e=r[1])+"000000000").substr(0,9),n=Number(e));var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:n}}function Ko(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Xo(t){return"string"==typeof t?Ti.fromBase64String(t):Ti.fromUint8Array(t)}function Yo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.R()}}function Jo(t){return t&&"integerValue"in t}function Zo(t){return!!t&&"arrayValue"in t}function $o(t){return t&&"nullValue"in t}function ts(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function es(t){return t&&"mapValue"in t}var ns={asc:"ASCENDING",desc:"DESCENDING"},rs={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},is=function(t,e){this.B=t,this.Be=e};function os(t){return{integerValue:""+t}}function ss(t,e){if(t.Be){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:qi(e)?"-0":e}}function as(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!qi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?os(e):ss(t,e);var n}function us(t,e){return t.Be?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function hs(t,e){return t.Be?e.toBase64():e.toUint8Array()}function cs(t){return Gr(!!t),Ci.Y((e=Ho(t),new _i(e.seconds,e.nanos)));var e}function ls(t,e){return new Wr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).R()}function fs(t,e){return ls(t.B,e.path)}function ps(t,e){var n,r,i=(Gr(bs(r=Wr.P(e))),r);return Gr(i.get(1)===t.B.projectId),Gr(!i.get(3)&&!t.B.database||i.get(3)===t.B.database),new Xr((Gr(4<(n=i).length&&"documents"===n.get(4)),n.u(5)))}function ds(t,e){return ls(t.B,e)}function vs(t){return new Wr(["projects",t.B.projectId,"databases",t.B.database]).R()}function ys(t,e,n){return{name:fs(t,e),fields:n.proto.mapValue.fields}}function gs(t,e){var n,r,i,o;if(e instanceof Zs)n={update:ys(t,e.key,e.value)};else if(e instanceof ha)n={delete:fs(t,e.key)};else if(e instanceof $s)n={update:ys(t,e.key,e.data),updateMask:(r=e.Qe,i=[],r.fields.forEach(function(t){return i.push(t.R())}),{fieldPaths:i})};else if(e instanceof ia)n={transform:{document:fs(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Ns)return{fieldPath:t.field.R(),setToServerValue:"REQUEST_TIME"};if(e instanceof Rs)return{fieldPath:t.field.R(),appendMissingElements:{values:e.elements}};if(e instanceof Ds)return{fieldPath:t.field.R(),removeAllFromArray:{values:e.elements}};if(e instanceof Cs)return{fieldPath:t.field.R(),increment:e.je};throw jr()})}};else{if(!(e instanceof ca))return jr();n={verify:fs(t,e.key)}}return e.Ge.We||(n.currentDocument=void 0!==(o=e.Ge).updateTime?{updateTime:us(t,o.updateTime.X())}:void 0!==o.exists?{exists:o.exists}:jr()),n}function ms(t){return{before:t.before,values:t.position}}function ws(t){return{fieldPath:t.R()}}function bs(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function Es(){this.ze=void 0}function Is(t,e){return t instanceof Cs?Jo(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var Ts,As,Ns=(o(Ls,As=Es),Ls),Rs=(o(Ss,Ts=Es),Ss);function Ss(t){var e=this;return(e=Ts.call(this)||this).elements=t,e}function Ls(){return null!==As&&As.apply(this,arguments)||this}function ks(t,e){for(var n=js(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return qo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var Os,Ds=(o(Ps,Os=Es),Ps);function Ps(t){var e=this;return(e=Os.call(this)||this).elements=t,e}function Vs(t,e){for(var n=js(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!qo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var _s,Cs=(o(Us,_s=Es),Us);function Us(t,e){var n=this;return(n=_s.call(this)||this).serializer=t,n.je=e,n}function Ms(t){return Ko(t.integerValue||t.doubleValue)}function js(t){return Zo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Gs(t,e){this.field=t,this.transform=e}var xs=(Fs.prototype.Ke=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].T(t))return!0;return!1},Fs.prototype.isEqual=function(t){return Ii(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Fs);function Fs(t){(this.fields=t).sort(Kr.i)}function qs(t,e){this.version=t,this.transformResults=e}var Bs=(Qs.He=function(){return new Qs},Qs.exists=function(t){return new Qs(void 0,t)},Qs.updateTime=function(t){return new Qs(t)},Object.defineProperty(Qs.prototype,"We",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Qs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Qs);function Qs(t,e){this.updateTime=t,this.exists=e}function zs(t,e){return void 0!==t.updateTime?e instanceof Ea&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Ea}function Ws(){}function Hs(t,e,n,r){return t instanceof Zs?function(t,e){if(!zs(t.Ge,e))return e;var n=Xs(e);return new Ea(t.key,n,t.value,{Ye:!0})}(t,e):t instanceof $s?function(t,e){if(!zs(t.Ge,e))return e;var n=Xs(e),r=na(t,e);return new Ea(t.key,n,r,{Ye:!0})}(t,e):t instanceof ia?function(t,e,n,r){if(!zs(t.Ge,e))return e;var i=e,o=function(t,e,n,r){for(var i,o,s,a,u,h,c=[],l=0,f=t;l<f.length;l++){var p=f[l],d=p.transform,v=null;n instanceof Ea&&(v=n.field(p.field)),null===v&&r instanceof Ea&&(v=r.field(p.field)),c.push((o=v,h=u=a=s=void 0,(i=d)instanceof Ns?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},o&&(h.fields.__previous_value__=o),{mapValue:h}):i instanceof Rs?ks(i,o):i instanceof Ds?Vs(i,o):(u=Ms(a=Is(s=i,o))+Ms(s.je),Jo(a)&&Jo(s.je)?os(u):ss(s.serializer,u))))}return c}(t.fieldTransforms,n,e,r),s=sa(t,i.data(),o);return new Ea(t.key,i.version,s,{Ye:!0})}(t,e,r,n):(o=e,zs((i=t).Ge,o)?new Ia(i.key,Ci.min()):o);var i,o}function Ks(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ge.isEqual(e.Ge)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||Ii(t.fieldTransforms,t.fieldTransforms,function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof Rs&&o instanceof Rs||i instanceof Ds&&o instanceof Ds?Ii(i.elements,o.elements,qo):i instanceof Cs&&o instanceof Cs?qo(i.je,o.je):i instanceof Ns&&o instanceof Ns);var n,r,i,o}))}function Xs(t){return t instanceof Ea?t.version:Ci.min()}var Ys,Js,Zs=(o(ea,Js=Ws),ea),$s=(o(ta,Ys=Ws),ta);function ta(t,e,n,r){var i=this;return(i=Ys.call(this)||this).key=t,i.data=e,i.Qe=n,i.Ge=r,i.type=1,i}function ea(t,e,n){var r=this;return(r=Js.call(this)||this).key=t,r.value=e,r.Ge=n,r.type=0,r}function na(t,e){return n=t,r=e instanceof Ea?e.data():la.empty(),i=new fa(r),n.Qe.fields.forEach(function(t){var e;t.m()||(null!==(e=n.data.field(t))?i.set(t,e):i.delete(t))}),i.Je();var n,r,i}var ra,ia=(o(oa,ra=Ws),oa);function oa(t,e){var n=this;return(n=ra.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ge=Bs.exists(!0),n}function sa(t,e,n){for(var r=new fa(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Je()}var aa,ua,ha=(o(ya,ua=Ws),ya),ca=(o(va,aa=Ws),va),la=(da.empty=function(){return new da({mapValue:{}})},da.prototype.field=function(t){if(t.m())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!es(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t._()])||null},da.prototype.isEqual=function(t){return qo(this.proto,t.proto)},da),fa=(pa.prototype.set=function(t,e){return this.tn(t,e),this},pa.prototype.delete=function(t){return this.tn(t,null),this},pa.prototype.tn=function(t,e){for(var n=this.Ze,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===Fo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t._(),e)},pa.prototype.Je=function(){var t=this.en(Kr.p(),this.Ze);return null!=t?new la(t):this.Xe},pa.prototype.en=function(r,t){var i=this,o=!1,e=this.Xe.field(r),s=es(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.en(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},pa);function pa(t){void 0===t&&(t=la.empty()),this.Xe=t,this.Ze=new Map}function da(t){this.proto=t}function va(t,e){var n=this;return(n=aa.call(this)||this).key=t,n.Ge=e,n.type=4,n}function ya(t,e){var n=this;return(n=ua.call(this)||this).key=t,n.Ge=e,n.type=3,n}function ga(t,e){this.key=t,this.version=e}var ma,wa,ba,Ea=(o(Sa,ba=ga),Sa.prototype.field=function(t){return this.nn.field(t)},Sa.prototype.data=function(){return this.nn},Sa.prototype.sn=function(){return this.nn.proto},Sa.prototype.isEqual=function(t){return t instanceof Sa&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ye===t.Ye&&this.hasCommittedMutations===t.hasCommittedMutations&&this.nn.isEqual(t.nn)},Sa.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.nn.toString()+", {hasLocalMutations: "+this.Ye+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Sa.prototype,"hasPendingWrites",{get:function(){return this.Ye||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Sa),Ia=(o(Ra,wa=ga),Ra.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Ra.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Ra.prototype.isEqual=function(t){return t instanceof Ra&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Ra),Ta=(o(Na,ma=ga),Na.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Na.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Na.prototype.isEqual=function(t){return t instanceof Na&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Na),Aa=function(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.rn=n,this.filters=r,this.limit=i,this.on=o,this.startAt=s,this.endAt=a,this.un=null,this.cn=null,this.startAt,this.endAt};function Na(){return null!==ma&&ma.apply(this,arguments)||this}function Ra(t,e,n){var r=this;return(r=wa.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Sa(t,e,n,r){var i=this;return(i=ba.call(this,t,e)||this).nn=n,i.Ye=!!r.Ye,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function La(t){return new Aa(t)}function ka(t){return!Fi(t.limit)&&"F"===t.on}function Oa(t){return!Fi(t.limit)&&"L"===t.on}function Da(t){return 0<t.rn.length?t.rn[0].field:null}function Pa(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.an())return r.field}return null}function Va(t){return null!==t.collectionGroup}function _a(t){var e=t;if(null===e.un){e.un=[];var n=Pa(e),r=Da(e);if(null!==n&&null===r)n.V()||e.un.push(new wu(n)),e.un.push(new wu(Kr.v(),"asc"));else{for(var i,o=!1,s=0,a=e.rn;s<a.length;s++){var u=a[s];e.un.push(u),u.field.V()&&(o=!0)}o||(i=0<e.rn.length?e.rn[e.rn.length-1].dir:"asc",e.un.push(new wu(Kr.v(),i)))}}return e.un}function Ca(t){var e=t;if(!e.cn)if("F"===e.on)e.cn=Qi(e.path,e.collectionGroup,_a(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=_a(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new wu(o.field,s))}var a=e.endAt?new lu(e.endAt.position,!e.endAt.before):null,u=e.startAt?new lu(e.startAt.position,!e.startAt.before):null;e.cn=Qi(e.path,e.collectionGroup,n,e.filters,e.limit,a,u)}return e.cn}function Ua(t,e,n){return new Aa(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ma(t,e){return new Aa(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,e,t.endAt)}function ja(t,e){return new Aa(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,t.startAt,e)}function Ga(t,e){return Wi(Ca(t),Ca(e))&&t.on===e.on}function xa(t){return zi(Ca(t))+"|lt:"+t.on}function Fa(t){return"Query(target="+(n=(e=Ca(t)).path.R(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.R()+" "+e.op+" "+Wo(e.value);var e}).join(", ")+"]"),Fi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.R()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+yu(e.startAt)),e.endAt&&(n+=", endAt: "+yu(e.endAt)),"Target("+n+")")+"; limitType="+t.on+")";var e,n}function qa(i,t){return r=i,o=t.key.path,(null!==r.collectionGroup?t.key.F(r.collectionGroup)&&r.path.T(o):Xr.N(r.path)?r.path.isEqual(o):r.path.I(o))&&function(t){for(var e=0,n=i.rn;e<n.length;e++){var r=n[e];if(!r.field.V()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=i).startAt||gu(e.startAt,_a(e),n))&&(!e.endAt||!gu(e.endAt,_a(e),n)));var e,n,r,o}function Ba(a){return function(t,e){for(var n=!1,r=0,i=_a(a);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i,o,s,a=t.field.V()?Xr.i(e.key,n.key):(r=t.field,i=n,o=e.field(r),s=i.field(r),null!==o&&null!==s?Qo(o,s):jr());switch(t.dir){case"asc":return a;case"desc":return-1*a;default:return jr()}}(o,t,e);if(0!==s)return s;n=n||o.field.V()}return 0}}var Qa,za=(o(Wa,Qa=function(){}),Wa.create=function(t,e,n){if(t.V())return"in"===e||"not-in"===e?this.hn(t,e,n):new Ya(t,e,n);if($o(n)){if("=="!==e&&"!="!==e)throw new Or(kr.INVALID_ARGUMENT,"Invalid query. Null only supports '==' and '!=' comparisons.");return new Wa(t,e,n)}if(ts(n)){if("=="!==e&&"!="!==e)throw new Or(kr.INVALID_ARGUMENT,"Invalid query. NaN only supports '==' and '!=' comparisons.");return new Wa(t,e,n)}return"array-contains"===e?new au(t,n):"in"===e?new uu(t,n):"not-in"===e?new hu(t,n):"array-contains-any"===e?new cu(t,n):new Wa(t,e,n)},Wa.hn=function(t,e,n){return new("in"===e?Ja:Za)(t,n)},Wa.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.ln(Qo(e,this.value)):null!==e&&Fo(this.value)===Fo(e)&&this.ln(Qo(e,this.value))},Wa.prototype.ln=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return jr()}},Wa.prototype.an=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Wa);function Wa(t,e,n){var r=this;return(r=Qa.call(this)||this).field=t,r.op=e,r.value=n,r}var Ha,Ka,Xa,Ya=(o(eu,Xa=za),eu.prototype.matches=function(t){var e=Xr.i(t.key,this.key);return this.ln(e)},eu),Ja=(o(tu,Ka=za),tu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},tu),Za=(o($a,Ha=za),$a.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},$a);function $a(t,e){var n=this;return(n=Ha.call(this,t,"not-in",e)||this).keys=nu(0,e),n}function tu(t,e){var n=this;return(n=Ka.call(this,t,"in",e)||this).keys=nu(0,e),n}function eu(t,e,n){var r=this;return(r=Xa.call(this,t,e,n)||this).key=Xr.D(n.referenceValue),r}function nu(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return Xr.D(t.referenceValue)})}var ru,iu,ou,su,au=(o(vu,su=za),vu.prototype.matches=function(t){var e=t.field(this.field);return Zo(e)&&Bo(e.arrayValue,this.value)},vu),uu=(o(du,ou=za),du.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Bo(this.value.arrayValue,e)},du),hu=(o(pu,iu=za),pu.prototype.matches=function(t){if(Bo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!Bo(this.value.arrayValue,e)},pu),cu=(o(fu,ru=za),fu.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!Zo(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return Bo(e.value.arrayValue,t)})},fu),lu=function(t,e){this.position=t,this.before=e};function fu(t,e){return ru.call(this,t,"array-contains-any",e)||this}function pu(t,e){return iu.call(this,t,"not-in",e)||this}function du(t,e){return ou.call(this,t,"in",e)||this}function vu(t,e){return su.call(this,t,"array-contains",e)||this}function yu(t){return(t.before?"b":"a")+":"+t.position.map(Wo).join(",")}function gu(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.V()?Xr.i(Xr.D(s.referenceValue),n.key):Qo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function mu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!qo(t.position[n],e.position[n]))return!1;return!0}var wu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function bu(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var Eu=(Au.prototype.reset=function(){this.Tn=0},Au.prototype.An=function(){this.Tn=this.mn},Au.prototype.Rn=function(t){var e=this;this.cancel();var n=Math.floor(this.Tn+this.yn()),r=Math.max(0,Date.now()-this.In),i=Math.max(0,n-r);0<i&&_r("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Tn+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.En=this._n.Pn(this.fn,i,function(){return e.In=Date.now(),t()}),this.Tn*=this.wn,this.Tn<this.dn&&(this.Tn=this.dn),this.Tn>this.mn&&(this.Tn=this.mn)},Au.prototype.pn=function(){null!==this.En&&(this.En.gn(),this.En=null)},Au.prototype.cancel=function(){null!==this.En&&(this.En.cancel(),this.En=null)},Au.prototype.yn=function(){return(Math.random()-.5)*this.Tn},Au),Iu=(Tu.prototype.catch=function(t){return this.next(void 0,t)},Tu.prototype.next=function(r,i){var o=this;return this.Sn&&jr(),this.Sn=!0,this.bn?this.error?this.Cn(i,this.error):this.Dn(r,this.result):new Tu(function(e,n){o.Vn=function(t){o.Dn(r,t).next(e,n)},o.vn=function(t){o.Cn(i,t).next(e,n)}})},Tu.prototype.Fn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Tu.prototype.Nn=function(t){try{var e=t();return e instanceof Tu?e:Tu.resolve(e)}catch(t){return Tu.reject(t)}},Tu.prototype.Dn=function(t,e){return t?this.Nn(function(){return t(e)}):Tu.resolve(e)},Tu.prototype.Cn=function(t,e){return t?this.Nn(function(){return t(e)}):Tu.reject(e)},Tu.resolve=function(n){return new Tu(function(t,e){t(n)})},Tu.reject=function(n){return new Tu(function(t,e){e(n)})},Tu.$n=function(t){return new Tu(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Tu.xn=function(t){for(var n=Tu.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Tu.resolve(t):e()})}(r[e]);return n},Tu.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.$n(i)},Tu);function Tu(t){var e=this;this.Vn=null,this.vn=null,this.result=void 0,this.error=void 0,this.bn=!1,this.Sn=!1,t(function(t){e.bn=!0,e.result=t,e.Vn&&e.Vn(t)},function(t){e.bn=!0,e.error=t,e.vn&&e.vn(t)})}function Au(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this._n=t,this.fn=e,this.dn=n,this.wn=r,this.mn=i,this.Tn=0,this.En=null,this.In=Date.now(),this.reset()}function Nu(t){return"IndexedDbTransactionError"===t.name}function Ru(){return"undefined"!=typeof document?document:null}var Su=(Ou.qn=function(t,e,n,r,i){var o=new Ou(t,e,Date.now()+n,r,i);return o.start(n),o},Ou.prototype.start=function(t){var e=this;this.Un=setTimeout(function(){return e.Bn()},t)},Ou.prototype.gn=function(){return this.Bn()},Ou.prototype.cancel=function(t){null!==this.Un&&(this.clearTimeout(),this.Ln.reject(new Or(kr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Ou.prototype.Bn=function(){var e=this;this.kn.Qn(function(){return null!==e.Un?(e.clearTimeout(),e.op().then(function(t){return e.Ln.resolve(t)})):Promise.resolve()})},Ou.prototype.clearTimeout=function(){null!==this.Un&&(this.Mn(this),clearTimeout(this.Un),this.Un=null)},Ou),Lu=(Object.defineProperty(ku.prototype,"Zn",{get:function(){return this.Gn},enumerable:!1,configurable:!0}),ku.prototype.Qn=function(t){this.enqueue(t)},ku.prototype.ts=function(t){this.es(),this.ns(t)},ku.prototype.ss=function(){var t;this.Gn||(this.Gn=!0,(t=Ru())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xn))},ku.prototype.enqueue=function(t){return this.es(),this.Gn?new Promise(function(t){}):this.ns(t)},ku.prototype.rs=function(t){var e=this;this.Wn.push(t),this.Qn(function(){return e.os()})},ku.prototype.os=function(){return w(this,void 0,void 0,function(){var e,n=this;return b(this,function(t){switch(t.label){case 0:if(0===this.Wn.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Wn[0]()];case 2:return t.sent(),this.Wn.shift(),this.Jn.reset(),[3,4];case 3:if(!Nu(e=t.sent()))throw e;return _r("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Wn.length&&this.Jn.Rn(function(){return n.os()}),t.label=5;case 5:return[2]}})})},ku.prototype.ns=function(t){var r=this,e=this.jn.then(function(){return r.Hn=!0,t().catch(function(t){throw r.Kn=t,r.Hn=!1,Cr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Hn=!1,t})});return this.jn=e},ku.prototype.Pn=function(t,e,n){var r=this;this.es(),-1<this.Yn.indexOf(t)&&(e=0);var i=Su.qn(this,t,e,n,function(t){return r.us(t)});return this.zn.push(i),i},ku.prototype.es=function(){this.Kn&&jr()},ku.prototype.cs=function(){},ku.prototype.hs=function(){return w(this,void 0,void 0,function(){var e;return b(this,function(t){switch(t.label){case 0:return[4,e=this.jn];case 1:t.sent(),t.label=2;case 2:if(e!==this.jn)return[3,0];t.label=3;case 3:return[2]}})})},ku.prototype.ls=function(t){for(var e=0,n=this.zn;e<n.length;e++)if(n[e].fn===t)return!0;return!1},ku.prototype._s=function(r){var i=this;return this.hs().then(function(){i.zn.sort(function(t,e){return t.On-e.On});for(var t=0,e=i.zn;t<e.length;t++){var n=e[t];if(n.gn(),"all"!==r&&n.fn===r)break}return i.hs()})},ku.prototype.fs=function(t){this.Yn.push(t)},ku.prototype.us=function(t){var e=this.zn.indexOf(t);this.zn.splice(e,1)},ku);function ku(){var e=this;this.jn=Promise.resolve(),this.Wn=[],this.Gn=!1,this.zn=[],this.Kn=null,this.Hn=!1,this.Yn=[],this.Jn=new Eu(this,"async_queue_retry"),this.Xn=function(){var t=Ru();t&&_r("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.Jn.pn()};var t=Ru();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Xn)}function Ou(t,e,n,r,i){this.kn=t,this.fn=e,this.On=n,this.op=r,this.Mn=i,this.Ln=new bu,this.then=this.Ln.promise.then.bind(this.Ln.promise),this.Ln.promise.catch(function(t){})}function Du(t,e){if(Cr("AsyncQueue",e+": "+t),Nu(t))return new Or(kr.UNAVAILABLE,e+": "+t);throw t}function Pu(){this.ds=void 0,this.listeners=[]}function Vu(){this.ws=new Vi(xa,Ga),this.onlineState="Unknown",this.Ts=new Set}function _u(u,h){return w(this,void 0,void 0,function(){var e,n,r,i,o,s,a;return b(this,function(t){switch(t.label){case 0:if(e=u,n=h.query,r=!1,(i=e.ws.get(n))||(r=!0,i=new Pu),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Es(n)];case 2:return o.ds=t.sent(),[3,4];case 3:return s=t.sent(),a=Du(s,"Initialization of query '"+Fa(h.query)+"' failed"),[2,void h.onError(a)];case 4:return e.ws.set(n,i),i.listeners.push(h),h.Is(e.onlineState),i.ds&&h.As(i.ds)&&Uu(e),[2]}})})}function Cu(s,a){return w(this,void 0,void 0,function(){var e,n,r,i,o;return b(this,function(t){return e=s,n=a.query,r=!1,(i=e.ws.get(n))&&0<=(o=i.listeners.indexOf(a))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.ws.delete(n),e.Rs(n))]:[2]})})}function Uu(t){t.Ts.forEach(function(t){t.next()})}var Mu=(xu.prototype.As=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Eo(t.query,t.docs,t.Bt,e,t.Qt,t.fromCache,t.jt,!0)}var o=!1;return this.Ps?this.gs(t)&&(this.ys.next(t),o=!0):this.Vs(t,this.onlineState)&&(this.vs(t),o=!0),this.ps=t,o},xu.prototype.onError=function(t){this.ys.error(t)},xu.prototype.Is=function(t){this.onlineState=t;var e=!1;return this.ps&&!this.Ps&&this.Vs(this.ps,t)&&(this.vs(this.ps),e=!0),e},xu.prototype.Vs=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.bs&&n||t.docs.m()&&"Offline"!==e)},xu.prototype.gs=function(t){if(0<t.docChanges.length)return!0;var e=this.ps&&this.ps.hasPendingWrites!==t.hasPendingWrites;return!(!t.jt&&!e)&&!0===this.options.includeMetadataChanges},xu.prototype.vs=function(t){t=Eo.Gt(t.query,t.docs,t.Qt,t.fromCache),this.Ps=!0,this.ys.next(t)},xu),ju=(Gu.prototype.Ss=function(){return null!=this.uid},Gu.prototype.Cs=function(){return this.Ss()?"uid:"+this.uid:"anonymous-user"},Gu.prototype.isEqual=function(t){return t.uid===this.uid},Gu);function Gu(t){this.uid=t}function xu(t,e,n){this.query=t,this.ys=e,this.Ps=!1,this.ps=null,this.onlineState="Unknown",this.options=n||{}}ju.UNAUTHENTICATED=new ju(null),ju.Ds=new ju("google-credentials-uid"),ju.Fs=new ju("first-party-uid");var Fu=(qu.prototype.$s=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},qu.prototype.next=function(){var t=++this.previousValue;return this.xs&&this.xs(t),t},qu);function qu(t,e){var n=this;this.previousValue=t,e&&(e.Ns=function(t){return n.$s(t)},this.xs=function(t){return e.ks(t)})}Fu.Os=-1;var Bu=(nh.prototype.Ms=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},nh.prototype.Ls=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},nh.prototype.qs=function(){var t={activeTargetIds:this.activeTargetIds.A(),updateTimeMs:Date.now()};return JSON.stringify(t)},nh),Qu=(eh.prototype.js=function(t){},eh.prototype.Ws=function(t,e,n){},eh.prototype.Gs=function(t){return this.Us.Ms(t),this.Bs[t]||"not-current"},eh.prototype.zs=function(t,e,n){this.Bs[t]=e},eh.prototype.Ks=function(t){this.Us.Ls(t)},eh.prototype.Hs=function(t){return this.Us.activeTargetIds.has(t)},eh.prototype.Ys=function(t){delete this.Bs[t]},eh.prototype.Js=function(){return this.Us.activeTargetIds},eh.prototype.Xs=function(t){return this.Us.activeTargetIds.has(t)},eh.prototype.start=function(){return this.Us=new Bu,Promise.resolve()},eh.prototype.Zs=function(t,e,n){},eh.prototype.ti=function(t){},eh.prototype.ei=function(){},eh.prototype.ks=function(t){},eh),zu=(th.prototype.si=function(t,e,n){for(var r,i,o,s=n.ii,a=0;a<this.mutations.length;a++){var u=this.mutations[a];u.key.isEqual(t)&&(r=u,i=e,o=s[a],e=r instanceof Zs?new Ea(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof $s?function(t,e,n){if(!zs(t.Ge,e))return new Ta(t.key,n.version);var r=na(t,e);return new Ea(t.key,n.version,r,{hasCommittedMutations:!0})}(r,i,o):r instanceof ia?function(t,e,n){if(Gr(null!=n.transformResults),!zs(t.Ge,e))return new Ta(t.key,n.version);var r=e,i=function(t,e,n){var r=[];Gr(t.length===n.length);for(var i,o,s,a=0;a<n.length;a++){var u=t[a],h=u.transform,c=null;e instanceof Ea&&(c=e.field(u.field)),r.push((i=h,o=c,s=n[a],i instanceof Rs?ks(i,o):i instanceof Ds?Vs(i,o):s))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=sa(t,r.data(),i);return new Ea(t.key,o,s,{hasCommittedMutations:!0})}(r,i,o):new Ia(r.key,o.version,{hasCommittedMutations:!0}))}return e},th.prototype.ri=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Hs(i,e,e,this.ni))}for(var o=e,s=0,a=this.mutations;s<a.length;s++){var u=a[s];u.key.isEqual(t)&&(e=Hs(u,e,o,this.ni))}return e},th.prototype.oi=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ri(t.key,n.get(t.key));e&&(i=i.rt(t.key,e))}),i},th.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},go())},th.prototype.isEqual=function(t){return this.batchId===t.batchId&&Ii(this.mutations,t.mutations,Ks)&&Ii(this.baseMutations,t.baseMutations,Ks)},th),Wu=($u.from=function(t,e,n){Gr(t.mutations.length===n.length);for(var r=vo,i=t.mutations,o=0;o<i.length;o++)r=r.rt(i[o].key,n[o].version);return new $u(t,e,n,r)},$u),Hu=(Zu.prototype._i=function(e,n){var r=this;return this.hi.fi(e,n).next(function(t){return r.di(e,n,t)})},Zu.prototype.di=function(t,r,i){return this.ai.wi(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ri(r,t);return t})},Zu.prototype.mi=function(t,e,i){var o=co;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ri(t,e);o=o.rt(t,e)}),o},Zu.prototype.Ti=function(e,t){var n=this;return this.ai.getEntries(e,t).next(function(t){return n.Ei(e,t)})},Zu.prototype.Ei=function(r,i){var o=this;return this.hi.Ii(r,i).next(function(t){var e=o.mi(r,i,t),n=co;return e.forEach(function(t,e){e=e||new Ia(t,Ci.min()),n=n.rt(t,e)}),n})},Zu.prototype.Ai=function(t,e,n){return r=e,Xr.N(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Ri(t,e.path):Va(e)?this.yi(t,e,n):this.Pi(t,e,n);var r},Zu.prototype.Ri=function(t,e){return this._i(t,new Xr(e)).next(function(t){var e=po;return t instanceof Ea&&(e=e.rt(t.key,t)),e})},Zu.prototype.yi=function(i,o,s){var a=this,u=o.collectionGroup,h=po;return this.li.pi(i,u).next(function(t){return Iu.forEach(t,function(t){var e,n,r=(e=o,n=t.child(u),new Aa(n,null,e.rn.slice(),e.filters.slice(),e.limit,e.on,e.startAt,e.endAt));return a.Pi(i,r,s).next(function(t){t.forEach(function(t,e){h=h.rt(t,e)})})}).next(function(){return h})})},Zu.prototype.Pi=function(e,n,t){var c,l,r=this;return this.ai.Ai(e,n,t).next(function(t){return c=t,r.hi.gi(e,n)}).next(function(t){return l=t,r.Vi(e,l,c).next(function(t){c=t;for(var e=0,n=l;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],a=s.key,u=c.get(a),h=Hs(s,u,u,r.ni);c=h instanceof Ea?c.rt(a,h):c.remove(a)}})}).next(function(){return c.forEach(function(t,e){qa(n,e)||(c=c.remove(t))}),c})},Zu.prototype.Vi=function(t,e,n){for(var r=go(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof $s&&null===n.get(u.key)&&(r=r.add(u.key))}var h=n;return this.ai.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Ea&&(h=h.rt(t,e))}),h})},Zu),Ku=(Ju.Si=function(t,e){for(var n=go(),r=go(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Ju(t,e.fromCache,n,r)},Ju),Xu=(Yu.Ni=function(t){return new Yu(t,Yu.$i,Yu.xi)},Yu);function Yu(t,e,n){this.Ci=t,this.Di=e,this.Fi=n}function Ju(t,e,n,r){this.targetId=t,this.fromCache=e,this.vi=n,this.bi=r}function Zu(t,e,n){this.ai=t,this.hi=e,this.li=n}function $u(t,e,n,r){this.batch=t,this.ui=e,this.ii=n,this.ci=r}function th(t,e,n,r){this.batchId=t,this.ni=e,this.baseMutations=n,this.mutations=r}function eh(){this.Us=new Bu,this.Bs={},this.Qs=null,this.Ns=null}function nh(){this.activeTargetIds=mo}Xu.ki=-1,Xu.Oi=1048576,Xu.Mi=41943040,Xu.$i=10,Xu.xi=1e3,Xu.Li=new Xu(Xu.Mi,Xu.$i,Xu.xi),Xu.qi=new Xu(Xu.ki,0,0);var rh=(ch.prototype.Bi=function(t,e){return this.Ui.add(e),Iu.resolve()},ch.prototype.pi=function(t,e){return Iu.resolve(this.Ui.getEntries(e))},ch),ih=(hh.prototype.add=function(t){var e=t._(),n=t.h(),r=this.index[e]||new uo(Wr.i),i=!r.has(n);return this.index[e]=r.add(n),i},hh.prototype.has=function(t){var e=t._(),n=t.h(),r=this.index[e];return r&&r.has(n)},hh.prototype.getEntries=function(t){return(this.index[t]||new uo(Wr.i)).A()},hh),oh=(uh.prototype.next=function(){return this.Qi+=2,this.Qi},uh.ji=function(){return new uh(0)},uh.Wi=function(){return new uh(-1)},uh),sh=(ah.prototype.ir=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.rr(t,n.zi)})},ah);function ah(t,e,n){this.persistence=t,this.Gi=e,this.zi=new eo(Ei),this.Ki=new Vi(zi,Wi),this.Hi=Ci.min(),this.hi=t.Yi(n),this.Ji=t.Xi(),this.Zi=t.tr(),this.er=new Hu(this.Ji,this.hi,this.persistence.nr()),this.Gi.sr(this.er)}function uh(t){this.Qi=t}function hh(){this.index={}}function ch(){this.Ui=new ih}function lh(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Zi._r(t)})}function fh(o,s,a){return w(this,void 0,void 0,function(){var e,n,r,i;return b(this,function(t){switch(t.label){case 0:n=(e=o).zi.get(s),r=a?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),a?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Ar.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Nu(i=t.sent()))throw i;return _r("LocalStore","Failed to update sequence numbers for target "+s+": "+i),[3,5];case 5:return e.zi=e.zi.remove(s),e.Ki.delete(n.target),[2]}})})}function ph(t,s,a){var u=t,h=Ci.min(),c=go();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=Ca(s),(void 0!==(o=(i=t).Ki.get(r))?Iu.resolve(i.zi.get(o)):i.Zi.Pr(n,r)).next(function(t){if(t)return h=t.lastLimboFreeSnapshotVersion,u.Zi.pr(e,t.targetId).next(function(t){c=t})}).next(function(){return u.Gi.Ai(e,s,a?h:Ci.min(),a?c:go())}).next(function(t){return{documents:t,gr:c}});var t,n,r,i,o})}function dh(e){return w(this,void 0,void 0,function(){return b(this,function(t){if(e.code!==kr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return _r("LocalStore","Unexpectedly lost primary lease"),[2]})})}function vh(t,e){this.user=e,this.type="OAuth",this.Ur={},this.Ur.Authorization="Bearer "+t}function yh(t,e,n,r,i){var o=this;this.Qo=t,this.jo=e,this.kn=n,this.Wo={},this.Go=[],this.zo=new Map,this.Ko=new Set,this.Ho=[],this.Yo=i,this.Yo.Jo(function(t){n.Qn(function(){return w(o,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return Jh(this)?(_r("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return w(this,void 0,void 0,function(){var e;return b(this,function(t){switch(t.label){case 0:return(e=n).Ko.add(4),[4,Bh(e)];case 1:return t.sent(),e.Xo.set("Unknown"),e.Ko.delete(4),[4,qh(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Xo=new Oh(n,r)}var gh,mh,wh,bh=(Fh.prototype.m=function(){return this.Vr.m()},Fh.prototype.Cr=function(t,e){var n=new Eh(t,e);this.Vr=this.Vr.add(n),this.br=this.br.add(n)},Fh.prototype.Dr=function(t,e){var n=this;t.forEach(function(t){return n.Cr(t,e)})},Fh.prototype.Fr=function(t,e){this.Nr(new Eh(t,e))},Fh.prototype.$r=function(t,e){var n=this;t.forEach(function(t){return n.Fr(t,e)})},Fh.prototype.kr=function(t){var e=this,n=new Xr(new Wr([])),r=new Eh(n,t),i=new Eh(n,t+1),o=[];return this.br.Ft([r,i],function(t){e.Nr(t),o.push(t.key)}),o},Fh.prototype.Or=function(){var e=this;this.Vr.forEach(function(t){return e.Nr(t)})},Fh.prototype.Nr=function(t){this.Vr=this.Vr.delete(t),this.br=this.br.delete(t)},Fh.prototype.Mr=function(t){var e=new Xr(new Wr([])),n=new Eh(e,t),r=new Eh(e,t+1),i=go();return this.br.Ft([n,r],function(t){i=i.add(t.key)}),i},Fh.prototype.Lr=function(t){var e=new Eh(t,0),n=this.Vr.$t(e);return null!==n&&t.isEqual(n.key)},Fh),Eh=(xh.vr=function(t,e){return Xr.i(t.key,e.key)||Ei(t.qr,e.qr)},xh.Sr=function(t,e){return Ei(t.qr,e.qr)||Xr.i(t.key,e.key)},xh),Ih=(Gh.prototype.getToken=function(){return Promise.resolve(null)},Gh.prototype.Qr=function(){},Gh.prototype.jr=function(t){(this.Br=t)(ju.UNAUTHENTICATED)},Gh.prototype.Wr=function(){this.Br=null},Gh),Th=(jh.prototype.getToken=function(){var e=this,n=this.Kr,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.Kr!==n?(_r("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Gr("string"==typeof t.accessToken),new vh(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},jh.prototype.Qr=function(){this.forceRefresh=!0},jh.prototype.jr=function(t){this.Br=t,this.zr&&t(this.currentUser)},jh.prototype.Wr=function(){this.auth&&this.auth.removeAuthTokenListener(this.Gr),this.Gr=null,this.Br=null},jh.prototype.Hr=function(){var t=this.auth&&this.auth.getUid();return Gr(null===t||"string"==typeof t),new ju(t)},jh),Ah=(Object.defineProperty(Mh.prototype,"Ur",{get:function(){var t={"X-Goog-AuthUser":this.Jr},e=this.Yr.auth.Xr([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Mh),Nh=(Uh.prototype.getToken=function(){return Promise.resolve(new Ah(this.Yr,this.Jr))},Uh.prototype.jr=function(t){t(ju.Fs)},Uh.prototype.Wr=function(){},Uh.prototype.Qr=function(){},Uh),Rh=(Ch.prototype.ro=function(){return 1===this.state||2===this.state||4===this.state},Ch.prototype.oo=function(){return 2===this.state},Ch.prototype.start=function(){3!==this.state?this.auth():this.uo()},Ch.prototype.stop=function(){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return this.ro()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Ch.prototype.co=function(){this.state=0,this.Jn.reset()},Ch.prototype.ao=function(){var t=this;this.oo()&&null===this.io&&(this.io=this._n.Pn(this.Zr,6e4,function(){return t.ho()}))},Ch.prototype.lo=function(t){this._o(),this.stream.send(t)},Ch.prototype.ho=function(){return w(this,void 0,void 0,function(){return b(this,function(t){return this.oo()?[2,this.close(0)]:[2]})})},Ch.prototype._o=function(){this.io&&(this.io.cancel(),this.io=null)},Ch.prototype.close=function(e,n){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return this._o(),this.Jn.cancel(),this.so++,3!==e?this.Jn.reset():n&&n.code===kr.RESOURCE_EXHAUSTED?(Cr(n.toString()),Cr("Using maximum backoff delay to prevent overloading the backend."),this.Jn.An()):n&&n.code===kr.UNAUTHENTICATED&&this.no.Qr(),null!==this.stream&&(this.fo(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.do(n)];case 1:return t.sent(),[2]}})})},Ch.prototype.fo=function(){},Ch.prototype.auth=function(){var n=this;this.state=1;var t=this.wo(this.so),e=this.so;this.no.getToken().then(function(t){n.so===e&&n.mo(t)},function(e){t(function(){var t=new Or(kr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.To(t)})})},Ch.prototype.mo=function(t){var e=this,n=this.wo(this.so);this.stream=this.Eo(t),this.stream.Io(function(){n(function(){return e.state=2,e.listener.Io()})}),this.stream.do(function(t){n(function(){return e.To(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Ch.prototype.uo=function(){var t=this;this.state=4,this.Jn.Rn(function(){return w(t,void 0,void 0,function(){return b(this,function(t){return this.state=0,this.start(),[2]})})})},Ch.prototype.To=function(t){return _r("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Ch.prototype.wo=function(e){var n=this;return function(t){n._n.Qn(function(){return n.so===e?t():(_r("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Ch),Sh=(o(_h,wh=Rh),_h.prototype.Eo=function(t){return this.eo.Ao("Listen",t)},_h.prototype.onMessage=function(t){this.Jn.reset();var e=function(t,e){var n,r,i,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:jr(),a=e.targetChange.targetIds||[],u=(i=e.targetChange.resumeToken,t.Be?(Gr(void 0===i||"string"==typeof i),Ti.fromBase64String(i||"")):(Gr(void 0===i||i instanceof Uint8Array),Ti.fromUint8Array(i||new Uint8Array))),h=e.targetChange.cause,c=h&&(r=void 0===(n=h).code?kr.UNKNOWN:to(n.code),new Or(r,n.message||"")),l=new Ro(s,a,u,c||null)}else if("documentChange"in e){e.documentChange;var f=e.documentChange;f.document,f.document.name,f.document.updateTime;var p=ps(t,f.document.name),d=cs(f.document.updateTime),v=new la({mapValue:{fields:f.document.fields}}),y=new Ea(p,d,v,{}),g=f.targetIds||[],m=f.removedTargetIds||[],l=new Ao(g,m,y.key,y)}else if("documentDelete"in e){e.documentDelete;var w=e.documentDelete;w.document;var b=ps(t,w.document),E=w.readTime?cs(w.readTime):Ci.min(),I=new Ia(b,E),T=w.removedTargetIds||[];l=new Ao([],T,I.key,I)}else if("documentRemove"in e){e.documentRemove;var A=e.documentRemove;A.document;var N=ps(t,A.document),R=A.removedTargetIds||[];l=new Ao([],R,N,null)}else{if(!("filter"in e))return jr();e.filter;var S=e.filter;S.targetId;var L=new Ki(S.count||0),k=S.targetId;l=new No(k,L)}return l}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Ci.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Ci.min():cs(e.readTime)}(t);return this.listener.Ro(e,n)},_h.prototype.yo=function(t){var e,n,r,i,o={};o.database=vs(this.serializer),o.addTarget=(e=this.serializer,(r=Hi(i=(n=t).target)?{documents:{documents:[ds(e,i.path)]}}:{query:function(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=ds(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=ds(t,r.h()),n.structuredQuery.from=[{collectionId:r._()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){if("=="===t.op){if(ts(t.value))return{unaryFilter:{field:ws(t.field),op:"IS_NAN"}};if($o(t.value))return{unaryFilter:{field:ws(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(ts(t.value))return{unaryFilter:{field:ws(t.field),op:"IS_NOT_NAN"}};if($o(t.value))return{unaryFilter:{field:ws(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ws(t.field),op:(e=t.op,rs[e]),value:t.value}};var e});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:ws((e=t).field),direction:(n=e.dir,ns[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,a=(s=e.limit,t.Be||Fi(s)?s:{value:s});return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=ms(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ms(e.endAt)),n}(e,i)}).targetId=n.targetId,0<n.resumeToken.M()&&(r.resumeToken=hs(e,n.resumeToken)),r);var s,a,u=(this.serializer,s=t,null==(a=function(){switch(s.tt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return jr()}}())?null:{"goog-listen-tags":a});u&&(o.labels=u),this.lo(o)},_h.prototype.Po=function(t){var e={};e.database=vs(this.serializer),e.removeTarget=t,this.lo(e)},_h),Lh=(o(Vh,mh=Rh),Object.defineProperty(Vh.prototype,"Vo",{get:function(){return this.po},enumerable:!1,configurable:!0}),Vh.prototype.start=function(){this.po=!1,this.lastStreamToken=void 0,mh.prototype.start.call(this)},Vh.prototype.fo=function(){this.po&&this.vo([])},Vh.prototype.Eo=function(t){return this.eo.Ao("Write",t)},Vh.prototype.onMessage=function(t){if(Gr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.po){this.Jn.reset();var e=(r=t.writeResults,i=t.commitTime,r&&0<r.length?(Gr(void 0!==i),r.map(function(t){return function(t,e){var n=t.updateTime?cs(t.updateTime):cs(e);n.isEqual(Ci.min())&&(n=cs(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new qs(n,r)}(t,i)})):[]),n=cs(t.commitTime);return this.listener.bo(n,e)}var r,i;return Gr(!t.writeResults||0===t.writeResults.length),this.po=!0,this.listener.So()},Vh.prototype.Co=function(){var t={};t.database=vs(this.serializer),this.lo(t)},Vh.prototype.vo=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return gs(e.serializer,t)})};this.lo(n)},Vh),kh=(o(Ph,gh=function(){}),Ph.prototype.Fo=function(){if(this.Do)throw new Or(kr.FAILED_PRECONDITION,"The client has already been terminated.")},Ph.prototype.No=function(e,n,r){var i=this;return this.Fo(),this.credentials.getToken().then(function(t){return i.eo.No(e,n,r,t)}).catch(function(t){throw t.code===kr.UNAUTHENTICATED&&i.credentials.Qr(),t})},Ph.prototype.$o=function(e,n,r){var i=this;return this.Fo(),this.credentials.getToken().then(function(t){return i.eo.$o(e,n,r,t)}).catch(function(t){throw t.code===kr.UNAUTHENTICATED&&i.credentials.Qr(),t})},Ph.prototype.terminate=function(){this.Do=!1},Ph),Oh=(Dh.prototype.Mo=function(){var t=this;0===this.xo&&(this.Lo("Unknown"),this.ko=this.kn.Pn("online_state_timeout",1e4,function(){return t.ko=null,t.qo("Backend didn't respond within 10 seconds."),t.Lo("Offline"),Promise.resolve()}))},Dh.prototype.Uo=function(t){"Online"===this.state?this.Lo("Unknown"):(this.xo++,1<=this.xo&&(this.Bo(),this.qo("Connection failed 1 times. Most recent error: "+t.toString()),this.Lo("Offline")))},Dh.prototype.set=function(t){this.Bo(),this.xo=0,"Online"===t&&(this.Oo=!1),this.Lo(t)},Dh.prototype.Lo=function(t){t!==this.state&&(this.state=t,this.Qs(t))},Dh.prototype.qo=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Oo?(Cr(e),this.Oo=!1):_r("OnlineStateTracker",e)},Dh.prototype.Bo=function(){null!==this.ko&&(this.ko.cancel(),this.ko=null)},Dh);function Dh(t,e){this.kn=t,this.Qs=e,this.state="Unknown",this.xo=0,this.ko=null,this.Oo=!0}function Ph(t,e,n){var r=this;return(r=gh.call(this)||this).credentials=t,r.eo=e,r.serializer=n,r.Do=!1,r}function Vh(t,e,n,r,i){var o=this;return(o=mh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.po=!1,o}function _h(t,e,n,r,i){var o=this;return(o=wh.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Ch(t,e,n,r,i,o){this._n=t,this.Zr=n,this.eo=r,this.no=i,this.listener=o,this.state=0,this.so=0,this.io=null,this.stream=null,this.Jn=new Eu(t,e)}function Uh(t,e){this.Yr=t,this.Jr=e}function Mh(t,e){this.Yr=t,this.Jr=e,this.type="FirstParty",this.user=ju.Fs}function jh(t){var e=this;this.Gr=null,this.currentUser=ju.UNAUTHENTICATED,this.zr=!1,this.Kr=0,this.Br=null,this.forceRefresh=!1,this.Gr=function(){e.Kr++,e.currentUser=e.Hr(),e.zr=!0,e.Br&&e.Br(e.currentUser)},this.Kr=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Gr):(this.Gr(null),t.get().then(function(t){e.auth=t,e.Gr&&e.auth.addAuthTokenListener(e.Gr)},function(){}))}function Gh(){this.Br=null}function xh(t,e){this.key=t,this.qr=e}function Fh(){this.Vr=new uo(Eh.vr),this.br=new uo(Eh.Sr)}function qh(r){return w(this,void 0,void 0,function(){var e,n;return b(this,function(t){switch(t.label){case 0:if(!Jh(r))return[3,4];e=0,n=r.Ho,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Bh(r){return w(this,void 0,void 0,function(){var e,n;return b(this,function(t){switch(t.label){case 0:e=0,n=r.Ho,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Qh(n){return w(this,void 0,void 0,function(){var e;return b(this,function(t){switch(t.label){case 0:return e=n,_r("RemoteStore","RemoteStore shutting down."),e.Ko.add(5),[4,Bh(e)];case 1:return t.sent(),e.Yo.ei(),e.Xo.set("Unknown"),[2]}})})}function zh(t,e){var n=t;n.zo.has(e.targetId)||(n.zo.set(e.targetId,e),Yh(n)?Xh(n):ic(n).oo()&&Hh(n,e))}function Wh(t,e){var n=t,r=ic(n);n.zo.delete(e),r.oo()&&Kh(n,e),0===n.zo.size&&(r.oo()?r.ao():Jh(n)&&n.Xo.set("Unknown"))}function Hh(t,e){t.Zo.Ee(e.targetId),ic(t).yo(e)}function Kh(t,e){t.Zo.Ee(e),ic(t).Po(e)}function Xh(e){e.Zo=new Lo({qe:function(t){return e.Wo.qe(t)},Ue:function(t){return e.zo.get(t)||null}}),ic(e).start(),e.Xo.Mo()}function Yh(t){return Jh(t)&&!ic(t).ro()&&0<t.zo.size}function Jh(t){return 0===t.Ko.size}function Zh(t){t.Zo=void 0}function $h(n,r,i){return w(this,void 0,void 0,function(){var e=this;return b(this,function(t){switch(t.label){case 0:if(!Nu(r))throw r;return n.Ko.add(1),[4,Bh(n)];case 1:return t.sent(),n.Xo.set("Offline"),i=i||function(){return lh(n.Qo)},n.kn.rs(function(){return w(e,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return _r("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Ko.delete(1),[4,qh(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function tc(e,n){return n().catch(function(t){return $h(e,t,n)})}function ec(h){return w(this,void 0,void 0,function(){var i,o,s,a,u;return b(this,function(t){switch(t.label){case 0:o=oc(i=h),s=0<i.Go.length?i.Go[i.Go.length-1].batchId:-1,t.label=1;case 1:if(!(Jh(i)&&i.Go.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.Qo,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.hi.yr(t,n)}))];case 3:return null===(a=t.sent())?(0===i.Go.length&&o.ao(),[3,7]):(s=a.batchId,function(t,e){t.Go.push(e);var n=oc(t);n.oo()&&n.Vo&&n.vo(e.mutations)}(i,a),[3,6]);case 4:return u=t.sent(),[4,$h(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return nc(i)&&rc(i),[2]}var e,n,r})})}function nc(t){return Jh(t)&&!oc(t).ro()&&0<t.Go.length}function rc(t){oc(t).start()}function ic(n){var t,e,r,i,o=this;return n.iu||(n.iu=(t=n.jo,e=n.kn,r={Io:function(n){return w(this,void 0,void 0,function(){return b(this,function(t){return n.zo.forEach(function(t,e){Hh(n,t)}),[2]})})}.bind(null,n),do:function(e,n){return w(this,void 0,void 0,function(){return b(this,function(t){return Zh(e),Yh(e)?(e.Xo.Uo(n),Xh(e)):e.Xo.set("Unknown"),[2]})})}.bind(null,n),Ro:function(a,u,h){return w(this,void 0,void 0,function(){var n,o,s;return b(this,function(t){switch(t.label){case 0:if(a.Xo.set("Online"),!(u instanceof Ro&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return w(this,void 0,void 0,function(){var e,n,r,i;return b(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.zo.has(i)?[4,o.Wo.tu(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.zo.delete(i),o.Zo.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(a,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),_r("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,$h(a,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof Ao?a.Zo.Ve(u):u instanceof No?a.Zo.$e(u):a.Zo.Se(u),h.isEqual(Ci.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,lh(a.Qo)];case 8:return o=t.sent(),0<=h.L(o)?[4,(i=h,(e=(r=a).Zo.Oe(i)).zt.forEach(function(t,e){var n;0<t.resumeToken.M()&&(n=r.zo.get(e))&&r.zo.set(e,n.st(t.resumeToken,i))}),e.Kt.forEach(function(t){var e,n=r.zo.get(t);n&&(r.zo.set(t,n.st(Ti.q,n.et)),Kh(r,t),e=new Ji(n.target,t,1,n.sequenceNumber),Hh(r,e))}),r.Wo.eu(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return _r("RemoteStore","Failed to raise snapshot:",s=t.sent()),[4,$h(a,s)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},(i=t).Fo(),new Sh(e,i.eo,i.credentials,i.serializer,r)),n.Ho.push(function(e){return w(o,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return e?(n.iu.co(),Yh(n)?Xh(n):n.Xo.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.iu.stop()];case 2:t.sent(),Zh(n),t.label=3;case 3:return[2]}})})})),n.iu}function oc(n){var t,e,r,i,o=this;return n.ru||(n.ru=(t=n.jo,e=n.kn,r={Io:function(e){return w(this,void 0,void 0,function(){return b(this,function(t){return oc(e).Co(),[2]})})}.bind(null,n),do:function(e,n){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return n&&oc(e).Vo?[4,function(r,i){return w(this,void 0,void 0,function(){var e,n;return b(this,function(t){switch(t.label){case 0:return $i(n=i.code)&&n!==kr.ABORTED?(e=r.Go.shift(),oc(r).co(),[4,tc(r,function(){return r.Wo.su(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,ec(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return nc(e)&&rc(e),[2]}})})}.bind(null,n),So:function(o){return w(this,void 0,void 0,function(){var e,n,r,i;return b(this,function(t){for(e=oc(o),n=0,r=o.Go;n<r.length;n++)i=r[n],e.vo(i.mutations);return[2]})})}.bind(null,n),bo:function(r,i,o){return w(this,void 0,void 0,function(){var e,n;return b(this,function(t){switch(t.label){case 0:return e=r.Go.shift(),n=Wu.from(e,i,o),[4,tc(r,function(){return r.Wo.nu(n)})];case 1:return t.sent(),[4,ec(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},(i=t).Fo(),new Lh(e,i.eo,i.credentials,i.serializer,r)),n.Ho.push(function(e){return w(o,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return e?(n.ru.co(),[4,ec(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.ru.stop()];case 3:t.sent(),0<n.Go.length&&(_r("RemoteStore","Stopping write stream with "+n.Go.length+" pending writes"),n.Go=[]),t.label=4;case 4:return[2]}})})})),n.ru}function sc(t,e,n){this.query=t,this.targetId=e,this.view=n}var ac=function(t){this.key=t},uc=function(t){this.key=t},hc=(Object.defineProperty(pc.prototype,"lu",{get:function(){return this.ou},enumerable:!1,configurable:!0}),pc.prototype._u=function(t,e){var a=this,u=e?e.fu:new bo,h=e?e.hu:this.hu,c=e?e.Qt:this.Qt,l=h,f=!1,p=ka(this.query)&&h.size===this.query.limit?h.last():null,d=Oa(this.query)&&h.size===this.query.limit?h.first():null;if(t.at(function(t,e){var n=h.get(t),r=(r=e instanceof Ea?e:null)&&(qa(a.query,r)?r:null),i=!!n&&a.Qt.has(n.key),o=!!r&&(r.Ye||a.Qt.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),s=!0):a.du(n,r)||(u.track({type:2,doc:r}),s=!0,(p&&0<a.au(r,p)||d&&a.au(r,d)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),s=!0):n&&!r&&(u.track({type:1,doc:n}),s=!0,(p||d)&&(f=!0)),s&&(c=r?(l=l.add(r),o?c.add(t):c.delete(t)):(l=l.delete(t),c.delete(t)))}),ka(this.query)||Oa(this.query))for(;l.size>this.query.limit;){var n=ka(this.query)?l.last():l.first(),l=l.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{hu:l,fu:u,wu:f,Qt:c}},pc.prototype.du=function(t,e){return t.Ye&&e.hasCommittedMutations&&!e.Ye},pc.prototype.mu=function(t,e,n){var o=this,r=this.hu;this.hu=t.hu,this.Qt=t.Qt;var i=t.fu.Ut();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.au(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return jr()}}var r,i}),this.Tu(n);var s=e?this.Eu():[],a=0===this.cu.size&&this.Zt?1:0,u=a!==this.uu;return this.uu=a,0!==i.length||u?{snapshot:new Eo(this.query,t.hu,r,i,t.Qt,0==a,u,!1),Iu:s}:{Iu:s}},pc.prototype.Is=function(t){return this.Zt&&"Offline"===t?(this.Zt=!1,this.mu({hu:this.hu,fu:new bo,Qt:this.Qt,wu:!1},!1)):{Iu:[]}},pc.prototype.Au=function(t){return!this.ou.has(t)&&!!this.hu.has(t)&&!this.hu.get(t).Ye},pc.prototype.Tu=function(t){var e=this;t&&(t.te.forEach(function(t){return e.ou=e.ou.add(t)}),t.ee.forEach(function(t){}),t.ne.forEach(function(t){return e.ou=e.ou.delete(t)}),this.Zt=t.Zt)},pc.prototype.Eu=function(){var e=this;if(!this.Zt)return[];var n=this.cu;this.cu=go(),this.hu.forEach(function(t){e.Au(t.key)&&(e.cu=e.cu.add(t.key))});var r=[];return n.forEach(function(t){e.cu.has(t)||r.push(new uc(t))}),this.cu.forEach(function(t){n.has(t)||r.push(new ac(t))}),r},pc.prototype.Ru=function(t){this.ou=t.gr,this.cu=go();var e=this._u(t.documents);return this.mu(e,!0)},pc.prototype.yu=function(){return Eo.Gt(this.query,this.hu,this.Qt,0===this.uu)},pc),cc=function(t){this.key=t,this.Pu=!1},lc=(Object.defineProperty(fc.prototype,"Lu",{get:function(){return!0===this.Mu},enumerable:!1,configurable:!0}),fc);function fc(t,e,n,r,i,o){this.Qo=t,this.pu=e,this.gu=n,this.Vu=r,this.currentUser=i,this.vu=o,this.bu={},this.Su=new Vi(xa,Ga),this.Cu=new Map,this.Du=[],this.Fu=new eo(Xr.i),this.Nu=new Map,this.$u=new bh,this.xu={},this.ku=new Map,this.Ou=oh.Wi(),this.onlineState="Unknown",this.Mu=void 0}function pc(t,e){this.query=t,this.ou=e,this.uu=null,this.Zt=!1,this.cu=go(),this.Qt=go(),this.au=Ba(t),this.hu=new wo(this.au)}function dc(y,g,m){return w(this,void 0,void 0,function(){var u,p,d,v;return b(this,function(t){switch(t.label){case 0:(a=y).pu.Wo.nu=function(o,s){return w(this,void 0,void 0,function(){var n,r,i;return b(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Qo,c=s,(l=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var i,e=c.batch.keys(),n=l.Ji.ur({cr:!0}),r=l,o=t,s=n,a=(i=c).batch,u=a.keys(),h=Iu.resolve();return u.forEach(function(r){h=h.next(function(){return s.wi(o,r)}).next(function(t){var e=t,n=i.ci.get(r);Gr(null!==n),(!e||e.version.L(n)<0)&&(e=a.si(r,e,i))&&s.ar(e,i.ui)})}),h.next(function(){return r.hi.hr(o,a)}).next(function(){return n.apply(t)}).next(function(){return l.hi.lr(t)}).next(function(){return l.er.Ti(t,e)})}))];case 2:return i=t.sent(),mc(n,r,null),gc(n,r),n.Vu.Ws(r,"acknowledged"),[4,Tc(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,dh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,c,l})})}.bind(null,a),a.pu.Wo.su=function(s,a,u){return w(this,void 0,void 0,function(){var n,o;return b(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Qo,r=a,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.hi.Gu(e,r).next(function(t){return Gr(null!==t),n=t.keys(),i.hi.hr(e,t)}).next(function(){return i.hi.lr(e)}).next(function(){return i.er.Ti(e,n)})}))];case 2:return o=t.sent(),mc(n,a,u),gc(n,a),n.Vu.Ws(a,"rejected",u),[4,Tc(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,dh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,a),u=a,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(o=u.Qo,h=g,l=o,f=_i.now(),s=h.reduce(function(t,e){return t.add(e.key)},go()),l.persistence.runTransaction("Locally write mutations","readwrite",function(u){return l.er.Ti(u,s).next(function(t){c=t;for(var a,e,n=[],r=0,i=h;r<i.length;r++){var o=i[r],s=(a=o,e=c.get(o.key),a instanceof ia?function(t){for(var e=null,n=0,r=a.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Ea?t.field(i.field):void 0,s=Is(i.transform,o||null);null!=s&&(e=null==e?(new fa).set(i.field,s):e.set(i.field,s))}return e?e.Je():null}(e):null);null!=s&&n.push(new $s(o.key,s,function a(t){var u=[];return Fr(t.fields||{},function(t,e){var n=new Kr([t]);if(es(e)){var r=a(e.mapValue).fields;if(0===r.length)u.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];u.push(n.child(s))}}else u.push(n)}),new xs(u)}(s.proto.mapValue),Bs.exists(!0)))}return l.hi.ju(u,f,n,h)})}).then(function(t){var e=t.oi(c);return{batchId:t.batchId,Wu:e}}))];case 2:return p=t.sent(),u.Vu.js(p.batchId),e=u,n=p.batchId,r=m,i=(i=(i=e.xu[e.currentUser.Cs()])||new eo(Ei)).rt(n,r),e.xu[e.currentUser.Cs()]=i,[4,Tc(u,p.Wu)];case 3:return t.sent(),[4,ec(u.pu)];case 4:return t.sent(),[3,6];case 5:return d=t.sent(),v=Du(d,"Failed to persist write"),m.reject(v),[3,6];case 6:return[2]}var e,n,r,i,o,h,c,l,f,s,a})})}function vc(i,o){return w(this,void 0,void 0,function(){var r,n;return b(this,function(t){switch(t.label){case 0:r=i,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=r.Qo,c=e,l=(s=o).et,f=c.zi,c.persistence.runTransaction("Apply remote event","readwrite-primary",function(u){var i=c.Ji.ur({cr:!0});f=c.zi;var h=[];s.zt.forEach(function(t,e){var n,r,i,o,s,a=f.get(e);a&&(h.push(c.Zi.dr(u,t.ne,e).next(function(){return c.Zi.wr(u,t.te,e)})),0<(n=t.resumeToken).M()&&(r=a.st(n,l).nt(u.mr),f=f.rt(e,r),i=a,s=t,Gr(0<(o=r).resumeToken.M()),(0===i.resumeToken.M()||3e8<=o.et.J()-i.et.J()||0<s.te.size+s.ee.size+s.ne.size)&&h.push(c.Zi.Tr(u,r))))});var t,o=co,n=go();return s.Ht.forEach(function(t,e){n=n.add(t)}),h.push(i.getEntries(u,n).next(function(r){s.Ht.forEach(function(t,e){var n=r.get(t);e instanceof Ia&&e.version.isEqual(Ci.min())?(i.Er(t,l),o=o.rt(t,e)):null==n||0<e.version.L(n.version)||0===e.version.L(n.version)&&n.hasPendingWrites?(i.ar(e,l),o=o.rt(t,e)):_r("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),s.Yt.has(t)&&h.push(c.persistence.Ar.Ir(u,t))})})),l.isEqual(Ci.min())||(t=c.Zi._r(u).next(function(t){return c.Zi.Rr(u,u.mr,l)}),h.push(t)),Iu.$n(h).next(function(){return i.apply(u)}).next(function(){return c.er.Ei(u,o)})}).then(function(t){return c.zi=f,t}))];case 2:return n=t.sent(),o.zt.forEach(function(t,e){var n=r.Nu.get(e);n&&(Gr(t.te.size+t.ee.size+t.ne.size<=1),0<t.te.size?n.Pu=!0:0<t.ee.size?Gr(n.Pu):0<t.ne.size&&(Gr(n.Pu),n.Pu=!1))}),[4,Tc(r,n,o)];case 3:return t.sent(),[3,6];case 4:return[4,dh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,s,c,l,f})})}function yc(t,r,e){var i,n=t;(n.Lu&&0===e||!n.Lu&&1===e)&&(i=[],n.Su.forEach(function(t,e){var n=e.view.Is(r);n.snapshot&&i.push(n.snapshot)}),function(t,i){var e=t;e.onlineState=i;var o=!1;e.ws.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Is(i)&&(o=!0)}),o&&Uu(e)}(n.gu,r),i.length&&n.bu.Ro(i),n.onlineState=r,n.Lu&&n.Vu.ti(r))}function gc(t,e){(t.ku.get(e)||[]).forEach(function(t){t.resolve()}),t.ku.delete(e)}function mc(t,e,n){var r,i=t,o=i.xu[i.currentUser.Cs()];o&&((r=o.get(e))&&(n?r.reject(n):r.resolve(),o=o.remove(e)),i.xu[i.currentUser.Cs()]=o)}function wc(e,t,n){void 0===n&&(n=null),e.Vu.Ks(t);for(var r=0,i=e.Cu.get(t);r<i.length;r++){var o=i[r];e.Su.delete(o),n&&e.bu.qu(o,n)}e.Cu.delete(t),e.Lu&&e.$u.kr(t).forEach(function(t){e.$u.Lr(t)||bc(e,t)})}function bc(t,e){var n=t.Fu.get(e);null!==n&&(Wh(t.pu,n),t.Fu=t.Fu.remove(e),t.Nu.delete(n),Ic(t))}function Ec(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var a=s[o];a instanceof ac?(t.$u.Cr(a.key,e),r=t,i=a.key,r.Fu.get(i)||(_r("SyncEngine","New document in limbo: "+i),r.Du.push(i),Ic(r))):a instanceof uc?(_r("SyncEngine","Document no longer in limbo: "+a.key),t.$u.Fr(a.key,e),t.$u.Lr(a.key)||bc(t,a.key)):jr()}}function Ic(t){for(;0<t.Du.length&&t.Fu.size<t.vu;){var e=t.Du.shift(),n=t.Ou.next();t.Nu.set(n,new cc(e)),t.Fu=t.Fu.rt(e,n),zh(t.pu,new Ji(Ca(La(e.path)),n,2,Fu.Os))}}function Tc(n,s,a){return w(this,void 0,void 0,function(){var r,i,o,e;return b(this,function(t){switch(t.label){case 0:return i=[],o=[],e=[],(r=n).Su.m()?[3,3]:(r.Su.forEach(function(t,n){e.push(r.Qu(n,s,a).then(function(t){var e;t&&(r.Lu&&r.Vu.zs(n.targetId,t.fromCache?"not-current":"current"),i.push(t),e=Ku.Si(n.targetId,t),o.push(e))}))}),[4,Promise.all(e)]);case 1:return t.sent(),r.bu.Ro(i),[4,function(c,l){return w(this,void 0,void 0,function(){var r,e,n,i,o,s,a,u,h;return b(this,function(t){switch(t.label){case 0:r=c,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Iu.forEach(l,function(e){return Iu.forEach(e.vi,function(t){return r.persistence.Ar.Cr(n,e.targetId,t)}).next(function(){return Iu.forEach(e.bi,function(t){return r.persistence.Ar.Fr(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Nu(e=t.sent()))throw e;return _r("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=l;n<i.length;n++)o=i[n],s=o.targetId,o.fromCache||(a=r.zi.get(s),u=a.et,h=a.it(u),r.zi=r.zi.rt(s,h));return[2]}})})}(r.Qo,o)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}var Ac,Nc=(Oc.prototype.sr=function(t){this.Xu=t},Oc.prototype.Ai=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.rn.length||1===r.rn.length&&r.rn[0].field.V())||i.isEqual(Ci.min())?this.Zu(e,r):this.Xu.Ti(e,o).next(function(t){var n=s.tc(r,t);return(ka(r)||Oa(r))&&s.wu(r.on,n,o,i)?s.Zu(e,r):(Vr()<=a.DEBUG&&_r("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Fa(r)),s.Xu.Ai(e,r,i).next(function(e){return n.forEach(function(t){e=e.rt(t.key,t)}),e}))})},Oc.prototype.tc=function(n,t){var r=new uo(Ba(n));return t.forEach(function(t,e){e instanceof Ea&&qa(n,e)&&(r=r.add(e))}),r},Oc.prototype.wu=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.L(r))},Oc.prototype.Zu=function(t,e){return Vr()<=a.DEBUG&&_r("IndexFreeQueryEngine","Using full collection scan to execute query:",Fa(e)),this.Xu.Ai(t,e,Ci.min())},Oc),Rc=(kc.prototype.sc=function(t){return Iu.resolve(0===this.hi.length)},kc.prototype.ju=function(t,e,n,r){var i=this.ec;this.ec++,0<this.hi.length&&this.hi[this.hi.length-1];var o=new zu(i,e,n,r);this.hi.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this.nc=this.nc.add(new Eh(u.key,i)),this.li.Bi(t,u.key.path.h())}return Iu.resolve(o)},kc.prototype.Gu=function(t,e){return Iu.resolve(this.ic(e))},kc.prototype.yr=function(t,e){var n=e+1,r=this.rc(n),i=r<0?0:r;return Iu.resolve(this.hi.length>i?this.hi[i]:null)},kc.prototype.zu=function(){return Iu.resolve(0===this.hi.length?-1:this.ec-1)},kc.prototype.Ku=function(t){return Iu.resolve(this.hi.slice())},kc.prototype.fi=function(t,e){var n=this,r=new Eh(e,0),i=new Eh(e,Number.POSITIVE_INFINITY),o=[];return this.nc.Ft([r,i],function(t){var e=n.ic(t.qr);o.push(e)}),Iu.resolve(o)},kc.prototype.Ii=function(t,e){var r=this,i=new uo(Ei);return e.forEach(function(t){var e=new Eh(t,0),n=new Eh(t,Number.POSITIVE_INFINITY);r.nc.Ft([e,n],function(t){i=i.add(t.qr)})}),Iu.resolve(this.oc(i))},kc.prototype.gi=function(t,e){var n=e.path,r=n.length+1,i=n;Xr.N(i)||(i=i.child(""));var o=new Eh(new Xr(i),0),s=new uo(Ei);return this.nc.Nt(function(t){var e=t.key.path;return!!n.T(e)&&(e.length===r&&(s=s.add(t.qr)),!0)},o),Iu.resolve(this.oc(s))},kc.prototype.oc=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.ic(t);null!==e&&r.push(e)}),r},kc.prototype.hr=function(n,r){var i=this;Gr(0===this.uc(r.batchId,"removed")),this.hi.shift();var o=this.nc;return Iu.forEach(r.mutations,function(t){var e=new Eh(t.key,r.batchId);return o=o.delete(e),i.Ar.cc(n,t.key)}).next(function(){i.nc=o})},kc.prototype.ac=function(t){},kc.prototype.Lr=function(t,e){var n=new Eh(e,0),r=this.nc.$t(n);return Iu.resolve(e.isEqual(r&&r.key))},kc.prototype.lr=function(t){return this.hi.length,Iu.resolve()},kc.prototype.uc=function(t,e){return this.rc(t)},kc.prototype.rc=function(t){return 0===this.hi.length?0:t-this.hi[0].batchId},kc.prototype.ic=function(t){var e=this.rc(t);return e<0||e>=this.hi.length?null:this.hi[e]},kc),Sc=(Lc.prototype.ar=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.hc(e);return this.docs=this.docs.rt(r,{lc:e,size:s,readTime:n}),this.size+=s-o,this.li.Bi(t,r.path.h())},Lc.prototype.Er=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Lc.prototype.wi=function(t,e){var n=this.docs.get(e);return Iu.resolve(n?n.lc:null)},Lc.prototype.getEntries=function(t,e){var n=this,r=co;return e.forEach(function(t){var e=n.docs.get(t);r=r.rt(t,e?e.lc:null)}),Iu.resolve(r)},Lc.prototype.Ai=function(t,e,n){for(var r=po,i=new Xr(e.path.child("")),o=this.docs._t(i);o.It();){var s=o.Et(),a=s.key,u=s.value,h=u.lc,c=u.readTime;if(!e.path.T(a.path))break;c.L(n)<=0||h instanceof Ea&&qa(e,h)&&(r=r.rt(h.key,h))}return Iu.resolve(r)},Lc.prototype._c=function(t,e){return Iu.forEach(this.docs,function(t){return e(t)})},Lc.prototype.ur=function(t){return new Lc.fc(this)},Lc.prototype.dc=function(t){return Iu.resolve(this.size)},Lc);function Lc(t,e){this.li=t,this.hc=e,this.docs=new eo(Xr.i),this.size=0}function kc(t,e){this.li=t,this.Ar=e,this.hi=[],this.ec=1,this.nc=new uo(Eh.vr)}function Oc(){}function Dc(t){var e=this;return(e=Ac.call(this)||this).Ac=t,e}function Pc(){this.Wu=new Vi(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.wc=!1}Sc.fc=(Object.defineProperty(Pc.prototype,"readTime",{get:function(){return this.mc},set:function(t){this.mc=t},enumerable:!1,configurable:!0}),Pc.prototype.ar=function(t,e){this.Tc(),this.readTime=e,this.Wu.set(t.key,t)},Pc.prototype.Er=function(t,e){this.Tc(),e&&(this.readTime=e),this.Wu.set(t,null)},Pc.prototype.wi=function(t,e){this.Tc();var n=this.Wu.get(e);return void 0!==n?Iu.resolve(n):this.Ec(t,e)},Pc.prototype.getEntries=function(t,e){return this.Ic(t,e)},Pc.prototype.apply=function(t){return this.Tc(),this.wc=!0,this.mu(t)},Pc.prototype.Tc=function(){},o(Dc,Ac=Pc),Dc.prototype.mu=function(n){var r=this,i=[];return this.Wu.forEach(function(t,e){e?i.push(r.Ac.ar(n,e,r.readTime)):r.Ac.Er(t)}),Iu.$n(i)},Dc.prototype.Ec=function(t,e){return this.Ac.wi(t,e)},Dc.prototype.Ic=function(t,e){return this.Ac.getEntries(t,e)},Dc);var Vc,_c,Cc=($c.prototype.Ce=function(t,n){return this.Rc.forEach(function(t,e){return n(e)}),Iu.resolve()},$c.prototype._r=function(t){return Iu.resolve(this.lastRemoteSnapshotVersion)},$c.prototype.Vc=function(t){return Iu.resolve(this.yc)},$c.prototype.Uu=function(t){return this.highestTargetId=this.gc.next(),Iu.resolve(this.highestTargetId)},$c.prototype.Rr=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.yc&&(this.yc=e),Iu.resolve()},$c.prototype.vc=function(t){this.Rc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.gc=new oh(e),this.highestTargetId=e),t.sequenceNumber>this.yc&&(this.yc=t.sequenceNumber)},$c.prototype.Bu=function(t,e){return this.vc(e),this.targetCount+=1,Iu.resolve()},$c.prototype.Tr=function(t,e){return this.vc(e),Iu.resolve()},$c.prototype.bc=function(t,e){return this.Rc.delete(e.target),this.Pc.kr(e.targetId),--this.targetCount,Iu.resolve()},$c.prototype.Sc=function(n,r,i){var o=this,s=0,a=[];return this.Rc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Rc.delete(t),a.push(o.Cc(n,e.targetId)),s++)}),Iu.$n(a).next(function(){return s})},$c.prototype.Dc=function(t){return Iu.resolve(this.targetCount)},$c.prototype.Pr=function(t,e){var n=this.Rc.get(e)||null;return Iu.resolve(n)},$c.prototype.wr=function(t,e,n){return this.Pc.Dr(e,n),Iu.resolve()},$c.prototype.dr=function(e,t,n){this.Pc.$r(t,n);var r=this.persistence.Ar,i=[];return r&&t.forEach(function(t){i.push(r.cc(e,t))}),Iu.$n(i)},$c.prototype.Cc=function(t,e){return this.Pc.kr(e),Iu.resolve()},$c.prototype.pr=function(t,e){var n=this.Pc.Mr(e);return Iu.resolve(n)},$c.prototype.Lr=function(t,e){return Iu.resolve(this.Pc.Lr(e))},$c),Uc=(Zc.prototype.start=function(){return Promise.resolve()},Zc.prototype.ei=function(){return this.$c=!1,Promise.resolve()},Object.defineProperty(Zc.prototype,"kc",{get:function(){return this.$c},enumerable:!1,configurable:!0}),Zc.prototype.Oc=function(){},Zc.prototype.Mc=function(){},Zc.prototype.nr=function(){return this.li},Zc.prototype.Yi=function(t){var e=this.Fc[t.Cs()];return e||(e=new Rc(this.li,this.Ar),this.Fc[t.Cs()]=e),e},Zc.prototype.tr=function(){return this.Zi},Zc.prototype.Xi=function(){return this.ai},Zc.prototype.runTransaction=function(t,e,n){var r=this;_r("MemoryPersistence","Starting transaction:",t);var i=new Mc(this.Nc.next());return this.Ar.Lc(),n(i).next(function(t){return r.Ar.qc(i).next(function(){return t})}).Fn().then(function(t){return i.Uc(),t})},Zc.prototype.Bc=function(e,n){return Iu.xn(Object.values(this.Fc).map(function(t){return function(){return t.Lr(e,n)}}))},Zc),Mc=(Jc.prototype.jc=function(t){this.Qc.push(t)},Jc.prototype.Uc=function(){this.Qc.forEach(function(t){return t()})},o(Yc,_c=Jc),Yc),jc=(Xc.zc=function(t){return new Xc(t)},Object.defineProperty(Xc.prototype,"Kc",{get:function(){if(this.Gc)return this.Gc;throw jr()},enumerable:!1,configurable:!0}),Xc.prototype.Cr=function(t,e,n){return this.Wc.Cr(n,e),this.Kc.delete(n.toString()),Iu.resolve()},Xc.prototype.Fr=function(t,e,n){return this.Wc.Fr(n,e),this.Kc.add(n.toString()),Iu.resolve()},Xc.prototype.cc=function(t,e){return this.Kc.add(e.toString()),Iu.resolve()},Xc.prototype.removeTarget=function(t,e){var n=this;this.Wc.kr(e.targetId).forEach(function(t){return n.Kc.add(t.toString())});var r=this.persistence.tr();return r.pr(t,e.targetId).next(function(t){t.forEach(function(t){return n.Kc.add(t.toString())})}).next(function(){return r.bc(t,e)})},Xc.prototype.Lc=function(){this.Gc=new Set},Xc.prototype.qc=function(n){var r=this,i=this.persistence.Xi().ur();return Iu.forEach(this.Kc,function(t){var e=Xr.C(t);return r.Hc(n,e).next(function(t){t||i.Er(e)})}).next(function(){return r.Gc=null,i.apply(n)})},Xc.prototype.Ir=function(t,e){var n=this;return this.Hc(t,e).next(function(t){t?n.Kc.delete(e.toString()):n.Kc.add(e.toString())})},Xc.prototype.xc=function(t){return 0},Xc.prototype.Hc=function(t,e){var n=this;return Iu.xn([function(){return Iu.resolve(n.Wc.Lr(e))},function(){return n.persistence.tr().Lr(t,e)},function(){return n.persistence.Bc(t,e)}])},Xc),Gc=(Kc.prototype.Io=function(t){this.Xc=t},Kc.prototype.do=function(t){this.Zc=t},Kc.prototype.onMessage=function(t){this.ta=t},Kc.prototype.close=function(){this.Jc()},Kc.prototype.send=function(t){this.Yc(t)},Kc.prototype.ea=function(){this.Xc()},Kc.prototype.na=function(t){this.Zc(t)},Kc.prototype.sa=function(t){this.ta(t)},Kc),xc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Fc=(Hc.prototype.No=function(e,t,n,r){var i=this.ua(e,t);_r("RestConnection","Sending: ",i,n);var o={};return this.ca(o,r),this.aa(e,i,o,n).then(function(t){return _r("RestConnection","Received: ",t),t},function(t){throw Ur("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Hc.prototype.$o=function(t,e,n,r){return this.No(t,e,n,r)},Hc.prototype.ca=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.21.0",t["Content-Type"]="text/plain",e)for(var n in e.Ur)e.Ur.hasOwnProperty(n)&&(t[n]=e.Ur[n])},Hc.prototype.ua=function(t,e){var n=xc[t];return this.ra+"/v1/"+e+":"+n},o(Wc,Vc=Hc),Wc.prototype.aa=function(u,e,n,r){return new Promise(function(o,s){var a=new Nr;a.listenOnce(Tr.COMPLETE,function(){try{switch(a.getLastErrorCode()){case Ir.NO_ERROR:var t=a.getResponseJson();_r("Connection","XHR received:",JSON.stringify(t)),o(t);break;case Ir.TIMEOUT:_r("Connection",'RPC "'+u+'" timed out'),s(new Or(kr.DEADLINE_EXCEEDED,"Request time out"));break;case Ir.HTTP_ERROR:var e,n,r=a.getStatus();_r("Connection",'RPC "'+u+'" failed with status:',r,"response text:",a.getResponseText()),0<r?(e=a.getResponseJson().error)&&e.status&&e.message?(i=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(kr).indexOf(i)?i:kr.UNKNOWN,s(new Or(n,e.message))):s(new Or(kr.UNKNOWN,"Server responded with status "+a.getStatus())):s(new Or(kr.UNAVAILABLE,"Connection failed."));break;default:jr()}}finally{_r("Connection",'RPC "'+u+'" completed.')}var i});var t=JSON.stringify(r);a.send(e,"POST",t,n,15)})},Wc.prototype.Ao=function(t,e){var n,r,i=[this.ra,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Er(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.B.projectId+"/databases/"+this.B.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.ca(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(v())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=v().indexOf("Electron/")||0<=(r=v()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=v().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var a=i.join("");function u(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}_r("Connection","Creating WebChannel: "+a,s);var h=o.createWebChannel(a,s),c=!1,l=!1,f=new Gc({Yc:function(t){l?_r("Connection","Not sending because WebChannel is closed:",t):(c||(_r("Connection","Opening WebChannel transport."),h.open(),c=!0),_r("Connection","WebChannel sending:",t),h.send(t))},Jc:function(){return h.close()}});return u(Ar.EventType.OPEN,function(){l||_r("Connection","WebChannel transport opened.")}),u(Ar.EventType.CLOSE,function(){l||(l=!0,_r("Connection","WebChannel transport closed"),f.na())}),u(Ar.EventType.ERROR,function(t){l||(l=!0,Ur("Connection","WebChannel transport errored:",t),f.na(new Or(kr.UNAVAILABLE,"The operation could not be completed")))}),u(Ar.EventType.MESSAGE,function(t){var e,n,r,i,o,s;l||(Gr(!!(n=t.data[0])),(r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(_r("Connection","WebChannel received error:",r),i=r.status,o=function(){var t=Xi[i];if(void 0!==t)return to(t)}(),s=r.message,void 0===o&&(o=kr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),l=!0,f.na(new Or(o,s)),h.close()):(_r("Connection","WebChannel received:",n),f.sa(n)))}),setTimeout(function(){f.ea()},0),f},Wc),qc=(zc.prototype.Jo=function(t){this.da.push(t)},zc.prototype.ei=function(){window.removeEventListener("online",this.ha),window.removeEventListener("offline",this._a)},zc.prototype.wa=function(){window.addEventListener("online",this.ha),window.addEventListener("offline",this._a)},zc.prototype.la=function(){_r("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.da;t<e.length;t++)(0,e[t])(0)},zc.prototype.fa=function(){_r("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.da;t<e.length;t++)(0,e[t])(1)},zc.ma=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},zc),Bc=(Qc.prototype.Jo=function(t){},Qc.prototype.ei=function(){},Qc);function Qc(){}function zc(){var t=this;this.ha=function(){return t.la()},this._a=function(){return t.fa()},this.da=[],this.wa()}function Wc(t){var e=this;return(e=Vc.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function Hc(t){this.ia=t,this.B=t.B;var e=t.ssl?"https":"http";this.ra=e+"://"+t.host,this.oa="projects/"+this.B.projectId+"/databases/"+this.B.database+"/documents"}function Kc(t){this.Yc=t.Yc,this.Jc=t.Jc}function Xc(t){this.persistence=t,this.Wc=new bh,this.Gc=null}function Yc(t){var e=this;return(e=_c.call(this)||this).mr=t,e}function Jc(){this.Qc=[]}function Zc(t){var e=this;this.Fc={},this.Nc=new Fu(0),this.$c=!1,this.$c=!0,this.Ar=t(this),this.Zi=new Cc(this),this.li=new rh,this.ai=new Sc(this.li,function(t){return e.Ar.xc(t)})}function $c(t){this.persistence=t,this.Rc=new Vi(zi,Wi),this.lastRemoteSnapshotVersion=Ci.min(),this.highestTargetId=0,this.yc=0,this.Pc=new bh,this.targetCount=0,this.gc=oh.ji()}function tl(t){return new is(t,!0)}var el,nl,rl="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",il=(yl.prototype.initialize=function(e){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return this.Vu=this.Ta(e),this.persistence=this.Ea(e),[4,this.persistence.start()];case 1:return t.sent(),this.Ia=this.Aa(e),this.Qo=this.Ra(e),[2]}})})},yl.prototype.Aa=function(t){return null},yl.prototype.Ra=function(t){return e=this.persistence,n=new Nc,r=t.ya,new sh(e,n,r);var e,n,r},yl.prototype.Ea=function(t){if(t.persistenceSettings.Pa)throw new Or(kr.FAILED_PRECONDITION,rl);return new Uc(jc.zc)},yl.prototype.Ta=function(t){return new Qu},yl.prototype.terminate=function(){return w(this,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return this.Ia&&this.Ia.stop(),[4,this.Vu.ei()];case 1:return t.sent(),[4,this.persistence.ei()];case 2:return t.sent(),[2]}})})},yl.prototype.clearPersistence=function(t,e){throw new Or(kr.FAILED_PRECONDITION,rl)},yl),ol=(vl.prototype.initialize=function(n,r){return w(this,void 0,void 0,function(){var e=this;return b(this,function(t){switch(t.label){case 0:return this.Qo?[3,2]:(this.Qo=n.Qo,this.Vu=n.Vu,this.jo=this.pa(r),this.pu=this.ga(r),this.gu=this.Va(r),this.va=this.ba(r),this.Vu.Qs=function(t){return yc(e.va,t,1)},this.pu.Wo.Sa=function(i,o){return w(this,void 0,void 0,function(){var n,r;return b(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(_r("SyncEngine","User change. New user:",o.Cs()),[4,function(i,o){return w(this,void 0,void 0,function(){var e,n,m,r;return b(this,function(t){switch(t.label){case 0:return n=(e=i).hi,m=e.er,[4,e.persistence.runTransaction("Handle user change","readonly",function(y){var g;return e.hi.Ku(y).next(function(t){return g=t,n=e.persistence.Yi(o),m=new Hu(e.Ji,n,e.persistence.nr()),n.Ku(y)}).next(function(t){for(var e=[],n=[],r=go(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var a=0,u=s.mutations;a<u.length;a++)var h=u[a],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var v=d[p];r=r.add(v.key)}}return m.Ti(y,r).next(function(t){return{Hu:t,Yu:e,Ju:n}})})})];case 1:return r=t.sent(),[2,(e.hi=n,e.er=m,e.Gi.sr(e.er),r)]}})})}(n.Qo,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).ku.forEach(function(t){t.forEach(function(t){t.reject(new Or(kr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.ku.clear(),n.Vu.Zs(o,r.Yu,r.Ju),[4,Tc(n,r.Hu)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this.va),[4,function(n,r){return w(this,void 0,void 0,function(){var e;return b(this,function(t){switch(t.label){case 0:return e=n,r?(e.Ko.delete(2),[4,qh(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Ko.add(2),[4,Bh(e)]);case 3:t.sent(),e.Xo.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.pu,this.va.Lu)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},vl.prototype.Va=function(t){return new Vu},vl.prototype.pa=function(t){var e,n=tl(t.ia.B),r=(e=t.ia,new Fc(e)),i=t.credentials;return new kh(i,r,n)},vl.prototype.ga=function(t){var e=this;return new yh(this.Qo,this.jo,t.kn,function(t){return yc(e.va,t,0)},new(qc.ma()?qc:Bc))},vl.prototype.ba=function(t){return e=this.Qo,n=this.pu,r=this.gu,i=this.Vu,o=t.ya,s=t.vu,a=!t.persistenceSettings.Pa||!t.persistenceSettings.synchronizeTabs,u=new lc(e,n,r,i,o,s),a&&(u.Mu=!0),u;var e,n,r,i,o,s,a,u},vl.prototype.terminate=function(){return Qh(this.pu)},vl),sl=(dl.prototype.next=function(t){this.observer.next&&this.Ca(this.observer.next,t)},dl.prototype.error=function(t){this.observer.error?this.Ca(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},dl.prototype.Da=function(){this.muted=!0},dl.prototype.Ca=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},dl),al=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Or(kr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(ii("FieldPath","string",e,t[e]),0===t[e].length)throw new Or(kr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Fa=new Kr(t)},ul=(o(pl,nl=al),pl.documentId=function(){return new pl(Kr.v().R())},pl.prototype.isEqual=function(t){if(!(t instanceof pl))throw vi("isEqual","FieldPath",1,t);return this.Fa.isEqual(t.Fa)},pl),hl=new RegExp("[~\\*/\\[\\]]"),cl=function(){this.Na=this},ll=(o(fl,el=cl),fl.prototype.xa=function(t){if(2!==t.ka)throw 1===t.ka?t.Oa(this.$a+"() can only appear at the top level of your update data"):t.Oa(this.$a+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},fl.prototype.isEqual=function(t){return t instanceof fl},fl);function fl(t){var e=this;return(e=el.call(this)||this).$a=t,e}function pl(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return nl.call(this,t)||this}function dl(t){this.observer=t,this.muted=!1}function vl(){}function yl(){}function gl(t,e,n){return new zl({ka:3,Ma:e.settings.Ma,methodName:t.$a,La:n},e.B,e.serializer,e.ignoreUndefinedProperties)}var ml,wl,bl,El,Il,Tl,Al=(o(Bl,Tl=cl),Bl.prototype.xa=function(t){return new Gs(t.path,new Ns)},Bl.prototype.isEqual=function(t){return t instanceof Bl},Bl),Nl=(o(ql,Il=cl),ql.prototype.xa=function(t){var e=gl(this,t,!0),n=this.qa.map(function(t){return $l(t,e)}),r=new Rs(n);return new Gs(t.path,r)},ql.prototype.isEqual=function(t){return this===t},ql),Rl=(o(Fl,El=cl),Fl.prototype.xa=function(t){var e=gl(this,t,!0),n=this.qa.map(function(t){return $l(t,e)}),r=new Ds(n);return new Gs(t.path,r)},Fl.prototype.isEqual=function(t){return this===t},Fl),Sl=(o(xl,bl=cl),xl.prototype.xa=function(t){var e=new Cs(t.serializer,as(t.serializer,this.Ua));return new Gs(t.path,e)},xl.prototype.isEqual=function(t){return this===t},xl),Ll=(o(Gl,wl=cl),Gl.delete=function(){return ti("FieldValue.delete",arguments),new kl(new ll("FieldValue.delete"))},Gl.serverTimestamp=function(){return ti("FieldValue.serverTimestamp",arguments),new kl(new Al("FieldValue.serverTimestamp"))},Gl.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ni("FieldValue.arrayUnion",arguments,1),new kl(new Nl("FieldValue.arrayUnion",t))},Gl.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ni("FieldValue.arrayRemove",arguments,1),new kl(new Rl("FieldValue.arrayRemove",t))},Gl.increment=function(t){return ii("FieldValue.increment","number",1,t),ei("FieldValue.increment",arguments,1),new kl(new Sl("FieldValue.increment",t))},Gl),kl=(o(jl,ml=Ll),jl.prototype.xa=function(t){return this.Na.xa(t)},jl.prototype.isEqual=function(t){return t instanceof jl&&this.Na.isEqual(t.Na)},jl),Ol=(Object.defineProperty(Ml.prototype,"latitude",{get:function(){return this.Ba},enumerable:!1,configurable:!0}),Object.defineProperty(Ml.prototype,"longitude",{get:function(){return this.Qa},enumerable:!1,configurable:!0}),Ml.prototype.isEqual=function(t){return this.Ba===t.Ba&&this.Qa===t.Qa},Ml.prototype.toJSON=function(){return{latitude:this.Ba,longitude:this.Qa}},Ml.prototype.H=function(t){return Ei(this.Ba,t.Ba)||Ei(this.Qa,t.Qa)},Ml),Dl=/^__.*__$/,Pl=function(t,e,n){this.ja=t,this.Wa=e,this.Ga=n},Vl=(Ul.prototype.za=function(t,e){var n=[];return null!==this.Qe?n.push(new $s(t,this.data,this.Qe,e)):n.push(new Zs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new ia(t,this.fieldTransforms)),n},Ul),_l=(Cl.prototype.za=function(t,e){var n=[new $s(t,this.data,this.Qe,e)];return 0<this.fieldTransforms.length&&n.push(new ia(t,this.fieldTransforms)),n},Cl);function Cl(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function Ul(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function Ml(t,e){if(ei("GeoPoint",arguments,2),ii("GeoPoint","number",1,t),ii("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Or(kr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Or(kr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Ba=t,this.Qa=e}function jl(t){var e=this;return(e=ml.call(this)||this).Na=t,e.$a=t.$a,e}function Gl(){return wl.call(this)||this}function xl(t,e){var n=this;return(n=bl.call(this)||this).$a=t,n.Ua=e,n}function Fl(t,e){var n=this;return(n=El.call(this)||this).$a=t,n.qa=e,n}function ql(t,e){var n=this;return(n=Il.call(this)||this).$a=t,n.qa=e,n}function Bl(t){var e=this;return(e=Tl.call(this)||this).$a=t,e}function Ql(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw jr()}}var zl=(Object.defineProperty(Kl.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Kl.prototype,"ka",{get:function(){return this.settings.ka},enumerable:!1,configurable:!0}),Kl.prototype.Ha=function(t){return new Kl(Object.assign(Object.assign({},this.settings),t),this.B,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},Kl.prototype.Ya=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Ha({path:n,La:!1});return r.Ja(t),r},Kl.prototype.Xa=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Ha({path:n,La:!1});return r.Ka(),r},Kl.prototype.Za=function(t){return this.Ha({path:void 0,La:!0})},Kl.prototype.Oa=function(t){return sf(t,this.settings.methodName,this.settings.th||!1,this.path,this.settings.Ma)},Kl.prototype.contains=function(e){return void 0!==this.Qe.find(function(t){return e.T(t)})||void 0!==this.fieldTransforms.find(function(t){return e.T(t.field)})},Kl.prototype.Ka=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Ja(this.path.get(t))},Kl.prototype.Ja=function(t){if(0===t.length)throw this.Oa("Document fields must not be empty");if(Ql(this.ka)&&Dl.test(t))throw this.Oa('Document fields cannot begin and end with "__"')},Kl),Wl=(Hl.prototype.eh=function(t,e,n,r){return void 0===r&&(r=!1),new zl({ka:t,methodName:e,Ma:n,path:Kr.p(),La:!1,th:r},this.B,this.serializer,this.ignoreUndefinedProperties)},Hl);function Hl(t,e,n){this.B=t,this.ignoreUndefinedProperties=e,this.serializer=n||tl(t)}function Kl(t,e,n,r,i,o){this.settings=t,this.B=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Ka(),this.fieldTransforms=i||[],this.Qe=o||[]}function Xl(t,e,n,r,i,o){void 0===o&&(o={});var s=t.eh(o.merge||o.mergeFields?2:0,e,n,i);nf("Data must be an object, but it was:",s,r);var a,u,h=tf(r,s);if(o.merge)a=new xs(s.Qe),u=s.fieldTransforms;else if(o.mergeFields){for(var c=[],l=0,f=o.mergeFields;l<f.length;l++){var p=f[l],d=void 0;if(p instanceof al)d=p.Fa;else{if("string"!=typeof p)throw jr();d=of(e,p,n)}if(!s.contains(d))throw new Or(kr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");af(c,d)||c.push(d)}a=new xs(c),u=s.fieldTransforms.filter(function(t){return a.Ke(t.field)})}else a=null,u=s.fieldTransforms;return new Vl(new la(h),a,u)}function Yl(t,o,s,e){var a=t.eh(1,o,s);nf("Data must be an object, but it was:",a,e);var u=[],h=new fa;Fr(e,function(t,e){var n,r=of(o,t,s),i=a.Xa(r);e instanceof cl&&e.Na instanceof ll?u.push(r):null!=(n=$l(e,i))&&(u.push(r),h.set(r,n))});var n=new xs(u);return new _l(h.Je(),n,a.fieldTransforms)}function Jl(t,e,n,r,i,o){var s=t.eh(1,e,n),a=[rf(e,r,n)],u=[i];if(o.length%2!=0)throw new Or(kr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)a.push(rf(e,o[h])),u.push(o[h+1]);for(var c,l,f,p,d=[],v=new fa,y=a.length-1;0<=y;--y)af(d,a[y])||(c=a[y],l=u[y],f=s.Xa(c),l instanceof cl&&l.Na instanceof ll?d.push(c):null!=(p=$l(l,f))&&(d.push(c),v.set(c,p)));var g=new xs(d);return new _l(v.Je(),g,s.fieldTransforms)}function Zl(t,e,n,r){return void 0===r&&(r=!1),$l(n,t.eh(r?4:3,e))}function $l(s,t){if(ef(s))return nf("Unsupported field value:",t,s),tf(s,t);if(s instanceof cl)return function(t,e){if(!Ql(e.ka))throw e.Oa(t.$a+"() can only be used with update() and set()");if(!e.path)throw e.Oa(t.$a+"() is not currently supported inside arrays");var n=t.xa(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Qe.push(t.path),s instanceof Array){if(t.settings.La&&4!==t.ka)throw t.Oa("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=$l(i[r],t.Za(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return as(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=_i.fromDate(t);return{timestampValue:us(e.serializer,n)}}if(t instanceof _i){var r=new _i(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:us(e.serializer,r)}}if(t instanceof Ol)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Ni)return{bytesValue:hs(e.serializer,t.U)};if(t instanceof Pl){var i=e.B,o=t.ja;if(!o.isEqual(i))throw e.Oa("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:ls(t.ja||e.B,t.Wa.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Oa("Unsupported field value: "+fi(t))}(s,t)}function tf(t,r){var i={};return qr(t)?r.path&&0<r.path.length&&r.Qe.push(r.path):Fr(t,function(t,e){var n=$l(e,r.Ya(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function ef(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof _i||t instanceof Ol||t instanceof Ni||t instanceof Pl||t instanceof cl)}function nf(t,e,n){if(!ef(n)||!li(n)){var r=fi(n);throw"an object"===r?e.Oa(t+" a custom object"):e.Oa(t+" "+r)}}function rf(t,e,n){if(e instanceof al)return e.Fa;if("string"==typeof e)return of(t,e);throw sf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function of(t,e,n){try{return function(e){if(0<=e.search(hl))throw new Or(kr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(ul.bind.apply(ul,s([void 0],e.split("."))))}catch(t){throw new Or(kr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Fa}catch(e){throw sf(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function sf(t,e,n,r,i){var o=r&&!r.m(),s=void 0!==i,a="Function "+e+"() called with invalid data";n&&(a+=" (via `toFirestore()`)");var u="";return(o||s)&&(u+=" (found",o&&(u+=" in field "+r),s&&(u+=" in document "+i),u+=")"),new Or(kr.INVALID_ARGUMENT,(a+=". ")+t+u)}function af(t,e){return t.some(function(t){return t.isEqual(e)})}var uf=(pf.prototype.oh=function(r){return w(this,void 0,void 0,function(){var e,n=this;return b(this,function(t){switch(t.label){case 0:if(this.uh(),0<this.mutations.length)throw new Or(kr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(a,u){return w(this,void 0,void 0,function(){var i,e,n,r,o,s;return b(this,function(t){switch(t.label){case 0:return e=vs((i=a).serializer)+"/documents",n={documents:u.map(function(t){return fs(i.serializer,t)})},[4,i.$o("BatchGetDocuments",e,n)];case 1:return r=t.sent(),o=new Map,r.forEach(function(t){var e,n,r=(e=i.serializer,"found"in(n=t)?function(t,e){Gr(!!e.found),e.found.name,e.found.updateTime;var n=ps(t,e.found.name),r=cs(e.found.updateTime),i=new la({mapValue:{fields:e.found.fields}});return new Ea(n,r,i,{})}(e,n):"missing"in n?function(t,e){Gr(!!e.missing),Gr(!!e.readTime);var n=ps(t,e.missing),r=cs(e.readTime);return new Ia(n,r)}(e,n):jr());o.set(r.key.toString(),r)}),s=[],[2,(u.forEach(function(t){var e=o.get(t.toString());Gr(!!e),s.push(e)}),s)]}})})}(this.jo,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Ia||t instanceof Ea?n.ah(t):jr()}),e)]}})})},pf.prototype.set=function(t,e){this.write(e.za(t,this.Ge(t))),this.rh.add(t.toString())},pf.prototype.update=function(t,e){try{this.write(e.za(t,this.hh(t)))}catch(t){this.ih=t}this.rh.add(t.toString())},pf.prototype.delete=function(t){this.write([new ha(t,this.Ge(t))]),this.rh.add(t.toString())},pf.prototype.commit=function(){return w(this,void 0,void 0,function(){var e,r=this;return b(this,function(t){switch(t.label){case 0:if(this.uh(),this.ih)throw this.ih;return e=this.nh,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=Xr.C(e);r.mutations.push(new ca(n,r.Ge(n)))}),[4,function(i,o){return w(this,void 0,void 0,function(){var e,n,r;return b(this,function(t){switch(t.label){case 0:return n=vs((e=i).serializer)+"/documents",r={writes:o.map(function(t){return gs(e.serializer,t)})},[4,e.No("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.jo,this.mutations)];case 1:return t.sent(),this.sh=!0,[2]}})})},pf.prototype.ah=function(t){var e;if(t instanceof Ea)e=t.version;else{if(!(t instanceof Ia))throw jr();e=Ci.min()}var n=this.nh.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Or(kr.ABORTED,"Document version changed between two reads.")}else this.nh.set(t.key.toString(),e)},pf.prototype.Ge=function(t){var e=this.nh.get(t.toString());return!this.rh.has(t.toString())&&e?Bs.updateTime(e):Bs.He()},pf.prototype.hh=function(t){var e=this.nh.get(t.toString());if(this.rh.has(t.toString())||!e)return Bs.exists(!0);if(e.isEqual(Ci.min()))throw new Or(kr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Bs.updateTime(e)},pf.prototype.write=function(t){this.uh(),this.mutations=this.mutations.concat(t)},pf.prototype.uh=function(){},pf),hf=(ff.prototype.run=function(){this._h()},ff.prototype._h=function(){var t=this;this.Jn.Rn(function(){return w(t,void 0,void 0,function(){var e,n,r=this;return b(this,function(t){return e=new uf(this.jo),(n=this.fh(e))&&n.then(function(t){r.kn.Qn(function(){return e.commit().then(function(){r.Ln.resolve(t)}).catch(function(t){r.dh(t)})})}).catch(function(t){r.dh(t)}),[2]})})})},ff.prototype.fh=function(t){try{var e=this.updateFunction(t);return!Fi(e)&&e.catch&&e.then?e:(this.Ln.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ln.reject(t),null}},ff.prototype.dh=function(t){var e=this;0<this.lh&&this.wh(t)?(--this.lh,this.kn.Qn(function(){return e._h(),Promise.resolve()})):this.Ln.reject(t)},ff.prototype.wh=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!$i(e)},ff),cf=(lf.prototype.start=function(t,e,n,r){var i=this;this.Th(),this.ia=t;var o=new bu,s=!1;return this.credentials.jr(function(t){return s?void i.kn.rs(function(){return function(r,i){return w(this,void 0,void 0,function(){var e,n;return b(this,function(t){switch(t.label){case 0:return(e=r).kn.cs(),_r("RemoteStore","RemoteStore received new credentials"),n=Jh(e),e.Ko.add(3),[4,Bh(e)];case 1:return t.sent(),n&&e.Xo.set("Unknown"),[4,e.Wo.Sa(i)];case 2:return t.sent(),e.Ko.delete(3),[4,qh(e)];case 3:return t.sent(),[2]}})})}(i.pu,t)}):(s=!0,_r("FirestoreClient","Initializing. user=",t.uid),i.Eh(e,n,r,t,o).then(i.mh.resolve,i.mh.reject))}),this.kn.Qn(function(){return i.mh.promise}),o.promise},lf.prototype.enableNetwork=function(){var e=this;return this.Th(),this.kn.enqueue(function(){return e.persistence.Mc(!0),(t=e.pu).Ko.delete(0),qh(t);var t})},lf.prototype.Eh=function(i,o,s,a,u){return w(this,void 0,void 0,function(){var e,n,r=this;return b(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={kn:this.kn,ia:this.ia,clientId:this.clientId,credentials:this.credentials,ya:a,vu:100,persistenceSettings:s},[4,i.initialize(e)];case 1:return t.sent(),[4,o.initialize(i,e)];case 2:return t.sent(),this.persistence=i.persistence,this.Vu=i.Vu,this.Qo=i.Qo,this.Ia=i.Ia,this.jo=o.jo,this.pu=o.pu,this.va=o.va,this.Ih=o.gu,this.Ih.Es=function(l,f){return w(this,void 0,void 0,function(){var o,s,a,u,h,c;return b(this,function(t){switch(t.label){case 0:return(n=l).pu.Wo.eu=vc.bind(null,n),n.pu.Wo.qe=function(t,e){var n=t,r=n.Nu.get(e);if(r&&r.Pu)return go().add(r.key);var i=go(),o=n.Cu.get(e);if(!o)return i;for(var s=0,a=o;s<a.length;s++)var u=a[s],h=n.Su.get(u),i=i.xt(h.view.lu);return i}.bind(null,n),n.pu.Wo.tu=function(a,u,h){return w(this,void 0,void 0,function(){var e,n,r,i,o,s;return b(this,function(t){switch(t.label){case 0:return(e=a).Vu.zs(u,"rejected",h),n=e.Nu.get(u),(r=n&&n.key)?(i=(i=new eo(Xr.i)).rt(r,new Ia(r,Ci.min())),o=go().add(r),s=new Io(Ci.min(),new Map,new uo(Ei),i,o),[4,vc(e,s)]):[3,2];case 1:return t.sent(),e.Fu=e.Fu.remove(r),e.Nu.delete(u),Ic(e),[3,4];case 2:return[4,fh(e.Qo,u,!1).then(function(){return wc(e,u,h)}).catch(dh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,n),n.bu.Ro=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],a=s.query,u=n.ws.get(a);if(u){for(var h=0,c=u.listeners;h<c.length;h++)c[h].As(s)&&(r=!0);u.ds=s}}r&&Uu(n)}.bind(null,n.gu),n.bu.qu=function(t,e,n){var r=t,i=r.ws.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.ws.delete(e)}.bind(null,n.gu),(u=(o=n).Su.get(f))?(s=u.targetId,o.Vu.Gs(s),a=u.view.yu(),[3,4]):[3,1];case 1:return[4,(e=o.Qo,r=Ca(f),(i=e).persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Zi.Pr(e,r).next(function(t){return t?(n=t,Iu.resolve(n)):i.Zi.Uu(e).next(function(t){return n=new Ji(r,t,0,e.mr),i.Zi.Bu(e,n).next(function(){return n})})})}).then(function(t){var e=i.zi.get(t.targetId);return(null===e||0<t.et.L(e.et))&&(i.zi=i.zi.rt(t.targetId,t),i.Ki.set(r,t.targetId)),t}))];case 2:return h=t.sent(),c=o.Vu.Gs(h.targetId),s=h.targetId,[4,function(a,u,h,c){return w(this,void 0,void 0,function(){var e,n,r,i,o,s;return b(this,function(t){switch(t.label){case 0:return a.Qu=function(t,e,n){return function(i,o,s,a){return w(this,void 0,void 0,function(){var n,e,r;return b(this,function(t){switch(t.label){case 0:return(n=o.view._u(s)).wu?[4,ph(i.Qo,o.query,!1).then(function(t){var e=t.documents;return o.view._u(e,n)})]:[3,2];case 1:n=t.sent(),t.label=2;case 2:return e=a&&a.zt.get(o.targetId),r=o.view.mu(n,i.Lu,e),[2,(Ec(i,o.targetId,r.Iu),r.snapshot)]}})})}(a,t,e,n)},[4,ph(a.Qo,u,!0)];case 1:return e=t.sent(),n=new hc(u,e.gr),r=n._u(e.documents),i=To.Xt(h,c&&"Offline"!==a.onlineState),o=n.mu(r,a.Lu,i),Ec(a,h,o.Iu),s=new sc(u,h,n),a.Su.set(u,s),a.Cu.has(h)?a.Cu.get(h).push(u):a.Cu.set(h,[u]),[2,o.snapshot]}})})}(o,f,s,"current"===c)];case 3:a=t.sent(),o.Lu&&zh(o.pu,h),t.label=4;case 4:return[2,a]}var e,r,i,n})})}.bind(null,this.va),this.Ih.Rs=function(i,o){return w(this,void 0,void 0,function(){var e,n,r;return b(this,function(t){switch(t.label){case 0:return n=(e=i).Su.get(o),1<(r=e.Cu.get(n.targetId)).length?[2,(e.Cu.set(n.targetId,r.filter(function(t){return!Ga(t,o)})),void e.Su.delete(o))]:e.Lu?(e.Vu.Ks(n.targetId),e.Vu.Xs(n.targetId)?[3,2]:[4,fh(e.Qo,n.targetId,!1).then(function(){e.Vu.Ys(n.targetId),Wh(e.pu,n.targetId),wc(e,n.targetId)}).catch(dh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return wc(e,n.targetId),[4,fh(e.Qo,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,this.va),this.persistence.Oc(function(){return w(r,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),u.resolve(),[3,4];case 3:if(n=t.sent(),u.reject(n),!this.Ah(n))throw n;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+n),this.Eh(new il,new ol,{Pa:!1},a,u))];case 4:return[2]}})})},lf.prototype.Ah=function(t){return"FirebaseError"===t.name?t.code===kr.FAILED_PRECONDITION||t.code===kr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},lf.prototype.Th=function(){if(this.kn.Zn)throw new Or(kr.FAILED_PRECONDITION,"The client has already been terminated.")},lf.prototype.disableNetwork=function(){var t=this;return this.Th(),this.kn.enqueue(function(){return t.persistence.Mc(!1),function(n){return w(this,void 0,void 0,function(){var e;return b(this,function(t){switch(t.label){case 0:return(e=n).Ko.add(0),[4,Bh(e)];case 1:return t.sent(),e.Xo.set("Offline"),[2]}})})}(t.pu)})},lf.prototype.terminate=function(){var t=this;this.kn.ss();var r=new bu;return this.kn.ts(function(){return w(t,void 0,void 0,function(){var e,n;return b(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.Ia&&this.Ia.stop(),[4,Qh(this.pu)];case 1:return t.sent(),[4,this.Vu.ei()];case 2:return t.sent(),[4,this.persistence.ei()];case 3:return t.sent(),this.credentials.Wr(),r.resolve(),[3,5];case 4:return e=t.sent(),n=Du(e,"Failed to shutdown persistence"),r.reject(n),[3,5];case 5:return[2]}})})}),r.promise},lf.prototype.waitForPendingWrites=function(){var t=this;this.Th();var e=new bu;return this.kn.Qn(function(){return function(a,u){return w(this,void 0,void 0,function(){var n,r,i,o,s;return b(this,function(t){switch(t.label){case 0:Jh((n=a).pu)||_r("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Qo).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.hi.zu(t)})];case 2:return-1===(r=t.sent())?[2,void u.resolve()]:((i=n.ku.get(r)||[]).push(u),n.ku.set(r,i),[3,4]);case 3:return o=t.sent(),s=Du(o,"Initialization of waitForPendingWrites() operation failed"),u.reject(s),[3,4];case 4:return[2]}var e})})}(t.va,e)}),e.promise},lf.prototype.listen=function(t,e,n){var r=this;this.Th();var i=new sl(n),o=new Mu(t,i,e);return this.kn.Qn(function(){return _u(r.Ih,o)}),function(){i.Da(),r.kn.Qn(function(){return Cu(r.Ih,o)})}},lf.prototype.Rh=function(r){return w(this,void 0,void 0,function(){var e,n=this;return b(this,function(t){switch(t.label){case 0:return this.Th(),[4,this.mh.promise];case 1:return t.sent(),e=new bu,[2,(this.kn.Qn(function(){return function(s,a,u){return w(this,void 0,void 0,function(){var r,i,o;return b(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=a,(n=s).persistence.runTransaction("read document","readonly",function(t){return n.er._i(t,e)}))];case 1:return(r=t.sent())instanceof Ea?u.resolve(r):r instanceof Ia?u.resolve(null):u.reject(new Or(kr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return i=t.sent(),o=Du(i,"Failed to get document '"+a+" from cache"),u.reject(o),[3,3];case 3:return[2]}var e,n})})}(n.Qo,r,e)}),e.promise)]}})})},lf.prototype.yh=function(h,c){return void 0===c&&(c={}),w(this,void 0,void 0,function(){var e,u=this;return b(this,function(t){switch(t.label){case 0:return this.Th(),[4,this.mh.promise];case 1:return t.sent(),e=new bu,[2,(this.kn.Qn(function(){return n=u.Ih,r=u.kn,i=h,o=c,s=e,t=new sl({next:function(t){r.Qn(function(){return Cu(n,a)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Or(kr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Or(kr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),a=new Mu(La(i.path),t,{includeMetadataChanges:!0,bs:!0}),_u(n,a);var n,r,i,o,s,t,a}),e.promise)]}})})},lf.prototype.Ph=function(r){return w(this,void 0,void 0,function(){var e,n=this;return b(this,function(t){switch(t.label){case 0:return this.Th(),[4,this.mh.promise];case 1:return t.sent(),e=new bu,[2,(this.kn.Qn(function(){return function(a,u,h){return w(this,void 0,void 0,function(){var e,n,r,i,o,s;return b(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,ph(a,u,!0)];case 1:return e=t.sent(),n=new hc(u,e.gr),r=n._u(e.documents),i=n.mu(r,!1),h.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=Du(o,"Failed to execute query '"+u+" against cache"),h.reject(s),[3,3];case 3:return[2]}})})}(n.Qo,r,e)}),e.promise)]}})})},lf.prototype.ph=function(h,c){return void 0===c&&(c={}),w(this,void 0,void 0,function(){var a,u=this;return b(this,function(t){switch(t.label){case 0:return this.Th(),[4,this.mh.promise];case 1:return t.sent(),a=new bu,[2,(this.kn.Qn(function(){return e=u.Ih,n=u.kn,t=h,r=c,i=a,o=new sl({next:function(t){n.Qn(function(){return Cu(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Or(kr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Mu(t,o,{includeMetadataChanges:!0,bs:!0}),_u(e,s);var e,n,t,r,i,o,s}),a.promise)]}})})},lf.prototype.write=function(t){var e=this;this.Th();var n=new bu;return this.kn.Qn(function(){return dc(e.va,t,n)}),n.promise},lf.prototype.B=function(){return this.ia.B},lf.prototype.gh=function(t){var e=this;this.Th();var r=new sl(t);return this.kn.Qn(function(){return w(e,void 0,void 0,function(){return b(this,function(t){return[2,(e=this.Ih,n=r,e.Ts.add(n),void n.next())];var e,n})})}),function(){r.Da(),e.kn.Qn(function(){return w(e,void 0,void 0,function(){return b(this,function(t){return[2,void this.Ih.Ts.delete(r)]})})})}},Object.defineProperty(lf.prototype,"Vh",{get:function(){return this.kn.Zn},enumerable:!1,configurable:!0}),lf.prototype.transaction=function(t){var e=this;this.Th();var n=new bu;return this.kn.Qn(function(){return new hf(e.kn,e.jo,t,n).run(),Promise.resolve()}),n.promise},lf);function lf(t,e){this.credentials=t,this.kn=e,this.clientId=wi.k(),this.mh=new bu}function ff(t,e,n,r){this.kn=t,this.jo=e,this.updateFunction=n,this.Ln=r,this.lh=5,this.Jn=new Eu(this.kn,"transaction_retry")}function pf(t){this.jo=t,this.nh=new Map,this.mutations=[],this.sh=!1,this.ih=null,this.rh=new Set}function df(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var vf,yf,gf=(Cf.prototype.Dh=function(t){switch(Fo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ko(t.integerValue||t.doubleValue);case 3:return this.Fh(t.timestampValue);case 4:return this.Nh(t);case 5:return t.stringValue;case 6:return this.Ch(Xo(t.bytesValue));case 7:return this.$h(t.referenceValue);case 8:return this.xh(t.geoPointValue);case 9:return this.kh(t.arrayValue);case 10:return this.Oh(t.mapValue);default:throw jr()}},Cf.prototype.Oh=function(t){var n=this,r={};return Fr(t.fields||{},function(t,e){r[t]=n.Dh(e)}),r},Cf.prototype.xh=function(t){return new Ol(Ko(t.latitude),Ko(t.longitude))},Cf.prototype.kh=function(t){var e=this;return(t.values||[]).map(function(t){return e.Dh(t)})},Cf.prototype.Nh=function(t){switch(this.bh){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return jo(n)?t(n):n}(t);return null==e?null:this.Dh(e);case"estimate":return this.Fh(Go(t));default:return null}},Cf.prototype.Fh=function(t){var e=Ho(t),n=new _i(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},Cf.prototype.$h=function(t){var e=Wr.P(t);Gr(bs(e));var n=new Pi(e.get(1),e.get(3)),r=new Xr(e.u(5));return n.isEqual(this.B)||Cr("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.B.projectId+"/"+this.B.database+") instead."),this.Sh(r)},Cf),mf=Xu.ki,wf=(_f.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},_f),bf=(Object.defineProperty(Vf.prototype,"Kh",{get:function(){return this.Hh||(this.Hh=new Wl(this.ja,this.zh.ignoreUndefinedProperties)),this.Hh},enumerable:!1,configurable:!0}),Vf.prototype.settings=function(t){ei("Firestore.settings",arguments,1),ii("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.zh),t)).merge;var e=new wf(t);if(this.Qh&&!this.zh.isEqual(e))throw new Or(kr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.zh=e).credentials&&(this.Gh=function(t){if(!t)return new Ih;switch(t.type){case"gapi":var e=t.Yh;return Gr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Nh(e,t.Jr||"0");case"provider":return t.Yh;default:throw new Or(kr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},Vf.prototype.enableNetwork=function(){return this.Bh(),this.Qh.enableNetwork()},Vf.prototype.disableNetwork=function(){return this.Bh(),this.Qh.disableNetwork()},Vf.prototype.enablePersistence=function(t){var e,n;if(this.Qh)throw new Or(kr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Cr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new Or(kr.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Jh(this.Mh,this.Lh,{Pa:!0,cacheSizeBytes:this.zh.cacheSizeBytes,synchronizeTabs:r,Xh:i})},Vf.prototype.clearPersistence=function(){return w(this,void 0,void 0,function(){var n,e=this;return b(this,function(t){if(void 0!==this.Qh&&!this.Qh.Vh)throw new Or(kr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new bu,[2,(this.Uh.ts(function(){return w(e,void 0,void 0,function(){var e;return b(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Mh.clearPersistence(this.ja,this.Wh)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},Vf.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Vf.prototype,"Zh",{get:function(){return this.Bh(),this.Qh.Vh},enumerable:!1,configurable:!0}),Vf.prototype.waitForPendingWrites=function(){return this.Bh(),this.Qh.waitForPendingWrites()},Vf.prototype.onSnapshotsInSync=function(t){if(this.Bh(),df(t))return this.Qh.gh(t);ii("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.Qh.gh(e)},Vf.prototype.Bh=function(){return this.Qh||this.Jh(new il,new ol,{Pa:!1}),this.Qh},Vf.prototype.tl=function(){return new ki(this.ja,this.Wh,this.zh.host,this.zh.ssl,this.zh.experimentalForceLongPolling)},Vf.prototype.Jh=function(t,e,n){var r=this.tl();return this.Qh=new cf(this.Gh,this.Uh),this.Qh.start(r,t,e,n)},Vf.jh=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Or(kr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Or(kr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Pi(n)},Object.defineProperty(Vf.prototype,"app",{get:function(){if(!this.qh)throw new Or(kr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.qh},enumerable:!1,configurable:!0}),Vf.prototype.collection=function(t){return ei("Firestore.collection",arguments,1),ii("Firestore.collection","non-empty string",1,t),this.Bh(),new Bf(Wr.P(t),this,null)},Vf.prototype.doc=function(t){return ei("Firestore.doc",arguments,1),ii("Firestore.doc","non-empty string",1,t),this.Bh(),Tf.el(Wr.P(t),this,null)},Vf.prototype.collectionGroup=function(t){if(ei("Firestore.collectionGroup",arguments,1),ii("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Or(kr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.Bh(),new Ff((e=t,new Aa(Wr.p(),e)),this,null);var e},Vf.prototype.runTransaction=function(e){var n=this;return ei("Firestore.runTransaction",arguments,1),ii("Firestore.runTransaction","function",1,e),this.Bh().transaction(function(t){return e(new Ef(n,t))})},Vf.prototype.batch=function(){return this.Bh(),new If(this)},Object.defineProperty(Vf,"logLevel",{get:function(){switch(Vr()){case a.DEBUG:return"debug";case a.ERROR:return"error";case a.SILENT:return"silent";case a.WARN:return"warn";case a.INFO:return"info";case a.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),Vf.setLogLevel=function(t){ei("Firestore.setLogLevel",arguments,1),hi("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Dr.setLogLevel(t)},Vf.prototype.nl=function(){return this.zh.timestampsInSnapshots},Vf.prototype.sl=function(){return this.zh},Vf),Ef=(Pf.prototype.get=function(t){var n=this;ei("Transaction.get",arguments,1);var r=Yf("Transaction.get",t,this.il);return this.rl.oh([r.Wa]).then(function(t){if(!t||1!==t.length)return jr();var e=t[0];if(e instanceof Ia)return new Nf(n.il,r.Wa,null,!1,!1,r.Ga);if(e instanceof Ea)return new Nf(n.il,r.Wa,e,!1,!1,r.Ga);throw jr()})},Pf.prototype.set=function(t,e,n){ri("Transaction.set",arguments,2,3);var r=Yf("Transaction.set",t,this.il);n=Hf("Transaction.set",n);var i=Jf(r.Ga,e,n),o=Xl(this.il.Kh,"Transaction.set",r.Wa,i,null!==r.Ga,n);return this.rl.set(r.Wa,o),this},Pf.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof ul?(ni("Transaction.update",arguments,3),r=Yf("Transaction.update",t,this.il),Jl(this.il.Kh,"Transaction.update",r.Wa,e,n,o)):(ei("Transaction.update",arguments,2),r=Yf("Transaction.update",t,this.il),Yl(this.il.Kh,"Transaction.update",r.Wa,e)),this.rl.update(r.Wa,i),this},Pf.prototype.delete=function(t){ei("Transaction.delete",arguments,1);var e=Yf("Transaction.delete",t,this.il);return this.rl.delete(e.Wa),this},Pf),If=(Df.prototype.set=function(t,e,n){ri("WriteBatch.set",arguments,2,3),this.cl();var r=Yf("WriteBatch.set",t,this.il);n=Hf("WriteBatch.set",n);var i=Jf(r.Ga,e,n),o=Xl(this.il.Kh,"WriteBatch.set",r.Wa,i,null!==r.Ga,n);return this.ol=this.ol.concat(o.za(r.Wa,Bs.He())),this},Df.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.cl(),i="string"==typeof e||e instanceof ul?(ni("WriteBatch.update",arguments,3),r=Yf("WriteBatch.update",t,this.il),Jl(this.il.Kh,"WriteBatch.update",r.Wa,e,n,o)):(ei("WriteBatch.update",arguments,2),r=Yf("WriteBatch.update",t,this.il),Yl(this.il.Kh,"WriteBatch.update",r.Wa,e)),this.ol=this.ol.concat(i.za(r.Wa,Bs.exists(!0))),this},Df.prototype.delete=function(t){ei("WriteBatch.delete",arguments,1),this.cl();var e=Yf("WriteBatch.delete",t,this.il);return this.ol=this.ol.concat(new ha(e.Wa,Bs.He())),this},Df.prototype.commit=function(){return this.cl(),this.ul=!0,0<this.ol.length?this.il.Bh().write(this.ol):Promise.resolve()},Df.prototype.cl=function(){if(this.ul)throw new Or(kr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Df),Tf=(o(Of,yf=Pl),Of.el=function(t,e,n){if(t.length%2!=0)throw new Or(kr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.R()+" has "+t.length);return new Of(new Xr(t),e,n)},Object.defineProperty(Of.prototype,"id",{get:function(){return this.Wa.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Of.prototype,"parent",{get:function(){return new Bf(this.Wa.path.h(),this.firestore,this.Ga)},enumerable:!1,configurable:!0}),Object.defineProperty(Of.prototype,"path",{get:function(){return this.Wa.path.R()},enumerable:!1,configurable:!0}),Of.prototype.collection=function(t){if(ei("DocumentReference.collection",arguments,1),ii("DocumentReference.collection","non-empty string",1,t),!t)throw new Or(kr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Wr.P(t);return new Bf(this.Wa.path.child(e),this.firestore,null)},Of.prototype.isEqual=function(t){if(!(t instanceof Of))throw vi("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Wa.isEqual(t.Wa)&&this.Ga===t.Ga},Of.prototype.set=function(t,e){ri("DocumentReference.set",arguments,1,2),e=Hf("DocumentReference.set",e);var n=Jf(this.Ga,t,e),r=Xl(this.firestore.Kh,"DocumentReference.set",this.Wa,n,null!==this.Ga,e);return this.Qh.write(r.za(this.Wa,Bs.He()))},Of.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof ul?(ni("DocumentReference.update",arguments,2),Jl(this.firestore.Kh,"DocumentReference.update",this.Wa,t,e,r)):(ei("DocumentReference.update",arguments,1),Yl(this.firestore.Kh,"DocumentReference.update",this.Wa,t)),this.Qh.write(n.za(this.Wa,Bs.exists(!0)))},Of.prototype.delete=function(){return ei("DocumentReference.delete",arguments,0),this.Qh.write([new ha(this.Wa,Bs.He())])},Of.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];ri("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},a=0;"object"!=typeof i[a]||df(i[a])||(di("DocumentReference.onSnapshot",s=i[a],["includeMetadataChanges"]),ai("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),a++);var u,h={includeMetadataChanges:s.includeMetadataChanges};df(i[a])?(u=i[a],i[a]=null===(t=u.next)||void 0===t?void 0:t.bind(u),i[a+1]=null===(e=u.error)||void 0===e?void 0:e.bind(u),i[a+2]=null===(n=u.complete)||void 0===n?void 0:n.bind(u)):(ii("DocumentReference.onSnapshot","function",a,i[a]),oi("DocumentReference.onSnapshot","function",a+1,i[a+1]),oi("DocumentReference.onSnapshot","function",a+2,i[a+2]));var c={next:function(t){i[a]&&i[a](r.al(t))},error:i[a+1],complete:i[a+2]};return this.Qh.listen(La(this.Wa.path),h,c)},Of.prototype.get=function(t){var e=this;ri("DocumentReference.get",arguments,0,1),Xf("DocumentReference.get",t);var n=this.firestore.Bh();return t&&"cache"===t.source?n.Rh(this.Wa).then(function(t){return new Nf(e.firestore,e.Wa,t,!0,t instanceof Ea&&t.Ye,e.Ga)}):n.yh(this.Wa,t).then(function(t){return e.al(t)})},Of.prototype.withConverter=function(t){return new Of(this.Wa,this.firestore,t)},Of.prototype.al=function(t){var e=t.docs.get(this.Wa);return new Nf(this.firestore,this.Wa,e,t.fromCache,t.hasPendingWrites,this.Ga)},Of),Af=(kf.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},kf),Nf=(Lf.prototype.data=function(t){var e=this;if(ri("DocumentSnapshot.data",arguments,0,1),t=Kf("DocumentSnapshot.data",t),this.hl){if(this.Ga){var n=new Rf(this.il,this.Wa,this.hl,this.ll,this._l,null);return this.Ga.fromFirestore(n,t)}return new gf(this.il.ja,this.il.nl(),t.serverTimestamps||"none",function(t){return new Tf(t,e.il,null)},function(t){return new Di(t)}).Dh(this.hl.sn())}},Lf.prototype.get=function(t,e){var n=this;if(ri("DocumentSnapshot.get",arguments,1,2),e=Kf("DocumentSnapshot.get",e),this.hl){var r=this.hl.data().field(rf("DocumentSnapshot.get",t,this.Wa));if(null!==r)return new gf(this.il.ja,this.il.nl(),e.serverTimestamps||"none",function(t){return new Tf(t,n.il,n.Ga)},function(t){return new Di(t)}).Dh(r)}},Object.defineProperty(Lf.prototype,"id",{get:function(){return this.Wa.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Lf.prototype,"ref",{get:function(){return new Tf(this.Wa,this.il,this.Ga)},enumerable:!1,configurable:!0}),Object.defineProperty(Lf.prototype,"exists",{get:function(){return null!==this.hl},enumerable:!1,configurable:!0}),Object.defineProperty(Lf.prototype,"metadata",{get:function(){return new Af(this._l,this.ll)},enumerable:!1,configurable:!0}),Lf.prototype.isEqual=function(t){if(!(t instanceof Lf))throw vi("isEqual","DocumentSnapshot",1,t);return this.il===t.il&&this.ll===t.ll&&this.Wa.isEqual(t.Wa)&&(null===this.hl?null===t.hl:this.hl.isEqual(t.hl))&&this.Ga===t.Ga},Lf),Rf=(o(Sf,vf=Nf),Sf.prototype.data=function(t){return vf.prototype.data.call(this,t)},Sf);function Sf(){return null!==vf&&vf.apply(this,arguments)||this}function Lf(t,e,n,r,i,o){this.il=t,this.Wa=e,this.hl=n,this.ll=r,this._l=i,this.Ga=o}function kf(t,e){this.hasPendingWrites=t,this.fromCache=e}function Of(t,e,n){var r=this;return(r=yf.call(this,e.ja,t,n)||this).Wa=t,r.firestore=e,r.Ga=n,r.Qh=r.firestore.Bh(),r}function Df(t){this.il=t,this.ol=[],this.ul=!1}function Pf(t,e){this.il=t,this.rl=e}function Vf(t,e,n,r){var i=this;if(void 0===n&&(n=new il),void 0===r&&(r=new ol),this.Mh=n,this.Lh=r,this.qh=null,this.Uh=new Lu,this.INTERNAL={delete:function(){return w(i,void 0,void 0,function(){return b(this,function(t){switch(t.label){case 0:return this.Bh(),[4,this.Qh.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var o=t;this.qh=o,this.ja=Vf.jh(o),this.Wh=o.name,this.Gh=new Th(e)}else{var s=t;if(!s.projectId)throw new Or(kr.INVALID_ARGUMENT,"Must provide projectId");this.ja=new Pi(s.projectId,s.database),this.Wh="[DEFAULT]",this.Gh=new Ih}this.zh=new wf({})}function _f(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new Or(kr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else si("settings","non-empty string","host",t.host),this.host=t.host,ai("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(di("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),ai("settings","object","credentials",t.credentials),this.credentials=t.credentials,ai("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),ai("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Cr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Cr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,ai("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Xu.Mi;else{if(t.cacheSizeBytes!==mf&&t.cacheSizeBytes<Xu.Oi)throw new Or(kr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Xu.Oi);this.cacheSizeBytes=t.cacheSizeBytes}ai("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}function Cf(t,e,n,r,i){this.B=t,this.timestampsInSnapshots=e,this.bh=n,this.Sh=r,this.Ch=i}function Uf(t,e,n){if("string"==typeof n){if(""===n)throw new Or(kr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Va(e)&&-1!==n.indexOf("/"))throw new Or(kr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Wr.P(n));if(!Xr.N(r))throw new Or(kr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Yo(t,new Xr(r))}if(n instanceof Pl)return Yo(t,n.Wa);throw new Or(kr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+fi(n)+".")}function Mf(t,e){if(!Array.isArray(t)||0===t.length)throw new Or(kr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Or(kr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new Or(kr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Or(kr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function jf(t,e,n){if(!n.isEqual(e))throw new Or(kr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Gf(t){if(Oa(t)&&0===t.rn.length)throw new Or(kr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var xf,Ff=(Wf.prototype.where=function(t,e,n){ei("Query.where",arguments,3),pi("Query.where",3,n);var r,i,o=hi("Query.where",["<","<=","==","!=",">=",">","array-contains","in","array-contains-any","not-in"],2,e),s=rf("Query.where",t),a=function(t,e,n,r,i,o){var s;if(r.V()){if("array-contains"===i||"array-contains-any"===i)throw new Or(kr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){Mf(o,i);for(var a=[],u=0,h=o;u<h.length;u++){var c=h[u];a.push(Uf(n,t,c))}s={arrayValue:{values:a}}}else s=Uf(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Mf(o,i),s=Zl(e,"Query.where",o,"in"===i||"not-in"===i);var l=za.create(r,i,s);return function(t,e){if(e.an()){var n=Pa(t);if(null!==n&&!n.isEqual(e.field))throw new Or(kr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=Da(t);null!==r&&jf(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==i)throw i===e.op?new Or(kr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Or(kr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,l),l}(this.fl,this.firestore.Kh,this.firestore.ja,s,o,n);return new Wf((i=(r=this.fl).filters.concat([a]),new Aa(r.path,r.collectionGroup,r.rn.slice(),i,r.limit,r.on,r.startAt,r.endAt)),this.firestore,this.Ga)},Wf.prototype.orderBy=function(t,e){var n;if(ri("Query.orderBy",arguments,1,2),oi("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Or(kr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var r,i,o=rf("Query.orderBy",t),s=function(t,e,n){if(null!==t.startAt)throw new Or(kr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Or(kr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r,i,o=new wu(e,n),s=o;return null!==Da(r=t)||null!==(i=Pa(r))&&jf(0,i,s.field),o}(this.fl,o,n);return new Wf((i=(r=this.fl).rn.concat([s]),new Aa(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.on,r.startAt,r.endAt)),this.firestore,this.Ga)},Wf.prototype.limit=function(t){return ei("Query.limit",arguments,1),ii("Query.limit","number",1,t),yi("Query.limit",1,t),new Wf(Ua(this.fl,t,"F"),this.firestore,this.Ga)},Wf.prototype.limitToLast=function(t){return ei("Query.limitToLast",arguments,1),ii("Query.limitToLast","number",1,t),yi("Query.limitToLast",1,t),new Wf(Ua(this.fl,t,"L"),this.firestore,this.Ga)},Wf.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ni("Query.startAt",arguments,1);var r=this.dl("Query.startAt",t,e,!0);return new Wf(Ma(this.fl,r),this.firestore,this.Ga)},Wf.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ni("Query.startAfter",arguments,1);var r=this.dl("Query.startAfter",t,e,!1);return new Wf(Ma(this.fl,r),this.firestore,this.Ga)},Wf.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ni("Query.endBefore",arguments,1);var r=this.dl("Query.endBefore",t,e,!0);return new Wf(ja(this.fl,r),this.firestore,this.Ga)},Wf.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ni("Query.endAt",arguments,1);var r=this.dl("Query.endAt",t,e,!1);return new Wf(ja(this.fl,r),this.firestore,this.Ga)},Wf.prototype.isEqual=function(t){if(!(t instanceof Wf))throw vi("isEqual","Query",1,t);return this.firestore===t.firestore&&Ga(this.fl,t.fl)&&this.Ga===t.Ga},Wf.prototype.withConverter=function(t){return new Wf(this.fl,this.firestore,t)},Wf.prototype.dl=function(c,t,e,n){if(pi(c,1,t),t instanceof Nf)return ei(c,s([t],e),1),function(t,e,n,r){if(!n)throw new Or(kr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=_a(t);o<s.length;o++){var a=s[o];if(a.field.V())i.push(Yo(e,n.key));else{var u=n.field(a.field);if(jo(u))throw new Or(kr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===u){var h=a.field.R();throw new Or(kr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}i.push(u)}}return new lu(i,r)}(this.fl,this.firestore.ja,t.hl,n);var r=[t].concat(e);return function(t,e,n,r,i,o){var s=t.rn;if(i.length>s.length)throw new Or(kr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var a=[],u=0;u<i.length;u++){var h=i[u];if(s[u].field.V()){if("string"!=typeof h)throw new Or(kr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!Va(t)&&-1!==h.indexOf("/"))throw new Or(kr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(Wr.P(h));if(!Xr.N(c))throw new Or(kr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");var l=new Xr(c);a.push(Yo(e,l))}else{var f=Zl(n,r,h);a.push(f)}}return new lu(a,o)}(this.fl,this.firestore.ja,this.firestore.Kh,c,r,n)},Wf.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];ri("Query.onSnapshot",arguments,1,4);var s,a={},u=0;"object"!=typeof i[u]||df(i[u])||(di("Query.onSnapshot",a=i[u],["includeMetadataChanges"]),ai("Query.onSnapshot","boolean","includeMetadataChanges",a.includeMetadataChanges),u++),df(i[u])?(s=i[u],i[u]=null===(t=s.next)||void 0===t?void 0:t.bind(s),i[u+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),i[u+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(ii("Query.onSnapshot","function",u,i[u]),oi("Query.onSnapshot","function",u+1,i[u+1]),oi("Query.onSnapshot","function",u+2,i[u+2]));var h={next:function(t){i[u]&&i[u](new qf(r.firestore,r.fl,t,r.Ga))},error:i[u+1],complete:i[u+2]};return Gf(this.fl),this.firestore.Bh().listen(this.fl,a,h)},Wf.prototype.get=function(t){var e=this;ri("Query.get",arguments,0,1),Xf("Query.get",t),Gf(this.fl);var n=this.firestore.Bh();return(t&&"cache"===t.source?n.Ph(this.fl):n.ph(this.fl,t)).then(function(t){return new qf(e.firestore,e.fl,t,e.Ga)})},Wf),qf=(Object.defineProperty(zf.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(zf.prototype,"empty",{get:function(){return this.ml.docs.m()},enumerable:!1,configurable:!0}),Object.defineProperty(zf.prototype,"size",{get:function(){return this.ml.docs.size},enumerable:!1,configurable:!0}),zf.prototype.forEach=function(e,n){var r=this;ri("QuerySnapshot.forEach",arguments,1,2),ii("QuerySnapshot.forEach","function",1,e),this.ml.docs.forEach(function(t){e.call(n,r.Il(t,r.metadata.fromCache,r.ml.Qt.has(t.key)))})},Object.defineProperty(zf.prototype,"query",{get:function(){return new Ff(this.wl,this.il,this.Ga)},enumerable:!1,configurable:!0}),zf.prototype.docChanges=function(t){t&&(di("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),ai("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.ml.Wt)throw new Or(kr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Tl&&this.El===e||(this.Tl=function(i,e,o){if(i.Bt.m()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Bt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return jr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.ml,e,this.Il.bind(this)),this.El=e),this.Tl},zf.prototype.isEqual=function(t){if(!(t instanceof zf))throw vi("isEqual","QuerySnapshot",1,t);return this.il===t.il&&Ga(this.wl,t.wl)&&this.ml.isEqual(t.ml)&&this.Ga===t.Ga},zf.prototype.Il=function(t,e,n){return new Rf(this.il,t.key,t,e,n,this.Ga)},zf),Bf=(o(Qf,xf=Ff),Object.defineProperty(Qf.prototype,"id",{get:function(){return this.fl.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Qf.prototype,"parent",{get:function(){var t=this.fl.path.h();return t.m()?null:new Tf(new Xr(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Qf.prototype,"path",{get:function(){return this.fl.path.R()},enumerable:!1,configurable:!0}),Qf.prototype.doc=function(t){ri("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=wi.k()),ii("CollectionReference.doc","non-empty string",1,t);var e=Wr.P(t);return Tf.el(this.fl.path.child(e),this.firestore,this.Ga)},Qf.prototype.add=function(t){ei("CollectionReference.add",arguments,1);var e=this.Ga?this.Ga.toFirestore(t):t;ii("CollectionReference.add","object",1,e);var n=this.doc();return new Tf(n.Wa,this.firestore,null).set(e).then(function(){return n})},Qf.prototype.withConverter=function(t){return new Qf(this.Al,this.firestore,t)},Qf);function Qf(t,e,n){var r=this;if(((r=xf.call(this,La(t),e,n)||this).Al=t).length%2!=1)throw new Or(kr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.R()+" has "+t.length);return r}function zf(t,e,n,r){this.il=t,this.wl=e,this.ml=n,this.Ga=r,this.Tl=null,this.El=null,this.metadata=new Af(n.hasPendingWrites,n.fromCache)}function Wf(t,e,n){this.fl=t,this.firestore=e,this.Ga=n}function Hf(t,e){if(void 0===e)return{merge:!1};if(di(t,e,["merge","mergeFields"]),ai(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Or(kr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+fi(n));for(var r,i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof ul))throw new Or(kr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+fi(n[i]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Or(kr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function Kf(t,e){return void 0===e?{}:(di(t,e,["serverTimestamps"]),ui(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Xf(t,e){oi(t,"object",1,e),e&&(di(t,e,["source"]),ui(t,0,"source",e.source,["default","server","cache"]))}function Yf(t,e,n){if(e instanceof Pl){if(e.firestore!==n)throw new Or(kr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw vi(t,"DocumentReference",1,e)}function Jf(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Zf,$f={Firestore:bf,GeoPoint:Ol,Timestamp:_i,Blob:Di,Transaction:Ef,WriteBatch:If,DocumentReference:Tf,DocumentSnapshot:Nf,Query:Ff,QueryDocumentSnapshot:Rf,QuerySnapshot:qf,CollectionReference:Bf,FieldPath:ul,FieldValue:Ll,setLogLevel:bf.setLogLevel,CACHE_SIZE_UNLIMITED:mf};(Zf=r.default).INTERNAL.registerComponent(new Rr("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new bf(e,n,new il,new ol);var e,n},"PUBLIC").setServiceProps(Object.assign({},$f))),Zf.registerVersion("@firebase/firestore","1.17.0")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
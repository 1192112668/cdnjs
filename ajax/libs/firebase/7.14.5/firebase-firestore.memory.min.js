!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t=t||self).firebase)}(this,function(tf){"use strict";try{(function(){tf=tf&&Object.prototype.hasOwnProperty.call(tf,"default")?tf.default:tf;var t,u,e,r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function l(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function p(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=h[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(e=u=u||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT",u.DEBUG,u.VERBOSE,u.INFO,u.WARN,u.ERROR,u.SILENT;var a=u.INFO,h=((t={})[u.DEBUG]="log",t[u.VERBOSE]="log",t[u.INFO]="info",t[u.WARN]="warn",t[u.ERROR]="error",t),c=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!0,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=a,this._logHandler=o,this._userLogHandler=null}function d(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var y,v=(n(g,y=Error),g);function g(t,e){var n=y.call(this,e)||this;return n.code=t,n.name="FirebaseError",Object.setPrototypeOf(n,g.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,m.prototype.create),n}var m=(w.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(r=i,s.replace(b,function(t,e){var n=r[e];return null!=n?n.toString():"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new v(o,a),c=0,f=Object.keys(i);c<f.length;c++){var l=f[c];"_"!==l.slice(-1)&&(l in h&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),h[l]=i[l])}return h},w);function w(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var b=/\{\$([^}]+)}/g,E=(I.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},I.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},I.prototype.setServiceProps=function(t){return this.serviceProps=t,this},I);function I(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var T,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},_=_||{},R=N||self;function S(){}function D(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function k(t){var e=D(t);return"array"==e||"object"==e&&"number"==typeof t.length}function L(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var O="closure_uid_"+(1e9*Math.random()>>>0),V=0;function M(t,e,n){return t.call.apply(t.bind,arguments)}function P(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?M:P).apply(null,arguments)}function U(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var q=Date.now||function(){return+new Date};function x(t,e){function n(){}n.prototype=e.prototype,t.M=e.prototype,t.prototype=new n,t.prototype.constructor=t}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.da=function(){!this.j&&(this.j=!0,this.C(),0)&&(Object.prototype.hasOwnProperty.call(this,O)&&this[O]||(this[O]=++V))},F.prototype.C=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var j=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function B(t){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var W,Q=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function J(t,e){return t<e?-1:e<t?1:0}t:{var Y=R.navigator;if(Y){var Z=Y.userAgent;if(Z){W=Z;break t}}W=""}function K(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function $(t){var e={};for(var n in t)e[n]=t[n];return e}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<tt.length;o++)n=tt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function nt(t){return nt[" "](t),t}nt[" "]=S;var rt,it,ot=X(W,"Opera"),st=X(W,"Trident")||X(W,"MSIE"),ut=X(W,"Edge"),at=ut||st,ht=X(W,"Gecko")&&!(X(W.toLowerCase(),"webkit")&&!X(W,"Edge"))&&!(X(W,"Trident")||X(W,"MSIE"))&&!X(W,"Edge"),ct=X(W.toLowerCase(),"webkit")&&!X(W,"Edge");function ft(){var t=R.document;return t?t.documentMode:void 0}t:{var lt="",pt=(it=W,ht?/rv:([^\);]+)(\)|;)/.exec(it):ut?/Edge\/([\d\.]+)/.exec(it):st?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(it):ct?/WebKit\/(\S+)/.exec(it):ot?/(?:Version)[ \/]?(\S+)/.exec(it):void 0);if(pt&&(lt=pt?pt[1]:""),st){var dt=ft();if(null!=dt&&dt>parseFloat(lt)){rt=String(dt);break t}}rt=lt}var yt={};function vt(u){return t=u,e=function(){for(var t=0,e=Q(String(rt)).split("."),n=Q(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=J(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||J(0==o[2].length,0==s[2].length)||J(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=yt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var gt=R.document&&st&&(ft()||parseInt(rt,10))||void 0,mt=!st||9<=Number(gt),wt=st&&!vt("9"),bt=function(){if(!R.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{R.addEventListener("test",S,e),R.removeEventListener("test",S,e)}catch(t){}return t}();function Et(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function It(t,e){if(Et.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ht){t:{try{nt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:At[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Et.prototype.b=function(){this.defaultPrevented=!0},x(It,Et);var At={2:"touch",3:"pen",4:"mouse"};It.prototype.b=function(){It.M.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,wt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Tt="closure_listenable_"+(1e6*Math.random()|0),Nt=0;function _t(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.aa=i,this.key=++Nt,this.V=this.X=!1}function Rt(t){t.V=!0,t.listener=null,t.proxy=null,t.src=null,t.aa=null}function St(t){this.src=t,this.a={},this.b=0}function Dt(t,e){var n,r,i,o=e.type;o in t.a&&(r=t.a[o],(n=0<=(i=j(r,e)))&&Array.prototype.splice.call(r,i,1),n&&(Rt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function kt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.V&&o.listener==e&&o.capture==!!n&&o.aa==r)return i}return-1}St.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=kt(t,e,r,i);return-1<s?(e=t[s],n||(e.X=!1)):((e=new _t(e,this.src,o,!!r,i)).X=n,t.push(e)),e};var Lt="closure_lm_"+(1e6*Math.random()|0),Ot={};function Vt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=jt(r),e&&e[Tt]?e.sa(n,r,L(i)?!!i.capture:!!i,o):Mt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Vt(t,e[o],n,r,i);return null}return n=jt(n),t&&t[Tt]?t.ra(e,n,L(r)?!!r.capture:!!r,i):Mt(t,e,n,!1,r,i)}function Mt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=L(i)?!!i.capture:!!i;if(s&&!mt)return null;var u,a,h=xt(t);if(h||(t[Lt]=h=new St(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=qt,r=a=mt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)bt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ct(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Pt(t){var e,n,r;"number"!=typeof t&&t&&!t.V&&((e=t.src)&&e[Tt]?Dt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ct(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=xt(e))?(Dt(n,t),0==n.b&&(n.src=null,e[Lt]=null)):Rt(t)))}function Ct(t){return t in Ot?Ot[t]:Ot[t]="on"+t}function Ut(t,e){var n=t.listener,r=t.aa||t.src;return t.X&&Pt(t),n.call(r,e)}function qt(t,e){if(t.V)return!0;if(mt)return Ut(t,new It(e,this));if(!e)t:{e=["window","event"];for(var n=R,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ut(t,e=new It(e,this))}function xt(t){return(t=t[Lt])instanceof St?t:null}var Ft="__closure_events_fn_"+(1e9*Math.random()>>>0);function jt(e){return"function"==D(e)?e:(e[Ft]||(e[Ft]=function(t){return e.handleEvent(t)}),e[Ft])}function Gt(){F.call(this),this.c=new St(this),(this.J=this).A=null}function Bt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.V&&a.capture==n&&(s=a.listener,u=a.aa||a.src,a.X&&Dt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}x(Gt,F),Gt.prototype[Tt]=!0,(T=Gt.prototype).addEventListener=function(t,e,n,r){Vt(this,t,e,n,r)},T.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=L(i)?!!i.capture:!!i,r=jt(r),e&&e[Tt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=kt(s=e.a[n],r,i,o))&&(Rt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&xt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=kt(n,r,i,o)),(r=-1<e?n[e]:null)&&Pt(r))}(this,t,e,n,r)},T.dispatchEvent=function(t){var e,n=this.A;if(n)for(e=[];n;n=n.A)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new Et(t,n):t instanceof Et?t.target=t.target||n:(s=t,et(t=new Et(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=Bt(o,r,!0,t)&&s;if(s=Bt(o=t.a=n,r,!0,t)&&s,s=Bt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Bt(o=t.a=e[i],r,!1,t)&&s;return s},T.C=function(){if(Gt.M.C.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Rt(n[r]);delete e.a[t],e.b--}}this.A=null},T.ra=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},T.sa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var zt=R.JSON.stringify;function Ht(){this.b=this.a=null}var Wt,Qt=(Xt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Xt(function(){return new Jt},function(t){t.reset()},100));function Xt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Jt(){this.next=this.b=this.a=null}function Yt(t){R.setTimeout(function(){throw t},0)}function Zt(t,e){var n;Wt||(n=R.Promise.resolve(void 0),Wt=function(){n.then(te)}),Kt||(Wt(),Kt=!0),$t.add(t,e)}Ht.prototype.add=function(t,e){var n=Qt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Jt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Kt=!(Jt.prototype.reset=function(){this.next=this.b=this.a=null}),$t=new Ht;function te(){for(var t,e,n;n=e=void 0,n=null,(e=$t).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){Yt(t)}var r=Qt;r.g(t),r.b<r.f&&(r.b++,t.next=r.a,r.a=t)}Kt=!1}function ee(t,e){Gt.call(this),this.b=t||1,this.a=e||R,this.f=C(this.Ua,this),this.g=q()}function ne(t){t.Z=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function re(t,e,n){if("function"==D(t))n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:R.setTimeout(t,e||0)}function ie(t,e,n){F.call(this),this.f=null!=n?C(t,n):t,this.c=e,this.b=C(this.Pa,this),this.a=[]}function oe(t){t.T=re(t.b,t.c),t.f.apply(null,t.a)}function se(t){F.call(this),this.b=t,this.a={}}x(ee,Gt),(T=ee.prototype).Z=!1,T.L=null,T.Ua=function(){var t;this.Z&&(0<(t=q()-this.g)&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.Z&&(ne(this),this.start())))},T.start=function(){this.Z=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=q())},T.C=function(){ee.M.C.call(this),ne(this),delete this.a},x(ie,F),(T=ie.prototype).ba=!1,T.T=null,T.Ia=function(t){this.a=arguments,this.T?this.ba=!0:oe(this)},T.C=function(){ie.M.C.call(this),this.T&&(R.clearTimeout(this.T),this.T=null,this.ba=!1,this.a=[])},T.Pa=function(){this.T=null,this.ba&&(this.ba=!1,oe(this))},x(se,F);var ue=[];function ae(t,e,n,r){Array.isArray(n)||(n&&(ue[0]=n.toString()),n=ue);for(var i=0;i<n.length;i++){var o=Vt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function he(t){K(t.a,function(t,e){this.a.hasOwnProperty(e)&&Pt(t)},t),t.a={}}function ce(){}se.prototype.C=function(){se.M.C.call(this),he(this)},se.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var fe=null;function le(){return fe=fe||new Gt}function pe(t){Et.call(this,"serverreachability",t)}function de(){var t=le();t.dispatchEvent(new pe(t))}function ye(t){Et.call(this,"statevent",t)}function ve(){var t=le();t.dispatchEvent(new ye(t))}function ge(t){Et.call(this,"timingevent",t)}function me(t,e){if("function"!=D(t))throw Error("Fn must not be null and must be a function");return R.setTimeout(function(){t()},e)}x(pe,Et),x(ye,Et),x(ge,Et);var we={NO_ERROR:0,Va:1,bb:2,ab:3,Ya:4,$a:5,cb:6,za:7,TIMEOUT:8,gb:9},be={Xa:"complete",kb:"success",Aa:"error",za:"abort",ib:"ready",jb:"readystatechange",TIMEOUT:"timeout",eb:"incrementaldata",hb:"progress",Za:"downloadprogress",lb:"uploadprogress"};function Ee(){}function Ie(t){var e;return(e=t.a)||(e=t.a={}),e}function Ae(){}Ee.prototype.a=null;var Te,Ne={OPEN:"a",Wa:"b",Aa:"c",fb:"d"};function _e(){Et.call(this,"d")}function Re(){Et.call(this,"c")}function Se(){}function De(t,e,n){this.g=t,this.W=e,this.U=n||1,this.G=new se(this),this.N=ke,t=at?125:void 0,this.O=new ee(t),this.m=null,this.b=!1,this.j=this.A=this.f=this.B=this.s=this.P=this.h=null,this.i=[],this.a=null,this.w=0,this.c=this.v=null,this.H=-1,this.l=!1,this.J=0,this.D=null,this.o=this.R=this.F=!1}x(_e,Et),x(Re,Et),x(Se,Ee),Te=new Se;var ke=45e3,Le={},Oe={};function Ve(t,e,n){t.B=1,t.f=tn(Xe(e)),t.j=n,t.F=!0,Me(t,null)}function Me(t,e){t.s=q(),Ce(t),t.A=Xe(t.f);var n=t.A,r=t.U;Array.isArray(r)||(r=[String(r)]),dn(n.b,"t",r),t.w=0,t.a=or(t.g,t.g.w?e:null),0<t.J&&(t.D=new ie(C(t.ya,t,t.a),t.J)),ae(t.G,t.a,"readystatechange",t.Sa),e=t.m?$(t.m):{},t.j?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.$(t.A,t.v,t.j,e)):(t.v="GET",t.a.$(t.A,t.v,null,e)),de()}function Pe(t,e,n){for(var r,i,o,s,u=!0;!t.l&&t.w<n.length;){var a=(i=n,s=o=void 0,o=(r=t).w,-1==(s=i.indexOf("\n",o))?Oe:(o=Number(i.substring(o,s)),isNaN(o)?Le:(s+=1)+o>i.length?Oe:(i=i.substr(s,o),r.w=s+o,i)));if(a==Oe){4==e&&(t.c=4,ve(),u=!1);break}if(a==Le){t.c=4,ve(),u=!1;break}je(t,a)}4==e&&0==n.length&&(t.c=1,ve(),u=!1),t.b=t.b&&u,u||(Fe(t),xe(t))}function Ce(t){t.P=q()+t.N,Ue(t,t.N)}function Ue(t,e){if(null!=t.h)throw Error("WatchDog timer not null");t.h=me(C(t.Qa,t),e)}function qe(t){t.h&&(R.clearTimeout(t.h),t.h=null)}function xe(t){0==t.g.u||t.l||tr(t.g,t)}function Fe(t){qe(t);var e=t.D;e&&"function"==typeof e.da&&e.da(),t.D=null,ne(t.O),he(t.G),t.a&&(e=t.a,t.a=null,e.abort(),e.da())}function je(t,e){try{var n,r,i,o,s,u,a,h,c,f,l=t.g;if(0!=l.u&&(l.a==t||En(l.b,t)))if(l.A=t.H,!t.o&&En(l.b,t)&&3==l.u){try{var p=l.ja.a.parse(e)}catch(t){p=null}if(Array.isArray(p)&&3==p.length){var d=p;if(0==d[0]){t:if(!l.i){if(l.a){if(!(l.a.s+3e3<t.s))break t;$n(l),l.a.cancel(),l.a=null}Kn(l),ve()}}else l.ia=d[1],0<l.ia-l.G&&d[2]<37500&&l.U&&0==l.m&&!l.l&&(l.l=me(C(l.Na,l),6e3));if(bn(l.b)<=1&&l.O){try{l.O()}catch(t){}l.O=void 0}}else nr(l,11)}else if(!t.o&&l.a!=t||$n(l),!H(e))for(e=p=l.ja.a.parse(e),p=0;p<e.length;p++){d=e[p],l.G=d[0],d=d[1],2==l.u?"c"==d[0]?(l.B=d[1],l.R=d[2],null!=(n=d[3])&&(l.oa=n),null!=(r=d[5])&&"number"==typeof r&&0<r&&(l.D=1.5*r),i=l,(o=t.a)&&(!(s=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(u=i.b).a&&(X(s,"spdy")||X(s,"quic")||X(s,"h2"))&&(u.f=u.g,u.a=new Set,u.b&&(In(u,u.b),u.b=null)),!i.s||(a=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(i.ha=a,$e(i.v,i.s,a))),l.u=3,l.c&&l.c.na(),h=t,(i=l).ea=ir(i,i.w?i.R:null,i.P),h.o?(An(i.b,h),c=h,(f=i.D)&&c.setTimeout(f),c.h&&(qe(c),Ce(c)),i.a=h):Zn(i),0<l.f.length&&Qn(l)):"stop"!=d[0]&&"close"!=d[0]||nr(l,7):3==l.u&&("stop"==d[0]||"close"==d[0]?"stop"==d[0]?nr(l,7):zn(l):"noop"!=d[0]&&l.c&&l.c.ma(d),l.m=0)}de()}catch(t){}}function Ge(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(k(t)||"string"==typeof t)G(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.I&&"function"==typeof t.I)n=void 0;else if(k(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.I&&"function"==typeof t.I)return t.I();if("string"==typeof t)return t.split("");if(k(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Be(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Be)for(n=t.K(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function ze(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];He(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)He(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function He(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(T=De.prototype).setTimeout=function(t){this.N=t},T.Sa=function(t){t=t.target;var e=this.D;e&&3==Fn(t)?e.Ia():this.ya(t)},T.ya=function(t){try{if(t==this.a)t:{var e=Fn(this.a),n=this.a.qa();this.a.S();if(!(e<3||3==e&&!at&&!this.a.Y())){this.l||4!=e||7==n||de(),qe(this);var r=this.a.S();this.H=r;var i=this.a.Y();if(this.b=200==r){if(this.R&&!this.o){e:{if(this.a){var o,s=this.a;if((o=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(o)){var u=o;break e}}u=null}if(!u){this.b=!1,this.c=3,ve(),Fe(this),xe(this);break t}this.o=!0,je(this,u)}this.F?(Pe(this,e,i),at&&this.b&&3==e&&(ae(this.G,this.O,"tick",this.Ra),this.O.start())):je(this,i),4==e&&Fe(this),this.b&&!this.l&&(4==e?tr(this.g,this):(this.b=!1,Ce(this)))}else 400==r&&0<i.indexOf("Unknown SID")?this.c=3:this.c=0,ve(),Fe(this),xe(this)}}}catch(t){}},T.Ra=function(){var t,e;this.a&&(t=Fn(this.a),e=this.a.Y(),this.w<e.length&&(qe(this),Pe(this,t,e),this.b&&4!=t&&Ce(this)))},T.cancel=function(){this.l=!0,Fe(this)},T.Qa=function(){this.h=null;var t=q();0<=t-this.P?(2!=this.B&&(de(),ve()),Fe(this),this.c=2,xe(this)):Ue(this,this.P-t)},(T=Be.prototype).I=function(){ze(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},T.K=function(){return ze(this),this.a.concat()},T.get=function(t,e){return He(this.b,t)?this.b[t]:e},T.set=function(t,e){He(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},T.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var We=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Qe(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Qe?(this.a=void 0!==e?e:t.a,Je(this,t.f),this.j=t.j,Ye(this,t.c),Ze(this,t.h),this.g=t.g,e=t.b,(n=new cn).c=e.c,e.a&&(n.a=new Be(e.a),n.b=e.b),Ke(this,n),this.i=t.i):t&&(n=String(t).match(We))?(this.a=!!e,Je(this,n[1]||"",!0),this.j=en(n[2]||""),Ye(this,n[3]||"",!0),Ze(this,n[4]),this.g=en(n[5]||"",!0),Ke(this,n[6]||"",!0),this.i=en(n[7]||"")):(this.a=!!e,this.b=new cn(null,this.a))}function Xe(t){return new Qe(t)}function Je(t,e,n){t.f=n?en(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ye(t,e,n){t.c=n?en(e,!0):e}function Ze(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ke(t,e,n){var r,i;e instanceof cn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(fn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(ln(this,e),dn(this,n,t))},r)),r.f=i):(n||(e=nn(e,an)),t.b=new cn(e,t.a))}function $e(t,e,n){t.b.set(e,n)}function tn(t){return $e(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^q()).toString(36)),t}function en(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function nn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,rn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function rn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Qe.prototype.toString=function(){var t=[],e=this.f;e&&t.push(nn(e,on,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(nn(e,on,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(nn(n,"/"==n.charAt(0)?un:sn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",nn(n,hn)),t.join("")};var on=/[#\/\?@]/g,sn=/[#\?:]/g,un=/[#\?]/g,an=/[#\?@]/g,hn=/#/g;function cn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function fn(u){u.a||(u.a=new Be,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function ln(t,e){fn(t),e=yn(t,e),He(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,He((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&ze(t)))}function pn(t,e){return fn(t),e=yn(t,e),He(t.a.b,e)}function dn(t,e,n){ln(t,e),0<n.length&&(t.c=null,t.a.set(yn(t,e),z(n)),t.b+=n.length)}function yn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function vn(t,e){this.b=t,this.a=e}function gn(t){this.g=t||mn,t=R.PerformanceNavigationTiming?0<(t=R.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(R.ca&&R.ca.ua&&R.ca.ua()&&R.ca.ua().mb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(T=cn.prototype).add=function(t,e){fn(this),this.c=null,t=yn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},T.forEach=function(n,r){fn(this),this.a.forEach(function(t,e){G(t,function(t){n.call(r,t,e,this)},this)},this)},T.K=function(){fn(this);for(var t=this.a.I(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},T.I=function(t){fn(this);var e=[];if("string"==typeof t)pn(this,t)&&(e=B(e,this.a.get(yn(this,t))));else{t=this.a.I();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},T.set=function(t,e){return fn(this),this.c=null,pn(this,t=yn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},T.get=function(t,e){return t&&0<(t=this.I(t)).length?String(t[0]):e},T.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.I(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var mn=10;function wn(t){return t.b||t.a&&t.a.size>=t.f}function bn(t){return t.b?1:t.a?t.a.size:0}function En(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function In(t,e){t.a?t.a.add(e):t.b=e}function An(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Tn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.i);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.i)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Nn(){}function _n(){this.a=new Nn}function Rn(t,r,e){var i=e||"";try{Ge(t,function(t,e){var n=t;L(t)&&(n=zt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}function Sn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}gn.prototype.cancel=function(){var t,e;if(this.c=Tn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Nn.prototype.stringify=function(t){return R.JSON.stringify(t,void 0)},Nn.prototype.parse=function(t){return R.JSON.parse(t,void 0)};var Dn=R.JSON.parse;function kn(t){Gt.call(this),this.headers=new Be,this.G=t||null,this.b=!1,this.s=this.a=null,this.D="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.H=Ln,this.B=this.F=!1}x(kn,Gt);var Ln="",On=/^https?$/i,Vn=["POST","PUT"];function Mn(t){return"content-type"==t.toLowerCase()}function Pn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Cn(t),qn(t)}function Cn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Un(t){if(t.b&&void 0!==_&&(!t.s[1]||4!=Fn(t)||2!=t.S()))if(t.l&&4==Fn(t))re(t.va,0,t);else if(t.dispatchEvent("readystatechange"),4==Fn(t)){t.b=!1;try{var e,n,r,i,o=t.S();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.D).match(We)[1]||null)&&R.self&&R.self.location&&(i=(r=R.self.location.protocol).substr(0,r.length-1)),n=!On.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Fn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.S()+"]",Cn(t)}}finally{qn(t)}}}function qn(t,e){if(t.a){xn(t);var n=t.a,r=t.s[0]?S:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function xn(t){t.a&&t.B&&(t.a.ontimeout=null),t.m&&(R.clearTimeout(t.m),t.m=null)}function Fn(t){return t.a?t.a.readyState:0}function jn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",K(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):$e(t,e,n))}function Gn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Bn(t){this.f=[],this.R=this.ea=this.v=this.P=this.a=this.ha=this.s=this.N=this.h=this.F=this.j=null,this.Fa=this.H=0,this.Ca=Gn("failFast",!1,t),this.U=this.l=this.i=this.g=this.c=null,this.W=!0,this.A=this.ia=this.G=-1,this.J=this.m=this.o=0,this.Ba=Gn("baseRetryDelayMs",5e3,t),this.Ga=Gn("retryDelaySeedMs",1e4,t),this.Da=Gn("forwardChannelMaxRetries",2,t),this.ga=Gn("forwardChannelRequestTimeoutMs",2e4,t),this.Ea=t&&t.nb||void 0,this.D=void 0,this.w=t&&t.supportsCrossDomainXhr||!1,this.B="",this.b=new gn(t&&t.concurrentRequestLimit),this.ja=new _n,this.fa=t&&t.fastHandshake||!1,t&&t.forceLongPolling&&(this.W=!1),this.O=void 0}function zn(t){var e,n;Hn(t),3==t.u&&(e=t.H++,$e(n=Xe(t.v),"SID",t.B),$e(n,"RID",e),$e(n,"TYPE","terminate"),Jn(t,n),(e=new De(t,e,void 0)).B=2,e.f=tn(Xe(n)),n=!1,R.navigator&&R.navigator.sendBeacon&&(n=R.navigator.sendBeacon(e.f.toString(),"")),!n&&R.Image&&((new Image).src=e.f,n=!0),n||(e.a=or(e.g,null),e.a.$(e.f)),e.s=q(),Ce(e)),rr(t)}function Hn(t){t.a&&(t.a.cancel(),t.a=null),t.i&&(R.clearTimeout(t.i),t.i=null),$n(t),t.b.cancel(),t.g&&("number"==typeof t.g&&R.clearTimeout(t.g),t.g=null)}function Wn(t,e){t.f.push(new vn(t.Fa++,e)),3==t.u&&Qn(t)}function Qn(t){wn(t.b)||t.g||(t.g=!0,Zt(t.xa,t),t.o=0)}function Xn(t,e){var n=e?e.W:t.H++,r=Xe(t.v);$e(r,"SID",t.B),$e(r,"RID",n),$e(r,"AID",t.G),Jn(t,r),t.h&&t.j&&jn(r,t.h,t.j),n=new De(t,n,t.o+1),null===t.h&&(n.m=t.j),e&&(t.f=e.i.concat(t.f)),e=Yn(t,n,1e3),n.setTimeout(Math.round(.5*t.ga)+Math.round(.5*t.ga*Math.random())),In(t.b,n),Ve(n,r,e)}function Jn(t,n){t.c&&Ge({},function(t,e){$e(n,e,t)})}function Yn(t,e,n){n=Math.min(t.f.length,n);var r=t.c?C(t.c.Ha,t.c,t):null;t:for(var i=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{Rn(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.f.splice(0,n),e.i=t,r}function Zn(t){t.a||t.i||(t.J=1,Zt(t.wa,t),t.m=0)}function Kn(t){return!(t.a||t.i||3<=t.m)&&(t.J++,t.i=me(C(t.wa,t),er(t,t.m)),t.m++,1)}function $n(t){null!=t.l&&(R.clearTimeout(t.l),t.l=null)}function tr(t,e){var n,r=null;if(t.a==e){$n(t),t.a=null;var i=2}else{if(!En(t.b,e))return;r=e.i,An(t.b,e),i=1}if(t.A=e.H,0!=t.u)if(e.b){1==i?(r=e.j?e.j.length:0,e=q()-e.s,n=t.o,(i=le()).dispatchEvent(new ge(i)),Qn(t)):Zn(t)}else if(3==(n=e.c)||0==n&&0<t.A||!(1==i&&function(t,e){if(!(bn(t.b)>=t.b.f-(t.g?1:0))){if(t.g)return t.f=e.i.concat(t.f),1;if(!(1==t.u||2==t.u||t.o>=(t.Ca?0:t.Da)))return t.g=me(C(t.xa,t,e),er(t,t.o)),t.o++,1}}(t,e)||2==i&&Kn(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:nr(t,5);break;case 4:nr(t,10);break;case 3:nr(t,6);break;default:nr(t,2)}}function er(t,e){var n=t.Ba+Math.floor(Math.random()*t.Ga);return t.c||(n*=2),n*e}function nr(t,e){var n,r,i,o,s,u;2==e?(n=null,t.c&&(n=null),r=C(t.Ta,t),n||(n=new Qe("//www.google.com/images/cleardot.gif"),R.location&&"http"==R.location.protocol||Je(n,"https"),tn(n)),i=n.toString(),o=r,u=new ce,R.Image?((s=new Image).onload=U(Sn,u,s,"TestLoadImage: loaded",!0,o),s.onerror=U(Sn,u,s,"TestLoadImage: error",!1,o),s.onabort=U(Sn,u,s,"TestLoadImage: abort",!1,o),s.ontimeout=U(Sn,u,s,"TestLoadImage: timeout",!1,o),R.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=i):o(!1)):ve(),t.u=0,t.c&&t.c.la(e),rr(t),Hn(t)}function rr(t){t.u=0,t.A=-1,t.c&&(0==Tn(t.b).length&&0==t.f.length||(t.b.c.length=0,z(t.f),t.f.length=0),t.c.ka())}function ir(t,e,n){var r,i,o,s,u,a,h,c=(r=n)instanceof Qe?Xe(r):new Qe(r,void 0);return""!=c.c?(e&&Ye(c,e+"."+c.c),Ze(c,c.h)):(o=(i=R.location).protocol,s=e?e+"."+i.hostname:i.hostname,u=+i.port,a=n,h=new Qe(null,void 0),o&&Je(h,o),s&&Ye(h,s),u&&Ze(h,u),a&&(h.g=a),c=h),t.N&&K(t.N,function(t,e){$e(c,e,t)}),e=t.s,n=t.ha,e&&n&&$e(c,e,n),$e(c,"VER",t.oa),Jn(t,c),c}function or(t,e){if(e&&!t.w)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new kn(t.Ea)).F=t.w,e}function sr(){}function ur(){if(st&&!(10<=Number(gt)))throw Error("Environmental error: no available transport.")}function ar(t,e){Gt.call(this),this.a=new Bn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.j=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.pa&&(t?t["X-WebChannel-Client-Profile"]=e.pa:t={"X-WebChannel-Client-Profile":e.pa}),this.a.F=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.h=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.s=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new fr(this)}function hr(t){_e.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function cr(){Re.call(this),this.status=1}function fr(t){this.a=t}(T=kn.prototype).$=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.G?Ie(this.G):Ie(Te),this.a.onreadystatechange=C(this.va,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void Pn(this,t)}t=n||"";var i,o=new Be(this.headers);r&&Ge(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Mn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.K()),n=R.FormData&&t instanceof R.FormData,0<=j(Vn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.H&&(this.a.responseType=this.H),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{xn(this),0<this.o&&((this.B=(i=this.a,st&&vt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=C(this.ta,this)):this.m=re(this.ta,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Pn(this,t)}},T.ta=function(){void 0!==_&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},T.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),qn(this))},T.C=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),qn(this,!0)),kn.M.C.call(this)},T.va=function(){this.j||(this.w||this.l||this.g?Un(this):this.Oa())},T.Oa=function(){Un(this)},T.S=function(){try{return 2<Fn(this)?this.a.status:-1}catch(t){return-1}},T.Y=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},T.Ja=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Dn(e)}},T.qa=function(){return this.h},T.Ma=function(){return"string"==typeof this.f?this.f:String(this.f)},(T=Bn.prototype).oa=8,T.u=1,T.xa=function(t){if(this.g)if(this.g=null,1==this.u){if(!t){this.H=Math.floor(1e5*Math.random()),t=this.H++;var e,n=new De(this,t,void 0),r=this.j;if(this.F&&(r?et(r=$(r),this.F):r=this.F),null===this.h&&(n.m=r),this.fa)t:{for(var i=e=0;i<this.f.length;i++){var o=this.f[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.f.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Yn(this,n,e),$e(i=Xe(this.v),"RID",t),$e(i,"CVER",22),this.s&&$e(i,"X-HTTP-Session-Id",this.s),Jn(this,i),this.h&&r&&jn(i,this.h,r),In(this.b,n),this.fa?($e(i,"$req",e),$e(i,"SID","null"),n.R=!0,Ve(n,i,null)):Ve(n,i,e),this.u=2}}else 3==this.u&&(t?Xn(this,t):0==this.f.length||wn(this.b)||Xn(this))},T.wa=function(){this.i=null,this.a=new De(this,"rpc",this.J),null===this.h&&(this.a.m=this.j),this.a.J=0;var t=Xe(this.ea);$e(t,"RID","rpc"),$e(t,"SID",this.B),$e(t,"CI",this.U?"0":"1"),$e(t,"AID",this.G),Jn(this,t),$e(t,"TYPE","xmlhttp"),this.h&&this.j&&jn(t,this.h,this.j),this.D&&this.a.setTimeout(this.D);var e=this.a,n=this.R;e.B=1,e.f=tn(Xe(t)),e.j=null,e.F=!0,Me(e,n)},T.Na=function(){null!=this.l&&(this.l=null,this.a.cancel(),this.a=null,Kn(this),ve())},T.Ta=function(t){ve()},(T=sr.prototype).na=function(){},T.ma=function(){},T.la=function(){},T.ka=function(){},T.Ha=function(){},ur.prototype.a=function(t,e){return new ar(t,e)},x(ar,Gt),(T=ar.prototype).addEventListener=function(t,e,n,r){ar.M.addEventListener.call(this,t,e,n,r)},T.removeEventListener=function(t,e,n,r){ar.M.removeEventListener.call(this,t,e,n,r)},T.Ka=function(){this.a.c=this.f,this.h&&(this.a.w=!0);var t=this.a,e=this.l,n=this.b||void 0;ve(),t.P=e,t.N=n||{},t.U=t.W,t.v=ir(t,null,t.P),Qn(t)},T.close=function(){zn(this.a)},T.La=function(t){var e;"string"==typeof t?((e={}).__data__=t,Wn(this.a,e)):this.g?((e={}).__data__=zt(t),Wn(this.a,e)):Wn(this.a,t)},T.C=function(){this.a.c=null,delete this.f,zn(this.a),delete this.a,ar.M.C.call(this)},x(hr,_e),x(cr,Re),x(fr,sr),fr.prototype.na=function(){this.a.dispatchEvent("a")},fr.prototype.ma=function(t){this.a.dispatchEvent(new hr(t))},fr.prototype.la=function(t){this.a.dispatchEvent(new cr)},fr.prototype.ka=function(){this.a.dispatchEvent("b")},ur.prototype.createWebChannel=ur.prototype.a,ar.prototype.send=ar.prototype.La,ar.prototype.open=ar.prototype.Ka,ar.prototype.close=ar.prototype.close,we.NO_ERROR=0,we.TIMEOUT=8,we.HTTP_ERROR=6,be.COMPLETE="complete",(Ae.EventType=Ne).OPEN="a",Ne.CLOSE="b",Ne.ERROR="c",Ne.MESSAGE="d",Gt.prototype.listen=Gt.prototype.ra,kn.prototype.listenOnce=kn.prototype.sa,kn.prototype.getLastError=kn.prototype.Ma,kn.prototype.getLastErrorCode=kn.prototype.qa,kn.prototype.getStatus=kn.prototype.S,kn.prototype.getResponseJson=kn.prototype.Ja,kn.prototype.getResponseText=kn.prototype.Y,kn.prototype.send=kn.prototype.$;var lr={createWebChannelTransport:function(){return new ur},ErrorCode:we,EventType:be,WebChannel:Ae,XhrIo:kn},pr=lr.createWebChannelTransport,dr=lr.ErrorCode,yr=lr.EventType,vr=lr.WebChannel,gr=lr.XhrIo,mr=tf.SDK_VERSION,wr=(br.prototype.t=function(){return null!=this.uid},br.prototype.s=function(){return this.t()?"uid:"+this.uid:"anonymous-user"},br.prototype.isEqual=function(t){return t.uid===this.uid},br);function br(t){this.uid=t}function Er(t,e){this.user=e,this.type="OAuth",this.o={},this.o.Authorization="Bearer "+t}wr.UNAUTHENTICATED=new wr(null),wr.i=new wr("google-credentials-uid"),wr.h=new wr("first-party-uid");var Ir,Ar,Tr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Nr=(n(Gr,Ar=Error),Gr),_r=(jr.prototype.getToken=function(){return Promise.resolve(null)},jr.prototype.l=function(){},jr.prototype._=function(t){(this.u=t)(wr.UNAUTHENTICATED)},jr.prototype.T=function(){this.u=null},jr),Rr=(Fr.prototype.getToken=function(){var e=this,n=this.R,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){if(e.R!==n)throw new Nr(Tr.ABORTED,"getToken aborted due to token change.");return t?(zs("string"==typeof t.accessToken),new Er(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Fr.prototype.l=function(){this.forceRefresh=!0},Fr.prototype._=function(t){this.u=t,this.I&&t(this.currentUser)},Fr.prototype.T=function(){this.auth&&this.auth.removeAuthTokenListener(this.m),this.m=null,this.u=null},Fr.prototype.A=function(){var t=this.auth&&this.auth.getUid();return zs(null===t||"string"==typeof t),new wr(t)},Fr),Sr=(Object.defineProperty(xr.prototype,"o",{get:function(){var t={"X-Goog-AuthUser":this.V},e=this.P.auth.p([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),xr),Dr=(qr.prototype.getToken=function(){return Promise.resolve(new Sr(this.P,this.V))},qr.prototype._=function(t){t(wr.h)},qr.prototype.T=function(){},qr.prototype.l=function(){},qr),kr=(Ur.now=function(){return Ur.fromMillis(Date.now())},Ur.fromDate=function(t){return Ur.fromMillis(t.getTime())},Ur.fromMillis=function(t){var e=Math.floor(t/1e3);return new Ur(e,1e6*(t-1e3*e))},Ur.prototype.toDate=function(){return new Date(this.toMillis())},Ur.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Ur.prototype.g=function(t){return this.seconds===t.seconds?Qs(this.nanoseconds,t.nanoseconds):Qs(this.seconds,t.seconds)},Ur.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Ur.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Ur.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Ur),Lr=(Cr.v=function(t){return new Cr(t)},Cr.min=function(){return new Cr(new kr(0,0))},Cr.prototype.S=function(t){return this.timestamp.g(t.timestamp)},Cr.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Cr.prototype.C=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Cr.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Cr.prototype.D=function(){return this.timestamp},Cr),Or=(Object.defineProperty(Pr.prototype,"length",{get:function(){return this.F},enumerable:!0,configurable:!0}),Pr.prototype.isEqual=function(t){return 0===Pr.N(this,t)},Pr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Pr?t.forEach(function(t){e.push(t)}):e.push(t),this.$(e)},Pr.prototype.limit=function(){return this.offset+this.length},Pr.prototype.L=function(t){return t=void 0===t?1:t,this.$(this.segments,this.offset+t,this.length-t)},Pr.prototype.k=function(){return this.$(this.segments,this.offset,this.length-1)},Pr.prototype.O=function(){return this.segments[this.offset]},Pr.prototype.q=function(){return this.get(this.length-1)},Pr.prototype.get=function(t){return this.segments[this.offset+t]},Pr.prototype.M=function(){return 0===this.length},Pr.prototype.B=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Pr.prototype.U=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Pr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Pr.prototype.W=function(){return this.segments.slice(this.offset,this.limit())},Pr.N=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Pr),Vr=(n(Mr,Ir=Or),Mr.prototype.$=function(t,e,n){return new Mr(t,e,n)},Mr.prototype.j=function(){return this.W().join("/")},Mr.prototype.toString=function(){return this.j()},Mr.G=function(t){if(0<=t.indexOf("//"))throw new Nr(Tr.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new Mr(t.split("/").filter(function(t){return 0<t.length}))},Mr);function Mr(){return null!==Ir&&Ir.apply(this,arguments)||this}function Pr(t,e,n){void 0===e?e=0:e>t.length&&Bs(),void 0===n?n=t.length-e:n>t.length-e&&Bs(),this.segments=t,this.offset=e,this.F=n}function Cr(t){this.timestamp=t}function Ur(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Nr(Tr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Nr(Tr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Nr(Tr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Nr(Tr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function qr(t,e){this.P=t,this.V=e}function xr(t,e){this.P=t,this.V=e,this.type="FirstParty",this.user=wr.h}function Fr(t){var e=this;this.m=null,this.currentUser=wr.UNAUTHENTICATED,this.I=!1,this.R=0,this.u=null,this.forceRefresh=!1,this.m=function(){e.R++,e.currentUser=e.A(),e.I=!0,e.u&&e.u(e.currentUser)},this.R=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.m):(this.m(null),t.get().then(function(t){e.auth=t,e.m&&e.auth.addAuthTokenListener(e.m)},function(){}))}function jr(){this.u=null}function Gr(t,e){var n=this;return(n=Ar.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}Vr.H=new Vr([]);var Br,zr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Hr=(n(Wr,Br=Or),Wr.prototype.$=function(t,e,n){return new Wr(t,e,n)},Wr.K=function(t){return zr.test(t)},Wr.prototype.j=function(){return this.W().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),Wr.K(t)||(t="`"+t+"`"),t}).join(".")},Wr.prototype.toString=function(){return this.j()},Wr.prototype.Y=function(){return 1===this.length&&"__name__"===this.get(0)},Wr.X=function(){return new Wr(["__name__"])},Wr.J=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Nr(Tr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Nr(Tr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Nr(Tr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Nr(Tr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Wr(e)},Wr);function Wr(){return null!==Br&&Br.apply(this,arguments)||this}Hr.H=new Hr([]);var Qr=(Xr.Z=function(t){return new Xr(Vr.G(t).L(5))},Xr.prototype.tt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Xr.prototype.isEqual=function(t){return null!==t&&0===Vr.N(this.path,t.path)},Xr.prototype.toString=function(){return this.path.toString()},Xr.N=function(t,e){return Vr.N(t.path,e.path)},Xr.et=function(t){return t.length%2==0},Xr.st=function(t){return new Xr(new Vr(t.slice()))},Xr);function Xr(t){this.path=t}function Jr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Yr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Zr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}Qr.EMPTY=new Qr(new Vr([]));var Kr=($r.fromBase64String=function(t){return new $r(Ps.nt().atob(t))},$r.fromUint8Array=function(t){return new $r(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},$r.prototype.toBase64=function(){return Ps.nt().btoa(this.it)},$r.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.it)},$r.prototype.rt=function(){return 2*this.it.length},$r.prototype.S=function(t){return Qs(this.it,t.it)},$r.prototype.isEqual=function(t){return this.it===t.it},$r);function $r(t){this.it=t}function ti(t){return null==t}function ei(t){return-0===t&&1/t==-1/0}function ni(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ri(t){var e=fi(t.mapValue.fields.__local_write_time__.timestampValue);return new kr(e.seconds,e.nanos)}Kr.ht=new Kr("");var ii=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function oi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ni(t)?4:10:Bs()}function si(r,i){var t,e,n,o=oi(r);if(o!==oi(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return ri(r).isEqual(ri(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=fi(r.timestampValue),n=fi(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return n=i,pi(r.bytesValue).isEqual(pi(n.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,li((t=r).geoPointValue.latitude)===li(e.geoPointValue.latitude)&&li(t.geoPointValue.longitude)===li(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return li(t.integerValue)===li(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=li(t.doubleValue),r=li(e.doubleValue);return n===r?ei(n)===ei(r):isNaN(n)&&isNaN(r)}return!1}(r,i);case 9:return Xs(r.arrayValue.values||[],i.arrayValue.values||[],si);case 10:return function(){var t=r.mapValue.fields||{},e=i.mapValue.fields||{};if(Jr(t)!==Jr(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!si(t[n],e[n])))return!1;return!0}();default:return Bs()}}function ui(t,e){return void 0!==(t.values||[]).find(function(t){return si(t,e)})}function ai(t,e){var n,r,i,o,s,u,a,h,c,f,l=oi(t),p=oi(e);if(l!==p)return Qs(l,p);switch(l){case 0:return 0;case 1:return Qs(t.booleanValue,e.booleanValue);case 2:return h=e,(c=li(t.integerValue||t.doubleValue))<(f=li(h.integerValue||h.doubleValue))?-1:f<c?1:c===f?0:isNaN(c)?isNaN(f)?0:-1:1;case 3:return hi(t.timestampValue,e.timestampValue);case 4:return hi(ri(t),ri(e));case 5:return Qs(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=pi(o),a=pi(s),u.S(a);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Qs(n[i],r[i]);if(0!==o)return o}return Qs(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=Qs(li(n.latitude),li(r.latitude)))?i:Qs(li(n.longitude),li(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=ai(n[i],r[i]);if(o)return o}return Qs(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Qs(r[s],o[s]);if(0!==u)return u;var a=ai(n[r[s]],i[o[s]]);if(0!==a)return a}return Qs(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Bs()}}function hi(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Qs(t,e);var n=fi(t),r=fi(e),i=Qs(n.seconds,r.seconds);return 0!==i?i:Qs(n.nanos,r.nanos)}function ci(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=fi(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?pi(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,Qr.Z(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Bs();var t,e,n}(t)}function fi(t){if(zs(!!t),"string"!=typeof t)return{seconds:li(t.seconds),nanos:li(t.nanos)};var e,n=0,r=ii.exec(t);zs(!!r),r[1]&&(e=((e=r[1])+"000000000").substr(0,9),n=Number(e));var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:n}}function li(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function pi(t){return"string"==typeof t?Kr.fromBase64String(t):Kr.fromUint8Array(t)}function di(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.j()}}function yi(t){return t&&"integerValue"in t}function vi(t){return!!t&&"arrayValue"in t}function gi(t){return t&&"nullValue"in t}function mi(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function wi(t){return t&&"mapValue"in t}var bi=(Ei.prototype.ot=function(t,e){return n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},t&&(n.fields.__previous_value__=t),{mapValue:n};var n},Ei.prototype.at=function(t,e){return e},Ei.prototype.ut=function(t){return null},Ei.prototype.isEqual=function(t){return t instanceof Ei},Ei);function Ei(){}bi.instance=new bi;var Ii=(Ri.prototype.ot=function(t,e){return this.apply(t)},Ri.prototype.at=function(t,e){return this.apply(t)},Ri.prototype.apply=function(t){for(var n=Si(t),e=function(e){n.some(function(t){return si(t,e)})||n.push(e)},r=0,i=this.elements;r<i.length;r++)e(i[r]);return{arrayValue:{values:n}}},Ri.prototype.ut=function(t){return null},Ri.prototype.isEqual=function(t){return t instanceof Ri&&Xs(this.elements,t.elements,si)},Ri),Ai=(_i.prototype.ot=function(t,e){return this.apply(t)},_i.prototype.at=function(t,e){return this.apply(t)},_i.prototype.apply=function(t){for(var n=Si(t),e=function(e){n=n.filter(function(t){return!si(t,e)})},r=0,i=this.elements;r<i.length;r++)e(i[r]);return{arrayValue:{values:n}}},_i.prototype.ut=function(t){return null},_i.prototype.isEqual=function(t){return t instanceof _i&&Xs(this.elements,t.elements,si)},_i),Ti=(Ni.prototype.ot=function(t,e){var n=this.ut(t),r=this.asNumber(n)+this.asNumber(this.ct);return yi(n)&&yi(this.ct)?this.serializer.lt(r):this.serializer._t(r)},Ni.prototype.at=function(t,e){return e},Ni.prototype.ut=function(t){return yi(e=t)||e&&"doubleValue"in e?t:{integerValue:0};var e},Ni.prototype.isEqual=function(t){return t instanceof Ni&&si(this.ct,t.ct)},Ni.prototype.asNumber=function(t){return li(t.integerValue||t.doubleValue)},Ni);function Ni(t,e){this.serializer=t,this.ct=e}function _i(t){this.elements=t}function Ri(t){this.elements=t}function Si(t){return vi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Di(t,e){this.version=t,this.transformResults=e}var ki,Li,Oi,Vi,Mi,Pi=(no.prototype.ft=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].B(t))return!0;return!1},no.prototype.isEqual=function(t){return Xs(this.fields,t.fields,function(t,e){return t.isEqual(e)})},no),Ci=(eo.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},eo),Ui=(to.dt=function(){return new to},to.exists=function(t){return new to(void 0,t)},to.updateTime=function(t){return new to(t)},Object.defineProperty(to.prototype,"wt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),to.prototype.Tt=function(t){return void 0!==this.updateTime?t instanceof mo&&t.version.isEqual(this.updateTime):void 0===this.exists||this.exists===t instanceof mo},to.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},to),qi=($i.prototype.Et=function(t){},$i.It=function(t){return t instanceof mo?t.version:Lr.min()},$i),xi=(n(Ki,Mi=qi),Ki.prototype.at=function(t,e){this.Et(t);var n=e.version;return new mo(this.key,n,this.value,{hasCommittedMutations:!0})},Ki.prototype.ot=function(t,e,n){if(this.Et(t),!this.Rt.Tt(t))return t;var r=qi.It(t);return new mo(this.key,r,this.value,{At:!0})},Ki.prototype.Pt=function(t){return null},Ki.prototype.isEqual=function(t){return t instanceof Ki&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.Rt.isEqual(t.Rt)},Ki),Fi=(n(Zi,Vi=qi),Zi.prototype.at=function(t,e){if(this.Et(t),!this.Rt.Tt(t))return new bo(this.key,e.version);var n=this.pt(t);return new mo(this.key,e.version,n,{hasCommittedMutations:!0})},Zi.prototype.ot=function(t,e,n){if(this.Et(t),!this.Rt.Tt(t))return t;var r=qi.It(t),i=this.pt(t);return new mo(this.key,r,i,{At:!0})},Zi.prototype.Pt=function(t){return null},Zi.prototype.isEqual=function(t){return t instanceof Zi&&this.key.isEqual(t.key)&&this.Vt.isEqual(t.Vt)&&this.Rt.isEqual(t.Rt)},Zi.prototype.pt=function(t){var e=t instanceof mo?t.data():zi.empty();return this.yt(e)},Zi.prototype.yt=function(t){var n=this,r=new Hi(t);return this.Vt.fields.forEach(function(t){var e;t.M()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.gt()},Zi),ji=(n(Yi,Oi=qi),Yi.prototype.at=function(t,e){if(this.Et(t),zs(null!=e.transformResults),!this.Rt.Tt(t))return new bo(this.key,e.version);var n=this.bt(t),r=this.vt(t,e.transformResults),i=e.version,o=this.St(n.data(),r);return new mo(this.key,i,o,{hasCommittedMutations:!0})},Yi.prototype.ot=function(t,e,n){if(this.Et(t),!this.Rt.Tt(t))return t;var r=this.bt(t),i=this.Ct(n,t,e),o=this.St(r.data(),i);return new mo(this.key,r.version,o,{At:!0})},Yi.prototype.Pt=function(t){for(var e=null,n=0,r=this.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof mo?t.field(i.field):void 0,s=i.transform.ut(o||null);null!=s&&(e=null==e?(new Hi).set(i.field,s):e.set(i.field,s))}return e?e.gt():null},Yi.prototype.isEqual=function(t){return t instanceof Yi&&this.key.isEqual(t.key)&&Xs(this.fieldTransforms,t.fieldTransforms,function(t,e){return t.isEqual(e)})&&this.Rt.isEqual(t.Rt)},Yi.prototype.bt=function(t){return t},Yi.prototype.vt=function(t,e){var n=[];zs(this.fieldTransforms.length===e.length);for(var r=0;r<e.length;r++){var i=this.fieldTransforms[r],o=i.transform,s=null;t instanceof mo&&(s=t.field(i.field)),n.push(o.at(s,e[r]))}return n},Yi.prototype.Ct=function(t,e,n){for(var r=[],i=0,o=this.fieldTransforms;i<o.length;i++){var s=o[i],u=s.transform,a=null;e instanceof mo&&(a=e.field(s.field)),null===a&&n instanceof mo&&(a=n.field(s.field)),r.push(u.ot(a,t))}return r},Yi.prototype.St=function(t,e){for(var n=new Hi(t),r=0;r<this.fieldTransforms.length;r++){var i=this.fieldTransforms[r].field;n.set(i,e[r])}return n.gt()},Yi),Gi=(n(Ji,Li=qi),Ji.prototype.at=function(t,e){return this.Et(t),new wo(this.key,e.version,{hasCommittedMutations:!0})},Ji.prototype.ot=function(t,e,n){return this.Et(t),this.Rt.Tt(t)?new wo(this.key,Lr.min()):t},Ji.prototype.Pt=function(t){return null},Ji.prototype.isEqual=function(t){return t instanceof Ji&&this.key.isEqual(t.key)&&this.Rt.isEqual(t.Rt)},Ji),Bi=(n(Xi,ki=qi),Xi.prototype.at=function(t,e){Bs()},Xi.prototype.ot=function(t,e,n){Bs()},Xi.prototype.Pt=function(t){Bs()},Xi.prototype.isEqual=function(t){return t instanceof Xi&&this.key.isEqual(t.key)&&this.Rt.isEqual(t.Rt)},Xi),zi=(Qi.empty=function(){return new Qi({mapValue:{}})},Qi.prototype.field=function(t){if(t.M())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!wi(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.q()])||null},Qi.prototype.isEqual=function(t){return si(this.proto,t.proto)},Qi),Hi=(Wi.prototype.set=function(t,e){return this.Nt(t,e),this},Wi.prototype.delete=function(t){return this.Nt(t,null),this},Wi.prototype.Nt=function(t,e){for(var n=this.Ft,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map||(o=o&&10===oi(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),n=o}n.set(t.q(),e)},Wi.prototype.gt=function(){var t=this.$t(Hr.H,this.Ft);return null!=t?new zi(t):this.Dt},Wi.prototype.$t=function(r,t){var i=this,o=!1,e=this.Dt.field(r),s=wi(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.$t(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Wi);function Wi(t){void 0===t&&(t=zi.empty()),this.Dt=t,this.Ft=new Map}function Qi(t){this.proto=t}function Xi(t,e){var n=this;return(n=ki.call(this)||this).key=t,n.Rt=e,n.type=4,n}function Ji(t,e){var n=this;return(n=Li.call(this)||this).key=t,n.Rt=e,n.type=3,n}function Yi(t,e){var n=this;return(n=Oi.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Rt=Ui.exists(!0),n}function Zi(t,e,n,r){var i=this;return(i=Vi.call(this)||this).key=t,i.data=e,i.Vt=n,i.Rt=r,i.type=1,i}function Ki(t,e,n){var r=this;return(r=Mi.call(this)||this).key=t,r.value=e,r.Rt=n,r.type=0,r}function $i(){}function to(t,e){this.updateTime=t,this.exists=e}function eo(t,e){this.field=t,this.transform=e}function no(t){(this.fields=t).sort(Hr.N)}function ro(t){var u=[];return Yr(t.fields||{},function(t,e){var n=new Hr([t]);if(wi(e)){var r=ro(e.mapValue).fields;if(0===r.length)u.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];u.push(n.child(s))}}else u.push(n)}),new Pi(u)}function io(t,e){this.key=t,this.version=e}function oo(t){this.count=t}var so,uo,ao,ho,co,fo,lo,po,yo,vo,go,mo=(n(Ho,go=io),Ho.prototype.field=function(t){return this.Lt.field(t)},Ho.prototype.data=function(){return this.Lt},Ho.prototype.kt=function(){return this.Lt.proto},Ho.prototype.isEqual=function(t){return t instanceof Ho&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.At===t.At&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Lt.isEqual(t.Lt)},Ho.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Lt.toString()+", {hasLocalMutations: "+this.At+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Ho.prototype,"hasPendingWrites",{get:function(){return this.At||this.hasCommittedMutations},enumerable:!0,configurable:!0}),Ho),wo=(n(zo,vo=io),zo.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(zo.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),zo.prototype.isEqual=function(t){return t instanceof zo&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},zo),bo=(n(Bo,yo=io),Bo.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Bo.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),Bo.prototype.isEqual=function(t){return t instanceof Bo&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Bo),Eo=(Go.prototype.canonicalId=function(){var t;return null===this.Ot&&(t=this.path.j(),null!==this.collectionGroup&&(t+="|cg:"+this.collectionGroup),t+="|f:",t+=this.filters.map(function(t){return t.canonicalId()}).join(","),t+="|ob:",t+=this.orderBy.map(function(t){return t.canonicalId()}).join(","),ti(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.Ot=t),this.Ot},Go.prototype.toString=function(){var t=this.path.j();return null!==this.collectionGroup&&(t+=" collectionGroup="+this.collectionGroup),0<this.filters.length&&(t+=", filters: ["+this.filters.join(", ")+"]"),ti(this.limit)||(t+=", limit: "+this.limit),0<this.orderBy.length&&(t+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),"Target("+t+")"},Go.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(var n=0;n<this.filters.length;n++)if(!this.filters[n].isEqual(t.filters[n]))return!1;return this.collectionGroup===t.collectionGroup&&!!this.path.isEqual(t.path)&&!!(null!==this.startAt?this.startAt.isEqual(t.startAt):null===t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)},Go.prototype.qt=function(){return Qr.et(this.path)&&null===this.collectionGroup&&0===this.filters.length},Go),Io=(jo.Wt=function(t){return new jo(t)},Object.defineProperty(jo.prototype,"orderBy",{get:function(){if(null===this.Bt){this.Bt=[];var t=this.jt(),e=this.Gt();if(null!==t&&null===e)t.Y()||this.Bt.push(new ko(t)),this.Bt.push(new ko(Hr.X(),"asc"));else{for(var n,r=!1,i=0,o=this.Mt;i<o.length;i++){var s=o[i];this.Bt.push(s),s.field.Y()&&(r=!0)}r||(n=0<this.Mt.length?this.Mt[this.Mt.length-1].dir:"asc",this.Bt.push(new ko(Hr.X(),n)))}}return this.Bt},enumerable:!0,configurable:!0}),jo.prototype.Ht=function(t){var e=this.filters.concat([t]);return new jo(this.path,this.collectionGroup,this.Mt.slice(),e,this.limit,this.xt,this.startAt,this.endAt)},jo.prototype.Kt=function(t){var e=this.Mt.concat([t]);return new jo(this.path,this.collectionGroup,e,this.filters.slice(),this.limit,this.xt,this.startAt,this.endAt)},jo.prototype.zt=function(t){return new jo(this.path,this.collectionGroup,this.Mt.slice(),this.filters.slice(),t,"F",this.startAt,this.endAt)},jo.prototype.Yt=function(t){return new jo(this.path,this.collectionGroup,this.Mt.slice(),this.filters.slice(),t,"L",this.startAt,this.endAt)},jo.prototype.Xt=function(t){return new jo(this.path,this.collectionGroup,this.Mt.slice(),this.filters.slice(),this.limit,this.xt,t,this.endAt)},jo.prototype.Jt=function(t){return new jo(this.path,this.collectionGroup,this.Mt.slice(),this.filters.slice(),this.limit,this.xt,this.startAt,t)},jo.prototype.Zt=function(t){return new jo(t,null,this.Mt.slice(),this.filters.slice(),this.limit,this.xt,this.startAt,this.endAt)},jo.prototype.te=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.Mt.length||1===this.Mt.length&&this.Mt[0].field.Y())},jo.prototype.canonicalId=function(){return this.ee().canonicalId()+"|lt:"+this.xt},jo.prototype.toString=function(){return"Query(target="+this.ee().toString()+"; limitType="+this.xt+")"},jo.prototype.isEqual=function(t){return this.ee().isEqual(t.ee())&&this.xt===t.xt},jo.prototype.se=function(t,e){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],s=o.compare(t,e);if(0!==s)return s;n=n||o.field.Y()}return 0},jo.prototype.matches=function(t){return this.ie(t)&&this.ne(t)&&this.re(t)&&this.he(t)},jo.prototype.oe=function(){return!ti(this.limit)&&"F"===this.xt},jo.prototype.ae=function(){return!ti(this.limit)&&"L"===this.xt},jo.prototype.Gt=function(){return 0<this.Mt.length?this.Mt[0].field:null},jo.prototype.jt=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof Ao&&n.ue())return n.field}return null},jo.prototype.ce=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(r instanceof Ao&&0<=t.indexOf(r.op))return r.op}return null},jo.prototype.qt=function(){return this.ee().qt()},jo.prototype.le=function(){return null!==this.collectionGroup},jo.prototype.ee=function(){if(!this.Ut)if("F"===this.xt)this.Ut=new Eo(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var r=n[e],i="desc"===r.dir?"asc":"desc";t.push(new ko(r.field,i))}var o=this.endAt?new Do(this.endAt.position,!this.endAt.before):null,s=this.startAt?new Do(this.startAt.position,!this.startAt.before):null;this.Ut=new Eo(this.path,this.collectionGroup,t,this.filters,this.limit,o,s)}return this.Ut},jo.prototype.ie=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.tt(this.collectionGroup)&&this.path.B(e):Qr.et(this.path)?this.path.isEqual(e):this.path.U(e)},jo.prototype.ne=function(t){for(var e=0,n=this.Mt;e<n.length;e++){var r=n[e];if(!r.field.Y()&&null===t.field(r.field))return!1}return!0},jo.prototype.re=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},jo.prototype.he=function(t){return!(this.startAt&&!this.startAt._e(this.orderBy,t)||this.endAt&&this.endAt._e(this.orderBy,t))},jo.prototype.Qt=function(t){},jo),Ao=(n(Fo,po=function(){}),Fo.create=function(t,e,n){if(t.Y())return"in"===e?new No(t,n):new To(t,e,n);if(gi(n)){if("=="!==e)throw new Nr(Tr.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new Fo(t,e,n)}if(mi(n)){if("=="!==e)throw new Nr(Tr.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new Fo(t,e,n)}return"array-contains"===e?new _o(t,n):"in"===e?new Ro(t,n):"array-contains-any"===e?new So(t,n):new Fo(t,e,n)},Fo.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&oi(this.value)===oi(e)&&this.fe(ai(e,this.value))},Fo.prototype.fe=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return 0<t;case">=":return 0<=t;default:return Bs()}},Fo.prototype.ue=function(){return 0<=["<","<=",">",">="].indexOf(this.op)},Fo.prototype.canonicalId=function(){return this.field.j()+this.op.toString()+ci(this.value)},Fo.prototype.isEqual=function(t){return t instanceof Fo&&this.op===t.op&&this.field.isEqual(t.field)&&si(this.value,t.value)},Fo.prototype.toString=function(){return this.field.j()+" "+this.op+" "+ci(this.value)},Fo),To=(n(xo,lo=Ao),xo.prototype.matches=function(t){var e=Qr.N(t.key,this.key);return this.fe(e)},xo),No=(n(qo,fo=Ao),qo.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},qo),_o=(n(Uo,co=Ao),Uo.prototype.matches=function(t){var e=t.field(this.field);return vi(e)&&ui(e.arrayValue,this.value)},Uo),Ro=(n(Co,ho=Ao),Co.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&ui(this.value.arrayValue,e)},Co),So=(n(Po,ao=Ao),Po.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!vi(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return ui(e.value.arrayValue,t)})},Po),Do=(Mo.prototype.canonicalId=function(){return(this.before?"b":"a")+":"+this.position.map(ci).join(",")},Mo.prototype._e=function(t,e){for(var n=0,r=0;r<this.position.length;r++){var i=t[r],o=this.position[r],n=i.field.Y()?Qr.N(Qr.Z(o.referenceValue),e.key):ai(o,e.field(i.field));if("desc"===i.dir&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},Mo.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++)if(!si(this.position[e],t.position[e]))return!1;return!0},Mo),ko=(Vo.prototype.compare=function(t,e){var n,r,i,o,s=this.de?Qr.N(t.key,e.key):(n=this.field,r=e,i=t.field(n),o=r.field(n),null!==i&&null!==o?ai(i,o):Bs());switch(this.dir){case"asc":return s;case"desc":return-1*s;default:return Bs()}},Vo.prototype.canonicalId=function(){return this.field.j()+this.dir.toString()},Vo.prototype.toString=function(){return this.field.j()+" ("+this.dir+")"},Vo.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},Vo),Lo=(Oo.prototype.Ee=function(t){return new Oo(this.target,this.targetId,this.we,t,this.Te,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Oo.prototype.me=function(t,e){return new Oo(this.target,this.targetId,this.we,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Oo.prototype.Ie=function(t){return new Oo(this.target,this.targetId,this.we,this.sequenceNumber,this.Te,t,this.resumeToken)},Oo);function Oo(t,e,n,r,i,o,s){void 0===i&&(i=Lr.min()),void 0===o&&(o=Lr.min()),void 0===s&&(s=Kr.ht),this.target=t,this.targetId=e,this.we=n,this.sequenceNumber=r,this.Te=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Vo(t,e){this.field=t,void 0===e&&(e="asc"),this.dir=e,this.de=t.Y()}function Mo(t,e){this.position=t,this.before=e}function Po(t,e){return ao.call(this,t,"array-contains-any",e)||this}function Co(t,e){return ho.call(this,t,"in",e)||this}function Uo(t,e){return co.call(this,t,"array-contains",e)||this}function qo(t,e){var n=this;return(n=fo.call(this,t,"in",e)||this).keys=(e.arrayValue.values||[]).map(function(t){return Qr.Z(t.referenceValue)}),n}function xo(t,e,n){var r=this;return(r=lo.call(this,t,e,n)||this).key=Qr.Z(n.referenceValue),r}function Fo(t,e,n){var r=this;return(r=po.call(this)||this).field=t,r.op=e,r.value=n,r}function jo(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Mt=n,this.filters=r,this.limit=i,this.xt=o,this.startAt=s,this.endAt=u,this.Bt=null,this.Ut=null,this.startAt&&this.Qt(this.startAt),this.endAt&&this.Qt(this.endAt)}function Go(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Ot=null}function Bo(){return null!==yo&&yo.apply(this,arguments)||this}function zo(t,e,n){var r=this;return(r=vo.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Ho(t,e,n,r){var i=this;return(i=go.call(this,t,e)||this).Lt=n,i.At=!!r.At,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Wo(t){switch(t){case Tr.OK:return Bs();case Tr.CANCELLED:case Tr.UNKNOWN:case Tr.DEADLINE_EXCEEDED:case Tr.RESOURCE_EXHAUSTED:case Tr.INTERNAL:case Tr.UNAVAILABLE:case Tr.UNAUTHENTICATED:return;case Tr.INVALID_ARGUMENT:case Tr.NOT_FOUND:case Tr.ALREADY_EXISTS:case Tr.PERMISSION_DENIED:case Tr.FAILED_PRECONDITION:case Tr.ABORTED:case Tr.OUT_OF_RANGE:case Tr.UNIMPLEMENTED:case Tr.DATA_LOSS:return 1;default:return Bs()}}function Qo(t){if(void 0===t)return js("GRPC error has no .code"),Tr.UNKNOWN;switch(t){case so.OK:return Tr.OK;case so.CANCELLED:return Tr.CANCELLED;case so.UNKNOWN:return Tr.UNKNOWN;case so.DEADLINE_EXCEEDED:return Tr.DEADLINE_EXCEEDED;case so.RESOURCE_EXHAUSTED:return Tr.RESOURCE_EXHAUSTED;case so.INTERNAL:return Tr.INTERNAL;case so.UNAVAILABLE:return Tr.UNAVAILABLE;case so.UNAUTHENTICATED:return Tr.UNAUTHENTICATED;case so.INVALID_ARGUMENT:return Tr.INVALID_ARGUMENT;case so.NOT_FOUND:return Tr.NOT_FOUND;case so.ALREADY_EXISTS:return Tr.ALREADY_EXISTS;case so.PERMISSION_DENIED:return Tr.PERMISSION_DENIED;case so.FAILED_PRECONDITION:return Tr.FAILED_PRECONDITION;case so.ABORTED:return Tr.ABORTED;case so.OUT_OF_RANGE:return Tr.OUT_OF_RANGE;case so.UNIMPLEMENTED:return Tr.UNIMPLEMENTED;case so.DATA_LOSS:return Tr.DATA_LOSS;default:return Bs()}}(uo=so=so||{})[uo.OK=0]="OK",uo[uo.CANCELLED=1]="CANCELLED",uo[uo.UNKNOWN=2]="UNKNOWN",uo[uo.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",uo[uo.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",uo[uo.NOT_FOUND=5]="NOT_FOUND",uo[uo.ALREADY_EXISTS=6]="ALREADY_EXISTS",uo[uo.PERMISSION_DENIED=7]="PERMISSION_DENIED",uo[uo.UNAUTHENTICATED=16]="UNAUTHENTICATED",uo[uo.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",uo[uo.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",uo[uo.ABORTED=10]="ABORTED",uo[uo.OUT_OF_RANGE=11]="OUT_OF_RANGE",uo[uo.UNIMPLEMENTED=12]="UNIMPLEMENTED",uo[uo.INTERNAL=13]="INTERNAL",uo[uo.UNAVAILABLE=14]="UNAVAILABLE",uo[uo.DATA_LOSS=15]="DATA_LOSS";var Xo=($o.prototype.Re=function(t,e){return new $o(this.N,this.root.Re(t,e,this.N).Ae(null,null,Yo.Pe,null,null))},$o.prototype.remove=function(t){return new $o(this.N,this.root.remove(t,this.N).Ae(null,null,Yo.Pe,null,null))},$o.prototype.get=function(t){for(var e=this.root;!e.M();){var n=this.N(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},$o.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.M();){var r=this.N(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},$o.prototype.M=function(){return this.root.M()},Object.defineProperty($o.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),$o.prototype.Ve=function(){return this.root.Ve()},$o.prototype.pe=function(){return this.root.pe()},$o.prototype.ye=function(t){return this.root.ye(t)},$o.prototype.forEach=function(n){this.ye(function(t,e){return n(t,e),!1})},$o.prototype.toString=function(){var n=[];return this.ye(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},$o.prototype.ge=function(t){return this.root.ge(t)},$o.prototype.be=function(){return new Jo(this.root,null,this.N,!1)},$o.prototype.ve=function(t){return new Jo(this.root,t,this.N,!1)},$o.prototype.Se=function(){return new Jo(this.root,null,this.N,!0)},$o.prototype.Ce=function(t){return new Jo(this.root,t,this.N,!0)},$o),Jo=(Ko.prototype.Ne=function(){var t=this.Fe.pop(),e={key:t.key,value:t.value};if(this.De)for(t=t.left;!t.M();)this.Fe.push(t),t=t.right;else for(t=t.right;!t.M();)this.Fe.push(t),t=t.left;return e},Ko.prototype.$e=function(){return 0<this.Fe.length},Ko.prototype.Le=function(){if(0===this.Fe.length)return null;var t=this.Fe[this.Fe.length-1];return{key:t.key,value:t.value}},Ko),Yo=(Zo.prototype.Ae=function(t,e,n,r,i){return new Zo(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Zo.prototype.M=function(){return!1},Zo.prototype.ye=function(t){return this.left.ye(t)||t(this.key,this.value)||this.right.ye(t)},Zo.prototype.ge=function(t){return this.right.ge(t)||t(this.key,this.value)||this.left.ge(t)},Zo.prototype.min=function(){return this.left.M()?this:this.left.min()},Zo.prototype.Ve=function(){return this.min().key},Zo.prototype.pe=function(){return this.right.M()?this.key:this.right.pe()},Zo.prototype.Re=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.Ae(null,null,null,r.left.Re(t,e,n),null):0===i?r.Ae(null,e,null,null,null):r.Ae(null,null,null,null,r.right.Re(t,e,n))).ke()},Zo.prototype.Oe=function(){if(this.left.M())return Zo.EMPTY;var t=this;return t.left.qe()||t.left.left.qe()||(t=t.Me()),(t=t.Ae(null,null,null,t.left.Oe(),null)).ke()},Zo.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.M()||r.left.qe()||r.left.left.qe()||(r=r.Me()),r=r.Ae(null,null,null,r.left.remove(t,e),null);else{if(r.left.qe()&&(r=r.xe()),r.right.M()||r.right.qe()||r.right.left.qe()||(r=r.Be()),0===e(t,r.key)){if(r.right.M())return Zo.EMPTY;n=r.right.min(),r=r.Ae(n.key,n.value,null,null,r.right.Oe())}r=r.Ae(null,null,null,null,r.right.remove(t,e))}return r.ke()},Zo.prototype.qe=function(){return this.color},Zo.prototype.ke=function(){var t=this;return t.right.qe()&&!t.left.qe()&&(t=t.Ue()),t.left.qe()&&t.left.left.qe()&&(t=t.xe()),t.left.qe()&&t.right.qe()&&(t=t.Qe()),t},Zo.prototype.Me=function(){var t=this.Qe();return t.right.left.qe()&&(t=(t=(t=t.Ae(null,null,null,null,t.right.xe())).Ue()).Qe()),t},Zo.prototype.Be=function(){var t=this.Qe();return t.left.left.qe()&&(t=(t=t.xe()).Qe()),t},Zo.prototype.Ue=function(){var t=this.Ae(null,null,Zo.RED,null,this.right.left);return this.right.Ae(null,null,this.color,t,null)},Zo.prototype.xe=function(){var t=this.Ae(null,null,Zo.RED,this.left.right,null);return this.left.Ae(null,null,this.color,null,t)},Zo.prototype.Qe=function(){var t=this.left.Ae(null,null,!this.left.color,null,null),e=this.right.Ae(null,null,!this.right.color,null,null);return this.Ae(null,null,!this.color,t,e)},Zo.prototype.We=function(){var t=this.je();return Math.pow(2,t)<=this.size+1},Zo.prototype.je=function(){if(this.qe()&&this.left.qe())throw Bs();if(this.right.qe())throw Bs();var t=this.left.je();if(t!==this.right.je())throw Bs();return t+(this.qe()?0:1)},Zo);function Zo(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Zo.RED,this.left=null!=r?r:Zo.EMPTY,this.right=null!=i?i:Zo.EMPTY,this.size=this.left.size+1+this.right.size}function Ko(t,e,n,r){this.De=r,this.Fe=[];for(var i=1;!t.M();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.De?t.left:t.right;else{if(0===i){this.Fe.push(t);break}this.Fe.push(t),t=this.De?t.right:t.left}}function $o(t,e){this.N=t,this.root=e||Yo.EMPTY}function ts(){this.size=0}Yo.EMPTY=null,Yo.RED=!0,Yo.Pe=!1,Yo.EMPTY=(Object.defineProperty(ts.prototype,"key",{get:function(){throw Bs()},enumerable:!0,configurable:!0}),Object.defineProperty(ts.prototype,"value",{get:function(){throw Bs()},enumerable:!0,configurable:!0}),Object.defineProperty(ts.prototype,"color",{get:function(){throw Bs()},enumerable:!0,configurable:!0}),Object.defineProperty(ts.prototype,"left",{get:function(){throw Bs()},enumerable:!0,configurable:!0}),Object.defineProperty(ts.prototype,"right",{get:function(){throw Bs()},enumerable:!0,configurable:!0}),ts.prototype.Ae=function(t,e,n,r,i){return this},ts.prototype.Re=function(t,e,n){return new Yo(t,e)},ts.prototype.remove=function(t,e){return this},ts.prototype.M=function(){return!0},ts.prototype.ye=function(t){return!1},ts.prototype.ge=function(t){return!1},ts.prototype.Ve=function(){return null},ts.prototype.pe=function(){return null},ts.prototype.qe=function(){return!1},ts.prototype.We=function(){return!0},ts.prototype.je=function(){return 0},new ts);var es=(os.prototype.has=function(t){return null!==this.data.get(t)},os.prototype.first=function(){return this.data.Ve()},os.prototype.last=function(){return this.data.pe()},Object.defineProperty(os.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),os.prototype.indexOf=function(t){return this.data.indexOf(t)},os.prototype.forEach=function(n){this.data.ye(function(t,e){return n(t),!1})},os.prototype.Ge=function(t,e){for(var n=this.data.ve(t[0]);n.$e();){var r=n.Ne();if(0<=this.N(r.key,t[1]))return;e(r.key)}},os.prototype.He=function(t,e){for(var n=void 0!==e?this.data.ve(e):this.data.be();n.$e();)if(!t(n.Ne().key))return},os.prototype.Ke=function(t){var e=this.data.ve(t);return e.$e()?e.Ne().key:null},os.prototype.be=function(){return new ns(this.data.be())},os.prototype.ve=function(t){return new ns(this.data.ve(t))},os.prototype.add=function(t){return this.Ae(this.data.remove(t).Re(t,!0))},os.prototype.delete=function(t){return this.has(t)?this.Ae(this.data.remove(t)):this},os.prototype.M=function(){return this.data.M()},os.prototype.ze=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},os.prototype.isEqual=function(t){if(!(t instanceof os))return!1;if(this.size!==t.size)return!1;for(var e=this.data.be(),n=t.data.be();e.$e();){var r=e.Ne().key,i=n.Ne().key;if(0!==this.N(r,i))return!1}return!0},os.prototype.W=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},os.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},os.prototype.Ae=function(t){var e=new os(this.N);return e.data=t,e},os),ns=(is.prototype.Ne=function(){return this.Ye.Ne().key},is.prototype.$e=function(){return this.Ye.$e()},is),rs=new Xo(Qr.N);function is(t){this.Ye=t}function os(t){this.N=t,this.data=new Xo(this.N)}var ss=new Xo(Qr.N);var us=new Xo(Qr.N);var as=new es(Qr.N);function hs(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=as,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var cs=new es(Qs);function fs(t,e,n,r){this.ms=t,this.removedTargetIds=e,this.key=n,this.Is=r}function ls(t,e){this.targetId=t,this.Rs=e}function ps(t,e,n,r){void 0===n&&(n=Kr.ht),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}var ds=(Rs.Ze=function(t){return new Rs(t.N)},Rs.prototype.has=function(t){return null!=this.Xe.get(t)},Rs.prototype.get=function(t){return this.Xe.get(t)},Rs.prototype.first=function(){return this.Je.Ve()},Rs.prototype.last=function(){return this.Je.pe()},Rs.prototype.M=function(){return this.Je.M()},Rs.prototype.indexOf=function(t){var e=this.Xe.get(t);return e?this.Je.indexOf(e):-1},Object.defineProperty(Rs.prototype,"size",{get:function(){return this.Je.size},enumerable:!0,configurable:!0}),Rs.prototype.forEach=function(n){this.Je.ye(function(t,e){return n(t),!1})},Rs.prototype.add=function(t){var e=this.delete(t.key);return e.Ae(e.Xe.Re(t.key,t),e.Je.Re(t,null))},Rs.prototype.delete=function(t){var e=this.get(t);return e?this.Ae(this.Xe.remove(t),this.Je.remove(e)):this},Rs.prototype.isEqual=function(t){if(!(t instanceof Rs))return!1;if(this.size!==t.size)return!1;for(var e=this.Je.be(),n=t.Je.be();e.$e();){var r=e.Ne().key,i=n.Ne().key;if(!r.isEqual(i))return!1}return!0},Rs.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Rs.prototype.Ae=function(t,e){var n=new Rs;return n.N=this.N,n.Xe=t,n.Je=e,n},Rs),ys=(_s.prototype.track=function(t){var e=t.doc.key,n=this.ts.get(e);!n||0!==t.type&&3===n.type?this.ts=this.ts.Re(e,t):3===t.type&&1!==n.type?this.ts=this.ts.Re(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ts=this.ts.Re(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ts=this.ts.Re(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ts=this.ts.remove(e):1===t.type&&2===n.type?this.ts=this.ts.Re(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ts=this.ts.Re(e,{type:2,doc:t.doc}):Bs()},_s.prototype.es=function(){var n=[];return this.ts.ye(function(t,e){n.push(e)}),n},_s),vs=(Ns.os=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Ns(t,e,ds.Ze(e),i,n,r,!0,!1)},Object.defineProperty(Ns.prototype,"hasPendingWrites",{get:function(){return!this.ns.M()},enumerable:!0,configurable:!0}),Ns.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.rs===t.rs&&this.ns.isEqual(t.ns)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.ss.isEqual(t.ss)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Ns),gs=(Ts._s=function(t,e){var n=new Map;return n.set(t,ms.fs(t,e)),new Ts(Lr.min(),n,cs,rs,hs())},Ts),ms=(As.fs=function(t,e){return new As(Kr.ht,e,hs(),hs(),hs())},As),ws=(Object.defineProperty(Is.prototype,"ds",{get:function(){return this.ps},enumerable:!0,configurable:!0}),Object.defineProperty(Is.prototype,"resumeToken",{get:function(){return this.Vs},enumerable:!0,configurable:!0}),Object.defineProperty(Is.prototype,"gs",{get:function(){return 0!==this.As},enumerable:!0,configurable:!0}),Object.defineProperty(Is.prototype,"bs",{get:function(){return this.ys},enumerable:!0,configurable:!0}),Is.prototype.vs=function(t){0<t.rt()&&(this.ys=!0,this.Vs=t)},Is.prototype.Ss=function(){var n=hs(),r=hs(),i=hs();return this.Ps.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Bs()}}),new ms(this.Vs,this.ps,n,r,i)},Is.prototype.Cs=function(){this.ys=!1,this.Ps=Ds()},Is.prototype.Ds=function(t,e){this.ys=!0,this.Ps=this.Ps.Re(t,e)},Is.prototype.Fs=function(t){this.ys=!0,this.Ps=this.Ps.remove(t)},Is.prototype.Ns=function(){this.As+=1},Is.prototype.$s=function(){--this.As},Is.prototype.Ls=function(){this.ys=!0,this.ps=!0},Is),bs=(Es.prototype.Bs=function(t){for(var e=0,n=t.ms;e<n.length;e++){var r=n[e];t.Is instanceof mo?this.Us(r,t.Is):t.Is instanceof wo&&this.Qs(r,t.key,t.Is)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Qs(s,t.key,t.Is)}},Es.prototype.Ws=function(n){var r=this;this.js(n,function(t){var e=r.Gs(t);switch(n.state){case 0:r.Hs(t)&&e.vs(n.resumeToken);break;case 1:e.$s(),e.gs||e.Cs(),e.vs(n.resumeToken);break;case 2:e.$s(),e.gs||r.removeTarget(t);break;case 3:r.Hs(t)&&(e.Ls(),e.vs(n.resumeToken));break;case 4:r.Hs(t)&&(r.Ks(t),e.vs(n.resumeToken));break;default:Bs()}})},Es.prototype.js=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Os.forEach(function(t,e){r.Hs(e)&&n(e)})},Es.prototype.zs=function(t){var e,n,r=t.targetId,i=t.Rs.count,o=this.Ys(r);o&&((e=o.target).qt()?0===i?(n=new Qr(e.path),this.Qs(r,n,new wo(n,Lr.min()))):zs(1===i):this.Xs(r)!==i&&(this.Ks(r),this.xs=this.xs.add(r)))},Es.prototype.Js=function(i){var o=this,s=new Map;this.Os.forEach(function(t,e){var n,r=o.Ys(e);r&&(t.ds&&r.target.qt()&&(n=new Qr(r.target.path),null!==o.qs.get(n)||o.Zs(e,n)||o.Qs(e,n,new wo(n,i))),t.bs&&(s.set(e,t.Ss()),t.Cs()))});var r=hs();this.Ms.forEach(function(t,e){var n=!0;e.He(function(t){var e=o.Ys(t);return!e||2===e.we||(n=!1)}),n&&(r=r.add(t))});var t=new gs(i,s,this.xs,this.qs,r);return this.qs=rs,this.Ms=Ss(),this.xs=new es(Qs),t},Es.prototype.Us=function(t,e){var n;this.Hs(t)&&(n=this.Zs(t,e.key)?2:0,this.Gs(t).Ds(e.key,n),this.qs=this.qs.Re(e.key,e),this.Ms=this.Ms.Re(e.key,this.ti(e.key).add(t)))},Es.prototype.Qs=function(t,e,n){var r;this.Hs(t)&&(r=this.Gs(t),this.Zs(t,e)?r.Ds(e,1):r.Fs(e),this.Ms=this.Ms.Re(e,this.ti(e).delete(t)),n&&(this.qs=this.qs.Re(e,n)))},Es.prototype.removeTarget=function(t){this.Os.delete(t)},Es.prototype.Xs=function(t){var e=this.Gs(t).Ss();return this.ks.ei(t).size+e.ws.size-e.Es.size},Es.prototype.Ns=function(t){this.Gs(t).Ns()},Es.prototype.Gs=function(t){var e=this.Os.get(t);return e||(e=new ws,this.Os.set(t,e)),e},Es.prototype.ti=function(t){var e=this.Ms.get(t);return e||(e=new es(Qs),this.Ms=this.Ms.Re(t,e)),e},Es.prototype.Hs=function(t){var e=null!==this.Ys(t);return e||Fs("WatchChangeAggregator","Detected inactive target",t),e},Es.prototype.Ys=function(t){var e=this.Os.get(t);return e&&e.gs?null:this.ks.si(t)},Es.prototype.Ks=function(e){var n=this;this.Os.set(e,new ws),this.ks.ei(e).forEach(function(t){n.Qs(e,t,null)})},Es.prototype.Zs=function(t,e){return this.ks.ei(t).has(e)},Es);function Es(t){this.ks=t,this.Os=new Map,this.qs=rs,this.Ms=Ss(),this.xs=new es(Qs)}function Is(){this.As=0,this.Ps=Ds(),this.Vs=Kr.ht,this.ps=!1,this.ys=!0}function As(t,e,n,r,i){this.resumeToken=t,this.ds=e,this.ws=n,this.Ts=r,this.Es=i}function Ts(t,e,n,r,i){this.Te=t,this.as=e,this.us=n,this.cs=r,this.ls=i}function Ns(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.ss=n,this.docChanges=r,this.ns=i,this.fromCache=o,this.rs=s,this.hs=u}function _s(){this.ts=new Xo(Qr.N)}function Rs(n){this.N=n?function(t,e){return n(t,e)||Qr.N(t.key,e.key)}:function(t,e){return Qr.N(t.key,e.key)},this.Xe=ss,this.Je=new Xo(this.N)}function Ss(){return new Xo(Qr.N)}function Ds(){return new Xo(Qr.N)}var ks={asc:"ASCENDING",desc:"DESCENDING"},Ls={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Os=(Vs.prototype.ni=function(t){var e=void 0===t.code?Tr.UNKNOWN:Qo(t.code);return new Nr(e,t.message||"")},Vs.prototype.ri=function(t){return this.options.hi||ti(t)?t:{value:t}},Vs.prototype.oi=function(t){var e;return ti(e="object"==typeof t?t.value:t)?null:e},Vs.prototype.lt=function(t){return{integerValue:""+t}},Vs.prototype._t=function(t){if(this.options.hi){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ei(t)?"-0":t}},Vs.prototype.ai=function(t){return"number"==typeof(e=t)&&Number.isInteger(e)&&!ei(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER?this.lt(t):this._t(t);var e},Vs.prototype.D=function(t){return this.options.hi?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}},Vs.prototype.v=function(t){var e=fi(t);return new kr(e.seconds,e.nanos)},Vs.prototype.ui=function(t){return this.options.hi?t.toBase64():t.toUint8Array()},Vs.prototype.ci=function(t){return this.options.hi?(zs(void 0===t||"string"==typeof t),Kr.fromBase64String(t||"")):(zs(void 0===t||t instanceof Uint8Array),Kr.fromUint8Array(t||new Uint8Array))},Vs.prototype.toVersion=function(t){return this.D(t.D())},Vs.prototype.fromVersion=function(t){return zs(!!t),Lr.v(this.v(t))},Vs.prototype.li=function(t,e){return this._i(e||this.ii).child("documents").child(t).j()},Vs.prototype.fi=function(t){var e=Vr.G(t);return zs(Ms(e)),e},Vs.prototype.di=function(t){return this.li(t.path)},Vs.prototype.Z=function(t){var e=this.fi(t);return zs(e.get(1)===this.ii.projectId),zs(!e.get(3)&&!this.ii.database||e.get(3)===this.ii.database),new Qr(this.wi(e))},Vs.prototype.Ti=function(t){return this.li(t)},Vs.prototype.Ei=function(t){var e=this.fi(t);return 4===e.length?Vr.H:this.wi(e)},Object.defineProperty(Vs.prototype,"mi",{get:function(){return new Vr(["projects",this.ii.projectId,"databases",this.ii.database]).j()},enumerable:!0,configurable:!0}),Vs.prototype._i=function(t){return new Vr(["projects",t.projectId,"databases",t.database])},Vs.prototype.wi=function(t){return zs(4<t.length&&"documents"===t.get(4)),t.L(5)},Vs.prototype.Ii=function(t,e){return{name:this.di(t),fields:e.proto.mapValue.fields}},Vs.prototype.Ri=function(t){return{name:this.di(t.key),fields:t.kt().mapValue.fields,updateTime:this.D(t.version.D())}},Vs.prototype.Ai=function(t,e){var n=this.Z(t.name),r=this.fromVersion(t.updateTime),i=new zi({mapValue:{fields:t.fields}});return new mo(n,r,i,{hasCommittedMutations:!!e})},Vs.prototype.Pi=function(t){zs(!!t.found),t.found.name,t.found.updateTime;var e=this.Z(t.found.name),n=this.fromVersion(t.found.updateTime),r=new zi({mapValue:{fields:t.found.fields}});return new mo(e,n,r,{})},Vs.prototype.Vi=function(t){zs(!!t.missing),zs(!!t.readTime);var e=this.Z(t.missing),n=this.fromVersion(t.readTime);return new wo(e,n)},Vs.prototype.pi=function(t){return"found"in t?this.Pi(t):"missing"in t?this.Vi(t):Bs()},Vs.prototype.yi=function(t){if("targetChange"in t){t.targetChange;var e=this.gi(t.targetChange.targetChangeType||"NO_CHANGE"),n=t.targetChange.targetIds||[],r=this.ci(t.targetChange.resumeToken),i=t.targetChange.cause,o=new ps(e,n,r,i&&this.ni(i)||null)}else if("documentChange"in t){t.documentChange;var s=t.documentChange;s.document,s.document.name,s.document.updateTime;var u=this.Z(s.document.name),a=this.fromVersion(s.document.updateTime),h=new zi({mapValue:{fields:s.document.fields}}),c=new mo(u,a,h,{});o=new fs(s.targetIds||[],s.removedTargetIds||[],c.key,c)}else if("documentDelete"in t){t.documentDelete;var f=t.documentDelete;f.document;var l=this.Z(f.document),p=f.readTime?this.fromVersion(f.readTime):Lr.min(),d=new wo(l,p);o=new fs([],f.removedTargetIds||[],d.key,d)}else if("documentRemove"in t){t.documentRemove;var y=t.documentRemove;y.document;var v=this.Z(y.document);o=new fs([],y.removedTargetIds||[],v,null)}else{if(!("filter"in t))return Bs();t.filter;var g=t.filter;g.targetId;var m=new oo(g.count||0);o=new ls(g.targetId,m)}return o},Vs.prototype.gi=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Bs()},Vs.prototype.bi=function(t){if(!("targetChange"in t))return Lr.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Lr.min():this.fromVersion(e.readTime)},Vs.prototype.vi=function(t){var e,n=this;if(t instanceof xi)e={update:this.Ii(t.key,t.value)};else if(t instanceof Gi)e={delete:this.di(t.key)};else if(t instanceof Fi)e={update:this.Ii(t.key,t.data),updateMask:this.Si(t.Vt)};else if(t instanceof ji)e={transform:{document:this.di(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.Ci(t)})}};else{if(!(t instanceof Bi))return Bs();e={verify:this.di(t.key)}}return t.Rt.wt||(e.currentDocument=this.Di(t.Rt)),e},Vs.prototype.Fi=function(t){var e=this,n=t.currentDocument?this.Ni(t.currentDocument):Ui.dt();if(t.update){t.update.name;var r=this.Z(t.update.name),i=new zi({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=this.$i(t.updateMask);return new Fi(r,i,o,n)}return new xi(r,i,n)}if(t.delete){var s=this.Z(t.delete);return new Gi(s,n)}if(t.transform){var u=this.Z(t.transform.document),a=t.transform.fieldTransforms.map(function(t){return e.Li(t)});return zs(!0===n.exists),new ji(u,a)}if(t.verify){var h=this.Z(t.verify);return new Bi(h,n)}return Bs()},Vs.prototype.Di=function(t){return void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Bs()},Vs.prototype.Ni=function(t){return void 0!==t.updateTime?Ui.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?Ui.exists(t.exists):Ui.dt()},Vs.prototype.ki=function(t,e){var n=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e);n.isEqual(Lr.min())&&(n=this.fromVersion(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new Di(n,r)},Vs.prototype.Oi=function(t,e){var n=this;return t&&0<t.length?(zs(void 0!==e),t.map(function(t){return n.ki(t,e)})):[]},Vs.prototype.Ci=function(t){var e=t.transform;if(e instanceof bi)return{fieldPath:t.field.j(),setToServerValue:"REQUEST_TIME"};if(e instanceof Ii)return{fieldPath:t.field.j(),appendMissingElements:{values:e.elements}};if(e instanceof Ai)return{fieldPath:t.field.j(),removeAllFromArray:{values:e.elements}};if(e instanceof Ti)return{fieldPath:t.field.j(),increment:e.ct};throw Bs()},Vs.prototype.Li=function(t){var e,n,r=null;"setToServerValue"in t?(zs("REQUEST_TIME"===t.setToServerValue),r=bi.instance):"appendMissingElements"in t?(e=t.appendMissingElements.values||[],r=new Ii(e)):"removeAllFromArray"in t?(n=t.removeAllFromArray.values||[],r=new Ai(n)):"increment"in t?r=new Ti(this,t.increment):Bs();var i=Hr.J(t.fieldPath);return new Ci(i,r)},Vs.prototype.qi=function(t){return{documents:[this.Ti(t.path)]}},Vs.prototype.Mi=function(t){zs(1===t.documents.length);var e=t.documents[0];return Io.Wt(this.Ei(e)).ee()},Vs.prototype.xi=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(e.parent=this.Ti(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=this.Ti(n.k()),e.structuredQuery.from=[{collectionId:n.q()}]);var r=this.Bi(t.filters);r&&(e.structuredQuery.where=r);var i=this.Ui(t.orderBy);i&&(e.structuredQuery.orderBy=i);var o=this.ri(t.limit);return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.Qi(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.Qi(t.endAt)),e},Vs.prototype.Wi=function(t){var e,n=this.Ei(t.parent),r=t.structuredQuery,i=r.from?r.from.length:0,o=null;0<i&&(zs(1===i),(e=r.from[0]).allDescendants?o=e.collectionId:n=n.child(e.collectionId));var s=[];r.where&&(s=this.ji(r.where));var u=[];r.orderBy&&(u=this.Gi(r.orderBy));var a=null;r.limit&&(a=this.oi(r.limit));var h=null;r.startAt&&(h=this.Hi(r.startAt));var c=null;return r.endAt&&(c=this.Hi(r.endAt)),new Io(n,o,u,s,a,"F",h,c).ee()},Vs.prototype.Ki=function(t){var e=this.zi(t.we);return null==e?null:{"goog-listen-tags":e}},Vs.prototype.zi=function(t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Bs()}},Vs.prototype.ee=function(t){var e,n=t.target;return(e=n.qt()?{documents:this.qi(n)}:{query:this.xi(n)}).targetId=t.targetId,0<t.resumeToken.rt()&&(e.resumeToken=this.ui(t.resumeToken)),e},Vs.prototype.Bi=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof Ao?e.Yi(t):Bs()});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},Vs.prototype.ji=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.Xi(t)]:void 0!==t.fieldFilter?[this.Ji(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.ji(t)}).reduce(function(t,e){return t.concat(e)}):Bs():[]},Vs.prototype.Ui=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.Zi(t)})},Vs.prototype.Gi=function(t){var e=this;return t.map(function(t){return e.tn(t)})},Vs.prototype.Qi=function(t){return{before:t.before,values:t.position}},Vs.prototype.Hi=function(t){var e=!!t.before,n=t.values||[];return new Do(n,e)},Vs.prototype.en=function(t){return ks[t]},Vs.prototype.sn=function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}},Vs.prototype.nn=function(t){return Ls[t]},Vs.prototype.rn=function(t){switch(t){case"EQUAL":return"==";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Bs()}},Vs.prototype.hn=function(t){return{fieldPath:t.j()}},Vs.prototype.on=function(t){return Hr.J(t.fieldPath)},Vs.prototype.Zi=function(t){return{field:this.hn(t.field),direction:this.en(t.dir)}},Vs.prototype.tn=function(t){return new ko(this.on(t.field),this.sn(t.direction))},Vs.prototype.Ji=function(t){return Ao.create(this.on(t.fieldFilter.field),this.rn(t.fieldFilter.op),t.fieldFilter.value)},Vs.prototype.Yi=function(t){if("=="===t.op){if(mi(t.value))return{unaryFilter:{field:this.hn(t.field),op:"IS_NAN"}};if(gi(t.value))return{unaryFilter:{field:this.hn(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.hn(t.field),op:this.nn(t.op),value:t.value}}},Vs.prototype.Xi=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.on(t.unaryFilter.field);return Ao.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=this.on(t.unaryFilter.field);return Ao.create(n,"==",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Bs()}},Vs.prototype.Si=function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.j())}),{fieldPaths:e}},Vs.prototype.$i=function(t){var e=t.fieldPaths||[];return new Pi(e.map(function(t){return Hr.J(t)}))},Vs);function Vs(t,e){this.ii=t,this.options=e}function Ms(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var Ps=(Us.an=function(t){Us.platform&&Bs(),Us.platform=t},Us.nt=function(){return Us.platform||Bs(),Us.platform},Us),Cs=new c("@firebase/firestore");function Us(){}function qs(){return Cs.logLevel}function xs(t){Cs.logLevel=t}function Fs(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Cs.logLevel<=u.DEBUG&&(e=n.map(Gs),Cs.debug.apply(Cs,i(["Firestore ("+mr+"): "+t],e)))}function js(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Cs.logLevel<=u.ERROR&&(e=n.map(Gs),Cs.error.apply(Cs,i(["Firestore ("+mr+"): "+t],e)))}function Gs(t){if("string"==typeof t)return t;var e=Ps.nt();try{return e.un(t)}catch(e){return t}}function Bs(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+mr+") INTERNAL ASSERTION FAILED: "+t;throw js(e),new Error(e)}function zs(t){t||Bs()}var Hs=(Ws.cn=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Ps.nt().ln(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Ws);function Ws(){}function Qs(t,e){return t<e?-1:e<t?1:0}function Xs(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Js(t,e,n,r,i){this.ii=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var Ys=(Object.defineProperty(fu.prototype,"_n",{get:function(){return"(default)"===this.database},enumerable:!0,configurable:!0}),fu.prototype.isEqual=function(t){return t instanceof fu&&t.projectId===this.projectId&&t.database===this.database},fu.prototype.S=function(t){return Qs(this.projectId,t.projectId)||Qs(this.database,t.database)},fu),Zs=(cu.prototype.get=function(t){var e=this.fn(t),n=this.dn[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(s.isEqual(t))return u}},cu.prototype.has=function(t){return void 0!==this.get(t)},cu.prototype.set=function(t,e){var n=this.fn(t),r=this.dn[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(t))return void(r[i]=[t,e]);r.push([t,e])}else this.dn[n]=[[t,e]]},cu.prototype.delete=function(t){var e=this.fn(t),n=this.dn[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(t))return 1===n.length?delete this.dn[e]:n.splice(r,1),!0;return!1},cu.prototype.forEach=function(u){Yr(this.dn,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];u(o,s)}})},cu.prototype.M=function(){return Zr(this.dn)},cu),Ks=(hu.prototype.at=function(t,e,n){for(var r=n.Tn,i=0;i<this.mutations.length;i++){var o,s=this.mutations[i];s.key.isEqual(t)&&(o=r[i],e=s.at(e,o))}return e},hu.prototype.ot=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=i.ot(e,e,this.wn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=a.ot(e,o,this.wn))}return e},hu.prototype.En=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ot(t.key,n.get(t.key));e&&(i=i.Re(t.key,e))}),i},hu.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},hs())},hu.prototype.isEqual=function(t){return this.batchId===t.batchId&&Xs(this.mutations,t.mutations,function(t,e){return t.isEqual(e)})&&Xs(this.baseMutations,t.baseMutations,function(t,e){return t.isEqual(e)})},hu),$s=(au.from=function(t,e,n,r){zs(t.mutations.length===n.length);for(var i=us,o=t.mutations,s=0;s<o.length;s++)i=i.Re(o[s].key,n[s].version);return new au(t,e,n,r,i)},au),tu=(uu.prototype.catch=function(t){return this.next(void 0,t)},uu.prototype.next=function(r,i){var o=this;return this.Vn&&Bs(),this.Vn=!0,this.Pn?this.error?this.pn(i,this.error):this.yn(r,this.result):new uu(function(e,n){o.Rn=function(t){o.yn(r,t).next(e,n)},o.An=function(t){o.pn(i,t).next(e,n)}})},uu.prototype.gn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},uu.prototype.bn=function(t){try{var e=t();return e instanceof uu?e:uu.resolve(e)}catch(t){return uu.reject(t)}},uu.prototype.yn=function(t,e){return t?this.bn(function(){return t(e)}):uu.resolve(e)},uu.prototype.pn=function(t,e){return t?this.bn(function(){return t(e)}):uu.reject(e)},uu.resolve=function(n){return new uu(function(t,e){t(n)})},uu.reject=function(n){return new uu(function(t,e){e(n)})},uu.vn=function(t){return new uu(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},uu.Sn=function(t){for(var n=uu.resolve(!1),e=function(e){n=n.next(function(t){return t?uu.resolve(t):e()})},r=0,i=t;r<i.length;r++)e(i[r]);return n},uu.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.vn(i)},uu),eu=(su.prototype.Nn=function(e,n){var r=this;return this.Dn.$n(e,n).next(function(t){return r.Ln(e,n,t)})},su.prototype.Ln=function(t,r,i){return this.Cn.kn(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ot(r,t);return t})},su.prototype.On=function(t,e,i){var o=rs;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ot(t,e);o=o.Re(t,e)}),o},su.prototype.qn=function(e,t){var n=this;return this.Cn.getEntries(e,t).next(function(t){return n.Mn(e,t)})},su.prototype.Mn=function(r,i){var o=this;return this.Dn.xn(r,i).next(function(t){var e=o.On(r,i,t),n=rs;return e.forEach(function(t,e){e=e||new wo(t,Lr.min()),n=n.Re(t,e)}),n})},su.prototype.Bn=function(t,e,n){return e.qt()?this.Un(t,e.path):e.le()?this.Qn(t,e,n):this.Wn(t,e,n)},su.prototype.Un=function(t,e){return this.Nn(t,new Qr(e)).next(function(t){var e=ss;return t instanceof mo&&(e=e.Re(t.key,t)),e})},su.prototype.Qn=function(n,r,i){var o=this,s=r.collectionGroup,u=ss;return this.Fn.jn(n,s).next(function(t){return tu.forEach(t,function(t){var e=r.Zt(t.child(s));return o.Wn(n,e,i).next(function(t){t.forEach(function(t,e){u=u.Re(t,e)})})}).next(function(){return u})})},su.prototype.Wn=function(e,n,t){var c,f,r=this;return this.Cn.Bn(e,n,t).next(function(t){return c=t,r.Dn.Gn(e,n)}).next(function(t){return f=t,r.Hn(e,f,c).next(function(t){c=t;for(var e=0,n=f;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),h=s.ot(a,a,r.wn);c=h instanceof mo?c.Re(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){n.matches(e)||(c=c.remove(t))}),c})},su.prototype.Hn=function(t,e,n){for(var r=hs(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Fi&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.Cn.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof mo&&(h=h.Re(t,e))}),h})},su),nu=(ou.Yn=function(t,e){for(var n=hs(),r=hs(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new ou(t,e.fromCache,n,r)},ou),ru=(iu.prototype.Jn=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},iu.prototype.next=function(){var t=++this.previousValue;return this.Zn&&this.Zn(t),t},iu);function iu(t,e){var n=this;this.previousValue=t,e&&(e.Xn=function(t){return n.Jn(t)},this.Zn=function(t){return e.tr(t)})}function ou(t,e,n,r){this.targetId=t,this.fromCache=e,this.Kn=n,this.zn=r}function su(t,e,n){this.Cn=t,this.Dn=e,this.Fn=n}function uu(t){var e=this;this.Rn=null,this.An=null,this.result=void 0,this.error=void 0,this.Pn=!1,this.Vn=!1,t(function(t){e.Pn=!0,e.result=t,e.Rn&&e.Rn(t)},function(t){e.Pn=!0,e.error=t,e.An&&e.An(t)})}function au(t,e,n,r,i){this.batch=t,this.mn=e,this.Tn=n,this.streamToken=r,this.In=i}function hu(t,e,n,r){this.batchId=t,this.wn=e,this.baseMutations=n,this.mutations=r}function cu(t){this.fn=t,this.dn={}}function fu(t,e){this.projectId=t,this.database=e||"(default)"}function lu(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}ru.er=-1;var pu=(bu.prototype.reset=function(){this.or=0},bu.prototype.cr=function(){this.or=this.hr},bu.prototype.lr=function(t){var e=this;this.cancel();var n=Math.floor(this.or+this._r()),r=Math.max(0,Date.now()-this.ur),i=Math.max(0,n-r);0<i&&Fs("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.or+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.ar=this.sr.dr(this.ir,i,function(){return e.ur=Date.now(),t()}),this.or*=this.rr,this.or<this.nr&&(this.or=this.nr),this.or>this.hr&&(this.or=this.hr)},bu.prototype.cancel=function(){null!==this.ar&&(this.ar.cancel(),this.ar=null)},bu.prototype._r=function(){return(Math.random()-.5)*this.or},bu),du=(wu.prototype.Tr=function(t,e){return this.wr.add(e),tu.resolve()},wu.prototype.jn=function(t,e){return tu.resolve(this.wr.getEntries(e))},wu),yu=(mu.prototype.add=function(t){var e=t.q(),n=t.k(),r=this.index[e]||new es(Vr.N),i=!r.has(n);return this.index[e]=r.add(n),i},mu.prototype.has=function(t){var e=t.q(),n=t.k(),r=this.index[e];return r&&r.has(n)},mu.prototype.getEntries=function(t){return(this.index[t]||new es(Vr.N)).W()},mu),vu=(gu.prototype.next=function(){return this.Er+=2,this.Er},gu.mr=function(){return new gu(0)},gu.Ir=function(){return new gu(-1)},gu);function gu(t){this.Er=t}function mu(){this.index={}}function wu(){this.wr=new yu}function bu(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.sr=t,this.ir=e,this.nr=n,this.rr=r,this.hr=i,this.or=0,this.ar=null,this.ur=Date.now(),this.reset()}function Eu(t){return"IndexedDbTransactionError"===t.name}var Iu=(Nu.pr=function(t,e,n,r,i){var o=new Nu(t,e,Date.now()+n,r,i);return o.start(n),o},Nu.prototype.start=function(t){var e=this;this.yr=setTimeout(function(){return e.gr()},t)},Nu.prototype.br=function(){return this.gr()},Nu.prototype.cancel=function(t){null!==this.yr&&(this.clearTimeout(),this.Vr.reject(new Nr(Tr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Nu.prototype.gr=function(){var e=this;this.Rr.vr(function(){return null!==e.yr?(e.clearTimeout(),e.op().then(function(t){return e.Vr.resolve(t)})):Promise.resolve()})},Nu.prototype.clearTimeout=function(){null!==this.yr&&(this.Pr(this),clearTimeout(this.yr),this.yr=null)},Nu),Au=(Object.defineProperty(Tu.prototype,"Mr",{get:function(){return this.Dr},enumerable:!0,configurable:!0}),Tu.prototype.vr=function(t){this.enqueue(t)},Tu.prototype.xr=function(t){this.Br(),this.Ur(t)},Tu.prototype.Qr=function(t){return this.Br(),this.Ur(t)},Tu.prototype.Wr=function(n){return l(this,void 0,void 0,function(){var e;return p(this,function(t){switch(t.label){case 0:return this.Br(),this.Dr?[3,2]:(this.Dr=!0,(e=Ps.nt().window)&&e.removeEventListener("visibilitychange",this.Or),[4,this.Qr(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Tu.prototype.enqueue=function(t){return this.Br(),this.Dr?new Promise(function(t){}):this.Ur(t)},Tu.prototype.jr=function(i){var t=this;this.Br(),this.Dr||(this.Cr=this.Cr.then(function(){var n=new lu,r=function(){return l(t,void 0,void 0,function(){var e;return p(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,i()];case 1:return t.sent(),n.resolve(),this.kr.reset(),[3,3];case 2:if(!Eu(e=t.sent()))throw n.resolve(),e;return Fs("AsyncQueue","Operation failed with retryable error: "+e),this.kr.lr(r),[3,3];case 3:return[2]}})})};return t.vr(r),n.promise}))},Tu.prototype.Ur=function(t){var e=this,n=this.Sr.then(function(){return e.$r=!0,t().catch(function(t){throw e.Nr=t,e.$r=!1,js("INTERNAL UNHANDLED ERROR: ",t.stack||t.message||""),t}).then(function(t){return e.$r=!1,t})});return this.Sr=n},Tu.prototype.dr=function(t,e,n){var r=this;this.Br(),-1<this.Lr.indexOf(t)&&(e=0);var i=Iu.pr(this,t,e,n,function(t){return r.Gr(t)});return this.Fr.push(i),i},Tu.prototype.Br=function(){this.Nr&&Bs()},Tu.prototype.Hr=function(){},Tu.prototype.Kr=function(){return l(this,void 0,void 0,function(){var e;return p(this,function(t){switch(t.label){case 0:return[4,e=this.Sr];case 1:t.sent(),t.label=2;case 2:if(e!==this.Sr)return[3,0];t.label=3;case 3:return[2]}})})},Tu.prototype.zr=function(t){for(var e=0,n=this.Fr;e<n.length;e++)if(n[e].ir===t)return!0;return!1},Tu.prototype.qr=function(r){var i=this;return this.Kr().then(function(){i.Fr.sort(function(t,e){return t.Ar-e.Ar});for(var t=0,e=i.Fr;t<e.length;t++){var n=e[t];if(n.br(),"all"!==r&&n.ir===r)break}return i.Kr()})},Tu.prototype.Yr=function(t){this.Lr.push(t)},Tu.prototype.Gr=function(t){var e=this.Fr.indexOf(t);this.Fr.splice(e,1)},Tu);function Tu(){var t=this;this.Sr=Promise.resolve(),this.Cr=Promise.resolve(),this.Dr=!1,this.Fr=[],this.Nr=null,this.$r=!1,this.Lr=[],this.kr=new pu(this,"async_queue_retry"),this.Or=function(){t.qr("async_queue_retry")};var e=Ps.nt().window;e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Or)}function Nu(t,e,n,r,i){this.Rr=t,this.ir=e,this.Ar=n,this.op=r,this.Pr=i,this.Vr=new lu,this.then=this.Vr.promise.then.bind(this.Vr.promise),this.catch=this.Vr.promise.catch.bind(this.Vr.promise),this.Vr.promise.catch(function(t){})}function _u(t,e){if(js("AsyncQueue",e+": "+t),Eu(t))return new Nr(Tr.UNAVAILABLE,e+": "+t);throw t}var Ru=(Su.th=function(t){return new Su(t,Su.eh,Su.sh)},Su);function Su(t,e,n){this.Xr=t,this.Jr=e,this.Zr=n}Ru.ih=-1,Ru.nh=1048576,Ru.rh=41943040,Ru.eh=10,Ru.sh=1e3,Ru.hh=new Ru(Ru.rh,Ru.eh,Ru.sh),Ru.DISABLED=new Ru(Ru.ih,0,0);var Du=(ku.prototype.start=function(){return Promise.resolve()},ku.prototype.Rh=function(i){return l(this,void 0,void 0,function(){var e,m,n,r=this;return p(this,function(t){switch(t.label){case 0:return e=this.Dn,m=this.Eh,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return r.Dn.Ah(v).next(function(t){return g=t,e=r.persistence._h(i),m=new eu(r.fh,e,r.persistence.mh()),e.Ah(v)}).next(function(t){for(var e=[],n=[],r=hs(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,f=t;c<f.length;c++){var l=f[c];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.qn(v,r).next(function(t){return{Ph:t,Vh:e,ph:n}})})})];case 1:return n=t.sent(),[2,(this.Dn=e,this.Eh=m,this.oh.Ih(this.Eh),n)]}})})},ku.prototype.yh=function(u){var a,h=this,c=kr.now(),t=u.reduce(function(t,e){return t.add(e.key)},hs());return this.persistence.runTransaction("Locally write mutations","readwrite",function(s){return h.Eh.qn(s,t).next(function(t){a=t;for(var e=[],n=0,r=u;n<r.length;n++){var i=r[n],o=i.Pt(a.get(i.key));null!=o&&e.push(new Fi(i.key,o,ro(o.proto.mapValue),Ui.exists(!0)))}return h.Dn.gh(s,c,e,u)})}).then(function(t){var e=t.En(a);return{batchId:t.batchId,bh:e}})},ku.prototype.vh=function(r){var i=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=r.batch.keys(),n=i.fh.Sh({Ch:!0});return i.Dn.vh(t,r.batch,r.streamToken).next(function(){return i.Dh(t,r,n)}).next(function(){return n.apply(t)}).next(function(){return i.Dn.Fh(t)}).next(function(){return i.Eh.qn(t,e)})})},ku.prototype.Nh=function(t){var r=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return r.Dn.$h(e,t).next(function(t){return zs(null!==t),n=t.keys(),r.Dn.Lh(e,t)}).next(function(){return r.Dn.Fh(e)}).next(function(){return r.Eh.qn(e,n)})})},ku.prototype.kh=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Dn.kh(t)})},ku.prototype.Oh=function(){var e=this;return this.persistence.runTransaction("Get last stream token","readonly",function(t){return e.Dn.Oh(t)})},ku.prototype.qh=function(e){var n=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary",function(t){return n.Dn.qh(t,e)})},ku.prototype.Mh=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.wh.Mh(t)})},ku.prototype.xh=function(a){var h=this,c=a.Te,f=this.ah;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var i=h.fh.Sh({Ch:!0});f=h.ah;var s=[];a.as.forEach(function(t,e){var n,r,i=f.get(e);i&&(s.push(h.wh.Bh(o,t.Es,e).next(function(){return h.wh.Uh(o,t.ws,e)})),0<(n=t.resumeToken).rt()&&(r=i.me(n,c).Ee(o.Qh),f=f.Re(e,r),ku.Wh(i,r,t)&&s.push(h.wh.jh(o,r))))});var t,u=rs,n=hs();return a.cs.forEach(function(t,e){n=n.add(t)}),s.push(i.getEntries(o,n).next(function(r){a.cs.forEach(function(t,e){var n=r.get(t);e instanceof wo&&e.version.isEqual(Lr.min())?(i.Gh(t,c),u=u.Re(t,e)):null==n||0<e.version.S(n.version)||0===e.version.S(n.version)&&n.hasPendingWrites?(i.Hh(e,c),u=u.Re(t,e)):Fs("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.ls.has(t)&&s.push(h.persistence.zh.Kh(o,t))})})),c.isEqual(Lr.min())||(t=h.wh.Mh(o).next(function(t){return h.wh.Yh(o,o.Qh,c)}),s.push(t)),tu.vn(s).next(function(){return i.apply(o)}).next(function(){return h.Eh.Mn(o,u)})}).then(function(t){return h.ah=f,t})},ku.Wh=function(t,e,n){return zs(0<e.resumeToken.rt()),0===t.resumeToken.rt()||e.Te.C()-t.Te.C()>=this.Xh||0<n.ws.size+n.Ts.size+n.Es.size},ku.prototype.Jh=function(c){return l(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h=this;return p(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return tu.forEach(c,function(e){return tu.forEach(e.Kn,function(t){return h.persistence.zh.Zh(n,e.targetId,t)}).next(function(){return tu.forEach(e.zn,function(t){return h.persistence.zh.to(n,e.targetId,t)})})})})];case 1:return t.sent(),[3,3];case 2:if(!Eu(e=t.sent()))throw e;return Fs("LocalStore","Failed to update sequence numbers: "+e),[3,3];case 3:for(n=0,r=c;n<r.length;n++)i=r[n],o=i.targetId,i.fromCache||(s=this.ah.get(o),u=s.Te,a=s.Ie(u),this.ah=this.ah.Re(o,a));return[2]}})})},ku.prototype.eo=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Dn.so(t,e)})},ku.prototype.io=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Eh.Nn(t,e)})},ku.prototype.no=function(r){var i=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.wh.ro(e,r).next(function(t){return t?(n=t,tu.resolve(n)):i.wh.ho(e).next(function(t){return n=new Lo(r,t,0,e.Qh),i.wh.oo(e,n).next(function(){return n})})})}).then(function(t){return null===i.ah.get(t.targetId)&&(i.ah=i.ah.Re(t.targetId,t),i.uh.set(r,t.targetId)),t})},ku.prototype.ro=function(t,e){var n=this.uh.get(e);return void 0!==n?tu.resolve(this.ah.get(n)):this.wh.ro(t,e)},ku.prototype.ao=function(t,e){var n=this,r=this.ah.get(t),i=e?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release target",i,function(t){return e?tu.resolve():n.persistence.zh.removeTarget(t,r)}).then(function(){n.ah=n.ah.remove(t),n.uh.delete(r.target)})},ku.prototype.uo=function(t,n){var r=this,i=Lr.min(),o=hs();return this.persistence.runTransaction("Execute query","readonly",function(e){return r.ro(e,t.ee()).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.wh.co(e,t.targetId).next(function(t){o=t})}).next(function(){return r.oh.Bn(e,t,n?i:Lr.min(),n?o:hs())}).next(function(t){return{documents:t,lo:o}})})},ku.prototype.Dh=function(t,i,o){var e=this,s=i.batch,n=s.keys(),u=tu.resolve();return n.forEach(function(r){u=u.next(function(){return o.kn(t,r)}).next(function(t){var e=t,n=i.In.get(r);zs(null!==n),(!e||e.version.S(n)<0)&&(e=s.at(r,e,i))&&o.Hh(e,i.mn)})}),u.next(function(){return e.Dn.Lh(t,s)})},ku.prototype._o=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.fo(t,n.ah)})},ku);function ku(t,e,n){this.persistence=t,this.oh=e,this.ah=new Xo(Qs),this.uh=new Zs(function(t){return t.canonicalId()}),this.lh=Lr.min(),this.Dn=t._h(n),this.fh=t.dh(),this.wh=t.Th(),this.Eh=new eu(this.fh,this.Dn,this.persistence.mh()),this.oh.Ih(this.Eh)}function Lu(e){return l(this,void 0,void 0,function(){return p(this,function(t){if(e.code!==Tr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Fs("LocalStore","Unexpectedly lost primary lease"),[2]})})}Du.Xh=3e8;var Ou=(Pu.prototype.M=function(){return this.do.M()},Pu.prototype.Zh=function(t,e){var n=new Vu(t,e);this.do=this.do.add(n),this.To=this.To.add(n)},Pu.prototype.mo=function(t,e){var n=this;t.forEach(function(t){return n.Zh(t,e)})},Pu.prototype.to=function(t,e){this.Io(new Vu(t,e))},Pu.prototype.Ro=function(t,e){var n=this;t.forEach(function(t){return n.to(t,e)})},Pu.prototype.Ao=function(t){var e=this,n=Qr.EMPTY,r=new Vu(n,t),i=new Vu(n,t+1),o=[];return this.To.Ge([r,i],function(t){e.Io(t),o.push(t.key)}),o},Pu.prototype.Po=function(){var e=this;this.do.forEach(function(t){return e.Io(t)})},Pu.prototype.Io=function(t){this.do=this.do.delete(t),this.To=this.To.delete(t)},Pu.prototype.Vo=function(t){var e=Qr.EMPTY,n=new Vu(e,t),r=new Vu(e,t+1),i=hs();return this.To.Ge([n,r],function(t){i=i.add(t.key)}),i},Pu.prototype.po=function(t){var e=new Vu(t,0),n=this.do.Ke(e);return null!==n&&t.isEqual(n.key)},Pu),Vu=(Mu.wo=function(t,e){return Qr.N(t.key,e.key)||Qs(t.yo,e.yo)},Mu.Eo=function(t,e){return Qs(t.yo,e.yo)||Qr.N(t.key,e.key)},Mu);function Mu(t,e){this.key=t,this.yo=e}function Pu(){this.do=new es(Vu.wo),this.To=new es(Vu.Eo)}function Cu(t,e){if(0!==e.length)throw new Nr(Tr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+$u(e.length,"argument")+".")}function Uu(t,e,n){if(e.length!==n)throw new Nr(Tr.INVALID_ARGUMENT,"Function "+t+"() requires "+$u(n,"argument")+", but was called with "+$u(e.length,"argument")+".")}function qu(t,e,n){if(e.length<n)throw new Nr(Tr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+$u(n,"argument")+", but was called with "+$u(e.length,"argument")+".")}function xu(t,e,n,r){if(e.length<n||e.length>r)throw new Nr(Tr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+$u(e.length,"argument")+".")}function Fu(t,e,n,r){Hu(t,e,Ku(n)+" argument",r)}function ju(t,e,n,r){void 0!==r&&Fu(t,e,n,r)}function Gu(t,e,n,r){Hu(t,e,n+" option",r)}function Bu(t,e,n,r){void 0!==r&&Gu(t,e,n,r)}function zu(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(Qu(s))}var u=Qu(n);throw new Nr(Tr.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function Hu(t,e,n,r){if(!("object"===e?Wu(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=Qu(r);throw new Nr(Tr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function Wu(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Qu(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Bs();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Xu(t,e,n){if(void 0===n)throw new Nr(Tr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Ku(e)+" argument, but it was undefined.")}function Ju(n,t,r){Yr(t,function(t,e){if(r.indexOf(t)<0)throw new Nr(Tr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function Yu(t,e,n,r){var i=Qu(r);return new Nr(Tr.INVALID_ARGUMENT,"Function "+t+"() requires its "+Ku(n)+" argument to be a "+e+", but it was: "+i)}function Zu(t,e,n){if(n<=0)throw new Nr(Tr.INVALID_ARGUMENT,'Function "'+t+'()" requires its '+Ku(e)+" argument to be a positive number, but it was: "+n+".")}function Ku(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function $u(t,e){return t+" "+e+(1===t?"":"s")}function ta(){if("undefined"==typeof Uint8Array)throw new Nr(Tr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function ea(){if(!Ps.nt().bo)throw new Nr(Tr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var na=(oa.fromBase64String=function(t){Uu("Blob.fromBase64String",arguments,1),Fu("Blob.fromBase64String","string",1,t),ea();try{return new oa(Kr.fromBase64String(t))}catch(t){throw new Nr(Tr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},oa.fromUint8Array=function(t){if(Uu("Blob.fromUint8Array",arguments,1),ta(),!(t instanceof Uint8Array))throw Yu("Blob.fromUint8Array","Uint8Array",1,t);return new oa(Kr.fromUint8Array(t))},oa.prototype.toBase64=function(){return Uu("Blob.toBase64",arguments,0),ea(),this.vo.toBase64()},oa.prototype.toUint8Array=function(){return Uu("Blob.toUint8Array",arguments,0),ta(),this.vo.toUint8Array()},oa.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},oa.prototype.isEqual=function(t){return this.vo.isEqual(t.vo)},oa),ra=(ia.documentId=function(){return ia.Co},ia.prototype.isEqual=function(t){if(!(t instanceof ia))throw Yu("isEqual","FieldPath",1,t);return this.So.isEqual(t.So)},ia);function ia(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(){if(!(t instanceof Array)||t.length<1)throw new Nr(Tr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var n=0;n<t.length;++n)if(Fu("FieldPath","string",n,t[n]),0===t[n].length)throw new Nr(Tr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.So=new Hr(t)}function oa(t){ea(),this.vo=t}ra.Co=new ra(Hr.X().j());var sa,ua,aa,ha,ca,fa=new RegExp("[~\\*/\\[\\]]"),la=function(t){this.Do=t},pa=(n(Da,ca=la),Da.prototype.Ci=function(t){if(2!==t.Fo)throw 1===t.Fo?t.No("FieldValue.delete() can only appear at the top level of your update data"):t.No("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");return t.Vt.push(t.path),null},Da.prototype.isEqual=function(t){return t instanceof Da},Da),da=(n(Sa,ha=la),Sa.prototype.Ci=function(t){return new Ci(t.path,bi.instance)},Sa.prototype.isEqual=function(t){return t instanceof Sa},Sa),ya=(n(Ra,aa=la),Ra.prototype.Ci=function(t){var e=new La({Fo:3,methodName:this.Do,Lo:!0},t.ii,t.serializer),n=this.$o.map(function(t){return Pa(t,e)}),r=new Ii(n);return new Ci(t.path,r)},Ra.prototype.isEqual=function(t){return this===t},Ra),va=(n(_a,ua=la),_a.prototype.Ci=function(t){var e=new La({Fo:3,methodName:this.Do,Lo:!0},t.ii,t.serializer),n=this.$o.map(function(t){return Pa(t,e)}),r=new Ai(n);return new Ci(t.path,r)},_a.prototype.isEqual=function(t){return this===t},_a),ga=(n(Na,sa=la),Na.prototype.Ci=function(t){var e=new La({Fo:3,methodName:this.Do},t.ii,t.serializer),n=Pa(this.ko,e),r=new Ti(t.serializer,n);return new Ci(t.path,r)},Na.prototype.isEqual=function(t){return this===t},Na),ma=(Object.defineProperty(Ta.prototype,"latitude",{get:function(){return this.Oo},enumerable:!0,configurable:!0}),Object.defineProperty(Ta.prototype,"longitude",{get:function(){return this.qo},enumerable:!0,configurable:!0}),Ta.prototype.isEqual=function(t){return this.Oo===t.Oo&&this.qo===t.qo},Ta.prototype.g=function(t){return Qs(this.Oo,t.Oo)||Qs(this.qo,t.qo)},Ta),wa=/^__.*__$/,ba=(Aa.prototype.Mo=function(t,e){var n=[];return null!==this.Vt?n.push(new Fi(t,this.data,this.Vt,e)):n.push(new xi(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new ji(t,this.fieldTransforms)),n},Aa),Ea=(Ia.prototype.Mo=function(t,e){var n=[new Fi(t,this.data,this.Vt,e)];return 0<this.fieldTransforms.length&&n.push(new ji(t,this.fieldTransforms)),n},Ia);function Ia(t,e,n){this.data=t,this.Vt=e,this.fieldTransforms=n}function Aa(t,e,n){this.data=t,this.Vt=e,this.fieldTransforms=n}function Ta(t,e){if(Uu("GeoPoint",arguments,2),Fu("GeoPoint","number",1,t),Fu("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Nr(Tr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Nr(Tr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Oo=t,this.qo=e}function Na(t){var e=this;return(e=sa.call(this,"FieldValue.increment")||this).ko=t,e}function _a(t){var e=this;return(e=ua.call(this,"FieldValue.arrayRemove")||this).$o=t,e}function Ra(t){var e=this;return(e=aa.call(this,"FieldValue.arrayUnion")||this).$o=t,e}function Sa(){return ha.call(this,"FieldValue.serverTimestamp")||this}function Da(){return ca.call(this,"FieldValue.delete")||this}function ka(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Bs()}}var La=(Object.defineProperty(Ma.prototype,"path",{get:function(){return this.settings.path},enumerable:!0,configurable:!0}),Object.defineProperty(Ma.prototype,"Fo",{get:function(){return this.settings.Fo},enumerable:!0,configurable:!0}),Ma.prototype.Bo=function(t){return new Ma(Object.assign(Object.assign({},this.settings),t),this.ii,this.serializer,this.fieldTransforms,this.Vt)},Ma.prototype.Uo=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Bo({path:n,Lo:!1});return r.Qo(t),r},Ma.prototype.Wo=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Bo({path:n,Lo:!1});return r.xo(),r},Ma.prototype.jo=function(t){return this.Bo({path:void 0,Lo:!0})},Ma.prototype.No=function(t){var e=!this.path||this.path.M()?"":" (found in field "+this.path.toString()+")";return new Nr(Tr.INVALID_ARGUMENT,"Function "+this.settings.methodName+"() called with invalid data. "+t+e)},Ma.prototype.contains=function(e){return void 0!==this.Vt.find(function(t){return e.B(t)})||void 0!==this.fieldTransforms.find(function(t){return e.B(t.field)})},Ma.prototype.xo=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Qo(this.path.get(t))},Ma.prototype.Qo=function(t){if(0===t.length)throw this.No("Document fields must not be empty");if(ka(this.Fo)&&wa.test(t))throw this.No('Document fields cannot begin and end with "__"')},Ma),Oa=(Va.prototype.Ho=function(t,e){var n=this.Ko(0,t);qa("Data must be an object, but it was:",n,e);var r=Ca(e,n);return new ba(new zi(r),null,n.fieldTransforms)},Va.prototype.zo=function(t,e,n){var r=this.Ko(2,t);qa("Data must be an object, but it was:",r,e);var i,o,s=Ca(e,r);if(n){for(var u=[],a=0,h=n;a<h.length;a++){var c=h[a],f=void 0;if(c instanceof ra)f=c.So;else{if("string"!=typeof c)throw Bs();f=Fa(t,c)}if(!r.contains(f))throw new Nr(Tr.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");ja(u,f)||u.push(f)}i=new Pi(u),o=r.fieldTransforms.filter(function(t){return i.ft(t.field)})}else i=new Pi(r.Vt),o=r.fieldTransforms;return new ba(new zi(s),i,o)},Va.prototype.Yo=function(o,t){var s=this.Ko(1,o);qa("Data must be an object, but it was:",s,t);var u=[],a=new Hi;Yr(t,function(t,e){var n,r=Fa(o,t),i=s.Wo(r);e instanceof pa?u.push(r):null!=(n=Pa(e,i))&&(u.push(r),a.set(r,n))});var e=new Pi(u);return new Ea(a.gt(),e,s.fieldTransforms)},Va.prototype.Xo=function(t,e,n,r){var i=this.Ko(1,t),o=[xa(t,e)],s=[n];if(r.length%2!=0)throw new Nr(Tr.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var u=0;u<r.length;u+=2)o.push(xa(t,r[u])),s.push(r[u+1]);for(var a,h,c,f,l=[],p=new Hi,d=o.length-1;0<=d;--d){ja(l,o[d])||(a=o[d],h=s[d],c=i.Wo(a),h instanceof pa?l.push(a):null!=(f=Pa(h,c))&&(l.push(a),p.set(a,f)))}var y=new Pi(l);return new Ea(p.gt(),y,i.fieldTransforms)},Va.prototype.Ko=function(t,e){return new La({Fo:t,methodName:e,path:Hr.H,Lo:!1},this.ii,this.serializer)},Va.prototype.Jo=function(t,e,n){return void 0===n&&(n=!1),Pa(e,this.Ko(n?4:3,t))},Va);function Va(t,e){this.ii=t,this.serializer=e||Ps.nt().Go(t)}function Ma(t,e,n,r,i){this.settings=t,this.ii=e,this.serializer=n,void 0===r&&this.xo(),this.fieldTransforms=r||[],this.Vt=i||[]}function Pa(s,t){if(Ua(s))return qa("Unsupported field value:",t,s),Ca(s,t);if(s instanceof la)return function(t,e){if(!ka(e.Fo))throw e.No(t.Do+"() can only be used with update() and set()");if(null===e.path)throw e.No(t.Do+"() is not currently supported inside arrays");var n=t.Ci(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Vt.push(t.path),s instanceof Array){if(t.settings.Lo&&4!==t.Fo)throw t.No("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Pa(i[r],t.jo(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return e.serializer.ai(t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=kr.fromDate(t);return{timestampValue:e.serializer.D(n)}}if(t instanceof kr){var r=new kr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:e.serializer.D(r)}}if(t instanceof ma)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof na)return{bytesValue:e.serializer.ui(t)};if(t instanceof ic){var i=e.ii,o=t.firestore.Zo;if(!o.isEqual(i))throw e.No("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:e.serializer.li(t.ta.path,t.firestore.Zo)}}throw e.No("Unsupported field value: "+Qu(t))}(s,t)}function Ca(t,r){var i={};return Zr(t)?r.path&&0<r.path.length&&r.Vt.push(r.path):Yr(t,function(t,e){var n=Pa(e,r.Uo(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function Ua(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof kr||t instanceof ma||t instanceof na||t instanceof ic||t instanceof la)}function qa(t,e,n){if(!Ua(n)||!Wu(n)){var r=Qu(n);throw"an object"===r?e.No(t+" a custom object"):e.No(t+" "+r)}}function xa(t,e){if(e instanceof ra)return e.So;if("string"==typeof e)return Fa(t,e);throw new Nr(Tr.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function Fa(t,e){try{return function(e){if(0<=e.search(fa))throw new Nr(Tr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(ra.bind.apply(ra,i([void 0],e.split("."))))}catch(t){throw new Nr(Tr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).So}catch(e){var n=e instanceof Error?e.message:e.toString();throw new Nr(Tr.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function ja(t,e){return t.some(function(t){return t.isEqual(e)})}function Ga(t){this.key=t}function Ba(t){this.key=t}function za(t,e,n){this.query=t,this.targetId=e,this.view=n}function Ha(t){this.key=t,this.vc=!1}function Wa(){this.rl=void 0,this.hl=[]}var Qa,Xa,Ja,Ya,Za=(kh.prototype.ha=function(){return 1===this.state||2===this.state||4===this.state},kh.prototype.oa=function(){return 2===this.state},kh.prototype.start=function(){3!==this.state?this.auth():this.aa()},kh.prototype.stop=function(){return l(this,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return this.ha()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},kh.prototype.ua=function(){this.state=0,this.kr.reset()},kh.prototype.ca=function(){var t=this;this.oa()&&null===this.ra&&(this.ra=this.sr.dr(this.ea,6e4,function(){return t.la()}))},kh.prototype._a=function(t){this.fa(),this.stream.send(t)},kh.prototype.la=function(){return l(this,void 0,void 0,function(){return p(this,function(t){return this.oa()?[2,this.close(0)]:[2]})})},kh.prototype.fa=function(){this.ra&&(this.ra.cancel(),this.ra=null)},kh.prototype.close=function(e,n){return l(this,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return this.fa(),this.kr.cancel(),this.na++,3!==e?this.kr.reset():n&&n.code===Tr.RESOURCE_EXHAUSTED?(js(n.toString()),js("Using maximum backoff delay to prevent overloading the backend."),this.kr.cr()):n&&n.code===Tr.UNAUTHENTICATED&&this.ia.l(),null!==this.stream&&(this.da(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.wa(n)];case 1:return t.sent(),[2]}})})},kh.prototype.da=function(){},kh.prototype.auth=function(){var n=this;this.state=1;var t=this.Ta(this.na),e=this.na;this.ia.getToken().then(function(t){n.na===e&&n.Ea(t)},function(e){t(function(){var t=new Nr(Tr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.ma(t)})})},kh.prototype.Ea=function(t){var e=this,n=this.Ta(this.na);this.stream=this.Ia(t),this.stream.Ra(function(){n(function(){return e.state=2,e.listener.Ra()})}),this.stream.wa(function(t){n(function(){return e.ma(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},kh.prototype.aa=function(){var t=this;this.state=4,this.kr.lr(function(){return l(t,void 0,void 0,function(){return p(this,function(t){return this.state=0,this.start(),[2]})})})},kh.prototype.ma=function(t){return Fs("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},kh.prototype.Ta=function(e){var n=this;return function(t){n.sr.vr(function(){return n.na===e?t():(Fs("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},kh),Ka=(n(Dh,Ja=Za),Dh.prototype.Ia=function(t){return this.sa.Aa("Listen",t)},Dh.prototype.onMessage=function(t){this.kr.reset();var e=this.serializer.yi(t),n=this.serializer.bi(t);return this.listener.Pa(e,n)},Dh.prototype.Va=function(t){var e={};e.database=this.serializer.mi,e.addTarget=this.serializer.ee(t);var n=this.serializer.Ki(t);n&&(e.labels=n),this._a(e)},Dh.prototype.pa=function(t){var e={};e.database=this.serializer.mi,e.removeTarget=t,this._a(e)},Dh),$a=(n(Sh,Xa=Za),Object.defineProperty(Sh.prototype,"ga",{get:function(){return this.ya},enumerable:!0,configurable:!0}),Sh.prototype.start=function(){this.ya=!1,Xa.prototype.start.call(this)},Sh.prototype.da=function(){this.ya&&this.ba([])},Sh.prototype.Ia=function(t){return this.sa.Aa("Write",t)},Sh.prototype.onMessage=function(t){if(zs(!!t.streamToken),this.lastStreamToken=this.serializer.ci(t.streamToken),this.ya){this.kr.reset();var e=this.serializer.Oi(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.va(n,e)}return zs(!t.writeResults||0===t.writeResults.length),this.ya=!0,this.listener.Sa()},Sh.prototype.Ca=function(){var t={};t.database=this.serializer.mi,this._a(t)},Sh.prototype.ba=function(t){var e=this,n={streamToken:this.serializer.ui(this.lastStreamToken),writes:t.map(function(t){return e.serializer.vi(t)})};this._a(n)},Sh),th=(n(Rh,Qa=function(){this.Da=void 0}),Rh.prototype.Fa=function(e,n){var r=this;return this.credentials.getToken().then(function(t){return r.sa.Fa(e,n,t)}).catch(function(t){throw t.code===Tr.UNAUTHENTICATED&&r.credentials.l(),t})},Rh.prototype.Na=function(e,n){var r=this;return this.credentials.getToken().then(function(t){return r.sa.Na(e,n,t)}).catch(function(t){throw t.code===Tr.UNAUTHENTICATED&&r.credentials.l(),t})},Rh),eh=(_h.prototype.Ma=function(r){return l(this,void 0,void 0,function(){var e,n=this;return p(this,function(t){switch(t.label){case 0:if(this.xa(),0<this.mutations.length)throw new Nr(Tr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return l(this,void 0,void 0,function(){var n,e,r,i,o;return p(this,function(t){switch(t.label){case 0:return e={database:(n=s).serializer.mi,documents:u.map(function(t){return n.serializer.di(t)})},[4,n.Na("BatchGetDocuments",e)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e=n.serializer.pi(t);i.set(e.key.toString(),e)}),o=[],[2,(u.forEach(function(t){var e=i.get(t.toString());zs(!!e),o.push(e)}),o)]}})})}(this.$a,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof wo||t instanceof mo?n.Ba(t):Bs()}),e)]}})})},_h.prototype.set=function(t,e){this.write(e.Mo(t,this.Rt(t))),this.qa.add(t)},_h.prototype.update=function(t,e){try{this.write(e.Mo(t,this.Ua(t)))}catch(t){this.Oa=t}this.qa.add(t)},_h.prototype.delete=function(t){this.write([new Gi(t,this.Rt(t))]),this.qa.add(t)},_h.prototype.commit=function(){return l(this,void 0,void 0,function(){var e,n=this;return p(this,function(t){switch(t.label){case 0:if(this.xa(),this.Oa)throw this.Oa;return e=this.La,this.mutations.forEach(function(t){e=e.remove(t.key)}),e.forEach(function(t,e){n.mutations.push(new Bi(t,n.Rt(t)))}),[4,function(i,o){return l(this,void 0,void 0,function(){var e,n,r;return p(this,function(t){switch(t.label){case 0:return n={database:(e=i).serializer.mi,writes:o.map(function(t){return e.serializer.vi(t)})},[4,e.Fa("Commit",n)];case 1:return r=t.sent(),[2,e.serializer.Oi(r.writeResults,r.commitTime)]}})})}(this.$a,this.mutations)];case 1:return t.sent(),this.ka=!0,[2]}})})},_h.prototype.Ba=function(t){var e;if(t instanceof mo)e=t.version;else{if(!(t instanceof wo))throw Bs();e=Lr.min()}var n=this.La.get(t.key);if(null!==n){if(!e.isEqual(n))throw new Nr(Tr.ABORTED,"Document version changed between two reads.")}else this.La=this.La.Re(t.key,e)},_h.prototype.Rt=function(t){var e=this.La.get(t);return!this.qa.has(t)&&e?Ui.updateTime(e):Ui.dt()},_h.prototype.Ua=function(t){var e=this.La.get(t);if(this.qa.has(t)||!e)return Ui.exists(!0);if(e.isEqual(Lr.min()))throw new Nr(Tr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ui.updateTime(e)},_h.prototype.write=function(t){this.xa(),this.mutations=this.mutations.concat(t)},_h.prototype.xa=function(){},_h),nh=(Nh.prototype.Ha=function(){var t=this;0===this.Wa&&(this.Ka("Unknown"),this.ja=this.Rr.dr("online_state_timeout",1e4,function(){return t.ja=null,t.za("Backend didn't respond within 10 seconds."),t.Ka("Offline"),Promise.resolve()}))},Nh.prototype.Ya=function(t){"Online"===this.state?this.Ka("Unknown"):(this.Wa++,1<=this.Wa&&(this.Xa(),this.za("Connection failed 1 times. Most recent error: "+t.toString()),this.Ka("Offline")))},Nh.prototype.set=function(t){this.Xa(),this.Wa=0,"Online"===t&&(this.Ga=!1),this.Ka(t)},Nh.prototype.Ka=function(t){t!==this.state&&(this.state=t,this.Qa(t))},Nh.prototype.za=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Ga?(js(e),this.Ga=!1):Fs("OnlineStateTracker",e)},Nh.prototype.Xa=function(){null!==this.ja&&(this.ja.cancel(),this.ja=null)},Nh),rh=(Th.prototype.start=function(){return this.enableNetwork()},Th.prototype.enableNetwork=function(){return this.networkEnabled=!0,this.Tu()},Th.prototype.Tu=function(){return l(this,void 0,void 0,function(){var e;return p(this,function(t){switch(t.label){case 0:return this.ru()?(e=this._u,[4,this.Ja.Oh()]):[3,3];case 1:return e.lastStreamToken=t.sent(),this.Eu()?this.mu():this.ou.set("Unknown"),[4,this.Iu()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Th.prototype.disableNetwork=function(){return l(this,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.Ru()];case 1:return t.sent(),this.ou.set("Offline"),[2]}})})},Th.prototype.Ru=function(){return l(this,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return[4,this._u.stop()];case 1:return t.sent(),[4,this.au.stop()];case 2:return t.sent(),0<this.Za.length&&(Fs("RemoteStore","Stopping write stream with "+this.Za.length+" pending writes"),this.Za=[]),this.Au(),[2]}})})},Th.prototype.Pu=function(){return l(this,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return Fs("RemoteStore","RemoteStore shutting down."),this.networkEnabled=!1,[4,this.Ru()];case 1:return t.sent(),this.iu.Pu(),this.ou.set("Unknown"),[2]}})})},Th.prototype.listen=function(t){this.tu.has(t.targetId)||(this.tu.set(t.targetId,t),this.Eu()?this.mu():this.au.oa()&&this.Vu(t))},Th.prototype.pu=function(t){this.tu.delete(t),this.au.oa()&&this.yu(t),0===this.tu.size&&(this.au.oa()?this.au.ca():this.ru()&&this.ou.set("Unknown"))},Th.prototype.si=function(t){return this.tu.get(t)||null},Th.prototype.ei=function(t){return this.gu.ei(t)},Th.prototype.Vu=function(t){this.eu.Ns(t.targetId),this.au.Va(t)},Th.prototype.yu=function(t){this.eu.Ns(t),this.au.pa(t)},Th.prototype.mu=function(){this.eu=new bs(this),this.au.start(),this.ou.Ha()},Th.prototype.Eu=function(){return this.ru()&&!this.au.ha()&&0<this.tu.size},Th.prototype.ru=function(){return!this.su&&this.isPrimary&&this.networkEnabled},Th.prototype.Au=function(){this.eu=null},Th.prototype.uu=function(){return l(this,void 0,void 0,function(){var n=this;return p(this,function(t){return this.tu.forEach(function(t,e){n.Vu(t)}),[2]})})},Th.prototype.cu=function(e){return l(this,void 0,void 0,function(){return p(this,function(t){return this.Au(),this.Eu()?(this.ou.Ya(e),this.mu()):this.ou.set("Unknown"),[2]})})},Th.prototype.lu=function(i,o){return l(this,void 0,void 0,function(){var e,n,r;return p(this,function(t){switch(t.label){case 0:if(this.ou.set("Online"),!(i instanceof ps&&2===i.state&&i.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.bu(i)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Fs("RemoteStore","Failed to remove targets %s: %s ",i.targetIds.join(","),e),[4,this.vu(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(i instanceof fs?this.eu.Bs(i):i instanceof ls?this.eu.zs(i):this.eu.Ws(i),o.isEqual(Lr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,this.Ja.Mh()];case 8:return n=t.sent(),0<=o.S(n)?[4,this.Su(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Fs("RemoteStore","Failed to raise snapshot:",r=t.sent()),[4,this.vu(r)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},Th.prototype.vu=function(n){return l(this,void 0,void 0,function(){var e=this;return p(this,function(t){switch(t.label){case 0:if(!Eu(n))throw n;return this.su=!0,[4,this.Ru()];case 1:return t.sent(),this.ou.set("Offline"),this.Rr.jr(function(){return l(e,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return Fs("RemoteStore","Retrying IndexedDB access"),[4,this.Ja.Mh()];case 1:return t.sent(),this.su=!1,[4,this.Tu()];case 2:return t.sent(),[2]}})})}),[2]}})})},Th.prototype.Su=function(r){var i=this,t=this.eu.Js(r);return t.as.forEach(function(t,e){var n;0<t.resumeToken.rt()&&((n=i.tu.get(e))&&i.tu.set(e,n.me(t.resumeToken,r)))}),t.us.forEach(function(t){var e,n=i.tu.get(t);n&&(i.tu.set(t,n.me(Kr.ht,n.Te)),i.yu(t),e=new Lo(n.target,t,1,n.sequenceNumber),i.Vu(e))}),this.gu.xh(t)},Th.prototype.bu=function(o){return l(this,void 0,void 0,function(){var e,n,r,i;return p(this,function(t){switch(t.label){case 0:e=o.cause,n=0,r=o.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],this.tu.has(i)?[4,this.gu.Cu(i,e)]:[3,3]):[3,5];case 2:t.sent(),this.tu.delete(i),this.eu.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},Th.prototype.Iu=function(){return l(this,void 0,void 0,function(){var e,n;return p(this,function(t){switch(t.label){case 0:return this.Du()?(e=0<this.Za.length?this.Za[this.Za.length-1].batchId:-1,[4,this.Ja.eo(e)]):[3,5];case 1:return null!==(n=t.sent())?[3,2]:(0===this.Za.length&&this._u.ca(),[3,4]);case 2:return this.Fu(n),[4,this.Iu()];case 3:t.sent(),t.label=4;case 4:t.label=5;case 5:return this.Nu()&&this.$u(),[2]}})})},Th.prototype.Du=function(){return this.ru()&&this.Za.length<10},Th.prototype.Lu=function(){return this.Za.length},Th.prototype.Fu=function(t){this.Za.push(t),this._u.oa()&&this._u.ga&&this._u.ba(t.mutations)},Th.prototype.Nu=function(){return this.ru()&&!this._u.ha()&&0<this.Za.length},Th.prototype.$u=function(){this._u.start()},Th.prototype.fu=function(){return l(this,void 0,void 0,function(){return p(this,function(t){return this._u.Ca(),[2]})})},Th.prototype.wu=function(){var r=this;return this.Ja.qh(this._u.lastStreamToken).then(function(){for(var t=0,e=r.Za;t<e.length;t++){var n=e[t];r._u.ba(n.mutations)}}).catch(Lu)},Th.prototype.va=function(t,e){var n=this,r=this.Za.shift(),i=$s.from(r,t,e,this._u.lastStreamToken);return this.gu.ku(i).then(function(){return n.Iu()})},Th.prototype.du=function(e){return l(this,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return e&&0<this.Za.length?this._u.ga?[4,this.Ou(e)]:[3,2]:[3,5];case 1:return t.sent(),[3,4];case 2:return[4,this.qu(e)];case 3:t.sent(),t.label=4;case 4:this.Nu()&&this.$u(),t.label=5;case 5:return[2]}})})},Th.prototype.qu=function(e){return l(this,void 0,void 0,function(){return p(this,function(t){return Wo(e.code)?[2,(Fs("RemoteStore","RemoteStore error before completed handshake; resetting stream token: ",this._u.lastStreamToken),this._u.lastStreamToken=Kr.ht,this.Ja.qh(Kr.ht).catch(Lu))]:[2]})})},Th.prototype.Ou=function(i){return l(this,void 0,void 0,function(){var e,n,r=this;return p(this,function(t){return Wo(n=i.code)&&n!==Tr.ABORTED?(e=this.Za.shift(),[2,(this._u.ua(),this.gu.Mu(e.batchId,i).then(function(){return r.Iu()}))]):[2]})})},Th.prototype.xu=function(){return new eh(this.$a)},Th.prototype.hu=function(){return l(this,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.Ru()];case 1:return t.sent(),this.ou.set("Unknown"),[4,this.enableNetwork()];case 2:return t.sent(),[2]}})})},Th.prototype.Bu=function(){return l(this,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return this.ru()?(Fs("RemoteStore","RemoteStore restarting streams for new credential"),[4,this.hu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Th.prototype.Uu=function(e){return l(this,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return(this.isPrimary=e)&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:[4,this.Ru()];case 3:t.sent(),this.ou.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},Th),ih=(Ah.prototype.Qu=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Ah.prototype.Wu=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Ah.prototype.ju=function(){var t={activeTargetIds:this.activeTargetIds.W(),updateTimeMs:Date.now()};return JSON.stringify(t)},Ah),oh=(Ih.prototype.Ku=function(t){},Ih.prototype.zu=function(t,e,n){},Ih.prototype.Yu=function(t){return this.Gu.Qu(t),this.Hu[t]||"not-current"},Ih.prototype.Xu=function(t,e,n){this.Hu[t]=e},Ih.prototype.Ju=function(t){this.Gu.Wu(t)},Ih.prototype.Zu=function(t){return this.Gu.activeTargetIds.has(t)},Ih.prototype.tc=function(t){delete this.Hu[t]},Ih.prototype.ec=function(){return this.Gu.activeTargetIds},Ih.prototype.sc=function(t){return this.Gu.activeTargetIds.has(t)},Ih.prototype.start=function(){return this.Gu=new ih,Promise.resolve()},Ih.prototype.Rh=function(t,e,n){},Ih.prototype.ic=function(t){},Ih.prototype.Pu=function(){},Ih.prototype.tr=function(t){},Ih),sh=(Object.defineProperty(Eh.prototype,"ac",{get:function(){return this.nc},enumerable:!0,configurable:!0}),Eh.prototype.uc=function(t,e){var u=this,a=e?e.cc:new ys,h=e?e.oc:this.oc,c=e?e.ns:this.ns,f=h,l=!1,p=this.query.oe()&&h.size===this.query.limit?h.last():null,d=this.query.ae()&&h.size===this.query.limit?h.first():null;if(t.ye(function(t,e){var n=h.get(t),r=(r=e instanceof mo?e:null)&&(u.query.matches(r)?r:null),i=!!n&&u.ns.has(n.key),o=!!r&&(r.At||u.ns.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(a.track({type:3,doc:r}),s=!0):u.lc(n,r)||(a.track({type:2,doc:r}),s=!0,(p&&0<u.query.se(r,p)||d&&u.query.se(r,d)<0)&&(l=!0)):!n&&r?(a.track({type:0,doc:r}),s=!0):n&&!r&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(l=!0)),s&&(c=r?(f=f.add(r),o?c.add(t):c.delete(t)):(f=f.delete(t),c.delete(t)))}),this.query.oe()||this.query.ae())for(;f.size>this.query.limit;){var n=this.query.oe()?f.last():f.first(),f=f.delete(n.key),c=c.delete(n.key);a.track({type:1,doc:n})}return{oc:f,cc:a,_c:l,ns:c}},Eh.prototype.lc=function(t,e){return t.At&&e.hasCommittedMutations&&!e.At},Eh.prototype.fc=function(t,e,n){var o=this,r=this.oc;this.oc=t.oc,this.ns=t.ns;var i=t.cc.es();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.query.se(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Bs()}}var r,i}),this.dc(n);var s=e?this.wc():[],u=0===this.hc.size&&this.ds?1:0,a=u!==this.rc;return this.rc=u,0!==i.length||a?{snapshot:new vs(this.query,t.oc,r,i,t.ns,0==u,a,!1),Tc:s}:{Tc:s}},Eh.prototype.Ec=function(t){return this.ds&&"Offline"===t?(this.ds=!1,this.fc({oc:this.oc,cc:new ys,ns:this.ns,_c:!1},!1)):{Tc:[]}},Eh.prototype.mc=function(t){return!this.nc.has(t)&&!!this.oc.has(t)&&!this.oc.get(t).At},Eh.prototype.dc=function(t){var e=this;t&&(t.ws.forEach(function(t){return e.nc=e.nc.add(t)}),t.Ts.forEach(function(t){}),t.Es.forEach(function(t){return e.nc=e.nc.delete(t)}),this.ds=t.ds)},Eh.prototype.wc=function(){var e=this;if(!this.ds)return[];var n=this.hc;this.hc=hs(),this.oc.forEach(function(t){e.mc(t.key)&&(e.hc=e.hc.add(t.key))});var r=[];return n.forEach(function(t){e.hc.has(t)||r.push(new Ba(t))}),this.hc.forEach(function(t){n.has(t)||r.push(new Ga(t))}),r},Eh.prototype.Ic=function(t){this.nc=t.lo,this.hc=hs();var e=this.uc(t.documents);return this.fc(e,!0)},Eh.prototype.Rc=function(){return vs.os(this.query,this.oc,this.ns,0===this.rc)},Eh),uh=(bh.prototype.Vc=function(){this.pc()},bh.prototype.pc=function(){var t=this;this.kr.lr(function(){return l(t,void 0,void 0,function(){var e,n,r=this;return p(this,function(t){return e=this.Ac.xu(),(n=this.yc(e))&&n.then(function(t){r.Rr.vr(function(){return e.commit().then(function(){r.Vr.resolve(t)}).catch(function(t){r.gc(t)})})}).catch(function(t){r.gc(t)}),[2]})})})},bh.prototype.yc=function(t){try{var e=this.updateFunction(t);return!ti(e)&&e.catch&&e.then?e:(this.Vr.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Vr.reject(t),null}},bh.prototype.gc=function(t){var e=this;0<this.Pc&&this.bc(t)?(--this.Pc,this.Rr.vr(function(){return e.pc(),Promise.resolve()})):this.Vr.reject(t)},bh.prototype.bc=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Wo(e)},bh),ah=(Object.defineProperty(wh.prototype,"Bc",{get:function(){return!0},enumerable:!0,configurable:!0}),wh.prototype.subscribe=function(t){this.Dc=t},wh.prototype.listen=function(s){return l(this,void 0,void 0,function(){var e,n,r,i,o;return p(this,function(t){switch(t.label){case 0:return this.Uc("listen()"),(r=this.Fc.get(s))?(e=r.targetId,this.Sc.Yu(e),n=r.view.Rc(),[3,4]):[3,1];case 1:return[4,this.Ja.no(s.ee())];case 2:return i=t.sent(),o=this.Sc.Yu(i.targetId),e=i.targetId,[4,this.Qc(s,e,"current"===o)];case 3:n=t.sent(),this.Bc&&this.Ac.listen(i),t.label=4;case 4:return[2,n]}})})},wh.prototype.Qc=function(u,a,h){return l(this,void 0,void 0,function(){var e,n,r,i,o,s;return p(this,function(t){switch(t.label){case 0:return[4,this.Ja.uo(u,!0)];case 1:return e=t.sent(),n=new sh(u,e.lo),r=n.uc(e.documents),i=ms.fs(a,h&&"Offline"!==this.onlineState),o=n.fc(r,this.Bc,i),this.Wc(a,o.Tc),s=new za(u,a,n),[2,(this.Fc.set(u,s),this.Nc.has(a)?this.Nc.get(a).push(u):this.Nc.set(a,[u]),o.snapshot)]}})})},wh.prototype.pu=function(i){return l(this,void 0,void 0,function(){var e,n,r=this;return p(this,function(t){switch(t.label){case 0:return this.Uc("unlisten()"),e=this.Fc.get(i),1<(n=this.Nc.get(e.targetId)).length?[2,(this.Nc.set(e.targetId,n.filter(function(t){return!t.isEqual(i)})),void this.Fc.delete(i))]:this.Bc?(this.Sc.Ju(e.targetId),this.Sc.sc(e.targetId)?[3,2]:[4,this.Ja.ao(e.targetId,!1).then(function(){r.Sc.tc(e.targetId),r.Ac.pu(e.targetId),r.jc(e.targetId)}).catch(Lu)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.jc(e.targetId),[4,this.Ja.ao(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},wh.prototype.write=function(i,o){return l(this,void 0,void 0,function(){var e,n,r;return p(this,function(t){switch(t.label){case 0:this.Uc("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,this.Ja.yh(i)];case 2:return e=t.sent(),this.Sc.Ku(e.batchId),this.Gc(e.batchId,o),[4,this.Hc(e.bh)];case 3:return t.sent(),[4,this.Ac.Iu()];case 4:return t.sent(),[3,6];case 5:return n=t.sent(),r=_u(n,"Failed to persist write"),o.reject(r),[3,6];case 6:return[2]}})})},wh.prototype.runTransaction=function(t,e,n){new uh(t,this.Ac,e,n).Vc()},wh.prototype.xh=function(n){return l(this,void 0,void 0,function(){var e,r=this;return p(this,function(t){switch(t.label){case 0:this.Uc("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.Ja.xh(n)];case 2:return e=t.sent(),n.as.forEach(function(t,e){var n=r.kc.get(e);n&&(zs(t.ws.size+t.Ts.size+t.Es.size<=1),0<t.ws.size?n.vc=!0:0<t.Ts.size?zs(n.vc):0<t.Es.size&&(zs(n.vc),n.vc=!1))}),[4,this.Hc(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,Lu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},wh.prototype.Ec=function(r,t){this.Uc("applyOnlineStateChange()");var i=[];this.Fc.forEach(function(t,e){var n=e.view.Ec(r);n.snapshot&&i.push(n.snapshot)}),this.Dc.Kc(r),this.Dc.Pa(i),this.onlineState=r},wh.prototype.Cu=function(u,a){return l(this,void 0,void 0,function(){var e,n,r,i,o,s=this;return p(this,function(t){switch(t.label){case 0:return this.Uc("rejectListens()"),this.Sc.Xu(u,"rejected",a),e=this.kc.get(u),(n=e&&e.key)?(r=(r=new Xo(Qr.N)).Re(n,new wo(n,Lr.min())),i=hs().add(n),o=new gs(Lr.min(),new Map,new es(Qs),r,i),[4,this.xh(o)]):[3,2];case 1:return t.sent(),this.Lc=this.Lc.remove(n),this.kc.delete(u),this.zc(),[3,4];case 2:return[4,this.Ja.ao(u,!1).then(function(){return s.jc(u,a)}).catch(Lu)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},wh.prototype.ku=function(r){return l(this,void 0,void 0,function(){var e,n;return p(this,function(t){switch(t.label){case 0:this.Uc("applySuccessfulWrite()"),e=r.batch.batchId,this.Yc(e,null),this.Xc(e),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.Ja.vh(r)];case 2:return n=t.sent(),this.Sc.zu(e,"acknowledged"),[4,this.Hc(n)];case 3:return t.sent(),[3,6];case 4:return[4,Lu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},wh.prototype.Mu=function(n,r){return l(this,void 0,void 0,function(){var e;return p(this,function(t){switch(t.label){case 0:this.Uc("rejectFailedWrite()"),this.Yc(n,r),this.Xc(n),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.Ja.Nh(n)];case 2:return e=t.sent(),this.Sc.zu(n,"rejected",r),[4,this.Hc(e)];case 3:return t.sent(),[3,6];case 4:return[4,Lu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},wh.prototype.Jc=function(o){return l(this,void 0,void 0,function(){var e,n,r,i;return p(this,function(t){switch(t.label){case 0:this.Ac.ru()||Fs("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Ja.kh()];case 2:return-1===(e=t.sent())?[2,void o.resolve()]:((n=this.Mc.get(e)||[]).push(o),this.Mc.set(e,n),[3,4]);case 3:return r=t.sent(),i=_u(r,"Initialization of waitForPendingWrites() operation failed"),o.reject(i),[3,4];case 4:return[2]}})})},wh.prototype.Xc=function(t){(this.Mc.get(t)||[]).forEach(function(t){t.resolve()}),this.Mc.delete(t)},wh.prototype.Zc=function(e){this.Mc.forEach(function(t){t.forEach(function(t){t.reject(new Nr(Tr.CANCELLED,e))})}),this.Mc.clear()},wh.prototype.Gc=function(t,e){var n=(n=(n=this.qc[this.currentUser.s()])||new Xo(Qs)).Re(t,e);this.qc[this.currentUser.s()]=n},wh.prototype.Yc=function(t,e){var n,r=this.qc[this.currentUser.s()];r&&((n=r.get(t))&&(e?n.reject(e):n.resolve(),r=r.remove(t)),this.qc[this.currentUser.s()]=r)},wh.prototype.jc=function(t,e){var n=this;void 0===e&&(e=null),this.Sc.Ju(t);for(var r=0,i=this.Nc.get(t);r<i.length;r++){var o=i[r];this.Fc.delete(o),e&&this.Dc.tl(o,e)}this.Nc.delete(t),this.Bc&&this.Oc.Ao(t).forEach(function(t){n.Oc.po(t)||n.el(t)})},wh.prototype.el=function(t){var e=this.Lc.get(t);null!==e&&(this.Ac.pu(e),this.Lc=this.Lc.remove(t),this.kc.delete(e),this.zc())},wh.prototype.Wc=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof Ga?(this.Oc.Zh(i.key,t),this.sl(i)):i instanceof Ba?(Fs("SyncEngine","Document no longer in limbo: "+i.key),this.Oc.to(i.key,t),this.Oc.po(i.key)||this.el(i.key)):Bs()}},wh.prototype.sl=function(t){var e=t.key;this.Lc.get(e)||(Fs("SyncEngine","New document in limbo: "+e),this.$c.push(e),this.zc())},wh.prototype.zc=function(){for(;0<this.$c.length&&this.Lc.size<this.Cc;){var t=this.$c.shift(),e=this.xc.next();this.kc.set(e,new Ha(t)),this.Lc=this.Lc.Re(t,e),this.Ac.listen(new Lo(Io.Wt(t.path).ee(),e,2,ru.er))}},wh.prototype.il=function(){return this.Lc},wh.prototype.nl=function(){return this.$c},wh.prototype.Hc=function(r,a){return l(this,void 0,void 0,function(){var o,s,e,u=this;return p(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.Fc.forEach(function(t,i){e.push(Promise.resolve().then(function(){var n=i.view.uc(r);return n._c?u.Ja.uo(i.query,!1).then(function(t){var e=t.documents;return i.view.uc(e,n)}):n}).then(function(t){var e,n=a&&a.as.get(i.targetId),r=i.view.fc(t,u.Bc,n);u.Wc(i.targetId,r.Tc),r.snapshot&&(u.Bc&&u.Sc.Xu(i.targetId,r.snapshot.fromCache?"not-current":"current"),o.push(r.snapshot),e=nu.Yn(i.targetId,r.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.Dc.Pa(o),[4,this.Ja.Jh(s)];case 2:return t.sent(),[2]}})})},wh.prototype.Uc=function(t){},wh.prototype.Bu=function(r){return l(this,void 0,void 0,function(){var e,n;return p(this,function(t){switch(t.label){case 0:return e=!this.currentUser.isEqual(r),this.currentUser=r,e?(this.Zc("'waitForPendingWrites' promise is rejected due to a user change."),[4,this.Ja.Rh(r)]):[3,3];case 1:return n=t.sent(),this.Sc.Rh(r,n.Vh,n.ph),[4,this.Hc(n.Ph)];case 2:t.sent(),t.label=3;case 3:return[4,this.Ac.Bu()];case 4:return t.sent(),[2]}})})},wh.prototype.enableNetwork=function(){return this.Ac.enableNetwork()},wh.prototype.disableNetwork=function(){return this.Ac.disableNetwork()},wh.prototype.ei=function(t){var e=this.kc.get(t);if(e&&e.vc)return hs().add(e.key);var n=hs(),r=this.Nc.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++)var s=o[i],u=this.Fc.get(s),n=n.ze(u.view.ac);return n},wh),hh=(mh.prototype.listen=function(u){return l(this,void 0,void 0,function(){var e,n,r,i,o,s;return p(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(r=this.ol.get(e))||(n=!0,r=new Wa),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),i=r,[4,this.gu.listen(e)];case 2:return i.rl=t.sent(),[3,4];case 3:return o=t.sent(),s=_u(o,"Initialization of query '"+u.query+"' failed"),[2,void u.onError(s)];case 4:return this.ol.set(e,r),r.hl.push(u),u.Ec(this.onlineState),r.rl&&u.ul(r.rl)&&this.cl(),[2]}})})},mh.prototype.pu=function(o){return l(this,void 0,void 0,function(){var e,n,r,i;return p(this,function(t){return e=o.query,n=!1,(r=this.ol.get(e))&&0<=(i=r.hl.indexOf(o))&&(r.hl.splice(i,1),n=0===r.hl.length),n?[2,(this.ol.delete(e),this.gu.pu(e))]:[2]})})},mh.prototype.Pa=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.ol.get(o);if(s){for(var u=0,a=s.hl;u<a.length;u++)a[u].ul(i)&&(e=!0);s.rl=i}}e&&this.cl()},mh.prototype.tl=function(t,e){var n=this.ol.get(t);if(n)for(var r=0,i=n.hl;r<i.length;r++)i[r].onError(e);this.ol.delete(t)},mh.prototype.Kc=function(i){this.onlineState=i;var o=!1;this.ol.forEach(function(t,e){for(var n=0,r=e.hl;n<r.length;n++)r[n].Ec(i)&&(o=!0)}),o&&this.cl()},mh.prototype.ll=function(t){this.al.add(t),t.next()},mh.prototype._l=function(t){this.al.delete(t)},mh.prototype.cl=function(){this.al.forEach(function(t){t.next()})},mh),ch=(gh.prototype.ul=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new vs(t.query,t.docs,t.ss,e,t.ns,t.fromCache,t.rs,!0)}var o=!1;return this.dl?this.Tl(t)&&(this.fl.next(t),o=!0):this.El(t,this.onlineState)&&(this.ml(t),o=!0),this.wl=t,o},gh.prototype.onError=function(t){this.fl.error(t)},gh.prototype.Ec=function(t){this.onlineState=t;var e=!1;return this.wl&&!this.dl&&this.El(this.wl,t)&&(this.ml(this.wl),e=!0),e},gh.prototype.El=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Il&&n||t.docs.M()&&"Offline"!==e)},gh.prototype.Tl=function(t){if(0<t.docChanges.length)return!0;var e=this.wl&&this.wl.hasPendingWrites!==t.hasPendingWrites;return!(!t.rs&&!e)&&!0===this.options.includeMetadataChanges},gh.prototype.ml=function(t){t=vs.os(t.query,t.docs,t.ns,t.fromCache),this.dl=!0,this.fl.next(t)},gh),fh=(vh.prototype.Ih=function(t){this.Rl=t},vh.prototype.Bn=function(e,r,i,o){var s=this;return r.te()||i.isEqual(Lr.min())?this.Al(e,r):this.Rl.qn(e,o).next(function(t){var n=s.Pl(r,t);return(r.oe()||r.ae())&&s._c(r.xt,n,o,i)?s.Al(e,r):(qs()<=u.DEBUG&&Fs("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),r.toString()),s.Rl.Bn(e,r,i).next(function(e){return n.forEach(function(t){e=e.Re(t.key,t)}),e}))})},vh.prototype.Pl=function(n,t){var r=new es(function(t,e){return n.se(t,e)});return t.forEach(function(t,e){e instanceof mo&&n.matches(e)&&(r=r.add(e))}),r},vh.prototype._c=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.S(r))},vh.prototype.Al=function(t,e){return qs()<=u.DEBUG&&Fs("IndexFreeQueryEngine","Using full collection scan to execute query: %s",e.toString()),this.Rl.Bn(t,e,Lr.min())},vh),lh=(yh.prototype.yl=function(t){return tu.resolve(0===this.Dn.length)},yh.prototype.vh=function(t,e,n){var r=e.batchId,i=this.gl(r,"acknowledged");return zs(0===i),this.Dn[i],this.lastStreamToken=n,tu.resolve()},yh.prototype.Oh=function(t){return tu.resolve(this.lastStreamToken)},yh.prototype.qh=function(t,e){return this.lastStreamToken=e,tu.resolve()},yh.prototype.gh=function(t,e,n,r){var i=this.Vl;this.Vl++,0<this.Dn.length&&this.Dn[this.Dn.length-1];var o=new Ks(i,e,n,r);this.Dn.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.pl=this.pl.add(new Vu(a.key,i)),this.Fn.Tr(t,a.key.path.k())}return tu.resolve(o)},yh.prototype.$h=function(t,e){return tu.resolve(this.bl(e))},yh.prototype.so=function(t,e){var n=e+1,r=this.vl(n),i=r<0?0:r;return tu.resolve(this.Dn.length>i?this.Dn[i]:null)},yh.prototype.kh=function(){return tu.resolve(0===this.Dn.length?-1:this.Vl-1)},yh.prototype.Ah=function(t){return tu.resolve(this.Dn.slice())},yh.prototype.$n=function(t,e){var n=this,r=new Vu(e,0),i=new Vu(e,Number.POSITIVE_INFINITY),o=[];return this.pl.Ge([r,i],function(t){var e=n.bl(t.yo);o.push(e)}),tu.resolve(o)},yh.prototype.xn=function(t,e){var r=this,i=new es(Qs);return e.forEach(function(t){var e=new Vu(t,0),n=new Vu(t,Number.POSITIVE_INFINITY);r.pl.Ge([e,n],function(t){i=i.add(t.yo)})}),tu.resolve(this.Sl(i))},yh.prototype.Gn=function(t,e){var n=e.path,r=n.length+1,i=n;Qr.et(i)||(i=i.child(""));var o=new Vu(new Qr(i),0),s=new es(Qs);return this.pl.He(function(t){var e=t.key.path;return!!n.B(e)&&(e.length===r&&(s=s.add(t.yo)),!0)},o),tu.resolve(this.Sl(s))},yh.prototype.Sl=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.bl(t);null!==e&&r.push(e)}),r},yh.prototype.Lh=function(n,r){var i=this;zs(0===this.gl(r.batchId,"removed")),this.Dn.shift();var o=this.pl;return tu.forEach(r.mutations,function(t){var e=new Vu(t.key,r.batchId);return o=o.delete(e),i.zh.Cl(n,t.key)}).next(function(){i.pl=o})},yh.prototype.Dl=function(t){},yh.prototype.po=function(t,e){var n=new Vu(e,0),r=this.pl.Ke(n);return tu.resolve(e.isEqual(r&&r.key))},yh.prototype.Fh=function(t){return this.Dn.length,tu.resolve()},yh.prototype.gl=function(t,e){return this.vl(t)},yh.prototype.vl=function(t){return 0===this.Dn.length?0:t-this.Dn[0].batchId},yh.prototype.bl=function(t){var e=this.vl(t);return e<0||e>=this.Dn.length?null:this.Dn[e]},yh),ph=(dh.prototype.Hh=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.Fl(e);return this.docs=this.docs.Re(r,{Nl:e,size:s,readTime:n}),this.size+=s-o,this.Fn.Tr(t,r.path.k())},dh.prototype.Gh=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},dh.prototype.kn=function(t,e){var n=this.docs.get(e);return tu.resolve(n?n.Nl:null)},dh.prototype.getEntries=function(t,e){var n=this,r=rs;return e.forEach(function(t){var e=n.docs.get(t);r=r.Re(t,e?e.Nl:null)}),tu.resolve(r)},dh.prototype.Bn=function(t,e,n){for(var r=ss,i=new Qr(e.path.child("")),o=this.docs.ve(i);o.$e();){var s=o.Ne(),u=s.key,a=s.value,h=a.Nl,c=a.readTime;if(!e.path.B(u.path))break;c.S(n)<=0||h instanceof mo&&e.matches(h)&&(r=r.Re(h.key,h))}return tu.resolve(r)},dh.prototype.$l=function(t,e){return tu.forEach(this.docs,function(t){return e(t)})},dh.prototype.Sh=function(t){return new dh.Ll(this)},dh.prototype.kl=function(t){return tu.resolve(this.size)},dh);function dh(t,e){this.Fn=t,this.Fl=e,this.docs=new Xo(Qr.N),this.size=0}function yh(t,e){this.Fn=t,this.zh=e,this.Dn=[],this.Vl=1,this.lastStreamToken=Kr.ht,this.pl=new es(Vu.wo)}function vh(){}function gh(t,e,n){this.query=t,this.fl=e,this.dl=!1,this.wl=null,this.onlineState="Unknown",this.options=n||{}}function mh(t){this.gu=t,this.ol=new Zs(function(t){return t.canonicalId()}),this.onlineState="Unknown",this.al=new Set,this.gu.subscribe(this)}function wh(t,e,n,r,i){this.Ja=t,this.Ac=e,this.Sc=n,this.currentUser=r,this.Cc=i,this.Dc=null,this.Fc=new Zs(function(t){return t.canonicalId()}),this.Nc=new Map,this.$c=[],this.Lc=new Xo(Qr.N),this.kc=new Map,this.Oc=new Ou,this.qc={},this.Mc=new Map,this.xc=vu.Ir(),this.onlineState="Unknown"}function bh(t,e,n,r){this.Rr=t,this.Ac=e,this.updateFunction=n,this.Vr=r,this.Pc=5,this.kr=new pu(this.Rr,"transaction_retry")}function Eh(t,e){this.query=t,this.nc=e,this.rc=null,this.ds=!1,this.hc=hs(),this.ns=hs(),this.oc=new ds(t.se.bind(t))}function Ih(){this.Gu=new ih,this.Hu={},this.gu=null,this.Qa=null,this.Xn=null}function Ah(){this.activeTargetIds=cs}function Th(t,e,n,r,i){var o,s,u,a,h,c,f=this;this.Ja=t,this.$a=e,this.Rr=n,this.Za=[],this.tu=new Map,this.eu=null,this.networkEnabled=!1,this.isPrimary=!1,this.su=!1,this.iu=i,this.iu.nu(function(t){n.vr(function(){return l(f,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return this.ru()?(Fs("RemoteStore","Restarting streams for network reachability change."),[4,this.hu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.ou=new nh(n,r),this.au=(a=this.$a,h=n,c={Ra:this.uu.bind(this),wa:this.cu.bind(this),Pa:this.lu.bind(this)},new Ka(h,a.sa,a.credentials,a.serializer,c)),this._u=(o=this.$a,s=n,u={Ra:this.fu.bind(this),wa:this.du.bind(this),Sa:this.wu.bind(this),va:this.va.bind(this)},new $a(s,o.sa,o.credentials,o.serializer,u))}function Nh(t,e){this.Rr=t,this.Qa=e,this.state="Unknown",this.Wa=0,this.ja=null,this.Ga=!0}function _h(t){this.$a=t,this.La=us,this.mutations=[],this.ka=!1,this.Oa=null,this.qa=new Set}function Rh(t,e,n){var r=this;return(r=Qa.call(this)||this).sa=t,r.credentials=e,r.serializer=n,r}function Sh(t,e,n,r,i){var o=this;return(o=Xa.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.ya=!1,o.lastStreamToken=Kr.ht,o}function Dh(t,e,n,r,i){var o=this;return(o=Ja.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function kh(t,e,n,r,i,o){this.sr=t,this.ea=n,this.sa=r,this.ia=i,this.listener=o,this.state=0,this.na=0,this.ra=null,this.stream=null,this.kr=new pu(t,e)}function Lh(t){var e=this;return(e=Ya.call(this)||this).Ul=t,e}function Oh(){this.bh=new Zs(function(t){return t.toString()}),this.Ol=!1}ph.Ll=(Object.defineProperty(Oh.prototype,"readTime",{get:function(){return this.ql},set:function(t){this.ql=t},enumerable:!0,configurable:!0}),Oh.prototype.Hh=function(t,e){this.Ml(),this.readTime=e,this.bh.set(t.key,t)},Oh.prototype.Gh=function(t,e){this.Ml(),e&&(this.readTime=e),this.bh.set(t,null)},Oh.prototype.kn=function(t,e){this.Ml();var n=this.bh.get(e);return void 0!==n?tu.resolve(n):this.xl(t,e)},Oh.prototype.getEntries=function(t,e){return this.Bl(t,e)},Oh.prototype.apply=function(t){return this.Ml(),this.Ol=!0,this.fc(t)},Oh.prototype.Ml=function(){},n(Lh,Ya=Oh),Lh.prototype.fc=function(n){var r=this,i=[];return this.bh.forEach(function(t,e){e?i.push(r.Ul.Hh(n,e,r.readTime)):r.Ul.Gh(t)}),tu.vn(i)},Lh.prototype.xl=function(t,e){return this.Ul.kn(t,e)},Lh.prototype.Bl=function(t,e){return this.Ul.getEntries(t,e)},Lh);var Vh,Mh=(Xh.prototype.js=function(t,n){return this.Ql.forEach(function(t,e){return n(e)}),tu.resolve()},Xh.prototype.Mh=function(t){return tu.resolve(this.lastRemoteSnapshotVersion)},Xh.prototype.Hl=function(t){return tu.resolve(this.Wl)},Xh.prototype.ho=function(t){return this.highestTargetId=this.Gl.next(),tu.resolve(this.highestTargetId)},Xh.prototype.Yh=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Wl&&(this.Wl=e),tu.resolve()},Xh.prototype.Kl=function(t){this.Ql.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Gl=new vu(e),this.highestTargetId=e),t.sequenceNumber>this.Wl&&(this.Wl=t.sequenceNumber)},Xh.prototype.oo=function(t,e){return this.Kl(e),this.targetCount+=1,tu.resolve()},Xh.prototype.jh=function(t,e){return this.Kl(e),tu.resolve()},Xh.prototype.zl=function(t,e){return this.Ql.delete(e.target),this.jl.Ao(e.targetId),--this.targetCount,tu.resolve()},Xh.prototype.Yl=function(n,r,i){var o=this,s=0,u=[];return this.Ql.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Ql.delete(t),u.push(o.Xl(n,e.targetId)),s++)}),tu.vn(u).next(function(){return s})},Xh.prototype.Jl=function(t){return tu.resolve(this.targetCount)},Xh.prototype.ro=function(t,e){var n=this.Ql.get(e)||null;return tu.resolve(n)},Xh.prototype.Uh=function(t,e,n){return this.jl.mo(e,n),tu.resolve()},Xh.prototype.Bh=function(e,t,n){this.jl.Ro(t,n);var r=this.persistence.zh,i=[];return r&&t.forEach(function(t){i.push(r.Cl(e,t))}),tu.vn(i)},Xh.prototype.Xl=function(t,e){return this.jl.Ao(e),tu.resolve()},Xh.prototype.co=function(t,e){var n=this.jl.Vo(e);return tu.resolve(n)},Xh.prototype.po=function(t,e){return tu.resolve(this.jl.po(e))},Xh),Ph=(Qh.prototype.start=function(){return Promise.resolve()},Qh.prototype.Pu=function(){return this.e_=!1,Promise.resolve()},Object.defineProperty(Qh.prototype,"i_",{get:function(){return this.e_},enumerable:!0,configurable:!0}),Qh.prototype.n_=function(){},Qh.prototype.mh=function(){return this.Fn},Qh.prototype._h=function(t){var e=this.Zl[t.s()];return e||(e=new lh(this.Fn,this.zh),this.Zl[t.s()]=e),e},Qh.prototype.Th=function(){return this.wh},Qh.prototype.dh=function(){return this.Cn},Qh.prototype.runTransaction=function(t,e,n){var r=this;Fs("MemoryPersistence","Starting transaction:",t);var i=new Ch(this.t_.next());return this.zh.r_(),n(i).next(function(t){return r.zh.h_(i).next(function(){return t})}).gn().then(function(t){return i.o_(),t})},Qh.prototype.a_=function(e,n){return tu.Sn(Object.values(this.Zl).map(function(t){return function(){return t.po(e,n)}}))},Qh),Ch=(Wh.prototype.c_=function(t){this.u_.push(t)},Wh.prototype.o_=function(){this.u_.forEach(function(t){return t()})},n(Hh,Vh=Wh),Hh),Uh=(zh.f_=function(t){return new zh(t)},Object.defineProperty(zh.prototype,"d_",{get:function(){if(this.__)return this.__;throw Bs()},enumerable:!0,configurable:!0}),zh.prototype.Zh=function(t,e,n){return this.l_.Zh(n,e),this.d_.delete(n),tu.resolve()},zh.prototype.to=function(t,e,n){return this.l_.to(n,e),this.d_.add(n),tu.resolve()},zh.prototype.Cl=function(t,e){return this.d_.add(e),tu.resolve()},zh.prototype.removeTarget=function(t,e){var n=this;this.l_.Ao(e.targetId).forEach(function(t){return n.d_.add(t)});var r=this.persistence.Th();return r.co(t,e.targetId).next(function(t){t.forEach(function(t){return n.d_.add(t)})}).next(function(){return r.zl(t,e)})},zh.prototype.r_=function(){this.__=new Set},zh.prototype.h_=function(t){var n=this,r=this.persistence.dh().Sh();return tu.forEach(this.d_,function(e){return n.w_(t,e).next(function(t){t||r.Gh(e)})}).next(function(){return n.__=null,r.apply(t)})},zh.prototype.Kh=function(t,e){var n=this;return this.w_(t,e).next(function(t){t?n.d_.delete(e):n.d_.add(e)})},zh.prototype.s_=function(t){return 0},zh.prototype.w_=function(t,e){var n=this;return tu.Sn([function(){return tu.resolve(n.l_.po(e))},function(){return n.persistence.Th().po(t,e)},function(){return n.persistence.a_(t,e)}])},zh),qh=(Bh.prototype.initialize=function(n){return l(this,void 0,void 0,function(){var e=this;return p(this,function(t){switch(t.label){case 0:return this.Sc=this.T_(n),this.persistence=this.E_(n),[4,this.persistence.start()];case 1:return t.sent(),this.m_=this.I_(n),this.Ja=this.R_(n),this.Ac=this.A_(n),this.gu=this.P_(n),this.V_=this.p_(n),this.Sc.Qa=function(t){return e.gu.Ec(t,1)},this.Ac.gu=this.gu,[4,this.Ja.start()];case 2:return t.sent(),[4,this.Sc.start()];case 3:return t.sent(),[4,this.Ac.start()];case 4:return t.sent(),[4,this.Ac.Uu(this.gu.Bc)];case 5:return t.sent(),[2]}})})},Bh.prototype.p_=function(t){return new hh(this.gu)},Bh.prototype.I_=function(t){return null},Bh.prototype.R_=function(t){return new Du(this.persistence,new fh,t.y_)},Bh.prototype.E_=function(t){return new Ph(Uh.f_)},Bh.prototype.A_=function(t){var e=this;return new rh(this.Ja,t.$a,t.Rr,function(t){return e.gu.Ec(t,0)},t.platform.g_())},Bh.prototype.T_=function(t){return new oh},Bh.prototype.P_=function(t){return new ah(this.Ja,this.Ac,this.Sc,t.y_,t.Cc)},Bh.prototype.clearPersistence=function(t){throw new Nr(Tr.FAILED_PRECONDITION,"You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.")},Bh),xh=(Gh.prototype.start=function(e,n){var r=this;this.v_();var i=new lu,o=new lu,s=!1;return this.credentials._(function(t){if(!s)return s=!0,Fs("FirestoreClient","Initializing. user=",t.uid),r.S_(e,n,t,o).then(i.resolve,i.reject);r.Rr.vr(function(){return r.Bu(t)})}),this.Rr.vr(function(){return i.promise}),o.promise},Gh.prototype.enableNetwork=function(){var t=this;return this.v_(),this.Rr.enqueue(function(){return t.gu.enableNetwork()})},Gh.prototype.S_=function(u,a,h,c){return l(this,void 0,void 0,function(){var n,r,i,o,s=this;return p(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,this.platform.C_(this.b_)];case 1:return n=t.sent(),r=this.platform.Go(this.b_.ii),e=this.credentials,i=new th(n,e,r),[4,u.initialize({Rr:this.Rr,b_:this.b_,platform:this.platform,$a:i,clientId:this.clientId,y_:h,Cc:100,D_:a})];case 2:return t.sent(),this.persistence=u.persistence,this.Sc=u.Sc,this.Ja=u.Ja,this.Ac=u.Ac,this.gu=u.gu,this.m_=u.m_,this.F_=u.V_,this.persistence.n_(function(){return l(s,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),c.resolve(),[3,4];case 3:if(o=t.sent(),c.reject(o),!this.N_(o))throw o;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+o),this.S_(new qh,{L_:!1},h,c))];case 4:return[2]}var e})})},Gh.prototype.N_=function(t){return"FirebaseError"===t.name?t.code===Tr.FAILED_PRECONDITION||t.code===Tr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Gh.prototype.v_=function(){if(this.Rr.Mr)throw new Nr(Tr.FAILED_PRECONDITION,"The client has already been terminated.")},Gh.prototype.Bu=function(t){return this.Rr.Hr(),Fs("FirestoreClient","Credential Changed. Current user: "+t.uid),this.gu.Bu(t)},Gh.prototype.disableNetwork=function(){var t=this;return this.v_(),this.Rr.enqueue(function(){return t.gu.disableNetwork()})},Gh.prototype.terminate=function(){var t=this;return this.Rr.Wr(function(){return l(t,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return this.m_&&this.m_.stop(),[4,this.Ac.Pu()];case 1:return t.sent(),[4,this.Sc.Pu()];case 2:return t.sent(),[4,this.persistence.Pu()];case 3:return t.sent(),this.credentials.T(),[2]}})})})},Gh.prototype.waitForPendingWrites=function(){var t=this;this.v_();var e=new lu;return this.Rr.vr(function(){return t.gu.Jc(e)}),e.promise},Gh.prototype.listen=function(t,e,n){var r=this;this.v_();var i=new ch(t,e,n);return this.Rr.vr(function(){return r.F_.listen(i)}),i},Gh.prototype.pu=function(t){var e=this;this.k_||this.Rr.vr(function(){return e.F_.pu(t)})},Gh.prototype.O_=function(o){return l(this,void 0,void 0,function(){var i,e=this;return p(this,function(t){switch(t.label){case 0:return this.v_(),i=new lu,[4,this.Rr.enqueue(function(){return l(e,void 0,void 0,function(){var e,n,r;return p(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Ja.io(o)];case 1:return(e=t.sent())instanceof mo?i.resolve(e):e instanceof wo?i.resolve(null):i.reject(new Nr(Tr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return n=t.sent(),r=_u(n,"Failed to get document '"+o+" from cache"),i.reject(r),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),i.promise)]}})})},Gh.prototype.q_=function(a){return l(this,void 0,void 0,function(){var u,e=this;return p(this,function(t){switch(t.label){case 0:return this.v_(),u=new lu,[4,this.Rr.enqueue(function(){return l(e,void 0,void 0,function(){var e,n,r,i,o,s;return p(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Ja.uo(a,!0)];case 1:return e=t.sent(),n=new sh(a,e.lo),r=n.uc(e.documents),i=n.fc(r,!1),u.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=_u(o,"Failed to execute query '"+a+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})},Gh.prototype.write=function(t){var e=this;this.v_();var n=new lu;return this.Rr.vr(function(){return e.gu.write(t,n)}),n.promise},Gh.prototype.ii=function(){return this.b_.ii},Gh.prototype.ll=function(t){var e=this;this.v_(),this.Rr.vr(function(){return e.F_.ll(t),Promise.resolve()})},Gh.prototype._l=function(t){var e=this;this.k_||this.Rr.vr(function(){return e.F_._l(t),Promise.resolve()})},Object.defineProperty(Gh.prototype,"k_",{get:function(){return this.Rr.Mr},enumerable:!0,configurable:!0}),Gh.prototype.transaction=function(t){var e=this;this.v_();var n=new lu;return this.Rr.vr(function(){return e.gu.runTransaction(e.Rr,t,n),Promise.resolve()}),n.promise},Gh),Fh=(jh.prototype.next=function(t){this.M_(this.observer.next,t)},jh.prototype.error=function(t){this.M_(this.observer.error,t)},jh.prototype.x_=function(){this.muted=!0},jh.prototype.M_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},jh);function jh(t){this.observer=t,this.muted=!1}function Gh(t,e,n,r){this.platform=t,this.b_=e,this.credentials=n,this.Rr=r,this.clientId=Hs.cn()}function Bh(){}function zh(t){this.persistence=t,this.l_=new Ou,this.__=null}function Hh(t){var e=this;return(e=Vh.call(this)||this).Qh=t,e}function Wh(){this.u_=[]}function Qh(t){var e=this;this.Zl={},this.t_=new ru(0),this.e_=!1,this.e_=!0,this.zh=t(this),this.wh=new Mh(this),this.Fn=new du,this.Cn=new ph(this.Fn,function(t){return e.zh.s_(t)})}function Xh(t){this.persistence=t,this.Ql=new Zs(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=Lr.min(),this.highestTargetId=0,this.Wl=0,this.jl=new Ou,this.targetCount=0,this.Gl=vu.mr()}function Jh(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Yh,Zh,Kh=(Ic.prototype.U_=function(t){switch(oi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return li(t.integerValue||t.doubleValue);case 3:return this.Q_(t.timestampValue);case 4:return this.W_(t);case 5:return t.stringValue;case 6:return new na(pi(t.bytesValue));case 7:return this.j_(t.referenceValue);case 8:return this.G_(t.geoPointValue);case 9:return this.H_(t.arrayValue);case 10:return this.K_(t.mapValue);default:throw Bs()}},Ic.prototype.K_=function(t){var n=this,r={};return Yr(t.fields||{},function(t,e){r[t]=n.U_(e)}),r},Ic.prototype.G_=function(t){return new ma(li(t.latitude),li(t.longitude))},Ic.prototype.H_=function(t){var e=this;return(t.values||[]).map(function(t){return e.U_(t)})},Ic.prototype.W_=function(t){switch(this.B_){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return ni(n)?t(n):n}(t);return null==e?null:this.U_(e);case"estimate":return this.Q_(ri(t));default:return null}},Ic.prototype.Q_=function(t){var e=fi(t),n=new kr(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},Ic.prototype.j_=function(t){var e=Vr.G(t);zs(Ms(e));var n=new Ys(e.get(1),e.get(3)),r=new Qr(e.L(5));return n.isEqual(this.firestore.Zo)||js("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.firestore.Zo.projectId+"/"+this.firestore.Zo.database+") instead."),new ic(r,this.firestore,this.converter)},Ic),$h=Ru.ih,tc=(Ec.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling},Ec),ec=(bc.prototype.settings=function(t){Uu("Firestore.settings",arguments,1),Fu("Firestore.settings","object",1,t);var e=new tc(t);if(this.J_&&!this.if.isEqual(e))throw new Nr(Tr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.if=e).credentials&&(this.ef=function(t){if(!t)return new _r;switch(t.type){case"gapi":var e=t.rf;return zs(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Dr(e,t.V||"0");case"provider":return t.rf;default:throw new Nr(Tr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},bc.prototype.enableNetwork=function(){return this.X_(),this.J_.enableNetwork()},bc.prototype.disableNetwork=function(){return this.X_(),this.J_.disableNetwork()},bc.prototype.enablePersistence=function(t){var e,n;if(this.J_)throw new Nr(Tr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1;return t&&(void 0!==t.experimentalTabSynchronization&&js("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n),this.hf(this.sf,{L_:!0,cacheSizeBytes:this.if.cacheSizeBytes,synchronizeTabs:r})},bc.prototype.clearPersistence=function(){return l(this,void 0,void 0,function(){var r,e=this;return p(this,function(t){if(void 0!==this.J_&&!this.J_.k_)throw new Nr(Tr.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return r=new lu,[2,(this.Y_.xr(function(){return l(e,void 0,void 0,function(){var e,n;return p(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),e=this.af(),[4,this.sf.clearPersistence(e)];case 1:return t.sent(),r.resolve(),[3,3];case 2:return n=t.sent(),r.reject(n),[3,3];case 3:return[2]}})})}),r.promise)]})})},bc.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(bc.prototype,"uf",{get:function(){return this.X_(),this.J_.k_},enumerable:!0,configurable:!0}),bc.prototype.waitForPendingWrites=function(){return this.X_(),this.J_.waitForPendingWrites()},bc.prototype.onSnapshotsInSync=function(t){if(this.X_(),Jh(t))return this.cf(t);Fu("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.cf(e)},bc.prototype.cf=function(t){var e=this,n=new Fh({next:function(){t.next&&t.next()},error:function(t){throw Bs()}});return this.J_.ll(n),function(){n.x_(),e.J_._l(n)}},bc.prototype.X_=function(){return this.J_||this.hf(new qh,{L_:!1}),this.J_},bc.prototype.af=function(){return new Js(this.Zo,this.tf,this.if.host,this.if.ssl,this.if.forceLongPolling)},bc.prototype.hf=function(t,e){var n=this.af();return this.J_=new xh(Ps.nt(),n,this.ef,this.Y_),this.J_.start(t,e)},bc.Z_=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Nr(Tr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Nr(Tr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Ys(n)},Object.defineProperty(bc.prototype,"app",{get:function(){if(!this.z_)throw new Nr(Tr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.z_},enumerable:!0,configurable:!0}),bc.prototype.collection=function(t){return Uu("Firestore.collection",arguments,1),Fu("Firestore.collection","non-empty string",1,t),this.X_(),new cc(Vr.G(t),this)},bc.prototype.doc=function(t){return Uu("Firestore.doc",arguments,1),Fu("Firestore.doc","non-empty string",1,t),this.X_(),ic.lf(Vr.G(t),this)},bc.prototype.collectionGroup=function(t){if(Uu("Firestore.collectionGroup",arguments,1),Fu("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Nr(Tr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.X_(),new ac(new Io(Vr.H,t),this)},bc.prototype.runTransaction=function(e){var n=this;return Uu("Firestore.runTransaction",arguments,1),Fu("Firestore.runTransaction","function",1,e),this.X_().transaction(function(t){return e(new nc(n,t))})},bc.prototype.batch=function(){return this.X_(),new rc(this)},Object.defineProperty(bc,"logLevel",{get:function(){switch(qs()){case u.DEBUG:return"debug";case u.SILENT:return"silent";default:return"error"}},enumerable:!0,configurable:!0}),bc.setLogLevel=function(t){switch(Uu("Firestore.setLogLevel",arguments,1),Fu("Firestore.setLogLevel","non-empty string",1,t),t){case"debug":xs(u.DEBUG);break;case"error":xs(u.ERROR);break;case"silent":xs(u.SILENT);break;default:throw new Nr(Tr.INVALID_ARGUMENT,"Invalid log level: "+t)}},bc.prototype._f=function(){return this.if.timestampsInSnapshots},bc),nc=(wc.prototype.get=function(t){var n=this;Uu("Transaction.get",arguments,1);var r=_c("Transaction.get",t,this.ff);return this.df.Ma([r.ta]).then(function(t){if(!t||1!==t.length)return Bs();var e=t[0];if(e instanceof wo)return new sc(n.ff,r.ta,null,!1,!1,r.wf);if(e instanceof mo)return new sc(n.ff,r.ta,e,!1,!1,r.wf);throw Bs()})},wc.prototype.set=function(t,e,n){xu("Transaction.set",arguments,2,3);var r=_c("Transaction.set",t,this.ff);n=Ac("Transaction.set",n);var i=Rc(r.wf,e,"Transaction.set"),o=i[0],s=i[1],u=n.merge||n.mergeFields?this.ff.nf.zo(s,o,n.mergeFields):this.ff.nf.Ho(s,o);return this.df.set(r.ta,u),this},wc.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof ra?(qu("Transaction.update",arguments,3),r=_c("Transaction.update",t,this.ff),this.ff.nf.Xo("Transaction.update",e,n,o)):(Uu("Transaction.update",arguments,2),r=_c("Transaction.update",t,this.ff),this.ff.nf.Yo("Transaction.update",e)),this.df.update(r.ta,i),this},wc.prototype.delete=function(t){Uu("Transaction.delete",arguments,1);var e=_c("Transaction.delete",t,this.ff);return this.df.delete(e.ta),this},wc),rc=(mc.prototype.set=function(t,e,n){xu("WriteBatch.set",arguments,2,3),this.mf();var r=_c("WriteBatch.set",t,this.ff);n=Ac("WriteBatch.set",n);var i=Rc(r.wf,e,"WriteBatch.set"),o=i[0],s=i[1],u=n.merge||n.mergeFields?this.ff.nf.zo(s,o,n.mergeFields):this.ff.nf.Ho(s,o);return this.Tf=this.Tf.concat(u.Mo(r.ta,Ui.dt())),this},mc.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.mf(),i="string"==typeof e||e instanceof ra?(qu("WriteBatch.update",arguments,3),r=_c("WriteBatch.update",t,this.ff),this.ff.nf.Xo("WriteBatch.update",e,n,o)):(Uu("WriteBatch.update",arguments,2),r=_c("WriteBatch.update",t,this.ff),this.ff.nf.Yo("WriteBatch.update",e)),this.Tf=this.Tf.concat(i.Mo(r.ta,Ui.exists(!0))),this},mc.prototype.delete=function(t){Uu("WriteBatch.delete",arguments,1),this.mf();var e=_c("WriteBatch.delete",t,this.ff);return this.Tf=this.Tf.concat(new Gi(e.ta,Ui.dt())),this},mc.prototype.commit=function(){return this.mf(),this.Ef=!0,0<this.Tf.length?this.ff.X_().write(this.Tf):Promise.resolve()},mc.prototype.mf=function(){if(this.Ef)throw new Nr(Tr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},mc),ic=(gc.lf=function(t,e,n){if(t.length%2!=0)throw new Nr(Tr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.j()+" has "+t.length);return new gc(new Qr(t),e,n)},Object.defineProperty(gc.prototype,"id",{get:function(){return this.ta.path.q()},enumerable:!0,configurable:!0}),Object.defineProperty(gc.prototype,"parent",{get:function(){return new cc(this.ta.path.k(),this.firestore,this.wf)},enumerable:!0,configurable:!0}),Object.defineProperty(gc.prototype,"path",{get:function(){return this.ta.path.j()},enumerable:!0,configurable:!0}),gc.prototype.collection=function(t){if(Uu("DocumentReference.collection",arguments,1),Fu("DocumentReference.collection","non-empty string",1,t),!t)throw new Nr(Tr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Vr.G(t);return new cc(this.ta.path.child(e),this.firestore)},gc.prototype.isEqual=function(t){if(!(t instanceof gc))throw Yu("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.ta.isEqual(t.ta)&&this.wf===t.wf},gc.prototype.set=function(t,e){xu("DocumentReference.set",arguments,1,2),e=Ac("DocumentReference.set",e);var n=Rc(this.wf,t,"DocumentReference.set"),r=n[0],i=n[1],o=e.merge||e.mergeFields?this.firestore.nf.zo(i,r,e.mergeFields):this.firestore.nf.Ho(i,r);return this.J_.write(o.Mo(this.ta,Ui.dt()))},gc.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof ra?(qu("DocumentReference.update",arguments,2),this.firestore.nf.Xo("DocumentReference.update",t,e,r)):(Uu("DocumentReference.update",arguments,1),this.firestore.nf.Yo("DocumentReference.update",t)),this.J_.write(n.Mo(this.ta,Ui.exists(!0)))},gc.prototype.delete=function(){return Uu("DocumentReference.delete",arguments,0),this.J_.write([new Gi(this.ta,Ui.dt())])},gc.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];xu("DocumentReference.onSnapshot",arguments,1,4);var n={includeMetadataChanges:!1},r=0;"object"!=typeof t[r]||Jh(t[r])||(Ju("DocumentReference.onSnapshot",n=t[r],["includeMetadataChanges"]),Bu("DocumentReference.onSnapshot","boolean","includeMetadataChanges",n.includeMetadataChanges),r++);var i={includeMetadataChanges:n.includeMetadataChanges},o=Jh(t[r])?t[r]:(Fu("DocumentReference.onSnapshot","function",r,t[r]),ju("DocumentReference.onSnapshot","function",r+1,t[r+1]),ju("DocumentReference.onSnapshot","function",r+2,t[r+2]),{next:t[r],error:t[r+1],complete:t[r+2]});return this.If(i,o)},gc.prototype.If=function(t,n){var r=this,e=function(t){console.error("Uncaught Error in onSnapshot:",t)};n.error&&(e=n.error.bind(n));var i=new Fh({next:function(t){var e;n.next&&(e=t.docs.get(r.ta),n.next(new sc(r.firestore,r.ta,e,t.fromCache,t.hasPendingWrites,r.wf)))},error:e}),o=this.J_.listen(Io.Wt(this.ta.path),i,t);return function(){i.x_(),r.J_.pu(o)}},gc.prototype.get=function(n){var r=this;return xu("DocumentReference.get",arguments,0,1),Nc("DocumentReference.get",n),new Promise(function(e,t){n&&"cache"===n.source?r.firestore.X_().O_(r.ta).then(function(t){e(new sc(r.firestore,r.ta,t,!0,t instanceof mo&&t.At,r.wf))},t):r.Rf(e,t,n)})},gc.prototype.Rf=function(e,n,r){var i=this.If({includeMetadataChanges:!0,Il:!0},{next:function(t){i(),!t.exists&&t.metadata.fromCache?n(new Nr(Tr.UNAVAILABLE,"Failed to get document because the client is offline.")):t.exists&&t.metadata.fromCache&&r&&"server"===r.source?n(new Nr(Tr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):e(t)},error:n})},gc.prototype.withConverter=function(t){return new gc(this.ta,this.firestore,t)},gc),oc=(vc.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},vc),sc=(yc.prototype.data=function(t){if(xu("DocumentSnapshot.data",arguments,0,1),t=Tc("DocumentSnapshot.data",t),this.Af){if(this.wf){var e=new uc(this.ff,this.ta,this.Af,this.Pf,this.Vf);return this.wf.fromFirestore(e,t)}return new Kh(this.ff,this.ff._f(),t.serverTimestamps,void 0).U_(this.Af.kt())}},yc.prototype.get=function(t,e){if(xu("DocumentSnapshot.get",arguments,1,2),e=Tc("DocumentSnapshot.get",e),this.Af){var n=this.Af.data().field(xa("DocumentSnapshot.get",t));if(null!==n)return new Kh(this.ff,this.ff._f(),e.serverTimestamps,this.wf).U_(n)}},Object.defineProperty(yc.prototype,"id",{get:function(){return this.ta.path.q()},enumerable:!0,configurable:!0}),Object.defineProperty(yc.prototype,"ref",{get:function(){return new ic(this.ta,this.ff,this.wf)},enumerable:!0,configurable:!0}),Object.defineProperty(yc.prototype,"exists",{get:function(){return null!==this.Af},enumerable:!0,configurable:!0}),Object.defineProperty(yc.prototype,"metadata",{get:function(){return new oc(this.Vf,this.Pf)},enumerable:!0,configurable:!0}),yc.prototype.isEqual=function(t){if(!(t instanceof yc))throw Yu("isEqual","DocumentSnapshot",1,t);return this.ff===t.ff&&this.Pf===t.Pf&&this.ta.isEqual(t.ta)&&(null===this.Af?null===t.Af:this.Af.isEqual(t.Af))&&this.wf===t.wf},yc),uc=(n(dc,Zh=sc),dc.prototype.data=function(t){return Zh.prototype.data.call(this,t)},dc),ac=(pc.prototype.where=function(t,e,n){Uu("Query.where",arguments,3),Xu("Query.where",3,n);var r,i=function(t,e){if(!t.some(function(t){return t===e}))throw new Nr(Tr.INVALID_ARGUMENT,"Invalid value "+Qu(e)+" provided to function Query.where() for its "+Ku(2)+" argument. Acceptable values: "+t.join(", "));return e}(["<","<=","==",">=",">","array-contains","in","array-contains-any"],e),o=xa("Query.where",t);if(o.Y()){if("array-contains"===i||"array-contains-any"===i)throw new Nr(Tr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i){this.yf(n,i);for(var s=[],u=0,a=n;u<a.length;u++){var h=a[u];s.push(this.gf(h))}r={arrayValue:{values:s}}}else r=this.gf(n)}else"in"!==i&&"array-contains-any"!==i||this.yf(n,i),r=this.firestore.nf.Jo("Query.where",n,"in"===i);var c=Ao.create(o,i,r);return this.bf(c),new pc(this.pf.Ht(c),this.firestore,this.wf)},pc.prototype.orderBy=function(t,e){var n;if(xu("Query.orderBy",arguments,1,2),ju("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Nr(Tr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}if(null!==this.pf.startAt)throw new Nr(Tr.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.pf.endAt)throw new Nr(Tr.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var r=xa("Query.orderBy",t),i=new ko(r,n);return this.vf(i),new pc(this.pf.Kt(i),this.firestore,this.wf)},pc.prototype.limit=function(t){return Uu("Query.limit",arguments,1),Fu("Query.limit","number",1,t),Zu("Query.limit",1,t),new pc(this.pf.zt(t),this.firestore,this.wf)},pc.prototype.limitToLast=function(t){return Uu("Query.limitToLast",arguments,1),Fu("Query.limitToLast","number",1,t),Zu("Query.limitToLast",1,t),new pc(this.pf.Yt(t),this.firestore,this.wf)},pc.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];qu("Query.startAt",arguments,1);var r=this.Sf("Query.startAt",t,e,!0);return new pc(this.pf.Xt(r),this.firestore,this.wf)},pc.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];qu("Query.startAfter",arguments,1);var r=this.Sf("Query.startAfter",t,e,!1);return new pc(this.pf.Xt(r),this.firestore,this.wf)},pc.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];qu("Query.endBefore",arguments,1);var r=this.Sf("Query.endBefore",t,e,!0);return new pc(this.pf.Jt(r),this.firestore,this.wf)},pc.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];qu("Query.endAt",arguments,1);var r=this.Sf("Query.endAt",t,e,!1);return new pc(this.pf.Jt(r),this.firestore,this.wf)},pc.prototype.isEqual=function(t){if(!(t instanceof pc))throw Yu("isEqual","Query",1,t);return this.firestore===t.firestore&&this.pf.isEqual(t.pf)},pc.prototype.withConverter=function(t){return new pc(this.pf,this.firestore,t)},pc.prototype.Sf=function(t,e,n,r){if(Xu(t,1,e),e instanceof sc){if(0<n.length)throw new Nr(Tr.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var i=e;if(!i.exists)throw new Nr(Tr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.Cf(i.Af,r)}var o=[e].concat(n);return this.Df(t,o,r)},pc.prototype.Cf=function(t,e){for(var n=[],r=0,i=this.pf.orderBy;r<i.length;r++){var o=i[r];if(o.field.Y())n.push(di(this.firestore.Zo,t.key));else{var s=t.field(o.field);if(ni(s))throw new Nr(Tr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===s){var u=o.field.j();throw new Nr(Tr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}n.push(s)}}return new Do(n,e)},pc.prototype.Df=function(t,e,n){var r=this.pf.Mt;if(e.length>r.length)throw new Nr(Tr.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<e.length;o++){var s=e[o];if(r[o].field.Y()){if("string"!=typeof s)throw new Nr(Tr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof s);if(!this.pf.le()&&-1!==s.indexOf("/"))throw new Nr(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+s+"' contains a slash.");var u=this.pf.path.child(Vr.G(s));if(!Qr.et(u))throw new Nr(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+u+"' is not because it contains an odd number of segments.");var a=new Qr(u);i.push(di(this.firestore.Zo,a))}else{var h=this.firestore.nf.Jo(t,s);i.push(h)}}return new Do(i,n)},pc.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];xu("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!=typeof t[i]||Jh(t[i])||(Ju("Query.onSnapshot",r=t[i],["includeMetadataChanges"]),Bu("Query.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++),n=Jh(t[i])?t[i]:(Fu("Query.onSnapshot","function",i,t[i]),ju("Query.onSnapshot","function",i+1,t[i+1]),ju("Query.onSnapshot","function",i+2,t[i+2]),{next:t[i],error:t[i+1],complete:t[i+2]}),this.Ff(this.pf),this.If(r,n)},pc.prototype.If=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Fh({next:function(t){e.next&&e.next(new hc(n.firestore,n.pf,t,n.wf))},error:r}),o=this.firestore.X_(),s=o.listen(this.pf,i,t);return function(){i.x_(),o.pu(s)}},pc.prototype.Ff=function(t){if(t.ae()&&0===t.Mt.length)throw new Nr(Tr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},pc.prototype.get=function(n){var r=this;return xu("Query.get",arguments,0,1),Nc("Query.get",n),this.Ff(this.pf),new Promise(function(e,t){n&&"cache"===n.source?r.firestore.X_().q_(r.pf).then(function(t){e(new hc(r.firestore,r.pf,t,r.wf))},t):r.Rf(e,t,n)})},pc.prototype.Rf=function(e,n,r){var i=this.If({includeMetadataChanges:!0,Il:!0},{next:function(t){i(),t.metadata.fromCache&&r&&"server"===r.source?n(new Nr(Tr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):e(t)},error:n})},pc.prototype.gf=function(t){if("string"==typeof t){if(""===t)throw new Nr(Tr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.pf.le()&&-1!==t.indexOf("/"))throw new Nr(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this.pf.path.child(Vr.G(t));if(!Qr.et(e))throw new Nr(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return di(this.firestore.Zo,new Qr(e))}if(t instanceof ic)return di(this.firestore.Zo,t.ta);throw new Nr(Tr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Qu(t)+".")},pc.prototype.yf=function(t,e){if(!Array.isArray(t)||0===t.length)throw new Nr(Tr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Nr(Tr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new Nr(Tr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Nr(Tr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},pc.prototype.bf=function(t){if(t instanceof Ao){var e=["array-contains","array-contains-any"],n=["in","array-contains-any"],r=0<=e.indexOf(t.op),i=0<=n.indexOf(t.op);if(t.ue()){var o=this.pf.jt();if(null!==o&&!o.isEqual(t.field))throw new Nr(Tr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var s=this.pf.Gt();null!==s&&this.Nf(t.field,s)}else if(i||r){var u=null;if(i&&(u=this.pf.ce(n)),null===u&&r&&(u=this.pf.ce(e)),null!=u)throw u===t.op?new Nr(Tr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new Nr(Tr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+u.toString()+"' filters.")}}},pc.prototype.vf=function(t){var e;null!==this.pf.Gt()||null!==(e=this.pf.jt())&&this.Nf(e,t.field)},pc.prototype.Nf=function(t,e){if(!e.isEqual(t))throw new Nr(Tr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},pc),hc=(Object.defineProperty(lc.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!0,configurable:!0}),Object.defineProperty(lc.prototype,"empty",{get:function(){return this.Lf.docs.M()},enumerable:!0,configurable:!0}),Object.defineProperty(lc.prototype,"size",{get:function(){return this.Lf.docs.size},enumerable:!0,configurable:!0}),lc.prototype.forEach=function(e,n){var r=this;xu("QuerySnapshot.forEach",arguments,1,2),Fu("QuerySnapshot.forEach","function",1,e),this.Lf.docs.forEach(function(t){e.call(n,r.qf(t))})},Object.defineProperty(lc.prototype,"query",{get:function(){return new ac(this.$f,this.ff,this.wf)},enumerable:!0,configurable:!0}),lc.prototype.docChanges=function(t){t&&(Ju("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Bu("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.Lf.hs)throw new Nr(Tr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.kf&&this.Of===e||(this.kf=function(i,e,o,s){if(o.ss.M()){var n=0;return o.docChanges.map(function(t){var e=new uc(i,t.doc.key,t.doc,o.fromCache,o.ns.has(t.doc.key),s);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var u=o.ss;return o.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new uc(i,t.doc.key,t.doc,o.fromCache,o.ns.has(t.doc.key),s),n=-1,r=-1;return 0!==t.type&&(n=u.indexOf(t.doc.key),u=u.delete(t.doc.key)),1!==t.type&&(r=(u=u.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Bs()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.ff,e,this.Lf,this.wf),this.Of=e),this.kf},lc.prototype.isEqual=function(t){if(!(t instanceof lc))throw Yu("isEqual","QuerySnapshot",1,t);return this.ff===t.ff&&this.$f.isEqual(t.$f)&&this.Lf.isEqual(t.Lf)&&this.wf===t.wf},lc.prototype.qf=function(t){return new uc(this.ff,t.key,t,this.metadata.fromCache,this.Lf.ns.has(t.key),this.wf)},lc),cc=(n(fc,Yh=ac),Object.defineProperty(fc.prototype,"id",{get:function(){return this.pf.path.q()},enumerable:!0,configurable:!0}),Object.defineProperty(fc.prototype,"parent",{get:function(){var t=this.pf.path.k();return t.M()?null:new ic(new Qr(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(fc.prototype,"path",{get:function(){return this.pf.path.j()},enumerable:!0,configurable:!0}),fc.prototype.doc=function(t){if(xu("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Hs.cn()),Fu("CollectionReference.doc","non-empty string",1,t),""===t)throw new Nr(Tr.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=Vr.G(t);return ic.lf(this.pf.path.child(e),this.firestore,this.wf)},fc.prototype.add=function(t){Uu("CollectionReference.add",arguments,1),Fu("CollectionReference.add","object",1,this.wf?this.wf.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},fc.prototype.withConverter=function(t){return new fc(this.Mf,this.firestore,t)},fc);function fc(t,e,n){var r=this;if(((r=Yh.call(this,Io.Wt(t),e,n)||this).Mf=t).length%2!=1)throw new Nr(Tr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.j()+" has "+t.length);return r}function lc(t,e,n,r){this.ff=t,this.$f=e,this.Lf=n,this.wf=r,this.kf=null,this.Of=null,this.metadata=new oc(n.hasPendingWrites,n.fromCache)}function pc(t,e,n){this.pf=t,this.firestore=e,this.wf=n}function dc(){return null!==Zh&&Zh.apply(this,arguments)||this}function yc(t,e,n,r,i,o){this.ff=t,this.ta=e,this.Af=n,this.Pf=r,this.Vf=i,this.wf=o}function vc(t,e){this.hasPendingWrites=t,this.fromCache=e}function gc(t,e,n){this.ta=t,this.firestore=e,this.wf=n,this.J_=this.firestore.X_()}function mc(t){this.ff=t,this.Tf=[],this.Ef=!1}function wc(t,e){this.ff=t,this.df=e}function bc(t,e,n){var r=this;if(void 0===n&&(n=new qh),this.z_=null,this.Y_=new Au,this.INTERNAL={delete:function(){return l(r,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return this.X_(),[4,this.J_.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var i=t;this.z_=i,this.Zo=bc.Z_(i),this.tf=i.name,this.ef=new Rr(e)}else{var o=t;if(!o.projectId)throw new Nr(Tr.INVALID_ARGUMENT,"Must provide projectId");this.Zo=new Ys(o.projectId,o.database),this.tf="[DEFAULT]",this.ef=new _r}this.sf=n,this.if=new tc({}),this.nf=new Oa(this.Zo)}function Ec(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new Nr(Tr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Gu("settings","non-empty string","host",t.host),this.host=t.host,Bu("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(Ju("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),Bu("settings","object","credentials",t.credentials),this.credentials=t.credentials,Bu("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),!0===t.timestampsInSnapshots?js("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&js("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,Bu("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Ru.rh;else{if(t.cacheSizeBytes!==$h&&t.cacheSizeBytes<Ru.nh)throw new Nr(Tr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Ru.nh);this.cacheSizeBytes=t.cacheSizeBytes}Bu("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=void 0!==t.experimentalForceLongPolling&&t.experimentalForceLongPolling}function Ic(t,e,n,r){this.firestore=t,this.timestampsInSnapshots=e,this.B_=n,this.converter=r}function Ac(t,e){if(void 0===e)return{merge:!1};if(Ju(t,e,["merge","mergeFields"]),Bu(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Nr(Tr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Qu(n));for(var r,i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof ra))throw new Nr(Tr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+Qu(n[i]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Nr(Tr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function Tc(t,e){return void 0===e?{}:(Ju(t,e,["serverTimestamps"]),zu(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Nc(t,e){ju(t,"object",1,e),e&&(Ju(t,e,["source"]),zu(t,0,"source",e.source,["default","server","cache"]))}function _c(t,e,n){if(e instanceof ic){if(e.firestore!==n)throw new Nr(Tr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Yu(t,"DocumentReference",1,e)}function Rc(t,e,n){var r;return t?(r=t.toFirestore(e),n="toFirestore() in "+n):r=e,[r,n]}function Sc(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new Nr(Tr.INVALID_ARGUMENT,t)}return n.prototype=t.prototype,Object.assign(n,t),n}var Dc,kc=Sc(ec,"Use firebase.firestore() instead."),Lc=Sc(nc,"Use firebase.firestore().runTransaction() instead."),Oc=Sc(rc,"Use firebase.firestore().batch() instead."),Vc=Sc(ic,"Use firebase.firestore().doc() instead."),Mc=Sc(sc),Pc=Sc(uc),Cc=Sc(ac),Uc=Sc(hc),qc=Sc(cc,"Use firebase.firestore().collection() instead."),xc=Sc((Kc.delete=function(){return Cu("FieldValue.delete",arguments),new pa},Kc.serverTimestamp=function(){return Cu("FieldValue.serverTimestamp",arguments),new da},Kc.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return qu("FieldValue.arrayUnion",arguments,1),new ya(t)},Kc.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return qu("FieldValue.arrayRemove",arguments,1),new va(t)},Kc.increment=function(t){return Fu("FieldValue.increment","number",1,t),Uu("FieldValue.increment",arguments,1),new ga(t)},Kc.prototype.isEqual=function(t){return this===t},Kc),"Use FieldValue.<field>() instead."),Fc=Sc(na,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),jc={Firestore:kc,GeoPoint:ma,Timestamp:kr,Blob:Fc,Transaction:Lc,WriteBatch:Oc,DocumentReference:Vc,DocumentSnapshot:Mc,Query:Cc,QueryDocumentSnapshot:Pc,QuerySnapshot:Uc,CollectionReference:qc,FieldPath:ra,FieldValue:xc,setLogLevel:ec.setLogLevel,CACHE_SIZE_UNLIMITED:$h},Gc=(Zc.prototype.nu=function(t){},Zc.prototype.Pu=function(){},Zc),Bc=(Yc.prototype.nu=function(t){this.Wf.push(t)},Yc.prototype.Pu=function(){window.removeEventListener("online",this.xf),window.removeEventListener("offline",this.Uf)},Yc.prototype.jf=function(){window.addEventListener("online",this.xf),window.addEventListener("offline",this.Uf)},Yc.prototype.Bf=function(){Fs("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Wf;t<e.length;t++)(0,e[t])(0)},Yc.prototype.Qf=function(){Fs("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Wf;t<e.length;t++)(0,e[t])(1)},Yc.Gf=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Yc),zc=(Jc.prototype.Ra=function(t){this.zf=t},Jc.prototype.wa=function(t){this.Yf=t},Jc.prototype.onMessage=function(t){this.Xf=t},Jc.prototype.close=function(){this.Kf()},Jc.prototype.send=function(t){this.Hf(t)},Jc.prototype.Jf=function(){this.zf()},Jc.prototype.Zf=function(t){this.Yf(t)},Jc.prototype.td=function(t){this.Xf(t)},Jc),Hc={BatchGetDocuments:"batchGet",Commit:"commit"},Wc="gl-js/ fire/"+mr,Qc=(Xc.prototype.sd=function(t,e){if(e)for(var n in e.o)e.o.hasOwnProperty(n)&&(t[n]=e.o[n]);t["X-Goog-Api-Client"]=Wc},Xc.prototype.Fa=function(a,r,i){var h=this,c=this.nd(a);return new Promise(function(o,s){var u=new gr;u.listenOnce(yr.COMPLETE,function(){try{switch(u.getLastErrorCode()){case dr.NO_ERROR:var t=u.getResponseJson();Fs("Connection","XHR received:",JSON.stringify(t)),o(t);break;case dr.TIMEOUT:Fs("Connection",'RPC "'+a+'" timed out'),s(new Nr(Tr.DEADLINE_EXCEEDED,"Request time out"));break;case dr.HTTP_ERROR:var e,n,r=u.getStatus();Fs("Connection",'RPC "'+a+'" failed with status:',r,"response text:",u.getResponseText()),0<r?(e=u.getResponseJson().error)&&e.status&&e.message?(i=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(Tr).indexOf(i)?i:Tr.UNKNOWN,s(new Nr(n,e.message))):s(new Nr(Tr.UNKNOWN,"Server responded with status "+u.getStatus())):(Fs("Connection",'RPC "'+a+'" failed'),s(new Nr(Tr.UNAVAILABLE,"Connection failed.")));break;default:Bs()}}finally{Fs("Connection",'RPC "'+a+'" completed.')}var i});var t=Object.assign({},r);delete t.database;var e=JSON.stringify(t);Fs("Connection","XHR sending: ",c+" "+e);var n={"Content-Type":"text/plain"};h.sd(n,i),u.send(c,"POST",e,n,15)})},Xc.prototype.Na=function(t,e,n){return this.Fa(t,e,n)},Xc.prototype.Aa=function(t,e){var n,r,i=[this.ed,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=pr(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.ii.projectId+"/databases/"+this.ii.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.sd(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(d())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=d().indexOf("Electron/")||0<=(r=d()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=d().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Fs("Connection","Creating WebChannel: "+u+" "+s);var h=o.createWebChannel(u,s),c=!1,f=!1,l=new zc({Hf:function(t){f?Fs("Connection","Not sending because WebChannel is closed:",t):(c||(Fs("Connection","Opening WebChannel transport."),h.open(),c=!0),Fs("Connection","WebChannel sending:",t),h.send(t))},Kf:function(){return h.close()}});return a(vr.EventType.OPEN,function(){f||Fs("Connection","WebChannel transport opened.")}),a(vr.EventType.CLOSE,function(){f||(f=!0,Fs("Connection","WebChannel transport closed"),l.Zf())}),a(vr.EventType.ERROR,function(t){f||(f=!0,Fs("Connection","WebChannel transport errored:",t),l.Zf(new Nr(Tr.UNAVAILABLE,"The operation could not be completed")))}),a(vr.EventType.MESSAGE,function(t){var e,n,r,i,o,s;f||(zs(!!(n=t.data[0])),(r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(Fs("Connection","WebChannel received error:",r),i=r.status,o=function(){var t=so[i];if(void 0!==t)return Qo(t)}(),s=r.message,void 0===o&&(o=Tr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),f=!0,l.Zf(new Nr(o,s)),h.close()):(Fs("Connection","WebChannel received:",n),l.td(n)))}),setTimeout(function(){l.Jf()},0),l},Xc.prototype.nd=function(t){var e=Hc[t];return this.ed+"/v1/projects/"+this.ii.projectId+"/databases/"+this.ii.database+"/documents:"+e},Xc);function Xc(t){this.ii=t.ii;var e=t.ssl?"https":"http";this.ed=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function Jc(t){this.Hf=t.Hf,this.Kf=t.Kf}function Yc(){var t=this;this.xf=function(){return t.Bf()},this.Uf=function(){return t.Qf()},this.Wf=[],this.jf()}function Zc(){}function Kc(){}function $c(){this.bo="undefined"!=typeof atob}Ps.an((Object.defineProperty($c.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty($c.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),$c.prototype.C_=function(t){return Promise.resolve(new Qc(t))},$c.prototype.g_=function(){return new(Bc.Gf()?Bc:Gc)},$c.prototype.Go=function(t){return new Os(t,{hi:!0})},$c.prototype.un=function(t){return JSON.stringify(t)},$c.prototype.atob=function(t){return atob(t)},$c.prototype.btoa=function(t){return btoa(t)},$c.prototype.ln=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n},new $c)),(Dc=tf).INTERNAL.registerComponent(new E("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new ec(e,n,new qh);var e,n},"PUBLIC").setServiceProps(Object.assign({},jc))),Dc.registerVersion("@firebase/firestore","1.14.5")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
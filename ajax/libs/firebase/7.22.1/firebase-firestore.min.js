!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(wv){"use strict";try{(function(){var t,l,e,n,r=(n=wv)&&"object"==typeof n&&"default"in n?n:{default:n},i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function o(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function m(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function w(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function u(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function a(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=f[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,u(["["+i+"]  "+t.name+":"],n))}}(e=l=l||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";var c={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},h=l.INFO,f=((t={})[l.DEBUG]="log",t[l.VERBOSE]="log",t[l.INFO]="info",t[l.WARN]="warn",t[l.ERROR]="error",t),p=(Object.defineProperty(d.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),d.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?c[t]:t},Object.defineProperty(d.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),d.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.DEBUG],t)),this._logHandler.apply(this,u([this,l.DEBUG],t))},d.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.VERBOSE],t)),this._logHandler.apply(this,u([this,l.VERBOSE],t))},d.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.INFO],t)),this._logHandler.apply(this,u([this,l.INFO],t))},d.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.WARN],t)),this._logHandler.apply(this,u([this,l.WARN],t))},d.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,u([this,l.ERROR],t)),this._logHandler.apply(this,u([this,l.ERROR],t))},d);function d(t){this.name=t,this._logLevel=h,this._logHandler=a,this._userLogHandler=null}function v(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var y,g="FirebaseError",b=(o(I,y=Error),I);function I(t,e){var n=y.call(this,e)||this;return n.code=t,n.name=g,Object.setPrototypeOf(n,I.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,E.prototype.create),n}var E=(T.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(r=i,s.replace(_,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",c=new b(o,a),h=0,f=Object.keys(i);h<f.length;h++){var l=f[h];"_"!==l.slice(-1)&&(l in c&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),c[l]=i[l])}return c},T);function T(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var _=/\{\$([^}]+)}/g,A=function(t,e){return(A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function N(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var S,D="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},x=D||self;function O(){}function R(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function k(t){var e=R(t);return"array"==e||"object"==e&&"number"==typeof t.length}function L(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var C="closure_uid_"+(1e9*Math.random()>>>0),P=0;function U(t,e,n){return t.call.apply(t.bind,arguments)}function V(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function M(t,e,n){return(M=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?U:V).apply(null,arguments)}function F(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var q=Date.now;function j(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function G(){this.j=this.j,this.i=this.i}G.prototype.j=!1,G.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,C)&&this[C]||(this[C]=++P))},G.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var B=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},z=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function H(t){return Array.prototype.concat.apply([],arguments)}function Q(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function K(t){return/^[\s\xa0]*$/.test(t)}var W,Y=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function $(t,e){return t<e?-1:e<t?1:0}t:{var J=x.navigator;if(J){var Z=J.userAgent;if(Z){W=Z;break t}}W=""}function tt(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function et(t){var e,n={};for(e in t)n[e]=t[e];return n}var nt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function rt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<nt.length;o++)n=nt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function it(t){return it[" "](t),t}it[" "]=O;var ot,st,ut=X(W,"Opera"),at=X(W,"Trident")||X(W,"MSIE"),ct=X(W,"Edge"),ht=ct||at,ft=X(W,"Gecko")&&!(X(W.toLowerCase(),"webkit")&&!X(W,"Edge"))&&!(X(W,"Trident")||X(W,"MSIE"))&&!X(W,"Edge"),lt=X(W.toLowerCase(),"webkit")&&!X(W,"Edge");function pt(){var t=x.document;return t?t.documentMode:void 0}t:{var dt="",vt=(st=W,ft?/rv:([^\);]+)(\)|;)/.exec(st):ct?/Edge\/([\d\.]+)/.exec(st):at?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(st):lt?/WebKit\/(\S+)/.exec(st):ut?/(?:Version)[ \/]?(\S+)/.exec(st):void 0);if(vt&&(dt=vt?vt[1]:""),at){var yt=pt();if(null!=yt&&yt>parseFloat(dt)){ot=String(yt);break t}}ot=dt}var gt={};function mt(u){return t=u,e=function(){for(var t=0,e=Y(String(ot)).split("."),n=Y(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=$(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||$(0==o[2].length,0==s[2].length)||$(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=gt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var wt=x.document&&at&&(pt()||parseInt(ot,10))||void 0,bt=!at||9<=Number(wt),It=at&&!mt("9"),Et=function(){if(!x.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{x.addEventListener("test",O,e),x.removeEventListener("test",O,e)}catch(t){}return t}();function Tt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function _t(t,e){if(Tt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ft){t:{try{it(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:At[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Tt.prototype.b=function(){this.defaultPrevented=!0},j(_t,Tt);var At={2:"touch",3:"pen",4:"mouse"};_t.prototype.b=function(){_t.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,It)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Nt="closure_listenable_"+(1e6*Math.random()|0),St=0;function Dt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++St,this.Y=this.Z=!1}function xt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Ot(t){this.src=t,this.a={},this.b=0}function Rt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=B(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(xt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function kt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Ot.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=kt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Dt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Lt="closure_lm_"+(1e6*Math.random()|0),Ct={};function Pt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Bt(r),e&&e[Nt]?e.wa(n,r,L(i)?!!i.capture:!!i,o):Ut(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Pt(t,e[o],n,r,i);return null}return n=Bt(n),t&&t[Nt]?t.va(e,n,L(r)?!!r.capture:!!r,i):Ut(t,e,n,!1,r,i)}function Ut(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=L(i)?!!i.capture:!!i;if(s&&!bt)return null;var u,a,c=jt(t);if(c||(t[Lt]=c=new Ot(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=qt,r=a=bt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)Et||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Mt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Vt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Nt]?Rt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Mt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=jt(e))?(Rt(n,t),0==n.b&&(n.src=null,e[Lt]=null)):xt(t)))}function Mt(t){return t in Ct?Ct[t]:Ct[t]="on"+t}function Ft(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Vt(t),n.call(r,e)}function qt(t,e){if(t.Y)return!0;if(bt)return Ft(t,new _t(e,this));if(!e)t:{e=["window","event"];for(var n=x,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ft(t,e=new _t(e,this))}function jt(t){return(t=t[Lt])instanceof Ot?t:null}var Gt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Bt(e){return"function"==R(e)?e:(e[Gt]||(e[Gt]=function(t){return e.handleEvent(t)}),e[Gt])}function zt(){G.call(this),this.c=new Ot(this),(this.J=this).C=null}function Ht(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Rt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}j(zt,G),zt.prototype[Nt]=!0,(S=zt.prototype).addEventListener=function(t,e,n,r){Pt(this,t,e,n,r)},S.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=L(i)?!!i.capture:!!i,r=Bt(r),e&&e[Nt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=kt(s=e.a[n],r,i,o))&&(xt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&jt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=kt(n,r,i,o)),(r=-1<e?n[e]:null)&&Vt(r))}(this,t,e,n,r)},S.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new Tt(t,n):t instanceof Tt?t.target=t.target||n:(s=t,rt(t=new Tt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=Ht(o,r,!0,t)&&s;if(s=Ht(o=t.a=n,r,!0,t)&&s,s=Ht(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Ht(o=t.a=e[i],r,!1,t)&&s;return s},S.G=function(){if(zt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)xt(n[r]);delete e.a[t],e.b--}}this.C=null},S.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},S.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Qt=x.JSON.stringify;function Kt(){this.b=this.a=null}var Wt,Yt=(Xt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Xt(function(){return new $t},function(t){t.reset()},100));function Xt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function $t(){this.next=this.b=this.a=null}function Jt(t,e){var n;Wt||(n=x.Promise.resolve(void 0),Wt=function(){n.then(ee)}),Zt||(Wt(),Zt=!0),te.add(t,e)}Kt.prototype.add=function(t,e){var n=Yt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},$t.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Zt=!($t.prototype.reset=function(){this.next=this.b=this.a=null}),te=new Kt;function ee(){for(var t,e,n;n=e=void 0,n=null,(e=te).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){x.setTimeout(function(){throw t},0)}(t)}var r=Yt;r.g(t),r.b<r.f&&(r.b++,t.next=r.a,r.a=t)}Zt=!1}function ne(t,e){zt.call(this),this.b=t||1,this.a=e||x,this.f=M(this.Ya,this),this.g=q()}function re(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ie(t,e,n){if("function"==R(t))n&&(t=M(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=M(t.handleEvent,t)}return 2147483647<Number(e)?-1:x.setTimeout(t,e||0)}j(ne,zt),(S=ne.prototype).aa=!1,S.M=null,S.Ya=function(){var t;this.aa&&(0<(t=q()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(re(this),this.start())))},S.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=q())},S.G=function(){ne.S.G.call(this),re(this),delete this.a};var oe,se,ue,ae=(A(se=he,ue=oe=G),se.prototype=null===ue?Object.create(ue):(ce.prototype=ue.prototype,new ce),he.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ie(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},he.prototype.G=function(){oe.prototype.G.call(this),this.a&&(x.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},he);function ce(){this.constructor=se}function he(t,e,n){var r=oe.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function fe(t){G.call(this),this.b=t,this.a={}}j(fe,G);var le=[];function pe(t,e,n,r){Array.isArray(n)||(n&&(le[0]=n.toString()),n=le);for(var i=0;i<n.length;i++){var o=Pt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function de(t){tt(t.a,function(t,e){this.a.hasOwnProperty(e)&&Vt(t)},t),t.a={}}function ve(){this.a=!0}function ye(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return Qt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}fe.prototype.G=function(){fe.S.G.call(this),de(this)},fe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ve.prototype.info=function(){};var ge=null;function me(){return ge=ge||new zt}function we(t){Tt.call(this,"serverreachability",t)}function be(){var t=me();t.dispatchEvent(new we(t))}function Ie(t){Tt.call(this,"statevent",t)}function Ee(){var t=me();t.dispatchEvent(new Ie(t))}function Te(t){Tt.call(this,"timingevent",t)}function _e(t,e){if("function"!=R(t))throw Error("Fn must not be null and must be a function");return x.setTimeout(function(){t()},e)}j(we,Tt),j(Ie,Tt),j(Te,Tt);var Ae={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ne={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Se(){}function De(t){var e;return(e=t.a)||(e=t.a={}),e}function xe(){}Se.prototype.a=null;var Oe,Re={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function ke(){Tt.call(this,"d")}function Le(){Tt.call(this,"c")}function Ce(){}function Pe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new fe(this),this.P=Ue,t=ht?125:void 0,this.R=new ne(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}j(ke,Tt),j(Le,Tt),j(Ce,Se),Oe=new Ce;var Ue=45e3,Ve={},Me={};function Fe(t,e,n){t.H=1,t.i=un(tn(e)),t.j=n,t.I=!0,qe(t,null)}function qe(t,e){t.u=q(),Ge(t),t.l=tn(t.i);var s,u,a,c,h,f,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),bn(n.b,"t",r),t.D=0,t.a=pr(t.g,t.g.C?e:null),0<t.O&&(t.F=new ae(M(t.Ca,t,t.a),t.O)),pe(t.J,t.a,"readystatechange",t.Wa),e=t.B?et(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),be(),s=t.c,u=t.m,a=t.l,c=t.f,h=t.T,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function je(t,e,n){for(var r,i,o,s,u=!0;!t.A&&t.D<n.length;){var a=(i=n,s=o=void 0,o=(r=t).D,-1==(s=i.indexOf("\n",o))?Me:(o=Number(i.substring(o,s)),isNaN(o)?Ve:(s+=1)+o>i.length?Me:(i=i.substr(s,o),r.D=s+o,i)));if(a==Me){4==e&&(t.h=4,Ee(),u=!1),ye(t.c,t.f,null,"[Incomplete Response]");break}if(a==Ve){t.h=4,Ee(),ye(t.c,t.f,n,"[Invalid Chunk]"),u=!1;break}ye(t.c,t.f,a,null),Ke(t,a)}4==e&&0==n.length&&(t.h=1,Ee(),u=!1),t.b=t.b&&u,u?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),or(e),e.F=!0)):(ye(t.c,t.f,n,"[Invalid Chunked Response]"),Qe(t),He(t))}function Ge(t){t.U=q()+t.P,Be(t,t.P)}function Be(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=_e(M(t.Ua,t),e)}function ze(t){t.o&&(x.clearTimeout(t.o),t.o=null)}function He(t){0==t.g.v||t.A||ar(t.g,t)}function Qe(t){ze(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,re(t.R),de(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ke(t,e){try{var n,r,i,o,s,u,a,c,h,f,l,p=t.g;if(0!=p.v&&(p.a==t||Sn(p.b,t)))if(p.I=t.N,!t.C&&Sn(p.b,t)&&3==p.v){try{var d=p.ka.a.parse(e)}catch(t){d=null}if(Array.isArray(d)&&3==d.length){var v=d;if(0==v[0]){t:if(!p.j){if(p.a){if(!(p.a.u+3e3<t.u))break t;ur(p),Xn(p)}ir(p),Ee()}}else p.oa=v[1],0<p.oa-p.P&&v[2]<37500&&p.H&&0==p.o&&!p.m&&(p.m=_e(M(p.Ra,p),6e3));if(Nn(p.b)<=1&&p.ea){try{p.ea()}catch(t){}p.ea=void 0}}else hr(p,11)}else if(!t.C&&p.a!=t||ur(p),!K(e))for(e=d=p.ka.a.parse(e),d=0;d<e.length;d++)v=e[d],p.P=v[0],v=v[1],2==p.v?"c"==v[0]?(p.J=v[1],p.ga=v[2],null!=(n=v[3])&&(p.ha=n,p.c.info("VER="+p.ha)),null!=(r=v[4])&&(p.pa=r,p.c.info("SVER="+p.pa)),null!=(i=v[5])&&"number"==typeof i&&0<i&&(o=1.5*i,p.D=o,p.c.info("backChannelRequestTimeoutMs_="+o)),o=p,(s=t.a)&&(!(u=s.a?s.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(a=o.b).a&&(X(u,"spdy")||X(u,"quic")||X(u,"h2"))&&(a.f=a.g,a.a=new Set,a.b&&(Dn(a,a.b),a.b=null)),!o.A||(c=s.a?s.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(o.na=c,sn(o.B,o.A,c))),p.v=3,p.f&&p.f.ta(),p.V&&(p.N=q()-t.u,p.c.info("Handshake RTT: "+p.N+"ms")),h=t,(o=p).la=lr(o,o.C?o.ga:null,o.fa),h.C?(xn(o.b,h),f=h,(l=o.D)&&f.setTimeout(l),f.o&&(ze(f),Ge(f)),o.a=h):rr(o),0<p.g.length&&Zn(p)):"stop"!=v[0]&&"close"!=v[0]||hr(p,7):3==p.v&&("stop"==v[0]||"close"==v[0]?"stop"==v[0]?hr(p,7):Yn(p):"noop"!=v[0]&&p.f&&p.f.sa(v),p.o=0);be()}catch(t){}}function We(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(k(t)||"string"==typeof t)z(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(k(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(k(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ye(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ye)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Xe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];$e(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)$e(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function $e(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(S=Pe.prototype).setTimeout=function(t){this.P=t},S.Wa=function(t){t=t.target;var e=this.F;e&&3==Hn(t)?e.f():this.Ca(t)},S.Ca=function(t){try{if(t==this.a)t:{var e=Hn(this.a),n=this.a.ua();this.a.X();if(!(e<3||3==e&&!ht&&!this.a.$())){this.A||4!=e||7==n||be(),ze(this);var r=this.a.X();this.N=r;var i=this.a.$();if(this.b=200==r,a=this.c,c=this.m,h=this.l,f=this.f,l=this.T,p=e,d=r,a.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+l+"]: "+c+"\n"+h+"\n"+p+" "+d}),this.b){if(this.V&&!this.C){e:{if(this.a){var o,s=this.a;if((o=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(o)){var u=o;break e}}u=null}if(!u){this.b=!1,this.h=3,Ee(),Qe(this),He(this);break t}ye(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ke(this,u)}this.I?(je(this,e,i),ht&&this.b&&3==e&&(pe(this.J,this.R,"tick",this.Va),this.R.start())):(ye(this.c,this.f,i,null),Ke(this,i)),4==e&&Qe(this),this.b&&!this.A&&(4==e?ar(this.g,this):(this.b=!1,Ge(this)))}else 400==r&&0<i.indexOf("Unknown SID")?this.h=3:this.h=0,Ee(),Qe(this),He(this)}}}catch(t){}var a,c,h,f,l,p,d},S.Va=function(){var t,e;this.a&&(t=Hn(this.a),e=this.a.$(),this.D<e.length&&(ze(this),je(this,t,e),this.b&&4!=t&&Ge(this)))},S.cancel=function(){this.A=!0,Qe(this)},S.Ua=function(){this.o=null;var t,e,n=q();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(be(),Ee()),Qe(this),this.h=2,He(this)):Be(this,this.U-n)},(S=Ye.prototype).K=function(){Xe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},S.L=function(){return Xe(this),this.a.concat()},S.get=function(t,e){return $e(this.b,t)?this.b[t]:e},S.set=function(t,e){$e(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},S.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Je=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ze(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ze?(this.a=void 0!==e?e:t.a,en(this,t.f),this.j=t.j,nn(this,t.c),rn(this,t.h),this.g=t.g,e=t.b,(n=new yn).c=e.c,e.a&&(n.a=new Ye(e.a),n.b=e.b),on(this,n),this.i=t.i):t&&(n=String(t).match(Je))?(this.a=!!e,en(this,n[1]||"",!0),this.j=an(n[2]||""),nn(this,n[3]||"",!0),rn(this,n[4]),this.g=an(n[5]||"",!0),on(this,n[6]||"",!0),this.i=an(n[7]||"")):(this.a=!!e,this.b=new yn(null,this.a))}function tn(t){return new Ze(t)}function en(t,e,n){t.f=n?an(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function nn(t,e,n){t.c=n?an(e,!0):e}function rn(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function on(t,e,n){var r,i;e instanceof yn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(gn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(mn(this,e),bn(this,n,t))},r)),r.f=i):(n||(e=cn(e,dn)),t.b=new yn(e,t.a))}function sn(t,e,n){t.b.set(e,n)}function un(t){return sn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^q()).toString(36)),t}function an(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function cn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,hn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function hn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ze.prototype.toString=function(){var t=[],e=this.f;e&&t.push(cn(e,fn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(cn(e,fn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(cn(n,"/"==n.charAt(0)?pn:ln,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",cn(n,vn)),t.join("")};var fn=/[#\/\?@]/g,ln=/[#\?:]/g,pn=/[#\?]/g,dn=/[#\?@]/g,vn=/#/g;function yn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function gn(u){u.a||(u.a=new Ye,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function mn(t,e){gn(t),e=In(t,e),$e(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,$e((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Xe(t)))}function wn(t,e){return gn(t),e=In(t,e),$e(t.a.b,e)}function bn(t,e,n){mn(t,e),0<n.length&&(t.c=null,t.a.set(In(t,e),Q(n)),t.b+=n.length)}function In(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function En(t,e){this.b=t,this.a=e}function Tn(t){this.g=t||_n,t=x.PerformanceNavigationTiming?0<(t=x.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(x.ia&&x.ia.ya&&x.ia.ya()&&x.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(S=yn.prototype).add=function(t,e){gn(this),this.c=null,t=In(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},S.forEach=function(n,r){gn(this),this.a.forEach(function(t,e){z(t,function(t){n.call(r,t,e,this)},this)},this)},S.L=function(){gn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},S.K=function(t){gn(this);var e=[];if("string"==typeof t)wn(this,t)&&(e=H(e,this.a.get(In(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=H(e,t[n])}return e},S.set=function(t,e){return gn(this),this.c=null,wn(this,t=In(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},S.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},S.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var _n=10;function An(t){return t.b||t.a&&t.a.size>=t.f}function Nn(t){return t.b?1:t.a?t.a.size:0}function Sn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Dn(t,e){t.a?t.a.add(e):t.b=e}function xn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function On(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return Q(t.c);var r=t.c;try{for(var i=N(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Rn(){}function kn(){this.a=new Rn}function Ln(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}Tn.prototype.cancel=function(){var t,e;if(this.c=On(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=N(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Rn.prototype.stringify=function(t){return x.JSON.stringify(t,void 0)},Rn.prototype.parse=function(t){return x.JSON.parse(t,void 0)};var Cn=x.JSON.parse;function Pn(t){zt.call(this),this.headers=new Ye,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Un,this.D=this.F=!1}j(Pn,zt);var Un="",Vn=/^https?$/i,Mn=["POST","PUT"];function Fn(t){return"content-type"==t.toLowerCase()}function qn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,jn(t),Bn(t)}function jn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Gn(t){if(t.b&&(!t.s[1]||4!=Hn(t)||2!=t.X()))if(t.l&&4==Hn(t))ie(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==Hn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Je)[1]||null)&&x.self&&x.self.location&&(i=(r=x.self.location.protocol).substr(0,r.length-1)),n=!Vn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Hn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",jn(t)}}finally{Bn(t)}}}function Bn(t,e){if(t.a){zn(t);var n=t.a,r=t.s[0]?O:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function zn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(x.clearTimeout(t.m),t.m=null)}function Hn(t){return t.a?t.a.readyState:0}function Qn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",tt(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):sn(t,e,n))}function Kn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Wn(t){this.pa=0,this.g=[],this.c=new ve,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Kn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Kn("baseRetryDelayMs",5e3,t),this.Ma=Kn("retryDelaySeedMs",1e4,t),this.Ja=Kn("forwardChannelMaxRetries",2,t),this.ma=Kn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new Tn(t&&t.concurrentRequestLimit),this.ka=new kn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Yn(t){var e,n;$n(t),3==t.v&&(e=t.R++,sn(n=tn(t.B),"SID",t.J),sn(n,"RID",e),sn(n,"TYPE","terminate"),er(t,n),(e=new Pe(t,t.c,e,void 0)).H=2,e.i=un(tn(n)),n=!1,x.navigator&&x.navigator.sendBeacon&&(n=x.navigator.sendBeacon(e.i.toString(),"")),!n&&x.Image&&((new Image).src=e.i,n=!0),n||(e.a=pr(e.g,null),e.a.ba(e.i)),e.u=q(),Ge(e)),fr(t)}function Xn(t){t.a&&(or(t),t.a.cancel(),t.a=null)}function $n(t){Xn(t),t.j&&(x.clearTimeout(t.j),t.j=null),ur(t),t.b.cancel(),t.h&&("number"==typeof t.h&&x.clearTimeout(t.h),t.h=null)}function Jn(t,e){t.g.push(new En(t.La++,e)),3==t.v&&Zn(t)}function Zn(t){An(t.b)||t.h||(t.h=!0,Jt(t.Ba,t),t.u=0)}function tr(t,e){var n=e?e.f:t.R++,r=tn(t.B);sn(r,"SID",t.J),sn(r,"RID",n),sn(r,"AID",t.P),er(t,r),t.i&&t.l&&Qn(r,t.i,t.l),n=new Pe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=nr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Dn(t.b,n),Fe(n,r,e)}function er(t,n){t.f&&We({},function(t,e){sn(n,e,t)})}function nr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?M(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+c+"_"||"";try{We(t,function(t,e){var n=t;L(t)&&(n=Qt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s)}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function rr(t){t.a||t.j||(t.U=1,Jt(t.Aa,t),t.o=0)}function ir(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=_e(M(t.Aa,t),cr(t,t.o)),t.o++,1)}function or(t){null!=t.s&&(x.clearTimeout(t.s),t.s=null)}function sr(t){t.a=new Pe(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=tn(t.la);sn(e,"RID","rpc"),sn(e,"SID",t.J),sn(e,"CI",t.H?"0":"1"),sn(e,"AID",t.P),er(t,e),sn(e,"TYPE","xmlhttp"),t.i&&t.l&&Qn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=un(tn(e)),n.j=null,n.I=!0,qe(n,t)}function ur(t){null!=t.m&&(x.clearTimeout(t.m),t.m=null)}function ar(t,e){var n,r=null;if(t.a==e){ur(t),or(t),t.a=null;var i=2}else{if(!Sn(t.b,e))return;r=e.s,xn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b)1==i?(r=e.j?e.j.length:0,e=q()-e.u,n=t.u,(i=me()).dispatchEvent(new Te(i)),Zn(t)):rr(t);else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(Nn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=_e(M(t.Ba,t,e),cr(t,t.u)),t.u++,1}}(t,e)||2==i&&ir(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:hr(t,5);break;case 4:hr(t,10);break;case 3:hr(t,6);break;default:hr(t,2)}}function cr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function hr(t,e){var n,r,i,o,s,u;t.c.info("Error code "+e),2==e?(n=null,t.f&&(n=null),r=M(t.Xa,t),n||(n=new Ze("//www.google.com/images/cleardot.gif"),x.location&&"http"==x.location.protocol||en(n,"https"),un(n)),i=n.toString(),o=r,u=new ve,x.Image?((s=new Image).onload=F(Ln,u,s,"TestLoadImage: loaded",!0,o),s.onerror=F(Ln,u,s,"TestLoadImage: error",!1,o),s.onabort=F(Ln,u,s,"TestLoadImage: abort",!1,o),s.ontimeout=F(Ln,u,s,"TestLoadImage: timeout",!1,o),x.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=i):o(!1)):Ee(),t.v=0,t.f&&t.f.ra(e),fr(t),$n(t)}function fr(t){t.v=0,t.I=-1,t.f&&(0==On(t.b).length&&0==t.g.length||(t.b.c.length=0,Q(t.g),t.g.length=0),t.f.qa())}function lr(t,e,n){var r,i,o,s,u,a,c,h=(r=n)instanceof Ze?tn(r):new Ze(r,void 0);return""!=h.c?(e&&nn(h,e+"."+h.c),rn(h,h.h)):(o=(i=x.location).protocol,s=e?e+"."+i.hostname:i.hostname,u=+i.port,a=n,c=new Ze(null,void 0),o&&en(c,o),s&&nn(c,s),u&&rn(c,u),a&&(c.g=a),h=c),t.W&&tt(t.W,function(t,e){sn(h,e,t)}),e=t.A,n=t.na,e&&n&&sn(h,e,n),sn(h,"VER",t.ha),er(t,h),h}function pr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Pn(t.Ka)).F=t.C,e}function dr(){}function vr(){if(at&&!(10<=Number(wt)))throw Error("Environmental error: no available transport.")}function yr(t,e){zt.call(this),this.a=new Wn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!K(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!K(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new wr(this)}function gr(t){ke.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function mr(){Le.call(this),this.status=1}function wr(t){this.a=t}(S=Pn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?De(this.H):De(Oe),this.a.onreadystatechange=M(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void qn(this,t)}t=n||"";var i,o=new Ye(this.headers);r&&We(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Fn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=x.FormData&&t instanceof x.FormData,0<=B(Mn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{zn(this),0<this.o&&((this.D=(i=this.a,at&&mt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=M(this.xa,this)):this.m=ie(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){qn(this,t)}},S.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},S.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Bn(this))},S.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Bn(this,!0)),Pn.S.G.call(this)},S.za=function(){this.j||(this.A||this.l||this.g?Gn(this):this.Ta())},S.Ta=function(){Gn(this)},S.X=function(){try{return 2<Hn(this)?this.a.status:-1}catch(t){return-1}},S.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},S.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Cn(e)}},S.ua=function(){return this.h},S.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(S=Wn.prototype).ha=8,S.v=1,S.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Pe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?rt(r=et(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=nr(this,n,e),sn(i=tn(this.B),"RID",t),sn(i,"CVER",22),this.A&&sn(i,"X-HTTP-Session-Id",this.A),er(this,i),this.i&&r&&Qn(i,this.i,r),Dn(this.b,n),this.Ga&&sn(i,"TYPE","init"),this.da?(sn(i,"$req",e),sn(i,"SID","null"),n.V=!0,Fe(n,i,null)):Fe(n,i,e),this.v=2}}else 3==this.v&&(t?tr(this,t):0==this.g.length||An(this.b)||tr(this))},S.Aa=function(){var t;this.j=null,sr(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=_e(M(this.Sa,this),t))},S.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Xn(this),sr(this))},S.Ra=function(){null!=this.m&&(this.m=null,Xn(this),ir(this),Ee())},S.Xa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),Ee()},(S=dr.prototype).ta=function(){},S.sa=function(){},S.ra=function(){},S.qa=function(){},S.Ha=function(){},vr.prototype.a=function(t,e){return new yr(t,e)},j(yr,zt),(S=yr.prototype).addEventListener=function(t,e,n,r){yr.S.addEventListener.call(this,t,e,n,r)},S.removeEventListener=function(t,e,n,r){yr.S.removeEventListener.call(this,t,e,n,r)},S.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;Ee(),t.fa=e,t.W=n||{},t.H=t.T,t.B=lr(t,null,t.fa),Zn(t)},S.close=function(){Yn(this.a)},S.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Jn(this.a,e)):this.g?((e={}).__data__=Qt(t),Jn(this.a,e)):Jn(this.a,t)},S.G=function(){this.a.f=null,delete this.f,Yn(this.a),delete this.a,yr.S.G.call(this)},j(gr,ke),j(mr,Le),j(wr,dr),wr.prototype.ta=function(){this.a.dispatchEvent("a")},wr.prototype.sa=function(t){this.a.dispatchEvent(new gr(t))},wr.prototype.ra=function(t){this.a.dispatchEvent(new mr)},wr.prototype.qa=function(){this.a.dispatchEvent("b")},vr.prototype.createWebChannel=vr.prototype.a,yr.prototype.send=yr.prototype.Pa,yr.prototype.open=yr.prototype.Oa,Ae.NO_ERROR=0,Ae.TIMEOUT=8,Ae.HTTP_ERROR=6,Ne.COMPLETE="complete",(xe.EventType=Re).OPEN="a",Re.CLOSE="b",Re.ERROR="c",Re.MESSAGE="d",zt.prototype.listen=zt.prototype.va,Pn.prototype.listenOnce=Pn.prototype.wa,Pn.prototype.getLastError=Pn.prototype.Qa,Pn.prototype.getLastErrorCode=Pn.prototype.ua,Pn.prototype.getStatus=Pn.prototype.X,Pn.prototype.getResponseJson=Pn.prototype.Na,Pn.prototype.getResponseText=Pn.prototype.$,Pn.prototype.send=Pn.prototype.ba;var br={createWebChannelTransport:function(){return new vr},ErrorCode:Ae,EventType:Ne,WebChannel:xe,XhrIo:Pn},Ir=br.createWebChannelTransport,Er=br.ErrorCode,Tr=br.EventType,_r=br.WebChannel,Ar=br.XhrIo,Nr=(Sr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Sr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Sr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Sr);function Sr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Dr,xr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Or=(o(kr,Dr=Error),kr),Rr=new p("@firebase/firestore");function kr(t,e){var n=this;return(n=Dr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Lr(){return Rr.logLevel}function Cr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Rr.logLevel<=l.DEBUG&&(e=n.map(Vr),Rr.debug.apply(Rr,s(["Firestore (7.22.1): "+t],e)))}function Pr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Rr.logLevel<=l.ERROR&&(e=n.map(Vr),Rr.error.apply(Rr,s(["Firestore (7.22.1): "+t],e)))}function Ur(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Rr.logLevel<=l.WARN&&(e=n.map(Vr),Rr.warn.apply(Rr,s(["Firestore (7.22.1): "+t],e)))}function Vr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Mr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (7.22.1) INTERNAL ASSERTION FAILED: "+t;throw Pr(e),new Error(e)}function Fr(t){t||Mr()}function qr(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function jr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Gr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Br,zr,Hr=(Object.defineProperty(Zr.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),Zr.prototype.isEqual=function(t){return 0===Zr.i(this,t)},Zr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Zr?t.forEach(function(t){e.push(t)}):e.push(t),this.o(e)},Zr.prototype.limit=function(){return this.offset+this.length},Zr.prototype.u=function(t){return t=void 0===t?1:t,this.o(this.segments,this.offset+t,this.length-t)},Zr.prototype.h=function(){return this.o(this.segments,this.offset,this.length-1)},Zr.prototype.l=function(){return this.segments[this.offset]},Zr.prototype._=function(){return this.get(this.length-1)},Zr.prototype.get=function(t){return this.segments[this.offset+t]},Zr.prototype.m=function(){return 0===this.length},Zr.prototype.T=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Zr.prototype.I=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Zr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Zr.prototype.A=function(){return this.segments.slice(this.offset,this.limit())},Zr.i=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Zr),Qr=(o(Jr,zr=Hr),Jr.prototype.o=function(t,e,n){return new Jr(t,e,n)},Jr.prototype.R=function(){return this.A().join("/")},Jr.prototype.toString=function(){return this.R()},Jr.P=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Or(xr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new Jr(n)},Jr.g=function(){return new Jr([])},Jr),Kr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Wr=(o($r,Br=Hr),$r.prototype.o=function(t,e,n){return new $r(t,e,n)},$r.V=function(t){return Kr.test(t)},$r.prototype.R=function(){return this.A().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),$r.V(t)||(t="`"+t+"`"),t}).join(".")},$r.prototype.toString=function(){return this.R()},$r.prototype.p=function(){return 1===this.length&&"__name__"===this.get(0)},$r.v=function(){return new $r(["__name__"])},$r.S=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Or(xr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Or(xr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Or(xr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Or(xr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new $r(e)},$r.g=function(){return new $r([])},$r),Yr=(Xr.D=function(t){return new Xr(Qr.P(t))},Xr.C=function(t){return new Xr(Qr.P(t).u(5))},Xr.prototype.N=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Xr.prototype.isEqual=function(t){return null!==t&&0===Qr.i(this.path,t.path)},Xr.prototype.toString=function(){return this.path.toString()},Xr.i=function(t,e){return Qr.i(t.path,e.path)},Xr.F=function(t){return t.length%2==0},Xr.$=function(t){return new Xr(new Qr(t.slice()))},Xr);function Xr(t){this.path=t}function $r(){return null!==Br&&Br.apply(this,arguments)||this}function Jr(){return null!==zr&&zr.apply(this,arguments)||this}function Zr(t,e,n){void 0===e?e=0:e>t.length&&Mr(),void 0===n?n=t.length-e:n>t.length-e&&Mr(),this.segments=t,this.offset=e,this.t=n}function ti(t,e){if(0!==e.length)throw new Or(xr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+mi(e.length,"argument")+".")}function ei(t,e,n){if(e.length!==n)throw new Or(xr.INVALID_ARGUMENT,"Function "+t+"() requires "+mi(n,"argument")+", but was called with "+mi(e.length,"argument")+".")}function ni(t,e,n){if(e.length<n)throw new Or(xr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+mi(n,"argument")+", but was called with "+mi(e.length,"argument")+".")}function ri(t,e,n,r){if(e.length<n||e.length>r)throw new Or(xr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+mi(e.length,"argument")+".")}function ii(t,e,n,r){hi(t,e,gi(n)+" argument",r)}function oi(t,e,n,r){void 0!==r&&ii(t,e,n,r)}function si(t,e,n,r){hi(t,e,n+" option",r)}function ui(t,e,n,r){void 0!==r&&si(t,e,n,r)}function ai(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(li(s))}var u=li(n);throw new Or(xr.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function ci(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Or(xr.INVALID_ARGUMENT,"Invalid value "+li(r)+" provided to function "+t+"() for its "+gi(n)+" argument. Acceptable values: "+e.join(", "));return r}function hi(t,e,n,r){if(!("object"===e?fi(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=li(r);throw new Or(xr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function fi(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function li(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Mr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function pi(t,e,n){if(void 0===n)throw new Or(xr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+gi(e)+" argument, but it was undefined.")}function di(n,t,r){jr(t,function(t,e){if(r.indexOf(t)<0)throw new Or(xr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function vi(t,e,n,r){var i=li(r);return new Or(xr.INVALID_ARGUMENT,"Function "+t+"() requires its "+gi(n)+" argument to be a "+e+", but it was: "+i)}function yi(t,e,n){if(n<=0)throw new Or(xr.INVALID_ARGUMENT,"Function "+t+"() requires its "+gi(e)+" argument to be a positive number, but it was: "+n+".")}function gi(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function mi(t,e){return t+" "+e+(1===t?"":"s")}var wi=(bi.k=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},bi);function bi(){}function Ii(t,e){return t<e?-1:e<t?1:0}function Ei(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Ti(t){return t+"\0"}var _i=(Ai.fromBase64String=function(t){return new Ai(atob(t))},Ai.fromUint8Array=function(t){return new Ai(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Ai.prototype.toBase64=function(){return t=this.M,btoa(t);var t},Ai.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.M)},Ai.prototype.O=function(){return 2*this.M.length},Ai.prototype.L=function(t){return Ii(this.M,t.M)},Ai.prototype.isEqual=function(t){return this.M===t.M},Ai);function Ai(t){this.M=t}_i.B=new _i("");var Ni=(Si.fromBase64String=function(t){try{return new Si(_i.fromBase64String(t))}catch(t){throw new Or(xr.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},Si.fromUint8Array=function(t){return new Si(_i.fromUint8Array(t))},Si.prototype.toBase64=function(){return this.q.toBase64()},Si.prototype.toUint8Array=function(){return this.q.toUint8Array()},Si.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},Si.prototype.isEqual=function(t){return this.q.isEqual(t.q)},Si);function Si(t){this.q=t}function Di(){if("undefined"==typeof Uint8Array)throw new Or(xr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function xi(){if("undefined"==typeof atob)throw new Or(xr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function Oi(t,e,n,r,i){this.U=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var Ri,ki=(o(ji,Ri=Ni),ji.fromBase64String=function(t){ei("Blob.fromBase64String",arguments,1),ii("Blob.fromBase64String","string",1,t),xi();try{return new ji(_i.fromBase64String(t))}catch(t){throw new Or(xr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},ji.fromUint8Array=function(t){if(ei("Blob.fromUint8Array",arguments,1),Di(),!(t instanceof Uint8Array))throw vi("Blob.fromUint8Array","Uint8Array",1,t);return new ji(_i.fromUint8Array(t))},ji.prototype.toBase64=function(){return ei("Blob.toBase64",arguments,0),xi(),Ri.prototype.toBase64.call(this)},ji.prototype.toUint8Array=function(){return ei("Blob.toUint8Array",arguments,0),Di(),Ri.prototype.toUint8Array.call(this)},ji.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},ji),Li=(Object.defineProperty(qi.prototype,"W",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),qi.prototype.isEqual=function(t){return t instanceof qi&&t.projectId===this.projectId&&t.database===this.database},qi.prototype.L=function(t){return Ii(this.projectId,t.projectId)||Ii(this.database,t.database)},qi),Ci=(Fi.prototype.get=function(t){var e=this.j(t),n=this.G[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.K(s,t))return u}},Fi.prototype.has=function(t){return void 0!==this.get(t)},Fi.prototype.set=function(t,e){var n=this.j(t),r=this.G[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.K(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.G[n]=[[t,e]]},Fi.prototype.delete=function(t){var e=this.j(t),n=this.G[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.K(n[r][0],t))return 1===n.length?delete this.G[e]:n.splice(r,1),!0;return!1},Fi.prototype.forEach=function(u){jr(this.G,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];u(o,s)}})},Fi.prototype.m=function(){return Gr(this.G)},Fi),Pi=(Mi.now=function(){return Mi.fromMillis(Date.now())},Mi.fromDate=function(t){return Mi.fromMillis(t.getTime())},Mi.fromMillis=function(t){var e=Math.floor(t/1e3);return new Mi(e,1e6*(t-1e3*e))},Mi.prototype.toDate=function(){return new Date(this.toMillis())},Mi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Mi.prototype.H=function(t){return this.seconds===t.seconds?Ii(this.nanoseconds,t.nanoseconds):Ii(this.seconds,t.seconds)},Mi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Mi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Mi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},Mi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Mi),Ui=(Vi.Y=function(t){return new Vi(t)},Vi.min=function(){return new Vi(new Pi(0,0))},Vi.prototype.L=function(t){return this.timestamp.H(t.timestamp)},Vi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Vi.prototype.J=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Vi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Vi.prototype.X=function(){return this.timestamp},Vi);function Vi(t){this.timestamp=t}function Mi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Or(xr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Or(xr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Or(xr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Or(xr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Fi(t,e){this.j=t,this.K=e,this.G={}}function qi(t,e){this.projectId=t,this.database=e||"(default)"}function ji(){return null!==Ri&&Ri.apply(this,arguments)||this}function Gi(t){return null==t}function Bi(t){return 0===t&&1/t==-1/0}function zi(t){return"number"==typeof t&&Number.isInteger(t)&&!Bi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Hi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Z=null};function Qi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Hi(t,e,n,r,i,o,s)}function Ki(t){var e,n=t;return null===n.Z&&(e=n.path.R(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.R()+e.op.toString()+Wo(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.R()+e.dir;var e}).join(","),Gi(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=Sa(n.startAt)),n.endAt&&(e+="|ub:",e+=Sa(n.endAt)),n.Z=e),n.Z}function Wi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!zo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!xa(t.startAt,e.startAt)&&xa(t.endAt,e.endAt)}function Yi(t){return Yr.F(t.path)&&null===t.collectionGroup&&0===t.filters.length}function Xi(t){this.count=t}var $i,Ji,Zi=(to.prototype.nt=function(t){return new to(this.target,this.targetId,this.tt,t,this.et,this.lastLimboFreeSnapshotVersion,this.resumeToken)},to.prototype.st=function(t,e){return new to(this.target,this.targetId,this.tt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},to.prototype.it=function(t){return new to(this.target,this.targetId,this.tt,this.sequenceNumber,this.et,t,this.resumeToken)},to);function to(t,e,n,r,i,o,s){void 0===i&&(i=Ui.min()),void 0===o&&(o=Ui.min()),void 0===s&&(s=_i.B),this.target=t,this.targetId=e,this.tt=n,this.sequenceNumber=r,this.et=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function eo(t){switch(t){case xr.OK:return Mr(),0;case xr.CANCELLED:case xr.UNKNOWN:case xr.DEADLINE_EXCEEDED:case xr.RESOURCE_EXHAUSTED:case xr.INTERNAL:case xr.UNAVAILABLE:case xr.UNAUTHENTICATED:return;case xr.INVALID_ARGUMENT:case xr.NOT_FOUND:case xr.ALREADY_EXISTS:case xr.PERMISSION_DENIED:case xr.FAILED_PRECONDITION:case xr.ABORTED:case xr.OUT_OF_RANGE:case xr.UNIMPLEMENTED:case xr.DATA_LOSS:return 1;default:return Mr(),0}}function no(t){if(void 0===t)return Pr("GRPC error has no .code"),xr.UNKNOWN;switch(t){case $i.OK:return xr.OK;case $i.CANCELLED:return xr.CANCELLED;case $i.UNKNOWN:return xr.UNKNOWN;case $i.DEADLINE_EXCEEDED:return xr.DEADLINE_EXCEEDED;case $i.RESOURCE_EXHAUSTED:return xr.RESOURCE_EXHAUSTED;case $i.INTERNAL:return xr.INTERNAL;case $i.UNAVAILABLE:return xr.UNAVAILABLE;case $i.UNAUTHENTICATED:return xr.UNAUTHENTICATED;case $i.INVALID_ARGUMENT:return xr.INVALID_ARGUMENT;case $i.NOT_FOUND:return xr.NOT_FOUND;case $i.ALREADY_EXISTS:return xr.ALREADY_EXISTS;case $i.PERMISSION_DENIED:return xr.PERMISSION_DENIED;case $i.FAILED_PRECONDITION:return xr.FAILED_PRECONDITION;case $i.ABORTED:return xr.ABORTED;case $i.OUT_OF_RANGE:return xr.OUT_OF_RANGE;case $i.UNIMPLEMENTED:return xr.UNIMPLEMENTED;case $i.DATA_LOSS:return xr.DATA_LOSS;default:return Mr()}}(Ji=$i=$i||{})[Ji.OK=0]="OK",Ji[Ji.CANCELLED=1]="CANCELLED",Ji[Ji.UNKNOWN=2]="UNKNOWN",Ji[Ji.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ji[Ji.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ji[Ji.NOT_FOUND=5]="NOT_FOUND",Ji[Ji.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ji[Ji.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ji[Ji.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ji[Ji.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ji[Ji.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ji[Ji.ABORTED=10]="ABORTED",Ji[Ji.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ji[Ji.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ji[Ji.INTERNAL=13]="INTERNAL",Ji[Ji.UNAVAILABLE=14]="UNAVAILABLE",Ji[Ji.DATA_LOSS=15]="DATA_LOSS";var ro=(ao.prototype.rt=function(t,e){return new ao(this.i,this.root.rt(t,e,this.i).copy(null,null,oo.ot,null,null))},ao.prototype.remove=function(t){return new ao(this.i,this.root.remove(t,this.i).copy(null,null,oo.ot,null,null))},ao.prototype.get=function(t){for(var e=this.root;!e.m();){var n=this.i(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},ao.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.m();){var r=this.i(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},ao.prototype.m=function(){return this.root.m()},Object.defineProperty(ao.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),ao.prototype.at=function(){return this.root.at()},ao.prototype.ct=function(){return this.root.ct()},ao.prototype.ut=function(t){return this.root.ut(t)},ao.prototype.forEach=function(n){this.ut(function(t,e){return n(t,e),!1})},ao.prototype.toString=function(){var n=[];return this.ut(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},ao.prototype.ht=function(t){return this.root.ht(t)},ao.prototype.lt=function(){return new io(this.root,null,this.i,!1)},ao.prototype._t=function(t){return new io(this.root,t,this.i,!1)},ao.prototype.ft=function(){return new io(this.root,null,this.i,!0)},ao.prototype.dt=function(t){return new io(this.root,t,this.i,!0)},ao),io=(uo.prototype.Et=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.m();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.m();)this.Tt.push(t),t=t.left;return e},uo.prototype.It=function(){return 0<this.Tt.length},uo.prototype.At=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},uo),oo=(so.prototype.copy=function(t,e,n,r,i){return new so(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},so.prototype.m=function(){return!1},so.prototype.ut=function(t){return this.left.ut(t)||t(this.key,this.value)||this.right.ut(t)},so.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},so.prototype.min=function(){return this.left.m()?this:this.left.min()},so.prototype.at=function(){return this.min().key},so.prototype.ct=function(){return this.right.m()?this.key:this.right.ct()},so.prototype.rt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.rt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.rt(t,e,n))).Rt()},so.prototype.Pt=function(){if(this.left.m())return so.EMPTY;var t=this;return t.left.gt()||t.left.left.gt()||(t=t.yt()),(t=t.copy(null,null,null,t.left.Pt(),null)).Rt()},so.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.m()||r.left.gt()||r.left.left.gt()||(r=r.yt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.gt()&&(r=r.Vt()),r.right.m()||r.right.gt()||r.right.left.gt()||(r=r.bt()),0===e(t,r.key)){if(r.right.m())return so.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Pt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Rt()},so.prototype.gt=function(){return this.color},so.prototype.Rt=function(){var t=this;return t.right.gt()&&!t.left.gt()&&(t=t.vt()),t.left.gt()&&t.left.left.gt()&&(t=t.Vt()),t.left.gt()&&t.right.gt()&&(t=t.St()),t},so.prototype.yt=function(){var t=this.St();return t.right.left.gt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Vt())).vt()).St()),t},so.prototype.bt=function(){var t=this.St();return t.left.left.gt()&&(t=(t=t.Vt()).St()),t},so.prototype.vt=function(){var t=this.copy(null,null,so.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},so.prototype.Vt=function(){var t=this.copy(null,null,so.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},so.prototype.St=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},so.prototype.Dt=function(){var t=this.Ct();return Math.pow(2,t)<=this.size+1},so.prototype.Ct=function(){if(this.gt()&&this.left.gt())throw Mr();if(this.right.gt())throw Mr();var t=this.left.Ct();if(t!==this.right.Ct())throw Mr();return t+(this.gt()?0:1)},so);function so(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:so.RED,this.left=null!=r?r:so.EMPTY,this.right=null!=i?i:so.EMPTY,this.size=this.left.size+1+this.right.size}function uo(t,e,n,r){this.wt=r,this.Tt=[];for(var i=1;!t.m();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.wt?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.wt?t.right:t.left}}function ao(t,e){this.i=t,this.root=e||oo.EMPTY}function co(){this.size=0}oo.EMPTY=null,oo.RED=!0,oo.ot=!1,oo.EMPTY=(Object.defineProperty(co.prototype,"key",{get:function(){throw Mr()},enumerable:!1,configurable:!0}),Object.defineProperty(co.prototype,"value",{get:function(){throw Mr()},enumerable:!1,configurable:!0}),Object.defineProperty(co.prototype,"color",{get:function(){throw Mr()},enumerable:!1,configurable:!0}),Object.defineProperty(co.prototype,"left",{get:function(){throw Mr()},enumerable:!1,configurable:!0}),Object.defineProperty(co.prototype,"right",{get:function(){throw Mr()},enumerable:!1,configurable:!0}),co.prototype.copy=function(t,e,n,r,i){return this},co.prototype.rt=function(t,e,n){return new oo(t,e)},co.prototype.remove=function(t,e){return this},co.prototype.m=function(){return!0},co.prototype.ut=function(t){return!1},co.prototype.ht=function(t){return!1},co.prototype.at=function(){return null},co.prototype.ct=function(){return null},co.prototype.gt=function(){return!1},co.prototype.Dt=function(){return!0},co.prototype.Ct=function(){return 0},new co);var ho=(vo.prototype.has=function(t){return null!==this.data.get(t)},vo.prototype.first=function(){return this.data.at()},vo.prototype.last=function(){return this.data.ct()},Object.defineProperty(vo.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),vo.prototype.indexOf=function(t){return this.data.indexOf(t)},vo.prototype.forEach=function(n){this.data.ut(function(t,e){return n(t),!1})},vo.prototype.Nt=function(t,e){for(var n=this.data._t(t[0]);n.It();){var r=n.Et();if(0<=this.i(r.key,t[1]))return;e(r.key)}},vo.prototype.Ft=function(t,e){for(var n=void 0!==e?this.data._t(e):this.data.lt();n.It();)if(!t(n.Et().key))return},vo.prototype.$t=function(t){var e=this.data._t(t);return e.It()?e.Et().key:null},vo.prototype.lt=function(){return new fo(this.data.lt())},vo.prototype._t=function(t){return new fo(this.data._t(t))},vo.prototype.add=function(t){return this.copy(this.data.remove(t).rt(t,!0))},vo.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},vo.prototype.m=function(){return this.data.m()},vo.prototype.xt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},vo.prototype.isEqual=function(t){if(!(t instanceof vo))return!1;if(this.size!==t.size)return!1;for(var e=this.data.lt(),n=t.data.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(0!==this.i(r,i))return!1}return!0},vo.prototype.A=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},vo.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},vo.prototype.copy=function(t){var e=new vo(this.i);return e.data=t,e},vo),fo=(po.prototype.Et=function(){return this.kt.Et().key},po.prototype.It=function(){return this.kt.It()},po),lo=new ro(Yr.i);function po(t){this.kt=t}function vo(t){this.i=t,this.data=new ro(this.i)}var yo=new ro(Yr.i),go=new ro(Yr.i),mo=new ho(Yr.i);function wo(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=mo,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var bo=new ho(Ii),Io=(Vo.Lt=function(t){return new Vo(t.i)},Vo.prototype.has=function(t){return null!=this.Mt.get(t)},Vo.prototype.get=function(t){return this.Mt.get(t)},Vo.prototype.first=function(){return this.Ot.at()},Vo.prototype.last=function(){return this.Ot.ct()},Vo.prototype.m=function(){return this.Ot.m()},Vo.prototype.indexOf=function(t){var e=this.Mt.get(t);return e?this.Ot.indexOf(e):-1},Object.defineProperty(Vo.prototype,"size",{get:function(){return this.Ot.size},enumerable:!1,configurable:!0}),Vo.prototype.forEach=function(n){this.Ot.ut(function(t,e){return n(t),!1})},Vo.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Mt.rt(t.key,t),e.Ot.rt(t,null))},Vo.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Mt.remove(t),this.Ot.remove(e)):this},Vo.prototype.isEqual=function(t){if(!(t instanceof Vo))return!1;if(this.size!==t.size)return!1;for(var e=this.Ot.lt(),n=t.Ot.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(!r.isEqual(i))return!1}return!0},Vo.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Vo.prototype.copy=function(t,e){var n=new Vo;return n.i=this.i,n.Mt=t,n.Ot=e,n},Vo),Eo=(Uo.prototype.track=function(t){var e=t.doc.key,n=this.Bt.get(e);!n||0!==t.type&&3===n.type?this.Bt=this.Bt.rt(e,t):3===t.type&&1!==n.type?this.Bt=this.Bt.rt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Bt=this.Bt.rt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Bt=this.Bt.remove(e):1===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):Mr()},Uo.prototype.qt=function(){var n=[];return this.Bt.ut(function(t,e){n.push(e)}),n},Uo),To=(Po.Kt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Po(t,e,Io.Lt(e),i,n,r,!0,!1)},Object.defineProperty(Po.prototype,"hasPendingWrites",{get:function(){return!this.Qt.m()},enumerable:!1,configurable:!0}),Po.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Wt===t.Wt&&this.Qt.isEqual(t.Qt)&&Xu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ut.isEqual(t.Ut)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Po),_o=(Co.Jt=function(t,e){var n=new Map;return n.set(t,Ao.Xt(t,e)),new Co(Ui.min(),n,bo,lo,wo())},Co),Ao=(Lo.Xt=function(t,e){return new Lo(_i.B,e,wo(),wo(),wo())},Lo),No=function(t,e,n,r){this.se=t,this.removedTargetIds=e,this.key=n,this.ie=r},So=function(t,e){this.targetId=t,this.re=e},Do=function(t,e,n,r){void 0===n&&(n=_i.B),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},xo=(Object.defineProperty(ko.prototype,"Zt",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(ko.prototype,"resumeToken",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(ko.prototype,"le",{get:function(){return 0!==this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(ko.prototype,"_e",{get:function(){return this.he},enumerable:!1,configurable:!0}),ko.prototype.fe=function(t){0<t.O()&&(this.he=!0,this.ce=t)},ko.prototype.de=function(){var n=wo(),r=wo(),i=wo();return this.ae.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Mr()}}),new Ao(this.ce,this.ue,n,r,i)},ko.prototype.we=function(){this.he=!1,this.ae=Fo()},ko.prototype.me=function(t,e){this.he=!0,this.ae=this.ae.rt(t,e)},ko.prototype.Te=function(t){this.he=!0,this.ae=this.ae.remove(t)},ko.prototype.Ee=function(){this.oe+=1},ko.prototype.Ie=function(){--this.oe},ko.prototype.Ae=function(){this.he=!0,this.ue=!0},ko),Oo=(Ro.prototype.pe=function(t){for(var e=0,n=t.se;e<n.length;e++){var r=n[e];t.ie instanceof Ru?this.be(r,t.ie):t.ie instanceof ku&&this.ve(r,t.key,t.ie)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.ve(s,t.key,t.ie)}},Ro.prototype.Se=function(n){var r=this;this.De(n,function(t){var e=r.Ce(t);switch(n.state){case 0:r.Ne(t)&&e.fe(n.resumeToken);break;case 1:e.Ie(),e.le||e.we(),e.fe(n.resumeToken);break;case 2:e.Ie(),e.le||r.removeTarget(t);break;case 3:r.Ne(t)&&(e.Ae(),e.fe(n.resumeToken));break;case 4:r.Ne(t)&&(r.Fe(t),e.fe(n.resumeToken));break;default:Mr()}})},Ro.prototype.De=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Pe.forEach(function(t,e){r.Ne(e)&&n(e)})},Ro.prototype.$e=function(t){var e,n,r=t.targetId,i=t.re.count,o=this.xe(r);o&&(Yi(e=o.target)?0===i?(n=new Yr(e.path),this.ve(r,n,new ku(n,Ui.min()))):Fr(1===i):this.ke(r)!==i&&(this.Fe(r),this.Ve=this.Ve.add(r)))},Ro.prototype.Me=function(i){var o=this,s=new Map;this.Pe.forEach(function(t,e){var n,r=o.xe(e);r&&(t.Zt&&Yi(r.target)&&(n=new Yr(r.target.path),null!==o.ge.get(n)||o.Oe(e,n)||o.ve(e,n,new ku(n,i))),t._e&&(s.set(e,t.de()),t.we()))});var r=wo();this.ye.forEach(function(t,e){var n=!0;e.Ft(function(t){var e=o.xe(t);return!e||2===e.tt||(n=!1)}),n&&(r=r.add(t))});var t=new _o(i,s,this.Ve,this.ge,r);return this.ge=lo,this.ye=Mo(),this.Ve=new ho(Ii),t},Ro.prototype.be=function(t,e){var n;this.Ne(t)&&(n=this.Oe(t,e.key)?2:0,this.Ce(t).me(e.key,n),this.ge=this.ge.rt(e.key,e),this.ye=this.ye.rt(e.key,this.Le(e.key).add(t)))},Ro.prototype.ve=function(t,e,n){var r;this.Ne(t)&&(r=this.Ce(t),this.Oe(t,e)?r.me(e,1):r.Te(e),this.ye=this.ye.rt(e,this.Le(e).delete(t)),n&&(this.ge=this.ge.rt(e,n)))},Ro.prototype.removeTarget=function(t){this.Pe.delete(t)},Ro.prototype.ke=function(t){var e=this.Ce(t).de();return this.Re.Be(t).size+e.te.size-e.ne.size},Ro.prototype.Ee=function(t){this.Ce(t).Ee()},Ro.prototype.Ce=function(t){var e=this.Pe.get(t);return e||(e=new xo,this.Pe.set(t,e)),e},Ro.prototype.Le=function(t){var e=this.ye.get(t);return e||(e=new ho(Ii),this.ye=this.ye.rt(t,e)),e},Ro.prototype.Ne=function(t){var e=null!==this.xe(t);return e||Cr("WatchChangeAggregator","Detected inactive target",t),e},Ro.prototype.xe=function(t){var e=this.Pe.get(t);return e&&e.le?null:this.Re.qe(t)},Ro.prototype.Fe=function(e){var n=this;this.Pe.set(e,new xo),this.Re.Be(e).forEach(function(t){n.ve(e,t,null)})},Ro.prototype.Oe=function(t,e){return this.Re.Be(t).has(e)},Ro);function Ro(t){this.Re=t,this.Pe=new Map,this.ge=lo,this.ye=Mo(),this.Ve=new ho(Ii)}function ko(){this.oe=0,this.ae=Fo(),this.ce=_i.B,this.ue=!1,this.he=!0}function Lo(t,e,n,r,i){this.resumeToken=t,this.Zt=e,this.te=n,this.ee=r,this.ne=i}function Co(t,e,n,r,i){this.et=t,this.Gt=e,this.zt=n,this.Ht=r,this.Yt=i}function Po(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Ut=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.Wt=s,this.jt=u}function Uo(){this.Bt=new ro(Yr.i)}function Vo(n){this.i=n?function(t,e){return n(t,e)||Yr.i(t.key,e.key)}:function(t,e){return Yr.i(t.key,e.key)},this.Mt=yo,this.Ot=new ro(this.i)}function Mo(){return new ro(Yr.i)}function Fo(){return new ro(Yr.i)}function qo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function jo(t){var e=Yo(t.mapValue.fields.__local_write_time__.timestampValue);return new Pi(e.seconds,e.nanos)}var Go=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Bo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?qo(t)?4:10:Mr()}function zo(r,i){var t,e,n,o=Bo(r);if(o!==Bo(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return jo(r).isEqual(jo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Yo(r.timestampValue),n=Yo(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return n=i,$o(r.bytesValue).isEqual($o(n.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Xo((t=r).geoPointValue.latitude)===Xo(e.geoPointValue.latitude)&&Xo(t.geoPointValue.longitude)===Xo(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Xo(t.integerValue)===Xo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Xo(t.doubleValue),r=Xo(e.doubleValue);return n===r?Bi(n)===Bi(r):isNaN(n)&&isNaN(r)}return!1}(r,i);case 9:return Ei(r.arrayValue.values||[],i.arrayValue.values||[],zo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(qr(e)!==qr(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!zo(e[t],n[t])))return!1;return!0}();default:return Mr()}}function Ho(t,e){return void 0!==(t.values||[]).find(function(t){return zo(t,e)})}function Qo(t,e){var n,r,i,o,s,u,a,c,h,f,l=Bo(t),p=Bo(e);if(l!==p)return Ii(l,p);switch(l){case 0:return 0;case 1:return Ii(t.booleanValue,e.booleanValue);case 2:return c=e,(h=Xo(t.integerValue||t.doubleValue))<(f=Xo(c.integerValue||c.doubleValue))?-1:f<h?1:h===f?0:isNaN(h)?isNaN(f)?0:-1:1;case 3:return Ko(t.timestampValue,e.timestampValue);case 4:return Ko(jo(t),jo(e));case 5:return Ii(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=$o(o),a=$o(s),u.L(a);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Ii(n[i],r[i]);if(0!==o)return o}return Ii(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=Ii(Xo(n.latitude),Xo(r.latitude)))?i:Ii(Xo(n.longitude),Xo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Qo(n[i],r[i]);if(o)return o}return Ii(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Ii(r[s],o[s]);if(0!==u)return u;var a=Qo(n[r[s]],i[o[s]]);if(0!==a)return a}return Ii(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Mr()}}function Ko(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ii(t,e);var n=Yo(t),r=Yo(e),i=Ii(n.seconds,r.seconds);return 0!==i?i:Ii(n.nanos,r.nanos)}function Wo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=Yo(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?$o(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,Yr.C(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Mr();var t,e,n}(t)}function Yo(t){if(Fr(!!t),"string"!=typeof t)return{seconds:Xo(t.seconds),nanos:Xo(t.nanos)};var e,n=0,r=Go.exec(t);Fr(!!r),r[1]&&(e=((e=r[1])+"000000000").substr(0,9),n=Number(e));var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:n}}function Xo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function $o(t){return"string"==typeof t?_i.fromBase64String(t):_i.fromUint8Array(t)}function Jo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.R()}}function Zo(t){return t&&"integerValue"in t}function ts(t){return!!t&&"arrayValue"in t}function es(t){return t&&"nullValue"in t}function ns(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function rs(t){return t&&"mapValue"in t}var is={asc:"ASCENDING",desc:"DESCENDING"},os={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ss=function(t,e){this.U=t,this.Ue=e};function us(t){return{integerValue:""+t}}function as(t,e){if(t.Ue){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Bi(e)?"-0":e}}function cs(t,e){return zi(e)?us(e):as(t,e)}function hs(t,e){return t.Ue?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function fs(t,e){return t.Ue?e.toBase64():e.toUint8Array()}function ls(t){return Fr(!!t),Ui.Y((e=Yo(t),new Pi(e.seconds,e.nanos)));var e}function ps(t,e){return new Qr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).R()}function ds(t){var e=Qr.P(t);return Fr(Os(e)),e}function vs(t,e){return ps(t.U,e.path)}function ys(t,e){var n=ds(e);return Fr(n.get(1)===t.U.projectId),Fr(!n.get(3)&&!t.U.database||n.get(3)===t.U.database),new Yr(bs(n))}function gs(t,e){return ps(t.U,e)}function ms(t){var e=ds(t);return 4===e.length?Qr.g():bs(e)}function ws(t){return new Qr(["projects",t.U.projectId,"databases",t.U.database]).R()}function bs(t){return Fr(4<t.length&&"documents"===t.get(4)),t.u(5)}function Is(t,e,n){return{name:vs(t,e),fields:n.proto.mapValue.fields}}function Es(t,e){var n,r,i,o;if(e instanceof au)n={update:Is(t,e.key,e.value)};else if(e instanceof wu)n={delete:vs(t,e.key)};else if(e instanceof cu)n={update:Is(t,e.key,e.data),updateMask:(r=e.Qe,i=[],r.fields.forEach(function(t){return i.push(t.R())}),{fieldPaths:i})};else if(e instanceof du)n={transform:{document:vs(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Ps)return{fieldPath:t.field.R(),setToServerValue:"REQUEST_TIME"};if(e instanceof Us)return{fieldPath:t.field.R(),appendMissingElements:{values:e.elements}};if(e instanceof js)return{fieldPath:t.field.R(),removeAllFromArray:{values:e.elements}};if(e instanceof Hs)return{fieldPath:t.field.R(),increment:e.We};throw Mr()})}};else{if(!(e instanceof bu))return Mr();n={verify:vs(t,e.key)}}return e.Ke.je||(n.currentDocument=void 0!==(o=e.Ke).updateTime?{updateTime:hs(t,o.updateTime.X())}:void 0!==o.exists?{exists:o.exists}:Mr()),n}function Ts(e,t){var n,r,i=t.currentDocument?void 0!==(n=t.currentDocument).updateTime?Zs.updateTime(ls(n.updateTime)):void 0!==n.exists?Zs.exists(n.exists):Zs.Ge():Zs.Ge();if(t.update){t.update.name;var o=ys(e,t.update.name),s=new Iu({mapValue:{fields:t.update.fields}});if(t.updateMask){var u=(r=t.updateMask.fieldPaths||[],new Ys(r.map(function(t){return Wr.S(t)})));return new cu(o,s,u,i)}return new au(o,s,i)}if(t.delete){var a=ys(e,t.delete);return new wu(a,i)}if(t.transform){var c=ys(e,t.transform.document),h=t.transform.fieldTransforms.map(function(t){return function(t,e){var n,r,i=null;"setToServerValue"in e?(Fr("REQUEST_TIME"===e.setToServerValue),i=new Ps):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],i=new Us(n)):"removeAllFromArray"in e?(r=e.removeAllFromArray.values||[],i=new js(r)):"increment"in e?i=new Hs(t,e.increment):Mr();var o=Wr.S(e.fieldPath);return new Xs(o,i)}(e,t)});return Fr(!0===i.exists),new du(c,h)}if(t.verify){var f=ys(e,t.verify);return new bu(f,i)}return Mr()}function _s(t,e){return{documents:[gs(t,e.path)]}}function As(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=gs(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=gs(t,r.h()),n.structuredQuery.from=[{collectionId:r._()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){if("=="===t.op){if(ns(t.value))return{unaryFilter:{field:Ds(t.field),op:"IS_NAN"}};if(es(t.value))return{unaryFilter:{field:Ds(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(ns(t.value))return{unaryFilter:{field:Ds(t.field),op:"IS_NOT_NAN"}};if(es(t.value))return{unaryFilter:{field:Ds(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ds(t.field),op:(e=t.op,os[e]),value:t.value}};var e});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:Ds((e=t).field),direction:(n=e.dir,is[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,u=(s=e.limit,t.Ue||Gi(s)?s:{value:s});return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=Ns(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Ns(e.endAt)),n}function Ns(t){return{before:t.before,values:t.position}}function Ss(t){var e=!!t.before,n=t.values||[];return new Ea(n,e)}function Ds(t){return{fieldPath:t.R()}}function xs(t){return Wr.S(t.fieldPath)}function Os(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function Rs(){this.ze=void 0}function ks(t,e){return t instanceof Hs?Zo(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var Ls,Cs,Ps=(o(Ms,Cs=Rs),Ms),Us=(o(Vs,Ls=Rs),Vs);function Vs(t){var e=this;return(e=Ls.call(this)||this).elements=t,e}function Ms(){return null!==Cs&&Cs.apply(this,arguments)||this}function Fs(t,e){for(var n=Ws(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return zo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var qs,js=(o(Gs,qs=Rs),Gs);function Gs(t){var e=this;return(e=qs.call(this)||this).elements=t,e}function Bs(t,e){for(var n=Ws(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!zo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var zs,Hs=(o(Qs,zs=Rs),Qs);function Qs(t,e){var n=this;return(n=zs.call(this)||this).serializer=t,n.We=e,n}function Ks(t){return Xo(t.integerValue||t.doubleValue)}function Ws(t){return ts(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Ys=($s.prototype.He=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].T(t))return!0;return!1},$s.prototype.isEqual=function(t){return Ei(this.fields,t.fields,function(t,e){return t.isEqual(e)})},$s),Xs=function(t,e){this.field=t,this.transform=e};function $s(t){(this.fields=t).sort(Wr.i)}function Js(t,e){this.version=t,this.transformResults=e}var Zs=(tu.Ge=function(){return new tu},tu.exists=function(t){return new tu(void 0,t)},tu.updateTime=function(t){return new tu(t)},Object.defineProperty(tu.prototype,"je",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),tu.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},tu);function tu(t,e){this.updateTime=t,this.exists=e}function eu(t,e){return void 0!==t.updateTime?e instanceof Ru&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Ru}function nu(){}function ru(t,e,n,r){return t instanceof au?function(t,e){if(!eu(t.Ke,e))return e;var n=ou(e);return new Ru(t.key,n,t.value,{Ye:!0})}(t,e):t instanceof cu?function(t,e){if(!eu(t.Ke,e))return e;var n=ou(e),r=lu(t,e);return new Ru(t.key,n,r,{Ye:!0})}(t,e):t instanceof du?function(t,e,n,r){if(!eu(t.Ke,e))return e;var i=e,o=function(t,e,n,r){for(var i,o,s,u,a,c,h=[],f=0,l=t;f<l.length;f++){var p=l[f],d=p.transform,v=null;n instanceof Ru&&(v=n.field(p.field)),null===v&&r instanceof Ru&&(v=r.field(p.field)),h.push((o=v,c=a=u=s=void 0,(i=d)instanceof Ps?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},o&&(c.fields.__previous_value__=o),{mapValue:c}):i instanceof Us?Fs(i,o):i instanceof js?Bs(i,o):(a=Ks(u=ks(s=i,o))+Ks(s.We),Zo(u)&&Zo(s.We)?us(a):as(s.serializer,a))))}return h}(t.fieldTransforms,n,e,r),s=yu(t,i.data(),o);return new Ru(t.key,i.version,s,{Ye:!0})}(t,e,r,n):(o=e,eu((i=t).Ke,o)?new ku(i.key,Ui.min()):o);var i,o}function iu(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ke.isEqual(e.Ke)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||Ei(t.fieldTransforms,t.fieldTransforms,function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof Us&&o instanceof Us||i instanceof js&&o instanceof js?Ei(i.elements,o.elements,zo):i instanceof Hs&&o instanceof Hs?zo(i.We,o.We):i instanceof Ps&&o instanceof Ps);var n,r,i,o}))}function ou(t){return t instanceof Ru?t.version:Ui.min()}var su,uu,au=(o(fu,uu=nu),fu),cu=(o(hu,su=nu),hu);function hu(t,e,n,r){var i=this;return(i=su.call(this)||this).key=t,i.data=e,i.Qe=n,i.Ke=r,i.type=1,i}function fu(t,e,n){var r=this;return(r=uu.call(this)||this).key=t,r.value=e,r.Ke=n,r.type=0,r}function lu(t,e){return n=t,r=e instanceof Ru?e.data():Iu.empty(),i=new Eu(r),n.Qe.fields.forEach(function(t){var e;t.m()||(null!==(e=n.data.field(t))?i.set(t,e):i.delete(t))}),i.Je();var n,r,i}var pu,du=(o(vu,pu=nu),vu);function vu(t,e){var n=this;return(n=pu.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ke=Zs.exists(!0),n}function yu(t,e,n){for(var r=new Eu(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Je()}var gu,mu,wu=(o(Nu,mu=nu),Nu),bu=(o(Au,gu=nu),Au),Iu=(_u.empty=function(){return new _u({mapValue:{}})},_u.prototype.field=function(t){if(t.m())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!rs(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t._()])||null},_u.prototype.isEqual=function(t){return zo(this.proto,t.proto)},_u),Eu=(Tu.prototype.set=function(t,e){return this.tn(t,e),this},Tu.prototype.delete=function(t){return this.tn(t,null),this},Tu.prototype.tn=function(t,e){for(var n=this.Ze,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===Bo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t._(),e)},Tu.prototype.Je=function(){var t=this.en(Wr.g(),this.Ze);return null!=t?new Iu(t):this.Xe},Tu.prototype.en=function(r,t){var i=this,o=!1,e=this.Xe.field(r),s=rs(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.en(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Tu);function Tu(t){void 0===t&&(t=Iu.empty()),this.Xe=t,this.Ze=new Map}function _u(t){this.proto=t}function Au(t,e){var n=this;return(n=gu.call(this)||this).key=t,n.Ke=e,n.type=4,n}function Nu(t,e){var n=this;return(n=mu.call(this)||this).key=t,n.Ke=e,n.type=3,n}function Su(t,e){this.key=t,this.version=e}var Du,xu,Ou,Ru=(o(Vu,Ou=Su),Vu.prototype.field=function(t){return this.nn.field(t)},Vu.prototype.data=function(){return this.nn},Vu.prototype.sn=function(){return this.nn.proto},Vu.prototype.isEqual=function(t){return t instanceof Vu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ye===t.Ye&&this.hasCommittedMutations===t.hasCommittedMutations&&this.nn.isEqual(t.nn)},Vu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.nn.toString()+", {hasLocalMutations: "+this.Ye+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Vu.prototype,"hasPendingWrites",{get:function(){return this.Ye||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Vu),ku=(o(Uu,xu=Su),Uu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Uu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Uu.prototype.isEqual=function(t){return t instanceof Uu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Uu),Lu=(o(Pu,Du=Su),Pu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Pu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Pu.prototype.isEqual=function(t){return t instanceof Pu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Pu),Cu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.rn=n,this.filters=r,this.limit=i,this.on=o,this.startAt=s,this.endAt=u,this.an=null,this.cn=null,this.startAt,this.endAt};function Pu(){return null!==Du&&Du.apply(this,arguments)||this}function Uu(t,e,n){var r=this;return(r=xu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Vu(t,e,n,r){var i=this;return(i=Ou.call(this,t,e)||this).nn=n,i.Ye=!!r.Ye,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Mu(t,e,n,r,i,o,s,u){return new Cu(t,e,n,r,i,o,s,u)}function Fu(t){return new Cu(t)}function qu(t){return!Gi(t.limit)&&"F"===t.on}function ju(t){return!Gi(t.limit)&&"L"===t.on}function Gu(t){return 0<t.rn.length?t.rn[0].field:null}function Bu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.un())return r.field}return null}function zu(t){return null!==t.collectionGroup}function Hu(t){var e=t;if(null===e.an){e.an=[];var n=Bu(e),r=Gu(e);if(null!==n&&null===r)n.p()||e.an.push(new Oa(n)),e.an.push(new Oa(Wr.v(),"asc"));else{for(var i,o=!1,s=0,u=e.rn;s<u.length;s++){var a=u[s];e.an.push(a),a.field.p()&&(o=!0)}o||(i=0<e.rn.length?e.rn[e.rn.length-1].dir:"asc",e.an.push(new Oa(Wr.v(),i)))}}return e.an}function Qu(t){var e=t;if(!e.cn)if("F"===e.on)e.cn=Qi(e.path,e.collectionGroup,Hu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Hu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Oa(o.field,s))}var u=e.endAt?new Ea(e.endAt.position,!e.endAt.before):null,a=e.startAt?new Ea(e.startAt.position,!e.startAt.before):null;e.cn=Qi(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.cn}function Ku(t,e,n){return new Cu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Wu(t,e){return new Cu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,e,t.endAt)}function Yu(t,e){return new Cu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,t.startAt,e)}function Xu(t,e){return Wi(Qu(t),Qu(e))&&t.on===e.on}function $u(t){return Ki(Qu(t))+"|lt:"+t.on}function Ju(t){return"Query(target="+(n=(e=Qu(t)).path.R(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.R()+" "+e.op+" "+Wo(e.value);var e}).join(", ")+"]"),Gi(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.R()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Sa(e.startAt)),e.endAt&&(n+=", endAt: "+Sa(e.endAt)),"Target("+n+")")+"; limitType="+t.on+")";var e,n}function Zu(i,t){return r=i,o=t.key.path,(null!==r.collectionGroup?t.key.N(r.collectionGroup)&&r.path.T(o):Yr.F(r.path)?r.path.isEqual(o):r.path.I(o))&&function(t){for(var e=0,n=i.rn;e<n.length;e++){var r=n[e];if(!r.field.p()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=i).startAt||Da(e.startAt,Hu(e),n))&&(!e.endAt||!Da(e.endAt,Hu(e),n)));var e,n,r,o}function ta(u){return function(t,e){for(var n=!1,r=0,i=Hu(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i,o,s,u=t.field.p()?Yr.i(e.key,n.key):(r=t.field,i=n,o=e.field(r),s=i.field(r),null!==o&&null!==s?Qo(o,s):Mr());switch(t.dir){case"asc":return u;case"desc":return-1*u;default:return Mr()}}(o,t,e);if(0!==s)return s;n=n||o.field.p()}return 0}}var ea,na=(o(ra,ea=function(){}),ra.create=function(t,e,n){if(t.p())return"in"===e||"not-in"===e?this.hn(t,e,n):new ua(t,e,n);if(es(n)){if("=="!==e&&"!="!==e)throw new Or(xr.INVALID_ARGUMENT,"Invalid query. Null only supports '==' and '!=' comparisons.");return new ra(t,e,n)}if(ns(n)){if("=="!==e&&"!="!==e)throw new Or(xr.INVALID_ARGUMENT,"Invalid query. NaN only supports '==' and '!=' comparisons.");return new ra(t,e,n)}return"array-contains"===e?new ma(t,n):"in"===e?new wa(t,n):"not-in"===e?new ba(t,n):"array-contains-any"===e?new Ia(t,n):new ra(t,e,n)},ra.hn=function(t,e,n){return new("in"===e?aa:ca)(t,n)},ra.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.ln(Qo(e,this.value)):null!==e&&Bo(this.value)===Bo(e)&&this.ln(Qo(e,this.value))},ra.prototype.ln=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Mr()}},ra.prototype.un=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},ra);function ra(t,e,n){var r=this;return(r=ea.call(this)||this).field=t,r.op=e,r.value=n,r}var ia,oa,sa,ua=(o(la,sa=na),la.prototype.matches=function(t){var e=Yr.i(t.key,this.key);return this.ln(e)},la),aa=(o(fa,oa=na),fa.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},fa),ca=(o(ha,ia=na),ha.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},ha);function ha(t,e){var n=this;return(n=ia.call(this,t,"not-in",e)||this).keys=pa(0,e),n}function fa(t,e){var n=this;return(n=oa.call(this,t,"in",e)||this).keys=pa(0,e),n}function la(t,e,n){var r=this;return(r=sa.call(this,t,e,n)||this).key=Yr.C(n.referenceValue),r}function pa(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return Yr.C(t.referenceValue)})}var da,va,ya,ga,ma=(o(Na,ga=na),Na.prototype.matches=function(t){var e=t.field(this.field);return ts(e)&&Ho(e.arrayValue,this.value)},Na),wa=(o(Aa,ya=na),Aa.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&Ho(this.value.arrayValue,e)},Aa),ba=(o(_a,va=na),_a.prototype.matches=function(t){if(Ho(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.field(this.field);return null!==e&&!Ho(this.value.arrayValue,e)},_a),Ia=(o(Ta,da=na),Ta.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!ts(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return Ho(e.value.arrayValue,t)})},Ta),Ea=function(t,e){this.position=t,this.before=e};function Ta(t,e){return da.call(this,t,"array-contains-any",e)||this}function _a(t,e){return va.call(this,t,"not-in",e)||this}function Aa(t,e){return ya.call(this,t,"in",e)||this}function Na(t,e){return ga.call(this,t,"array-contains",e)||this}function Sa(t){return(t.before?"b":"a")+":"+t.position.map(Wo).join(",")}function Da(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.p()?Yr.i(Yr.C(s.referenceValue),n.key):Qo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function xa(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!zo(t.position[n],e.position[n]))return!1;return!0}var Oa=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Ra(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var ka,La=(Ga.prototype.reset=function(){this.Tn=0},Ga.prototype.An=function(){this.Tn=this.mn},Ga.prototype.Rn=function(t){var e=this;this.cancel();var n=Math.floor(this.Tn+this.Pn()),r=Math.max(0,Date.now()-this.In),i=Math.max(0,n-r);0<i&&Cr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Tn+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.En=this._n.gn(this.fn,i,function(){return e.In=Date.now(),t()}),this.Tn*=this.wn,this.Tn<this.dn&&(this.Tn=this.dn),this.Tn>this.mn&&(this.Tn=this.mn)},Ga.prototype.yn=function(){null!==this.En&&(this.En.Vn(),this.En=null)},Ga.prototype.cancel=function(){null!==this.En&&(this.En.cancel(),this.En=null)},Ga.prototype.Pn=function(){return(Math.random()-.5)*this.Tn},Ga),Ca=(ja.prototype.catch=function(t){return this.next(void 0,t)},ja.prototype.next=function(r,i){var o=this;return this.Sn&&Mr(),this.Sn=!0,this.vn?this.error?this.Dn(i,this.error):this.Cn(r,this.result):new ja(function(e,n){o.pn=function(t){o.Cn(r,t).next(e,n)},o.bn=function(t){o.Dn(i,t).next(e,n)}})},ja.prototype.Nn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ja.prototype.Fn=function(t){try{var e=t();return e instanceof ja?e:ja.resolve(e)}catch(t){return ja.reject(t)}},ja.prototype.Cn=function(t,e){return t?this.Fn(function(){return t(e)}):ja.resolve(e)},ja.prototype.Dn=function(t,e){return t?this.Fn(function(){return t(e)}):ja.reject(e)},ja.resolve=function(n){return new ja(function(t,e){t(n)})},ja.reject=function(n){return new ja(function(t,e){e(n)})},ja.$n=function(t){return new ja(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ja.xn=function(t){for(var n=ja.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?ja.resolve(t):e()})}(r[e]);return n},ja.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.$n(i)},ja),Pa=(qa.delete=function(t){return Cr("SimpleDb","Removing database:",t),Wa(window.indexedDB.deleteDatabase(t)).Nn()},qa.On=function(){if("undefined"==typeof indexedDB)return!1;if(qa.Ln())return!0;var t=v(),e=qa.Mn(t),n=0<e&&e<10,r=qa.Bn(t),i=0<r&&r<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||i)},qa.Ln=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.qn)},qa.Un=function(t,e){return t.store(e)},qa.Mn=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},qa.Bn=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},qa.prototype.Qn=function(){return m(this,void 0,void 0,function(){var e,o=this;return w(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Cr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(n,r){var i=indexedDB.open(o.name,o.version);i.onsuccess=function(t){var e=t.target.result;n(e)},i.onblocked=function(){r(new Va("Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(t){var e=t.target.error;"VersionError"===e.name?r(new Or(xr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new Va(e))},i.onupgradeneeded=function(t){Cr("SimpleDb",'Database "'+o.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;o.kn.createOrUpgrade(e,i.transaction,t.oldVersion,o.version).next(function(){Cr("SimpleDb","Database upgrade to version "+o.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.Wn&&(this.db.onversionchange=function(t){return o.Wn(t)}),this.db)]}})})},qa.prototype.jn=function(e){this.Wn=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},qa.prototype.runTransaction=function(r,c,h){return m(this,void 0,void 0,function(){var s,u,e,a,n;return w(this,function(t){switch(t.label){case 0:s="readonly"===r,u=0,e=function(){var e,n,r,i,o;return w(this,function(t){switch(t.label){case 0:++u,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,a.Qn()];case 2:return a.db=t.sent(),e=za.open(a.db,s?"readonly":"readwrite",c),n=h(e).catch(function(t){return e.abort(t),Ca.reject(t)}).Nn(),r={},n.catch(function(){}),[4,e.Kn];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return i=t.sent(),o="FirebaseError"!==i.name&&u<3,Cr("SimpleDb","Transaction failed with error:",i.message,"Retrying:",o),a.close(),o?[3,5]:[2,{value:Promise.reject(i)}];case 5:return[2]}})},a=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(n=t.sent()))return[2,n.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},qa.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},qa),Ua=(Object.defineProperty(Fa.prototype,"vn",{get:function(){return this.zn},enumerable:!1,configurable:!0}),Object.defineProperty(Fa.prototype,"Yn",{get:function(){return this.Hn},enumerable:!1,configurable:!0}),Object.defineProperty(Fa.prototype,"cursor",{set:function(t){this.Gn=t},enumerable:!1,configurable:!0}),Fa.prototype.done=function(){this.zn=!0},Fa.prototype.Jn=function(t){this.Hn=t},Fa.prototype.delete=function(){return Wa(this.Gn.delete())},Fa),Va=(o(Ma,ka=Or),Ma);function Ma(t){var e=this;return(e=ka.call(this,xr.UNAVAILABLE,"IndexedDB transaction failed: "+t)||this).name="IndexedDbTransactionError",e}function Fa(t){this.Gn=t,this.zn=!1,this.Hn=null}function qa(t,e,n){this.name=t,this.version=e,this.kn=n,12.2===qa.Mn(v())&&Pr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function ja(t){var e=this;this.pn=null,this.bn=null,this.result=void 0,this.error=void 0,this.vn=!1,this.Sn=!1,t(function(t){e.vn=!0,e.result=t,e.pn&&e.pn(t)},function(t){e.vn=!0,e.error=t,e.bn&&e.bn(t)})}function Ga(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this._n=t,this.fn=e,this.dn=n,this.wn=r,this.mn=i,this.Tn=0,this.En=null,this.In=Date.now(),this.reset()}function Ba(t){return"IndexedDbTransactionError"===t.name}var za=(Ka.open=function(t,e,n){try{return new Ka(t.transaction(n,e))}catch(t){throw new Va(t)}},Object.defineProperty(Ka.prototype,"Kn",{get:function(){return this.Xn.promise},enumerable:!1,configurable:!0}),Ka.prototype.abort=function(t){t&&this.Xn.reject(t),this.aborted||(Cr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Ka.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Ha(e)},Ka),Ha=(Qa.prototype.put=function(t,e){return Wa(void 0!==e?(Cr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Cr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},Qa.prototype.add=function(t){return Cr("SimpleDb","ADD",this.store.name,t,t),Wa(this.store.add(t))},Qa.prototype.get=function(e){var n=this;return Wa(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Cr("SimpleDb","GET",n.store.name,e,t),t})},Qa.prototype.delete=function(t){return Cr("SimpleDb","DELETE",this.store.name,t),Wa(this.store.delete(t))},Qa.prototype.count=function(){return Cr("SimpleDb","COUNT",this.store.name),Wa(this.store.count())},Qa.prototype.Zn=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.ts(n,function(t,e){r.push(e)}).next(function(){return r})},Qa.prototype.es=function(t,e){Cr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.ns=!1;var r=this.cursor(n);return this.ts(r,function(t,e,n){return n.delete()})},Qa.prototype.ss=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.ts(r,e)},Qa.prototype.rs=function(i){var t=this.cursor({});return new Ca(function(n,r){t.onerror=function(t){var e=Xa(t.target.error);r(e)},t.onsuccess=function(t){var e=t.target.result;e?i(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},Qa.prototype.ts=function(t,s){var u=[];return new Ca(function(o,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n,r,i=t.target.result;i?(e=new Ua(i),(n=s(i.primaryKey,i.value,e))instanceof Ca&&(r=n.catch(function(t){return e.done(),Ca.reject(t)}),u.push(r)),e.vn?o():null===e.Yn?i.continue():i.continue(e.Yn)):o()}}).next(function(){return Ca.$n(u)})},Qa.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Qa.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.ns?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Qa);function Qa(t){this.store=t}function Ka(t){var n=this;this.transaction=t,this.aborted=!1,this.Xn=new Ra,this.transaction.oncomplete=function(){n.Xn.resolve()},this.transaction.onabort=function(){t.error?n.Xn.reject(new Va(t.error)):n.Xn.resolve()},this.transaction.onerror=function(t){var e=Xa(t.target.error);n.Xn.reject(new Va(e))}}function Wa(t){return new Ca(function(n,r){t.onsuccess=function(t){var e=t.target.result;n(e)},t.onerror=function(t){var e=Xa(t.target.error);r(e)}})}var Ya=!1;function Xa(t){var e=Pa.Mn(v());if(12.2<=e&&e<13){var n="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(n)){var r=new Or("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Ya||(Ya=!0,setTimeout(function(){throw r},0)),r}}return t}function $a(){return"undefined"!=typeof window?window:null}function Ja(){return"undefined"!=typeof document?document:null}var Za=(nc.ls=function(t,e,n,r,i){var o=new nc(t,e,Date.now()+n,r,i);return o.start(n),o},nc.prototype.start=function(t){var e=this;this._s=setTimeout(function(){return e.fs()},t)},nc.prototype.Vn=function(){return this.fs()},nc.prototype.cancel=function(t){null!==this._s&&(this.clearTimeout(),this.hs.reject(new Or(xr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},nc.prototype.fs=function(){var e=this;this.os.ds(function(){return null!==e._s?(e.clearTimeout(),e.op().then(function(t){return e.hs.resolve(t)})):Promise.resolve()})},nc.prototype.clearTimeout=function(){null!==this._s&&(this.us(this),clearTimeout(this._s),this._s=null)},nc),tc=(Object.defineProperty(ec.prototype,"Vs",{get:function(){return this.Es},enumerable:!1,configurable:!0}),ec.prototype.ds=function(t){this.enqueue(t)},ec.prototype.ps=function(t){this.bs(),this.vs(t)},ec.prototype.Ss=function(){var t;this.Es||(this.Es=!0,(t=Ja())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.ys))},ec.prototype.enqueue=function(t){return this.bs(),this.Es?new Promise(function(t){}):this.vs(t)},ec.prototype.Ds=function(t){var e=this;this.Ts.push(t),this.ds(function(){return e.Cs()})},ec.prototype.Cs=function(){return m(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(0===this.Ts.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Ts[0]()];case 2:return t.sent(),this.Ts.shift(),this.gs.reset(),[3,4];case 3:if(!Ba(e=t.sent()))throw e;return Cr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Ts.length&&this.gs.Rn(function(){return n.Cs()}),t.label=5;case 5:return[2]}})})},ec.prototype.vs=function(t){var r=this,e=this.ws.then(function(){return r.Rs=!0,t().catch(function(t){throw r.As=t,r.Rs=!1,Pr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Rs=!1,t})});return this.ws=e},ec.prototype.gn=function(t,e,n){var r=this;this.bs(),-1<this.Ps.indexOf(t)&&(e=0);var i=Za.ls(this,t,e,n,function(t){return r.Ns(t)});return this.Is.push(i),i},ec.prototype.bs=function(){this.As&&Mr()},ec.prototype.Fs=function(){},ec.prototype.$s=function(){return m(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return[4,e=this.ws];case 1:t.sent(),t.label=2;case 2:if(e!==this.ws)return[3,0];t.label=3;case 3:return[2]}})})},ec.prototype.xs=function(t){for(var e=0,n=this.Is;e<n.length;e++)if(n[e].fn===t)return!0;return!1},ec.prototype.ks=function(r){var i=this;return this.$s().then(function(){i.Is.sort(function(t,e){return t.cs-e.cs});for(var t=0,e=i.Is;t<e.length;t++){var n=e[t];if(n.Vn(),"all"!==r&&n.fn===r)break}return i.$s()})},ec.prototype.Ms=function(t){this.Ps.push(t)},ec.prototype.Ns=function(t){var e=this.Is.indexOf(t);this.Is.splice(e,1)},ec);function ec(){var e=this;this.ws=Promise.resolve(),this.Ts=[],this.Es=!1,this.Is=[],this.As=null,this.Rs=!1,this.Ps=[],this.gs=new La(this,"async_queue_retry"),this.ys=function(){var t=Ja();t&&Cr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.gs.yn()};var t=Ja();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.ys)}function nc(t,e,n,r,i){this.os=t,this.fn=e,this.cs=n,this.op=r,this.us=i,this.hs=new Ra,this.then=this.hs.promise.then.bind(this.hs.promise),this.hs.promise.catch(function(t){})}function rc(t,e){if(Pr("AsyncQueue",e+": "+t),Ba(t))return new Or(xr.UNAVAILABLE,e+": "+t);throw t}function ic(){this.Os=void 0,this.listeners=[]}function oc(){this.Ls=new Ci($u,Xu),this.onlineState="Unknown",this.Bs=new Set}function sc(a,c){return m(this,void 0,void 0,function(){var e,n,r,i,o,s,u;return w(this,function(t){switch(t.label){case 0:if(e=a,n=c.query,r=!1,(i=e.Ls.get(n))||(r=!0,i=new ic),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.qs(n)];case 2:return o.Os=t.sent(),[3,4];case 3:return s=t.sent(),u=rc(s,"Initialization of query '"+Ju(c.query)+"' failed"),[2,void c.onError(u)];case 4:return e.Ls.set(n,i),i.listeners.push(c),c.Us(e.onlineState),i.Os&&c.Qs(i.Os)&&ac(e),[2]}})})}function uc(s,u){return m(this,void 0,void 0,function(){var e,n,r,i,o;return w(this,function(t){return e=s,n=u.query,r=!1,(i=e.Ls.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.Ls.delete(n),e.Ws(n))]:[2]})})}function ac(t){t.Bs.forEach(function(t){t.next()})}var cc=(lc.prototype.Qs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new To(t.query,t.docs,t.Ut,e,t.Qt,t.fromCache,t.Wt,!0)}var o=!1;return this.Ks?this.zs(t)&&(this.js.next(t),o=!0):this.Hs(t,this.onlineState)&&(this.Ys(t),o=!0),this.Gs=t,o},lc.prototype.onError=function(t){this.js.error(t)},lc.prototype.Us=function(t){this.onlineState=t;var e=!1;return this.Gs&&!this.Ks&&this.Hs(this.Gs,t)&&(this.Ys(this.Gs),e=!0),e},lc.prototype.Hs=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Js&&n||t.docs.m()&&"Offline"!==e)},lc.prototype.zs=function(t){if(0<t.docChanges.length)return!0;var e=this.Gs&&this.Gs.hasPendingWrites!==t.hasPendingWrites;return!(!t.Wt&&!e)&&!0===this.options.includeMetadataChanges},lc.prototype.Ys=function(t){t=To.Kt(t.query,t.docs,t.Qt,t.fromCache),this.Ks=!0,this.js.next(t)},lc),hc=(fc.prototype.Xs=function(){return null!=this.uid},fc.prototype.Zs=function(){return this.Xs()?"uid:"+this.uid:"anonymous-user"},fc.prototype.isEqual=function(t){return t.uid===this.uid},fc);function fc(t){this.uid=t}function lc(t,e,n){this.query=t,this.js=e,this.Ks=!1,this.Gs=null,this.onlineState="Unknown",this.options=n||{}}hc.UNAUTHENTICATED=new hc(null),hc.ti=new hc("google-credentials-uid"),hc.ei=new hc("first-party-uid");var pc=(dc.prototype.si=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},dc.prototype.next=function(){var t=++this.previousValue;return this.ii&&this.ii(t),t},dc);function dc(t,e){var n=this;this.previousValue=t,e&&(e.ni=function(t){return n.si(t)},this.ii=function(t){return e.ri(t)})}function vc(t,e){return"firestore_clients_"+t+"_"+e}function yc(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.Xs()&&(r+="_"+e.uid),r}function gc(t,e){return"firestore_targets_"+t+"_"+e}pc.oi=-1;var mc=(zc.ai=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Or(r.error.code,r.error.message)),i?new zc(t,e,r.state,o):(Pr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},zc.prototype.ci=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},zc),wc=(Bc.ai=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Or(n.error.code,n.error.message)),r?new Bc(t,n.state,i):(Pr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},Bc.prototype.ci=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Bc),bc=(Gc.ai=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=bo,o=0;r&&o<n.activeTargetIds.length;++o)r=zi(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new Gc(t,i):(Pr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},Gc),Ic=(jc.ai=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new jc(e.clientId,e.onlineState):(Pr("SharedClientState","Failed to parse online state: "+t),null)},jc),Ec=(qc.prototype.ui=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},qc.prototype.hi=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},qc.prototype.ci=function(){var t={activeTargetIds:this.activeTargetIds.A(),updateTimeMs:Date.now()};return JSON.stringify(t)},qc),Tc=(Fc.On=function(t){return!(!t||!t.localStorage)},Fc.prototype.start=function(){return m(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l=this;return w(this,function(t){switch(t.label){case 0:return[4,this._i.Vi()];case 1:for(e=t.sent(),n=0,r=e;n<r.length;n++)(i=r[n])!==this.li&&(o=this.getItem(vc(this.persistenceKey,i)))&&(s=bc.ai(i,o))&&(this.mi=this.mi.rt(s.clientId,s));for(this.pi(),(u=this.storage.getItem(this.yi))&&(a=this.bi(u))&&this.vi(a),c=0,h=this.Ei;c<h.length;c++)f=h[c],this.wi(f);return this.Ei=[],this.window.addEventListener("unload",function(){return l.Si()}),this.Ti=!0,[2]}})})},Fc.prototype.ri=function(t){this.setItem(this.Ai,JSON.stringify(t))},Fc.prototype.Di=function(){return this.Ci(this.mi)},Fc.prototype.Ni=function(n){var r=!1;return this.mi.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},Fc.prototype.Fi=function(t){this.$i(t,"pending")},Fc.prototype.xi=function(t,e,n){this.$i(t,e,n),this.ki(t)},Fc.prototype.Mi=function(t){var e,n,r="not-current";return this.Ni(t)&&(!(e=this.storage.getItem(gc(this.persistenceKey,t)))||(n=wc.ai(t,e))&&(r=n.state)),this.Oi.ui(t),this.pi(),r},Fc.prototype.Li=function(t){this.Oi.hi(t),this.pi()},Fc.prototype.Bi=function(t){return this.Oi.activeTargetIds.has(t)},Fc.prototype.qi=function(t){this.removeItem(gc(this.persistenceKey,t))},Fc.prototype.Ui=function(t,e,n){this.Qi(t,e,n)},Fc.prototype.Wi=function(t,e,n){var r=this;e.forEach(function(t){r.ki(t)}),this.currentUser=t,n.forEach(function(t){r.Fi(t)})},Fc.prototype.ji=function(t){this.Ki(t)},Fc.prototype.Si=function(){this.Ti&&(this.window.removeEventListener("storage",this.di),this.removeItem(this.Ii),this.Ti=!1)},Fc.prototype.getItem=function(t){var e=this.storage.getItem(t);return Cr("SharedClientState","READ",t,e),e},Fc.prototype.setItem=function(t,e){Cr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},Fc.prototype.removeItem=function(t){Cr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},Fc.prototype.wi=function(t){var e=this,u=t;if(u.storageArea===this.storage){if(Cr("SharedClientState","EVENT",u.key,u.newValue),u.key===this.Ii)return void Pr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this._n.Ds(function(){return m(e,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){if(this.Ti){if(null!==u.key)if(this.Ri.test(u.key)){if(null==u.newValue)return e=this.Gi(u.key),[2,this.zi(e,null)];if(n=this.Hi(u.key,u.newValue))return[2,this.zi(n.clientId,n)]}else if(this.Pi.test(u.key)){if(null!==u.newValue&&(r=this.Yi(u.key,u.newValue)))return[2,this.Ji(r)]}else if(this.gi.test(u.key)){if(null!==u.newValue&&(i=this.Xi(u.key,u.newValue)))return[2,this.Zi(i)]}else if(u.key===this.yi){if(null!==u.newValue&&(o=this.bi(u.newValue)))return[2,this.vi(o)]}else u.key===this.Ai&&(s=function(t){var e=pc.oi;if(null!=t)try{var n=JSON.parse(t);Fr("number"==typeof n),e=n}catch(t){Pr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(u.newValue))!==pc.oi&&this.ni(s)}else this.Ei.push(u);return[2]})})})}},Object.defineProperty(Fc.prototype,"Oi",{get:function(){return this.mi.get(this.li)},enumerable:!1,configurable:!0}),Fc.prototype.pi=function(){this.setItem(this.Ii,this.Oi.ci())},Fc.prototype.$i=function(t,e,n){var r=new mc(this.currentUser,t,e,n),i=yc(this.persistenceKey,this.currentUser,t);this.setItem(i,r.ci())},Fc.prototype.ki=function(t){var e=yc(this.persistenceKey,this.currentUser,t);this.removeItem(e)},Fc.prototype.Ki=function(t){var e={clientId:this.li,onlineState:t};this.storage.setItem(this.yi,JSON.stringify(e))},Fc.prototype.Qi=function(t,e,n){var r=gc(this.persistenceKey,t),i=new wc(t,e,n);this.setItem(r,i.ci())},Fc.prototype.Gi=function(t){var e=this.Ri.exec(t);return e?e[1]:null},Fc.prototype.Hi=function(t,e){var n=this.Gi(t);return bc.ai(n,e)},Fc.prototype.Yi=function(t,e){var n=this.Pi.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return mc.ai(new hc(i),r,e)},Fc.prototype.Xi=function(t,e){var n=this.gi.exec(t),r=Number(n[1]);return wc.ai(r,e)},Fc.prototype.bi=function(t){return Ic.ai(t)},Fc.prototype.Ji=function(e){return m(this,void 0,void 0,function(){return w(this,function(t){return e.user.uid===this.currentUser.uid?[2,this._i.tr(e.batchId,e.state,e.error)]:(Cr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},Fc.prototype.Zi=function(t){return this._i.er(t.targetId,t.state,t.error)},Fc.prototype.zi=function(t,e){var n=this,r=e?this.mi.rt(t,e):this.mi.remove(t),i=this.Ci(this.mi),o=this.Ci(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this._i.nr(s,u).then(function(){n.mi=r})},Fc.prototype.vi=function(t){this.mi.get(t.clientId)&&this.fi(t.onlineState)},Fc.prototype.Ci=function(t){var n=bo;return t.forEach(function(t,e){n=n.xt(e.activeTargetIds)}),n},Fc),_c=(Mc.prototype.Fi=function(t){},Mc.prototype.xi=function(t,e,n){},Mc.prototype.Mi=function(t){return this.sr.ui(t),this.ir[t]||"not-current"},Mc.prototype.Ui=function(t,e,n){this.ir[t]=e},Mc.prototype.Li=function(t){this.sr.hi(t)},Mc.prototype.Bi=function(t){return this.sr.activeTargetIds.has(t)},Mc.prototype.qi=function(t){delete this.ir[t]},Mc.prototype.Di=function(){return this.sr.activeTargetIds},Mc.prototype.Ni=function(t){return this.sr.activeTargetIds.has(t)},Mc.prototype.start=function(){return this.sr=new Ec,Promise.resolve()},Mc.prototype.Wi=function(t,e,n){},Mc.prototype.ji=function(t){},Mc.prototype.Si=function(){},Mc.prototype.ri=function(t){},Mc),Ac=(Vc.prototype.ar=function(t,e,n){for(var r,i,o,s=n.cr,u=0;u<this.mutations.length;u++){var a=this.mutations[u];a.key.isEqual(t)&&(r=a,i=e,o=s[u],e=r instanceof au?new Ru(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof cu?function(t,e,n){if(!eu(t.Ke,e))return new Lu(t.key,n.version);var r=lu(t,e);return new Ru(t.key,n.version,r,{hasCommittedMutations:!0})}(r,i,o):r instanceof du?function(t,e,n){if(Fr(null!=n.transformResults),!eu(t.Ke,e))return new Lu(t.key,n.version);var r=e,i=function(t,e,n){var r=[];Fr(t.length===n.length);for(var i,o,s,u=0;u<n.length;u++){var a=t[u],c=a.transform,h=null;e instanceof Ru&&(h=e.field(a.field)),r.push((i=c,o=h,s=n[u],i instanceof Us?Fs(i,o):i instanceof js?Bs(i,o):s))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=yu(t,r.data(),i);return new Ru(t.key,o,s,{hasCommittedMutations:!0})}(r,i,o):new ku(r.key,o.version,{hasCommittedMutations:!0}))}return e},Vc.prototype.ur=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=ru(i,e,e,this.rr))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=ru(a,e,o,this.rr))}return e},Vc.prototype.hr=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ur(t.key,n.get(t.key));e&&(i=i.rt(t.key,e))}),i},Vc.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},wo())},Vc.prototype.isEqual=function(t){return this.batchId===t.batchId&&Ei(this.mutations,t.mutations,iu)&&Ei(this.baseMutations,t.baseMutations,iu)},Vc),Nc=(Uc.from=function(t,e,n){Fr(t.mutations.length===n.length);for(var r=go,i=t.mutations,o=0;o<i.length;o++)r=r.rt(i[o].key,n[o].version);return new Uc(t,e,n,r)},Uc),Sc=(Object.defineProperty(Pc.prototype,"readTime",{get:function(){return this.mr},set:function(t){this.mr=t},enumerable:!1,configurable:!0}),Pc.prototype.Tr=function(t,e){this.Er(),this.readTime=e,this.dr.set(t.key,t)},Pc.prototype.Ir=function(t,e){this.Er(),e&&(this.readTime=e),this.dr.set(t,null)},Pc.prototype.Ar=function(t,e){this.Er();var n=this.dr.get(e);return void 0!==n?Ca.resolve(n):this.Rr(t,e)},Pc.prototype.getEntries=function(t,e){return this.Pr(t,e)},Pc.prototype.apply=function(t){return this.Er(),this.wr=!0,this.gr(t)},Pc.prototype.Er=function(){},Pc),Dc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",xc=(Cc.prototype.Vr=function(t){this.yr.push(t)},Cc.prototype.pr=function(){this.yr.forEach(function(t){return t()})},Cc),Oc=(Lc.prototype.Dr=function(e,n){var r=this;return this.vr.Cr(e,n).next(function(t){return r.Nr(e,n,t)})},Lc.prototype.Nr=function(t,r,i){return this.br.Ar(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ur(r,t);return t})},Lc.prototype.Fr=function(t,e,i){var o=lo;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ur(t,e);o=o.rt(t,e)}),o},Lc.prototype.$r=function(e,t){var n=this;return this.br.getEntries(e,t).next(function(t){return n.kr(e,t)})},Lc.prototype.kr=function(r,i){var o=this;return this.vr.Mr(r,i).next(function(t){var e=o.Fr(r,i,t),n=lo;return e.forEach(function(t,e){e=e||new ku(t,Ui.min()),n=n.rt(t,e)}),n})},Lc.prototype.Or=function(t,e,n){return r=e,Yr.F(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Lr(t,e.path):zu(e)?this.Br(t,e,n):this.qr(t,e,n);var r},Lc.prototype.Lr=function(t,e){return this.Dr(t,new Yr(e)).next(function(t){var e=yo;return t instanceof Ru&&(e=e.rt(t.key,t)),e})},Lc.prototype.Br=function(i,o,s){var u=this,a=o.collectionGroup,c=yo;return this.Sr.Ur(i,a).next(function(t){return Ca.forEach(t,function(t){var e,n,r=(e=o,n=t.child(a),new Cu(n,null,e.rn.slice(),e.filters.slice(),e.limit,e.on,e.startAt,e.endAt));return u.qr(i,r,s).next(function(t){t.forEach(function(t,e){c=c.rt(t,e)})})}).next(function(){return c})})},Lc.prototype.qr=function(e,n,t){var h,f,r=this;return this.br.Or(e,n,t).next(function(t){return h=t,r.vr.Qr(e,n)}).next(function(t){return f=t,r.Wr(e,f,h).next(function(t){h=t;for(var e=0,n=f;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=h.get(u),c=ru(s,a,a,r.rr);h=c instanceof Ru?h.rt(u,c):h.remove(u)}})}).next(function(){return h.forEach(function(t,e){Zu(n,e)||(h=h.remove(t))}),h})},Lc.prototype.Wr=function(t,e,n){for(var r=wo(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof cu&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.br.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Ru&&(c=c.rt(t,e))}),c})},Lc),Rc=(kc.Gr=function(t,e){for(var n=wo(),r=wo(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new kc(t,e.fromCache,n,r)},kc);function kc(t,e,n,r){this.targetId=t,this.fromCache=e,this.jr=n,this.Kr=r}function Lc(t,e,n){this.br=t,this.vr=e,this.Sr=n}function Cc(){this.yr=[]}function Pc(){this.dr=new Ci(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.wr=!1}function Uc(t,e,n,r){this.batch=t,this.lr=e,this.cr=n,this._r=r}function Vc(t,e,n,r){this.batchId=t,this.rr=e,this.baseMutations=n,this.mutations=r}function Mc(){this.sr=new Ec,this.ir={},this.fi=null,this.ni=null}function Fc(t,e,n,r,i){this.window=t,this._n=e,this.persistenceKey=n,this.li=r,this._i=null,this.fi=null,this.ni=null,this.di=this.wi.bind(this),this.mi=new ro(Ii),this.Ti=!1,this.Ei=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ii=vc(this.persistenceKey,this.li),this.Ai="firestore_sequence_number_"+this.persistenceKey,this.mi=this.mi.rt(this.li,new Ec),this.Ri=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Pi=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.gi=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.yi="firestore_online_state_"+this.persistenceKey,this.window.addEventListener("storage",this.di)}function qc(){this.activeTargetIds=bo}function jc(t,e){this.clientId=t,this.onlineState=e}function Gc(t,e){this.clientId=t,this.activeTargetIds=e}function Bc(t,e,n){this.targetId=t,this.state=e,this.error=n}function zc(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function Hc(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Ii(n,i);return 0===s?Ii(r,o):s}var Qc=(Xc.prototype.Yr=function(){return++this.Hr},Xc.prototype.Jr=function(t){var e,n=[t,this.Yr()];this.buffer.size<this.zr?this.buffer=this.buffer.add(n):Hc(n,e=this.buffer.last())<0&&(this.buffer=this.buffer.delete(e).add(n))},Object.defineProperty(Xc.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),Xc),Kc={Xr:!1,Zr:0,eo:0,no:0},Wc=(Yc.oo=function(t){return new Yc(t,Yc.ao,Yc.co)},Yc);function Yc(t,e,n){this.so=t,this.io=e,this.ro=n}function Xc(t){this.zr=t,this.buffer=new ho(Hc),this.Hr=0}Wc.uo=-1,Wc.ho=1048576,Wc.lo=41943040,Wc.ao=10,Wc.co=1e3,Wc._o=new Wc(Wc.lo,Wc.ao,Wc.co),Wc.fo=new Wc(Wc.uo,0,0);var $c=(th.prototype.start=function(t){this.do.params.so!==Wc.uo&&this.To(t)},th.prototype.stop=function(){this.mo&&(this.mo.cancel(),this.mo=null)},Object.defineProperty(th.prototype,"Ti",{get:function(){return null!==this.mo},enumerable:!1,configurable:!0}),th.prototype.To=function(n){var t=this,e=this.wo?3e5:6e4;Cr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.mo=this.os.gn("lru_garbage_collection",e,function(){return m(t,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:this.mo=null,this.wo=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.Eo(this.do)];case 2:return t.sent(),[3,7];case 3:return Ba(e=t.sent())?(Cr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Df(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.To(n)];case 8:return t.sent(),[2]}})})})},th),Jc=(Zc.prototype.Ao=function(t,e){return this.Io.Ro(t).next(function(t){return Math.floor(e/100*t)})},Zc.prototype.Po=function(t,e){var n=this;if(0===e)return Ca.resolve(pc.oi);var r=new Qc(e);return this.Io.De(t,function(t){return r.Jr(t.sequenceNumber)}).next(function(){return n.Io.yo(t,function(t){return r.Jr(t)})}).next(function(){return r.maxValue})},Zc.prototype.Vo=function(t,e,n){return this.Io.Vo(t,e,n)},Zc.prototype.po=function(t,e){return this.Io.po(t,e)},Zc.prototype.bo=function(e,n){var r=this;return this.params.so===Wc.uo?(Cr("LruGarbageCollector","Garbage collection skipped; disabled"),Ca.resolve(Kc)):this.vo(e).next(function(t){return t<r.params.so?(Cr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.so),Kc):r.So(e,n)})},Zc.prototype.vo=function(t){return this.Io.vo(t)},Zc.prototype.So=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.Ao(e,this.params.io).next(function(t){return i=t>h.params.ro?(Cr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.ro+" from "+t),h.params.ro):t,s=Date.now(),h.Po(e,i)}).next(function(t){return r=t,u=Date.now(),h.Vo(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.po(e,r)}).next(function(t){return c=Date.now(),Lr()<=l.DEBUG&&Cr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),Ca.resolve({Xr:!0,Zr:i,eo:o,no:t})})},Zc);function Zc(t,e){this.Io=t,this.params=e}function th(t,e){this.do=t,this.os=e,this.wo=!1,this.mo=null}function eh(t){for(var o="",e=0;e<t.length;e++)0<o.length&&(o=nh(o)),o=function(t){for(var e=o,n=t.length,r=0;r<n;r++){var i=t.charAt(r);switch(i){case"\0":e+="";break;case"":e+="";break;default:e+=i}}return e}(t.get(e));return nh(o)}function nh(t){return t+""}function rh(t){var e=t.length;if(Fr(2<=e),2===e)return Fr(""===t.charAt(0)&&""===t.charAt(1)),Qr.g();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&Mr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Mr()}o=s+2}return new Qr(r)}var ih=function(t){this.Do=t};function oh(t,e){if(e.document)return n=t.Do,r=e.document,i=!!e.hasCommittedMutations,o=ys(n,r.name),s=ls(r.updateTime),u=new Iu({mapValue:{fields:r.fields}}),new Ru(o,s,u,{hasCommittedMutations:!!i});var n,r,i,o,s,u;if(e.noDocument){var a=Yr.$(e.noDocument.path),c=hh(e.noDocument.readTime);return new ku(a,c,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var h=Yr.$(e.unknownDocument.path),f=hh(e.unknownDocument.version);return new Lu(h,f)}return Mr()}function sh(t,e,n){var r,i,o=uh(n),s=e.key.path.h().A();if(e instanceof Ru){var u={name:vs(r=t.Do,(i=e).key),fields:i.sn().mapValue.fields,updateTime:hs(r,i.version.X())},a=e.hasCommittedMutations;return new Bh(null,null,u,a,o,s)}if(e instanceof ku){var c=e.key.path.A(),h=ch(e.version),f=e.hasCommittedMutations;return new Bh(null,new jh(c,h),null,f,o,s)}if(e instanceof Lu){var l=e.key.path.A(),p=ch(e.version);return new Bh(new Gh(l,p),null,null,!0,o,s)}return Mr()}function uh(t){var e=t.X();return[e.seconds,e.nanoseconds]}function ah(t){var e=new Pi(t[0],t[1]);return Ui.Y(e)}function ch(t){var e=t.X();return new kh(e.seconds,e.nanoseconds)}function hh(t){var e=new Pi(t.seconds,t.nanoseconds);return Ui.Y(e)}function fh(e,t){var n=(t.baseMutations||[]).map(function(t){return Ts(e.Do,t)}),r=t.mutations.map(function(t){return Ts(e.Do,t)}),i=Pi.fromMillis(t.localWriteTimeMs);return new Ac(t.batchId,i,n,r)}function lh(t){var e,n=hh(t.readTime),r=void 0!==t.lastLimboFreeSnapshotVersion?hh(t.lastLimboFreeSnapshotVersion):Ui.min(),i=void 0!==t.query.documents?(Fr(1===(e=t.query).documents.length),Qu(Fu(ms(e.documents[0])))):function(t){var e,n=ms(t.parent),r=t.structuredQuery,i=r.from?r.from.length:0,o=null;0<i&&(Fr(1===i),(e=r.from[0]).allDescendants?o=e.collectionId:n=n.child(e.collectionId));var s=[];r.where&&(s=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=xs(t.unaryFilter.field);return na.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=xs(t.unaryFilter.field);return na.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=xs(t.unaryFilter.field);return na.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=xs(t.unaryFilter.field);return na.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Mr()}}(e)]:void 0!==e.fieldFilter?[(n=e,na.create(xs(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Mr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Mr():[];var n}(r.where));var u=[];r.orderBy&&(u=r.orderBy.map(function(t){return new Oa(xs((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));var a,c,h=null;r.limit&&(h=Gi(c="object"==typeof(a=r.limit)?a.value:a)?null:c);var f=null;r.startAt&&(f=Ss(r.startAt));var l=null;return r.endAt&&(l=Ss(r.endAt)),Qu(Mu(n,o,u,s,h,"F",f,l))}(t.query);return new Zi(i,t.targetId,0,t.lastListenSequenceNumber,n,r,_i.fromBase64String(t.resumeToken))}function ph(t,e){var n=ch(e.et),r=ch(e.lastLimboFreeSnapshotVersion),i=(Yi(e.target)?_s:As)(t.Do,e.target),o=e.resumeToken.toBase64();return new Hh(e.targetId,Ki(e.target),n,o,e.sequenceNumber,r,i)}var dh=(vh.Fo=function(t,e,n,r){return Fr(""!==t.uid),new vh(t.Xs()?t.uid:"",e,n,r)},vh.prototype.$o=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return mh(t).ss({index:Mh.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},vh.prototype.xo=function(d,v,y,g){var m=this,w=wh(d),b=mh(d);return b.add({}).next(function(t){Fr("number"==typeof t);for(var e,n,r,i,o,s=new Ac(t,v,y,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return Es(e.Do,t)}),o=r.mutations.map(function(t){return Es(e.Do,t)}),new Mh(n,r.batchId,r.rr.toMillis(),i,o)),a=[],c=new ho(function(t,e){return Ii(t.R(),e.R())}),h=0,f=g;h<f.length;h++){var l=f[h],p=Fh.key(m.userId,l.key.path,t),c=c.add(l.key.path.h());a.push(b.put(u)),a.push(w.put(p,Fh.PLACEHOLDER))}return c.forEach(function(t){a.push(m.Sr.ko(d,t))}),d.Vr(function(){m.No[t]=s.keys()}),Ca.$n(a).next(function(){return s})})},vh.prototype.Mo=function(t,e){var n=this;return mh(t).get(e).next(function(t){return t?(Fr(t.userId===n.userId),fh(n.serializer,t)):null})},vh.prototype.Oo=function(t,n){var r=this;return this.No[n]?Ca.resolve(this.No[n]):this.Mo(t,n).next(function(t){if(t){var e=t.keys();return r.No[n]=e}return null})},vh.prototype.Lo=function(t,e){var r=this,i=e+1,n=IDBKeyRange.lowerBound([this.userId,i]),o=null;return mh(t).ss({index:Mh.userMutationsIndex,range:n},function(t,e,n){e.userId===r.userId&&(Fr(e.batchId>=i),o=fh(r.serializer,e)),n.done()}).next(function(){return o})},vh.prototype.Bo=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return mh(t).ss({index:Mh.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},vh.prototype.qo=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return mh(t).Zn(Mh.userMutationsIndex,n).next(function(t){return t.map(function(t){return fh(e.serializer,t)})})},vh.prototype.Cr=function(u,a){var c=this,t=Fh.prefixForPath(this.userId,a.path),e=IDBKeyRange.lowerBound(t),h=[];return wh(u).ss({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=rh(i);if(r===c.userId&&a.path.isEqual(s))return mh(u).get(o).next(function(t){if(!t)throw Mr();Fr(t.userId===c.userId),h.push(fh(c.serializer,t))});n.done()}).next(function(){return h})},vh.prototype.Mr=function(r,t){var a=this,c=new ho(Ii),i=[];return t.forEach(function(u){var t=Fh.prefixForPath(a.userId,u.path),e=IDBKeyRange.lowerBound(t),n=wh(r).ss({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=rh(i);r===a.userId&&u.path.isEqual(s)?c=c.add(o):n.done()});i.push(n)}),Ca.$n(i).next(function(){return a.Uo(r,c)})},vh.prototype.Qr=function(t,e){var u=this,a=e.path,c=a.length+1,n=Fh.prefixForPath(this.userId,a),r=IDBKeyRange.lowerBound(n),h=new ho(Ii);return wh(t).ss({range:r},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=rh(i);r===u.userId&&a.T(s)?s.length===c&&(h=h.add(o)):n.done()}).next(function(){return u.Uo(t,h)})},vh.prototype.Uo=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(mh(e).get(t).next(function(t){if(null===t)throw Mr();Fr(t.userId===n.userId),r.push(fh(n.serializer,t))}))}),Ca.$n(i).next(function(){return r})},vh.prototype.Qo=function(e,n){var r=this;return gh(e.Wo,this.userId,n).next(function(t){return e.Vr(function(){r.jo(n.batchId)}),Ca.forEach(t,function(t){return r.Co.Ko(e,t)})})},vh.prototype.jo=function(t){delete this.No[t]},vh.prototype.Go=function(n){var o=this;return this.$o(n).next(function(t){if(!t)return Ca.resolve();var e=IDBKeyRange.lowerBound(Fh.prefixForUser(o.userId)),i=[];return wh(n).ss({range:e},function(t,e,n){var r;t[0]===o.userId?(r=rh(t[1]),i.push(r)):n.done()}).next(function(){Fr(0===i.length)})})},vh.prototype.zo=function(t,e){return yh(t,this.userId,e)},vh.prototype.Ho=function(t){var e=this;return bh(t).get(this.userId).next(function(t){return t||new Vh(e.userId,-1,"")})},vh);function vh(t,e,n,r){this.userId=t,this.serializer=e,this.Sr=n,this.Co=r,this.No={}}function yh(t,o,e){var n=Fh.prefixForPath(o,e.path),s=n[1],r=IDBKeyRange.lowerBound(n),u=!1;return wh(t).ss({range:r,ns:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function gh(t,e,n){var r=t.store(Mh.store),i=t.store(Fh.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.ss({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){Fr(1===u)}));for(var c=[],h=0,f=n.mutations;h<f.length;h++){var l=f[h],p=Fh.key(e,l.key.path,n.batchId);o.push(i.delete(p)),c.push(l.key)}return Ca.$n(o).next(function(){return c})}function mh(t){return lf.Un(t,Mh.store)}function wh(t){return lf.Un(t,Fh.store)}function bh(t){return lf.Un(t,Vh.store)}var Ih,Eh=(Th.prototype.Tr=function(t,e,n){return Ah(t).put(Nh(e),n)},Th.prototype.Ir=function(t,e){var n=Ah(t),r=Nh(e);return n.delete(r)},Th.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.Yo(e,t)})},Th.prototype.Ar=function(t,e){var n=this;return Ah(t).get(Nh(e)).next(function(t){return n.Jo(t)})},Th.prototype.Xo=function(t,e){var n=this;return Ah(t).get(Nh(e)).next(function(t){var e=n.Jo(t);return e?{Zo:e,size:Sh(t)}:null})},Th.prototype.getEntries=function(t,e){var r=this,i=lo;return this.ta(t,e,function(t,e){var n=r.Jo(e);i=i.rt(t,n)}).next(function(){return i})},Th.prototype.ea=function(t,e){var r=this,i=lo,o=new ro(Yr.i);return this.ta(t,e,function(t,e){var n=r.Jo(e);o=n?(i=i.rt(t,n),o.rt(t,Sh(e))):(i=i.rt(t,null),o.rt(t,0))}).next(function(){return{na:i,sa:o}})},Th.prototype.ta=function(t,e,i){if(e.m())return Ca.resolve();var n=IDBKeyRange.bound(e.first().path.A(),e.last().path.A()),o=e.lt(),s=o.Et();return Ah(t).ss({range:n},function(t,e,n){for(var r=Yr.$(t);s&&Yr.i(s,r)<0;)i(s,null),s=o.Et();s&&s.isEqual(r)&&(i(s,e),s=o.It()?o.Et():null),s?n.Jn(s.path.A()):n.done()}).next(function(){for(;s;)i(s,null),s=o.It()?o.Et():null})},Th.prototype.Or=function(t,i,e){var n,r,o,s=this,u=yo,a=i.path.length+1,c={};return e.isEqual(Ui.min())?(n=i.path.A(),c.range=IDBKeyRange.lowerBound(n)):(r=i.path.A(),o=uh(e),c.range=IDBKeyRange.lowerBound([r,o],!0),c.index=Bh.collectionReadTimeIndex),Ah(t).ss(c,function(t,e,n){var r;t.length===a&&(r=oh(s.serializer,e),i.path.T(r.key.path)?r instanceof Ru&&Zu(i,r)&&(u=u.rt(r.key,r)):n.done())}).next(function(){return u})},Th.prototype.ia=function(t,e){var r=this,i=lo,o=uh(e),n=Ah(t),s=IDBKeyRange.lowerBound(o,!0);return n.ss({index:Bh.readTimeIndex,range:s},function(t,e){var n=oh(r.serializer,e);i=i.rt(n.key,n),o=e.readTime}).next(function(){return{ra:i,readTime:ah(o)}})},Th.prototype.oa=function(t){var e=Ah(t),r=Ui.min();return e.ss({index:Bh.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=ah(e.readTime)),n.done()}).next(function(){return r})},Th.prototype.aa=function(t){return new Th.ca(this,!!t&&t.ua)},Th.prototype.ha=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Th.prototype.getMetadata=function(t){return _h(t).get(zh.key).next(function(t){return Fr(!!t),t})},Th.prototype.Yo=function(t,e){return _h(t).put(zh.key,e)},Th.prototype.Jo=function(t){if(t){var e=oh(this.serializer,t);return e instanceof ku&&e.version.isEqual(Ui.min())?null:e}return null},Th);function Th(t,e){this.serializer=t,this.Sr=e}function _h(t){return lf.Un(t,zh.store)}function Ah(t){return lf.Un(t,Bh.store)}function Nh(t){return t.path.A()}function Sh(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Mr();e=t.noDocument}return JSON.stringify(e).length}function Dh(t,e){var n=this;return(n=Ih.call(this)||this).la=t,n.ua=e,n._a=new Ci(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}Eh.ca=(o(Dh,Ih=Sc),Dh.prototype.gr=function(s){var u=this,a=[],c=0,h=new ho(function(t,e){return Ii(t.R(),e.R())});return this.dr.forEach(function(t,e){var n,r,i,o=u._a.get(t);e?(n=sh(u.la.serializer,e,u.readTime),h=h.add(t.path.h()),r=Sh(n),c+=r-o,a.push(u.la.Tr(s,t,n))):(c-=o,u.ua?(i=sh(u.la.serializer,new ku(t,Ui.min()),u.readTime),a.push(u.la.Tr(s,t,i))):a.push(u.la.Ir(s,t)))}),h.forEach(function(t){a.push(u.la.Sr.ko(s,t))}),a.push(this.la.updateMetadata(s,c)),Ca.$n(a)},Dh.prototype.Rr=function(t,e){var n=this;return this.la.Xo(t,e).next(function(t){return null===t?(n._a.set(e,0),null):(n._a.set(e,t.size),t.Zo)})},Dh.prototype.Pr=function(t,e){var n=this;return this.la.ea(t,e).next(function(t){var e=t.na;return t.sa.forEach(function(t,e){n._a.set(t,e)}),e})},Dh);var xh=(Uh.prototype.ko=function(t,e){return this.fa.add(e),Ca.resolve()},Uh.prototype.Ur=function(t,e){return Ca.resolve(this.fa.getEntries(e))},Uh),Oh=(Ph.prototype.add=function(t){var e=t._(),n=t.h(),r=this.index[e]||new ho(Qr.i),i=!r.has(n);return this.index[e]=r.add(n),i},Ph.prototype.has=function(t){var e=t._(),n=t.h(),r=this.index[e];return r&&r.has(n)},Ph.prototype.getEntries=function(t){return(this.index[t]||new ho(Qr.i)).A()},Ph),Rh=(Ch.prototype.createOrUpgrade=function(n,r,t,e){var i=this;Fr(t<e&&0<=t&&e<=10);var o,s=new za(r);t<1&&1<=e&&(n.createObjectStore(Lh.store),(o=n).createObjectStore(Vh.store,{keyPath:Vh.keyPath}),o.createObjectStore(Mh.store,{keyPath:Mh.keyPath,autoIncrement:!0}).createIndex(Mh.userMutationsIndex,Mh.userMutationsKeyPath,{unique:!0}),o.createObjectStore(Fh.store),Yh(n),n.createObjectStore(Bh.store));var u,a=Ca.resolve();return t<3&&3<=e&&(0!==t&&((u=n).deleteObjectStore(Qh.store),u.deleteObjectStore(Hh.store),u.deleteObjectStore(Kh.store),Yh(n)),a=a.next(function(){return t=s.store(Kh.store),e=new Kh(0,0,Ui.min().X(),0),t.put(Kh.key,e);var t,e})),t<4&&4<=e&&(0!==t&&(a=a.next(function(){return r=n,(i=s).store(Mh.store).Zn().next(function(t){r.deleteObjectStore(Mh.store),r.createObjectStore(Mh.store,{keyPath:Mh.keyPath,autoIncrement:!0}).createIndex(Mh.userMutationsIndex,Mh.userMutationsKeyPath,{unique:!0});var e=i.store(Mh.store),n=t.map(function(t){return e.put(t)});return Ca.$n(n)});var r,i})),a=a.next(function(){n.createObjectStore(Xh.store,{keyPath:Xh.keyPath})})),t<5&&5<=e&&(a=a.next(function(){return i.removeAcknowledgedMutations(s)})),t<6&&6<=e&&(a=a.next(function(){return n.createObjectStore(zh.store),i.addDocumentGlobal(s)})),t<7&&7<=e&&(a=a.next(function(){return i.ensureSequenceNumbers(s)})),t<8&&8<=e&&(a=a.next(function(){return i.createCollectionParentIndex(n,s)})),t<9&&9<=e&&(a=a.next(function(){var t,e;(e=n).objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges"),(t=r.objectStore(Bh.store)).createIndex(Bh.readTimeIndex,Bh.readTimeIndexPath,{unique:!1}),t.createIndex(Bh.collectionReadTimeIndex,Bh.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=e&&(a=a.next(function(){return i.rewriteCanonicalIds(s)})),a},Ch.prototype.addDocumentGlobal=function(e){var n=0;return e.store(Bh.store).ss(function(t,e){n+=Sh(e)}).next(function(){var t=new zh(n);return e.store(zh.store).put(zh.key,t)})},Ch.prototype.removeAcknowledgedMutations=function(r){var i=this,t=r.store(Vh.store),e=r.store(Mh.store);return t.Zn().next(function(t){return Ca.forEach(t,function(n){var t=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return e.Zn(Mh.userMutationsIndex,t).next(function(t){return Ca.forEach(t,function(t){Fr(t.userId===n.userId);var e=fh(i.serializer,t);return gh(r,n.userId,e).next(function(){})})})})})},Ch.prototype.ensureSequenceNumbers=function(t){var s=t.store(Qh.store),e=t.store(Bh.store);return t.store(Kh.store).get(Kh.key).next(function(i){var o=[];return e.ss(function(t,e){var n=new Qr(t),r=[0,eh(n)];o.push(s.get(r).next(function(t){return t?Ca.resolve():s.put(new Qh(0,eh(n),i.highestListenSequenceNumber))}))}).next(function(){return Ca.$n(o)})})},Ch.prototype.createCollectionParentIndex=function(t,e){function r(t){if(o.add(t)){var e=t._(),n=t.h();return i.put({collectionId:e,parent:eh(n)})}}t.createObjectStore(Wh.store,{keyPath:Wh.keyPath});var i=e.store(Wh.store),o=new Oh;return e.store(Bh.store).ss({ns:!0},function(t,e){return r(new Qr(t).h())}).next(function(){return e.store(Fh.store).ss({ns:!0},function(t,e){t[0];var n=t[1];return r((t[2],rh(n)).h())})})},Ch.prototype.rewriteCanonicalIds=function(t){var i=this,o=t.store(Hh.store);return o.ss(function(t,e){var n=lh(e),r=ph(i.serializer,n);return o.put(r)})},Ch),kh=function(t,e){this.seconds=t,this.nanoseconds=e},Lh=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function Ch(t){this.serializer=t}function Ph(){this.index={}}function Uh(){this.fa=new Oh}Lh.store="owner",Lh.key="owner";var Vh=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Vh.store="mutationQueues",Vh.keyPath="userId";var Mh=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Mh.store="mutations",Mh.keyPath="batchId",Mh.userMutationsIndex="userMutationsIndex",Mh.userMutationsKeyPath=["userId","batchId"];var Fh=(qh.prefixForUser=function(t){return[t]},qh.prefixForPath=function(t,e){return[t,eh(e)]},qh.key=function(t,e,n){return[t,eh(e),n]},qh);function qh(){}Fh.store="documentMutations",Fh.PLACEHOLDER=new Fh;var jh=function(t,e){this.path=t,this.readTime=e},Gh=function(t,e){this.path=t,this.version=e},Bh=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Bh.store="remoteDocuments",Bh.readTimeIndex="readTimeIndex",Bh.readTimeIndexPath="readTime",Bh.collectionReadTimeIndex="collectionReadTimeIndex",Bh.collectionReadTimeIndexPath=["parentPath","readTime"];var zh=function(t){this.byteSize=t};zh.store="remoteDocumentGlobal",zh.key="remoteDocumentGlobalKey";var Hh=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Hh.store="targets",Hh.keyPath="targetId",Hh.queryTargetsIndexName="queryTargetsIndex",Hh.queryTargetsKeyPath=["canonicalId","targetId"];var Qh=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Qh.store="targetDocuments",Qh.keyPath=["targetId","path"],Qh.documentTargetsIndex="documentTargetsIndex",Qh.documentTargetsKeyPath=["path","targetId"];var Kh=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Kh.key="targetGlobalKey",Kh.store="targetGlobal";var Wh=function(t,e){this.collectionId=t,this.parent=e};function Yh(t){t.createObjectStore(Qh.store,{keyPath:Qh.keyPath}).createIndex(Qh.documentTargetsIndex,Qh.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Hh.store,{keyPath:Hh.keyPath}).createIndex(Hh.queryTargetsIndexName,Hh.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Kh.store)}Wh.store="collectionParents",Wh.keyPath=["collectionId","parent"];var Xh=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Xh.store="clientMetadata",Xh.keyPath="clientId";var $h=s(s(s([Vh.store,Mh.store,Fh.store,Bh.store,Hh.store,Lh.store,Kh.store,Qh.store],[Xh.store]),[zh.store]),[Wh.store]),Jh=(Zh.prototype.ko=function(t,e){var n=this;if(this.da.has(e))return Ca.resolve();var r=e._(),i=e.h();t.Vr(function(){n.da.add(e)});var o={collectionId:r,parent:eh(i)};return tf(t).put(o)},Zh.prototype.Ur=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Ti(i),""],!1,!0);return tf(t).Zn(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(rh(r.parent))}return o})},Zh);function Zh(){this.da=new Oh}function tf(t){return lf.Un(t,Wh.store)}var ef=(of.prototype.next=function(){return this.wa+=2,this.wa},of.ma=function(){return new of(0)},of.Ta=function(){return new of(-1)},of),nf=(rf.prototype.Ea=function(n){var r=this;return this.Ia(n).next(function(t){var e=new ef(t.highestTargetId);return t.highestTargetId=e.next(),r.Aa(n,t).next(function(){return t.highestTargetId})})},rf.prototype.Ra=function(t){return this.Ia(t).next(function(t){return Ui.Y(new Pi(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},rf.prototype.Pa=function(t){return this.Ia(t).next(function(t){return t.highestListenSequenceNumber})},rf.prototype.ga=function(e,n,r){var i=this;return this.Ia(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.X()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.Aa(e,t)})},rf.prototype.ya=function(e,n){var r=this;return this.Va(e,n).next(function(){return r.Ia(e).next(function(t){return t.targetCount+=1,r.pa(n,t),r.Aa(e,t)})})},rf.prototype.ba=function(t,e){return this.Va(t,e)},rf.prototype.va=function(e,t){var n=this;return this.Sa(e,t.targetId).next(function(){return sf(e).delete(t.targetId)}).next(function(){return n.Ia(e)}).next(function(t){return Fr(0<t.targetCount),--t.targetCount,n.Aa(e,t)})},rf.prototype.Vo=function(r,i,o){var s=this,u=0,a=[];return sf(r).ss(function(t,e){var n=lh(e);n.sequenceNumber<=i&&null===o.get(n.targetId)&&(u++,a.push(s.va(r,n)))}).next(function(){return Ca.$n(a)}).next(function(){return u})},rf.prototype.De=function(t,r){return sf(t).ss(function(t,e){var n=lh(e);r(n)})},rf.prototype.Ia=function(t){return uf(t).get(Kh.key).next(function(t){return Fr(null!==t),t})},rf.prototype.Aa=function(t,e){return uf(t).put(Kh.key,e)},rf.prototype.Va=function(t,e){return sf(t).put(ph(this.serializer,e))},rf.prototype.pa=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},rf.prototype.Da=function(t){return this.Ia(t).next(function(t){return t.targetCount})},rf.prototype.Ca=function(t,i){var e=Ki(i),n=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),o=null;return sf(t).ss({range:n,index:Hh.queryTargetsIndexName},function(t,e,n){var r=lh(e);Wi(i,r.target)&&(o=r,n.done())}).next(function(){return o})},rf.prototype.Na=function(n,t,r){var i=this,o=[],s=af(n);return t.forEach(function(t){var e=eh(t.path);o.push(s.put(new Qh(r,e))),o.push(i.Co.Fa(n,r,t))}),Ca.$n(o)},rf.prototype.$a=function(n,t,r){var i=this,o=af(n);return Ca.forEach(t,function(t){var e=eh(t.path);return Ca.$n([o.delete([r,e]),i.Co.xa(n,r,t)])})},rf.prototype.Sa=function(t,e){var n=af(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},rf.prototype.ka=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=af(t),o=wo();return r.ss({range:n,ns:!0},function(t,e,n){var r=rh(t[1]),i=new Yr(r);o=o.add(i)}).next(function(){return o})},rf.prototype.zo=function(t,e){var n=eh(e.path),r=IDBKeyRange.bound([n],[Ti(n)],!1,!0),i=0;return af(t).ss({index:Qh.documentTargetsIndex,ns:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},rf.prototype.qe=function(t,e){return sf(t).get(e).next(function(t){return t?lh(t):null})},rf);function rf(t,e){this.Co=t,this.serializer=e}function of(t){this.wa=t}function sf(t){return lf.Un(t,Hh.store)}function uf(t){return lf.Un(t,Kh.store)}function af(t){return lf.Un(t,Qh.store)}var cf,hf="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",ff=(o(df,cf=xc),df),lf=(pf.Un=function(t,e){if(t instanceof ff)return Pa.Un(t.Wo,e);throw Mr()},pf.prototype.start=function(){var e=this;return this.Ja().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Or(xr.FAILED_PRECONDITION,hf);return e.Xa(),e.Za(),e.tc(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.Ha.Pa(t)})}).then(function(t){e.Ba=new pc(t,e.Oa)}).then(function(){e.qa=!0}).catch(function(t){return e.za&&e.za.close(),Promise.reject(t)})},pf.prototype.ec=function(n){var t=this;return this.Ka=function(e){return m(t,void 0,void 0,function(){return w(this,function(t){return this.Ti?[2,n(e)]:[2]})})},n(this.isPrimary)},pf.prototype.nc=function(n){var t=this;this.za.jn(function(e){return m(t,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},pf.prototype.sc=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this._n.ds(function(){return m(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Ti?[4,this.Ja()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},pf.prototype.Ja=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return yf(e).put(new Xh(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.ic(e).next(function(t){t||(n.isPrimary=!1,n._n.Ds(function(){return n.Ka(!1)}))})}).next(function(){return n.rc(e)}).next(function(t){return n.isPrimary&&!t?n.oc(e).next(function(){return!1}):!!t&&n.ac(e).next(function(){return!0})})}).catch(function(t){if(Ba(t))return Cr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Cr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n._n.Ds(function(){return n.Ka(t)}),n.isPrimary=t})},pf.prototype.ic=function(t){var e=this;return vf(t).get(Lh.key).next(function(t){return Ca.resolve(e.cc(t))})},pf.prototype.uc=function(t){return yf(t).delete(this.clientId)},pf.prototype.hc=function(){return m(this,void 0,void 0,function(){var e,n,r,i,o=this;return w(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.lc(this.ja,18e5)?[3,2]:(this.ja=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=pf.Un(t,Xh.store);return r.Zn().next(function(t){var e=o._c(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return Ca.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.Ya)for(n=0,r=e;n<r.length;n++)i=r[n],this.Ya.removeItem(this.fc(i.clientId));t.label=2;case 2:return[2]}})})},pf.prototype.tc=function(){var t=this;this.Wa=this._n.gn("client_metadata_refresh",4e3,function(){return t.Ja().then(function(){return t.hc()}).then(function(){return t.tc()})})},pf.prototype.cc=function(t){return!!t&&t.ownerId===this.clientId},pf.prototype.rc=function(e){var i=this;return this.La?Ca.resolve(!0):vf(e).get(Lh.key).next(function(t){if(null!==t&&i.lc(t.leaseTimestampMs,5e3)&&!i.dc(t.ownerId)){if(i.cc(t)&&i.networkEnabled)return!0;if(!i.cc(t)){if(!t.allowTabSynchronization)throw new Or(xr.FAILED_PRECONDITION,hf);return!1}}return!(!i.networkEnabled||!i.inForeground)||yf(e).Zn().next(function(t){return void 0===i._c(t,5e3).find(function(t){if(i.clientId!==t.clientId){var e=!i.networkEnabled&&t.networkEnabled,n=!i.inForeground&&t.inForeground,r=i.networkEnabled===t.networkEnabled;if(e||n&&r)return!0}return!1})})}).next(function(t){return i.isPrimary!==t&&Cr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},pf.prototype.Si=function(){return m(this,void 0,void 0,function(){var n=this;return w(this,function(t){switch(t.label){case 0:return this.qa=!1,this.wc(),this.Wa&&(this.Wa.cancel(),this.Wa=null),this.mc(),this.Tc(),[4,this.za.runTransaction("readwrite",[Lh.store,Xh.store],function(t){var e=new ff(t,pc.oi);return n.oc(e).next(function(){return n.uc(e)})})];case 1:return t.sent(),this.za.close(),this.Ec(),[2]}})})},pf.prototype._c=function(t,e){var n=this;return t.filter(function(t){return n.lc(t.updateTimeMs,e)&&!n.dc(t.clientId)})},pf.prototype.Vi=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return yf(t).Zn().next(function(t){return e._c(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(pf.prototype,"Ti",{get:function(){return this.qa},enumerable:!1,configurable:!0}),pf.prototype.Ic=function(t){return dh.Fo(t,this.serializer,this.Sr,this.Co)},pf.prototype.Ac=function(){return this.Ha},pf.prototype.Rc=function(){return this.br},pf.prototype.Pc=function(){return this.Sr},pf.prototype.runTransaction=function(e,n,r){var i=this;Cr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.za.runTransaction(t,$h,function(t){return o=new ff(t,i.Ba?i.Ba.next():pc.oi),"readwrite-primary"===n?i.ic(o).next(function(t){return!!t||i.rc(o)}).next(function(t){if(!t)throw Pr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i._n.Ds(function(){return i.Ka(!1)}),new Or(xr.FAILED_PRECONDITION,Dc);return r(o)}).next(function(t){return i.ac(o).next(function(){return t})}):i.gc(o).next(function(){return r(o)})}).then(function(t){return o.pr(),t})},pf.prototype.gc=function(t){var e=this;return vf(t).get(Lh.key).next(function(t){if(null!==t&&e.lc(t.leaseTimestampMs,5e3)&&!e.dc(t.ownerId)&&!e.cc(t)&&!(e.La||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Or(xr.FAILED_PRECONDITION,hf)})},pf.prototype.ac=function(t){var e=new Lh(this.clientId,this.allowTabSynchronization,Date.now());return vf(t).put(Lh.key,e)},pf.On=function(){return Pa.On()},pf.prototype.oc=function(t){var e=this,n=vf(t);return n.get(Lh.key).next(function(t){return e.cc(t)?(Cr("IndexedDbPersistence","Releasing primary lease."),n.delete(Lh.key)):Ca.resolve()})},pf.prototype.lc=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Pr("Detected an update time that is in the future: "+t+" > "+n),1))},pf.prototype.Xa=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Qa=function(){t._n.ds(function(){return t.inForeground="visible"===t.document.visibilityState,t.Ja()})},this.document.addEventListener("visibilitychange",this.Qa),this.inForeground="visible"===this.document.visibilityState)},pf.prototype.mc=function(){this.Qa&&(this.document.removeEventListener("visibilitychange",this.Qa),this.Qa=null)},pf.prototype.Za=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Ua=function(){e.wc(),e._n.ds(function(){return e.Si()})},this.window.addEventListener("unload",this.Ua))},pf.prototype.Tc=function(){this.Ua&&(this.window.removeEventListener("unload",this.Ua),this.Ua=null)},pf.prototype.dc=function(t){var e;try{var n=null!==(null===(e=this.Ya)||void 0===e?void 0:e.getItem(this.fc(t)));return Cr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Pr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},pf.prototype.wc=function(){if(this.Ya)try{this.Ya.setItem(this.fc(this.clientId),String(Date.now()))}catch(t){Pr("Failed to set zombie client id.",t)}},pf.prototype.Ec=function(){if(this.Ya)try{this.Ya.removeItem(this.fc(this.clientId))}catch(t){}},pf.prototype.fc=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},pf);function pf(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this._n=i,this.window=o,this.document=s,this.Oa=a,this.La=c,this.Ba=null,this.qa=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ua=null,this.inForeground=!1,this.Qa=null,this.Wa=null,this.ja=Number.NEGATIVE_INFINITY,this.Ka=function(t){return Promise.resolve()},!pf.On())throw new Or(xr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Co=new gf(this,r),this.Ga=e+"main",this.serializer=new ih(u),this.za=new Pa(this.Ga,10,new Rh(this.serializer)),this.Ha=new nf(this.Co,this.serializer),this.Sr=new Jh,this.br=new Eh(this.serializer,this.Sr),this.window&&this.window.localStorage?this.Ya=this.window.localStorage:(this.Ya=null,!1===c&&Pr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function df(t,e){var n=this;return(n=cf.call(this)||this).Wo=t,n.Ma=e,n}function vf(t){return lf.Un(t,Lh.store)}function yf(t){return lf.Un(t,Xh.store)}var gf=(mf.prototype.Ro=function(t){var n=this.yc(t);return this.db.Ac().Da(t).next(function(e){return n.next(function(t){return e+t})})},mf.prototype.yc=function(t){var e=0;return this.yo(t,function(t){e++}).next(function(){return e})},mf.prototype.De=function(t,e){return this.db.Ac().De(t,e)},mf.prototype.yo=function(t,n){return this.Vc(t,function(t,e){return n(e)})},mf.prototype.Fa=function(t,e,n){return wf(t,n)},mf.prototype.xa=function(t,e,n){return wf(t,n)},mf.prototype.Vo=function(t,e,n){return this.db.Ac().Vo(t,e,n)},mf.prototype.Ko=wf,mf.prototype.bc=function(t,e){return r=e,i=!1,bh(n=t).rs(function(t){return yh(n,t,r).next(function(t){return t&&(i=!0),Ca.resolve(!t)})}).next(function(){return i});var n,r,i},mf.prototype.po=function(r,i){var o=this,s=this.db.Rc().aa(),u=[],a=0;return this.Vc(r,function(e,t){var n;t<=i&&(n=o.bc(r,e).next(function(t){if(!t)return a++,s.Ar(r,e).next(function(){return s.Ir(e),af(r).delete([0,eh(e.path)])})}),u.push(n))}).next(function(){return Ca.$n(u)}).next(function(){return s.apply(r)}).next(function(){return a})},mf.prototype.removeTarget=function(t,e){var n=e.nt(t.Ma);return this.db.Ac().ba(t,n)},mf.prototype.vc=wf,mf.prototype.Vc=function(t,o){var s,e=af(t),u=pc.oi;return e.ss({index:Qh.documentTargetsIndex},function(t,e){var n=t[0],r=(t[1],e.path),i=e.sequenceNumber;0===n?(u!==pc.oi&&o(new Yr(rh(s)),u),u=i,s=r):u=pc.oi}).next(function(){u!==pc.oi&&o(new Yr(rh(s)),u)})},mf.prototype.vo=function(t){return this.db.Rc().ha(t)},mf);function mf(t,e){this.db=t,this.do=new Jc(this,e)}function wf(t,e){return af(t).put((n=t.Ma,new Qh(0,eh(e.path),n)));var n}function bf(t,e){var n=t.projectId;return t.W||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var If=(Ef.prototype.Eo=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.bo(t,n.Dc)})},Ef);function Ef(t,e,n){this.persistence=t,this.Sc=e,this.Dc=new ro(Ii),this.Cc=new Ci(Ki,Wi),this.Nc=Ui.min(),this.vr=t.Ic(n),this.Fc=t.Rc(),this.Ha=t.Ac(),this.$c=new Oc(this.Fc,this.vr,this.persistence.Pc()),this.Sc.xc(this.$c)}function Tf(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Ha.Ra(t)})}function _f(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Ha.Ca(e,r).next(function(t){return t?(n=t,Ca.resolve(n)):i.Ha.Ea(e).next(function(t){return n=new Zi(r,t,0,e.Ma),i.Ha.ya(e,n).next(function(){return n})})})}).then(function(t){var e=i.Dc.get(t.targetId);return(null===e||0<t.et.L(e.et))&&(i.Dc=i.Dc.rt(t.targetId,t),i.Cc.set(r,t.targetId)),t})}function Af(o,s,u){return m(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:n=(e=o).Dc.get(s),r=u?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),u?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Co.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Ba(i=t.sent()))throw i;return Cr("LocalStore","Failed to update sequence numbers for target "+s+": "+i),[3,5];case 5:return e.Dc=e.Dc.remove(s),e.Cc.delete(n.target),[2]}})})}function Nf(t,s,u){var a=t,c=Ui.min(),h=wo();return a.persistence.runTransaction("Execute query","readonly",function(e){return t=a,n=e,r=Qu(s),(void 0!==(o=(i=t).Cc.get(r))?Ca.resolve(i.Dc.get(o)):i.Ha.Ca(n,r)).next(function(t){if(t)return c=t.lastLimboFreeSnapshotVersion,a.Ha.ka(e,t.targetId).next(function(t){h=t})}).next(function(){return a.Sc.Or(e,s,u?c:Ui.min(),u?h:wo())}).next(function(t){return{documents:t,kc:h}});var t,n,r,i,o})}function Sf(t,e){var n=t,r=n.Ha,i=n.Dc.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.qe(t,e).next(function(t){return t?t.target:null})})}function Df(e){return m(this,void 0,void 0,function(){return w(this,function(t){if(e.code!==xr.FAILED_PRECONDITION||e.message!==Dc)throw e;return Cr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function xf(t,e){this.user=e,this.type="OAuth",this.zc={},this.zc.Authorization="Bearer "+t}function Of(t,e,n,r,i){var o=this;this.Gu=t,this.zu=e,this.os=n,this.Hu={},this.Yu=[],this.Ju=new Map,this.Xu=new Set,this.Zu=[],this.th=i,this.th.eh(function(t){n.ds(function(){return m(o,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return fl(this)?(Cr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return m(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return(e=n).Xu.add(4),[4,rl(e)];case 1:return t.sent(),e.nh.set("Unknown"),e.Xu.delete(4),[4,nl(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.nh=new zf(n,r)}var Rf,kf,Lf,Cf=(el.prototype.m=function(){return this.Mc.m()},el.prototype.Fa=function(t,e){var n=new Pf(t,e);this.Mc=this.Mc.add(n),this.Lc=this.Lc.add(n)},el.prototype.qc=function(t,e){var n=this;t.forEach(function(t){return n.Fa(t,e)})},el.prototype.xa=function(t,e){this.Uc(new Pf(t,e))},el.prototype.Qc=function(t,e){var n=this;t.forEach(function(t){return n.xa(t,e)})},el.prototype.Wc=function(t){var e=this,n=new Yr(new Qr([])),r=new Pf(n,t),i=new Pf(n,t+1),o=[];return this.Lc.Nt([r,i],function(t){e.Uc(t),o.push(t.key)}),o},el.prototype.jc=function(){var e=this;this.Mc.forEach(function(t){return e.Uc(t)})},el.prototype.Uc=function(t){this.Mc=this.Mc.delete(t),this.Lc=this.Lc.delete(t)},el.prototype.Kc=function(t){var e=new Yr(new Qr([])),n=new Pf(e,t),r=new Pf(e,t+1),i=wo();return this.Lc.Nt([n,r],function(t){i=i.add(t.key)}),i},el.prototype.zo=function(t){var e=new Pf(t,0),n=this.Mc.$t(e);return null!==n&&t.isEqual(n.key)},el),Pf=(tl.Oc=function(t,e){return Yr.i(t.key,e.key)||Ii(t.Gc,e.Gc)},tl.Bc=function(t,e){return Ii(t.Gc,e.Gc)||Yr.i(t.key,e.key)},tl),Uf=(Zf.prototype.getToken=function(){return Promise.resolve(null)},Zf.prototype.Yc=function(){},Zf.prototype.Jc=function(t){(this.Hc=t)(hc.UNAUTHENTICATED)},Zf.prototype.Xc=function(){this.Hc=null},Zf),Vf=(Jf.prototype.getToken=function(){var e=this,n=this.eu,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.eu!==n?(Cr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Fr("string"==typeof t.accessToken),new xf(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Jf.prototype.Yc=function(){this.forceRefresh=!0},Jf.prototype.Jc=function(t){this.Hc=t,this.tu&&t(this.currentUser)},Jf.prototype.Xc=function(){this.auth&&this.auth.removeAuthTokenListener(this.Zc),this.Zc=null,this.Hc=null},Jf.prototype.nu=function(){var t=this.auth&&this.auth.getUid();return Fr(null===t||"string"==typeof t),new hc(t)},Jf),Mf=(Object.defineProperty($f.prototype,"zc",{get:function(){var t={"X-Goog-AuthUser":this.iu},e=this.su.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),$f),Ff=(Xf.prototype.getToken=function(){return Promise.resolve(new Mf(this.su,this.iu))},Xf.prototype.Jc=function(t){t(hc.ei)},Xf.prototype.Xc=function(){},Xf.prototype.Yc=function(){},Xf),qf=(Yf.prototype.hu=function(){return 1===this.state||2===this.state||4===this.state},Yf.prototype.lu=function(){return 2===this.state},Yf.prototype.start=function(){3!==this.state?this.auth():this._u()},Yf.prototype.stop=function(){return m(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.hu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Yf.prototype.fu=function(){this.state=0,this.gs.reset()},Yf.prototype.du=function(){var t=this;this.lu()&&null===this.uu&&(this.uu=this._n.gn(this.ru,6e4,function(){return t.wu()}))},Yf.prototype.mu=function(t){this.Tu(),this.stream.send(t)},Yf.prototype.wu=function(){return m(this,void 0,void 0,function(){return w(this,function(t){return this.lu()?[2,this.close(0)]:[2]})})},Yf.prototype.Tu=function(){this.uu&&(this.uu.cancel(),this.uu=null)},Yf.prototype.close=function(e,n){return m(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Tu(),this.gs.cancel(),this.cu++,3!==e?this.gs.reset():n&&n.code===xr.RESOURCE_EXHAUSTED?(Pr(n.toString()),Pr("Using maximum backoff delay to prevent overloading the backend."),this.gs.An()):n&&n.code===xr.UNAUTHENTICATED&&this.au.Yc(),null!==this.stream&&(this.Eu(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Iu(n)];case 1:return t.sent(),[2]}})})},Yf.prototype.Eu=function(){},Yf.prototype.auth=function(){var n=this;this.state=1;var t=this.Au(this.cu),e=this.cu;this.au.getToken().then(function(t){n.cu===e&&n.Ru(t)},function(e){t(function(){var t=new Or(xr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Pu(t)})})},Yf.prototype.Ru=function(t){var e=this,n=this.Au(this.cu);this.stream=this.gu(t),this.stream.yu(function(){n(function(){return e.state=2,e.listener.yu()})}),this.stream.Iu(function(t){n(function(){return e.Pu(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Yf.prototype._u=function(){var t=this;this.state=4,this.gs.Rn(function(){return m(t,void 0,void 0,function(){return w(this,function(t){return this.state=0,this.start(),[2]})})})},Yf.prototype.Pu=function(t){return Cr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Yf.prototype.Au=function(e){var n=this;return function(t){n._n.ds(function(){return n.cu===e?t():(Cr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Yf),jf=(o(Wf,Lf=qf),Wf.prototype.gu=function(t){return this.ou.Vu("Listen",t)},Wf.prototype.onMessage=function(t){this.gs.reset();var e=function(t,e){var n,r,i,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Mr(),u=e.targetChange.targetIds||[],a=(i=e.targetChange.resumeToken,t.Ue?(Fr(void 0===i||"string"==typeof i),_i.fromBase64String(i||"")):(Fr(void 0===i||i instanceof Uint8Array),_i.fromUint8Array(i||new Uint8Array))),c=e.targetChange.cause,h=c&&(r=void 0===(n=c).code?xr.UNKNOWN:no(n.code),new Or(r,n.message||"")),f=new Do(s,u,a,h||null)}else if("documentChange"in e){e.documentChange;var l=e.documentChange;l.document,l.document.name,l.document.updateTime;var p=ys(t,l.document.name),d=ls(l.document.updateTime),v=new Iu({mapValue:{fields:l.document.fields}}),y=new Ru(p,d,v,{}),g=l.targetIds||[],m=l.removedTargetIds||[],f=new No(g,m,y.key,y)}else if("documentDelete"in e){e.documentDelete;var w=e.documentDelete;w.document;var b=ys(t,w.document),I=w.readTime?ls(w.readTime):Ui.min(),E=new ku(b,I),T=w.removedTargetIds||[];f=new No([],T,E.key,E)}else if("documentRemove"in e){e.documentRemove;var _=e.documentRemove;_.document;var A=ys(t,_.document),N=_.removedTargetIds||[];f=new No([],N,A,null)}else{if(!("filter"in e))return Mr();e.filter;var S=e.filter;S.targetId;var D=new Xi(S.count||0),x=S.targetId;f=new So(x,D)}return f}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Ui.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Ui.min():ls(e.readTime)}(t);return this.listener.pu(e,n)},Wf.prototype.bu=function(t){var e,n,r,i,o={};o.database=ws(this.serializer),o.addTarget=(e=this.serializer,(r=Yi(i=(n=t).target)?{documents:_s(e,i)}:{query:As(e,i)}).targetId=n.targetId,0<n.resumeToken.O()&&(r.resumeToken=fs(e,n.resumeToken)),r);var s,u,a=(this.serializer,s=t,null==(u=function(){switch(s.tt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Mr()}}())?null:{"goog-listen-tags":u});a&&(o.labels=a),this.mu(o)},Wf.prototype.vu=function(t){var e={};e.database=ws(this.serializer),e.removeTarget=t,this.mu(e)},Wf),Gf=(o(Kf,kf=qf),Object.defineProperty(Kf.prototype,"Du",{get:function(){return this.Su},enumerable:!1,configurable:!0}),Kf.prototype.start=function(){this.Su=!1,this.lastStreamToken=void 0,kf.prototype.start.call(this)},Kf.prototype.Eu=function(){this.Su&&this.Cu([])},Kf.prototype.gu=function(t){return this.ou.Vu("Write",t)},Kf.prototype.onMessage=function(t){if(Fr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Su){this.gs.reset();var e=(r=t.writeResults,i=t.commitTime,r&&0<r.length?(Fr(void 0!==i),r.map(function(t){return function(t,e){var n=t.updateTime?ls(t.updateTime):ls(e);n.isEqual(Ui.min())&&(n=ls(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new Js(n,r)}(t,i)})):[]),n=ls(t.commitTime);return this.listener.Nu(n,e)}var r,i;return Fr(!t.writeResults||0===t.writeResults.length),this.Su=!0,this.listener.Fu()},Kf.prototype.$u=function(){var t={};t.database=ws(this.serializer),this.mu(t)},Kf.prototype.Cu=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Es(e.serializer,t)})};this.mu(n)},Kf),Bf=(o(Qf,Rf=function(){}),Qf.prototype.ku=function(){if(this.xu)throw new Or(xr.FAILED_PRECONDITION,"The client has already been terminated.")},Qf.prototype.Mu=function(e,n,r){var i=this;return this.ku(),this.credentials.getToken().then(function(t){return i.ou.Mu(e,n,r,t)}).catch(function(t){throw t.code===xr.UNAUTHENTICATED&&i.credentials.Yc(),t})},Qf.prototype.Ou=function(e,n,r){var i=this;return this.ku(),this.credentials.getToken().then(function(t){return i.ou.Ou(e,n,r,t)}).catch(function(t){throw t.code===xr.UNAUTHENTICATED&&i.credentials.Yc(),t})},Qf.prototype.terminate=function(){this.xu=!1},Qf),zf=(Hf.prototype.Uu=function(){var t=this;0===this.Lu&&(this.Qu("Unknown"),this.Bu=this.os.gn("online_state_timeout",1e4,function(){return t.Bu=null,t.Wu("Backend didn't respond within 10 seconds."),t.Qu("Offline"),Promise.resolve()}))},Hf.prototype.ju=function(t){"Online"===this.state?this.Qu("Unknown"):(this.Lu++,1<=this.Lu&&(this.Ku(),this.Wu("Connection failed 1 times. Most recent error: "+t.toString()),this.Qu("Offline")))},Hf.prototype.set=function(t){this.Ku(),this.Lu=0,"Online"===t&&(this.qu=!1),this.Qu(t)},Hf.prototype.Qu=function(t){t!==this.state&&(this.state=t,this.fi(t))},Hf.prototype.Wu=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.qu?(Pr(e),this.qu=!1):Cr("OnlineStateTracker",e)},Hf.prototype.Ku=function(){null!==this.Bu&&(this.Bu.cancel(),this.Bu=null)},Hf);function Hf(t,e){this.os=t,this.fi=e,this.state="Unknown",this.Lu=0,this.Bu=null,this.qu=!0}function Qf(t,e,n){var r=this;return(r=Rf.call(this)||this).credentials=t,r.ou=e,r.serializer=n,r.xu=!1,r}function Kf(t,e,n,r,i){var o=this;return(o=kf.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Su=!1,o}function Wf(t,e,n,r,i){var o=this;return(o=Lf.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Yf(t,e,n,r,i,o){this._n=t,this.ru=n,this.ou=r,this.au=i,this.listener=o,this.state=0,this.cu=0,this.uu=null,this.stream=null,this.gs=new La(t,e)}function Xf(t,e){this.su=t,this.iu=e}function $f(t,e){this.su=t,this.iu=e,this.type="FirstParty",this.user=hc.ei}function Jf(t){var e=this;this.Zc=null,this.currentUser=hc.UNAUTHENTICATED,this.tu=!1,this.eu=0,this.Hc=null,this.forceRefresh=!1,this.Zc=function(){e.eu++,e.currentUser=e.nu(),e.tu=!0,e.Hc&&e.Hc(e.currentUser)},this.eu=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Zc):(this.Zc(null),t.get().then(function(t){e.auth=t,e.Zc&&e.auth.addAuthTokenListener(e.Zc)},function(){}))}function Zf(){this.Hc=null}function tl(t,e){this.key=t,this.Gc=e}function el(){this.Mc=new ho(Pf.Oc),this.Lc=new ho(Pf.Bc)}function nl(r){return m(this,void 0,void 0,function(){var e,n;return w(this,function(t){switch(t.label){case 0:if(!fl(r))return[3,4];e=0,n=r.Zu,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function rl(r){return m(this,void 0,void 0,function(){var e,n;return w(this,function(t){switch(t.label){case 0:e=0,n=r.Zu,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function il(n){return m(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return e=n,Cr("RemoteStore","RemoteStore shutting down."),e.Xu.add(5),[4,rl(e)];case 1:return t.sent(),e.th.Si(),e.nh.set("Unknown"),[2]}})})}function ol(t,e){var n=t;n.Ju.has(e.targetId)||(n.Ju.set(e.targetId,e),hl(n)?cl(n):wl(n).lu()&&ul(n,e))}function sl(t,e){var n=t,r=wl(n);n.Ju.delete(e),r.lu()&&al(n,e),0===n.Ju.size&&(r.lu()?r.du():fl(n)&&n.nh.set("Unknown"))}function ul(t,e){t.sh.Ee(e.targetId),wl(t).bu(e)}function al(t,e){t.sh.Ee(e),wl(t).vu(e)}function cl(e){e.sh=new Oo({Be:function(t){return e.Hu.Be(t)},qe:function(t){return e.Ju.get(t)||null}}),wl(e).start(),e.nh.Uu()}function hl(t){return fl(t)&&!wl(t).hu()&&0<t.Ju.size}function fl(t){return 0===t.Xu.size}function ll(t){t.sh=void 0}function pl(n,r,i){return m(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:if(!Ba(r))throw r;return n.Xu.add(1),[4,rl(n)];case 1:return t.sent(),n.nh.set("Offline"),i=i||function(){return Tf(n.Gu)},n.os.Ds(function(){return m(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return Cr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Xu.delete(1),[4,nl(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function dl(e,n){return n().catch(function(t){return pl(e,t,n)})}function vl(c){return m(this,void 0,void 0,function(){var i,o,s,u,a;return w(this,function(t){switch(t.label){case 0:o=bl(i=c),s=0<i.Yu.length?i.Yu[i.Yu.length-1].batchId:-1,t.label=1;case 1:if(!(fl(i)&&i.Yu.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.Gu,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.vr.Lo(t,n)}))];case 3:return null===(u=t.sent())?(0===i.Yu.length&&o.du(),[3,7]):(s=u.batchId,function(t,e){t.Yu.push(e);var n=bl(t);n.lu()&&n.Du&&n.Cu(e.mutations)}(i,u),[3,6]);case 4:return a=t.sent(),[4,pl(i,a)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return yl(i)&&gl(i),[2]}var e,n,r})})}function yl(t){return fl(t)&&!bl(t).hu()&&0<t.Yu.length}function gl(t){bl(t).start()}function ml(n,r){return m(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return e=n,r?(e.Xu.delete(2),[4,nl(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Xu.add(2),[4,rl(e)]);case 3:t.sent(),e.nh.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function wl(n){var t,e,r,i,o=this;return n.uh||(n.uh=(t=n.zu,e=n.os,r={yu:function(n){return m(this,void 0,void 0,function(){return w(this,function(t){return n.Ju.forEach(function(t,e){ul(n,t)}),[2]})})}.bind(null,n),Iu:function(e,n){return m(this,void 0,void 0,function(){return w(this,function(t){return ll(e),hl(e)?(e.nh.ju(n),cl(e)):e.nh.set("Unknown"),[2]})})}.bind(null,n),pu:function(u,a,c){return m(this,void 0,void 0,function(){var n,o,s;return w(this,function(t){switch(t.label){case 0:if(u.nh.set("Online"),!(a instanceof Do&&2===a.state&&a.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return m(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Ju.has(i)?[4,o.Hu.ih(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Ju.delete(i),o.sh.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(u,a)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Cr("RemoteStore","Failed to remove targets %s: %s ",a.targetIds.join(","),n),[4,pl(u,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(a instanceof No?u.sh.pe(a):a instanceof So?u.sh.$e(a):u.sh.Se(a),c.isEqual(Ui.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Tf(u.Gu)];case 8:return o=t.sent(),0<=c.L(o)?[4,(i=c,(e=(r=u).sh.Me(i)).Gt.forEach(function(t,e){var n;0<t.resumeToken.O()&&(n=r.Ju.get(e))&&r.Ju.set(e,n.st(t.resumeToken,i))}),e.zt.forEach(function(t){var e,n=r.Ju.get(t);n&&(r.Ju.set(t,n.st(_i.B,n.et)),al(r,t),e=new Zi(n.target,t,1,n.sequenceNumber),ul(r,e))}),r.Hu.rh(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Cr("RemoteStore","Failed to raise snapshot:",s=t.sent()),[4,pl(u,s)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},(i=t).ku(),new jf(e,i.ou,i.credentials,i.serializer,r)),n.Zu.push(function(e){return m(o,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e?(n.uh.fu(),hl(n)?cl(n):n.nh.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.uh.stop()];case 2:t.sent(),ll(n),t.label=3;case 3:return[2]}})})})),n.uh}function bl(n){var t,e,r,i,o=this;return n.hh||(n.hh=(t=n.zu,e=n.os,r={yu:function(e){return m(this,void 0,void 0,function(){return w(this,function(t){return bl(e).$u(),[2]})})}.bind(null,n),Iu:function(e,n){return m(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return n&&bl(e).Du?[4,function(r,i){return m(this,void 0,void 0,function(){var e,n;return w(this,function(t){switch(t.label){case 0:return eo(n=i.code)&&n!==xr.ABORTED?(e=r.Yu.shift(),bl(r).fu(),[4,dl(r,function(){return r.Hu.ah(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,vl(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return yl(e)&&gl(e),[2]}})})}.bind(null,n),Fu:function(o){return m(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){for(e=bl(o),n=0,r=o.Yu;n<r.length;n++)i=r[n],e.Cu(i.mutations);return[2]})})}.bind(null,n),Nu:function(r,i,o){return m(this,void 0,void 0,function(){var e,n;return w(this,function(t){switch(t.label){case 0:return e=r.Yu.shift(),n=Nc.from(e,i,o),[4,dl(r,function(){return r.Hu.oh(n)})];case 1:return t.sent(),[4,vl(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},(i=t).ku(),new Gf(e,i.ou,i.credentials,i.serializer,r)),n.Zu.push(function(e){return m(o,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e?(n.hh.fu(),[4,vl(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.hh.stop()];case 3:t.sent(),0<n.Yu.length&&(Cr("RemoteStore","Stopping write stream with "+n.Yu.length+" pending writes"),n.Yu=[]),t.label=4;case 4:return[2]}})})})),n.hh}var Il=function(t){this.key=t},El=function(t){this.key=t},Tl=(Object.defineProperty(Dl.prototype,"mh",{get:function(){return this.lh},enumerable:!1,configurable:!0}),Dl.prototype.Th=function(t,e){var u=this,a=e?e.Eh:new Eo,c=e?e.wh:this.wh,h=e?e.Qt:this.Qt,f=c,l=!1,p=qu(this.query)&&c.size===this.query.limit?c.last():null,d=ju(this.query)&&c.size===this.query.limit?c.first():null;if(t.ut(function(t,e){var n=c.get(t),r=(r=e instanceof Ru?e:null)&&(Zu(u.query,r)?r:null),i=!!n&&u.Qt.has(n.key),o=!!r&&(r.Ye||u.Qt.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(a.track({type:3,doc:r}),s=!0):u.Ih(n,r)||(a.track({type:2,doc:r}),s=!0,(p&&0<u.dh(r,p)||d&&u.dh(r,d)<0)&&(l=!0)):!n&&r?(a.track({type:0,doc:r}),s=!0):n&&!r&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(l=!0)),s&&(h=r?(f=f.add(r),o?h.add(t):h.delete(t)):(f=f.delete(t),h.delete(t)))}),qu(this.query)||ju(this.query))for(;f.size>this.query.limit;){var n=qu(this.query)?f.last():f.first(),f=f.delete(n.key),h=h.delete(n.key);a.track({type:1,doc:n})}return{wh:f,Eh:a,Ah:l,Qt:h}},Dl.prototype.Ih=function(t,e){return t.Ye&&e.hasCommittedMutations&&!e.Ye},Dl.prototype.gr=function(t,e,n){var o=this,r=this.wh;this.wh=t.wh,this.Qt=t.Qt;var i=t.Eh.qt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.dh(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Mr()}}var r,i}),this.Rh(n);var s=e?this.Ph():[],u=0===this.fh.size&&this.Zt?1:0,a=u!==this._h;return this._h=u,0!==i.length||a?{snapshot:new To(this.query,t.wh,r,i,t.Qt,0==u,a,!1),gh:s}:{gh:s}},Dl.prototype.Us=function(t){return this.Zt&&"Offline"===t?(this.Zt=!1,this.gr({wh:this.wh,Eh:new Eo,Qt:this.Qt,Ah:!1},!1)):{gh:[]}},Dl.prototype.yh=function(t){return!this.lh.has(t)&&!!this.wh.has(t)&&!this.wh.get(t).Ye},Dl.prototype.Rh=function(t){var e=this;t&&(t.te.forEach(function(t){return e.lh=e.lh.add(t)}),t.ee.forEach(function(t){}),t.ne.forEach(function(t){return e.lh=e.lh.delete(t)}),this.Zt=t.Zt)},Dl.prototype.Ph=function(){var e=this;if(!this.Zt)return[];var n=this.fh;this.fh=wo(),this.wh.forEach(function(t){e.yh(t.key)&&(e.fh=e.fh.add(t.key))});var r=[];return n.forEach(function(t){e.fh.has(t)||r.push(new El(t))}),this.fh.forEach(function(t){n.has(t)||r.push(new Il(t))}),r},Dl.prototype.Vh=function(t){this.lh=t.kc,this.fh=wo();var e=this.Th(t.documents);return this.gr(e,!0)},Dl.prototype.ph=function(){return To.Kt(this.query,this.wh,this.Qt,0===this._h)},Dl),_l=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Al=function(t){this.key=t,this.bh=!1},Nl=(Object.defineProperty(Sl.prototype,"Wh",{get:function(){return!0===this.Qh},enumerable:!1,configurable:!0}),Sl);function Sl(t,e,n,r,i,o){this.Gu=t,this.Sh=e,this.Dh=n,this.Ch=r,this.currentUser=i,this.Nh=o,this.Fh={},this.$h=new Ci($u,Xu),this.xh=new Map,this.kh=[],this.Mh=new ro(Yr.i),this.Oh=new Map,this.Lh=new Cf,this.Bh={},this.qh=new Map,this.Uh=ef.Ta(),this.onlineState="Unknown",this.Qh=void 0}function Dl(t,e){this.query=t,this.lh=e,this._h=null,this.Zt=!1,this.fh=wo(),this.Qt=wo(),this.dh=ta(t),this.wh=new Io(this.dh)}function xl(u,a,c,h){return m(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return u.jh=function(t,e,n){return function(i,o,s,u){return m(this,void 0,void 0,function(){var n,e,r;return w(this,function(t){switch(t.label){case 0:return(n=o.view.Th(s)).Ah?[4,Nf(i.Gu,o.query,!1).then(function(t){var e=t.documents;return o.view.Th(e,n)})]:[3,2];case 1:n=t.sent(),t.label=2;case 2:return e=u&&u.Gt.get(o.targetId),r=o.view.gr(n,i.Wh,e),[2,(Ul(i,o.targetId,r.gh),r.snapshot)]}})})}(u,t,e,n)},[4,Nf(u.Gu,a,!0)];case 1:return e=t.sent(),n=new Tl(a,e.kc),r=n.Th(e.documents),i=Ao.Xt(c,h&&"Offline"!==u.onlineState),o=n.gr(r,u.Wh,i),Ul(u,c,o.gh),s=new _l(a,c,n),[2,(u.$h.set(a,s),u.xh.has(c)?u.xh.get(c).push(a):u.xh.set(c,[a]),o.snapshot)]}})})}function Ol(i,o){return m(this,void 0,void 0,function(){var r,n;return w(this,function(t){switch(t.label){case 0:r=i,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=r.Gu,h=e,f=(s=o).et,l=h.Dc,h.persistence.runTransaction("Apply remote event","readwrite-primary",function(a){var i=h.Fc.aa({ua:!0});l=h.Dc;var c=[];s.Gt.forEach(function(t,e){var n,r,i,o,s,u=l.get(e);u&&(c.push(h.Ha.$a(a,t.ne,e).next(function(){return h.Ha.Na(a,t.te,e)})),0<(n=t.resumeToken).O()&&(r=u.st(n,f).nt(a.Ma),l=l.rt(e,r),i=u,s=t,Fr(0<(o=r).resumeToken.O()),(0===i.resumeToken.O()||3e8<=o.et.J()-i.et.J()||0<s.te.size+s.ee.size+s.ne.size)&&c.push(h.Ha.ba(a,r))))});var t,o=lo,n=wo();return s.Ht.forEach(function(t,e){n=n.add(t)}),c.push(i.getEntries(a,n).next(function(r){s.Ht.forEach(function(t,e){var n=r.get(t);e instanceof ku&&e.version.isEqual(Ui.min())?(i.Ir(t,f),o=o.rt(t,e)):null==n||0<e.version.L(n.version)||0===e.version.L(n.version)&&n.hasPendingWrites?(i.Tr(e,f),o=o.rt(t,e)):Cr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),s.Yt.has(t)&&c.push(h.persistence.Co.vc(a,t))})})),f.isEqual(Ui.min())||(t=h.Ha.Ra(a).next(function(t){return h.Ha.ga(a,a.Ma,f)}),c.push(t)),Ca.$n(c).next(function(){return i.apply(a)}).next(function(){return h.$c.kr(a,o)})}).then(function(t){return h.Dc=l,t}))];case 2:return n=t.sent(),o.Gt.forEach(function(t,e){var n=r.Oh.get(e);n&&(Fr(t.te.size+t.ee.size+t.ne.size<=1),0<t.te.size?n.bh=!0:0<t.ee.size?Fr(n.bh):0<t.ne.size&&(Fr(n.bh),n.bh=!1))}),[4,Ml(r,n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Df(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,s,h,f,l})})}function Rl(t,r,e){var i,n=t;(n.Wh&&0===e||!n.Wh&&1===e)&&(i=[],n.$h.forEach(function(t,e){var n=e.view.Us(r);n.snapshot&&i.push(n.snapshot)}),function(t,i){var e=t;e.onlineState=i;var o=!1;e.Ls.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Us(i)&&(o=!0)}),o&&ac(e)}(n.Dh,r),i.length&&n.Fh.pu(i),n.onlineState=r,n.Wh&&n.Ch.ji(r))}function kl(t,e){(t.qh.get(e)||[]).forEach(function(t){t.resolve()}),t.qh.delete(e)}function Ll(t,e,n){var r,i=t,o=i.Bh[i.currentUser.Zs()];o&&((r=o.get(e))&&(n?r.reject(n):r.resolve(),o=o.remove(e)),i.Bh[i.currentUser.Zs()]=o)}function Cl(e,t,n){void 0===n&&(n=null),e.Ch.Li(t);for(var r=0,i=e.xh.get(t);r<i.length;r++){var o=i[r];e.$h.delete(o),n&&e.Fh.Kh(o,n)}e.xh.delete(t),e.Wh&&e.Lh.Wc(t).forEach(function(t){e.Lh.zo(t)||Pl(e,t)})}function Pl(t,e){var n=t.Mh.get(e);null!==n&&(sl(t.Sh,n),t.Mh=t.Mh.remove(e),t.Oh.delete(n),Vl(t))}function Ul(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof Il?(t.Lh.Fa(u.key,e),r=t,i=u.key,r.Mh.get(i)||(Cr("SyncEngine","New document in limbo: "+i),r.kh.push(i),Vl(r))):u instanceof El?(Cr("SyncEngine","Document no longer in limbo: "+u.key),t.Lh.xa(u.key,e),t.Lh.zo(u.key)||Pl(t,u.key)):Mr()}}function Vl(t){for(;0<t.kh.length&&t.Mh.size<t.Nh;){var e=t.kh.shift(),n=t.Uh.next();t.Oh.set(n,new Al(e)),t.Mh=t.Mh.rt(e,n),ol(t.Sh,new Zi(Qu(Fu(e.path)),n,2,pc.oi))}}function Ml(n,s,u){return m(this,void 0,void 0,function(){var r,i,o,e;return w(this,function(t){switch(t.label){case 0:return i=[],o=[],e=[],(r=n).$h.m()?[3,3]:(r.$h.forEach(function(t,n){e.push(r.jh(n,s,u).then(function(t){var e;t&&(r.Wh&&r.Ch.Ui(n.targetId,t.fromCache?"not-current":"current"),i.push(t),e=Rc.Gr(n.targetId,t),o.push(e))}))}),[4,Promise.all(e)]);case 1:return t.sent(),r.Fh.pu(i),[4,function(h,f){return m(this,void 0,void 0,function(){var r,e,n,i,o,s,u,a,c;return w(this,function(t){switch(t.label){case 0:r=h,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Ca.forEach(f,function(e){return Ca.forEach(e.jr,function(t){return r.persistence.Co.Fa(n,e.targetId,t)}).next(function(){return Ca.forEach(e.Kr,function(t){return r.persistence.Co.xa(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Ba(e=t.sent()))throw e;return Cr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=f;n<i.length;n++)o=i[n],s=o.targetId,o.fromCache||(u=r.Dc.get(s),a=u.et,c=u.it(a),r.Dc=r.Dc.rt(s,c));return[2]}})})}(r.Gu,o)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function Fl(v,y){return m(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l,p,d;return w(this,function(t){switch(t.label){case 0:e=v,n=[],r=[],i=0,o=y,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.xh.get(s))&&0!==a.length?[4,_f(e.Gu,Qu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],l=e.$h.get(f),[4,function(i,o){return m(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return[4,Nf((e=i).Gu,o.query,!0)];case 1:return n=t.sent(),r=o.view.Vh(n),[2,(e.Wh&&Ul(e,o.targetId,r.gh),r)]}})})}(e,l)]):[3,6];case 4:(p=t.sent()).snapshot&&r.push(p.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,Sf(e.Gu,s)];case 8:return d=t.sent(),[4,_f(e.Gu,d)];case 9:return u=t.sent(),[4,xl(e,ql(d),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.Fh.pu(r),n)]}})})}function ql(t){return Mu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function jl(t){var e=t;return e.Sh.Hu.rh=Ol.bind(null,e),e.Sh.Hu.Be=function(t,e){var n=t,r=n.Oh.get(e);if(r&&r.bh)return wo().add(r.key);var i=wo(),o=n.xh.get(e);if(!o)return i;for(var s=0,u=o;s<u.length;s++)var a=u[s],c=n.$h.get(a),i=i.xt(c.view.mh);return i}.bind(null,e),e.Sh.Hu.ih=function(u,a,c){return m(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return(e=u).Ch.Ui(a,"rejected",c),n=e.Oh.get(a),(r=n&&n.key)?(i=(i=new ro(Yr.i)).rt(r,new ku(r,Ui.min())),o=wo().add(r),s=new _o(Ui.min(),new Map,new ho(Ii),i,o),[4,Ol(e,s)]):[3,2];case 1:return t.sent(),e.Mh=e.Mh.remove(r),e.Oh.delete(a),Vl(e),[3,4];case 2:return[4,Af(e.Gu,a,!1).then(function(){return Cl(e,a,c)}).catch(Df)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.Fh.pu=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,a=n.Ls.get(u);if(a){for(var c=0,h=a.listeners;c<h.length;c++)h[c].Qs(s)&&(r=!0);a.Os=s}}r&&ac(n)}.bind(null,e.Dh),e.Fh.Kh=function(t,e,n){var r=t,i=r.Ls.get(e);if(i)for(var o=0,s=i.listeners;o<s.length;o++)s[o].onError(n);r.Ls.delete(e)}.bind(null,e.Dh),e}function Gl(t){var e=t;return e.Sh.Hu.oh=function(o,s){return m(this,void 0,void 0,function(){var n,r,i;return w(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Gu,h=s,(f=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var i,e=h.batch.keys(),n=f.Fc.aa({ua:!0}),r=f,o=t,s=n,u=(i=h).batch,a=u.keys(),c=Ca.resolve();return a.forEach(function(r){c=c.next(function(){return s.Ar(o,r)}).next(function(t){var e=t,n=i._r.get(r);Fr(null!==n),(!e||e.version.L(n)<0)&&(e=u.ar(r,e,i))&&s.Tr(e,i.lr)})}),c.next(function(){return r.vr.Qo(o,u)}).next(function(){return n.apply(t)}).next(function(){return f.vr.Go(t)}).next(function(){return f.$c.$r(t,e)})}))];case 2:return i=t.sent(),Ll(n,r,null),kl(n,r),n.Ch.xi(r,"acknowledged"),[4,Ml(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,Df(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,h,f})})}.bind(null,e),e.Sh.Hu.ah=function(s,u,a){return m(this,void 0,void 0,function(){var n,o;return w(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Gu,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.vr.Mo(e,r).next(function(t){return Fr(null!==t),n=t.keys(),i.vr.Qo(e,t)}).next(function(){return i.vr.Go(e)}).next(function(){return i.$c.$r(e,n)})}))];case 2:return o=t.sent(),Ll(n,u,a),kl(n,u),n.Ch.xi(u,"rejected",a),[4,Ml(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Df(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,e),e}var Bl,zl=(Yl.prototype.xc=function(t){this.Yh=t},Yl.prototype.Or=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.rn.length||1===r.rn.length&&r.rn[0].field.p())||i.isEqual(Ui.min())?this.Jh(e,r):this.Yh.$r(e,o).next(function(t){var n=s.Xh(r,t);return(qu(r)||ju(r))&&s.Ah(r.on,n,o,i)?s.Jh(e,r):(Lr()<=l.DEBUG&&Cr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ju(r)),s.Yh.Or(e,r,i).next(function(e){return n.forEach(function(t){e=e.rt(t.key,t)}),e}))})},Yl.prototype.Xh=function(n,t){var r=new ho(ta(n));return t.forEach(function(t,e){e instanceof Ru&&Zu(n,e)&&(r=r.add(e))}),r},Yl.prototype.Ah=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.L(r))},Yl.prototype.Jh=function(t,e){return Lr()<=l.DEBUG&&Cr("IndexFreeQueryEngine","Using full collection scan to execute query:",Ju(e)),this.Yh.Or(t,e,Ui.min())},Yl),Hl=(Wl.prototype.$o=function(t){return Ca.resolve(0===this.vr.length)},Wl.prototype.xo=function(t,e,n,r){var i=this.Zh;this.Zh++,0<this.vr.length&&this.vr[this.vr.length-1];var o=new Ac(i,e,n,r);this.vr.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.tl=this.tl.add(new Pf(a.key,i)),this.Sr.ko(t,a.key.path.h())}return Ca.resolve(o)},Wl.prototype.Mo=function(t,e){return Ca.resolve(this.el(e))},Wl.prototype.Lo=function(t,e){var n=e+1,r=this.nl(n),i=r<0?0:r;return Ca.resolve(this.vr.length>i?this.vr[i]:null)},Wl.prototype.Bo=function(){return Ca.resolve(0===this.vr.length?-1:this.Zh-1)},Wl.prototype.qo=function(t){return Ca.resolve(this.vr.slice())},Wl.prototype.Cr=function(t,e){var n=this,r=new Pf(e,0),i=new Pf(e,Number.POSITIVE_INFINITY),o=[];return this.tl.Nt([r,i],function(t){var e=n.el(t.Gc);o.push(e)}),Ca.resolve(o)},Wl.prototype.Mr=function(t,e){var r=this,i=new ho(Ii);return e.forEach(function(t){var e=new Pf(t,0),n=new Pf(t,Number.POSITIVE_INFINITY);r.tl.Nt([e,n],function(t){i=i.add(t.Gc)})}),Ca.resolve(this.sl(i))},Wl.prototype.Qr=function(t,e){var n=e.path,r=n.length+1,i=n;Yr.F(i)||(i=i.child(""));var o=new Pf(new Yr(i),0),s=new ho(Ii);return this.tl.Ft(function(t){var e=t.key.path;return!!n.T(e)&&(e.length===r&&(s=s.add(t.Gc)),!0)},o),Ca.resolve(this.sl(s))},Wl.prototype.sl=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.el(t);null!==e&&r.push(e)}),r},Wl.prototype.Qo=function(n,r){var i=this;Fr(0===this.il(r.batchId,"removed")),this.vr.shift();var o=this.tl;return Ca.forEach(r.mutations,function(t){var e=new Pf(t.key,r.batchId);return o=o.delete(e),i.Co.Ko(n,t.key)}).next(function(){i.tl=o})},Wl.prototype.jo=function(t){},Wl.prototype.zo=function(t,e){var n=new Pf(e,0),r=this.tl.$t(n);return Ca.resolve(e.isEqual(r&&r.key))},Wl.prototype.Go=function(t){return this.vr.length,Ca.resolve()},Wl.prototype.il=function(t,e){return this.nl(t)},Wl.prototype.nl=function(t){return 0===this.vr.length?0:t-this.vr[0].batchId},Wl.prototype.el=function(t){var e=this.nl(t);return e<0||e>=this.vr.length?null:this.vr[e]},Wl),Ql=(Kl.prototype.Tr=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.rl(e);return this.docs=this.docs.rt(r,{Zo:e,size:s,readTime:n}),this.size+=s-o,this.Sr.ko(t,r.path.h())},Kl.prototype.Ir=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Kl.prototype.Ar=function(t,e){var n=this.docs.get(e);return Ca.resolve(n?n.Zo:null)},Kl.prototype.getEntries=function(t,e){var n=this,r=lo;return e.forEach(function(t){var e=n.docs.get(t);r=r.rt(t,e?e.Zo:null)}),Ca.resolve(r)},Kl.prototype.Or=function(t,e,n){for(var r=yo,i=new Yr(e.path.child("")),o=this.docs._t(i);o.It();){var s=o.Et(),u=s.key,a=s.value,c=a.Zo,h=a.readTime;if(!e.path.T(u.path))break;h.L(n)<=0||c instanceof Ru&&Zu(e,c)&&(r=r.rt(c.key,c))}return Ca.resolve(r)},Kl.prototype.ol=function(t,e){return Ca.forEach(this.docs,function(t){return e(t)})},Kl.prototype.aa=function(t){return new Kl.ca(this)},Kl.prototype.ha=function(t){return Ca.resolve(this.size)},Kl);function Kl(t,e){this.Sr=t,this.rl=e,this.docs=new ro(Yr.i),this.size=0}function Wl(t,e){this.Sr=t,this.Co=e,this.vr=[],this.Zh=1,this.tl=new ho(Pf.Oc)}function Yl(){}function Xl(t){var e=this;return(e=Bl.call(this)||this).la=t,e}Ql.ca=(o(Xl,Bl=Sc),Xl.prototype.gr=function(n){var r=this,i=[];return this.dr.forEach(function(t,e){e?i.push(r.la.Tr(n,e,r.readTime)):r.la.Ir(t)}),Ca.$n(i)},Xl.prototype.Rr=function(t,e){return this.la.Ar(t,e)},Xl.prototype.Pr=function(t,e){return this.la.getEntries(t,e)},Xl);var $l,Jl,Zl=(yp.prototype.De=function(t,n){return this.al.forEach(function(t,e){return n(e)}),Ca.resolve()},yp.prototype.Ra=function(t){return Ca.resolve(this.lastRemoteSnapshotVersion)},yp.prototype.Pa=function(t){return Ca.resolve(this.cl)},yp.prototype.Ea=function(t){return this.highestTargetId=this.hl.next(),Ca.resolve(this.highestTargetId)},yp.prototype.ga=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.cl&&(this.cl=e),Ca.resolve()},yp.prototype.Va=function(t){this.al.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.hl=new ef(e),this.highestTargetId=e),t.sequenceNumber>this.cl&&(this.cl=t.sequenceNumber)},yp.prototype.ya=function(t,e){return this.Va(e),this.targetCount+=1,Ca.resolve()},yp.prototype.ba=function(t,e){return this.Va(e),Ca.resolve()},yp.prototype.va=function(t,e){return this.al.delete(e.target),this.ul.Wc(e.targetId),--this.targetCount,Ca.resolve()},yp.prototype.Vo=function(n,r,i){var o=this,s=0,u=[];return this.al.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.al.delete(t),u.push(o.Sa(n,e.targetId)),s++)}),Ca.$n(u).next(function(){return s})},yp.prototype.Da=function(t){return Ca.resolve(this.targetCount)},yp.prototype.Ca=function(t,e){var n=this.al.get(e)||null;return Ca.resolve(n)},yp.prototype.Na=function(t,e,n){return this.ul.qc(e,n),Ca.resolve()},yp.prototype.$a=function(e,t,n){this.ul.Qc(t,n);var r=this.persistence.Co,i=[];return r&&t.forEach(function(t){i.push(r.Ko(e,t))}),Ca.$n(i)},yp.prototype.Sa=function(t,e){return this.ul.Wc(e),Ca.resolve()},yp.prototype.ka=function(t,e){var n=this.ul.Kc(e);return Ca.resolve(n)},yp.prototype.zo=function(t,e){return Ca.resolve(this.ul.zo(e))},yp),tp=(vp.prototype.start=function(){return Promise.resolve()},vp.prototype.Si=function(){return this.qa=!1,Promise.resolve()},Object.defineProperty(vp.prototype,"Ti",{get:function(){return this.qa},enumerable:!1,configurable:!0}),vp.prototype.nc=function(){},vp.prototype.sc=function(){},vp.prototype.Pc=function(){return this.Sr},vp.prototype.Ic=function(t){var e=this.ll[t.Zs()];return e||(e=new Hl(this.Sr,this.Co),this.ll[t.Zs()]=e),e},vp.prototype.Ac=function(){return this.Ha},vp.prototype.Rc=function(){return this.br},vp.prototype.runTransaction=function(t,e,n){var r=this;Cr("MemoryPersistence","Starting transaction:",t);var i=new ep(this.Ba.next());return this.Co.fl(),n(i).next(function(t){return r.Co.dl(i).next(function(){return t})}).Nn().then(function(t){return i.pr(),t})},vp.prototype.wl=function(e,n){return Ca.xn(Object.values(this.ll).map(function(t){return function(){return t.zo(e,n)}}))},vp),ep=(o(dp,Jl=xc),dp),np=(pp.El=function(t){return new pp(t)},Object.defineProperty(pp.prototype,"Il",{get:function(){if(this.Tl)return this.Tl;throw Mr()},enumerable:!1,configurable:!0}),pp.prototype.Fa=function(t,e,n){return this.ml.Fa(n,e),this.Il.delete(n.toString()),Ca.resolve()},pp.prototype.xa=function(t,e,n){return this.ml.xa(n,e),this.Il.add(n.toString()),Ca.resolve()},pp.prototype.Ko=function(t,e){return this.Il.add(e.toString()),Ca.resolve()},pp.prototype.removeTarget=function(t,e){var n=this;this.ml.Wc(e.targetId).forEach(function(t){return n.Il.add(t.toString())});var r=this.persistence.Ac();return r.ka(t,e.targetId).next(function(t){t.forEach(function(t){return n.Il.add(t.toString())})}).next(function(){return r.va(t,e)})},pp.prototype.fl=function(){this.Tl=new Set},pp.prototype.dl=function(n){var r=this,i=this.persistence.Rc().aa();return Ca.forEach(this.Il,function(t){var e=Yr.D(t);return r.Al(n,e).next(function(t){t||i.Ir(e)})}).next(function(){return r.Tl=null,i.apply(n)})},pp.prototype.vc=function(t,e){var n=this;return this.Al(t,e).next(function(t){t?n.Il.delete(e.toString()):n.Il.add(e.toString())})},pp.prototype._l=function(t){return 0},pp.prototype.Al=function(t,e){var n=this;return Ca.xn([function(){return Ca.resolve(n.ml.zo(e))},function(){return n.persistence.Ac().zo(t,e)},function(){return n.persistence.wl(t,e)}])},pp),rp=(lp.prototype.yu=function(t){this.gl=t},lp.prototype.Iu=function(t){this.yl=t},lp.prototype.onMessage=function(t){this.Vl=t},lp.prototype.close=function(){this.Pl()},lp.prototype.send=function(t){this.Rl(t)},lp.prototype.pl=function(){this.gl()},lp.prototype.bl=function(t){this.yl(t)},lp.prototype.vl=function(t){this.Vl(t)},lp),ip={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},op=(fp.prototype.Mu=function(e,t,n,r){var i=this.Nl(e,t);Cr("RestConnection","Sending: ",i,n);var o={};return this.Fl(o,r),this.$l(e,i,o,n).then(function(t){return Cr("RestConnection","Received: ",t),t},function(t){throw Ur("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},fp.prototype.Ou=function(t,e,n,r){return this.Mu(t,e,n,r)},fp.prototype.Fl=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.22.1",t["Content-Type"]="text/plain",e)for(var n in e.zc)e.zc.hasOwnProperty(n)&&(t[n]=e.zc[n])},fp.prototype.Nl=function(t,e){var n=ip[t];return this.Dl+"/v1/"+e+":"+n},o(hp,$l=fp),hp.prototype.$l=function(a,e,n,r){return new Promise(function(o,s){var u=new Ar;u.listenOnce(Tr.COMPLETE,function(){try{switch(u.getLastErrorCode()){case Er.NO_ERROR:var t=u.getResponseJson();Cr("Connection","XHR received:",JSON.stringify(t)),o(t);break;case Er.TIMEOUT:Cr("Connection",'RPC "'+a+'" timed out'),s(new Or(xr.DEADLINE_EXCEEDED,"Request time out"));break;case Er.HTTP_ERROR:var e,n,r=u.getStatus();Cr("Connection",'RPC "'+a+'" failed with status:',r,"response text:",u.getResponseText()),0<r?(e=u.getResponseJson().error)&&e.status&&e.message?(i=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(xr).indexOf(i)?i:xr.UNKNOWN,s(new Or(n,e.message))):s(new Or(xr.UNKNOWN,"Server responded with status "+u.getStatus())):s(new Or(xr.UNAVAILABLE,"Connection failed."));break;default:Mr()}}finally{Cr("Connection",'RPC "'+a+'" completed.')}var i});var t=JSON.stringify(r);u.send(e,"POST",t,n,15)})},hp.prototype.Vu=function(t,e){var n,r,i=[this.Dl,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=Ir(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.U.projectId+"/databases/"+this.U.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.Fl(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(v())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=v().indexOf("Electron/")||0<=(r=v()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=v().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");function a(t,e){c.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Cr("Connection","Creating WebChannel: "+u,s);var c=o.createWebChannel(u,s),h=!1,f=!1,l=new rp({Rl:function(t){f?Cr("Connection","Not sending because WebChannel is closed:",t):(h||(Cr("Connection","Opening WebChannel transport."),c.open(),h=!0),Cr("Connection","WebChannel sending:",t),c.send(t))},Pl:function(){return c.close()}});return a(_r.EventType.OPEN,function(){f||Cr("Connection","WebChannel transport opened.")}),a(_r.EventType.CLOSE,function(){f||(f=!0,Cr("Connection","WebChannel transport closed"),l.bl())}),a(_r.EventType.ERROR,function(t){f||(f=!0,Ur("Connection","WebChannel transport errored:",t),l.bl(new Or(xr.UNAVAILABLE,"The operation could not be completed")))}),a(_r.EventType.MESSAGE,function(t){var e,n,r,i,o,s;f||(Fr(!!(n=t.data[0])),(r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(Cr("Connection","WebChannel received error:",r),i=r.status,o=function(){var t=$i[i];if(void 0!==t)return no(t)}(),s=r.message,void 0===o&&(o=xr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),f=!0,l.bl(new Or(o,s)),c.close()):(Cr("Connection","WebChannel received:",n),l.vl(n)))}),setTimeout(function(){l.pl()},0),l},hp),sp=(cp.prototype.eh=function(t){this.Ll.push(t)},cp.prototype.Si=function(){window.removeEventListener("online",this.xl),window.removeEventListener("offline",this.Ml)},cp.prototype.Bl=function(){window.addEventListener("online",this.xl),window.addEventListener("offline",this.Ml)},cp.prototype.kl=function(){Cr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Ll;t<e.length;t++)(0,e[t])(0)},cp.prototype.Ol=function(){Cr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Ll;t<e.length;t++)(0,e[t])(1)},cp.On=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},cp),up=(ap.prototype.eh=function(t){},ap.prototype.Si=function(){},ap);function ap(){}function cp(){var t=this;this.xl=function(){return t.kl()},this.Ml=function(){return t.Ol()},this.Ll=[],this.Bl()}function hp(t){var e=this;return(e=$l.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function fp(t){this.Sl=t,this.U=t.U;var e=t.ssl?"https":"http";this.Dl=e+"://"+t.host,this.Cl="projects/"+this.U.projectId+"/databases/"+this.U.database+"/documents"}function lp(t){this.Rl=t.Rl,this.Pl=t.Pl}function pp(t){this.persistence=t,this.ml=new Cf,this.Tl=null}function dp(t){var e=this;return(e=Jl.call(this)||this).Ma=t,e}function vp(t){var e=this;this.ll={},this.Ba=new pc(0),this.qa=!1,this.qa=!0,this.Co=t(this),this.Ha=new Zl(this),this.Sr=new xh,this.br=new Ql(this.Sr,function(t){return e.Co._l(t)})}function yp(t){this.persistence=t,this.al=new Ci(Ki,Wi),this.lastRemoteSnapshotVersion=Ui.min(),this.highestTargetId=0,this.cl=0,this.ul=new Cf,this.targetCount=0,this.hl=ef.ma()}function gp(t){return new ss(t,!0)}var mp,wp,bp,Ip,Ep="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Tp=(Mp.prototype.initialize=function(e){return m(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Ch=this.ql(e),this.persistence=this.Ul(e),[4,this.persistence.start()];case 1:return t.sent(),this.Ql=this.Wl(e),this.Gu=this.jl(e),[2]}})})},Mp.prototype.Wl=function(t){return null},Mp.prototype.jl=function(t){return e=this.persistence,n=new zl,r=t.Kl,new If(e,n,r);var e,n,r},Mp.prototype.Ul=function(t){if(t.persistenceSettings.Gl)throw new Or(xr.FAILED_PRECONDITION,Ep);return new tp(np.El)},Mp.prototype.ql=function(t){return new _c},Mp.prototype.terminate=function(){return m(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Ql&&this.Ql.stop(),[4,this.Ch.Si()];case 1:return t.sent(),[4,this.persistence.Si()];case 2:return t.sent(),[2]}})})},Mp.prototype.clearPersistence=function(t,e){throw new Or(xr.FAILED_PRECONDITION,Ep)},Mp),_p=(o(Vp,Ip=Tp),Vp.prototype.initialize=function(e){return m(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,Ip.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,function(r){return m(this,void 0,void 0,function(){var e,n;return w(this,function(t){return n=(e=r).Fc,[2,e.persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return n.oa(t)}).then(function(t){e.Nc=t})]})})}(this.Gu)];case 2:return t.sent(),[4,this.zl.initialize(this,e)];case 3:return t.sent(),[4,Gl(this.zl._i)];case 4:return t.sent(),[4,vl(this.zl.Sh)];case 5:return t.sent(),[2]}})})},Vp.prototype.Wl=function(t){var e=this.persistence.Co.do;return new $c(e,t.os)},Vp.prototype.Ul=function(t){var e=bf(t.Sl.U,t.Sl.persistenceKey),n=gp(t.Sl.U);return new lf(t.persistenceSettings.synchronizeTabs,e,t.clientId,Wc.oo(t.persistenceSettings.cacheSizeBytes),t.os,$a(),Ja(),n,this.Ch,t.persistenceSettings.La)},Vp.prototype.ql=function(t){return new _c},Vp.prototype.clearPersistence=function(t,e){return function(n){return m(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return Pa.On()?(e=n+"main",[4,Pa.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(bf(t,e))},o(Up,bp=Vp),Up.prototype.initialize=function(r){return m(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:return[4,bp.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.zl._i,this.Ch instanceof Tc?(this.Ch._i={tr:function(u,a,c,h){return m(this,void 0,void 0,function(){var o,s;return w(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).Gu,n=a,i=(r=e).vr,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Oo(e,n).next(function(t){return t?r.$c.$r(e,t):Ca.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,vl(o.Sh)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(Ll(o,a,h||null),kl(o,a),o.Gu.vr.jo(a)):Mr(),t.label=4;case 4:return[4,Ml(o,s)];case 5:return t.sent(),[3,7];case 6:Cr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}.bind(null,e),er:function(s,u,a,c){return m(this,void 0,void 0,function(){var n,i,o;return w(this,function(t){switch(t.label){case 0:return(n=s).Qh?(Cr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!n.xh.has(u))return[3,8];switch(a){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,(r=n.Gu,e=r.Fc,r.persistence.runTransaction("Get new document changes","readonly",function(t){return e.ia(t,r.Nc)}).then(function(t){var e=t.ra,n=t.readTime;return r.Nc=n,e}))];case 3:return i=t.sent(),o=_o.Jt(u,"current"===a),[4,Ml(n,i,o)];case 4:return t.sent(),[3,8];case 5:return[4,Af(n.Gu,u,!0)];case 6:return t.sent(),Cl(n,u,c),[3,8];case 7:Mr(),t.label=8;case 8:return[2]}var r,e})})}.bind(null,e),nr:function(f,l,p){return m(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a,c,h;return w(this,function(t){switch(t.label){case 0:if(!(n=jl(f)).Qh)return[3,10];e=0,r=l,t.label=1;case 1:return e<r.length?(i=r[e],n.xh.has(i)?(Cr("SyncEngine","Adding an already active target "+i),[3,5]):[4,Sf(n.Gu,i)]):[3,6];case 2:return o=t.sent(),[4,_f(n.Gu,o)];case 3:return s=t.sent(),[4,xl(n,ql(o),s.targetId,!1)];case 4:t.sent(),ol(n.Sh,s),t.label=5;case 5:return e++,[3,1];case 6:u=function(e){return w(this,function(t){switch(t.label){case 0:return n.xh.has(e)?[4,Af(n.Gu,e,!1).then(function(){sl(n.Sh,e),Cl(n,e)}).catch(Df)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},a=0,c=p,t.label=7;case 7:return a<c.length?(h=c[a],[5,u(h)]):[3,10];case 8:t.sent(),t.label=9;case 9:return a++,[3,7];case 10:return[2]}})})}.bind(null,e),Vi:function(t){return t.Gu.persistence.Vi()}.bind(null,e)},[4,this.Ch.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.ec(function(e){return m(n,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,function(h,f){return m(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return w(this,function(t){switch(t.label){case 0:return jl(r=h),Gl(r),!0!==f||!0===r.Qh?[3,3]:(e=r.Ch.Di(),[4,Fl(r,e.A())]);case 1:return i=t.sent(),r.Qh=!0,[4,ml(r.Sh,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],ol(r.Sh,u);return[3,7];case 3:return!1!==f||!1===r.Qh?[3,7]:(a=[],c=Promise.resolve(),r.xh.forEach(function(t,e){r.Ch.Bi(e)?a.push(e):c=c.then(function(){return Cl(r,e),Af(r.Gu,e,!0)}),sl(r.Sh,e)}),[4,c]);case 4:return t.sent(),[4,Fl(r,a)];case 5:return t.sent(),(n=r).Oh.forEach(function(t,e){sl(n.Sh,e)}),n.Lh.jc(),n.Oh=new Map,n.Mh=new ro(Yr.i),r.Qh=!1,[4,ml(r.Sh,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}(this.zl._i,e)];case 1:return t.sent(),this.Ql&&(e&&!this.Ql.Ti?this.Ql.start(this.Gu):e||this.Ql.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},Up.prototype.ql=function(t){if(t.persistenceSettings.Gl&&t.persistenceSettings.synchronizeTabs){var e=$a();if(!Tc.On(e))throw new Or(xr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=bf(t.Sl.U,t.Sl.persistenceKey);return new Tc(e,t.os,n,t.clientId,t.Kl)}return new _c},Up),Ap=(Pp.prototype.initialize=function(n,r){return m(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:return this.Gu?[3,2]:(this.Gu=n.Gu,this.Ch=n.Ch,this.zu=this.Hl(r),this.Sh=this.Yl(r),this.Dh=this.Jl(r),this._i=this.Xl(r),this.Ch.fi=function(t){return Rl(e._i,t,1)},this.Sh.Hu.Zl=function(i,o){return m(this,void 0,void 0,function(){var n,r;return w(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Cr("SyncEngine","User change. New user:",o.Zs()),[4,function(i,o){return m(this,void 0,void 0,function(){var e,n,m,r;return w(this,function(t){switch(t.label){case 0:return n=(e=i).vr,m=e.$c,[4,e.persistence.runTransaction("Handle user change","readonly",function(y){var g;return e.vr.qo(y).next(function(t){return g=t,n=e.persistence.Ic(o),m=new Oc(e.Fc,n,e.persistence.Pc()),n.qo(y)}).next(function(t){for(var e=[],n=[],r=wo(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var v=d[p];r=r.add(v.key)}}return m.$r(y,r).next(function(t){return{Gh:t,zh:e,Hh:n}})})})];case 1:return r=t.sent(),[2,(e.vr=n,e.$c=m,e.Sc.xc(e.$c),r)]}})})}(n.Gu,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).qh.forEach(function(t){t.forEach(function(t){t.reject(new Or(xr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.qh.clear(),n.Ch.Wi(o,r.zh,r.Hh),[4,Ml(n,r.Gh)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this._i),[4,ml(this.Sh,this._i.Wh)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Pp.prototype.Jl=function(t){return new oc},Pp.prototype.Hl=function(t){var e,n=gp(t.Sl.U),r=(e=t.Sl,new op(e)),i=t.credentials;return new Bf(i,r,n)},Pp.prototype.Yl=function(t){var e=this;return new Of(this.Gu,this.zu,t.os,function(t){return Rl(e._i,t,0)},new(sp.On()?sp:up))},Pp.prototype.Xl=function(t){return e=this.Gu,n=this.Sh,r=this.Dh,i=this.Ch,o=t.Kl,s=t.Nh,u=!t.persistenceSettings.Gl||!t.persistenceSettings.synchronizeTabs,a=new Nl(e,n,r,i,o,s),u&&(a.Qh=!0),a;var e,n,r,i,o,s,u,a},Pp.prototype.terminate=function(){return il(this.Sh)},Pp),Np=(Cp.prototype.next=function(t){this.observer.next&&this.t_(this.observer.next,t)},Cp.prototype.error=function(t){this.observer.error?this.t_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Cp.prototype.e_=function(){this.muted=!0},Cp.prototype.t_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Cp),Sp=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Or(xr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(ii("FieldPath","string",e,t[e]),0===t[e].length)throw new Or(xr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.n_=new Wr(t)},Dp=(o(Lp,wp=Sp),Lp.documentId=function(){return new Lp(Wr.v().R())},Lp.prototype.isEqual=function(t){if(!(t instanceof Lp))throw vi("isEqual","FieldPath",1,t);return this.n_.isEqual(t.n_)},Lp),xp=new RegExp("[~\\*/\\[\\]]"),Op=function(t){this.s_=t},Rp=(o(kp,mp=Op),kp.prototype.i_=function(t){if(2!==t.r_)throw 1===t.r_?t.o_(this.s_+"() can only appear at the top level of your update data"):t.o_(this.s_+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},kp.prototype.isEqual=function(t){return t instanceof kp},kp);function kp(){return null!==mp&&mp.apply(this,arguments)||this}function Lp(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return wp.call(this,t)||this}function Cp(t){this.observer=t,this.muted=!1}function Pp(){}function Up(){return null!==bp&&bp.apply(this,arguments)||this}function Vp(t){var e=this;return(e=Ip.call(this)||this).zl=t,e}function Mp(){}function Fp(t,e,n){return new ad({r_:3,a_:e.settings.a_,methodName:t.s_,c_:n},e.U,e.serializer,e.ignoreUndefinedProperties)}var qp,jp,Gp,Bp,zp=(o(sd,Bp=Op),sd.prototype.i_=function(t){return new Xs(t.path,new Ps)},sd.prototype.isEqual=function(t){return t instanceof sd},sd),Hp=(o(od,Gp=Op),od.prototype.i_=function(t){var e=Fp(this,t,!0),n=this.u_.map(function(t){return yd(t,e)}),r=new Us(n);return new Xs(t.path,r)},od.prototype.isEqual=function(t){return this===t},od),Qp=(o(id,jp=Op),id.prototype.i_=function(t){var e=Fp(this,t,!0),n=this.u_.map(function(t){return yd(t,e)}),r=new js(n);return new Xs(t.path,r)},id.prototype.isEqual=function(t){return this===t},id),Kp=(o(rd,qp=Op),rd.prototype.i_=function(t){var e=new Hs(t.serializer,cs(t.serializer,this.h_));return new Xs(t.path,e)},rd.prototype.isEqual=function(t){return this===t},rd),Wp=(Object.defineProperty(nd.prototype,"latitude",{get:function(){return this.l_},enumerable:!1,configurable:!0}),Object.defineProperty(nd.prototype,"longitude",{get:function(){return this.__},enumerable:!1,configurable:!0}),nd.prototype.isEqual=function(t){return this.l_===t.l_&&this.__===t.__},nd.prototype.toJSON=function(){return{latitude:this.l_,longitude:this.__}},nd.prototype.H=function(t){return Ii(this.l_,t.l_)||Ii(this.__,t.__)},nd),Yp=function(t){this.f_=t},Xp=/^__.*__$/,$p=function(t,e,n){this.d_=t,this.w_=e,this.m_=n},Jp=(ed.prototype.T_=function(t,e){var n=[];return null!==this.Qe?n.push(new cu(t,this.data,this.Qe,e)):n.push(new au(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new du(t,this.fieldTransforms)),n},ed),Zp=(td.prototype.T_=function(t,e){var n=[new cu(t,this.data,this.Qe,e)];return 0<this.fieldTransforms.length&&n.push(new du(t,this.fieldTransforms)),n},td);function td(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function ed(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function nd(t,e){if(ei("GeoPoint",arguments,2),ii("GeoPoint","number",1,t),ii("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Or(xr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Or(xr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.l_=t,this.__=e}function rd(t,e){var n=this;return(n=qp.call(this,t)||this).h_=e,n}function id(t,e){var n=this;return(n=jp.call(this,t)||this).u_=e,n}function od(t,e){var n=this;return(n=Gp.call(this,t)||this).u_=e,n}function sd(){return null!==Bp&&Bp.apply(this,arguments)||this}function ud(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Mr()}}var ad=(Object.defineProperty(fd.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(fd.prototype,"r_",{get:function(){return this.settings.r_},enumerable:!1,configurable:!0}),fd.prototype.I_=function(t){return new fd(Object.assign(Object.assign({},this.settings),t),this.U,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},fd.prototype.A_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.I_({path:n,c_:!1});return r.R_(t),r},fd.prototype.P_=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.I_({path:n,c_:!1});return r.E_(),r},fd.prototype.g_=function(t){return this.I_({path:void 0,c_:!0})},fd.prototype.o_=function(t){return Ed(t,this.settings.methodName,this.settings.y_||!1,this.path,this.settings.a_)},fd.prototype.contains=function(e){return void 0!==this.Qe.find(function(t){return e.T(t)})||void 0!==this.fieldTransforms.find(function(t){return e.T(t.field)})},fd.prototype.E_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.R_(this.path.get(t))},fd.prototype.R_=function(t){if(0===t.length)throw this.o_("Document fields must not be empty");if(ud(this.r_)&&Xp.test(t))throw this.o_('Document fields cannot begin and end with "__"')},fd),cd=(hd.prototype.V_=function(t,e,n,r){return void 0===r&&(r=!1),new ad({r_:t,methodName:e,a_:n,path:Wr.g(),c_:!1,y_:r},this.U,this.serializer,this.ignoreUndefinedProperties)},hd);function hd(t,e,n){this.U=t,this.ignoreUndefinedProperties=e,this.serializer=n||gp(t)}function fd(t,e,n,r,i,o){this.settings=t,this.U=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.E_(),this.fieldTransforms=i||[],this.Qe=o||[]}function ld(t,e,n,r,i,o){void 0===o&&(o={});var s=t.V_(o.merge||o.mergeFields?2:0,e,n,i);wd("Data must be an object, but it was:",s,r);var u,a,c=gd(r,s);if(o.merge)u=new Ys(s.Qe),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],f=0,l=o.mergeFields;f<l.length;f++){var p=l[f],d=void 0;if(p instanceof Sp)d=p.n_;else{if("string"!=typeof p)throw Mr();d=Id(e,p,n)}if(!s.contains(d))throw new Or(xr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Td(h,d)||h.push(d)}u=new Ys(h),a=s.fieldTransforms.filter(function(t){return u.He(t.field)})}else u=null,a=s.fieldTransforms;return new Jp(new Iu(c),u,a)}function pd(t,o,s,e){var u=t.V_(1,o,s);wd("Data must be an object, but it was:",u,e);var a=[],c=new Eu;jr(e,function(t,e){var n,r=Id(o,t,s),i=u.P_(r);e instanceof Rp||e instanceof Yp&&e.f_ instanceof Rp?a.push(r):null!=(n=yd(e,i))&&(a.push(r),c.set(r,n))});var n=new Ys(a);return new Zp(c.Je(),n,u.fieldTransforms)}function dd(t,e,n,r,i,o){var s=t.V_(1,e,n),u=[bd(e,r,n)],a=[i];if(o.length%2!=0)throw new Or(xr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(bd(e,o[c])),a.push(o[c+1]);for(var h,f,l,p,d=[],v=new Eu,y=u.length-1;0<=y;--y)Td(d,u[y])||(h=u[y],f=a[y],l=s.P_(h),f instanceof Rp||f instanceof Yp&&f.f_ instanceof Rp?d.push(h):null!=(p=yd(f,l))&&(d.push(h),v.set(h,p)));var g=new Ys(d);return new Zp(v.Je(),g,s.fieldTransforms)}function vd(t,e,n,r){return void 0===r&&(r=!1),yd(n,t.V_(r?4:3,e))}function yd(s,t){if(s instanceof Yp&&(s=s.f_),md(s))return wd("Unsupported field value:",t,s),gd(s,t);if(s instanceof Op)return function(t,e){if(!ud(e.r_))throw e.o_(t.s_+"() can only be used with update() and set()");if(!e.path)throw e.o_(t.s_+"() is not currently supported inside arrays");var n=t.i_(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Qe.push(t.path),s instanceof Array){if(t.settings.c_&&4!==t.r_)throw t.o_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=yd(i[r],t.g_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return cs(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Pi.fromDate(t);return{timestampValue:hs(e.serializer,n)}}if(t instanceof Pi){var r=new Pi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:hs(e.serializer,r)}}if(t instanceof Wp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Ni)return{bytesValue:fs(e.serializer,t.q)};if(t instanceof $p){var i=e.U,o=t.d_;if(!o.isEqual(i))throw e.o_("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:ps(t.d_||e.U,t.w_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.o_("Unsupported field value: "+li(t))}(s,t)}function gd(t,r){var i={};return Gr(t)?r.path&&0<r.path.length&&r.Qe.push(r.path):jr(t,function(t,e){var n=yd(e,r.A_(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function md(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Pi||t instanceof Wp||t instanceof Ni||t instanceof $p||t instanceof Op)}function wd(t,e,n){if(!md(n)||!fi(n)){var r=li(n);throw"an object"===r?e.o_(t+" a custom object"):e.o_(t+" "+r)}}function bd(t,e,n){if(e instanceof Sp)return e.n_;if("string"==typeof e)return Id(t,e);throw Ed("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Id(t,e,n){try{return function(e){if(0<=e.search(xp))throw new Or(xr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Dp.bind.apply(Dp,s([void 0],e.split("."))))}catch(t){throw new Or(xr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).n_}catch(e){throw Ed(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Ed(t,e,n,r,i){var o=r&&!r.m(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new Or(xr.INVALID_ARGUMENT,(u+=". ")+t+a)}function Td(t,e){return t.some(function(t){return t.isEqual(e)})}var _d=(xd.prototype.D_=function(r){return m(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(this.C_(),0<this.mutations.length)throw new Or(xr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(u,a){return m(this,void 0,void 0,function(){var i,e,n,r,o,s;return w(this,function(t){switch(t.label){case 0:return e=ws((i=u).serializer)+"/documents",n={documents:a.map(function(t){return vs(i.serializer,t)})},[4,i.Ou("BatchGetDocuments",e,n)];case 1:return r=t.sent(),o=new Map,r.forEach(function(t){var e,n,r=(e=i.serializer,"found"in(n=t)?function(t,e){Fr(!!e.found),e.found.name,e.found.updateTime;var n=ys(t,e.found.name),r=ls(e.found.updateTime),i=new Iu({mapValue:{fields:e.found.fields}});return new Ru(n,r,i,{})}(e,n):"missing"in n?function(t,e){Fr(!!e.missing),Fr(!!e.readTime);var n=ys(t,e.missing),r=ls(e.readTime);return new ku(n,r)}(e,n):Mr());o.set(r.key.toString(),r)}),s=[],[2,(a.forEach(function(t){var e=o.get(t.toString());Fr(!!e),s.push(e)}),s)]}})})}(this.zu,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof ku||t instanceof Ru?n.N_(t):Mr()}),e)]}})})},xd.prototype.set=function(t,e){this.write(e.T_(t,this.Ke(t))),this.S_.add(t.toString())},xd.prototype.update=function(t,e){try{this.write(e.T_(t,this.F_(t)))}catch(t){this.v_=t}this.S_.add(t.toString())},xd.prototype.delete=function(t){this.write([new wu(t,this.Ke(t))]),this.S_.add(t.toString())},xd.prototype.commit=function(){return m(this,void 0,void 0,function(){var e,r=this;return w(this,function(t){switch(t.label){case 0:if(this.C_(),this.v_)throw this.v_;return e=this.p_,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=Yr.D(e);r.mutations.push(new bu(n,r.Ke(n)))}),[4,function(i,o){return m(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return n=ws((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Es(e.serializer,t)})},[4,e.Mu("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.zu,this.mutations)];case 1:return t.sent(),this.b_=!0,[2]}})})},xd.prototype.N_=function(t){var e;if(t instanceof Ru)e=t.version;else{if(!(t instanceof ku))throw Mr();e=Ui.min()}var n=this.p_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Or(xr.ABORTED,"Document version changed between two reads.")}else this.p_.set(t.key.toString(),e)},xd.prototype.Ke=function(t){var e=this.p_.get(t.toString());return!this.S_.has(t.toString())&&e?Zs.updateTime(e):Zs.Ge()},xd.prototype.F_=function(t){var e=this.p_.get(t.toString());if(this.S_.has(t.toString())||!e)return Zs.exists(!0);if(e.isEqual(Ui.min()))throw new Or(xr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Zs.updateTime(e)},xd.prototype.write=function(t){this.C_(),this.mutations=this.mutations.concat(t)},xd.prototype.C_=function(){},xd),Ad=(Dd.prototype.run=function(){this.k_()},Dd.prototype.k_=function(){var t=this;this.gs.Rn(function(){return m(t,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){return e=new _d(this.zu),(n=this.M_(e))&&n.then(function(t){r.os.ds(function(){return e.commit().then(function(){r.hs.resolve(t)}).catch(function(t){r.O_(t)})})}).catch(function(t){r.O_(t)}),[2]})})})},Dd.prototype.M_=function(t){try{var e=this.updateFunction(t);return!Gi(e)&&e.catch&&e.then?e:(this.hs.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.hs.reject(t),null}},Dd.prototype.O_=function(t){var e=this;0<this.x_&&this.L_(t)?(--this.x_,this.os.ds(function(){return e.k_(),Promise.resolve()})):this.hs.reject(t)},Dd.prototype.L_=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!eo(e)},Dd),Nd=(Sd.prototype.start=function(t,e,n,r){var i=this;this.q_(),this.Sl=t;var o=new Ra,s=!1;return this.credentials.Jc(function(t){return s?void i.os.Ds(function(){return function(r,i){return m(this,void 0,void 0,function(){var e,n;return w(this,function(t){switch(t.label){case 0:return(e=r).os.Fs(),Cr("RemoteStore","RemoteStore received new credentials"),n=fl(e),e.Xu.add(3),[4,rl(e)];case 1:return t.sent(),n&&e.nh.set("Unknown"),[4,e.Hu.Zl(i)];case 2:return t.sent(),e.Xu.delete(3),[4,nl(e)];case 3:return t.sent(),[2]}})})}(i.Sh,t)}):(s=!0,Cr("FirestoreClient","Initializing. user=",t.uid),i.U_(e,n,r,t,o).then(i.B_.resolve,i.B_.reject))}),this.os.ds(function(){return i.B_.promise}),o.promise},Sd.prototype.enableNetwork=function(){var e=this;return this.q_(),this.os.enqueue(function(){return e.persistence.sc(!0),(t=e.Sh).Xu.delete(0),nl(t);var t})},Sd.prototype.U_=function(i,o,s,u,a){return m(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={os:this.os,Sl:this.Sl,clientId:this.clientId,credentials:this.credentials,Kl:u,Nh:100,persistenceSettings:s},[4,i.initialize(e)];case 1:return t.sent(),[4,o.initialize(i,e)];case 2:return t.sent(),this.persistence=i.persistence,this.Ch=i.Ch,this.Gu=i.Gu,this.Ql=i.Ql,this.zu=o.zu,this.Sh=o.Sh,this._i=o._i,this.Q_=o.Dh,this.Q_.qs=function(u,a){return m(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return e=jl(u),(i=e.$h.get(a))?(n=i.targetId,e.Ch.Mi(n),r=i.view.ph(),[3,4]):[3,1];case 1:return[4,_f(e.Gu,Qu(a))];case 2:return o=t.sent(),s=e.Ch.Mi(o.targetId),n=o.targetId,[4,xl(e,a,n,"current"===s)];case 3:r=t.sent(),e.Wh&&ol(e.Sh,o),t.label=4;case 4:return[2,r]}})})}.bind(null,this._i),this.Q_.Ws=function(i,o){return m(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return n=(e=i).$h.get(o),1<(r=e.xh.get(n.targetId)).length?[2,(e.xh.set(n.targetId,r.filter(function(t){return!Xu(t,o)})),void e.$h.delete(o))]:e.Wh?(e.Ch.Li(n.targetId),e.Ch.Ni(n.targetId)?[3,2]:[4,Af(e.Gu,n.targetId,!1).then(function(){e.Ch.qi(n.targetId),sl(e.Sh,n.targetId),Cl(e,n.targetId)}).catch(Df)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Cl(e,n.targetId),[4,Af(e.Gu,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,this._i),this.persistence.nc(function(){return m(r,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),a.resolve(),[3,4];case 3:if(n=t.sent(),a.reject(n),!this.W_(n))throw n;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+n),this.U_(new Tp,new Ap,{Gl:!1},u,a))];case 4:return[2]}})})},Sd.prototype.W_=function(t){return"FirebaseError"===t.name?t.code===xr.FAILED_PRECONDITION||t.code===xr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Sd.prototype.q_=function(){if(this.os.Vs)throw new Or(xr.FAILED_PRECONDITION,"The client has already been terminated.")},Sd.prototype.disableNetwork=function(){var t=this;return this.q_(),this.os.enqueue(function(){return t.persistence.sc(!1),function(n){return m(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return(e=n).Xu.add(0),[4,rl(e)];case 1:return t.sent(),e.nh.set("Offline"),[2]}})})}(t.Sh)})},Sd.prototype.terminate=function(){var t=this;this.os.Ss();var r=new Ra;return this.os.ps(function(){return m(t,void 0,void 0,function(){var e,n;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.Ql&&this.Ql.stop(),[4,il(this.Sh)];case 1:return t.sent(),[4,this.Ch.Si()];case 2:return t.sent(),[4,this.persistence.Si()];case 3:return t.sent(),this.credentials.Xc(),r.resolve(),[3,5];case 4:return e=t.sent(),n=rc(e,"Failed to shutdown persistence"),r.reject(n),[3,5];case 5:return[2]}})})}),r.promise},Sd.prototype.waitForPendingWrites=function(){var t=this;this.q_();var e=new Ra;return this.os.ds(function(){return function(u,a){return m(this,void 0,void 0,function(){var n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:fl((n=u).Sh)||Cr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Gu).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.vr.Bo(t)})];case 2:return-1===(r=t.sent())?[2,void a.resolve()]:((i=n.qh.get(r)||[]).push(a),n.qh.set(r,i),[3,4]);case 3:return o=t.sent(),s=rc(o,"Initialization of waitForPendingWrites() operation failed"),a.reject(s),[3,4];case 4:return[2]}var e})})}(t._i,e)}),e.promise},Sd.prototype.listen=function(t,e,n){var r=this;this.q_();var i=new Np(n),o=new cc(t,i,e);return this.os.ds(function(){return sc(r.Q_,o)}),function(){i.e_(),r.os.ds(function(){return uc(r.Q_,o)})}},Sd.prototype.j_=function(r){return m(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:return this.q_(),[4,this.B_.promise];case 1:return t.sent(),e=new Ra,[2,(this.os.ds(function(){return function(s,u,a){return m(this,void 0,void 0,function(){var r,i,o;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=u,(n=s).persistence.runTransaction("read document","readonly",function(t){return n.$c.Dr(t,e)}))];case 1:return(r=t.sent())instanceof Ru?a.resolve(r):r instanceof ku?a.resolve(null):a.reject(new Or(xr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return i=t.sent(),o=rc(i,"Failed to get document '"+u+" from cache"),a.reject(o),[3,3];case 3:return[2]}var e,n})})}(n.Gu,r,e)}),e.promise)]}})})},Sd.prototype.K_=function(c,h){return void 0===h&&(h={}),m(this,void 0,void 0,function(){var e,a=this;return w(this,function(t){switch(t.label){case 0:return this.q_(),[4,this.B_.promise];case 1:return t.sent(),e=new Ra,[2,(this.os.ds(function(){return n=a.Q_,r=a.os,i=c,o=h,s=e,t=new Np({next:function(t){r.ds(function(){return uc(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Or(xr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Or(xr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new cc(Fu(i.path),t,{includeMetadataChanges:!0,Js:!0}),sc(n,u);var n,r,i,o,s,t,u}),e.promise)]}})})},Sd.prototype.G_=function(r){return m(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:return this.q_(),[4,this.B_.promise];case 1:return t.sent(),e=new Ra,[2,(this.os.ds(function(){return function(u,a,c){return m(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Nf(u,a,!0)];case 1:return e=t.sent(),n=new Tl(a,e.kc),r=n.Th(e.documents),i=n.gr(r,!1),c.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=rc(o,"Failed to execute query '"+a+" against cache"),c.reject(s),[3,3];case 3:return[2]}})})}(n.Gu,r,e)}),e.promise)]}})})},Sd.prototype.z_=function(c,h){return void 0===h&&(h={}),m(this,void 0,void 0,function(){var u,a=this;return w(this,function(t){switch(t.label){case 0:return this.q_(),[4,this.B_.promise];case 1:return t.sent(),u=new Ra,[2,(this.os.ds(function(){return e=a.Q_,n=a.os,t=c,r=h,i=u,o=new Np({next:function(t){n.ds(function(){return uc(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Or(xr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new cc(t,o,{includeMetadataChanges:!0,Js:!0}),sc(e,s);var e,n,t,r,i,o,s}),u.promise)]}})})},Sd.prototype.write=function(t){var e=this;this.q_();var n=new Ra;return this.os.ds(function(){return function(v,y,g){return m(this,void 0,void 0,function(){var u,a,p,d;return w(this,function(t){switch(t.label){case 0:u=Gl(v),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(o=u.Gu,c=y,f=o,l=Pi.now(),s=c.reduce(function(t,e){return t.add(e.key)},wo()),f.persistence.runTransaction("Locally write mutations","readwrite",function(a){return f.$c.$r(a,s).next(function(t){h=t;for(var u,e,n=[],r=0,i=c;r<i.length;r++){var o=i[r],s=(u=o,e=h.get(o.key),u instanceof du?function(t){for(var e=null,n=0,r=u.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Ru?t.field(i.field):void 0,s=ks(i.transform,o||null);null!=s&&(e=null==e?(new Eu).set(i.field,s):e.set(i.field,s))}return e?e.Je():null}(e):null);null!=s&&n.push(new cu(o.key,s,function u(t){var a=[];return jr(t.fields||{},function(t,e){var n=new Wr([t]);if(rs(e)){var r=u(e.mapValue).fields;if(0===r.length)a.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];a.push(n.child(s))}}else a.push(n)}),new Ys(a)}(s.proto.mapValue),Zs.exists(!0)))}return f.vr.xo(a,l,n,c)})}).then(function(t){var e=t.hr(h);return{batchId:t.batchId,dr:e}}))];case 2:return a=t.sent(),u.Ch.Fi(a.batchId),e=u,n=a.batchId,r=g,i=(i=(i=e.Bh[e.currentUser.Zs()])||new ro(Ii)).rt(n,r),e.Bh[e.currentUser.Zs()]=i,[4,Ml(u,a.dr)];case 3:return t.sent(),[4,vl(u.Sh)];case 4:return t.sent(),[3,6];case 5:return p=t.sent(),d=rc(p,"Failed to persist write"),g.reject(d),[3,6];case 6:return[2]}var e,n,r,i,o,c,h,f,l,s})})}(e._i,t,n)}),n.promise},Sd.prototype.U=function(){return this.Sl.U},Sd.prototype.H_=function(t){var e=this;this.q_();var r=new Np(t);return this.os.ds(function(){return m(e,void 0,void 0,function(){return w(this,function(t){return[2,(e=this.Q_,n=r,e.Bs.add(n),void n.next())];var e,n})})}),function(){r.e_(),e.os.ds(function(){return m(e,void 0,void 0,function(){return w(this,function(t){return[2,void this.Q_.Bs.delete(r)]})})})}},Object.defineProperty(Sd.prototype,"Y_",{get:function(){return this.os.Vs},enumerable:!1,configurable:!0}),Sd.prototype.transaction=function(t){var e=this;this.q_();var n=new Ra;return this.os.ds(function(){return new Ad(e.os,e.zu,t,n).run(),Promise.resolve()}),n.promise},Sd);function Sd(t,e){this.credentials=t,this.os=e,this.clientId=wi.k(),this.B_=new Ra}function Dd(t,e,n,r){this.os=t,this.zu=e,this.updateFunction=n,this.hs=r,this.x_=5,this.gs=new La(this.os,"transaction_retry")}function xd(t){this.zu=t,this.p_=new Map,this.mutations=[],this.b_=!1,this.v_=null,this.S_=new Set}function Od(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Rd,kd,Ld=($d.prototype.tf=function(t){switch(Bo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Xo(t.integerValue||t.doubleValue);case 3:return this.ef(t.timestampValue);case 4:return this.nf(t);case 5:return t.stringValue;case 6:return this.Z_($o(t.bytesValue));case 7:return this.sf(t.referenceValue);case 8:return this.if(t.geoPointValue);case 9:return this.rf(t.arrayValue);case 10:return this.af(t.mapValue);default:throw Mr()}},$d.prototype.af=function(t){var n=this,r={};return jr(t.fields||{},function(t,e){r[t]=n.tf(e)}),r},$d.prototype.if=function(t){return new Wp(Xo(t.latitude),Xo(t.longitude))},$d.prototype.rf=function(t){var e=this;return(t.values||[]).map(function(t){return e.tf(t)})},$d.prototype.nf=function(t){switch(this.J_){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return qo(n)?t(n):n}(t);return null==e?null:this.tf(e);case"estimate":return this.ef(jo(t));default:return null}},$d.prototype.ef=function(t){var e=Yo(t),n=new Pi(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},$d.prototype.sf=function(t){var e=Qr.P(t);Fr(Os(e));var n=new Li(e.get(1),e.get(3)),r=new Yr(e.u(5));return n.isEqual(this.U)||Pr("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.U.projectId+"/"+this.U.database+") instead."),this.X_(r)},$d),Cd=Wc.uo,Pd=(Xd.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Xd),Ud=(Object.defineProperty(Yd.prototype,"Ef",{get:function(){return this.If||(this.If=new cd(this.d_,this.Tf.ignoreUndefinedProperties)),this.If},enumerable:!1,configurable:!0}),Yd.prototype.settings=function(t){ei("Firestore.settings",arguments,1),ii("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.Tf),t)).merge;var e=new Pd(t);if(this.ff&&!this.Tf.isEqual(e))throw new Or(xr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Tf=e).credentials&&(this.mf=function(t){if(!t)return new Uf;switch(t.type){case"gapi":var e=t.client;return Fr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Ff(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Or(xr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},Yd.prototype.enableNetwork=function(){return this._f(),this.ff.enableNetwork()},Yd.prototype.disableNetwork=function(){return this._f(),this.ff.disableNetwork()},Yd.prototype.enablePersistence=function(t){var e,n;if(this.ff)throw new Or(xr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Pr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new Or(xr.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Af(this.cf,this.uf,{Gl:!0,cacheSizeBytes:this.Tf.cacheSizeBytes,synchronizeTabs:r,La:i})},Yd.prototype.clearPersistence=function(){return m(this,void 0,void 0,function(){var n,e=this;return w(this,function(t){if(void 0!==this.ff&&!this.ff.Y_)throw new Or(xr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new Ra,[2,(this.lf.ps(function(){return m(e,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.cf.clearPersistence(this.d_,this.wf)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},Yd.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Yd.prototype,"Rf",{get:function(){return this._f(),this.ff.Y_},enumerable:!1,configurable:!0}),Yd.prototype.waitForPendingWrites=function(){return this._f(),this.ff.waitForPendingWrites()},Yd.prototype.onSnapshotsInSync=function(t){if(this._f(),Od(t))return this.ff.H_(t);ii("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.ff.H_(e)},Yd.prototype._f=function(){return this.ff||this.Af(new Tp,new Ap,{Gl:!1}),this.ff},Yd.prototype.Pf=function(){return new Oi(this.d_,this.wf,this.Tf.host,this.Tf.ssl,this.Tf.experimentalForceLongPolling)},Yd.prototype.Af=function(t,e,n){var r=this.Pf();return this.ff=new Nd(this.mf,this.lf),this.ff.start(r,t,e,n)},Yd.df=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Or(xr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Or(xr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Li(n)},Object.defineProperty(Yd.prototype,"app",{get:function(){if(!this.hf)throw new Or(xr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.hf},enumerable:!1,configurable:!0}),Yd.prototype.collection=function(t){return ei("Firestore.collection",arguments,1),ii("Firestore.collection","non-empty string",1,t),this._f(),new ov(Qr.P(t),this,null)},Yd.prototype.doc=function(t){return ei("Firestore.doc",arguments,1),ii("Firestore.doc","non-empty string",1,t),this._f(),Fd.gf(Qr.P(t),this,null)},Yd.prototype.collectionGroup=function(t){if(ei("Firestore.collectionGroup",arguments,1),ii("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Or(xr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this._f(),new rv((e=t,new Cu(Qr.g(),e)),this,null);var e},Yd.prototype.runTransaction=function(e){var n=this;return ei("Firestore.runTransaction",arguments,1),ii("Firestore.runTransaction","function",1,e),this._f().transaction(function(t){return e(new Vd(n,t))})},Yd.prototype.batch=function(){return this._f(),new Md(this)},Object.defineProperty(Yd,"logLevel",{get:function(){switch(Lr()){case l.DEBUG:return"debug";case l.ERROR:return"error";case l.SILENT:return"silent";case l.WARN:return"warn";case l.INFO:return"info";case l.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),Yd.setLogLevel=function(t){ei("Firestore.setLogLevel",arguments,1),ci("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Rr.setLogLevel(t)},Yd.prototype.yf=function(){return this.Tf.timestampsInSnapshots},Yd.prototype.Vf=function(){return this.Tf},Yd),Vd=(Wd.prototype.get=function(t){var n=this;ei("Transaction.get",arguments,1);var r=lv("Transaction.get",t,this.pf);return this.bf.D_([r.w_]).then(function(t){if(!t||1!==t.length)return Mr();var e=t[0];if(e instanceof ku)return new jd(n.pf,r.w_,null,!1,!1,r.m_);if(e instanceof Ru)return new jd(n.pf,r.w_,e,!1,!1,r.m_);throw Mr()})},Wd.prototype.set=function(t,e,n){ri("Transaction.set",arguments,2,3);var r=lv("Transaction.set",t,this.pf);n=cv("Transaction.set",n);var i=pv(r.m_,e,n),o=ld(this.pf.Ef,"Transaction.set",r.w_,i,null!==r.m_,n);return this.bf.set(r.w_,o),this},Wd.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof Dp?(ni("Transaction.update",arguments,3),r=lv("Transaction.update",t,this.pf),dd(this.pf.Ef,"Transaction.update",r.w_,e,n,o)):(ei("Transaction.update",arguments,2),r=lv("Transaction.update",t,this.pf),pd(this.pf.Ef,"Transaction.update",r.w_,e)),this.bf.update(r.w_,i),this},Wd.prototype.delete=function(t){ei("Transaction.delete",arguments,1);var e=lv("Transaction.delete",t,this.pf);return this.bf.delete(e.w_),this},Wd),Md=(Kd.prototype.set=function(t,e,n){ri("WriteBatch.set",arguments,2,3),this.Df();var r=lv("WriteBatch.set",t,this.pf);n=cv("WriteBatch.set",n);var i=pv(r.m_,e,n),o=ld(this.pf.Ef,"WriteBatch.set",r.w_,i,null!==r.m_,n);return this.vf=this.vf.concat(o.T_(r.w_,Zs.Ge())),this},Kd.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Df(),i="string"==typeof e||e instanceof Dp?(ni("WriteBatch.update",arguments,3),r=lv("WriteBatch.update",t,this.pf),dd(this.pf.Ef,"WriteBatch.update",r.w_,e,n,o)):(ei("WriteBatch.update",arguments,2),r=lv("WriteBatch.update",t,this.pf),pd(this.pf.Ef,"WriteBatch.update",r.w_,e)),this.vf=this.vf.concat(i.T_(r.w_,Zs.exists(!0))),this},Kd.prototype.delete=function(t){ei("WriteBatch.delete",arguments,1),this.Df();var e=lv("WriteBatch.delete",t,this.pf);return this.vf=this.vf.concat(new wu(e.w_,Zs.Ge())),this},Kd.prototype.commit=function(){return this.Df(),this.Sf=!0,0<this.vf.length?this.pf._f().write(this.vf):Promise.resolve()},Kd.prototype.Df=function(){if(this.Sf)throw new Or(xr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Kd),Fd=(o(Qd,kd=$p),Qd.gf=function(t,e,n){if(t.length%2!=0)throw new Or(xr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.R()+" has "+t.length);return new Qd(new Yr(t),e,n)},Object.defineProperty(Qd.prototype,"id",{get:function(){return this.w_.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Qd.prototype,"parent",{get:function(){return new ov(this.w_.path.h(),this.firestore,this.m_)},enumerable:!1,configurable:!0}),Object.defineProperty(Qd.prototype,"path",{get:function(){return this.w_.path.R()},enumerable:!1,configurable:!0}),Qd.prototype.collection=function(t){if(ei("DocumentReference.collection",arguments,1),ii("DocumentReference.collection","non-empty string",1,t),!t)throw new Or(xr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Qr.P(t);return new ov(this.w_.path.child(e),this.firestore,null)},Qd.prototype.isEqual=function(t){if(!(t instanceof Qd))throw vi("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.w_.isEqual(t.w_)&&this.m_===t.m_},Qd.prototype.set=function(t,e){ri("DocumentReference.set",arguments,1,2),e=cv("DocumentReference.set",e);var n=pv(this.m_,t,e),r=ld(this.firestore.Ef,"DocumentReference.set",this.w_,n,null!==this.m_,e);return this.ff.write(r.T_(this.w_,Zs.Ge()))},Qd.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof Dp?(ni("DocumentReference.update",arguments,2),dd(this.firestore.Ef,"DocumentReference.update",this.w_,t,e,r)):(ei("DocumentReference.update",arguments,1),pd(this.firestore.Ef,"DocumentReference.update",this.w_,t)),this.ff.write(n.T_(this.w_,Zs.exists(!0)))},Qd.prototype.delete=function(){return ei("DocumentReference.delete",arguments,0),this.ff.write([new wu(this.w_,Zs.Ge())])},Qd.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];ri("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||Od(i[u])||(di("DocumentReference.onSnapshot",s=i[u],["includeMetadataChanges"]),ui("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++);var a,c={includeMetadataChanges:s.includeMetadataChanges};Od(i[u])?(a=i[u],i[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),i[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),i[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)):(ii("DocumentReference.onSnapshot","function",u,i[u]),oi("DocumentReference.onSnapshot","function",u+1,i[u+1]),oi("DocumentReference.onSnapshot","function",u+2,i[u+2]));var h={next:function(t){i[u]&&i[u](r.Cf(t))},error:i[u+1],complete:i[u+2]};return this.ff.listen(Fu(this.w_.path),c,h)},Qd.prototype.get=function(t){var e=this;ri("DocumentReference.get",arguments,0,1),fv("DocumentReference.get",t);var n=this.firestore._f();return t&&"cache"===t.source?n.j_(this.w_).then(function(t){return new jd(e.firestore,e.w_,t,!0,t instanceof Ru&&t.Ye,e.m_)}):n.K_(this.w_,t).then(function(t){return e.Cf(t)})},Qd.prototype.withConverter=function(t){return new Qd(this.w_,this.firestore,t)},Qd.prototype.Cf=function(t){var e=t.docs.get(this.w_);return new jd(this.firestore,this.w_,e,t.fromCache,t.hasPendingWrites,this.m_)},Qd),qd=(Hd.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Hd),jd=(zd.prototype.data=function(t){var e=this;if(ri("DocumentSnapshot.data",arguments,0,1),t=hv("DocumentSnapshot.data",t),this.Nf){if(this.m_){var n=new Gd(this.pf,this.w_,this.Nf,this.Ff,this.$f,null);return this.m_.fromFirestore(n,t)}return new Ld(this.pf.d_,this.pf.yf(),t.serverTimestamps||"none",function(t){return new Fd(t,e.pf,null)},function(t){return new ki(t)}).tf(this.Nf.sn())}},zd.prototype.get=function(t,e){var n=this;if(ri("DocumentSnapshot.get",arguments,1,2),e=hv("DocumentSnapshot.get",e),this.Nf){var r=this.Nf.data().field(bd("DocumentSnapshot.get",t,this.w_));if(null!==r)return new Ld(this.pf.d_,this.pf.yf(),e.serverTimestamps||"none",function(t){return new Fd(t,n.pf,n.m_)},function(t){return new ki(t)}).tf(r)}},Object.defineProperty(zd.prototype,"id",{get:function(){return this.w_.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(zd.prototype,"ref",{get:function(){return new Fd(this.w_,this.pf,this.m_)},enumerable:!1,configurable:!0}),Object.defineProperty(zd.prototype,"exists",{get:function(){return null!==this.Nf},enumerable:!1,configurable:!0}),Object.defineProperty(zd.prototype,"metadata",{get:function(){return new qd(this.$f,this.Ff)},enumerable:!1,configurable:!0}),zd.prototype.isEqual=function(t){if(!(t instanceof zd))throw vi("isEqual","DocumentSnapshot",1,t);return this.pf===t.pf&&this.Ff===t.Ff&&this.w_.isEqual(t.w_)&&(null===this.Nf?null===t.Nf:this.Nf.isEqual(t.Nf))&&this.m_===t.m_},zd),Gd=(o(Bd,Rd=jd),Bd.prototype.data=function(t){return Rd.prototype.data.call(this,t)},Bd);function Bd(){return null!==Rd&&Rd.apply(this,arguments)||this}function zd(t,e,n,r,i,o){this.pf=t,this.w_=e,this.Nf=n,this.Ff=r,this.$f=i,this.m_=o}function Hd(t,e){this.hasPendingWrites=t,this.fromCache=e}function Qd(t,e,n){var r=this;return(r=kd.call(this,e.d_,t,n)||this).w_=t,r.firestore=e,r.m_=n,r.ff=r.firestore._f(),r}function Kd(t){this.pf=t,this.vf=[],this.Sf=!1}function Wd(t,e){this.pf=t,this.bf=e}function Yd(t,e,n,r){var i=this;if(void 0===n&&(n=new Tp),void 0===r&&(r=new Ap),this.cf=n,this.uf=r,this.hf=null,this.lf=new tc,this.INTERNAL={delete:function(){return m(i,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this._f(),[4,this.ff.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var o=t;this.hf=o,this.d_=Yd.df(o),this.wf=o.name,this.mf=new Vf(e)}else{var s=t;if(!s.projectId)throw new Or(xr.INVALID_ARGUMENT,"Must provide projectId");this.d_=new Li(s.projectId,s.database),this.wf="[DEFAULT]",this.mf=new Uf}this.Tf=new Pd({})}function Xd(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new Or(xr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else si("settings","non-empty string","host",t.host),this.host=t.host,ui("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(di("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),ui("settings","object","credentials",t.credentials),this.credentials=t.credentials,ui("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),ui("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Pr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Pr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,ui("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Wc.lo;else{if(t.cacheSizeBytes!==Cd&&t.cacheSizeBytes<Wc.ho)throw new Or(xr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Wc.ho);this.cacheSizeBytes=t.cacheSizeBytes}ui("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}function $d(t,e,n,r,i){this.U=t,this.timestampsInSnapshots=e,this.J_=n,this.X_=r,this.Z_=i}function Jd(t,e,n){if("string"==typeof n){if(""===n)throw new Or(xr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!zu(e)&&-1!==n.indexOf("/"))throw new Or(xr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Qr.P(n));if(!Yr.F(r))throw new Or(xr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return Jo(t,new Yr(r))}if(n instanceof $p)return Jo(t,n.w_);throw new Or(xr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+li(n)+".")}function Zd(t,e){if(!Array.isArray(t)||0===t.length)throw new Or(xr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Or(xr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new Or(xr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Or(xr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function tv(t,e,n){if(!n.isEqual(e))throw new Or(xr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function ev(t){if(ju(t)&&0===t.rn.length)throw new Or(xr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var nv,rv=(av.prototype.where=function(t,e,n){ei("Query.where",arguments,3),pi("Query.where",3,n);var r,i,o=ci("Query.where",["<","<=","==","!=",">=",">","array-contains","in","array-contains-any","not-in"],2,e),s=bd("Query.where",t),u=function(t,e,n,r,i,o){var s;if(r.p()){if("array-contains"===i||"array-contains-any"===i)throw new Or(xr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){Zd(o,i);for(var u=[],a=0,c=o;a<c.length;a++){var h=c[a];u.push(Jd(n,t,h))}s={arrayValue:{values:u}}}else s=Jd(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Zd(o,i),s=vd(e,"Query.where",o,"in"===i||"not-in"===i);var f=na.create(r,i,s);return function(t,e){if(e.un()){var n=Bu(t);if(null!==n&&!n.isEqual(e.field))throw new Or(xr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=Gu(t);null!==r&&tv(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==i)throw i===e.op?new Or(xr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Or(xr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(this.xf,this.firestore.Ef,this.firestore.d_,s,o,n);return new av((i=(r=this.xf).filters.concat([u]),new Cu(r.path,r.collectionGroup,r.rn.slice(),i,r.limit,r.on,r.startAt,r.endAt)),this.firestore,this.m_)},av.prototype.orderBy=function(t,e){var n;if(ri("Query.orderBy",arguments,1,2),oi("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Or(xr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var r,i,o=bd("Query.orderBy",t),s=function(t,e,n){if(null!==t.startAt)throw new Or(xr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Or(xr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r,i,o=new Oa(e,n),s=o;return null!==Gu(r=t)||null!==(i=Bu(r))&&tv(0,i,s.field),o}(this.xf,o,n);return new av((i=(r=this.xf).rn.concat([s]),new Cu(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.on,r.startAt,r.endAt)),this.firestore,this.m_)},av.prototype.limit=function(t){return ei("Query.limit",arguments,1),ii("Query.limit","number",1,t),yi("Query.limit",1,t),new av(Ku(this.xf,t,"F"),this.firestore,this.m_)},av.prototype.limitToLast=function(t){return ei("Query.limitToLast",arguments,1),ii("Query.limitToLast","number",1,t),yi("Query.limitToLast",1,t),new av(Ku(this.xf,t,"L"),this.firestore,this.m_)},av.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ni("Query.startAt",arguments,1);var r=this.kf("Query.startAt",t,e,!0);return new av(Wu(this.xf,r),this.firestore,this.m_)},av.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ni("Query.startAfter",arguments,1);var r=this.kf("Query.startAfter",t,e,!1);return new av(Wu(this.xf,r),this.firestore,this.m_)},av.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ni("Query.endBefore",arguments,1);var r=this.kf("Query.endBefore",t,e,!0);return new av(Yu(this.xf,r),this.firestore,this.m_)},av.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];ni("Query.endAt",arguments,1);var r=this.kf("Query.endAt",t,e,!1);return new av(Yu(this.xf,r),this.firestore,this.m_)},av.prototype.isEqual=function(t){if(!(t instanceof av))throw vi("isEqual","Query",1,t);return this.firestore===t.firestore&&Xu(this.xf,t.xf)&&this.m_===t.m_},av.prototype.withConverter=function(t){return new av(this.xf,this.firestore,t)},av.prototype.kf=function(h,t,e,n){if(pi(h,1,t),t instanceof jd)return ei(h,s([t],e),1),function(t,e,n,r){if(!n)throw new Or(xr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+h+"().");for(var i=[],o=0,s=Hu(t);o<s.length;o++){var u=s[o];if(u.field.p())i.push(Jo(e,n.key));else{var a=n.field(u.field);if(qo(a))throw new Or(xr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){var c=u.field.R();throw new Or(xr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+c+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Ea(i,r)}(this.xf,this.firestore.d_,t.Nf,n);var r=[t].concat(e);return function(t,e,n,r,i,o){var s=t.rn;if(i.length>s.length)throw new Or(xr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.p()){if("string"!=typeof c)throw new Or(xr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!zu(t)&&-1!==c.indexOf("/"))throw new Or(xr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Qr.P(c));if(!Yr.F(h))throw new Or(xr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var f=new Yr(h);u.push(Jo(e,f))}else{var l=vd(n,r,c);u.push(l)}}return new Ea(u,o)}(this.xf,this.firestore.d_,this.firestore.Ef,h,r,n)},av.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];ri("Query.onSnapshot",arguments,1,4);var s,u={},a=0;"object"!=typeof i[a]||Od(i[a])||(di("Query.onSnapshot",u=i[a],["includeMetadataChanges"]),ui("Query.onSnapshot","boolean","includeMetadataChanges",u.includeMetadataChanges),a++),Od(i[a])?(s=i[a],i[a]=null===(t=s.next)||void 0===t?void 0:t.bind(s),i[a+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),i[a+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(ii("Query.onSnapshot","function",a,i[a]),oi("Query.onSnapshot","function",a+1,i[a+1]),oi("Query.onSnapshot","function",a+2,i[a+2]));var c={next:function(t){i[a]&&i[a](new iv(r.firestore,r.xf,t,r.m_))},error:i[a+1],complete:i[a+2]};return ev(this.xf),this.firestore._f().listen(this.xf,u,c)},av.prototype.get=function(t){var e=this;ri("Query.get",arguments,0,1),fv("Query.get",t),ev(this.xf);var n=this.firestore._f();return(t&&"cache"===t.source?n.G_(this.xf):n.z_(this.xf,t)).then(function(t){return new iv(e.firestore,e.xf,t,e.m_)})},av),iv=(Object.defineProperty(uv.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(uv.prototype,"empty",{get:function(){return this.Of.docs.m()},enumerable:!1,configurable:!0}),Object.defineProperty(uv.prototype,"size",{get:function(){return this.Of.docs.size},enumerable:!1,configurable:!0}),uv.prototype.forEach=function(e,n){var r=this;ri("QuerySnapshot.forEach",arguments,1,2),ii("QuerySnapshot.forEach","function",1,e),this.Of.docs.forEach(function(t){e.call(n,r.qf(t,r.metadata.fromCache,r.Of.Qt.has(t.key)))})},Object.defineProperty(uv.prototype,"query",{get:function(){return new rv(this.Mf,this.pf,this.m_)},enumerable:!1,configurable:!0}),uv.prototype.docChanges=function(t){t&&(di("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),ui("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.Of.jt)throw new Or(xr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Lf&&this.Bf===e||(this.Lf=function(i,e,o){if(i.Ut.m()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Ut;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Mr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.Of,e,this.qf.bind(this)),this.Bf=e),this.Lf},uv.prototype.isEqual=function(t){if(!(t instanceof uv))throw vi("isEqual","QuerySnapshot",1,t);return this.pf===t.pf&&Xu(this.Mf,t.Mf)&&this.Of.isEqual(t.Of)&&this.m_===t.m_},uv.prototype.qf=function(t,e,n){return new Gd(this.pf,t.key,t,e,n,this.m_)},uv),ov=(o(sv,nv=rv),Object.defineProperty(sv.prototype,"id",{get:function(){return this.xf.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(sv.prototype,"parent",{get:function(){var t=this.xf.path.h();return t.m()?null:new Fd(new Yr(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(sv.prototype,"path",{get:function(){return this.xf.path.R()},enumerable:!1,configurable:!0}),sv.prototype.doc=function(t){ri("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=wi.k()),ii("CollectionReference.doc","non-empty string",1,t);var e=Qr.P(t);return Fd.gf(this.xf.path.child(e),this.firestore,this.m_)},sv.prototype.add=function(t){ei("CollectionReference.add",arguments,1);var e=this.m_?this.m_.toFirestore(t):t;ii("CollectionReference.add","object",1,e);var n=this.doc();return new Fd(n.w_,this.firestore,null).set(e).then(function(){return n})},sv.prototype.withConverter=function(t){return new sv(this.Uf,this.firestore,t)},sv);function sv(t,e,n){var r=this;if(((r=nv.call(this,Fu(t),e,n)||this).Uf=t).length%2!=1)throw new Or(xr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.R()+" has "+t.length);return r}function uv(t,e,n,r){this.pf=t,this.Mf=e,this.Of=n,this.m_=r,this.Lf=null,this.Bf=null,this.metadata=new qd(n.hasPendingWrites,n.fromCache)}function av(t,e,n){this.xf=t,this.firestore=e,this.m_=n}function cv(t,e){if(void 0===e)return{merge:!1};if(di(t,e,["merge","mergeFields"]),ui(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Or(xr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+li(n));for(var r,i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof Dp))throw new Or(xr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+li(n[i]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Or(xr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function hv(t,e){return void 0===e?{}:(di(t,e,["serverTimestamps"]),ai(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function fv(t,e){oi(t,"object",1,e),e&&(di(t,e,["source"]),ai(t,0,"source",e.source,["default","server","cache"]))}function lv(t,e,n){if(e instanceof $p){if(e.firestore!==n)throw new Or(xr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw vi(t,"DocumentReference",1,e)}function pv(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var dv,vv,yv=(o(mv,dv=Yp),mv.serverTimestamp=function(){ti("FieldValue.serverTimestamp",arguments);var t=new zp("serverTimestamp");return t.s_="FieldValue.serverTimestamp",new mv(t)},mv.delete=function(){ti("FieldValue.delete",arguments);var t=new Rp("deleteField");return t.s_="FieldValue.delete",new mv(t)},mv.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];ni("FieldValue.arrayUnion",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ni("arrayUnion()",arguments,1),new Hp("arrayUnion",t)}.apply(void 0,t);return n.s_="FieldValue.arrayUnion",new mv(n)},mv.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];ni("FieldValue.arrayRemove",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ni("arrayRemove()",arguments,1),new Qp("arrayRemove",t)}.apply(void 0,t);return n.s_="FieldValue.arrayRemove",new mv(n)},mv.increment=function(t){ii("FieldValue.increment","number",1,t),ei("FieldValue.increment",arguments,1);var e=new Kp("increment",t);return e.s_="FieldValue.increment",new mv(e)},mv.prototype.isEqual=function(t){return this.f_.isEqual(t.f_)},mv),gv={Firestore:Ud,GeoPoint:Wp,Timestamp:Pi,Blob:ki,Transaction:Vd,WriteBatch:Md,DocumentReference:Fd,DocumentSnapshot:jd,Query:rv,QueryDocumentSnapshot:Gd,QuerySnapshot:iv,CollectionReference:ov,FieldPath:Dp,FieldValue:yv,setLogLevel:Ud.setLogLevel,CACHE_SIZE_UNLIMITED:Cd};function mv(){return null!==dv&&dv.apply(this,arguments)||this}(vv=r.default).INTERNAL.registerComponent(new Nr("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),r=new Ap,i=new _p(r),new Ud(e,n,i,r);var e,n,r,i},"PUBLIC").setServiceProps(Object.assign({},gv))),vv.registerVersion("@firebase/firestore","1.17.2")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
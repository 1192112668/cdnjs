!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(wf){"use strict";try{(function(){wf=wf&&Object.prototype.hasOwnProperty.call(wf,"default")?wf.default:wf;var t,u,e,i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function d(t,s,u,a){return new(u=u||Promise)(function(n,e){function i(t){try{o(a.next(t))}catch(t){e(t)}}function r(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(i,r)}o((a=a.apply(t,s||[])).next())})}function y(n,i){var r,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=i.call(n,u)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,r++)i[r]=o[s];return i}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,r++)i[r]=o[s];return i}function o(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var r=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+r+"]  "+t.name+":"],n))}}(e=u=u||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";var a={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},h=u.INFO,c=((t={})[u.DEBUG]="log",t[u.VERBOSE]="log",t[u.INFO]="info",t[u.WARN]="warn",t[u.ERROR]="error",t),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?a[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=h,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var v,g="FirebaseError",m=(n(w,v=Error),w);function w(t,e){var n=v.call(this,e)||this;return n.code=t,n.name=g,Object.setPrototypeOf(n,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,b.prototype.create),n}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i,r=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(i=r,s.replace(I,function(t,e){var n=i[e];return null!=n?String(n):"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new m(o,a),c=0,l=Object.keys(r);c<l.length;c++){var f=l[c];"_"!==f.slice(-1)&&(f in h&&console.warn('Overwriting FirebaseError base field "'+f+'" can cause unexpected behavior.'),h[f]=r[f])}return h},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,A=function(t,e){return(A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function T(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,R="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},k=R||self;function S(){}function _(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function O(t){var e=_(t);return"array"==e||"object"==e&&"number"==typeof t.length}function L(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var D="closure_uid_"+(1e9*Math.random()>>>0),P=0;function V(t,e,n){return t.call.apply(t.bind,arguments)}function C(e,n,t){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,i),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function U(t,e,n){return(U=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?V:C).apply(null,arguments)}function M(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var q=Date.now;function x(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function j(){this.j=this.j,this.i=this.i}j.prototype.j=!1,j.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,D)&&this[D]||(this[D]=++P))},j.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var F=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,r="string"==typeof t?t.split(""):t,o=0;o<i;o++)o in r&&e.call(n,r[o],o,t)};function G(t){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}function $(t){return/^[\s\xa0]*$/.test(t)}var W,H=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Q(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}t:{var Y=k.navigator;if(Y){var K=Y.userAgent;if(K){W=K;break t}}W=""}function J(t,e,n){for(var i in t)e.call(n,t[i],i,t)}function Z(t){var e={};for(var n in t)e[n]=t[n];return e}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t,e){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])t[n]=i[n];for(var o=0;o<tt.length;o++)n=tt[o],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function nt(t){return nt[" "](t),t}nt[" "]=S;var it,rt,ot=Q(W,"Opera"),st=Q(W,"Trident")||Q(W,"MSIE"),ut=Q(W,"Edge"),at=ut||st,ht=Q(W,"Gecko")&&!(Q(W.toLowerCase(),"webkit")&&!Q(W,"Edge"))&&!(Q(W,"Trident")||Q(W,"MSIE"))&&!Q(W,"Edge"),ct=Q(W.toLowerCase(),"webkit")&&!Q(W,"Edge");function lt(){var t=k.document;return t?t.documentMode:void 0}t:{var ft="",pt=(rt=W,ht?/rv:([^\);]+)(\)|;)/.exec(rt):ut?/Edge\/([\d\.]+)/.exec(rt):st?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(rt):ct?/WebKit\/(\S+)/.exec(rt):ot?/(?:Version)[ \/]?(\S+)/.exec(rt):void 0);if(pt&&(ft=pt?pt[1]:""),st){var dt=lt();if(null!=dt&&dt>parseFloat(ft)){it=String(dt);break t}}it=ft}var yt={};function vt(u){return t=u,e=function(){for(var t=0,e=H(String(it)).split("."),n=H(String(u)).split("."),i=Math.max(e.length,n.length),r=0;0==t&&r<i;r++){var o=e[r]||"",s=n[r]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=yt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var gt=k.document&&st&&(lt()||parseInt(it,10))||void 0,mt=!st||9<=Number(gt),wt=st&&!vt("9"),bt=function(){if(!k.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{k.addEventListener("test",S,e),k.removeEventListener("test",S,e)}catch(t){}return t}();function Et(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function It(t,e){if(Et.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ht){t:{try{nt(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:At[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Et.prototype.b=function(){this.defaultPrevented=!0},x(It,Et);var At={2:"touch",3:"pen",4:"mouse"};It.prototype.b=function(){It.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,wt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Tt="closure_listenable_"+(1e6*Math.random()|0),Nt=0;function Rt(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.ca=r,this.key=++Nt,this.Y=this.Z=!1}function kt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function St(t){this.src=t,this.a={},this.b=0}function _t(t,e){var n,i,r,o=e.type;o in t.a&&(n=t.a[o],(r=0<=(i=F(n,e)))&&Array.prototype.splice.call(n,i,1),r&&(kt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Ot(t,e,n,i){for(var r=0;r<t.length;++r){var o=t[r];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==i)return r}return-1}St.prototype.add=function(t,e,n,i,r){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Ot(t,e,i,r);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Rt(e,this.src,o,!!i,r)).Z=n,t.push(e)),e};var Lt="closure_lm_"+(1e6*Math.random()|0),Dt={};function Pt(t,e,n,i,r){if(i&&i.once)return function t(e,n,i,r,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);return null}return i=Ft(i),e&&e[Tt]?e.wa(n,i,L(r)?!!r.capture:!!r,o):Vt(e,n,i,!0,r,o)}(t,e,n,i,r);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Pt(t,e[o],n,i,r);return null}return n=Ft(n),t&&t[Tt]?t.va(e,n,L(i)?!!i.capture:!!i,r):Vt(t,e,n,!1,i,r)}function Vt(t,e,n,i,r,o){if(!e)throw Error("Invalid event type");var s=L(r)?!!r.capture:!!r;if(s&&!mt)return null;var u,a,h=xt(t);if(h||(t[Lt]=h=new St(t)),(n=h.add(e,n,i,s,o)).proxy)return n;if(u=qt,i=a=mt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=i).src=t,i.listener=n,t.addEventListener)bt||(r=s),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(Ut(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function Ct(t){var e,n,i;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Tt]?_t(e.c,t):(n=t.type,i=t.proxy,e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(Ut(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=xt(e))?(_t(n,t),0==n.b&&(n.src=null,e[Lt]=null)):kt(t)))}function Ut(t){return t in Dt?Dt[t]:Dt[t]="on"+t}function Mt(t,e){var n=t.listener,i=t.ca||t.src;return t.Z&&Ct(t),n.call(i,e)}function qt(t,e){if(t.Y)return!0;if(mt)return Mt(t,new It(e,this));if(!e)t:{e=["window","event"];for(var n=k,i=0;i<e.length;i++)if(null==(n=n[e[i]])){e=null;break t}e=n}return Mt(t,e=new It(e,this))}function xt(t){return(t=t[Lt])instanceof St?t:null}var jt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ft(e){return"function"==_(e)?e:(e[jt]||(e[jt]=function(t){return e.handleEvent(t)}),e[jt])}function Bt(){j.call(this),this.c=new St(this),(this.J=this).C=null}function Gt(t,e,n,i){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var r=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&_t(t.c,a),r=!1!==s.call(u,i)&&r)}return r&&!i.defaultPrevented}x(Bt,j),Bt.prototype[Tt]=!0,(N=Bt.prototype).addEventListener=function(t,e,n,i){Pt(this,t,e,n,i)},N.removeEventListener=function(t,e,n,i){!function t(e,n,i,r,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);else r=L(r)?!!r.capture:!!r,i=Ft(i),e&&e[Tt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(i=Ot(s=e.a[n],i,r,o))&&(kt(s[i]),Array.prototype.splice.call(s,i,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&xt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Ot(n,i,r,o)),(i=-1<e?n[e]:null)&&Ct(i))}(this,t,e,n,i)},N.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var i=t.type||t;if("string"==typeof t?t=new Et(t,n):t instanceof Et?t.target=t.target||n:(s=t,et(t=new Et(i,n),s)),s=!0,e)for(var r=e.length-1;0<=r;r--)var o=t.a=e[r],s=Gt(o,i,!0,t)&&s;if(s=Gt(o=t.a=n,i,!0,t)&&s,s=Gt(o,i,!1,t)&&s,e)for(r=0;r<e.length;r++)s=Gt(o=t.a=e[r],i,!1,t)&&s;return s},N.G=function(){if(Bt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],i=0;i<n.length;i++)kt(n[i]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,i){return this.c.add(String(t),e,!1,n,i)},N.wa=function(t,e,n,i){return this.c.add(String(t),e,!0,n,i)};var zt=k.JSON.stringify;function $t(){this.b=this.a=null}var Wt,Ht=(Qt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Qt(function(){return new Xt},function(t){t.reset()},100));function Qt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Xt(){this.next=this.b=this.a=null}function Yt(t,e){var n;Wt||(n=k.Promise.resolve(void 0),Wt=function(){n.then(Zt)}),Kt||(Wt(),Kt=!0),Jt.add(t,e)}$t.prototype.add=function(t,e){var n=Ht.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Xt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Kt=!(Xt.prototype.reset=function(){this.next=this.b=this.a=null}),Jt=new $t;function Zt(){for(var t,e,n;n=e=void 0,n=null,(e=Jt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){k.setTimeout(function(){throw t},0)}(t)}var i=Ht;i.g(t),i.b<i.f&&(i.b++,t.next=i.a,i.a=t)}Kt=!1}function te(t,e){Bt.call(this),this.b=t||1,this.a=e||k,this.f=U(this.Ya,this),this.g=q()}function ee(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ne(t,e,n){if("function"==_(t))n&&(t=U(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=U(t.handleEvent,t)}return 2147483647<Number(e)?-1:k.setTimeout(t,e||0)}x(te,Bt),(N=te.prototype).aa=!1,N.M=null,N.Ya=function(){var t;this.aa&&(0<(t=q()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(ee(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=q())},N.G=function(){te.S.G.call(this),ee(this),delete this.a};var ie,re,oe,se=(A(re=ae,oe=ie=j),re.prototype=null===oe?Object.create(oe):(ue.prototype=oe.prototype,new ue),ae.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ne(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ae.prototype.G=function(){ie.prototype.G.call(this),this.a&&(k.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ae);function ue(){this.constructor=re}function ae(t,e,n){var i=ie.call(this)||this;return i.g=null!=n?t.bind(n):t,i.h=e,i.b=null,i.c=!1,i.a=null,i}function he(t){j.call(this),this.b=t,this.a={}}x(he,j);var ce=[];function le(t,e,n,i){Array.isArray(n)||(n&&(ce[0]=n.toString()),n=ce);for(var r=0;r<n.length;r++){var o=Pt(e,n[r],i||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function fe(t){J(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ct(t)},t),t.a={}}function pe(){this.a=!0}function de(t,e,n,i){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(i.length<2)){var r=i[1];if(Array.isArray(r)&&!(r.length<1)){var o=r[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<r.length;s++)r[s]=""}}}return zt(n)}catch(t){return e}}(t,n)+(i?" "+i:"")})}he.prototype.G=function(){he.S.G.call(this),fe(this)},he.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},pe.prototype.info=function(){};var ye=null;function ve(){return ye=ye||new Bt}function ge(t){Et.call(this,"serverreachability",t)}function me(){var t=ve();t.dispatchEvent(new ge(t))}function we(t){Et.call(this,"statevent",t)}function be(){var t=ve();t.dispatchEvent(new we(t))}function Ee(t){Et.call(this,"timingevent",t)}function Ie(t,e){if("function"!=_(t))throw Error("Fn must not be null and must be a function");return k.setTimeout(function(){t()},e)}x(ge,Et),x(we,Et),x(Ee,Et);var Ae={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Te={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Ne(){}function Re(t){var e;return(e=t.a)||(e=t.a={}),e}function ke(){}Ne.prototype.a=null;var Se,_e={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Oe(){Et.call(this,"d")}function Le(){Et.call(this,"c")}function De(){}function Pe(t,e,n,i){this.g=t,this.c=e,this.f=n,this.T=i||1,this.J=new he(this),this.P=Ve,t=at?125:void 0,this.R=new te(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}x(Oe,Et),x(Le,Et),x(De,Ne),Se=new De;var Ve=45e3,Ce={},Ue={};function Me(t,e,n){t.H=1,t.i=on(Je(e)),t.j=n,t.I=!0,qe(t,null)}function qe(t,e){t.u=q(),je(t),t.l=Je(t.i);var s,u,a,h,c,l,n=t.l,i=t.T;Array.isArray(i)||(i=[String(i)]),mn(n.b,"t",i),t.D=0,t.a=li(t.g,t.g.C?e:null),0<t.O&&(t.F=new se(U(t.Ca,t,t.a),t.O)),le(t.J,t.a,"readystatechange",t.Wa),e=t.B?Z(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),me(),s=t.c,u=t.m,a=t.l,h=t.f,c=t.T,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var i,r,o=e[n].split("=");1<o.length&&(i=o[0],o=o[1],t=2<=(r=i.split("_")).length&&"type"==r[1]?t+(i+"=")+o+"&":t+(i+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function xe(t,e,n){for(var i,r,o,s,u=!0;!t.A&&t.D<n.length;){var a=(r=n,s=o=void 0,o=(i=t).D,-1==(s=r.indexOf("\n",o))?Ue:(o=Number(r.substring(o,s)),isNaN(o)?Ce:(s+=1)+o>r.length?Ue:(r=r.substr(s,o),i.D=s+o,r)));if(a==Ue){4==e&&(t.h=4,be(),u=!1),de(t.c,t.f,null,"[Incomplete Response]");break}if(a==Ce){t.h=4,be(),de(t.c,t.f,n,"[Invalid Chunk]"),u=!1;break}de(t.c,t.f,a,null),$e(t,a)}4==e&&0==n.length&&(t.h=1,be(),u=!1),t.b=t.b&&u,u?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),ii(e),e.F=!0)):(de(t.c,t.f,n,"[Invalid Chunked Response]"),ze(t),Ge(t))}function je(t){t.U=q()+t.P,Fe(t,t.P)}function Fe(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ie(U(t.Ua,t),e)}function Be(t){t.o&&(k.clearTimeout(t.o),t.o=null)}function Ge(t){0==t.g.v||t.A||si(t.g,t)}function ze(t){Be(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ee(t.R),fe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function $e(t,e){try{var n,i,r,o,s,u,a,h,c,l,f,p=t.g;if(0!=p.v&&(p.a==t||Nn(p.b,t)))if(p.I=t.N,!t.C&&Nn(p.b,t)&&3==p.v){try{var d=p.ka.a.parse(e)}catch(t){d=null}if(Array.isArray(d)&&3==d.length){var y=d;if(0==y[0]){t:if(!p.j){if(p.a){if(!(p.a.u+3e3<t.u))break t;oi(p),Qn(p)}ni(p),be()}}else p.oa=y[1],0<p.oa-p.P&&y[2]<37500&&p.H&&0==p.o&&!p.m&&(p.m=Ie(U(p.Ra,p),6e3));if(Tn(p.b)<=1&&p.ea){try{p.ea()}catch(t){}p.ea=void 0}}else ai(p,11)}else if(!t.C&&p.a!=t||oi(p),!$(e))for(e=d=p.ka.a.parse(e),d=0;d<e.length;d++)y=e[d],p.P=y[0],y=y[1],2==p.v?"c"==y[0]?(p.J=y[1],p.ga=y[2],null!=(n=y[3])&&(p.ha=n,p.c.info("VER="+p.ha)),null!=(i=y[4])&&(p.pa=i,p.c.info("SVER="+p.pa)),null!=(r=y[5])&&"number"==typeof r&&0<r&&(o=1.5*r,p.D=o,p.c.info("backChannelRequestTimeoutMs_="+o)),o=p,(s=t.a)&&(!(u=s.a?s.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(a=o.b).a&&(Q(u,"spdy")||Q(u,"quic")||Q(u,"h2"))&&(a.f=a.g,a.a=new Set,a.b&&(Rn(a,a.b),a.b=null)),!o.A||(h=s.a?s.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(o.na=h,rn(o.B,o.A,h))),p.v=3,p.f&&p.f.ta(),p.V&&(p.N=q()-t.u,p.c.info("Handshake RTT: "+p.N+"ms")),c=t,(o=p).la=ci(o,o.C?o.ga:null,o.fa),c.C?(kn(o.b,c),l=c,(f=o.D)&&l.setTimeout(f),l.o&&(Be(l),je(l)),o.a=c):ei(o),0<p.g.length&&Kn(p)):"stop"!=y[0]&&"close"!=y[0]||ai(p,7):3==p.v&&("stop"==y[0]||"close"==y[0]?"stop"==y[0]?ai(p,7):Hn(p):"noop"!=y[0]&&p.f&&p.f.sa(y),p.o=0);me()}catch(t){}}function We(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(O(t)||"string"==typeof t)B(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(O(t)||"string"==typeof t){n=[];for(var i=t.length,r=0;r<i;r++)n.push(r)}else for(r in n=[],i=0,t)n[i++]=r;r=(i=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(O(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t)).length;for(var o=0;o<r;o++)e.call(void 0,i[o],n&&n[o],t)}}function He(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof He)for(n=t.L(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function Qe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var i=t.a[e];Xe(t.b,i)&&(t.a[n++]=i),e++}t.a.length=n}if(t.c!=t.a.length){for(var r={},n=e=0;e<t.a.length;)Xe(r,i=t.a[e])||(r[t.a[n++]=i]=1),e++;t.a.length=n}}function Xe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=Pe.prototype).setTimeout=function(t){this.P=t},N.Wa=function(t){t=t.target;var e=this.F;e&&3==Gn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=Gn(this.a),n=this.a.ua();this.a.X();if(!(e<3||3==e&&!at&&!this.a.$())){this.A||4!=e||7==n||me(),Be(this);var i=this.a.X();this.N=i;var r=this.a.$();if(this.b=200==i,a=this.c,h=this.m,c=this.l,l=this.f,f=this.T,p=e,d=i,a.info(function(){return"XMLHTTP RESP ("+l+") [ attempt "+f+"]: "+h+"\n"+c+"\n"+p+" "+d}),this.b){if(this.V&&!this.C){e:{if(this.a){var o,s=this.a;if((o=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!$(o)){var u=o;break e}}u=null}if(!u){this.b=!1,this.h=3,be(),ze(this),Ge(this);break t}de(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,$e(this,u)}this.I?(xe(this,e,r),at&&this.b&&3==e&&(le(this.J,this.R,"tick",this.Va),this.R.start())):(de(this.c,this.f,r,null),$e(this,r)),4==e&&ze(this),this.b&&!this.A&&(4==e?si(this.g,this):(this.b=!1,je(this)))}else 400==i&&0<r.indexOf("Unknown SID")?this.h=3:this.h=0,be(),ze(this),Ge(this)}}}catch(t){}var a,h,c,l,f,p,d},N.Va=function(){var t,e;this.a&&(t=Gn(this.a),e=this.a.$(),this.D<e.length&&(Be(this),xe(this,t,e),this.b&&4!=t&&je(this)))},N.cancel=function(){this.A=!0,ze(this)},N.Ua=function(){this.o=null;var t,e,n=q();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(me(),be()),ze(this),this.h=2,Ge(this)):Fe(this,this.U-n)},(N=He.prototype).K=function(){Qe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return Qe(this),this.a.concat()},N.get=function(t,e){return Xe(this.b,t)?this.b[t]:e},N.set=function(t,e){Xe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),i=0;i<n.length;i++){var r=n[i],o=this.get(r);t.call(e,o,r,this)}};var Ye=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ke(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ke?(this.a=void 0!==e?e:t.a,Ze(this,t.f),this.j=t.j,tn(this,t.c),en(this,t.h),this.g=t.g,e=t.b,(n=new dn).c=e.c,e.a&&(n.a=new He(e.a),n.b=e.b),nn(this,n),this.i=t.i):t&&(n=String(t).match(Ye))?(this.a=!!e,Ze(this,n[1]||"",!0),this.j=sn(n[2]||""),tn(this,n[3]||"",!0),en(this,n[4]),this.g=sn(n[5]||"",!0),nn(this,n[6]||"",!0),this.i=sn(n[7]||"")):(this.a=!!e,this.b=new dn(null,this.a))}function Je(t){return new Ke(t)}function Ze(t,e,n){t.f=n?sn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function tn(t,e,n){t.c=n?sn(e,!0):e}function en(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function nn(t,e,n){var i,r;e instanceof dn?(t.b=e,i=t.b,(r=t.a)&&!i.f&&(yn(i),i.c=null,i.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(vn(this,e),mn(this,n,t))},i)),i.f=r):(n||(e=un(e,fn)),t.b=new dn(e,t.a))}function rn(t,e,n){t.b.set(e,n)}function on(t){return rn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^q()).toString(36)),t}function sn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function un(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,an),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function an(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ke.prototype.toString=function(){var t=[],e=this.f;e&&t.push(un(e,hn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(un(e,hn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(un(n,"/"==n.charAt(0)?ln:cn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",un(n,pn)),t.join("")};var hn=/[#\/\?@]/g,cn=/[#\?:]/g,ln=/[#\?]/g,fn=/[#\?@]/g,pn=/#/g;function dn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function yn(u){u.a||(u.a=new He,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,i=t[e].indexOf("="),r=null;0<=i?(n=t[e].substring(0,i),r=t[e].substring(i+1)):n=t[e],o=n,s=r?decodeURIComponent(r.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function vn(t,e){yn(t),e=wn(t,e),Xe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Xe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Qe(t)))}function gn(t,e){return yn(t),e=wn(t,e),Xe(t.a.b,e)}function mn(t,e,n){vn(t,e),0<n.length&&(t.c=null,t.a.set(wn(t,e),z(n)),t.b+=n.length)}function wn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function bn(t,e){this.b=t,this.a=e}function En(t){this.g=t||In,t=k.PerformanceNavigationTiming?0<(t=k.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(k.ia&&k.ia.ya&&k.ia.ya()&&k.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(N=dn.prototype).add=function(t,e){yn(this),this.c=null,t=wn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,i){yn(this),this.a.forEach(function(t,e){B(t,function(t){n.call(i,t,e,this)},this)},this)},N.L=function(){yn(this);for(var t=this.a.K(),e=this.a.L(),n=[],i=0;i<e.length;i++)for(var r=t[i],o=0;o<r.length;o++)n.push(e[i]);return n},N.K=function(t){yn(this);var e=[];if("string"==typeof t)gn(this,t)&&(e=G(e,this.a.get(wn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},N.set=function(t,e){return yn(this),this.c=null,gn(this,t=wn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var i=e[n],r=encodeURIComponent(String(i)),i=this.K(i),o=0;o<i.length;o++){var s=r;""!==i[o]&&(s+="="+encodeURIComponent(String(i[o]))),t.push(s)}return this.c=t.join("&")};var In=10;function An(t){return t.b||t.a&&t.a.size>=t.f}function Tn(t){return t.b?1:t.a?t.a.size:0}function Nn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Rn(t,e){t.a?t.a.add(e):t.b=e}function kn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Sn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var i=t.c;try{for(var r=T(t.a.values()),o=r.next();!o.done;o=r.next())var s=o.value,i=i.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return i}function _n(){}function On(){this.a=new _n}function Ln(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}En.prototype.cancel=function(){var t,e;if(this.c=Sn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=T(this.a.values()),i=n.next();!i.done;i=n.next())i.value.cancel()}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},_n.prototype.stringify=function(t){return k.JSON.stringify(t,void 0)},_n.prototype.parse=function(t){return k.JSON.parse(t,void 0)};var Dn=k.JSON.parse;function Pn(t){Bt.call(this),this.headers=new He,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Vn,this.D=this.F=!1}x(Pn,Bt);var Vn="",Cn=/^https?$/i,Un=["POST","PUT"];function Mn(t){return"content-type"==t.toLowerCase()}function qn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,xn(t),Fn(t)}function xn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function jn(t){if(t.b&&(!t.s[1]||4!=Gn(t)||2!=t.X()))if(t.l&&4==Gn(t))ne(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==Gn(t)){t.b=!1;try{var e,n,i,r,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(r=String(t.B).match(Ye)[1]||null)&&k.self&&k.self.location&&(r=(i=k.self.location.protocol).substr(0,i.length-1)),n=!Cn.test(r?r.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Gn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",xn(t)}}finally{Fn(t)}}}function Fn(t,e){if(t.a){Bn(t);var n=t.a,i=t.s[0]?S:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=i}catch(t){}}}function Bn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(k.clearTimeout(t.m),t.m=null)}function Gn(t){return t.a?t.a.readyState:0}function zn(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}var r;i||(r="",J(n,function(t,e){r+=e,r+=":",r+=t,r+="\r\n"}),n=r,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):rn(t,e,n))}function $n(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Wn(t){this.pa=0,this.g=[],this.c=new pe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=$n("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=$n("baseRetryDelayMs",5e3,t),this.Ma=$n("retryDelaySeedMs",1e4,t),this.Ja=$n("forwardChannelMaxRetries",2,t),this.ma=$n("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new En(t&&t.concurrentRequestLimit),this.ka=new On,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Hn(t){var e,n;Xn(t),3==t.v&&(e=t.R++,rn(n=Je(t.B),"SID",t.J),rn(n,"RID",e),rn(n,"TYPE","terminate"),Zn(t,n),(e=new Pe(t,t.c,e,void 0)).H=2,e.i=on(Je(n)),n=!1,k.navigator&&k.navigator.sendBeacon&&(n=k.navigator.sendBeacon(e.i.toString(),"")),!n&&k.Image&&((new Image).src=e.i,n=!0),n||(e.a=li(e.g,null),e.a.ba(e.i)),e.u=q(),je(e)),hi(t)}function Qn(t){t.a&&(ii(t),t.a.cancel(),t.a=null)}function Xn(t){Qn(t),t.j&&(k.clearTimeout(t.j),t.j=null),oi(t),t.b.cancel(),t.h&&("number"==typeof t.h&&k.clearTimeout(t.h),t.h=null)}function Yn(t,e){t.g.push(new bn(t.La++,e)),3==t.v&&Kn(t)}function Kn(t){An(t.b)||t.h||(t.h=!0,Yt(t.Ba,t),t.u=0)}function Jn(t,e){var n=e?e.f:t.R++,i=Je(t.B);rn(i,"SID",t.J),rn(i,"RID",n),rn(i,"AID",t.P),Zn(t,i),t.i&&t.l&&zn(i,t.i,t.l),n=new Pe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=ti(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Rn(t.b,n),Me(n,i,e)}function Zn(t,n){t.f&&We({},function(t,e){rn(n,e,t)})}function ti(t,e,n){n=Math.min(t.g.length,n);var i=t.f?U(t.f.Ha,t.f,t):null;t:for(var r=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=r[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=r[a].b,c=r[a].a;if((h-=o)<0)o=Math.max(0,r[a].b-100),u=!1;else try{!function(t,i){var r="req"+h+"_"||"";try{We(t,function(t,e){var n=t;L(t)&&(n=zt(t)),i.push(r+e+"="+encodeURIComponent(n))})}catch(t){throw i.push(r+"type="+encodeURIComponent("_badmap")),t}}(c,s)}catch(t){i&&i(c)}}if(u){i=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,i}function ei(t){t.a||t.j||(t.U=1,Yt(t.Aa,t),t.o=0)}function ni(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=Ie(U(t.Aa,t),ui(t,t.o)),t.o++,1)}function ii(t){null!=t.s&&(k.clearTimeout(t.s),t.s=null)}function ri(t){t.a=new Pe(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Je(t.la);rn(e,"RID","rpc"),rn(e,"SID",t.J),rn(e,"CI",t.H?"0":"1"),rn(e,"AID",t.P),Zn(t,e),rn(e,"TYPE","xmlhttp"),t.i&&t.l&&zn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=on(Je(e)),n.j=null,n.I=!0,qe(n,t)}function oi(t){null!=t.m&&(k.clearTimeout(t.m),t.m=null)}function si(t,e){var n,i=null;if(t.a==e){oi(t),ii(t),t.a=null;var r=2}else{if(!Nn(t.b,e))return;i=e.s,kn(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)1==r?(i=e.j?e.j.length:0,e=q()-e.u,n=t.u,(r=ve()).dispatchEvent(new Ee(r)),Kn(t)):ei(t);else if(3==(n=e.h)||0==n&&0<t.I||!(1==r&&function(t,e){if(!(Tn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=Ie(U(t.Ba,t,e),ui(t,t.u)),t.u++,1}}(t,e)||2==r&&ni(t)))switch(i&&0<i.length&&(e=t.b,e.c=e.c.concat(i)),n){case 1:ai(t,5);break;case 4:ai(t,10);break;case 3:ai(t,6);break;default:ai(t,2)}}function ui(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function ai(t,e){var n,i,r,o,s,u;t.c.info("Error code "+e),2==e?(n=null,t.f&&(n=null),i=U(t.Xa,t),n||(n=new Ke("//www.google.com/images/cleardot.gif"),k.location&&"http"==k.location.protocol||Ze(n,"https"),on(n)),r=n.toString(),o=i,u=new pe,k.Image?((s=new Image).onload=M(Ln,u,s,"TestLoadImage: loaded",!0,o),s.onerror=M(Ln,u,s,"TestLoadImage: error",!1,o),s.onabort=M(Ln,u,s,"TestLoadImage: abort",!1,o),s.ontimeout=M(Ln,u,s,"TestLoadImage: timeout",!1,o),k.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=r):o(!1)):be(),t.v=0,t.f&&t.f.ra(e),hi(t),Xn(t)}function hi(t){t.v=0,t.I=-1,t.f&&(0==Sn(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function ci(t,e,n){var i,r,o,s,u,a,h,c=(i=n)instanceof Ke?Je(i):new Ke(i,void 0);return""!=c.c?(e&&tn(c,e+"."+c.c),en(c,c.h)):(o=(r=k.location).protocol,s=e?e+"."+r.hostname:r.hostname,u=+r.port,a=n,h=new Ke(null,void 0),o&&Ze(h,o),s&&tn(h,s),u&&en(h,u),a&&(h.g=a),c=h),t.W&&J(t.W,function(t,e){rn(c,e,t)}),e=t.A,n=t.na,e&&n&&rn(c,e,n),rn(c,"VER",t.ha),Zn(t,c),c}function li(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Pn(t.Ka)).F=t.C,e}function fi(){}function pi(){if(st&&!(10<=Number(gt)))throw Error("Environmental error: no available transport.")}function di(t,e){Bt.call(this),this.a=new Wn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!$(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!$(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new gi(this)}function yi(t){Oe.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function vi(){Le.call(this),this.status=1}function gi(t){this.a=t}(N=Pn.prototype).ba=function(t,e,n,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Re(this.H):Re(Se),this.a.onreadystatechange=U(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void qn(this,t)}t=n||"";var r,o=new He(this.headers);i&&We(i,function(t,e){o.set(e,t)}),i=function(t){t:{for(var e=Mn,n=t.length,i="string"==typeof t?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=k.FormData&&t instanceof k.FormData,0<=F(Un,e)&&!i&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Bn(this),0<this.o&&((this.D=(r=this.a,st&&vt(9)&&"number"==typeof r.timeout&&void 0!==r.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=U(this.xa,this)):this.m=ne(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){qn(this,t)}},N.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Fn(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Fn(this,!0)),Pn.S.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?jn(this):this.Ta())},N.Ta=function(){jn(this)},N.X=function(){try{return 2<Gn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Dn(e)}},N.ua=function(){return this.h},N.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=Wn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Pe(this,this.c,t,void 0),i=this.l;if(this.O&&(i?et(i=Z(i),this.O):i=this.O),null===this.i&&(n.B=i),this.da)t:{for(var r=e=0;r<this.g.length;r++){var o=this.g[r];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=r;break t}if(4096===e||r===this.g.length-1){e=r+1;break t}}e=1e3}else e=1e3;e=ti(this,n,e),rn(r=Je(this.B),"RID",t),rn(r,"CVER",22),this.A&&rn(r,"X-HTTP-Session-Id",this.A),Zn(this,r),this.i&&i&&zn(r,this.i,i),Rn(this.b,n),this.Ga&&rn(r,"TYPE","init"),this.da?(rn(r,"$req",e),rn(r,"SID","null"),n.V=!0,Me(n,r,null)):Me(n,r,e),this.v=2}}else 3==this.v&&(t?Jn(this,t):0==this.g.length||An(this.b)||Jn(this))},N.Aa=function(){var t;this.j=null,ri(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Ie(U(this.Sa,this),t))},N.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Qn(this),ri(this))},N.Ra=function(){null!=this.m&&(this.m=null,Qn(this),ni(this),be())},N.Xa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),be()},(N=fi.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ha=function(){},pi.prototype.a=function(t,e){return new di(t,e)},x(di,Bt),(N=di.prototype).addEventListener=function(t,e,n,i){di.S.addEventListener.call(this,t,e,n,i)},N.removeEventListener=function(t,e,n,i){di.S.removeEventListener.call(this,t,e,n,i)},N.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;be(),t.fa=e,t.W=n||{},t.H=t.T,t.B=ci(t,null,t.fa),Kn(t)},N.close=function(){Hn(this.a)},N.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Yn(this.a,e)):this.g?((e={}).__data__=zt(t),Yn(this.a,e)):Yn(this.a,t)},N.G=function(){this.a.f=null,delete this.f,Hn(this.a),delete this.a,di.S.G.call(this)},x(yi,Oe),x(vi,Le),x(gi,fi),gi.prototype.ta=function(){this.a.dispatchEvent("a")},gi.prototype.sa=function(t){this.a.dispatchEvent(new yi(t))},gi.prototype.ra=function(t){this.a.dispatchEvent(new vi)},gi.prototype.qa=function(){this.a.dispatchEvent("b")},pi.prototype.createWebChannel=pi.prototype.a,di.prototype.send=di.prototype.Pa,di.prototype.open=di.prototype.Oa,Ae.NO_ERROR=0,Ae.TIMEOUT=8,Ae.HTTP_ERROR=6,Te.COMPLETE="complete",(ke.EventType=_e).OPEN="a",_e.CLOSE="b",_e.ERROR="c",_e.MESSAGE="d",Bt.prototype.listen=Bt.prototype.va,Pn.prototype.listenOnce=Pn.prototype.wa,Pn.prototype.getLastError=Pn.prototype.Qa,Pn.prototype.getLastErrorCode=Pn.prototype.ua,Pn.prototype.getStatus=Pn.prototype.X,Pn.prototype.getResponseJson=Pn.prototype.Na,Pn.prototype.getResponseText=Pn.prototype.$,Pn.prototype.send=Pn.prototype.ba;var mi={createWebChannelTransport:function(){return new pi},ErrorCode:Ae,EventType:Te,WebChannel:ke,XhrIo:Pn},wi=mi.createWebChannelTransport,bi=mi.ErrorCode,Ei=mi.EventType,Ii=mi.WebChannel,Ai=mi.XhrIo,Ti=(Ni.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Ni.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Ni.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Ni);function Ni(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Ri=new l("@firebase/firestore");function ki(){return Ri.logLevel}function Si(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];Ri.logLevel<=u.DEBUG&&(e=n.map(Li),Ri.debug.apply(Ri,r(["Firestore (7.19.0): "+t],e)))}function _i(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];Ri.logLevel<=u.ERROR&&(e=n.map(Li),Ri.error.apply(Ri,r(["Firestore (7.19.0): "+t],e)))}function Oi(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];Ri.logLevel<=u.WARN&&(e=n.map(Li),Ri.warn.apply(Ri,r(["Firestore (7.19.0): "+t],e)))}function Li(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Di(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (7.19.0) INTERNAL ASSERTION FAILED: "+t;throw _i(e),new Error(e)}function Pi(t){t||Di()}var Vi=(Ci.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var i=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),r=0;r<i.length;++r)n.length<20&&i[r]<e&&(n+=t.charAt(i[r]%t.length));return n},Ci);function Ci(){}function Ui(t,e){return t<e?-1:e<t?1:0}function Mi(t,n,i){return t.length===n.length&&t.every(function(t,e){return i(t,n[e])})}function qi(t,e,n,i,r){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=i,this.forceLongPolling=r}var xi=(Object.defineProperty(ji.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),ji.prototype.isEqual=function(t){return t instanceof ji&&t.projectId===this.projectId&&t.database===this.database},ji.prototype.o=function(t){return Ui(this.projectId,t.projectId)||Ui(this.database,t.database)},ji);function ji(t,e){this.projectId=t,this.database=e||"(default)"}function Fi(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Bi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Gi(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var zi,$i,Wi,Hi=(cr.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var i=0,r=n;i<r.length;i++){var o=r[i],s=o[0],u=o[1];if(this.u(s,t))return u}},cr.prototype.has=function(t){return void 0!==this.get(t)},cr.prototype.set=function(t,e){var n=this.h(t),i=this.l[n];if(void 0!==i){for(var r=0;r<i.length;r++)if(this.u(i[r][0],t))return void(i[r]=[t,e]);i.push([t,e])}else this.l[n]=[[t,e]]},cr.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var i=0;i<n.length;i++)if(this.u(n[i][0],t))return 1===n.length?delete this.l[e]:n.splice(i,1),!0;return!1},cr.prototype.forEach=function(u){Bi(this.l,function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n],o=r[0],s=r[1];u(o,s)}})},cr.prototype._=function(){return Gi(this.l)},cr),Qi={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Xi=(n(hr,Wi=Error),hr),Yi=(ar.now=function(){return ar.fromMillis(Date.now())},ar.fromDate=function(t){return ar.fromMillis(t.getTime())},ar.fromMillis=function(t){var e=Math.floor(t/1e3);return new ar(e,1e6*(t-1e3*e))},ar.prototype.toDate=function(){return new Date(this.toMillis())},ar.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},ar.prototype.m=function(t){return this.seconds===t.seconds?Ui(this.nanoseconds,t.nanoseconds):Ui(this.seconds,t.seconds)},ar.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},ar.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},ar.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},ar.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},ar),Ki=(ur.T=function(t){return new ur(t)},ur.min=function(){return new ur(new Yi(0,0))},ur.prototype.o=function(t){return this.timestamp.m(t.timestamp)},ur.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},ur.prototype.I=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},ur.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},ur.prototype.R=function(){return this.timestamp},ur),Ji=(Object.defineProperty(sr.prototype,"length",{get:function(){return this.A},enumerable:!1,configurable:!0}),sr.prototype.isEqual=function(t){return 0===sr.P(this,t)},sr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof sr?t.forEach(function(t){e.push(t)}):e.push(t),this.V(e)},sr.prototype.limit=function(){return this.offset+this.length},sr.prototype.p=function(t){return t=void 0===t?1:t,this.V(this.segments,this.offset+t,this.length-t)},sr.prototype.g=function(){return this.V(this.segments,this.offset,this.length-1)},sr.prototype.v=function(){return this.segments[this.offset]},sr.prototype.S=function(){return this.get(this.length-1)},sr.prototype.get=function(t){return this.segments[this.offset+t]},sr.prototype._=function(){return 0===this.length},sr.prototype.C=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},sr.prototype.D=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},sr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},sr.prototype.F=function(){return this.segments.slice(this.offset,this.limit())},sr.P=function(t,e){for(var n=Math.min(t.length,e.length),i=0;i<n;i++){var r=t.get(i),o=e.get(i);if(r<o)return-1;if(o<r)return 1}return t.length<e.length?-1:t.length>e.length?1:0},sr),Zi=(n(or,$i=Ji),or.prototype.V=function(t,e,n){return new or(t,e,n)},or.prototype.N=function(){return this.F().join("/")},or.prototype.toString=function(){return this.N()},or.$=function(t){if(0<=t.indexOf("//"))throw new Xi(Qi.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new or(t.split("/").filter(function(t){return 0<t.length}))},or.k=function(){return new or([])},or),tr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,er=(n(rr,zi=Ji),rr.prototype.V=function(t,e,n){return new rr(t,e,n)},rr.O=function(t){return tr.test(t)},rr.prototype.N=function(){return this.F().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),rr.O(t)||(t="`"+t+"`"),t}).join(".")},rr.prototype.toString=function(){return this.N()},rr.prototype.L=function(){return 1===this.length&&"__name__"===this.get(0)},rr.M=function(){return new rr(["__name__"])},rr.q=function(t){for(var e=[],n="",i=0,r=function(){if(0===n.length)throw new Xi(Qi.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new Xi(Qi.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Xi(Qi.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,i+=2}else"`"===s?o=!o:"."!==s||o?n+=s:r(),i++}if(r(),o)throw new Xi(Qi.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new rr(e)},rr.k=function(){return new rr([])},rr),nr=(ir.U=function(t){return new ir(Zi.$(t))},ir.B=function(t){return new ir(Zi.$(t).p(5))},ir.prototype.W=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ir.prototype.isEqual=function(t){return null!==t&&0===Zi.P(this.path,t.path)},ir.prototype.toString=function(){return this.path.toString()},ir.P=function(t,e){return Zi.P(t.path,e.path)},ir.j=function(t){return t.length%2==0},ir.G=function(t){return new ir(new Zi(t.slice()))},ir);function ir(t){this.path=t}function rr(){return null!==zi&&zi.apply(this,arguments)||this}function or(){return null!==$i&&$i.apply(this,arguments)||this}function sr(t,e,n){void 0===e?e=0:e>t.length&&Di(),void 0===n?n=t.length-e:n>t.length-e&&Di(),this.segments=t,this.offset=e,this.A=n}function ur(t){this.timestamp=t}function ar(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Xi(Qi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Xi(Qi.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Xi(Qi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Xi(Qi.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function hr(t,e){var n=this;return(n=Wi.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function cr(t,e){this.h=t,this.u=e,this.l={}}function lr(t){return null==t}function fr(t){return-0===t&&1/t==-1/0}var pr=function(t,e,n,i,r,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=o,this.endAt=s,this.K=null};function dr(t,e,n,i,r,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),new pr(t,e,n,i,r,o,s)}function yr(t){var e,n=t;return null===n.K&&(e=n.path.N(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.N()+e.op.toString()+mo(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.N()+e.dir;var e}).join(","),lr(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=ju(n.startAt)),n.endAt&&(e+="|ub:",e+=ju(n.endAt)),n.K=e),n.K}function vr(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,i,r=0;r<t.orderBy.length;r++)if(n=t.orderBy[r],i=e.orderBy[r],n.dir!==i.dir||!n.field.isEqual(i.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!po(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Bu(t.startAt,e.startAt)&&Bu(t.endAt,e.endAt)}function gr(t){return nr.j(t.path)&&null===t.collectionGroup&&0===t.filters.length}var mr=(wr.fromBase64String=function(t){return new wr(atob(t))},wr.fromUint8Array=function(t){return new wr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},wr.prototype.toBase64=function(){return t=this.H,btoa(t);var t},wr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.H)},wr.prototype.Y=function(){return 2*this.H.length},wr.prototype.o=function(t){return Ui(this.H,t.H)},wr.prototype.isEqual=function(t){return this.H===t.H},wr);function wr(t){this.H=t}function br(t){this.count=t}mr.J=new mr("");var Er,Ir,Ar=(Tr.prototype.tt=function(t){return new Tr(this.target,this.targetId,this.X,t,this.Z,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Tr.prototype.et=function(t,e){return new Tr(this.target,this.targetId,this.X,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Tr.prototype.nt=function(t){return new Tr(this.target,this.targetId,this.X,this.sequenceNumber,this.Z,t,this.resumeToken)},Tr);function Tr(t,e,n,i,r,o,s){void 0===r&&(r=Ki.min()),void 0===o&&(o=Ki.min()),void 0===s&&(s=mr.J),this.target=t,this.targetId=e,this.X=n,this.sequenceNumber=i,this.Z=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Nr(t){switch(t){case Qi.OK:return Di(),0;case Qi.CANCELLED:case Qi.UNKNOWN:case Qi.DEADLINE_EXCEEDED:case Qi.RESOURCE_EXHAUSTED:case Qi.INTERNAL:case Qi.UNAVAILABLE:case Qi.UNAUTHENTICATED:return;case Qi.INVALID_ARGUMENT:case Qi.NOT_FOUND:case Qi.ALREADY_EXISTS:case Qi.PERMISSION_DENIED:case Qi.FAILED_PRECONDITION:case Qi.ABORTED:case Qi.OUT_OF_RANGE:case Qi.UNIMPLEMENTED:case Qi.DATA_LOSS:return 1;default:return Di(),0}}function Rr(t){if(void 0===t)return _i("GRPC error has no .code"),Qi.UNKNOWN;switch(t){case Er.OK:return Qi.OK;case Er.CANCELLED:return Qi.CANCELLED;case Er.UNKNOWN:return Qi.UNKNOWN;case Er.DEADLINE_EXCEEDED:return Qi.DEADLINE_EXCEEDED;case Er.RESOURCE_EXHAUSTED:return Qi.RESOURCE_EXHAUSTED;case Er.INTERNAL:return Qi.INTERNAL;case Er.UNAVAILABLE:return Qi.UNAVAILABLE;case Er.UNAUTHENTICATED:return Qi.UNAUTHENTICATED;case Er.INVALID_ARGUMENT:return Qi.INVALID_ARGUMENT;case Er.NOT_FOUND:return Qi.NOT_FOUND;case Er.ALREADY_EXISTS:return Qi.ALREADY_EXISTS;case Er.PERMISSION_DENIED:return Qi.PERMISSION_DENIED;case Er.FAILED_PRECONDITION:return Qi.FAILED_PRECONDITION;case Er.ABORTED:return Qi.ABORTED;case Er.OUT_OF_RANGE:return Qi.OUT_OF_RANGE;case Er.UNIMPLEMENTED:return Qi.UNIMPLEMENTED;case Er.DATA_LOSS:return Qi.DATA_LOSS;default:return Di()}}(Ir=Er=Er||{})[Ir.OK=0]="OK",Ir[Ir.CANCELLED=1]="CANCELLED",Ir[Ir.UNKNOWN=2]="UNKNOWN",Ir[Ir.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ir[Ir.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ir[Ir.NOT_FOUND=5]="NOT_FOUND",Ir[Ir.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ir[Ir.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ir[Ir.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ir[Ir.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ir[Ir.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ir[Ir.ABORTED=10]="ABORTED",Ir[Ir.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ir[Ir.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ir[Ir.INTERNAL=13]="INTERNAL",Ir[Ir.UNAVAILABLE=14]="UNAVAILABLE",Ir[Ir.DATA_LOSS=15]="DATA_LOSS";var kr=(Dr.prototype.st=function(t,e){return new Dr(this.P,this.root.st(t,e,this.P).copy(null,null,_r.it,null,null))},Dr.prototype.remove=function(t){return new Dr(this.P,this.root.remove(t,this.P).copy(null,null,_r.it,null,null))},Dr.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Dr.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var i=this.P(t,n.key);if(0===i)return e+n.left.size;n=i<0?n.left:(e+=n.left.size+1,n.right)}return-1},Dr.prototype._=function(){return this.root._()},Object.defineProperty(Dr.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Dr.prototype.rt=function(){return this.root.rt()},Dr.prototype.ot=function(){return this.root.ot()},Dr.prototype.ht=function(t){return this.root.ht(t)},Dr.prototype.forEach=function(n){this.ht(function(t,e){return n(t,e),!1})},Dr.prototype.toString=function(){var n=[];return this.ht(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Dr.prototype.at=function(t){return this.root.at(t)},Dr.prototype.ut=function(){return new Sr(this.root,null,this.P,!1)},Dr.prototype.ct=function(t){return new Sr(this.root,t,this.P,!1)},Dr.prototype.lt=function(){return new Sr(this.root,null,this.P,!0)},Dr.prototype._t=function(t){return new Sr(this.root,t,this.P,!0)},Dr),Sr=(Lr.prototype.wt=function(){var t=this.dt.pop(),e={key:t.key,value:t.value};if(this.ft)for(t=t.left;!t._();)this.dt.push(t),t=t.right;else for(t=t.right;!t._();)this.dt.push(t),t=t.left;return e},Lr.prototype.Tt=function(){return 0<this.dt.length},Lr.prototype.Et=function(){if(0===this.dt.length)return null;var t=this.dt[this.dt.length-1];return{key:t.key,value:t.value}},Lr),_r=(Or.prototype.copy=function(t,e,n,i,r){return new Or(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)},Or.prototype._=function(){return!1},Or.prototype.ht=function(t){return this.left.ht(t)||t(this.key,this.value)||this.right.ht(t)},Or.prototype.at=function(t){return this.right.at(t)||t(this.key,this.value)||this.left.at(t)},Or.prototype.min=function(){return this.left._()?this:this.left.min()},Or.prototype.rt=function(){return this.min().key},Or.prototype.ot=function(){return this.right._()?this.key:this.right.ot()},Or.prototype.st=function(t,e,n){var i=this,r=n(t,i.key);return(i=r<0?i.copy(null,null,null,i.left.st(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.st(t,e,n))).It()},Or.prototype.Rt=function(){if(this.left._())return Or.EMPTY;var t=this;return t.left.At()||t.left.left.At()||(t=t.Pt()),(t=t.copy(null,null,null,t.left.Rt(),null)).It()},Or.prototype.remove=function(t,e){var n,i=this;if(e(t,i.key)<0)i.left._()||i.left.At()||i.left.left.At()||(i=i.Pt()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.At()&&(i=i.Vt()),i.right._()||i.right.At()||i.right.left.At()||(i=i.yt()),0===e(t,i.key)){if(i.right._())return Or.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.Rt())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.It()},Or.prototype.At=function(){return this.color},Or.prototype.It=function(){var t=this;return t.right.At()&&!t.left.At()&&(t=t.pt()),t.left.At()&&t.left.left.At()&&(t=t.Vt()),t.left.At()&&t.right.At()&&(t=t.gt()),t},Or.prototype.Pt=function(){var t=this.gt();return t.right.left.At()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Vt())).pt()).gt()),t},Or.prototype.yt=function(){var t=this.gt();return t.left.left.At()&&(t=(t=t.Vt()).gt()),t},Or.prototype.pt=function(){var t=this.copy(null,null,Or.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Or.prototype.Vt=function(){var t=this.copy(null,null,Or.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Or.prototype.gt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Or.prototype.vt=function(){var t=this.bt();return Math.pow(2,t)<=this.size+1},Or.prototype.bt=function(){if(this.At()&&this.left.At())throw Di();if(this.right.At())throw Di();var t=this.left.bt();if(t!==this.right.bt())throw Di();return t+(this.At()?0:1)},Or);function Or(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:Or.RED,this.left=null!=i?i:Or.EMPTY,this.right=null!=r?r:Or.EMPTY,this.size=this.left.size+1+this.right.size}function Lr(t,e,n,i){this.ft=i,this.dt=[];for(var r=1;!t._();)if(r=e?n(t.key,e):1,i&&(r*=-1),r<0)t=this.ft?t.left:t.right;else{if(0===r){this.dt.push(t);break}this.dt.push(t),t=this.ft?t.right:t.left}}function Dr(t,e){this.P=t,this.root=e||_r.EMPTY}function Pr(){this.size=0}_r.EMPTY=null,_r.RED=!0,_r.it=!1,_r.EMPTY=(Object.defineProperty(Pr.prototype,"key",{get:function(){throw Di()},enumerable:!1,configurable:!0}),Object.defineProperty(Pr.prototype,"value",{get:function(){throw Di()},enumerable:!1,configurable:!0}),Object.defineProperty(Pr.prototype,"color",{get:function(){throw Di()},enumerable:!1,configurable:!0}),Object.defineProperty(Pr.prototype,"left",{get:function(){throw Di()},enumerable:!1,configurable:!0}),Object.defineProperty(Pr.prototype,"right",{get:function(){throw Di()},enumerable:!1,configurable:!0}),Pr.prototype.copy=function(t,e,n,i,r){return this},Pr.prototype.st=function(t,e,n){return new _r(t,e)},Pr.prototype.remove=function(t,e){return this},Pr.prototype._=function(){return!0},Pr.prototype.ht=function(t){return!1},Pr.prototype.at=function(t){return!1},Pr.prototype.rt=function(){return null},Pr.prototype.ot=function(){return null},Pr.prototype.At=function(){return!1},Pr.prototype.vt=function(){return!0},Pr.prototype.bt=function(){return 0},new Pr);var Vr=(qr.prototype.has=function(t){return null!==this.data.get(t)},qr.prototype.first=function(){return this.data.rt()},qr.prototype.last=function(){return this.data.ot()},Object.defineProperty(qr.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),qr.prototype.indexOf=function(t){return this.data.indexOf(t)},qr.prototype.forEach=function(n){this.data.ht(function(t,e){return n(t),!1})},qr.prototype.St=function(t,e){for(var n=this.data.ct(t[0]);n.Tt();){var i=n.wt();if(0<=this.P(i.key,t[1]))return;e(i.key)}},qr.prototype.Ct=function(t,e){for(var n=void 0!==e?this.data.ct(e):this.data.ut();n.Tt();)if(!t(n.wt().key))return},qr.prototype.Dt=function(t){var e=this.data.ct(t);return e.Tt()?e.wt().key:null},qr.prototype.ut=function(){return new Cr(this.data.ut())},qr.prototype.ct=function(t){return new Cr(this.data.ct(t))},qr.prototype.add=function(t){return this.copy(this.data.remove(t).st(t,!0))},qr.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},qr.prototype._=function(){return this.data._()},qr.prototype.Ft=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},qr.prototype.isEqual=function(t){if(!(t instanceof qr))return!1;if(this.size!==t.size)return!1;for(var e=this.data.ut(),n=t.data.ut();e.Tt();){var i=e.wt().key,r=n.wt().key;if(0!==this.P(i,r))return!1}return!0},qr.prototype.F=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},qr.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},qr.prototype.copy=function(t){var e=new qr(this.P);return e.data=t,e},qr),Cr=(Mr.prototype.wt=function(){return this.Nt.wt().key},Mr.prototype.Tt=function(){return this.Nt.Tt()},Mr),Ur=new kr(nr.P);function Mr(t){this.Nt=t}function qr(t){this.P=t,this.data=new kr(this.P)}var xr=new kr(nr.P),jr=new kr(nr.P),Fr=new Vr(nr.P);function Br(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Fr,i=0,r=t;i<r.length;i++)var o=r[i],n=n.add(o);return n}var Gr=new Vr(Ui);function zr(t,e,n,i){this.te=t,this.removedTargetIds=e,this.key=n,this.ee=i}function $r(t,e){this.targetId=t,this.ne=e}function Wr(t,e,n,i){void 0===n&&(n=mr.J),void 0===i&&(i=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}var Hr=(so.Ot=function(t){return new so(t.P)},so.prototype.has=function(t){return null!=this.$t.get(t)},so.prototype.get=function(t){return this.$t.get(t)},so.prototype.first=function(){return this.kt.rt()},so.prototype.last=function(){return this.kt.ot()},so.prototype._=function(){return this.kt._()},so.prototype.indexOf=function(t){var e=this.$t.get(t);return e?this.kt.indexOf(e):-1},Object.defineProperty(so.prototype,"size",{get:function(){return this.kt.size},enumerable:!1,configurable:!0}),so.prototype.forEach=function(n){this.kt.ht(function(t,e){return n(t),!1})},so.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.$t.st(t.key,t),e.kt.st(t,null))},so.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.$t.remove(t),this.kt.remove(e)):this},so.prototype.isEqual=function(t){if(!(t instanceof so))return!1;if(this.size!==t.size)return!1;for(var e=this.kt.ut(),n=t.kt.ut();e.Tt();){var i=e.wt().key,r=n.wt().key;if(!i.isEqual(r))return!1}return!0},so.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},so.prototype.copy=function(t,e){var n=new so;return n.P=this.P,n.$t=t,n.kt=e,n},so),Qr=(oo.prototype.track=function(t){var e=t.doc.key,n=this.xt.get(e);!n||0!==t.type&&3===n.type?this.xt=this.xt.st(e,t):3===t.type&&1!==n.type?this.xt=this.xt.st(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.xt=this.xt.st(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.xt=this.xt.st(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.xt=this.xt.remove(e):1===t.type&&2===n.type?this.xt=this.xt.st(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.xt=this.xt.st(e,{type:2,doc:t.doc}):Di()},oo.prototype.Lt=function(){var n=[];return this.xt.ht(function(t,e){n.push(e)}),n},oo),Xr=(ro.Wt=function(t,e,n,i){var r=[];return e.forEach(function(t){r.push({type:0,doc:t})}),new ro(t,e,Hr.Ot(e),r,n,i,!0,!1)},Object.defineProperty(ro.prototype,"hasPendingWrites",{get:function(){return!this.qt._()},enumerable:!1,configurable:!0}),ro.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Ut===t.Ut&&this.qt.isEqual(t.qt)&&hu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Mt.isEqual(t.Mt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var i=0;i<e.length;i++)if(e[i].type!==n[i].type||!e[i].doc.isEqual(n[i].doc))return!1;return!0},ro),Yr=(io.zt=function(t,e){var n=new Map;return n.set(t,Kr.Ht(t,e)),new io(Ki.min(),n,Gr,Ur,Br())},io),Kr=(no.Ht=function(t,e){return new no(mr.J,e,Br(),Br(),Br())},no),Jr=(Object.defineProperty(eo.prototype,"Yt",{get:function(){return this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"resumeToken",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"ae",{get:function(){return 0!==this.se},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"ue",{get:function(){return this.he},enumerable:!1,configurable:!0}),eo.prototype.ce=function(t){0<t.Y()&&(this.he=!0,this.re=t)},eo.prototype.le=function(){var n=Br(),i=Br(),r=Br();return this.ie.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:i=i.add(t);break;case 1:r=r.add(t);break;default:Di()}}),new Kr(this.re,this.oe,n,i,r)},eo.prototype._e=function(){this.he=!1,this.ie=ao()},eo.prototype.fe=function(t,e){this.he=!0,this.ie=this.ie.st(t,e)},eo.prototype.de=function(t){this.he=!0,this.ie=this.ie.remove(t)},eo.prototype.we=function(){this.se+=1},eo.prototype.me=function(){--this.se},eo.prototype.Te=function(){this.he=!0,this.oe=!0},eo),Zr=(to.prototype.Ve=function(t){for(var e=0,n=t.te;e<n.length;e++){var i=n[e];t.ee instanceof Hs?this.ye(i,t.ee):t.ee instanceof Qs&&this.pe(i,t.key,t.ee)}for(var r=0,o=t.removedTargetIds;r<o.length;r++){var s=o[r];this.pe(s,t.key,t.ee)}},to.prototype.ge=function(n){var i=this;this.ve(n,function(t){var e=i.be(t);switch(n.state){case 0:i.Se(t)&&e.ce(n.resumeToken);break;case 1:e.me(),e.ae||e._e(),e.ce(n.resumeToken);break;case 2:e.me(),e.ae||i.removeTarget(t);break;case 3:i.Se(t)&&(e.Te(),e.ce(n.resumeToken));break;case 4:i.Se(t)&&(i.Ce(t),e.ce(n.resumeToken));break;default:Di()}})},to.prototype.ve=function(t,n){var i=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Ie.forEach(function(t,e){i.Se(e)&&n(e)})},to.prototype.De=function(t){var e,n,i=t.targetId,r=t.ne.count,o=this.Fe(i);o&&(gr(e=o.target)?0===r?(n=new nr(e.path),this.pe(i,n,new Qs(n,Ki.min()))):Pi(1===r):this.Ne(i)!==r&&(this.Ce(i),this.Pe=this.Pe.add(i)))},to.prototype.$e=function(r){var o=this,s=new Map;this.Ie.forEach(function(t,e){var n,i=o.Fe(e);i&&(t.Yt&&gr(i.target)&&(n=new nr(i.target.path),null!==o.Re.get(n)||o.ke(e,n)||o.pe(e,n,new Qs(n,r))),t.ue&&(s.set(e,t.le()),t._e()))});var i=Br();this.Ae.forEach(function(t,e){var n=!0;e.Ct(function(t){var e=o.Fe(t);return!e||2===e.X||(n=!1)}),n&&(i=i.add(t))});var t=new Yr(r,s,this.Pe,this.Re,i);return this.Re=Ur,this.Ae=uo(),this.Pe=new Vr(Ui),t},to.prototype.ye=function(t,e){var n;this.Se(t)&&(n=this.ke(t,e.key)?2:0,this.be(t).fe(e.key,n),this.Re=this.Re.st(e.key,e),this.Ae=this.Ae.st(e.key,this.Oe(e.key).add(t)))},to.prototype.pe=function(t,e,n){var i;this.Se(t)&&(i=this.be(t),this.ke(t,e)?i.fe(e,1):i.de(e),this.Ae=this.Ae.st(e,this.Oe(e).delete(t)),n&&(this.Re=this.Re.st(e,n)))},to.prototype.removeTarget=function(t){this.Ie.delete(t)},to.prototype.Ne=function(t){var e=this.be(t).le();return this.Ee.xe(t).size+e.Jt.size-e.Zt.size},to.prototype.we=function(t){this.be(t).we()},to.prototype.be=function(t){var e=this.Ie.get(t);return e||(e=new Jr,this.Ie.set(t,e)),e},to.prototype.Oe=function(t){var e=this.Ae.get(t);return e||(e=new Vr(Ui),this.Ae=this.Ae.st(t,e)),e},to.prototype.Se=function(t){var e=null!==this.Fe(t);return e||Si("WatchChangeAggregator","Detected inactive target",t),e},to.prototype.Fe=function(t){var e=this.Ie.get(t);return e&&e.ae?null:this.Ee.Le(t)},to.prototype.Ce=function(e){var n=this;this.Ie.set(e,new Jr),this.Ee.xe(e).forEach(function(t){n.pe(e,t,null)})},to.prototype.ke=function(t,e){return this.Ee.xe(t).has(e)},to);function to(t){this.Ee=t,this.Ie=new Map,this.Re=Ur,this.Ae=uo(),this.Pe=new Vr(Ui)}function eo(){this.se=0,this.ie=ao(),this.re=mr.J,this.oe=!1,this.he=!0}function no(t,e,n,i,r){this.resumeToken=t,this.Yt=e,this.Jt=n,this.Xt=i,this.Zt=r}function io(t,e,n,i,r){this.Z=t,this.Qt=e,this.jt=n,this.Gt=i,this.Kt=r}function ro(t,e,n,i,r,o,s,u){this.query=t,this.docs=e,this.Mt=n,this.docChanges=i,this.qt=r,this.fromCache=o,this.Ut=s,this.Bt=u}function oo(){this.xt=new kr(nr.P)}function so(n){this.P=n?function(t,e){return n(t,e)||nr.P(t.key,e.key)}:function(t,e){return nr.P(t.key,e.key)},this.$t=xr,this.kt=new kr(this.P)}function uo(){return new kr(nr.P)}function ao(){return new kr(nr.P)}function ho(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function co(t){var e=wo(t.mapValue.fields.__local_write_time__.timestampValue);return new Yi(e.seconds,e.nanos)}var lo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function fo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ho(t)?4:10:Di()}function po(i,r){var t,e,n,o=fo(i);if(o!==fo(r))return!1;switch(o){case 0:return!0;case 1:return i.booleanValue===r.booleanValue;case 4:return co(i).isEqual(co(r));case 3:return function(t){if("string"==typeof i.timestampValue&&"string"==typeof t.timestampValue&&i.timestampValue.length===t.timestampValue.length)return i.timestampValue===t.timestampValue;var e=wo(i.timestampValue),n=wo(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(r);case 5:return i.stringValue===r.stringValue;case 6:return n=r,Eo(i.bytesValue).isEqual(Eo(n.bytesValue));case 7:return i.referenceValue===r.referenceValue;case 8:return e=r,bo((t=i).geoPointValue.latitude)===bo(e.geoPointValue.latitude)&&bo(t.geoPointValue.longitude)===bo(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return bo(t.integerValue)===bo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=bo(t.doubleValue),i=bo(e.doubleValue);return n===i?fr(n)===fr(i):isNaN(n)&&isNaN(i)}return!1}(i,r);case 9:return Mi(i.arrayValue.values||[],r.arrayValue.values||[],po);case 10:return function(){var t=i.mapValue.fields||{},e=r.mapValue.fields||{};if(Fi(t)!==Fi(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!po(t[n],e[n])))return!1;return!0}();default:return Di()}}function yo(t,e){return void 0!==(t.values||[]).find(function(t){return po(t,e)})}function vo(t,e){var n,i,r,o,s,u,a,h,c,l,f=fo(t),p=fo(e);if(f!==p)return Ui(f,p);switch(f){case 0:return 0;case 1:return Ui(t.booleanValue,e.booleanValue);case 2:return h=e,(c=bo(t.integerValue||t.doubleValue))<(l=bo(h.integerValue||h.doubleValue))?-1:l<c?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1;case 3:return go(t.timestampValue,e.timestampValue);case 4:return go(co(t),co(e));case 5:return Ui(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=Eo(o),a=Eo(s),u.o(a);case 7:return function(t,e){for(var n=t.split("/"),i=e.split("/"),r=0;r<n.length&&r<i.length;r++){var o=Ui(n[r],i[r]);if(0!==o)return o}return Ui(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,i=e.geoPointValue,0!==(r=Ui(bo(n.latitude),bo(i.latitude)))?r:Ui(bo(n.longitude),bo(i.longitude));case 9:return function(t,e){for(var n=t.values||[],i=e.values||[],r=0;r<n.length&&r<i.length;++r){var o=vo(n[r],i[r]);if(o)return o}return Ui(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},i=Object.keys(n),r=e.fields||{},o=Object.keys(r);i.sort(),o.sort();for(var s=0;s<i.length&&s<o.length;++s){var u=Ui(i[s],o[s]);if(0!==u)return u;var a=vo(n[i[s]],r[o[s]]);if(0!==a)return a}return Ui(i.length,o.length)}(t.mapValue,e.mapValue);default:throw Di()}}function go(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ui(t,e);var n=wo(t),i=wo(e),r=Ui(n.seconds,i.seconds);return 0!==r?r:Ui(n.nanos,i.nanos)}function mo(t){return function s(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?"time("+(t=wo(r.timestampValue)).seconds+","+t.nanos+")":"stringValue"in r?r.stringValue:"bytesValue"in r?Eo(r.bytesValue).toBase64():"referenceValue"in r?(n=r.referenceValue,nr.B(n).toString()):"geoPointValue"in r?"geo("+(e=r.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in r?function(){for(var t="[",e=!0,n=0,i=r.arrayValue.values||[];n<i.length;n++)e?e=!1:t+=",",t+=s(i[n]);return t+"]"}():"mapValue"in r?function(t){for(var e="{",n=!0,i=0,r=Object.keys(t.fields||{}).sort();i<r.length;i++){var o=r[i];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(r.mapValue):Di();var t,e,n}(t)}function wo(t){if(Pi(!!t),"string"!=typeof t)return{seconds:bo(t.seconds),nanos:bo(t.nanos)};var e,n=0,i=lo.exec(t);Pi(!!i),i[1]&&(e=((e=i[1])+"000000000").substr(0,9),n=Number(e));var r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:n}}function bo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Eo(t){return"string"==typeof t?mr.fromBase64String(t):mr.fromUint8Array(t)}function Io(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.N()}}function Ao(t){return t&&"integerValue"in t}function To(t){return!!t&&"arrayValue"in t}function No(t){return t&&"nullValue"in t}function Ro(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ko(t){return t&&"mapValue"in t}var So={asc:"ASCENDING",desc:"DESCENDING"},_o={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Oo=function(t,e){this.s=t,this.Me=e};function Lo(t){return{integerValue:""+t}}function Do(t,e){if(t.Me){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:fr(e)?"-0":e}}function Po(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!fr(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Lo(e):Do(t,e);var n}function Vo(t,e){return t.Me?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Co(t,e){return t.Me?e.toBase64():e.toUint8Array()}function Uo(t){return Pi(!!t),Ki.T((e=wo(t),new Yi(e.seconds,e.nanos)));var e}function Mo(t,e){return new Zi(["projects",t.projectId,"databases",t.database]).child("documents").child(e).N()}function qo(t,e){return Mo(t.s,e.path)}function xo(t,e){var n,i,r=(Pi(Wo(i=Zi.$(e))),i);return Pi(r.get(1)===t.s.projectId),Pi(!r.get(3)&&!t.s.database||r.get(3)===t.s.database),new nr((Pi(4<(n=r).length&&"documents"===n.get(4)),n.p(5)))}function jo(t,e){return Mo(t.s,e)}function Fo(t){return new Zi(["projects",t.s.projectId,"databases",t.s.database]).N()}function Bo(t,e,n){return{name:qo(t,e),fields:n.proto.mapValue.fields}}function Go(t,e){var n,i,r,o;if(e instanceof Ts)n={update:Bo(t,e.key,e.value)};else if(e instanceof Cs)n={delete:qo(t,e.key)};else if(e instanceof Ns)n={update:Bo(t,e.key,e.data),updateMask:(i=e.qe,r=[],i.fields.forEach(function(t){return r.push(t.N())}),{fieldPaths:r})};else if(e instanceof Os)n={transform:{document:qo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Ko)return{fieldPath:t.field.N(),setToServerValue:"REQUEST_TIME"};if(e instanceof Jo)return{fieldPath:t.field.N(),appendMissingElements:{values:e.elements}};if(e instanceof is)return{fieldPath:t.field.N(),removeAllFromArray:{values:e.elements}};if(e instanceof us)return{fieldPath:t.field.N(),increment:e.Ue};throw Di()})}};else{if(!(e instanceof Us))return Di();n={verify:qo(t,e.key)}}return e.We.Be||(n.currentDocument=void 0!==(o=e.We).updateTime?{updateTime:Vo(t,o.updateTime.R())}:void 0!==o.exists?{exists:o.exists}:Di()),n}function zo(t){return{before:t.before,values:t.position}}function $o(t){return{fieldPath:t.N()}}function Wo(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function Ho(){this.Qe=void 0}function Qo(t,e){return t instanceof us?Ao(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var Xo,Yo,Ko=(n(ts,Yo=Ho),ts),Jo=(n(Zo,Xo=Ho),Zo);function Zo(t){var e=this;return(e=Xo.call(this)||this).elements=t,e}function ts(){return null!==Yo&&Yo.apply(this,arguments)||this}function es(t,e){for(var n=cs(e),i=0,r=t.elements;i<r.length;i++)!function(e){n.some(function(t){return po(t,e)})||n.push(e)}(r[i]);return{arrayValue:{values:n}}}var ns,is=(n(rs,ns=Ho),rs);function rs(t){var e=this;return(e=ns.call(this)||this).elements=t,e}function os(t,e){for(var n=cs(e),i=0,r=t.elements;i<r.length;i++)!function(e){n=n.filter(function(t){return!po(t,e)})}(r[i]);return{arrayValue:{values:n}}}var ss,us=(n(as,ss=Ho),as);function as(t,e){var n=this;return(n=ss.call(this)||this).serializer=t,n.Ue=e,n}function hs(t){return bo(t.integerValue||t.doubleValue)}function cs(t){return To(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function ls(t,e){this.field=t,this.transform=e}var fs=(ps.prototype.je=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].C(t))return!0;return!1},ps.prototype.isEqual=function(t){return Mi(this.fields,t.fields,function(t,e){return t.isEqual(e)})},ps);function ps(t){(this.fields=t).sort(er.P)}function ds(t,e){this.version=t,this.transformResults=e}var ys=(vs.Ge=function(){return new vs},vs.exists=function(t){return new vs(void 0,t)},vs.updateTime=function(t){return new vs(t)},Object.defineProperty(vs.prototype,"Be",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),vs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},vs);function vs(t,e){this.updateTime=t,this.exists=e}function gs(t,e){return void 0!==t.updateTime?e instanceof Hs&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Hs}function ms(){}function ws(t,e,n,i){return t instanceof Ts?function(t,e){if(!gs(t.We,e))return e;var n=Es(e);return new Hs(t.key,n,t.value,{Ke:!0})}(t,e):t instanceof Ns?function(t,e){if(!gs(t.We,e))return e;var n=Es(e),i=Ss(t,e);return new Hs(t.key,n,i,{Ke:!0})}(t,e):t instanceof Os?function(t,e,n,i){if(!gs(t.We,e))return e;var r=e,o=function(t,e,n,i){for(var r,o,s,u,a,h,c=[],l=0,f=t;l<f.length;l++){var p=f[l],d=p.transform,y=null;n instanceof Hs&&(y=n.field(p.field)),null===y&&i instanceof Hs&&(y=i.field(p.field)),c.push((o=y,h=a=u=s=void 0,(r=d)instanceof Ko?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},o&&(h.fields.__previous_value__=o),{mapValue:h}):r instanceof Jo?es(r,o):r instanceof is?os(r,o):(a=hs(u=Qo(s=r,o))+hs(s.Ue),Ao(u)&&Ao(s.Ue)?Lo(a):Do(s.serializer,a))))}return c}(t.fieldTransforms,n,e,i),s=Ds(t,r.data(),o);return new Hs(t.key,r.version,s,{Ke:!0})}(t,e,i,n):(o=e,gs((r=t).We,o)?new Qs(r.key,Ki.min()):o);var r,o}function bs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.We.isEqual(e.We)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.qe.isEqual(e.qe):2!==t.type||Mi(t.fieldTransforms,t.fieldTransforms,function(t,e){return i=e,(n=t).field.isEqual(i.field)&&(r=n.transform,o=i.transform,r instanceof Jo&&o instanceof Jo||r instanceof is&&o instanceof is?Mi(r.elements,o.elements,po):r instanceof us&&o instanceof us?po(r.Ue,o.Ue):r instanceof Ko&&o instanceof Ko);var n,i,r,o}))}function Es(t){return t instanceof Hs?t.version:Ki.min()}var Is,As,Ts=(n(ks,As=ms),ks),Ns=(n(Rs,Is=ms),Rs);function Rs(t,e,n,i){var r=this;return(r=Is.call(this)||this).key=t,r.data=e,r.qe=n,r.We=i,r.type=1,r}function ks(t,e,n){var i=this;return(i=As.call(this)||this).key=t,i.value=e,i.We=n,i.type=0,i}function Ss(t,e){return n=t,i=e instanceof Hs?e.data():Ms.empty(),r=new qs(i),n.qe.fields.forEach(function(t){var e;t._()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.ze();var n,i,r}var _s,Os=(n(Ls,_s=ms),Ls);function Ls(t,e){var n=this;return(n=_s.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.We=ys.exists(!0),n}function Ds(t,e,n){for(var i=new qs(e),r=0;r<t.fieldTransforms.length;r++){var o=t.fieldTransforms[r];i.set(o.field,n[r])}return i.ze()}var Ps,Vs,Cs=(n(Bs,Vs=ms),Bs),Us=(n(Fs,Ps=ms),Fs),Ms=(js.empty=function(){return new js({mapValue:{}})},js.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!ko(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},js.prototype.isEqual=function(t){return po(this.proto,t.proto)},js),qs=(xs.prototype.set=function(t,e){return this.Je(t,e),this},xs.prototype.delete=function(t){return this.Je(t,null),this},xs.prototype.Je=function(t,e){for(var n=this.Ye,i=0;i<t.length-1;++i)var r=t.get(i),o=n.get(r),n=(o instanceof Map||(o=o&&10===fo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(r,o)),o);n.set(t.S(),e)},xs.prototype.ze=function(){var t=this.Xe(er.k(),this.Ye);return null!=t?new Ms(t):this.He},xs.prototype.Xe=function(i,t){var r=this,o=!1,e=this.He.field(i),s=ko(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=r.Xe(i.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},xs);function xs(t){void 0===t&&(t=Ms.empty()),this.He=t,this.Ye=new Map}function js(t){this.proto=t}function Fs(t,e){var n=this;return(n=Ps.call(this)||this).key=t,n.We=e,n.type=4,n}function Bs(t,e){var n=this;return(n=Vs.call(this)||this).key=t,n.We=e,n.type=3,n}function Gs(t,e){this.key=t,this.version=e}var zs,$s,Ws,Hs=(n(Js,Ws=Gs),Js.prototype.field=function(t){return this.Ze.field(t)},Js.prototype.data=function(){return this.Ze},Js.prototype.tn=function(){return this.Ze.proto},Js.prototype.isEqual=function(t){return t instanceof Js&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ke===t.Ke&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Ze.isEqual(t.Ze)},Js.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Ze.toString()+", {hasLocalMutations: "+this.Ke+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Js.prototype,"hasPendingWrites",{get:function(){return this.Ke||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Js),Qs=(n(Ks,$s=Gs),Ks.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Ks.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Ks.prototype.isEqual=function(t){return t instanceof Ks&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Ks),Xs=(n(Ys,zs=Gs),Ys.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Ys.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Ys.prototype.isEqual=function(t){return t instanceof Ys&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Ys);function Ys(){return null!==zs&&zs.apply(this,arguments)||this}function Ks(t,e,n){var i=this;return(i=$s.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),i}function Js(t,e,n,i){var r=this;return(r=Ws.call(this,t,e)||this).Ze=n,r.Ke=!!i.Ke,r.hasCommittedMutations=!!i.hasCommittedMutations,r}function Zs(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new Xi(Qi.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass '"+e.name+"' from a different Firestore SDK?"):new Xi(Qi.INVALID_ARGUMENT,"Expected type '"+e.name+"', but was '"+t.constructor.name+"'");return t}var tu=(eu.prototype.on=function(t){return new eu(t,null,this.en.slice(),this.filters.slice(),this.limit,this.nn,this.startAt,this.endAt)},eu.prototype.hn=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.en.length||1===this.en.length&&this.en[0].field.L())},eu.prototype.an=function(){return!lr(this.limit)&&"F"===this.nn},eu.prototype.un=function(){return!lr(this.limit)&&"L"===this.nn},eu.prototype.cn=function(){return 0<this.en.length?this.en[0].field:null},eu.prototype.ln=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n._n())return n.field}return null},eu.prototype.fn=function(t){for(var e=0,n=this.filters;e<n.length;e++){var i=n[e];if(0<=t.indexOf(i.op))return i.op}return null},eu);function eu(t,e,n,i,r,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.en=n,this.filters=i,this.limit=r,this.nn=o,this.startAt=s,this.endAt=u,this.sn=null,this.rn=null,this.startAt,this.endAt}function nu(t){return new tu(t)}function iu(t){return null!==t.collectionGroup}function ru(t){var e=Zs(t,tu);if(null===e.sn){e.sn=[];var n=e.ln(),i=e.cn();if(null!==n&&null===i)n.L()||e.sn.push(new Gu(n)),e.sn.push(new Gu(er.M(),"asc"));else{for(var r,o=!1,s=0,u=e.en;s<u.length;s++){var a=u[s];e.sn.push(a),a.field.L()&&(o=!0)}o||(r=0<e.en.length?e.en[e.en.length-1].dir:"asc",e.sn.push(new Gu(er.M(),r)))}}return e.sn}function ou(t){var e=Zs(t,tu);if(!e.rn)if("F"===e.nn)e.rn=dr(e.path,e.collectionGroup,ru(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],i=0,r=ru(e);i<r.length;i++){var o=r[i],s="desc"===o.dir?"asc":"desc";n.push(new Gu(o.field,s))}var u=e.endAt?new Cu(e.endAt.position,!e.endAt.before):null,a=e.startAt?new Cu(e.startAt.position,!e.startAt.before):null;e.rn=dr(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.rn}function su(t,e,n){return new tu(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function uu(t,e){return new tu(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),t.limit,t.nn,e,t.endAt)}function au(t,e){return new tu(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),t.limit,t.nn,t.startAt,e)}function hu(t,e){return vr(ou(t),ou(e))&&t.nn===e.nn}function cu(t){return yr(ou(t))+"|lt:"+t.nn}function lu(t){return"Query(target="+(n=(e=ou(t)).path.N(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.N()+" "+e.op+" "+mo(e.value);var e}).join(", ")+"]"),lr(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.N()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+ju(e.startAt)),e.endAt&&(n+=", endAt: "+ju(e.endAt)),"Target("+n+")")+"; limitType="+t.nn+")";var e,n}function fu(r,t){return i=r,o=t.key.path,(null!==i.collectionGroup?t.key.W(i.collectionGroup)&&i.path.C(o):nr.j(i.path)?i.path.isEqual(o):i.path.D(o))&&function(t){for(var e=0,n=r.en;e<n.length;e++){var i=n[e];if(!i.field.L()&&null===t.field(i.field))return}return 1}(t)&&function(t){for(var e=0,n=r.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=r).startAt||Fu(e.startAt,ru(e),n))&&(!e.endAt||!Fu(e.endAt,ru(e),n)));var e,n,i,o}function pu(u){return function(t,e){for(var n=!1,i=0,r=ru(u);i<r.length;i++){var o=r[i],s=function(t,e,n){var i,r,o,s,u=t.field.L()?nr.P(e.key,n.key):(i=t.field,r=n,o=e.field(i),s=r.field(i),null!==o&&null!==s?vo(o,s):Di());switch(t.dir){case"asc":return u;case"desc":return-1*u;default:return Di()}}(o,t,e);if(0!==s)return s;n=n||o.field.L()}return 0}}var du,yu=(n(vu,du=function(){}),vu.create=function(t,e,n){if(t.L())return"in"===e||"not-in"===e?this.dn(t,e,n):new bu(t,e,n);if(No(n)){if("=="!==e&&"!="!==e)throw new Xi(Qi.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new vu(t,e,n)}if(Ro(n)){if("=="!==e&&"!="!==e)throw new Xi(Qi.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new vu(t,e,n)}return"array-contains"===e?new Lu(t,n):"in"===e?new Du(t,n):"not-in"===e?new Pu(t,n):"array-contains-any"===e?new Vu(t,n):new vu(t,e,n)},vu.dn=function(t,e,n){return new("in"===e?Eu:Iu)(t,n)},vu.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.wn(vo(e,this.value)):null!==e&&fo(this.value)===fo(e)&&this.wn(vo(e,this.value))},vu.prototype.wn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Di()}},vu.prototype._n=function(){return 0<=["<","<=",">",">=","!="].indexOf(this.op)},vu);function vu(t,e,n){var i=this;return(i=du.call(this)||this).field=t,i.op=e,i.value=n,i}var gu,mu,wu,bu=(n(Nu,wu=yu),Nu.prototype.matches=function(t){var e=nr.P(t.key,this.key);return this.wn(e)},Nu),Eu=(n(Tu,mu=yu),Tu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Tu),Iu=(n(Au,gu=yu),Au.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Au);function Au(t,e){var n=this;return(n=gu.call(this,t,"not-in",e)||this).keys=Ru(0,e),n}function Tu(t,e){var n=this;return(n=mu.call(this,t,"in",e)||this).keys=Ru(0,e),n}function Nu(t,e,n){var i=this;return(i=wu.call(this,t,e,n)||this).key=nr.B(n.referenceValue),i}function Ru(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return nr.B(t.referenceValue)})}var ku,Su,_u,Ou,Lu=(n(xu,Ou=yu),xu.prototype.matches=function(t){var e=t.field(this.field);return To(e)&&yo(e.arrayValue,this.value)},xu),Du=(n(qu,_u=yu),qu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&yo(this.value.arrayValue,e)},qu),Pu=(n(Mu,Su=yu),Mu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&!yo(this.value.arrayValue,e)},Mu),Vu=(n(Uu,ku=yu),Uu.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!To(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return yo(e.value.arrayValue,t)})},Uu),Cu=function(t,e){this.position=t,this.before=e};function Uu(t,e){return ku.call(this,t,"array-contains-any",e)||this}function Mu(t,e){return Su.call(this,t,"not-in",e)||this}function qu(t,e){return _u.call(this,t,"in",e)||this}function xu(t,e){return Ou.call(this,t,"array-contains",e)||this}function ju(t){return(t.before?"b":"a")+":"+t.position.map(mo).join(",")}function Fu(t,e,n){for(var i=0,r=0;r<t.position.length;r++){var o=e[r],s=t.position[r],i=o.field.L()?nr.P(nr.B(s.referenceValue),n.key):vo(s,n.field(o.field));if("desc"===o.dir&&(i*=-1),0!==i)break}return t.before?i<=0:i<0}function Bu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!po(t.position[n],e.position[n]))return!1;return!0}var Gu=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e},zu=(ea.prototype.Tn=function(t,e,n){for(var i,r,o,s=n.En,u=0;u<this.mutations.length;u++){var a=this.mutations[u];a.key.isEqual(t)&&(i=a,r=e,o=s[u],e=i instanceof Ts?new Hs(i.key,o.version,i.value,{hasCommittedMutations:!0}):i instanceof Ns?function(t,e,n){if(!gs(t.We,e))return new Xs(t.key,n.version);var i=Ss(t,e);return new Hs(t.key,n.version,i,{hasCommittedMutations:!0})}(i,r,o):i instanceof Os?function(t,e,n){if(Pi(null!=n.transformResults),!gs(t.We,e))return new Xs(t.key,n.version);var i=e,r=function(t,e,n){var i=[];Pi(t.length===n.length);for(var r,o,s,u=0;u<n.length;u++){var a=t[u],h=a.transform,c=null;e instanceof Hs&&(c=e.field(a.field)),i.push((r=h,o=c,s=n[u],r instanceof Jo?es(r,o):r instanceof is?os(r,o):s))}return i}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Ds(t,i.data(),r);return new Hs(t.key,o,s,{hasCommittedMutations:!0})}(i,r,o):new Qs(i.key,o.version,{hasCommittedMutations:!0}))}return e},ea.prototype.In=function(t,e){for(var n=0,i=this.baseMutations;n<i.length;n++){var r=i[n];r.key.isEqual(t)&&(e=ws(r,e,e,this.mn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=ws(a,e,o,this.mn))}return e},ea.prototype.Rn=function(n){var i=this,r=n;return this.mutations.forEach(function(t){var e=i.In(t.key,n.get(t.key));e&&(r=r.st(t.key,e))}),r},ea.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},Br())},ea.prototype.isEqual=function(t){return this.batchId===t.batchId&&Mi(this.mutations,t.mutations,bs)&&Mi(this.baseMutations,t.baseMutations,bs)},ea),$u=(ta.from=function(t,e,n){Pi(t.mutations.length===n.length);for(var i=jr,r=t.mutations,o=0;o<r.length;o++)i=i.st(r[o].key,n[o].version);return new ta(t,e,n,i)},ta),Wu=(Zu.prototype.catch=function(t){return this.next(void 0,t)},Zu.prototype.next=function(i,r){var o=this;return this.gn&&Di(),this.gn=!0,this.pn?this.error?this.vn(r,this.error):this.bn(i,this.result):new Zu(function(e,n){o.Vn=function(t){o.bn(i,t).next(e,n)},o.yn=function(t){o.vn(r,t).next(e,n)}})},Zu.prototype.Sn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Zu.prototype.Cn=function(t){try{var e=t();return e instanceof Zu?e:Zu.resolve(e)}catch(t){return Zu.reject(t)}},Zu.prototype.bn=function(t,e){return t?this.Cn(function(){return t(e)}):Zu.resolve(e)},Zu.prototype.vn=function(t,e){return t?this.Cn(function(){return t(e)}):Zu.reject(e)},Zu.resolve=function(n){return new Zu(function(t,e){t(n)})},Zu.reject=function(n){return new Zu(function(t,e){e(n)})},Zu.Dn=function(t){return new Zu(function(e,n){var i=0,r=0,o=!1;t.forEach(function(t){++i,t.next(function(){++r,o&&r===i&&e()},function(t){return n(t)})}),o=!0,r===i&&e()})},Zu.Fn=function(t){for(var n=Zu.resolve(!1),e=0,i=t;e<i.length;e++)!function(e){n=n.next(function(t){return t?Zu.resolve(t):e()})}(i[e]);return n},Zu.forEach=function(t,n){var i=this,r=[];return t.forEach(function(t,e){r.push(n.call(i,t,e))}),this.Dn(r)},Zu),Hu=(Ju.prototype.On=function(e,n){var i=this;return this.$n.xn(e,n).next(function(t){return i.Ln(e,n,t)})},Ju.prototype.Ln=function(t,i,r){return this.Nn.Mn(t,i).next(function(t){for(var e=0,n=r;e<n.length;e++)t=n[e].In(i,t);return t})},Ju.prototype.qn=function(t,e,r){var o=Ur;return e.forEach(function(t,e){for(var n=0,i=r;n<i.length;n++)e=i[n].In(t,e);o=o.st(t,e)}),o},Ju.prototype.Un=function(e,t){var n=this;return this.Nn.getEntries(e,t).next(function(t){return n.Bn(e,t)})},Ju.prototype.Bn=function(i,r){var o=this;return this.$n.Wn(i,r).next(function(t){var e=o.qn(i,r,t),n=Ur;return e.forEach(function(t,e){e=e||new Qs(t,Ki.min()),n=n.st(t,e)}),n})},Ju.prototype.Qn=function(t,e,n){return i=e,nr.j(i.path)&&null===i.collectionGroup&&0===i.filters.length?this.jn(t,e.path):iu(e)?this.Gn(t,e,n):this.Kn(t,e,n);var i},Ju.prototype.jn=function(t,e){return this.On(t,new nr(e)).next(function(t){var e=xr;return t instanceof Hs&&(e=e.st(t.key,t)),e})},Ju.prototype.Gn=function(n,i,r){var o=this,s=i.collectionGroup,u=xr;return this.kn.zn(n,s).next(function(t){return Wu.forEach(t,function(t){var e=i.on(t.child(s));return o.Kn(n,e,r).next(function(t){t.forEach(function(t,e){u=u.st(t,e)})})}).next(function(){return u})})},Ju.prototype.Kn=function(e,n,t){var c,l,i=this;return this.Nn.Qn(e,n,t).next(function(t){return c=t,i.$n.Hn(e,n)}).next(function(t){return l=t,i.Yn(e,l,c).next(function(t){c=t;for(var e=0,n=l;e<n.length;e++)for(var i=n[e],r=0,o=i.mutations;r<o.length;r++){var s=o[r],u=s.key,a=c.get(u),h=ws(s,a,a,i.mn);c=h instanceof Hs?c.st(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){fu(n,e)||(c=c.remove(t))}),c})},Ju.prototype.Yn=function(t,e,n){for(var i=Br(),r=0,o=e;r<o.length;r++)for(var s=0,u=o[r].mutations;s<u.length;s++){var a=u[s];a instanceof Ns&&null===n.get(a.key)&&(i=i.add(a.key))}var h=n;return this.Nn.getEntries(t,i).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Hs&&(h=h.st(t,e))}),h})},Ju),Qu=(Ku.Zn=function(t,e){for(var n=Br(),i=Br(),r=0,o=e.docChanges;r<o.length;r++){var s=o[r];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new Ku(t,e.fromCache,n,i)},Ku),Xu=(Yu.prototype.es=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Yu.prototype.next=function(){var t=++this.previousValue;return this.ns&&this.ns(t),t},Yu);function Yu(t,e){var n=this;this.previousValue=t,e&&(e.ts=function(t){return n.es(t)},this.ns=function(t){return e.ss(t)})}function Ku(t,e,n,i){this.targetId=t,this.fromCache=e,this.Jn=n,this.Xn=i}function Ju(t,e,n){this.Nn=t,this.$n=e,this.kn=n}function Zu(t){var e=this;this.Vn=null,this.yn=null,this.result=void 0,this.error=void 0,this.pn=!1,this.gn=!1,t(function(t){e.pn=!0,e.result=t,e.Vn&&e.Vn(t)},function(t){e.pn=!0,e.error=t,e.yn&&e.yn(t)})}function ta(t,e,n,i){this.batch=t,this.An=e,this.En=n,this.Pn=i}function ea(t,e,n,i){this.batchId=t,this.mn=e,this.baseMutations=n,this.mutations=i}function na(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}Xu.rs=-1;var ia=(ra.prototype.reset=function(){this.ls=0},ra.prototype.ds=function(){this.ls=this.cs},ra.prototype.ws=function(t){var e=this;this.cancel();var n=Math.floor(this.ls+this.ms()),i=Math.max(0,Date.now()-this.fs),r=Math.max(0,n-i);0<r&&Si("ExponentialBackoff","Backing off for "+r+" ms (base delay: "+this.ls+" ms, delay with jitter: "+n+" ms, last attempt: "+i+" ms ago)"),this._s=this.os.Ts(this.hs,r,function(){return e.fs=Date.now(),t()}),this.ls*=this.us,this.ls<this.as&&(this.ls=this.as),this.ls>this.cs&&(this.ls=this.cs)},ra.prototype.Es=function(){null!==this._s&&(this._s.Is(),this._s=null)},ra.prototype.cancel=function(){null!==this._s&&(this._s.cancel(),this._s=null)},ra.prototype.ms=function(){return(Math.random()-.5)*this.ls},ra);function ra(t,e,n,i,r){void 0===n&&(n=1e3),void 0===i&&(i=1.5),void 0===r&&(r=6e4),this.os=t,this.hs=e,this.as=n,this.us=i,this.cs=r,this.ls=0,this._s=null,this.fs=Date.now(),this.reset()}function oa(t){return"IndexedDbTransactionError"===t.name}function sa(){return"undefined"!=typeof document?document:null}var ua=(ca.ys=function(t,e,n,i,r){var o=new ca(t,e,Date.now()+n,i,r);return o.start(n),o},ca.prototype.start=function(t){var e=this;this.ps=setTimeout(function(){return e.gs()},t)},ca.prototype.Is=function(){return this.gs()},ca.prototype.cancel=function(t){null!==this.ps&&(this.clearTimeout(),this.Vs.reject(new Xi(Qi.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},ca.prototype.gs=function(){var e=this;this.Rs.vs(function(){return null!==e.ps?(e.clearTimeout(),e.op().then(function(t){return e.Vs.resolve(t)})):Promise.resolve()})},ca.prototype.clearTimeout=function(){null!==this.ps&&(this.Ps(this),clearTimeout(this.ps),this.ps=null)},ca),aa=(Object.defineProperty(ha.prototype,"xs",{get:function(){return this.Cs},enumerable:!1,configurable:!0}),ha.prototype.vs=function(t){this.enqueue(t)},ha.prototype.Ls=function(t){this.Ms(),this.qs(t)},ha.prototype.Us=function(){var t;this.Cs||(this.Cs=!0,(t=sa())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Os))},ha.prototype.enqueue=function(t){return this.Ms(),this.Cs?new Promise(function(t){}):this.qs(t)},ha.prototype.Bs=function(t){var e=this;this.Ss.push(t),this.vs(function(){return e.Ws()})},ha.prototype.Ws=function(){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(0===this.Ss.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Ss[0]()];case 2:return t.sent(),this.Ss.shift(),this.ks.reset(),[3,4];case 3:if(!oa(e=t.sent()))throw e;return Si("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Ss.length&&this.ks.ws(function(){return n.Ws()}),t.label=5;case 5:return[2]}})})},ha.prototype.qs=function(t){var i=this,e=this.bs.then(function(){return i.Ns=!0,t().catch(function(t){throw i.Fs=t,i.Ns=!1,_i("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return i.Ns=!1,t})});return this.bs=e},ha.prototype.Ts=function(t,e,n){var i=this;this.Ms(),-1<this.$s.indexOf(t)&&(e=0);var r=ua.ys(this,t,e,n,function(t){return i.Qs(t)});return this.Ds.push(r),r},ha.prototype.Ms=function(){this.Fs&&Di()},ha.prototype.js=function(){},ha.prototype.Gs=function(){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,e=this.bs];case 1:t.sent(),t.label=2;case 2:if(e!==this.bs)return[3,0];t.label=3;case 3:return[2]}})})},ha.prototype.Ks=function(t){for(var e=0,n=this.Ds;e<n.length;e++)if(n[e].hs===t)return!0;return!1},ha.prototype.zs=function(i){var r=this;return this.Gs().then(function(){r.Ds.sort(function(t,e){return t.As-e.As});for(var t=0,e=r.Ds;t<e.length;t++){var n=e[t];if(n.Is(),"all"!==i&&n.hs===i)break}return r.Gs()})},ha.prototype.Hs=function(t){this.$s.push(t)},ha.prototype.Qs=function(t){var e=this.Ds.indexOf(t);this.Ds.splice(e,1)},ha);function ha(){var e=this;this.bs=Promise.resolve(),this.Ss=[],this.Cs=!1,this.Ds=[],this.Fs=null,this.Ns=!1,this.$s=[],this.ks=new ia(this,"async_queue_retry"),this.Os=function(){var t=sa();t&&Si("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.ks.Es()};var t=sa();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Os)}function ca(t,e,n,i,r){this.Rs=t,this.hs=e,this.As=n,this.op=i,this.Ps=r,this.Vs=new na,this.then=this.Vs.promise.then.bind(this.Vs.promise),this.Vs.promise.catch(function(t){})}function la(t,e){if(_i("AsyncQueue",e+": "+t),oa(t))return new Xi(Qi.UNAVAILABLE,e+": "+t);throw t}var fa=(pa.Zs=function(t){return new pa(t,pa.ti,pa.ei)},pa);function pa(t,e,n){this.Ys=t,this.Js=e,this.Xs=n}fa.ni=-1,fa.si=1048576,fa.ii=41943040,fa.ti=10,fa.ei=1e3,fa.ri=new fa(fa.ii,fa.ti,fa.ei),fa.oi=new fa(fa.ni,0,0);var da=(Ea.prototype.ai=function(t,e){return this.hi.add(e),Wu.resolve()},Ea.prototype.zn=function(t,e){return Wu.resolve(this.hi.getEntries(e))},Ea),ya=(ba.prototype.add=function(t){var e=t.S(),n=t.g(),i=this.index[e]||new Vr(Zi.P),r=!i.has(n);return this.index[e]=i.add(n),r},ba.prototype.has=function(t){var e=t.S(),n=t.g(),i=this.index[e];return i&&i.has(n)},ba.prototype.getEntries=function(t){return(this.index[t]||new Vr(Zi.P)).F()},ba),va=(wa.prototype.next=function(){return this.ui+=2,this.ui},wa.ci=function(){return new wa(0)},wa.li=function(){return new wa(-1)},wa),ga=(ma.prototype.yi=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.pi(t,n.fi)})},ma);function ma(t,e,n){this.persistence=t,this._i=e,this.fi=new kr(Ui),this.di=new Hi(yr,vr),this.wi=Ki.min(),this.$n=t.mi(n),this.Ti=t.Ei(),this.Ii=t.Ri(),this.Ai=new Hu(this.Ti,this.$n,this.persistence.Pi()),this._i.Vi(this.Ai)}function wa(t){this.ui=t}function ba(){this.index={}}function Ea(){this.hi=new ya}function Ia(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Ii.Di(t)})}function Aa(o,s,u){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){switch(t.label){case 0:n=(e=o).fi.get(s),i=u?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),u?[3,3]:[4,e.persistence.runTransaction("Release target",i,function(t){return e.persistence.Li.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!oa(r=t.sent()))throw r;return Si("LocalStore","Failed to update sequence numbers for target "+s+": "+r),[3,5];case 5:return e.fi=e.fi.remove(s),e.di.delete(n.target),[2]}})})}function Ta(t,s,u){var a=t,h=Ki.min(),c=Br();return a.persistence.runTransaction("Execute query","readonly",function(e){return t=a,n=e,i=ou(s),(void 0!==(o=(r=t).di.get(i))?Wu.resolve(r.fi.get(o)):r.Ii.Ui(n,i)).next(function(t){if(t)return h=t.lastLimboFreeSnapshotVersion,a.Ii.Bi(e,t.targetId).next(function(t){c=t})}).next(function(){return a._i.Qn(e,s,u?h:Ki.min(),u?c:Br())}).next(function(t){return{documents:t,Wi:c}});var t,n,i,r,o})}function Na(e){return d(this,void 0,void 0,function(){return y(this,function(t){if(e.code!==Qi.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Si("LocalStore","Unexpectedly lost primary lease"),[2]})})}var Ra=(La.prototype._=function(){return this.Qi._()},La.prototype.zi=function(t,e){var n=new ka(t,e);this.Qi=this.Qi.add(n),this.Gi=this.Gi.add(n)},La.prototype.Hi=function(t,e){var n=this;t.forEach(function(t){return n.zi(t,e)})},La.prototype.Yi=function(t,e){this.Ji(new ka(t,e))},La.prototype.Xi=function(t,e){var n=this;t.forEach(function(t){return n.Yi(t,e)})},La.prototype.Zi=function(t){var e=this,n=new nr(new Zi([])),i=new ka(n,t),r=new ka(n,t+1),o=[];return this.Gi.St([i,r],function(t){e.Ji(t),o.push(t.key)}),o},La.prototype.tr=function(){var e=this;this.Qi.forEach(function(t){return e.Ji(t)})},La.prototype.Ji=function(t){this.Qi=this.Qi.delete(t),this.Gi=this.Gi.delete(t)},La.prototype.er=function(t){var e=new nr(new Zi([])),n=new ka(e,t),i=new ka(e,t+1),r=Br();return this.Gi.St([n,i],function(t){r=r.add(t.key)}),r},La.prototype.nr=function(t){var e=new ka(t,0),n=this.Qi.Dt(e);return null!==n&&t.isEqual(n.key)},La),ka=(Oa.ji=function(t,e){return nr.P(t.key,e.key)||Ui(t.sr,e.sr)},Oa.Ki=function(t,e){return Ui(t.sr,e.sr)||nr.P(t.key,e.key)},Oa),Sa=(_a.prototype.ir=function(){return null!=this.uid},_a.prototype.rr=function(){return this.ir()?"uid:"+this.uid:"anonymous-user"},_a.prototype.isEqual=function(t){return t.uid===this.uid},_a);function _a(t){this.uid=t}function Oa(t,e){this.key=t,this.sr=e}function La(){this.Qi=new Vr(ka.ji),this.Gi=new Vr(ka.Ki)}function Da(t,e){this.user=e,this.type="OAuth",this.ar={},this.ar.Authorization="Bearer "+t}function Pa(t){this.key=t}function Va(t){this.key=t}function Ca(t,e,n){this.query=t,this.targetId=e,this.view=n}function Ua(t){this.key=t,this.Lh=!1}function Ma(){this.va=void 0,this.listeners=[]}Sa.UNAUTHENTICATED=new Sa(null),Sa.or=new Sa("google-credentials-uid"),Sa.hr=new Sa("first-party-uid");var qa,xa,ja,Fa,Ba=(Nh.prototype.getToken=function(){return Promise.resolve(null)},Nh.prototype.cr=function(){},Nh.prototype.lr=function(t){(this.ur=t)(Sa.UNAUTHENTICATED)},Nh.prototype._r=function(){this.ur=null},Nh),Ga=(Th.prototype.getToken=function(){var e=this,n=this.mr,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.mr!==n?(Si("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Pi("string"==typeof t.accessToken),new Da(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Th.prototype.cr=function(){this.forceRefresh=!0},Th.prototype.lr=function(t){this.ur=t,this.wr&&t(this.currentUser)},Th.prototype._r=function(){this.auth&&this.auth.removeAuthTokenListener(this.dr),this.dr=null,this.ur=null},Th.prototype.Tr=function(){var t=this.auth&&this.auth.getUid();return Pi(null===t||"string"==typeof t),new Sa(t)},Th),za=(Object.defineProperty(Ah.prototype,"ar",{get:function(){var t={"X-Goog-AuthUser":this.Ir},e=this.Er.auth.Rr([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Ah),$a=(Ih.prototype.getToken=function(){return Promise.resolve(new za(this.Er,this.Ir))},Ih.prototype.lr=function(t){t(Sa.hr)},Ih.prototype._r=function(){},Ih.prototype.cr=function(){},Ih),Wa=(Eh.prototype.gr=function(){return 1===this.state||2===this.state||4===this.state},Eh.prototype.vr=function(){return 2===this.state},Eh.prototype.start=function(){3!==this.state?this.auth():this.br()},Eh.prototype.stop=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.gr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Eh.prototype.Sr=function(){this.state=0,this.ks.reset()},Eh.prototype.Cr=function(){var t=this;this.vr()&&null===this.pr&&(this.pr=this.os.Ts(this.Ar,6e4,function(){return t.Dr()}))},Eh.prototype.Fr=function(t){this.Nr(),this.stream.send(t)},Eh.prototype.Dr=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.vr()?[2,this.close(0)]:[2]})})},Eh.prototype.Nr=function(){this.pr&&(this.pr.cancel(),this.pr=null)},Eh.prototype.close=function(e,n){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Nr(),this.ks.cancel(),this.yr++,3!==e?this.ks.reset():n&&n.code===Qi.RESOURCE_EXHAUSTED?(_i(n.toString()),_i("Using maximum backoff delay to prevent overloading the backend."),this.ks.ds()):n&&n.code===Qi.UNAUTHENTICATED&&this.Vr.cr(),null!==this.stream&&(this.$r(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.kr(n)];case 1:return t.sent(),[2]}})})},Eh.prototype.$r=function(){},Eh.prototype.auth=function(){var n=this;this.state=1;var t=this.Or(this.yr),e=this.yr;this.Vr.getToken().then(function(t){n.yr===e&&n.xr(t)},function(e){t(function(){var t=new Xi(Qi.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Lr(t)})})},Eh.prototype.xr=function(t){var e=this,n=this.Or(this.yr);this.stream=this.Mr(t),this.stream.qr(function(){n(function(){return e.state=2,e.listener.qr()})}),this.stream.kr(function(t){n(function(){return e.Lr(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Eh.prototype.br=function(){var t=this;this.state=4,this.ks.ws(function(){return d(t,void 0,void 0,function(){return y(this,function(t){return this.state=0,this.start(),[2]})})})},Eh.prototype.Lr=function(t){return Si("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Eh.prototype.Or=function(e){var n=this;return function(t){n.os.vs(function(){return n.yr===e?t():(Si("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Eh),Ha=(n(bh,ja=Wa),bh.prototype.Mr=function(t){return this.Pr.Ur("Listen",t)},bh.prototype.onMessage=function(t){this.ks.reset();var e=function(t,e){var n,i,r,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Di(),u=e.targetChange.targetIds||[],a=(r=e.targetChange.resumeToken,t.Me?(Pi(void 0===r||"string"==typeof r),mr.fromBase64String(r||"")):(Pi(void 0===r||r instanceof Uint8Array),mr.fromUint8Array(r||new Uint8Array))),h=e.targetChange.cause,c=new Wr(s,u,a,h&&(i=void 0===(n=h).code?Qi.UNKNOWN:Rr(n.code),new Xi(i,n.message||""))||null)}else if("documentChange"in e){e.documentChange;var l=e.documentChange;l.document,l.document.name,l.document.updateTime;var f=xo(t,l.document.name),p=Uo(l.document.updateTime),d=new Ms({mapValue:{fields:l.document.fields}}),y=new Hs(f,p,d,{}),c=new zr(l.targetIds||[],l.removedTargetIds||[],y.key,y)}else if("documentDelete"in e){e.documentDelete;var v=e.documentDelete;v.document;var g=xo(t,v.document),m=v.readTime?Uo(v.readTime):Ki.min(),w=new Qs(g,m);c=new zr([],v.removedTargetIds||[],w.key,w)}else if("documentRemove"in e){e.documentRemove;var b=e.documentRemove;b.document;var E=xo(t,b.document);c=new zr([],b.removedTargetIds||[],E,null)}else{if(!("filter"in e))return Di();e.filter;var I=e.filter;I.targetId;var A=new br(I.count||0);c=new $r(I.targetId,A)}return c}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Ki.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Ki.min():Uo(e.readTime)}(t);return this.listener.Br(e,n)},bh.prototype.Wr=function(t){var e,n,i,r,o={};o.database=Fo(this.serializer),o.addTarget=(e=this.serializer,(i=gr(r=(n=t).target)?{documents:{documents:[jo(e,r.path)]}}:{query:function(t,e){var n={structuredQuery:{}},i=e.path;null!==e.collectionGroup?(n.parent=jo(t,i),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=jo(t,i.g()),n.structuredQuery.from=[{collectionId:i.S()}]);var r=function(t){if(0!==t.length){var e=t.map(function(t){if("=="===t.op){if(Ro(t.value))return{unaryFilter:{field:$o(t.field),op:"IS_NAN"}};if(No(t.value))return{unaryFilter:{field:$o(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Ro(t.value))return{unaryFilter:{field:$o(t.field),op:"IS_NOT_NAN"}};if(No(t.value))return{unaryFilter:{field:$o(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:$o(t.field),op:(e=t.op,_o[e]),value:t.value}};var e});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);r&&(n.structuredQuery.where=r);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:$o((e=t).field),direction:(n=e.dir,So[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,u=(s=e.limit,t.Me||lr(s)?s:{value:s});return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=zo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=zo(e.endAt)),n}(e,r)}).targetId=n.targetId,0<n.resumeToken.Y()&&(i.resumeToken=Co(e,n.resumeToken)),i);var s,u,a=(this.serializer,s=t,null==(u=function(){switch(s.X){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Di()}}())?null:{"goog-listen-tags":u});a&&(o.labels=a),this.Fr(o)},bh.prototype.Qr=function(t){var e={};e.database=Fo(this.serializer),e.removeTarget=t,this.Fr(e)},bh),Qa=(n(wh,xa=Wa),Object.defineProperty(wh.prototype,"Gr",{get:function(){return this.jr},enumerable:!1,configurable:!0}),wh.prototype.start=function(){this.jr=!1,this.lastStreamToken=void 0,xa.prototype.start.call(this)},wh.prototype.$r=function(){this.jr&&this.Kr([])},wh.prototype.Mr=function(t){return this.Pr.Ur("Write",t)},wh.prototype.onMessage=function(t){if(Pi(!!t.streamToken),this.lastStreamToken=t.streamToken,this.jr){this.ks.reset();var e=(i=t.writeResults,r=t.commitTime,i&&0<i.length?(Pi(void 0!==r),i.map(function(t){return function(t,e){var n=t.updateTime?Uo(t.updateTime):Uo(e);n.isEqual(Ki.min())&&(n=Uo(e));var i=null;return t.transformResults&&0<t.transformResults.length&&(i=t.transformResults),new ds(n,i)}(t,r)})):[]),n=Uo(t.commitTime);return this.listener.zr(n,e)}var i,r;return Pi(!t.writeResults||0===t.writeResults.length),this.jr=!0,this.listener.Hr()},wh.prototype.Yr=function(){var t={};t.database=Fo(this.serializer),this.Fr(t)},wh.prototype.Kr=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Go(e.serializer,t)})};this.Fr(n)},wh),Xa=(n(mh,qa=function(){}),mh.prototype.Xr=function(){if(this.Jr)throw new Xi(Qi.FAILED_PRECONDITION,"The client has already been terminated.")},mh.prototype.Zr=function(e,n,i){var r=this;return this.Xr(),this.credentials.getToken().then(function(t){return r.Pr.Zr(e,n,i,t)}).catch(function(t){throw t.code===Qi.UNAUTHENTICATED&&r.credentials.cr(),t})},mh.prototype.to=function(e,n,i){var r=this;return this.Xr(),this.credentials.getToken().then(function(t){return r.Pr.to(e,n,i,t)}).catch(function(t){throw t.code===Qi.UNAUTHENTICATED&&r.credentials.cr(),t})},mh.prototype.terminate=function(){this.Jr=!1},mh),Ya=(gh.prototype.ro=function(){var t=this;0===this.no&&(this.oo("Unknown"),this.so=this.Rs.Ts("online_state_timeout",1e4,function(){return t.so=null,t.ho("Backend didn't respond within 10 seconds."),t.oo("Offline"),Promise.resolve()}))},gh.prototype.ao=function(t){"Online"===this.state?this.oo("Unknown"):(this.no++,1<=this.no&&(this.uo(),this.ho("Connection failed 1 times. Most recent error: "+t.toString()),this.oo("Offline")))},gh.prototype.set=function(t){this.uo(),this.no=0,"Online"===t&&(this.io=!1),this.oo(t)},gh.prototype.oo=function(t){t!==this.state&&(this.state=t,this.eo(t))},gh.prototype.ho=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.io?(_i(e),this.io=!1):Si("OnlineStateTracker",e)},gh.prototype.uo=function(){null!==this.so&&(this.so.cancel(),this.so=null)},gh),Ka=(vh.prototype.start=function(){return this.enableNetwork()},vh.prototype.enableNetwork=function(){return this.wo.delete(0),this.Co()},vh.prototype.Co=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Eo()?(this.Do()?this.Fo():this.Ro.set("Unknown"),[4,this.No()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},vh.prototype.disableNetwork=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.wo.add(0),[4,this.$o()];case 1:return t.sent(),this.Ro.set("Offline"),[2]}})})},vh.prototype.$o=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.po.stop()];case 1:return t.sent(),[4,this.Ao.stop()];case 2:return t.sent(),0<this._o.length&&(Si("RemoteStore","Stopping write stream with "+this._o.length+" pending writes"),this._o=[]),this.ko(),[2]}})})},vh.prototype.Oo=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Si("RemoteStore","RemoteStore shutting down."),this.wo.add(5),[4,this.$o()];case 1:return t.sent(),this.mo.Oo(),this.Ro.set("Unknown"),[2]}})})},vh.prototype.listen=function(t){this.fo.has(t.targetId)||(this.fo.set(t.targetId,t),this.Do()?this.Fo():this.Ao.vr()&&this.xo(t))},vh.prototype.Lo=function(t){this.fo.delete(t),this.Ao.vr()&&this.Mo(t),0===this.fo.size&&(this.Ao.vr()?this.Ao.Cr():this.Eo()&&this.Ro.set("Unknown"))},vh.prototype.Le=function(t){return this.fo.get(t)||null},vh.prototype.xe=function(t){return this.qo.xe(t)},vh.prototype.xo=function(t){this.do.we(t.targetId),this.Ao.Wr(t)},vh.prototype.Mo=function(t){this.do.we(t),this.Ao.Qr(t)},vh.prototype.Fo=function(){this.do=new Zr(this),this.Ao.start(),this.Ro.ro()},vh.prototype.Do=function(){return this.Eo()&&!this.Ao.gr()&&0<this.fo.size},vh.prototype.Eo=function(){return 0===this.wo.size},vh.prototype.ko=function(){this.do=null},vh.prototype.Po=function(){return d(this,void 0,void 0,function(){var n=this;return y(this,function(t){return this.fo.forEach(function(t,e){n.xo(t)}),[2]})})},vh.prototype.Vo=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){return this.ko(),this.Do()?(this.Ro.ao(e),this.Fo()):this.Ro.set("Unknown"),[2]})})},vh.prototype.yo=function(r,o){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:if(this.Ro.set("Online"),!(r instanceof Wr&&2===r.state&&r.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.Uo(r)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Si("RemoteStore","Failed to remove targets %s: %s ",r.targetIds.join(","),e),[4,this.Bo(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(r instanceof zr?this.do.Ve(r):r instanceof $r?this.do.De(r):this.do.ge(r),o.isEqual(Ki.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Ia(this.co)];case 8:return n=t.sent(),0<=o.o(n)?[4,this.Wo(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Si("RemoteStore","Failed to raise snapshot:",i=t.sent()),[4,this.Bo(i)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},vh.prototype.Bo=function(n,i){return d(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:if(!oa(n))throw n;return this.wo.add(1),[4,this.$o()];case 1:return t.sent(),this.Ro.set("Offline"),i=i||function(){return Ia(e.co)},this.Rs.Bs(function(){return d(e,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Si("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),this.wo.delete(1),[4,this.Co()];case 2:return t.sent(),[2]}})})}),[2]}})})},vh.prototype.Qo=function(e){var n=this;return e().catch(function(t){return n.Bo(t,e)})},vh.prototype.Wo=function(i){var r=this,t=this.do.$e(i);return t.Qt.forEach(function(t,e){var n;0<t.resumeToken.Y()&&(n=r.fo.get(e))&&r.fo.set(e,n.et(t.resumeToken,i))}),t.jt.forEach(function(t){var e,n=r.fo.get(t);n&&(r.fo.set(t,n.et(mr.J,n.Z)),r.Mo(t),e=new Ar(n.target,t,1,n.sequenceNumber),r.xo(e))}),this.qo.jo(t)},vh.prototype.Uo=function(o){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){switch(t.label){case 0:e=o.cause,n=0,i=o.targetIds,t.label=1;case 1:return n<i.length?(r=i[n],this.fo.has(r)?[4,this.qo.Go(r,e)]:[3,3]):[3,5];case 2:t.sent(),this.fo.delete(r),this.do.removeTarget(r),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},vh.prototype.No=function(){return d(this,void 0,void 0,function(){var r,o,s;return y(this,function(t){switch(t.label){case 0:r=0<this._o.length?this._o[this._o.length-1].batchId:-1,t.label=1;case 1:if(!this.Ko())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=this.co,n=r,(i=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),i.$n.qi(t,n)}))];case 3:return null===(o=t.sent())?(0===this._o.length&&this.po.Cr(),[3,7]):(r=o.batchId,this.zo(o),[3,6]);case 4:return s=t.sent(),[4,this.Bo(s)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.Ho()&&this.Yo(),[2]}var e,n,i})})},vh.prototype.Ko=function(){return this.Eo()&&this._o.length<10},vh.prototype.Jo=function(){return this._o.length},vh.prototype.zo=function(t){this._o.push(t),this.po.vr()&&this.po.Gr&&this.po.Kr(t.mutations)},vh.prototype.Ho=function(){return this.Eo()&&!this.po.gr()&&0<this._o.length},vh.prototype.Yo=function(){this.po.start()},vh.prototype.vo=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.po.Yr(),[2]})})},vh.prototype.So=function(){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){for(e=0,n=this._o;e<n.length;e++)i=n[e],this.po.Kr(i.mutations);return[2]})})},vh.prototype.zr=function(r,o){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return e=this._o.shift(),n=$u.from(e,r,o),[4,this.Qo(function(){return i.qo.Xo(n)})];case 1:return t.sent(),[4,this.No()];case 2:return t.sent(),[2]}})})},vh.prototype.bo=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e&&this.po.Gr?[4,this.Zo(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Ho()&&this.Yo(),[2]}})})},vh.prototype.Zo=function(r){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return Nr(n=r.code)&&n!==Qi.ABORTED?(e=this._o.shift(),this.po.Sr(),[4,this.Qo(function(){return i.qo.th(e.batchId,r)})]):[3,3];case 1:return t.sent(),[4,this.No()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},vh.prototype.Io=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.wo.add(4),[4,this.$o()];case 1:return t.sent(),this.Ro.set("Unknown"),this.po.Sr(),this.Ao.Sr(),this.wo.delete(4),[4,this.Co()];case 2:return t.sent(),[2]}})})},vh.prototype.eh=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Rs.js(),Si("RemoteStore","RemoteStore received new credentials"),this.wo.add(3),[4,this.$o()];case 1:return t.sent(),this.Ro.set("Unknown"),[4,this.qo.eh(e)];case 2:return t.sent(),this.wo.delete(3),[4,this.Co()];case 3:return t.sent(),[2]}})})},vh.prototype.nh=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e?(this.wo.delete(2),[4,this.Co()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.wo.add(2),[4,this.$o()]);case 3:t.sent(),this.Ro.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},vh),Ja=(yh.prototype.sh=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},yh.prototype.ih=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},yh.prototype.rh=function(){var t={activeTargetIds:this.activeTargetIds.F(),updateTimeMs:Date.now()};return JSON.stringify(t)},yh),Za=(dh.prototype.ah=function(t){},dh.prototype.uh=function(t,e,n){},dh.prototype.lh=function(t){return this.oh.sh(t),this.hh[t]||"not-current"},dh.prototype._h=function(t,e,n){this.hh[t]=e},dh.prototype.fh=function(t){this.oh.ih(t)},dh.prototype.dh=function(t){return this.oh.activeTargetIds.has(t)},dh.prototype.wh=function(t){delete this.hh[t]},dh.prototype.mh=function(){return this.oh.activeTargetIds},dh.prototype.Th=function(t){return this.oh.activeTargetIds.has(t)},dh.prototype.start=function(){return this.oh=new Ja,Promise.resolve()},dh.prototype.Eh=function(t,e,n){},dh.prototype.Ih=function(t){},dh.prototype.Oo=function(){},dh.prototype.ss=function(t){},dh),th=(Object.defineProperty(ph.prototype,"ph",{get:function(){return this.Rh},enumerable:!1,configurable:!0}),ph.prototype.gh=function(t,e){var u=this,a=e?e.vh:new Qr,h=e?e.yh:this.yh,c=e?e.qt:this.qt,l=h,f=!1,p=this.query.an()&&h.size===this.query.limit?h.last():null,d=this.query.un()&&h.size===this.query.limit?h.first():null;if(t.ht(function(t,e){var n=h.get(t),i=(i=e instanceof Hs?e:null)&&(fu(u.query,i)?i:null),r=!!n&&u.qt.has(n.key),o=!!i&&(i.Ke||u.qt.has(i.key)&&i.hasCommittedMutations),s=!1;n&&i?n.data().isEqual(i.data())?r!==o&&(a.track({type:3,doc:i}),s=!0):u.bh(n,i)||(a.track({type:2,doc:i}),s=!0,(p&&0<u.Vh(i,p)||d&&u.Vh(i,d)<0)&&(f=!0)):!n&&i?(a.track({type:0,doc:i}),s=!0):n&&!i&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(f=!0)),s&&(c=i?(l=l.add(i),o?c.add(t):c.delete(t)):(l=l.delete(t),c.delete(t)))}),this.query.an()||this.query.un())for(;l.size>this.query.limit;){var n=this.query.an()?l.last():l.first(),l=l.delete(n.key),c=c.delete(n.key);a.track({type:1,doc:n})}return{yh:l,vh:a,Sh:f,qt:c}},ph.prototype.bh=function(t,e){return t.Ke&&e.hasCommittedMutations&&!e.Ke},ph.prototype.Ch=function(t,e,n){var o=this,i=this.yh;this.yh=t.yh,this.qt=t.qt;var r=t.vh.Lt();r.sort(function(t,e){return i=t.type,r=e.type,n(i)-n(r)||o.Vh(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Di()}}var i,r}),this.Dh(n);var s=e?this.Fh():[],u=0===this.Ph.size&&this.Yt?1:0,a=u!==this.Ah;return this.Ah=u,0!==r.length||a?{snapshot:new Xr(this.query,t.yh,i,r,t.qt,0==u,a,!1),Nh:s}:{Nh:s}},ph.prototype.$h=function(t){return this.Yt&&"Offline"===t?(this.Yt=!1,this.Ch({yh:this.yh,vh:new Qr,qt:this.qt,Sh:!1},!1)):{Nh:[]}},ph.prototype.kh=function(t){return!this.Rh.has(t)&&!!this.yh.has(t)&&!this.yh.get(t).Ke},ph.prototype.Dh=function(t){var e=this;t&&(t.Jt.forEach(function(t){return e.Rh=e.Rh.add(t)}),t.Xt.forEach(function(t){}),t.Zt.forEach(function(t){return e.Rh=e.Rh.delete(t)}),this.Yt=t.Yt)},ph.prototype.Fh=function(){var e=this;if(!this.Yt)return[];var n=this.Ph;this.Ph=Br(),this.yh.forEach(function(t){e.kh(t.key)&&(e.Ph=e.Ph.add(t.key))});var i=[];return n.forEach(function(t){e.Ph.has(t)||i.push(new Va(t))}),this.Ph.forEach(function(t){n.has(t)||i.push(new Pa(t))}),i},ph.prototype.Oh=function(t){this.Rh=t.Wi,this.Ph=Br();var e=this.gh(t.documents);return this.Ch(e,!0)},ph.prototype.xh=function(){return Xr.Wt(this.query,this.yh,this.qt,0===this.Ah)},ph),eh=(Object.defineProperty(fh.prototype,"Zh",{get:function(){return!0===this.Xh},enumerable:!1,configurable:!0}),fh.prototype.subscribe=function(t){this.Bh=t},fh.prototype.listen=function(h){return d(this,void 0,void 0,function(){var n,o,s,u,a;return y(this,function(t){switch(t.label){case 0:return this.ta("listen()"),(s=this.Wh.get(h))?(n=s.targetId,this.qh.lh(n),o=s.view.xh(),[3,4]):[3,1];case 1:return[4,(e=this.co,i=ou(h),(r=e).persistence.runTransaction("Allocate target","readwrite",function(e){var n;return r.Ii.Ui(e,i).next(function(t){return t?(n=t,Wu.resolve(n)):r.Ii.ea(e).next(function(t){return n=new Ar(i,t,0,e.$i),r.Ii.na(e,n).next(function(){return n})})})}).then(function(t){var e=r.fi.get(t.targetId);return(null===e||0<t.Z.o(e.Z))&&(r.fi=r.fi.st(t.targetId,t),r.di.set(i,t.targetId)),t}))];case 2:return u=t.sent(),a=this.qh.lh(u.targetId),n=u.targetId,[4,this.sa(h,n,"current"===a)];case 3:o=t.sent(),this.Zh&&this.Mh.listen(u),t.label=4;case 4:return[2,o]}var e,i,r})})},fh.prototype.sa=function(u,a,h){return d(this,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:return[4,Ta(this.co,u,!0)];case 1:return e=t.sent(),n=new th(u,e.Wi),i=n.gh(e.documents),r=Kr.Ht(a,h&&"Offline"!==this.onlineState),o=n.Ch(i,this.Zh,r),this.ia(a,o.Nh),s=new Ca(u,a,n),[2,(this.Wh.set(u,s),this.Qh.has(a)?this.Qh.get(a).push(u):this.Qh.set(a,[u]),o.snapshot)]}})})},fh.prototype.Lo=function(r){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return this.ta("unlisten()"),e=this.Wh.get(r),1<(n=this.Qh.get(e.targetId)).length?[2,(this.Qh.set(e.targetId,n.filter(function(t){return!hu(t,r)})),void this.Wh.delete(r))]:this.Zh?(this.qh.fh(e.targetId),this.qh.Th(e.targetId)?[3,2]:[4,Aa(this.co,e.targetId,!1).then(function(){i.qh.wh(e.targetId),i.Mh.Lo(e.targetId),i.ra(e.targetId)}).catch(Na)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.ra(e.targetId),[4,Aa(this.co,e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},fh.prototype.write=function(s,u){return d(this,void 0,void 0,function(){var i,r,o;return y(this,function(t){switch(t.label){case 0:this.ta("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(e=this.co,h=s,l=e,f=Yi.now(),n=h.reduce(function(t,e){return t.add(e.key)},Br()),l.persistence.runTransaction("Locally write mutations","readwrite",function(a){return l.Ai.Un(a,n).next(function(t){c=t;for(var u,e,n=[],i=0,r=h;i<r.length;i++){var o=r[i],s=(u=o,e=c.get(o.key),u instanceof Os?function(t){for(var e=null,n=0,i=u.fieldTransforms;n<i.length;n++){var r=i[n],o=t instanceof Hs?t.field(r.field):void 0,s=Qo(r.transform,o||null);null!=s&&(e=null==e?(new qs).set(r.field,s):e.set(r.field,s))}return e?e.ze():null}(e):null);null!=s&&n.push(new Ns(o.key,s,function u(t){var a=[];return Bi(t.fields||{},function(t,e){var n=new er([t]);if(ko(e)){var i=u(e.mapValue).fields;if(0===i.length)a.push(n);else for(var r=0,o=i;r<o.length;r++){var s=o[r];a.push(n.child(s))}}else a.push(n)}),new fs(a)}(s.proto.mapValue),ys.exists(!0)))}return l.$n.oa(a,f,n,h)})}).then(function(t){var e=t.Rn(c);return{batchId:t.batchId,ha:e}}))];case 2:return i=t.sent(),this.qh.ah(i.batchId),this.aa(i.batchId,u),[4,this.ua(i.ha)];case 3:return t.sent(),[4,this.Mh.No()];case 4:return t.sent(),[3,6];case 5:return r=t.sent(),o=la(r,"Failed to persist write"),u.reject(o),[3,6];case 6:return[2]}var e,h,c,l,f,n})})},fh.prototype.jo=function(r){return d(this,void 0,void 0,function(){var n,i=this;return y(this,function(t){switch(t.label){case 0:this.ta("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=this.co,c=e,l=(s=r).Z,f=c.fi,c.persistence.runTransaction("Apply remote event","readwrite-primary",function(a){var r=c.Ti.gi({vi:!0});f=c.fi;var h=[];s.Qt.forEach(function(t,e){var n,i,r,o,s,u=f.get(e);u&&(h.push(c.Ii.Fi(a,t.Zt,e).next(function(){return c.Ii.Ni(a,t.Jt,e)})),0<(n=t.resumeToken).Y()&&(i=u.et(n,l).tt(a.$i),f=f.st(e,i),r=u,s=t,Pi(0<(o=i).resumeToken.Y()),(0===r.resumeToken.Y()||3e8<=o.Z.I()-r.Z.I()||0<s.Jt.size+s.Xt.size+s.Zt.size)&&h.push(c.Ii.ki(a,i))))});var t,o=Ur,n=Br();return s.Gt.forEach(function(t,e){n=n.add(t)}),h.push(r.getEntries(a,n).next(function(i){s.Gt.forEach(function(t,e){var n=i.get(t);e instanceof Qs&&e.version.isEqual(Ki.min())?(r.Oi(t,l),o=o.st(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(r.bi(e,l),o=o.st(t,e)):Si("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),s.Kt.has(t)&&h.push(c.persistence.Li.xi(a,t))})})),l.isEqual(Ki.min())||(t=c.Ii.Di(a).next(function(t){return c.Ii.Mi(a,a.$i,l)}),h.push(t)),Wu.Dn(h).next(function(){return r.apply(a)}).next(function(){return c.Ai.Bn(a,o)})}).then(function(t){return c.fi=f,t}))];case 2:return n=t.sent(),r.Qt.forEach(function(t,e){var n=i.Kh.get(e);n&&(Pi(t.Jt.size+t.Xt.size+t.Zt.size<=1),0<t.Jt.size?n.Lh=!0:0<t.Xt.size?Pi(n.Lh):0<t.Zt.size&&(Pi(n.Lh),n.Lh=!1))}),[4,this.ua(n,r)];case 3:return t.sent(),[3,6];case 4:return[4,Na(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,s,c,l,f})})},fh.prototype.$h=function(i,t){var r;(this.Zh&&0===t||!this.Zh&&1===t)&&(this.ta("applyOnlineStateChange()"),r=[],this.Wh.forEach(function(t,e){var n=e.view.$h(i);n.snapshot&&r.push(n.snapshot)}),this.Bh.ca(i),this.Bh.Br(r),this.onlineState=i,this.Zh&&this.qh.Ih(i))},fh.prototype.Go=function(u,a){return d(this,void 0,void 0,function(){var e,n,i,r,o,s=this;return y(this,function(t){switch(t.label){case 0:return this.ta("rejectListens()"),this.qh._h(u,"rejected",a),e=this.Kh.get(u),(n=e&&e.key)?(i=(i=new kr(nr.P)).st(n,new Qs(n,Ki.min())),r=Br().add(n),o=new Yr(Ki.min(),new Map,new Vr(Ui),i,r),[4,this.jo(o)]):[3,2];case 1:return t.sent(),this.Gh=this.Gh.remove(n),this.Kh.delete(u),this.la(),[3,4];case 2:return[4,Aa(this.co,u,!1).then(function(){return s.ra(u,a)}).catch(Na)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},fh.prototype.Xo=function(r){return d(this,void 0,void 0,function(){var n,i;return y(this,function(t){switch(t.label){case 0:this.ta("applySuccessfulWrite()"),n=r.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=this.co,c=r,(l=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=c.batch.keys(),n=l.Ti.gi({vi:!0}),i=l,o=t,s=n,u=(r=c).batch,a=u.keys(),h=Wu.resolve();return a.forEach(function(i){h=h.next(function(){return s.Mn(o,i)}).next(function(t){var e=t,n=r.Pn.get(i);Pi(null!==n),(!e||e.version.o(n)<0)&&(e=u.Tn(i,e,r))&&s.bi(e,r.An)})}),h.next(function(){return i.$n.Si(o,u)}).next(function(){return n.apply(t)}).next(function(){return l.$n.Ci(t)}).next(function(){return l.Ai.Un(t,e)})}))];case 2:return i=t.sent(),this._a(n,null),this.fa(n),this.qh.uh(n,"acknowledged"),[4,this.ua(i)];case 3:return t.sent(),[3,6];case 4:return[4,Na(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,c,l})})},fh.prototype.th=function(o,s){return d(this,void 0,void 0,function(){var n;return y(this,function(t){switch(t.label){case 0:this.ta("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=this.co,i=o,(r=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return r.$n.da(e,i).next(function(t){return Pi(null!==t),n=t.keys(),r.$n.Si(e,t)}).next(function(){return r.$n.Ci(e)}).next(function(){return r.Ai.Un(e,n)})}))];case 2:return n=t.sent(),this._a(o,s),this.fa(o),this.qh.uh(o,"rejected",s),[4,this.ua(n)];case 3:return t.sent(),[3,6];case 4:return[4,Na(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,i,r})})},fh.prototype.wa=function(u){return d(this,void 0,void 0,function(){var i,r,o,s;return y(this,function(t){switch(t.label){case 0:this.Mh.Eo()||Si("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=this.co,(n=e).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return n.$n.ma(t)}))];case 2:return-1===(i=t.sent())?[2,void u.resolve()]:((r=this.Yh.get(i)||[]).push(u),this.Yh.set(i,r),[3,4]);case 3:return o=t.sent(),s=la(o,"Initialization of waitForPendingWrites() operation failed"),u.reject(s),[3,4];case 4:return[2]}var e,n})})},fh.prototype.fa=function(t){(this.Yh.get(t)||[]).forEach(function(t){t.resolve()}),this.Yh.delete(t)},fh.prototype.Ta=function(e){this.Yh.forEach(function(t){t.forEach(function(t){t.reject(new Xi(Qi.CANCELLED,e))})}),this.Yh.clear()},fh.prototype.aa=function(t,e){var n=(n=(n=this.Hh[this.currentUser.rr()])||new kr(Ui)).st(t,e);this.Hh[this.currentUser.rr()]=n},fh.prototype._a=function(t,e){var n,i=this.Hh[this.currentUser.rr()];i&&((n=i.get(t))&&(e?n.reject(e):n.resolve(),i=i.remove(t)),this.Hh[this.currentUser.rr()]=i)},fh.prototype.ra=function(t,e){var n=this;void 0===e&&(e=null),this.qh.fh(t);for(var i=0,r=this.Qh.get(t);i<r.length;i++){var o=r[i];this.Wh.delete(o),e&&this.Bh.Ea(o,e)}this.Qh.delete(t),this.Zh&&this.zh.Zi(t).forEach(function(t){n.zh.nr(t)||n.Ia(t)})},fh.prototype.Ia=function(t){var e=this.Gh.get(t);null!==e&&(this.Mh.Lo(e),this.Gh=this.Gh.remove(t),this.Kh.delete(e),this.la())},fh.prototype.ia=function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n];r instanceof Pa?(this.zh.zi(r.key,t),this.Ra(r)):r instanceof Va?(Si("SyncEngine","Document no longer in limbo: "+r.key),this.zh.Yi(r.key,t),this.zh.nr(r.key)||this.Ia(r.key)):Di()}},fh.prototype.Ra=function(t){var e=t.key;this.Gh.get(e)||(Si("SyncEngine","New document in limbo: "+e),this.jh.push(e),this.la())},fh.prototype.la=function(){for(;0<this.jh.length&&this.Gh.size<this.Uh;){var t=this.jh.shift(),e=this.Jh.next();this.Kh.set(e,new Ua(t)),this.Gh=this.Gh.st(t,e),this.Mh.listen(new Ar(ou(nu(t.path)),e,2,Xu.rs))}},fh.prototype.Aa=function(){return this.Gh},fh.prototype.Pa=function(){return this.jh},fh.prototype.ua=function(i,a){return d(this,void 0,void 0,function(){var o,s,e,u=this;return y(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.Wh.forEach(function(t,r){e.push(Promise.resolve().then(function(){var n=r.view.gh(i);return n.Sh?Ta(u.co,r.query,!1).then(function(t){var e=t.documents;return r.view.gh(e,n)}):n}).then(function(t){var e,n=a&&a.Qt.get(r.targetId),i=r.view.Ch(t,u.Zh,n);u.ia(r.targetId,i.Nh),i.snapshot&&(u.Zh&&u.qh._h(r.targetId,i.snapshot.fromCache?"not-current":"current"),o.push(i.snapshot),e=Qu.Zn(r.targetId,i.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.Bh.Br(o),[4,function(c,l){return d(this,void 0,void 0,function(){var i,e,n,r,o,s,u,a,h;return y(this,function(t){switch(t.label){case 0:i=c,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,i.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Wu.forEach(l,function(e){return Wu.forEach(e.Jn,function(t){return i.persistence.Li.zi(n,e.targetId,t)}).next(function(){return Wu.forEach(e.Xn,function(t){return i.persistence.Li.Yi(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!oa(e=t.sent()))throw e;return Si("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,r=l;n<r.length;n++)o=r[n],s=o.targetId,o.fromCache||(u=i.fi.get(s),a=u.Z,h=u.nt(a),i.fi=i.fi.st(s,h));return[2]}})})}(this.co,s)];case 2:return t.sent(),[2]}})})},fh.prototype.ta=function(t){},fh.prototype.eh=function(n){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(Si("SyncEngine","User change. New user:",n.rr()),[4,function(r,o){return d(this,void 0,void 0,function(){var e,n,m,i;return y(this,function(t){switch(t.label){case 0:return n=(e=r).$n,m=e.Ai,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.$n.Va(v).next(function(t){return g=t,n=e.persistence.mi(o),m=new Hu(e.Ti,n,e.persistence.Pi()),n.Va(v)}).next(function(t){for(var e=[],n=[],i=Br(),r=0,o=g;r<o.length;r++){var s=o[r];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],i=i.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];i=i.add(y.key)}}return m.Un(v,i).next(function(t){return{ya:t,pa:e,ga:n}})})})];case 1:return i=t.sent(),[2,(e.$n=n,e.Ai=m,e._i.Vi(e.Ai),i)]}})})}(this.co,n)]);case 1:return e=t.sent(),this.currentUser=n,this.Ta("'waitForPendingWrites' promise is rejected due to a user change."),this.qh.Eh(n,e.pa,e.ga),[4,this.ua(e.ya)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},fh.prototype.xe=function(t){var e=this.Kh.get(t);if(e&&e.Lh)return Br().add(e.key);var n=Br(),i=this.Qh.get(t);if(!i)return n;for(var r=0,o=i;r<o.length;r++)var s=o[r],u=this.Wh.get(s),n=n.Ft(u.view.ph);return n},fh),nh=(lh.prototype.listen=function(u){return d(this,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(i=this.ba.get(e))||(n=!0,i=new Ma),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),r=i,[4,this.qo.listen(e)];case 2:return r.va=t.sent(),[3,4];case 3:return o=t.sent(),s=la(o,"Initialization of query '"+lu(u.query)+"' failed"),[2,void u.onError(s)];case 4:return this.ba.set(e,i),i.listeners.push(u),u.$h(this.onlineState),i.va&&u.Ca(i.va)&&this.Da(),[2]}})})},lh.prototype.Lo=function(o){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){return e=o.query,n=!1,(i=this.ba.get(e))&&0<=(r=i.listeners.indexOf(o))&&(i.listeners.splice(r,1),n=0===i.listeners.length),n?[2,(this.ba.delete(e),this.qo.Lo(e))]:[2]})})},lh.prototype.Br=function(t){for(var e=!1,n=0,i=t;n<i.length;n++){var r=i[n],o=r.query,s=this.ba.get(o);if(s){for(var u=0,a=s.listeners;u<a.length;u++)a[u].Ca(r)&&(e=!0);s.va=r}}e&&this.Da()},lh.prototype.Ea=function(t,e){var n=this.ba.get(t);if(n)for(var i=0,r=n.listeners;i<r.length;i++)r[i].onError(e);this.ba.delete(t)},lh.prototype.ca=function(r){this.onlineState=r;var o=!1;this.ba.forEach(function(t,e){for(var n=0,i=e.listeners;n<i.length;n++)i[n].$h(r)&&(o=!0)}),o&&this.Da()},lh.prototype.Fa=function(t){this.Sa.add(t),t.next()},lh.prototype.Na=function(t){this.Sa.delete(t)},lh.prototype.Da=function(){this.Sa.forEach(function(t){t.next()})},lh),ih=(ch.prototype.Ca=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,i=t.docChanges;n<i.length;n++){var r=i[n];3!==r.type&&e.push(r)}t=new Xr(t.query,t.docs,t.Mt,e,t.qt,t.fromCache,t.Ut,!0)}var o=!1;return this.ka?this.xa(t)&&(this.$a.next(t),o=!0):this.La(t,this.onlineState)&&(this.Ma(t),o=!0),this.Oa=t,o},ch.prototype.onError=function(t){this.$a.error(t)},ch.prototype.$h=function(t){this.onlineState=t;var e=!1;return this.Oa&&!this.ka&&this.La(this.Oa,t)&&(this.Ma(this.Oa),e=!0),e},ch.prototype.La=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.qa&&n||t.docs._()&&"Offline"!==e)},ch.prototype.xa=function(t){if(0<t.docChanges.length)return!0;var e=this.Oa&&this.Oa.hasPendingWrites!==t.hasPendingWrites;return!(!t.Ut&&!e)&&!0===this.options.includeMetadataChanges},ch.prototype.Ma=function(t){t=Xr.Wt(t.query,t.docs,t.qt,t.fromCache),this.ka=!0,this.$a.next(t)},ch),rh=(hh.prototype.Vi=function(t){this.Ua=t},hh.prototype.Qn=function(e,i,r,o){var s=this;return i.hn()||r.isEqual(Ki.min())?this.Ba(e,i):this.Ua.Un(e,o).next(function(t){var n=s.Wa(i,t);return(i.an()||i.un())&&s.Sh(i.nn,n,o,r)?s.Ba(e,i):(ki()<=u.DEBUG&&Si("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),lu(i)),s.Ua.Qn(e,i,r).next(function(e){return n.forEach(function(t){e=e.st(t.key,t)}),e}))})},hh.prototype.Wa=function(n,t){var i=new Vr(pu(n));return t.forEach(function(t,e){e instanceof Hs&&fu(n,e)&&(i=i.add(e))}),i},hh.prototype.Sh=function(t,e,n,i){if(n.size!==e.size)return!0;var r="F"===t?e.last():e.first();return!!r&&(r.hasPendingWrites||0<r.version.o(i))},hh.prototype.Ba=function(t,e){return ki()<=u.DEBUG&&Si("IndexFreeQueryEngine","Using full collection scan to execute query:",lu(e)),this.Ua.Qn(t,e,Ki.min())},hh),oh=(ah.prototype.Ga=function(t){return Wu.resolve(0===this.$n.length)},ah.prototype.oa=function(t,e,n,i){var r=this.Qa;this.Qa++,0<this.$n.length&&this.$n[this.$n.length-1];var o=new zu(r,e,n,i);this.$n.push(o);for(var s=0,u=i;s<u.length;s++){var a=u[s];this.ja=this.ja.add(new ka(a.key,r)),this.kn.ai(t,a.key.path.g())}return Wu.resolve(o)},ah.prototype.da=function(t,e){return Wu.resolve(this.Ka(e))},ah.prototype.qi=function(t,e){var n=e+1,i=this.za(n),r=i<0?0:i;return Wu.resolve(this.$n.length>r?this.$n[r]:null)},ah.prototype.ma=function(){return Wu.resolve(0===this.$n.length?-1:this.Qa-1)},ah.prototype.Va=function(t){return Wu.resolve(this.$n.slice())},ah.prototype.xn=function(t,e){var n=this,i=new ka(e,0),r=new ka(e,Number.POSITIVE_INFINITY),o=[];return this.ja.St([i,r],function(t){var e=n.Ka(t.sr);o.push(e)}),Wu.resolve(o)},ah.prototype.Wn=function(t,e){var i=this,r=new Vr(Ui);return e.forEach(function(t){var e=new ka(t,0),n=new ka(t,Number.POSITIVE_INFINITY);i.ja.St([e,n],function(t){r=r.add(t.sr)})}),Wu.resolve(this.Ha(r))},ah.prototype.Hn=function(t,e){var n=e.path,i=n.length+1,r=n;nr.j(r)||(r=r.child(""));var o=new ka(new nr(r),0),s=new Vr(Ui);return this.ja.Ct(function(t){var e=t.key.path;return!!n.C(e)&&(e.length===i&&(s=s.add(t.sr)),!0)},o),Wu.resolve(this.Ha(s))},ah.prototype.Ha=function(t){var n=this,i=[];return t.forEach(function(t){var e=n.Ka(t);null!==e&&i.push(e)}),i},ah.prototype.Si=function(n,i){var r=this;Pi(0===this.Ya(i.batchId,"removed")),this.$n.shift();var o=this.ja;return Wu.forEach(i.mutations,function(t){var e=new ka(t.key,i.batchId);return o=o.delete(e),r.Li.Ja(n,t.key)}).next(function(){r.ja=o})},ah.prototype.Xa=function(t){},ah.prototype.nr=function(t,e){var n=new ka(e,0),i=this.ja.Dt(n);return Wu.resolve(e.isEqual(i&&i.key))},ah.prototype.Ci=function(t){return this.$n.length,Wu.resolve()},ah.prototype.Ya=function(t,e){return this.za(t)},ah.prototype.za=function(t){return 0===this.$n.length?0:t-this.$n[0].batchId},ah.prototype.Ka=function(t){var e=this.za(t);return e<0||e>=this.$n.length?null:this.$n[e]},ah),sh=(uh.prototype.bi=function(t,e,n){var i=e.key,r=this.docs.get(i),o=r?r.size:0,s=this.Za(e);return this.docs=this.docs.st(i,{tu:e,size:s,readTime:n}),this.size+=s-o,this.kn.ai(t,i.path.g())},uh.prototype.Oi=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},uh.prototype.Mn=function(t,e){var n=this.docs.get(e);return Wu.resolve(n?n.tu:null)},uh.prototype.getEntries=function(t,e){var n=this,i=Ur;return e.forEach(function(t){var e=n.docs.get(t);i=i.st(t,e?e.tu:null)}),Wu.resolve(i)},uh.prototype.Qn=function(t,e,n){for(var i=xr,r=new nr(e.path.child("")),o=this.docs.ct(r);o.Tt();){var s=o.wt(),u=s.key,a=s.value,h=a.tu,c=a.readTime;if(!e.path.C(u.path))break;c.o(n)<=0||h instanceof Hs&&fu(e,h)&&(i=i.st(h.key,h))}return Wu.resolve(i)},uh.prototype.eu=function(t,e){return Wu.forEach(this.docs,function(t){return e(t)})},uh.prototype.gi=function(t){return new uh.nu(this)},uh.prototype.su=function(t){return Wu.resolve(this.size)},uh);function uh(t,e){this.kn=t,this.Za=e,this.docs=new kr(nr.P),this.size=0}function ah(t,e){this.kn=t,this.Li=e,this.$n=[],this.Qa=1,this.ja=new Vr(ka.ji)}function hh(){}function ch(t,e,n){this.query=t,this.$a=e,this.ka=!1,this.Oa=null,this.onlineState="Unknown",this.options=n||{}}function lh(t){this.qo=t,this.ba=new Hi(cu,hu),this.onlineState="Unknown",this.Sa=new Set,this.qo.subscribe(this)}function fh(t,e,n,i,r,o){this.co=t,this.Mh=e,this.lo=n,this.qh=i,this.currentUser=r,this.Uh=o,this.Bh=null,this.Wh=new Hi(cu,hu),this.Qh=new Map,this.jh=[],this.Gh=new kr(nr.P),this.Kh=new Map,this.zh=new Ra,this.Hh={},this.Yh=new Map,this.Jh=va.li(),this.onlineState="Unknown",this.Xh=void 0}function ph(t,e){this.query=t,this.Rh=e,this.Ah=null,this.Yt=!1,this.Ph=Br(),this.qt=Br(),this.Vh=pu(t),this.yh=new Hr(this.Vh)}function dh(){this.oh=new Ja,this.hh={},this.eo=null,this.ts=null}function yh(){this.activeTargetIds=Gr}function vh(t,e,n,i,r){var o,s,u,a,h,c,l,f,p=this;this.co=t,this.lo=e,this.Rs=n,this._o=[],this.fo=new Map,this.do=null,this.wo=new Set,this.mo=r,this.mo.To(function(t){n.vs(function(){return d(p,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.Eo()?(Si("RemoteStore","Restarting streams for network reachability change."),[4,this.Io()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Ro=new Ya(n,i),this.Ao=(h=this.lo,c=n,l={qr:this.Po.bind(this),kr:this.Vo.bind(this),Br:this.yo.bind(this)},(f=h).Xr(),new Ha(c,f.Pr,f.credentials,f.serializer,l)),this.po=(o=this.lo,s=n,u={qr:this.vo.bind(this),kr:this.bo.bind(this),Hr:this.So.bind(this),zr:this.zr.bind(this)},(a=o).Xr(),new Qa(s,a.Pr,a.credentials,a.serializer,u))}function gh(t,e){this.Rs=t,this.eo=e,this.state="Unknown",this.no=0,this.so=null,this.io=!0}function mh(t,e,n){var i=this;return(i=qa.call(this)||this).credentials=t,i.Pr=e,i.serializer=n,i.Jr=!1,i}function wh(t,e,n,i,r){var o=this;return(o=xa.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,r)||this).serializer=i,o.jr=!1,o}function bh(t,e,n,i,r){var o=this;return(o=ja.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,r)||this).serializer=i,o}function Eh(t,e,n,i,r,o){this.os=t,this.Ar=n,this.Pr=i,this.Vr=r,this.listener=o,this.state=0,this.yr=0,this.pr=null,this.stream=null,this.ks=new ia(t,e)}function Ih(t,e){this.Er=t,this.Ir=e}function Ah(t,e){this.Er=t,this.Ir=e,this.type="FirstParty",this.user=Sa.hr}function Th(t){var e=this;this.dr=null,this.currentUser=Sa.UNAUTHENTICATED,this.wr=!1,this.mr=0,this.ur=null,this.forceRefresh=!1,this.dr=function(){e.mr++,e.currentUser=e.Tr(),e.wr=!0,e.ur&&e.ur(e.currentUser)},this.mr=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.dr):(this.dr(null),t.get().then(function(t){e.auth=t,e.dr&&e.auth.addAuthTokenListener(e.dr)},function(){}))}function Nh(){this.ur=null}function Rh(t){var e=this;return(e=Fa.call(this)||this).uu=t,e}function kh(){this.ha=new Hi(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.iu=!1}sh.nu=(Object.defineProperty(kh.prototype,"readTime",{get:function(){return this.ru},set:function(t){this.ru=t},enumerable:!1,configurable:!0}),kh.prototype.bi=function(t,e){this.ou(),this.readTime=e,this.ha.set(t.key,t)},kh.prototype.Oi=function(t,e){this.ou(),e&&(this.readTime=e),this.ha.set(t,null)},kh.prototype.Mn=function(t,e){this.ou();var n=this.ha.get(e);return void 0!==n?Wu.resolve(n):this.hu(t,e)},kh.prototype.getEntries=function(t,e){return this.au(t,e)},kh.prototype.apply=function(t){return this.ou(),this.iu=!0,this.Ch(t)},kh.prototype.ou=function(){},n(Rh,Fa=kh),Rh.prototype.Ch=function(n){var i=this,r=[];return this.ha.forEach(function(t,e){e?r.push(i.uu.bi(n,e,i.readTime)):i.uu.Oi(t)}),Wu.Dn(r)},Rh.prototype.hu=function(t,e){return this.uu.Mn(t,e)},Rh.prototype.au=function(t,e){return this.uu.getEntries(t,e)},Rh);var Sh,_h,Oh=(Qh.prototype.ve=function(t,n){return this.cu.forEach(function(t,e){return n(e)}),Wu.resolve()},Qh.prototype.Di=function(t){return Wu.resolve(this.lastRemoteSnapshotVersion)},Qh.prototype.du=function(t){return Wu.resolve(this.lu)},Qh.prototype.ea=function(t){return this.highestTargetId=this.fu.next(),Wu.resolve(this.highestTargetId)},Qh.prototype.Mi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.lu&&(this.lu=e),Wu.resolve()},Qh.prototype.wu=function(t){this.cu.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.fu=new va(e),this.highestTargetId=e),t.sequenceNumber>this.lu&&(this.lu=t.sequenceNumber)},Qh.prototype.na=function(t,e){return this.wu(e),this.targetCount+=1,Wu.resolve()},Qh.prototype.ki=function(t,e){return this.wu(e),Wu.resolve()},Qh.prototype.mu=function(t,e){return this.cu.delete(e.target),this._u.Zi(e.targetId),--this.targetCount,Wu.resolve()},Qh.prototype.Tu=function(n,i,r){var o=this,s=0,u=[];return this.cu.forEach(function(t,e){e.sequenceNumber<=i&&null===r.get(e.targetId)&&(o.cu.delete(t),u.push(o.Eu(n,e.targetId)),s++)}),Wu.Dn(u).next(function(){return s})},Qh.prototype.Iu=function(t){return Wu.resolve(this.targetCount)},Qh.prototype.Ui=function(t,e){var n=this.cu.get(e)||null;return Wu.resolve(n)},Qh.prototype.Ni=function(t,e,n){return this._u.Hi(e,n),Wu.resolve()},Qh.prototype.Fi=function(e,t,n){this._u.Xi(t,n);var i=this.persistence.Li,r=[];return i&&t.forEach(function(t){r.push(i.Ja(e,t))}),Wu.Dn(r)},Qh.prototype.Eu=function(t,e){return this._u.Zi(e),Wu.resolve()},Qh.prototype.Bi=function(t,e){var n=this._u.er(e);return Wu.resolve(n)},Qh.prototype.nr=function(t,e){return Wu.resolve(this._u.nr(e))},Qh),Lh=(Hh.prototype.start=function(){return Promise.resolve()},Hh.prototype.Oo=function(){return this.Pu=!1,Promise.resolve()},Object.defineProperty(Hh.prototype,"yu",{get:function(){return this.Pu},enumerable:!1,configurable:!0}),Hh.prototype.pu=function(){},Hh.prototype.gu=function(){},Hh.prototype.Pi=function(){return this.kn},Hh.prototype.mi=function(t){var e=this.Ru[t.rr()];return e||(e=new oh(this.kn,this.Li),this.Ru[t.rr()]=e),e},Hh.prototype.Ri=function(){return this.Ii},Hh.prototype.Ei=function(){return this.Nn},Hh.prototype.runTransaction=function(t,e,n){var i=this;Si("MemoryPersistence","Starting transaction:",t);var r=new Dh(this.Au.next());return this.Li.vu(),n(r).next(function(t){return i.Li.bu(r).next(function(){return t})}).Sn().then(function(t){return r.Su(),t})},Hh.prototype.Cu=function(e,n){return Wu.Fn(Object.values(this.Ru).map(function(t){return function(){return t.nr(e,n)}}))},Hh),Dh=(Wh.prototype.Fu=function(t){this.Du.push(t)},Wh.prototype.Su=function(){this.Du.forEach(function(t){return t()})},n($h,_h=Wh),$h),Ph=(zh.ku=function(t){return new zh(t)},Object.defineProperty(zh.prototype,"Ou",{get:function(){if(this.$u)return this.$u;throw Di()},enumerable:!1,configurable:!0}),zh.prototype.zi=function(t,e,n){return this.Nu.zi(n,e),this.Ou.delete(n.toString()),Wu.resolve()},zh.prototype.Yi=function(t,e,n){return this.Nu.Yi(n,e),this.Ou.add(n.toString()),Wu.resolve()},zh.prototype.Ja=function(t,e){return this.Ou.add(e.toString()),Wu.resolve()},zh.prototype.removeTarget=function(t,e){var n=this;this.Nu.Zi(e.targetId).forEach(function(t){return n.Ou.add(t.toString())});var i=this.persistence.Ri();return i.Bi(t,e.targetId).next(function(t){t.forEach(function(t){return n.Ou.add(t.toString())})}).next(function(){return i.mu(t,e)})},zh.prototype.vu=function(){this.$u=new Set},zh.prototype.bu=function(n){var i=this,r=this.persistence.Ei().gi();return Wu.forEach(this.Ou,function(t){var e=nr.U(t);return i.xu(n,e).next(function(t){t||r.Oi(e)})}).next(function(){return i.$u=null,r.apply(n)})},zh.prototype.xi=function(t,e){var n=this;return this.xu(t,e).next(function(t){t?n.Ou.delete(e.toString()):n.Ou.add(e.toString())})},zh.prototype.Vu=function(t){return 0},zh.prototype.xu=function(t,e){var n=this;return Wu.Fn([function(){return Wu.resolve(n.Nu.nr(e))},function(){return n.persistence.Ri().nr(t,e)},function(){return n.persistence.Cu(t,e)}])},zh),Vh=(Gh.prototype.qr=function(t){this.qu=t},Gh.prototype.kr=function(t){this.Uu=t},Gh.prototype.onMessage=function(t){this.Bu=t},Gh.prototype.close=function(){this.Mu()},Gh.prototype.send=function(t){this.Lu(t)},Gh.prototype.Wu=function(){this.qu()},Gh.prototype.Qu=function(t){this.Uu(t)},Gh.prototype.ju=function(t){this.Bu(t)},Gh),Ch={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Uh=(Bh.prototype.Zr=function(e,t,n,i){var r=this.Hu(e,t);Si("RestConnection","Sending: ",r,n);var o={};return this.Yu(o,i),this.Ju(e,r,o,n).then(function(t){return Si("RestConnection","Received: ",t),t},function(t){throw Oi("RestConnection",e+" failed with error: ",t,"url: ",r,"request:",n),t})},Bh.prototype.to=function(t,e,n,i){return this.Zr(t,e,n,i)},Bh.prototype.Yu=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.19.0",t["Content-Type"]="text/plain",e)for(var n in e.ar)e.ar.hasOwnProperty(n)&&(t[n]=e.ar[n])},Bh.prototype.Hu=function(t,e){var n=Ch[t];return this.Ku+"/v1/"+e+":"+n},n(Fh,Sh=Bh),Fh.prototype.Ju=function(a,e,n,i){return new Promise(function(o,s){var u=new Ai;u.listenOnce(Ei.COMPLETE,function(){try{switch(u.getLastErrorCode()){case bi.NO_ERROR:var t=u.getResponseJson();Si("Connection","XHR received:",JSON.stringify(t)),o(t);break;case bi.TIMEOUT:Si("Connection",'RPC "'+a+'" timed out'),s(new Xi(Qi.DEADLINE_EXCEEDED,"Request time out"));break;case bi.HTTP_ERROR:var e,n,i=u.getStatus();Si("Connection",'RPC "'+a+'" failed with status:',i,"response text:",u.getResponseText()),0<i?(e=u.getResponseJson().error)&&e.status&&e.message?(r=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(Qi).indexOf(r)?r:Qi.UNKNOWN,s(new Xi(n,e.message))):s(new Xi(Qi.UNKNOWN,"Server responded with status "+u.getStatus())):s(new Xi(Qi.UNAVAILABLE,"Connection failed."));break;default:Di()}}finally{Si("Connection",'RPC "'+a+'" completed.')}var r});var t=JSON.stringify(i);u.send(e,"POST",t,n,15)})},Fh.prototype.Ur=function(t,e){var n,i,r=[this.Ku,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=wi(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.Yu(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(i=p()).indexOf("MSIE ")||0<=i.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=r.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Si("Connection","Creating WebChannel: "+u,s);var h=o.createWebChannel(u,s),c=!1,l=!1,f=new Vh({Lu:function(t){l?Si("Connection","Not sending because WebChannel is closed:",t):(c||(Si("Connection","Opening WebChannel transport."),h.open(),c=!0),Si("Connection","WebChannel sending:",t),h.send(t))},Mu:function(){return h.close()}});return a(Ii.EventType.OPEN,function(){l||Si("Connection","WebChannel transport opened.")}),a(Ii.EventType.CLOSE,function(){l||(l=!0,Si("Connection","WebChannel transport closed"),f.Qu())}),a(Ii.EventType.ERROR,function(t){l||(l=!0,Oi("Connection","WebChannel transport errored:",t),f.Qu(new Xi(Qi.UNAVAILABLE,"The operation could not be completed")))}),a(Ii.EventType.MESSAGE,function(t){var e,n,i,r,o,s;l||(Pi(!!(n=t.data[0])),(i=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(Si("Connection","WebChannel received error:",i),r=i.status,o=function(){var t=Er[r];if(void 0!==t)return Rr(t)}(),s=i.message,void 0===o&&(o=Qi.INTERNAL,s="Unknown error status: "+r+" with message "+i.message),l=!0,f.Qu(new Xi(o,s)),h.close()):(Si("Connection","WebChannel received:",n),f.ju(n)))}),setTimeout(function(){f.Wu()},0),f},Fh),Mh=(jh.prototype.To=function(t){this.nc.push(t)},jh.prototype.Oo=function(){window.removeEventListener("online",this.Xu),window.removeEventListener("offline",this.tc)},jh.prototype.sc=function(){window.addEventListener("online",this.Xu),window.addEventListener("offline",this.tc)},jh.prototype.Zu=function(){Si("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.nc;t<e.length;t++)(0,e[t])(0)},jh.prototype.ec=function(){Si("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.nc;t<e.length;t++)(0,e[t])(1)},jh.ic=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},jh),qh=(xh.prototype.To=function(t){},xh.prototype.Oo=function(){},xh);function xh(){}function jh(){var t=this;this.Xu=function(){return t.Zu()},this.tc=function(){return t.ec()},this.nc=[],this.sc()}function Fh(t){var e=this;return(e=Sh.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function Bh(t){this.Gu=t,this.s=t.s;var e=t.ssl?"https":"http";this.Ku=e+"://"+t.host,this.zu="projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents"}function Gh(t){this.Lu=t.Lu,this.Mu=t.Mu}function zh(t){this.persistence=t,this.Nu=new Ra,this.$u=null}function $h(t){var e=this;return(e=_h.call(this)||this).$i=t,e}function Wh(){this.Du=[]}function Hh(t){var e=this;this.Ru={},this.Au=new Xu(0),this.Pu=!1,this.Pu=!0,this.Li=t(this),this.Ii=new Oh(this),this.kn=new da,this.Nn=new sh(this.kn,function(t){return e.Li.Vu(t)})}function Qh(t){this.persistence=t,this.cu=new Hi(yr,vr),this.lastRemoteSnapshotVersion=Ki.min(),this.highestTargetId=0,this.lu=0,this._u=new Ra,this.targetCount=0,this.fu=va.ci()}function Xh(t){return new Oo(t,!0)}var Yh="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Kh=(tc.prototype.initialize=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.qh=this.rc(e),this.persistence=this.oc(e),[4,this.persistence.start()];case 1:return t.sent(),this.hc=this.ac(e),this.co=this.uc(e),[2]}})})},tc.prototype.ac=function(t){return null},tc.prototype.uc=function(t){return e=this.persistence,n=new rh,i=t.cc,new ga(e,n,i);var e,n,i},tc.prototype.oc=function(t){if(t._c.lc)throw new Xi(Qi.FAILED_PRECONDITION,Yh);return new Lh(Ph.ku)},tc.prototype.rc=function(t){return new Za},tc.prototype.terminate=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.hc&&this.hc.stop(),[4,this.qh.Oo()];case 1:return t.sent(),[4,this.persistence.Oo()];case 2:return t.sent(),[2]}})})},tc.prototype.clearPersistence=function(t,e){throw new Xi(Qi.FAILED_PRECONDITION,Yh)},tc),Jh=(Zh.prototype.initialize=function(n,i){return d(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:return this.co?[3,3]:(this.co=n.co,this.qh=n.qh,this.lo=this.fc(i),this.Mh=this.dc(i),this.qo=this.wc(i),this.mc=this.Tc(i),this.qh.eo=function(t){return e.qo.$h(t,1)},this.Mh.qo=this.qo,[4,this.Mh.start()]);case 1:return t.sent(),[4,this.Mh.nh(this.qo.Zh)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Zh.prototype.Tc=function(t){return new nh(this.qo)},Zh.prototype.fc=function(t){var e,n=Xh(t.Gu.s),i=(e=t.Gu,new Uh(e)),r=t.credentials;return new Xa(r,i,n)},Zh.prototype.dc=function(t){var e=this;return new Ka(this.co,this.lo,t.Rs,function(t){return e.qo.$h(t,0)},new(Mh.ic()?Mh:qh))},Zh.prototype.wc=function(t){return e=this.co,n=this.Mh,i=this.lo,r=this.qh,o=t.cc,s=t.Uh,u=!t._c.lc||!t._c.synchronizeTabs,a=new eh(e,n,i,r,o,s),u&&(a.Xh=!0),a;var e,n,i,r,o,s,u,a},Zh.prototype.terminate=function(){return this.Mh.Oo()},Zh);function Zh(){}function tc(){}function ec(r){return function(){if("object"==typeof r&&null!==r)for(var t=r,e=0,n=["next","error","complete"];e<n.length;e++){var i=n[e];if(i in t&&"function"==typeof t[i])return 1}}()}var nc=(ic.prototype.next=function(t){this.observer.next&&this.Ec(this.observer.next,t)},ic.prototype.error=function(t){this.observer.error?this.Ec(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},ic.prototype.Ic=function(){this.muted=!0},ic.prototype.Ec=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},ic);function ic(t){this.observer=t,this.muted=!1}function rc(t,e){if(0!==e.length)throw new Xi(Qi.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+Ic(e.length,"argument")+".")}function oc(t,e,n){if(e.length!==n)throw new Xi(Qi.INVALID_ARGUMENT,"Function "+t+"() requires "+Ic(n,"argument")+", but was called with "+Ic(e.length,"argument")+".")}function sc(t,e,n){if(e.length<n)throw new Xi(Qi.INVALID_ARGUMENT,"Function "+t+"() requires at least "+Ic(n,"argument")+", but was called with "+Ic(e.length,"argument")+".")}function uc(t,e,n,i){if(e.length<n||e.length>i)throw new Xi(Qi.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+i+" arguments, but was called with "+Ic(e.length,"argument")+".")}function ac(t,e,n,i){dc(t,e,Ec(n)+" argument",i)}function hc(t,e,n,i){void 0!==i&&ac(t,e,n,i)}function cc(t,e,n,i){dc(t,e,n+" option",i)}function lc(t,e,n,i){void 0!==i&&cc(t,e,n,i)}function fc(t,e,n,i,a){void 0!==i&&function(t,e,n){for(var i=[],r=0,o=a;r<o.length;r++){var s=o[r];if(s===n)return;i.push(vc(s))}var u=vc(n);throw new Xi(Qi.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+i.join(", "))}(t,n,i)}function pc(t,e,n,i){if(!e.some(function(t){return t===i}))throw new Xi(Qi.INVALID_ARGUMENT,"Invalid value "+vc(i)+" provided to function "+t+"() for its "+Ec(n)+" argument. Acceptable values: "+e.join(", "));return i}function dc(t,e,n,i){if(!("object"===e?yc(i):"non-empty string"===e?"string"==typeof i&&""!==i:typeof i===e)){var r=vc(i);throw new Xi(Qi.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}}function yc(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function vc(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Di();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function gc(t,e,n){if(void 0===n)throw new Xi(Qi.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Ec(e)+" argument, but it was undefined.")}function mc(n,t,i){Bi(t,function(t,e){if(i.indexOf(t)<0)throw new Xi(Qi.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+i.join(", "))})}function wc(t,e,n,i){var r=vc(i);return new Xi(Qi.INVALID_ARGUMENT,"Function "+t+"() requires its "+Ec(n)+" argument to be a "+e+", but it was: "+r)}function bc(t,e,n){if(n<=0)throw new Xi(Qi.INVALID_ARGUMENT,"Function "+t+"() requires its "+Ec(e)+" argument to be a positive number, but it was: "+n+".")}function Ec(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function Ic(t,e){return t+" "+e+(1===t?"":"s")}function Ac(){if("undefined"==typeof Uint8Array)throw new Xi(Qi.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Tc(){if("undefined"==typeof atob)throw new Xi(Qi.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Nc,Rc,kc=(Cc.fromBase64String=function(t){oc("Blob.fromBase64String",arguments,1),ac("Blob.fromBase64String","string",1,t),Tc();try{return new Cc(mr.fromBase64String(t))}catch(t){throw new Xi(Qi.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Cc.fromUint8Array=function(t){if(oc("Blob.fromUint8Array",arguments,1),Ac(),!(t instanceof Uint8Array))throw wc("Blob.fromUint8Array","Uint8Array",1,t);return new Cc(mr.fromUint8Array(t))},Cc.prototype.toBase64=function(){return oc("Blob.toBase64",arguments,0),Tc(),this.Rc.toBase64()},Cc.prototype.toUint8Array=function(){return oc("Blob.toUint8Array",arguments,0),Ac(),this.Rc.toUint8Array()},Cc.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Cc.prototype.isEqual=function(t){return this.Rc.isEqual(t.Rc)},Cc),Sc=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Xi(Qi.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(ac("FieldPath","string",e,t[e]),0===t[e].length)throw new Xi(Qi.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Ac=new er(t)},_c=(n(Vc,Rc=Sc),Vc.documentId=function(){return new Vc(er.M().N())},Vc.prototype.isEqual=function(t){if(!(t instanceof Vc))throw wc("isEqual","FieldPath",1,t);return this.Ac.isEqual(t.Ac)},Vc),Oc=new RegExp("[~\\*/\\[\\]]"),Lc=function(){this.Pc=this},Dc=(n(Pc,Nc=Lc),Pc.prototype.yc=function(t){if(2!==t.pc)throw 1===t.pc?t.gc(this.Vc+"() can only appear at the top level of your update data"):t.gc(this.Vc+"() cannot be used with set() unless you pass {merge:true}");return t.qe.push(t.path),null},Pc.prototype.isEqual=function(t){return t instanceof Pc},Pc);function Pc(t){var e=this;return(e=Nc.call(this)||this).Vc=t,e}function Vc(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Rc.call(this,t)||this}function Cc(t){Tc(),this.Rc=t}function Uc(t,e,n){return new cl({pc:3,vc:e.settings.vc,methodName:t.Vc,bc:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var Mc,qc,xc,jc,Fc,Bc,Gc=(n(al,Bc=Lc),al.prototype.yc=function(t){return new ls(t.path,new Ko)},al.prototype.isEqual=function(t){return t instanceof al},al),zc=(n(ul,Fc=Lc),ul.prototype.yc=function(t){var e=Uc(this,t,!0),n=this.Sc.map(function(t){return ml(t,e)}),i=new Jo(n);return new ls(t.path,i)},ul.prototype.isEqual=function(t){return this===t},ul),$c=(n(sl,jc=Lc),sl.prototype.yc=function(t){var e=Uc(this,t,!0),n=this.Sc.map(function(t){return ml(t,e)}),i=new is(n);return new ls(t.path,i)},sl.prototype.isEqual=function(t){return this===t},sl),Wc=(n(ol,xc=Lc),ol.prototype.yc=function(t){var e=new us(t.serializer,Po(t.serializer,this.Cc));return new ls(t.path,e)},ol.prototype.isEqual=function(t){return this===t},ol),Hc=(n(rl,qc=Lc),rl.delete=function(){return rc("FieldValue.delete",arguments),new Qc(new Dc("FieldValue.delete"))},rl.serverTimestamp=function(){return rc("FieldValue.serverTimestamp",arguments),new Qc(new Gc("FieldValue.serverTimestamp"))},rl.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return sc("FieldValue.arrayUnion",arguments,1),new Qc(new zc("FieldValue.arrayUnion",t))},rl.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return sc("FieldValue.arrayRemove",arguments,1),new Qc(new $c("FieldValue.arrayRemove",t))},rl.increment=function(t){return ac("FieldValue.increment","number",1,t),oc("FieldValue.increment",arguments,1),new Qc(new Wc("FieldValue.increment",t))},rl),Qc=(n(il,Mc=Hc),il.prototype.yc=function(t){return this.Pc.yc(t)},il.prototype.isEqual=function(t){return t instanceof il&&this.Pc.isEqual(t.Pc)},il),Xc=(Object.defineProperty(nl.prototype,"latitude",{get:function(){return this.Dc},enumerable:!1,configurable:!0}),Object.defineProperty(nl.prototype,"longitude",{get:function(){return this.Fc},enumerable:!1,configurable:!0}),nl.prototype.isEqual=function(t){return this.Dc===t.Dc&&this.Fc===t.Fc},nl.prototype.toJSON=function(){return{latitude:this.Dc,longitude:this.Fc}},nl.prototype.m=function(t){return Ui(this.Dc,t.Dc)||Ui(this.Fc,t.Fc)},nl),Yc=/^__.*__$/,Kc=function(t,e,n){this.Nc=t,this.$c=e,this.kc=n},Jc=(el.prototype.Oc=function(t,e){var n=[];return null!==this.qe?n.push(new Ns(t,this.data,this.qe,e)):n.push(new Ts(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Os(t,this.fieldTransforms)),n},el),Zc=(tl.prototype.Oc=function(t,e){var n=[new Ns(t,this.data,this.qe,e)];return 0<this.fieldTransforms.length&&n.push(new Os(t,this.fieldTransforms)),n},tl);function tl(t,e,n){this.data=t,this.qe=e,this.fieldTransforms=n}function el(t,e,n){this.data=t,this.qe=e,this.fieldTransforms=n}function nl(t,e){if(oc("GeoPoint",arguments,2),ac("GeoPoint","number",1,t),ac("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Xi(Qi.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Xi(Qi.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Dc=t,this.Fc=e}function il(t){var e=this;return(e=Mc.call(this)||this).Pc=t,e.Vc=t.Vc,e}function rl(){return qc.call(this)||this}function ol(t,e){var n=this;return(n=xc.call(this)||this).Vc=t,n.Cc=e,n}function sl(t,e){var n=this;return(n=jc.call(this)||this).Vc=t,n.Sc=e,n}function ul(t,e){var n=this;return(n=Fc.call(this)||this).Vc=t,n.Sc=e,n}function al(t){var e=this;return(e=Bc.call(this)||this).Vc=t,e}function hl(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Di()}}var cl=(Object.defineProperty(pl.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(pl.prototype,"pc",{get:function(){return this.settings.pc},enumerable:!1,configurable:!0}),pl.prototype.Lc=function(t){return new pl(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.qe)},pl.prototype.Mc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Lc({path:n,bc:!1});return i.qc(t),i},pl.prototype.Uc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.Lc({path:n,bc:!1});return i.xc(),i},pl.prototype.Bc=function(t){return this.Lc({path:void 0,bc:!0})},pl.prototype.gc=function(t){return Tl(t,this.settings.methodName,this.settings.Wc||!1,this.path,this.settings.vc)},pl.prototype.contains=function(e){return void 0!==this.qe.find(function(t){return e.C(t)})||void 0!==this.fieldTransforms.find(function(t){return e.C(t.field)})},pl.prototype.xc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.qc(this.path.get(t))},pl.prototype.qc=function(t){if(0===t.length)throw this.gc("Document fields must not be empty");if(hl(this.pc)&&Yc.test(t))throw this.gc('Document fields cannot begin and end with "__"')},pl),ll=(fl.prototype.Qc=function(t,e,n,i){return void 0===i&&(i=!1),new cl({pc:t,methodName:e,vc:n,path:er.k(),bc:!1,Wc:i},this.s,this.serializer,this.ignoreUndefinedProperties)},fl);function fl(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||Xh(t)}function pl(t,e,n,i,r,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===r&&this.xc(),this.fieldTransforms=r||[],this.qe=o||[]}function dl(t,e,n,i,r,o){void 0===o&&(o={});var s=t.Qc(o.merge||o.mergeFields?2:0,e,n,r);El("Data must be an object, but it was:",s,i);var u,a,h=wl(i,s);if(o.merge)u=new fs(s.qe),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],l=0,f=o.mergeFields;l<f.length;l++){var p=f[l],d=void 0;if(p instanceof Sc)d=p.Ac;else{if("string"!=typeof p)throw Di();d=Al(e,p,n)}if(!s.contains(d))throw new Xi(Qi.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Nl(c,d)||c.push(d)}u=new fs(c),a=s.fieldTransforms.filter(function(t){return u.je(t.field)})}else u=null,a=s.fieldTransforms;return new Jc(new Ms(h),u,a)}function yl(t,o,s,e){var u=t.Qc(1,o,s);El("Data must be an object, but it was:",u,e);var a=[],h=new qs;Bi(e,function(t,e){var n,i=Al(o,t,s),r=u.Uc(i);e instanceof Lc&&e.Pc instanceof Dc?a.push(i):null!=(n=ml(e,r))&&(a.push(i),h.set(i,n))});var n=new fs(a);return new Zc(h.ze(),n,u.fieldTransforms)}function vl(t,e,n,i,r,o){var s=t.Qc(1,e,n),u=[Il(e,i,n)],a=[r];if(o.length%2!=0)throw new Xi(Qi.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(Il(e,o[h])),a.push(o[h+1]);for(var c,l,f,p,d=[],y=new qs,v=u.length-1;0<=v;--v)Nl(d,u[v])||(c=u[v],l=a[v],f=s.Uc(c),l instanceof Lc&&l.Pc instanceof Dc?d.push(c):null!=(p=ml(l,f))&&(d.push(c),y.set(c,p)));var g=new fs(d);return new Zc(y.ze(),g,s.fieldTransforms)}function gl(t,e,n,i){return void 0===i&&(i=!1),ml(n,t.Qc(i?4:3,e))}function ml(s,t){if(bl(s))return El("Unsupported field value:",t,s),wl(s,t);if(s instanceof Lc)return function(t,e){if(!hl(e.pc))throw e.gc(t.Vc+"() can only be used with update() and set()");if(!e.path)throw e.gc(t.Vc+"() is not currently supported inside arrays");var n=t.yc(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.qe.push(t.path),s instanceof Array){if(t.settings.bc&&4!==t.pc)throw t.gc("Nested arrays are not supported");return function(t){for(var e=[],n=0,i=0,r=s;i<r.length;i++){var o=ml(r[i],t.Bc(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Po(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Yi.fromDate(t);return{timestampValue:Vo(e.serializer,n)}}if(t instanceof Yi){var i=new Yi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Vo(e.serializer,i)}}if(t instanceof Xc)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof kc)return{bytesValue:Co(e.serializer,t)};if(t instanceof Kc){var r=e.s,o=t.Nc;if(!o.isEqual(r))throw e.gc("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+r.projectId+"/"+r.database);return{referenceValue:Mo(t.Nc||e.s,t.$c.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.gc("Unsupported field value: "+vc(t))}(s,t)}function wl(t,i){var r={};return Gi(t)?i.path&&0<i.path.length&&i.qe.push(i.path):Bi(t,function(t,e){var n=ml(e,i.Mc(t));null!=n&&(r[t]=n)}),{mapValue:{fields:r}}}function bl(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Yi||t instanceof Xc||t instanceof kc||t instanceof Kc||t instanceof Lc)}function El(t,e,n){if(!bl(n)||!yc(n)){var i=vc(n);throw"an object"===i?e.gc(t+" a custom object"):e.gc(t+" "+i)}}function Il(t,e,n){if(e instanceof Sc)return e.Ac;if("string"==typeof e)return Al(t,e);throw Tl("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Al(t,e,n){try{return function(e){if(0<=e.search(Oc))throw new Xi(Qi.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(_c.bind.apply(_c,r([void 0],e.split("."))))}catch(t){throw new Xi(Qi.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Ac}catch(e){throw Tl(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Tl(t,e,n,i,r){var o=i&&!i._(),s=void 0!==r,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+i),s&&(a+=" in document "+r),a+=")"),new Xi(Qi.INVALID_ARGUMENT,(u+=". ")+t+a)}function Nl(t,e){return t.some(function(t){return t.isEqual(e)})}var Rl=(Ll.prototype.Hc=function(i){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.Yc(),0<this.mutations.length)throw new Xi(Qi.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(u,a){return d(this,void 0,void 0,function(){var r,e,n,i,o,s;return y(this,function(t){switch(t.label){case 0:return e=Fo((r=u).serializer)+"/documents",n={documents:a.map(function(t){return qo(r.serializer,t)})},[4,r.to("BatchGetDocuments",e,n)];case 1:return i=t.sent(),o=new Map,i.forEach(function(t){var e,n,i=(e=r.serializer,"found"in(n=t)?function(t,e){Pi(!!e.found),e.found.name,e.found.updateTime;var n=xo(t,e.found.name),i=Uo(e.found.updateTime),r=new Ms({mapValue:{fields:e.found.fields}});return new Hs(n,i,r,{})}(e,n):"missing"in n?function(t,e){Pi(!!e.missing),Pi(!!e.readTime);var n=xo(t,e.missing),i=Uo(e.readTime);return new Qs(n,i)}(e,n):Di());o.set(i.key.toString(),i)}),s=[],[2,(a.forEach(function(t){var e=o.get(t.toString());Pi(!!e),s.push(e)}),s)]}})})}(this.lo,i)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Qs||t instanceof Hs?n.Jc(t):Di()}),e)]}})})},Ll.prototype.set=function(t,e){this.write(e.Oc(t,this.We(t))),this.zc.add(t.toString())},Ll.prototype.update=function(t,e){try{this.write(e.Oc(t,this.Xc(t)))}catch(t){this.Kc=t}this.zc.add(t.toString())},Ll.prototype.delete=function(t){this.write([new Cs(t,this.We(t))]),this.zc.add(t.toString())},Ll.prototype.commit=function(){return d(this,void 0,void 0,function(){var e,i=this;return y(this,function(t){switch(t.label){case 0:if(this.Yc(),this.Kc)throw this.Kc;return e=this.jc,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=nr.U(e);i.mutations.push(new Us(n,i.We(n)))}),[4,function(r,o){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:return n=Fo((e=r).serializer)+"/documents",i={writes:o.map(function(t){return Go(e.serializer,t)})},[4,e.Zr("Commit",n,i)];case 1:return t.sent(),[2]}})})}(this.lo,this.mutations)];case 1:return t.sent(),this.Gc=!0,[2]}})})},Ll.prototype.Jc=function(t){var e;if(t instanceof Hs)e=t.version;else{if(!(t instanceof Qs))throw Di();e=Ki.min()}var n=this.jc.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Xi(Qi.ABORTED,"Document version changed between two reads.")}else this.jc.set(t.key.toString(),e)},Ll.prototype.We=function(t){var e=this.jc.get(t.toString());return!this.zc.has(t.toString())&&e?ys.updateTime(e):ys.Ge()},Ll.prototype.Xc=function(t){var e=this.jc.get(t.toString());if(this.zc.has(t.toString())||!e)return ys.exists(!0);if(e.isEqual(Ki.min()))throw new Xi(Qi.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ys.updateTime(e)},Ll.prototype.write=function(t){this.Yc(),this.mutations=this.mutations.concat(t)},Ll.prototype.Yc=function(){},Ll),kl=(Ol.prototype.run=function(){this.tl()},Ol.prototype.tl=function(){var t=this;this.ks.ws(function(){return d(t,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){return e=new Rl(this.lo),(n=this.el(e))&&n.then(function(t){i.Rs.vs(function(){return e.commit().then(function(){i.Vs.resolve(t)}).catch(function(t){i.nl(t)})})}).catch(function(t){i.nl(t)}),[2]})})})},Ol.prototype.el=function(t){try{var e=this.updateFunction(t);return!lr(e)&&e.catch&&e.then?e:(this.Vs.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Vs.reject(t),null}},Ol.prototype.nl=function(t){var e=this;0<this.Zc&&this.sl(t)?(--this.Zc,this.Rs.vs(function(){return e.tl(),Promise.resolve()})):this.Vs.reject(t)},Ol.prototype.sl=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Nr(e)},Ol),Sl=(_l.prototype.start=function(t,e,n,i){var r=this;this.rl(),this.Gu=t;var o=new na,s=!1;return this.credentials.lr(function(t){return s?void r.Rs.Bs(function(){return r.Mh.eh(t)}):(s=!0,Si("FirestoreClient","Initializing. user=",t.uid),r.ol(e,n,i,t,o).then(r.il.resolve,r.il.reject))}),this.Rs.vs(function(){return r.il.promise}),o.promise},_l.prototype.enableNetwork=function(){var t=this;return this.rl(),this.Rs.enqueue(function(){return t.persistence.gu(!0),t.Mh.enableNetwork()})},_l.prototype.ol=function(r,o,s,u,a){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={Rs:this.Rs,Gu:this.Gu,clientId:this.clientId,credentials:this.credentials,cc:u,Uh:100,_c:s},[4,r.initialize(e)];case 1:return t.sent(),[4,o.initialize(r,e)];case 2:return t.sent(),this.persistence=r.persistence,this.qh=r.qh,this.co=r.co,this.hc=r.hc,this.lo=o.lo,this.Mh=o.Mh,this.qo=o.qo,this.hl=o.mc,this.persistence.pu(function(){return d(i,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),a.resolve(),[3,4];case 3:if(n=t.sent(),a.reject(n),!this.al(n))throw n;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+n),this.ol(new Kh,new Jh,{lc:!1},u,a))];case 4:return[2]}})})},_l.prototype.al=function(t){return"FirebaseError"===t.name?t.code===Qi.FAILED_PRECONDITION||t.code===Qi.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},_l.prototype.rl=function(){if(this.Rs.xs)throw new Xi(Qi.FAILED_PRECONDITION,"The client has already been terminated.")},_l.prototype.disableNetwork=function(){var t=this;return this.rl(),this.Rs.enqueue(function(){return t.persistence.gu(!1),t.Mh.disableNetwork()})},_l.prototype.terminate=function(){var t=this;this.Rs.Us();var i=new na;return this.Rs.Ls(function(){return d(t,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.hc&&this.hc.stop(),[4,this.Mh.Oo()];case 1:return t.sent(),[4,this.qh.Oo()];case 2:return t.sent(),[4,this.persistence.Oo()];case 3:return t.sent(),this.credentials._r(),i.resolve(),[3,5];case 4:return e=t.sent(),n=la(e,"Failed to shutdown persistence"),i.reject(n),[3,5];case 5:return[2]}})})}),i.promise},_l.prototype.waitForPendingWrites=function(){var t=this;this.rl();var e=new na;return this.Rs.vs(function(){return t.qo.wa(e)}),e.promise},_l.prototype.listen=function(t,e,n){var i=this;this.rl();var r=new nc(n),o=new ih(t,r,e);return this.Rs.vs(function(){return i.hl.listen(o)}),function(){r.Ic(),i.Rs.vs(function(){return i.hl.Lo(o)})}},_l.prototype.ul=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.rl(),[4,this.il.promise];case 1:return[2,(t.sent(),function(n,u,a){return d(this,void 0,void 0,function(){var s,e=this;return y(this,function(t){switch(t.label){case 0:return s=new na,[4,n.enqueue(function(){return d(e,void 0,void 0,function(){var i,r,o;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=a,(n=u).persistence.runTransaction("read document","readonly",function(t){return n.Ai.On(t,e)}))];case 1:return(i=t.sent())instanceof Hs?s.resolve(i):i instanceof Qs?s.resolve(null):s.reject(new Xi(Qi.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),o=la(r,"Failed to get document '"+a+" from cache"),s.reject(o),[3,3];case 3:return[2]}var e,n})})})];case 1:return[2,(t.sent(),s.promise)]}})})}(this.Rs,this.co,e))]}})})},_l.prototype.cl=function(u,a){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.rl(),[4,this.il.promise];case 1:return[2,(t.sent(),e=this.Rs,n=this.hl,i=u,r=a,o=new na,s=Dl(e,n,nu(i.path),{includeMetadataChanges:!0,qa:!0},{next:function(t){s();var e=t.docs.has(i);!e&&t.fromCache?o.reject(new Xi(Qi.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&r&&"server"===r.source?o.reject(new Xi(Qi.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,i,r,o,s})})},_l.prototype.ll=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.rl(),[4,this.il.promise];case 1:return[2,(t.sent(),function(n,a,h){return d(this,void 0,void 0,function(){var u,e=this;return y(this,function(t){switch(t.label){case 0:return u=new na,[4,n.enqueue(function(){return d(e,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Ta(a,h,!0)];case 1:return e=t.sent(),n=new th(h,e.Wi),i=n.gh(e.documents),r=n.Ch(i,!1),u.resolve(r.snapshot),[3,3];case 2:return o=t.sent(),s=la(o,"Failed to execute query '"+h+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})}(this.Rs,this.co,e))]}})})},_l.prototype._l=function(u,a){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.rl(),[4,this.il.promise];case 1:return[2,(t.sent(),e=this.Rs,n=this.hl,i=u,r=a,o=new na,s=Dl(e,n,i,{includeMetadataChanges:!0,qa:!0},{next:function(t){s(),t.fromCache&&r&&"server"===r.source?o.reject(new Xi(Qi.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,i,r,o,s})})},_l.prototype.write=function(t){var e=this;this.rl();var n=new na;return this.Rs.vs(function(){return e.qo.write(t,n)}),n.promise},_l.prototype.s=function(){return this.Gu.s},_l.prototype.Fa=function(t){var e=this;this.rl();var n=new nc(t);return this.Rs.vs(function(){return d(e,void 0,void 0,function(){return y(this,function(t){return[2,this.hl.Fa(n)]})})}),function(){n.Ic(),e.Rs.vs(function(){return d(e,void 0,void 0,function(){return y(this,function(t){return[2,this.hl.Na(n)]})})})}},Object.defineProperty(_l.prototype,"fl",{get:function(){return this.Rs.xs},enumerable:!1,configurable:!0}),_l.prototype.transaction=function(t){var e=this;this.rl();var n=new na;return this.Rs.vs(function(){return new kl(e.Rs,e.lo,t,n).run(),Promise.resolve()}),n.promise},_l);function _l(t,e){this.credentials=t,this.Rs=e,this.clientId=Vi.t(),this.il=new na}function Ol(t,e,n,i){this.Rs=t,this.lo=e,this.updateFunction=n,this.Vs=i,this.Zc=5,this.ks=new ia(this.Rs,"transaction_retry")}function Ll(t){this.lo=t,this.jc=new Map,this.mutations=[],this.Gc=!1,this.Kc=null,this.zc=new Set}function Dl(t,e,n,i,r){var o=new nc(r),s=new ih(n,o,i);return t.vs(function(){return e.listen(s)}),function(){o.Ic(),t.vs(function(){return e.Lo(s)})}}var Pl,Vl,Cl=(Zl.prototype.ml=function(t){switch(fo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return bo(t.integerValue||t.doubleValue);case 3:return this.Tl(t.timestampValue);case 4:return this.El(t);case 5:return t.stringValue;case 6:return new kc(Eo(t.bytesValue));case 7:return this.Il(t.referenceValue);case 8:return this.Rl(t.geoPointValue);case 9:return this.Al(t.arrayValue);case 10:return this.Pl(t.mapValue);default:throw Di()}},Zl.prototype.Pl=function(t){var n=this,i={};return Bi(t.fields||{},function(t,e){i[t]=n.ml(e)}),i},Zl.prototype.Rl=function(t){return new Xc(bo(t.latitude),bo(t.longitude))},Zl.prototype.Al=function(t){var e=this;return(t.values||[]).map(function(t){return e.ml(t)})},Zl.prototype.El=function(t){switch(this.dl){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return ho(n)?t(n):n}(t);return null==e?null:this.ml(e);case"estimate":return this.Tl(co(t));default:return null}},Zl.prototype.Tl=function(t){var e=wo(t),n=new Yi(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},Zl.prototype.Il=function(t){var e=Zi.$(t);Pi(Wo(e));var n=new xi(e.get(1),e.get(3)),i=new nr(e.p(5));return n.isEqual(this.s)||_i("Document "+i+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.wl(i)},Zl),Ul=fa.ni,Ml=(Jl.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Jl),ql=(Object.defineProperty(Kl.prototype,"Nl",{get:function(){return this.$l||(this.$l=new ll(this.Nc,this.Fl.ignoreUndefinedProperties)),this.$l},enumerable:!1,configurable:!0}),Kl.prototype.settings=function(t){oc("Firestore.settings",arguments,1),ac("Firestore.settings","object",1,t);var e=new Ml(t);if(this.bl&&!this.Fl.isEqual(e))throw new Xi(Qi.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Fl=e).credentials&&(this.Dl=function(t){if(!t)return new Ba;switch(t.type){case"gapi":var e=t.kl;return Pi(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new $a(e,t.Ir||"0");case"provider":return t.kl;default:throw new Xi(Qi.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},Kl.prototype.enableNetwork=function(){return this.vl(),this.bl.enableNetwork()},Kl.prototype.disableNetwork=function(){return this.vl(),this.bl.disableNetwork()},Kl.prototype.enablePersistence=function(t){var e,n;if(this.bl)throw new Xi(Qi.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var i=!1,r=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&_i("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),i=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,r=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,i&&r))throw new Xi(Qi.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Ol(this.Vl,this.yl,{lc:!0,cacheSizeBytes:this.Fl.cacheSizeBytes,synchronizeTabs:i,xl:r})},Kl.prototype.clearPersistence=function(){return d(this,void 0,void 0,function(){var n,e=this;return y(this,function(t){if(void 0!==this.bl&&!this.bl.fl)throw new Xi(Qi.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new na,[2,(this.gl.Ls(function(){return d(e,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Vl.clearPersistence(this.Nc,this.Cl)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},Kl.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Kl.prototype,"Ll",{get:function(){return this.vl(),this.bl.fl},enumerable:!1,configurable:!0}),Kl.prototype.waitForPendingWrites=function(){return this.vl(),this.bl.waitForPendingWrites()},Kl.prototype.onSnapshotsInSync=function(t){if(this.vl(),ec(t))return this.bl.Fa(t);ac("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.bl.Fa(e)},Kl.prototype.vl=function(){return this.bl||this.Ol(new Kh,new Jh,{lc:!1}),this.bl},Kl.prototype.Ml=function(){return new qi(this.Nc,this.Cl,this.Fl.host,this.Fl.ssl,this.Fl.forceLongPolling)},Kl.prototype.Ol=function(t,e,n){var i=this.Ml();return this.bl=new Sl(this.Dl,this.gl),this.bl.start(i,t,e,n)},Kl.Sl=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Xi(Qi.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Xi(Qi.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new xi(n)},Object.defineProperty(Kl.prototype,"app",{get:function(){if(!this.pl)throw new Xi(Qi.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.pl},enumerable:!1,configurable:!0}),Kl.prototype.collection=function(t){return oc("Firestore.collection",arguments,1),ac("Firestore.collection","non-empty string",1,t),this.vl(),new af(Zi.$(t),this,null)},Kl.prototype.doc=function(t){return oc("Firestore.doc",arguments,1),ac("Firestore.doc","non-empty string",1,t),this.vl(),Fl.ql(Zi.$(t),this,null)},Kl.prototype.collectionGroup=function(t){if(oc("Firestore.collectionGroup",arguments,1),ac("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Xi(Qi.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.vl(),new sf((e=t,new tu(Zi.k(),e)),this,null);var e},Kl.prototype.runTransaction=function(e){var n=this;return oc("Firestore.runTransaction",arguments,1),ac("Firestore.runTransaction","function",1,e),this.vl().transaction(function(t){return e(new xl(n,t))})},Kl.prototype.batch=function(){return this.vl(),new jl(this)},Object.defineProperty(Kl,"logLevel",{get:function(){switch(ki()){case u.DEBUG:return"debug";case u.ERROR:return"error";case u.SILENT:return"silent";case u.WARN:return"warn";case u.INFO:return"info";case u.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),Kl.setLogLevel=function(t){oc("Firestore.setLogLevel",arguments,1),pc("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Ri.setLogLevel(t)},Kl.prototype.Ul=function(){return this.Fl.timestampsInSnapshots},Kl),xl=(Yl.prototype.get=function(t){var n=this;oc("Transaction.get",arguments,1);var i=yf("Transaction.get",t,this.Bl);return this.Wl.Hc([i.$c]).then(function(t){if(!t||1!==t.length)return Di();var e=t[0];if(e instanceof Qs)return new Gl(n.Bl,i.$c,null,!1,!1,i.kc);if(e instanceof Hs)return new Gl(n.Bl,i.$c,e,!1,!1,i.kc);throw Di()})},Yl.prototype.set=function(t,e,n){uc("Transaction.set",arguments,2,3);var i=yf("Transaction.set",t,this.Bl);n=ff("Transaction.set",n);var r=vf(i.kc,e,n),o=dl(this.Bl.Nl,"Transaction.set",i.$c,r,null!==i.kc,n);return this.Wl.set(i.$c,o),this},Yl.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return r="string"==typeof e||e instanceof _c?(sc("Transaction.update",arguments,3),i=yf("Transaction.update",t,this.Bl),vl(this.Bl.Nl,"Transaction.update",i.$c,e,n,o)):(oc("Transaction.update",arguments,2),i=yf("Transaction.update",t,this.Bl),yl(this.Bl.Nl,"Transaction.update",i.$c,e)),this.Wl.update(i.$c,r),this},Yl.prototype.delete=function(t){oc("Transaction.delete",arguments,1);var e=yf("Transaction.delete",t,this.Bl);return this.Wl.delete(e.$c),this},Yl),jl=(Xl.prototype.set=function(t,e,n){uc("WriteBatch.set",arguments,2,3),this.Gl();var i=yf("WriteBatch.set",t,this.Bl);n=ff("WriteBatch.set",n);var r=vf(i.kc,e,n),o=dl(this.Bl.Nl,"WriteBatch.set",i.$c,r,null!==i.kc,n);return this.Ql=this.Ql.concat(o.Oc(i.$c,ys.Ge())),this},Xl.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Gl(),r="string"==typeof e||e instanceof _c?(sc("WriteBatch.update",arguments,3),i=yf("WriteBatch.update",t,this.Bl),vl(this.Bl.Nl,"WriteBatch.update",i.$c,e,n,o)):(oc("WriteBatch.update",arguments,2),i=yf("WriteBatch.update",t,this.Bl),yl(this.Bl.Nl,"WriteBatch.update",i.$c,e)),this.Ql=this.Ql.concat(r.Oc(i.$c,ys.exists(!0))),this},Xl.prototype.delete=function(t){oc("WriteBatch.delete",arguments,1),this.Gl();var e=yf("WriteBatch.delete",t,this.Bl);return this.Ql=this.Ql.concat(new Cs(e.$c,ys.Ge())),this},Xl.prototype.commit=function(){return this.Gl(),this.jl=!0,0<this.Ql.length?this.Bl.vl().write(this.Ql):Promise.resolve()},Xl.prototype.Gl=function(){if(this.jl)throw new Xi(Qi.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Xl),Fl=(n(Ql,Vl=Kc),Ql.ql=function(t,e,n){if(t.length%2!=0)throw new Xi(Qi.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.N()+" has "+t.length);return new Ql(new nr(t),e,n)},Object.defineProperty(Ql.prototype,"id",{get:function(){return this.$c.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Ql.prototype,"parent",{get:function(){return new af(this.$c.path.g(),this.firestore,this.kc)},enumerable:!1,configurable:!0}),Object.defineProperty(Ql.prototype,"path",{get:function(){return this.$c.path.N()},enumerable:!1,configurable:!0}),Ql.prototype.collection=function(t){if(oc("DocumentReference.collection",arguments,1),ac("DocumentReference.collection","non-empty string",1,t),!t)throw new Xi(Qi.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Zi.$(t);return new af(this.$c.path.child(e),this.firestore,null)},Ql.prototype.isEqual=function(t){if(!(t instanceof Ql))throw wc("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.$c.isEqual(t.$c)&&this.kc===t.kc},Ql.prototype.set=function(t,e){uc("DocumentReference.set",arguments,1,2),e=ff("DocumentReference.set",e);var n=vf(this.kc,t,e),i=dl(this.firestore.Nl,"DocumentReference.set",this.$c,n,null!==this.kc,e);return this.bl.write(i.Oc(this.$c,ys.Ge()))},Ql.prototype.update=function(t,e){for(var n,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return n="string"==typeof t||t instanceof _c?(sc("DocumentReference.update",arguments,2),vl(this.firestore.Nl,"DocumentReference.update",this.$c,t,e,i)):(oc("DocumentReference.update",arguments,1),yl(this.firestore.Nl,"DocumentReference.update",this.$c,t)),this.bl.write(n.Oc(this.$c,ys.exists(!0)))},Ql.prototype.delete=function(){return oc("DocumentReference.delete",arguments,0),this.bl.write([new Cs(this.$c,ys.Ge())])},Ql.prototype.onSnapshot=function(){for(var t,e,n,i=this,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];uc("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},u=0;"object"!=typeof r[u]||ec(r[u])||(mc("DocumentReference.onSnapshot",s=r[u],["includeMetadataChanges"]),lc("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++);var a,h={includeMetadataChanges:s.includeMetadataChanges};ec(r[u])?(a=r[u],r[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),r[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),r[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)):(ac("DocumentReference.onSnapshot","function",u,r[u]),hc("DocumentReference.onSnapshot","function",u+1,r[u+1]),hc("DocumentReference.onSnapshot","function",u+2,r[u+2]));var c={next:function(t){r[u]&&r[u](i.Kl(t))},error:r[u+1],complete:r[u+2]};return this.bl.listen(nu(this.$c.path),h,c)},Ql.prototype.get=function(t){var e=this;uc("DocumentReference.get",arguments,0,1),df("DocumentReference.get",t);var n=this.firestore.vl();return t&&"cache"===t.source?n.ul(this.$c).then(function(t){return new Gl(e.firestore,e.$c,t,!0,t instanceof Hs&&t.Ke,e.kc)}):n.cl(this.$c,t).then(function(t){return e.Kl(t)})},Ql.prototype.withConverter=function(t){return new Ql(this.$c,this.firestore,t)},Ql.prototype.Kl=function(t){var e=t.docs.get(this.$c);return new Gl(this.firestore,this.$c,e,t.fromCache,t.hasPendingWrites,this.kc)},Ql),Bl=(Hl.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Hl),Gl=(Wl.prototype.data=function(t){var e=this;if(uc("DocumentSnapshot.data",arguments,0,1),t=pf("DocumentSnapshot.data",t),this.zl){if(this.kc){var n=new zl(this.Bl,this.$c,this.zl,this.Hl,this.Yl,null);return this.kc.fromFirestore(n,t)}return new Cl(this.Bl.Nc,this.Bl.Ul(),t.serverTimestamps||"none",function(t){return new Fl(t,e.Bl,null)}).ml(this.zl.tn())}},Wl.prototype.get=function(t,e){var n=this;if(uc("DocumentSnapshot.get",arguments,1,2),e=pf("DocumentSnapshot.get",e),this.zl){var i=this.zl.data().field(Il("DocumentSnapshot.get",t,this.$c));if(null!==i)return new Cl(this.Bl.Nc,this.Bl.Ul(),e.serverTimestamps||"none",function(t){return new Fl(t,n.Bl,n.kc)}).ml(i)}},Object.defineProperty(Wl.prototype,"id",{get:function(){return this.$c.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Wl.prototype,"ref",{get:function(){return new Fl(this.$c,this.Bl,this.kc)},enumerable:!1,configurable:!0}),Object.defineProperty(Wl.prototype,"exists",{get:function(){return null!==this.zl},enumerable:!1,configurable:!0}),Object.defineProperty(Wl.prototype,"metadata",{get:function(){return new Bl(this.Yl,this.Hl)},enumerable:!1,configurable:!0}),Wl.prototype.isEqual=function(t){if(!(t instanceof Wl))throw wc("isEqual","DocumentSnapshot",1,t);return this.Bl===t.Bl&&this.Hl===t.Hl&&this.$c.isEqual(t.$c)&&(null===this.zl?null===t.zl:this.zl.isEqual(t.zl))&&this.kc===t.kc},Wl),zl=(n($l,Pl=Gl),$l.prototype.data=function(t){return Pl.prototype.data.call(this,t)},$l);function $l(){return null!==Pl&&Pl.apply(this,arguments)||this}function Wl(t,e,n,i,r,o){this.Bl=t,this.$c=e,this.zl=n,this.Hl=i,this.Yl=r,this.kc=o}function Hl(t,e){this.hasPendingWrites=t,this.fromCache=e}function Ql(t,e,n){var i=this;return(i=Vl.call(this,e.Nc,t,n)||this).$c=t,i.firestore=e,i.kc=n,i.bl=i.firestore.vl(),i}function Xl(t){this.Bl=t,this.Ql=[],this.jl=!1}function Yl(t,e){this.Bl=t,this.Wl=e}function Kl(t,e,n,i){var r=this;if(void 0===n&&(n=new Kh),void 0===i&&(i=new Jh),this.Vl=n,this.yl=i,this.pl=null,this.gl=new aa,this.INTERNAL={delete:function(){return d(r,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.vl(),[4,this.bl.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var o=t;this.pl=o,this.Nc=Kl.Sl(o),this.Cl=o.name,this.Dl=new Ga(e)}else{var s=t;if(!s.projectId)throw new Xi(Qi.INVALID_ARGUMENT,"Must provide projectId");this.Nc=new xi(s.projectId,s.database),this.Cl="[DEFAULT]",this.Dl=new Ba}this.Fl=new Ml({})}function Jl(t){var e,n,i,r;if(void 0===t.host){if(void 0!==t.ssl)throw new Xi(Qi.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else cc("settings","non-empty string","host",t.host),this.host=t.host,lc("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(mc("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),lc("settings","object","credentials",t.credentials),this.credentials=t.credentials,lc("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),lc("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?_i("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&_i("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(i=t.ignoreUndefinedProperties)&&void 0!==i&&i,lc("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=fa.ii;else{if(t.cacheSizeBytes!==Ul&&t.cacheSizeBytes<fa.si)throw new Xi(Qi.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+fa.si);this.cacheSizeBytes=t.cacheSizeBytes}lc("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(r=t.experimentalForceLongPolling)&&void 0!==r&&r}function Zl(t,e,n,i){this.s=t,this.timestampsInSnapshots=e,this.dl=n,this.wl=i}function tf(t,e,n){if("string"==typeof n){if(""===n)throw new Xi(Qi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!iu(e)&&-1!==n.indexOf("/"))throw new Xi(Qi.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var i=e.path.child(Zi.$(n));if(!nr.j(i))throw new Xi(Qi.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+i+"' is not because it has an odd number of segments ("+i.length+").");return Io(t,new nr(i))}if(n instanceof Kc)return Io(t,n.$c);throw new Xi(Qi.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+vc(n)+".")}function ef(t,e){if(!Array.isArray(t)||0===t.length)throw new Xi(Qi.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Xi(Qi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new Xi(Qi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Xi(Qi.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function nf(t,e,n){if(!n.isEqual(e))throw new Xi(Qi.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function rf(t){if(t.un()&&0===t.en.length)throw new Xi(Qi.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var of,sf=(lf.prototype.where=function(t,e,n){var i;oc("Query.where",arguments,3),gc("Query.where",3,n),i="not-in"===e||"!="===e?e:pc("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e);var r,o,s=Il("Query.where",t),u=function(t,e,n,i,r,o){var s;if(i.L()){if("array-contains"===r||"array-contains-any"===r)throw new Xi(Qi.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+r+"' queries on FieldPath.documentId().");if("in"===r||"not-in"===r){ef(o,r);for(var u=[],a=0,h=o;a<h.length;a++){var c=h[a];u.push(tf(n,t,c))}s={arrayValue:{values:u}}}else s=tf(n,t,o)}else"in"!==r&&"not-in"!==r&&"array-contains-any"!==r||ef(o,r),s=gl(e,"Query.where",o,"in"===r||"not-in"===r);var l=yu.create(i,r,s);return function(t,e){if(e._n()){var n=t.ln();if(null!==n&&!n.isEqual(e.field))throw new Xi(Qi.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var i=t.cn();null!==i&&nf(0,e.field,i)}var r=t.fn(function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==r)throw r===e.op?new Xi(Qi.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Xi(Qi.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+r.toString()+"' filters.")}(t,l),l}(this.Jl,this.firestore.Nl,this.firestore.Nc,s,i,n);return new lf((o=(r=this.Jl).filters.concat([u]),new tu(r.path,r.collectionGroup,r.en.slice(),o,r.limit,r.nn,r.startAt,r.endAt)),this.firestore,this.kc)},lf.prototype.orderBy=function(t,e){var n;if(uc("Query.orderBy",arguments,1,2),hc("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Xi(Qi.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var i,r,o=Il("Query.orderBy",t),s=function(t,e,n){if(null!==t.startAt)throw new Xi(Qi.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Xi(Qi.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var i,r,o=new Gu(e,n),s=o;return null!==(i=t).cn()||null!==(r=i.ln())&&nf(0,r,s.field),o}(this.Jl,o,n);return new lf((r=(i=this.Jl).en.concat([s]),new tu(i.path,i.collectionGroup,r,i.filters.slice(),i.limit,i.nn,i.startAt,i.endAt)),this.firestore,this.kc)},lf.prototype.limit=function(t){return oc("Query.limit",arguments,1),ac("Query.limit","number",1,t),bc("Query.limit",1,t),new lf(su(this.Jl,t,"F"),this.firestore,this.kc)},lf.prototype.limitToLast=function(t){return oc("Query.limitToLast",arguments,1),ac("Query.limitToLast","number",1,t),bc("Query.limitToLast",1,t),new lf(su(this.Jl,t,"L"),this.firestore,this.kc)},lf.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];sc("Query.startAt",arguments,1);var i=this.Xl("Query.startAt",t,e,!0);return new lf(uu(this.Jl,i),this.firestore,this.kc)},lf.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];sc("Query.startAfter",arguments,1);var i=this.Xl("Query.startAfter",t,e,!1);return new lf(uu(this.Jl,i),this.firestore,this.kc)},lf.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];sc("Query.endBefore",arguments,1);var i=this.Xl("Query.endBefore",t,e,!0);return new lf(au(this.Jl,i),this.firestore,this.kc)},lf.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];sc("Query.endAt",arguments,1);var i=this.Xl("Query.endAt",t,e,!1);return new lf(au(this.Jl,i),this.firestore,this.kc)},lf.prototype.isEqual=function(t){if(!(t instanceof lf))throw wc("isEqual","Query",1,t);return this.firestore===t.firestore&&hu(this.Jl,t.Jl)&&this.kc===t.kc},lf.prototype.withConverter=function(t){return new lf(this.Jl,this.firestore,t)},lf.prototype.Xl=function(c,t,e,n){if(gc(c,1,t),t instanceof Gl)return oc(c,r([t],e),1),function(t,e,n,i){if(!n)throw new Xi(Qi.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var r=[],o=0,s=ru(t);o<s.length;o++){var u=s[o];if(u.field.L())r.push(Io(e,n.key));else{var a=n.field(u.field);if(ho(a))throw new Xi(Qi.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){var h=u.field.N();throw new Xi(Qi.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}r.push(a)}}return new Cu(r,i)}(this.Jl,this.firestore.Nc,t.zl,n);var i=[t].concat(e);return function(t,e,n,i,r,o){var s=t.en;if(r.length>s.length)throw new Xi(Qi.INVALID_ARGUMENT,"Too many arguments provided to "+i+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<r.length;a++){var h=r[a];if(s[a].field.L()){if("string"!=typeof h)throw new Xi(Qi.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+i+"(), but got a "+typeof h);if(!iu(t)&&-1!==h.indexOf("/"))throw new Xi(Qi.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+i+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(Zi.$(h));if(!nr.j(c))throw new Xi(Qi.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+i+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");var l=new nr(c);u.push(Io(e,l))}else{var f=gl(n,i,h);u.push(f)}}return new Cu(u,o)}(this.Jl,this.firestore.Nc,this.firestore.Nl,c,i,n)},lf.prototype.onSnapshot=function(){for(var t,e,n,i=this,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];uc("Query.onSnapshot",arguments,1,4);var s,u={},a=0;"object"!=typeof r[a]||ec(r[a])||(mc("Query.onSnapshot",u=r[a],["includeMetadataChanges"]),lc("Query.onSnapshot","boolean","includeMetadataChanges",u.includeMetadataChanges),a++),ec(r[a])?(s=r[a],r[a]=null===(t=s.next)||void 0===t?void 0:t.bind(s),r[a+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),r[a+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(ac("Query.onSnapshot","function",a,r[a]),hc("Query.onSnapshot","function",a+1,r[a+1]),hc("Query.onSnapshot","function",a+2,r[a+2]));var h={next:function(t){r[a]&&r[a](new uf(i.firestore,i.Jl,t,i.kc))},error:r[a+1],complete:r[a+2]};return rf(this.Jl),this.firestore.vl().listen(this.Jl,u,h)},lf.prototype.get=function(t){var e=this;uc("Query.get",arguments,0,1),df("Query.get",t),rf(this.Jl);var n=this.firestore.vl();return(t&&"cache"===t.source?n.ll(this.Jl):n._l(this.Jl,t)).then(function(t){return new uf(e.firestore,e.Jl,t,e.kc)})},lf),uf=(Object.defineProperty(cf.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(cf.prototype,"empty",{get:function(){return this.t_.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(cf.prototype,"size",{get:function(){return this.t_.docs.size},enumerable:!1,configurable:!0}),cf.prototype.forEach=function(e,n){var i=this;uc("QuerySnapshot.forEach",arguments,1,2),ac("QuerySnapshot.forEach","function",1,e),this.t_.docs.forEach(function(t){e.call(n,i.s_(t,i.metadata.fromCache,i.t_.qt.has(t.key)))})},Object.defineProperty(cf.prototype,"query",{get:function(){return new sf(this.Zl,this.Bl,this.kc)},enumerable:!1,configurable:!0}),cf.prototype.docChanges=function(t){t&&(mc("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),lc("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.t_.Bt)throw new Xi(Qi.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.e_&&this.n_===e||(this.e_=function(r,e,o){if(r.Mt._()){var n=0;return r.docChanges.map(function(t){var e=o(t.doc,r.fromCache,r.qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=r.Mt;return r.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,r.fromCache,r.qt.has(t.doc.key)),n=-1,i=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(i=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Di()}}(),doc:e,oldIndex:n,newIndex:i}})}(this.t_,e,this.s_.bind(this)),this.n_=e),this.e_},cf.prototype.isEqual=function(t){if(!(t instanceof cf))throw wc("isEqual","QuerySnapshot",1,t);return this.Bl===t.Bl&&hu(this.Zl,t.Zl)&&this.t_.isEqual(t.t_)&&this.kc===t.kc},cf.prototype.s_=function(t,e,n){return new zl(this.Bl,t.key,t,e,n,this.kc)},cf),af=(n(hf,of=sf),Object.defineProperty(hf.prototype,"id",{get:function(){return this.Jl.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(hf.prototype,"parent",{get:function(){var t=this.Jl.path.g();return t._()?null:new Fl(new nr(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(hf.prototype,"path",{get:function(){return this.Jl.path.N()},enumerable:!1,configurable:!0}),hf.prototype.doc=function(t){uc("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Vi.t()),ac("CollectionReference.doc","non-empty string",1,t);var e=Zi.$(t);return Fl.ql(this.Jl.path.child(e),this.firestore,this.kc)},hf.prototype.add=function(t){oc("CollectionReference.add",arguments,1),ac("CollectionReference.add","object",1,this.kc?this.kc.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},hf.prototype.withConverter=function(t){return new hf(this.i_,this.firestore,t)},hf);function hf(t,e,n){var i=this;if(((i=of.call(this,nu(t),e,n)||this).i_=t).length%2!=1)throw new Xi(Qi.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.N()+" has "+t.length);return i}function cf(t,e,n,i){this.Bl=t,this.Zl=e,this.t_=n,this.kc=i,this.e_=null,this.n_=null,this.metadata=new Bl(n.hasPendingWrites,n.fromCache)}function lf(t,e,n){this.Jl=t,this.firestore=e,this.kc=n}function ff(t,e){if(void 0===e)return{merge:!1};if(mc(t,e,["merge","mergeFields"]),lc(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Xi(Qi.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+vc(n));for(var i,r=0;r<n.length;++r)if(!("string"==typeof(i=n[r])||i instanceof _c))throw new Xi(Qi.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+r+" was: "+vc(n[r]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Xi(Qi.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function pf(t,e){return void 0===e?{}:(mc(t,e,["serverTimestamps"]),fc(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function df(t,e){hc(t,"object",1,e),e&&(mc(t,e,["source"]),fc(t,0,"source",e.source,["default","server","cache"]))}function yf(t,e,n){if(e instanceof Kc){if(e.firestore!==n)throw new Xi(Qi.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw wc(t,"DocumentReference",1,e)}function vf(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var gf,mf={Firestore:ql,GeoPoint:Xc,Timestamp:Yi,Blob:kc,Transaction:xl,WriteBatch:jl,DocumentReference:Fl,DocumentSnapshot:Gl,Query:sf,QueryDocumentSnapshot:zl,QuerySnapshot:uf,CollectionReference:af,FieldPath:_c,FieldValue:Hc,setLogLevel:ql.setLogLevel,CACHE_SIZE_UNLIMITED:Ul};(gf=wf).INTERNAL.registerComponent(new Ti("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new ql(e,n,new Kh,new Jh);var e,n},"PUBLIC").setServiceProps(Object.assign({},mf))),gf.registerVersion("@firebase/firestore","1.16.5")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
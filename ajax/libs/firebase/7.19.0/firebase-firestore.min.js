!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Vd){"use strict";try{(function(){Vd=Vd&&Object.prototype.hasOwnProperty.call(Vd,"default")?Vd.default:Vd;var t,l,e,r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function g(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function w(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=h[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(e=l=l||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";var u={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},a=l.INFO,h=((t={})[l.DEBUG]="log",t[l.VERBOSE]="log",t[l.INFO]="info",t[l.WARN]="warn",t[l.ERROR]="error",t),c=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?u[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.DEBUG],t)),this._logHandler.apply(this,s([this,l.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.VERBOSE],t)),this._logHandler.apply(this,s([this,l.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.INFO],t)),this._logHandler.apply(this,s([this,l.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.WARN],t)),this._logHandler.apply(this,s([this,l.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.ERROR],t)),this._logHandler.apply(this,s([this,l.ERROR],t))},f);function f(t){this.name=t,this._logLevel=a,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,y="FirebaseError",v=(n(m,d=Error),m);function m(t,e){var n=d.call(this,e)||this;return n.code=t,n.name=y,Object.setPrototypeOf(n,m.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,b.prototype.create),n}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(r=i,s.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new v(o,a),c=0,f=Object.keys(i);c<f.length;c++){var l=f[c];"_"!==l.slice(-1)&&(l in h&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),h[l]=i[l])}return h},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function N(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var _,A="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S=A||self;function D(){}function k(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function R(t){var e=k(t);return"array"==e||"object"==e&&"number"==typeof t.length}function L(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var x="closure_uid_"+(1e9*Math.random()>>>0),O=0;function P(t,e,n){return t.call.apply(t.bind,arguments)}function C(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function U(t,e,n){return(U=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?P:C).apply(null,arguments)}function V(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var M=Date.now;function F(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function q(){this.j=this.j,this.i=this.i}q.prototype.j=!1,q.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,x)&&this[x]||(this[x]=++O))},q.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var j=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function B(t){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var W,K=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}t:{var Q=S.navigator;if(Q){var Z=Q.userAgent;if(Z){W=Z;break t}}W=""}function J(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function $(t){var e={};for(var n in t)e[n]=t[n];return e}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<tt.length;o++)n=tt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function nt(t){return nt[" "](t),t}nt[" "]=D;var rt,it,ot=Y(W,"Opera"),st=Y(W,"Trident")||Y(W,"MSIE"),ut=Y(W,"Edge"),at=ut||st,ht=Y(W,"Gecko")&&!(Y(W.toLowerCase(),"webkit")&&!Y(W,"Edge"))&&!(Y(W,"Trident")||Y(W,"MSIE"))&&!Y(W,"Edge"),ct=Y(W.toLowerCase(),"webkit")&&!Y(W,"Edge");function ft(){var t=S.document;return t?t.documentMode:void 0}t:{var lt="",pt=(it=W,ht?/rv:([^\);]+)(\)|;)/.exec(it):ut?/Edge\/([\d\.]+)/.exec(it):st?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(it):ct?/WebKit\/(\S+)/.exec(it):ot?/(?:Version)[ \/]?(\S+)/.exec(it):void 0);if(pt&&(lt=pt?pt[1]:""),st){var dt=ft();if(null!=dt&&dt>parseFloat(lt)){rt=String(dt);break t}}rt=lt}var yt={};function vt(u){return t=u,e=function(){for(var t=0,e=K(String(rt)).split("."),n=K(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=yt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var gt=S.document&&st&&(ft()||parseInt(rt,10))||void 0,mt=!st||9<=Number(gt),wt=st&&!vt("9"),bt=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",D,e),S.removeEventListener("test",D,e)}catch(t){}return t}();function Et(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function It(t,e){if(Et.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ht){t:{try{nt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Tt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Et.prototype.b=function(){this.defaultPrevented=!0},F(It,Et);var Tt={2:"touch",3:"pen",4:"mouse"};It.prototype.b=function(){It.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,wt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Nt="closure_listenable_"+(1e6*Math.random()|0),_t=0;function At(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++_t,this.Y=this.Z=!1}function St(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Dt(t){this.src=t,this.a={},this.b=0}function kt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=j(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(St(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Rt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Dt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Rt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new At(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Lt="closure_lm_"+(1e6*Math.random()|0),xt={};function Ot(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=jt(r),e&&e[Nt]?e.wa(n,r,L(i)?!!i.capture:!!i,o):Pt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ot(t,e[o],n,r,i);return null}return n=jt(n),t&&t[Nt]?t.va(e,n,L(r)?!!r.capture:!!r,i):Pt(t,e,n,!1,r,i)}function Pt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=L(i)?!!i.capture:!!i;if(s&&!mt)return null;var u,a,h=Ft(t);if(h||(t[Lt]=h=new Dt(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Mt,r=a=mt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)bt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ut(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ct(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Nt]?kt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ut(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ft(e))?(kt(n,t),0==n.b&&(n.src=null,e[Lt]=null)):St(t)))}function Ut(t){return t in xt?xt[t]:xt[t]="on"+t}function Vt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Ct(t),n.call(r,e)}function Mt(t,e){if(t.Y)return!0;if(mt)return Vt(t,new It(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Vt(t,e=new It(e,this))}function Ft(t){return(t=t[Lt])instanceof Dt?t:null}var qt="__closure_events_fn_"+(1e9*Math.random()>>>0);function jt(e){return"function"==k(e)?e:(e[qt]||(e[qt]=function(t){return e.handleEvent(t)}),e[qt])}function Gt(){q.call(this),this.c=new Dt(this),(this.J=this).C=null}function Bt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&kt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}F(Gt,q),Gt.prototype[Nt]=!0,(_=Gt.prototype).addEventListener=function(t,e,n,r){Ot(this,t,e,n,r)},_.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=L(i)?!!i.capture:!!i,r=jt(r),e&&e[Nt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Rt(s=e.a[n],r,i,o))&&(St(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ft(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Rt(n,r,i,o)),(r=-1<e?n[e]:null)&&Ct(r))}(this,t,e,n,r)},_.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new Et(t,n):t instanceof Et?t.target=t.target||n:(s=t,et(t=new Et(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=Bt(o,r,!0,t)&&s;if(s=Bt(o=t.a=n,r,!0,t)&&s,s=Bt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Bt(o=t.a=e[i],r,!1,t)&&s;return s},_.G=function(){if(Gt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)St(n[r]);delete e.a[t],e.b--}}this.C=null},_.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},_.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var zt=S.JSON.stringify;function Ht(){this.b=this.a=null}var Wt,Kt=(Yt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Yt(function(){return new Xt},function(t){t.reset()},100));function Yt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Xt(){this.next=this.b=this.a=null}function Qt(t,e){var n;Wt||(n=S.Promise.resolve(void 0),Wt=function(){n.then($t)}),Zt||(Wt(),Zt=!0),Jt.add(t,e)}Ht.prototype.add=function(t,e){var n=Kt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Xt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Zt=!(Xt.prototype.reset=function(){this.next=this.b=this.a=null}),Jt=new Ht;function $t(){for(var t,e,n;n=e=void 0,n=null,(e=Jt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var r=Kt;r.g(t),r.b<r.f&&(r.b++,t.next=r.a,r.a=t)}Zt=!1}function te(t,e){Gt.call(this),this.b=t||1,this.a=e||S,this.f=U(this.Ya,this),this.g=M()}function ee(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function ne(t,e,n){if("function"==k(t))n&&(t=U(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=U(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}F(te,Gt),(_=te.prototype).aa=!1,_.M=null,_.Ya=function(){var t;this.aa&&(0<(t=M()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(ee(this),this.start())))},_.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=M())},_.G=function(){te.S.G.call(this),ee(this),delete this.a};var re,ie,oe,se=(T(ie=ae,oe=re=q),ie.prototype=null===oe?Object.create(oe):(ue.prototype=oe.prototype,new ue),ae.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=ne(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ae.prototype.G=function(){re.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ae);function ue(){this.constructor=ie}function ae(t,e,n){var r=re.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function he(t){q.call(this),this.b=t,this.a={}}F(he,q);var ce=[];function fe(t,e,n,r){Array.isArray(n)||(n&&(ce[0]=n.toString()),n=ce);for(var i=0;i<n.length;i++){var o=Ot(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function le(t){J(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ct(t)},t),t.a={}}function pe(){this.a=!0}function de(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return zt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}he.prototype.G=function(){he.S.G.call(this),le(this)},he.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},pe.prototype.info=function(){};var ye=null;function ve(){return ye=ye||new Gt}function ge(t){Et.call(this,"serverreachability",t)}function me(){var t=ve();t.dispatchEvent(new ge(t))}function we(t){Et.call(this,"statevent",t)}function be(){var t=ve();t.dispatchEvent(new we(t))}function Ee(t){Et.call(this,"timingevent",t)}function Ie(t,e){if("function"!=k(t))throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}F(ge,Et),F(we,Et),F(Ee,Et);var Te={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ne={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function _e(){}function Ae(t){var e;return(e=t.a)||(e=t.a={}),e}function Se(){}_e.prototype.a=null;var De,ke={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Re(){Et.call(this,"d")}function Le(){Et.call(this,"c")}function xe(){}function Oe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new he(this),this.P=Pe,t=at?125:void 0,this.R=new te(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}F(Re,Et),F(Le,Et),F(xe,_e),De=new xe;var Pe=45e3,Ce={},Ue={};function Ve(t,e,n){t.H=1,t.i=on(Je(e)),t.j=n,t.I=!0,Me(t,null)}function Me(t,e){t.u=M(),qe(t),t.l=Je(t.i);var s,u,a,h,c,f,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),mn(n.b,"t",r),t.D=0,t.a=fr(t.g,t.g.C?e:null),0<t.O&&(t.F=new se(U(t.Ca,t,t.a),t.O)),fe(t.J,t.a,"readystatechange",t.Wa),e=t.B?$(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),me(),s=t.c,u=t.m,a=t.l,h=t.f,c=t.T,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function Fe(t,e,n){for(var r,i,o,s,u=!0;!t.A&&t.D<n.length;){var a=(i=n,s=o=void 0,o=(r=t).D,-1==(s=i.indexOf("\n",o))?Ue:(o=Number(i.substring(o,s)),isNaN(o)?Ce:(s+=1)+o>i.length?Ue:(i=i.substr(s,o),r.D=s+o,i)));if(a==Ue){4==e&&(t.h=4,be(),u=!1),de(t.c,t.f,null,"[Incomplete Response]");break}if(a==Ce){t.h=4,be(),de(t.c,t.f,n,"[Invalid Chunk]"),u=!1;break}de(t.c,t.f,a,null),He(t,a)}4==e&&0==n.length&&(t.h=1,be(),u=!1),t.b=t.b&&u,u?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),rr(e),e.F=!0)):(de(t.c,t.f,n,"[Invalid Chunked Response]"),ze(t),Be(t))}function qe(t){t.U=M()+t.P,je(t,t.P)}function je(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=Ie(U(t.Ua,t),e)}function Ge(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function Be(t){0==t.g.v||t.A||sr(t.g,t)}function ze(t){Ge(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,ee(t.R),le(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function He(t,e){try{var n,r,i,o,s,u,a,h,c,f,l,p=t.g;if(0!=p.v&&(p.a==t||_n(p.b,t)))if(p.I=t.N,!t.C&&_n(p.b,t)&&3==p.v){try{var d=p.ka.a.parse(e)}catch(t){d=null}if(Array.isArray(d)&&3==d.length){var y=d;if(0==y[0]){t:if(!p.j){if(p.a){if(!(p.a.u+3e3<t.u))break t;or(p),Yn(p)}nr(p),be()}}else p.oa=y[1],0<p.oa-p.P&&y[2]<37500&&p.H&&0==p.o&&!p.m&&(p.m=Ie(U(p.Ra,p),6e3));if(Nn(p.b)<=1&&p.ea){try{p.ea()}catch(t){}p.ea=void 0}}else ar(p,11)}else if(!t.C&&p.a!=t||or(p),!H(e))for(e=d=p.ka.a.parse(e),d=0;d<e.length;d++)y=e[d],p.P=y[0],y=y[1],2==p.v?"c"==y[0]?(p.J=y[1],p.ga=y[2],null!=(n=y[3])&&(p.ha=n,p.c.info("VER="+p.ha)),null!=(r=y[4])&&(p.pa=r,p.c.info("SVER="+p.pa)),null!=(i=y[5])&&"number"==typeof i&&0<i&&(o=1.5*i,p.D=o,p.c.info("backChannelRequestTimeoutMs_="+o)),o=p,(s=t.a)&&(!(u=s.a?s.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(a=o.b).a&&(Y(u,"spdy")||Y(u,"quic")||Y(u,"h2"))&&(a.f=a.g,a.a=new Set,a.b&&(An(a,a.b),a.b=null)),!o.A||(h=s.a?s.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(o.na=h,rn(o.B,o.A,h))),p.v=3,p.f&&p.f.ta(),p.V&&(p.N=M()-t.u,p.c.info("Handshake RTT: "+p.N+"ms")),c=t,(o=p).la=cr(o,o.C?o.ga:null,o.fa),c.C?(Sn(o.b,c),f=c,(l=o.D)&&f.setTimeout(l),f.o&&(Ge(f),qe(f)),o.a=c):er(o),0<p.g.length&&Zn(p)):"stop"!=y[0]&&"close"!=y[0]||ar(p,7):3==p.v&&("stop"==y[0]||"close"==y[0]?"stop"==y[0]?ar(p,7):Kn(p):"noop"!=y[0]&&p.f&&p.f.sa(y),p.o=0);me()}catch(t){}}function We(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(R(t)||"string"==typeof t)G(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(R(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(R(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ke(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ke)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Ye(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Xe(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Xe(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Xe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(_=Oe.prototype).setTimeout=function(t){this.P=t},_.Wa=function(t){t=t.target;var e=this.F;e&&3==Bn(t)?e.f():this.Ca(t)},_.Ca=function(t){try{if(t==this.a)t:{var e=Bn(this.a),n=this.a.ua();this.a.X();if(!(e<3||3==e&&!at&&!this.a.$())){this.A||4!=e||7==n||me(),Ge(this);var r=this.a.X();this.N=r;var i=this.a.$();if(this.b=200==r,a=this.c,h=this.m,c=this.l,f=this.f,l=this.T,p=e,d=r,a.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+l+"]: "+h+"\n"+c+"\n"+p+" "+d}),this.b){if(this.V&&!this.C){e:{if(this.a){var o,s=this.a;if((o=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(o)){var u=o;break e}}u=null}if(!u){this.b=!1,this.h=3,be(),ze(this),Be(this);break t}de(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,He(this,u)}this.I?(Fe(this,e,i),at&&this.b&&3==e&&(fe(this.J,this.R,"tick",this.Va),this.R.start())):(de(this.c,this.f,i,null),He(this,i)),4==e&&ze(this),this.b&&!this.A&&(4==e?sr(this.g,this):(this.b=!1,qe(this)))}else 400==r&&0<i.indexOf("Unknown SID")?this.h=3:this.h=0,be(),ze(this),Be(this)}}}catch(t){}var a,h,c,f,l,p,d},_.Va=function(){var t,e;this.a&&(t=Bn(this.a),e=this.a.$(),this.D<e.length&&(Ge(this),Fe(this,t,e),this.b&&4!=t&&qe(this)))},_.cancel=function(){this.A=!0,ze(this)},_.Ua=function(){this.o=null;var t,e,n=M();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(me(),be()),ze(this),this.h=2,Be(this)):je(this,this.U-n)},(_=Ke.prototype).K=function(){Ye(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},_.L=function(){return Ye(this),this.a.concat()},_.get=function(t,e){return Xe(this.b,t)?this.b[t]:e},_.set=function(t,e){Xe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},_.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Qe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ze(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ze?(this.a=void 0!==e?e:t.a,$e(this,t.f),this.j=t.j,tn(this,t.c),en(this,t.h),this.g=t.g,e=t.b,(n=new dn).c=e.c,e.a&&(n.a=new Ke(e.a),n.b=e.b),nn(this,n),this.i=t.i):t&&(n=String(t).match(Qe))?(this.a=!!e,$e(this,n[1]||"",!0),this.j=sn(n[2]||""),tn(this,n[3]||"",!0),en(this,n[4]),this.g=sn(n[5]||"",!0),nn(this,n[6]||"",!0),this.i=sn(n[7]||"")):(this.a=!!e,this.b=new dn(null,this.a))}function Je(t){return new Ze(t)}function $e(t,e,n){t.f=n?sn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function tn(t,e,n){t.c=n?sn(e,!0):e}function en(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function nn(t,e,n){var r,i;e instanceof dn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(yn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(vn(this,e),mn(this,n,t))},r)),r.f=i):(n||(e=un(e,ln)),t.b=new dn(e,t.a))}function rn(t,e,n){t.b.set(e,n)}function on(t){return rn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^M()).toString(36)),t}function sn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function un(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,an),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function an(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ze.prototype.toString=function(){var t=[],e=this.f;e&&t.push(un(e,hn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(un(e,hn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(un(n,"/"==n.charAt(0)?fn:cn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",un(n,pn)),t.join("")};var hn=/[#\/\?@]/g,cn=/[#\?:]/g,fn=/[#\?]/g,ln=/[#\?@]/g,pn=/#/g;function dn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function yn(u){u.a||(u.a=new Ke,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function vn(t,e){yn(t),e=wn(t,e),Xe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Xe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Ye(t)))}function gn(t,e){return yn(t),e=wn(t,e),Xe(t.a.b,e)}function mn(t,e,n){vn(t,e),0<n.length&&(t.c=null,t.a.set(wn(t,e),z(n)),t.b+=n.length)}function wn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function bn(t,e){this.b=t,this.a=e}function En(t){this.g=t||In,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(_=dn.prototype).add=function(t,e){yn(this),this.c=null,t=wn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},_.forEach=function(n,r){yn(this),this.a.forEach(function(t,e){G(t,function(t){n.call(r,t,e,this)},this)},this)},_.L=function(){yn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},_.K=function(t){yn(this);var e=[];if("string"==typeof t)gn(this,t)&&(e=B(e,this.a.get(wn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},_.set=function(t,e){return yn(this),this.c=null,gn(this,t=wn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},_.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},_.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var In=10;function Tn(t){return t.b||t.a&&t.a.size>=t.f}function Nn(t){return t.b?1:t.a?t.a.size:0}function _n(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function An(t,e){t.a?t.a.add(e):t.b=e}function Sn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Dn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=N(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function kn(){}function Rn(){this.a=new kn}function Ln(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}En.prototype.cancel=function(){var t,e;if(this.c=Dn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=N(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},kn.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},kn.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var xn=S.JSON.parse;function On(t){Gt.call(this),this.headers=new Ke,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Pn,this.D=this.F=!1}F(On,Gt);var Pn="",Cn=/^https?$/i,Un=["POST","PUT"];function Vn(t){return"content-type"==t.toLowerCase()}function Mn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Fn(t),jn(t)}function Fn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function qn(t){if(t.b&&(!t.s[1]||4!=Bn(t)||2!=t.X()))if(t.l&&4==Bn(t))ne(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==Bn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Qe)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!Cn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Bn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Fn(t)}}finally{jn(t)}}}function jn(t,e){if(t.a){Gn(t);var n=t.a,r=t.s[0]?D:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Gn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function Bn(t){return t.a?t.a.readyState:0}function zn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",J(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):rn(t,e,n))}function Hn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Wn(t){this.pa=0,this.g=[],this.c=new pe,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Hn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Hn("baseRetryDelayMs",5e3,t),this.Ma=Hn("retryDelaySeedMs",1e4,t),this.Ja=Hn("forwardChannelMaxRetries",2,t),this.ma=Hn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new En(t&&t.concurrentRequestLimit),this.ka=new Rn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Kn(t){var e,n;Xn(t),3==t.v&&(e=t.R++,rn(n=Je(t.B),"SID",t.J),rn(n,"RID",e),rn(n,"TYPE","terminate"),$n(t,n),(e=new Oe(t,t.c,e,void 0)).H=2,e.i=on(Je(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.i.toString(),"")),!n&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=fr(e.g,null),e.a.ba(e.i)),e.u=M(),qe(e)),hr(t)}function Yn(t){t.a&&(rr(t),t.a.cancel(),t.a=null)}function Xn(t){Yn(t),t.j&&(S.clearTimeout(t.j),t.j=null),or(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function Qn(t,e){t.g.push(new bn(t.La++,e)),3==t.v&&Zn(t)}function Zn(t){Tn(t.b)||t.h||(t.h=!0,Qt(t.Ba,t),t.u=0)}function Jn(t,e){var n=e?e.f:t.R++,r=Je(t.B);rn(r,"SID",t.J),rn(r,"RID",n),rn(r,"AID",t.P),$n(t,r),t.i&&t.l&&zn(r,t.i,t.l),n=new Oe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=tr(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),An(t.b,n),Ve(n,r,e)}function $n(t,n){t.f&&We({},function(t,e){rn(n,e,t)})}function tr(t,e,n){n=Math.min(t.g.length,n);var r=t.f?U(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+h+"_"||"";try{We(t,function(t,e){var n=t;L(t)&&(n=zt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s)}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function er(t){t.a||t.j||(t.U=1,Qt(t.Aa,t),t.o=0)}function nr(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=Ie(U(t.Aa,t),ur(t,t.o)),t.o++,1)}function rr(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function ir(t){t.a=new Oe(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Je(t.la);rn(e,"RID","rpc"),rn(e,"SID",t.J),rn(e,"CI",t.H?"0":"1"),rn(e,"AID",t.P),$n(t,e),rn(e,"TYPE","xmlhttp"),t.i&&t.l&&zn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=on(Je(e)),n.j=null,n.I=!0,Me(n,t)}function or(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function sr(t,e){var n,r=null;if(t.a==e){or(t),rr(t),t.a=null;var i=2}else{if(!_n(t.b,e))return;r=e.s,Sn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b)1==i?(r=e.j?e.j.length:0,e=M()-e.u,n=t.u,(i=ve()).dispatchEvent(new Ee(i)),Zn(t)):er(t);else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(Nn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=Ie(U(t.Ba,t,e),ur(t,t.u)),t.u++,1}}(t,e)||2==i&&nr(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:ar(t,5);break;case 4:ar(t,10);break;case 3:ar(t,6);break;default:ar(t,2)}}function ur(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function ar(t,e){var n,r,i,o,s,u;t.c.info("Error code "+e),2==e?(n=null,t.f&&(n=null),r=U(t.Xa,t),n||(n=new Ze("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||$e(n,"https"),on(n)),i=n.toString(),o=r,u=new pe,S.Image?((s=new Image).onload=V(Ln,u,s,"TestLoadImage: loaded",!0,o),s.onerror=V(Ln,u,s,"TestLoadImage: error",!1,o),s.onabort=V(Ln,u,s,"TestLoadImage: abort",!1,o),s.ontimeout=V(Ln,u,s,"TestLoadImage: timeout",!1,o),S.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=i):o(!1)):be(),t.v=0,t.f&&t.f.ra(e),hr(t),Xn(t)}function hr(t){t.v=0,t.I=-1,t.f&&(0==Dn(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function cr(t,e,n){var r,i,o,s,u,a,h,c=(r=n)instanceof Ze?Je(r):new Ze(r,void 0);return""!=c.c?(e&&tn(c,e+"."+c.c),en(c,c.h)):(o=(i=S.location).protocol,s=e?e+"."+i.hostname:i.hostname,u=+i.port,a=n,h=new Ze(null,void 0),o&&$e(h,o),s&&tn(h,s),u&&en(h,u),a&&(h.g=a),c=h),t.W&&J(t.W,function(t,e){rn(c,e,t)}),e=t.A,n=t.na,e&&n&&rn(c,e,n),rn(c,"VER",t.ha),$n(t,c),c}function fr(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new On(t.Ka)).F=t.C,e}function lr(){}function pr(){if(st&&!(10<=Number(gt)))throw Error("Environmental error: no available transport.")}function dr(t,e){Gt.call(this),this.a=new Wn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new gr(this)}function yr(t){Re.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function vr(){Le.call(this),this.status=1}function gr(t){this.a=t}(_=On.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ae(this.H):Ae(De),this.a.onreadystatechange=U(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Mn(this,t)}t=n||"";var i,o=new Ke(this.headers);r&&We(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Vn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=j(Un,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Gn(this),0<this.o&&((this.D=(i=this.a,st&&vt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=U(this.xa,this)):this.m=ne(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Mn(this,t)}},_.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},_.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),jn(this))},_.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),jn(this,!0)),On.S.G.call(this)},_.za=function(){this.j||(this.A||this.l||this.g?qn(this):this.Ta())},_.Ta=function(){qn(this)},_.X=function(){try{return 2<Bn(this)?this.a.status:-1}catch(t){return-1}},_.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},_.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),xn(e)}},_.ua=function(){return this.h},_.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(_=Wn.prototype).ha=8,_.v=1,_.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Oe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?et(r=$(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=tr(this,n,e),rn(i=Je(this.B),"RID",t),rn(i,"CVER",22),this.A&&rn(i,"X-HTTP-Session-Id",this.A),$n(this,i),this.i&&r&&zn(i,this.i,r),An(this.b,n),this.Ga&&rn(i,"TYPE","init"),this.da?(rn(i,"$req",e),rn(i,"SID","null"),n.V=!0,Ve(n,i,null)):Ve(n,i,e),this.v=2}}else 3==this.v&&(t?Jn(this,t):0==this.g.length||Tn(this.b)||Jn(this))},_.Aa=function(){var t;this.j=null,ir(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=Ie(U(this.Sa,this),t))},_.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Yn(this),ir(this))},_.Ra=function(){null!=this.m&&(this.m=null,Yn(this),nr(this),be())},_.Xa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),be()},(_=lr.prototype).ta=function(){},_.sa=function(){},_.ra=function(){},_.qa=function(){},_.Ha=function(){},pr.prototype.a=function(t,e){return new dr(t,e)},F(dr,Gt),(_=dr.prototype).addEventListener=function(t,e,n,r){dr.S.addEventListener.call(this,t,e,n,r)},_.removeEventListener=function(t,e,n,r){dr.S.removeEventListener.call(this,t,e,n,r)},_.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;be(),t.fa=e,t.W=n||{},t.H=t.T,t.B=cr(t,null,t.fa),Zn(t)},_.close=function(){Kn(this.a)},_.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Qn(this.a,e)):this.g?((e={}).__data__=zt(t),Qn(this.a,e)):Qn(this.a,t)},_.G=function(){this.a.f=null,delete this.f,Kn(this.a),delete this.a,dr.S.G.call(this)},F(yr,Re),F(vr,Le),F(gr,lr),gr.prototype.ta=function(){this.a.dispatchEvent("a")},gr.prototype.sa=function(t){this.a.dispatchEvent(new yr(t))},gr.prototype.ra=function(t){this.a.dispatchEvent(new vr)},gr.prototype.qa=function(){this.a.dispatchEvent("b")},pr.prototype.createWebChannel=pr.prototype.a,dr.prototype.send=dr.prototype.Pa,dr.prototype.open=dr.prototype.Oa,Te.NO_ERROR=0,Te.TIMEOUT=8,Te.HTTP_ERROR=6,Ne.COMPLETE="complete",(Se.EventType=ke).OPEN="a",ke.CLOSE="b",ke.ERROR="c",ke.MESSAGE="d",Gt.prototype.listen=Gt.prototype.va,On.prototype.listenOnce=On.prototype.wa,On.prototype.getLastError=On.prototype.Qa,On.prototype.getLastErrorCode=On.prototype.ua,On.prototype.getStatus=On.prototype.X,On.prototype.getResponseJson=On.prototype.Na,On.prototype.getResponseText=On.prototype.$,On.prototype.send=On.prototype.ba;var mr={createWebChannelTransport:function(){return new pr},ErrorCode:Te,EventType:Ne,WebChannel:Se,XhrIo:On},wr=mr.createWebChannelTransport,br=mr.ErrorCode,Er=mr.EventType,Ir=mr.WebChannel,Tr=mr.XhrIo,Nr=(_r.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},_r.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},_r.prototype.setServiceProps=function(t){return this.serviceProps=t,this},_r);function _r(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Ar=new c("@firebase/firestore");function Sr(){return Ar.logLevel}function Dr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=l.DEBUG&&(e=n.map(Lr),Ar.debug.apply(Ar,i(["Firestore (7.19.0): "+t],e)))}function kr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=l.ERROR&&(e=n.map(Lr),Ar.error.apply(Ar,i(["Firestore (7.19.0): "+t],e)))}function Rr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=l.WARN&&(e=n.map(Lr),Ar.warn.apply(Ar,i(["Firestore (7.19.0): "+t],e)))}function Lr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function xr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (7.19.0) INTERNAL ASSERTION FAILED: "+t;throw kr(e),new Error(e)}function Or(t){t||xr()}var Pr=(Cr.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Cr);function Cr(){}function Ur(t,e){return t<e?-1:e<t?1:0}function Vr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Mr(t){return t+"\0"}function Fr(t,e,n,r,i){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var qr=(Object.defineProperty(jr.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),jr.prototype.isEqual=function(t){return t instanceof jr&&t.projectId===this.projectId&&t.database===this.database},jr.prototype.o=function(t){return Ur(this.projectId,t.projectId)||Ur(this.database,t.database)},jr);function jr(t,e){this.projectId=t,this.database=e||"(default)"}function Gr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Br(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function zr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Hr,Wr,Kr,Yr=(fi.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.u(s,t))return u}},fi.prototype.has=function(t){return void 0!==this.get(t)},fi.prototype.set=function(t,e){var n=this.h(t),r=this.l[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.u(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.l[n]=[[t,e]]},fi.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.u(n[r][0],t))return 1===n.length?delete this.l[e]:n.splice(r,1),!0;return!1},fi.prototype.forEach=function(u){Br(this.l,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];u(o,s)}})},fi.prototype._=function(){return zr(this.l)},fi),Xr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Qr=(n(ci,Kr=Error),ci),Zr=(hi.now=function(){return hi.fromMillis(Date.now())},hi.fromDate=function(t){return hi.fromMillis(t.getTime())},hi.fromMillis=function(t){var e=Math.floor(t/1e3);return new hi(e,1e6*(t-1e3*e))},hi.prototype.toDate=function(){return new Date(this.toMillis())},hi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},hi.prototype.T=function(t){return this.seconds===t.seconds?Ur(this.nanoseconds,t.nanoseconds):Ur(this.seconds,t.seconds)},hi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},hi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},hi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},hi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},hi),Jr=(ai.m=function(t){return new ai(t)},ai.min=function(){return new ai(new Zr(0,0))},ai.prototype.o=function(t){return this.timestamp.T(t.timestamp)},ai.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},ai.prototype.I=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},ai.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},ai.prototype.A=function(){return this.timestamp},ai),$r=(Object.defineProperty(ui.prototype,"length",{get:function(){return this.R},enumerable:!1,configurable:!0}),ui.prototype.isEqual=function(t){return 0===ui.P(this,t)},ui.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ui?t.forEach(function(t){e.push(t)}):e.push(t),this.g(e)},ui.prototype.limit=function(){return this.offset+this.length},ui.prototype.V=function(t){return t=void 0===t?1:t,this.g(this.segments,this.offset+t,this.length-t)},ui.prototype.p=function(){return this.g(this.segments,this.offset,this.length-1)},ui.prototype.v=function(){return this.segments[this.offset]},ui.prototype.S=function(){return this.get(this.length-1)},ui.prototype.get=function(t){return this.segments[this.offset+t]},ui.prototype._=function(){return 0===this.length},ui.prototype.D=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ui.prototype.C=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ui.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ui.prototype.N=function(){return this.segments.slice(this.offset,this.limit())},ui.P=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ui),ti=(n(si,Wr=$r),si.prototype.g=function(t,e,n){return new si(t,e,n)},si.prototype.F=function(){return this.N().join("/")},si.prototype.toString=function(){return this.F()},si.k=function(t){if(0<=t.indexOf("//"))throw new Qr(Xr.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new si(t.split("/").filter(function(t){return 0<t.length}))},si.$=function(){return new si([])},si),ei=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ni=(n(oi,Hr=$r),oi.prototype.g=function(t,e,n){return new oi(t,e,n)},oi.O=function(t){return ei.test(t)},oi.prototype.F=function(){return this.N().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),oi.O(t)||(t="`"+t+"`"),t}).join(".")},oi.prototype.toString=function(){return this.F()},oi.prototype.M=function(){return 1===this.length&&"__name__"===this.get(0)},oi.L=function(){return new oi(["__name__"])},oi.q=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Qr(Xr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Qr(Xr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Qr(Xr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Qr(Xr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new oi(e)},oi.$=function(){return new oi([])},oi),ri=(ii.B=function(t){return new ii(ti.k(t))},ii.U=function(t){return new ii(ti.k(t).V(5))},ii.prototype.W=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ii.prototype.isEqual=function(t){return null!==t&&0===ti.P(this.path,t.path)},ii.prototype.toString=function(){return this.path.toString()},ii.P=function(t,e){return ti.P(t.path,e.path)},ii.j=function(t){return t.length%2==0},ii.K=function(t){return new ii(new ti(t.slice()))},ii);function ii(t){this.path=t}function oi(){return null!==Hr&&Hr.apply(this,arguments)||this}function si(){return null!==Wr&&Wr.apply(this,arguments)||this}function ui(t,e,n){void 0===e?e=0:e>t.length&&xr(),void 0===n?n=t.length-e:n>t.length-e&&xr(),this.segments=t,this.offset=e,this.R=n}function ai(t){this.timestamp=t}function hi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Qr(Xr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Qr(Xr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Qr(Xr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Qr(Xr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function ci(t,e){var n=this;return(n=Kr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function fi(t,e){this.h=t,this.u=e,this.l={}}function li(t){return null==t}function pi(t){return-0===t&&1/t==-1/0}function di(t){return"number"==typeof t&&Number.isInteger(t)&&!pi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var yi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.G=null};function vi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new yi(t,e,n,r,i,o,s)}function gi(t){var e,n=t;return null===n.G&&(e=n.path.F(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return(e=t).field.F()+e.op.toString()+bo(e.value);var e}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return(e=t).field.F()+e.dir;var e}).join(","),li(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=Zu(n.startAt)),n.endAt&&(e+="|ub:",e+=Zu(n.endAt)),n.G=e),n.G}function mi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!vo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!$u(t.startAt,e.startAt)&&$u(t.endAt,e.endAt)}function wi(t){return ri.j(t.path)&&null===t.collectionGroup&&0===t.filters.length}var bi=(Ei.fromBase64String=function(t){return new Ei(atob(t))},Ei.fromUint8Array=function(t){return new Ei(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Ei.prototype.toBase64=function(){return t=this.H,btoa(t);var t},Ei.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.H)},Ei.prototype.Y=function(){return 2*this.H.length},Ei.prototype.o=function(t){return Ur(this.H,t.H)},Ei.prototype.isEqual=function(t){return this.H===t.H},Ei);function Ei(t){this.H=t}function Ii(t){this.count=t}bi.J=new bi("");var Ti,Ni,_i=(Ai.prototype.tt=function(t){return new Ai(this.target,this.targetId,this.X,t,this.Z,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Ai.prototype.et=function(t,e){return new Ai(this.target,this.targetId,this.X,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Ai.prototype.nt=function(t){return new Ai(this.target,this.targetId,this.X,this.sequenceNumber,this.Z,t,this.resumeToken)},Ai);function Ai(t,e,n,r,i,o,s){void 0===i&&(i=Jr.min()),void 0===o&&(o=Jr.min()),void 0===s&&(s=bi.J),this.target=t,this.targetId=e,this.X=n,this.sequenceNumber=r,this.Z=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Si(t){switch(t){case Xr.OK:return xr(),0;case Xr.CANCELLED:case Xr.UNKNOWN:case Xr.DEADLINE_EXCEEDED:case Xr.RESOURCE_EXHAUSTED:case Xr.INTERNAL:case Xr.UNAVAILABLE:case Xr.UNAUTHENTICATED:return;case Xr.INVALID_ARGUMENT:case Xr.NOT_FOUND:case Xr.ALREADY_EXISTS:case Xr.PERMISSION_DENIED:case Xr.FAILED_PRECONDITION:case Xr.ABORTED:case Xr.OUT_OF_RANGE:case Xr.UNIMPLEMENTED:case Xr.DATA_LOSS:return 1;default:return xr(),0}}function Di(t){if(void 0===t)return kr("GRPC error has no .code"),Xr.UNKNOWN;switch(t){case Ti.OK:return Xr.OK;case Ti.CANCELLED:return Xr.CANCELLED;case Ti.UNKNOWN:return Xr.UNKNOWN;case Ti.DEADLINE_EXCEEDED:return Xr.DEADLINE_EXCEEDED;case Ti.RESOURCE_EXHAUSTED:return Xr.RESOURCE_EXHAUSTED;case Ti.INTERNAL:return Xr.INTERNAL;case Ti.UNAVAILABLE:return Xr.UNAVAILABLE;case Ti.UNAUTHENTICATED:return Xr.UNAUTHENTICATED;case Ti.INVALID_ARGUMENT:return Xr.INVALID_ARGUMENT;case Ti.NOT_FOUND:return Xr.NOT_FOUND;case Ti.ALREADY_EXISTS:return Xr.ALREADY_EXISTS;case Ti.PERMISSION_DENIED:return Xr.PERMISSION_DENIED;case Ti.FAILED_PRECONDITION:return Xr.FAILED_PRECONDITION;case Ti.ABORTED:return Xr.ABORTED;case Ti.OUT_OF_RANGE:return Xr.OUT_OF_RANGE;case Ti.UNIMPLEMENTED:return Xr.UNIMPLEMENTED;case Ti.DATA_LOSS:return Xr.DATA_LOSS;default:return xr()}}(Ni=Ti=Ti||{})[Ni.OK=0]="OK",Ni[Ni.CANCELLED=1]="CANCELLED",Ni[Ni.UNKNOWN=2]="UNKNOWN",Ni[Ni.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ni[Ni.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ni[Ni.NOT_FOUND=5]="NOT_FOUND",Ni[Ni.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ni[Ni.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ni[Ni.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ni[Ni.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ni[Ni.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ni[Ni.ABORTED=10]="ABORTED",Ni[Ni.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ni[Ni.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ni[Ni.INTERNAL=13]="INTERNAL",Ni[Ni.UNAVAILABLE=14]="UNAVAILABLE",Ni[Ni.DATA_LOSS=15]="DATA_LOSS";var ki=(Pi.prototype.st=function(t,e){return new Pi(this.P,this.root.st(t,e,this.P).copy(null,null,Li.it,null,null))},Pi.prototype.remove=function(t){return new Pi(this.P,this.root.remove(t,this.P).copy(null,null,Li.it,null,null))},Pi.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Pi.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var r=this.P(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Pi.prototype._=function(){return this.root._()},Object.defineProperty(Pi.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Pi.prototype.rt=function(){return this.root.rt()},Pi.prototype.ot=function(){return this.root.ot()},Pi.prototype.ht=function(t){return this.root.ht(t)},Pi.prototype.forEach=function(n){this.ht(function(t,e){return n(t,e),!1})},Pi.prototype.toString=function(){var n=[];return this.ht(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Pi.prototype.at=function(t){return this.root.at(t)},Pi.prototype.ct=function(){return new Ri(this.root,null,this.P,!1)},Pi.prototype.ut=function(t){return new Ri(this.root,t,this.P,!1)},Pi.prototype.lt=function(){return new Ri(this.root,null,this.P,!0)},Pi.prototype._t=function(t){return new Ri(this.root,t,this.P,!0)},Pi),Ri=(Oi.prototype.wt=function(){var t=this.dt.pop(),e={key:t.key,value:t.value};if(this.ft)for(t=t.left;!t._();)this.dt.push(t),t=t.right;else for(t=t.right;!t._();)this.dt.push(t),t=t.left;return e},Oi.prototype.Tt=function(){return 0<this.dt.length},Oi.prototype.Et=function(){if(0===this.dt.length)return null;var t=this.dt[this.dt.length-1];return{key:t.key,value:t.value}},Oi),Li=(xi.prototype.copy=function(t,e,n,r,i){return new xi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},xi.prototype._=function(){return!1},xi.prototype.ht=function(t){return this.left.ht(t)||t(this.key,this.value)||this.right.ht(t)},xi.prototype.at=function(t){return this.right.at(t)||t(this.key,this.value)||this.left.at(t)},xi.prototype.min=function(){return this.left._()?this:this.left.min()},xi.prototype.rt=function(){return this.min().key},xi.prototype.ot=function(){return this.right._()?this.key:this.right.ot()},xi.prototype.st=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.st(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.st(t,e,n))).It()},xi.prototype.At=function(){if(this.left._())return xi.EMPTY;var t=this;return t.left.Rt()||t.left.left.Rt()||(t=t.Pt()),(t=t.copy(null,null,null,t.left.At(),null)).It()},xi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left._()||r.left.Rt()||r.left.left.Rt()||(r=r.Pt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Rt()&&(r=r.gt()),r.right._()||r.right.Rt()||r.right.left.Rt()||(r=r.Vt()),0===e(t,r.key)){if(r.right._())return xi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.At())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.It()},xi.prototype.Rt=function(){return this.color},xi.prototype.It=function(){var t=this;return t.right.Rt()&&!t.left.Rt()&&(t=t.yt()),t.left.Rt()&&t.left.left.Rt()&&(t=t.gt()),t.left.Rt()&&t.right.Rt()&&(t=t.pt()),t},xi.prototype.Pt=function(){var t=this.pt();return t.right.left.Rt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.gt())).yt()).pt()),t},xi.prototype.Vt=function(){var t=this.pt();return t.left.left.Rt()&&(t=(t=t.gt()).pt()),t},xi.prototype.yt=function(){var t=this.copy(null,null,xi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},xi.prototype.gt=function(){var t=this.copy(null,null,xi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},xi.prototype.pt=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},xi.prototype.bt=function(){var t=this.vt();return Math.pow(2,t)<=this.size+1},xi.prototype.vt=function(){if(this.Rt()&&this.left.Rt())throw xr();if(this.right.Rt())throw xr();var t=this.left.vt();if(t!==this.right.vt())throw xr();return t+(this.Rt()?0:1)},xi);function xi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:xi.RED,this.left=null!=r?r:xi.EMPTY,this.right=null!=i?i:xi.EMPTY,this.size=this.left.size+1+this.right.size}function Oi(t,e,n,r){this.ft=r,this.dt=[];for(var i=1;!t._();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.ft?t.left:t.right;else{if(0===i){this.dt.push(t);break}this.dt.push(t),t=this.ft?t.right:t.left}}function Pi(t,e){this.P=t,this.root=e||Li.EMPTY}function Ci(){this.size=0}Li.EMPTY=null,Li.RED=!0,Li.it=!1,Li.EMPTY=(Object.defineProperty(Ci.prototype,"key",{get:function(){throw xr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ci.prototype,"value",{get:function(){throw xr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ci.prototype,"color",{get:function(){throw xr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ci.prototype,"left",{get:function(){throw xr()},enumerable:!1,configurable:!0}),Object.defineProperty(Ci.prototype,"right",{get:function(){throw xr()},enumerable:!1,configurable:!0}),Ci.prototype.copy=function(t,e,n,r,i){return this},Ci.prototype.st=function(t,e,n){return new Li(t,e)},Ci.prototype.remove=function(t,e){return this},Ci.prototype._=function(){return!0},Ci.prototype.ht=function(t){return!1},Ci.prototype.at=function(t){return!1},Ci.prototype.rt=function(){return null},Ci.prototype.ot=function(){return null},Ci.prototype.Rt=function(){return!1},Ci.prototype.bt=function(){return!0},Ci.prototype.vt=function(){return 0},new Ci);var Ui=(qi.prototype.has=function(t){return null!==this.data.get(t)},qi.prototype.first=function(){return this.data.rt()},qi.prototype.last=function(){return this.data.ot()},Object.defineProperty(qi.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),qi.prototype.indexOf=function(t){return this.data.indexOf(t)},qi.prototype.forEach=function(n){this.data.ht(function(t,e){return n(t),!1})},qi.prototype.St=function(t,e){for(var n=this.data.ut(t[0]);n.Tt();){var r=n.wt();if(0<=this.P(r.key,t[1]))return;e(r.key)}},qi.prototype.Dt=function(t,e){for(var n=void 0!==e?this.data.ut(e):this.data.ct();n.Tt();)if(!t(n.wt().key))return},qi.prototype.Ct=function(t){var e=this.data.ut(t);return e.Tt()?e.wt().key:null},qi.prototype.ct=function(){return new Vi(this.data.ct())},qi.prototype.ut=function(t){return new Vi(this.data.ut(t))},qi.prototype.add=function(t){return this.copy(this.data.remove(t).st(t,!0))},qi.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},qi.prototype._=function(){return this.data._()},qi.prototype.Nt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},qi.prototype.isEqual=function(t){if(!(t instanceof qi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.ct(),n=t.data.ct();e.Tt();){var r=e.wt().key,i=n.wt().key;if(0!==this.P(r,i))return!1}return!0},qi.prototype.N=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},qi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},qi.prototype.copy=function(t){var e=new qi(this.P);return e.data=t,e},qi),Vi=(Fi.prototype.wt=function(){return this.Ft.wt().key},Fi.prototype.Tt=function(){return this.Ft.Tt()},Fi),Mi=new ki(ri.P);function Fi(t){this.Ft=t}function qi(t){this.P=t,this.data=new ki(this.P)}var ji=new ki(ri.P),Gi=new ki(ri.P),Bi=new Ui(ri.P);function zi(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Bi,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Hi=new Ui(Ur);function Wi(t,e,n,r){this.te=t,this.removedTargetIds=e,this.key=n,this.ee=r}function Ki(t,e){this.targetId=t,this.ne=e}function Yi(t,e,n,r){void 0===n&&(n=bi.J),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}var Xi=(ao.xt=function(t){return new ao(t.P)},ao.prototype.has=function(t){return null!=this.kt.get(t)},ao.prototype.get=function(t){return this.kt.get(t)},ao.prototype.first=function(){return this.$t.rt()},ao.prototype.last=function(){return this.$t.ot()},ao.prototype._=function(){return this.$t._()},ao.prototype.indexOf=function(t){var e=this.kt.get(t);return e?this.$t.indexOf(e):-1},Object.defineProperty(ao.prototype,"size",{get:function(){return this.$t.size},enumerable:!1,configurable:!0}),ao.prototype.forEach=function(n){this.$t.ht(function(t,e){return n(t),!1})},ao.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.kt.st(t.key,t),e.$t.st(t,null))},ao.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.kt.remove(t),this.$t.remove(e)):this},ao.prototype.isEqual=function(t){if(!(t instanceof ao))return!1;if(this.size!==t.size)return!1;for(var e=this.$t.ct(),n=t.$t.ct();e.Tt();){var r=e.wt().key,i=n.wt().key;if(!r.isEqual(i))return!1}return!0},ao.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},ao.prototype.copy=function(t,e){var n=new ao;return n.P=this.P,n.kt=t,n.$t=e,n},ao),Qi=(uo.prototype.track=function(t){var e=t.doc.key,n=this.Ot.get(e);!n||0!==t.type&&3===n.type?this.Ot=this.Ot.st(e,t):3===t.type&&1!==n.type?this.Ot=this.Ot.st(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Ot=this.Ot.st(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Ot=this.Ot.st(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Ot=this.Ot.remove(e):1===t.type&&2===n.type?this.Ot=this.Ot.st(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Ot=this.Ot.st(e,{type:2,doc:t.doc}):xr()},uo.prototype.Mt=function(){var n=[];return this.Ot.ht(function(t,e){n.push(e)}),n},uo),Zi=(so.Qt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new so(t,e,Xi.xt(e),i,n,r,!0,!1)},Object.defineProperty(so.prototype,"hasPendingWrites",{get:function(){return!this.qt._()},enumerable:!1,configurable:!0}),so.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Bt===t.Bt&&this.qt.isEqual(t.qt)&&bu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Lt.isEqual(t.Lt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},so),Ji=(oo.zt=function(t,e){var n=new Map;return n.set(t,$i.Ht(t,e)),new oo(Jr.min(),n,Hi,Mi,zi())},oo),$i=(io.Ht=function(t,e){return new io(bi.J,e,zi(),zi(),zi())},io),to=(Object.defineProperty(ro.prototype,"Yt",{get:function(){return this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"resumeToken",{get:function(){return this.re},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"ae",{get:function(){return 0!==this.se},enumerable:!1,configurable:!0}),Object.defineProperty(ro.prototype,"ce",{get:function(){return this.he},enumerable:!1,configurable:!0}),ro.prototype.ue=function(t){0<t.Y()&&(this.he=!0,this.re=t)},ro.prototype.le=function(){var n=zi(),r=zi(),i=zi();return this.ie.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:xr()}}),new $i(this.re,this.oe,n,r,i)},ro.prototype._e=function(){this.he=!1,this.ie=co()},ro.prototype.fe=function(t,e){this.he=!0,this.ie=this.ie.st(t,e)},ro.prototype.de=function(t){this.he=!0,this.ie=this.ie.remove(t)},ro.prototype.we=function(){this.se+=1},ro.prototype.Te=function(){--this.se},ro.prototype.Ee=function(){this.he=!0,this.oe=!0},ro),eo=(no.prototype.ge=function(t){for(var e=0,n=t.te;e<n.length;e++){var r=n[e];t.ee instanceof ru?this.Ve(r,t.ee):t.ee instanceof iu&&this.ye(r,t.key,t.ee)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.ye(s,t.key,t.ee)}},no.prototype.pe=function(n){var r=this;this.be(n,function(t){var e=r.ve(t);switch(n.state){case 0:r.Se(t)&&e.ue(n.resumeToken);break;case 1:e.Te(),e.ae||e._e(),e.ue(n.resumeToken);break;case 2:e.Te(),e.ae||r.removeTarget(t);break;case 3:r.Se(t)&&(e.Ee(),e.ue(n.resumeToken));break;case 4:r.Se(t)&&(r.De(t),e.ue(n.resumeToken));break;default:xr()}})},no.prototype.be=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Ie.forEach(function(t,e){r.Se(e)&&n(e)})},no.prototype.Ce=function(t){var e,n,r=t.targetId,i=t.ne.count,o=this.Ne(r);o&&(wi(e=o.target)?0===i?(n=new ri(e.path),this.ye(r,n,new iu(n,Jr.min()))):Or(1===i):this.Fe(r)!==i&&(this.De(r),this.Pe=this.Pe.add(r)))},no.prototype.ke=function(i){var o=this,s=new Map;this.Ie.forEach(function(t,e){var n,r=o.Ne(e);r&&(t.Yt&&wi(r.target)&&(n=new ri(r.target.path),null!==o.Ae.get(n)||o.$e(e,n)||o.ye(e,n,new iu(n,i))),t.ce&&(s.set(e,t.le()),t._e()))});var r=zi();this.Re.forEach(function(t,e){var n=!0;e.Dt(function(t){var e=o.Ne(t);return!e||2===e.X||(n=!1)}),n&&(r=r.add(t))});var t=new Ji(i,s,this.Pe,this.Ae,r);return this.Ae=Mi,this.Re=ho(),this.Pe=new Ui(Ur),t},no.prototype.Ve=function(t,e){var n;this.Se(t)&&(n=this.$e(t,e.key)?2:0,this.ve(t).fe(e.key,n),this.Ae=this.Ae.st(e.key,e),this.Re=this.Re.st(e.key,this.xe(e.key).add(t)))},no.prototype.ye=function(t,e,n){var r;this.Se(t)&&(r=this.ve(t),this.$e(t,e)?r.fe(e,1):r.de(e),this.Re=this.Re.st(e,this.xe(e).delete(t)),n&&(this.Ae=this.Ae.st(e,n)))},no.prototype.removeTarget=function(t){this.Ie.delete(t)},no.prototype.Fe=function(t){var e=this.ve(t).le();return this.me.Oe(t).size+e.Jt.size-e.Zt.size},no.prototype.we=function(t){this.ve(t).we()},no.prototype.ve=function(t){var e=this.Ie.get(t);return e||(e=new to,this.Ie.set(t,e)),e},no.prototype.xe=function(t){var e=this.Re.get(t);return e||(e=new Ui(Ur),this.Re=this.Re.st(t,e)),e},no.prototype.Se=function(t){var e=null!==this.Ne(t);return e||Dr("WatchChangeAggregator","Detected inactive target",t),e},no.prototype.Ne=function(t){var e=this.Ie.get(t);return e&&e.ae?null:this.me.Me(t)},no.prototype.De=function(e){var n=this;this.Ie.set(e,new to),this.me.Oe(e).forEach(function(t){n.ye(e,t,null)})},no.prototype.$e=function(t,e){return this.me.Oe(t).has(e)},no);function no(t){this.me=t,this.Ie=new Map,this.Ae=Mi,this.Re=ho(),this.Pe=new Ui(Ur)}function ro(){this.se=0,this.ie=co(),this.re=bi.J,this.oe=!1,this.he=!0}function io(t,e,n,r,i){this.resumeToken=t,this.Yt=e,this.Jt=n,this.Xt=r,this.Zt=i}function oo(t,e,n,r,i){this.Z=t,this.Wt=e,this.jt=n,this.Kt=r,this.Gt=i}function so(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Lt=n,this.docChanges=r,this.qt=i,this.fromCache=o,this.Bt=s,this.Ut=u}function uo(){this.Ot=new ki(ri.P)}function ao(n){this.P=n?function(t,e){return n(t,e)||ri.P(t.key,e.key)}:function(t,e){return ri.P(t.key,e.key)},this.kt=ji,this.$t=new ki(this.P)}function ho(){return new ki(ri.P)}function co(){return new ki(ri.P)}function fo(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function lo(t){var e=Eo(t.mapValue.fields.__local_write_time__.timestampValue);return new Zr(e.seconds,e.nanos)}var po=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function yo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?fo(t)?4:10:xr()}function vo(r,i){var t,e,n,o=yo(r);if(o!==yo(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return lo(r).isEqual(lo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Eo(r.timestampValue),n=Eo(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return n=i,To(r.bytesValue).isEqual(To(n.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,Io((t=r).geoPointValue.latitude)===Io(e.geoPointValue.latitude)&&Io(t.geoPointValue.longitude)===Io(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Io(t.integerValue)===Io(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Io(t.doubleValue),r=Io(e.doubleValue);return n===r?pi(n)===pi(r):isNaN(n)&&isNaN(r)}return!1}(r,i);case 9:return Vr(r.arrayValue.values||[],i.arrayValue.values||[],vo);case 10:return function(){var t=r.mapValue.fields||{},e=i.mapValue.fields||{};if(Gr(t)!==Gr(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!vo(t[n],e[n])))return!1;return!0}();default:return xr()}}function go(t,e){return void 0!==(t.values||[]).find(function(t){return vo(t,e)})}function mo(t,e){var n,r,i,o,s,u,a,h,c,f,l=yo(t),p=yo(e);if(l!==p)return Ur(l,p);switch(l){case 0:return 0;case 1:return Ur(t.booleanValue,e.booleanValue);case 2:return h=e,(c=Io(t.integerValue||t.doubleValue))<(f=Io(h.integerValue||h.doubleValue))?-1:f<c?1:c===f?0:isNaN(c)?isNaN(f)?0:-1:1;case 3:return wo(t.timestampValue,e.timestampValue);case 4:return wo(lo(t),lo(e));case 5:return Ur(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=To(o),a=To(s),u.o(a);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Ur(n[i],r[i]);if(0!==o)return o}return Ur(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=Ur(Io(n.latitude),Io(r.latitude)))?i:Ur(Io(n.longitude),Io(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=mo(n[i],r[i]);if(o)return o}return Ur(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Ur(r[s],o[s]);if(0!==u)return u;var a=mo(n[r[s]],i[o[s]]);if(0!==a)return a}return Ur(r.length,o.length)}(t.mapValue,e.mapValue);default:throw xr()}}function wo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Ur(t,e);var n=Eo(t),r=Eo(e),i=Ur(n.seconds,r.seconds);return 0!==i?i:Ur(n.nanos,r.nanos)}function bo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=Eo(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?To(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,ri.U(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):xr();var t,e,n}(t)}function Eo(t){if(Or(!!t),"string"!=typeof t)return{seconds:Io(t.seconds),nanos:Io(t.nanos)};var e,n=0,r=po.exec(t);Or(!!r),r[1]&&(e=((e=r[1])+"000000000").substr(0,9),n=Number(e));var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:n}}function Io(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function To(t){return"string"==typeof t?bi.fromBase64String(t):bi.fromUint8Array(t)}function No(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.F()}}function _o(t){return t&&"integerValue"in t}function Ao(t){return!!t&&"arrayValue"in t}function So(t){return t&&"nullValue"in t}function Do(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ko(t){return t&&"mapValue"in t}var Ro={asc:"ASCENDING",desc:"DESCENDING"},Lo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},xo=function(t,e){this.s=t,this.Le=e};function Oo(t){return{integerValue:""+t}}function Po(t,e){if(t.Le){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:pi(e)?"-0":e}}function Co(t,e){return di(e)?Oo(e):Po(t,e)}function Uo(t,e){return t.Le?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Vo(t,e){return t.Le?e.toBase64():e.toUint8Array()}function Mo(t){return Or(!!t),Jr.m((e=Eo(t),new Zr(e.seconds,e.nanos)));var e}function Fo(t,e){return new ti(["projects",t.projectId,"databases",t.database]).child("documents").child(e).F()}function qo(t){var e=ti.k(t);return Or(ns(e)),e}function jo(t,e){return Fo(t.s,e.path)}function Go(t,e){var n=qo(e);return Or(n.get(1)===t.s.projectId),Or(!n.get(3)&&!t.s.database||n.get(3)===t.s.database),new ri(Wo(n))}function Bo(t,e){return Fo(t.s,e)}function zo(t){var e=qo(t);return 4===e.length?ti.$():Wo(e)}function Ho(t){return new ti(["projects",t.s.projectId,"databases",t.s.database]).F()}function Wo(t){return Or(4<t.length&&"documents"===t.get(4)),t.V(5)}function Ko(t,e,n){return{name:jo(t,e),fields:n.proto.mapValue.fields}}function Yo(t,e){var n,r,i,o;if(e instanceof Ps)n={update:Ko(t,e.key,e.value)};else if(e instanceof Hs)n={delete:jo(t,e.key)};else if(e instanceof Cs)n={update:Ko(t,e.key,e.data),updateMask:(r=e.qe,i=[],r.fields.forEach(function(t){return i.push(t.F())}),{fieldPaths:i})};else if(e instanceof qs)n={transform:{document:jo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof us)return{fieldPath:t.field.F(),setToServerValue:"REQUEST_TIME"};if(e instanceof as)return{fieldPath:t.field.F(),appendMissingElements:{values:e.elements}};if(e instanceof ps)return{fieldPath:t.field.F(),removeAllFromArray:{values:e.elements}};if(e instanceof gs)return{fieldPath:t.field.F(),increment:e.Be};throw xr()})}};else{if(!(e instanceof Ws))return xr();n={verify:jo(t,e.key)}}return e.Qe.Ue||(n.currentDocument=void 0!==(o=e.Qe).updateTime?{updateTime:Uo(t,o.updateTime.A())}:void 0!==o.exists?{exists:o.exists}:xr()),n}function Xo(e,t){var n,r,i=t.currentDocument?void 0!==(n=t.currentDocument).updateTime?_s.updateTime(Mo(n.updateTime)):void 0!==n.exists?_s.exists(n.exists):_s.We():_s.We();if(t.update){t.update.name;var o=Go(e,t.update.name),s=new Ks({mapValue:{fields:t.update.fields}});if(t.updateMask){var u=(r=t.updateMask.fieldPaths||[],new Es(r.map(function(t){return ni.q(t)})));return new Cs(o,s,u,i)}return new Ps(o,s,i)}if(t.delete){var a=Go(e,t.delete);return new Hs(a,i)}if(t.transform){var h=Go(e,t.transform.document),c=t.transform.fieldTransforms.map(function(t){return function(t,e){var n,r,i=null;"setToServerValue"in e?(Or("REQUEST_TIME"===e.setToServerValue),i=new us):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],i=new as(n)):"removeAllFromArray"in e?(r=e.removeAllFromArray.values||[],i=new ps(r)):"increment"in e?i=new gs(t,e.increment):xr();var o=ni.q(e.fieldPath);return new Is(o,i)}(e,t)});return Or(!0===i.exists),new qs(h,c)}if(t.verify){var f=Go(e,t.verify);return new Ws(f,i)}return xr()}function Qo(t,e){return{documents:[Bo(t,e.path)]}}function Zo(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Bo(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Bo(t,r.p()),n.structuredQuery.from=[{collectionId:r.S()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){if("=="===t.op){if(Do(t.value))return{unaryFilter:{field:ts(t.field),op:"IS_NAN"}};if(So(t.value))return{unaryFilter:{field:ts(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Do(t.value))return{unaryFilter:{field:ts(t.field),op:"IS_NOT_NAN"}};if(So(t.value))return{unaryFilter:{field:ts(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ts(t.field),op:(e=t.op,Lo[e]),value:t.value}};var e});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:ts((e=t).field),direction:(n=e.dir,Ro[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,u=(s=e.limit,t.Le||li(s)?s:{value:s});return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=Jo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Jo(e.endAt)),n}function Jo(t){return{before:t.before,values:t.position}}function $o(t){var e=!!t.before,n=t.values||[];return new Wu(n,e)}function ts(t){return{fieldPath:t.F()}}function es(t){return ni.q(t.fieldPath)}function ns(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function rs(){this.je=void 0}function is(t,e){return t instanceof gs?_o(n=e)||n&&"doubleValue"in n?e:{integerValue:0}:null;var n}var os,ss,us=(n(cs,ss=rs),cs),as=(n(hs,os=rs),hs);function hs(t){var e=this;return(e=os.call(this)||this).elements=t,e}function cs(){return null!==ss&&ss.apply(this,arguments)||this}function fs(t,e){for(var n=bs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return vo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var ls,ps=(n(ds,ls=rs),ds);function ds(t){var e=this;return(e=ls.call(this)||this).elements=t,e}function ys(t,e){for(var n=bs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!vo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var vs,gs=(n(ms,vs=rs),ms);function ms(t,e){var n=this;return(n=vs.call(this)||this).serializer=t,n.Be=e,n}function ws(t){return Io(t.integerValue||t.doubleValue)}function bs(t){return Ao(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Es=(Ts.prototype.Ke=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].D(t))return!0;return!1},Ts.prototype.isEqual=function(t){return Vr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Ts),Is=function(t,e){this.field=t,this.transform=e};function Ts(t){(this.fields=t).sort(ni.P)}function Ns(t,e){this.version=t,this.transformResults=e}var _s=(As.We=function(){return new As},As.exists=function(t){return new As(void 0,t)},As.updateTime=function(t){return new As(t)},Object.defineProperty(As.prototype,"Ue",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),As.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},As);function As(t,e){this.updateTime=t,this.exists=e}function Ss(t,e){return void 0!==t.updateTime?e instanceof ru&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof ru}function Ds(){}function ks(t,e,n,r){return t instanceof Ps?function(t,e){if(!Ss(t.Qe,e))return e;var n=Ls(e);return new ru(t.key,n,t.value,{Ge:!0})}(t,e):t instanceof Cs?function(t,e){if(!Ss(t.Qe,e))return e;var n=Ls(e),r=Ms(t,e);return new ru(t.key,n,r,{Ge:!0})}(t,e):t instanceof qs?function(t,e,n,r){if(!Ss(t.Qe,e))return e;var i=e,o=function(t,e,n,r){for(var i,o,s,u,a,h,c=[],f=0,l=t;f<l.length;f++){var p=l[f],d=p.transform,y=null;n instanceof ru&&(y=n.field(p.field)),null===y&&r instanceof ru&&(y=r.field(p.field)),c.push((o=y,h=a=u=s=void 0,(i=d)instanceof us?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},o&&(h.fields.__previous_value__=o),{mapValue:h}):i instanceof as?fs(i,o):i instanceof ps?ys(i,o):(a=ws(u=is(s=i,o))+ws(s.Be),_o(u)&&_o(s.Be)?Oo(a):Po(s.serializer,a))))}return c}(t.fieldTransforms,n,e,r),s=Gs(t,i.data(),o);return new ru(t.key,i.version,s,{Ge:!0})}(t,e,r,n):(o=e,Ss((i=t).Qe,o)?new iu(i.key,Jr.min()):o);var i,o}function Rs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Qe.isEqual(e.Qe)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.qe.isEqual(e.qe):2!==t.type||Vr(t.fieldTransforms,t.fieldTransforms,function(t,e){return r=e,(n=t).field.isEqual(r.field)&&(i=n.transform,o=r.transform,i instanceof as&&o instanceof as||i instanceof ps&&o instanceof ps?Vr(i.elements,o.elements,vo):i instanceof gs&&o instanceof gs?vo(i.Be,o.Be):i instanceof us&&o instanceof us);var n,r,i,o}))}function Ls(t){return t instanceof ru?t.version:Jr.min()}var xs,Os,Ps=(n(Vs,Os=Ds),Vs),Cs=(n(Us,xs=Ds),Us);function Us(t,e,n,r){var i=this;return(i=xs.call(this)||this).key=t,i.data=e,i.qe=n,i.Qe=r,i.type=1,i}function Vs(t,e,n){var r=this;return(r=Os.call(this)||this).key=t,r.value=e,r.Qe=n,r.type=0,r}function Ms(t,e){return n=t,r=e instanceof ru?e.data():Ks.empty(),i=new Ys(r),n.qe.fields.forEach(function(t){var e;t._()||(null!==(e=n.data.field(t))?i.set(t,e):i.delete(t))}),i.ze();var n,r,i}var Fs,qs=(n(js,Fs=Ds),js);function js(t,e){var n=this;return(n=Fs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Qe=_s.exists(!0),n}function Gs(t,e,n){for(var r=new Ys(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.ze()}var Bs,zs,Hs=(n(Js,zs=Ds),Js),Ws=(n(Zs,Bs=Ds),Zs),Ks=(Qs.empty=function(){return new Qs({mapValue:{}})},Qs.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!ko(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},Qs.prototype.isEqual=function(t){return vo(this.proto,t.proto)},Qs),Ys=(Xs.prototype.set=function(t,e){return this.Je(t,e),this},Xs.prototype.delete=function(t){return this.Je(t,null),this},Xs.prototype.Je=function(t,e){for(var n=this.Ye,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===yo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.S(),e)},Xs.prototype.ze=function(){var t=this.Xe(ni.$(),this.Ye);return null!=t?new Ks(t):this.He},Xs.prototype.Xe=function(r,t){var i=this,o=!1,e=this.He.field(r),s=ko(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.Xe(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Xs);function Xs(t){void 0===t&&(t=Ks.empty()),this.He=t,this.Ye=new Map}function Qs(t){this.proto=t}function Zs(t,e){var n=this;return(n=Bs.call(this)||this).key=t,n.Qe=e,n.type=4,n}function Js(t,e){var n=this;return(n=zs.call(this)||this).key=t,n.Qe=e,n.type=3,n}function $s(t,e){this.key=t,this.version=e}var tu,eu,nu,ru=(n(au,nu=$s),au.prototype.field=function(t){return this.Ze.field(t)},au.prototype.data=function(){return this.Ze},au.prototype.tn=function(){return this.Ze.proto},au.prototype.isEqual=function(t){return t instanceof au&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ge===t.Ge&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Ze.isEqual(t.Ze)},au.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Ze.toString()+", {hasLocalMutations: "+this.Ge+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(au.prototype,"hasPendingWrites",{get:function(){return this.Ge||this.hasCommittedMutations},enumerable:!1,configurable:!0}),au),iu=(n(uu,eu=$s),uu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(uu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),uu.prototype.isEqual=function(t){return t instanceof uu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},uu),ou=(n(su,tu=$s),su.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(su.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),su.prototype.isEqual=function(t){return t instanceof su&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},su);function su(){return null!==tu&&tu.apply(this,arguments)||this}function uu(t,e,n){var r=this;return(r=eu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function au(t,e,n,r){var i=this;return(i=nu.call(this,t,e)||this).Ze=n,i.Ge=!!r.Ge,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function hu(t,e){if(!(t instanceof e))throw e.name===t.constructor.name?new Qr(Xr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass '"+e.name+"' from a different Firestore SDK?"):new Qr(Xr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but was '"+t.constructor.name+"'");return t}var cu=(fu.prototype.on=function(t){return new fu(t,null,this.en.slice(),this.filters.slice(),this.limit,this.nn,this.startAt,this.endAt)},fu.prototype.hn=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.en.length||1===this.en.length&&this.en[0].field.M())},fu.prototype.an=function(){return!li(this.limit)&&"F"===this.nn},fu.prototype.cn=function(){return!li(this.limit)&&"L"===this.nn},fu.prototype.un=function(){return 0<this.en.length?this.en[0].field:null},fu.prototype.ln=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n._n())return n.field}return null},fu.prototype.fn=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(0<=t.indexOf(r.op))return r.op}return null},fu);function fu(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.en=n,this.filters=r,this.limit=i,this.nn=o,this.startAt=s,this.endAt=u,this.sn=null,this.rn=null,this.startAt,this.endAt}function lu(t,e,n,r,i,o,s,u){return new cu(t,e,n,r,i,o,s,u)}function pu(t){return new cu(t)}function du(t){return null!==t.collectionGroup}function yu(t){var e=hu(t,cu);if(null===e.sn){e.sn=[];var n=e.ln(),r=e.un();if(null!==n&&null===r)n.M()||e.sn.push(new ta(n)),e.sn.push(new ta(ni.L(),"asc"));else{for(var i,o=!1,s=0,u=e.en;s<u.length;s++){var a=u[s];e.sn.push(a),a.field.M()&&(o=!0)}o||(i=0<e.en.length?e.en[e.en.length-1].dir:"asc",e.sn.push(new ta(ni.L(),i)))}}return e.sn}function vu(t){var e=hu(t,cu);if(!e.rn)if("F"===e.nn)e.rn=vi(e.path,e.collectionGroup,yu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=yu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new ta(o.field,s))}var u=e.endAt?new Wu(e.endAt.position,!e.endAt.before):null,a=e.startAt?new Wu(e.startAt.position,!e.startAt.before):null;e.rn=vi(e.path,e.collectionGroup,n,e.filters,e.limit,u,a)}return e.rn}function gu(t,e,n){return new cu(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function mu(t,e){return new cu(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),t.limit,t.nn,e,t.endAt)}function wu(t,e){return new cu(t.path,t.collectionGroup,t.en.slice(),t.filters.slice(),t.limit,t.nn,t.startAt,e)}function bu(t,e){return mi(vu(t),vu(e))&&t.nn===e.nn}function Eu(t){return gi(vu(t))+"|lt:"+t.nn}function Iu(t){return"Query(target="+(n=(e=vu(t)).path.F(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(e=t).field.F()+" "+e.op+" "+bo(e.value);var e}).join(", ")+"]"),li(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(e=t).field.F()+" ("+e.dir+")";var e}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Zu(e.startAt)),e.endAt&&(n+=", endAt: "+Zu(e.endAt)),"Target("+n+")")+"; limitType="+t.nn+")";var e,n}function Tu(i,t){return r=i,o=t.key.path,(null!==r.collectionGroup?t.key.W(r.collectionGroup)&&r.path.D(o):ri.j(r.path)?r.path.isEqual(o):r.path.C(o))&&function(t){for(var e=0,n=i.en;e<n.length;e++){var r=n[e];if(!r.field.M()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(e=i).startAt||Ju(e.startAt,yu(e),n))&&(!e.endAt||!Ju(e.endAt,yu(e),n)));var e,n,r,o}function Nu(u){return function(t,e){for(var n=!1,r=0,i=yu(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i,o,s,u=t.field.M()?ri.P(e.key,n.key):(r=t.field,i=n,o=e.field(r),s=i.field(r),null!==o&&null!==s?mo(o,s):xr());switch(t.dir){case"asc":return u;case"desc":return-1*u;default:return xr()}}(o,t,e);if(0!==s)return s;n=n||o.field.M()}return 0}}var _u,Au=(n(Su,_u=function(){}),Su.create=function(t,e,n){if(t.M())return"in"===e||"not-in"===e?this.dn(t,e,n):new Lu(t,e,n);if(So(n)){if("=="!==e&&"!="!==e)throw new Qr(Xr.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new Su(t,e,n)}if(Do(n)){if("=="!==e&&"!="!==e)throw new Qr(Xr.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new Su(t,e,n)}return"array-contains"===e?new Gu(t,n):"in"===e?new Bu(t,n):"not-in"===e?new zu(t,n):"array-contains-any"===e?new Hu(t,n):new Su(t,e,n)},Su.dn=function(t,e,n){return new("in"===e?xu:Ou)(t,n)},Su.prototype.matches=function(t){var e=t.field(this.field);return"!="===this.op?null!==e&&this.wn(mo(e,this.value)):null!==e&&yo(this.value)===yo(e)&&this.wn(mo(e,this.value))},Su.prototype.wn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return xr()}},Su.prototype._n=function(){return 0<=["<","<=",">",">=","!="].indexOf(this.op)},Su);function Su(t,e,n){var r=this;return(r=_u.call(this)||this).field=t,r.op=e,r.value=n,r}var Du,ku,Ru,Lu=(n(Uu,Ru=Au),Uu.prototype.matches=function(t){var e=ri.P(t.key,this.key);return this.wn(e)},Uu),xu=(n(Cu,ku=Au),Cu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Cu),Ou=(n(Pu,Du=Au),Pu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Pu);function Pu(t,e){var n=this;return(n=Du.call(this,t,"not-in",e)||this).keys=Vu(0,e),n}function Cu(t,e){var n=this;return(n=ku.call(this,t,"in",e)||this).keys=Vu(0,e),n}function Uu(t,e,n){var r=this;return(r=Ru.call(this,t,e,n)||this).key=ri.U(n.referenceValue),r}function Vu(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map(function(t){return ri.U(t.referenceValue)})}var Mu,Fu,qu,ju,Gu=(n(Qu,ju=Au),Qu.prototype.matches=function(t){var e=t.field(this.field);return Ao(e)&&go(e.arrayValue,this.value)},Qu),Bu=(n(Xu,qu=Au),Xu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&go(this.value.arrayValue,e)},Xu),zu=(n(Yu,Fu=Au),Yu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&!go(this.value.arrayValue,e)},Yu),Hu=(n(Ku,Mu=Au),Ku.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!Ao(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return go(e.value.arrayValue,t)})},Ku),Wu=function(t,e){this.position=t,this.before=e};function Ku(t,e){return Mu.call(this,t,"array-contains-any",e)||this}function Yu(t,e){return Fu.call(this,t,"not-in",e)||this}function Xu(t,e){return qu.call(this,t,"in",e)||this}function Qu(t,e){return ju.call(this,t,"array-contains",e)||this}function Zu(t){return(t.before?"b":"a")+":"+t.position.map(bo).join(",")}function Ju(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.M()?ri.P(ri.U(s.referenceValue),n.key):mo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function $u(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!vo(t.position[n],e.position[n]))return!1;return!0}var ta=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e},ea=(ga.prototype.En=function(t,e,n){for(var r,i,o,s=n.mn,u=0;u<this.mutations.length;u++){var a=this.mutations[u];a.key.isEqual(t)&&(r=a,i=e,o=s[u],e=r instanceof Ps?new ru(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof Cs?function(t,e,n){if(!Ss(t.Qe,e))return new ou(t.key,n.version);var r=Ms(t,e);return new ru(t.key,n.version,r,{hasCommittedMutations:!0})}(r,i,o):r instanceof qs?function(t,e,n){if(Or(null!=n.transformResults),!Ss(t.Qe,e))return new ou(t.key,n.version);var r=e,i=function(t,e,n){var r=[];Or(t.length===n.length);for(var i,o,s,u=0;u<n.length;u++){var a=t[u],h=a.transform,c=null;e instanceof ru&&(c=e.field(a.field)),r.push((i=h,o=c,s=n[u],i instanceof as?fs(i,o):i instanceof ps?ys(i,o):s))}return r}(t.fieldTransforms,e,n.transformResults),o=n.version,s=Gs(t,r.data(),i);return new ru(t.key,o,s,{hasCommittedMutations:!0})}(r,i,o):new iu(r.key,o.version,{hasCommittedMutations:!0}))}return e},ga.prototype.In=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=ks(i,e,e,this.Tn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=ks(a,e,o,this.Tn))}return e},ga.prototype.An=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.In(t.key,n.get(t.key));e&&(i=i.st(t.key,e))}),i},ga.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},zi())},ga.prototype.isEqual=function(t){return this.batchId===t.batchId&&Vr(this.mutations,t.mutations,Rs)&&Vr(this.baseMutations,t.baseMutations,Rs)},ga),na=(va.from=function(t,e,n){Or(t.mutations.length===n.length);for(var r=Gi,i=t.mutations,o=0;o<i.length;o++)r=r.st(i[o].key,n[o].version);return new va(t,e,n,r)},va),ra=(ya.prototype.catch=function(t){return this.next(void 0,t)},ya.prototype.next=function(r,i){var o=this;return this.pn&&xr(),this.pn=!0,this.yn?this.error?this.bn(i,this.error):this.vn(r,this.result):new ya(function(e,n){o.gn=function(t){o.vn(r,t).next(e,n)},o.Vn=function(t){o.bn(i,t).next(e,n)}})},ya.prototype.Sn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ya.prototype.Dn=function(t){try{var e=t();return e instanceof ya?e:ya.resolve(e)}catch(t){return ya.reject(t)}},ya.prototype.vn=function(t,e){return t?this.Dn(function(){return t(e)}):ya.resolve(e)},ya.prototype.bn=function(t,e){return t?this.Dn(function(){return t(e)}):ya.reject(e)},ya.resolve=function(n){return new ya(function(t,e){t(n)})},ya.reject=function(n){return new ya(function(t,e){e(n)})},ya.Cn=function(t){return new ya(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ya.Nn=function(t){for(var n=ya.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?ya.resolve(t):e()})}(r[e]);return n},ya.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Cn(i)},ya),ia=(Object.defineProperty(da.prototype,"readTime",{get:function(){return this.$n},set:function(t){this.$n=t},enumerable:!1,configurable:!0}),da.prototype.xn=function(t,e){this.On(),this.readTime=e,this.Fn.set(t.key,t)},da.prototype.Mn=function(t,e){this.On(),e&&(this.readTime=e),this.Fn.set(t,null)},da.prototype.Ln=function(t,e){this.On();var n=this.Fn.get(e);return void 0!==n?ra.resolve(n):this.qn(t,e)},da.prototype.getEntries=function(t,e){return this.Bn(t,e)},da.prototype.apply=function(t){return this.On(),this.kn=!0,this.Un(t)},da.prototype.On=function(){},da),oa="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",sa=(pa.prototype.Wn=function(t){this.Qn.push(t)},pa.prototype.jn=function(){this.Qn.forEach(function(t){return t()})},pa),ua=(la.prototype.Hn=function(e,n){var r=this;return this.Gn.Yn(e,n).next(function(t){return r.Jn(e,n,t)})},la.prototype.Jn=function(t,r,i){return this.Kn.Ln(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].In(r,t);return t})},la.prototype.Xn=function(t,e,i){var o=Mi;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].In(t,e);o=o.st(t,e)}),o},la.prototype.Zn=function(e,t){var n=this;return this.Kn.getEntries(e,t).next(function(t){return n.ts(e,t)})},la.prototype.ts=function(r,i){var o=this;return this.Gn.es(r,i).next(function(t){var e=o.Xn(r,i,t),n=Mi;return e.forEach(function(t,e){e=e||new iu(t,Jr.min()),n=n.st(t,e)}),n})},la.prototype.ns=function(t,e,n){return r=e,ri.j(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.ss(t,e.path):du(e)?this.rs(t,e,n):this.os(t,e,n);var r},la.prototype.ss=function(t,e){return this.Hn(t,new ri(e)).next(function(t){var e=ji;return t instanceof ru&&(e=e.st(t.key,t)),e})},la.prototype.rs=function(n,r,i){var o=this,s=r.collectionGroup,u=ji;return this.zn.hs(n,s).next(function(t){return ra.forEach(t,function(t){var e=r.on(t.child(s));return o.os(n,e,i).next(function(t){t.forEach(function(t,e){u=u.st(t,e)})})}).next(function(){return u})})},la.prototype.os=function(e,n,t){var c,f,r=this;return this.Kn.ns(e,n,t).next(function(t){return c=t,r.Gn.as(e,n)}).next(function(t){return f=t,r.cs(e,f,c).next(function(t){c=t;for(var e=0,n=f;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),h=ks(s,a,a,r.Tn);c=h instanceof ru?c.st(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){Tu(n,e)||(c=c.remove(t))}),c})},la.prototype.cs=function(t,e,n){for(var r=zi(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Cs&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.Kn.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof ru&&(h=h.st(t,e))}),h})},la),aa=(fa._s=function(t,e){for(var n=zi(),r=zi(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new fa(t,e.fromCache,n,r)},fa),ha=(ca.prototype.ds=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},ca.prototype.next=function(){var t=++this.previousValue;return this.ws&&this.ws(t),t},ca);function ca(t,e){var n=this;this.previousValue=t,e&&(e.fs=function(t){return n.ds(t)},this.ws=function(t){return e.Ts(t)})}function fa(t,e,n,r){this.targetId=t,this.fromCache=e,this.us=n,this.ls=r}function la(t,e,n){this.Kn=t,this.Gn=e,this.zn=n}function pa(){this.Qn=[]}function da(){this.Fn=new Yr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.kn=!1}function ya(t){var e=this;this.gn=null,this.Vn=null,this.result=void 0,this.error=void 0,this.yn=!1,this.pn=!1,t(function(t){e.yn=!0,e.result=t,e.gn&&e.gn(t)},function(t){e.yn=!0,e.error=t,e.Vn&&e.Vn(t)})}function va(t,e,n,r){this.batch=t,this.Rn=e,this.mn=n,this.Pn=r}function ga(t,e,n,r){this.batchId=t,this.Tn=e,this.baseMutations=n,this.mutations=r}function ma(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}ha.Es=-1;var wa,ba=(Sa.prototype.reset=function(){this.gs=0},Sa.prototype.ps=function(){this.gs=this.Ps},Sa.prototype.bs=function(t){var e=this;this.cancel();var n=Math.floor(this.gs+this.vs()),r=Math.max(0,Date.now()-this.ys),i=Math.max(0,n-r);0<i&&Dr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.gs+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Vs=this.ms.Ss(this.Is,i,function(){return e.ys=Date.now(),t()}),this.gs*=this.Rs,this.gs<this.As&&(this.gs=this.As),this.gs>this.Ps&&(this.gs=this.Ps)},Sa.prototype.Ds=function(){null!==this.Vs&&(this.Vs.Cs(),this.Vs=null)},Sa.prototype.cancel=function(){null!==this.Vs&&(this.Vs.cancel(),this.Vs=null)},Sa.prototype.vs=function(){return(Math.random()-.5)*this.gs},Sa),Ea=(Aa.delete=function(t){return Dr("SimpleDb","Removing database:",t),Oa(window.indexedDB.deleteDatabase(t)).Sn()},Aa.ks=function(){if("undefined"==typeof indexedDB)return!1;if(Aa.$s())return!0;var t=p(),e=Aa.Fs(t),n=0<e&&e<10,r=Aa.xs(t),i=0<r&&r<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||i)},Aa.$s=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Os)},Aa.Ms=function(t,e){return t.store(e)},Aa.Fs=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},Aa.xs=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},Aa.prototype.Ls=function(){return g(this,void 0,void 0,function(){var e,o=this;return w(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Dr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(n,r){var i=indexedDB.open(o.name,o.version);i.onsuccess=function(t){var e=t.target.result;n(e)},i.onblocked=function(){r(new Ta("Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(t){var e=t.target.error;"VersionError"===e.name?r(new Qr(Xr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new Ta(e))},i.onupgradeneeded=function(t){Dr("SimpleDb",'Database "'+o.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;o.Ns.createOrUpgrade(e,i.transaction,t.oldVersion,o.version).next(function(){Dr("SimpleDb","Database upgrade to version "+o.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.qs&&(this.db.onversionchange=function(t){return o.qs(t)}),this.db)]}})})},Aa.prototype.Bs=function(e){this.qs=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},Aa.prototype.runTransaction=function(r,h,c){return g(this,void 0,void 0,function(){var s,u,e,a,n;return w(this,function(t){switch(t.label){case 0:s="readonly"===r,u=0,e=function(){var e,n,r,i,o;return w(this,function(t){switch(t.label){case 0:++u,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,a.Ls()];case 2:return a.db=t.sent(),e=ka.open(a.db,s?"readonly":"readwrite",h),n=c(e).catch(function(t){return e.abort(t),ra.reject(t)}).Sn(),r={},n.catch(function(){}),[4,e.Us];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return i=t.sent(),o="FirebaseError"!==i.name&&u<3,Dr("SimpleDb","Transaction failed with error: %s. Retrying: %s.",i.message,o),a.close(),o?[3,5]:[2,{value:Promise.reject(i)}];case 5:return[2]}})},a=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(n=t.sent()))return[2,n.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},Aa.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},Aa),Ia=(Object.defineProperty(_a.prototype,"yn",{get:function(){return this.Ws},enumerable:!1,configurable:!0}),Object.defineProperty(_a.prototype,"Ks",{get:function(){return this.js},enumerable:!1,configurable:!0}),Object.defineProperty(_a.prototype,"cursor",{set:function(t){this.Qs=t},enumerable:!1,configurable:!0}),_a.prototype.done=function(){this.Ws=!0},_a.prototype.Gs=function(t){this.js=t},_a.prototype.delete=function(){return Oa(this.Qs.delete())},_a),Ta=(n(Na,wa=Qr),Na);function Na(t){var e=this;return(e=wa.call(this,Xr.UNAVAILABLE,"IndexedDB transaction failed: "+t)||this).name="IndexedDbTransactionError",e}function _a(t){this.Qs=t,this.Ws=!1,this.js=null}function Aa(t,e,n){this.name=t,this.version=e,this.Ns=n,12.2===Aa.Fs(p())&&kr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function Sa(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.ms=t,this.Is=e,this.As=n,this.Rs=r,this.Ps=i,this.gs=0,this.Vs=null,this.ys=Date.now(),this.reset()}function Da(t){return"IndexedDbTransactionError"===t.name}var ka=(xa.open=function(t,e,n){try{return new xa(t.transaction(n,e))}catch(t){throw new Ta(t)}},Object.defineProperty(xa.prototype,"Us",{get:function(){return this.zs.promise},enumerable:!1,configurable:!0}),xa.prototype.abort=function(t){t&&this.zs.reject(t),this.aborted||(Dr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},xa.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Ra(e)},xa),Ra=(La.prototype.put=function(t,e){return Oa(void 0!==e?(Dr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Dr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},La.prototype.add=function(t){return Dr("SimpleDb","ADD",this.store.name,t,t),Oa(this.store.add(t))},La.prototype.get=function(e){var n=this;return Oa(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Dr("SimpleDb","GET",n.store.name,e,t),t})},La.prototype.delete=function(t){return Dr("SimpleDb","DELETE",this.store.name,t),Oa(this.store.delete(t))},La.prototype.count=function(){return Dr("SimpleDb","COUNT",this.store.name),Oa(this.store.count())},La.prototype.Hs=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.Ys(n,function(t,e){r.push(e)}).next(function(){return r})},La.prototype.Js=function(t,e){Dr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.Xs=!1;var r=this.cursor(n);return this.Ys(r,function(t,e,n){return n.delete()})},La.prototype.Zs=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.Ys(r,e)},La.prototype.ti=function(i){var t=this.cursor({});return new ra(function(n,r){t.onerror=function(t){var e=Ca(t.target.error);r(e)},t.onsuccess=function(t){var e=t.target.result;e?i(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},La.prototype.Ys=function(t,s){var u=[];return new ra(function(o,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n,r,i=t.target.result;i?(e=new Ia(i),(n=s(i.primaryKey,i.value,e))instanceof ra&&(r=n.catch(function(t){return e.done(),ra.reject(t)}),u.push(r)),e.yn?o():null===e.Ks?i.continue():i.continue(e.Ks)):o()}}).next(function(){return ra.Cn(u)})},La.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},La.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Xs?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},La);function La(t){this.store=t}function xa(t){var n=this;this.transaction=t,this.aborted=!1,this.zs=new ma,this.transaction.oncomplete=function(){n.zs.resolve()},this.transaction.onabort=function(){t.error?n.zs.reject(new Ta(t.error)):n.zs.resolve()},this.transaction.onerror=function(t){var e=Ca(t.target.error);n.zs.reject(new Ta(e))}}function Oa(t){return new ra(function(n,r){t.onsuccess=function(t){var e=t.target.result;n(e)},t.onerror=function(t){var e=Ca(t.target.error);r(e)}})}var Pa=!1;function Ca(t){var e=Ea.Fs(p());if(12.2<=e&&e<13){var n="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(n)){var r=new Qr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Pa||(Pa=!0,setTimeout(function(){throw r},0)),r}}return t}function Ua(){return"undefined"!=typeof window?window:null}function Va(){return"undefined"!=typeof document?document:null}var Ma=(ja.ri=function(t,e,n,r,i){var o=new ja(t,e,Date.now()+n,r,i);return o.start(n),o},ja.prototype.start=function(t){var e=this;this.oi=setTimeout(function(){return e.hi()},t)},ja.prototype.Cs=function(){return this.hi()},ja.prototype.cancel=function(t){null!==this.oi&&(this.clearTimeout(),this.ii.reject(new Qr(Xr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},ja.prototype.hi=function(){var e=this;this.ei.ai(function(){return null!==e.oi?(e.clearTimeout(),e.op().then(function(t){return e.ii.resolve(t)})):Promise.resolve()})},ja.prototype.clearTimeout=function(){null!==this.oi&&(this.si(this),clearTimeout(this.oi),this.oi=null)},ja),Fa=(Object.defineProperty(qa.prototype,"mi",{get:function(){return this.li},enumerable:!1,configurable:!0}),qa.prototype.ai=function(t){this.enqueue(t)},qa.prototype.Ii=function(t){this.Ai(),this.Ri(t)},qa.prototype.Pi=function(){var t;this.li||(this.li=!0,(t=Va())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Ei))},qa.prototype.enqueue=function(t){return this.Ai(),this.li?new Promise(function(t){}):this.Ri(t)},qa.prototype.gi=function(t){var e=this;this.ui.push(t),this.ai(function(){return e.Vi()})},qa.prototype.Vi=function(){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(0===this.ui.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.ui[0]()];case 2:return t.sent(),this.ui.shift(),this.Ti.reset(),[3,4];case 3:if(!Da(e=t.sent()))throw e;return Dr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.ui.length&&this.Ti.bs(function(){return n.Vi()}),t.label=5;case 5:return[2]}})})},qa.prototype.Ri=function(t){var r=this,e=this.ci.then(function(){return r.di=!0,t().catch(function(t){throw r.fi=t,r.di=!1,kr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.di=!1,t})});return this.ci=e},qa.prototype.Ss=function(t,e,n){var r=this;this.Ai(),-1<this.wi.indexOf(t)&&(e=0);var i=Ma.ri(this,t,e,n,function(t){return r.yi(t)});return this._i.push(i),i},qa.prototype.Ai=function(){this.fi&&xr()},qa.prototype.pi=function(){},qa.prototype.bi=function(){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return[4,e=this.ci];case 1:t.sent(),t.label=2;case 2:if(e!==this.ci)return[3,0];t.label=3;case 3:return[2]}})})},qa.prototype.vi=function(t){for(var e=0,n=this._i;e<n.length;e++)if(n[e].Is===t)return!0;return!1},qa.prototype.Si=function(r){var i=this;return this.bi().then(function(){i._i.sort(function(t,e){return t.ni-e.ni});for(var t=0,e=i._i;t<e.length;t++){var n=e[t];if(n.Cs(),"all"!==r&&n.Is===r)break}return i.bi()})},qa.prototype.Di=function(t){this.wi.push(t)},qa.prototype.yi=function(t){var e=this._i.indexOf(t);this._i.splice(e,1)},qa);function qa(){var e=this;this.ci=Promise.resolve(),this.ui=[],this.li=!1,this._i=[],this.fi=null,this.di=!1,this.wi=[],this.Ti=new ba(this,"async_queue_retry"),this.Ei=function(){var t=Va();t&&Dr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.Ti.Ds()};var t=Va();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Ei)}function ja(t,e,n,r,i){this.ei=t,this.Is=e,this.ni=n,this.op=r,this.si=i,this.ii=new ma,this.then=this.ii.promise.then.bind(this.ii.promise),this.ii.promise.catch(function(t){})}function Ga(t,e){if(kr("AsyncQueue",e+": "+t),Da(t))return new Qr(Xr.UNAVAILABLE,e+": "+t);throw t}function Ba(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Ur(n,i);return 0===s?Ur(r,o):s}var za=(Ya.prototype.Fi=function(){return++this.Ni},Ya.prototype.ki=function(t){var e,n=[t,this.Fi()];this.buffer.size<this.Ci?this.buffer=this.buffer.add(n):Ba(n,e=this.buffer.last())<0&&(this.buffer=this.buffer.delete(e).add(n))},Object.defineProperty(Ya.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),Ya),Ha={$i:!1,xi:0,Oi:0,Mi:0},Wa=(Ka.Ui=function(t){return new Ka(t,Ka.Qi,Ka.Wi)},Ka);function Ka(t,e,n){this.Li=t,this.qi=e,this.Bi=n}function Ya(t){this.Ci=t,this.buffer=new Ui(Ba),this.Ni=0}Wa.ji=-1,Wa.Ki=1048576,Wa.Gi=41943040,Wa.Qi=10,Wa.Wi=1e3,Wa.zi=new Wa(Wa.Gi,Wa.Qi,Wa.Wi),Wa.Hi=new Wa(Wa.ji,0,0);var Xa=(Ja.prototype.start=function(t){this.Yi.params.Li!==Wa.ji&&this.Zi(t)},Ja.prototype.stop=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},Object.defineProperty(Ja.prototype,"tr",{get:function(){return null!==this.Xi},enumerable:!1,configurable:!0}),Ja.prototype.Zi=function(n){var t=this,e=this.Ji?3e5:6e4;Dr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.Xi=this.ei.Ss("lru_garbage_collection",e,function(){return g(t,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:this.Xi=null,this.Ji=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.er(this.Yi)];case 2:return t.sent(),[3,7];case 3:return Da(e=t.sent())?(Dr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,_c(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.Zi(n)];case 8:return t.sent(),[2]}})})})},Ja),Qa=(Za.prototype.sr=function(t,e){return this.nr.ir(t).next(function(t){return Math.floor(e/100*t)})},Za.prototype.rr=function(t,e){var n=this;if(0===e)return ra.resolve(ha.Es);var r=new za(e);return this.nr.be(t,function(t){return r.ki(t.sequenceNumber)}).next(function(){return n.nr.or(t,function(t){return r.ki(t)})}).next(function(){return r.maxValue})},Za.prototype.hr=function(t,e,n){return this.nr.hr(t,e,n)},Za.prototype.ar=function(t,e){return this.nr.ar(t,e)},Za.prototype.cr=function(e,n){var r=this;return this.params.Li===Wa.ji?(Dr("LruGarbageCollector","Garbage collection skipped; disabled"),ra.resolve(Ha)):this.ur(e).next(function(t){return t<r.params.Li?(Dr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.Li),Ha):r.lr(e,n)})},Za.prototype.ur=function(t){return this.nr.ur(t)},Za.prototype.lr=function(e,n){var r,i,o,s,u,a,h,c=this,f=Date.now();return this.sr(e,this.params.qi).next(function(t){return i=t>c.params.Bi?(Dr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.Bi+" from "+t),c.params.Bi):t,s=Date.now(),c.rr(e,i)}).next(function(t){return r=t,u=Date.now(),c.hr(e,r,n)}).next(function(t){return o=t,a=Date.now(),c.ar(e,r)}).next(function(t){return h=Date.now(),Sr()<=l.DEBUG&&Dr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(h-a)+"ms\nTotal Duration: "+(h-f)+"ms"),ra.resolve({$i:!0,xi:i,Oi:o,Mi:t})})},Za);function Za(t,e){this.nr=t,this.params=e}function Ja(t,e){this.Yi=t,this.ei=e,this.Ji=!1,this.Xi=null}function $a(t){for(var o="",e=0;e<t.length;e++)0<o.length&&(o=th(o)),o=function(t){for(var e=o,n=t.length,r=0;r<n;r++){var i=t.charAt(r);switch(i){case"\0":e+="";break;case"":e+="";break;default:e+=i}}return e}(t.get(e));return th(o)}function th(t){return t+""}function eh(t){var e=t.length;if(Or(2<=e),2===e)return Or(""===t.charAt(0)&&""===t.charAt(1)),ti.$();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&xr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:xr()}o=s+2}return new ti(r)}var nh=function(t){this._r=t};function rh(t,e){if(e.document)return n=t._r,r=e.document,i=!!e.hasCommittedMutations,o=Go(n,r.name),s=Mo(r.updateTime),u=new Ks({mapValue:{fields:r.fields}}),new ru(o,s,u,{hasCommittedMutations:!!i});var n,r,i,o,s,u;if(e.noDocument){var a=ri.K(e.noDocument.path),h=ah(e.noDocument.readTime);return new iu(a,h,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var c=ri.K(e.unknownDocument.path),f=ah(e.unknownDocument.version);return new ou(c,f)}return xr()}function ih(t,e,n){var r,i,o=oh(n),s=e.key.path.p().N();if(e instanceof ru){var u={name:jo(r=t._r,(i=e).key),fields:i.tn().mapValue.fields,updateTime:Uo(r,i.version.A())},a=e.hasCommittedMutations;return new jh(null,null,u,a,o,s)}if(e instanceof iu){var h=e.key.path.N(),c=uh(e.version),f=e.hasCommittedMutations;return new jh(null,new Fh(h,c),null,f,o,s)}if(e instanceof ou){var l=e.key.path.N(),p=uh(e.version);return new jh(new qh(l,p),null,null,!0,o,s)}return xr()}function oh(t){var e=t.A();return[e.seconds,e.nanoseconds]}function sh(t){var e=new Zr(t[0],t[1]);return Jr.m(e)}function uh(t){var e=t.A();return new Rh(e.seconds,e.nanoseconds)}function ah(t){var e=new Zr(t.seconds,t.nanoseconds);return Jr.m(e)}function hh(e,t){var n=(t.baseMutations||[]).map(function(t){return Xo(e._r,t)}),r=t.mutations.map(function(t){return Xo(e._r,t)}),i=Zr.fromMillis(t.localWriteTimeMs);return new ea(t.batchId,i,n,r)}function ch(t){var e,n=ah(t.readTime),r=void 0!==t.lastLimboFreeSnapshotVersion?ah(t.lastLimboFreeSnapshotVersion):Jr.min(),i=void 0!==t.query.documents?(Or(1===(e=t.query).documents.length),vu(pu(zo(e.documents[0])))):function(t){var e,n=zo(t.parent),r=t.structuredQuery,i=r.from?r.from.length:0,o=null;0<i&&(Or(1===i),(e=r.from[0]).allDescendants?o=e.collectionId:n=n.child(e.collectionId));var s=[];r.where&&(s=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=es(t.unaryFilter.field);return Au.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=es(t.unaryFilter.field);return Au.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=es(t.unaryFilter.field);return Au.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=es(t.unaryFilter.field);return Au.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return xr()}}(e)]:void 0!==e.fieldFilter?[(n=e,Au.create(es(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return xr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):xr():[];var n}(r.where));var u=[];r.orderBy&&(u=r.orderBy.map(function(t){return new ta(es((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));var a,h,c=null;r.limit&&(c=li(h="object"==typeof(a=r.limit)?a.value:a)?null:h);var f=null;r.startAt&&(f=$o(r.startAt));var l=null;return r.endAt&&(l=$o(r.endAt)),vu(lu(n,o,u,s,c,"F",f,l))}(t.query);return new _i(i,t.targetId,0,t.lastListenSequenceNumber,n,r,bi.fromBase64String(t.resumeToken))}function fh(t,e){var n=uh(e.Z),r=uh(e.lastLimboFreeSnapshotVersion),i=(wi(e.target)?Qo:Zo)(t._r,e.target),o=e.resumeToken.toBase64();return new Bh(e.targetId,gi(e.target),n,o,e.sequenceNumber,r,i)}var lh=(ph.Tr=function(t,e,n,r){return Or(""!==t.uid),new ph(t.Er()?t.uid:"",e,n,r)},ph.prototype.mr=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return vh(t).Zs({index:Uh.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},ph.prototype.Ir=function(d,y,v,g){var m=this,w=gh(d),b=vh(d);return b.add({}).next(function(t){Or("number"==typeof t);for(var e,n,r,i,o,s=new ea(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return Yo(e._r,t)}),o=r.mutations.map(function(t){return Yo(e._r,t)}),new Uh(n,r.batchId,r.Tn.toMillis(),i,o)),a=[],h=new Ui(function(t,e){return Ur(t.F(),e.F())}),c=0,f=g;c<f.length;c++){var l=f[c],p=Vh.key(m.userId,l.key.path,t),h=h.add(l.key.path.p());a.push(b.put(u)),a.push(w.put(p,Vh.PLACEHOLDER))}return h.forEach(function(t){a.push(m.zn.Ar(d,t))}),d.Wn(function(){m.wr[t]=s.keys()}),ra.Cn(a).next(function(){return s})})},ph.prototype.Rr=function(t,e){var n=this;return vh(t).get(e).next(function(t){return t?(Or(t.userId===n.userId),hh(n.serializer,t)):null})},ph.prototype.Pr=function(t,n){var r=this;return this.wr[n]?ra.resolve(this.wr[n]):this.Rr(t,n).next(function(t){if(t){var e=t.keys();return r.wr[n]=e}return null})},ph.prototype.gr=function(t,e){var r=this,i=e+1,n=IDBKeyRange.lowerBound([this.userId,i]),o=null;return vh(t).Zs({index:Uh.userMutationsIndex,range:n},function(t,e,n){e.userId===r.userId&&(Or(e.batchId>=i),o=hh(r.serializer,e)),n.done()}).next(function(){return o})},ph.prototype.Vr=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return vh(t).Zs({index:Uh.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},ph.prototype.yr=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return vh(t).Hs(Uh.userMutationsIndex,n).next(function(t){return t.map(function(t){return hh(e.serializer,t)})})},ph.prototype.Yn=function(u,a){var h=this,t=Vh.prefixForPath(this.userId,a.path),e=IDBKeyRange.lowerBound(t),c=[];return gh(u).Zs({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=eh(i);if(r===h.userId&&a.path.isEqual(s))return vh(u).get(o).next(function(t){if(!t)throw xr();Or(t.userId===h.userId),c.push(hh(h.serializer,t))});n.done()}).next(function(){return c})},ph.prototype.es=function(r,t){var a=this,h=new Ui(Ur),i=[];return t.forEach(function(u){var t=Vh.prefixForPath(a.userId,u.path),e=IDBKeyRange.lowerBound(t),n=gh(r).Zs({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=eh(i);r===a.userId&&u.path.isEqual(s)?h=h.add(o):n.done()});i.push(n)}),ra.Cn(i).next(function(){return a.pr(r,h)})},ph.prototype.as=function(t,e){var u=this,a=e.path,h=a.length+1,n=Vh.prefixForPath(this.userId,a),r=IDBKeyRange.lowerBound(n),c=new Ui(Ur);return gh(t).Zs({range:r},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=eh(i);r===u.userId&&a.D(s)?s.length===h&&(c=c.add(o)):n.done()}).next(function(){return u.pr(t,c)})},ph.prototype.pr=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(vh(e).get(t).next(function(t){if(null===t)throw xr();Or(t.userId===n.userId),r.push(hh(n.serializer,t))}))}),ra.Cn(i).next(function(){return r})},ph.prototype.br=function(e,n){var r=this;return yh(e.vr,this.userId,n).next(function(t){return e.Wn(function(){r.Sr(n.batchId)}),ra.forEach(t,function(t){return r.dr.Dr(e,t)})})},ph.prototype.Sr=function(t){delete this.wr[t]},ph.prototype.Cr=function(n){var o=this;return this.mr(n).next(function(t){if(!t)return ra.resolve();var e=IDBKeyRange.lowerBound(Vh.prefixForUser(o.userId)),i=[];return gh(n).Zs({range:e},function(t,e,n){var r;t[0]===o.userId?(r=eh(t[1]),i.push(r)):n.done()}).next(function(){Or(0===i.length)})})},ph.prototype.Nr=function(t,e){return dh(t,this.userId,e)},ph.prototype.Fr=function(t){var e=this;return mh(t).get(this.userId).next(function(t){return t||new Ch(e.userId,-1,"")})},ph);function ph(t,e,n,r){this.userId=t,this.serializer=e,this.zn=n,this.dr=r,this.wr={}}function dh(t,o,e){var n=Vh.prefixForPath(o,e.path),s=n[1],r=IDBKeyRange.lowerBound(n),u=!1;return gh(t).Zs({range:r,Xs:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function yh(t,e,n){var r=t.store(Uh.store),i=t.store(Vh.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.Zs({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){Or(1===u)}));for(var h=[],c=0,f=n.mutations;c<f.length;c++){var l=f[c],p=Vh.key(e,l.key.path,n.batchId);o.push(i.delete(p)),h.push(l.key)}return ra.Cn(o).next(function(){return h})}function vh(t){return hc.Ms(t,Uh.store)}function gh(t){return hc.Ms(t,Vh.store)}function mh(t){return hc.Ms(t,Ch.store)}var wh,bh=(Eh.prototype.xn=function(t,e,n){return Th(t).put(Nh(e),n)},Eh.prototype.Mn=function(t,e){var n=Th(t),r=Nh(e);return n.delete(r)},Eh.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.kr(e,t)})},Eh.prototype.Ln=function(t,e){var n=this;return Th(t).get(Nh(e)).next(function(t){return n.$r(t)})},Eh.prototype.xr=function(t,e){var n=this;return Th(t).get(Nh(e)).next(function(t){var e=n.$r(t);return e?{Or:e,size:_h(t)}:null})},Eh.prototype.getEntries=function(t,e){var r=this,i=Mi;return this.Mr(t,e,function(t,e){var n=r.$r(e);i=i.st(t,n)}).next(function(){return i})},Eh.prototype.Lr=function(t,e){var r=this,i=Mi,o=new ki(ri.P);return this.Mr(t,e,function(t,e){var n=r.$r(e);o=n?(i=i.st(t,n),o.st(t,_h(e))):(i=i.st(t,null),o.st(t,0))}).next(function(){return{qr:i,Br:o}})},Eh.prototype.Mr=function(t,e,i){if(e._())return ra.resolve();var n=IDBKeyRange.bound(e.first().path.N(),e.last().path.N()),o=e.ct(),s=o.wt();return Th(t).Zs({range:n},function(t,e,n){for(var r=ri.K(t);s&&ri.P(s,r)<0;)i(s,null),s=o.wt();s&&s.isEqual(r)&&(i(s,e),s=o.Tt()?o.wt():null),s?n.Gs(s.path.N()):n.done()}).next(function(){for(;s;)i(s,null),s=o.Tt()?o.wt():null})},Eh.prototype.ns=function(t,i,e){var n,r,o,s=this,u=ji,a=i.path.length+1,h={};return e.isEqual(Jr.min())?(n=i.path.N(),h.range=IDBKeyRange.lowerBound(n)):(r=i.path.N(),o=oh(e),h.range=IDBKeyRange.lowerBound([r,o],!0),h.index=jh.collectionReadTimeIndex),Th(t).Zs(h,function(t,e,n){var r;t.length===a&&(r=rh(s.serializer,e),i.path.D(r.key.path)?r instanceof ru&&Tu(i,r)&&(u=u.st(r.key,r)):n.done())}).next(function(){return u})},Eh.prototype.Ur=function(t,e){var r=this,i=Mi,o=oh(e),n=Th(t),s=IDBKeyRange.lowerBound(o,!0);return n.Zs({index:jh.readTimeIndex,range:s},function(t,e){var n=rh(r.serializer,e);i=i.st(n.key,n),o=e.readTime}).next(function(){return{Qr:i,readTime:sh(o)}})},Eh.prototype.Wr=function(t){var e=Th(t),r=Jr.min();return e.Zs({index:jh.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=sh(e.readTime)),n.done()}).next(function(){return r})},Eh.prototype.jr=function(t){return new Eh.Kr(this,!!t&&t.Gr)},Eh.prototype.zr=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Eh.prototype.getMetadata=function(t){return Ih(t).get(Gh.key).next(function(t){return Or(!!t),t})},Eh.prototype.kr=function(t,e){return Ih(t).put(Gh.key,e)},Eh.prototype.$r=function(t){if(t){var e=rh(this.serializer,t);return e instanceof iu&&e.version.isEqual(Jr.min())?null:e}return null},Eh);function Eh(t,e){this.serializer=t,this.zn=e}function Ih(t){return hc.Ms(t,Gh.store)}function Th(t){return hc.Ms(t,jh.store)}function Nh(t){return t.path.N()}function _h(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw xr();e=t.noDocument}return JSON.stringify(e).length}function Ah(t,e){var n=this;return(n=wh.call(this)||this).Hr=t,n.Gr=e,n.Yr=new Yr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}bh.Kr=(n(Ah,wh=ia),Ah.prototype.Un=function(s){var u=this,a=[],h=0,c=new Ui(function(t,e){return Ur(t.F(),e.F())});return this.Fn.forEach(function(t,e){var n,r,i,o=u.Yr.get(t);e?(n=ih(u.Hr.serializer,e,u.readTime),c=c.add(t.path.p()),r=_h(n),h+=r-o,a.push(u.Hr.xn(s,t,n))):(h-=o,u.Gr?(i=ih(u.Hr.serializer,new iu(t,Jr.min()),u.readTime),a.push(u.Hr.xn(s,t,i))):a.push(u.Hr.Mn(s,t)))}),c.forEach(function(t){a.push(u.Hr.zn.Ar(s,t))}),a.push(this.Hr.updateMetadata(s,h)),ra.Cn(a)},Ah.prototype.qn=function(t,e){var n=this;return this.Hr.xr(t,e).next(function(t){return null===t?(n.Yr.set(e,0),null):(n.Yr.set(e,t.size),t.Or)})},Ah.prototype.Bn=function(t,e){var n=this;return this.Hr.Lr(t,e).next(function(t){var e=t.qr;return t.Br.forEach(function(t,e){n.Yr.set(t,e)}),e})},Ah);var Sh=(Ph.prototype.Ar=function(t,e){return this.Jr.add(e),ra.resolve()},Ph.prototype.hs=function(t,e){return ra.resolve(this.Jr.getEntries(e))},Ph),Dh=(Oh.prototype.add=function(t){var e=t.S(),n=t.p(),r=this.index[e]||new Ui(ti.P),i=!r.has(n);return this.index[e]=r.add(n),i},Oh.prototype.has=function(t){var e=t.S(),n=t.p(),r=this.index[e];return r&&r.has(n)},Oh.prototype.getEntries=function(t){return(this.index[t]||new Ui(ti.P)).N()},Oh),kh=(xh.prototype.createOrUpgrade=function(n,r,t,e){var i=this;Or(t<e&&0<=t&&e<=10);var o,s=new ka(r);t<1&&1<=e&&(n.createObjectStore(Lh.store),(o=n).createObjectStore(Ch.store,{keyPath:Ch.keyPath}),o.createObjectStore(Uh.store,{keyPath:Uh.keyPath,autoIncrement:!0}).createIndex(Uh.userMutationsIndex,Uh.userMutationsKeyPath,{unique:!0}),o.createObjectStore(Vh.store),Kh(n),n.createObjectStore(jh.store));var u,a=ra.resolve();return t<3&&3<=e&&(0!==t&&((u=n).deleteObjectStore(zh.store),u.deleteObjectStore(Bh.store),u.deleteObjectStore(Hh.store),Kh(n)),a=a.next(function(){return t=s.store(Hh.store),e=new Hh(0,0,Jr.min().A(),0),t.put(Hh.key,e);var t,e})),t<4&&4<=e&&(0!==t&&(a=a.next(function(){return r=n,(i=s).store(Uh.store).Hs().next(function(t){r.deleteObjectStore(Uh.store),r.createObjectStore(Uh.store,{keyPath:Uh.keyPath,autoIncrement:!0}).createIndex(Uh.userMutationsIndex,Uh.userMutationsKeyPath,{unique:!0});var e=i.store(Uh.store),n=t.map(function(t){return e.put(t)});return ra.Cn(n)});var r,i})),a=a.next(function(){n.createObjectStore(Yh.store,{keyPath:Yh.keyPath})})),t<5&&5<=e&&(a=a.next(function(){return i.removeAcknowledgedMutations(s)})),t<6&&6<=e&&(a=a.next(function(){return n.createObjectStore(Gh.store),i.addDocumentGlobal(s)})),t<7&&7<=e&&(a=a.next(function(){return i.ensureSequenceNumbers(s)})),t<8&&8<=e&&(a=a.next(function(){return i.createCollectionParentIndex(n,s)})),t<9&&9<=e&&(a=a.next(function(){var t,e;(e=n).objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges"),(t=r.objectStore(jh.store)).createIndex(jh.readTimeIndex,jh.readTimeIndexPath,{unique:!1}),t.createIndex(jh.collectionReadTimeIndex,jh.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=e&&(a=a.next(function(){return i.rewriteCanonicalIds(s)})),a},xh.prototype.addDocumentGlobal=function(e){var n=0;return e.store(jh.store).Zs(function(t,e){n+=_h(e)}).next(function(){var t=new Gh(n);return e.store(Gh.store).put(Gh.key,t)})},xh.prototype.removeAcknowledgedMutations=function(r){var i=this,t=r.store(Ch.store),e=r.store(Uh.store);return t.Hs().next(function(t){return ra.forEach(t,function(n){var t=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return e.Hs(Uh.userMutationsIndex,t).next(function(t){return ra.forEach(t,function(t){Or(t.userId===n.userId);var e=hh(i.serializer,t);return yh(r,n.userId,e).next(function(){})})})})})},xh.prototype.ensureSequenceNumbers=function(t){var s=t.store(zh.store),e=t.store(jh.store);return t.store(Hh.store).get(Hh.key).next(function(i){var o=[];return e.Zs(function(t,e){var n=new ti(t),r=[0,$a(n)];o.push(s.get(r).next(function(t){return t?ra.resolve():s.put(new zh(0,$a(n),i.highestListenSequenceNumber))}))}).next(function(){return ra.Cn(o)})})},xh.prototype.createCollectionParentIndex=function(t,e){function r(t){if(o.add(t)){var e=t.S(),n=t.p();return i.put({collectionId:e,parent:$a(n)})}}t.createObjectStore(Wh.store,{keyPath:Wh.keyPath});var i=e.store(Wh.store),o=new Dh;return e.store(jh.store).Zs({Xs:!0},function(t,e){return r(new ti(t).p())}).next(function(){return e.store(Vh.store).Zs({Xs:!0},function(t,e){t[0];var n=t[1];return r((t[2],eh(n)).p())})})},xh.prototype.rewriteCanonicalIds=function(t){var i=this,o=t.store(Bh.store);return o.Zs(function(t,e){var n=ch(e),r=fh(i.serializer,n);return o.put(r)})},xh),Rh=function(t,e){this.seconds=t,this.nanoseconds=e},Lh=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function xh(t){this.serializer=t}function Oh(){this.index={}}function Ph(){this.Jr=new Dh}Lh.store="owner",Lh.key="owner";var Ch=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Ch.store="mutationQueues",Ch.keyPath="userId";var Uh=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Uh.store="mutations",Uh.keyPath="batchId",Uh.userMutationsIndex="userMutationsIndex",Uh.userMutationsKeyPath=["userId","batchId"];var Vh=(Mh.prefixForUser=function(t){return[t]},Mh.prefixForPath=function(t,e){return[t,$a(e)]},Mh.key=function(t,e,n){return[t,$a(e),n]},Mh);function Mh(){}Vh.store="documentMutations",Vh.PLACEHOLDER=new Vh;var Fh=function(t,e){this.path=t,this.readTime=e},qh=function(t,e){this.path=t,this.version=e},jh=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};jh.store="remoteDocuments",jh.readTimeIndex="readTimeIndex",jh.readTimeIndexPath="readTime",jh.collectionReadTimeIndex="collectionReadTimeIndex",jh.collectionReadTimeIndexPath=["parentPath","readTime"];var Gh=function(t){this.byteSize=t};Gh.store="remoteDocumentGlobal",Gh.key="remoteDocumentGlobalKey";var Bh=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Bh.store="targets",Bh.keyPath="targetId",Bh.queryTargetsIndexName="queryTargetsIndex",Bh.queryTargetsKeyPath=["canonicalId","targetId"];var zh=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};zh.store="targetDocuments",zh.keyPath=["targetId","path"],zh.documentTargetsIndex="documentTargetsIndex",zh.documentTargetsKeyPath=["path","targetId"];var Hh=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Hh.key="targetGlobalKey",Hh.store="targetGlobal";var Wh=function(t,e){this.collectionId=t,this.parent=e};function Kh(t){t.createObjectStore(zh.store,{keyPath:zh.keyPath}).createIndex(zh.documentTargetsIndex,zh.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Bh.store,{keyPath:Bh.keyPath}).createIndex(Bh.queryTargetsIndexName,Bh.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Hh.store)}Wh.store="collectionParents",Wh.keyPath=["collectionId","parent"];var Yh=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Yh.store="clientMetadata",Yh.keyPath="clientId";var Xh=i(i(i([Ch.store,Uh.store,Vh.store,jh.store,Bh.store,Lh.store,Hh.store,zh.store],[Yh.store]),[Gh.store]),[Wh.store]),Qh=(Zh.prototype.Ar=function(t,e){var n=this;if(this.Xr.has(e))return ra.resolve();var r=e.S(),i=e.p();t.Wn(function(){n.Xr.add(e)});var o={collectionId:r,parent:$a(i)};return Jh(t).put(o)},Zh.prototype.hs=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Mr(i),""],!1,!0);return Jh(t).Hs(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(eh(r.parent))}return o})},Zh);function Zh(){this.Xr=new Dh}function Jh(t){return hc.Ms(t,Wh.store)}var $h=(nc.prototype.next=function(){return this.Zr+=2,this.Zr},nc.to=function(){return new nc(0)},nc.eo=function(){return new nc(-1)},nc),tc=(ec.prototype.no=function(n){var r=this;return this.so(n).next(function(t){var e=new $h(t.highestTargetId);return t.highestTargetId=e.next(),r.io(n,t).next(function(){return t.highestTargetId})})},ec.prototype.ro=function(t){return this.so(t).next(function(t){return Jr.m(new Zr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},ec.prototype.oo=function(t){return this.so(t).next(function(t){return t.highestListenSequenceNumber})},ec.prototype.ho=function(e,n,r){var i=this;return this.so(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.A()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.io(e,t)})},ec.prototype.ao=function(e,n){var r=this;return this.co(e,n).next(function(){return r.so(e).next(function(t){return t.targetCount+=1,r.uo(n,t),r.io(e,t)})})},ec.prototype.lo=function(t,e){return this.co(t,e)},ec.prototype._o=function(e,t){var n=this;return this.fo(e,t.targetId).next(function(){return rc(e).delete(t.targetId)}).next(function(){return n.so(e)}).next(function(t){return Or(0<t.targetCount),--t.targetCount,n.io(e,t)})},ec.prototype.hr=function(r,i,o){var s=this,u=0,a=[];return rc(r).Zs(function(t,e){var n=ch(e);n.sequenceNumber<=i&&null===o.get(n.targetId)&&(u++,a.push(s._o(r,n)))}).next(function(){return ra.Cn(a)}).next(function(){return u})},ec.prototype.be=function(t,r){return rc(t).Zs(function(t,e){var n=ch(e);r(n)})},ec.prototype.so=function(t){return ic(t).get(Hh.key).next(function(t){return Or(null!==t),t})},ec.prototype.io=function(t,e){return ic(t).put(Hh.key,e)},ec.prototype.co=function(t,e){return rc(t).put(fh(this.serializer,e))},ec.prototype.uo=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},ec.prototype.do=function(t){return this.so(t).next(function(t){return t.targetCount})},ec.prototype.wo=function(t,i){var e=gi(i),n=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),o=null;return rc(t).Zs({range:n,index:Bh.queryTargetsIndexName},function(t,e,n){var r=ch(e);mi(i,r.target)&&(o=r,n.done())}).next(function(){return o})},ec.prototype.To=function(n,t,r){var i=this,o=[],s=oc(n);return t.forEach(function(t){var e=$a(t.path);o.push(s.put(new zh(r,e))),o.push(i.dr.Eo(n,r,t))}),ra.Cn(o)},ec.prototype.mo=function(n,t,r){var i=this,o=oc(n);return ra.forEach(t,function(t){var e=$a(t.path);return ra.Cn([o.delete([r,e]),i.dr.Io(n,r,t)])})},ec.prototype.fo=function(t,e){var n=oc(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},ec.prototype.Ao=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=oc(t),o=zi();return r.Zs({range:n,Xs:!0},function(t,e,n){var r=eh(t[1]),i=new ri(r);o=o.add(i)}).next(function(){return o})},ec.prototype.Nr=function(t,e){var n=$a(e.path),r=IDBKeyRange.bound([n],[Mr(n)],!1,!0),i=0;return oc(t).Zs({index:zh.documentTargetsIndex,Xs:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},ec.prototype.Me=function(t,e){return rc(t).get(e).next(function(t){return t?ch(t):null})},ec);function ec(t,e){this.dr=t,this.serializer=e}function nc(t){this.Zr=t}function rc(t){return hc.Ms(t,Bh.store)}function ic(t){return hc.Ms(t,Hh.store)}function oc(t){return hc.Ms(t,zh.store)}var sc,uc="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",ac=(n(fc,sc=sa),fc),hc=(cc.Ms=function(t,e){if(t instanceof ac)return Ea.Ms(t.vr,e);throw xr()},cc.prototype.start=function(){var e=this;return this.xo().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Qr(Xr.FAILED_PRECONDITION,uc);return e.Oo(),e.Mo(),e.Lo(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.ko.oo(t)})}).then(function(t){e.yo=new ha(t,e.Po)}).then(function(){e.po=!0}).catch(function(t){return e.Fo&&e.Fo.close(),Promise.reject(t)})},cc.prototype.qo=function(n){var t=this;return this.Co=function(e){return g(t,void 0,void 0,function(){return w(this,function(t){return this.tr?[2,n(e)]:[2]})})},n(this.isPrimary)},cc.prototype.Bo=function(n){var t=this;this.Fo.Bs(function(e){return g(t,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},cc.prototype.Uo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.ms.ai(function(){return g(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.tr?[4,this.xo()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},cc.prototype.xo=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return pc(e).put(new Yh(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.Qo(e).next(function(t){t||(n.isPrimary=!1,n.ms.gi(function(){return n.Co(!1)}))})}).next(function(){return n.Wo(e)}).next(function(t){return n.isPrimary&&!t?n.jo(e).next(function(){return!1}):!!t&&n.Ko(e).next(function(){return!0})})}).catch(function(t){if(Da(t))return Dr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Dr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.ms.gi(function(){return n.Co(t)}),n.isPrimary=t})},cc.prototype.Qo=function(t){var e=this;return lc(t).get(Lh.key).next(function(t){return ra.resolve(e.Go(t))})},cc.prototype.zo=function(t){return pc(t).delete(this.clientId)},cc.prototype.Ho=function(){return g(this,void 0,void 0,function(){var e,n,r,i,o=this;return w(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.Yo(this.Do,18e5)?[3,2]:(this.Do=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=cc.Ms(t,Yh.store);return r.Hs().next(function(t){var e=o.Jo(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return ra.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.$o)for(n=0,r=e;n<r.length;n++)i=r[n],this.$o.removeItem(this.Xo(i.clientId));t.label=2;case 2:return[2]}})})},cc.prototype.Lo=function(){var t=this;this.So=this.ms.Ss("client_metadata_refresh",4e3,function(){return t.xo().then(function(){return t.Ho()}).then(function(){return t.Lo()})})},cc.prototype.Go=function(t){return!!t&&t.ownerId===this.clientId},cc.prototype.Wo=function(e){var i=this;return this.Vo?ra.resolve(!0):lc(e).get(Lh.key).next(function(t){if(null!==t&&i.Yo(t.leaseTimestampMs,5e3)&&!i.Zo(t.ownerId)){if(i.Go(t)&&i.networkEnabled)return!0;if(!i.Go(t)){if(!t.allowTabSynchronization)throw new Qr(Xr.FAILED_PRECONDITION,uc);return!1}}return!(!i.networkEnabled||!i.inForeground)||pc(e).Hs().next(function(t){return void 0===i.Jo(t,5e3).find(function(t){if(i.clientId!==t.clientId){var e=!i.networkEnabled&&t.networkEnabled,n=!i.inForeground&&t.inForeground,r=i.networkEnabled===t.networkEnabled;if(e||n&&r)return!0}return!1})})}).next(function(t){return i.isPrimary!==t&&Dr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},cc.prototype.th=function(){return g(this,void 0,void 0,function(){var n=this;return w(this,function(t){switch(t.label){case 0:return this.po=!1,this.eh(),this.So&&(this.So.cancel(),this.So=null),this.nh(),this.sh(),[4,this.Fo.runTransaction("readwrite",[Lh.store,Yh.store],function(t){var e=new ac(t,ha.Es);return n.jo(e).next(function(){return n.zo(e)})})];case 1:return t.sent(),this.Fo.close(),this.ih(),[2]}})})},cc.prototype.Jo=function(t,e){var n=this;return t.filter(function(t){return n.Yo(t.updateTimeMs,e)&&!n.Zo(t.clientId)})},cc.prototype.rh=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return pc(t).Hs().next(function(t){return e.Jo(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(cc.prototype,"tr",{get:function(){return this.po},enumerable:!1,configurable:!0}),cc.prototype.oh=function(t){return lh.Tr(t,this.serializer,this.zn,this.dr)},cc.prototype.hh=function(){return this.ko},cc.prototype.ah=function(){return this.Kn},cc.prototype.uh=function(){return this.zn},cc.prototype.runTransaction=function(e,n,r){var i=this;Dr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Fo.runTransaction(t,Xh,function(t){return o=new ac(t,i.yo?i.yo.next():ha.Es),"readwrite-primary"===n?i.Qo(o).next(function(t){return!!t||i.Wo(o)}).next(function(t){if(!t)throw kr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.ms.gi(function(){return i.Co(!1)}),new Qr(Xr.FAILED_PRECONDITION,oa);return r(o)}).next(function(t){return i.Ko(o).next(function(){return t})}):i.lh(o).next(function(){return r(o)})}).then(function(t){return o.jn(),t})},cc.prototype.lh=function(t){var e=this;return lc(t).get(Lh.key).next(function(t){if(null!==t&&e.Yo(t.leaseTimestampMs,5e3)&&!e.Zo(t.ownerId)&&!e.Go(t)&&!(e.Vo||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Qr(Xr.FAILED_PRECONDITION,uc)})},cc.prototype.Ko=function(t){var e=new Lh(this.clientId,this.allowTabSynchronization,Date.now());return lc(t).put(Lh.key,e)},cc.ks=function(){return Ea.ks()},cc.prototype.jo=function(t){var e=this,n=lc(t);return n.get(Lh.key).next(function(t){return e.Go(t)?(Dr("IndexedDbPersistence","Releasing primary lease."),n.delete(Lh.key)):ra.resolve()})},cc.prototype.Yo=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(kr("Detected an update time that is in the future: "+t+" > "+n),1))},cc.prototype.Oo=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.vo=function(){t.ms.ai(function(){return t.inForeground="visible"===t.document.visibilityState,t.xo()})},this.document.addEventListener("visibilitychange",this.vo),this.inForeground="visible"===this.document.visibilityState)},cc.prototype.nh=function(){this.vo&&(this.document.removeEventListener("visibilitychange",this.vo),this.vo=null)},cc.prototype.Mo=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.bo=function(){e.eh(),e.ms.ai(function(){return e.th()})},this.window.addEventListener("unload",this.bo))},cc.prototype.sh=function(){this.bo&&(this.window.removeEventListener("unload",this.bo),this.bo=null)},cc.prototype.Zo=function(t){var e;try{var n=null!==(null===(e=this.$o)||void 0===e?void 0:e.getItem(this.Xo(t)));return Dr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return kr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},cc.prototype.eh=function(){if(this.$o)try{this.$o.setItem(this.Xo(this.clientId),String(Date.now()))}catch(t){kr("Failed to set zombie client id.",t)}},cc.prototype.ih=function(){if(this.$o)try{this.$o.removeItem(this.Xo(this.clientId))}catch(t){}},cc.prototype.Xo=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},cc);function cc(t,e,n,r,i,o,s,u,a,h){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.ms=i,this.window=o,this.document=s,this.Po=a,this.Vo=h,this.yo=null,this.po=!1,this.isPrimary=!1,this.networkEnabled=!0,this.bo=null,this.inForeground=!1,this.vo=null,this.So=null,this.Do=Number.NEGATIVE_INFINITY,this.Co=function(t){return Promise.resolve()},!cc.ks())throw new Qr(Xr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.dr=new dc(this,r),this.No=e+"main",this.serializer=new nh(u),this.Fo=new Ea(this.No,10,new kh(this.serializer)),this.ko=new tc(this.dr,this.serializer),this.zn=new Qh,this.Kn=new bh(this.serializer,this.zn),this.window&&this.window.localStorage?this.$o=this.window.localStorage:(this.$o=null,!1===h&&kr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function fc(t,e){var n=this;return(n=sc.call(this)||this).vr=t,n.Ro=e,n}function lc(t){return hc.Ms(t,Lh.store)}function pc(t){return hc.Ms(t,Yh.store)}var dc=(yc.prototype.ir=function(t){var n=this._h(t);return this.db.hh().do(t).next(function(e){return n.next(function(t){return e+t})})},yc.prototype._h=function(t){var e=0;return this.or(t,function(t){e++}).next(function(){return e})},yc.prototype.be=function(t,e){return this.db.hh().be(t,e)},yc.prototype.or=function(t,n){return this.fh(t,function(t,e){return n(e)})},yc.prototype.Eo=function(t,e,n){return vc(t,n)},yc.prototype.Io=function(t,e,n){return vc(t,n)},yc.prototype.hr=function(t,e,n){return this.db.hh().hr(t,e,n)},yc.prototype.Dr=vc,yc.prototype.dh=function(t,e){return r=e,i=!1,mh(n=t).ti(function(t){return dh(n,t,r).next(function(t){return t&&(i=!0),ra.resolve(!t)})}).next(function(){return i});var n,r,i},yc.prototype.ar=function(r,i){var o=this,s=this.db.ah().jr(),u=[],a=0;return this.fh(r,function(e,t){var n;t<=i&&(n=o.dh(r,e).next(function(t){if(!t)return a++,s.Ln(r,e).next(function(){return s.Mn(e),oc(r).delete([0,$a(e.path)])})}),u.push(n))}).next(function(){return ra.Cn(u)}).next(function(){return s.apply(r)}).next(function(){return a})},yc.prototype.removeTarget=function(t,e){var n=e.tt(t.Ro);return this.db.hh().lo(t,n)},yc.prototype.wh=vc,yc.prototype.fh=function(t,o){var s,e=oc(t),u=ha.Es;return e.Zs({index:zh.documentTargetsIndex},function(t,e){var n=t[0],r=(t[1],e.path),i=e.sequenceNumber;0===n?(u!==ha.Es&&o(new ri(eh(s)),u),u=i,s=r):u=ha.Es}).next(function(){u!==ha.Es&&o(new ri(eh(s)),u)})},yc.prototype.ur=function(t){return this.db.ah().zr(t)},yc);function yc(t,e){this.db=t,this.Yi=new Qa(this,e)}function vc(t,e){return oc(t).put((n=t.Ro,new zh(0,$a(e.path),n)));var n}function gc(t,e){var n=t.projectId;return t.i||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var mc=(wc.prototype.er=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.cr(t,n.Eh)})},wc);function wc(t,e,n){this.persistence=t,this.Th=e,this.Eh=new ki(Ur),this.mh=new Yr(gi,mi),this.Ih=Jr.min(),this.Gn=t.oh(n),this.Ah=t.ah(),this.ko=t.hh(),this.Rh=new ua(this.Ah,this.Gn,this.persistence.uh()),this.Th.Ph(this.Rh)}function bc(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.ko.ro(t)})}function Ec(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.ko.wo(e,r).next(function(t){return t?(n=t,ra.resolve(n)):i.ko.no(e).next(function(t){return n=new _i(r,t,0,e.Ro),i.ko.ao(e,n).next(function(){return n})})})}).then(function(t){var e=i.Eh.get(t.targetId);return(null===e||0<t.Z.o(e.Z))&&(i.Eh=i.Eh.st(t.targetId,t),i.mh.set(r,t.targetId)),t})}function Ic(o,s,u){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:n=(e=o).Eh.get(s),r=u?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),u?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.dr.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Da(i=t.sent()))throw i;return Dr("LocalStore","Failed to update sequence numbers for target "+s+": "+i),[3,5];case 5:return e.Eh=e.Eh.remove(s),e.mh.delete(n.target),[2]}})})}function Tc(t,s,u){var a=t,h=Jr.min(),c=zi();return a.persistence.runTransaction("Execute query","readonly",function(e){return t=a,n=e,r=vu(s),(void 0!==(o=(i=t).mh.get(r))?ra.resolve(i.Eh.get(o)):i.ko.wo(n,r)).next(function(t){if(t)return h=t.lastLimboFreeSnapshotVersion,a.ko.Ao(e,t.targetId).next(function(t){c=t})}).next(function(){return a.Th.ns(e,s,u?h:Jr.min(),u?c:zi())}).next(function(t){return{documents:t,gh:c}});var t,n,r,i,o})}function Nc(t,e){var n=t,r=n.ko,i=n.Eh.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Me(t,e).next(function(t){return t?t.target:null})})}function _c(e){return g(this,void 0,void 0,function(){return w(this,function(t){if(e.code!==Xr.FAILED_PRECONDITION||e.message!==oa)throw e;return Dr("LocalStore","Unexpectedly lost primary lease"),[2]})})}var Ac=(Lc.prototype._=function(){return this.Vh._()},Lc.prototype.Eo=function(t,e){var n=new Sc(t,e);this.Vh=this.Vh.add(n),this.ph=this.ph.add(n)},Lc.prototype.vh=function(t,e){var n=this;t.forEach(function(t){return n.Eo(t,e)})},Lc.prototype.Io=function(t,e){this.Sh(new Sc(t,e))},Lc.prototype.Dh=function(t,e){var n=this;t.forEach(function(t){return n.Io(t,e)})},Lc.prototype.Ch=function(t){var e=this,n=new ri(new ti([])),r=new Sc(n,t),i=new Sc(n,t+1),o=[];return this.ph.St([r,i],function(t){e.Sh(t),o.push(t.key)}),o},Lc.prototype.Nh=function(){var e=this;this.Vh.forEach(function(t){return e.Sh(t)})},Lc.prototype.Sh=function(t){this.Vh=this.Vh.delete(t),this.ph=this.ph.delete(t)},Lc.prototype.Fh=function(t){var e=new ri(new ti([])),n=new Sc(e,t),r=new Sc(e,t+1),i=zi();return this.ph.St([n,r],function(t){i=i.add(t.key)}),i},Lc.prototype.Nr=function(t){var e=new Sc(t,0),n=this.Vh.Ct(e);return null!==n&&t.isEqual(n.key)},Lc),Sc=(Rc.yh=function(t,e){return ri.P(t.key,e.key)||Ur(t.kh,e.kh)},Rc.bh=function(t,e){return Ur(t.kh,e.kh)||ri.P(t.key,e.key)},Rc),Dc=(kc.prototype.Er=function(){return null!=this.uid},kc.prototype.$h=function(){return this.Er()?"uid:"+this.uid:"anonymous-user"},kc.prototype.isEqual=function(t){return t.uid===this.uid},kc);function kc(t){this.uid=t}function Rc(t,e){this.key=t,this.kh=e}function Lc(){this.Vh=new Ui(Sc.yh),this.ph=new Ui(Sc.bh)}function xc(t,e){this.user=e,this.type="OAuth",this.Mh={},this.Mh.Authorization="Bearer "+t}Dc.UNAUTHENTICATED=new Dc(null),Dc.xh=new Dc("google-credentials-uid"),Dc.Oh=new Dc("first-party-uid");var Oc,Pc,Cc,Uc=(ef.prototype.getToken=function(){return Promise.resolve(null)},ef.prototype.qh=function(){},ef.prototype.Bh=function(t){(this.Lh=t)(Dc.UNAUTHENTICATED)},ef.prototype.Uh=function(){this.Lh=null},ef),Vc=(tf.prototype.getToken=function(){var e=this,n=this.jh,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.jh!==n?(Dr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Or("string"==typeof t.accessToken),new xc(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},tf.prototype.qh=function(){this.forceRefresh=!0},tf.prototype.Bh=function(t){this.Lh=t,this.Wh&&t(this.currentUser)},tf.prototype.Uh=function(){this.auth&&this.auth.removeAuthTokenListener(this.Qh),this.Qh=null,this.Lh=null},tf.prototype.Kh=function(){var t=this.auth&&this.auth.getUid();return Or(null===t||"string"==typeof t),new Dc(t)},tf),Mc=(Object.defineProperty($c.prototype,"Mh",{get:function(){var t={"X-Goog-AuthUser":this.zh},e=this.Gh.auth.Hh([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),$c),Fc=(Jc.prototype.getToken=function(){return Promise.resolve(new Mc(this.Gh,this.zh))},Jc.prototype.Bh=function(t){t(Dc.Oh)},Jc.prototype.Uh=function(){},Jc.prototype.qh=function(){},Jc),qc=(Zc.prototype.ea=function(){return 1===this.state||2===this.state||4===this.state},Zc.prototype.na=function(){return 2===this.state},Zc.prototype.start=function(){3!==this.state?this.auth():this.sa()},Zc.prototype.stop=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ea()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Zc.prototype.ia=function(){this.state=0,this.Ti.reset()},Zc.prototype.ra=function(){var t=this;this.na()&&null===this.ta&&(this.ta=this.ms.Ss(this.Yh,6e4,function(){return t.oa()}))},Zc.prototype.ha=function(t){this.aa(),this.stream.send(t)},Zc.prototype.oa=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.na()?[2,this.close(0)]:[2]})})},Zc.prototype.aa=function(){this.ta&&(this.ta.cancel(),this.ta=null)},Zc.prototype.close=function(e,n){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.aa(),this.Ti.cancel(),this.Zh++,3!==e?this.Ti.reset():n&&n.code===Xr.RESOURCE_EXHAUSTED?(kr(n.toString()),kr("Using maximum backoff delay to prevent overloading the backend."),this.Ti.ps()):n&&n.code===Xr.UNAUTHENTICATED&&this.Xh.qh(),null!==this.stream&&(this.ca(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.ua(n)];case 1:return t.sent(),[2]}})})},Zc.prototype.ca=function(){},Zc.prototype.auth=function(){var n=this;this.state=1;var t=this.la(this.Zh),e=this.Zh;this.Xh.getToken().then(function(t){n.Zh===e&&n._a(t)},function(e){t(function(){var t=new Qr(Xr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.fa(t)})})},Zc.prototype._a=function(t){var e=this,n=this.la(this.Zh);this.stream=this.da(t),this.stream.wa(function(){n(function(){return e.state=2,e.listener.wa()})}),this.stream.ua(function(t){n(function(){return e.fa(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Zc.prototype.sa=function(){var t=this;this.state=4,this.Ti.bs(function(){return g(t,void 0,void 0,function(){return w(this,function(t){return this.state=0,this.start(),[2]})})})},Zc.prototype.fa=function(t){return Dr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Zc.prototype.la=function(e){var n=this;return function(t){n.ms.ai(function(){return n.Zh===e?t():(Dr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Zc),jc=(n(Qc,Cc=qc),Qc.prototype.da=function(t){return this.Jh.Ta("Listen",t)},Qc.prototype.onMessage=function(t){this.Ti.reset();var e=function(t,e){var n,r,i,o;if("targetChange"in e){e.targetChange;var s="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:xr(),u=e.targetChange.targetIds||[],a=(i=e.targetChange.resumeToken,t.Le?(Or(void 0===i||"string"==typeof i),bi.fromBase64String(i||"")):(Or(void 0===i||i instanceof Uint8Array),bi.fromUint8Array(i||new Uint8Array))),h=e.targetChange.cause,c=new Yi(s,u,a,h&&(r=void 0===(n=h).code?Xr.UNKNOWN:Di(n.code),new Qr(r,n.message||""))||null)}else if("documentChange"in e){e.documentChange;var f=e.documentChange;f.document,f.document.name,f.document.updateTime;var l=Go(t,f.document.name),p=Mo(f.document.updateTime),d=new Ks({mapValue:{fields:f.document.fields}}),y=new ru(l,p,d,{}),c=new Wi(f.targetIds||[],f.removedTargetIds||[],y.key,y)}else if("documentDelete"in e){e.documentDelete;var v=e.documentDelete;v.document;var g=Go(t,v.document),m=v.readTime?Mo(v.readTime):Jr.min(),w=new iu(g,m);c=new Wi([],v.removedTargetIds||[],w.key,w)}else if("documentRemove"in e){e.documentRemove;var b=e.documentRemove;b.document;var E=Go(t,b.document);c=new Wi([],b.removedTargetIds||[],E,null)}else{if(!("filter"in e))return xr();e.filter;var I=e.filter;I.targetId;var T=new Ii(I.count||0);c=new Ki(I.targetId,T)}return c}(this.serializer,t),n=function(t){if(!("targetChange"in t))return Jr.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Jr.min():Mo(e.readTime)}(t);return this.listener.Ea(e,n)},Qc.prototype.ma=function(t){var e,n,r,i,o={};o.database=Ho(this.serializer),o.addTarget=(e=this.serializer,(r=wi(i=(n=t).target)?{documents:Qo(e,i)}:{query:Zo(e,i)}).targetId=n.targetId,0<n.resumeToken.Y()&&(r.resumeToken=Vo(e,n.resumeToken)),r);var s,u,a=(this.serializer,s=t,null==(u=function(){switch(s.X){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return xr()}}())?null:{"goog-listen-tags":u});a&&(o.labels=a),this.ha(o)},Qc.prototype.Ia=function(t){var e={};e.database=Ho(this.serializer),e.removeTarget=t,this.ha(e)},Qc),Gc=(n(Xc,Pc=qc),Object.defineProperty(Xc.prototype,"Ra",{get:function(){return this.Aa},enumerable:!1,configurable:!0}),Xc.prototype.start=function(){this.Aa=!1,this.lastStreamToken=void 0,Pc.prototype.start.call(this)},Xc.prototype.ca=function(){this.Aa&&this.Pa([])},Xc.prototype.da=function(t){return this.Jh.Ta("Write",t)},Xc.prototype.onMessage=function(t){if(Or(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Aa){this.Ti.reset();var e=(r=t.writeResults,i=t.commitTime,r&&0<r.length?(Or(void 0!==i),r.map(function(t){return function(t,e){var n=t.updateTime?Mo(t.updateTime):Mo(e);n.isEqual(Jr.min())&&(n=Mo(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new Ns(n,r)}(t,i)})):[]),n=Mo(t.commitTime);return this.listener.ga(n,e)}var r,i;return Or(!t.writeResults||0===t.writeResults.length),this.Aa=!0,this.listener.Va()},Xc.prototype.ya=function(){var t={};t.database=Ho(this.serializer),this.ha(t)},Xc.prototype.Pa=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map(function(t){return Yo(e.serializer,t)})};this.ha(n)},Xc),Bc=(n(Yc,Oc=function(){}),Yc.prototype.ba=function(){if(this.pa)throw new Qr(Xr.FAILED_PRECONDITION,"The client has already been terminated.")},Yc.prototype.va=function(e,n,r){var i=this;return this.ba(),this.credentials.getToken().then(function(t){return i.Jh.va(e,n,r,t)}).catch(function(t){throw t.code===Xr.UNAUTHENTICATED&&i.credentials.qh(),t})},Yc.prototype.Sa=function(e,n,r){var i=this;return this.ba(),this.credentials.getToken().then(function(t){return i.Jh.Sa(e,n,r,t)}).catch(function(t){throw t.code===Xr.UNAUTHENTICATED&&i.credentials.qh(),t})},Yc.prototype.terminate=function(){this.pa=!1},Yc),zc=(Kc.prototype.ka=function(){var t=this;0===this.Ca&&(this.$a("Unknown"),this.Na=this.ei.Ss("online_state_timeout",1e4,function(){return t.Na=null,t.xa("Backend didn't respond within 10 seconds."),t.$a("Offline"),Promise.resolve()}))},Kc.prototype.Oa=function(t){"Online"===this.state?this.$a("Unknown"):(this.Ca++,1<=this.Ca&&(this.Ma(),this.xa("Connection failed 1 times. Most recent error: "+t.toString()),this.$a("Offline")))},Kc.prototype.set=function(t){this.Ma(),this.Ca=0,"Online"===t&&(this.Fa=!1),this.$a(t)},Kc.prototype.$a=function(t){t!==this.state&&(this.state=t,this.Da(t))},Kc.prototype.xa=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Fa?(kr(e),this.Fa=!1):Dr("OnlineStateTracker",e)},Kc.prototype.Ma=function(){null!==this.Na&&(this.Na.cancel(),this.Na=null)},Kc),Hc=(Wc.prototype.start=function(){return this.enableNetwork()},Wc.prototype.enableNetwork=function(){return this.Wa.delete(0),this.ic()},Wc.prototype.ic=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Ga()?(this.rc()?this.oc():this.Ha.set("Unknown"),[4,this.hc()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Wc.prototype.disableNetwork=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Wa.add(0),[4,this.ac()];case 1:return t.sent(),this.Ha.set("Offline"),[2]}})})},Wc.prototype.ac=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,this.tc.stop()];case 1:return t.sent(),[4,this.Ya.stop()];case 2:return t.sent(),0<this.Ba.length&&(Dr("RemoteStore","Stopping write stream with "+this.Ba.length+" pending writes"),this.Ba=[]),this.cc(),[2]}})})},Wc.prototype.th=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return Dr("RemoteStore","RemoteStore shutting down."),this.Wa.add(5),[4,this.ac()];case 1:return t.sent(),this.ja.th(),this.Ha.set("Unknown"),[2]}})})},Wc.prototype.listen=function(t){this.Ua.has(t.targetId)||(this.Ua.set(t.targetId,t),this.rc()?this.oc():this.Ya.na()&&this.uc(t))},Wc.prototype.lc=function(t){this.Ua.delete(t),this.Ya.na()&&this._c(t),0===this.Ua.size&&(this.Ya.na()?this.Ya.ra():this.Ga()&&this.Ha.set("Unknown"))},Wc.prototype.Me=function(t){return this.Ua.get(t)||null},Wc.prototype.Oe=function(t){return this.fc.Oe(t)},Wc.prototype.uc=function(t){this.Qa.we(t.targetId),this.Ya.ma(t)},Wc.prototype._c=function(t){this.Qa.we(t),this.Ya.Ia(t)},Wc.prototype.oc=function(){this.Qa=new eo(this),this.Ya.start(),this.Ha.ka()},Wc.prototype.rc=function(){return this.Ga()&&!this.Ya.ea()&&0<this.Ua.size},Wc.prototype.Ga=function(){return 0===this.Wa.size},Wc.prototype.cc=function(){this.Qa=null},Wc.prototype.Ja=function(){return g(this,void 0,void 0,function(){var n=this;return w(this,function(t){return this.Ua.forEach(function(t,e){n.uc(t)}),[2]})})},Wc.prototype.Xa=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){return this.cc(),this.rc()?(this.Ha.Oa(e),this.oc()):this.Ha.set("Unknown"),[2]})})},Wc.prototype.Za=function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:if(this.Ha.set("Online"),!(i instanceof Yi&&2===i.state&&i.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.dc(i)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Dr("RemoteStore","Failed to remove targets %s: %s ",i.targetIds.join(","),e),[4,this.wc(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(i instanceof Wi?this.Qa.ge(i):i instanceof Ki?this.Qa.Ce(i):this.Qa.pe(i),o.isEqual(Jr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,bc(this.La)];case 8:return n=t.sent(),0<=o.o(n)?[4,this.Tc(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Dr("RemoteStore","Failed to raise snapshot:",r=t.sent()),[4,this.wc(r)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},Wc.prototype.wc=function(n,r){return g(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:if(!Da(n))throw n;return this.Wa.add(1),[4,this.ac()];case 1:return t.sent(),this.Ha.set("Offline"),r=r||function(){return bc(e.La)},this.ei.gi(function(){return g(e,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return Dr("RemoteStore","Retrying IndexedDB access"),[4,r()];case 1:return t.sent(),this.Wa.delete(1),[4,this.ic()];case 2:return t.sent(),[2]}})})}),[2]}})})},Wc.prototype.Ec=function(e){var n=this;return e().catch(function(t){return n.wc(t,e)})},Wc.prototype.Tc=function(r){var i=this,t=this.Qa.ke(r);return t.Wt.forEach(function(t,e){var n;0<t.resumeToken.Y()&&(n=i.Ua.get(e))&&i.Ua.set(e,n.et(t.resumeToken,r))}),t.jt.forEach(function(t){var e,n=i.Ua.get(t);n&&(i.Ua.set(t,n.et(bi.J,n.Z)),i._c(t),e=new _i(n.target,t,1,n.sequenceNumber),i.uc(e))}),this.fc.mc(t)},Wc.prototype.dc=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){switch(t.label){case 0:e=o.cause,n=0,r=o.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],this.Ua.has(i)?[4,this.fc.Ic(i,e)]:[3,3]):[3,5];case 2:t.sent(),this.Ua.delete(i),this.Qa.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},Wc.prototype.hc=function(){return g(this,void 0,void 0,function(){var i,o,s;return w(this,function(t){switch(t.label){case 0:i=0<this.Ba.length?this.Ba[this.Ba.length-1].batchId:-1,t.label=1;case 1:if(!this.Ac())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=this.La,n=i,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.Gn.gr(t,n)}))];case 3:return null===(o=t.sent())?(0===this.Ba.length&&this.tc.ra(),[3,7]):(i=o.batchId,this.Rc(o),[3,6]);case 4:return s=t.sent(),[4,this.wc(s)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.Pc()&&this.gc(),[2]}var e,n,r})})},Wc.prototype.Ac=function(){return this.Ga()&&this.Ba.length<10},Wc.prototype.Vc=function(){return this.Ba.length},Wc.prototype.Rc=function(t){this.Ba.push(t),this.tc.na()&&this.tc.Ra&&this.tc.Pa(t.mutations)},Wc.prototype.Pc=function(){return this.Ga()&&!this.tc.ea()&&0<this.Ba.length},Wc.prototype.gc=function(){this.tc.start()},Wc.prototype.ec=function(){return g(this,void 0,void 0,function(){return w(this,function(t){return this.tc.ya(),[2]})})},Wc.prototype.sc=function(){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){for(e=0,n=this.Ba;e<n.length;e++)r=n[e],this.tc.Pa(r.mutations);return[2]})})},Wc.prototype.ga=function(i,o){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return e=this.Ba.shift(),n=na.from(e,i,o),[4,this.Ec(function(){return r.fc.yc(n)})];case 1:return t.sent(),[4,this.hc()];case 2:return t.sent(),[2]}})})},Wc.prototype.nc=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e&&this.tc.Ra?[4,this.pc(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Pc()&&this.gc(),[2]}})})},Wc.prototype.pc=function(i){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return Si(n=i.code)&&n!==Xr.ABORTED?(e=this.Ba.shift(),this.tc.ia(),[4,this.Ec(function(){return r.fc.bc(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,this.hc()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Wc.prototype.za=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Wa.add(4),[4,this.ac()];case 1:return t.sent(),this.Ha.set("Unknown"),this.tc.ia(),this.Ya.ia(),this.Wa.delete(4),[4,this.ic()];case 2:return t.sent(),[2]}})})},Wc.prototype.vc=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.ei.pi(),Dr("RemoteStore","RemoteStore received new credentials"),this.Wa.add(3),[4,this.ac()];case 1:return t.sent(),this.Ha.set("Unknown"),[4,this.fc.vc(e)];case 2:return t.sent(),this.Wa.delete(3),[4,this.ic()];case 3:return t.sent(),[2]}})})},Wc.prototype.Sc=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return e?(this.Wa.delete(2),[4,this.ic()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.Wa.add(2),[4,this.ac()]);case 3:t.sent(),this.Ha.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},Wc);function Wc(t,e,n,r,i){var o,s,u,a,h,c,f,l,p=this;this.La=t,this.qa=e,this.ei=n,this.Ba=[],this.Ua=new Map,this.Qa=null,this.Wa=new Set,this.ja=i,this.ja.Ka(function(t){n.ai(function(){return g(p,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Ga()?(Dr("RemoteStore","Restarting streams for network reachability change."),[4,this.za()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Ha=new zc(n,r),this.Ya=(h=this.qa,c=n,f={wa:this.Ja.bind(this),ua:this.Xa.bind(this),Ea:this.Za.bind(this)},(l=h).ba(),new jc(c,l.Jh,l.credentials,l.serializer,f)),this.tc=(o=this.qa,s=n,u={wa:this.ec.bind(this),ua:this.nc.bind(this),Va:this.sc.bind(this),ga:this.ga.bind(this)},(a=o).ba(),new Gc(s,a.Jh,a.credentials,a.serializer,u))}function Kc(t,e){this.ei=t,this.Da=e,this.state="Unknown",this.Ca=0,this.Na=null,this.Fa=!0}function Yc(t,e,n){var r=this;return(r=Oc.call(this)||this).credentials=t,r.Jh=e,r.serializer=n,r.pa=!1,r}function Xc(t,e,n,r,i){var o=this;return(o=Pc.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Aa=!1,o}function Qc(t,e,n,r,i){var o=this;return(o=Cc.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Zc(t,e,n,r,i,o){this.ms=t,this.Yh=n,this.Jh=r,this.Xh=i,this.listener=o,this.state=0,this.Zh=0,this.ta=null,this.stream=null,this.Ti=new ba(t,e)}function Jc(t,e){this.Gh=t,this.zh=e}function $c(t,e){this.Gh=t,this.zh=e,this.type="FirstParty",this.user=Dc.Oh}function tf(t){var e=this;this.Qh=null,this.currentUser=Dc.UNAUTHENTICATED,this.Wh=!1,this.jh=0,this.Lh=null,this.forceRefresh=!1,this.Qh=function(){e.jh++,e.currentUser=e.Kh(),e.Wh=!0,e.Lh&&e.Lh(e.currentUser)},this.jh=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Qh):(this.Qh(null),t.get().then(function(t){e.auth=t,e.Qh&&e.auth.addAuthTokenListener(e.Qh)},function(){}))}function ef(){this.Lh=null}function nf(t,e){return"firestore_clients_"+t+"_"+e}function rf(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.Er()&&(r+="_"+e.uid),r}function of(t,e){return"firestore_targets_"+t+"_"+e}function sf(t){this.key=t}function uf(t){this.key=t}function af(t,e,n){this.query=t,this.targetId=e,this.view=n}function hf(t){this.key=t,this.qu=!1}var cf=(Sf.Dc=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Qr(r.error.code,r.error.message)),i?new Sf(t,e,r.state,o):(kr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},Sf.prototype.Cc=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Sf),ff=(Af.Dc=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Qr(n.error.code,n.error.message)),r?new Af(t,n.state,i):(kr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},Af.prototype.Cc=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Af),lf=(_f.Dc=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Hi,o=0;r&&o<n.activeTargetIds.length;++o)r=di(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new _f(t,i):(kr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},_f),pf=(Nf.Dc=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Nf(e.clientId,e.onlineState):(kr("SharedClientState","Failed to parse online state: "+t),null)},Nf),df=(Tf.prototype.Nc=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Tf.prototype.Fc=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Tf.prototype.Cc=function(){var t={activeTargetIds:this.activeTargetIds.N(),updateTimeMs:Date.now()};return JSON.stringify(t)},Tf),yf=(If.ks=function(t){return!(!t||!t.localStorage)},If.prototype.start=function(){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f,l=this;return w(this,function(t){switch(t.label){case 0:return[4,this.fc.rh()];case 1:for(e=t.sent(),n=0,r=e;n<r.length;n++)(i=r[n])!==this.kc&&(o=this.getItem(nf(this.persistenceKey,i)))&&(s=lf.Dc(i,o))&&(this.Oc=this.Oc.st(s.clientId,s));for(this.jc(),(u=this.storage.getItem(this.Wc))&&(a=this.Kc(u))&&this.Gc(a),h=0,c=this.Mc;h<c.length;h++)f=c[h],this.xc(f);return this.Mc=[],this.window.addEventListener("unload",function(){return l.th()}),this.tr=!0,[2]}})})},If.prototype.Ts=function(t){this.setItem(this.qc,JSON.stringify(t))},If.prototype.zc=function(){return this.Hc(this.Oc)},If.prototype.Yc=function(n){var r=!1;return this.Oc.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},If.prototype.Jc=function(t){this.Xc(t,"pending")},If.prototype.Zc=function(t,e,n){this.Xc(t,e,n),this.tu(t)},If.prototype.eu=function(t){var e,n,r="not-current";return this.Yc(t)&&(!(e=this.storage.getItem(of(this.persistenceKey,t)))||(n=ff.Dc(t,e))&&(r=n.state)),this.nu.Nc(t),this.jc(),r},If.prototype.su=function(t){this.nu.Fc(t),this.jc()},If.prototype.iu=function(t){return this.nu.activeTargetIds.has(t)},If.prototype.ru=function(t){this.removeItem(of(this.persistenceKey,t))},If.prototype.ou=function(t,e,n){this.hu(t,e,n)},If.prototype.au=function(t,e,n){var r=this;e.forEach(function(t){r.tu(t)}),this.currentUser=t,n.forEach(function(t){r.Jc(t)})},If.prototype.cu=function(t){this.uu(t)},If.prototype.th=function(){this.tr&&(this.window.removeEventListener("storage",this.$c),this.removeItem(this.Lc),this.tr=!1)},If.prototype.getItem=function(t){var e=this.storage.getItem(t);return Dr("SharedClientState","READ",t,e),e},If.prototype.setItem=function(t,e){Dr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},If.prototype.removeItem=function(t){Dr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},If.prototype.xc=function(t){var e=this,u=t;if(u.storageArea===this.storage){if(Dr("SharedClientState","EVENT",u.key,u.newValue),u.key===this.Lc)return void kr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ms.gi(function(){return g(e,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){if(this.tr){if(null!==u.key)if(this.Bc.test(u.key)){if(null==u.newValue)return e=this.lu(u.key),[2,this._u(e,null)];if(n=this.fu(u.key,u.newValue))return[2,this._u(n.clientId,n)]}else if(this.Uc.test(u.key)){if(null!==u.newValue&&(r=this.du(u.key,u.newValue)))return[2,this.wu(r)]}else if(this.Qc.test(u.key)){if(null!==u.newValue&&(i=this.Tu(u.key,u.newValue)))return[2,this.Eu(i)]}else if(u.key===this.Wc){if(null!==u.newValue&&(o=this.Kc(u.newValue)))return[2,this.Gc(o)]}else u.key===this.qc&&(s=function(t){var e=ha.Es;if(null!=t)try{var n=JSON.parse(t);Or("number"==typeof n),e=n}catch(t){kr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(u.newValue))!==ha.Es&&this.fs(s)}else this.Mc.push(u);return[2]})})})}},Object.defineProperty(If.prototype,"nu",{get:function(){return this.Oc.get(this.kc)},enumerable:!1,configurable:!0}),If.prototype.jc=function(){this.setItem(this.Lc,this.nu.Cc())},If.prototype.Xc=function(t,e,n){var r=new cf(this.currentUser,t,e,n),i=rf(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Cc())},If.prototype.tu=function(t){var e=rf(this.persistenceKey,this.currentUser,t);this.removeItem(e)},If.prototype.uu=function(t){var e={clientId:this.kc,onlineState:t};this.storage.setItem(this.Wc,JSON.stringify(e))},If.prototype.hu=function(t,e,n){var r=of(this.persistenceKey,t),i=new ff(t,e,n);this.setItem(r,i.Cc())},If.prototype.lu=function(t){var e=this.Bc.exec(t);return e?e[1]:null},If.prototype.fu=function(t,e){var n=this.lu(t);return lf.Dc(n,e)},If.prototype.du=function(t,e){var n=this.Uc.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return cf.Dc(new Dc(i),r,e)},If.prototype.Tu=function(t,e){var n=this.Qc.exec(t),r=Number(n[1]);return ff.Dc(r,e)},If.prototype.Kc=function(t){return pf.Dc(t)},If.prototype.wu=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.fc.mu(e.batchId,e.state,e.error)]:(Dr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},If.prototype.Eu=function(t){return this.fc.Iu(t.targetId,t.state,t.error)},If.prototype._u=function(t,e){var n=this,r=e?this.Oc.st(t,e):this.Oc.remove(t),i=this.Hc(this.Oc),o=this.Hc(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.fc.Au(s,u).then(function(){n.Oc=r})},If.prototype.Gc=function(t){this.Oc.get(t.clientId)&&this.Da(t.onlineState)},If.prototype.Hc=function(t){var n=Hi;return t.forEach(function(t,e){n=n.Nt(e.activeTargetIds)}),n},If),vf=(Ef.prototype.Jc=function(t){},Ef.prototype.Zc=function(t,e,n){},Ef.prototype.eu=function(t){return this.Ru.Nc(t),this.Pu[t]||"not-current"},Ef.prototype.ou=function(t,e,n){this.Pu[t]=e},Ef.prototype.su=function(t){this.Ru.Fc(t)},Ef.prototype.iu=function(t){return this.Ru.activeTargetIds.has(t)},Ef.prototype.ru=function(t){delete this.Pu[t]},Ef.prototype.zc=function(){return this.Ru.activeTargetIds},Ef.prototype.Yc=function(t){return this.Ru.activeTargetIds.has(t)},Ef.prototype.start=function(){return this.Ru=new df,Promise.resolve()},Ef.prototype.au=function(t,e,n){},Ef.prototype.cu=function(t){},Ef.prototype.th=function(){},Ef.prototype.Ts=function(t){},Ef),gf=(Object.defineProperty(bf.prototype,"vu",{get:function(){return this.gu},enumerable:!1,configurable:!0}),bf.prototype.Su=function(t,e){var u=this,a=e?e.Du:new Qi,h=e?e.bu:this.bu,c=e?e.qt:this.qt,f=h,l=!1,p=this.query.an()&&h.size===this.query.limit?h.last():null,d=this.query.cn()&&h.size===this.query.limit?h.first():null;if(t.ht(function(t,e){var n=h.get(t),r=(r=e instanceof ru?e:null)&&(Tu(u.query,r)?r:null),i=!!n&&u.qt.has(n.key),o=!!r&&(r.Ge||u.qt.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(a.track({type:3,doc:r}),s=!0):u.Cu(n,r)||(a.track({type:2,doc:r}),s=!0,(p&&0<u.pu(r,p)||d&&u.pu(r,d)<0)&&(l=!0)):!n&&r?(a.track({type:0,doc:r}),s=!0):n&&!r&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(l=!0)),s&&(c=r?(f=f.add(r),o?c.add(t):c.delete(t)):(f=f.delete(t),c.delete(t)))}),this.query.an()||this.query.cn())for(;f.size>this.query.limit;){var n=this.query.an()?f.last():f.first(),f=f.delete(n.key),c=c.delete(n.key);a.track({type:1,doc:n})}return{bu:f,Du:a,Nu:l,qt:c}},bf.prototype.Cu=function(t,e){return t.Ge&&e.hasCommittedMutations&&!e.Ge},bf.prototype.Un=function(t,e,n){var o=this,r=this.bu;this.bu=t.bu,this.qt=t.qt;var i=t.Du.Mt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.pu(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return xr()}}var r,i}),this.Fu(n);var s=e?this.ku():[],u=0===this.yu.size&&this.Yt?1:0,a=u!==this.Vu;return this.Vu=u,0!==i.length||a?{snapshot:new Zi(this.query,t.bu,r,i,t.qt,0==u,a,!1),$u:s}:{$u:s}},bf.prototype.xu=function(t){return this.Yt&&"Offline"===t?(this.Yt=!1,this.Un({bu:this.bu,Du:new Qi,qt:this.qt,Nu:!1},!1)):{$u:[]}},bf.prototype.Ou=function(t){return!this.gu.has(t)&&!!this.bu.has(t)&&!this.bu.get(t).Ge},bf.prototype.Fu=function(t){var e=this;t&&(t.Jt.forEach(function(t){return e.gu=e.gu.add(t)}),t.Xt.forEach(function(t){}),t.Zt.forEach(function(t){return e.gu=e.gu.delete(t)}),this.Yt=t.Yt)},bf.prototype.ku=function(){var e=this;if(!this.Yt)return[];var n=this.yu;this.yu=zi(),this.bu.forEach(function(t){e.Ou(t.key)&&(e.yu=e.yu.add(t.key))});var r=[];return n.forEach(function(t){e.yu.has(t)||r.push(new uf(t))}),this.yu.forEach(function(t){n.has(t)||r.push(new sf(t))}),r},bf.prototype.Mu=function(t){this.gu=t.gh,this.yu=zi();var e=this.Su(t.documents);return this.Un(e,!0)},bf.prototype.Lu=function(){return Zi.Qt(this.query,this.bu,this.qt,0===this.Vu)},bf),mf=(Object.defineProperty(wf.prototype,"el",{get:function(){return!0===this.tl},enumerable:!1,configurable:!0}),wf.prototype.subscribe=function(t){this.Wu=t},wf.prototype.listen=function(s){return g(this,void 0,void 0,function(){var e,n,r,i,o;return w(this,function(t){switch(t.label){case 0:return this.nl("listen()"),(r=this.ju.get(s))?(e=r.targetId,this.Uu.eu(e),n=r.view.Lu(),[3,4]):[3,1];case 1:return[4,Ec(this.La,vu(s))];case 2:return i=t.sent(),o=this.Uu.eu(i.targetId),e=i.targetId,[4,this.sl(s,e,"current"===o)];case 3:n=t.sent(),this.el&&this.Bu.listen(i),t.label=4;case 4:return[2,n]}})})},wf.prototype.sl=function(u,a,h){return g(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return[4,Tc(this.La,u,!0)];case 1:return e=t.sent(),n=new gf(u,e.gh),r=n.Su(e.documents),i=$i.Ht(a,h&&"Offline"!==this.onlineState),o=n.Un(r,this.el,i),this.il(a,o.$u),s=new af(u,a,n),[2,(this.ju.set(u,s),this.Ku.has(a)?this.Ku.get(a).push(u):this.Ku.set(a,[u]),o.snapshot)]}})})},wf.prototype.lc=function(i){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return this.nl("unlisten()"),e=this.ju.get(i),1<(n=this.Ku.get(e.targetId)).length?[2,(this.Ku.set(e.targetId,n.filter(function(t){return!bu(t,i)})),void this.ju.delete(i))]:this.el?(this.Uu.su(e.targetId),this.Uu.Yc(e.targetId)?[3,2]:[4,Ic(this.La,e.targetId,!1).then(function(){r.Uu.ru(e.targetId),r.Bu.lc(e.targetId),r.rl(e.targetId)}).catch(_c)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.rl(e.targetId),[4,Ic(this.La,e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},wf.prototype.write=function(s,u){return g(this,void 0,void 0,function(){var r,i,o;return w(this,function(t){switch(t.label){case 0:this.nl("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(e=this.La,h=s,f=e,l=Zr.now(),n=h.reduce(function(t,e){return t.add(e.key)},zi()),f.persistence.runTransaction("Locally write mutations","readwrite",function(a){return f.Rh.Zn(a,n).next(function(t){c=t;for(var u,e,n=[],r=0,i=h;r<i.length;r++){var o=i[r],s=(u=o,e=c.get(o.key),u instanceof qs?function(t){for(var e=null,n=0,r=u.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof ru?t.field(i.field):void 0,s=is(i.transform,o||null);null!=s&&(e=null==e?(new Ys).set(i.field,s):e.set(i.field,s))}return e?e.ze():null}(e):null);null!=s&&n.push(new Cs(o.key,s,function u(t){var a=[];return Br(t.fields||{},function(t,e){var n=new ni([t]);if(ko(e)){var r=u(e.mapValue).fields;if(0===r.length)a.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];a.push(n.child(s))}}else a.push(n)}),new Es(a)}(s.proto.mapValue),_s.exists(!0)))}return f.Gn.Ir(a,l,n,h)})}).then(function(t){var e=t.An(c);return{batchId:t.batchId,Fn:e}}))];case 2:return r=t.sent(),this.Uu.Jc(r.batchId),this.ol(r.batchId,u),[4,this.hl(r.Fn)];case 3:return t.sent(),[4,this.Bu.hc()];case 4:return t.sent(),[3,6];case 5:return i=t.sent(),o=Ga(i,"Failed to persist write"),u.reject(o),[3,6];case 6:return[2]}var e,h,c,f,l,n})})},wf.prototype.mc=function(i){return g(this,void 0,void 0,function(){var n,r=this;return w(this,function(t){switch(t.label){case 0:this.nl("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=this.La,c=e,f=(s=i).Z,l=c.Eh,c.persistence.runTransaction("Apply remote event","readwrite-primary",function(a){var i=c.Ah.jr({Gr:!0});l=c.Eh;var h=[];s.Wt.forEach(function(t,e){var n,r,i,o,s,u=l.get(e);u&&(h.push(c.ko.mo(a,t.Zt,e).next(function(){return c.ko.To(a,t.Jt,e)})),0<(n=t.resumeToken).Y()&&(r=u.et(n,f).tt(a.Ro),l=l.st(e,r),i=u,s=t,Or(0<(o=r).resumeToken.Y()),(0===i.resumeToken.Y()||3e8<=o.Z.I()-i.Z.I()||0<s.Jt.size+s.Xt.size+s.Zt.size)&&h.push(c.ko.lo(a,r))))});var t,o=Mi,n=zi();return s.Kt.forEach(function(t,e){n=n.add(t)}),h.push(i.getEntries(a,n).next(function(r){s.Kt.forEach(function(t,e){var n=r.get(t);e instanceof iu&&e.version.isEqual(Jr.min())?(i.Mn(t,f),o=o.st(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(i.xn(e,f),o=o.st(t,e)):Dr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),s.Gt.has(t)&&h.push(c.persistence.dr.wh(a,t))})})),f.isEqual(Jr.min())||(t=c.ko.ro(a).next(function(t){return c.ko.ho(a,a.Ro,f)}),h.push(t)),ra.Cn(h).next(function(){return i.apply(a)}).next(function(){return c.Rh.ts(a,o)})}).then(function(t){return c.Eh=l,t}))];case 2:return n=t.sent(),i.Wt.forEach(function(t,e){var n=r.Hu.get(e);n&&(Or(t.Jt.size+t.Xt.size+t.Zt.size<=1),0<t.Jt.size?n.qu=!0:0<t.Xt.size?Or(n.qu):0<t.Zt.size&&(Or(n.qu),n.qu=!1))}),[4,this.hl(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,_c(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,s,c,f,l})})},wf.prototype.xu=function(r,t){var i;(this.el&&0===t||!this.el&&1===t)&&(this.nl("applyOnlineStateChange()"),i=[],this.ju.forEach(function(t,e){var n=e.view.xu(r);n.snapshot&&i.push(n.snapshot)}),this.Wu.al(r),this.Wu.Ea(i),this.onlineState=r,this.el&&this.Uu.cu(r))},wf.prototype.Ic=function(u,a){return g(this,void 0,void 0,function(){var e,n,r,i,o,s=this;return w(this,function(t){switch(t.label){case 0:return this.nl("rejectListens()"),this.Uu.ou(u,"rejected",a),e=this.Hu.get(u),(n=e&&e.key)?(r=(r=new ki(ri.P)).st(n,new iu(n,Jr.min())),i=zi().add(n),o=new Ji(Jr.min(),new Map,new Ui(Ur),r,i),[4,this.mc(o)]):[3,2];case 1:return t.sent(),this.zu=this.zu.remove(n),this.Hu.delete(u),this.cl(),[3,4];case 2:return[4,Ic(this.La,u,!1).then(function(){return s.rl(u,a)}).catch(_c)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},wf.prototype.yc=function(i){return g(this,void 0,void 0,function(){var n,r;return w(this,function(t){switch(t.label){case 0:this.nl("applySuccessfulWrite()"),n=i.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=this.La,c=i,(f=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var i,e=c.batch.keys(),n=f.Ah.jr({Gr:!0}),r=f,o=t,s=n,u=(i=c).batch,a=u.keys(),h=ra.resolve();return a.forEach(function(r){h=h.next(function(){return s.Ln(o,r)}).next(function(t){var e=t,n=i.Pn.get(r);Or(null!==n),(!e||e.version.o(n)<0)&&(e=u.En(r,e,i))&&s.xn(e,i.Rn)})}),h.next(function(){return r.Gn.br(o,u)}).next(function(){return n.apply(t)}).next(function(){return f.Gn.Cr(t)}).next(function(){return f.Rh.Zn(t,e)})}))];case 2:return r=t.sent(),this.ul(n,null),this.ll(n),this.Uu.Zc(n,"acknowledged"),[4,this.hl(r)];case 3:return t.sent(),[3,6];case 4:return[4,_c(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,c,f})})},wf.prototype.bc=function(o,s){return g(this,void 0,void 0,function(){var n;return w(this,function(t){switch(t.label){case 0:this.nl("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=this.La,r=o,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Gn.Rr(e,r).next(function(t){return Or(null!==t),n=t.keys(),i.Gn.br(e,t)}).next(function(){return i.Gn.Cr(e)}).next(function(){return i.Rh.Zn(e,n)})}))];case 2:return n=t.sent(),this.ul(o,s),this.ll(o),this.Uu.Zc(o,"rejected",s),[4,this.hl(n)];case 3:return t.sent(),[3,6];case 4:return[4,_c(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})},wf.prototype._l=function(u){return g(this,void 0,void 0,function(){var r,i,o,s;return w(this,function(t){switch(t.label){case 0:this.Bu.Ga()||Dr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=this.La,(n=e).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return n.Gn.Vr(t)}))];case 2:return-1===(r=t.sent())?[2,void u.resolve()]:((i=this.Xu.get(r)||[]).push(u),this.Xu.set(r,i),[3,4]);case 3:return o=t.sent(),s=Ga(o,"Initialization of waitForPendingWrites() operation failed"),u.reject(s),[3,4];case 4:return[2]}var e,n})})},wf.prototype.ll=function(t){(this.Xu.get(t)||[]).forEach(function(t){t.resolve()}),this.Xu.delete(t)},wf.prototype.fl=function(e){this.Xu.forEach(function(t){t.forEach(function(t){t.reject(new Qr(Xr.CANCELLED,e))})}),this.Xu.clear()},wf.prototype.ol=function(t,e){var n=(n=(n=this.Ju[this.currentUser.$h()])||new ki(Ur)).st(t,e);this.Ju[this.currentUser.$h()]=n},wf.prototype.ul=function(t,e){var n,r=this.Ju[this.currentUser.$h()];r&&((n=r.get(t))&&(e?n.reject(e):n.resolve(),r=r.remove(t)),this.Ju[this.currentUser.$h()]=r)},wf.prototype.rl=function(t,e){var n=this;void 0===e&&(e=null),this.Uu.su(t);for(var r=0,i=this.Ku.get(t);r<i.length;r++){var o=i[r];this.ju.delete(o),e&&this.Wu.dl(o,e)}this.Ku.delete(t),this.el&&this.Yu.Ch(t).forEach(function(t){n.Yu.Nr(t)||n.wl(t)})},wf.prototype.wl=function(t){var e=this.zu.get(t);null!==e&&(this.Bu.lc(e),this.zu=this.zu.remove(t),this.Hu.delete(e),this.cl())},wf.prototype.il=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof sf?(this.Yu.Eo(i.key,t),this.Tl(i)):i instanceof uf?(Dr("SyncEngine","Document no longer in limbo: "+i.key),this.Yu.Io(i.key,t),this.Yu.Nr(i.key)||this.wl(i.key)):xr()}},wf.prototype.Tl=function(t){var e=t.key;this.zu.get(e)||(Dr("SyncEngine","New document in limbo: "+e),this.Gu.push(e),this.cl())},wf.prototype.cl=function(){for(;0<this.Gu.length&&this.zu.size<this.Qu;){var t=this.Gu.shift(),e=this.Zu.next();this.Hu.set(e,new hf(t)),this.zu=this.zu.st(t,e),this.Bu.listen(new _i(vu(pu(t.path)),e,2,ha.Es))}},wf.prototype.El=function(){return this.zu},wf.prototype.ml=function(){return this.Gu},wf.prototype.hl=function(r,a){return g(this,void 0,void 0,function(){var o,s,e,u=this;return w(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.ju.forEach(function(t,i){e.push(Promise.resolve().then(function(){var n=i.view.Su(r);return n.Nu?Tc(u.La,i.query,!1).then(function(t){var e=t.documents;return i.view.Su(e,n)}):n}).then(function(t){var e,n=a&&a.Wt.get(i.targetId),r=i.view.Un(t,u.el,n);u.il(i.targetId,r.$u),r.snapshot&&(u.el&&u.Uu.ou(i.targetId,r.snapshot.fromCache?"not-current":"current"),o.push(r.snapshot),e=aa._s(i.targetId,r.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.Wu.Ea(o),[4,function(c,f){return g(this,void 0,void 0,function(){var r,e,n,i,o,s,u,a,h;return w(this,function(t){switch(t.label){case 0:r=c,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ra.forEach(f,function(e){return ra.forEach(e.us,function(t){return r.persistence.dr.Eo(n,e.targetId,t)}).next(function(){return ra.forEach(e.ls,function(t){return r.persistence.dr.Io(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Da(e=t.sent()))throw e;return Dr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=f;n<i.length;n++)o=i[n],s=o.targetId,o.fromCache||(u=r.Eh.get(s),a=u.Z,h=u.nt(a),r.Eh=r.Eh.st(s,h));return[2]}})})}(this.La,s)];case 2:return t.sent(),[2]}})})},wf.prototype.nl=function(t){},wf.prototype.vc=function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(Dr("SyncEngine","User change. New user:",n.$h()),[4,function(i,o){return g(this,void 0,void 0,function(){var e,n,m,r;return w(this,function(t){switch(t.label){case 0:return n=(e=i).Gn,m=e.Rh,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Gn.yr(v).next(function(t){return g=t,n=e.persistence.oh(o),m=new ua(e.Ah,n,e.persistence.uh()),n.yr(v)}).next(function(t){for(var e=[],n=[],r=zi(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,f=t;c<f.length;c++){var l=f[c];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Zn(v,r).next(function(t){return{Il:t,Al:e,Rl:n}})})})];case 1:return r=t.sent(),[2,(e.Gn=n,e.Rh=m,e.Th.Ph(e.Rh),r)]}})})}(this.La,n)]);case 1:return e=t.sent(),this.currentUser=n,this.fl("'waitForPendingWrites' promise is rejected due to a user change."),this.Uu.au(n,e.Al,e.Rl),[4,this.hl(e.Il)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},wf.prototype.Oe=function(t){var e=this.Hu.get(t);if(e&&e.qu)return zi().add(e.key);var n=zi(),r=this.Ku.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++)var s=o[i],u=this.ju.get(s),n=n.Nt(u.view.vu);return n},wf);function wf(t,e,n,r,i,o){this.La=t,this.Bu=e,this.qa=n,this.Uu=r,this.currentUser=i,this.Qu=o,this.Wu=null,this.ju=new Yr(Eu,bu),this.Ku=new Map,this.Gu=[],this.zu=new ki(ri.P),this.Hu=new Map,this.Yu=new Ac,this.Ju={},this.Xu=new Map,this.Zu=$h.eo(),this.onlineState="Unknown",this.tl=void 0}function bf(t,e){this.query=t,this.gu=e,this.Vu=null,this.Yt=!1,this.yu=zi(),this.qt=zi(),this.pu=Nu(t),this.bu=new Xi(this.pu)}function Ef(){this.Ru=new df,this.Pu={},this.Da=null,this.fs=null}function If(t,e,n,r,i){this.window=t,this.ms=e,this.persistenceKey=n,this.kc=r,this.fc=null,this.Da=null,this.fs=null,this.$c=this.xc.bind(this),this.Oc=new ki(Ur),this.tr=!1,this.Mc=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Lc=nf(this.persistenceKey,this.kc),this.qc="firestore_sequence_number_"+this.persistenceKey,this.Oc=this.Oc.st(this.kc,new df),this.Bc=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Uc=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Qc=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Wc="firestore_online_state_"+this.persistenceKey,this.window.addEventListener("storage",this.$c)}function Tf(){this.activeTargetIds=Hi}function Nf(t,e){this.clientId=t,this.onlineState=e}function _f(t,e){this.clientId=t,this.activeTargetIds=e}function Af(t,e,n){this.targetId=t,this.state=e,this.error=n}function Sf(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function Df(y,v){return g(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f,l,p,d;return w(this,function(t){switch(t.label){case 0:e=y,n=[],r=[],i=0,o=v,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.Ku.get(s))&&0!==a.length?[4,Ec(e.La,vu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),h=0,c=a,t.label=3;case 3:return h<c.length?(f=c[h],l=e.ju.get(f),[4,function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return[4,Tc((e=i).La,o.query,!0)];case 1:return n=t.sent(),r=o.view.Mu(n),[2,(e.el&&e.il(o.targetId,r.$u),r)]}})})}(e,l)]):[3,6];case 4:(p=t.sent()).snapshot&&r.push(p.snapshot),t.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,Nc(e.La,s)];case 8:return d=t.sent(),[4,Ec(e.La,d)];case 9:return u=t.sent(),[4,e.sl(kf(d),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.Wu.Ea(r),n)]}})})}function kf(t){return lu(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Rf(){this.Pl=void 0,this.listeners=[]}var Lf,xf=(jf.prototype.listen=function(u){return g(this,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(r=this.gl.get(e))||(n=!0,r=new Rf),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),i=r,[4,this.fc.listen(e)];case 2:return i.Pl=t.sent(),[3,4];case 3:return o=t.sent(),s=Ga(o,"Initialization of query '"+Iu(u.query)+"' failed"),[2,void u.onError(s)];case 4:return this.gl.set(e,r),r.listeners.push(u),u.xu(this.onlineState),r.Pl&&u.yl(r.Pl)&&this.pl(),[2]}})})},jf.prototype.lc=function(o){return g(this,void 0,void 0,function(){var e,n,r,i;return w(this,function(t){return e=o.query,n=!1,(r=this.gl.get(e))&&0<=(i=r.listeners.indexOf(o))&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?[2,(this.gl.delete(e),this.fc.lc(e))]:[2]})})},jf.prototype.Ea=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.gl.get(o);if(s){for(var u=0,a=s.listeners;u<a.length;u++)a[u].yl(i)&&(e=!0);s.Pl=i}}e&&this.pl()},jf.prototype.dl=function(t,e){var n=this.gl.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(e);this.gl.delete(t)},jf.prototype.al=function(i){this.onlineState=i;var o=!1;this.gl.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].xu(i)&&(o=!0)}),o&&this.pl()},jf.prototype.bl=function(t){this.Vl.add(t),t.next()},jf.prototype.vl=function(t){this.Vl.delete(t)},jf.prototype.pl=function(){this.Vl.forEach(function(t){t.next()})},jf),Of=(qf.prototype.yl=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Zi(t.query,t.docs,t.Lt,e,t.qt,t.fromCache,t.Bt,!0)}var o=!1;return this.Dl?this.Nl(t)&&(this.Sl.next(t),o=!0):this.Fl(t,this.onlineState)&&(this.kl(t),o=!0),this.Cl=t,o},qf.prototype.onError=function(t){this.Sl.error(t)},qf.prototype.xu=function(t){this.onlineState=t;var e=!1;return this.Cl&&!this.Dl&&this.Fl(this.Cl,t)&&(this.kl(this.Cl),e=!0),e},qf.prototype.Fl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.$l&&n||t.docs._()&&"Offline"!==e)},qf.prototype.Nl=function(t){if(0<t.docChanges.length)return!0;var e=this.Cl&&this.Cl.hasPendingWrites!==t.hasPendingWrites;return!(!t.Bt&&!e)&&!0===this.options.includeMetadataChanges},qf.prototype.kl=function(t){t=Zi.Qt(t.query,t.docs,t.qt,t.fromCache),this.Dl=!0,this.Sl.next(t)},qf),Pf=(Ff.prototype.Ph=function(t){this.xl=t},Ff.prototype.ns=function(e,r,i,o){var s=this;return r.hn()||i.isEqual(Jr.min())?this.Ol(e,r):this.xl.Zn(e,o).next(function(t){var n=s.Ml(r,t);return(r.an()||r.cn())&&s.Nu(r.nn,n,o,i)?s.Ol(e,r):(Sr()<=l.DEBUG&&Dr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Iu(r)),s.xl.ns(e,r,i).next(function(e){return n.forEach(function(t){e=e.st(t.key,t)}),e}))})},Ff.prototype.Ml=function(n,t){var r=new Ui(Nu(n));return t.forEach(function(t,e){e instanceof ru&&Tu(n,e)&&(r=r.add(e))}),r},Ff.prototype.Nu=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.o(r))},Ff.prototype.Ol=function(t,e){return Sr()<=l.DEBUG&&Dr("IndexFreeQueryEngine","Using full collection scan to execute query:",Iu(e)),this.xl.ns(t,e,Jr.min())},Ff),Cf=(Mf.prototype.mr=function(t){return ra.resolve(0===this.Gn.length)},Mf.prototype.Ir=function(t,e,n,r){var i=this.Ll;this.Ll++,0<this.Gn.length&&this.Gn[this.Gn.length-1];var o=new ea(i,e,n,r);this.Gn.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.ql=this.ql.add(new Sc(a.key,i)),this.zn.Ar(t,a.key.path.p())}return ra.resolve(o)},Mf.prototype.Rr=function(t,e){return ra.resolve(this.Bl(e))},Mf.prototype.gr=function(t,e){var n=e+1,r=this.Ul(n),i=r<0?0:r;return ra.resolve(this.Gn.length>i?this.Gn[i]:null)},Mf.prototype.Vr=function(){return ra.resolve(0===this.Gn.length?-1:this.Ll-1)},Mf.prototype.yr=function(t){return ra.resolve(this.Gn.slice())},Mf.prototype.Yn=function(t,e){var n=this,r=new Sc(e,0),i=new Sc(e,Number.POSITIVE_INFINITY),o=[];return this.ql.St([r,i],function(t){var e=n.Bl(t.kh);o.push(e)}),ra.resolve(o)},Mf.prototype.es=function(t,e){var r=this,i=new Ui(Ur);return e.forEach(function(t){var e=new Sc(t,0),n=new Sc(t,Number.POSITIVE_INFINITY);r.ql.St([e,n],function(t){i=i.add(t.kh)})}),ra.resolve(this.Ql(i))},Mf.prototype.as=function(t,e){var n=e.path,r=n.length+1,i=n;ri.j(i)||(i=i.child(""));var o=new Sc(new ri(i),0),s=new Ui(Ur);return this.ql.Dt(function(t){var e=t.key.path;return!!n.D(e)&&(e.length===r&&(s=s.add(t.kh)),!0)},o),ra.resolve(this.Ql(s))},Mf.prototype.Ql=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.Bl(t);null!==e&&r.push(e)}),r},Mf.prototype.br=function(n,r){var i=this;Or(0===this.Wl(r.batchId,"removed")),this.Gn.shift();var o=this.ql;return ra.forEach(r.mutations,function(t){var e=new Sc(t.key,r.batchId);return o=o.delete(e),i.dr.Dr(n,t.key)}).next(function(){i.ql=o})},Mf.prototype.Sr=function(t){},Mf.prototype.Nr=function(t,e){var n=new Sc(e,0),r=this.ql.Ct(n);return ra.resolve(e.isEqual(r&&r.key))},Mf.prototype.Cr=function(t){return this.Gn.length,ra.resolve()},Mf.prototype.Wl=function(t,e){return this.Ul(t)},Mf.prototype.Ul=function(t){return 0===this.Gn.length?0:t-this.Gn[0].batchId},Mf.prototype.Bl=function(t){var e=this.Ul(t);return e<0||e>=this.Gn.length?null:this.Gn[e]},Mf),Uf=(Vf.prototype.xn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.jl(e);return this.docs=this.docs.st(r,{Or:e,size:s,readTime:n}),this.size+=s-o,this.zn.Ar(t,r.path.p())},Vf.prototype.Mn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Vf.prototype.Ln=function(t,e){var n=this.docs.get(e);return ra.resolve(n?n.Or:null)},Vf.prototype.getEntries=function(t,e){var n=this,r=Mi;return e.forEach(function(t){var e=n.docs.get(t);r=r.st(t,e?e.Or:null)}),ra.resolve(r)},Vf.prototype.ns=function(t,e,n){for(var r=ji,i=new ri(e.path.child("")),o=this.docs.ut(i);o.Tt();){var s=o.wt(),u=s.key,a=s.value,h=a.Or,c=a.readTime;if(!e.path.D(u.path))break;c.o(n)<=0||h instanceof ru&&Tu(e,h)&&(r=r.st(h.key,h))}return ra.resolve(r)},Vf.prototype.Kl=function(t,e){return ra.forEach(this.docs,function(t){return e(t)})},Vf.prototype.jr=function(t){return new Vf.Kr(this)},Vf.prototype.zr=function(t){return ra.resolve(this.size)},Vf);function Vf(t,e){this.zn=t,this.jl=e,this.docs=new ki(ri.P),this.size=0}function Mf(t,e){this.zn=t,this.dr=e,this.Gn=[],this.Ll=1,this.ql=new Ui(Sc.yh)}function Ff(){}function qf(t,e,n){this.query=t,this.Sl=e,this.Dl=!1,this.Cl=null,this.onlineState="Unknown",this.options=n||{}}function jf(t){this.fc=t,this.gl=new Yr(Eu,bu),this.onlineState="Unknown",this.Vl=new Set,this.fc.subscribe(this)}function Gf(t){var e=this;return(e=Lf.call(this)||this).Hr=t,e}Uf.Kr=(n(Gf,Lf=ia),Gf.prototype.Un=function(n){var r=this,i=[];return this.Fn.forEach(function(t,e){e?i.push(r.Hr.xn(n,e,r.readTime)):r.Hr.Mn(t)}),ra.Cn(i)},Gf.prototype.qn=function(t,e){return this.Hr.Ln(t,e)},Gf.prototype.Bn=function(t,e){return this.Hr.getEntries(t,e)},Gf);var Bf,zf,Hf=(al.prototype.be=function(t,n){return this.Gl.forEach(function(t,e){return n(e)}),ra.resolve()},al.prototype.ro=function(t){return ra.resolve(this.lastRemoteSnapshotVersion)},al.prototype.oo=function(t){return ra.resolve(this.zl)},al.prototype.no=function(t){return this.highestTargetId=this.Yl.next(),ra.resolve(this.highestTargetId)},al.prototype.ho=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.zl&&(this.zl=e),ra.resolve()},al.prototype.co=function(t){this.Gl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Yl=new $h(e),this.highestTargetId=e),t.sequenceNumber>this.zl&&(this.zl=t.sequenceNumber)},al.prototype.ao=function(t,e){return this.co(e),this.targetCount+=1,ra.resolve()},al.prototype.lo=function(t,e){return this.co(e),ra.resolve()},al.prototype._o=function(t,e){return this.Gl.delete(e.target),this.Hl.Ch(e.targetId),--this.targetCount,ra.resolve()},al.prototype.hr=function(n,r,i){var o=this,s=0,u=[];return this.Gl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Gl.delete(t),u.push(o.fo(n,e.targetId)),s++)}),ra.Cn(u).next(function(){return s})},al.prototype.do=function(t){return ra.resolve(this.targetCount)},al.prototype.wo=function(t,e){var n=this.Gl.get(e)||null;return ra.resolve(n)},al.prototype.To=function(t,e,n){return this.Hl.vh(e,n),ra.resolve()},al.prototype.mo=function(e,t,n){this.Hl.Dh(t,n);var r=this.persistence.dr,i=[];return r&&t.forEach(function(t){i.push(r.Dr(e,t))}),ra.Cn(i)},al.prototype.fo=function(t,e){return this.Hl.Ch(e),ra.resolve()},al.prototype.Ao=function(t,e){var n=this.Hl.Fh(e);return ra.resolve(n)},al.prototype.Nr=function(t,e){return ra.resolve(this.Hl.Nr(e))},al),Wf=(ul.prototype.start=function(){return Promise.resolve()},ul.prototype.th=function(){return this.po=!1,Promise.resolve()},Object.defineProperty(ul.prototype,"tr",{get:function(){return this.po},enumerable:!1,configurable:!0}),ul.prototype.Bo=function(){},ul.prototype.Uo=function(){},ul.prototype.uh=function(){return this.zn},ul.prototype.oh=function(t){var e=this.Jl[t.$h()];return e||(e=new Cf(this.zn,this.dr),this.Jl[t.$h()]=e),e},ul.prototype.hh=function(){return this.ko},ul.prototype.ah=function(){return this.Kn},ul.prototype.runTransaction=function(t,e,n){var r=this;Dr("MemoryPersistence","Starting transaction:",t);var i=new Kf(this.yo.next());return this.dr.Zl(),n(i).next(function(t){return r.dr.t_(i).next(function(){return t})}).Sn().then(function(t){return i.jn(),t})},ul.prototype.e_=function(e,n){return ra.Nn(Object.values(this.Jl).map(function(t){return function(){return t.Nr(e,n)}}))},ul),Kf=(n(sl,zf=sa),sl),Yf=(ol.i_=function(t){return new ol(t)},Object.defineProperty(ol.prototype,"r_",{get:function(){if(this.s_)return this.s_;throw xr()},enumerable:!1,configurable:!0}),ol.prototype.Eo=function(t,e,n){return this.n_.Eo(n,e),this.r_.delete(n.toString()),ra.resolve()},ol.prototype.Io=function(t,e,n){return this.n_.Io(n,e),this.r_.add(n.toString()),ra.resolve()},ol.prototype.Dr=function(t,e){return this.r_.add(e.toString()),ra.resolve()},ol.prototype.removeTarget=function(t,e){var n=this;this.n_.Ch(e.targetId).forEach(function(t){return n.r_.add(t.toString())});var r=this.persistence.hh();return r.Ao(t,e.targetId).next(function(t){t.forEach(function(t){return n.r_.add(t.toString())})}).next(function(){return r._o(t,e)})},ol.prototype.Zl=function(){this.s_=new Set},ol.prototype.t_=function(n){var r=this,i=this.persistence.ah().jr();return ra.forEach(this.r_,function(t){var e=ri.B(t);return r.o_(n,e).next(function(t){t||i.Mn(e)})}).next(function(){return r.s_=null,i.apply(n)})},ol.prototype.wh=function(t,e){var n=this;return this.o_(t,e).next(function(t){t?n.r_.delete(e.toString()):n.r_.add(e.toString())})},ol.prototype.Xl=function(t){return 0},ol.prototype.o_=function(t,e){var n=this;return ra.Nn([function(){return ra.resolve(n.n_.Nr(e))},function(){return n.persistence.hh().Nr(t,e)},function(){return n.persistence.e_(t,e)}])},ol),Xf=(il.prototype.wa=function(t){this.c_=t},il.prototype.ua=function(t){this.u_=t},il.prototype.onMessage=function(t){this.l_=t},il.prototype.close=function(){this.a_()},il.prototype.send=function(t){this.h_(t)},il.prototype.__=function(){this.c_()},il.prototype.f_=function(t){this.u_(t)},il.prototype.d_=function(t){this.l_(t)},il),Qf={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Zf=(rl.prototype.va=function(e,t,n,r){var i=this.m_(e,t);Dr("RestConnection","Sending: ",i,n);var o={};return this.I_(o,r),this.A_(e,i,o,n).then(function(t){return Dr("RestConnection","Received: ",t),t},function(t){throw Rr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},rl.prototype.Sa=function(t,e,n,r){return this.va(t,e,n,r)},rl.prototype.I_=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.19.0",t["Content-Type"]="text/plain",e)for(var n in e.Mh)e.Mh.hasOwnProperty(n)&&(t[n]=e.Mh[n])},rl.prototype.m_=function(t,e){var n=Qf[t];return this.T_+"/v1/"+e+":"+n},n(nl,Bf=rl),nl.prototype.A_=function(a,e,n,r){return new Promise(function(o,s){var u=new Tr;u.listenOnce(Er.COMPLETE,function(){try{switch(u.getLastErrorCode()){case br.NO_ERROR:var t=u.getResponseJson();Dr("Connection","XHR received:",JSON.stringify(t)),o(t);break;case br.TIMEOUT:Dr("Connection",'RPC "'+a+'" timed out'),s(new Qr(Xr.DEADLINE_EXCEEDED,"Request time out"));break;case br.HTTP_ERROR:var e,n,r=u.getStatus();Dr("Connection",'RPC "'+a+'" failed with status:',r,"response text:",u.getResponseText()),0<r?(e=u.getResponseJson().error)&&e.status&&e.message?(i=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(Xr).indexOf(i)?i:Xr.UNKNOWN,s(new Qr(n,e.message))):s(new Qr(Xr.UNKNOWN,"Server responded with status "+u.getStatus())):s(new Qr(Xr.UNAVAILABLE,"Connection failed."));break;default:xr()}}finally{Dr("Connection",'RPC "'+a+'" completed.')}var i});var t=JSON.stringify(r);u.send(e,"POST",t,n,15)})},nl.prototype.Ta=function(t,e){var n,r,i=[this.T_,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=wr(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.I_(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(r=p()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Dr("Connection","Creating WebChannel: "+u,s);var h=o.createWebChannel(u,s),c=!1,f=!1,l=new Xf({h_:function(t){f?Dr("Connection","Not sending because WebChannel is closed:",t):(c||(Dr("Connection","Opening WebChannel transport."),h.open(),c=!0),Dr("Connection","WebChannel sending:",t),h.send(t))},a_:function(){return h.close()}});return a(Ir.EventType.OPEN,function(){f||Dr("Connection","WebChannel transport opened.")}),a(Ir.EventType.CLOSE,function(){f||(f=!0,Dr("Connection","WebChannel transport closed"),l.f_())}),a(Ir.EventType.ERROR,function(t){f||(f=!0,Rr("Connection","WebChannel transport errored:",t),l.f_(new Qr(Xr.UNAVAILABLE,"The operation could not be completed")))}),a(Ir.EventType.MESSAGE,function(t){var e,n,r,i,o,s;f||(Or(!!(n=t.data[0])),(r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(Dr("Connection","WebChannel received error:",r),i=r.status,o=function(){var t=Ti[i];if(void 0!==t)return Di(t)}(),s=r.message,void 0===o&&(o=Xr.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),f=!0,l.f_(new Qr(o,s)),h.close()):(Dr("Connection","WebChannel received:",n),l.d_(n)))}),setTimeout(function(){l.__()},0),l},nl),Jf=(el.prototype.Ka=function(t){this.y_.push(t)},el.prototype.th=function(){window.removeEventListener("online",this.R_),window.removeEventListener("offline",this.g_)},el.prototype.p_=function(){window.addEventListener("online",this.R_),window.addEventListener("offline",this.g_)},el.prototype.P_=function(){Dr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.y_;t<e.length;t++)(0,e[t])(0)},el.prototype.V_=function(){Dr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.y_;t<e.length;t++)(0,e[t])(1)},el.ks=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},el),$f=(tl.prototype.Ka=function(t){},tl.prototype.th=function(){},tl);function tl(){}function el(){var t=this;this.R_=function(){return t.P_()},this.g_=function(){return t.V_()},this.y_=[],this.p_()}function nl(t){var e=this;return(e=Bf.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function rl(t){this.w_=t,this.s=t.s;var e=t.ssl?"https":"http";this.T_=e+"://"+t.host,this.E_="projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents"}function il(t){this.h_=t.h_,this.a_=t.a_}function ol(t){this.persistence=t,this.n_=new Ac,this.s_=null}function sl(t){var e=this;return(e=zf.call(this)||this).Ro=t,e}function ul(t){var e=this;this.Jl={},this.yo=new ha(0),this.po=!1,this.po=!0,this.dr=t(this),this.ko=new Hf(this),this.zn=new Sh,this.Kn=new Uf(this.zn,function(t){return e.dr.Xl(t)})}function al(t){this.persistence=t,this.Gl=new Yr(gi,mi),this.lastRemoteSnapshotVersion=Jr.min(),this.highestTargetId=0,this.zl=0,this.Hl=new Ac,this.targetCount=0,this.Yl=$h.to()}function hl(t){return new xo(t,!0)}var cl,fl,ll="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",pl=(wl.prototype.initialize=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Uu=this.b_(e),this.persistence=this.v_(e),[4,this.persistence.start()];case 1:return t.sent(),this.S_=this.D_(e),this.La=this.C_(e),[2]}})})},wl.prototype.D_=function(t){return null},wl.prototype.C_=function(t){return e=this.persistence,n=new Pf,r=t.N_,new mc(e,n,r);var e,n,r},wl.prototype.v_=function(t){if(t.k_.F_)throw new Qr(Xr.FAILED_PRECONDITION,ll);return new Wf(Yf.i_)},wl.prototype.b_=function(t){return new vf},wl.prototype.terminate=function(){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.S_&&this.S_.stop(),[4,this.Uu.th()];case 1:return t.sent(),[4,this.persistence.th()];case 2:return t.sent(),[2]}})})},wl.prototype.clearPersistence=function(t,e){throw new Qr(Xr.FAILED_PRECONDITION,ll)},wl),dl=(n(ml,fl=pl),ml.prototype.initialize=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,fl.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,function(r){return g(this,void 0,void 0,function(){var e,n;return w(this,function(t){return n=(e=r).Ah,[2,e.persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return n.Wr(t)}).then(function(t){e.Ih=t})]})})}(this.La)];case 2:return t.sent(),[2]}})})},ml.prototype.D_=function(t){var e=this.persistence.dr.Yi;return new Xa(e,t.ei)},ml.prototype.v_=function(t){var e=gc(t.w_.s,t.w_.persistenceKey),n=hl(t.w_.s);return new hc(t.k_.synchronizeTabs,e,t.clientId,Wa.Ui(t.k_.cacheSizeBytes),t.ei,Ua(),Va(),n,this.Uu,t.k_.Vo)},ml.prototype.b_=function(t){return new vf},ml.prototype.clearPersistence=function(t,e){return function(n){return g(this,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return Ea.ks()?(e=n+"main",[4,Ea.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(gc(t,e))},n(gl,cl=ml),gl.prototype.initialize=function(r){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:return[4,cl.prototype.initialize.call(this,r)];case 1:return t.sent(),[4,this.x_.initialize(this,r)];case 2:return t.sent(),e=this.x_.fc,this.Uu instanceof yf?(this.Uu.fc={mu:function(u,a,h,c){return g(this,void 0,void 0,function(){var o,s;return w(this,function(t){switch(t.label){case 0:return(o=u).nl("applyBatchState()"),[4,(e=o.La,n=a,i=(r=e).Gn,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Pr(e,n).next(function(t){return t?r.Rh.Zn(e,t):ra.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==h?[3,3]:[4,o.Bu.hc()];case 2:return t.sent(),[3,4];case 3:"acknowledged"===h||"rejected"===h?(o.ul(a,c||null),o.La.Gn.Sr(a)):xr(),t.label=4;case 4:return[4,o.hl(s)];case 5:return t.sent(),[3,7];case 6:Dr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}.bind(null,e),Iu:function(s,u,a,h){return g(this,void 0,void 0,function(){var n,i,o;return w(this,function(t){switch(t.label){case 0:return(n=s).tl?(Dr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!n.Ku.has(u))return[3,8];switch(a){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,(r=n.La,e=r.Ah,r.persistence.runTransaction("Get new document changes","readonly",function(t){return e.Ur(t,r.Ih)}).then(function(t){var e=t.Qr,n=t.readTime;return r.Ih=n,e}))];case 3:return i=t.sent(),o=Ji.zt(u,"current"===a),[4,n.hl(i,o)];case 4:return t.sent(),[3,8];case 5:return[4,Ic(n.La,u,!0)];case 6:return t.sent(),n.rl(u,h),[3,8];case 7:xr(),t.label=8;case 8:return[2]}var r,e})})}.bind(null,e),Au:function(f,l,p){return g(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a,h,c;return w(this,function(t){switch(t.label){case 0:if(!(n=f).tl)return[3,10];e=0,r=l,t.label=1;case 1:return e<r.length?(i=r[e],n.Ku.has(i)?(Dr("SyncEngine","Adding an already active target "+i),[3,5]):[4,Nc(n.La,i)]):[3,6];case 2:return o=t.sent(),[4,Ec(n.La,o)];case 3:return s=t.sent(),[4,n.sl(kf(o),s.targetId,!1)];case 4:t.sent(),n.Bu.listen(s),t.label=5;case 5:return e++,[3,1];case 6:u=function(e){return w(this,function(t){switch(t.label){case 0:return n.Ku.has(e)?[4,Ic(n.La,e,!1).then(function(){n.Bu.lc(e),n.rl(e)}).catch(_c)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},a=0,h=p,t.label=7;case 7:return a<h.length?(c=h[a],[5,u(c)]):[3,10];case 8:t.sent(),t.label=9;case 9:return a++,[3,7];case 10:return[2]}})})}.bind(null,e),rh:function(t){return t.La.persistence.rh()}.bind(null,e)},[4,this.Uu.start()]):[3,4];case 3:t.sent(),t.label=4;case 4:return[4,this.persistence.qo(function(e){return g(n,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,function(c,f){return g(this,void 0,void 0,function(){var r,e,i,o,s,u,a,h;return w(this,function(t){switch(t.label){case 0:return r=c,!0!==f||!0===r.tl?[3,3]:(e=r.Uu.zc(),[4,Df(r,e.N())]);case 1:return i=t.sent(),r.tl=!0,[4,r.Bu.Sc(!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],r.Bu.listen(u);return[3,7];case 3:return!1!==f||!1===r.tl?[3,7]:(a=[],h=Promise.resolve(),r.Ku.forEach(function(t,e){r.Uu.iu(e)?a.push(e):h=h.then(function(){return r.rl(e),Ic(r.La,e,!0)}),r.Bu.lc(e)}),[4,h]);case 4:return t.sent(),[4,Df(r,a)];case 5:return t.sent(),(n=r).Hu.forEach(function(t,e){n.Bu.lc(e)}),n.Yu.Nh(),n.Hu=new Map,n.zu=new ki(ri.P),r.tl=!1,[4,r.Bu.Sc(!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}(this.x_.fc,e)];case 1:return t.sent(),this.S_&&(e&&!this.S_.tr?this.S_.start(this.La):e||this.S_.stop()),[2]}})})})];case 5:return t.sent(),[2]}})})},gl.prototype.b_=function(t){if(t.k_.F_&&t.k_.synchronizeTabs){var e=Ua();if(!yf.ks(e))throw new Qr(Xr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=gc(t.w_.s,t.w_.persistenceKey);return new yf(e,t.ei,n,t.clientId,t.N_)}return new vf},gl),yl=(vl.prototype.initialize=function(n,r){return g(this,void 0,void 0,function(){var e=this;return w(this,function(t){switch(t.label){case 0:return this.La?[3,3]:(this.La=n.La,this.Uu=n.Uu,this.qa=this.O_(r),this.Bu=this.M_(r),this.fc=this.L_(r),this.q_=this.B_(r),this.Uu.Da=function(t){return e.fc.xu(t,1)},this.Bu.fc=this.fc,[4,this.Bu.start()]);case 1:return t.sent(),[4,this.Bu.Sc(this.fc.el)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},vl.prototype.B_=function(t){return new xf(this.fc)},vl.prototype.O_=function(t){var e,n=hl(t.w_.s),r=(e=t.w_,new Zf(e)),i=t.credentials;return new Bc(i,r,n)},vl.prototype.M_=function(t){var e=this;return new Hc(this.La,this.qa,t.ei,function(t){return e.fc.xu(t,0)},new(Jf.ks()?Jf:$f))},vl.prototype.L_=function(t){return e=this.La,n=this.Bu,r=this.qa,i=this.Uu,o=t.N_,s=t.Qu,u=!t.k_.F_||!t.k_.synchronizeTabs,a=new mf(e,n,r,i,o,s),u&&(a.tl=!0),a;var e,n,r,i,o,s,u,a},vl.prototype.terminate=function(){return this.Bu.th()},vl);function vl(){}function gl(t){var e=this;return(e=cl.call(this)||this).x_=t,e}function ml(){return null!==fl&&fl.apply(this,arguments)||this}function wl(){}function bl(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var El=(Il.prototype.next=function(t){this.observer.next&&this.U_(this.observer.next,t)},Il.prototype.error=function(t){this.observer.error?this.U_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Il.prototype.Q_=function(){this.muted=!0},Il.prototype.U_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Il);function Il(t){this.observer=t,this.muted=!1}function Tl(t,e){if(0!==e.length)throw new Qr(Xr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+jl(e.length,"argument")+".")}function Nl(t,e,n){if(e.length!==n)throw new Qr(Xr.INVALID_ARGUMENT,"Function "+t+"() requires "+jl(n,"argument")+", but was called with "+jl(e.length,"argument")+".")}function _l(t,e,n){if(e.length<n)throw new Qr(Xr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+jl(n,"argument")+", but was called with "+jl(e.length,"argument")+".")}function Al(t,e,n,r){if(e.length<n||e.length>r)throw new Qr(Xr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+jl(e.length,"argument")+".")}function Sl(t,e,n,r){Ol(t,e,ql(n)+" argument",r)}function Dl(t,e,n,r){void 0!==r&&Sl(t,e,n,r)}function kl(t,e,n,r){Ol(t,e,n+" option",r)}function Rl(t,e,n,r){void 0!==r&&kl(t,e,n,r)}function Ll(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(Cl(s))}var u=Cl(n);throw new Qr(Xr.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function xl(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Qr(Xr.INVALID_ARGUMENT,"Invalid value "+Cl(r)+" provided to function "+t+"() for its "+ql(n)+" argument. Acceptable values: "+e.join(", "));return r}function Ol(t,e,n,r){if(!("object"===e?Pl(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=Cl(r);throw new Qr(Xr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function Pl(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Cl(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":xr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Ul(t,e,n){if(void 0===n)throw new Qr(Xr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+ql(e)+" argument, but it was undefined.")}function Vl(n,t,r){Br(t,function(t,e){if(r.indexOf(t)<0)throw new Qr(Xr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function Ml(t,e,n,r){var i=Cl(r);return new Qr(Xr.INVALID_ARGUMENT,"Function "+t+"() requires its "+ql(n)+" argument to be a "+e+", but it was: "+i)}function Fl(t,e,n){if(n<=0)throw new Qr(Xr.INVALID_ARGUMENT,"Function "+t+"() requires its "+ql(e)+" argument to be a positive number, but it was: "+n+".")}function ql(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function jl(t,e){return t+" "+e+(1===t?"":"s")}function Gl(){if("undefined"==typeof Uint8Array)throw new Qr(Xr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Bl(){if("undefined"==typeof atob)throw new Qr(Xr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var zl,Hl,Wl=(tp.fromBase64String=function(t){Nl("Blob.fromBase64String",arguments,1),Sl("Blob.fromBase64String","string",1,t),Bl();try{return new tp(bi.fromBase64String(t))}catch(t){throw new Qr(Xr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},tp.fromUint8Array=function(t){if(Nl("Blob.fromUint8Array",arguments,1),Gl(),!(t instanceof Uint8Array))throw Ml("Blob.fromUint8Array","Uint8Array",1,t);return new tp(bi.fromUint8Array(t))},tp.prototype.toBase64=function(){return Nl("Blob.toBase64",arguments,0),Bl(),this.W_.toBase64()},tp.prototype.toUint8Array=function(){return Nl("Blob.toUint8Array",arguments,0),Gl(),this.W_.toUint8Array()},tp.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},tp.prototype.isEqual=function(t){return this.W_.isEqual(t.W_)},tp),Kl=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Qr(Xr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(Sl("FieldPath","string",e,t[e]),0===t[e].length)throw new Qr(Xr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.j_=new ni(t)},Yl=(n($l,Hl=Kl),$l.documentId=function(){return new $l(ni.L().F())},$l.prototype.isEqual=function(t){if(!(t instanceof $l))throw Ml("isEqual","FieldPath",1,t);return this.j_.isEqual(t.j_)},$l),Xl=new RegExp("[~\\*/\\[\\]]"),Ql=function(){this.K_=this},Zl=(n(Jl,zl=Ql),Jl.prototype.z_=function(t){if(2!==t.H_)throw 1===t.H_?t.Y_(this.G_+"() can only appear at the top level of your update data"):t.Y_(this.G_+"() cannot be used with set() unless you pass {merge:true}");return t.qe.push(t.path),null},Jl.prototype.isEqual=function(t){return t instanceof Jl},Jl);function Jl(t){var e=this;return(e=zl.call(this)||this).G_=t,e}function $l(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Hl.call(this,t)||this}function tp(t){Bl(),this.W_=t}function ep(t,e,n){return new kp({H_:3,J_:e.settings.J_,methodName:t.G_,X_:n},e.s,e.serializer,e.ignoreUndefinedProperties)}var np,rp,ip,op,sp,up,ap=(n(Sp,up=Ql),Sp.prototype.z_=function(t){return new Is(t.path,new us)},Sp.prototype.isEqual=function(t){return t instanceof Sp},Sp),hp=(n(Ap,sp=Ql),Ap.prototype.z_=function(t){var e=ep(this,t,!0),n=this.Z_.map(function(t){return Vp(t,e)}),r=new as(n);return new Is(t.path,r)},Ap.prototype.isEqual=function(t){return this===t},Ap),cp=(n(_p,op=Ql),_p.prototype.z_=function(t){var e=ep(this,t,!0),n=this.Z_.map(function(t){return Vp(t,e)}),r=new ps(n);return new Is(t.path,r)},_p.prototype.isEqual=function(t){return this===t},_p),fp=(n(Np,ip=Ql),Np.prototype.z_=function(t){var e=new gs(t.serializer,Co(t.serializer,this.tf));return new Is(t.path,e)},Np.prototype.isEqual=function(t){return this===t},Np),lp=(n(Tp,rp=Ql),Tp.delete=function(){return Tl("FieldValue.delete",arguments),new pp(new Zl("FieldValue.delete"))},Tp.serverTimestamp=function(){return Tl("FieldValue.serverTimestamp",arguments),new pp(new ap("FieldValue.serverTimestamp"))},Tp.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return _l("FieldValue.arrayUnion",arguments,1),new pp(new hp("FieldValue.arrayUnion",t))},Tp.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return _l("FieldValue.arrayRemove",arguments,1),new pp(new cp("FieldValue.arrayRemove",t))},Tp.increment=function(t){return Sl("FieldValue.increment","number",1,t),Nl("FieldValue.increment",arguments,1),new pp(new fp("FieldValue.increment",t))},Tp),pp=(n(Ip,np=lp),Ip.prototype.z_=function(t){return this.K_.z_(t)},Ip.prototype.isEqual=function(t){return t instanceof Ip&&this.K_.isEqual(t.K_)},Ip),dp=(Object.defineProperty(Ep.prototype,"latitude",{get:function(){return this.ef},enumerable:!1,configurable:!0}),Object.defineProperty(Ep.prototype,"longitude",{get:function(){return this.nf},enumerable:!1,configurable:!0}),Ep.prototype.isEqual=function(t){return this.ef===t.ef&&this.nf===t.nf},Ep.prototype.toJSON=function(){return{latitude:this.ef,longitude:this.nf}},Ep.prototype.T=function(t){return Ur(this.ef,t.ef)||Ur(this.nf,t.nf)},Ep),yp=/^__.*__$/,vp=function(t,e,n){this.sf=t,this.if=e,this.rf=n},gp=(bp.prototype.hf=function(t,e){var n=[];return null!==this.qe?n.push(new Cs(t,this.data,this.qe,e)):n.push(new Ps(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new qs(t,this.fieldTransforms)),n},bp),mp=(wp.prototype.hf=function(t,e){var n=[new Cs(t,this.data,this.qe,e)];return 0<this.fieldTransforms.length&&n.push(new qs(t,this.fieldTransforms)),n},wp);function wp(t,e,n){this.data=t,this.qe=e,this.fieldTransforms=n}function bp(t,e,n){this.data=t,this.qe=e,this.fieldTransforms=n}function Ep(t,e){if(Nl("GeoPoint",arguments,2),Sl("GeoPoint","number",1,t),Sl("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Qr(Xr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Qr(Xr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.ef=t,this.nf=e}function Ip(t){var e=this;return(e=np.call(this)||this).K_=t,e.G_=t.G_,e}function Tp(){return rp.call(this)||this}function Np(t,e){var n=this;return(n=ip.call(this)||this).G_=t,n.tf=e,n}function _p(t,e){var n=this;return(n=op.call(this)||this).G_=t,n.Z_=e,n}function Ap(t,e){var n=this;return(n=sp.call(this)||this).G_=t,n.Z_=e,n}function Sp(t){var e=this;return(e=up.call(this)||this).G_=t,e}function Dp(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw xr()}}var kp=(Object.defineProperty(xp.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(xp.prototype,"H_",{get:function(){return this.settings.H_},enumerable:!1,configurable:!0}),xp.prototype.cf=function(t){return new xp(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.qe)},xp.prototype.uf=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.cf({path:n,X_:!1});return r.lf(t),r},xp.prototype._f=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.cf({path:n,X_:!1});return r.af(),r},xp.prototype.ff=function(t){return this.cf({path:void 0,X_:!0})},xp.prototype.Y_=function(t){return Bp(t,this.settings.methodName,this.settings.df||!1,this.path,this.settings.J_)},xp.prototype.contains=function(e){return void 0!==this.qe.find(function(t){return e.D(t)})||void 0!==this.fieldTransforms.find(function(t){return e.D(t.field)})},xp.prototype.af=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.lf(this.path.get(t))},xp.prototype.lf=function(t){if(0===t.length)throw this.Y_("Document fields must not be empty");if(Dp(this.H_)&&yp.test(t))throw this.Y_('Document fields cannot begin and end with "__"')},xp),Rp=(Lp.prototype.wf=function(t,e,n,r){return void 0===r&&(r=!1),new kp({H_:t,methodName:e,J_:n,path:ni.$(),X_:!1,df:r},this.s,this.serializer,this.ignoreUndefinedProperties)},Lp);function Lp(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||hl(t)}function xp(t,e,n,r,i,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.af(),this.fieldTransforms=i||[],this.qe=o||[]}function Op(t,e,n,r,i,o){void 0===o&&(o={});var s=t.wf(o.merge||o.mergeFields?2:0,e,n,i);qp("Data must be an object, but it was:",s,r);var u,a,h=Mp(r,s);if(o.merge)u=new Es(s.qe),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],f=0,l=o.mergeFields;f<l.length;f++){var p=l[f],d=void 0;if(p instanceof Kl)d=p.j_;else{if("string"!=typeof p)throw xr();d=Gp(e,p,n)}if(!s.contains(d))throw new Qr(Xr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");zp(c,d)||c.push(d)}u=new Es(c),a=s.fieldTransforms.filter(function(t){return u.Ke(t.field)})}else u=null,a=s.fieldTransforms;return new gp(new Ks(h),u,a)}function Pp(t,o,s,e){var u=t.wf(1,o,s);qp("Data must be an object, but it was:",u,e);var a=[],h=new Ys;Br(e,function(t,e){var n,r=Gp(o,t,s),i=u._f(r);e instanceof Ql&&e.K_ instanceof Zl?a.push(r):null!=(n=Vp(e,i))&&(a.push(r),h.set(r,n))});var n=new Es(a);return new mp(h.ze(),n,u.fieldTransforms)}function Cp(t,e,n,r,i,o){var s=t.wf(1,e,n),u=[jp(e,r,n)],a=[i];if(o.length%2!=0)throw new Qr(Xr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(jp(e,o[h])),a.push(o[h+1]);for(var c,f,l,p,d=[],y=new Ys,v=u.length-1;0<=v;--v)zp(d,u[v])||(c=u[v],f=a[v],l=s._f(c),f instanceof Ql&&f.K_ instanceof Zl?d.push(c):null!=(p=Vp(f,l))&&(d.push(c),y.set(c,p)));var g=new Es(d);return new mp(y.ze(),g,s.fieldTransforms)}function Up(t,e,n,r){return void 0===r&&(r=!1),Vp(n,t.wf(r?4:3,e))}function Vp(s,t){if(Fp(s))return qp("Unsupported field value:",t,s),Mp(s,t);if(s instanceof Ql)return function(t,e){if(!Dp(e.H_))throw e.Y_(t.G_+"() can only be used with update() and set()");if(!e.path)throw e.Y_(t.G_+"() is not currently supported inside arrays");var n=t.z_(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.qe.push(t.path),s instanceof Array){if(t.settings.X_&&4!==t.H_)throw t.Y_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Vp(i[r],t.ff(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Co(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Zr.fromDate(t);return{timestampValue:Uo(e.serializer,n)}}if(t instanceof Zr){var r=new Zr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Uo(e.serializer,r)}}if(t instanceof dp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Wl)return{bytesValue:Vo(e.serializer,t)};if(t instanceof vp){var i=e.s,o=t.sf;if(!o.isEqual(i))throw e.Y_("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:Fo(t.sf||e.s,t.if.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Y_("Unsupported field value: "+Cl(t))}(s,t)}function Mp(t,r){var i={};return zr(t)?r.path&&0<r.path.length&&r.qe.push(r.path):Br(t,function(t,e){var n=Vp(e,r.uf(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function Fp(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Zr||t instanceof dp||t instanceof Wl||t instanceof vp||t instanceof Ql)}function qp(t,e,n){if(!Fp(n)||!Pl(n)){var r=Cl(n);throw"an object"===r?e.Y_(t+" a custom object"):e.Y_(t+" "+r)}}function jp(t,e,n){if(e instanceof Kl)return e.j_;if("string"==typeof e)return Gp(t,e);throw Bp("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Gp(t,e,n){try{return function(e){if(0<=e.search(Xl))throw new Qr(Xr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Yl.bind.apply(Yl,i([void 0],e.split("."))))}catch(t){throw new Qr(Xr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).j_}catch(e){throw Bp(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Bp(t,e,n,r,i){var o=r&&!r._(),s=void 0!==i,u="Function "+e+"() called with invalid data";n&&(u+=" (via `toFirestore()`)");var a="";return(o||s)&&(a+=" (found",o&&(a+=" in field "+r),s&&(a+=" in document "+i),a+=")"),new Qr(Xr.INVALID_ARGUMENT,(u+=". ")+t+a)}function zp(t,e){return t.some(function(t){return t.isEqual(e)})}var Hp=(Qp.prototype.Af=function(r){return g(this,void 0,void 0,function(){var e,n=this;return w(this,function(t){switch(t.label){case 0:if(this.Rf(),0<this.mutations.length)throw new Qr(Xr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(u,a){return g(this,void 0,void 0,function(){var i,e,n,r,o,s;return w(this,function(t){switch(t.label){case 0:return e=Ho((i=u).serializer)+"/documents",n={documents:a.map(function(t){return jo(i.serializer,t)})},[4,i.Sa("BatchGetDocuments",e,n)];case 1:return r=t.sent(),o=new Map,r.forEach(function(t){var e,n,r=(e=i.serializer,"found"in(n=t)?function(t,e){Or(!!e.found),e.found.name,e.found.updateTime;var n=Go(t,e.found.name),r=Mo(e.found.updateTime),i=new Ks({mapValue:{fields:e.found.fields}});return new ru(n,r,i,{})}(e,n):"missing"in n?function(t,e){Or(!!e.missing),Or(!!e.readTime);var n=Go(t,e.missing),r=Mo(e.readTime);return new iu(n,r)}(e,n):xr());o.set(r.key.toString(),r)}),s=[],[2,(a.forEach(function(t){var e=o.get(t.toString());Or(!!e),s.push(e)}),s)]}})})}(this.qa,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof iu||t instanceof ru?n.Pf(t):xr()}),e)]}})})},Qp.prototype.set=function(t,e){this.write(e.hf(t,this.Qe(t))),this.If.add(t.toString())},Qp.prototype.update=function(t,e){try{this.write(e.hf(t,this.gf(t)))}catch(t){this.mf=t}this.If.add(t.toString())},Qp.prototype.delete=function(t){this.write([new Hs(t,this.Qe(t))]),this.If.add(t.toString())},Qp.prototype.commit=function(){return g(this,void 0,void 0,function(){var e,r=this;return w(this,function(t){switch(t.label){case 0:if(this.Rf(),this.mf)throw this.mf;return e=this.Tf,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=ri.B(e);r.mutations.push(new Ws(n,r.Qe(n)))}),[4,function(i,o){return g(this,void 0,void 0,function(){var e,n,r;return w(this,function(t){switch(t.label){case 0:return n=Ho((e=i).serializer)+"/documents",r={writes:o.map(function(t){return Yo(e.serializer,t)})},[4,e.va("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.qa,this.mutations)];case 1:return t.sent(),this.Ef=!0,[2]}})})},Qp.prototype.Pf=function(t){var e;if(t instanceof ru)e=t.version;else{if(!(t instanceof iu))throw xr();e=Jr.min()}var n=this.Tf.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Qr(Xr.ABORTED,"Document version changed between two reads.")}else this.Tf.set(t.key.toString(),e)},Qp.prototype.Qe=function(t){var e=this.Tf.get(t.toString());return!this.If.has(t.toString())&&e?_s.updateTime(e):_s.We()},Qp.prototype.gf=function(t){var e=this.Tf.get(t.toString());if(this.If.has(t.toString())||!e)return _s.exists(!0);if(e.isEqual(Jr.min()))throw new Qr(Xr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return _s.updateTime(e)},Qp.prototype.write=function(t){this.Rf(),this.mutations=this.mutations.concat(t)},Qp.prototype.Rf=function(){},Qp),Wp=(Xp.prototype.run=function(){this.yf()},Xp.prototype.yf=function(){var t=this;this.Ti.bs(function(){return g(t,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){return e=new Hp(this.qa),(n=this.pf(e))&&n.then(function(t){r.ei.ai(function(){return e.commit().then(function(){r.ii.resolve(t)}).catch(function(t){r.bf(t)})})}).catch(function(t){r.bf(t)}),[2]})})})},Xp.prototype.pf=function(t){try{var e=this.updateFunction(t);return!li(e)&&e.catch&&e.then?e:(this.ii.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.ii.reject(t),null}},Xp.prototype.bf=function(t){var e=this;0<this.Vf&&this.vf(t)?(--this.Vf,this.ei.ai(function(){return e.yf(),Promise.resolve()})):this.ii.reject(t)},Xp.prototype.vf=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Si(e)},Xp),Kp=(Yp.prototype.start=function(t,e,n,r){var i=this;this.Df(),this.w_=t;var o=new ma,s=!1;return this.credentials.Bh(function(t){return s?void i.ei.gi(function(){return i.Bu.vc(t)}):(s=!0,Dr("FirestoreClient","Initializing. user=",t.uid),i.Cf(e,n,r,t,o).then(i.Sf.resolve,i.Sf.reject))}),this.ei.ai(function(){return i.Sf.promise}),o.promise},Yp.prototype.enableNetwork=function(){var t=this;return this.Df(),this.ei.enqueue(function(){return t.persistence.Uo(!0),t.Bu.enableNetwork()})},Yp.prototype.Cf=function(i,o,s,u,a){return g(this,void 0,void 0,function(){var e,n,r=this;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={ei:this.ei,w_:this.w_,clientId:this.clientId,credentials:this.credentials,N_:u,Qu:100,k_:s},[4,i.initialize(e)];case 1:return t.sent(),[4,o.initialize(i,e)];case 2:return t.sent(),this.persistence=i.persistence,this.Uu=i.Uu,this.La=i.La,this.S_=i.S_,this.qa=o.qa,this.Bu=o.Bu,this.fc=o.fc,this.Nf=o.q_,this.persistence.Bo(function(){return g(r,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),a.resolve(),[3,4];case 3:if(n=t.sent(),a.reject(n),!this.Ff(n))throw n;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+n),this.Cf(new pl,new yl,{F_:!1},u,a))];case 4:return[2]}})})},Yp.prototype.Ff=function(t){return"FirebaseError"===t.name?t.code===Xr.FAILED_PRECONDITION||t.code===Xr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Yp.prototype.Df=function(){if(this.ei.mi)throw new Qr(Xr.FAILED_PRECONDITION,"The client has already been terminated.")},Yp.prototype.disableNetwork=function(){var t=this;return this.Df(),this.ei.enqueue(function(){return t.persistence.Uo(!1),t.Bu.disableNetwork()})},Yp.prototype.terminate=function(){var t=this;this.ei.Pi();var r=new ma;return this.ei.Ii(function(){return g(t,void 0,void 0,function(){var e,n;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.S_&&this.S_.stop(),[4,this.Bu.th()];case 1:return t.sent(),[4,this.Uu.th()];case 2:return t.sent(),[4,this.persistence.th()];case 3:return t.sent(),this.credentials.Uh(),r.resolve(),[3,5];case 4:return e=t.sent(),n=Ga(e,"Failed to shutdown persistence"),r.reject(n),[3,5];case 5:return[2]}})})}),r.promise},Yp.prototype.waitForPendingWrites=function(){var t=this;this.Df();var e=new ma;return this.ei.ai(function(){return t.fc._l(e)}),e.promise},Yp.prototype.listen=function(t,e,n){var r=this;this.Df();var i=new El(n),o=new Of(t,i,e);return this.ei.ai(function(){return r.Nf.listen(o)}),function(){i.Q_(),r.ei.ai(function(){return r.Nf.lc(o)})}},Yp.prototype.kf=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Df(),[4,this.Sf.promise];case 1:return[2,(t.sent(),function(n,u,a){return g(this,void 0,void 0,function(){var s,e=this;return w(this,function(t){switch(t.label){case 0:return s=new ma,[4,n.enqueue(function(){return g(e,void 0,void 0,function(){var r,i,o;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=a,(n=u).persistence.runTransaction("read document","readonly",function(t){return n.Rh.Hn(t,e)}))];case 1:return(r=t.sent())instanceof ru?s.resolve(r):r instanceof iu?s.resolve(null):s.reject(new Qr(Xr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return i=t.sent(),o=Ga(i,"Failed to get document '"+a+" from cache"),s.reject(o),[3,3];case 3:return[2]}var e,n})})})];case 1:return[2,(t.sent(),s.promise)]}})})}(this.ei,this.La,e))]}})})},Yp.prototype.$f=function(u,a){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Df(),[4,this.Sf.promise];case 1:return[2,(t.sent(),e=this.ei,n=this.Nf,r=u,i=a,o=new ma,s=Zp(e,n,pu(r.path),{includeMetadataChanges:!0,$l:!0},{next:function(t){s();var e=t.docs.has(r);!e&&t.fromCache?o.reject(new Qr(Xr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&i&&"server"===i.source?o.reject(new Qr(Xr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,r,i,o,s})})},Yp.prototype.xf=function(e){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Df(),[4,this.Sf.promise];case 1:return[2,(t.sent(),function(n,a,h){return g(this,void 0,void 0,function(){var u,e=this;return w(this,function(t){switch(t.label){case 0:return u=new ma,[4,n.enqueue(function(){return g(e,void 0,void 0,function(){var e,n,r,i,o,s;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Tc(a,h,!0)];case 1:return e=t.sent(),n=new gf(h,e.gh),r=n.Su(e.documents),i=n.Un(r,!1),u.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=Ga(o,"Failed to execute query '"+h+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})}(this.ei,this.La,e))]}})})},Yp.prototype.Of=function(u,a){return g(this,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Df(),[4,this.Sf.promise];case 1:return[2,(t.sent(),e=this.ei,n=this.Nf,r=u,i=a,o=new ma,s=Zp(e,n,r,{includeMetadataChanges:!0,$l:!0},{next:function(t){s(),t.fromCache&&i&&"server"===i.source?o.reject(new Qr(Xr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):o.resolve(t)},error:function(t){return o.reject(t)}}),o.promise)]}var e,n,r,i,o,s})})},Yp.prototype.write=function(t){var e=this;this.Df();var n=new ma;return this.ei.ai(function(){return e.fc.write(t,n)}),n.promise},Yp.prototype.s=function(){return this.w_.s},Yp.prototype.bl=function(t){var e=this;this.Df();var n=new El(t);return this.ei.ai(function(){return g(e,void 0,void 0,function(){return w(this,function(t){return[2,this.Nf.bl(n)]})})}),function(){n.Q_(),e.ei.ai(function(){return g(e,void 0,void 0,function(){return w(this,function(t){return[2,this.Nf.vl(n)]})})})}},Object.defineProperty(Yp.prototype,"Mf",{get:function(){return this.ei.mi},enumerable:!1,configurable:!0}),Yp.prototype.transaction=function(t){var e=this;this.Df();var n=new ma;return this.ei.ai(function(){return new Wp(e.ei,e.qa,t,n).run(),Promise.resolve()}),n.promise},Yp);function Yp(t,e){this.credentials=t,this.ei=e,this.clientId=Pr.t(),this.Sf=new ma}function Xp(t,e,n,r){this.ei=t,this.qa=e,this.updateFunction=n,this.ii=r,this.Vf=5,this.Ti=new ba(this.ei,"transaction_retry")}function Qp(t){this.qa=t,this.Tf=new Map,this.mutations=[],this.Ef=!1,this.mf=null,this.If=new Set}function Zp(t,e,n,r,i){var o=new El(i),s=new Of(n,o,r);return t.ai(function(){return e.listen(s)}),function(){o.Q_(),t.ai(function(){return e.lc(s)})}}var Jp,$p,td=(md.prototype.Bf=function(t){switch(yo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Io(t.integerValue||t.doubleValue);case 3:return this.Uf(t.timestampValue);case 4:return this.Qf(t);case 5:return t.stringValue;case 6:return new Wl(To(t.bytesValue));case 7:return this.Wf(t.referenceValue);case 8:return this.jf(t.geoPointValue);case 9:return this.Kf(t.arrayValue);case 10:return this.Gf(t.mapValue);default:throw xr()}},md.prototype.Gf=function(t){var n=this,r={};return Br(t.fields||{},function(t,e){r[t]=n.Bf(e)}),r},md.prototype.jf=function(t){return new dp(Io(t.latitude),Io(t.longitude))},md.prototype.Kf=function(t){var e=this;return(t.values||[]).map(function(t){return e.Bf(t)})},md.prototype.Qf=function(t){switch(this.Lf){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return fo(n)?t(n):n}(t);return null==e?null:this.Bf(e);case"estimate":return this.Uf(lo(t));default:return null}},md.prototype.Uf=function(t){var e=Eo(t),n=new Zr(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},md.prototype.Wf=function(t){var e=ti.k(t);Or(ns(e));var n=new qr(e.get(1),e.get(3)),r=new ri(e.V(5));return n.isEqual(this.s)||kr("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.qf(r)},md),ed=Wa.ji,nd=(gd.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},gd),rd=(Object.defineProperty(vd.prototype,"rd",{get:function(){return this.od||(this.od=new Rp(this.sf,this.sd.ignoreUndefinedProperties)),this.od},enumerable:!1,configurable:!0}),vd.prototype.settings=function(t){Nl("Firestore.settings",arguments,1),Sl("Firestore.settings","object",1,t);var e=new nd(t);if(this.Zf&&!this.sd.isEqual(e))throw new Qr(Xr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.sd=e).credentials&&(this.nd=function(t){if(!t)return new Uc;switch(t.type){case"gapi":var e=t.hd;return Or(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Fc(e,t.zh||"0");case"provider":return t.hd;default:throw new Qr(Xr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},vd.prototype.enableNetwork=function(){return this.Xf(),this.Zf.enableNetwork()},vd.prototype.disableNetwork=function(){return this.Xf(),this.Zf.disableNetwork()},vd.prototype.enablePersistence=function(t){var e,n;if(this.Zf)throw new Qr(Xr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&kr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new Qr(Xr.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.ad(this.zf,this.Hf,{F_:!0,cacheSizeBytes:this.sd.cacheSizeBytes,synchronizeTabs:r,Vo:i})},vd.prototype.clearPersistence=function(){return g(this,void 0,void 0,function(){var n,e=this;return w(this,function(t){if(void 0!==this.Zf&&!this.Zf.Mf)throw new Qr(Xr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new ma,[2,(this.Jf.Ii(function(){return g(e,void 0,void 0,function(){var e;return w(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.zf.clearPersistence(this.sf,this.ed)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},vd.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(vd.prototype,"ud",{get:function(){return this.Xf(),this.Zf.Mf},enumerable:!1,configurable:!0}),vd.prototype.waitForPendingWrites=function(){return this.Xf(),this.Zf.waitForPendingWrites()},vd.prototype.onSnapshotsInSync=function(t){if(this.Xf(),bl(t))return this.Zf.bl(t);Sl("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.Zf.bl(e)},vd.prototype.Xf=function(){return this.Zf||this.ad(new pl,new yl,{F_:!1}),this.Zf},vd.prototype.ld=function(){return new Fr(this.sf,this.ed,this.sd.host,this.sd.ssl,this.sd.forceLongPolling)},vd.prototype.ad=function(t,e,n){var r=this.ld();return this.Zf=new Kp(this.nd,this.Jf),this.Zf.start(r,t,e,n)},vd.td=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Qr(Xr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Qr(Xr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new qr(n)},Object.defineProperty(vd.prototype,"app",{get:function(){if(!this.Yf)throw new Qr(Xr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Yf},enumerable:!1,configurable:!0}),vd.prototype.collection=function(t){return Nl("Firestore.collection",arguments,1),Sl("Firestore.collection","non-empty string",1,t),this.Xf(),new Ad(ti.k(t),this,null)},vd.prototype.doc=function(t){return Nl("Firestore.doc",arguments,1),Sl("Firestore.doc","non-empty string",1,t),this.Xf(),sd._d(ti.k(t),this,null)},vd.prototype.collectionGroup=function(t){if(Nl("Firestore.collectionGroup",arguments,1),Sl("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Qr(Xr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.Xf(),new Nd((e=t,new cu(ti.$(),e)),this,null);var e},vd.prototype.runTransaction=function(e){var n=this;return Nl("Firestore.runTransaction",arguments,1),Sl("Firestore.runTransaction","function",1,e),this.Xf().transaction(function(t){return e(new id(n,t))})},vd.prototype.batch=function(){return this.Xf(),new od(this)},Object.defineProperty(vd,"logLevel",{get:function(){switch(Sr()){case l.DEBUG:return"debug";case l.ERROR:return"error";case l.SILENT:return"silent";case l.WARN:return"warn";case l.INFO:return"info";case l.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),vd.setLogLevel=function(t){Nl("Firestore.setLogLevel",arguments,1),xl("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Ar.setLogLevel(t)},vd.prototype.fd=function(){return this.sd.timestampsInSnapshots},vd),id=(yd.prototype.get=function(t){var n=this;Nl("Transaction.get",arguments,1);var r=Od("Transaction.get",t,this.dd);return this.wd.Af([r.if]).then(function(t){if(!t||1!==t.length)return xr();var e=t[0];if(e instanceof iu)return new ad(n.dd,r.if,null,!1,!1,r.rf);if(e instanceof ru)return new ad(n.dd,r.if,e,!1,!1,r.rf);throw xr()})},yd.prototype.set=function(t,e,n){Al("Transaction.set",arguments,2,3);var r=Od("Transaction.set",t,this.dd);n=Rd("Transaction.set",n);var i=Pd(r.rf,e,n),o=Op(this.dd.rd,"Transaction.set",r.if,i,null!==r.rf,n);return this.wd.set(r.if,o),this},yd.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof Yl?(_l("Transaction.update",arguments,3),r=Od("Transaction.update",t,this.dd),Cp(this.dd.rd,"Transaction.update",r.if,e,n,o)):(Nl("Transaction.update",arguments,2),r=Od("Transaction.update",t,this.dd),Pp(this.dd.rd,"Transaction.update",r.if,e)),this.wd.update(r.if,i),this},yd.prototype.delete=function(t){Nl("Transaction.delete",arguments,1);var e=Od("Transaction.delete",t,this.dd);return this.wd.delete(e.if),this},yd),od=(dd.prototype.set=function(t,e,n){Al("WriteBatch.set",arguments,2,3),this.md();var r=Od("WriteBatch.set",t,this.dd);n=Rd("WriteBatch.set",n);var i=Pd(r.rf,e,n),o=Op(this.dd.rd,"WriteBatch.set",r.if,i,null!==r.rf,n);return this.Td=this.Td.concat(o.hf(r.if,_s.We())),this},dd.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.md(),i="string"==typeof e||e instanceof Yl?(_l("WriteBatch.update",arguments,3),r=Od("WriteBatch.update",t,this.dd),Cp(this.dd.rd,"WriteBatch.update",r.if,e,n,o)):(Nl("WriteBatch.update",arguments,2),r=Od("WriteBatch.update",t,this.dd),Pp(this.dd.rd,"WriteBatch.update",r.if,e)),this.Td=this.Td.concat(i.hf(r.if,_s.exists(!0))),this},dd.prototype.delete=function(t){Nl("WriteBatch.delete",arguments,1),this.md();var e=Od("WriteBatch.delete",t,this.dd);return this.Td=this.Td.concat(new Hs(e.if,_s.We())),this},dd.prototype.commit=function(){return this.md(),this.Ed=!0,0<this.Td.length?this.dd.Xf().write(this.Td):Promise.resolve()},dd.prototype.md=function(){if(this.Ed)throw new Qr(Xr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},dd),sd=(n(pd,$p=vp),pd._d=function(t,e,n){if(t.length%2!=0)throw new Qr(Xr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.F()+" has "+t.length);return new pd(new ri(t),e,n)},Object.defineProperty(pd.prototype,"id",{get:function(){return this.if.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"parent",{get:function(){return new Ad(this.if.path.p(),this.firestore,this.rf)},enumerable:!1,configurable:!0}),Object.defineProperty(pd.prototype,"path",{get:function(){return this.if.path.F()},enumerable:!1,configurable:!0}),pd.prototype.collection=function(t){if(Nl("DocumentReference.collection",arguments,1),Sl("DocumentReference.collection","non-empty string",1,t),!t)throw new Qr(Xr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=ti.k(t);return new Ad(this.if.path.child(e),this.firestore,null)},pd.prototype.isEqual=function(t){if(!(t instanceof pd))throw Ml("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.if.isEqual(t.if)&&this.rf===t.rf},pd.prototype.set=function(t,e){Al("DocumentReference.set",arguments,1,2),e=Rd("DocumentReference.set",e);var n=Pd(this.rf,t,e),r=Op(this.firestore.rd,"DocumentReference.set",this.if,n,null!==this.rf,e);return this.Zf.write(r.hf(this.if,_s.We()))},pd.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof Yl?(_l("DocumentReference.update",arguments,2),Cp(this.firestore.rd,"DocumentReference.update",this.if,t,e,r)):(Nl("DocumentReference.update",arguments,1),Pp(this.firestore.rd,"DocumentReference.update",this.if,t)),this.Zf.write(n.hf(this.if,_s.exists(!0)))},pd.prototype.delete=function(){return Nl("DocumentReference.delete",arguments,0),this.Zf.write([new Hs(this.if,_s.We())])},pd.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Al("DocumentReference.onSnapshot",arguments,1,4);var s={includeMetadataChanges:!1},u=0;"object"!=typeof i[u]||bl(i[u])||(Vl("DocumentReference.onSnapshot",s=i[u],["includeMetadataChanges"]),Rl("DocumentReference.onSnapshot","boolean","includeMetadataChanges",s.includeMetadataChanges),u++);var a,h={includeMetadataChanges:s.includeMetadataChanges};bl(i[u])?(a=i[u],i[u]=null===(t=a.next)||void 0===t?void 0:t.bind(a),i[u+1]=null===(e=a.error)||void 0===e?void 0:e.bind(a),i[u+2]=null===(n=a.complete)||void 0===n?void 0:n.bind(a)):(Sl("DocumentReference.onSnapshot","function",u,i[u]),Dl("DocumentReference.onSnapshot","function",u+1,i[u+1]),Dl("DocumentReference.onSnapshot","function",u+2,i[u+2]));var c={next:function(t){i[u]&&i[u](r.Id(t))},error:i[u+1],complete:i[u+2]};return this.Zf.listen(pu(this.if.path),h,c)},pd.prototype.get=function(t){var e=this;Al("DocumentReference.get",arguments,0,1),xd("DocumentReference.get",t);var n=this.firestore.Xf();return t&&"cache"===t.source?n.kf(this.if).then(function(t){return new ad(e.firestore,e.if,t,!0,t instanceof ru&&t.Ge,e.rf)}):n.$f(this.if,t).then(function(t){return e.Id(t)})},pd.prototype.withConverter=function(t){return new pd(this.if,this.firestore,t)},pd.prototype.Id=function(t){var e=t.docs.get(this.if);return new ad(this.firestore,this.if,e,t.fromCache,t.hasPendingWrites,this.rf)},pd),ud=(ld.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},ld),ad=(fd.prototype.data=function(t){var e=this;if(Al("DocumentSnapshot.data",arguments,0,1),t=Ld("DocumentSnapshot.data",t),this.Ad){if(this.rf){var n=new hd(this.dd,this.if,this.Ad,this.Rd,this.Pd,null);return this.rf.fromFirestore(n,t)}return new td(this.dd.sf,this.dd.fd(),t.serverTimestamps||"none",function(t){return new sd(t,e.dd,null)}).Bf(this.Ad.tn())}},fd.prototype.get=function(t,e){var n=this;if(Al("DocumentSnapshot.get",arguments,1,2),e=Ld("DocumentSnapshot.get",e),this.Ad){var r=this.Ad.data().field(jp("DocumentSnapshot.get",t,this.if));if(null!==r)return new td(this.dd.sf,this.dd.fd(),e.serverTimestamps||"none",function(t){return new sd(t,n.dd,n.rf)}).Bf(r)}},Object.defineProperty(fd.prototype,"id",{get:function(){return this.if.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(fd.prototype,"ref",{get:function(){return new sd(this.if,this.dd,this.rf)},enumerable:!1,configurable:!0}),Object.defineProperty(fd.prototype,"exists",{get:function(){return null!==this.Ad},enumerable:!1,configurable:!0}),Object.defineProperty(fd.prototype,"metadata",{get:function(){return new ud(this.Pd,this.Rd)},enumerable:!1,configurable:!0}),fd.prototype.isEqual=function(t){if(!(t instanceof fd))throw Ml("isEqual","DocumentSnapshot",1,t);return this.dd===t.dd&&this.Rd===t.Rd&&this.if.isEqual(t.if)&&(null===this.Ad?null===t.Ad:this.Ad.isEqual(t.Ad))&&this.rf===t.rf},fd),hd=(n(cd,Jp=ad),cd.prototype.data=function(t){return Jp.prototype.data.call(this,t)},cd);function cd(){return null!==Jp&&Jp.apply(this,arguments)||this}function fd(t,e,n,r,i,o){this.dd=t,this.if=e,this.Ad=n,this.Rd=r,this.Pd=i,this.rf=o}function ld(t,e){this.hasPendingWrites=t,this.fromCache=e}function pd(t,e,n){var r=this;return(r=$p.call(this,e.sf,t,n)||this).if=t,r.firestore=e,r.rf=n,r.Zf=r.firestore.Xf(),r}function dd(t){this.dd=t,this.Td=[],this.Ed=!1}function yd(t,e){this.dd=t,this.wd=e}function vd(t,e,n,r){var i=this;if(void 0===n&&(n=new pl),void 0===r&&(r=new yl),this.zf=n,this.Hf=r,this.Yf=null,this.Jf=new Fa,this.INTERNAL={delete:function(){return g(i,void 0,void 0,function(){return w(this,function(t){switch(t.label){case 0:return this.Xf(),[4,this.Zf.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var o=t;this.Yf=o,this.sf=vd.td(o),this.ed=o.name,this.nd=new Vc(e)}else{var s=t;if(!s.projectId)throw new Qr(Xr.INVALID_ARGUMENT,"Must provide projectId");this.sf=new qr(s.projectId,s.database),this.ed="[DEFAULT]",this.nd=new Uc}this.sd=new nd({})}function gd(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new Qr(Xr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else kl("settings","non-empty string","host",t.host),this.host=t.host,Rl("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(Vl("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),Rl("settings","object","credentials",t.credentials),this.credentials=t.credentials,Rl("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),Rl("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?kr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&kr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,Rl("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Wa.Gi;else{if(t.cacheSizeBytes!==ed&&t.cacheSizeBytes<Wa.Ki)throw new Qr(Xr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Wa.Ki);this.cacheSizeBytes=t.cacheSizeBytes}Rl("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}function md(t,e,n,r){this.s=t,this.timestampsInSnapshots=e,this.Lf=n,this.qf=r}function wd(t,e,n){if("string"==typeof n){if(""===n)throw new Qr(Xr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!du(e)&&-1!==n.indexOf("/"))throw new Qr(Xr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(ti.k(n));if(!ri.j(r))throw new Qr(Xr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return No(t,new ri(r))}if(n instanceof vp)return No(t,n.if);throw new Qr(Xr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Cl(n)+".")}function bd(t,e){if(!Array.isArray(t)||0===t.length)throw new Qr(Xr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Qr(Xr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new Qr(Xr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Qr(Xr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function Ed(t,e,n){if(!n.isEqual(e))throw new Qr(Xr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Id(t){if(t.cn()&&0===t.en.length)throw new Qr(Xr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Td,Nd=(kd.prototype.where=function(t,e,n){var r;Nl("Query.where",arguments,3),Ul("Query.where",3,n),r="not-in"===e||"!="===e?e:xl("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e);var i,o,s=jp("Query.where",t),u=function(t,e,n,r,i,o){var s;if(r.M()){if("array-contains"===i||"array-contains-any"===i)throw new Qr(Xr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){bd(o,i);for(var u=[],a=0,h=o;a<h.length;a++){var c=h[a];u.push(wd(n,t,c))}s={arrayValue:{values:u}}}else s=wd(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||bd(o,i),s=Up(e,"Query.where",o,"in"===i||"not-in"===i);var f=Au.create(r,i,s);return function(t,e){if(e._n()){var n=t.ln();if(null!==n&&!n.isEqual(e.field))throw new Qr(Xr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=t.un();null!==r&&Ed(0,e.field,r)}var i=t.fn(function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==i)throw i===e.op?new Qr(Xr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Qr(Xr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(this.gd,this.firestore.rd,this.firestore.sf,s,r,n);return new kd((o=(i=this.gd).filters.concat([u]),new cu(i.path,i.collectionGroup,i.en.slice(),o,i.limit,i.nn,i.startAt,i.endAt)),this.firestore,this.rf)},kd.prototype.orderBy=function(t,e){var n;if(Al("Query.orderBy",arguments,1,2),Dl("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Qr(Xr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var r,i,o=jp("Query.orderBy",t),s=function(t,e,n){if(null!==t.startAt)throw new Qr(Xr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Qr(Xr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r,i,o=new ta(e,n),s=o;return null!==(r=t).un()||null!==(i=r.ln())&&Ed(0,i,s.field),o}(this.gd,o,n);return new kd((i=(r=this.gd).en.concat([s]),new cu(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.nn,r.startAt,r.endAt)),this.firestore,this.rf)},kd.prototype.limit=function(t){return Nl("Query.limit",arguments,1),Sl("Query.limit","number",1,t),Fl("Query.limit",1,t),new kd(gu(this.gd,t,"F"),this.firestore,this.rf)},kd.prototype.limitToLast=function(t){return Nl("Query.limitToLast",arguments,1),Sl("Query.limitToLast","number",1,t),Fl("Query.limitToLast",1,t),new kd(gu(this.gd,t,"L"),this.firestore,this.rf)},kd.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];_l("Query.startAt",arguments,1);var r=this.Vd("Query.startAt",t,e,!0);return new kd(mu(this.gd,r),this.firestore,this.rf)},kd.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];_l("Query.startAfter",arguments,1);var r=this.Vd("Query.startAfter",t,e,!1);return new kd(mu(this.gd,r),this.firestore,this.rf)},kd.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];_l("Query.endBefore",arguments,1);var r=this.Vd("Query.endBefore",t,e,!0);return new kd(wu(this.gd,r),this.firestore,this.rf)},kd.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];_l("Query.endAt",arguments,1);var r=this.Vd("Query.endAt",t,e,!1);return new kd(wu(this.gd,r),this.firestore,this.rf)},kd.prototype.isEqual=function(t){if(!(t instanceof kd))throw Ml("isEqual","Query",1,t);return this.firestore===t.firestore&&bu(this.gd,t.gd)&&this.rf===t.rf},kd.prototype.withConverter=function(t){return new kd(this.gd,this.firestore,t)},kd.prototype.Vd=function(c,t,e,n){if(Ul(c,1,t),t instanceof ad)return Nl(c,i([t],e),1),function(t,e,n,r){if(!n)throw new Qr(Xr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=yu(t);o<s.length;o++){var u=s[o];if(u.field.M())i.push(No(e,n.key));else{var a=n.field(u.field);if(fo(a))throw new Qr(Xr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){var h=u.field.F();throw new Qr(Xr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}i.push(a)}}return new Wu(i,r)}(this.gd,this.firestore.sf,t.Ad,n);var r=[t].concat(e);return function(t,e,n,r,i,o){var s=t.en;if(i.length>s.length)throw new Qr(Xr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.M()){if("string"!=typeof h)throw new Qr(Xr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!du(t)&&-1!==h.indexOf("/"))throw new Qr(Xr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(ti.k(h));if(!ri.j(c))throw new Qr(Xr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");var f=new ri(c);u.push(No(e,f))}else{var l=Up(n,r,h);u.push(l)}}return new Wu(u,o)}(this.gd,this.firestore.sf,this.firestore.rd,c,r,n)},kd.prototype.onSnapshot=function(){for(var t,e,n,r=this,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];Al("Query.onSnapshot",arguments,1,4);var s,u={},a=0;"object"!=typeof i[a]||bl(i[a])||(Vl("Query.onSnapshot",u=i[a],["includeMetadataChanges"]),Rl("Query.onSnapshot","boolean","includeMetadataChanges",u.includeMetadataChanges),a++),bl(i[a])?(s=i[a],i[a]=null===(t=s.next)||void 0===t?void 0:t.bind(s),i[a+1]=null===(e=s.error)||void 0===e?void 0:e.bind(s),i[a+2]=null===(n=s.complete)||void 0===n?void 0:n.bind(s)):(Sl("Query.onSnapshot","function",a,i[a]),Dl("Query.onSnapshot","function",a+1,i[a+1]),Dl("Query.onSnapshot","function",a+2,i[a+2]));var h={next:function(t){i[a]&&i[a](new _d(r.firestore,r.gd,t,r.rf))},error:i[a+1],complete:i[a+2]};return Id(this.gd),this.firestore.Xf().listen(this.gd,u,h)},kd.prototype.get=function(t){var e=this;Al("Query.get",arguments,0,1),xd("Query.get",t),Id(this.gd);var n=this.firestore.Xf();return(t&&"cache"===t.source?n.xf(this.gd):n.Of(this.gd,t)).then(function(t){return new _d(e.firestore,e.gd,t,e.rf)})},kd),_d=(Object.defineProperty(Dd.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Dd.prototype,"empty",{get:function(){return this.pd.docs._()},enumerable:!1,configurable:!0}),Object.defineProperty(Dd.prototype,"size",{get:function(){return this.pd.docs.size},enumerable:!1,configurable:!0}),Dd.prototype.forEach=function(e,n){var r=this;Al("QuerySnapshot.forEach",arguments,1,2),Sl("QuerySnapshot.forEach","function",1,e),this.pd.docs.forEach(function(t){e.call(n,r.Sd(t,r.metadata.fromCache,r.pd.qt.has(t.key)))})},Object.defineProperty(Dd.prototype,"query",{get:function(){return new Nd(this.yd,this.dd,this.rf)},enumerable:!1,configurable:!0}),Dd.prototype.docChanges=function(t){t&&(Vl("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Rl("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.pd.Ut)throw new Qr(Xr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.bd&&this.vd===e||(this.bd=function(i,e,o){if(i.Lt._()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Lt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.qt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return xr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.pd,e,this.Sd.bind(this)),this.vd=e),this.bd},Dd.prototype.isEqual=function(t){if(!(t instanceof Dd))throw Ml("isEqual","QuerySnapshot",1,t);return this.dd===t.dd&&bu(this.yd,t.yd)&&this.pd.isEqual(t.pd)&&this.rf===t.rf},Dd.prototype.Sd=function(t,e,n){return new hd(this.dd,t.key,t,e,n,this.rf)},Dd),Ad=(n(Sd,Td=Nd),Object.defineProperty(Sd.prototype,"id",{get:function(){return this.gd.path.S()},enumerable:!1,configurable:!0}),Object.defineProperty(Sd.prototype,"parent",{get:function(){var t=this.gd.path.p();return t._()?null:new sd(new ri(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Sd.prototype,"path",{get:function(){return this.gd.path.F()},enumerable:!1,configurable:!0}),Sd.prototype.doc=function(t){Al("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Pr.t()),Sl("CollectionReference.doc","non-empty string",1,t);var e=ti.k(t);return sd._d(this.gd.path.child(e),this.firestore,this.rf)},Sd.prototype.add=function(t){Nl("CollectionReference.add",arguments,1),Sl("CollectionReference.add","object",1,this.rf?this.rf.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},Sd.prototype.withConverter=function(t){return new Sd(this.Dd,this.firestore,t)},Sd);function Sd(t,e,n){var r=this;if(((r=Td.call(this,pu(t),e,n)||this).Dd=t).length%2!=1)throw new Qr(Xr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.F()+" has "+t.length);return r}function Dd(t,e,n,r){this.dd=t,this.yd=e,this.pd=n,this.rf=r,this.bd=null,this.vd=null,this.metadata=new ud(n.hasPendingWrites,n.fromCache)}function kd(t,e,n){this.gd=t,this.firestore=e,this.rf=n}function Rd(t,e){if(void 0===e)return{merge:!1};if(Vl(t,e,["merge","mergeFields"]),Rl(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Qr(Xr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Cl(n));for(var r,i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof Yl))throw new Qr(Xr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+Cl(n[i]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Qr(Xr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function Ld(t,e){return void 0===e?{}:(Vl(t,e,["serverTimestamps"]),Ll(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function xd(t,e){Dl(t,"object",1,e),e&&(Vl(t,e,["source"]),Ll(t,0,"source",e.source,["default","server","cache"]))}function Od(t,e,n){if(e instanceof vp){if(e.firestore!==n)throw new Qr(Xr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Ml(t,"DocumentReference",1,e)}function Pd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Cd,Ud={Firestore:rd,GeoPoint:dp,Timestamp:Zr,Blob:Wl,Transaction:id,WriteBatch:od,DocumentReference:sd,DocumentSnapshot:ad,Query:Nd,QueryDocumentSnapshot:hd,QuerySnapshot:_d,CollectionReference:Ad,FieldPath:Yl,FieldValue:lp,setLogLevel:rd.setLogLevel,CACHE_SIZE_UNLIMITED:ed};(Cd=Vd).INTERNAL.registerComponent(new Nr("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),r=new yl,i=new dl(r),new rd(e,n,i,r);var e,n,r,i},"PUBLIC").setServiceProps(Object.assign({},Ud))),Cd.registerVersion("@firebase/firestore","1.16.5")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Ly){"use strict";try{(function(){var f,t,e=(t=Ly)&&"object"==typeof t&&"default"in t?t:{default:t},r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(be=f=f||{})[be.DEBUG=0]="DEBUG",be[be.VERBOSE=1]="VERBOSE",be[be.INFO=2]="INFO",be[be.WARN=3]="WARN",be[be.ERROR=4]="ERROR",be[be.SILENT=5]="SILENT";var u={debug:f.DEBUG,verbose:f.VERBOSE,info:f.INFO,warn:f.WARN,error:f.ERROR,silent:f.SILENT},a=f.INFO,c=((Ee={})[f.DEBUG]="log",Ee[f.VERBOSE]="log",Ee[f.INFO]="info",Ee[f.WARN]="warn",Ee[f.ERROR]="error",Ee),h=(Object.defineProperty(l.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in f))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),l.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?u[t]:t},Object.defineProperty(l.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),l.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.DEBUG],t)),this._logHandler.apply(this,s([this,f.DEBUG],t))},l.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.VERBOSE],t)),this._logHandler.apply(this,s([this,f.VERBOSE],t))},l.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.INFO],t)),this._logHandler.apply(this,s([this,f.INFO],t))},l.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.WARN],t)),this._logHandler.apply(this,s([this,f.WARN],t))},l.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.ERROR],t)),this._logHandler.apply(this,s([this,f.ERROR],t))},l);function l(t){this.name=t,this._logLevel=a,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e){return(e=d.call(this,e)||this).code=t,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,t=(t=this.errors[t])?(r=i,t.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").",s=new m(o,t),u=0,a=Object.keys(i);u<a.length;u++){var c=a[u];"_"!==c.slice(-1)&&(c in s&&console.warn('Overwriting FirebaseError base field "'+c+'" can cause unexpected behavior.'),s[c]=i[c])}return s},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function _(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S=N||self;function x(){}function R(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function D(t){var e=R(t);return"array"==e||"object"==e&&"number"==typeof t.length}function O(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),k=0;function L(t,e,n){return t.call.apply(t.bind,arguments)}function C(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function U(t,e,n){return(U=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?L:C).apply(null,arguments)}function M(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var V=Date.now;function j(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,P)&&this[P]||(this[P]=++k))},F.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var q=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function G(){return Array.prototype.concat.apply([],arguments)}function W(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function z(t){return/^[\s\xa0]*$/.test(t)}var Q,K=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function H(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}var Y=S.navigator;function J(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function $(t){var e,n={};for(e in t)n[e]=t[e];return n}Q=(Y=Y&&Y.userAgent)?Y:"";var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<Z.length;i++)e=Z[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function et(t){return et[" "](t),t}et[" "]=x;var nt,rt=H(Q,"Opera"),it=H(Q,"Trident")||H(Q,"MSIE"),ot=H(Q,"Edge"),st=ot||it,ut=H(Q,"Gecko")&&!(H(Q.toLowerCase(),"webkit")&&!H(Q,"Edge"))&&!(H(Q,"Trident")||H(Q,"MSIE"))&&!H(Q,"Edge"),at=H(Q.toLowerCase(),"webkit")&&!H(Q,"Edge");function ct(){var t=S.document;return t?t.documentMode:void 0}var ht="",lt=(lt=Q,ut?/rv:([^\);]+)(\)|;)/.exec(lt):ot?/Edge\/([\d\.]+)/.exec(lt):it?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(lt):at?/WebKit\/(\S+)/.exec(lt):rt?/(?:Version)[ \/]?(\S+)/.exec(lt):void 0);lt&&(ht=lt?lt[1]:""),nt=it&&null!=(lt=ct())&&lt>parseFloat(ht)?String(lt):ht;var ft={};function pt(u){return t=u,e=function(){for(var t=0,e=K(String(nt)).split("."),n=K(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=ft,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var dt=S.document&&it&&(ct()||parseInt(nt,10))||void 0,yt=!it||9<=Number(dt),vt=it&&!pt("9"),gt=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",x,e),S.removeEventListener("test",x,e)}catch(t){}return t}();function mt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function wt(t,e){if(mt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ut){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:bt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}mt.prototype.b=function(){this.defaultPrevented=!0},j(wt,mt);var bt={2:"touch",3:"pen",4:"mouse"};wt.prototype.b=function(){wt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,vt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Et="closure_listenable_"+(1e6*Math.random()|0),It=0;function Tt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++It,this.Y=this.Z=!1}function _t(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function At(t){this.src=t,this.a={},this.b=0}function Nt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=q(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(_t(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function St(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}At.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=St(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Tt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var xt="closure_lm_"+(1e6*Math.random()|0),Rt={};function Dt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Vt(r),e&&e[Et]?e.wa(n,r,O(i)?!!i.capture:!!i,o):Ot(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Dt(t,e[o],n,r,i);return null}return n=Vt(n),t&&t[Et]?t.va(e,n,O(r)?!!r.capture:!!r,i):Ot(t,e,n,!1,r,i)}function Ot(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=O(i)?!!i.capture:!!i;if(s&&!yt)return null;var u,a,c=Ut(t);if(c||(t[xt]=c=new At(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Ct,r=a=yt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)gt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(kt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Pt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Et]?Nt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(kt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ut(e))?(Nt(n,t),0==n.b&&(n.src=null,e[xt]=null)):_t(t)))}function kt(t){return t in Rt?Rt[t]:Rt[t]="on"+t}function Lt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Pt(t),n.call(r,e)}function Ct(t,e){if(t.Y)return!0;if(yt)return Lt(t,new wt(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Lt(t,e=new wt(e,this))}function Ut(t){return(t=t[xt])instanceof At?t:null}var Mt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Vt(e){return"function"==R(e)?e:(e[Mt]||(e[Mt]=function(t){return e.handleEvent(t)}),e[Mt])}function jt(){F.call(this),this.c=new At(this),(this.J=this).C=null}function Ft(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Nt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}j(jt,F),jt.prototype[Et]=!0,(A=jt.prototype).addEventListener=function(t,e,n,r){Dt(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=O(i)?!!i.capture:!!i,r=Vt(r),e&&e[Et]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=St(s=e.a[n],r,i,o))&&(_t(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ut(e))&&(n=e.a[n.toString()],e=-1,n&&(e=St(n,r,i,o)),(r=-1<e?n[e]:null)&&Pt(r))}(this,t,e,n,r)},A.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new mt(t,n):t instanceof mt?t.target=t.target||n:(s=t,tt(t=new mt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=Ft(o,r,!0,t)&&s;if(s=Ft(o=t.a=n,r,!0,t)&&s,s=Ft(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Ft(o=t.a=e[i],r,!1,t)&&s;return s},A.G=function(){if(jt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)_t(n[r]);delete e.a[t],e.b--}}this.C=null},A.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var qt=S.JSON.stringify;function Bt(){this.b=this.a=null}var Gt,Wt=(zt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new zt(function(){return new Qt},function(t){t.reset()},100));function zt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Qt(){this.next=this.b=this.a=null}function Kt(t,e){var n;Gt||(n=S.Promise.resolve(void 0),Gt=function(){n.then(Yt)}),Ht||(Gt(),Ht=!0),Xt.add(t,e)}Bt.prototype.add=function(t,e){var n=Wt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Qt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Ht=!(Qt.prototype.reset=function(){this.next=this.b=this.a=null}),Xt=new Bt;function Yt(){for(var t,e;n=e=void 0,n=null,(e=Xt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var n=Wt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Ht=!1}function Jt(t,e){jt.call(this),this.b=t||1,this.a=e||S,this.f=U(this.Ya,this),this.g=V()}function $t(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Zt(t,e,n){if("function"==R(t))n&&(t=U(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=U(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}j(Jt,jt),(A=Jt.prototype).aa=!1,A.M=null,A.Ya=function(){var t;this.aa&&(0<(t=V()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&($t(this),this.start())))},A.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=V())},A.G=function(){Jt.S.G.call(this),$t(this),delete this.a};var te,ee,ne,re=(T(ee=oe,ne=te=F),ee.prototype=null===ne?Object.create(ne):(ie.prototype=ne.prototype,new ie),oe.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=Zt(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},oe.prototype.G=function(){te.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},oe);function ie(){this.constructor=ee}function oe(t,e,n){var r=te.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function se(t){F.call(this),this.b=t,this.a={}}j(se,F);var ue=[];function ae(t,e,n,r){Array.isArray(n)||(n&&(ue[0]=n.toString()),n=ue);for(var i=0;i<n.length;i++){var o=Dt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ce(t){J(t.a,function(t,e){this.a.hasOwnProperty(e)&&Pt(t)},t),t.a={}}function he(){this.a=!0}function le(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return qt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}se.prototype.G=function(){se.S.G.call(this),ce(this)},se.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},he.prototype.info=function(){};var fe=null;function pe(){return fe=fe||new jt}function de(t){mt.call(this,"serverreachability",t)}function ye(){var t=pe();t.dispatchEvent(new de(t))}function ve(t){mt.call(this,"statevent",t)}function ge(){var t=pe();t.dispatchEvent(new ve(t))}function me(t){mt.call(this,"timingevent",t)}function we(t,e){if("function"!=R(t))throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}j(de,mt),j(ve,mt),j(me,mt);var be={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ee={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Ie(){}function Te(t){var e;return(e=t.a)||(e=t.a={}),e}function _e(){}Ie.prototype.a=null;var Ae,N={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Ne(){mt.call(this,"d")}function Se(){mt.call(this,"c")}function xe(){}function Re(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new se(this),this.P=De,t=st?125:void 0,this.R=new Jt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}j(Ne,mt),j(Se,mt),j(xe,Ie),Ae=new xe;var De=45e3,Oe={},Pe={};function ke(t,e,n){t.H=1,t.i=tn(He(e)),t.j=n,t.I=!0,Le(t,null)}function Le(t,e){t.u=V(),Ue(t),t.l=He(t.i);var s,u,a,c,h,l,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),dn(n.b,"t",r),t.D=0,t.a=ur(t.g,t.g.C?e:null),0<t.O&&(t.F=new re(U(t.Ca,t,t.a),t.O)),ae(t.J,t.a,"readystatechange",t.Wa),e=t.B?$(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ye(),s=t.c,u=t.m,a=t.l,c=t.f,h=t.T,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Ce(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Pe:(i=Number(u.substring(i,o)),isNaN(i)?Oe:(o+=1)+i>u.length?Pe:(u=u.substr(o,i),r.D=o+i,u)));if(u==Pe){4==e&&(t.h=4,ge(),s=!1),le(t.c,t.f,null,"[Incomplete Response]");break}if(u==Oe){t.h=4,ge(),le(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}le(t.c,t.f,u,null),qe(t,u)}4==e&&0==n.length&&(t.h=1,ge(),s=!1),t.b=t.b&&s,s?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Zn(e),e.F=!0)):(le(t.c,t.f,n,"[Invalid Chunked Response]"),Fe(t),je(t))}function Ue(t){t.U=V()+t.P,Me(t,t.P)}function Me(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=we(U(t.Ua,t),e)}function Ve(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function je(t){0==t.g.v||t.A||nr(t.g,t)}function Fe(t){Ve(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,$t(t.R),ce(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function qe(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||En(u.b,t)))if(u.I=t.N,!t.C&&En(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;er(u),Wn(u)}$n(u),ge()}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=we(U(u.Ra,u),6e3));if(bn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else ir(u,11)}else if(!t.C&&u.a!=t||er(u),!z(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(H(r,"spdy")||H(r,"quic")||H(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(In(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,Ze(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.V&&(u.N=V()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=sr(n,n.C?n.ga:null,n.fa),i.C?(Tn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Ve(o),Ue(o)),n.a=i):Jn(n),0<u.g.length&&Kn(u)):"stop"!=c[0]&&"close"!=c[0]||ir(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?ir(u,7):Gn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0);ye()}catch(t){}}function Be(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(D(t)||"string"==typeof t)B(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(D(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(D(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ge(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ge)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function We(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];ze(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)ze(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function ze(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=Re.prototype).setTimeout=function(t){this.P=t},A.Wa=function(t){t=t.target;var e=this.F;e&&3==jn(t)?e.f():this.Ca(t)},A.Ca=function(t){try{if(t==this.a)t:{var e=jn(this.a),n=this.a.ua(),r=this.a.X();if(!(e<3||3==e&&!st&&!this.a.$())){this.A||4!=e||7==n||ye(),Ve(this);var i=this.a.X();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.T,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.V&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,ge(),Fe(this),je(this);break t}le(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,qe(this,s)}this.I?(Ce(this,e,n),st&&this.b&&3==e&&(ae(this.J,this.R,"tick",this.Va),this.R.start())):(le(this.c,this.f,n,null),qe(this,n)),4==e&&Fe(this),this.b&&!this.A&&(4==e?nr(this.g,this):(this.b=!1,Ue(this)))}else 400==i&&0<n.indexOf("Unknown SID")?this.h=3:this.h=0,ge(),Fe(this),je(this)}}}catch(t){}var u,a,c,h,l,f},A.Va=function(){var t,e;this.a&&(t=jn(this.a),e=this.a.$(),this.D<e.length&&(Ve(this),Ce(this,t,e),this.b&&4!=t&&Ue(this)))},A.cancel=function(){this.A=!0,Fe(this)},A.Ua=function(){this.o=null;var t,e,n=V();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ye(),ge()),Fe(this),this.h=2,je(this)):Me(this,this.U-n)},(A=Ge.prototype).K=function(){We(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.L=function(){return We(this),this.a.concat()},A.get=function(t,e){return ze(this.b,t)?this.b[t]:e},A.set=function(t,e){ze(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Qe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ke(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ke?(this.a=void 0!==e?e:t.a,Xe(this,t.f),this.j=t.j,Ye(this,t.c),Je(this,t.h),this.g=t.g,e=t.b,(n=new hn).c=e.c,e.a&&(n.a=new Ge(e.a),n.b=e.b),$e(this,n),this.i=t.i):t&&(n=String(t).match(Qe))?(this.a=!!e,Xe(this,n[1]||"",!0),this.j=en(n[2]||""),Ye(this,n[3]||"",!0),Je(this,n[4]),this.g=en(n[5]||"",!0),$e(this,n[6]||"",!0),this.i=en(n[7]||"")):(this.a=!!e,this.b=new hn(null,this.a))}function He(t){return new Ke(t)}function Xe(t,e,n){t.f=n?en(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ye(t,e,n){t.c=n?en(e,!0):e}function Je(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function $e(t,e,n){var r,i;e instanceof hn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(ln(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(fn(this,e),dn(this,n,t))},r)),r.f=i):(n||(e=nn(e,an)),t.b=new hn(e,t.a))}function Ze(t,e,n){t.b.set(e,n)}function tn(t){return Ze(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^V()).toString(36)),t}function en(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function nn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,rn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function rn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ke.prototype.toString=function(){var t=[],e=this.f;e&&t.push(nn(e,on,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(nn(e,on,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(nn(n,"/"==n.charAt(0)?un:sn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",nn(n,cn)),t.join("")};var on=/[#\/\?@]/g,sn=/[#\?:]/g,un=/[#\?]/g,an=/[#\?@]/g,cn=/#/g;function hn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function ln(u){u.a||(u.a=new Ge,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function fn(t,e){ln(t),e=yn(t,e),ze(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,ze((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&We(t)))}function pn(t,e){return ln(t),e=yn(t,e),ze(t.a.b,e)}function dn(t,e,n){fn(t,e),0<n.length&&(t.c=null,t.a.set(yn(t,e),W(n)),t.b+=n.length)}function yn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function vn(t,e){this.b=t,this.a=e}function gn(t){this.g=t||mn,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(A=hn.prototype).add=function(t,e){ln(this),this.c=null,t=yn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){ln(this),this.a.forEach(function(t,e){B(t,function(t){n.call(r,t,e,this)},this)},this)},A.L=function(){ln(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.K=function(t){ln(this);var e=[];if("string"==typeof t)pn(this,t)&&(e=G(e,this.a.get(yn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},A.set=function(t,e){return ln(this),this.c=null,pn(this,t=yn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var mn=10;function wn(t){return t.b||t.a&&t.a.size>=t.f}function bn(t){return t.b?1:t.a?t.a.size:0}function En(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function In(t,e){t.a?t.a.add(e):t.b=e}function Tn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function _n(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return W(t.c);var r=t.c;try{for(var i=_(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function An(){}function Nn(){this.a=new An}function Sn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}gn.prototype.cancel=function(){var t,e;if(this.c=_n(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=_(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},An.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},An.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var xn=S.JSON.parse;function Rn(t){jt.call(this),this.headers=new Ge,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Dn,this.D=this.F=!1}j(Rn,jt);var Dn="",On=/^https?$/i,Pn=["POST","PUT"];function kn(t){return"content-type"==t.toLowerCase()}function Ln(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Cn(t),Mn(t)}function Cn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Un(t){if(t.b&&(!t.s[1]||4!=jn(t)||2!=t.X()))if(t.l&&4==jn(t))Zt(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==jn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Qe)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!On.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<jn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Cn(t)}}finally{Mn(t)}}}function Mn(t,e){if(t.a){Vn(t);var n=t.a,r=t.s[0]?x:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Vn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function jn(t){return t.a?t.a.readyState:0}function Fn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",J(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ze(t,e,n))}function qn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Bn(t){this.pa=0,this.g=[],this.c=new he,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=qn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=qn("baseRetryDelayMs",5e3,t),this.Ma=qn("retryDelaySeedMs",1e4,t),this.Ja=qn("forwardChannelMaxRetries",2,t),this.ma=qn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new gn(t&&t.concurrentRequestLimit),this.ka=new Nn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Gn(t){var e,n;zn(t),3==t.v&&(e=t.R++,Ze(n=He(t.B),"SID",t.J),Ze(n,"RID",e),Ze(n,"TYPE","terminate"),Xn(t,n),(e=new Re(t,t.c,e,void 0)).H=2,e.i=tn(He(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.i.toString(),"")),!n&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=ur(e.g,null),e.a.ba(e.i)),e.u=V(),Ue(e)),or(t)}function Wn(t){t.a&&(Zn(t),t.a.cancel(),t.a=null)}function zn(t){Wn(t),t.j&&(S.clearTimeout(t.j),t.j=null),er(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function Qn(t,e){t.g.push(new vn(t.La++,e)),3==t.v&&Kn(t)}function Kn(t){wn(t.b)||t.h||(t.h=!0,Kt(t.Ba,t),t.u=0)}function Hn(t,e){var n=e?e.f:t.R++,r=He(t.B);Ze(r,"SID",t.J),Ze(r,"RID",n),Ze(r,"AID",t.P),Xn(t,r),t.i&&t.l&&Fn(r,t.i,t.l),n=new Re(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Yn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),In(t.b,n),ke(n,r,e)}function Xn(t,n){t.f&&Be({},function(t,e){Ze(n,e,t)})}function Yn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?U(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+c+"_"||"";try{Be(t,function(t,e){var n=t;O(t)&&(n=qt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s)}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Jn(t){t.a||t.j||(t.U=1,Kt(t.Aa,t),t.o=0)}function $n(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=we(U(t.Aa,t),rr(t,t.o)),t.o++,1)}function Zn(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function tr(t){t.a=new Re(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=He(t.la);Ze(e,"RID","rpc"),Ze(e,"SID",t.J),Ze(e,"CI",t.H?"0":"1"),Ze(e,"AID",t.P),Xn(t,e),Ze(e,"TYPE","xmlhttp"),t.i&&t.l&&Fn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=tn(He(e)),n.j=null,n.I=!0,Le(n,t)}function er(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function nr(t,e){var n,r=null;if(t.a==e){er(t),Zn(t),t.a=null;var i=2}else{if(!En(t.b,e))return;r=e.s,Tn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b)1==i?(r=e.j?e.j.length:0,e=V()-e.u,n=t.u,(i=pe()).dispatchEvent(new me(i)),Kn(t)):Jn(t);else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(bn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=we(U(t.Ba,t,e),rr(t,t.u)),t.u++,1}}(t,e)||2==i&&$n(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:ir(t,5);break;case 4:ir(t,10);break;case 3:ir(t,6);break;default:ir(t,2)}}function rr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function ir(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=U(t.Xa,t),r||(r=new Ke("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||Xe(r,"https"),tn(r)),n=r.toString(),r=o,o=new he,S.Image?((i=new Image).onload=M(Sn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=M(Sn,o,i,"TestLoadImage: error",!1,r),i.onabort=M(Sn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=M(Sn,o,i,"TestLoadImage: timeout",!1,r),S.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):ge(),t.v=0,t.f&&t.f.ra(e),or(t),zn(t)}function or(t){t.v=0,t.I=-1,t.f&&(0==_n(t.b).length&&0==t.g.length||(t.b.c.length=0,W(t.g),t.g.length=0),t.f.qa())}function sr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Ke?He(s):new Ke(s,void 0);return""!=a.c?(e&&Ye(a,e+"."+a.c),Je(a,a.h)):(r=(u=S.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Ke(null,void 0),r&&Xe(u,r),i&&Ye(u,i),o&&Je(u,o),s&&(u.g=s),a=u),t.W&&J(t.W,function(t,e){Ze(a,e,t)}),e=t.A,n=t.na,e&&n&&Ze(a,e,n),Ze(a,"VER",t.ha),Xn(t,a),a}function ur(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Rn(t.Ka)).F=t.C,e}function ar(){}function cr(){if(it&&!(10<=Number(dt)))throw Error("Environmental error: no available transport.")}function hr(t,e){jt.call(this),this.a=new Bn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!z(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!z(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new pr(this)}function lr(t){Ne.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function fr(){Se.call(this),this.status=1}function pr(t){this.a=t}(A=Rn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Te(this.H):Te(Ae),this.a.onreadystatechange=U(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Ln(this,t)}t=n||"";var i,o=new Ge(this.headers);r&&Be(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=kn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=q(Pn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Vn(this),0<this.o&&((this.D=(i=this.a,it&&pt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=U(this.xa,this)):this.m=Zt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Ln(this,t)}},A.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Mn(this))},A.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Mn(this,!0)),Rn.S.G.call(this)},A.za=function(){this.j||(this.A||this.l||this.g?Un(this):this.Ta())},A.Ta=function(){Un(this)},A.X=function(){try{return 2<jn(this)?this.a.status:-1}catch(t){return-1}},A.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),xn(e)}},A.ua=function(){return this.h},A.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=Bn.prototype).ha=8,A.v=1,A.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Re(this,this.c,t,void 0),r=this.l;if(this.O&&(r?tt(r=$(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Yn(this,n,e),Ze(i=He(this.B),"RID",t),Ze(i,"CVER",22),this.A&&Ze(i,"X-HTTP-Session-Id",this.A),Xn(this,i),this.i&&r&&Fn(i,this.i,r),In(this.b,n),this.Ga&&Ze(i,"TYPE","init"),this.da?(Ze(i,"$req",e),Ze(i,"SID","null"),n.V=!0,ke(n,i,null)):ke(n,i,e),this.v=2}}else 3==this.v&&(t?Hn(this,t):0==this.g.length||wn(this.b)||Hn(this))},A.Aa=function(){var t;this.j=null,tr(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=we(U(this.Sa,this),t))},A.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Wn(this),tr(this))},A.Ra=function(){null!=this.m&&(this.m=null,Wn(this),$n(this),ge())},A.Xa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),ge()},(A=ar.prototype).ta=function(){},A.sa=function(){},A.ra=function(){},A.qa=function(){},A.Ha=function(){},cr.prototype.a=function(t,e){return new hr(t,e)},j(hr,jt),(A=hr.prototype).addEventListener=function(t,e,n,r){hr.S.addEventListener.call(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){hr.S.removeEventListener.call(this,t,e,n,r)},A.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;ge(),t.fa=e,t.W=n||{},t.H=t.T,t.B=sr(t,null,t.fa),Kn(t)},A.close=function(){Gn(this.a)},A.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Qn(this.a,e)):this.g?((e={}).__data__=qt(t),Qn(this.a,e)):Qn(this.a,t)},A.G=function(){this.a.f=null,delete this.f,Gn(this.a),delete this.a,hr.S.G.call(this)},j(lr,Ne),j(fr,Se),j(pr,ar),pr.prototype.ta=function(){this.a.dispatchEvent("a")},pr.prototype.sa=function(t){this.a.dispatchEvent(new lr(t))},pr.prototype.ra=function(t){this.a.dispatchEvent(new fr)},pr.prototype.qa=function(){this.a.dispatchEvent("b")},cr.prototype.createWebChannel=cr.prototype.a,hr.prototype.send=hr.prototype.Pa,hr.prototype.open=hr.prototype.Oa,be.NO_ERROR=0,be.TIMEOUT=8,be.HTTP_ERROR=6,Ee.COMPLETE="complete",(_e.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",jt.prototype.listen=jt.prototype.va,Rn.prototype.listenOnce=Rn.prototype.wa,Rn.prototype.getLastError=Rn.prototype.Qa,Rn.prototype.getLastErrorCode=Rn.prototype.ua,Rn.prototype.getStatus=Rn.prototype.X,Rn.prototype.getResponseJson=Rn.prototype.Na,Rn.prototype.getResponseText=Rn.prototype.$,Rn.prototype.send=Rn.prototype.ba;var dr=(be={createWebChannelTransport:function(){return new cr},ErrorCode:be,EventType:Ee,WebChannel:_e,XhrIo:Rn}).createWebChannelTransport,yr=be.ErrorCode,vr=be.EventType,gr=be.WebChannel,mr=be.XhrIo,wr=(br.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},br.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},br.prototype.setServiceProps=function(t){return this.serviceProps=t,this},br);function br(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Er,Ir={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Tr=(n(Nr,Er=Error),Nr),_r="7.22.1-alpha.96ae6a5fe",Ar=new h("@firebase/firestore");function Nr(t,e){var n=this;return(n=Er.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Sr(){return Ar.logLevel}function xr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=f.DEBUG&&(e=n.map(Or),Ar.debug.apply(Ar,i(["Firestore ("+_r+"): "+t],e)))}function Rr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=f.ERROR&&(e=n.map(Or),Ar.error.apply(Ar,i(["Firestore ("+_r+"): "+t],e)))}function Dr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=f.WARN&&(e=n.map(Or),Ar.warn.apply(Ar,i(["Firestore ("+_r+"): "+t],e)))}function Or(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Pr(t){throw void 0===t&&(t="Unexpected state"),Rr(t="FIRESTORE ("+_r+") INTERNAL ASSERTION FAILED: "+t),new Error(t)}function kr(t){t||Pr()}function Lr(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Cr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ur(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Mr,Vr,Ee=(Object.defineProperty(Qr.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),Qr.prototype.isEqual=function(t){return 0===Qr.i(this,t)},Qr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Qr?t.forEach(function(t){e.push(t)}):e.push(t),this.o(e)},Qr.prototype.limit=function(){return this.offset+this.length},Qr.prototype.u=function(t){return t=void 0===t?1:t,this.o(this.segments,this.offset+t,this.length-t)},Qr.prototype.h=function(){return this.o(this.segments,this.offset,this.length-1)},Qr.prototype.l=function(){return this.segments[this.offset]},Qr.prototype._=function(){return this.get(this.length-1)},Qr.prototype.get=function(t){return this.segments[this.offset+t]},Qr.prototype.m=function(){return 0===this.length},Qr.prototype.T=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Qr.prototype.I=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Qr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Qr.prototype.A=function(){return this.segments.slice(this.offset,this.limit())},Qr.i=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Qr),jr=(n(zr,Vr=Ee),zr.prototype.o=function(t,e,n){return new zr(t,e,n)},zr.prototype.R=function(){return this.A().join("/")},zr.prototype.toString=function(){return this.R()},zr.P=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new zr(n)},zr.g=function(){return new zr([])},zr),Fr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,qr=(n(Wr,Mr=Ee),Wr.prototype.o=function(t,e,n){return new Wr(t,e,n)},Wr.V=function(t){return Fr.test(t)},Wr.prototype.R=function(){return this.A().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),Wr.V(t)||(t="`"+t+"`"),t}).join(".")},Wr.prototype.toString=function(){return this.R()},Wr.prototype.p=function(){return 1===this.length&&"__name__"===this.get(0)},Wr.v=function(){return new Wr(["__name__"])},Wr.S=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Tr(Ir.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Tr(Ir.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Tr(Ir.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Wr(e)},Wr.g=function(){return new Wr([])},Wr),Br=(Gr.D=function(t){return new Gr(jr.P(t))},Gr.C=function(t){return new Gr(jr.P(t).u(5))},Gr.prototype.N=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Gr.prototype.isEqual=function(t){return null!==t&&0===jr.i(this.path,t.path)},Gr.prototype.toString=function(){return this.path.toString()},Gr.i=function(t,e){return jr.i(t.path,e.path)},Gr.F=function(t){return t.length%2==0},Gr.$=function(t){return new Gr(new jr(t.slice()))},Gr);function Gr(t){this.path=t}function Wr(){return null!==Mr&&Mr.apply(this,arguments)||this}function zr(){return null!==Vr&&Vr.apply(this,arguments)||this}function Qr(t,e,n){void 0===e?e=0:e>t.length&&Pr(),void 0===n?n=t.length-e:n>t.length-e&&Pr(),this.segments=t,this.offset=e,this.t=n}function Kr(t,e){if(0!==e.length)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+li(e.length,"argument")+".")}function Hr(t,e,n){if(e.length!==n)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires "+li(n,"argument")+", but was called with "+li(e.length,"argument")+".")}function Xr(t,e,n){if(e.length<n)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires at least "+li(n,"argument")+", but was called with "+li(e.length,"argument")+".")}function Yr(t,e,n,r){if(e.length<n||e.length>r)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+li(e.length,"argument")+".")}function Jr(t,e,n,r){ri(t,e,hi(n)+" argument",r)}function $r(t,e,n,r){void 0!==r&&Jr(t,e,n,r)}function Zr(t,e,n,r){ri(t,e,n+" option",r)}function ti(t,e,n,r){void 0!==r&&Zr(t,e,n,r)}function ei(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(oi(s))}var u=oi(n);throw new Tr(Ir.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function ni(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid value "+oi(r)+" provided to function "+t+"() for its "+hi(n)+" argument. Acceptable values: "+e.join(", "));return r}function ri(t,e,n,r){if(!("object"===e?ii(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e))throw r=oi(r),new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}function ii(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function oi(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Pr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function si(t,e,n){if(void 0===n)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+hi(e)+" argument, but it was undefined.")}function ui(n,t,r){Cr(t,function(t,e){if(r.indexOf(t)<0)throw new Tr(Ir.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function ai(t,e,n,r){return r=oi(r),new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires its "+hi(n)+" argument to be a "+e+", but it was: "+r)}function ci(t,e,n){if(n<=0)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires its "+hi(e)+" argument to be a positive number, but it was: "+n+".")}function hi(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function li(t,e){return t+" "+e+(1===t?"":"s")}var fi=(pi.k=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},pi);function pi(){}function di(t,e){return t<e?-1:e<t?1:0}function yi(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function vi(t){return t+"\0"}var gi=(mi.fromBase64String=function(t){return new mi(atob(t))},mi.fromUint8Array=function(t){return new mi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},mi.prototype.toBase64=function(){return t=this.M,btoa(t);var t},mi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.M)},mi.prototype.O=function(){return 2*this.M.length},mi.prototype.L=function(t){return di(this.M,t.M)},mi.prototype.isEqual=function(t){return this.M===t.M},mi);function mi(t){this.M=t}gi.B=new gi("");var wi=(bi.fromBase64String=function(t){try{return new bi(gi.fromBase64String(t))}catch(t){throw new Tr(Ir.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},bi.fromUint8Array=function(t){return new bi(gi.fromUint8Array(t))},bi.prototype.toBase64=function(){return this.q.toBase64()},bi.prototype.toUint8Array=function(){return this.q.toUint8Array()},bi.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},bi.prototype.isEqual=function(t){return this.q.isEqual(t.q)},bi);function bi(t){this.q=t}function Ei(){if("undefined"==typeof Uint8Array)throw new Tr(Ir.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Ii(){if("undefined"==typeof atob)throw new Tr(Ir.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function Ti(t,e,n,r,i){this.U=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var _i,Ai=(n(Li,_i=wi),Li.fromBase64String=function(t){Hr("Blob.fromBase64String",arguments,1),Jr("Blob.fromBase64String","string",1,t),Ii();try{return new Li(gi.fromBase64String(t))}catch(t){throw new Tr(Ir.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Li.fromUint8Array=function(t){if(Hr("Blob.fromUint8Array",arguments,1),Ei(),!(t instanceof Uint8Array))throw ai("Blob.fromUint8Array","Uint8Array",1,t);return new Li(gi.fromUint8Array(t))},Li.prototype.toBase64=function(){return Hr("Blob.toBase64",arguments,0),Ii(),_i.prototype.toBase64.call(this)},Li.prototype.toUint8Array=function(){return Hr("Blob.toUint8Array",arguments,0),Ei(),_i.prototype.toUint8Array.call(this)},Li.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Li),Ni=(Object.defineProperty(ki.prototype,"W",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),ki.prototype.isEqual=function(t){return t instanceof ki&&t.projectId===this.projectId&&t.database===this.database},ki.prototype.L=function(t){return di(this.projectId,t.projectId)||di(this.database,t.database)},ki),Si=(Pi.prototype.get=function(t){var e=this.j(t);if(void 0!==(e=this.G[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.K(i,t))return o}},Pi.prototype.has=function(t){return void 0!==this.get(t)},Pi.prototype.set=function(t,e){var n=this.j(t),r=this.G[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.K(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.G[n]=[[t,e]]},Pi.prototype.delete=function(t){var e=this.j(t),n=this.G[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.K(n[r][0],t))return 1===n.length?delete this.G[e]:n.splice(r,1),!0;return!1},Pi.prototype.forEach=function(s){Cr(this.G,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},Pi.prototype.m=function(){return Ur(this.G)},Pi),xi=(Oi.now=function(){return Oi.fromMillis(Date.now())},Oi.fromDate=function(t){return Oi.fromMillis(t.getTime())},Oi.fromMillis=function(t){var e=Math.floor(t/1e3);return new Oi(e,1e6*(t-1e3*e))},Oi.prototype.toDate=function(){return new Date(this.toMillis())},Oi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Oi.prototype.H=function(t){return this.seconds===t.seconds?di(this.nanoseconds,t.nanoseconds):di(this.seconds,t.seconds)},Oi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Oi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Oi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},Oi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Oi),Ri=(Di.J=function(t){return new Di(t)},Di.min=function(){return new Di(new xi(0,0))},Di.prototype.L=function(t){return this.timestamp.H(t.timestamp)},Di.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Di.prototype.Y=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Di.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Di.prototype.X=function(){return this.timestamp},Di);function Di(t){this.timestamp=t}function Oi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Pi(t,e){this.j=t,this.K=e,this.G={}}function ki(t,e){this.projectId=t,this.database=e||"(default)"}function Li(){return null!==_i&&_i.apply(this,arguments)||this}function Ci(t){return null==t}function Ui(t){return 0===t&&1/t==-1/0}function Mi(t){return"number"==typeof t&&Number.isInteger(t)&&!Ui(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Vi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Z=null};function ji(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Vi(t,e,n,r,i,o,s)}function Fi(t){var e=t;return null===e.Z&&(t=e.path.R(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.R()+t.op.toString()+Fo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.R()+t.dir}).join(","),Ci(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=ma(e.startAt)),e.endAt&&(t+="|ub:",t+=ma(e.endAt)),e.Z=t),e.Z}function qi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Uo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ba(t.startAt,e.startAt)&&ba(t.endAt,e.endAt)}function Bi(t){return Br.F(t.path)&&null===t.collectionGroup&&0===t.filters.length}function Gi(t){this.count=t}var Wi,zi=(Qi.prototype.nt=function(t){return new Qi(this.target,this.targetId,this.tt,t,this.et,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Qi.prototype.st=function(t,e){return new Qi(this.target,this.targetId,this.tt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Qi.prototype.it=function(t){return new Qi(this.target,this.targetId,this.tt,this.sequenceNumber,this.et,t,this.resumeToken)},Qi);function Qi(t,e,n,r,i,o,s){void 0===i&&(i=Ri.min()),void 0===o&&(o=Ri.min()),void 0===s&&(s=gi.B),this.target=t,this.targetId=e,this.tt=n,this.sequenceNumber=r,this.et=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Ki(t){switch(t){case Ir.OK:return Pr(),0;case Ir.CANCELLED:case Ir.UNKNOWN:case Ir.DEADLINE_EXCEEDED:case Ir.RESOURCE_EXHAUSTED:case Ir.INTERNAL:case Ir.UNAVAILABLE:case Ir.UNAUTHENTICATED:return;case Ir.INVALID_ARGUMENT:case Ir.NOT_FOUND:case Ir.ALREADY_EXISTS:case Ir.PERMISSION_DENIED:case Ir.FAILED_PRECONDITION:case Ir.ABORTED:case Ir.OUT_OF_RANGE:case Ir.UNIMPLEMENTED:case Ir.DATA_LOSS:return 1;default:return Pr(),0}}function Hi(t){if(void 0===t)return Rr("GRPC error has no .code"),Ir.UNKNOWN;switch(t){case Wi.OK:return Ir.OK;case Wi.CANCELLED:return Ir.CANCELLED;case Wi.UNKNOWN:return Ir.UNKNOWN;case Wi.DEADLINE_EXCEEDED:return Ir.DEADLINE_EXCEEDED;case Wi.RESOURCE_EXHAUSTED:return Ir.RESOURCE_EXHAUSTED;case Wi.INTERNAL:return Ir.INTERNAL;case Wi.UNAVAILABLE:return Ir.UNAVAILABLE;case Wi.UNAUTHENTICATED:return Ir.UNAUTHENTICATED;case Wi.INVALID_ARGUMENT:return Ir.INVALID_ARGUMENT;case Wi.NOT_FOUND:return Ir.NOT_FOUND;case Wi.ALREADY_EXISTS:return Ir.ALREADY_EXISTS;case Wi.PERMISSION_DENIED:return Ir.PERMISSION_DENIED;case Wi.FAILED_PRECONDITION:return Ir.FAILED_PRECONDITION;case Wi.ABORTED:return Ir.ABORTED;case Wi.OUT_OF_RANGE:return Ir.OUT_OF_RANGE;case Wi.UNIMPLEMENTED:return Ir.UNIMPLEMENTED;case Wi.DATA_LOSS:return Ir.DATA_LOSS;default:return Pr()}}(be=Wi=Wi||{})[be.OK=0]="OK",be[be.CANCELLED=1]="CANCELLED",be[be.UNKNOWN=2]="UNKNOWN",be[be.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",be[be.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",be[be.NOT_FOUND=5]="NOT_FOUND",be[be.ALREADY_EXISTS=6]="ALREADY_EXISTS",be[be.PERMISSION_DENIED=7]="PERMISSION_DENIED",be[be.UNAUTHENTICATED=16]="UNAUTHENTICATED",be[be.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",be[be.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",be[be.ABORTED=10]="ABORTED",be[be.OUT_OF_RANGE=11]="OUT_OF_RANGE",be[be.UNIMPLEMENTED=12]="UNIMPLEMENTED",be[be.INTERNAL=13]="INTERNAL",be[be.UNAVAILABLE=14]="UNAVAILABLE",be[be.DATA_LOSS=15]="DATA_LOSS";var Xi=(to.prototype.rt=function(t,e){return new to(this.i,this.root.rt(t,e,this.i).copy(null,null,Ji.ot,null,null))},to.prototype.remove=function(t){return new to(this.i,this.root.remove(t,this.i).copy(null,null,Ji.ot,null,null))},to.prototype.get=function(t){for(var e=this.root;!e.m();){var n=this.i(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},to.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.m();){var r=this.i(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},to.prototype.m=function(){return this.root.m()},Object.defineProperty(to.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),to.prototype.at=function(){return this.root.at()},to.prototype.ut=function(){return this.root.ut()},to.prototype.ct=function(t){return this.root.ct(t)},to.prototype.forEach=function(n){this.ct(function(t,e){return n(t,e),!1})},to.prototype.toString=function(){var n=[];return this.ct(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},to.prototype.ht=function(t){return this.root.ht(t)},to.prototype.lt=function(){return new Yi(this.root,null,this.i,!1)},to.prototype._t=function(t){return new Yi(this.root,t,this.i,!1)},to.prototype.ft=function(){return new Yi(this.root,null,this.i,!0)},to.prototype.dt=function(t){return new Yi(this.root,t,this.i,!0)},to),Yi=(Zi.prototype.Et=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.m();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.m();)this.Tt.push(t),t=t.left;return e},Zi.prototype.It=function(){return 0<this.Tt.length},Zi.prototype.At=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},Zi),Ji=($i.prototype.copy=function(t,e,n,r,i){return new $i(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},$i.prototype.m=function(){return!1},$i.prototype.ct=function(t){return this.left.ct(t)||t(this.key,this.value)||this.right.ct(t)},$i.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},$i.prototype.min=function(){return this.left.m()?this:this.left.min()},$i.prototype.at=function(){return this.min().key},$i.prototype.ut=function(){return this.right.m()?this.key:this.right.ut()},$i.prototype.rt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.rt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.rt(t,e,n))).Rt()},$i.prototype.Pt=function(){if(this.left.m())return $i.EMPTY;var t=this;return t.left.yt()||t.left.left.yt()||(t=t.gt()),(t=t.copy(null,null,null,t.left.Pt(),null)).Rt()},$i.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.m()||r.left.yt()||r.left.left.yt()||(r=r.gt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.yt()&&(r=r.Vt()),r.right.m()||r.right.yt()||r.right.left.yt()||(r=r.bt()),0===e(t,r.key)){if(r.right.m())return $i.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Pt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Rt()},$i.prototype.yt=function(){return this.color},$i.prototype.Rt=function(){var t=this;return t.right.yt()&&!t.left.yt()&&(t=t.vt()),t.left.yt()&&t.left.left.yt()&&(t=t.Vt()),t.left.yt()&&t.right.yt()&&(t=t.St()),t},$i.prototype.gt=function(){var t=this.St();return t.right.left.yt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Vt())).vt()).St()),t},$i.prototype.bt=function(){var t=this.St();return t.left.left.yt()&&(t=(t=t.Vt()).St()),t},$i.prototype.vt=function(){var t=this.copy(null,null,$i.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},$i.prototype.Vt=function(){var t=this.copy(null,null,$i.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},$i.prototype.St=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},$i.prototype.Dt=function(){var t=this.Ct();return Math.pow(2,t)<=this.size+1},$i.prototype.Ct=function(){if(this.yt()&&this.left.yt())throw Pr();if(this.right.yt())throw Pr();var t=this.left.Ct();if(t!==this.right.Ct())throw Pr();return t+(this.yt()?0:1)},$i);function $i(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:$i.RED,this.left=null!=r?r:$i.EMPTY,this.right=null!=i?i:$i.EMPTY,this.size=this.left.size+1+this.right.size}function Zi(t,e,n,r){this.wt=r,this.Tt=[];for(var i=1;!t.m();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.wt?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.wt?t.right:t.left}}function to(t,e){this.i=t,this.root=e||Ji.EMPTY}function eo(){this.size=0}Ji.EMPTY=null,Ji.RED=!0,Ji.ot=!1,Ji.EMPTY=(Object.defineProperty(eo.prototype,"key",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"value",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"color",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"left",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"right",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),eo.prototype.copy=function(t,e,n,r,i){return this},eo.prototype.rt=function(t,e,n){return new Ji(t,e)},eo.prototype.remove=function(t,e){return this},eo.prototype.m=function(){return!0},eo.prototype.ct=function(t){return!1},eo.prototype.ht=function(t){return!1},eo.prototype.at=function(){return null},eo.prototype.ut=function(){return null},eo.prototype.yt=function(){return!1},eo.prototype.Dt=function(){return!0},eo.prototype.Ct=function(){return 0},new eo);var no=(so.prototype.has=function(t){return null!==this.data.get(t)},so.prototype.first=function(){return this.data.at()},so.prototype.last=function(){return this.data.ut()},Object.defineProperty(so.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),so.prototype.indexOf=function(t){return this.data.indexOf(t)},so.prototype.forEach=function(n){this.data.ct(function(t,e){return n(t),!1})},so.prototype.Nt=function(t,e){for(var n=this.data._t(t[0]);n.It();){var r=n.Et();if(0<=this.i(r.key,t[1]))return;e(r.key)}},so.prototype.Ft=function(t,e){for(var n=void 0!==e?this.data._t(e):this.data.lt();n.It();)if(!t(n.Et().key))return},so.prototype.$t=function(t){return(t=this.data._t(t)).It()?t.Et().key:null},so.prototype.lt=function(){return new ro(this.data.lt())},so.prototype._t=function(t){return new ro(this.data._t(t))},so.prototype.add=function(t){return this.copy(this.data.remove(t).rt(t,!0))},so.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},so.prototype.m=function(){return this.data.m()},so.prototype.xt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},so.prototype.isEqual=function(t){if(!(t instanceof so))return!1;if(this.size!==t.size)return!1;for(var e=this.data.lt(),n=t.data.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(0!==this.i(r,i))return!1}return!0},so.prototype.A=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},so.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},so.prototype.copy=function(t){var e=new so(this.i);return e.data=t,e},so),ro=(oo.prototype.Et=function(){return this.kt.Et().key},oo.prototype.It=function(){return this.kt.It()},oo),io=new Xi(Br.i);function oo(t){this.kt=t}function so(t){this.i=t,this.data=new Xi(this.i)}var uo=new Xi(Br.i),ao=new Xi(Br.i),co=new no(Br.i);function ho(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=co,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var lo=new no(di),fo=(Ro.Lt=function(t){return new Ro(t.i)},Ro.prototype.has=function(t){return null!=this.Mt.get(t)},Ro.prototype.get=function(t){return this.Mt.get(t)},Ro.prototype.first=function(){return this.Ot.at()},Ro.prototype.last=function(){return this.Ot.ut()},Ro.prototype.m=function(){return this.Ot.m()},Ro.prototype.indexOf=function(t){return(t=this.Mt.get(t))?this.Ot.indexOf(t):-1},Object.defineProperty(Ro.prototype,"size",{get:function(){return this.Ot.size},enumerable:!1,configurable:!0}),Ro.prototype.forEach=function(n){this.Ot.ct(function(t,e){return n(t),!1})},Ro.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Mt.rt(t.key,t),e.Ot.rt(t,null))},Ro.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Mt.remove(t),this.Ot.remove(e)):this},Ro.prototype.isEqual=function(t){if(!(t instanceof Ro))return!1;if(this.size!==t.size)return!1;for(var e=this.Ot.lt(),n=t.Ot.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(!r.isEqual(i))return!1}return!0},Ro.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Ro.prototype.copy=function(t,e){var n=new Ro;return n.i=this.i,n.Mt=t,n.Ot=e,n},Ro),po=(xo.prototype.track=function(t){var e=t.doc.key,n=this.Bt.get(e);!n||0!==t.type&&3===n.type?this.Bt=this.Bt.rt(e,t):3===t.type&&1!==n.type?this.Bt=this.Bt.rt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Bt=this.Bt.rt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Bt=this.Bt.remove(e):1===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):Pr()},xo.prototype.qt=function(){var n=[];return this.Bt.ct(function(t,e){n.push(e)}),n},xo),yo=(So.Kt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new So(t,e,fo.Lt(e),i,n,r,!0,!1)},Object.defineProperty(So.prototype,"hasPendingWrites",{get:function(){return!this.Qt.m()},enumerable:!1,configurable:!0}),So.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Wt===t.Wt&&this.Qt.isEqual(t.Qt)&&qu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ut.isEqual(t.Ut)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},So),vo=(No.Yt=function(t,e){var n=new Map;return n.set(t,go.Xt(t,e)),new No(Ri.min(),n,lo,io,ho())},No),go=(Ao.Xt=function(t,e){return new Ao(gi.B,e,ho(),ho(),ho())},Ao),mo=function(t,e,n,r){this.se=t,this.removedTargetIds=e,this.key=n,this.ie=r},wo=function(t,e){this.targetId=t,this.re=e},bo=function(t,e,n,r){void 0===n&&(n=gi.B),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Eo=(Object.defineProperty(_o.prototype,"Zt",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(_o.prototype,"resumeToken",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(_o.prototype,"le",{get:function(){return 0!==this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(_o.prototype,"_e",{get:function(){return this.he},enumerable:!1,configurable:!0}),_o.prototype.fe=function(t){0<t.O()&&(this.he=!0,this.ue=t)},_o.prototype.de=function(){var n=ho(),r=ho(),i=ho();return this.ae.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Pr()}}),new go(this.ue,this.ce,n,r,i)},_o.prototype.we=function(){this.he=!1,this.ae=Oo()},_o.prototype.me=function(t,e){this.he=!0,this.ae=this.ae.rt(t,e)},_o.prototype.Te=function(t){this.he=!0,this.ae=this.ae.remove(t)},_o.prototype.Ee=function(){this.oe+=1},_o.prototype.Ie=function(){--this.oe},_o.prototype.Ae=function(){this.he=!0,this.ce=!0},_o),Io=(To.prototype.pe=function(t){for(var e=0,n=t.se;e<n.length;e++){var r=n[e];t.ie instanceof Iu?this.be(r,t.ie):t.ie instanceof Tu&&this.ve(r,t.key,t.ie)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.ve(s,t.key,t.ie)}},To.prototype.Se=function(n){var r=this;this.De(n,function(t){var e=r.Ce(t);switch(n.state){case 0:r.Ne(t)&&e.fe(n.resumeToken);break;case 1:e.Ie(),e.le||e.we(),e.fe(n.resumeToken);break;case 2:e.Ie(),e.le||r.removeTarget(t);break;case 3:r.Ne(t)&&(e.Ae(),e.fe(n.resumeToken));break;case 4:r.Ne(t)&&(r.Fe(t),e.fe(n.resumeToken));break;default:Pr()}})},To.prototype.De=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Pe.forEach(function(t,e){r.Ne(e)&&n(e)})},To.prototype.$e=function(t){var e=t.targetId,n=t.re.count;(t=this.xe(e))&&(Bi(t=t.target)?0===n?(t=new Br(t.path),this.ve(e,t,new Tu(t,Ri.min()))):kr(1===n):this.ke(e)!==n&&(this.Fe(e),this.Ve=this.Ve.add(e)))},To.prototype.Me=function(r){var i=this,o=new Map;this.Pe.forEach(function(t,e){var n=i.xe(e);n&&(t.Zt&&Bi(n.target)&&(n=new Br(n.target.path),null!==i.ye.get(n)||i.Oe(e,n)||i.ve(e,n,new Tu(n,r))),t._e&&(o.set(e,t.de()),t.we()))});var s=ho();this.ge.forEach(function(t,e){var n=!0;e.Ft(function(t){return!(t=i.xe(t))||2===t.tt||(n=!1)}),n&&(s=s.add(t))});var t=new vo(r,o,this.Ve,this.ye,s);return this.ye=io,this.ge=Do(),this.Ve=new no(di),t},To.prototype.be=function(t,e){var n;this.Ne(t)&&(n=this.Oe(t,e.key)?2:0,this.Ce(t).me(e.key,n),this.ye=this.ye.rt(e.key,e),this.ge=this.ge.rt(e.key,this.Le(e.key).add(t)))},To.prototype.ve=function(t,e,n){var r;this.Ne(t)&&(r=this.Ce(t),this.Oe(t,e)?r.me(e,1):r.Te(e),this.ge=this.ge.rt(e,this.Le(e).delete(t)),n&&(this.ye=this.ye.rt(e,n)))},To.prototype.removeTarget=function(t){this.Pe.delete(t)},To.prototype.ke=function(t){var e=this.Ce(t).de();return this.Re.Be(t).size+e.te.size-e.ne.size},To.prototype.Ee=function(t){this.Ce(t).Ee()},To.prototype.Ce=function(t){var e=this.Pe.get(t);return e||(e=new Eo,this.Pe.set(t,e)),e},To.prototype.Le=function(t){var e=this.ge.get(t);return e||(e=new no(di),this.ge=this.ge.rt(t,e)),e},To.prototype.Ne=function(t){var e=null!==this.xe(t);return e||xr("WatchChangeAggregator","Detected inactive target",t),e},To.prototype.xe=function(t){var e=this.Pe.get(t);return e&&e.le?null:this.Re.qe(t)},To.prototype.Fe=function(e){var n=this;this.Pe.set(e,new Eo),this.Re.Be(e).forEach(function(t){n.ve(e,t,null)})},To.prototype.Oe=function(t,e){return this.Re.Be(t).has(e)},To);function To(t){this.Re=t,this.Pe=new Map,this.ye=io,this.ge=Do(),this.Ve=new no(di)}function _o(){this.oe=0,this.ae=Oo(),this.ue=gi.B,this.ce=!1,this.he=!0}function Ao(t,e,n,r,i){this.resumeToken=t,this.Zt=e,this.te=n,this.ee=r,this.ne=i}function No(t,e,n,r,i){this.et=t,this.Gt=e,this.zt=n,this.Ht=r,this.Jt=i}function So(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Ut=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.Wt=s,this.jt=u}function xo(){this.Bt=new Xi(Br.i)}function Ro(n){this.i=n?function(t,e){return n(t,e)||Br.i(t.key,e.key)}:function(t,e){return Br.i(t.key,e.key)},this.Mt=uo,this.Ot=new Xi(this.i)}function Do(){return new Xi(Br.i)}function Oo(){return new Xi(Br.i)}function Po(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function ko(t){return t=qo(t.mapValue.fields.__local_write_time__.timestampValue),new xi(t.seconds,t.nanos)}var Lo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Co(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Po(t)?4:10:Pr()}function Uo(r,i){var t,e,n,o=Co(r);if(o!==Co(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return ko(r).isEqual(ko(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=qo(r.timestampValue),t=qo(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Go(r.bytesValue).isEqual(Go(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return o=i,Bo((t=r).geoPointValue.latitude)===Bo(o.geoPointValue.latitude)&&Bo(t.geoPointValue.longitude)===Bo(o.geoPointValue.longitude);case 2:return n=i,"integerValue"in(e=r)&&"integerValue"in n?Bo(e.integerValue)===Bo(n.integerValue):"doubleValue"in e&&"doubleValue"in n&&((e=Bo(e.doubleValue))===(n=Bo(n.doubleValue))?Ui(e)===Ui(n):isNaN(e)&&isNaN(n));case 9:return yi(r.arrayValue.values||[],i.arrayValue.values||[],Uo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Lr(e)!==Lr(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Uo(e[t],n[t])))return!1;return!0}();default:return Pr()}}function Mo(t,e){return void 0!==(t.values||[]).find(function(t){return Uo(t,e)})}function Vo(t,e){var n,r,i,o,s=Co(t),u=Co(e);if(s!==u)return di(s,u);switch(s){case 0:return 0;case 1:return di(t.booleanValue,e.booleanValue);case 2:return n=e,(r=Bo(t.integerValue||t.doubleValue))<(n=Bo(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return jo(t.timestampValue,e.timestampValue);case 4:return jo(ko(t),ko(e));case 5:return di(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,o=e.bytesValue,i=Go(i),o=Go(o),i.L(o);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=di(n[i],r[i]);if(0!==o)return o}return di(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return s=t.geoPointValue,r=e.geoPointValue,0!==(n=di(Bo(s.latitude),Bo(r.latitude)))?n:di(Bo(s.longitude),Bo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Vo(n[i],r[i]);if(o)return o}return di(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=di(r[s],o[s]);if(0!==u)return u;if(0!==(u=Vo(n[r[s]],i[o[s]])))return u}return di(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Pr()}}function jo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return di(t,e);var n=qo(t),t=qo(e);return 0!==(e=di(n.seconds,t.seconds))?e:di(n.nanos,t.nanos)}function Fo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=qo(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?Go(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,Br.C(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Pr();var t,e}(t)}function qo(t){if(kr(!!t),"string"!=typeof t)return{seconds:Bo(t.seconds),nanos:Bo(t.nanos)};var e=0,n=Lo.exec(t);return kr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Bo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Go(t){return"string"==typeof t?gi.fromBase64String(t):gi.fromUint8Array(t)}function Wo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.R()}}function zo(t){return t&&"integerValue"in t}function Qo(t){return!!t&&"arrayValue"in t}function Ko(t){return t&&"nullValue"in t}function Ho(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Xo(t){return t&&"mapValue"in t}var Yo={asc:"ASCENDING",desc:"DESCENDING"},Jo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},$o=function(t,e){this.U=t,this.Ue=e};function Zo(t){return{integerValue:""+t}}function ts(t,e){if(t.Ue){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ui(e)?"-0":e}}function es(t,e){return Mi(e)?Zo(e):ts(t,e)}function ns(t,e){return t.Ue?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function rs(t,e){return t.Ue?e.toBase64():e.toUint8Array()}function is(t){return kr(!!t),Ri.J((t=qo(t),new xi(t.seconds,t.nanos)))}function os(t,e){return new jr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).R()}function ss(t){return kr(_s(t=jr.P(t))),t}function us(t,e){return os(t.U,e.path)}function as(t,e){return kr((e=ss(e)).get(1)===t.U.projectId),kr(!e.get(3)&&!t.U.database||e.get(3)===t.U.database),new Br(fs(e))}function cs(t,e){return os(t.U,e)}function hs(t){return 4===(t=ss(t)).length?jr.g():fs(t)}function ls(t){return new jr(["projects",t.U.projectId,"databases",t.U.database]).R()}function fs(t){return kr(4<t.length&&"documents"===t.get(4)),t.u(5)}function ps(t,e,n){return{name:us(t,e),fields:n.proto.mapValue.fields}}function ds(t,e,n){var r=as(t,e.name),t=is(e.updateTime),e=new pu({mapValue:{fields:e.fields}});return new Iu(r,t,e,{hasCommittedMutations:!!n})}function ys(t,e){var n,r,i;if(e instanceof tu)n={update:ps(t,e.key,e.value)};else if(e instanceof lu)n={delete:us(t,e.key)};else if(e instanceof eu)n={update:ps(t,e.key,e.data),updateMask:(i=e.Qe,r=[],i.fields.forEach(function(t){return r.push(t.R())}),{fieldPaths:r})};else if(e instanceof su)n={transform:{document:us(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof xs)return{fieldPath:t.field.R(),setToServerValue:"REQUEST_TIME"};if(e instanceof Rs)return{fieldPath:t.field.R(),appendMissingElements:{values:e.elements}};if(e instanceof Ls)return{fieldPath:t.field.R(),removeAllFromArray:{values:e.elements}};if(e instanceof Vs)return{fieldPath:t.field.R(),increment:e.We};throw Pr()})}};else{if(!(e instanceof fu))return Pr();n={verify:us(t,e.key)}}return e.Ke.je||(n.currentDocument=void 0!==(i=e.Ke).updateTime?{updateTime:ns(e=t,(t=i.updateTime).X())}:void 0!==i.exists?{exists:i.exists}:Pr()),n}function vs(o,t){var e=t.currentDocument?void 0!==(i=t.currentDocument).updateTime?Qs.updateTime(is(i.updateTime)):void 0!==i.exists?Qs.exists(i.exists):Qs.Ge():Qs.Ge();if(t.update){t.update.name;var n=as(o,t.update.name),r=new pu({mapValue:{fields:t.update.fields}});if(t.updateMask){var i=(i=t.updateMask.fieldPaths||[],new Bs(i.map(function(t){return qr.S(t)})));return new eu(n,r,i,e)}return new tu(n,r,e)}if(t.delete){var s=as(o,t.delete);return new lu(s,e)}return t.transform?(r=as(o,t.transform.document),s=t.transform.fieldTransforms.map(function(t){return e=o,i=null,"setToServerValue"in(n=t)?(kr("REQUEST_TIME"===n.setToServerValue),i=new xs):"appendMissingElements"in n?(r=n.appendMissingElements.values||[],i=new Rs(r)):"removeAllFromArray"in n?(r=n.removeAllFromArray.values||[],i=new Ls(r)):"increment"in n?i=new Vs(e,n.increment):Pr(),n=qr.S(n.fieldPath),new Gs(n,i);var e,n,r,i}),kr(!0===e.exists),new su(r,s)):t.verify?(t=as(o,t.verify),new fu(t,e)):Pr()}function gs(t,e){return{documents:[cs(t,e.path)]}}function ms(t,e){var n={structuredQuery:{}},r=e.path;return null!==e.collectionGroup?(n.parent=cs(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=cs(t,r.h()),n.structuredQuery.from=[{collectionId:r._()}]),(r=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(Ho(t.value))return{unaryFilter:{field:Is(t.field),op:"IS_NAN"}};if(Ko(t.value))return{unaryFilter:{field:Is(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Ho(t.value))return{unaryFilter:{field:Is(t.field),op:"IS_NOT_NAN"}};if(Ko(t.value))return{unaryFilter:{field:Is(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Is(t.field),op:(e=t.op,Jo[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(e.filters))&&(n.structuredQuery.where=r),(r=function(t){if(0!==t.length)return t.map(function(t){return{field:Is((t=t).field),direction:(t=t.dir,Yo[t])}})}(e.orderBy))&&(n.structuredQuery.orderBy=r),r=e.limit,null!==(r=t.Ue||Ci(r)?r:{value:r})&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=bs(e.startAt)),e.endAt&&(n.structuredQuery.endAt=bs(e.endAt)),n}function ws(t){var e=hs(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(kr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Ts(t.unaryFilter.field);return Ku.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Ts(t.unaryFilter.field);return Ku.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":return n=Ts(t.unaryFilter.field),Ku.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return t=Ts(t.unaryFilter.field),Ku.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Pr()}}(e)]:void 0!==e.fieldFilter?[(n=e,Ku.create(Ts(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Pr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Pr():[];var n}(n.where)),t=[],n.orderBy&&(t=n.orderBy.map(function(t){return new Ea(Ts((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e})),r=null,n.limit&&(r=Ci(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=Es(n.startAt));var u=null;return n.endAt&&(u=Es(n.endAt)),Ru(e,i,t,o,r,"F",s,u)}function bs(t){return{before:t.before,values:t.position}}function Es(t){var e=!!t.before,t=t.values||[];return new pa(t,e)}function Is(t){return{fieldPath:t.R()}}function Ts(t){return qr.S(t.fieldPath)}function _s(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function As(t,e){return t instanceof Vs?zo(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var Ns,Ss,xs=(n(Os,Ss=h=function(){this.ze=void 0}),Os),Rs=(n(Ds,Ns=h),Ds);function Ds(t){var e=this;return(e=Ns.call(this)||this).elements=t,e}function Os(){return null!==Ss&&Ss.apply(this,arguments)||this}function Ps(t,e){for(var n=qs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Uo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var ks,Ls=(n(Cs,ks=h),Cs);function Cs(t){var e=this;return(e=ks.call(this)||this).elements=t,e}function Us(t,e){for(var n=qs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Uo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var Ms,Vs=(n(js,Ms=h),js);function js(t,e){var n=this;return(n=Ms.call(this)||this).serializer=t,n.We=e,n}function Fs(t){return Bo(t.integerValue||t.doubleValue)}function qs(t){return Qo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Bs=(Ws.prototype.He=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].T(t))return!0;return!1},Ws.prototype.isEqual=function(t){return yi(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Ws),Gs=function(t,e){this.field=t,this.transform=e};function Ws(t){(this.fields=t).sort(qr.i)}function zs(t,e){this.version=t,this.transformResults=e}var Qs=(Ks.Ge=function(){return new Ks},Ks.exists=function(t){return new Ks(void 0,t)},Ks.updateTime=function(t){return new Ks(t)},Object.defineProperty(Ks.prototype,"je",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Ks.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Ks);function Ks(t,e){this.updateTime=t,this.exists=e}function Hs(t,e){return void 0!==t.updateTime?e instanceof Iu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Iu}function Xs(t,e,n,r){return t instanceof tu?(o=e,Hs((i=t).Ke,o)?(o=Js(o),new Iu(i.key,o,i.value,{Je:!0})):o):t instanceof eu?function(t,e){if(!Hs(t.Ke,e))return e;var n=Js(e),e=iu(t,e);return new Iu(t.key,n,e,{Je:!0})}(t,e):t instanceof su?function(t,e,n,r){if(!Hs(t.Ke,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof Iu&&(h=n.field(a.field)),null===h&&r instanceof Iu&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,(c=c)instanceof xs?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof Rs?Ps(c,i):c instanceof Ls?Us(c,i):(i=Fs(c=As(h=c,i))+Fs(h.We),zo(c)&&zo(h.We)?Zo(i):ts(h.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=au(t,i.data(),r);return new Iu(t.key,i.version,r,{Je:!0})}(t,e,r,n):(e=e,Hs((t=t).Ke,e)?new Tu(t.key,Ri.min()):e);var i,o}function Ys(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ke.isEqual(e.Ke)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||yi(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof Rs&&e instanceof Rs||t instanceof Ls&&e instanceof Ls?yi(t.elements,e.elements,Uo):t instanceof Vs&&e instanceof Vs?Uo(t.We,e.We):t instanceof xs&&e instanceof xs)}))}function Js(t){return t instanceof Iu?t.version:Ri.min()}var $s,Zs,tu=(n(ru,Zs=Ee=function(){}),ru),eu=(n(nu,$s=Ee),nu);function nu(t,e,n,r){var i=this;return(i=$s.call(this)||this).key=t,i.data=e,i.Qe=n,i.Ke=r,i.type=1,i}function ru(t,e,n){var r=this;return(r=Zs.call(this)||this).key=t,r.value=e,r.Ke=n,r.type=0,r}function iu(t,e){return n=t,e=e instanceof Iu?e.data():pu.empty(),r=new du(e),n.Qe.fields.forEach(function(t){var e;t.m()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Ye();var n,r}var ou,su=(n(uu,ou=Ee),uu);function uu(t,e){var n=this;return(n=ou.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ke=Qs.exists(!0),n}function au(t,e,n){for(var r=new du(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Ye()}var cu,hu,lu=(n(mu,hu=Ee),mu),fu=(n(gu,cu=Ee),gu),pu=(vu.empty=function(){return new vu({mapValue:{}})},vu.prototype.field=function(t){if(t.m())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Xo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t._()])||null},vu.prototype.isEqual=function(t){return Uo(this.proto,t.proto)},vu),du=(yu.prototype.set=function(t,e){return this.tn(t,e),this},yu.prototype.delete=function(t){return this.tn(t,null),this},yu.prototype.tn=function(t,e){for(var n=this.Ze,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===Co(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t._(),e)},yu.prototype.Ye=function(){var t=this.en(qr.g(),this.Ze);return null!=t?new pu(t):this.Xe},yu.prototype.en=function(r,t){var i=this,o=!1,e=this.Xe.field(r),s=Xo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.en(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},yu);function yu(t){void 0===t&&(t=pu.empty()),this.Xe=t,this.Ze=new Map}function vu(t){this.proto=t}function gu(t,e){var n=this;return(n=cu.call(this)||this).key=t,n.Ke=e,n.type=4,n}function mu(t,e){var n=this;return(n=hu.call(this)||this).key=t,n.Ke=e,n.type=3,n}var wu,bu,Eu,Iu=(n(xu,Eu=be=function(t,e){this.key=t,this.version=e}),xu.prototype.field=function(t){return this.nn.field(t)},xu.prototype.data=function(){return this.nn},xu.prototype.sn=function(){return this.nn.proto},xu.prototype.isEqual=function(t){return t instanceof xu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Je===t.Je&&this.hasCommittedMutations===t.hasCommittedMutations&&this.nn.isEqual(t.nn)},xu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.nn.toString()+", {hasLocalMutations: "+this.Je+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(xu.prototype,"hasPendingWrites",{get:function(){return this.Je||this.hasCommittedMutations},enumerable:!1,configurable:!0}),xu),Tu=(n(Su,bu=be),Su.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Su.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Su.prototype.isEqual=function(t){return t instanceof Su&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Su),_u=(n(Nu,wu=be),Nu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Nu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Nu.prototype.isEqual=function(t){return t instanceof Nu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Nu),Au=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.rn=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.on=null,this.an=null,this.startAt,this.endAt};function Nu(){return null!==wu&&wu.apply(this,arguments)||this}function Su(t,e,n){var r=this;return(r=bu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function xu(t,e,n,r){var i=this;return(i=Eu.call(this,t,e)||this).nn=n,i.Je=!!r.Je,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Ru(t,e,n,r,i,o,s,u){return new Au(t,e,n,r,i,o,s,u)}function Du(t){return new Au(t)}function Ou(t){return!Ci(t.limit)&&"F"===t.limitType}function Pu(t){return!Ci(t.limit)&&"L"===t.limitType}function ku(t){return 0<t.rn.length?t.rn[0].field:null}function Lu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.un())return r.field}return null}function Cu(t){return null!==t.collectionGroup}function Uu(t){var e=t;if(null===e.on){e.on=[];var n=Lu(e),t=ku(e);if(null!==n&&null===t)n.p()||e.on.push(new Ea(n)),e.on.push(new Ea(qr.v(),"asc"));else{for(var r=!1,i=0,o=e.rn;i<o.length;i++){var s=o[i];e.on.push(s),s.field.p()&&(r=!0)}r||(n=0<e.rn.length?e.rn[e.rn.length-1].dir:"asc",e.on.push(new Ea(qr.v(),n)))}}return e.on}function Mu(t){var e=t;if(!e.an)if("F"===e.limitType)e.an=ji(e.path,e.collectionGroup,Uu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Uu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Ea(o.field,s))}var u=e.endAt?new pa(e.endAt.position,!e.endAt.before):null,t=e.startAt?new pa(e.startAt.position,!e.startAt.before):null;e.an=ji(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.an}function Vu(t,e,n){return new Au(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ju(t,e){return new Au(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}function Fu(t,e){return new Au(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}function qu(t,e){return qi(Mu(t),Mu(e))&&t.limitType===e.limitType}function Bu(t){return Fi(Mu(t))+"|lt:"+t.limitType}function Gu(t){return"Query(target="+(n=(e=Mu(t)).path.R(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.R()+" "+t.op+" "+Fo(t.value)}).join(", ")+"]"),Ci(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.R()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+ma(e.startAt)),e.endAt&&(n+=", endAt: "+ma(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function Wu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.N(e.collectionGroup)&&e.path.T(n):Br.F(e.path)?e.path.isEqual(n):e.path.I(n))&&function(t){for(var e=0,n=i.rn;e<n.length;e++){var r=n[e];if(!r.field.p()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||wa(t.startAt,Uu(t),n))&&(!t.endAt||!wa(t.endAt,Uu(t),n)));var e,n}function zu(u){return function(t,e){for(var n=!1,r=0,i=Uu(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i,o;switch(n=t.field.p()?Br.i(e.key,n.key):(r=t.field,i=n,o=e.field(r),r=i.field(r),null!==o&&null!==r?Vo(o,r):Pr()),t.dir){case"asc":return n;case"desc":return-1*n;default:return Pr()}}(o,t,e);if(0!==s)return s;n=n||o.field.p()}return 0}}var Qu,Ku=(n(Hu,Qu=function(){}),Hu.create=function(t,e,n){if(t.p())return"in"===e||"not-in"===e?this.cn(t,e,n):new $u(t,e,n);if(Ko(n)){if("=="!==e&&"!="!==e)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. Null only supports '==' and '!=' comparisons.");return new Hu(t,e,n)}if(Ho(n)){if("=="!==e&&"!="!==e)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. NaN only supports '==' and '!=' comparisons.");return new Hu(t,e,n)}return"array-contains"===e?new ca(t,n):"in"===e?new ha(t,n):"not-in"===e?new la(t,n):"array-contains-any"===e?new fa(t,n):new Hu(t,e,n)},Hu.cn=function(t,e,n){return new("in"===e?Zu:ta)(t,n)},Hu.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this.hn(Vo(t,this.value)):null!==t&&Co(this.value)===Co(t)&&this.hn(Vo(t,this.value))},Hu.prototype.hn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Pr()}},Hu.prototype.un=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Hu);function Hu(t,e,n){var r=this;return(r=Qu.call(this)||this).field=t,r.op=e,r.value=n,r}var Xu,Yu,Ju,$u=(n(ra,Ju=Ku),ra.prototype.matches=function(t){return t=Br.i(t.key,this.key),this.hn(t)},ra),Zu=(n(na,Yu=Ku),na.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},na),ta=(n(ea,Xu=Ku),ea.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},ea);function ea(t,e){var n=this;return(n=Xu.call(this,t,"not-in",e)||this).keys=ia(0,e),n}function na(t,e){var n=this;return(n=Yu.call(this,t,"in",e)||this).keys=ia(0,e),n}function ra(t,e,n){var r=this;return(r=Ju.call(this,t,e,n)||this).key=Br.C(n.referenceValue),r}function ia(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return Br.C(t.referenceValue)})}var oa,sa,ua,aa,ca=(n(ga,aa=Ku),ga.prototype.matches=function(t){return Qo(t=t.field(this.field))&&Mo(t.arrayValue,this.value)},ga),ha=(n(va,ua=Ku),va.prototype.matches=function(t){return null!==(t=t.field(this.field))&&Mo(this.value.arrayValue,t)},va),la=(n(ya,sa=Ku),ya.prototype.matches=function(t){return!Mo(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!Mo(this.value.arrayValue,t))},ya),fa=(n(da,oa=Ku),da.prototype.matches=function(t){var e=this;return!(!Qo(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return Mo(e.value.arrayValue,t)})},da),pa=function(t,e){this.position=t,this.before=e};function da(t,e){return oa.call(this,t,"array-contains-any",e)||this}function ya(t,e){return sa.call(this,t,"not-in",e)||this}function va(t,e){return ua.call(this,t,"in",e)||this}function ga(t,e){return aa.call(this,t,"array-contains",e)||this}function ma(t){return(t.before?"b":"a")+":"+t.position.map(Fo).join(",")}function wa(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.p()?Br.i(Br.C(s.referenceValue),n.key):Vo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function ba(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Uo(t.position[n],e.position[n]))return!1;return!0}var Ea=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Ia(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var Ta,_a=(ka.prototype.reset=function(){this.mn=0},ka.prototype.In=function(){this.mn=this.wn},ka.prototype.An=function(t){var e=this;this.cancel();var n=Math.floor(this.mn+this.Rn()),r=Math.max(0,Date.now()-this.En),i=Math.max(0,n-r);0<i&&xr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.mn+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Tn=this.ln.Pn(this._n,i,function(){return e.En=Date.now(),t()}),this.mn*=this.dn,this.mn<this.fn&&(this.mn=this.fn),this.mn>this.wn&&(this.mn=this.wn)},ka.prototype.yn=function(){null!==this.Tn&&(this.Tn.gn(),this.Tn=null)},ka.prototype.cancel=function(){null!==this.Tn&&(this.Tn.cancel(),this.Tn=null)},ka.prototype.Rn=function(){return(Math.random()-.5)*this.mn},ka),Aa=(Pa.prototype.catch=function(t){return this.next(void 0,t)},Pa.prototype.next=function(r,i){var o=this;return this.vn&&Pr(),this.vn=!0,this.bn?this.error?this.Sn(i,this.error):this.Dn(r,this.result):new Pa(function(e,n){o.Vn=function(t){o.Dn(r,t).next(e,n)},o.pn=function(t){o.Sn(i,t).next(e,n)}})},Pa.prototype.Cn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Pa.prototype.Nn=function(t){try{var e=t();return e instanceof Pa?e:Pa.resolve(e)}catch(t){return Pa.reject(t)}},Pa.prototype.Dn=function(t,e){return t?this.Nn(function(){return t(e)}):Pa.resolve(e)},Pa.prototype.Sn=function(t,e){return t?this.Nn(function(){return t(e)}):Pa.reject(e)},Pa.resolve=function(n){return new Pa(function(t,e){t(n)})},Pa.reject=function(n){return new Pa(function(t,e){e(n)})},Pa.Fn=function(t){return new Pa(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Pa.$n=function(t){for(var n=Pa.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Pa.resolve(t):e()})}(r[e]);return n},Pa.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Fn(i)},Pa),Na=(Oa.delete=function(t){return xr("SimpleDb","Removing database:",t),ja(window.indexedDB.deleteDatabase(t)).Cn()},Oa.Mn=function(){if("undefined"==typeof indexedDB)return!1;if(Oa.On())return!0;var t=p(),e=0<(n=Oa.kn(t))&&n<10,n=0<(n=Oa.Ln(t))&&n<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||e||n)},Oa.On=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Bn)},Oa.qn=function(t,e){return t.store(e)},Oa.kn=function(t){return t=(t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i))?t[1].split("_").slice(0,2).join("."):"-1",Number(t)},Oa.Ln=function(t){return t=(t=t.match(/Android ([\d.]+)/i))?t[1].split(".").slice(0,2).join("."):"-1",Number(t)},Oa.prototype.Un=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(xr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result,e(t)},r.onblocked=function(){n(new xa(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){"VersionError"===(t=t.target.error).name?n(new Tr(Ir.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new xa(o,t))},r.onupgradeneeded=function(t){xr("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.xn.createOrUpgrade(e,r.transaction,t.oldVersion,i.version).next(function(){xr("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.Qn&&(this.db.onversionchange=function(t){return i.Qn(t)}),this.db)]}})})},Oa.prototype.Wn=function(e){this.Qn=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},Oa.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.Un(u)];case 2:return s.db=t.sent(),e=Ca.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),Aa.reject(t)}).Cn(),r={},n.catch(function(){}),[4,e.jn];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,xr("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},Oa.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},Oa),Sa=(Object.defineProperty(Da.prototype,"bn",{get:function(){return this.Gn},enumerable:!1,configurable:!0}),Object.defineProperty(Da.prototype,"Hn",{get:function(){return this.zn},enumerable:!1,configurable:!0}),Object.defineProperty(Da.prototype,"cursor",{set:function(t){this.Kn=t},enumerable:!1,configurable:!0}),Da.prototype.done=function(){this.Gn=!0},Da.prototype.Jn=function(t){this.zn=t},Da.prototype.delete=function(){return ja(this.Kn.delete())},Da),xa=(n(Ra,Ta=Tr),Ra);function Ra(t,e){var n=this;return(n=Ta.call(this,Ir.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function Da(t){this.Kn=t,this.Gn=!1,this.zn=null}function Oa(t,e,n){this.name=t,this.version=e,this.xn=n,12.2===Oa.kn(p())&&Rr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function Pa(t){var e=this;this.Vn=null,this.pn=null,this.result=void 0,this.error=void 0,this.bn=!1,this.vn=!1,t(function(t){e.bn=!0,e.result=t,e.Vn&&e.Vn(t)},function(t){e.bn=!0,e.error=t,e.pn&&e.pn(t)})}function ka(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.ln=t,this._n=e,this.fn=n,this.dn=r,this.wn=i,this.mn=0,this.Tn=null,this.En=Date.now(),this.reset()}function La(t){return"IndexedDbTransactionError"===t.name}var Ca=(Va.open=function(t,e,n,r){try{return new Va(e,t.transaction(r,n))}catch(t){throw new xa(e,t)}},Object.defineProperty(Va.prototype,"jn",{get:function(){return this.Yn.promise},enumerable:!1,configurable:!0}),Va.prototype.abort=function(t){t&&this.Yn.reject(t),this.aborted||(xr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Va.prototype.store=function(t){return t=this.transaction.objectStore(t),new Ua(t)},Va),Ua=(Ma.prototype.put=function(t,e){return ja(t=void 0!==e?(xr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(xr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},Ma.prototype.add=function(t){return xr("SimpleDb","ADD",this.store.name,t,t),ja(this.store.add(t))},Ma.prototype.get=function(e){var n=this;return ja(this.store.get(e)).next(function(t){return void 0===t&&(t=null),xr("SimpleDb","GET",n.store.name,e,t),t})},Ma.prototype.delete=function(t){return xr("SimpleDb","DELETE",this.store.name,t),ja(this.store.delete(t))},Ma.prototype.count=function(){return xr("SimpleDb","COUNT",this.store.name),ja(this.store.count())},Ma.prototype.Xn=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.Zn(e,function(t,e){n.push(e)}).next(function(){return n})},Ma.prototype.ts=function(t,e){return xr("SimpleDb","DELETE ALL",this.store.name),(e=this.options(t,e)).es=!1,e=this.cursor(e),this.Zn(e,function(t,e,n){return n.delete()})},Ma.prototype.ns=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.Zn(n,e)},Ma.prototype.ss=function(r){var t=this.cursor({});return new Aa(function(n,e){t.onerror=function(t){t=qa(t.target.error),e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},Ma.prototype.Zn=function(t,i){var o=[];return new Aa(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new Sa(n),(t=i(n.primaryKey,n.value,e))instanceof Aa&&(t=t.catch(function(t){return e.done(),Aa.reject(t)}),o.push(t)),e.bn?r():null===e.Hn?n.continue():n.continue(e.Hn)):r()}}).next(function(){return Aa.Fn(o)})},Ma.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Ma.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.es?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Ma);function Ma(t){this.store=t}function Va(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.Yn=new Ia,this.transaction.oncomplete=function(){n.Yn.resolve()},this.transaction.onabort=function(){t.error?n.Yn.reject(new xa(e,t.error)):n.Yn.resolve()},this.transaction.onerror=function(t){t=qa(t.target.error),n.Yn.reject(new xa(e,t))}}function ja(t){return new Aa(function(e,n){t.onsuccess=function(t){t=t.target.result,e(t)},t.onerror=function(t){t=qa(t.target.error),n(t)}})}var Fa=!1;function qa(t){var e=Na.kn(p());if(12.2<=e&&e<13&&(e="An internal error was encountered in the Indexed Database server",0<=t.message.indexOf(e))){var n=new Tr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Fa||(Fa=!0,setTimeout(function(){throw n},0)),n}return t}function Ba(){return"undefined"!=typeof window?window:null}function Ga(){return"undefined"!=typeof document?document:null}var Wa=(Ka.hs=function(t,e,n,r,i){return(i=new Ka(t,e,Date.now()+n,r,i)).start(n),i},Ka.prototype.start=function(t){var e=this;this.ls=setTimeout(function(){return e._s()},t)},Ka.prototype.gn=function(){return this._s()},Ka.prototype.cancel=function(t){null!==this.ls&&(this.clearTimeout(),this.cs.reject(new Tr(Ir.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Ka.prototype._s=function(){var e=this;this.rs.fs(function(){return null!==e.ls?(e.clearTimeout(),e.op().then(function(t){return e.cs.resolve(t)})):Promise.resolve()})},Ka.prototype.clearTimeout=function(){null!==this.ls&&(this.us(this),clearTimeout(this.ls),this.ls=null)},Ka),za=(Object.defineProperty(Qa.prototype,"gs",{get:function(){return this.Ts},enumerable:!1,configurable:!0}),Qa.prototype.fs=function(t){this.enqueue(t)},Qa.prototype.Vs=function(t){this.ps(),this.bs(t)},Qa.prototype.vs=function(){var t;this.Ts||(this.Ts=!0,(t=Ga())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.ys))},Qa.prototype.enqueue=function(t){return this.ps(),this.Ts?new Promise(function(t){}):this.bs(t)},Qa.prototype.Ss=function(t){var e=this;this.ws.push(t),this.fs(function(){return e.Ds()})},Qa.prototype.Ds=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.ws.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.ws[0]()];case 2:return t.sent(),this.ws.shift(),this.Ps.reset(),[3,4];case 3:if(!La(e=t.sent()))throw e;return xr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.ws.length&&this.Ps.An(function(){return n.Ds()}),t.label=5;case 5:return[2]}})})},Qa.prototype.bs=function(t){var r=this,e=this.ds.then(function(){return r.As=!0,t().catch(function(t){throw r.Is=t,r.As=!1,Rr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.As=!1,t})});return this.ds=e},Qa.prototype.Pn=function(t,e,n){var r=this;return this.ps(),-1<this.Rs.indexOf(t)&&(e=0),n=Wa.hs(this,t,e,n,function(t){return r.Cs(t)}),this.Es.push(n),n},Qa.prototype.ps=function(){this.Is&&Pr()},Qa.prototype.Ns=function(){},Qa.prototype.Fs=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.ds];case 1:t.sent(),t.label=2;case 2:if(e!==this.ds)return[3,0];t.label=3;case 3:return[2]}})})},Qa.prototype.$s=function(t){for(var e=0,n=this.Es;e<n.length;e++)if(n[e]._n===t)return!0;return!1},Qa.prototype.xs=function(r){var i=this;return this.Fs().then(function(){i.Es.sort(function(t,e){return t.os-e.os});for(var t=0,e=i.Es;t<e.length;t++){var n=e[t];if(n.gn(),"all"!==r&&n._n===r)break}return i.Fs()})},Qa.prototype.ks=function(t){this.Rs.push(t)},Qa.prototype.Cs=function(t){t=this.Es.indexOf(t),this.Es.splice(t,1)},Qa);function Qa(){var e=this;this.ds=Promise.resolve(),this.ws=[],this.Ts=!1,this.Es=[],this.Is=null,this.As=!1,this.Rs=[],this.Ps=new _a(this,"async_queue_retry"),this.ys=function(){var t=Ga();t&&xr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.Ps.yn()};var t=Ga();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.ys)}function Ka(t,e,n,r,i){this.rs=t,this._n=e,this.os=n,this.op=r,this.us=i,this.cs=new Ia,this.then=this.cs.promise.then.bind(this.cs.promise),this.cs.promise.catch(function(t){})}function Ha(t,e){if(Rr("AsyncQueue",e+": "+t),La(t))return new Tr(Ir.UNAVAILABLE,e+": "+t);throw t}function Xa(){this.Ms=void 0,this.listeners=[]}function Ya(){this.queries=new Si(Bu,qu),this.onlineState="Unknown",this.Os=new Set}function Ja(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new Xa),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Ls(n)];case 2:return o.Ms=t.sent(),[3,4];case 3:return o=Ha(o=t.sent(),"Initialization of query '"+Gu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.Bs(e.onlineState),i.Ms&&u.qs(i.Ms)&&Za(e),[2]}})})}function $a(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.Us(n))]:[2]})})}function Za(t){t.Os.forEach(function(t){t.next()})}var tc=(rc.prototype.qs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new yo(t.query,t.docs,t.Ut,e,t.Qt,t.fromCache,t.Wt,!0)}var o=!1;return this.Ws?this.Ks(t)&&(this.Qs.next(t),o=!0):this.Gs(t,this.onlineState)&&(this.zs(t),o=!0),this.js=t,o},rc.prototype.onError=function(t){this.Qs.error(t)},rc.prototype.Bs=function(t){this.onlineState=t;var e=!1;return this.js&&!this.Ws&&this.Gs(this.js,t)&&(this.zs(this.js),e=!0),e},rc.prototype.Gs=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Hs&&n||t.docs.m()&&"Offline"!==e)},rc.prototype.Ks=function(t){if(0<t.docChanges.length)return!0;var e=this.js&&this.js.hasPendingWrites!==t.hasPendingWrites;return!(!t.Wt&&!e)&&!0===this.options.includeMetadataChanges},rc.prototype.zs=function(t){t=yo.Kt(t.query,t.docs,t.Qt,t.fromCache),this.Ws=!0,this.Qs.next(t)},rc),ec=(nc.prototype.Js=function(){return null!=this.uid},nc.prototype.Ys=function(){return this.Js()?"uid:"+this.uid:"anonymous-user"},nc.prototype.isEqual=function(t){return t.uid===this.uid},nc);function nc(t){this.uid=t}function rc(t,e,n){this.query=t,this.Qs=e,this.Ws=!1,this.js=null,this.onlineState="Unknown",this.options=n||{}}ec.UNAUTHENTICATED=new ec(null),ec.Xs=new ec("google-credentials-uid"),ec.Zs=new ec("first-party-uid");var ic=(oc.prototype.ei=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},oc.prototype.next=function(){var t=++this.previousValue;return this.ni&&this.ni(t),t},oc);function oc(t,e){var n=this;this.previousValue=t,e&&(e.ti=function(t){return n.ei(t)},this.ni=function(t){return e.si(t)})}function sc(t,e){return"firestore_clients_"+t+"_"+e}function uc(t,e,n){return n="firestore_mutations_"+t+"_"+n,e.Js()&&(n+="_"+e.uid),n}function ac(t,e){return"firestore_targets_"+t+"_"+e}ic.ii=-1;var cc=(Sc.ri=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Tr(r.error.code,r.error.message)),i?new Sc(t,e,r.state,o):(Rr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},Sc.prototype.oi=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Sc),hc=(Nc.ri=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Tr(n.error.code,n.error.message)),r?new Nc(t,n.state,i):(Rr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},Nc.prototype.oi=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Nc),lc=(Ac.ri=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=lo,o=0;r&&o<n.activeTargetIds.length;++o)r=Mi(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new Ac(t,i):(Rr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},Ac),fc=(_c.ri=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new _c(e.clientId,e.onlineState):(Rr("SharedClientState","Failed to parse online state: "+t),null)},_c),pc=(Tc.prototype.ai=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Tc.prototype.ui=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Tc.prototype.oi=function(){var t={activeTargetIds:this.activeTargetIds.A(),updateTimeMs:Date.now()};return JSON.stringify(t)},Tc),dc=(Ic.Mn=function(t){return!(!t||!t.localStorage)},Ic.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,l=this;return v(this,function(t){switch(t.label){case 0:return[4,this.hi.gi()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this.ci&&(i=this.getItem(sc(this.persistenceKey,r)))&&(o=lc.ri(r,i))&&(this.di=this.di.rt(o.clientId,o));for(this.Vi(),(s=this.storage.getItem(this.Pi))&&(u=this.pi(s))&&this.bi(u),a=0,c=this.mi;a<c.length;a++)h=c[a],this.fi(h);return this.mi=[],this.window.addEventListener("unload",function(){return l.vi()}),this.wi=!0,[2]}})})},Ic.prototype.si=function(t){this.setItem(this.Ei,JSON.stringify(t))},Ic.prototype.Si=function(){return this.Di(this.di)},Ic.prototype.Ci=function(n){var r=!1;return this.di.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},Ic.prototype.Ni=function(t){this.Fi(t,"pending")},Ic.prototype.$i=function(t,e,n){this.Fi(t,e,n),this.xi(t)},Ic.prototype.ki=function(t){var e,n="not-current";return this.Ci(t)&&(!(e=this.storage.getItem(ac(this.persistenceKey,t)))||(e=hc.ri(t,e))&&(n=e.state)),this.Mi.ai(t),this.Vi(),n},Ic.prototype.Oi=function(t){this.Mi.ui(t),this.Vi()},Ic.prototype.Li=function(t){return this.Mi.activeTargetIds.has(t)},Ic.prototype.Bi=function(t){this.removeItem(ac(this.persistenceKey,t))},Ic.prototype.qi=function(t,e,n){this.Ui(t,e,n)},Ic.prototype.Qi=function(t,e,n){var r=this;e.forEach(function(t){r.xi(t)}),this.currentUser=t,n.forEach(function(t){r.Ni(t)})},Ic.prototype.Wi=function(t){this.ji(t)},Ic.prototype.Ki=function(){this.Gi()},Ic.prototype.vi=function(){this.wi&&(this.window.removeEventListener("storage",this._i),this.removeItem(this.Ti),this.wi=!1)},Ic.prototype.getItem=function(t){var e=this.storage.getItem(t);return xr("SharedClientState","READ",t,e),e},Ic.prototype.setItem=function(t,e){xr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},Ic.prototype.removeItem=function(t){xr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},Ic.prototype.fi=function(t){var e=this,o=t;if(o.storageArea===this.storage){if(xr("SharedClientState","EVENT",o.key,o.newValue),o.key===this.Ti)return void Rr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ln.Ss(function(){return y(e,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){if(this.wi){if(null!==o.key)if(this.Ii.test(o.key)){if(null==o.newValue)return e=this.zi(o.key),[2,this.Hi(e,null)];if(e=this.Ji(o.key,o.newValue))return[2,this.Hi(e.clientId,e)]}else if(this.Ai.test(o.key)){if(null!==o.newValue&&(n=this.Yi(o.key,o.newValue)))return[2,this.Xi(n)]}else if(this.Ri.test(o.key)){if(null!==o.newValue&&(r=this.Zi(o.key,o.newValue)))return[2,this.tr(r)]}else if(o.key===this.Pi){if(null!==o.newValue&&(i=this.pi(o.newValue)))return[2,this.bi(i)]}else if(o.key===this.Ei)(i=function(t){var e=ic.ii;if(null!=t)try{var n=JSON.parse(t);kr("number"==typeof n),e=n}catch(t){Rr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(o.newValue))!==ic.ii&&this.ti(i);else if(o.key===this.yi)return[2,this.hi.er()]}else this.mi.push(o);return[2]})})})}},Object.defineProperty(Ic.prototype,"Mi",{get:function(){return this.di.get(this.ci)},enumerable:!1,configurable:!0}),Ic.prototype.Vi=function(){this.setItem(this.Ti,this.Mi.oi())},Ic.prototype.Fi=function(t,e,n){n=new cc(this.currentUser,t,e,n),t=uc(this.persistenceKey,this.currentUser,t),this.setItem(t,n.oi())},Ic.prototype.xi=function(t){t=uc(this.persistenceKey,this.currentUser,t),this.removeItem(t)},Ic.prototype.ji=function(t){t={clientId:this.ci,onlineState:t},this.storage.setItem(this.Pi,JSON.stringify(t))},Ic.prototype.Ui=function(t,e,n){var r=ac(this.persistenceKey,t),n=new hc(t,e,n);this.setItem(r,n.oi())},Ic.prototype.Gi=function(){this.setItem(this.yi,"value-not-used")},Ic.prototype.zi=function(t){return(t=this.Ii.exec(t))?t[1]:null},Ic.prototype.Ji=function(t,e){return t=this.zi(t),lc.ri(t,e)},Ic.prototype.Yi=function(t,e){var n=this.Ai.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return cc.ri(new ec(n),t,e)},Ic.prototype.Zi=function(t,e){return t=this.Ri.exec(t),t=Number(t[1]),hc.ri(t,e)},Ic.prototype.pi=function(t){return fc.ri(t)},Ic.prototype.Xi=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.hi.nr(e.batchId,e.state,e.error)]:(xr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},Ic.prototype.tr=function(t){return this.hi.sr(t.targetId,t.state,t.error)},Ic.prototype.Hi=function(t,e){var n=this,r=e?this.di.rt(t,e):this.di.remove(t),i=this.Di(this.di),o=this.Di(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.hi.ir(s,u).then(function(){n.di=r})},Ic.prototype.bi=function(t){this.di.get(t.clientId)&&this.li(t.onlineState)},Ic.prototype.Di=function(t){var n=lo;return t.forEach(function(t,e){n=n.xt(e.activeTargetIds)}),n},Ic),yc=(Ec.prototype.Ni=function(t){},Ec.prototype.$i=function(t,e,n){},Ec.prototype.ki=function(t){return this.rr.ai(t),this.ar[t]||"not-current"},Ec.prototype.qi=function(t,e,n){this.ar[t]=e},Ec.prototype.Oi=function(t){this.rr.ui(t)},Ec.prototype.Li=function(t){return this.rr.activeTargetIds.has(t)},Ec.prototype.Bi=function(t){delete this.ar[t]},Ec.prototype.Si=function(){return this.rr.activeTargetIds},Ec.prototype.Ci=function(t){return this.rr.activeTargetIds.has(t)},Ec.prototype.start=function(){return this.rr=new pc,Promise.resolve()},Ec.prototype.Qi=function(t,e,n){},Ec.prototype.Wi=function(t){},Ec.prototype.vi=function(){},Ec.prototype.si=function(t){},Ec.prototype.Ki=function(){},Ec),vc=(bc.prototype.cr=function(t,e,n){for(var r,i,o,s,u,a,c=n.hr,h=0;h<this.mutations.length;h++){var l=this.mutations[h];l.key.isEqual(t)&&(r=l,i=e,o=c[h],a=u=s=void 0,e=r instanceof tu?new Iu(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof eu?(u=i,a=o,Hs((s=r).Ke,u)?(u=iu(s,u),new Iu(s.key,a.version,u,{hasCommittedMutations:!0})):new _u(s.key,a.version)):r instanceof su?function(t,e,n){if(kr(null!=n.transformResults),!Hs(t.Ke,e))return new _u(t.key,n.version);var r=e,e=function(t,e,n){var r=[];kr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Iu&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof Rs?Ps(o,s):o instanceof Ls?Us(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=au(t,r.data(),e);return new Iu(t.key,n,e,{hasCommittedMutations:!0})}(r,i,o):new Tu(r.key,o.version,{hasCommittedMutations:!0}))}return e},bc.prototype.lr=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Xs(i,e,e,this.ur))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Xs(a,e,o,this.ur))}return e},bc.prototype._r=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.lr(t.key,n.get(t.key));e&&(i=i.rt(t.key,e))}),i},bc.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},ho())},bc.prototype.isEqual=function(t){return this.batchId===t.batchId&&yi(this.mutations,t.mutations,Ys)&&yi(this.baseMutations,t.baseMutations,Ys)},bc),gc=(wc.from=function(t,e,n){kr(t.mutations.length===n.length);for(var r=ao,i=t.mutations,o=0;o<i.length;o++)r=r.rt(i[o].key,n[o].version);return new wc(t,e,n,r)},wc),h=(mc.prototype.Er=function(t){return(t=this.mr.get(t))?t.readTime:Ri.min()},mc.prototype.Ir=function(t,e){this.Ar(),this.mr.set(t.key,{Rr:t,readTime:e})},mc.prototype.Pr=function(t,e){void 0===e&&(e=null),this.Ar(),this.mr.set(t,{Rr:null,readTime:e})},mc.prototype.yr=function(t,e){this.Ar();var n=this.mr.get(e);return void 0!==n?Aa.resolve(n.Rr):this.gr(t,e)},mc.prototype.getEntries=function(t,e){return this.Vr(t,e)},mc.prototype.apply=function(t){return this.Ar(),this.Tr=!0,this.pr(t)},mc.prototype.Ar=function(){},mc);function mc(){this.mr=new Si(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Tr=!1}function wc(t,e,n,r){this.batch=t,this.dr=e,this.hr=n,this.wr=r}function bc(t,e,n,r){this.batchId=t,this.ur=e,this.baseMutations=n,this.mutations=r}function Ec(){this.rr=new pc,this.ar={},this.li=null,this.ti=null}function Ic(t,e,n,r,i){this.window=t,this.ln=e,this.persistenceKey=n,this.ci=r,this.hi=null,this.li=null,this.ti=null,this._i=this.fi.bind(this),this.di=new Xi(di),this.wi=!1,this.mi=[],n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),this.storage=this.window.localStorage,this.currentUser=i,this.Ti=sc(this.persistenceKey,this.ci),this.Ei="firestore_sequence_number_"+this.persistenceKey,this.di=this.di.rt(this.ci,new pc),this.Ii=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.Ai=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.Ri=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.Pi="firestore_online_state_"+this.persistenceKey,this.yi="firestore_bundle_loaded_"+this.persistenceKey,this.window.addEventListener("storage",this._i)}function Tc(){this.activeTargetIds=lo}function _c(t,e){this.clientId=t,this.onlineState=e}function Ac(t,e){this.clientId=t,this.activeTargetIds=e}function Nc(t,e,n){this.targetId=t,this.state=e,this.error=n}function Sc(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function xc(n,r){void 0===r&&(r=10240);var i=0;return{read:function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return i<n.byteLength?(e={value:n.slice(i,i+r),done:!1},[2,(i+=r,e)]):[2,{value:void 0,done:!0}]})})},cancel:function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2]})})},releaseLock:function(){}}}function Rc(t,e){if(t instanceof Uint8Array)return xc(t,e);if(t instanceof ArrayBuffer)return xc(new Uint8Array(t),e);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}function Dc(t){return new $o(t,!0)}var Oc=(Uc.prototype.br=function(){return"metadata"in this.payload},Uc),Pc=(Cc.Cr=function(t,e){return new Cc(Rc(t,10240),e)},Cc.prototype.close=function(){return this.vr.cancel()},Cc.prototype.getMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.metadata.promise]})})},Cc.prototype.Nr=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Dr())]}})})},Cc.prototype.Dr=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return[4,this.Fr()];case 1:return null===(e=t.sent())?[2,null]:(r=this.Sr.decode(e),n=Number(r),isNaN(n)&&this.$r("length string ("+r+") is not valid number"),[4,this.kr(n)]);case 2:return r=t.sent(),[2,new Oc(JSON.parse(r),e.length+n)]}})})},Cc.prototype.Mr=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},Cc.prototype.Fr=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.Mr()<0?[4,this.Or()]:[3,3];case 1:if(t.sent())return[3,3];t.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.Mr())<0&&this.$r("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),n)])}})})},Cc.prototype.kr=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.buffer.length<n?[4,this.Or()]:[3,3];case 1:t.sent()&&this.$r("Reached the end of bundle when more is expected."),t.label=2;case 2:return[3,0];case 3:return e=this.Sr.decode(this.buffer.slice(0,n)),[2,(this.buffer=this.buffer.slice(n),e)]}})})},Cc.prototype.$r=function(t){throw this.vr.cancel(),new Error("Invalid bundle format: "+t)},Cc.prototype.Or=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.vr.read()];case 1:return(e=t.sent()).done||((n=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n),[2,e.done]}})})},Cc),kc=(Lc.prototype.Lr=function(t){return as(this.serializer,t)},Lc.prototype.Br=function(t){return t.metadata.exists?ds(this.serializer,t.document,!1):new Tu(this.Lr(t.metadata.name),this.qr(t.metadata.readTime))},Lc.prototype.qr=is,Lc);function Lc(t){this.serializer=t}function Cc(t,e){var n=this;this.vr=t,this.serializer=e,this.metadata=new Ia,this.buffer=new Uint8Array,this.Sr=new TextDecoder("utf-8"),this.Dr().then(function(t){t&&t.br()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function Uc(t,e){this.payload=t,this.byteLength=e}function Mc(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}function Vc(t,e){this.progress=t,this.Ur=e}var jc=(Qc.prototype.jr=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},Qc.prototype.Kr=function(t){for(var e=new Map,n=new kc(this.serializer),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.Lr(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||ho()).add(s);e.set(c,h)}}return e},Qc.prototype.complete=function(){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return[4,function(f,p,d){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a,c,h,l;return v(this,function(t){switch(t.label){case 0:for(e=new kc((n=f).serializer),r=ho(),i=io,o=ao,s=0,u=p;s<u.length;s++)a=u[s],c=e.Lr(a.metadata.name),a.document&&(r=r.add(c)),i=i.rt(c,e.Br(a)),o=o.rt(c,e.qr(a.metadata.readTime));return h=n.zr.Gr({Hr:!0}),[4,Cl(n,Mu(Du(jr.P("__bundle__/docs/"+d))))];case 1:return l=t.sent(),[2,n.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return Ll(e,h,i,Ri.min(),o).next(function(t){return h.apply(e),t}).next(function(t){return n.Yr.Jr(e,l.targetId).next(function(){return n.Yr.Xr(e,r,l.targetId)}).next(function(){return n.eo.Zr(e,t)})})})]}})})}(this.Wr,this.documents,this.Qr.id)];case 1:e=t.sent(),n=this.Kr(this.documents),r=0,i=this.queries,t.label=2;case 2:return r<i.length?(i=i[r],[4,function(e,i,o){return void 0===o&&(o=ho()),y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return[4,Cl(e,Mu(vh(i.bundledQuery)))];case 1:return n=t.sent(),[2,(r=e).persistence.runTransaction("Save named query","readwrite",function(t){var e=is(i.readTime);return 0<=n.et.L(e)?r.Au.Ba(t,i):(e=n.st(gi.B,e),r.ec=r.ec.rt(e.targetId,e),r.Yr.tu(t,e).next(function(){return r.Yr.Jr(t,n.targetId)}).next(function(){return r.Yr.Xr(t,o,n.targetId)}).next(function(){return r.Au.Ba(t,i)}))})]}})})}(this.Wr,i,n.get(i.name))]):[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Vc(Object.assign({},this.progress),e))]}})})},Qc),Fc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ee=(zc.prototype.so=function(t){this.no.push(t)},zc.prototype.io=function(){this.no.forEach(function(t){return t()})},zc),qc=(Wc.prototype.uo=function(e,n){var r=this;return this.oo.co(e,n).next(function(t){return r.ho(e,n,t)})},Wc.prototype.ho=function(t,r,i){return this.ro.yr(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].lr(r,t);return t})},Wc.prototype.lo=function(t,e,i){var o=io;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].lr(t,e);o=o.rt(t,e)}),o},Wc.prototype._o=function(e,t){var n=this;return this.ro.getEntries(e,t).next(function(t){return n.Zr(e,t)})},Wc.prototype.Zr=function(e,r){var i=this;return this.oo.fo(e,r).next(function(t){var t=i.lo(e,r,t),n=io;return t.forEach(function(t,e){e=e||new Tu(t,Ri.min()),n=n.rt(t,e)}),n})},Wc.prototype.wo=function(t,e,n){return r=e,Br.F(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.mo(t,e.path):Cu(e)?this.To(t,e,n):this.Eo(t,e,n);var r},Wc.prototype.mo=function(t,e){return this.uo(t,new Br(e)).next(function(t){var e=uo;return t instanceof Iu&&(e=e.rt(t.key,t)),e})},Wc.prototype.To=function(n,r,i){var o=this,s=r.collectionGroup,u=uo;return this.ao.Io(n,s).next(function(t){return Aa.forEach(t,function(t){var e=(e=r,t=t.child(s),new Au(t,null,e.rn.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.Eo(n,e,i).next(function(t){t.forEach(function(t,e){u=u.rt(t,e)})})}).next(function(){return u})})},Wc.prototype.Eo=function(e,n,t){var c,h,r=this;return this.ro.wo(e,n,t).next(function(t){return c=t,r.oo.Ao(e,n)}).next(function(t){return h=t,r.Ro(e,h,c).next(function(t){c=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=Xs(s,a=c.get(u),a,r.ur);c=a instanceof Iu?c.rt(u,a):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){Wu(n,e)||(c=c.remove(t))}),c})},Wc.prototype.Ro=function(t,e,n){for(var r=ho(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof eu&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.ro.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Iu&&(c=c.rt(t,e))}),c})},Wc),Bc=(Gc.Vo=function(t,e){for(var n=ho(),r=ho(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Gc(t,e.fromCache,n,r)},Gc);function Gc(t,e,n,r){this.targetId=t,this.fromCache=e,this.Po=n,this.yo=r}function Wc(t,e,n){this.ro=t,this.oo=e,this.ao=n}function zc(){this.no=[]}function Qc(t,e,n){this.Qr=t,this.Wr=e,this.serializer=n,this.queries=[],this.documents=[],this.progress=Mc(t)}function Kc(t,e){var n=t[0],r=t[1],t=e[0],e=e[1];return 0===(t=di(n,t))?di(r,e):t}var Hc=($c.prototype.vo=function(){return++this.bo},$c.prototype.So=function(t){var e=[t,this.vo()];this.buffer.size<this.po?this.buffer=this.buffer.add(e):Kc(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty($c.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),$c),Xc={Do:!1,Co:0,No:0,Fo:0},Yc=(Jc.Mo=function(t){return new Jc(t,Jc.Oo,Jc.Lo)},Jc);function Jc(t,e,n){this.$o=t,this.xo=e,this.ko=n}function $c(t){this.po=t,this.buffer=new no(Kc),this.bo=0}Yc.Bo=-1,Yc.qo=1048576,Yc.Uo=41943040,Yc.Oo=10,Yc.Lo=1e3,Yc.Qo=new Yc(Yc.Uo,Yc.Oo,Yc.Lo),Yc.Wo=new Yc(Yc.Bo,0,0);var Zc=(nh.prototype.start=function(t){this.jo.params.$o!==Yc.Bo&&this.zo(t)},nh.prototype.stop=function(){this.Go&&(this.Go.cancel(),this.Go=null)},Object.defineProperty(nh.prototype,"wi",{get:function(){return null!==this.Go},enumerable:!1,configurable:!0}),nh.prototype.zo=function(n){var t=this,e=this.Ko?3e5:6e4;xr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.Go=this.rs.Pn("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.Go=null,this.Ko=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.Ho(this.jo)];case 2:return t.sent(),[3,7];case 3:return La(e=t.sent())?(xr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Fl(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.zo(n)];case 8:return t.sent(),[2]}})})})},nh),th=(eh.prototype.Yo=function(t,e){return this.Jo.Xo(t).next(function(t){return Math.floor(e/100*t)})},eh.prototype.Zo=function(t,e){var n=this;if(0===e)return Aa.resolve(ic.ii);var r=new Hc(e);return this.Jo.De(t,function(t){return r.So(t.sequenceNumber)}).next(function(){return n.Jo.ta(t,function(t){return r.So(t)})}).next(function(){return r.maxValue})},eh.prototype.ea=function(t,e,n){return this.Jo.ea(t,e,n)},eh.prototype.na=function(t,e){return this.Jo.na(t,e)},eh.prototype.sa=function(e,n){var r=this;return this.params.$o===Yc.Bo?(xr("LruGarbageCollector","Garbage collection skipped; disabled"),Aa.resolve(Xc)):this.ia(e).next(function(t){return t<r.params.$o?(xr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.$o),Xc):r.ra(e,n)})},eh.prototype.ia=function(t){return this.Jo.ia(t)},eh.prototype.ra=function(e,n){var r,i,o,s,u,a,c,h=this,l=Date.now();return this.Yo(e,this.params.xo).next(function(t){return i=t>h.params.ko?(xr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.ko+" from "+t),h.params.ko):t,s=Date.now(),h.Zo(e,i)}).next(function(t){return r=t,u=Date.now(),h.ea(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.na(e,r)}).next(function(t){return c=Date.now(),Sr()<=f.DEBUG&&xr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-l)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-l)+"ms"),Aa.resolve({Do:!0,Co:i,No:o,Fo:t})})},eh);function eh(t,e){this.Jo=t,this.params=e}function nh(t,e){this.jo=t,this.rs=e,this.Ko=!1,this.Go=null}function rh(t){for(var o="",e=0;e<t.length;e++)0<o.length&&(o=ih(o)),o=function(t){for(var e=o,n=t.length,r=0;r<n;r++){var i=t.charAt(r);switch(i){case"\0":e+="";break;case"":e+="";break;default:e+=i}}return e}(t.get(e));return ih(o)}function ih(t){return t+""}function oh(t){var e=t.length;if(kr(2<=e),2===e)return kr(""===t.charAt(0)&&""===t.charAt(1)),jr.g();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&Pr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Pr()}o=s+2}return new jr(r)}var sh=function(t){this.oa=t};function uh(t,e){if(e.document)return ds(t.oa,e.document,!!e.hasCommittedMutations);if(e.noDocument){var t=Br.$(e.noDocument.path),n=fh(e.noDocument.readTime);return new Tu(t,n,{hasCommittedMutations:!!e.hasCommittedMutations})}return e.unknownDocument?(n=Br.$(e.unknownDocument.path),e=fh(e.unknownDocument.version),new _u(n,e)):Pr()}function ah(t,e,n){var r=ch(n),n=e.key.path.h().A();if(e instanceof Iu){var i={name:us(i=t.oa,(o=e).key),fields:o.sn().mapValue.fields,updateTime:ns(i,o.version.X())},o=e.hasCommittedMutations;return new Kh(null,null,i,o,r,n)}if(e instanceof Tu){var i=e.key.path.A(),o=lh(e.version),s=e.hasCommittedMutations;return new Kh(null,new zh(i,o),null,s,r,n)}return e instanceof _u?(s=e.key.path.A(),e=lh(e.version),new Kh(new Qh(s,e),null,null,!0,r,n)):Pr()}function ch(t){return[(t=t.X()).seconds,t.nanoseconds]}function hh(t){return t=new xi(t[0],t[1]),Ri.J(t)}function lh(t){return t=t.X(),new Uh(t.seconds,t.nanoseconds)}function fh(t){return t=new xi(t.seconds,t.nanoseconds),Ri.J(t)}function ph(e,t){var n=(t.baseMutations||[]).map(function(t){return vs(e.oa,t)}),r=t.mutations.map(function(t){return vs(e.oa,t)}),i=xi.fromMillis(t.localWriteTimeMs);return new vc(t.batchId,i,n,r)}function dh(t){var e=fh(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?fh(t.lastLimboFreeSnapshotVersion):Ri.min(),r=void 0!==t.query.documents?(kr(1===(r=t.query).documents.length),Mu(Du(hs(r.documents[0])))):Mu(ws(t.query));return new zi(r,t.targetId,0,t.lastListenSequenceNumber,e,n,gi.fromBase64String(t.resumeToken))}function yh(t,e){var n=lh(e.et),r=lh(e.lastLimboFreeSnapshotVersion),i=(Bi(e.target)?gs:ms)(t.oa,e.target),t=e.resumeToken.toBase64();return new Xh(e.targetId,Fi(e.target),n,t,e.sequenceNumber,r,i)}function vh(t){var e=ws({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Vu(e,e.limit,"L"):e}var gh=(mh.ca=function(t,e,n,r){return kr(""!==t.uid),new mh(t.Js()?t.uid:"",e,n,r)},mh.prototype.ha=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Eh(t).ns({index:Bh.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},mh.prototype.la=function(d,y,v,g){var m=this,w=Ih(d),b=Eh(d);return b.add({}).next(function(t){kr("number"==typeof t);for(var e,n,r,i,o,s=new vc(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return ys(e.oa,t)}),o=r.mutations.map(function(t){return ys(e.oa,t)}),new Bh(n,r.batchId,r.ur.toMillis(),i,o)),a=[],c=new no(function(t,e){return di(t.R(),e.R())}),h=0,l=g;h<l.length;h++){var f=l[h],p=Gh.key(m.userId,f.key.path,t),c=c.add(f.key.path.h());a.push(b.put(u)),a.push(w.put(p,Gh.PLACEHOLDER))}return c.forEach(function(t){a.push(m.ao._a(d,t))}),d.so(function(){m.ua[t]=s.keys()}),Aa.Fn(a).next(function(){return s})})},mh.prototype.fa=function(t,e){var n=this;return Eh(t).get(e).next(function(t){return t?(kr(t.userId===n.userId),ph(n.serializer,t)):null})},mh.prototype.da=function(t,e){var n=this;return this.ua[e]?Aa.resolve(this.ua[e]):this.fa(t,e).next(function(t){return t?(t=t.keys(),n.ua[e]=t):null})},mh.prototype.wa=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return Eh(t).ns({index:Bh.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(kr(e.batchId>=i),o=ph(r.serializer,e)),n.done()}).next(function(){return o})},mh.prototype.ma=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Eh(t).ns({index:Bh.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},mh.prototype.Ta=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Eh(t).Xn(Bh.userMutationsIndex,n).next(function(t){return t.map(function(t){return ph(e.serializer,t)})})},mh.prototype.co=function(o,s){var u=this,t=Gh.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return Ih(o).ns({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=oh(i);if(r===u.userId&&s.path.isEqual(i))return Eh(o).get(t).next(function(t){if(!t)throw Pr();kr(t.userId===u.userId),a.push(ph(u.serializer,t))});n.done()}).next(function(){return a})},mh.prototype.fo=function(e,t){var s=this,u=new no(di),n=[];return t.forEach(function(o){var t=Gh.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=Ih(e).ns({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=oh(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),Aa.Fn(n).next(function(){return s.Ea(e,u)})},mh.prototype.Ao=function(t,e){var o=this,s=e.path,u=s.length+1,e=Gh.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new no(di);return Ih(t).ns({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=oh(i);r===o.userId&&s.T(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.Ea(t,a)})},mh.prototype.Ea=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(Eh(e).get(t).next(function(t){if(null===t)throw Pr();kr(t.userId===n.userId),r.push(ph(n.serializer,t))}))}),Aa.Fn(i).next(function(){return r})},mh.prototype.Ia=function(e,n){var r=this;return bh(e.Aa,this.userId,n).next(function(t){return e.so(function(){r.Ra(n.batchId)}),Aa.forEach(t,function(t){return r.aa.Pa(e,t)})})},mh.prototype.Ra=function(t){delete this.ua[t]},mh.prototype.ya=function(e){var i=this;return this.ha(e).next(function(t){if(!t)return Aa.resolve();var t=IDBKeyRange.lowerBound(Gh.prefixForUser(i.userId)),r=[];return Ih(e).ns({range:t},function(t,e,n){t[0]===i.userId?(t=oh(t[1]),r.push(t)):n.done()}).next(function(){kr(0===r.length)})})},mh.prototype.ga=function(t,e){return wh(t,this.userId,e)},mh.prototype.Va=function(t){var e=this;return Th(t).get(this.userId).next(function(t){return t||new qh(e.userId,-1,"")})},mh);function mh(t,e,n,r){this.userId=t,this.serializer=e,this.ao=n,this.aa=r,this.ua={}}function wh(t,o,e){var s=(e=Gh.prefixForPath(o,e.path))[1],e=IDBKeyRange.lowerBound(e),u=!1;return Ih(t).ns({range:e,es:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function bh(t,e,n){var r=t.store(Bh.store),i=t.store(Gh.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r.ns({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){kr(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],l=Gh.key(e,h.key.path,n.batchId);o.push(i.delete(l)),u.push(h.key)}return Aa.Fn(o).next(function(){return u})}function Eh(t){return El.qn(t,Bh.store)}function Ih(t){return El.qn(t,Gh.store)}function Th(t){return El.qn(t,qh.store)}var _h,Ah=(xh.prototype.Ir=function(t,e,n){return Dh(t).put(Oh(e),n)},xh.prototype.Pr=function(t,e){return t=Dh(t),e=Oh(e),t.delete(e)},xh.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.pa(e,t)})},xh.prototype.yr=function(t,e){var n=this;return Dh(t).get(Oh(e)).next(function(t){return n.ba(t)})},xh.prototype.va=function(t,e){var n=this;return Dh(t).get(Oh(e)).next(function(t){var e=n.ba(t);return e?{Rr:e,size:Ph(t)}:null})},xh.prototype.getEntries=function(t,e){var n=this,r=io;return this.Sa(t,e,function(t,e){e=n.ba(e),r=r.rt(t,e)}).next(function(){return r})},xh.prototype.Da=function(t,e){var r=this,i=io,o=new Xi(Br.i);return this.Sa(t,e,function(t,e){var n=r.ba(e);o=n?(i=i.rt(t,n),o.rt(t,Ph(e))):(i=i.rt(t,null),o.rt(t,0))}).next(function(){return{Ca:i,Na:o}})},xh.prototype.Sa=function(t,e,i){if(e.m())return Aa.resolve();var n=IDBKeyRange.bound(e.first().path.A(),e.last().path.A()),o=e.lt(),s=o.Et();return Dh(t).ns({range:n},function(t,e,n){for(var r=Br.$(t);s&&Br.i(s,r)<0;)i(s,null),s=o.Et();s&&s.isEqual(r)&&(i(s,e),s=o.It()?o.Et():null),s?n.Jn(s.path.A()):n.done()}).next(function(){for(;s;)i(s,null),s=o.It()?o.Et():null})},xh.prototype.wo=function(t,r,e){var n,i=this,o=uo,s=r.path.length+1,u={};return e.isEqual(Ri.min())?(n=r.path.A(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.A(),e=ch(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=Kh.collectionReadTimeIndex),Dh(t).ns(u,function(t,e,n){t.length===s&&(e=uh(i.serializer,e),r.path.T(e.key.path)?e instanceof Iu&&Wu(r,e)&&(o=o.rt(e.key,e)):n.done())}).next(function(){return o})},xh.prototype.Gr=function(t){return new Nh(this,!!t&&t.Hr)},xh.prototype.Fa=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},xh.prototype.getMetadata=function(t){return Rh(t).get(Hh.key).next(function(t){return kr(!!t),t})},xh.prototype.pa=function(t,e){return Rh(t).put(Hh.key,e)},xh.prototype.ba=function(t){return!t||(t=uh(this.serializer,t))instanceof Tu&&t.version.isEqual(Ri.min())?null:t},xh),Nh=(n(Sh,_h=h),Sh.prototype.pr=function(i){var o=this,s=[],u=0,a=new no(function(t,e){return di(t.R(),e.R())});return this.mr.forEach(function(t,e){var n,r=o.xa.get(t);e.Rr?(n=ah(o.$a.serializer,e.Rr,o.Er(t)),a=a.add(t.path.h()),e=Ph(n),u+=e-r,s.push(o.$a.Ir(i,t,n))):(u-=r,o.Hr?(r=ah(o.$a.serializer,new Tu(t,Ri.min()),o.Er(t)),s.push(o.$a.Ir(i,t,r))):s.push(o.$a.Pr(i,t)))}),a.forEach(function(t){s.push(o.$a.ao._a(i,t))}),s.push(this.$a.updateMetadata(i,u)),Aa.Fn(s)},Sh.prototype.gr=function(t,e){var n=this;return this.$a.va(t,e).next(function(t){return null===t?(n.xa.set(e,0),null):(n.xa.set(e,t.size),t.Rr)})},Sh.prototype.Vr=function(t,e){var n=this;return this.$a.Da(t,e).next(function(t){var e=t.Ca;return t.Na.forEach(function(t,e){n.xa.set(t,e)}),e})},Sh);function Sh(t,e){var n=this;return(n=_h.call(this)||this).$a=t,n.Hr=e,n.xa=new Si(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function xh(t,e){this.serializer=t,this.ao=e}function Rh(t){return El.qn(t,Hh.store)}function Dh(t){return El.qn(t,Kh.store)}function Oh(t){return t.path.A()}function Ph(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Pr();e=t.noDocument}return JSON.stringify(e).length}var kh=(Fh.prototype._a=function(t,e){return this.ka.add(e),Aa.resolve()},Fh.prototype.Io=function(t,e){return Aa.resolve(this.ka.getEntries(e))},Fh),Lh=(jh.prototype.add=function(t){var e=t._(),n=t.h(),r=this.index[e]||new no(jr.i),t=!r.has(n);return this.index[e]=r.add(n),t},jh.prototype.has=function(t){var e=t._(),t=t.h();return(e=this.index[e])&&e.has(t)},jh.prototype.getEntries=function(t){return(this.index[t]||new no(jr.i)).A()},jh),Ch=(Vh.prototype.createOrUpgrade=function(e,n,t,r){var i=this;kr(t<r&&0<=t&&r<=11);var o=new Ca("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(Mh.store),(s=e).createObjectStore(qh.store,{keyPath:qh.keyPath}),s.createObjectStore(Bh.store,{keyPath:Bh.keyPath,autoIncrement:!0}).createIndex(Bh.userMutationsIndex,Bh.userMutationsKeyPath,{unique:!0}),s.createObjectStore(Gh.store),Zh(e),e.createObjectStore(Kh.store));var s,u=Aa.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(Yh.store),s.deleteObjectStore(Xh.store),s.deleteObjectStore(Jh.store),Zh(e)),u=u.next(function(){return t=o.store(Jh.store),e=new Jh(0,0,Ri.min().X(),0),t.put(Jh.key,e);var t,e})),t<4&&4<=r&&(0!==t&&(u=u.next(function(){return n=e,(r=o).store(Bh.store).Xn().next(function(t){n.deleteObjectStore(Bh.store),n.createObjectStore(Bh.store,{keyPath:Bh.keyPath,autoIncrement:!0}).createIndex(Bh.userMutationsIndex,Bh.userMutationsKeyPath,{unique:!0});var e=r.store(Bh.store),t=t.map(function(t){return e.put(t)});return Aa.Fn(t)});var n,r})),u=u.next(function(){e.createObjectStore(tl.store,{keyPath:tl.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.removeAcknowledgedMutations(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(Hh.store),i.addDocumentGlobal(o)})),t<7&&7<=r&&(u=u.next(function(){return i.ensureSequenceNumbers(o)})),t<8&&8<=r&&(u=u.next(function(){return i.createCollectionParentIndex(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(Kh.store)).createIndex(Kh.readTimeIndex,Kh.readTimeIndexPath,{unique:!1}),t.createIndex(Kh.collectionReadTimeIndex,Kh.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.rewriteCanonicalIds(o)})),t<11&&11<=r&&(u=u.next(function(){e.createObjectStore(el.store,{keyPath:el.keyPath}),e.createObjectStore(nl.store,{keyPath:nl.keyPath})})),u},Vh.prototype.addDocumentGlobal=function(e){var n=0;return e.store(Kh.store).ns(function(t,e){n+=Ph(e)}).next(function(){var t=new Hh(n);return e.store(Hh.store).put(Hh.key,t)})},Vh.prototype.removeAcknowledgedMutations=function(n){var r=this,t=n.store(qh.store),i=n.store(Bh.store);return t.Xn().next(function(t){return Aa.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.Xn(Bh.userMutationsIndex,t).next(function(t){return Aa.forEach(t,function(t){return kr(t.userId===e.userId),t=ph(r.serializer,t),bh(n,e.userId,t).next(function(){})})})})})},Vh.prototype.ensureSequenceNumbers=function(t){var o=t.store(Yh.store),e=t.store(Kh.store);return t.store(Jh.store).get(Jh.key).next(function(r){var i=[];return e.ns(function(t,e){var n=new jr(t),t=[0,rh(n)];i.push(o.get(t).next(function(t){return t?Aa.resolve():o.put(new Yh(0,rh(n),r.highestListenSequenceNumber))}))}).next(function(){return Aa.Fn(i)})})},Vh.prototype.createCollectionParentIndex=function(t,e){function r(t){if(i.add(t)){var e=t._(),t=t.h();return n.put({collectionId:e,parent:rh(t)})}}t.createObjectStore($h.store,{keyPath:$h.keyPath});var n=e.store($h.store),i=new Lh;return e.store(Kh.store).ns({es:!0},function(t,e){return r((t=new jr(t)).h())}).next(function(){return e.store(Gh.store).ns({es:!0},function(t,e){t[0];var n=t[1];return r((n=(t[2],oh(n))).h())})})},Vh.prototype.rewriteCanonicalIds=function(t){var n=this,r=t.store(Xh.store);return r.ns(function(t,e){return e=dh(e),e=yh(n.serializer,e),r.put(e)})},Vh),Uh=function(t,e){this.seconds=t,this.nanoseconds=e},Mh=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function Vh(t){this.serializer=t}function jh(){this.index={}}function Fh(){this.ka=new Lh}Mh.store="owner",Mh.key="owner";var qh=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};qh.store="mutationQueues",qh.keyPath="userId";var Bh=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Bh.store="mutations",Bh.keyPath="batchId",Bh.userMutationsIndex="userMutationsIndex",Bh.userMutationsKeyPath=["userId","batchId"];var Gh=(Wh.prefixForUser=function(t){return[t]},Wh.prefixForPath=function(t,e){return[t,rh(e)]},Wh.key=function(t,e,n){return[t,rh(e),n]},Wh);function Wh(){}Gh.store="documentMutations",Gh.PLACEHOLDER=new Gh;var zh=function(t,e){this.path=t,this.readTime=e},Qh=function(t,e){this.path=t,this.version=e},Kh=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Kh.store="remoteDocuments",Kh.readTimeIndex="readTimeIndex",Kh.readTimeIndexPath="readTime",Kh.collectionReadTimeIndex="collectionReadTimeIndex",Kh.collectionReadTimeIndexPath=["parentPath","readTime"];var Hh=function(t){this.byteSize=t};Hh.store="remoteDocumentGlobal",Hh.key="remoteDocumentGlobalKey";var Xh=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Xh.store="targets",Xh.keyPath="targetId",Xh.queryTargetsIndexName="queryTargetsIndex",Xh.queryTargetsKeyPath=["canonicalId","targetId"];var Yh=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Yh.store="targetDocuments",Yh.keyPath=["targetId","path"],Yh.documentTargetsIndex="documentTargetsIndex",Yh.documentTargetsKeyPath=["path","targetId"];var Jh=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Jh.key="targetGlobalKey",Jh.store="targetGlobal";var $h=function(t,e){this.collectionId=t,this.parent=e};function Zh(t){t.createObjectStore(Yh.store,{keyPath:Yh.keyPath}).createIndex(Yh.documentTargetsIndex,Yh.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Xh.store,{keyPath:Xh.keyPath}).createIndex(Xh.queryTargetsIndexName,Xh.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Jh.store)}$h.store="collectionParents",$h.keyPath=["collectionId","parent"];var tl=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};tl.store="clientMetadata",tl.keyPath="clientId";var el=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};el.store="bundles",el.keyPath="bundleId";var nl=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};nl.store="namedQueries",nl.keyPath="name";var rl=i(i(i(i([qh.store,Bh.store,Gh.store,Kh.store,Xh.store,Mh.store,Jh.store,Yh.store],[tl.store]),[Hh.store]),[$h.store]),[el.store,nl.store]),il=(ol.prototype.Ma=function(t,e){return sl(t).get(e).next(function(t){if(t)return{id:(t=t).bundleId,createTime:fh(t.createTime),version:t.version}})},ol.prototype.Oa=function(t,e){return sl(t).put({bundleId:(e=e).id,createTime:lh(is(e.createTime)),version:e.version})},ol.prototype.La=function(t,e){return ul(t).get(e).next(function(t){if(t)return{name:(t=t).name,query:vh(t.bundledQuery),readTime:fh(t.readTime)}})},ol.prototype.Ba=function(t,e){return ul(t).put({name:(e=e).name,readTime:lh(is(e.readTime)),bundledQuery:e.bundledQuery})},ol);function ol(t){this.serializer=t}function sl(t){return El.qn(t,el.store)}function ul(t){return El.qn(t,nl.store)}var al=(cl.prototype._a=function(t,e){var n=this;if(this.qa.has(e))return Aa.resolve();var r=e._(),i=e.h();return t.so(function(){n.qa.add(e)}),i={collectionId:r,parent:rh(i)},hl(t).put(i)},cl.prototype.Io=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[vi(i),""],!1,!0);return hl(t).Xn(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(oh(r.parent))}return o})},cl);function cl(){this.qa=new Lh}function hl(t){return El.qn(t,$h.store)}var ll=(dl.prototype.next=function(){return this.Ua+=2,this.Ua},dl.Qa=function(){return new dl(0)},dl.Wa=function(){return new dl(-1)},dl),fl=(pl.prototype.ja=function(n){var r=this;return this.Ka(n).next(function(t){var e=new ll(t.highestTargetId);return t.highestTargetId=e.next(),r.Ga(n,t).next(function(){return t.highestTargetId})})},pl.prototype.za=function(t){return this.Ka(t).next(function(t){return Ri.J(new xi(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},pl.prototype.Ha=function(t){return this.Ka(t).next(function(t){return t.highestListenSequenceNumber})},pl.prototype.Ja=function(e,n,r){var i=this;return this.Ka(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.X()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.Ga(e,t)})},pl.prototype.Ya=function(e,n){var r=this;return this.Xa(e,n).next(function(){return r.Ka(e).next(function(t){return t.targetCount+=1,r.Za(n,t),r.Ga(e,t)})})},pl.prototype.tu=function(t,e){return this.Xa(t,e)},pl.prototype.eu=function(e,t){var n=this;return this.Jr(e,t.targetId).next(function(){return yl(e).delete(t.targetId)}).next(function(){return n.Ka(e)}).next(function(t){return kr(0<t.targetCount),--t.targetCount,n.Ga(e,t)})},pl.prototype.ea=function(n,r,i){var o=this,s=0,u=[];return yl(n).ns(function(t,e){(e=dh(e)).sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.eu(n,e)))}).next(function(){return Aa.Fn(u)}).next(function(){return s})},pl.prototype.De=function(t,n){return yl(t).ns(function(t,e){e=dh(e),n(e)})},pl.prototype.Ka=function(t){return vl(t).get(Jh.key).next(function(t){return kr(null!==t),t})},pl.prototype.Ga=function(t,e){return vl(t).put(Jh.key,e)},pl.prototype.Xa=function(t,e){return yl(t).put(yh(this.serializer,e))},pl.prototype.Za=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},pl.prototype.nu=function(t){return this.Ka(t).next(function(t){return t.targetCount})},pl.prototype.su=function(t,r){var e=Fi(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return yl(t).ns({range:e,index:Xh.queryTargetsIndexName},function(t,e,n){e=dh(e),qi(r,e.target)&&(i=e,n.done())}).next(function(){return i})},pl.prototype.Xr=function(n,t,r){var i=this,o=[],s=gl(n);return t.forEach(function(t){var e=rh(t.path);o.push(s.put(new Yh(r,e))),o.push(i.aa.iu(n,r,t))}),Aa.Fn(o)},pl.prototype.ru=function(n,t,r){var i=this,o=gl(n);return Aa.forEach(t,function(t){var e=rh(t.path);return Aa.Fn([o.delete([r,e]),i.aa.ou(n,r,t)])})},pl.prototype.Jr=function(t,e){return t=gl(t),e=IDBKeyRange.bound([e],[e+1],!1,!0),t.delete(e)},pl.prototype.au=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=gl(t),r=ho();return t.ns({range:e,es:!0},function(t,e,n){t=oh(t[1]),t=new Br(t),r=r.add(t)}).next(function(){return r})},pl.prototype.ga=function(t,e){var e=rh(e.path),e=IDBKeyRange.bound([e],[vi(e)],!1,!0),i=0;return gl(t).ns({index:Yh.documentTargetsIndex,es:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},pl.prototype.qe=function(t,e){return yl(t).get(e).next(function(t){return t?dh(t):null})},pl);function pl(t,e){this.aa=t,this.serializer=e}function dl(t){this.Ua=t}function yl(t){return El.qn(t,Xh.store)}function vl(t){return El.qn(t,Jh.store)}function gl(t){return El.qn(t,Yh.store)}var ml,wl="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",bl=(n(Tl,ml=Ee),Tl),El=(Il.qn=function(t,e){if(t instanceof bl)return Na.qn(t.Aa,e);throw Pr()},Il.prototype.start=function(){var e=this;return this.Pu().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Tr(Ir.FAILED_PRECONDITION,wl);return e.yu(),e.gu(),e.Vu(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.Yr.Ha(t)})}).then(function(t){e.lu=new ic(t,e.cu)}).then(function(){e._u=!0}).catch(function(t){return e.Iu&&e.Iu.close(),Promise.reject(t)})},Il.prototype.pu=function(n){var t=this;return this.Tu=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.wi?[2,n(e)]:[2]})})},n(this.isPrimary)},Il.prototype.bu=function(n){var t=this;this.Iu.Wn(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},Il.prototype.vu=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.ln.fs(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.wi?[4,this.Pu()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},Il.prototype.Pu=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Al(e).put(new tl(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.Su(e).next(function(t){t||(n.isPrimary=!1,n.ln.Ss(function(){return n.Tu(!1)}))})}).next(function(){return n.Du(e)}).next(function(t){return n.isPrimary&&!t?n.Cu(e).next(function(){return!1}):!!t&&n.Nu(e).next(function(){return!0})})}).catch(function(t){if(La(t))return xr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return xr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.ln.Ss(function(){return n.Tu(t)}),n.isPrimary=t})},Il.prototype.Su=function(t){var e=this;return _l(t).get(Mh.key).next(function(t){return Aa.resolve(e.Fu(t))})},Il.prototype.$u=function(t){return Al(t).delete(this.clientId)},Il.prototype.xu=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.ku(this.mu,18e5)?[3,2]:(this.mu=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=Il.qn(t,tl.store);return r.Xn().next(function(t){var e=o.Mu(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return Aa.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.Ru)for(n=0,r=e;n<r.length;n++)i=r[n],this.Ru.removeItem(this.Ou(i.clientId));t.label=2;case 2:return[2]}})})},Il.prototype.Vu=function(){var t=this;this.wu=this.ln.Pn("client_metadata_refresh",4e3,function(){return t.Pu().then(function(){return t.xu()}).then(function(){return t.Vu()})})},Il.prototype.Fu=function(t){return!!t&&t.ownerId===this.clientId},Il.prototype.Du=function(e){var r=this;return this.hu?Aa.resolve(!0):_l(e).get(Mh.key).next(function(t){if(null!==t&&r.ku(t.leaseTimestampMs,5e3)&&!r.Lu(t.ownerId)){if(r.Fu(t)&&r.networkEnabled)return!0;if(!r.Fu(t)){if(!t.allowTabSynchronization)throw new Tr(Ir.FAILED_PRECONDITION,wl);return!1}}return!(!r.networkEnabled||!r.inForeground)||Al(e).Xn().next(function(t){return void 0===r.Mu(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&xr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},Il.prototype.vi=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this._u=!1,this.Bu(),this.wu&&(this.wu.cancel(),this.wu=null),this.qu(),this.Uu(),[4,this.Iu.runTransaction("shutdown","readwrite",[Mh.store,tl.store],function(t){var e=new bl(t,ic.ii);return n.Cu(e).next(function(){return n.$u(e)})})];case 1:return t.sent(),this.Iu.close(),this.Qu(),[2]}})})},Il.prototype.Mu=function(t,e){var n=this;return t.filter(function(t){return n.ku(t.updateTimeMs,e)&&!n.Lu(t.clientId)})},Il.prototype.gi=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return Al(t).Xn().next(function(t){return e.Mu(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(Il.prototype,"wi",{get:function(){return this._u},enumerable:!1,configurable:!0}),Il.prototype.Wu=function(t){return gh.ca(t,this.serializer,this.ao,this.aa)},Il.prototype.ju=function(){return this.Yr},Il.prototype.Ku=function(){return this.ro},Il.prototype.Gu=function(){return this.ao},Il.prototype.zu=function(){return this.Au},Il.prototype.runTransaction=function(e,n,r){var i=this;xr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Iu.runTransaction(e,t,rl,function(t){return o=new bl(t,i.lu?i.lu.next():ic.ii),"readwrite-primary"===n?i.Su(o).next(function(t){return!!t||i.Du(o)}).next(function(t){if(!t)throw Rr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.ln.Ss(function(){return i.Tu(!1)}),new Tr(Ir.FAILED_PRECONDITION,Fc);return r(o)}).next(function(t){return i.Nu(o).next(function(){return t})}):i.Hu(o).next(function(){return r(o)})}).then(function(t){return o.io(),t})},Il.prototype.Hu=function(t){var e=this;return _l(t).get(Mh.key).next(function(t){if(null!==t&&e.ku(t.leaseTimestampMs,5e3)&&!e.Lu(t.ownerId)&&!e.Fu(t)&&!(e.hu||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Tr(Ir.FAILED_PRECONDITION,wl)})},Il.prototype.Nu=function(t){var e=new Mh(this.clientId,this.allowTabSynchronization,Date.now());return _l(t).put(Mh.key,e)},Il.Mn=function(){return Na.Mn()},Il.prototype.Cu=function(t){var e=this,n=_l(t);return n.get(Mh.key).next(function(t){return e.Fu(t)?(xr("IndexedDbPersistence","Releasing primary lease."),n.delete(Mh.key)):Aa.resolve()})},Il.prototype.ku=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Rr("Detected an update time that is in the future: "+t+" > "+n),1))},Il.prototype.yu=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.du=function(){t.ln.fs(function(){return t.inForeground="visible"===t.document.visibilityState,t.Pu()})},this.document.addEventListener("visibilitychange",this.du),this.inForeground="visible"===this.document.visibilityState)},Il.prototype.qu=function(){this.du&&(this.document.removeEventListener("visibilitychange",this.du),this.du=null)},Il.prototype.gu=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.fu=function(){e.Bu(),e.ln.fs(function(){return e.vi()})},this.window.addEventListener("unload",this.fu))},Il.prototype.Uu=function(){this.fu&&(this.window.removeEventListener("unload",this.fu),this.fu=null)},Il.prototype.Lu=function(t){try{var e=null!==(null===(e=this.Ru)||void 0===e?void 0:e.getItem(this.Ou(t)));return xr("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return Rr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},Il.prototype.Bu=function(){if(this.Ru)try{this.Ru.setItem(this.Ou(this.clientId),String(Date.now()))}catch(t){Rr("Failed to set zombie client id.",t)}},Il.prototype.Qu=function(){if(this.Ru)try{this.Ru.removeItem(this.Ou(this.clientId))}catch(t){}},Il.prototype.Ou=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},Il);function Il(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.ln=i,this.window=o,this.document=s,this.cu=a,this.hu=c,this.lu=null,this._u=!1,this.isPrimary=!1,this.networkEnabled=!0,this.fu=null,this.inForeground=!1,this.du=null,this.wu=null,this.mu=Number.NEGATIVE_INFINITY,this.Tu=function(t){return Promise.resolve()},!Il.Mn())throw new Tr(Ir.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.aa=new Nl(this,r),this.Eu=e+"main",this.serializer=new sh(u),this.Iu=new Na(this.Eu,11,new Ch(this.serializer)),this.Yr=new fl(this.aa,this.serializer),this.ao=new al,this.ro=(e=this.serializer,u=this.ao,new Ah(e,u)),this.Au=new il(this.serializer),this.window&&this.window.localStorage?this.Ru=this.window.localStorage:(this.Ru=null,!1===c&&Rr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function Tl(t,e){var n=this;return(n=ml.call(this)||this).Aa=t,n.uu=e,n}function _l(t){return El.qn(t,Mh.store)}function Al(t){return El.qn(t,tl.store)}var Nl=(Sl.prototype.Xo=function(t){var n=this.Ju(t);return this.db.ju().nu(t).next(function(e){return n.next(function(t){return e+t})})},Sl.prototype.Ju=function(t){var e=0;return this.ta(t,function(t){e++}).next(function(){return e})},Sl.prototype.De=function(t,e){return this.db.ju().De(t,e)},Sl.prototype.ta=function(t,n){return this.Yu(t,function(t,e){return n(e)})},Sl.prototype.iu=function(t,e,n){return xl(t,n)},Sl.prototype.ou=function(t,e,n){return xl(t,n)},Sl.prototype.ea=function(t,e,n){return this.db.ju().ea(t,e,n)},Sl.prototype.Pa=xl,Sl.prototype.Xu=function(t,e){return r=e,i=!1,Th(n=t).ss(function(t){return wh(n,t,r).next(function(t){return t&&(i=!0),Aa.resolve(!t)})}).next(function(){return i});var n,r,i},Sl.prototype.na=function(n,r){var i=this,o=this.db.Ku().Gr(),s=[],u=0;return this.Yu(n,function(e,t){t<=r&&(t=i.Xu(n,e).next(function(t){if(!t)return u++,o.yr(n,e).next(function(){return o.Pr(e),gl(n).delete([0,rh(e.path)])})}),s.push(t))}).next(function(){return Aa.Fn(s)}).next(function(){return o.apply(n)}).next(function(){return u})},Sl.prototype.removeTarget=function(t,e){return e=e.nt(t.uu),this.db.ju().tu(t,e)},Sl.prototype.Zu=xl,Sl.prototype.Yu=function(t,r){var i,t=gl(t),o=ic.ii;return t.ns({index:Yh.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==ic.ii&&r(new Br(oh(i)),o),o=e,i=t):o=ic.ii}).next(function(){o!==ic.ii&&r(new Br(oh(i)),o)})},Sl.prototype.ia=function(t){return this.db.Ku().Fa(t)},Sl);function Sl(t,e){this.db=t,this.jo=new th(this,e)}function xl(t,e){return gl(t).put((t=t.uu,new Yh(0,rh(e.path),t)))}function Rl(t,e){var n=t.projectId;return t.W||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Dl=(Ol.prototype.Ho=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.sa(t,n.ec)})},Ol);function Ol(t,e,n,r){this.persistence=t,this.tc=e,this.serializer=r,this.ec=new Xi(di),this.nc=new Si(Fi,qi),this.sc=Ri.min(),this.oo=t.Wu(n),this.zr=t.Ku(),this.Yr=t.ju(),this.eo=new qc(this.zr,this.oo,this.persistence.Gu()),this.Au=t.zu(),this.tc.ic(this.eo)}function Pl(t,e,n,r){return new Dl(t,e,n,r)}function kl(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Yr.za(t)})}function Ll(t,s,e,u,a){var n=ho();return e.forEach(function(t){return n=n.add(t)}),s.getEntries(t,n).next(function(i){var o=io;return e.forEach(function(t,e){var n=i.get(t),r=(null==a?void 0:a.get(t))||u;e instanceof Tu&&e.version.isEqual(Ri.min())?(s.Pr(t,r),o=o.rt(t,e)):null==n||0<e.version.L(n.version)||0===e.version.L(n.version)&&n.hasPendingWrites?(s.Ir(e,r),o=o.rt(t,e)):xr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o})}function Cl(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Yr.su(e,r).next(function(t){return t?(n=t,Aa.resolve(n)):i.Yr.ja(e).next(function(t){return n=new zi(r,t,0,e.uu),i.Yr.Ya(e,n).next(function(){return n})})})}).then(function(t){var e=i.ec.get(t.targetId);return(null===e||0<t.et.L(e.et))&&(i.ec=i.ec.rt(t.targetId,t),i.nc.set(r,t.targetId)),t})}function Ul(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).ec.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.aa.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!La(r=t.sent()))throw r;return xr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.ec=e.ec.remove(o),e.nc.delete(n.target),[2]}})})}function Ml(t,o,s){var u=t,a=Ri.min(),c=ho();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=Mu(o),(void 0!==(t=(i=t).nc.get(r))?Aa.resolve(i.ec.get(t)):i.Yr.su(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.Yr.au(e,t.targetId).next(function(t){c=t})}).next(function(){return u.tc.wo(e,o,s?a:Ri.min(),s?c:ho())}).next(function(t){return{documents:t,rc:c}});var t,n,r,i})}function Vl(t,e){var n=t,r=n.Yr;return(t=n.ec.get(e))?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.qe(t,e).next(function(t){return t?t.target:null})})}function jl(t){var s=t;return s.persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.zr,n=t,t=s.sc,r=e,i=io,o=ch(t),t=Dh(n),n=IDBKeyRange.lowerBound(o,!0),t.ns({index:Kh.readTimeIndex,range:n},function(t,e){var n=uh(r.serializer,e);i=i.rt(n.key,n),o=e.readTime}).next(function(){return{Ur:i,readTime:hh(o)}});var e,n,r,i,o}).then(function(t){var e=t.Ur,t=t.readTime;return s.sc=t,e})}function Fl(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Ir.FAILED_PRECONDITION||e.message!==Fc)throw e;return xr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function ql(t,e){this.user=e,this.type="OAuth",this.Tc={},this.Tc.Authorization="Bearer "+t}function Bl(t,e,n,r,i){var o=this;this.Wr=t,this.Eh=e,this.rs=n,this.Ih={},this.Ah=[],this.Rh=new Map,this.Ph=new Set,this.yh=[],this.gh=i,this.gh.Vh(function(t){n.fs(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Tf(this)?(xr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Ph.add(4),[4,yf(e)];case 1:return t.sent(),e.ph.set("Unknown"),e.Ph.delete(4),[4,df(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.ph=new ef(n,r)}var Gl,Wl,zl,Ql=(pf.prototype.m=function(){return this.oc.m()},pf.prototype.iu=function(t,e){e=new Kl(t,e),this.oc=this.oc.add(e),this.uc=this.uc.add(e)},pf.prototype.hc=function(t,e){var n=this;t.forEach(function(t){return n.iu(t,e)})},pf.prototype.ou=function(t,e){this.lc(new Kl(t,e))},pf.prototype._c=function(t,e){var n=this;t.forEach(function(t){return n.ou(t,e)})},pf.prototype.fc=function(t){var e=this,n=new Br(new jr([])),r=new Kl(n,t),t=new Kl(n,t+1),i=[];return this.uc.Nt([r,t],function(t){e.lc(t),i.push(t.key)}),i},pf.prototype.dc=function(){var e=this;this.oc.forEach(function(t){return e.lc(t)})},pf.prototype.lc=function(t){this.oc=this.oc.delete(t),this.uc=this.uc.delete(t)},pf.prototype.wc=function(t){var e=new Br(new jr([])),n=new Kl(e,t),t=new Kl(e,t+1),r=ho();return this.uc.Nt([n,t],function(t){r=r.add(t.key)}),r},pf.prototype.ga=function(t){var e=new Kl(t,0);return null!==(e=this.oc.$t(e))&&t.isEqual(e.key)},pf),Kl=(ff.ac=function(t,e){return Br.i(t.key,e.key)||di(t.mc,e.mc)},ff.cc=function(t,e){return di(t.mc,e.mc)||Br.i(t.key,e.key)},ff),Hl=(lf.prototype.getToken=function(){return Promise.resolve(null)},lf.prototype.Ic=function(){},lf.prototype.Ac=function(t){(this.Ec=t)(ec.UNAUTHENTICATED)},lf.prototype.Rc=function(){this.Ec=null},lf),Xl=(hf.prototype.getToken=function(){var e=this,n=this.gc,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.gc!==n?(xr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(kr("string"==typeof t.accessToken),new ql(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},hf.prototype.Ic=function(){this.forceRefresh=!0},hf.prototype.Ac=function(t){this.Ec=t,this.yc&&t(this.currentUser)},hf.prototype.Rc=function(){this.auth&&this.auth.removeAuthTokenListener(this.Pc),this.Pc=null,this.Ec=null},hf.prototype.Vc=function(){var t=this.auth&&this.auth.getUid();return kr(null===t||"string"==typeof t),new ec(t)},hf),Yl=(Object.defineProperty(cf.prototype,"Tc",{get:function(){var t={"X-Goog-AuthUser":this.vc},e=this.bc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),cf),Jl=(af.prototype.getToken=function(){return Promise.resolve(new Yl(this.bc,this.vc))},af.prototype.Ac=function(t){t(ec.Zs)},af.prototype.Rc=function(){},af.prototype.Ic=function(){},af),be=(uf.prototype.$c=function(){return 1===this.state||2===this.state||4===this.state},uf.prototype.xc=function(){return 2===this.state},uf.prototype.start=function(){3!==this.state?this.auth():this.kc()},uf.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.$c()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},uf.prototype.Mc=function(){this.state=0,this.Ps.reset()},uf.prototype.Oc=function(){var t=this;this.xc()&&null===this.Fc&&(this.Fc=this.ln.Pn(this.Sc,6e4,function(){return t.Lc()}))},uf.prototype.Bc=function(t){this.qc(),this.stream.send(t)},uf.prototype.Lc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.xc()?[2,this.close(0)]:[2]})})},uf.prototype.qc=function(){this.Fc&&(this.Fc.cancel(),this.Fc=null)},uf.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.qc(),this.Ps.cancel(),this.Nc++,3!==e?this.Ps.reset():n&&n.code===Ir.RESOURCE_EXHAUSTED?(Rr(n.toString()),Rr("Using maximum backoff delay to prevent overloading the backend."),this.Ps.In()):n&&n.code===Ir.UNAUTHENTICATED&&this.Cc.Ic(),null!==this.stream&&(this.Uc(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Qc(n)];case 1:return t.sent(),[2]}})})},uf.prototype.Uc=function(){},uf.prototype.auth=function(){var n=this;this.state=1;var t=this.Wc(this.Nc),e=this.Nc;this.Cc.getToken().then(function(t){n.Nc===e&&n.jc(t)},function(e){t(function(){var t=new Tr(Ir.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Kc(t)})})},uf.prototype.jc=function(t){var e=this,n=this.Wc(this.Nc);this.stream=this.Gc(t),this.stream.zc(function(){n(function(){return e.state=2,e.listener.zc()})}),this.stream.Qc(function(t){n(function(){return e.Kc(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},uf.prototype.kc=function(){var t=this;this.state=4,this.Ps.An(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},uf.prototype.Kc=function(t){return xr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},uf.prototype.Wc=function(e){var n=this;return function(t){n.ln.fs(function(){return n.Nc===e?t():(xr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},uf),$l=(n(sf,zl=be),sf.prototype.Gc=function(t){return this.Dc.Hc("Listen",t)},sf.prototype.onMessage=function(t){this.Ps.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Pr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Ue?(kr(void 0===o||"string"==typeof o),gi.fromBase64String(o||"")):(kr(void 0===o||o instanceof Uint8Array),gi.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Ir.UNKNOWN:Hi(s.code),new Tr(o,s.message||"")),r=new bo(n,r,i,s||null)}else if("documentChange"in e){e.documentChange,(a=e.documentChange).document,a.document.name,a.document.updateTime;var i=as(t,a.document.name),u=is(a.document.updateTime),s=new pu({mapValue:{fields:a.document.fields}}),u=new Iu(i,u,s,{}),s=a.targetIds||[],a=a.removedTargetIds||[];r=new mo(s,a,u.key,u)}else if("documentDelete"in e){e.documentDelete,(a=e.documentDelete).document;var u=as(t,a.document),c=a.readTime?is(a.readTime):Ri.min(),c=new Tu(u,c),a=a.removedTargetIds||[];r=new mo([],a,c.key,c)}else if("documentRemove"in e){e.documentRemove,(c=e.documentRemove).document;var h=as(t,c.document),c=c.removedTargetIds||[];r=new mo([],c,h,null)}else{if(!("filter"in e))return Pr();e.filter,(h=e.filter).targetId,e=new Gi(e=h.count||0),h=h.targetId,r=new wo(h,e)}return r}(this.serializer,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?Ri.min():is(e.readTime);return this.listener.Jc(n,t)},sf.prototype.Yc=function(t){var e,n,r,i,o={};o.database=ls(this.serializer),o.addTarget=(e=this.serializer,(r=Bi(r=(n=t).target)?{documents:gs(e,r)}:{query:ms(e,r)}).targetId=n.targetId,0<n.resumeToken.O()?r.resumeToken=rs(e,n.resumeToken):0<n.et.L(Ri.min())&&(r.readTime=ns(e,n.et.X())),r),(t=(this.serializer,i=t,null==(t=function(){switch(i.tt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Pr()}}())?null:{"goog-listen-tags":t}))&&(o.labels=t),this.Bc(o)},sf.prototype.Xc=function(t){var e={};e.database=ls(this.serializer),e.removeTarget=t,this.Bc(e)},sf),Zl=(n(of,Wl=be),Object.defineProperty(of.prototype,"th",{get:function(){return this.Zc},enumerable:!1,configurable:!0}),of.prototype.start=function(){this.Zc=!1,this.lastStreamToken=void 0,Wl.prototype.start.call(this)},of.prototype.Uc=function(){this.Zc&&this.eh([])},of.prototype.Gc=function(t){return this.Dc.Hc("Write",t)},of.prototype.onMessage=function(t){if(kr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Zc){this.Ps.reset();var e=(n=t.writeResults,i=t.commitTime,n&&0<n.length?(kr(void 0!==i),n.map(function(t){return n=i,(r=(e=t).updateTime?is(e.updateTime):is(n)).isEqual(Ri.min())&&(r=is(n)),n=null,e.transformResults&&0<e.transformResults.length&&(n=e.transformResults),new zs(r,n);var e,n,r})):[]),n=is(t.commitTime);return this.listener.nh(n,e)}var i;return kr(!t.writeResults||0===t.writeResults.length),this.Zc=!0,this.listener.sh()},of.prototype.ih=function(){var t={};t.database=ls(this.serializer),this.Bc(t)},of.prototype.eh=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return ys(e.serializer,t)})};this.Bc(t)},of),tf=(n(rf,Gl=function(){}),rf.prototype.oh=function(){if(this.rh)throw new Tr(Ir.FAILED_PRECONDITION,"The client has already been terminated.")},rf.prototype.ah=function(e,n,r){var i=this;return this.oh(),this.credentials.getToken().then(function(t){return i.Dc.ah(e,n,r,t)}).catch(function(t){throw t.code===Ir.UNAUTHENTICATED&&i.credentials.Ic(),t})},rf.prototype.uh=function(e,n,r){var i=this;return this.oh(),this.credentials.getToken().then(function(t){return i.Dc.uh(e,n,r,t)}).catch(function(t){throw t.code===Ir.UNAUTHENTICATED&&i.credentials.Ic(),t})},rf.prototype.terminate=function(){this.rh=!1},rf),ef=(nf.prototype.fh=function(){var t=this;0===this.hh&&(this.dh("Unknown"),this.lh=this.rs.Pn("online_state_timeout",1e4,function(){return t.lh=null,t.wh("Backend didn't respond within 10 seconds."),t.dh("Offline"),Promise.resolve()}))},nf.prototype.mh=function(t){"Online"===this.state?this.dh("Unknown"):(this.hh++,1<=this.hh&&(this.Th(),this.wh("Connection failed 1 times. Most recent error: "+t.toString()),this.dh("Offline")))},nf.prototype.set=function(t){this.Th(),this.hh=0,"Online"===t&&(this._h=!1),this.dh(t)},nf.prototype.dh=function(t){t!==this.state&&(this.state=t,this.li(t))},nf.prototype.wh=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this._h?(Rr(t),this._h=!1):xr("OnlineStateTracker",t)},nf.prototype.Th=function(){null!==this.lh&&(this.lh.cancel(),this.lh=null)},nf);function nf(t,e){this.rs=t,this.li=e,this.state="Unknown",this.hh=0,this.lh=null,this._h=!0}function rf(t,e,n){var r=this;return(r=Gl.call(this)||this).credentials=t,r.Dc=e,r.serializer=n,r.rh=!1,r}function of(t,e,n,r,i){var o=this;return(o=Wl.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Zc=!1,o}function sf(t,e,n,r,i){var o=this;return(o=zl.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function uf(t,e,n,r,i,o){this.ln=t,this.Sc=n,this.Dc=r,this.Cc=i,this.listener=o,this.state=0,this.Nc=0,this.Fc=null,this.stream=null,this.Ps=new _a(t,e)}function af(t,e){this.bc=t,this.vc=e}function cf(t,e){this.bc=t,this.vc=e,this.type="FirstParty",this.user=ec.Zs}function hf(t){var e=this;this.Pc=null,this.currentUser=ec.UNAUTHENTICATED,this.yc=!1,this.gc=0,this.Ec=null,this.forceRefresh=!1,this.Pc=function(){e.gc++,e.currentUser=e.Vc(),e.yc=!0,e.Ec&&e.Ec(e.currentUser)},this.gc=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Pc):(this.Pc(null),t.get().then(function(t){e.auth=t,e.Pc&&e.auth.addAuthTokenListener(e.Pc)},function(){}))}function lf(){this.Ec=null}function ff(t,e){this.key=t,this.mc=e}function pf(){this.oc=new no(Kl.ac),this.uc=new no(Kl.cc)}function df(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!Tf(r))return[3,4];e=0,n=r.yh,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function yf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.yh,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function vf(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,xr("RemoteStore","RemoteStore shutting down."),e.Ph.add(5),[4,yf(e)];case 1:return t.sent(),e.gh.vi(),e.ph.set("Unknown"),[2]}})})}function gf(t,e){t.Rh.has(e.targetId)||(t.Rh.set(e.targetId,e),If(t)?Ef(t):Of(t).xc()&&wf(t,e))}function mf(t,e){var n=t,t=Of(n);n.Rh.delete(e),t.xc()&&bf(n,e),0===n.Rh.size&&(t.xc()?t.Oc():Tf(n)&&n.ph.set("Unknown"))}function wf(t,e){t.bh.Ee(e.targetId),Of(t).Yc(e)}function bf(t,e){t.bh.Ee(e),Of(t).Xc(e)}function Ef(e){e.bh=new Io({Be:function(t){return e.Ih.Be(t)},qe:function(t){return e.Rh.get(t)||null}}),Of(e).start(),e.ph.fh()}function If(t){return Tf(t)&&!Of(t).$c()&&0<t.Rh.size}function Tf(t){return 0===t.Ph.size}function _f(t){t.bh=void 0}function Af(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!La(r))throw r;return n.Ph.add(1),[4,yf(n)];case 1:return t.sent(),n.ph.set("Offline"),i=i||function(){return kl(n.Wr)},n.rs.Ss(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return xr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Ph.delete(1),[4,df(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function Nf(e,n){return n().catch(function(t){return Af(e,t,n)})}function Sf(h){return y(this,void 0,void 0,function(){var s,u,a,c;return v(this,function(t){switch(t.label){case 0:u=Pf(s=h),a=0<s.Ah.length?s.Ah[s.Ah.length-1].batchId:-1,t.label=1;case 1:if(!(Tf(s)&&s.Ah.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(r=s.Wr,i=a,(o=r).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===i&&(i=-1),o.oo.wa(t,i)}))];case 3:return null===(c=t.sent())?(0===s.Ah.length&&u.Oc(),[3,7]):(a=c.batchId,n=c,(e=s).Ah.push(n),(e=Pf(e)).xc()&&e.th&&e.eh(n.mutations),[3,6]);case 4:return c=t.sent(),[4,Af(s,c)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return xf(s)&&Rf(s),[2]}var e,n,r,i,o})})}function xf(t){return Tf(t)&&!Pf(t).$c()&&0<t.Ah.length}function Rf(t){Pf(t).start()}function Df(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Ph.delete(2),[4,df(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Ph.add(2),[4,yf(e)]);case 3:t.sent(),e.ph.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function Of(n){var t,e,r,i=this;return n.Fh||(n.Fh=(t=n.Eh,e=n.rs,r={zc:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Rh.forEach(function(t,e){wf(n,t)}),[2]})})}.bind(null,n),Qc:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return _f(e),If(e)?(e.ph.mh(n),Ef(e)):e.ph.set("Unknown"),[2]})})}.bind(null,n),Jc:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.ph.set("Online"),!(u instanceof bo&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Rh.has(i)?[4,o.Ih.Sh(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Rh.delete(i),o.bh.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),xr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,Af(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof mo?s.bh.pe(u):u instanceof wo?s.bh.$e(u):s.bh.Se(u),a.isEqual(Ri.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,kl(s.Wr)];case 8:return o=t.sent(),0<=a.L(o)?[4,(i=a,(e=(r=s).bh.Me(i)).Gt.forEach(function(t,e){var n;0<t.resumeToken.O()&&(n=r.Rh.get(e))&&r.Rh.set(e,n.st(t.resumeToken,i))}),e.zt.forEach(function(t){var e=r.Rh.get(t);e&&(r.Rh.set(t,e.st(gi.B,e.et)),bf(r,t),e=new zi(e.target,t,1,e.sequenceNumber),wf(r,e))}),r.Ih.Dh(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return xr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,Af(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},t.oh(),new $l(e,t.Dc,t.credentials,t.serializer,r)),n.yh.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Fh.Mc(),If(n)?Ef(n):n.ph.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.Fh.stop()];case 2:t.sent(),_f(n),t.label=3;case 3:return[2]}})})})),n.Fh}function Pf(n){var t,e,r,i=this;return n.$h||(n.$h=(t=n.Eh,e=n.rs,r={zc:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Pf(e).ih(),[2]})})}.bind(null,n),Qc:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Pf(e).th?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Ki(n=i.code)&&n!==Ir.ABORTED?(e=r.Ah.shift(),Pf(r).Mc(),[4,Nf(r,function(){return r.Ih.Nh(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,Sf(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return xf(e)&&Rf(e),[2]}})})}.bind(null,n),sh:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Pf(o),n=0,r=o.Ah;n<r.length;n++)i=r[n],e.eh(i.mutations);return[2]})})}.bind(null,n),nh:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Ah.shift(),n=gc.from(e,i,o),[4,Nf(r,function(){return r.Ih.Ch(n)})];case 1:return t.sent(),[4,Sf(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.oh(),new Zl(e,t.Dc,t.credentials,t.serializer,r)),n.yh.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.$h.Mc(),[4,Sf(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.$h.stop()];case 3:t.sent(),0<n.Ah.length&&(xr("RemoteStore","Stopping write stream with "+n.Ah.length+" pending writes"),n.Ah=[]),t.label=4;case 4:return[2]}})})})),n.$h}var kf=function(t){this.key=t},Lf=function(t){this.key=t},Cf=(Object.defineProperty(Ff.prototype,"Bh",{get:function(){return this.xh},enumerable:!1,configurable:!0}),Ff.prototype.qh=function(t,e){var s=this,u=e?e.Uh:new po,a=(e||this).Lh,c=(e||this).Qt,h=a,l=!1,f=Ou(this.query)&&a.size===this.query.limit?a.last():null,p=Pu(this.query)&&a.size===this.query.limit?a.first():null;if(t.ct(function(t,e){var n=a.get(t),r=(r=e instanceof Iu?e:null)&&(Wu(s.query,r)?r:null),i=!!n&&s.Qt.has(n.key),o=!!r&&(r.Je||s.Qt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.Qh(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.Oh(r,f)||p&&s.Oh(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),Ou(this.query)||Pu(this.query))for(;h.size>this.query.limit;){var n=Ou(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{Lh:h,Uh:u,Wh:l,Qt:c}},Ff.prototype.Qh=function(t,e){return t.Je&&e.hasCommittedMutations&&!e.Je},Ff.prototype.pr=function(t,e,n){var o=this,r=this.Lh;this.Lh=t.Lh,this.Qt=t.Qt;var i=t.Uh.qt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.Oh(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Pr()}}var r,i}),this.jh(n);var s=e?this.Kh():[],e=(n=0===this.Mh.size&&this.Zt?1:0)!==this.kh;return this.kh=n,0!==i.length||e?{snapshot:new yo(this.query,t.Lh,r,i,t.Qt,0==n,e,!1),Gh:s}:{Gh:s}},Ff.prototype.Bs=function(t){return this.Zt&&"Offline"===t?(this.Zt=!1,this.pr({Lh:this.Lh,Uh:new po,Qt:this.Qt,Wh:!1},!1)):{Gh:[]}},Ff.prototype.zh=function(t){return!this.xh.has(t)&&!!this.Lh.has(t)&&!this.Lh.get(t).Je},Ff.prototype.jh=function(t){var e=this;t&&(t.te.forEach(function(t){return e.xh=e.xh.add(t)}),t.ee.forEach(function(t){}),t.ne.forEach(function(t){return e.xh=e.xh.delete(t)}),this.Zt=t.Zt)},Ff.prototype.Kh=function(){var e=this;if(!this.Zt)return[];var n=this.Mh;this.Mh=ho(),this.Lh.forEach(function(t){e.zh(t.key)&&(e.Mh=e.Mh.add(t.key))});var r=[];return n.forEach(function(t){e.Mh.has(t)||r.push(new Lf(t))}),this.Mh.forEach(function(t){n.has(t)||r.push(new kf(t))}),r},Ff.prototype.Hh=function(t){return this.xh=t.rc,this.Mh=ho(),t=this.qh(t.documents),this.pr(t,!0)},Ff.prototype.Jh=function(){return yo.Kt(this.query,this.Lh,this.Qt,0===this.kh)},Ff),Uf=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Mf=function(t){this.key=t,this.Yh=!1},Vf=(Object.defineProperty(jf.prototype,"fl",{get:function(){return!0===this._l},enumerable:!1,configurable:!0}),jf);function jf(t,e,n,r,i,o){this.Wr=t,this.Xh=e,this.Zh=n,this.tl=r,this.currentUser=i,this.el=o,this.nl={},this.sl=new Si(Bu,qu),this.il=new Map,this.rl=[],this.ol=new Xi(Br.i),this.al=new Map,this.ul=new Ql,this.cl={},this.hl=new Map,this.ll=ll.Wa(),this.onlineState="Unknown",this._l=void 0}function Ff(t,e){this.query=t,this.xh=e,this.kh=null,this.Zt=!1,this.Mh=ho(),this.Qt=ho(),this.Oh=zu(t),this.Lh=new fo(this.Oh)}function qf(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.dl=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.qh(o)).Wh?[4,Ml(r.Wr,i.query,!1).then(function(t){return t=t.documents,i.view.qh(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.Gt.get(i.targetId),n=i.view.pr(e,r.fl,n),[2,(Hf(r,i.targetId,n.Gh),n.snapshot)]}})})}(i,t,e,n)},[4,Ml(i.Wr,o,!0)];case 1:return n=t.sent(),r=new Cf(o,n.rc),e=r.qh(n.documents),n=go.Xt(s,u&&"Offline"!==i.onlineState),n=r.pr(e,i.fl,n),Hf(i,s,n.Gh),r=new Uf(o,s,r),[2,(i.sl.set(o,r),i.il.has(s)?i.il.get(s).push(o):i.il.set(s,[o]),n.snapshot)]}})})}function Bf(o,s){return y(this,void 0,void 0,function(){var n,i;return v(this,function(t){switch(t.label){case 0:n=o,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Wr,a=e,c=(r=s).et,h=a.ec,a.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=a.zr.Gr({Hr:!0});h=a.ec;var u=[];r.Gt.forEach(function(t,e){var n,r,i,o=h.get(e);o&&(u.push(a.Yr.ru(s,t.ne,e).next(function(){return a.Yr.Xr(s,t.te,e)})),0<(i=t.resumeToken).O()&&(n=o.st(i,c).nt(s.uu),h=h.rt(e,n),r=o,i=t,kr(0<(o=n).resumeToken.O()),(0===r.resumeToken.O()||3e8<=o.et.Y()-r.et.Y()||0<i.te.size+i.ee.size+i.ne.size)&&u.push(a.Yr.tu(s,n))))});var e,n=io;return r.Ht.forEach(function(t,e){r.Jt.has(t)&&u.push(a.persistence.aa.Zu(s,t))}),u.push(Ll(s,t,r.Ht,c,void 0).next(function(t){n=t})),c.isEqual(Ri.min())||(e=a.Yr.za(s).next(function(t){return a.Yr.Ja(s,s.uu,c)}),u.push(e)),Aa.Fn(u).next(function(){return t.apply(s)}).next(function(){return a.eo.Zr(s,n)})}).then(function(t){return a.ec=h,t}))];case 2:return i=t.sent(),s.Gt.forEach(function(t,e){(e=n.al.get(e))&&(kr(t.te.size+t.ee.size+t.ne.size<=1),0<t.te.size?e.Yh=!0:0<t.ee.size?kr(e.Yh):0<t.ne.size&&(kr(e.Yh),e.Yh=!1))}),[4,Yf(n,i,s)];case 3:return t.sent(),[3,6];case 4:return[4,Fl(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,a,c,h})})}function Gf(t,n,e){var r;((t=t).fl&&0===e||!t.fl&&1===e)&&(r=[],t.sl.forEach(function(t,e){(e=e.view.Bs(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Bs(i)&&(o=!0)}),o&&Za(t)}(t.Zh,n),r.length&&t.nl.Jc(r),t.onlineState=n,t.fl&&t.tl.Wi(n))}function Wf(t,e){(t.hl.get(e)||[]).forEach(function(t){t.resolve()}),t.hl.delete(e)}function zf(t,e,n){var r=t,i=r.cl[r.currentUser.Ys()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.cl[r.currentUser.Ys()]=i)}function Qf(e,t,n){void 0===n&&(n=null),e.tl.Oi(t);for(var r=0,i=e.il.get(t);r<i.length;r++){var o=i[r];e.sl.delete(o),n&&e.nl.wl(o,n)}e.il.delete(t),e.fl&&e.ul.fc(t).forEach(function(t){e.ul.ga(t)||Kf(e,t)})}function Kf(t,e){var n=t.ol.get(e);null!==n&&(mf(t.Xh,n),t.ol=t.ol.remove(e),t.al.delete(n),Xf(t))}function Hf(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof kf?(t.ul.iu(u.key,e),r=t,i=(i=u).key,r.ol.get(i)||(xr("SyncEngine","New document in limbo: "+i),r.rl.push(i),Xf(r))):u instanceof Lf?(xr("SyncEngine","Document no longer in limbo: "+u.key),t.ul.ou(u.key,e),t.ul.ga(u.key)||Kf(t,u.key)):Pr()}}function Xf(t){for(;0<t.rl.length&&t.ol.size<t.el;){var e=t.rl.shift(),n=t.ll.next();t.al.set(n,new Mf(e)),t.ol=t.ol.rt(e,n),gf(t.Xh,new zi(Mu(Du(e.path)),n,2,ic.ii))}}function Yf(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).sl.m()?[3,3]:(n.sl.forEach(function(t,e){o.push(n.dl(e,s,u).then(function(t){t&&(n.fl&&n.tl.qi(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=Bc.Vo(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.nl.Jc(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Aa.forEach(c,function(e){return Aa.forEach(e.Po,function(t){return r.persistence.aa.iu(n,e.targetId,t)}).next(function(){return Aa.forEach(e.yo,function(t){return r.persistence.aa.ou(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!La(e=t.sent()))throw e;return xr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.ec.get(o),u=s.et,u=s.it(u),r.ec=r.ec.rt(o,u));return[2]}})})}(n.Wr,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function Jf(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,l,f;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.il.get(s))&&0!==a.length?[4,Cl(e.Wr,Mu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(l=h[c],l=e.sl.get(l),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Ml((e=r).Wr,i.query,!0)];case 1:return n=t.sent(),n=i.view.Hh(n),[2,(e.fl&&Hf(e,i.targetId,n.Gh),n)]}})})}(e,l)]):[3,6];case 4:(l=t.sent()).snapshot&&r.push(l.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,Vl(e.Wr,s)];case 8:return f=t.sent(),[4,Cl(e.Wr,f)];case 9:return u=t.sent(),[4,qf(e,$f(f),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.nl.Jc(r),n)]}})})}function $f(t){return Ru(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Zf(t){return t.Xh.Ih.Dh=Bf.bind(null,t),t.Xh.Ih.Be=function(t,e){var n=t;if((t=n.al.get(e))&&t.Yh)return ho().add(t.key);var r=ho();if(!(e=n.il.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.sl.get(s),r=r.xt(s.view.Bh);return r}.bind(null,t),t.Xh.Ih.Sh=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).tl.qi(s,"rejected",u),i=e.al.get(s),(n=i&&i.key)?(r=(r=new Xi(Br.i)).rt(n,new Tu(n,Ri.min())),i=ho().add(n),i=new vo(Ri.min(),new Map,new no(di),r,i),[4,Bf(e,i)]):[3,2];case 1:return t.sent(),e.ol=e.ol.remove(n),e.al.delete(s),Xf(e),[3,4];case 2:return[4,Ul(e.Wr,s,!1).then(function(){return Qf(e,s,u)}).catch(Fl)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.nl.Jc=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.queries.get(u)){for(var a=0,c=u.listeners;a<c.length;a++)c[a].qs(s)&&(r=!0);u.Ms=s}}r&&Za(n)}.bind(null,t.Zh),t.nl.wl=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,t.Zh),t}function tp(t){return t.Xh.Ih.Ch=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Wr,h=s,(l=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=h.batch.keys(),n=l.zr.Gr({Hr:!0}),i=l,o=t,s=n,u=(r=h).batch,a=u.keys(),c=Aa.resolve();return a.forEach(function(n){c=c.next(function(){return s.yr(o,n)}).next(function(t){var e=t;kr(null!==(t=r.wr.get(n))),(!e||e.version.L(t)<0)&&(e=u.cr(n,e,r))&&s.Ir(e,r.dr)})}),c.next(function(){return i.oo.Ia(o,u)}).next(function(){return n.apply(t)}).next(function(){return l.oo.ya(t)}).next(function(){return l.eo._o(t,e)})}))];case 2:return i=t.sent(),zf(n,r,null),Wf(n,r),n.tl.$i(r,"acknowledged"),[4,Yf(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,Fl(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,h,l})})}.bind(null,t),t.Xh.Ih.Nh=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Wr,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.oo.fa(e,r).next(function(t){return kr(null!==t),n=t.keys(),i.oo.Ia(e,t)}).next(function(){return i.oo.ya(e)}).next(function(){return i.eo._o(e,n)})}))];case 2:return o=t.sent(),zf(n,u,a),Wf(n,u),n.tl.$i(u,"rejected",a),[4,Yf(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Fl(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,t),t}var ep,np,rp,ip,op,sp,up,ap=($p.prototype.ic=function(t){this.Pl=t},$p.prototype.wo=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.rn.length||1===r.rn.length&&r.rn[0].field.p())||i.isEqual(Ri.min())?this.yl(e,r):this.Pl._o(e,o).next(function(t){var n=s.gl(r,t);return(Ou(r)||Pu(r))&&s.Wh(r.limitType,n,o,i)?s.yl(e,r):(Sr()<=f.DEBUG&&xr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Gu(r)),s.Pl.wo(e,r,i).next(function(e){return n.forEach(function(t){e=e.rt(t.key,t)}),e}))})},$p.prototype.gl=function(n,t){var r=new no(zu(n));return t.forEach(function(t,e){e instanceof Iu&&Wu(n,e)&&(r=r.add(e))}),r},$p.prototype.Wh=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.L(r))},$p.prototype.yl=function(t,e){return Sr()<=f.DEBUG&&xr("IndexFreeQueryEngine","Using full collection scan to execute query:",Gu(e)),this.Pl.wo(t,e,Ri.min())},$p),cp=(Jp.prototype.ha=function(t){return Aa.resolve(0===this.oo.length)},Jp.prototype.la=function(t,e,n,r){var i=this.Vl;this.Vl++,0<this.oo.length&&this.oo[this.oo.length-1],n=new vc(i,e,n,r),this.oo.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.pl=this.pl.add(new Kl(u.key,i)),this.ao._a(t,u.key.path.h())}return Aa.resolve(n)},Jp.prototype.fa=function(t,e){return Aa.resolve(this.bl(e))},Jp.prototype.wa=function(t,e){return e+=1,e=(e=this.vl(e))<0?0:e,Aa.resolve(this.oo.length>e?this.oo[e]:null)},Jp.prototype.ma=function(){return Aa.resolve(0===this.oo.length?-1:this.Vl-1)},Jp.prototype.Ta=function(t){return Aa.resolve(this.oo.slice())},Jp.prototype.co=function(t,e){var n=this,r=new Kl(e,0),e=new Kl(e,Number.POSITIVE_INFINITY),i=[];return this.pl.Nt([r,e],function(t){t=n.bl(t.mc),i.push(t)}),Aa.resolve(i)},Jp.prototype.fo=function(t,e){var n=this,r=new no(di);return e.forEach(function(t){var e=new Kl(t,0),t=new Kl(t,Number.POSITIVE_INFINITY);n.pl.Nt([e,t],function(t){r=r.add(t.mc)})}),Aa.resolve(this.Sl(r))},Jp.prototype.Ao=function(t,e){var n=e.path,r=n.length+1,e=n;Br.F(e)||(e=e.child(""));var e=new Kl(new Br(e),0),i=new no(di);return this.pl.Ft(function(t){var e=t.key.path;return!!n.T(e)&&(e.length===r&&(i=i.add(t.mc)),!0)},e),Aa.resolve(this.Sl(i))},Jp.prototype.Sl=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.bl(t))&&n.push(t)}),n},Jp.prototype.Ia=function(n,r){var i=this;kr(0===this.Dl(r.batchId,"removed")),this.oo.shift();var o=this.pl;return Aa.forEach(r.mutations,function(t){var e=new Kl(t.key,r.batchId);return o=o.delete(e),i.aa.Pa(n,t.key)}).next(function(){i.pl=o})},Jp.prototype.Ra=function(t){},Jp.prototype.ga=function(t,e){var n=new Kl(e,0),n=this.pl.$t(n);return Aa.resolve(e.isEqual(n&&n.key))},Jp.prototype.ya=function(t){return this.oo.length,Aa.resolve()},Jp.prototype.Dl=function(t,e){return this.vl(t)},Jp.prototype.vl=function(t){return 0===this.oo.length?0:t-this.oo[0].batchId},Jp.prototype.bl=function(t){return(t=this.vl(t))<0||t>=this.oo.length?null:this.oo[t]},Jp),hp=(Yp.prototype.Ir=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.Cl(e);return this.docs=this.docs.rt(r,{Rr:e,size:o,readTime:n}),this.size+=o-i,this.ao._a(t,r.path.h())},Yp.prototype.Pr=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Yp.prototype.yr=function(t,e){return e=this.docs.get(e),Aa.resolve(e?e.Rr:null)},Yp.prototype.getEntries=function(t,e){var n=this,r=io;return e.forEach(function(t){var e=n.docs.get(t);r=r.rt(t,e?e.Rr:null)}),Aa.resolve(r)},Yp.prototype.wo=function(t,e,n){for(var r=uo,i=new Br(e.path.child("")),o=this.docs._t(i);o.It();){var s=(u=o.Et()).key,u=(a=u.value).Rr,a=a.readTime;if(!e.path.T(s.path))break;a.L(n)<=0||u instanceof Iu&&Wu(e,u)&&(r=r.rt(u.key,u))}return Aa.resolve(r)},Yp.prototype.Nl=function(t,e){return Aa.forEach(this.docs,function(t){return e(t)})},Yp.prototype.Gr=function(t){return new lp(this)},Yp.prototype.Fa=function(t){return Aa.resolve(this.size)},Yp),lp=(n(Xp,up=h),Xp.prototype.pr=function(n){var r=this,i=[];return this.mr.forEach(function(t,e){e&&e.Rr?i.push(r.$a.Ir(n,e.Rr,r.Er(t))):r.$a.Pr(t)}),Aa.Fn(i)},Xp.prototype.gr=function(t,e){return this.$a.yr(t,e)},Xp.prototype.Vr=function(t,e){return this.$a.getEntries(t,e)},Xp),fp=(Hp.prototype.De=function(t,n){return this.Fl.forEach(function(t,e){return n(e)}),Aa.resolve()},Hp.prototype.za=function(t){return Aa.resolve(this.lastRemoteSnapshotVersion)},Hp.prototype.Ha=function(t){return Aa.resolve(this.$l)},Hp.prototype.ja=function(t){return this.highestTargetId=this.kl.next(),Aa.resolve(this.highestTargetId)},Hp.prototype.Ja=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.$l&&(this.$l=e),Aa.resolve()},Hp.prototype.Xa=function(t){this.Fl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.kl=new ll(e),this.highestTargetId=e),t.sequenceNumber>this.$l&&(this.$l=t.sequenceNumber)},Hp.prototype.Ya=function(t,e){return this.Xa(e),this.targetCount+=1,Aa.resolve()},Hp.prototype.tu=function(t,e){return this.Xa(e),Aa.resolve()},Hp.prototype.eu=function(t,e){return this.Fl.delete(e.target),this.xl.fc(e.targetId),--this.targetCount,Aa.resolve()},Hp.prototype.ea=function(n,r,i){var o=this,s=0,u=[];return this.Fl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Fl.delete(t),u.push(o.Jr(n,e.targetId)),s++)}),Aa.Fn(u).next(function(){return s})},Hp.prototype.nu=function(t){return Aa.resolve(this.targetCount)},Hp.prototype.su=function(t,e){return e=this.Fl.get(e)||null,Aa.resolve(e)},Hp.prototype.Xr=function(t,e,n){return this.xl.hc(e,n),Aa.resolve()},Hp.prototype.ru=function(e,t,n){this.xl._c(t,n);var r=this.persistence.aa,i=[];return r&&t.forEach(function(t){i.push(r.Pa(e,t))}),Aa.Fn(i)},Hp.prototype.Jr=function(t,e){return this.xl.fc(e),Aa.resolve()},Hp.prototype.au=function(t,e){return e=this.xl.wc(e),Aa.resolve(e)},Hp.prototype.ga=function(t,e){return Aa.resolve(this.xl.ga(e))},Hp),pp=(Kp.prototype.Ma=function(t,e){return Aa.resolve(this.Ml.get(e))},Kp.prototype.Oa=function(t,e){return this.Ml.set(e.id,{id:e.id,version:e.version,createTime:is(e.createTime)}),Aa.resolve()},Kp.prototype.La=function(t,e){return Aa.resolve(this.Ol.get(e))},Kp.prototype.Ba=function(t,e){return this.Ol.set(e.name,{name:(e=e).name,query:vh(e.bundledQuery),readTime:is(e.readTime)}),Aa.resolve()},Kp),dp=(Qp.prototype.start=function(){return Promise.resolve()},Qp.prototype.vi=function(){return this._u=!1,Promise.resolve()},Object.defineProperty(Qp.prototype,"wi",{get:function(){return this._u},enumerable:!1,configurable:!0}),Qp.prototype.bu=function(){},Qp.prototype.vu=function(){},Qp.prototype.Gu=function(){return this.ao},Qp.prototype.Wu=function(t){var e=this.Ll[t.Ys()];return e||(e=new cp(this.ao,this.aa),this.Ll[t.Ys()]=e),e},Qp.prototype.ju=function(){return this.Yr},Qp.prototype.Ku=function(){return this.ro},Qp.prototype.zu=function(){return this.Au},Qp.prototype.runTransaction=function(t,e,n){var r=this;xr("MemoryPersistence","Starting transaction:",t);var i=new yp(this.lu.next());return this.aa.ql(),n(i).next(function(t){return r.aa.Ul(i).next(function(){return t})}).Cn().then(function(t){return i.io(),t})},Qp.prototype.Ql=function(e,n){return Aa.$n(Object.values(this.Ll).map(function(t){return function(){return t.ga(e,n)}}))},Qp),yp=(n(zp,sp=Ee),zp),vp=(Wp.Kl=function(t){return new Wp(t)},Object.defineProperty(Wp.prototype,"Gl",{get:function(){if(this.jl)return this.jl;throw Pr()},enumerable:!1,configurable:!0}),Wp.prototype.iu=function(t,e,n){return this.Wl.iu(n,e),this.Gl.delete(n.toString()),Aa.resolve()},Wp.prototype.ou=function(t,e,n){return this.Wl.ou(n,e),this.Gl.add(n.toString()),Aa.resolve()},Wp.prototype.Pa=function(t,e){return this.Gl.add(e.toString()),Aa.resolve()},Wp.prototype.removeTarget=function(t,e){var n=this;this.Wl.fc(e.targetId).forEach(function(t){return n.Gl.add(t.toString())});var r=this.persistence.ju();return r.au(t,e.targetId).next(function(t){t.forEach(function(t){return n.Gl.add(t.toString())})}).next(function(){return r.eu(t,e)})},Wp.prototype.ql=function(){this.jl=new Set},Wp.prototype.Ul=function(n){var r=this,i=this.persistence.Ku().Gr();return Aa.forEach(this.Gl,function(t){var e=Br.D(t);return r.zl(n,e).next(function(t){t||i.Pr(e)})}).next(function(){return r.jl=null,i.apply(n)})},Wp.prototype.Zu=function(t,e){var n=this;return this.zl(t,e).next(function(t){t?n.Gl.delete(e.toString()):n.Gl.add(e.toString())})},Wp.prototype.Bl=function(t){return 0},Wp.prototype.zl=function(t,e){var n=this;return Aa.$n([function(){return Aa.resolve(n.Wl.ga(e))},function(){return n.persistence.ju().ga(t,e)},function(){return n.persistence.Ql(t,e)}])},Wp),gp=(Gp.prototype.zc=function(t){this.Yl=t},Gp.prototype.Qc=function(t){this.Xl=t},Gp.prototype.onMessage=function(t){this.Zl=t},Gp.prototype.close=function(){this.Jl()},Gp.prototype.send=function(t){this.Hl(t)},Gp.prototype.t_=function(){this.Yl()},Gp.prototype.e_=function(t){this.Xl(t)},Gp.prototype.n_=function(t){this.Zl(t)},Gp),mp={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},wp=(Bp.prototype.ah=function(e,t,n,r){var i=this.o_(e,t);return xr("RestConnection","Sending: ",i,n),t={},this.a_(t,r),this.u_(e,i,t,n).then(function(t){return xr("RestConnection","Received: ",t),t},function(t){throw Dr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Bp.prototype.uh=function(t,e,n,r){return this.ah(t,e,n,r)},Bp.prototype.a_=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.22.1-alpha.96ae6a5fe",t["Content-Type"]="text/plain",e)for(var n in e.Tc)e.Tc.hasOwnProperty(n)&&(t[n]=e.Tc[n])},Bp.prototype.o_=function(t,e){return t=mp[t],this.i_+"/v1/"+e+":"+t},n(qp,op=Bp),qp.prototype.u_=function(o,e,s,u){return new Promise(function(n,r){var i=new mr;i.listenOnce(vr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case yr.NO_ERROR:var t=i.getResponseJson();xr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case yr.TIMEOUT:xr("Connection",'RPC "'+o+'" timed out'),r(new Tr(Ir.DEADLINE_EXCEEDED,"Request time out"));break;case yr.HTTP_ERROR:var e=i.getStatus();xr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Ir).indexOf(e)?e:Ir.UNKNOWN,r(new Tr(e,t.message))):r(new Tr(Ir.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Tr(Ir.UNAVAILABLE,"Connection failed."));break;default:Pr()}}finally{xr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},qp.prototype.Hc=function(t,e){var n,r=[this.i_,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=dr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.U.projectId+"/databases/"+this.U.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.a_(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),xr("Connection","Creating WebChannel: "+(r=r.join("")),t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new gp({Hl:function(t){u?xr("Connection","Not sending because WebChannel is closed:",t):(s||(xr("Connection","Opening WebChannel transport."),o.open(),s=!0),xr("Connection","WebChannel sending:",t),o.send(t))},Jl:function(){return o.close()}});return(t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})})(gr.EventType.OPEN,function(){u||xr("Connection","WebChannel transport opened.")}),t(gr.EventType.CLOSE,function(){u||(u=!0,xr("Connection","WebChannel transport closed"),a.e_())}),t(gr.EventType.ERROR,function(t){u||(u=!0,Dr("Connection","WebChannel transport errored:",t),a.e_(new Tr(Ir.UNAVAILABLE,"The operation could not be completed")))}),t(gr.EventType.MESSAGE,function(t){var e,n,r,i;u||(kr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(xr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Wi[r];if(void 0!==t)return Hi(t)}(),i=n.message,void 0===t&&(t=Ir.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.e_(new Tr(t,i)),o.close()):(xr("Connection","WebChannel received:",e),a.n_(e)))}),setTimeout(function(){a.t_()},0),a},qp),bp=(Fp.prototype.Vh=function(t){this.f_.push(t)},Fp.prototype.vi=function(){window.removeEventListener("online",this.c_),window.removeEventListener("offline",this.l_)},Fp.prototype.d_=function(){window.addEventListener("online",this.c_),window.addEventListener("offline",this.l_)},Fp.prototype.h_=function(){xr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.f_;t<e.length;t++)(0,e[t])(0)},Fp.prototype.__=function(){xr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.f_;t<e.length;t++)(0,e[t])(1)},Fp.Mn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Fp),Ep=(jp.prototype.Vh=function(t){},jp.prototype.vi=function(){},jp),Ip="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Tp=(Vp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.serializer=Dc(e.s_.U),this.tl=this.w_(e),this.persistence=this.m_(e),[4,this.persistence.start()];case 1:return t.sent(),this.T_=this.E_(e),this.Wr=this.I_(e),[2]}})})},Vp.prototype.E_=function(t){return null},Vp.prototype.I_=function(t){return Pl(this.persistence,new ap,t.A_,this.serializer)},Vp.prototype.m_=function(t){if(t.persistenceSettings.R_)throw new Tr(Ir.FAILED_PRECONDITION,Ip);return new dp(vp.Kl,this.serializer)},Vp.prototype.w_=function(t){return new yc},Vp.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.T_&&this.T_.stop(),[4,this.tl.vi()];case 1:return t.sent(),[4,this.persistence.vi()];case 2:return t.sent(),[2]}})})},Vp.prototype.clearPersistence=function(t,e){throw new Tr(Ir.FAILED_PRECONDITION,Ip)},Vp),_p=(n(Mp,ip=Tp),Mp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,ip.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=Dh(t),r=Ri.min(),t.ns({index:Kh.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=hh(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.sc=t})]})})}(this.Wr)];case 2:return t.sent(),[4,this.P_.initialize(this,e)];case 3:return t.sent(),[4,tp(this.P_.hi)];case 4:return t.sent(),[4,Sf(this.P_.Xh)];case 5:return t.sent(),[2]}})})},Mp.prototype.I_=function(t){return Pl(this.persistence,new ap,t.A_,this.serializer)},Mp.prototype.E_=function(t){var e=this.persistence.aa.jo;return new Zc(e,t.rs)},Mp.prototype.m_=function(t){var e=Rl(t.s_.U,t.s_.persistenceKey);return new El(t.persistenceSettings.synchronizeTabs,e,t.clientId,Yc.Mo(t.persistenceSettings.cacheSizeBytes),t.rs,Ba(),Ga(),this.serializer,this.tl,t.persistenceSettings.hu)},Mp.prototype.w_=function(t){return new yc},Mp.prototype.clearPersistence=function(t,e){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return Na.Mn()?(e=n+"main",[4,Na.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(Rl(t,e))},n(Up,rp=Mp),Up.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,rp.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.P_.hi,this.tl instanceof dc?(this.tl.hi={nr:function(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).Wr,n=a,i=(r=e).oo,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.da(e,n).next(function(t){return t?r.eo._o(e,t):Aa.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,Sf(o.Xh)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(zf(o,a,h||null),Wf(o,a),o.Wr.oo.Ra(a)):Pr(),t.label=4;case 4:return[4,Yf(o,s)];case 5:return t.sent(),[3,7];case 6:xr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}.bind(null,e),sr:function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return(e=i)._l?(xr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!e.il.has(o))return[3,8];switch(s){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,jl(e.Wr)];case 3:return n=t.sent(),r=vo.Yt(o,"current"===s),[4,Yf(e,n,r)];case 4:return t.sent(),[3,8];case 5:return[4,Ul(e.Wr,o,!0)];case 6:return t.sent(),Qf(e,o,u),[3,8];case 7:Pr(),t.label=8;case 8:return[2]}})})}.bind(null,e),ir:function(c,h,l){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=Zf(c))._l)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.il.has(r)?(xr("SyncEngine","Adding an already active target "+r),[3,5]):[4,Vl(n.Wr,r)]):[3,6];case 2:return i=t.sent(),[4,Cl(n.Wr,i)];case 3:return o=t.sent(),[4,qf(n,$f(i),o.targetId,!1)];case 4:t.sent(),gf(n.Xh,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.il.has(e)?[4,Ul(n.Wr,e,!1).then(function(){mf(n.Xh,e),Qf(n,e)}).catch(Fl)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=l,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),gi:function(t){return t.Wr.persistence.gi()}.bind(null,e),er:function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,jl((e=n).Wr).then(function(t){return Yf(e,t)})]})})}.bind(null,e)},[4,this.tl.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.pu(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,function(h,l){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return Zf(r=h),tp(r),!0!==l||!0===r._l?[3,3]:(e=r.tl.Si(),[4,Jf(r,e.A())]);case 1:return i=t.sent(),r._l=!0,[4,Df(r.Xh,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],gf(r.Xh,u);return[3,7];case 3:return!1!==l||!1===r._l?[3,7]:(a=[],c=Promise.resolve(),r.il.forEach(function(t,e){r.tl.Li(e)?a.push(e):c=c.then(function(){return Qf(r,e),Ul(r.Wr,e,!0)}),mf(r.Xh,e)}),[4,c]);case 4:return t.sent(),[4,Jf(r,a)];case 5:return t.sent(),(n=r).al.forEach(function(t,e){mf(n.Xh,e)}),n.ul.dc(),n.al=new Map,n.ol=new Xi(Br.i),r._l=!1,[4,Df(r.Xh,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}(this.P_.hi,e)];case 1:return t.sent(),this.T_&&(e&&!this.T_.wi?this.T_.start(this.Wr):e||this.T_.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},Up.prototype.w_=function(t){if(t.persistenceSettings.R_&&t.persistenceSettings.synchronizeTabs){var e=Ba();if(!dc.Mn(e))throw new Tr(Ir.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Rl(t.s_.U,t.s_.persistenceKey);return new dc(e,t.rs,n,t.clientId,t.A_)}return new yc},Up),Ap=(Cp.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Wr?[3,2]:(this.Wr=n.Wr,this.tl=n.tl,this.Eh=this.y_(r),this.Xh=this.g_(r),this.Zh=this.V_(r),this.hi=this.p_(r),this.tl.li=function(t){return Gf(e.hi,t,1)},this.Xh.Ih.b_=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(xr("SyncEngine","User change. New user:",o.Ys()),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).oo,m=e.eo,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.oo.Ta(v).next(function(t){return g=t,n=e.persistence.Wu(o),m=new qc(e.zr,n,e.persistence.Gu()),n.Ta(v)}).next(function(t){for(var e=[],n=[],r=ho(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,l=t;h<l.length;h++){var f=l[h];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m._o(v,r).next(function(t){return{ml:t,Tl:e,El:n}})})})];case 1:return r=t.sent(),[2,(e.oo=n,e.eo=m,e.tc.ic(e.eo),r)]}})})}(n.Wr,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).hl.forEach(function(t){t.forEach(function(t){t.reject(new Tr(Ir.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.hl.clear(),n.tl.Qi(o,r.Tl,r.El),[4,Yf(n,r.ml)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this.hi),[4,Df(this.Xh,this.hi.fl)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Cp.prototype.V_=function(t){return new Ya},Cp.prototype.y_=function(t){var e=Dc(t.s_.U),n=(n=t.s_,new wp(n));return t=t.credentials,new tf(t,n,e)},Cp.prototype.g_=function(t){var e=this;return new Bl(this.Wr,this.Eh,t.rs,function(t){return Gf(e.hi,t,0)},t=new(bp.Mn()?bp:Ep))},Cp.prototype.p_=function(t){return e=this.Wr,n=this.Xh,r=this.Zh,i=this.tl,o=t.A_,s=t.el,u=!t.persistenceSettings.R_||!t.persistenceSettings.synchronizeTabs,s=new Vf(e,n,r,i,o,s),u&&(s._l=!0),s;var e,n,r,i,o,s,u},Cp.prototype.terminate=function(){return vf(this.Xh)},Cp),Np=(Lp.prototype.next=function(t){this.observer.next&&this.v_(this.observer.next,t)},Lp.prototype.error=function(t){this.observer.error?this.v_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Lp.prototype.S_=function(){this.muted=!0},Lp.prototype.v_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Lp),Sp=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Tr(Ir.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(Jr("FieldPath","string",e,t[e]),0===t[e].length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.D_=new qr(t)},xp=(n(kp,np=Sp),kp.documentId=function(){return new kp(qr.v().R())},kp.prototype.isEqual=function(t){if(!(t instanceof kp))throw ai("isEqual","FieldPath",1,t);return this.D_.isEqual(t.D_)},kp),Rp=new RegExp("[~\\*/\\[\\]]"),Dp=function(t){this.C_=t},Op=(n(Pp,ep=Dp),Pp.prototype.N_=function(t){if(2!==t.F_)throw 1===t.F_?t.x_(this.C_+"() can only appear at the top level of your update data"):t.x_(this.C_+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},Pp.prototype.isEqual=function(t){return t instanceof Pp},Pp);function Pp(){return null!==ep&&ep.apply(this,arguments)||this}function kp(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return np.call(this,t)||this}function Lp(t){this.observer=t,this.muted=!1}function Cp(){}function Up(){return null!==rp&&rp.apply(this,arguments)||this}function Mp(t){var e=this;return(e=ip.call(this)||this).P_=t,e}function Vp(){}function jp(){}function Fp(){var t=this;this.c_=function(){return t.h_()},this.l_=function(){return t.__()},this.f_=[],this.d_()}function qp(t){var e=this;return(e=op.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function Bp(t){this.s_=t,this.U=t.U;var e=t.ssl?"https":"http";this.i_=e+"://"+t.host,this.r_="projects/"+this.U.projectId+"/databases/"+this.U.database+"/documents"}function Gp(t){this.Hl=t.Hl,this.Jl=t.Jl}function Wp(t){this.persistence=t,this.Wl=new Ql,this.jl=null}function zp(t){var e=this;return(e=sp.call(this)||this).uu=t,e}function Qp(t,e){var n=this;this.Ll={},this.lu=new ic(0),this._u=!1,this._u=!0,this.aa=t(this),this.Yr=new fp(this),this.ao=new kh,this.ro=(t=this.ao,new hp(t,function(t){return n.aa.Bl(t)})),this.serializer=new sh(e),this.Au=new pp(this.serializer)}function Kp(t){this.serializer=t,this.Ml=new Map,this.Ol=new Map}function Hp(t){this.persistence=t,this.Fl=new Si(Fi,qi),this.lastRemoteSnapshotVersion=Ri.min(),this.highestTargetId=0,this.$l=0,this.xl=new Ql,this.targetCount=0,this.kl=ll.Qa()}function Xp(t){var e=this;return(e=up.call(this)||this).$a=t,e}function Yp(t,e){this.ao=t,this.Cl=e,this.docs=new Xi(Br.i),this.size=0}function Jp(t,e){this.ao=t,this.aa=e,this.oo=[],this.Vl=1,this.pl=new no(Kl.ac)}function $p(){}function Zp(t,e,n){return new Id({F_:3,k_:e.settings.k_,methodName:t.C_,M_:n},e.U,e.serializer,e.ignoreUndefinedProperties)}var td,ed,nd,rd,id=(n(bd,rd=Dp),bd.prototype.N_=function(t){return new Gs(t.path,new xs)},bd.prototype.isEqual=function(t){return t instanceof bd},bd),od=(n(wd,nd=Dp),wd.prototype.N_=function(t){var e=Zp(this,t,!0),n=this.O_.map(function(t){return Dd(t,e)}),n=new Rs(n);return new Gs(t.path,n)},wd.prototype.isEqual=function(t){return this===t},wd),sd=(n(md,ed=Dp),md.prototype.N_=function(t){var e=Zp(this,t,!0),n=this.O_.map(function(t){return Dd(t,e)}),n=new Ls(n);return new Gs(t.path,n)},md.prototype.isEqual=function(t){return this===t},md),ud=(n(gd,td=Dp),gd.prototype.N_=function(t){var e=new Vs(t.serializer,es(t.serializer,this.L_));return new Gs(t.path,e)},gd.prototype.isEqual=function(t){return this===t},gd),ad=(Object.defineProperty(vd.prototype,"latitude",{get:function(){return this.B_},enumerable:!1,configurable:!0}),Object.defineProperty(vd.prototype,"longitude",{get:function(){return this.q_},enumerable:!1,configurable:!0}),vd.prototype.isEqual=function(t){return this.B_===t.B_&&this.q_===t.q_},vd.prototype.toJSON=function(){return{latitude:this.B_,longitude:this.q_}},vd.prototype.H=function(t){return di(this.B_,t.B_)||di(this.q_,t.q_)},vd),cd=function(t){this.U_=t},hd=/^__.*__$/,ld=function(t,e,n){this.Q_=t,this.W_=e,this.j_=n},fd=(yd.prototype.K_=function(t,e){var n=[];return null!==this.Qe?n.push(new eu(t,this.data,this.Qe,e)):n.push(new tu(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new su(t,this.fieldTransforms)),n},yd),pd=(dd.prototype.K_=function(t,e){return e=[new eu(t,this.data,this.Qe,e)],0<this.fieldTransforms.length&&e.push(new su(t,this.fieldTransforms)),e},dd);function dd(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function yd(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function vd(t,e){if(Hr("GeoPoint",arguments,2),Jr("GeoPoint","number",1,t),Jr("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Tr(Ir.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Tr(Ir.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.B_=t,this.q_=e}function gd(t,e){var n=this;return(n=td.call(this,t)||this).L_=e,n}function md(t,e){var n=this;return(n=ed.call(this,t)||this).O_=e,n}function wd(t,e){var n=this;return(n=nd.call(this,t)||this).O_=e,n}function bd(){return null!==rd&&rd.apply(this,arguments)||this}function Ed(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Pr()}}var Id=(Object.defineProperty(Ad.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Ad.prototype,"F_",{get:function(){return this.settings.F_},enumerable:!1,configurable:!0}),Ad.prototype.z_=function(t){return new Ad(Object.assign(Object.assign({},this.settings),t),this.U,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},Ad.prototype.H_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.z_({path:e,M_:!1})).J_(t),e},Ad.prototype.Y_=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.z_({path:t,M_:!1})).G_(),t},Ad.prototype.X_=function(t){return this.z_({path:void 0,M_:!0})},Ad.prototype.x_=function(t){return Ud(t,this.settings.methodName,this.settings.Z_||!1,this.path,this.settings.k_)},Ad.prototype.contains=function(e){return void 0!==this.Qe.find(function(t){return e.T(t)})||void 0!==this.fieldTransforms.find(function(t){return e.T(t.field)})},Ad.prototype.G_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.J_(this.path.get(t))},Ad.prototype.J_=function(t){if(0===t.length)throw this.x_("Document fields must not be empty");if(Ed(this.F_)&&hd.test(t))throw this.x_('Document fields cannot begin and end with "__"')},Ad),Td=(_d.prototype.tf=function(t,e,n,r){return void 0===r&&(r=!1),new Id({F_:t,methodName:e,k_:n,path:qr.g(),M_:!1,Z_:r},this.U,this.serializer,this.ignoreUndefinedProperties)},_d);function _d(t,e,n){this.U=t,this.ignoreUndefinedProperties=e,this.serializer=n||Dc(t)}function Ad(t,e,n,r,i,o){this.settings=t,this.U=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.G_(),this.fieldTransforms=i||[],this.Qe=o||[]}function Nd(t,e,n,r,i,o){void 0===o&&(o={});var s=t.tf(o.merge||o.mergeFields?2:0,e,n,i);kd("Data must be an object, but it was:",s,r);var u,a,r=Od(r,s);if(o.merge)u=new Bs(s.Qe),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,l=o.mergeFields;h<l.length;h++){var f=l[h],p=void 0;if(f instanceof Sp)p=f.D_;else{if("string"!=typeof f)throw Pr();p=Cd(e,f,n)}if(!s.contains(p))throw new Tr(Ir.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Md(c,p)||c.push(p)}u=new Bs(c),a=s.fieldTransforms.filter(function(t){return u.He(t.field)})}else u=null,a=s.fieldTransforms;return new fd(new pu(r),u,a)}function Sd(t,r,i,e){var o=t.tf(1,r,i);kd("Data must be an object, but it was:",o,e);var s=[],u=new du;return Cr(e,function(t,e){var n=Cd(r,t,i),t=o.Y_(n);e instanceof Op||e instanceof cd&&e.U_ instanceof Op?s.push(n):null!=(t=Dd(e,t))&&(s.push(n),u.set(n,t))}),e=new Bs(s),new pd(u.Ye(),e,o.fieldTransforms)}function xd(t,e,n,r,i,o){var s=t.tf(1,e,n),u=[Ld(e,r,n)],a=[i];if(o.length%2!=0)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Ld(e,o[c])),a.push(o[c+1]);for(var h,l,f,p=[],d=new du,y=u.length-1;0<=y;--y)Md(p,u[y])||(h=u[y],l=a[y],f=s.Y_(h),l instanceof Op||l instanceof cd&&l.U_ instanceof Op?p.push(h):null!=(f=Dd(l,f))&&(p.push(h),d.set(h,f)));return i=new Bs(p),new pd(d.Ye(),i,s.fieldTransforms)}function Rd(t,e,n,r){return void 0===r&&(r=!1),Dd(n,t.tf(r?4:3,e))}function Dd(s,t){if(s instanceof cd&&(s=s.U_),Pd(s))return kd("Unsupported field value:",t,s),Od(s,t);if(s instanceof Dp)return function(t,e){if(!Ed(e.F_))throw e.x_(t.C_+"() can only be used with update() and set()");if(!e.path)throw e.x_(t.C_+"() is not currently supported inside arrays");(t=t.N_(e))&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.Qe.push(t.path),s instanceof Array){if(t.settings.M_&&4!==t.F_)throw t.x_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Dd(i[r],t.X_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return es(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=xi.fromDate(t);return{timestampValue:ns(e.serializer,n)}}if(t instanceof xi){var r=new xi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:ns(e.serializer,r)}}if(t instanceof ad)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof wi)return{bytesValue:rs(e.serializer,t.q)};if(t instanceof ld){if(n=e.U,!(r=t.Q_).isEqual(n))throw e.x_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:os(t.Q_||e.U,t.W_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.x_("Unsupported field value: "+oi(t))}(s,t)}function Od(t,n){var r={};return Ur(t)?n.path&&0<n.path.length&&n.Qe.push(n.path):Cr(t,function(t,e){null!=(e=Dd(e,n.H_(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function Pd(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof xi||t instanceof ad||t instanceof wi||t instanceof ld||t instanceof Dp)}function kd(t,e,n){if(!Pd(n)||!ii(n))throw"an object"===(n=oi(n))?e.x_(t+" a custom object"):e.x_(t+" "+n)}function Ld(t,e,n){if(e instanceof Sp)return e.D_;if("string"==typeof e)return Cd(t,e);throw Ud("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Cd(t,e,n){try{return function(e){if(0<=e.search(Rp))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(xp.bind.apply(xp,i([void 0],e.split("."))))}catch(t){throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).D_}catch(e){throw Ud(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Ud(t,e,n,r,i){var o=r&&!r.m(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Tr(Ir.INVALID_ARGUMENT,(e+=". ")+t+n)}function Md(t,e){return t.some(function(t){return t.isEqual(e)})}var Vd=(Gd.prototype.rf=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.af(),0<this.mutations.length)throw new Tr(Ir.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var i,e,n,o,r;return v(this,function(t){switch(t.label){case 0:return e=ls((i=s).serializer)+"/documents",n={documents:u.map(function(t){return us(i.serializer,t)})},[4,i.uh("BatchGetDocuments",e,n)];case 1:return n=t.sent(),o=new Map,n.forEach(function(t){var e,n,r,t=(e=i.serializer,"found"in(t=t)?function(t,e){kr(!!e.found),e.found.name,e.found.updateTime;var n=as(t,e.found.name),t=is(e.found.updateTime),e=new pu({mapValue:{fields:e.found.fields}});return new Iu(n,t,e,{})}(e,t):"missing"in t?(n=e,kr(!!(r=t).missing),kr(!!r.readTime),n=as(n,r.missing),r=is(r.readTime),new Tu(n,r)):Pr());o.set(t.key.toString(),t)}),r=[],[2,(u.forEach(function(t){kr(!!(t=o.get(t.toString()))),r.push(t)}),r)]}})})}(this.Eh,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Tu||t instanceof Iu?n.uf(t):Pr()}),e)]}})})},Gd.prototype.set=function(t,e){this.write(e.K_(t,this.Ke(t))),this.if.add(t.toString())},Gd.prototype.update=function(t,e){try{this.write(e.K_(t,this.cf(t)))}catch(t){this.sf=t}this.if.add(t.toString())},Gd.prototype.delete=function(t){this.write([new lu(t,this.Ke(t))]),this.if.add(t.toString())},Gd.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.af(),this.sf)throw this.sf;return e=this.ef,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=Br.D(e),n.mutations.push(new fu(e,n.Ke(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=ls((e=i).serializer)+"/documents",r={writes:o.map(function(t){return ys(e.serializer,t)})},[4,e.ah("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Eh,this.mutations)];case 1:return t.sent(),this.nf=!0,[2]}})})},Gd.prototype.uf=function(t){var e;if(t instanceof Iu)e=t.version;else{if(!(t instanceof Tu))throw Pr();e=Ri.min()}var n=this.ef.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Tr(Ir.ABORTED,"Document version changed between two reads.")}else this.ef.set(t.key.toString(),e)},Gd.prototype.Ke=function(t){var e=this.ef.get(t.toString());return!this.if.has(t.toString())&&e?Qs.updateTime(e):Qs.Ge()},Gd.prototype.cf=function(t){var e=this.ef.get(t.toString());if(this.if.has(t.toString())||!e)return Qs.exists(!0);if(e.isEqual(Ri.min()))throw new Tr(Ir.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Qs.updateTime(e)},Gd.prototype.write=function(t){this.af(),this.mutations=this.mutations.concat(t)},Gd.prototype.af=function(){},Gd),jd=(Bd.prototype.run=function(){this.lf()},Bd.prototype.lf=function(){var t=this;this.Ps.An(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Vd(this.Eh),(n=this._f(e))&&n.then(function(t){r.rs.fs(function(){return e.commit().then(function(){r.cs.resolve(t)}).catch(function(t){r.ff(t)})})}).catch(function(t){r.ff(t)}),[2]})})})},Bd.prototype._f=function(t){try{var e=this.updateFunction(t);return!Ci(e)&&e.catch&&e.then?e:(this.cs.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.cs.reject(t),null}},Bd.prototype.ff=function(t){var e=this;0<this.hf&&this.df(t)?(--this.hf,this.rs.fs(function(){return e.lf(),Promise.resolve()})):this.cs.reject(t)},Bd.prototype.df=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!Ki(t))},Bd),Fd=(qd.prototype.start=function(t,e,n,r){var i=this;this.mf(),this.s_=t;var o=new Ia,s=!1;return this.credentials.Ac(function(t){return s?void i.rs.Ss(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).rs.Ns(),xr("RemoteStore","RemoteStore received new credentials"),n=Tf(e),e.Ph.add(3),[4,yf(e)];case 1:return t.sent(),n&&e.ph.set("Unknown"),[4,e.Ih.b_(i)];case 2:return t.sent(),e.Ph.delete(3),[4,df(e)];case 3:return t.sent(),[2]}})})}(i.Xh,t)}):(s=!0,xr("FirestoreClient","Initializing. user=",t.uid),i.Tf(e,n,r,t,o).then(i.wf.resolve,i.wf.reject))}),this.rs.fs(function(){return i.wf.promise}),o.promise},qd.prototype.enableNetwork=function(){var e=this;return this.mf(),this.rs.enqueue(function(){return e.persistence.vu(!0),(t=e.Xh).Ph.delete(0),df(t);var t})},qd.prototype.Tf=function(r,i,o,s,u){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={rs:this.rs,s_:this.s_,clientId:this.clientId,credentials:this.credentials,A_:s,el:100,persistenceSettings:o},[4,r.initialize(e)];case 1:return t.sent(),[4,i.initialize(r,e)];case 2:return t.sent(),this.persistence=r.persistence,this.tl=r.tl,this.Wr=r.Wr,this.T_=r.T_,this.Eh=i.Eh,this.Xh=i.Xh,this.hi=i.hi,this.Ef=i.Zh,this.Ef.Ls=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=Zf(s),(o=e.sl.get(u))?(n=o.targetId,e.tl.ki(n),r=o.view.Jh(),[3,4]):[3,1];case 1:return[4,Cl(e.Wr,Mu(u))];case 2:return i=t.sent(),o=e.tl.ki(i.targetId),n=i.targetId,[4,qf(e,u,n,"current"===o)];case 3:r=t.sent(),e.fl&&gf(e.Xh,i),t.label=4;case 4:return[2,r]}})})}.bind(null,this.hi),this.Ef.Us=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).sl.get(o),1<(r=e.il.get(n.targetId)).length?[2,(e.il.set(n.targetId,r.filter(function(t){return!qu(t,o)})),void e.sl.delete(o))]:e.fl?(e.tl.Oi(n.targetId),e.tl.Ci(n.targetId)?[3,2]:[4,Ul(e.Wr,n.targetId,!1).then(function(){e.tl.Bi(n.targetId),mf(e.Xh,n.targetId),Qf(e,n.targetId)}).catch(Fl)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Qf(e,n.targetId),[4,Ul(e.Wr,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,this.hi),this.persistence.bu(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),u.resolve(),[3,4];case 3:if(e=t.sent(),u.reject(e),!this.If(e))throw e;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),this.Tf(new Tp,new Ap,{R_:!1},s,u))];case 4:return[2]}})})},qd.prototype.If=function(t){return"FirebaseError"===t.name?t.code===Ir.FAILED_PRECONDITION||t.code===Ir.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},qd.prototype.mf=function(){if(this.rs.gs)throw new Tr(Ir.FAILED_PRECONDITION,"The client has already been terminated.")},qd.prototype.disableNetwork=function(){var t=this;return this.mf(),this.rs.enqueue(function(){return t.persistence.vu(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Ph.add(0),[4,yf(e)];case 1:return t.sent(),e.ph.set("Offline"),[2]}})})}(t.Xh)})},qd.prototype.terminate=function(){var t=this;this.rs.vs();var n=new Ia;return this.rs.Vs(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.T_&&this.T_.stop(),[4,vf(this.Xh)];case 1:return t.sent(),[4,this.tl.vi()];case 2:return t.sent(),[4,this.persistence.vi()];case 3:return t.sent(),this.credentials.Rc(),n.resolve(),[3,5];case 4:return e=Ha(e=t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,5];case 5:return[2]}})})}),n.promise},qd.prototype.waitForPendingWrites=function(){var t=this;this.mf();var e=new Ia;return this.rs.fs(function(){return function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:Tf((n=o).Xh)||xr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Wr).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.oo.ma(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.hl.get(r)||[]).push(s),n.hl.set(r,i),[3,4]);case 3:return i=Ha(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}(t.hi,e)}),e.promise},qd.prototype.listen=function(t,e,n){var r=this;this.mf();var i=new Np(n),o=new tc(t,i,e);return this.rs.fs(function(){return Ja(r.Ef,o)}),function(){i.S_(),r.rs.fs(function(){return $a(r.Ef,o)})}},qd.prototype.Af=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.mf(),[4,this.wf.promise];case 1:return t.sent(),e=new Ia,[2,(this.rs.fs(function(){return function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.eo.uo(t,e)}))];case 1:return(r=t.sent())instanceof Iu?s.resolve(r):r instanceof Tu?s.resolve(null):s.reject(new Tr(Ir.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=Ha(r=t.sent(),"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(n.Wr,r,e)}),e.promise)]}})})},qd.prototype.Rf=function(c,h){return void 0===h&&(h={}),y(this,void 0,void 0,function(){var e,a=this;return v(this,function(t){switch(t.label){case 0:return this.mf(),[4,this.wf.promise];case 1:return t.sent(),e=new Ia,[2,(this.rs.fs(function(){return n=a.Ef,r=a.rs,i=c,o=h,s=e,t=new Np({next:function(t){r.fs(function(){return $a(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Tr(Ir.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Tr(Ir.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new tc(Du(i.path),t,{includeMetadataChanges:!0,Hs:!0}),Ja(n,u);var n,r,i,o,s,t,u}),e.promise)]}})})},qd.prototype.Pf=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.mf(),[4,this.wf.promise];case 1:return t.sent(),e=new Ia,[2,(this.rs.fs(function(){return function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Ml(r,i,!0)];case 1:return n=t.sent(),e=new Cf(i,n.rc),n=e.qh(n.documents),n=e.pr(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=Ha(n=t.sent(),"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(n.Wr,r,e)}),e.promise)]}})})},qd.prototype.yf=function(c,h){return void 0===h&&(h={}),y(this,void 0,void 0,function(){var u,a=this;return v(this,function(t){switch(t.label){case 0:return this.mf(),[4,this.wf.promise];case 1:return t.sent(),u=new Ia,[2,(this.rs.fs(function(){return e=a.Ef,n=a.rs,t=c,r=h,i=u,o=new Np({next:function(t){n.fs(function(){return $a(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Tr(Ir.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new tc(t,o,{includeMetadataChanges:!0,Hs:!0}),Ja(e,s);var e,n,t,r,i,o,s}),u.promise)]}})})},qd.prototype.write=function(t){var e=this;this.mf();var n=new Ia;return this.rs.fs(function(){return function(f,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=tp(f),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.Wr,a=p,h=i,l=xi.now(),o=a.reduce(function(t,e){return t.add(e.key)},ho()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.eo._o(u,o).next(function(t){c=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=c.get(i.key),s instanceof su?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Iu?t.field(i.field):void 0;null!=(o=As(i.transform,o||null))&&(e=(null==e?new du:e).set(i.field,o))}return e?e.Ye():null}(o):null);null!=o&&e.push(new eu(i.key,o,function s(t){var u=[];return Cr(t.fields||{},function(t,e){var n=new qr([t]);if(Xo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Bs(u)}(o.proto.mapValue),Qs.exists(!0)))}return h.oo.la(u,l,e,a)})}).then(function(t){var e=t._r(c);return{batchId:t.batchId,mr:e}}))];case 2:return s=t.sent(),u.tl.Ni(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e.cl[e.currentUser.Ys()])||new Xi(di)).rt(n,r),e.cl[e.currentUser.Ys()]=i,[4,Yf(u,s.mr)];case 3:return t.sent(),[4,Sf(u.Xh)];case 4:return t.sent(),[3,6];case 5:return u=Ha(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,l,o})})}(e.hi,t,n)}),n.promise},qd.prototype.U=function(){return this.s_.U},qd.prototype.gf=function(t){var e=this;this.mf();var r=new Np(t);return this.rs.fs(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,(e=this.Ef,n=r,e.Os.add(n),void n.next())];var e,n})})}),function(){r.S_(),e.rs.fs(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,void this.Ef.Os.delete(r)]})})})}},Object.defineProperty(qd.prototype,"Vf",{get:function(){return this.rs.gs},enumerable:!1,configurable:!0}),qd.prototype.transaction=function(t){var e=this;this.mf();var n=new Ia;return this.rs.fs(function(){return new jd(e.rs,e.Eh,t,n).run(),Promise.resolve()}),n.promise},qd.prototype.loadBundle=function(t,r){var e=this;this.mf();var n,i,o=(n=t,i=Dc(this.s_.U),n="string"==typeof n?(new TextEncoder).encode(n):n,new Pc(Rc(n),i));this.rs.fs(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,(e=this.hi,function(f,p,d){return y(this,void 0,void 0,function(){var u,a,c,h,l;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,14,,15]),[4,p.getMetadata()];case 1:return u=t.sent(),[4,(r=f.Wr,i=u,s=new kc((o=r).serializer).qr(i.createTime),o.persistence.runTransaction("hasNewerBundle","readonly",function(t){return o.Au.Ma(t,i.id)}).then(function(t){return!!t&&0<=t.createTime.L(s)}))];case 2:return t.sent()?[4,p.close()]:[3,4];case 3:return[2,(t.sent(),void d.Il({taskState:"Success",documentsLoaded:u.totalDocuments,bytesLoaded:u.totalBytes,totalDocuments:u.totalDocuments,totalBytes:u.totalBytes}))];case 4:return d.Al(Mc(u)),a=new jc(u,f.Wr,p.serializer),[4,p.Nr()];case 5:c=t.sent(),t.label=6;case 6:return c?[4,a.jr(c)]:[3,10];case 7:return(h=t.sent())&&d.Al(h),[4,p.Nr()];case 8:c=t.sent(),t.label=9;case 9:return[3,6];case 10:return[4,a.complete()];case 11:return l=t.sent(),[4,Yf(f,l.Ur,void 0)];case 12:return t.sent(),[4,(r=f.Wr,e=u,(n=r).persistence.runTransaction("Save bundle","readwrite",function(t){return n.Au.Oa(t,e)}))];case 13:return t.sent(),d.Il(l.progress),[3,15];case 14:return l=t.sent(),d.Rl(l),[3,15];case 15:return[2]}var e,n,r,i,o,s})})}(n=e,o,r).then(function(){n.tl.Ki()}),r.catch(function(t){Dr("FirestoreClient","Loading bundle failed with "+t)}))];var e,n})})})},qd.prototype.La=function(t){return this.mf(),e=this.Wr,n=t,(r=e).persistence.runTransaction("Get named query","readonly",function(t){return r.Au.La(t,n)});var e,n,r},qd);function qd(t,e){this.credentials=t,this.rs=e,this.clientId=fi.k(),this.wf=new Ia}function Bd(t,e,n,r){this.rs=t,this.Eh=e,this.updateFunction=n,this.cs=r,this.hf=5,this.Ps=new _a(this.rs,"transaction_retry")}function Gd(t){this.Eh=t,this.ef=new Map,this.mutations=[],this.nf=!1,this.sf=null,this.if=new Set}function Wd(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var zd,Qd,Kd=(py.prototype.Sf=function(t){switch(Co(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Bo(t.integerValue||t.doubleValue);case 3:return this.Df(t.timestampValue);case 4:return this.Cf(t);case 5:return t.stringValue;case 6:return this.vf(Go(t.bytesValue));case 7:return this.Nf(t.referenceValue);case 8:return this.Ff(t.geoPointValue);case 9:return this.$f(t.arrayValue);case 10:return this.xf(t.mapValue);default:throw Pr()}},py.prototype.xf=function(t){var n=this,r={};return Cr(t.fields||{},function(t,e){r[t]=n.Sf(e)}),r},py.prototype.Ff=function(t){return new ad(Bo(t.latitude),Bo(t.longitude))},py.prototype.$f=function(t){var e=this;return(t.values||[]).map(function(t){return e.Sf(t)})},py.prototype.Cf=function(t){switch(this.pf){case"previous":var e=function t(e){return Po(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==e?null:this.Sf(e);case"estimate":return this.Df(ko(t));default:return null}},py.prototype.Df=function(t){return t=qo(t),t=new xi(t.seconds,t.nanos),this.timestampsInSnapshots?t:t.toDate()},py.prototype.Nf=function(t){var e=jr.P(t);return kr(_s(e)),t=new Ni(e.get(1),e.get(3)),e=new Br(e.u(5)),t.isEqual(this.U)||Rr("Document "+e+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+this.U.projectId+"/"+this.U.database+") instead."),this.bf(e)},py),Hd=(fy.prototype.onProgress=function(t,e,n){this.kf={next:t,error:e,complete:n}},fy.prototype.catch=function(t){return this.Mf.promise.catch(t)},fy.prototype.then=function(t,e){return this.Mf.promise.then(t,e)},fy.prototype.Il=function(t){this.Al(t),this.kf.complete&&this.kf.complete(),this.Mf.resolve(t)},fy.prototype.Rl=function(t){this.Of.taskState="Error",this.kf.next&&this.kf.next(this.Of),this.kf.error&&this.kf.error(t),this.Mf.reject(t)},fy.prototype.Al=function(t){this.Of=t,this.kf.next&&this.kf.next(t)},fy),Xd=Yc.Bo,Yd=(ly.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},ly),Jd=(Object.defineProperty(hy.prototype,"Hf",{get:function(){return this.Jf||(this.Jf=new Td(this.Q_,this.zf.ignoreUndefinedProperties)),this.Jf},enumerable:!1,configurable:!0}),hy.prototype.settings=function(t){if(Hr("Firestore.settings",arguments,1),Jr("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.zf),t)).merge,t=new Yd(t),this.Wf&&!this.zf.isEqual(t))throw new Tr(Ir.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.zf=t).credentials&&(this.Gf=function(t){if(!t)return new Hl;switch(t.type){case"gapi":var e=t.client;return kr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Jl(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Tr(Ir.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},hy.prototype.enableNetwork=function(){return this.Qf(),this.Wf.enableNetwork()},hy.prototype.disableNetwork=function(){return this.Qf(),this.Wf.disableNetwork()},hy.prototype.enablePersistence=function(t){var e;if(this.Wf)throw new Tr(Ir.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var n=!1,r=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Rr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),n=null!==(e=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==e&&e,r=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,n&&r))throw new Tr(Ir.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Yf(this.Lf,this.Bf,{R_:!0,cacheSizeBytes:this.zf.cacheSizeBytes,synchronizeTabs:n,hu:r})},hy.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){var n,e=this;return v(this,function(t){if(void 0!==this.Wf&&!this.Wf.Vf)throw new Tr(Ir.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new Ia,[2,(this.Uf.Vs(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Lf.clearPersistence(this.Q_,this.Kf)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},hy.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(hy.prototype,"Xf",{get:function(){return this.Qf(),this.Wf.Vf},enumerable:!1,configurable:!0}),hy.prototype.waitForPendingWrites=function(){return this.Qf(),this.Wf.waitForPendingWrites()},hy.prototype.onSnapshotsInSync=function(t){return this.Qf(),Wd(t)||(Jr("Firestore.onSnapshotsInSync","function",1,t),t={next:t}),this.Wf.gf(t)},hy.prototype.loadBundle=function(t){this.Qf();var e=new Hd;return this.Wf.loadBundle(t,e),e},hy.prototype.namedQuery=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.Qf(),[4,this.Wf.La(n)];case 1:return[2,(e=t.sent())?new wy(e.query,this,null):null]}})})},hy.prototype.Qf=function(){return this.Wf||this.Yf(new Tp,new Ap,{R_:!1}),this.Wf},hy.prototype.Zf=function(){return new Ti(this.Q_,this.Kf,this.zf.host,this.zf.ssl,this.zf.experimentalForceLongPolling)},hy.prototype.Yf=function(t,e,n){var r=this.Zf();return this.Wf=new Fd(this.Gf,this.Uf),this.Wf.start(r,t,e,n)},hy.jf=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Tr(Ir.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e;if(!(t=t.options.projectId)||"string"!=typeof t)throw new Tr(Ir.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Ni(t)},Object.defineProperty(hy.prototype,"app",{get:function(){if(!this.qf)throw new Tr(Ir.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.qf},enumerable:!1,configurable:!0}),hy.prototype.collection=function(t){return Hr("Firestore.collection",arguments,1),Jr("Firestore.collection","non-empty string",1,t),this.Qf(),new Ey(jr.P(t),this,null)},hy.prototype.doc=function(t){return Hr("Firestore.doc",arguments,1),Jr("Firestore.doc","non-empty string",1,t),this.Qf(),ty.td(jr.P(t),this,null)},hy.prototype.collectionGroup=function(t){if(Hr("Firestore.collectionGroup",arguments,1),Jr("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.Qf(),new wy((t=t,new Au(jr.g(),t)),this,null)},hy.prototype.runTransaction=function(e){var n=this;return Hr("Firestore.runTransaction",arguments,1),Jr("Firestore.runTransaction","function",1,e),this.Qf().transaction(function(t){return e(new $d(n,t))})},hy.prototype.batch=function(){return this.Qf(),new Zd(this)},Object.defineProperty(hy,"logLevel",{get:function(){switch(Sr()){case f.DEBUG:return"debug";case f.ERROR:return"error";case f.SILENT:return"silent";case f.WARN:return"warn";case f.INFO:return"info";case f.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),hy.setLogLevel=function(t){Hr("Firestore.setLogLevel",arguments,1),ni("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Ar.setLogLevel(t)},hy.prototype.ed=function(){return this.zf.timestampsInSnapshots},hy.prototype.nd=function(){return this.zf},hy),$d=(cy.prototype.get=function(t){var e=this;Hr("Transaction.get",arguments,1);var n=xy("Transaction.get",t,this.sd);return this.rd.rf([n.W_]).then(function(t){if(!t||1!==t.length)return Pr();if((t=t[0])instanceof Tu)return new ny(e.sd,n.W_,null,!1,!1,n.j_);if(t instanceof Iu)return new ny(e.sd,n.W_,t,!1,!1,n.j_);throw Pr()})},cy.prototype.set=function(t,e,n){return Yr("Transaction.set",arguments,2,3),t=xy("Transaction.set",t,this.sd),n=Ay("Transaction.set",n),e=Ry(t.j_,e,n),n=Nd(this.sd.Hf,"Transaction.set",t.W_,e,null!==t.j_,n),this.rd.set(t.W_,n),this},cy.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return e="string"==typeof e||e instanceof xp?(Xr("Transaction.update",arguments,3),r=xy("Transaction.update",t,this.sd),xd(this.sd.Hf,"Transaction.update",r.W_,e,n,i)):(Hr("Transaction.update",arguments,2),r=xy("Transaction.update",t,this.sd),Sd(this.sd.Hf,"Transaction.update",r.W_,e)),this.rd.update(r.W_,e),this},cy.prototype.delete=function(t){return Hr("Transaction.delete",arguments,1),t=xy("Transaction.delete",t,this.sd),this.rd.delete(t.W_),this},cy),Zd=(ay.prototype.set=function(t,e,n){return Yr("WriteBatch.set",arguments,2,3),this.ud(),t=xy("WriteBatch.set",t,this.sd),n=Ay("WriteBatch.set",n),e=Ry(t.j_,e,n),n=Nd(this.sd.Hf,"WriteBatch.set",t.W_,e,null!==t.j_,n),this.od=this.od.concat(n.K_(t.W_,Qs.Ge())),this},ay.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return this.ud(),e="string"==typeof e||e instanceof xp?(Xr("WriteBatch.update",arguments,3),r=xy("WriteBatch.update",t,this.sd),xd(this.sd.Hf,"WriteBatch.update",r.W_,e,n,i)):(Hr("WriteBatch.update",arguments,2),r=xy("WriteBatch.update",t,this.sd),Sd(this.sd.Hf,"WriteBatch.update",r.W_,e)),this.od=this.od.concat(e.K_(r.W_,Qs.exists(!0))),this},ay.prototype.delete=function(t){return Hr("WriteBatch.delete",arguments,1),this.ud(),t=xy("WriteBatch.delete",t,this.sd),this.od=this.od.concat(new lu(t.W_,Qs.Ge())),this},ay.prototype.commit=function(){return this.ud(),this.ad=!0,0<this.od.length?this.sd.Qf().write(this.od):Promise.resolve()},ay.prototype.ud=function(){if(this.ad)throw new Tr(Ir.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},ay),ty=(n(uy,Qd=ld),uy.td=function(t,e,n){if(t.length%2!=0)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.R()+" has "+t.length);return new uy(new Br(t),e,n)},Object.defineProperty(uy.prototype,"id",{get:function(){return this.W_.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(uy.prototype,"parent",{get:function(){return new Ey(this.W_.path.h(),this.firestore,this.j_)},enumerable:!1,configurable:!0}),Object.defineProperty(uy.prototype,"path",{get:function(){return this.W_.path.R()},enumerable:!1,configurable:!0}),uy.prototype.collection=function(t){if(Hr("DocumentReference.collection",arguments,1),Jr("DocumentReference.collection","non-empty string",1,t),!t)throw new Tr(Ir.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");return t=jr.P(t),new Ey(this.W_.path.child(t),this.firestore,null)},uy.prototype.isEqual=function(t){if(!(t instanceof uy))throw ai("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.W_.isEqual(t.W_)&&this.j_===t.j_},uy.prototype.set=function(t,e){return Yr("DocumentReference.set",arguments,1,2),e=Ay("DocumentReference.set",e),t=Ry(this.j_,t,e),e=Nd(this.firestore.Hf,"DocumentReference.set",this.W_,t,null!==this.j_,e),this.Wf.write(e.K_(this.W_,Qs.Ge()))},uy.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return t="string"==typeof t||t instanceof xp?(Xr("DocumentReference.update",arguments,2),xd(this.firestore.Hf,"DocumentReference.update",this.W_,t,e,n)):(Hr("DocumentReference.update",arguments,1),Sd(this.firestore.Hf,"DocumentReference.update",this.W_,t)),this.Wf.write(t.K_(this.W_,Qs.exists(!0)))},uy.prototype.delete=function(){return Hr("DocumentReference.delete",arguments,0),this.Wf.write([new lu(this.W_,Qs.Ge())])},uy.prototype.onSnapshot=function(){for(var e=this,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];Yr("DocumentReference.onSnapshot",arguments,1,4);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||Wd(n[i])||(ui("DocumentReference.onSnapshot",r=n[i],["includeMetadataChanges"]),ti("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};Wd(n[i])?(s=n[i],n[i]=null===(r=s.next)||void 0===r?void 0:r.bind(s),n[i+1]=null===(r=s.error)||void 0===r?void 0:r.bind(s),n[i+2]=null===(r=s.complete)||void 0===r?void 0:r.bind(s)):(Jr("DocumentReference.onSnapshot","function",i,n[i]),$r("DocumentReference.onSnapshot","function",i+1,n[i+1]),$r("DocumentReference.onSnapshot","function",i+2,n[i+2]));var s={next:function(t){n[i]&&n[i](e.hd(t))},error:n[i+1],complete:n[i+2]};return this.Wf.listen(Du(this.W_.path),o,s)},uy.prototype.get=function(t){var e=this;Yr("DocumentReference.get",arguments,0,1),Sy("DocumentReference.get",t);var n=this.firestore.Qf();return t&&"cache"===t.source?n.Af(this.W_).then(function(t){return new ny(e.firestore,e.W_,t,!0,t instanceof Iu&&t.Je,e.j_)}):n.Rf(this.W_,t).then(function(t){return e.hd(t)})},uy.prototype.withConverter=function(t){return new uy(this.W_,this.firestore,t)},uy.prototype.hd=function(t){var e=t.docs.get(this.W_);return new ny(this.firestore,this.W_,e,t.fromCache,t.hasPendingWrites,this.j_)},uy),ey=(sy.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},sy),ny=(oy.prototype.data=function(t){var e=this;if(Yr("DocumentSnapshot.data",arguments,0,1),t=Ny("DocumentSnapshot.data",t),this.ld){if(this.j_){var n=new ry(this.sd,this.W_,this.ld,this._d,this.fd,null);return this.j_.fromFirestore(n,t)}return new Kd(this.sd.Q_,this.sd.ed(),t.serverTimestamps||"none",function(t){return new ty(t,e.sd,null)},function(t){return new Ai(t)}).Sf(this.ld.sn())}},oy.prototype.get=function(t,e){var n=this;if(Yr("DocumentSnapshot.get",arguments,1,2),e=Ny("DocumentSnapshot.get",e),this.ld&&null!==(t=this.ld.data().field(Ld("DocumentSnapshot.get",t,this.W_))))return new Kd(this.sd.Q_,this.sd.ed(),e.serverTimestamps||"none",function(t){return new ty(t,n.sd,n.j_)},function(t){return new Ai(t)}).Sf(t)},Object.defineProperty(oy.prototype,"id",{get:function(){return this.W_.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(oy.prototype,"ref",{get:function(){return new ty(this.W_,this.sd,this.j_)},enumerable:!1,configurable:!0}),Object.defineProperty(oy.prototype,"exists",{get:function(){return null!==this.ld},enumerable:!1,configurable:!0}),Object.defineProperty(oy.prototype,"metadata",{get:function(){return new ey(this.fd,this._d)},enumerable:!1,configurable:!0}),oy.prototype.isEqual=function(t){if(!(t instanceof oy))throw ai("isEqual","DocumentSnapshot",1,t);return this.sd===t.sd&&this._d===t._d&&this.W_.isEqual(t.W_)&&(null===this.ld?null===t.ld:this.ld.isEqual(t.ld))&&this.j_===t.j_},oy),ry=(n(iy,zd=ny),iy.prototype.data=function(t){return zd.prototype.data.call(this,t)},iy);function iy(){return null!==zd&&zd.apply(this,arguments)||this}function oy(t,e,n,r,i,o){this.sd=t,this.W_=e,this.ld=n,this._d=r,this.fd=i,this.j_=o}function sy(t,e){this.hasPendingWrites=t,this.fromCache=e}function uy(t,e,n){var r=this;return(r=Qd.call(this,e.Q_,t,n)||this).W_=t,r.firestore=e,r.j_=n,r.Wf=r.firestore.Qf(),r}function ay(t){this.sd=t,this.od=[],this.ad=!1}function cy(t,e){this.sd=t,this.rd=e}function hy(t,e,n,r){var i=this;if(void 0===n&&(n=new Tp),void 0===r&&(r=new Ap),this.Lf=n,this.Bf=r,this.qf=null,this.Uf=new za,this.INTERNAL={delete:function(){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Qf(),[4,this.Wf.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options)r=t,this.qf=r,this.Q_=hy.jf(r),this.Kf=r.name,this.Gf=new Xl(e);else{if(!(t=t).projectId)throw new Tr(Ir.INVALID_ARGUMENT,"Must provide projectId");this.Q_=new Ni(t.projectId,t.database),this.Kf="[DEFAULT]",this.Gf=new Hl}this.zf=new Yd({})}function ly(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Tr(Ir.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Zr("settings","non-empty string","host",t.host),this.host=t.host,ti("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(ui("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),ti("settings","object","credentials",t.credentials),this.credentials=t.credentials,ti("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),ti("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Rr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Rr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(e=t.timestampsInSnapshots)||void 0===e||e,this.ignoreUndefinedProperties=null!==(e=t.ignoreUndefinedProperties)&&void 0!==e&&e,ti("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Yc.Uo;else{if(t.cacheSizeBytes!==Xd&&t.cacheSizeBytes<Yc.qo)throw new Tr(Ir.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Yc.qo);this.cacheSizeBytes=t.cacheSizeBytes}ti("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(t=t.experimentalForceLongPolling)&&void 0!==t&&t}function fy(){this.kf={},this.Mf=new Ia,this.Of={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function py(t,e,n,r,i){this.U=t,this.timestampsInSnapshots=e,this.pf=n,this.bf=r,this.vf=i}function dy(t,e,n){if("string"==typeof n){if(""===n)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Cu(e)&&-1!==n.indexOf("/"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(jr.P(n)),!Br.F(e))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Wo(t,new Br(e))}if(n instanceof ld)return Wo(t,n.W_);throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+oi(n)+".")}function yy(t,e){if(!Array.isArray(t)||0===t.length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function vy(t,e,n){if(!n.isEqual(e))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function gy(t){if(Pu(t)&&0===t.rn.length)throw new Tr(Ir.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var my,wy=(_y.prototype.where=function(t,e,n){return Hr("Query.where",arguments,3),si("Query.where",3,n),e=ni("Query.where",["<","<=","==","!=",">=",">","array-contains","in","array-contains-any","not-in"],2,e),t=Ld("Query.where",t),e=function(t,e,n,r,i,o){if(r.p()){if("array-contains"===i||"array-contains-any"===i)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){yy(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(dy(n,t,c))}h={arrayValue:{values:s}}}else h=dy(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||yy(o,i),h=Rd(e,"Query.where",o,"in"===i||"not-in"===i);var h=Ku.create(r,i,h);return function(t,e){if(e.un()){var n=Lu(t);if(null!==n&&!n.isEqual(e.field))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=ku(t))&&vy(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(this.dd,this.firestore.Hf,this.firestore.Q_,t,e,n),new _y((e=(n=this.dd).filters.concat([e]),new Au(n.path,n.collectionGroup,n.rn.slice(),e,n.limit,n.limitType,n.startAt,n.endAt)),this.firestore,this.j_)},_y.prototype.orderBy=function(t,e){if(Yr("Query.orderBy",arguments,1,2),$r("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Tr(Ir.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=Ld("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Ea(e,n);return e=r,null!==ku(n=t)||null!==(t=Lu(n))&&vy(0,t,e.field),r}(this.dd,t,n);return new _y((t=(n=this.dd).rn.concat([t]),new Au(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)),this.firestore,this.j_)},_y.prototype.limit=function(t){return Hr("Query.limit",arguments,1),Jr("Query.limit","number",1,t),ci("Query.limit",1,t),new _y(Vu(this.dd,t,"F"),this.firestore,this.j_)},_y.prototype.limitToLast=function(t){return Hr("Query.limitToLast",arguments,1),Jr("Query.limitToLast","number",1,t),ci("Query.limitToLast",1,t),new _y(Vu(this.dd,t,"L"),this.firestore,this.j_)},_y.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Xr("Query.startAt",arguments,1),t=this.wd("Query.startAt",t,e,!0),new _y(ju(this.dd,t),this.firestore,this.j_)},_y.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Xr("Query.startAfter",arguments,1),t=this.wd("Query.startAfter",t,e,!1),new _y(ju(this.dd,t),this.firestore,this.j_)},_y.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Xr("Query.endBefore",arguments,1),t=this.wd("Query.endBefore",t,e,!0),new _y(Fu(this.dd,t),this.firestore,this.j_)},_y.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Xr("Query.endAt",arguments,1),t=this.wd("Query.endAt",t,e,!1),new _y(Fu(this.dd,t),this.firestore,this.j_)},_y.prototype.isEqual=function(t){if(!(t instanceof _y))throw ai("isEqual","Query",1,t);return this.firestore===t.firestore&&qu(this.dd,t.dd)&&this.j_===t.j_},_y.prototype.withConverter=function(t){return new _y(this.dd,this.firestore,t)},_y.prototype.wd=function(c,t,e,n){return si(c,1,t),t instanceof ny?(Hr(c,i([t],e),1),function(t,e,n,r){if(!n)throw new Tr(Ir.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=Uu(t);o<s.length;o++){var u=s[o];if(u.field.p())i.push(Wo(e,n.key));else{var a=n.field(u.field);if(Po(a))throw new Tr(Ir.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.R(),new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new pa(i,r)}(this.dd,this.firestore.Q_,t.ld,n)):(e=[t].concat(e),function(t,e,n,r,i,o){var s=t.rn;if(i.length>s.length)throw new Tr(Ir.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.p()){if("string"!=typeof c)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Cu(t)&&-1!==c.indexOf("/"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(jr.P(c));if(!Br.F(h))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new Br(h),u.push(Wo(e,h))}else c=Rd(n,r,c),u.push(c)}return new pa(u,o)}(this.dd,this.firestore.Q_,this.firestore.Hf,c,e,n))},_y.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Yr("Query.onSnapshot",arguments,1,4);var i={},o=0;"object"!=typeof n[o]||Wd(n[o])||(ui("Query.onSnapshot",i=n[o],["includeMetadataChanges"]),ti("Query.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),o++),Wd(n[o])?(s=n[o],n[o]=null===(t=s.next)||void 0===t?void 0:t.bind(s),n[o+1]=null===(t=s.error)||void 0===t?void 0:t.bind(s),n[o+2]=null===(t=s.complete)||void 0===t?void 0:t.bind(s)):(Jr("Query.onSnapshot","function",o,n[o]),$r("Query.onSnapshot","function",o+1,n[o+1]),$r("Query.onSnapshot","function",o+2,n[o+2]));var s={next:function(t){n[o]&&n[o](new by(e.firestore,e.dd,t,e.j_))},error:n[o+1],complete:n[o+2]};return gy(this.dd),this.firestore.Qf().listen(this.dd,i,s)},_y.prototype.get=function(t){var e=this;Yr("Query.get",arguments,0,1),Sy("Query.get",t),gy(this.dd);var n=this.firestore.Qf();return(t&&"cache"===t.source?n.Pf(this.dd):n.yf(this.dd,t)).then(function(t){return new by(e.firestore,e.dd,t,e.j_)})},_y),by=(Object.defineProperty(Ty.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Ty.prototype,"empty",{get:function(){return this.Td.docs.m()},enumerable:!1,configurable:!0}),Object.defineProperty(Ty.prototype,"size",{get:function(){return this.Td.docs.size},enumerable:!1,configurable:!0}),Ty.prototype.forEach=function(e,n){var r=this;Yr("QuerySnapshot.forEach",arguments,1,2),Jr("QuerySnapshot.forEach","function",1,e),this.Td.docs.forEach(function(t){e.call(n,r.Ad(t,r.metadata.fromCache,r.Td.Qt.has(t.key)))})},Object.defineProperty(Ty.prototype,"query",{get:function(){return new wy(this.md,this.sd,this.j_)},enumerable:!1,configurable:!0}),Ty.prototype.docChanges=function(t){if(t&&(ui("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),ti("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges)),(t=!(!t||!t.includeMetadataChanges))&&this.Td.jt)throw new Tr(Ir.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Ed&&this.Id===t||(this.Ed=function(i,e,o){if(i.Ut.m()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Ut;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Pr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.Td,t,this.Ad.bind(this)),this.Id=t),this.Ed},Ty.prototype.isEqual=function(t){if(!(t instanceof Ty))throw ai("isEqual","QuerySnapshot",1,t);return this.sd===t.sd&&qu(this.md,t.md)&&this.Td.isEqual(t.Td)&&this.j_===t.j_},Ty.prototype.Ad=function(t,e,n){return new ry(this.sd,t.key,t,e,n,this.j_)},Ty),Ey=(n(Iy,my=wy),Object.defineProperty(Iy.prototype,"id",{get:function(){return this.dd.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Iy.prototype,"parent",{get:function(){var t=this.dd.path.h();return t.m()?null:new ty(new Br(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Iy.prototype,"path",{get:function(){return this.dd.path.R()},enumerable:!1,configurable:!0}),Iy.prototype.doc=function(t){return Yr("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=fi.k()),Jr("CollectionReference.doc","non-empty string",1,t),t=jr.P(t),ty.td(this.dd.path.child(t),this.firestore,this.j_)},Iy.prototype.add=function(t){Hr("CollectionReference.add",arguments,1),Jr("CollectionReference.add","object",1,t=this.j_?this.j_.toFirestore(t):t);var e=this.doc();return new ty(e.W_,this.firestore,null).set(t).then(function(){return e})},Iy.prototype.withConverter=function(t){return new Iy(this.Rd,this.firestore,t)},Iy);function Iy(t,e,n){var r=this;if(((r=my.call(this,Du(t),e,n)||this).Rd=t).length%2!=1)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.R()+" has "+t.length);return r}function Ty(t,e,n,r){this.sd=t,this.md=e,this.Td=n,this.j_=r,this.Ed=null,this.Id=null,this.metadata=new ey(n.hasPendingWrites,n.fromCache)}function _y(t,e,n){this.dd=t,this.firestore=e,this.j_=n}function Ay(t,e){if(void 0===e)return{merge:!1};if(ui(t,e,["merge","mergeFields"]),ti(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+oi(n));for(var r,i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof xp))throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+oi(n[i]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function Ny(t,e){return void 0===e?{}:(ui(t,e,["serverTimestamps"]),ei(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Sy(t,e){$r(t,"object",1,e),e&&(ui(t,e,["source"]),ei(t,0,"source",e.source,["default","server","cache"]))}function xy(t,e,n){if(e instanceof ld){if(e.firestore!==n)throw new Tr(Ir.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw ai(t,"DocumentReference",1,e)}function Ry(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Dy,Oy,Ee=(n(ky,Dy=cd),ky.serverTimestamp=function(){Kr("FieldValue.serverTimestamp",arguments);var t=new id("serverTimestamp");return t.C_="FieldValue.serverTimestamp",new ky(t)},ky.delete=function(){Kr("FieldValue.delete",arguments);var t=new Op("deleteField");return t.C_="FieldValue.delete",new ky(t)},ky.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Xr("FieldValue.arrayUnion",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Xr("arrayUnion()",arguments,1),new od("arrayUnion",t)}.apply(void 0,t);return n.C_="FieldValue.arrayUnion",new ky(n)},ky.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Xr("FieldValue.arrayRemove",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Xr("arrayRemove()",arguments,1),new sd("arrayRemove",t)}.apply(void 0,t);return n.C_="FieldValue.arrayRemove",new ky(n)},ky.increment=function(t){return Jr("FieldValue.increment","number",1,t),Hr("FieldValue.increment",arguments,1),(t=new ud("increment",t)).C_="FieldValue.increment",new ky(t)},ky.prototype.isEqual=function(t){return this.U_.isEqual(t.U_)},ky),Py={Firestore:Jd,GeoPoint:ad,Timestamp:xi,Blob:Ai,Transaction:$d,WriteBatch:Zd,DocumentReference:ty,DocumentSnapshot:ny,Query:wy,QueryDocumentSnapshot:ry,QuerySnapshot:by,CollectionReference:Ey,FieldPath:xp,FieldValue:Ee,setLogLevel:Jd.setLogLevel,CACHE_SIZE_UNLIMITED:Xd};function ky(){return null!==Dy&&Dy.apply(this,arguments)||this}(Oy=e.default).INTERNAL.registerComponent(new wr("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),r=new Ap,t=new _p(r),new Jd(e,n,t,r);var e,n,r},"PUBLIC").setServiceProps(Object.assign({},Py))),Oy.registerVersion("@firebase/firestore","1.18.0-alpha.96ae6a5fe")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
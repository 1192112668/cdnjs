!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(lp){"use strict";try{(function(){var u,t,e=(t=lp)&&"object"==typeof t&&"default"in t?t:{default:t},r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(be=u=u||{})[be.DEBUG=0]="DEBUG",be[be.VERBOSE=1]="VERBOSE",be[be.INFO=2]="INFO",be[be.WARN=3]="WARN",be[be.ERROR=4]="ERROR",be[be.SILENT=5]="SILENT";var a={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},h=u.INFO,c=((Ee={})[u.DEBUG]="log",Ee[u.VERBOSE]="log",Ee[u.INFO]="info",Ee[u.WARN]="warn",Ee[u.ERROR]="error",Ee),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?a[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=h,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e){return(e=d.call(this,e)||this).code=t,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,t=(t=this.errors[t])?(r=i,t.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").",s=new m(o,t),u=0,a=Object.keys(i);u<a.length;u++){var h=a[u];"_"!==h.slice(-1)&&(h in s&&console.warn('Overwriting FirebaseError base field "'+h+'" can cause unexpected behavior.'),s[h]=i[h])}return s},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,R="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},L=R||self;function S(){}function O(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function D(t){var e=O(t);return"array"==e||"object"==e&&"number"==typeof t.length}function V(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var _="closure_uid_"+(1e9*Math.random()>>>0),k=0;function U(t,e,n){return t.call.apply(t.bind,arguments)}function P(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?U:P).apply(null,arguments)}function M(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var x=Date.now;function F(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function j(){this.j=this.j,this.i=this.i}j.prototype.j=!1,j.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,_)&&this[_]||(this[_]=++k))},j.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var B=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},q=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function G(){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function Q(t){return/^[\s\xa0]*$/.test(t)}var H,Y=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function W(t,e){return-1!=t.indexOf(e)}function K(t,e){return t<e?-1:e<t?1:0}var X=L.navigator;function $(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function J(t){var e,n={};for(e in t)n[e]=t[e];return n}H=(X=X&&X.userAgent)?X:"";var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<Z.length;i++)e=Z[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function et(t){return et[" "](t),t}et[" "]=S;var nt,rt=W(H,"Opera"),it=W(H,"Trident")||W(H,"MSIE"),ot=W(H,"Edge"),st=ot||it,ut=W(H,"Gecko")&&!(W(H.toLowerCase(),"webkit")&&!W(H,"Edge"))&&!(W(H,"Trident")||W(H,"MSIE"))&&!W(H,"Edge"),at=W(H.toLowerCase(),"webkit")&&!W(H,"Edge");function ht(){var t=L.document;return t?t.documentMode:void 0}var ct="",lt=(lt=H,ut?/rv:([^\);]+)(\)|;)/.exec(lt):ot?/Edge\/([\d\.]+)/.exec(lt):it?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(lt):at?/WebKit\/(\S+)/.exec(lt):rt?/(?:Version)[ \/]?(\S+)/.exec(lt):void 0);lt&&(ct=lt?lt[1]:""),nt=it&&null!=(lt=ht())&&lt>parseFloat(ct)?String(lt):ct;var ft={};function pt(u){return t=u,e=function(){for(var t=0,e=Y(String(nt)).split("."),n=Y(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=K(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||K(0==o[2].length,0==s[2].length)||K(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=ft,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var dt=L.document&&it&&(ht()||parseInt(nt,10))||void 0,yt=!it||9<=Number(dt),vt=it&&!pt("9"),gt=function(){if(!L.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{L.addEventListener("test",S,e),L.removeEventListener("test",S,e)}catch(t){}return t}();function mt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function wt(t,e){if(mt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ut){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:bt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}mt.prototype.b=function(){this.defaultPrevented=!0},F(wt,mt);var bt={2:"touch",3:"pen",4:"mouse"};wt.prototype.b=function(){wt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,vt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Et="closure_listenable_"+(1e6*Math.random()|0),It=0;function Tt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++It,this.Y=this.Z=!1}function At(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Nt(t){this.src=t,this.a={},this.b=0}function Rt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=B(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(At(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Lt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Nt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Lt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Tt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var St="closure_lm_"+(1e6*Math.random()|0),Ot={};function Dt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=xt(r),e&&e[Et]?e.wa(n,r,V(i)?!!i.capture:!!i,o):Vt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Dt(t,e[o],n,r,i);return null}return n=xt(n),t&&t[Et]?t.va(e,n,V(r)?!!r.capture:!!r,i):Vt(t,e,n,!1,r,i)}function Vt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=V(i)?!!i.capture:!!i;if(s&&!yt)return null;var u,a,h=Ct(t);if(h||(t[St]=h=new Nt(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Pt,r=a=yt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)gt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(kt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function _t(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Et]?Rt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(kt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ct(e))?(Rt(n,t),0==n.b&&(n.src=null,e[St]=null)):At(t)))}function kt(t){return t in Ot?Ot[t]:Ot[t]="on"+t}function Ut(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&_t(t),n.call(r,e)}function Pt(t,e){if(t.Y)return!0;if(yt)return Ut(t,new wt(e,this));if(!e)t:{e=["window","event"];for(var n=L,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ut(t,e=new wt(e,this))}function Ct(t){return(t=t[St])instanceof Nt?t:null}var Mt="__closure_events_fn_"+(1e9*Math.random()>>>0);function xt(e){return"function"==O(e)?e:(e[Mt]||(e[Mt]=function(t){return e.handleEvent(t)}),e[Mt])}function Ft(){j.call(this),this.c=new Nt(this),(this.J=this).C=null}function jt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Rt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}F(Ft,j),Ft.prototype[Et]=!0,(N=Ft.prototype).addEventListener=function(t,e,n,r){Dt(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=V(i)?!!i.capture:!!i,r=xt(r),e&&e[Et]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Lt(s=e.a[n],r,i,o))&&(At(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ct(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Lt(n,r,i,o)),(r=-1<e?n[e]:null)&&_t(r))}(this,t,e,n,r)},N.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new mt(t,n):t instanceof mt?t.target=t.target||n:(s=t,tt(t=new mt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=jt(o,r,!0,t)&&s;if(s=jt(o=t.a=n,r,!0,t)&&s,s=jt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=jt(o=t.a=e[i],r,!1,t)&&s;return s},N.G=function(){if(Ft.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)At(n[r]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},N.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Bt=L.JSON.stringify;function qt(){this.b=this.a=null}var Gt,zt=(Qt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Qt(function(){return new Ht},function(t){t.reset()},100));function Qt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Ht(){this.next=this.b=this.a=null}function Yt(t,e){var n;Gt||(n=L.Promise.resolve(void 0),Gt=function(){n.then(Xt)}),Wt||(Gt(),Wt=!0),Kt.add(t,e)}qt.prototype.add=function(t,e){var n=zt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Ht.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Wt=!(Ht.prototype.reset=function(){this.next=this.b=this.a=null}),Kt=new qt;function Xt(){for(var t,e;n=e=void 0,n=null,(e=Kt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){L.setTimeout(function(){throw t},0)}(t)}var n=zt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Wt=!1}function $t(t,e){Ft.call(this),this.b=t||1,this.a=e||L,this.f=C(this.Ya,this),this.g=x()}function Jt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Zt(t,e,n){if("function"==O(t))n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:L.setTimeout(t,e||0)}F($t,Ft),(N=$t.prototype).aa=!1,N.M=null,N.Ya=function(){var t;this.aa&&(0<(t=x()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(Jt(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=x())},N.G=function(){$t.S.G.call(this),Jt(this),delete this.a};var te,ee,ne,re=(T(ee=oe,ne=te=j),ee.prototype=null===ne?Object.create(ne):(ie.prototype=ne.prototype,new ie),oe.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=Zt(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},oe.prototype.G=function(){te.prototype.G.call(this),this.a&&(L.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},oe);function ie(){this.constructor=ee}function oe(t,e,n){var r=te.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function se(t){j.call(this),this.b=t,this.a={}}F(se,j);var ue=[];function ae(t,e,n,r){Array.isArray(n)||(n&&(ue[0]=n.toString()),n=ue);for(var i=0;i<n.length;i++){var o=Dt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function he(t){$(t.a,function(t,e){this.a.hasOwnProperty(e)&&_t(t)},t),t.a={}}function ce(){this.a=!0}function le(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return Bt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}se.prototype.G=function(){se.S.G.call(this),he(this)},se.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ce.prototype.info=function(){};var fe=null;function pe(){return fe=fe||new Ft}function de(t){mt.call(this,"serverreachability",t)}function ye(){var t=pe();t.dispatchEvent(new de(t))}function ve(t){mt.call(this,"statevent",t)}function ge(){var t=pe();t.dispatchEvent(new ve(t))}function me(t){mt.call(this,"timingevent",t)}function we(t,e){if("function"!=O(t))throw Error("Fn must not be null and must be a function");return L.setTimeout(function(){t()},e)}F(de,mt),F(ve,mt),F(me,mt);var be={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ee={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Ie(){}function Te(t){var e;return(e=t.a)||(e=t.a={}),e}function Ae(){}Ie.prototype.a=null;var Ne,R={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Re(){mt.call(this,"d")}function Le(){mt.call(this,"c")}function Se(){}function Oe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new se(this),this.P=De,t=st?125:void 0,this.R=new $t(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}F(Re,mt),F(Le,mt),F(Se,Ie),Ne=new Se;var De=45e3,Ve={},_e={};function ke(t,e,n){t.H=1,t.i=tn(We(e)),t.j=n,t.I=!0,Ue(t,null)}function Ue(t,e){t.u=x(),Ce(t),t.l=We(t.i);var s,u,a,h,c,l,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),dn(n.b,"t",r),t.D=0,t.a=ur(t.g,t.g.C?e:null),0<t.O&&(t.F=new re(C(t.Ca,t,t.a),t.O)),ae(t.J,t.a,"readystatechange",t.Wa),e=t.B?J(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ye(),s=t.c,u=t.m,a=t.l,h=t.f,c=t.T,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function Pe(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?_e:(i=Number(u.substring(i,o)),isNaN(i)?Ve:(o+=1)+i>u.length?_e:(u=u.substr(o,i),r.D=o+i,u)));if(u==_e){4==e&&(t.h=4,ge(),s=!1),le(t.c,t.f,null,"[Incomplete Response]");break}if(u==Ve){t.h=4,ge(),le(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}le(t.c,t.f,u,null),Be(t,u)}4==e&&0==n.length&&(t.h=1,ge(),s=!1),t.b=t.b&&s,s?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Zn(e),e.F=!0)):(le(t.c,t.f,n,"[Invalid Chunked Response]"),je(t),Fe(t))}function Ce(t){t.U=x()+t.P,Me(t,t.P)}function Me(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=we(C(t.Ua,t),e)}function xe(t){t.o&&(L.clearTimeout(t.o),t.o=null)}function Fe(t){0==t.g.v||t.A||nr(t.g,t)}function je(t){xe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Jt(t.R),he(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Be(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||En(u.b,t)))if(u.I=t.N,!t.C&&En(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var h=a;if(0==h[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;er(u),zn(u)}Jn(u),ge()}}else u.oa=h[1],0<u.oa-u.P&&h[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=we(C(u.Ra,u),6e3));if(bn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else ir(u,11)}else if(!t.C&&u.a!=t||er(u),!Q(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)h=e[a],u.P=h[0],h=h[1],2==u.v?"c"==h[0]?(u.J=h[1],u.ga=h[2],null!=(r=h[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=h[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=h[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(W(r,"spdy")||W(r,"quic")||W(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(In(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,Ze(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.V&&(u.N=x()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=sr(n,n.C?n.ga:null,n.fa),i.C?(Tn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(xe(o),Ce(o)),n.a=i):$n(n),0<u.g.length&&Yn(u)):"stop"!=h[0]&&"close"!=h[0]||ir(u,7):3==u.v&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?ir(u,7):Gn(u):"noop"!=h[0]&&u.f&&u.f.sa(h),u.o=0);ye()}catch(t){}}function qe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(D(t)||"string"==typeof t)q(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(D(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(D(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ge(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ge)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function ze(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Qe(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Qe(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Qe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=Oe.prototype).setTimeout=function(t){this.P=t},N.Wa=function(t){t=t.target;var e=this.F;e&&3==Fn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=Fn(this.a),n=this.a.ua(),r=this.a.X();if(!(e<3||3==e&&!st&&!this.a.$())){this.A||4!=e||7==n||ye(),xe(this);var i=this.a.X();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,u=this.m,a=this.l,h=this.f,c=this.T,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+c+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.V&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Q(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,ge(),je(this),Fe(this);break t}le(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Be(this,s)}this.I?(Pe(this,e,n),st&&this.b&&3==e&&(ae(this.J,this.R,"tick",this.Va),this.R.start())):(le(this.c,this.f,n,null),Be(this,n)),4==e&&je(this),this.b&&!this.A&&(4==e?nr(this.g,this):(this.b=!1,Ce(this)))}else 400==i&&0<n.indexOf("Unknown SID")?this.h=3:this.h=0,ge(),je(this),Fe(this)}}}catch(t){}var u,a,h,c,l,f},N.Va=function(){var t,e;this.a&&(t=Fn(this.a),e=this.a.$(),this.D<e.length&&(xe(this),Pe(this,t,e),this.b&&4!=t&&Ce(this)))},N.cancel=function(){this.A=!0,je(this)},N.Ua=function(){this.o=null;var t,e,n=x();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ye(),ge()),je(this),this.h=2,Fe(this)):Me(this,this.U-n)},(N=Ge.prototype).K=function(){ze(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return ze(this),this.a.concat()},N.get=function(t,e){return Qe(this.b,t)?this.b[t]:e},N.set=function(t,e){Qe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var He=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ye(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ye?(this.a=void 0!==e?e:t.a,Ke(this,t.f),this.j=t.j,Xe(this,t.c),$e(this,t.h),this.g=t.g,e=t.b,(n=new cn).c=e.c,e.a&&(n.a=new Ge(e.a),n.b=e.b),Je(this,n),this.i=t.i):t&&(n=String(t).match(He))?(this.a=!!e,Ke(this,n[1]||"",!0),this.j=en(n[2]||""),Xe(this,n[3]||"",!0),$e(this,n[4]),this.g=en(n[5]||"",!0),Je(this,n[6]||"",!0),this.i=en(n[7]||"")):(this.a=!!e,this.b=new cn(null,this.a))}function We(t){return new Ye(t)}function Ke(t,e,n){t.f=n?en(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Xe(t,e,n){t.c=n?en(e,!0):e}function $e(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Je(t,e,n){var r,i;e instanceof cn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(ln(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(fn(this,e),dn(this,n,t))},r)),r.f=i):(n||(e=nn(e,an)),t.b=new cn(e,t.a))}function Ze(t,e,n){t.b.set(e,n)}function tn(t){return Ze(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^x()).toString(36)),t}function en(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function nn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,rn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function rn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ye.prototype.toString=function(){var t=[],e=this.f;e&&t.push(nn(e,on,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(nn(e,on,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(nn(n,"/"==n.charAt(0)?un:sn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",nn(n,hn)),t.join("")};var on=/[#\/\?@]/g,sn=/[#\?:]/g,un=/[#\?]/g,an=/[#\?@]/g,hn=/#/g;function cn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function ln(u){u.a||(u.a=new Ge,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function fn(t,e){ln(t),e=yn(t,e),Qe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Qe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&ze(t)))}function pn(t,e){return ln(t),e=yn(t,e),Qe(t.a.b,e)}function dn(t,e,n){fn(t,e),0<n.length&&(t.c=null,t.a.set(yn(t,e),z(n)),t.b+=n.length)}function yn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function vn(t,e){this.b=t,this.a=e}function gn(t){this.g=t||mn,t=L.PerformanceNavigationTiming?0<(t=L.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(L.ia&&L.ia.ya&&L.ia.ya()&&L.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(N=cn.prototype).add=function(t,e){ln(this),this.c=null,t=yn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,r){ln(this),this.a.forEach(function(t,e){q(t,function(t){n.call(r,t,e,this)},this)},this)},N.L=function(){ln(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},N.K=function(t){ln(this);var e=[];if("string"==typeof t)pn(this,t)&&(e=G(e,this.a.get(yn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},N.set=function(t,e){return ln(this),this.c=null,pn(this,t=yn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var mn=10;function wn(t){return t.b||t.a&&t.a.size>=t.f}function bn(t){return t.b?1:t.a?t.a.size:0}function En(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function In(t,e){t.a?t.a.add(e):t.b=e}function Tn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function An(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Nn(){}function Rn(){this.a=new Nn}function Ln(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}gn.prototype.cancel=function(){var t,e;if(this.c=An(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Nn.prototype.stringify=function(t){return L.JSON.stringify(t,void 0)},Nn.prototype.parse=function(t){return L.JSON.parse(t,void 0)};var Sn=L.JSON.parse;function On(t){Ft.call(this),this.headers=new Ge,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Dn,this.D=this.F=!1}F(On,Ft);var Dn="",Vn=/^https?$/i,_n=["POST","PUT"];function kn(t){return"content-type"==t.toLowerCase()}function Un(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Pn(t),Mn(t)}function Pn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Cn(t){if(t.b&&(!t.s[1]||4!=Fn(t)||2!=t.X()))if(t.l&&4==Fn(t))Zt(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==Fn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(He)[1]||null)&&L.self&&L.self.location&&(i=(r=L.self.location.protocol).substr(0,r.length-1)),n=!Vn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Fn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Pn(t)}}finally{Mn(t)}}}function Mn(t,e){if(t.a){xn(t);var n=t.a,r=t.s[0]?S:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function xn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(L.clearTimeout(t.m),t.m=null)}function Fn(t){return t.a?t.a.readyState:0}function jn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",$(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ze(t,e,n))}function Bn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function qn(t){this.pa=0,this.g=[],this.c=new ce,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Bn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Bn("baseRetryDelayMs",5e3,t),this.Ma=Bn("retryDelaySeedMs",1e4,t),this.Ja=Bn("forwardChannelMaxRetries",2,t),this.ma=Bn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new gn(t&&t.concurrentRequestLimit),this.ka=new Rn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Gn(t){var e,n;Qn(t),3==t.v&&(e=t.R++,Ze(n=We(t.B),"SID",t.J),Ze(n,"RID",e),Ze(n,"TYPE","terminate"),Kn(t,n),(e=new Oe(t,t.c,e,void 0)).H=2,e.i=tn(We(n)),n=!1,L.navigator&&L.navigator.sendBeacon&&(n=L.navigator.sendBeacon(e.i.toString(),"")),!n&&L.Image&&((new Image).src=e.i,n=!0),n||(e.a=ur(e.g,null),e.a.ba(e.i)),e.u=x(),Ce(e)),or(t)}function zn(t){t.a&&(Zn(t),t.a.cancel(),t.a=null)}function Qn(t){zn(t),t.j&&(L.clearTimeout(t.j),t.j=null),er(t),t.b.cancel(),t.h&&("number"==typeof t.h&&L.clearTimeout(t.h),t.h=null)}function Hn(t,e){t.g.push(new vn(t.La++,e)),3==t.v&&Yn(t)}function Yn(t){wn(t.b)||t.h||(t.h=!0,Yt(t.Ba,t),t.u=0)}function Wn(t,e){var n=e?e.f:t.R++,r=We(t.B);Ze(r,"SID",t.J),Ze(r,"RID",n),Ze(r,"AID",t.P),Kn(t,r),t.i&&t.l&&jn(r,t.i,t.l),n=new Oe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Xn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),In(t.b,n),ke(n,r,e)}function Kn(t,n){t.f&&qe({},function(t,e){Ze(n,e,t)})}function Xn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?C(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+h+"_"||"";try{qe(t,function(t,e){var n=t;V(t)&&(n=Bt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s)}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function $n(t){t.a||t.j||(t.U=1,Yt(t.Aa,t),t.o=0)}function Jn(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=we(C(t.Aa,t),rr(t,t.o)),t.o++,1)}function Zn(t){null!=t.s&&(L.clearTimeout(t.s),t.s=null)}function tr(t){t.a=new Oe(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=We(t.la);Ze(e,"RID","rpc"),Ze(e,"SID",t.J),Ze(e,"CI",t.H?"0":"1"),Ze(e,"AID",t.P),Kn(t,e),Ze(e,"TYPE","xmlhttp"),t.i&&t.l&&jn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=tn(We(e)),n.j=null,n.I=!0,Ue(n,t)}function er(t){null!=t.m&&(L.clearTimeout(t.m),t.m=null)}function nr(t,e){var n,r=null;if(t.a==e){er(t),Zn(t),t.a=null;var i=2}else{if(!En(t.b,e))return;r=e.s,Tn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b)1==i?(r=e.j?e.j.length:0,e=x()-e.u,n=t.u,(i=pe()).dispatchEvent(new me(i)),Yn(t)):$n(t);else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(bn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=we(C(t.Ba,t,e),rr(t,t.u)),t.u++,1}}(t,e)||2==i&&Jn(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:ir(t,5);break;case 4:ir(t,10);break;case 3:ir(t,6);break;default:ir(t,2)}}function rr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function ir(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=C(t.Xa,t),r||(r=new Ye("//www.google.com/images/cleardot.gif"),L.location&&"http"==L.location.protocol||Ke(r,"https"),tn(r)),n=r.toString(),r=o,o=new ce,L.Image?((i=new Image).onload=M(Ln,o,i,"TestLoadImage: loaded",!0,r),i.onerror=M(Ln,o,i,"TestLoadImage: error",!1,r),i.onabort=M(Ln,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=M(Ln,o,i,"TestLoadImage: timeout",!1,r),L.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):ge(),t.v=0,t.f&&t.f.ra(e),or(t),Qn(t)}function or(t){t.v=0,t.I=-1,t.f&&(0==An(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function sr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Ye?We(s):new Ye(s,void 0);return""!=a.c?(e&&Xe(a,e+"."+a.c),$e(a,a.h)):(r=(u=L.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Ye(null,void 0),r&&Ke(u,r),i&&Xe(u,i),o&&$e(u,o),s&&(u.g=s),a=u),t.W&&$(t.W,function(t,e){Ze(a,e,t)}),e=t.A,n=t.na,e&&n&&Ze(a,e,n),Ze(a,"VER",t.ha),Kn(t,a),a}function ur(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new On(t.Ka)).F=t.C,e}function ar(){}function hr(){if(it&&!(10<=Number(dt)))throw Error("Environmental error: no available transport.")}function cr(t,e){Ft.call(this),this.a=new qn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!Q(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Q(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new pr(this)}function lr(t){Re.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function fr(){Le.call(this),this.status=1}function pr(t){this.a=t}(N=On.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Te(this.H):Te(Ne),this.a.onreadystatechange=C(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Un(this,t)}t=n||"";var i,o=new Ge(this.headers);r&&qe(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=kn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=L.FormData&&t instanceof L.FormData,0<=B(_n,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{xn(this),0<this.o&&((this.D=(i=this.a,it&&pt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=C(this.xa,this)):this.m=Zt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Un(this,t)}},N.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Mn(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Mn(this,!0)),On.S.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?Cn(this):this.Ta())},N.Ta=function(){Cn(this)},N.X=function(){try{return 2<Fn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Sn(e)}},N.ua=function(){return this.h},N.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=qn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Oe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?tt(r=J(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Xn(this,n,e),Ze(i=We(this.B),"RID",t),Ze(i,"CVER",22),this.A&&Ze(i,"X-HTTP-Session-Id",this.A),Kn(this,i),this.i&&r&&jn(i,this.i,r),In(this.b,n),this.Ga&&Ze(i,"TYPE","init"),this.da?(Ze(i,"$req",e),Ze(i,"SID","null"),n.V=!0,ke(n,i,null)):ke(n,i,e),this.v=2}}else 3==this.v&&(t?Wn(this,t):0==this.g.length||wn(this.b)||Wn(this))},N.Aa=function(){var t;this.j=null,tr(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=we(C(this.Sa,this),t))},N.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,zn(this),tr(this))},N.Ra=function(){null!=this.m&&(this.m=null,zn(this),Jn(this),ge())},N.Xa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),ge()},(N=ar.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ha=function(){},hr.prototype.a=function(t,e){return new cr(t,e)},F(cr,Ft),(N=cr.prototype).addEventListener=function(t,e,n,r){cr.S.addEventListener.call(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){cr.S.removeEventListener.call(this,t,e,n,r)},N.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;ge(),t.fa=e,t.W=n||{},t.H=t.T,t.B=sr(t,null,t.fa),Yn(t)},N.close=function(){Gn(this.a)},N.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Hn(this.a,e)):this.g?((e={}).__data__=Bt(t),Hn(this.a,e)):Hn(this.a,t)},N.G=function(){this.a.f=null,delete this.f,Gn(this.a),delete this.a,cr.S.G.call(this)},F(lr,Re),F(fr,Le),F(pr,ar),pr.prototype.ta=function(){this.a.dispatchEvent("a")},pr.prototype.sa=function(t){this.a.dispatchEvent(new lr(t))},pr.prototype.ra=function(t){this.a.dispatchEvent(new fr)},pr.prototype.qa=function(){this.a.dispatchEvent("b")},hr.prototype.createWebChannel=hr.prototype.a,cr.prototype.send=cr.prototype.Pa,cr.prototype.open=cr.prototype.Oa,be.NO_ERROR=0,be.TIMEOUT=8,be.HTTP_ERROR=6,Ee.COMPLETE="complete",(Ae.EventType=R).OPEN="a",R.CLOSE="b",R.ERROR="c",R.MESSAGE="d",Ft.prototype.listen=Ft.prototype.va,On.prototype.listenOnce=On.prototype.wa,On.prototype.getLastError=On.prototype.Qa,On.prototype.getLastErrorCode=On.prototype.ua,On.prototype.getStatus=On.prototype.X,On.prototype.getResponseJson=On.prototype.Na,On.prototype.getResponseText=On.prototype.$,On.prototype.send=On.prototype.ba;var dr=(Ee={createWebChannelTransport:function(){return new hr},ErrorCode:be,EventType:Ee,WebChannel:Ae,XhrIo:On}).createWebChannelTransport,yr=Ee.ErrorCode,vr=Ee.EventType,gr=Ee.WebChannel,mr=Ee.XhrIo,wr=(br.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},br.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},br.prototype.setServiceProps=function(t){return this.serviceProps=t,this},br);function br(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Er,Ir={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Tr=(n(Rr,Er=Error),Rr),Ar="7.22.1-alpha.96ae6a5fe",Nr=new l("@firebase/firestore");function Rr(t,e){var n=this;return(n=Er.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Lr(){return Nr.logLevel}function Sr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=u.DEBUG&&(e=n.map(Vr),Nr.debug.apply(Nr,i(["Firestore ("+Ar+"): "+t],e)))}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=u.ERROR&&(e=n.map(Vr),Nr.error.apply(Nr,i(["Firestore ("+Ar+"): "+t],e)))}function Dr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=u.WARN&&(e=n.map(Vr),Nr.warn.apply(Nr,i(["Firestore ("+Ar+"): "+t],e)))}function Vr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function _r(t){throw void 0===t&&(t="Unexpected state"),Or(t="FIRESTORE ("+Ar+") INTERNAL ASSERTION FAILED: "+t),new Error(t)}function kr(t){t||_r()}function Ur(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Pr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Cr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Mr,xr,l=(Object.defineProperty(Hr.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),Hr.prototype.isEqual=function(t){return 0===Hr.i(this,t)},Hr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Hr?t.forEach(function(t){e.push(t)}):e.push(t),this.o(e)},Hr.prototype.limit=function(){return this.offset+this.length},Hr.prototype.u=function(t){return t=void 0===t?1:t,this.o(this.segments,this.offset+t,this.length-t)},Hr.prototype.h=function(){return this.o(this.segments,this.offset,this.length-1)},Hr.prototype.l=function(){return this.segments[this.offset]},Hr.prototype._=function(){return this.get(this.length-1)},Hr.prototype.get=function(t){return this.segments[this.offset+t]},Hr.prototype.m=function(){return 0===this.length},Hr.prototype.T=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Hr.prototype.A=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Hr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Hr.prototype.I=function(){return this.segments.slice(this.offset,this.limit())},Hr.i=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Hr),Fr=(n(Qr,xr=l),Qr.prototype.o=function(t,e,n){return new Qr(t,e,n)},Qr.prototype.R=function(){return this.I().join("/")},Qr.prototype.toString=function(){return this.R()},Qr.P=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new Qr(n)},Qr.V=function(){return new Qr([])},Qr),jr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Br=(n(zr,Mr=l),zr.prototype.o=function(t,e,n){return new zr(t,e,n)},zr.p=function(t){return jr.test(t)},zr.prototype.R=function(){return this.I().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),zr.p(t)||(t="`"+t+"`"),t}).join(".")},zr.prototype.toString=function(){return this.R()},zr.prototype.g=function(){return 1===this.length&&"__name__"===this.get(0)},zr.v=function(){return new zr(["__name__"])},zr.S=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Tr(Ir.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Tr(Ir.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Tr(Ir.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new zr(e)},zr.V=function(){return new zr([])},zr),qr=(Gr.D=function(t){return new Gr(Fr.P(t))},Gr.C=function(t){return new Gr(Fr.P(t).u(5))},Gr.prototype.N=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Gr.prototype.isEqual=function(t){return null!==t&&0===Fr.i(this.path,t.path)},Gr.prototype.toString=function(){return this.path.toString()},Gr.i=function(t,e){return Fr.i(t.path,e.path)},Gr.F=function(t){return t.length%2==0},Gr.$=function(t){return new Gr(new Fr(t.slice()))},Gr);function Gr(t){this.path=t}function zr(){return null!==Mr&&Mr.apply(this,arguments)||this}function Qr(){return null!==xr&&xr.apply(this,arguments)||this}function Hr(t,e,n){void 0===e?e=0:e>t.length&&_r(),void 0===n?n=t.length-e:n>t.length-e&&_r(),this.segments=t,this.offset=e,this.t=n}function Yr(t,e){if(0!==e.length)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+li(e.length,"argument")+".")}function Wr(t,e,n){if(e.length!==n)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires "+li(n,"argument")+", but was called with "+li(e.length,"argument")+".")}function Kr(t,e,n){if(e.length<n)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires at least "+li(n,"argument")+", but was called with "+li(e.length,"argument")+".")}function Xr(t,e,n,r){if(e.length<n||e.length>r)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+li(e.length,"argument")+".")}function $r(t,e,n,r){ri(t,e,ci(n)+" argument",r)}function Jr(t,e,n,r){void 0!==r&&$r(t,e,n,r)}function Zr(t,e,n,r){ri(t,e,n+" option",r)}function ti(t,e,n,r){void 0!==r&&Zr(t,e,n,r)}function ei(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(oi(s))}var u=oi(n);throw new Tr(Ir.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function ni(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid value "+oi(r)+" provided to function "+t+"() for its "+ci(n)+" argument. Acceptable values: "+e.join(", "));return r}function ri(t,e,n,r){if(!("object"===e?ii(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e))throw r=oi(r),new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}function ii(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function oi(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":_r();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function si(t,e,n){if(void 0===n)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+ci(e)+" argument, but it was undefined.")}function ui(n,t,r){Pr(t,function(t,e){if(r.indexOf(t)<0)throw new Tr(Ir.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function ai(t,e,n,r){return r=oi(r),new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires its "+ci(n)+" argument to be a "+e+", but it was: "+r)}function hi(t,e,n){if(n<=0)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires its "+ci(e)+" argument to be a positive number, but it was: "+n+".")}function ci(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function li(t,e){return t+" "+e+(1===t?"":"s")}var fi=(pi.L=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},pi);function pi(){}function di(t,e){return t<e?-1:e<t?1:0}function yi(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var vi=(gi.fromBase64String=function(t){return new gi(atob(t))},gi.fromUint8Array=function(t){return new gi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},gi.prototype.toBase64=function(){return t=this.O,btoa(t);var t},gi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.O)},gi.prototype.k=function(){return 2*this.O.length},gi.prototype.M=function(t){return di(this.O,t.O)},gi.prototype.isEqual=function(t){return this.O===t.O},gi);function gi(t){this.O=t}vi.U=new vi("");var mi=(wi.fromBase64String=function(t){try{return new wi(vi.fromBase64String(t))}catch(t){throw new Tr(Ir.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},wi.fromUint8Array=function(t){return new wi(vi.fromUint8Array(t))},wi.prototype.toBase64=function(){return this.q.toBase64()},wi.prototype.toUint8Array=function(){return this.q.toUint8Array()},wi.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},wi.prototype.isEqual=function(t){return this.q.isEqual(t.q)},wi);function wi(t){this.q=t}function bi(){if("undefined"==typeof Uint8Array)throw new Tr(Ir.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Ei(){if("undefined"==typeof atob)throw new Tr(Ir.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function Ii(t,e,n,r,i){this.B=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var Ti,Ai=(n(ki,Ti=mi),ki.fromBase64String=function(t){Wr("Blob.fromBase64String",arguments,1),$r("Blob.fromBase64String","string",1,t),Ei();try{return new ki(vi.fromBase64String(t))}catch(t){throw new Tr(Ir.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},ki.fromUint8Array=function(t){if(Wr("Blob.fromUint8Array",arguments,1),bi(),!(t instanceof Uint8Array))throw ai("Blob.fromUint8Array","Uint8Array",1,t);return new ki(vi.fromUint8Array(t))},ki.prototype.toBase64=function(){return Wr("Blob.toBase64",arguments,0),Ei(),Ti.prototype.toBase64.call(this)},ki.prototype.toUint8Array=function(){return Wr("Blob.toUint8Array",arguments,0),bi(),Ti.prototype.toUint8Array.call(this)},ki.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},ki),Ni=(Object.defineProperty(_i.prototype,"j",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),_i.prototype.isEqual=function(t){return t instanceof _i&&t.projectId===this.projectId&&t.database===this.database},_i.prototype.M=function(t){return di(this.projectId,t.projectId)||di(this.database,t.database)},_i),Ri=(Vi.prototype.get=function(t){var e=this.W(t);if(void 0!==(e=this.K[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.G(i,t))return o}},Vi.prototype.has=function(t){return void 0!==this.get(t)},Vi.prototype.set=function(t,e){var n=this.W(t),r=this.K[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.G(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.K[n]=[[t,e]]},Vi.prototype.delete=function(t){var e=this.W(t),n=this.K[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.G(n[r][0],t))return 1===n.length?delete this.K[e]:n.splice(r,1),!0;return!1},Vi.prototype.forEach=function(s){Pr(this.K,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},Vi.prototype.m=function(){return Cr(this.K)},Vi),Li=(Di.now=function(){return Di.fromMillis(Date.now())},Di.fromDate=function(t){return Di.fromMillis(t.getTime())},Di.fromMillis=function(t){var e=Math.floor(t/1e3);return new Di(e,1e6*(t-1e3*e))},Di.prototype.toDate=function(){return new Date(this.toMillis())},Di.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Di.prototype.H=function(t){return this.seconds===t.seconds?di(this.nanoseconds,t.nanoseconds):di(this.seconds,t.seconds)},Di.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Di.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Di.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},Di.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Di),Si=(Oi.Y=function(t){return new Oi(t)},Oi.min=function(){return new Oi(new Li(0,0))},Oi.prototype.M=function(t){return this.timestamp.H(t.timestamp)},Oi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Oi.prototype.J=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Oi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Oi.prototype.X=function(){return this.timestamp},Oi);function Oi(t){this.timestamp=t}function Di(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Vi(t,e){this.W=t,this.G=e,this.K={}}function _i(t,e){this.projectId=t,this.database=e||"(default)"}function ki(){return null!==Ti&&Ti.apply(this,arguments)||this}function Ui(t){return null==t}function Pi(t){return 0===t&&1/t==-1/0}var Ci=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Z=null};function Mi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Ci(t,e,n,r,i,o,s)}function xi(t){var e=t;return null===e.Z&&(t=e.path.R(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.R()+t.op.toString()+xo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.R()+t.dir}).join(","),Ui(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=ca(e.startAt)),e.endAt&&(t+="|ub:",t+=ca(e.endAt)),e.Z=t),e.Z}function Fi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Uo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!fa(t.startAt,e.startAt)&&fa(t.endAt,e.endAt)}function ji(t){return qr.F(t.path)&&null===t.collectionGroup&&0===t.filters.length}function Bi(t){this.count=t}var qi,Gi=(zi.prototype.nt=function(t){return new zi(this.target,this.targetId,this.tt,t,this.et,this.lastLimboFreeSnapshotVersion,this.resumeToken)},zi.prototype.st=function(t,e){return new zi(this.target,this.targetId,this.tt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},zi.prototype.it=function(t){return new zi(this.target,this.targetId,this.tt,this.sequenceNumber,this.et,t,this.resumeToken)},zi);function zi(t,e,n,r,i,o,s){void 0===i&&(i=Si.min()),void 0===o&&(o=Si.min()),void 0===s&&(s=vi.U),this.target=t,this.targetId=e,this.tt=n,this.sequenceNumber=r,this.et=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Qi(t){switch(t){case Ir.OK:return _r(),0;case Ir.CANCELLED:case Ir.UNKNOWN:case Ir.DEADLINE_EXCEEDED:case Ir.RESOURCE_EXHAUSTED:case Ir.INTERNAL:case Ir.UNAVAILABLE:case Ir.UNAUTHENTICATED:return;case Ir.INVALID_ARGUMENT:case Ir.NOT_FOUND:case Ir.ALREADY_EXISTS:case Ir.PERMISSION_DENIED:case Ir.FAILED_PRECONDITION:case Ir.ABORTED:case Ir.OUT_OF_RANGE:case Ir.UNIMPLEMENTED:case Ir.DATA_LOSS:return 1;default:return _r(),0}}function Hi(t){if(void 0===t)return Or("GRPC error has no .code"),Ir.UNKNOWN;switch(t){case qi.OK:return Ir.OK;case qi.CANCELLED:return Ir.CANCELLED;case qi.UNKNOWN:return Ir.UNKNOWN;case qi.DEADLINE_EXCEEDED:return Ir.DEADLINE_EXCEEDED;case qi.RESOURCE_EXHAUSTED:return Ir.RESOURCE_EXHAUSTED;case qi.INTERNAL:return Ir.INTERNAL;case qi.UNAVAILABLE:return Ir.UNAVAILABLE;case qi.UNAUTHENTICATED:return Ir.UNAUTHENTICATED;case qi.INVALID_ARGUMENT:return Ir.INVALID_ARGUMENT;case qi.NOT_FOUND:return Ir.NOT_FOUND;case qi.ALREADY_EXISTS:return Ir.ALREADY_EXISTS;case qi.PERMISSION_DENIED:return Ir.PERMISSION_DENIED;case qi.FAILED_PRECONDITION:return Ir.FAILED_PRECONDITION;case qi.ABORTED:return Ir.ABORTED;case qi.OUT_OF_RANGE:return Ir.OUT_OF_RANGE;case qi.UNIMPLEMENTED:return Ir.UNIMPLEMENTED;case qi.DATA_LOSS:return Ir.DATA_LOSS;default:return _r()}}(l=qi=qi||{})[l.OK=0]="OK",l[l.CANCELLED=1]="CANCELLED",l[l.UNKNOWN=2]="UNKNOWN",l[l.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",l[l.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",l[l.NOT_FOUND=5]="NOT_FOUND",l[l.ALREADY_EXISTS=6]="ALREADY_EXISTS",l[l.PERMISSION_DENIED=7]="PERMISSION_DENIED",l[l.UNAUTHENTICATED=16]="UNAUTHENTICATED",l[l.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",l[l.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",l[l.ABORTED=10]="ABORTED",l[l.OUT_OF_RANGE=11]="OUT_OF_RANGE",l[l.UNIMPLEMENTED=12]="UNIMPLEMENTED",l[l.INTERNAL=13]="INTERNAL",l[l.UNAVAILABLE=14]="UNAVAILABLE",l[l.DATA_LOSS=15]="DATA_LOSS";var Yi=(Ji.prototype.rt=function(t,e){return new Ji(this.i,this.root.rt(t,e,this.i).copy(null,null,Ki.ot,null,null))},Ji.prototype.remove=function(t){return new Ji(this.i,this.root.remove(t,this.i).copy(null,null,Ki.ot,null,null))},Ji.prototype.get=function(t){for(var e=this.root;!e.m();){var n=this.i(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Ji.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.m();){var r=this.i(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Ji.prototype.m=function(){return this.root.m()},Object.defineProperty(Ji.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Ji.prototype.ut=function(){return this.root.ut()},Ji.prototype.at=function(){return this.root.at()},Ji.prototype.ct=function(t){return this.root.ct(t)},Ji.prototype.forEach=function(n){this.ct(function(t,e){return n(t,e),!1})},Ji.prototype.toString=function(){var n=[];return this.ct(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Ji.prototype.ht=function(t){return this.root.ht(t)},Ji.prototype.lt=function(){return new Wi(this.root,null,this.i,!1)},Ji.prototype._t=function(t){return new Wi(this.root,t,this.i,!1)},Ji.prototype.ft=function(){return new Wi(this.root,null,this.i,!0)},Ji.prototype.dt=function(t){return new Wi(this.root,t,this.i,!0)},Ji),Wi=($i.prototype.Tt=function(){var t=this.Et.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.m();)this.Et.push(t),t=t.right;else for(t=t.right;!t.m();)this.Et.push(t),t=t.left;return e},$i.prototype.At=function(){return 0<this.Et.length},$i.prototype.It=function(){if(0===this.Et.length)return null;var t=this.Et[this.Et.length-1];return{key:t.key,value:t.value}},$i),Ki=(Xi.prototype.copy=function(t,e,n,r,i){return new Xi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Xi.prototype.m=function(){return!1},Xi.prototype.ct=function(t){return this.left.ct(t)||t(this.key,this.value)||this.right.ct(t)},Xi.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},Xi.prototype.min=function(){return this.left.m()?this:this.left.min()},Xi.prototype.ut=function(){return this.min().key},Xi.prototype.at=function(){return this.right.m()?this.key:this.right.at()},Xi.prototype.rt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.rt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.rt(t,e,n))).Rt()},Xi.prototype.yt=function(){if(this.left.m())return Xi.EMPTY;var t=this;return t.left.Pt()||t.left.left.Pt()||(t=t.Vt()),(t=t.copy(null,null,null,t.left.yt(),null)).Rt()},Xi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.m()||r.left.Pt()||r.left.left.Pt()||(r=r.Vt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Pt()&&(r=r.gt()),r.right.m()||r.right.Pt()||r.right.left.Pt()||(r=r.vt()),0===e(t,r.key)){if(r.right.m())return Xi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.yt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Rt()},Xi.prototype.Pt=function(){return this.color},Xi.prototype.Rt=function(){var t=this;return t.right.Pt()&&!t.left.Pt()&&(t=t.bt()),t.left.Pt()&&t.left.left.Pt()&&(t=t.gt()),t.left.Pt()&&t.right.Pt()&&(t=t.St()),t},Xi.prototype.Vt=function(){var t=this.St();return t.right.left.Pt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.gt())).bt()).St()),t},Xi.prototype.vt=function(){var t=this.St();return t.left.left.Pt()&&(t=(t=t.gt()).St()),t},Xi.prototype.bt=function(){var t=this.copy(null,null,Xi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Xi.prototype.gt=function(){var t=this.copy(null,null,Xi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Xi.prototype.St=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Xi.prototype.Dt=function(){var t=this.Ct();return Math.pow(2,t)<=this.size+1},Xi.prototype.Ct=function(){if(this.Pt()&&this.left.Pt())throw _r();if(this.right.Pt())throw _r();var t=this.left.Ct();if(t!==this.right.Ct())throw _r();return t+(this.Pt()?0:1)},Xi);function Xi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Xi.RED,this.left=null!=r?r:Xi.EMPTY,this.right=null!=i?i:Xi.EMPTY,this.size=this.left.size+1+this.right.size}function $i(t,e,n,r){this.wt=r,this.Et=[];for(var i=1;!t.m();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.wt?t.left:t.right;else{if(0===i){this.Et.push(t);break}this.Et.push(t),t=this.wt?t.right:t.left}}function Ji(t,e){this.i=t,this.root=e||Ki.EMPTY}function Zi(){this.size=0}Ki.EMPTY=null,Ki.RED=!0,Ki.ot=!1,Ki.EMPTY=(Object.defineProperty(Zi.prototype,"key",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(Zi.prototype,"value",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(Zi.prototype,"color",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(Zi.prototype,"left",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(Zi.prototype,"right",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Zi.prototype.copy=function(t,e,n,r,i){return this},Zi.prototype.rt=function(t,e,n){return new Ki(t,e)},Zi.prototype.remove=function(t,e){return this},Zi.prototype.m=function(){return!0},Zi.prototype.ct=function(t){return!1},Zi.prototype.ht=function(t){return!1},Zi.prototype.ut=function(){return null},Zi.prototype.at=function(){return null},Zi.prototype.Pt=function(){return!1},Zi.prototype.Dt=function(){return!0},Zi.prototype.Ct=function(){return 0},new Zi);var to=(io.prototype.has=function(t){return null!==this.data.get(t)},io.prototype.first=function(){return this.data.ut()},io.prototype.last=function(){return this.data.at()},Object.defineProperty(io.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),io.prototype.indexOf=function(t){return this.data.indexOf(t)},io.prototype.forEach=function(n){this.data.ct(function(t,e){return n(t),!1})},io.prototype.Nt=function(t,e){for(var n=this.data._t(t[0]);n.At();){var r=n.Tt();if(0<=this.i(r.key,t[1]))return;e(r.key)}},io.prototype.Ft=function(t,e){for(var n=void 0!==e?this.data._t(e):this.data.lt();n.At();)if(!t(n.Tt().key))return},io.prototype.$t=function(t){return(t=this.data._t(t)).At()?t.Tt().key:null},io.prototype.lt=function(){return new eo(this.data.lt())},io.prototype._t=function(t){return new eo(this.data._t(t))},io.prototype.add=function(t){return this.copy(this.data.remove(t).rt(t,!0))},io.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},io.prototype.m=function(){return this.data.m()},io.prototype.Lt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},io.prototype.isEqual=function(t){if(!(t instanceof io))return!1;if(this.size!==t.size)return!1;for(var e=this.data.lt(),n=t.data.lt();e.At();){var r=e.Tt().key,i=n.Tt().key;if(0!==this.i(r,i))return!1}return!0},io.prototype.I=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},io.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},io.prototype.copy=function(t){var e=new io(this.i);return e.data=t,e},io),eo=(ro.prototype.Tt=function(){return this.Ot.Tt().key},ro.prototype.At=function(){return this.Ot.At()},ro),no=new Yi(qr.i);function ro(t){this.Ot=t}function io(t){this.i=t,this.data=new Yi(this.i)}var oo=new Yi(qr.i),so=new Yi(qr.i),uo=new to(qr.i);function ao(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=uo,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var ho=new to(di),co=(Lo.Mt=function(t){return new Lo(t.i)},Lo.prototype.has=function(t){return null!=this.xt.get(t)},Lo.prototype.get=function(t){return this.xt.get(t)},Lo.prototype.first=function(){return this.kt.ut()},Lo.prototype.last=function(){return this.kt.at()},Lo.prototype.m=function(){return this.kt.m()},Lo.prototype.indexOf=function(t){return(t=this.xt.get(t))?this.kt.indexOf(t):-1},Object.defineProperty(Lo.prototype,"size",{get:function(){return this.kt.size},enumerable:!1,configurable:!0}),Lo.prototype.forEach=function(n){this.kt.ct(function(t,e){return n(t),!1})},Lo.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.xt.rt(t.key,t),e.kt.rt(t,null))},Lo.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.xt.remove(t),this.kt.remove(e)):this},Lo.prototype.isEqual=function(t){if(!(t instanceof Lo))return!1;if(this.size!==t.size)return!1;for(var e=this.kt.lt(),n=t.kt.lt();e.At();){var r=e.Tt().key,i=n.Tt().key;if(!r.isEqual(i))return!1}return!0},Lo.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Lo.prototype.copy=function(t,e){var n=new Lo;return n.i=this.i,n.xt=t,n.kt=e,n},Lo),lo=(Ro.prototype.track=function(t){var e=t.doc.key,n=this.Ut.get(e);!n||0!==t.type&&3===n.type?this.Ut=this.Ut.rt(e,t):3===t.type&&1!==n.type?this.Ut=this.Ut.rt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Ut=this.Ut.rt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Ut=this.Ut.rt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Ut=this.Ut.remove(e):1===t.type&&2===n.type?this.Ut=this.Ut.rt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Ut=this.Ut.rt(e,{type:2,doc:t.doc}):_r()},Ro.prototype.qt=function(){var n=[];return this.Ut.ct(function(t,e){n.push(e)}),n},Ro),fo=(No.Gt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new No(t,e,co.Mt(e),i,n,r,!0,!1)},Object.defineProperty(No.prototype,"hasPendingWrites",{get:function(){return!this.Qt.m()},enumerable:!1,configurable:!0}),No.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.jt===t.jt&&this.Qt.isEqual(t.Qt)&&ku(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Bt.isEqual(t.Bt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},No),po=(Ao.Jt=function(t,e){var n=new Map;return n.set(t,yo.Xt(t,e)),new Ao(Si.min(),n,ho,no,ao())},Ao),yo=(To.Xt=function(t,e){return new To(vi.U,e,ao(),ao(),ao())},To),vo=function(t,e,n,r){this.se=t,this.removedTargetIds=e,this.key=n,this.ie=r},go=function(t,e){this.targetId=t,this.re=e},mo=function(t,e,n,r){void 0===n&&(n=vi.U),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},wo=(Object.defineProperty(Io.prototype,"Zt",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(Io.prototype,"resumeToken",{get:function(){return this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(Io.prototype,"le",{get:function(){return 0!==this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(Io.prototype,"_e",{get:function(){return this.he},enumerable:!1,configurable:!0}),Io.prototype.fe=function(t){0<t.k()&&(this.he=!0,this.ae=t)},Io.prototype.de=function(){var n=ao(),r=ao(),i=ao();return this.ue.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:_r()}}),new yo(this.ae,this.ce,n,r,i)},Io.prototype.we=function(){this.he=!1,this.ue=Oo()},Io.prototype.me=function(t,e){this.he=!0,this.ue=this.ue.rt(t,e)},Io.prototype.Ee=function(t){this.he=!0,this.ue=this.ue.remove(t)},Io.prototype.Te=function(){this.oe+=1},Io.prototype.Ae=function(){--this.oe},Io.prototype.Ie=function(){this.he=!0,this.ce=!0},Io),bo=(Eo.prototype.ge=function(t){for(var e=0,n=t.se;e<n.length;e++){var r=n[e];t.ie instanceof yu?this.ve(r,t.ie):t.ie instanceof vu&&this.be(r,t.key,t.ie)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.be(s,t.key,t.ie)}},Eo.prototype.Se=function(n){var r=this;this.De(n,function(t){var e=r.Ce(t);switch(n.state){case 0:r.Ne(t)&&e.fe(n.resumeToken);break;case 1:e.Ae(),e.le||e.we(),e.fe(n.resumeToken);break;case 2:e.Ae(),e.le||r.removeTarget(t);break;case 3:r.Ne(t)&&(e.Ie(),e.fe(n.resumeToken));break;case 4:r.Ne(t)&&(r.Fe(t),e.fe(n.resumeToken));break;default:_r()}})},Eo.prototype.De=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ye.forEach(function(t,e){r.Ne(e)&&n(e)})},Eo.prototype.$e=function(t){var e=t.targetId,n=t.re.count;(t=this.Le(e))&&(ji(t=t.target)?0===n?(t=new qr(t.path),this.be(e,t,new vu(t,Si.min()))):kr(1===n):this.Oe(e)!==n&&(this.Fe(e),this.pe=this.pe.add(e)))},Eo.prototype.xe=function(r){var i=this,o=new Map;this.ye.forEach(function(t,e){var n=i.Le(e);n&&(t.Zt&&ji(n.target)&&(n=new qr(n.target.path),null!==i.Pe.get(n)||i.ke(e,n)||i.be(e,n,new vu(n,r))),t._e&&(o.set(e,t.de()),t.we()))});var s=ao();this.Ve.forEach(function(t,e){var n=!0;e.Ft(function(t){return!(t=i.Le(t))||2===t.tt||(n=!1)}),n&&(s=s.add(t))});var t=new po(r,o,this.pe,this.Pe,s);return this.Pe=no,this.Ve=So(),this.pe=new to(di),t},Eo.prototype.ve=function(t,e){var n;this.Ne(t)&&(n=this.ke(t,e.key)?2:0,this.Ce(t).me(e.key,n),this.Pe=this.Pe.rt(e.key,e),this.Ve=this.Ve.rt(e.key,this.Me(e.key).add(t)))},Eo.prototype.be=function(t,e,n){var r;this.Ne(t)&&(r=this.Ce(t),this.ke(t,e)?r.me(e,1):r.Ee(e),this.Ve=this.Ve.rt(e,this.Me(e).delete(t)),n&&(this.Pe=this.Pe.rt(e,n)))},Eo.prototype.removeTarget=function(t){this.ye.delete(t)},Eo.prototype.Oe=function(t){var e=this.Ce(t).de();return this.Re.Ue(t).size+e.te.size-e.ne.size},Eo.prototype.Te=function(t){this.Ce(t).Te()},Eo.prototype.Ce=function(t){var e=this.ye.get(t);return e||(e=new wo,this.ye.set(t,e)),e},Eo.prototype.Me=function(t){var e=this.Ve.get(t);return e||(e=new to(di),this.Ve=this.Ve.rt(t,e)),e},Eo.prototype.Ne=function(t){var e=null!==this.Le(t);return e||Sr("WatchChangeAggregator","Detected inactive target",t),e},Eo.prototype.Le=function(t){var e=this.ye.get(t);return e&&e.le?null:this.Re.qe(t)},Eo.prototype.Fe=function(e){var n=this;this.ye.set(e,new wo),this.Re.Ue(e).forEach(function(t){n.be(e,t,null)})},Eo.prototype.ke=function(t,e){return this.Re.Ue(t).has(e)},Eo);function Eo(t){this.Re=t,this.ye=new Map,this.Pe=no,this.Ve=So(),this.pe=new to(di)}function Io(){this.oe=0,this.ue=Oo(),this.ae=vi.U,this.ce=!1,this.he=!0}function To(t,e,n,r,i){this.resumeToken=t,this.Zt=e,this.te=n,this.ee=r,this.ne=i}function Ao(t,e,n,r,i){this.et=t,this.zt=e,this.Kt=n,this.Ht=r,this.Yt=i}function No(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Bt=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.jt=s,this.Wt=u}function Ro(){this.Ut=new Yi(qr.i)}function Lo(n){this.i=n?function(t,e){return n(t,e)||qr.i(t.key,e.key)}:function(t,e){return qr.i(t.key,e.key)},this.xt=oo,this.kt=new Yi(this.i)}function So(){return new Yi(qr.i)}function Oo(){return new Yi(qr.i)}function Do(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Vo(t){return t=Fo(t.mapValue.fields.__local_write_time__.timestampValue),new Li(t.seconds,t.nanos)}var _o=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ko(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Do(t)?4:10:_r()}function Uo(r,i){var t,e,n,o=ko(r);if(o!==ko(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return Vo(r).isEqual(Vo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Fo(r.timestampValue),t=Fo(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Bo(r.bytesValue).isEqual(Bo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return o=i,jo((t=r).geoPointValue.latitude)===jo(o.geoPointValue.latitude)&&jo(t.geoPointValue.longitude)===jo(o.geoPointValue.longitude);case 2:return n=i,"integerValue"in(e=r)&&"integerValue"in n?jo(e.integerValue)===jo(n.integerValue):"doubleValue"in e&&"doubleValue"in n&&((e=jo(e.doubleValue))===(n=jo(n.doubleValue))?Pi(e)===Pi(n):isNaN(e)&&isNaN(n));case 9:return yi(r.arrayValue.values||[],i.arrayValue.values||[],Uo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Ur(e)!==Ur(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Uo(e[t],n[t])))return!1;return!0}();default:return _r()}}function Po(t,e){return void 0!==(t.values||[]).find(function(t){return Uo(t,e)})}function Co(t,e){var n,r,i,o,s=ko(t),u=ko(e);if(s!==u)return di(s,u);switch(s){case 0:return 0;case 1:return di(t.booleanValue,e.booleanValue);case 2:return n=e,(r=jo(t.integerValue||t.doubleValue))<(n=jo(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return Mo(t.timestampValue,e.timestampValue);case 4:return Mo(Vo(t),Vo(e));case 5:return di(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,o=e.bytesValue,i=Bo(i),o=Bo(o),i.M(o);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=di(n[i],r[i]);if(0!==o)return o}return di(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return s=t.geoPointValue,r=e.geoPointValue,0!==(n=di(jo(s.latitude),jo(r.latitude)))?n:di(jo(s.longitude),jo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Co(n[i],r[i]);if(o)return o}return di(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=di(r[s],o[s]);if(0!==u)return u;if(0!==(u=Co(n[r[s]],i[o[s]])))return u}return di(r.length,o.length)}(t.mapValue,e.mapValue);default:throw _r()}}function Mo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return di(t,e);var n=Fo(t),t=Fo(e);return 0!==(e=di(n.seconds,t.seconds))?e:di(n.nanos,t.nanos)}function xo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=Fo(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?Bo(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,qr.C(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):_r();var t,e}(t)}function Fo(t){if(kr(!!t),"string"!=typeof t)return{seconds:jo(t.seconds),nanos:jo(t.nanos)};var e=0,n=_o.exec(t);return kr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function jo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Bo(t){return"string"==typeof t?vi.fromBase64String(t):vi.fromUint8Array(t)}function qo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.R()}}function Go(t){return t&&"integerValue"in t}function zo(t){return!!t&&"arrayValue"in t}function Qo(t){return t&&"nullValue"in t}function Ho(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Yo(t){return t&&"mapValue"in t}var Wo={asc:"ASCENDING",desc:"DESCENDING"},Ko={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Xo=function(t,e){this.B=t,this.Be=e};function $o(t){return{integerValue:""+t}}function Jo(t,e){if(t.Be){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Pi(e)?"-0":e}}function Zo(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!Pi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?$o(e):Jo(t,e);var n}function ts(t,e){return t.Be?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function es(t,e){return t.Be?e.toBase64():e.toUint8Array()}function ns(t){return kr(!!t),Si.Y((t=Fo(t),new Li(t.seconds,t.nanos)))}function rs(t,e){return new Fr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).R()}function is(t){return kr(gs(t=Fr.P(t))),t}function os(t,e){return rs(t.B,e.path)}function ss(t,e){return kr((e=is(e)).get(1)===t.B.projectId),kr(!e.get(3)&&!t.B.database||e.get(3)===t.B.database),new qr(hs(e))}function us(t,e){return rs(t.B,e)}function as(t){return new Fr(["projects",t.B.projectId,"databases",t.B.database]).R()}function hs(t){return kr(4<t.length&&"documents"===t.get(4)),t.u(5)}function cs(t,e,n){return{name:os(t,e),fields:n.proto.mapValue.fields}}function ls(t,e){var n,r,i;if(e instanceof Ys)n={update:cs(t,e.key,e.value)};else if(e instanceof iu)n={delete:os(t,e.key)};else if(e instanceof Ws)n={update:cs(t,e.key,e.data),updateMask:(i=e.Qe,r=[],i.fields.forEach(function(t){return r.push(t.R())}),{fieldPaths:r})};else if(e instanceof Zs)n={transform:{document:os(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Es)return{fieldPath:t.field.R(),setToServerValue:"REQUEST_TIME"};if(e instanceof Is)return{fieldPath:t.field.R(),appendMissingElements:{values:e.elements}};if(e instanceof Ls)return{fieldPath:t.field.R(),removeAllFromArray:{values:e.elements}};if(e instanceof Vs)return{fieldPath:t.field.R(),increment:e.je};throw _r()})}};else{if(!(e instanceof ou))return _r();n={verify:os(t,e.key)}}return e.Ge.We||(n.currentDocument=void 0!==(i=e.Ge).updateTime?{updateTime:ts(e=t,(t=i.updateTime).X())}:void 0!==i.exists?{exists:i.exists}:_r()),n}function fs(t){var e=4===(o=is(t.parent)).length?Fr.V():hs(o),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(kr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=vs(t.unaryFilter.field);return Fu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=vs(t.unaryFilter.field);return Fu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":return n=vs(t.unaryFilter.field),Fu.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return t=vs(t.unaryFilter.field),Fu.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return _r()}}(e)]:void 0!==e.fieldFilter?[(n=e,Fu.create(vs(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return _r()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):_r():[];var n}(n.where)),t=[],n.orderBy&&(t=n.orderBy.map(function(t){return new pa(vs((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e})),r=null,n.limit&&(r=Ui(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=ds(n.startAt));var u=null;return n.endAt&&(u=ds(n.endAt)),new mu(e,i,t,o,r,"F",s,u)}function ps(t){return{before:t.before,values:t.position}}function ds(t){var e=!!t.before,t=t.values||[];return new oa(t,e)}function ys(t){return{fieldPath:t.R()}}function vs(t){return Br.S(t.fieldPath)}function gs(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function ms(t,e){return t instanceof Vs?Go(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var ws,bs,Es=(n(As,bs=l=function(){this.ze=void 0}),As),Is=(n(Ts,ws=l),Ts);function Ts(t){var e=this;return(e=ws.call(this)||this).elements=t,e}function As(){return null!==bs&&bs.apply(this,arguments)||this}function Ns(t,e){for(var n=Us(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Uo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var Rs,Ls=(n(Ss,Rs=l),Ss);function Ss(t){var e=this;return(e=Rs.call(this)||this).elements=t,e}function Os(t,e){for(var n=Us(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Uo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var Ds,Vs=(n(_s,Ds=l),_s);function _s(t,e){var n=this;return(n=Ds.call(this)||this).serializer=t,n.je=e,n}function ks(t){return jo(t.integerValue||t.doubleValue)}function Us(t){return zo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Ps(t,e){this.field=t,this.transform=e}var Cs=(Ms.prototype.Ke=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].T(t))return!0;return!1},Ms.prototype.isEqual=function(t){return yi(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Ms);function Ms(t){(this.fields=t).sort(Br.i)}function xs(t,e){this.version=t,this.transformResults=e}var Fs=(js.He=function(){return new js},js.exists=function(t){return new js(void 0,t)},js.updateTime=function(t){return new js(t)},Object.defineProperty(js.prototype,"We",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),js.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},js);function js(t,e){this.updateTime=t,this.exists=e}function Bs(t,e){return void 0!==t.updateTime?e instanceof yu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof yu}function qs(t,e,n,r){return t instanceof Ys?(o=e,Bs((i=t).Ge,o)?(o=zs(o),new yu(i.key,o,i.value,{Ye:!0})):o):t instanceof Ws?function(t,e){if(!Bs(t.Ge,e))return e;var n=zs(e),e=$s(t,e);return new yu(t.key,n,e,{Ye:!0})}(t,e):t instanceof Zs?function(t,e,n,r){if(!Bs(t.Ge,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],h=a.transform,c=null;n instanceof yu&&(c=n.field(a.field)),null===c&&r instanceof yu&&(c=r.field(a.field)),o.push((i=c,a=e,c=void 0,(h=h)instanceof Es?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(c.fields.__previous_value__=i),{mapValue:c}):h instanceof Is?Ns(h,i):h instanceof Ls?Os(h,i):(i=ks(h=ms(c=h,i))+ks(c.je),Go(h)&&Go(c.je)?$o(i):Jo(c.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=eu(t,i.data(),r);return new yu(t.key,i.version,r,{Ye:!0})}(t,e,r,n):(e=e,Bs((t=t).Ge,e)?new vu(t.key,Si.min()):e);var i,o}function Gs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ge.isEqual(e.Ge)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||yi(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof Is&&e instanceof Is||t instanceof Ls&&e instanceof Ls?yi(t.elements,e.elements,Uo):t instanceof Vs&&e instanceof Vs?Uo(t.je,e.je):t instanceof Es&&e instanceof Es)}))}function zs(t){return t instanceof yu?t.version:Si.min()}var Qs,Hs,Ys=(n(Xs,Hs=l=function(){}),Xs),Ws=(n(Ks,Qs=l),Ks);function Ks(t,e,n,r){var i=this;return(i=Qs.call(this)||this).key=t,i.data=e,i.Qe=n,i.Ge=r,i.type=1,i}function Xs(t,e,n){var r=this;return(r=Hs.call(this)||this).key=t,r.value=e,r.Ge=n,r.type=0,r}function $s(t,e){return n=t,e=e instanceof yu?e.data():su.empty(),r=new uu(e),n.Qe.fields.forEach(function(t){var e;t.m()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Je();var n,r}var Js,Zs=(n(tu,Js=l),tu);function tu(t,e){var n=this;return(n=Js.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ge=Fs.exists(!0),n}function eu(t,e,n){for(var r=new uu(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Je()}var nu,ru,iu=(n(lu,ru=l),lu),ou=(n(cu,nu=l),cu),su=(hu.empty=function(){return new hu({mapValue:{}})},hu.prototype.field=function(t){if(t.m())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Yo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t._()])||null},hu.prototype.isEqual=function(t){return Uo(this.proto,t.proto)},hu),uu=(au.prototype.set=function(t,e){return this.tn(t,e),this},au.prototype.delete=function(t){return this.tn(t,null),this},au.prototype.tn=function(t,e){for(var n=this.Ze,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===ko(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t._(),e)},au.prototype.Je=function(){var t=this.en(Br.V(),this.Ze);return null!=t?new su(t):this.Xe},au.prototype.en=function(r,t){var i=this,o=!1,e=this.Xe.field(r),s=Yo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.en(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},au);function au(t){void 0===t&&(t=su.empty()),this.Xe=t,this.Ze=new Map}function hu(t){this.proto=t}function cu(t,e){var n=this;return(n=nu.call(this)||this).key=t,n.Ge=e,n.type=4,n}function lu(t,e){var n=this;return(n=ru.call(this)||this).key=t,n.Ge=e,n.type=3,n}var fu,pu,du,yu=(n(Eu,du=l=function(t,e){this.key=t,this.version=e}),Eu.prototype.field=function(t){return this.nn.field(t)},Eu.prototype.data=function(){return this.nn},Eu.prototype.sn=function(){return this.nn.proto},Eu.prototype.isEqual=function(t){return t instanceof Eu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ye===t.Ye&&this.hasCommittedMutations===t.hasCommittedMutations&&this.nn.isEqual(t.nn)},Eu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.nn.toString()+", {hasLocalMutations: "+this.Ye+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Eu.prototype,"hasPendingWrites",{get:function(){return this.Ye||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Eu),vu=(n(bu,pu=l),bu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(bu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),bu.prototype.isEqual=function(t){return t instanceof bu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},bu),gu=(n(wu,fu=l),wu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(wu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),wu.prototype.isEqual=function(t){return t instanceof wu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},wu),mu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.rn=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.on=null,this.un=null,this.startAt,this.endAt};function wu(){return null!==fu&&fu.apply(this,arguments)||this}function bu(t,e,n){var r=this;return(r=pu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Eu(t,e,n,r){var i=this;return(i=du.call(this,t,e)||this).nn=n,i.Ye=!!r.Ye,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Iu(t){return new mu(t)}function Tu(t){return!Ui(t.limit)&&"F"===t.limitType}function Au(t){return!Ui(t.limit)&&"L"===t.limitType}function Nu(t){return 0<t.rn.length?t.rn[0].field:null}function Ru(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.an())return r.field}return null}function Lu(t){return null!==t.collectionGroup}function Su(t){var e=t;if(null===e.on){e.on=[];var n=Ru(e),t=Nu(e);if(null!==n&&null===t)n.g()||e.on.push(new pa(n)),e.on.push(new pa(Br.v(),"asc"));else{for(var r=!1,i=0,o=e.rn;i<o.length;i++){var s=o[i];e.on.push(s),s.field.g()&&(r=!0)}r||(n=0<e.rn.length?e.rn[e.rn.length-1].dir:"asc",e.on.push(new pa(Br.v(),n)))}}return e.on}function Ou(t){var e=t;if(!e.un)if("F"===e.limitType)e.un=Mi(e.path,e.collectionGroup,Su(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Su(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new pa(o.field,s))}var u=e.endAt?new oa(e.endAt.position,!e.endAt.before):null,t=e.startAt?new oa(e.startAt.position,!e.startAt.before):null;e.un=Mi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.un}function Du(t,e,n){return new mu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Vu(t,e){return new mu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}function _u(t,e){return new mu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}function ku(t,e){return Fi(Ou(t),Ou(e))&&t.limitType===e.limitType}function Uu(t){return xi(Ou(t))+"|lt:"+t.limitType}function Pu(t){return"Query(target="+(n=(e=Ou(t)).path.R(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.R()+" "+t.op+" "+xo(t.value)}).join(", ")+"]"),Ui(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.R()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+ca(e.startAt)),e.endAt&&(n+=", endAt: "+ca(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function Cu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.N(e.collectionGroup)&&e.path.T(n):qr.F(e.path)?e.path.isEqual(n):e.path.A(n))&&function(t){for(var e=0,n=i.rn;e<n.length;e++){var r=n[e];if(!r.field.g()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||la(t.startAt,Su(t),n))&&(!t.endAt||!la(t.endAt,Su(t),n)));var e,n}function Mu(u){return function(t,e){for(var n=!1,r=0,i=Su(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i,o;switch(n=t.field.g()?qr.i(e.key,n.key):(r=t.field,i=n,o=e.field(r),r=i.field(r),null!==o&&null!==r?Co(o,r):_r()),t.dir){case"asc":return n;case"desc":return-1*n;default:return _r()}}(o,t,e);if(0!==s)return s;n=n||o.field.g()}return 0}}var xu,Fu=(n(ju,xu=function(){}),ju.create=function(t,e,n){if(t.g())return"in"===e||"not-in"===e?this.cn(t,e,n):new zu(t,e,n);if(Qo(n)){if("=="!==e&&"!="!==e)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. Null only supports '==' and '!=' comparisons.");return new ju(t,e,n)}if(Ho(n)){if("=="!==e&&"!="!==e)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. NaN only supports '==' and '!=' comparisons.");return new ju(t,e,n)}return"array-contains"===e?new ea(t,n):"in"===e?new na(t,n):"not-in"===e?new ra(t,n):"array-contains-any"===e?new ia(t,n):new ju(t,e,n)},ju.cn=function(t,e,n){return new("in"===e?Qu:Hu)(t,n)},ju.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this.hn(Co(t,this.value)):null!==t&&ko(this.value)===ko(t)&&this.hn(Co(t,this.value))},ju.prototype.hn=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return _r()}},ju.prototype.an=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},ju);function ju(t,e,n){var r=this;return(r=xu.call(this)||this).field=t,r.op=e,r.value=n,r}var Bu,qu,Gu,zu=(n(Ku,Gu=Fu),Ku.prototype.matches=function(t){return t=qr.i(t.key,this.key),this.hn(t)},Ku),Qu=(n(Wu,qu=Fu),Wu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Wu),Hu=(n(Yu,Bu=Fu),Yu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Yu);function Yu(t,e){var n=this;return(n=Bu.call(this,t,"not-in",e)||this).keys=Xu(0,e),n}function Wu(t,e){var n=this;return(n=qu.call(this,t,"in",e)||this).keys=Xu(0,e),n}function Ku(t,e,n){var r=this;return(r=Gu.call(this,t,e,n)||this).key=qr.C(n.referenceValue),r}function Xu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return qr.C(t.referenceValue)})}var $u,Ju,Zu,ta,ea=(n(ha,ta=Fu),ha.prototype.matches=function(t){return zo(t=t.field(this.field))&&Po(t.arrayValue,this.value)},ha),na=(n(aa,Zu=Fu),aa.prototype.matches=function(t){return null!==(t=t.field(this.field))&&Po(this.value.arrayValue,t)},aa),ra=(n(ua,Ju=Fu),ua.prototype.matches=function(t){return!Po(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!Po(this.value.arrayValue,t))},ua),ia=(n(sa,$u=Fu),sa.prototype.matches=function(t){var e=this;return!(!zo(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return Po(e.value.arrayValue,t)})},sa),oa=function(t,e){this.position=t,this.before=e};function sa(t,e){return $u.call(this,t,"array-contains-any",e)||this}function ua(t,e){return Ju.call(this,t,"not-in",e)||this}function aa(t,e){return Zu.call(this,t,"in",e)||this}function ha(t,e){return ta.call(this,t,"array-contains",e)||this}function ca(t){return(t.before?"b":"a")+":"+t.position.map(xo).join(",")}function la(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.g()?qr.i(qr.C(s.referenceValue),n.key):Co(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function fa(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Uo(t.position[n],e.position[n]))return!1;return!0}var pa=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function da(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var ya=(ma.prototype.reset=function(){this.mn=0},ma.prototype.An=function(){this.mn=this.wn},ma.prototype.In=function(t){var e=this;this.cancel();var n=Math.floor(this.mn+this.Rn()),r=Math.max(0,Date.now()-this.Tn),i=Math.max(0,n-r);0<i&&Sr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.mn+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.En=this.ln.yn(this._n,i,function(){return e.Tn=Date.now(),t()}),this.mn*=this.dn,this.mn<this.fn&&(this.mn=this.fn),this.mn>this.wn&&(this.mn=this.wn)},ma.prototype.Pn=function(){null!==this.En&&(this.En.Vn(),this.En=null)},ma.prototype.cancel=function(){null!==this.En&&(this.En.cancel(),this.En=null)},ma.prototype.Rn=function(){return(Math.random()-.5)*this.mn},ma),va=(ga.prototype.catch=function(t){return this.next(void 0,t)},ga.prototype.next=function(r,i){var o=this;return this.bn&&_r(),this.bn=!0,this.vn?this.error?this.Sn(i,this.error):this.Dn(r,this.result):new ga(function(e,n){o.pn=function(t){o.Dn(r,t).next(e,n)},o.gn=function(t){o.Sn(i,t).next(e,n)}})},ga.prototype.Cn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ga.prototype.Nn=function(t){try{var e=t();return e instanceof ga?e:ga.resolve(e)}catch(t){return ga.reject(t)}},ga.prototype.Dn=function(t,e){return t?this.Nn(function(){return t(e)}):ga.resolve(e)},ga.prototype.Sn=function(t,e){return t?this.Nn(function(){return t(e)}):ga.reject(e)},ga.resolve=function(n){return new ga(function(t,e){t(n)})},ga.reject=function(n){return new ga(function(t,e){e(n)})},ga.Fn=function(t){return new ga(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ga.$n=function(t){for(var n=ga.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?ga.resolve(t):e()})}(r[e]);return n},ga.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Fn(i)},ga);function ga(t){var e=this;this.pn=null,this.gn=null,this.result=void 0,this.error=void 0,this.vn=!1,this.bn=!1,t(function(t){e.vn=!0,e.result=t,e.pn&&e.pn(t)},function(t){e.vn=!0,e.error=t,e.gn&&e.gn(t)})}function ma(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.ln=t,this._n=e,this.fn=n,this.dn=r,this.wn=i,this.mn=0,this.En=null,this.Tn=Date.now(),this.reset()}function wa(t){return"IndexedDbTransactionError"===t.name}function ba(){return"undefined"!=typeof document?document:null}var Ea=(Aa.Mn=function(t,e,n,r,i){return(i=new Aa(t,e,Date.now()+n,r,i)).start(n),i},Aa.prototype.start=function(t){var e=this;this.Un=setTimeout(function(){return e.qn()},t)},Aa.prototype.Vn=function(){return this.qn()},Aa.prototype.cancel=function(t){null!==this.Un&&(this.clearTimeout(),this.kn.reject(new Tr(Ir.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Aa.prototype.qn=function(){var e=this;this.Ln.Bn(function(){return null!==e.Un?(e.clearTimeout(),e.op().then(function(t){return e.kn.resolve(t)})):Promise.resolve()})},Aa.prototype.clearTimeout=function(){null!==this.Un&&(this.xn(this),clearTimeout(this.Un),this.Un=null)},Aa),Ia=(Object.defineProperty(Ta.prototype,"Xn",{get:function(){return this.Wn},enumerable:!1,configurable:!0}),Ta.prototype.Bn=function(t){this.enqueue(t)},Ta.prototype.Zn=function(t){this.ts(),this.es(t)},Ta.prototype.ns=function(){var t;this.Wn||(this.Wn=!0,(t=ba())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Jn))},Ta.prototype.enqueue=function(t){return this.ts(),this.Wn?new Promise(function(t){}):this.es(t)},Ta.prototype.ss=function(t){var e=this;this.jn.push(t),this.Bn(function(){return e.rs()})},Ta.prototype.rs=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.jn.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.jn[0]()];case 2:return t.sent(),this.jn.shift(),this.Yn.reset(),[3,4];case 3:if(!wa(e=t.sent()))throw e;return Sr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.jn.length&&this.Yn.In(function(){return n.rs()}),t.label=5;case 5:return[2]}})})},Ta.prototype.es=function(t){var r=this,e=this.Qn.then(function(){return r.Kn=!0,t().catch(function(t){throw r.zn=t,r.Kn=!1,Or("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Kn=!1,t})});return this.Qn=e},Ta.prototype.yn=function(t,e,n){var r=this;return this.ts(),-1<this.Hn.indexOf(t)&&(e=0),n=Ea.Mn(this,t,e,n,function(t){return r.os(t)}),this.Gn.push(n),n},Ta.prototype.ts=function(){this.zn&&_r()},Ta.prototype.us=function(){},Ta.prototype.cs=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Qn];case 1:t.sent(),t.label=2;case 2:if(e!==this.Qn)return[3,0];t.label=3;case 3:return[2]}})})},Ta.prototype.hs=function(t){for(var e=0,n=this.Gn;e<n.length;e++)if(n[e]._n===t)return!0;return!1},Ta.prototype.ls=function(r){var i=this;return this.cs().then(function(){i.Gn.sort(function(t,e){return t.On-e.On});for(var t=0,e=i.Gn;t<e.length;t++){var n=e[t];if(n.Vn(),"all"!==r&&n._n===r)break}return i.cs()})},Ta.prototype._s=function(t){this.Hn.push(t)},Ta.prototype.os=function(t){t=this.Gn.indexOf(t),this.Gn.splice(t,1)},Ta);function Ta(){var e=this;this.Qn=Promise.resolve(),this.jn=[],this.Wn=!1,this.Gn=[],this.zn=null,this.Kn=!1,this.Hn=[],this.Yn=new ya(this,"async_queue_retry"),this.Jn=function(){var t=ba();t&&Sr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.Yn.Pn()};var t=ba();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Jn)}function Aa(t,e,n,r,i){this.Ln=t,this._n=e,this.On=n,this.op=r,this.xn=i,this.kn=new da,this.then=this.kn.promise.then.bind(this.kn.promise),this.kn.promise.catch(function(t){})}function Na(t,e){if(Or("AsyncQueue",e+": "+t),wa(t))return new Tr(Ir.UNAVAILABLE,e+": "+t);throw t}function Ra(){this.fs=void 0,this.listeners=[]}function La(){this.queries=new Ri(Uu,ku),this.onlineState="Unknown",this.ds=new Set}function Sa(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new Ra),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.ws(n)];case 2:return o.fs=t.sent(),[3,4];case 3:return o=Na(o=t.sent(),"Initialization of query '"+Pu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.Es(e.onlineState),i.fs&&u.Ts(i.fs)&&Da(e),[2]}})})}function Oa(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.As(n))]:[2]})})}function Da(t){t.ds.forEach(function(t){t.next()})}var Va=(Ua.prototype.Ts=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new fo(t.query,t.docs,t.Bt,e,t.Qt,t.fromCache,t.jt,!0)}var o=!1;return this.Rs?this.Ps(t)&&(this.Is.next(t),o=!0):this.Vs(t,this.onlineState)&&(this.ps(t),o=!0),this.ys=t,o},Ua.prototype.onError=function(t){this.Is.error(t)},Ua.prototype.Es=function(t){this.onlineState=t;var e=!1;return this.ys&&!this.Rs&&this.Vs(this.ys,t)&&(this.ps(this.ys),e=!0),e},Ua.prototype.Vs=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.gs&&n||t.docs.m()&&"Offline"!==e)},Ua.prototype.Ps=function(t){if(0<t.docChanges.length)return!0;var e=this.ys&&this.ys.hasPendingWrites!==t.hasPendingWrites;return!(!t.jt&&!e)&&!0===this.options.includeMetadataChanges},Ua.prototype.ps=function(t){t=fo.Gt(t.query,t.docs,t.Qt,t.fromCache),this.Rs=!0,this.Is.next(t)},Ua),_a=(ka.prototype.vs=function(){return null!=this.uid},ka.prototype.bs=function(){return this.vs()?"uid:"+this.uid:"anonymous-user"},ka.prototype.isEqual=function(t){return t.uid===this.uid},ka);function ka(t){this.uid=t}function Ua(t,e,n){this.query=t,this.Is=e,this.Rs=!1,this.ys=null,this.onlineState="Unknown",this.options=n||{}}_a.UNAUTHENTICATED=new _a(null),_a.Ss=new _a("google-credentials-uid"),_a.Ds=new _a("first-party-uid");var Pa=(Ca.prototype.Ns=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Ca.prototype.next=function(){var t=++this.previousValue;return this.Fs&&this.Fs(t),t},Ca);function Ca(t,e){var n=this;this.previousValue=t,e&&(e.Cs=function(t){return n.Ns(t)},this.Fs=function(t){return e.$s(t)})}Pa.Ls=-1;var Ma=(za.prototype.Os=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},za.prototype.xs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},za.prototype.ks=function(){var t={activeTargetIds:this.activeTargetIds.I(),updateTimeMs:Date.now()};return JSON.stringify(t)},za),xa=(Ga.prototype.Bs=function(t){},Ga.prototype.Qs=function(t,e,n){},Ga.prototype.js=function(t){return this.Ms.Os(t),this.Us[t]||"not-current"},Ga.prototype.Ws=function(t,e,n){this.Us[t]=e},Ga.prototype.Gs=function(t){this.Ms.xs(t)},Ga.prototype.zs=function(t){return this.Ms.activeTargetIds.has(t)},Ga.prototype.Ks=function(t){delete this.Us[t]},Ga.prototype.Hs=function(){return this.Ms.activeTargetIds},Ga.prototype.Ys=function(t){return this.Ms.activeTargetIds.has(t)},Ga.prototype.start=function(){return this.Ms=new Ma,Promise.resolve()},Ga.prototype.Js=function(t,e,n){},Ga.prototype.Xs=function(t){},Ga.prototype.Zs=function(){},Ga.prototype.$s=function(t){},Ga.prototype.ti=function(){},Ga),Fa=(qa.prototype.ni=function(t,e,n){for(var r,i,o,s,u,a,h=n.si,c=0;c<this.mutations.length;c++){var l=this.mutations[c];l.key.isEqual(t)&&(r=l,i=e,o=h[c],a=u=s=void 0,e=r instanceof Ys?new yu(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof Ws?(u=i,a=o,Bs((s=r).Ge,u)?(u=$s(s,u),new yu(s.key,a.version,u,{hasCommittedMutations:!0})):new gu(s.key,a.version)):r instanceof Zs?function(t,e,n){if(kr(null!=n.transformResults),!Bs(t.Ge,e))return new gu(t.key,n.version);var r=e,e=function(t,e,n){var r=[];kr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof yu&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof Is?Ns(o,s):o instanceof Ls?Os(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=eu(t,r.data(),e);return new yu(t.key,n,e,{hasCommittedMutations:!0})}(r,i,o):new vu(r.key,o.version,{hasCommittedMutations:!0}))}return e},qa.prototype.ii=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=qs(i,e,e,this.ei))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=qs(a,e,o,this.ei))}return e},qa.prototype.ri=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ii(t.key,n.get(t.key));e&&(i=i.rt(t.key,e))}),i},qa.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},ao())},qa.prototype.isEqual=function(t){return this.batchId===t.batchId&&yi(this.mutations,t.mutations,Gs)&&yi(this.baseMutations,t.baseMutations,Gs)},qa),ja=(Ba.from=function(t,e,n){kr(t.mutations.length===n.length);for(var r=so,i=t.mutations,o=0;o<i.length;o++)r=r.rt(i[o].key,n[o].version);return new Ba(t,e,n,r)},Ba);function Ba(t,e,n,r){this.batch=t,this.oi=e,this.si=n,this.ui=r}function qa(t,e,n,r){this.batchId=t,this.ei=e,this.baseMutations=n,this.mutations=r}function Ga(){this.Ms=new Ma,this.Us={},this.qs=null,this.Cs=null}function za(){this.activeTargetIds=ho}function Qa(n,r){void 0===r&&(r=10240);var i=0;return{read:function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return i<n.byteLength?(e={value:n.slice(i,i+r),done:!1},[2,(i+=r,e)]):[2,{value:void 0,done:!0}]})})},cancel:function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2]})})},releaseLock:function(){}}}function Ha(t,e){if(t instanceof Uint8Array)return Qa(t,e);if(t instanceof ArrayBuffer)return Qa(new Uint8Array(t),e);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}function Ya(t){return new Xo(t,!0)}var Wa=(Za.prototype.ai=function(){return"metadata"in this.payload},Za),Ka=(Ja._i=function(t,e){return new Ja(Ha(t,10240),e)},Ja.prototype.close=function(){return this.ci.cancel()},Ja.prototype.getMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.metadata.promise]})})},Ja.prototype.fi=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.li())]}})})},Ja.prototype.li=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return[4,this.di()];case 1:return null===(e=t.sent())?[2,null]:(r=this.hi.decode(e),n=Number(r),isNaN(n)&&this.wi("length string ("+r+") is not valid number"),[4,this.mi(n)]);case 2:return r=t.sent(),[2,new Wa(JSON.parse(r),e.length+n)]}})})},Ja.prototype.Ei=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},Ja.prototype.di=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.Ei()<0?[4,this.Ti()]:[3,3];case 1:if(t.sent())return[3,3];t.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.Ei())<0&&this.wi("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),n)])}})})},Ja.prototype.mi=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.buffer.length<n?[4,this.Ti()]:[3,3];case 1:t.sent()&&this.wi("Reached the end of bundle when more is expected."),t.label=2;case 2:return[3,0];case 3:return e=this.hi.decode(this.buffer.slice(0,n)),[2,(this.buffer=this.buffer.slice(n),e)]}})})},Ja.prototype.wi=function(t){throw this.ci.cancel(),new Error("Invalid bundle format: "+t)},Ja.prototype.Ti=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.ci.read()];case 1:return(e=t.sent()).done||((n=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n),[2,e.done]}})})},Ja),Xa=($a.prototype.Ai=function(t){return ss(this.serializer,t)},$a.prototype.Ii=function(t){return t.metadata.exists?(r=ss(e=this.serializer,(n=t.document).name),e=ns(n.updateTime),n=new su({mapValue:{fields:n.fields}}),new yu(r,e,n,{hasCommittedMutations:!1})):new vu(this.Ai(t.metadata.name),this.Ri(t.metadata.readTime));var e,n,r},$a.prototype.Ri=ns,$a);function $a(t){this.serializer=t}function Ja(t,e){var n=this;this.ci=t,this.serializer=e,this.metadata=new da,this.buffer=new Uint8Array,this.hi=new TextDecoder("utf-8"),this.li().then(function(t){t&&t.ai()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function Za(t,e){this.payload=t,this.byteLength=e}function th(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}function eh(t,e){this.progress=t,this.yi=e}var nh=(hh.prototype.pi=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},hh.prototype.gi=function(t){for(var e=new Map,n=new Xa(this.serializer),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.Ai(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var h=a[u],c=(e.get(h)||ao()).add(s);e.set(h,c)}}return e},hh.prototype.complete=function(){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return[4,function(f,p,d){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a,h,c,l;return v(this,function(t){switch(t.label){case 0:for(e=new Xa((n=f).serializer),r=ao(),i=no,o=so,s=0,u=p;s<u.length;s++)a=u[s],h=e.Ai(a.metadata.name),a.document&&(r=r.add(h)),i=i.rt(h,e.Ii(a)),o=o.rt(h,e.Ri(a.metadata.readTime));return c=n.bi.vi({Si:!0}),[4,Ih(n,Ou(Iu(Fr.P("__bundle__/docs/"+d))))];case 1:return l=t.sent(),[2,n.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return Eh(e,c,i,Si.min(),o).next(function(t){return c.apply(e),t}).next(function(t){return n.Ci.Di(e,l.targetId).next(function(){return n.Ci.Ni(e,r,l.targetId)}).next(function(){return n.$i.Fi(e,t)})})})]}})})}(this.Vi,this.documents,this.Pi.id)];case 1:e=t.sent(),n=this.gi(this.documents),r=0,i=this.queries,t.label=2;case 2:return r<i.length?(i=i[r],[4,function(e,i,o){return void 0===o&&(o=ao()),y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return[4,Ih(e,Ou(lh(i.bundledQuery)))];case 1:return n=t.sent(),[2,(r=e).persistence.runTransaction("Save named query","readwrite",function(t){var e=ns(i.readTime);return 0<=n.et.M(e)?r.br.Jr(t,i):(e=n.st(vi.U,e),r.Rr=r.Rr.rt(e.targetId,e),r.Ci.Ur(t,e).next(function(){return r.Ci.Di(t,n.targetId)}).next(function(){return r.Ci.Ni(t,o,n.targetId)}).next(function(){return r.br.Jr(t,i)}))})]}})})}(this.Vi,i,n.get(i.name))]):[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[2,(this.progress.taskState="Success",new eh(Object.assign({},this.progress),e))]}})})},hh),rh=(ah.prototype.ki=function(e,n){var r=this;return this.Oi.Mi(e,n).next(function(t){return r.Ui(e,n,t)})},ah.prototype.Ui=function(t,r,i){return this.Li.qi(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ii(r,t);return t})},ah.prototype.Bi=function(t,e,i){var o=no;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ii(t,e);o=o.rt(t,e)}),o},ah.prototype.Qi=function(e,t){var n=this;return this.Li.getEntries(e,t).next(function(t){return n.Fi(e,t)})},ah.prototype.Fi=function(e,r){var i=this;return this.Oi.ji(e,r).next(function(t){var t=i.Bi(e,r,t),n=no;return t.forEach(function(t,e){e=e||new vu(t,Si.min()),n=n.rt(t,e)}),n})},ah.prototype.Wi=function(t,e,n){return r=e,qr.F(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Gi(t,e.path):Lu(e)?this.zi(t,e,n):this.Ki(t,e,n);var r},ah.prototype.Gi=function(t,e){return this.ki(t,new qr(e)).next(function(t){var e=oo;return t instanceof yu&&(e=e.rt(t.key,t)),e})},ah.prototype.zi=function(n,r,i){var o=this,s=r.collectionGroup,u=oo;return this.xi.Hi(n,s).next(function(t){return va.forEach(t,function(t){var e=(e=r,t=t.child(s),new mu(t,null,e.rn.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.Ki(n,e,i).next(function(t){t.forEach(function(t,e){u=u.rt(t,e)})})}).next(function(){return u})})},ah.prototype.Ki=function(e,n,t){var h,c,r=this;return this.Li.Wi(e,n,t).next(function(t){return h=t,r.Oi.Yi(e,n)}).next(function(t){return c=t,r.Ji(e,c,h).next(function(t){h=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=qs(s,a=h.get(u),a,r.ei);h=a instanceof yu?h.rt(u,a):h.remove(u)}})}).next(function(){return h.forEach(function(t,e){Cu(n,e)||(h=h.remove(t))}),h})},ah.prototype.Ji=function(t,e,n){for(var r=ao(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Ws&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.Li.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof yu&&(h=h.rt(t,e))}),h})},ah),ih=(uh.tr=function(t,e){for(var n=ao(),r=ao(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new uh(t,e.fromCache,n,r)},uh),oh=(sh.ir=function(t){return new sh(t,sh.rr,sh.ur)},sh);function sh(t,e,n){this.er=t,this.nr=e,this.sr=n}function uh(t,e,n,r){this.targetId=t,this.fromCache=e,this.Xi=n,this.Zi=r}function ah(t,e,n){this.Li=t,this.Oi=e,this.xi=n}function hh(t,e,n){this.Pi=t,this.Vi=e,this.serializer=n,this.queries=[],this.documents=[],this.progress=th(t)}function ch(t){this.dr=t}function lh(t){var e=fs({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Du(e,e.limit,"L"):e}oh.ar=-1,oh.cr=1048576,oh.hr=41943040,oh.rr=10,oh.ur=1e3,oh.lr=new oh(oh.hr,oh.rr,oh.ur),oh._r=new oh(oh.ar,0,0);var fh=(wh.prototype.mr=function(t,e){return this.wr.add(e),va.resolve()},wh.prototype.Hi=function(t,e){return va.resolve(this.wr.getEntries(e))},wh),ph=(mh.prototype.add=function(t){var e=t._(),n=t.h(),r=this.index[e]||new to(Fr.i),t=!r.has(n);return this.index[e]=r.add(n),t},mh.prototype.has=function(t){var e=t._(),t=t.h();return(e=this.index[e])&&e.has(t)},mh.prototype.getEntries=function(t){return(this.index[t]||new to(Fr.i)).I()},mh),dh=(gh.prototype.next=function(){return this.Er+=2,this.Er},gh.Tr=function(){return new gh(0)},gh.Ar=function(){return new gh(-1)},gh),yh=(vh.prototype.Cr=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Nr(t,n.Rr)})},vh);function vh(t,e,n,r){this.persistence=t,this.Ir=e,this.serializer=r,this.Rr=new Yi(di),this.yr=new Ri(xi,Fi),this.Pr=Si.min(),this.Oi=t.Vr(n),this.bi=t.pr(),this.Ci=t.gr(),this.$i=new rh(this.bi,this.Oi,this.persistence.vr()),this.br=t.Sr(),this.Ir.Dr(this.$i)}function gh(t){this.Er=t}function mh(){this.index={}}function wh(){this.wr=new ph}function bh(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Ci.Or(t)})}function Eh(t,s,e,u,a){var n=ao();return e.forEach(function(t){return n=n.add(t)}),s.getEntries(t,n).next(function(i){var o=no;return e.forEach(function(t,e){var n=i.get(t),r=(null==a?void 0:a.get(t))||u;e instanceof vu&&e.version.isEqual(Si.min())?(s.jr(t,r),o=o.rt(t,e)):null==n||0<e.version.M(n.version)||0===e.version.M(n.version)&&n.hasPendingWrites?(s.Fr(e,r),o=o.rt(t,e)):Sr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o})}function Ih(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Ci.Gr(e,r).next(function(t){return t?(n=t,va.resolve(n)):i.Ci.zr(e).next(function(t){return n=new Gi(r,t,0,e.Mr),i.Ci.Kr(e,n).next(function(){return n})})})}).then(function(t){var e=i.Rr.get(t.targetId);return(null===e||0<t.et.M(e.et))&&(i.Rr=i.Rr.rt(t.targetId,t),i.yr.set(r,t.targetId)),t})}function Th(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).Rr.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Br.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!wa(r=t.sent()))throw r;return Sr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.Rr=e.Rr.remove(o),e.yr.delete(n.target),[2]}})})}function Ah(t,o,s){var u=t,a=Si.min(),h=ao();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=Ou(o),(void 0!==(t=(i=t).yr.get(r))?va.resolve(i.Rr.get(t)):i.Ci.Gr(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.Ci.Hr(e,t.targetId).next(function(t){h=t})}).next(function(){return u.Ir.Wi(e,o,s?a:Si.min(),s?h:ao())}).next(function(t){return{documents:t,Yr:h}});var t,n,r,i})}function Nh(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Ir.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Sr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Rh(t,e){this.user=e,this.type="OAuth",this.fo={},this.fo.Authorization="Bearer "+t}function Lh(t,e,n,r,i){var o=this;this.Vi=t,this.du=e,this.Ln=n,this.wu={},this.mu=[],this.Eu=new Map,this.Tu=new Set,this.Au=[],this.Iu=i,this.Iu.Ru(function(t){n.Bn(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return uc(this)?(Sr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Tu.add(4),[4,Zh(e)];case 1:return t.sent(),e.yu.set("Unknown"),e.Tu.delete(4),[4,Jh(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.yu=new jh(n,r)}var Sh,Oh,Dh,Vh=($h.prototype.m=function(){return this.Xr.m()},$h.prototype.so=function(t,e){e=new _h(t,e),this.Xr=this.Xr.add(e),this.eo=this.eo.add(e)},$h.prototype.io=function(t,e){var n=this;t.forEach(function(t){return n.so(t,e)})},$h.prototype.ro=function(t,e){this.oo(new _h(t,e))},$h.prototype.uo=function(t,e){var n=this;t.forEach(function(t){return n.ro(t,e)})},$h.prototype.ao=function(t){var e=this,n=new qr(new Fr([])),r=new _h(n,t),t=new _h(n,t+1),i=[];return this.eo.Nt([r,t],function(t){e.oo(t),i.push(t.key)}),i},$h.prototype.co=function(){var e=this;this.Xr.forEach(function(t){return e.oo(t)})},$h.prototype.oo=function(t){this.Xr=this.Xr.delete(t),this.eo=this.eo.delete(t)},$h.prototype.ho=function(t){var e=new qr(new Fr([])),n=new _h(e,t),t=new _h(e,t+1),r=ao();return this.eo.Nt([n,t],function(t){r=r.add(t.key)}),r},$h.prototype.lo=function(t){var e=new _h(t,0);return null!==(e=this.Xr.$t(e))&&t.isEqual(e.key)},$h),_h=(Xh.Zr=function(t,e){return qr.i(t.key,e.key)||di(t._o,e._o)},Xh.no=function(t,e){return di(t._o,e._o)||qr.i(t.key,e.key)},Xh),kh=(Kh.prototype.getToken=function(){return Promise.resolve(null)},Kh.prototype.mo=function(){},Kh.prototype.Eo=function(t){(this.wo=t)(_a.UNAUTHENTICATED)},Kh.prototype.To=function(){this.wo=null},Kh),Uh=(Wh.prototype.getToken=function(){var e=this,n=this.Ro,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.Ro!==n?(Sr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(kr("string"==typeof t.accessToken),new Rh(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Wh.prototype.mo=function(){this.forceRefresh=!0},Wh.prototype.Eo=function(t){this.wo=t,this.Io&&t(this.currentUser)},Wh.prototype.To=function(){this.auth&&this.auth.removeAuthTokenListener(this.Ao),this.Ao=null,this.wo=null},Wh.prototype.yo=function(){var t=this.auth&&this.auth.getUid();return kr(null===t||"string"==typeof t),new _a(t)},Wh),Ph=(Object.defineProperty(Yh.prototype,"fo",{get:function(){var t={"X-Goog-AuthUser":this.Vo},e=this.Po.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Yh),Ch=(Hh.prototype.getToken=function(){return Promise.resolve(new Ph(this.Po,this.Vo))},Hh.prototype.Eo=function(t){t(_a.Ds)},Hh.prototype.To=function(){},Hh.prototype.mo=function(){},Hh),l=(Qh.prototype.Co=function(){return 1===this.state||2===this.state||4===this.state},Qh.prototype.No=function(){return 2===this.state},Qh.prototype.start=function(){3!==this.state?this.auth():this.Fo()},Qh.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Co()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Qh.prototype.$o=function(){this.state=0,this.Yn.reset()},Qh.prototype.Lo=function(){var t=this;this.No()&&null===this.Do&&(this.Do=this.ln.yn(this.po,6e4,function(){return t.Oo()}))},Qh.prototype.xo=function(t){this.ko(),this.stream.send(t)},Qh.prototype.Oo=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.No()?[2,this.close(0)]:[2]})})},Qh.prototype.ko=function(){this.Do&&(this.Do.cancel(),this.Do=null)},Qh.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.ko(),this.Yn.cancel(),this.So++,3!==e?this.Yn.reset():n&&n.code===Ir.RESOURCE_EXHAUSTED?(Or(n.toString()),Or("Using maximum backoff delay to prevent overloading the backend."),this.Yn.An()):n&&n.code===Ir.UNAUTHENTICATED&&this.bo.mo(),null!==this.stream&&(this.Mo(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Uo(n)];case 1:return t.sent(),[2]}})})},Qh.prototype.Mo=function(){},Qh.prototype.auth=function(){var n=this;this.state=1;var t=this.qo(this.So),e=this.So;this.bo.getToken().then(function(t){n.So===e&&n.Bo(t)},function(e){t(function(){var t=new Tr(Ir.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Qo(t)})})},Qh.prototype.Bo=function(t){var e=this,n=this.qo(this.So);this.stream=this.jo(t),this.stream.Wo(function(){n(function(){return e.state=2,e.listener.Wo()})}),this.stream.Uo(function(t){n(function(){return e.Qo(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Qh.prototype.Fo=function(){var t=this;this.state=4,this.Yn.In(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},Qh.prototype.Qo=function(t){return Sr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Qh.prototype.qo=function(e){var n=this;return function(t){n.ln.Bn(function(){return n.So===e?t():(Sr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Qh),Mh=(n(zh,Dh=l),zh.prototype.jo=function(t){return this.vo.Go("Listen",t)},zh.prototype.onMessage=function(t){this.Yn.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:_r(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Be?(kr(void 0===o||"string"==typeof o),vi.fromBase64String(o||"")):(kr(void 0===o||o instanceof Uint8Array),vi.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Ir.UNKNOWN:Hi(s.code),new Tr(o,s.message||"")),r=new mo(n,r,i,s||null)}else if("documentChange"in e){e.documentChange,(a=e.documentChange).document,a.document.name,a.document.updateTime;var i=ss(t,a.document.name),u=ns(a.document.updateTime),s=new su({mapValue:{fields:a.document.fields}}),u=new yu(i,u,s,{}),s=a.targetIds||[],a=a.removedTargetIds||[];r=new vo(s,a,u.key,u)}else if("documentDelete"in e){e.documentDelete,(a=e.documentDelete).document;var u=ss(t,a.document),h=a.readTime?ns(a.readTime):Si.min(),h=new vu(u,h),a=a.removedTargetIds||[];r=new vo([],a,h.key,h)}else if("documentRemove"in e){e.documentRemove,(h=e.documentRemove).document;var c=ss(t,h.document),h=h.removedTargetIds||[];r=new vo([],h,c,null)}else{if(!("filter"in e))return _r();e.filter,(c=e.filter).targetId,e=new Bi(e=c.count||0),c=c.targetId,r=new go(c,e)}return r}(this.serializer,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?Si.min():ns(e.readTime);return this.listener.zo(n,t)},zh.prototype.Ko=function(t){var e,n,r,i,o,s,u,a,h={};h.database=as(this.serializer),h.addTarget=(e=this.serializer,(r=ji(r=(n=t).target)?{documents:{documents:[us(e,r.path)]}}:{query:(i=e,s={structuredQuery:{}},u=(o=r).path,null!==o.collectionGroup?(s.parent=us(i,u),s.structuredQuery.from=[{collectionId:o.collectionGroup,allDescendants:!0}]):(s.parent=us(i,u.h()),s.structuredQuery.from=[{collectionId:u._()}]),(u=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(Ho(t.value))return{unaryFilter:{field:ys(t.field),op:"IS_NAN"}};if(Qo(t.value))return{unaryFilter:{field:ys(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Ho(t.value))return{unaryFilter:{field:ys(t.field),op:"IS_NOT_NAN"}};if(Qo(t.value))return{unaryFilter:{field:ys(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ys(t.field),op:(e=t.op,Ko[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(o.filters))&&(s.structuredQuery.where=u),(u=function(t){if(0!==t.length)return t.map(function(t){return{field:ys((t=t).field),direction:(t=t.dir,Wo[t])}})}(o.orderBy))&&(s.structuredQuery.orderBy=u),u=o.limit,null!==(u=i.Be||Ui(u)?u:{value:u})&&(s.structuredQuery.limit=u),o.startAt&&(s.structuredQuery.startAt=ps(o.startAt)),o.endAt&&(s.structuredQuery.endAt=ps(o.endAt)),s)}).targetId=n.targetId,0<n.resumeToken.k()?r.resumeToken=es(e,n.resumeToken):0<n.et.M(Si.min())&&(r.readTime=ts(e,n.et.X())),r),(t=(this.serializer,a=t,null==(t=function(){switch(a.tt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return _r()}}())?null:{"goog-listen-tags":t}))&&(h.labels=t),this.xo(h)},zh.prototype.Ho=function(t){var e={};e.database=as(this.serializer),e.removeTarget=t,this.xo(e)},zh),xh=(n(Gh,Oh=l),Object.defineProperty(Gh.prototype,"Jo",{get:function(){return this.Yo},enumerable:!1,configurable:!0}),Gh.prototype.start=function(){this.Yo=!1,this.lastStreamToken=void 0,Oh.prototype.start.call(this)},Gh.prototype.Mo=function(){this.Yo&&this.Xo([])},Gh.prototype.jo=function(t){return this.vo.Go("Write",t)},Gh.prototype.onMessage=function(t){if(kr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Yo){this.Yn.reset();var e=(n=t.writeResults,i=t.commitTime,n&&0<n.length?(kr(void 0!==i),n.map(function(t){return n=i,(r=(e=t).updateTime?ns(e.updateTime):ns(n)).isEqual(Si.min())&&(r=ns(n)),n=null,e.transformResults&&0<e.transformResults.length&&(n=e.transformResults),new xs(r,n);var e,n,r})):[]),n=ns(t.commitTime);return this.listener.Zo(n,e)}var i;return kr(!t.writeResults||0===t.writeResults.length),this.Yo=!0,this.listener.tu()},Gh.prototype.eu=function(){var t={};t.database=as(this.serializer),this.xo(t)},Gh.prototype.Xo=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return ls(e.serializer,t)})};this.xo(t)},Gh),Fh=(n(qh,Sh=function(){}),qh.prototype.su=function(){if(this.nu)throw new Tr(Ir.FAILED_PRECONDITION,"The client has already been terminated.")},qh.prototype.iu=function(e,n,r){var i=this;return this.su(),this.credentials.getToken().then(function(t){return i.vo.iu(e,n,r,t)}).catch(function(t){throw t.code===Ir.UNAUTHENTICATED&&i.credentials.mo(),t})},qh.prototype.ru=function(e,n,r){var i=this;return this.su(),this.credentials.getToken().then(function(t){return i.vo.ru(e,n,r,t)}).catch(function(t){throw t.code===Ir.UNAUTHENTICATED&&i.credentials.mo(),t})},qh.prototype.terminate=function(){this.nu=!1},qh),jh=(Bh.prototype.cu=function(){var t=this;0===this.ou&&(this.hu("Unknown"),this.uu=this.Ln.yn("online_state_timeout",1e4,function(){return t.uu=null,t.lu("Backend didn't respond within 10 seconds."),t.hu("Offline"),Promise.resolve()}))},Bh.prototype._u=function(t){"Online"===this.state?this.hu("Unknown"):(this.ou++,1<=this.ou&&(this.fu(),this.lu("Connection failed 1 times. Most recent error: "+t.toString()),this.hu("Offline")))},Bh.prototype.set=function(t){this.fu(),this.ou=0,"Online"===t&&(this.au=!1),this.hu(t)},Bh.prototype.hu=function(t){t!==this.state&&(this.state=t,this.qs(t))},Bh.prototype.lu=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.au?(Or(t),this.au=!1):Sr("OnlineStateTracker",t)},Bh.prototype.fu=function(){null!==this.uu&&(this.uu.cancel(),this.uu=null)},Bh);function Bh(t,e){this.Ln=t,this.qs=e,this.state="Unknown",this.ou=0,this.uu=null,this.au=!0}function qh(t,e,n){var r=this;return(r=Sh.call(this)||this).credentials=t,r.vo=e,r.serializer=n,r.nu=!1,r}function Gh(t,e,n,r,i){var o=this;return(o=Oh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Yo=!1,o}function zh(t,e,n,r,i){var o=this;return(o=Dh.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Qh(t,e,n,r,i,o){this.ln=t,this.po=n,this.vo=r,this.bo=i,this.listener=o,this.state=0,this.So=0,this.Do=null,this.stream=null,this.Yn=new ya(t,e)}function Hh(t,e){this.Po=t,this.Vo=e}function Yh(t,e){this.Po=t,this.Vo=e,this.type="FirstParty",this.user=_a.Ds}function Wh(t){var e=this;this.Ao=null,this.currentUser=_a.UNAUTHENTICATED,this.Io=!1,this.Ro=0,this.wo=null,this.forceRefresh=!1,this.Ao=function(){e.Ro++,e.currentUser=e.yo(),e.Io=!0,e.wo&&e.wo(e.currentUser)},this.Ro=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Ao):(this.Ao(null),t.get().then(function(t){e.auth=t,e.Ao&&e.auth.addAuthTokenListener(e.Ao)},function(){}))}function Kh(){this.wo=null}function Xh(t,e){this.key=t,this._o=e}function $h(){this.Xr=new to(_h.Zr),this.eo=new to(_h.no)}function Jh(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!uc(r))return[3,4];e=0,n=r.Au,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Zh(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.Au,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function tc(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Sr("RemoteStore","RemoteStore shutting down."),e.Tu.add(5),[4,Zh(e)];case 1:return t.sent(),e.Iu.Zs(),e.yu.set("Unknown"),[2]}})})}function ec(t,e){t.Eu.has(e.targetId)||(t.Eu.set(e.targetId,e),sc(t)?oc(t):dc(t).No()&&rc(t,e))}function nc(t,e){var n=t,t=dc(n);n.Eu.delete(e),t.No()&&ic(n,e),0===n.Eu.size&&(t.No()?t.Lo():uc(n)&&n.yu.set("Unknown"))}function rc(t,e){t.Pu.Te(e.targetId),dc(t).Ko(e)}function ic(t,e){t.Pu.Te(e),dc(t).Ho(e)}function oc(e){e.Pu=new bo({Ue:function(t){return e.wu.Ue(t)},qe:function(t){return e.Eu.get(t)||null}}),dc(e).start(),e.yu.cu()}function sc(t){return uc(t)&&!dc(t).Co()&&0<t.Eu.size}function uc(t){return 0===t.Tu.size}function ac(t){t.Pu=void 0}function hc(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!wa(r))throw r;return n.Tu.add(1),[4,Zh(n)];case 1:return t.sent(),n.yu.set("Offline"),i=i||function(){return bh(n.Vi)},n.Ln.ss(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Sr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Tu.delete(1),[4,Jh(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function cc(e,n){return n().catch(function(t){return hc(e,t,n)})}function lc(c){return y(this,void 0,void 0,function(){var s,u,a,h;return v(this,function(t){switch(t.label){case 0:u=yc(s=c),a=0<s.mu.length?s.mu[s.mu.length-1].batchId:-1,t.label=1;case 1:if(!(uc(s)&&s.mu.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(r=s.Vi,i=a,(o=r).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===i&&(i=-1),o.Oi.Wr(t,i)}))];case 3:return null===(h=t.sent())?(0===s.mu.length&&u.Lo(),[3,7]):(a=h.batchId,n=h,(e=s).mu.push(n),(e=yc(e)).No()&&e.Jo&&e.Xo(n.mutations),[3,6]);case 4:return h=t.sent(),[4,hc(s,h)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return fc(s)&&pc(s),[2]}var e,n,r,i,o})})}function fc(t){return uc(t)&&!yc(t).Co()&&0<t.mu.length}function pc(t){yc(t).start()}function dc(n){var t,e,r,i=this;return n.bu||(n.bu=(t=n.du,e=n.Ln,r={Wo:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Eu.forEach(function(t,e){rc(n,t)}),[2]})})}.bind(null,n),Uo:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return ac(e),sc(e)?(e.yu._u(n),oc(e)):e.yu.set("Unknown"),[2]})})}.bind(null,n),zo:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.yu.set("Online"),!(u instanceof mo&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Eu.has(i)?[4,o.wu.Vu(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Eu.delete(i),o.Pu.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Sr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,hc(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof vo?s.Pu.ge(u):u instanceof go?s.Pu.$e(u):s.Pu.Se(u),a.isEqual(Si.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,bh(s.Vi)];case 8:return o=t.sent(),0<=a.M(o)?[4,(i=a,(e=(r=s).Pu.xe(i)).zt.forEach(function(t,e){var n;0<t.resumeToken.k()&&(n=r.Eu.get(e))&&r.Eu.set(e,n.st(t.resumeToken,i))}),e.Kt.forEach(function(t){var e=r.Eu.get(t);e&&(r.Eu.set(t,e.st(vi.U,e.et)),ic(r,t),e=new Gi(e.target,t,1,e.sequenceNumber),rc(r,e))}),r.wu.pu(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Sr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,hc(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},t.su(),new Mh(e,t.vo,t.credentials,t.serializer,r)),n.Au.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.bu.$o(),sc(n)?oc(n):n.yu.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.bu.stop()];case 2:t.sent(),ac(n),t.label=3;case 3:return[2]}})})})),n.bu}function yc(n){var t,e,r,i=this;return n.Su||(n.Su=(t=n.du,e=n.Ln,r={Wo:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return yc(e).eu(),[2]})})}.bind(null,n),Uo:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&yc(e).Jo?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Qi(n=i.code)&&n!==Ir.ABORTED?(e=r.mu.shift(),yc(r).$o(),[4,cc(r,function(){return r.wu.vu(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,lc(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return fc(e)&&pc(e),[2]}})})}.bind(null,n),tu:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=yc(o),n=0,r=o.mu;n<r.length;n++)i=r[n],e.Xo(i.mutations);return[2]})})}.bind(null,n),Zo:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.mu.shift(),n=ja.from(e,i,o),[4,cc(r,function(){return r.wu.gu(n)})];case 1:return t.sent(),[4,lc(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.su(),new xh(e,t.vo,t.credentials,t.serializer,r)),n.Au.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Su.$o(),[4,lc(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Su.stop()];case 3:t.sent(),0<n.mu.length&&(Sr("RemoteStore","Stopping write stream with "+n.mu.length+" pending writes"),n.mu=[]),t.label=4;case 4:return[2]}})})})),n.Su}function vc(t,e,n){this.query=t,this.targetId=e,this.view=n}var gc=function(t){this.key=t},mc=function(t){this.key=t},wc=(Object.defineProperty(Tc.prototype,"Lu",{get:function(){return this.Du},enumerable:!1,configurable:!0}),Tc.prototype.Ou=function(t,e){var s=this,u=e?e.xu:new lo,a=(e||this).$u,h=(e||this).Qt,c=a,l=!1,f=Tu(this.query)&&a.size===this.query.limit?a.last():null,p=Au(this.query)&&a.size===this.query.limit?a.first():null;if(t.ct(function(t,e){var n=a.get(t),r=(r=e instanceof yu?e:null)&&(Cu(s.query,r)?r:null),i=!!n&&s.Qt.has(n.key),o=!!r&&(r.Ye||s.Qt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.ku(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.Fu(r,f)||p&&s.Fu(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(h=r?(c=c.add(r),o?h.add(t):h.delete(t)):(c=c.delete(t),h.delete(t)))}),Tu(this.query)||Au(this.query))for(;c.size>this.query.limit;){var n=Tu(this.query)?c.last():c.first(),c=c.delete(n.key),h=h.delete(n.key);u.track({type:1,doc:n})}return{$u:c,xu:u,Mu:l,Qt:h}},Tc.prototype.ku=function(t,e){return t.Ye&&e.hasCommittedMutations&&!e.Ye},Tc.prototype.Uu=function(t,e,n){var o=this,r=this.$u;this.$u=t.$u,this.Qt=t.Qt;var i=t.xu.qt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.Fu(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _r()}}var r,i}),this.qu(n);var s=e?this.Bu():[],e=(n=0===this.Nu.size&&this.Zt?1:0)!==this.Cu;return this.Cu=n,0!==i.length||e?{snapshot:new fo(this.query,t.$u,r,i,t.Qt,0==n,e,!1),Qu:s}:{Qu:s}},Tc.prototype.Es=function(t){return this.Zt&&"Offline"===t?(this.Zt=!1,this.Uu({$u:this.$u,xu:new lo,Qt:this.Qt,Mu:!1},!1)):{Qu:[]}},Tc.prototype.ju=function(t){return!this.Du.has(t)&&!!this.$u.has(t)&&!this.$u.get(t).Ye},Tc.prototype.qu=function(t){var e=this;t&&(t.te.forEach(function(t){return e.Du=e.Du.add(t)}),t.ee.forEach(function(t){}),t.ne.forEach(function(t){return e.Du=e.Du.delete(t)}),this.Zt=t.Zt)},Tc.prototype.Bu=function(){var e=this;if(!this.Zt)return[];var n=this.Nu;this.Nu=ao(),this.$u.forEach(function(t){e.ju(t.key)&&(e.Nu=e.Nu.add(t.key))});var r=[];return n.forEach(function(t){e.Nu.has(t)||r.push(new mc(t))}),this.Nu.forEach(function(t){n.has(t)||r.push(new gc(t))}),r},Tc.prototype.Wu=function(t){return this.Du=t.Yr,this.Nu=ao(),t=this.Ou(t.documents),this.Uu(t,!0)},Tc.prototype.Gu=function(){return fo.Gt(this.query,this.$u,this.Qt,0===this.Cu)},Tc),bc=function(t){this.key=t,this.zu=!1},Ec=(Object.defineProperty(Ic.prototype,"ca",{get:function(){return!0===this.aa},enumerable:!1,configurable:!0}),Ic);function Ic(t,e,n,r,i,o){this.Vi=t,this.Ku=e,this.Hu=n,this.Yu=r,this.currentUser=i,this.Ju=o,this.Xu={},this.Zu=new Ri(Uu,ku),this.ta=new Map,this.ea=[],this.na=new Yi(qr.i),this.sa=new Map,this.ia=new Vh,this.ra={},this.oa=new Map,this.ua=dh.Ar(),this.onlineState="Unknown",this.aa=void 0}function Tc(t,e){this.query=t,this.Du=e,this.Cu=null,this.Zt=!1,this.Nu=ao(),this.Qt=ao(),this.Fu=Mu(t),this.$u=new co(this.Fu)}function Ac(f,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:(o=f).Ku.wu.gu=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Vi,c=s,(l=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=c.batch.keys(),n=l.bi.vi({Si:!0}),i=l,o=t,s=n,u=(r=c).batch,a=u.keys(),h=va.resolve();return a.forEach(function(n){h=h.next(function(){return s.qi(o,n)}).next(function(t){var e=t;kr(null!==(t=r.ui.get(n))),(!e||e.version.M(t)<0)&&(e=u.ni(n,e,r))&&s.Fr(e,r.oi)})}),h.next(function(){return i.Oi.$r(o,u)}).next(function(){return n.apply(t)}).next(function(){return l.Oi.Lr(t)}).next(function(){return l.$i.Qi(t,e)})}))];case 2:return i=t.sent(),Sc(n,r,null),Lc(n,r),n.Yu.Qs(r,"acknowledged"),[4,kc(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,Nh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,c,l})})}.bind(null,o),o.Ku.wu.vu=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Vi,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Oi.da(e,r).next(function(t){return kr(null!==t),n=t.keys(),i.Oi.$r(e,t)}).next(function(){return i.Oi.Lr(e)}).next(function(){return i.$i.Qi(e,n)})}))];case 2:return o=t.sent(),Sc(n,u,a),Lc(n,u),n.Yu.Qs(u,"rejected",a),[4,kc(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Nh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.Vi,a=p,c=r,l=Li.now(),i=a.reduce(function(t,e){return t.add(e.key)},ao()),c.persistence.runTransaction("Locally write mutations","readwrite",function(u){return c.$i.Qi(u,i).next(function(t){h=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=h.get(i.key),s instanceof Zs?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof yu?t.field(i.field):void 0;null!=(o=ms(i.transform,o||null))&&(e=(null==e?new uu:e).set(i.field,o))}return e?e.Je():null}(o):null);null!=o&&e.push(new Ws(i.key,o,function s(t){var u=[];return Pr(t.fields||{},function(t,e){var n=new Br([t]);if(Yo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Cs(u)}(o.proto.mapValue),Fs.exists(!0)))}return c.Oi._a(u,l,e,a)})}).then(function(t){var e=t.ri(h);return{batchId:t.batchId,fa:e}}))];case 2:return s=t.sent(),u.Yu.Bs(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.ra[e.currentUser.bs()])||new Yi(di)).rt(n,o),e.ra[e.currentUser.bs()]=r,[4,kc(u,s.fa)];case 3:return t.sent(),[4,lc(u.Ku)];case 4:return t.sent(),[3,6];case 5:return u=Na(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,h,c,l,i,o})})}function Nc(o,s){return y(this,void 0,void 0,function(){var n,i;return v(this,function(t){switch(t.label){case 0:n=o,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Vi,a=e,h=(r=s).et,c=a.Rr,a.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=a.bi.vi({Si:!0});c=a.Rr;var u=[];r.zt.forEach(function(t,e){var n,r,i,o=c.get(e);o&&(u.push(a.Ci.kr(s,t.ne,e).next(function(){return a.Ci.Ni(s,t.te,e)})),0<(i=t.resumeToken).k()&&(n=o.st(i,h).nt(s.Mr),c=c.rt(e,n),r=o,i=t,kr(0<(o=n).resumeToken.k()),(0===r.resumeToken.k()||3e8<=o.et.J()-r.et.J()||0<i.te.size+i.ee.size+i.ne.size)&&u.push(a.Ci.Ur(s,n))))});var e,n=no;return r.Ht.forEach(function(t,e){r.Yt.has(t)&&u.push(a.persistence.Br.qr(s,t))}),u.push(Eh(s,t,r.Ht,h,void 0).next(function(t){n=t})),h.isEqual(Si.min())||(e=a.Ci.Or(s).next(function(t){return a.Ci.Qr(s,s.Mr,h)}),u.push(e)),va.Fn(u).next(function(){return t.apply(s)}).next(function(){return a.$i.Fi(s,n)})}).then(function(t){return a.Rr=c,t}))];case 2:return i=t.sent(),s.zt.forEach(function(t,e){(e=n.sa.get(e))&&(kr(t.te.size+t.ee.size+t.ne.size<=1),0<t.te.size?e.zu=!0:0<t.ee.size?kr(e.zu):0<t.ne.size&&(kr(e.zu),e.zu=!1))}),[4,kc(n,i,s)];case 3:return t.sent(),[3,6];case 4:return[4,Nh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,a,h,c})})}function Rc(t,n,e){var r;((t=t).ca&&0===e||!t.ca&&1===e)&&(r=[],t.Zu.forEach(function(t,e){(e=e.view.Es(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Es(i)&&(o=!0)}),o&&Da(t)}(t.Hu,n),r.length&&t.Xu.zo(r),t.onlineState=n,t.ca&&t.Yu.Xs(n))}function Lc(t,e){(t.oa.get(e)||[]).forEach(function(t){t.resolve()}),t.oa.delete(e)}function Sc(t,e,n){var r=t,i=r.ra[r.currentUser.bs()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.ra[r.currentUser.bs()]=i)}function Oc(e,t,n){void 0===n&&(n=null),e.Yu.Gs(t);for(var r=0,i=e.ta.get(t);r<i.length;r++){var o=i[r];e.Zu.delete(o),n&&e.Xu.ha(o,n)}e.ta.delete(t),e.ca&&e.ia.ao(t).forEach(function(t){e.ia.lo(t)||Dc(e,t)})}function Dc(t,e){var n=t.na.get(e);null!==n&&(nc(t.Ku,n),t.na=t.na.remove(e),t.sa.delete(n),_c(t))}function Vc(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof gc?(t.ia.so(u.key,e),r=t,i=(i=u).key,r.na.get(i)||(Sr("SyncEngine","New document in limbo: "+i),r.ea.push(i),_c(r))):u instanceof mc?(Sr("SyncEngine","Document no longer in limbo: "+u.key),t.ia.ro(u.key,e),t.ia.lo(u.key)||Dc(t,u.key)):_r()}}function _c(t){for(;0<t.ea.length&&t.na.size<t.Ju;){var e=t.ea.shift(),n=t.ua.next();t.sa.set(n,new bc(e)),t.na=t.na.rt(e,n),ec(t.Ku,new Gi(Ou(Iu(e.path)),n,2,Pa.Ls))}}function kc(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).Zu.m()?[3,3]:(n.Zu.forEach(function(t,e){o.push(n.la(e,s,u).then(function(t){t&&(n.ca&&n.Yu.Ws(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=ih.tr(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.Xu.zo(r),[4,function(a,h){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return va.forEach(h,function(e){return va.forEach(e.Xi,function(t){return r.persistence.Br.so(n,e.targetId,t)}).next(function(){return va.forEach(e.Zi,function(t){return r.persistence.Br.ro(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!wa(e=t.sent()))throw e;return Sr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=h;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.Rr.get(o),u=s.et,u=s.it(u),r.Rr=r.Rr.rt(o,u));return[2]}})})}(n.Vi,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}var Uc,Pc,Cc,Mc,xc,Fc=(Sl.prototype.Dr=function(t){this.pa=t},Sl.prototype.Wi=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.rn.length||1===r.rn.length&&r.rn[0].field.g())||i.isEqual(Si.min())?this.ga(e,r):this.pa.Qi(e,o).next(function(t){var n=s.va(r,t);return(Tu(r)||Au(r))&&s.Mu(r.limitType,n,o,i)?s.ga(e,r):(Lr()<=u.DEBUG&&Sr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Pu(r)),s.pa.Wi(e,r,i).next(function(e){return n.forEach(function(t){e=e.rt(t.key,t)}),e}))})},Sl.prototype.va=function(n,t){var r=new to(Mu(n));return t.forEach(function(t,e){e instanceof yu&&Cu(n,e)&&(r=r.add(e))}),r},Sl.prototype.Mu=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.M(r))},Sl.prototype.ga=function(t,e){return Lr()<=u.DEBUG&&Sr("IndexFreeQueryEngine","Using full collection scan to execute query:",Pu(e)),this.pa.Wi(t,e,Si.min())},Sl),jc=(Ll.prototype.Da=function(t){return va.resolve(0===this.Oi.length)},Ll.prototype._a=function(t,e,n,r){var i=this.ba;this.ba++,0<this.Oi.length&&this.Oi[this.Oi.length-1],n=new Fa(i,e,n,r),this.Oi.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Sa=this.Sa.add(new _h(u.key,i)),this.xi.mr(t,u.key.path.h())}return va.resolve(n)},Ll.prototype.da=function(t,e){return va.resolve(this.Ca(e))},Ll.prototype.Wr=function(t,e){return e+=1,e=(e=this.Na(e))<0?0:e,va.resolve(this.Oi.length>e?this.Oi[e]:null)},Ll.prototype.wa=function(){return va.resolve(0===this.Oi.length?-1:this.ba-1)},Ll.prototype.ma=function(t){return va.resolve(this.Oi.slice())},Ll.prototype.Mi=function(t,e){var n=this,r=new _h(e,0),e=new _h(e,Number.POSITIVE_INFINITY),i=[];return this.Sa.Nt([r,e],function(t){t=n.Ca(t._o),i.push(t)}),va.resolve(i)},Ll.prototype.ji=function(t,e){var n=this,r=new to(di);return e.forEach(function(t){var e=new _h(t,0),t=new _h(t,Number.POSITIVE_INFINITY);n.Sa.Nt([e,t],function(t){r=r.add(t._o)})}),va.resolve(this.Fa(r))},Ll.prototype.Yi=function(t,e){var n=e.path,r=n.length+1,e=n;qr.F(e)||(e=e.child(""));var e=new _h(new qr(e),0),i=new to(di);return this.Sa.Ft(function(t){var e=t.key.path;return!!n.T(e)&&(e.length===r&&(i=i.add(t._o)),!0)},e),va.resolve(this.Fa(i))},Ll.prototype.Fa=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.Ca(t))&&n.push(t)}),n},Ll.prototype.$r=function(n,r){var i=this;kr(0===this.$a(r.batchId,"removed")),this.Oi.shift();var o=this.Sa;return va.forEach(r.mutations,function(t){var e=new _h(t.key,r.batchId);return o=o.delete(e),i.Br.La(n,t.key)}).next(function(){i.Sa=o})},Ll.prototype.Oa=function(t){},Ll.prototype.lo=function(t,e){var n=new _h(e,0),n=this.Sa.$t(n);return va.resolve(e.isEqual(n&&n.key))},Ll.prototype.Lr=function(t){return this.Oi.length,va.resolve()},Ll.prototype.$a=function(t,e){return this.Na(t)},Ll.prototype.Na=function(t){return 0===this.Oi.length?0:t-this.Oi[0].batchId},Ll.prototype.Ca=function(t){return(t=this.Na(t))<0||t>=this.Oi.length?null:this.Oi[t]},Ll),Bc=(Rl.prototype.Fr=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.xa(e);return this.docs=this.docs.rt(r,{ka:e,size:o,readTime:n}),this.size+=o-i,this.xi.mr(t,r.path.h())},Rl.prototype.jr=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Rl.prototype.qi=function(t,e){return e=this.docs.get(e),va.resolve(e?e.ka:null)},Rl.prototype.getEntries=function(t,e){var n=this,r=no;return e.forEach(function(t){var e=n.docs.get(t);r=r.rt(t,e?e.ka:null)}),va.resolve(r)},Rl.prototype.Wi=function(t,e,n){for(var r=oo,i=new qr(e.path.child("")),o=this.docs._t(i);o.At();){var s=(u=o.Tt()).key,u=(a=u.value).ka,a=a.readTime;if(!e.path.T(s.path))break;a.M(n)<=0||u instanceof yu&&Cu(e,u)&&(r=r.rt(u.key,u))}return va.resolve(r)},Rl.prototype.Ma=function(t,e){return va.forEach(this.docs,function(t){return e(t)})},Rl.prototype.vi=function(t){return new qc(this)},Rl.prototype.Ua=function(t){return va.resolve(this.size)},Rl),qc=(Nl.prototype.Ba=function(t){return(t=this.fa.get(t))?t.readTime:Si.min()},Nl.prototype.Fr=function(t,e){this.Qa(),this.fa.set(t.key,{ka:t,readTime:e})},Nl.prototype.jr=function(t,e){void 0===e&&(e=null),this.Qa(),this.fa.set(t,{ka:null,readTime:e})},Nl.prototype.qi=function(t,e){this.Qa();var n=this.fa.get(e);return void 0!==n?va.resolve(n.ka):this.ja(t,e)},Nl.prototype.getEntries=function(t,e){return this.Wa(t,e)},Nl.prototype.apply=function(t){return this.Qa(),this.qa=!0,this.Uu(t)},Nl.prototype.Qa=function(){},n(Al,xc=Nl),Al.prototype.Uu=function(n){var r=this,i=[];return this.fa.forEach(function(t,e){e&&e.ka?i.push(r.Ga.Fr(n,e.ka,r.Ba(t))):r.Ga.jr(t)}),va.Fn(i)},Al.prototype.ja=function(t,e){return this.Ga.qi(t,e)},Al.prototype.Wa=function(t,e){return this.Ga.getEntries(t,e)},Al),Gc=(Tl.prototype.De=function(t,n){return this.za.forEach(function(t,e){return n(e)}),va.resolve()},Tl.prototype.Or=function(t){return va.resolve(this.lastRemoteSnapshotVersion)},Tl.prototype.Ja=function(t){return va.resolve(this.Ka)},Tl.prototype.zr=function(t){return this.highestTargetId=this.Ya.next(),va.resolve(this.highestTargetId)},Tl.prototype.Qr=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Ka&&(this.Ka=e),va.resolve()},Tl.prototype.Xa=function(t){this.za.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Ya=new dh(e),this.highestTargetId=e),t.sequenceNumber>this.Ka&&(this.Ka=t.sequenceNumber)},Tl.prototype.Kr=function(t,e){return this.Xa(e),this.targetCount+=1,va.resolve()},Tl.prototype.Ur=function(t,e){return this.Xa(e),va.resolve()},Tl.prototype.Za=function(t,e){return this.za.delete(e.target),this.Ha.ao(e.targetId),--this.targetCount,va.resolve()},Tl.prototype.tc=function(n,r,i){var o=this,s=0,u=[];return this.za.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.za.delete(t),u.push(o.Di(n,e.targetId)),s++)}),va.Fn(u).next(function(){return s})},Tl.prototype.ec=function(t){return va.resolve(this.targetCount)},Tl.prototype.Gr=function(t,e){return e=this.za.get(e)||null,va.resolve(e)},Tl.prototype.Ni=function(t,e,n){return this.Ha.io(e,n),va.resolve()},Tl.prototype.kr=function(e,t,n){this.Ha.uo(t,n);var r=this.persistence.Br,i=[];return r&&t.forEach(function(t){i.push(r.La(e,t))}),va.Fn(i)},Tl.prototype.Di=function(t,e){return this.Ha.ao(e),va.resolve()},Tl.prototype.Hr=function(t,e){return e=this.Ha.ho(e),va.resolve(e)},Tl.prototype.lo=function(t,e){return va.resolve(this.Ha.lo(e))},Tl),zc=(Il.prototype.Ia=function(t,e){return va.resolve(this.nc.get(e))},Il.prototype.Pa=function(t,e){return this.nc.set(e.id,{id:e.id,version:e.version,createTime:ns(e.createTime)}),va.resolve()},Il.prototype.ic=function(t,e){return va.resolve(this.sc.get(e))},Il.prototype.Jr=function(t,e){return this.sc.set(e.name,{name:(e=e).name,query:lh(e.bundledQuery),readTime:ns(e.readTime)}),va.resolve()},Il),Qc=(El.prototype.start=function(){return Promise.resolve()},El.prototype.Zs=function(){return this.uc=!1,Promise.resolve()},Object.defineProperty(El.prototype,"cc",{get:function(){return this.uc},enumerable:!1,configurable:!0}),El.prototype.hc=function(){},El.prototype.lc=function(){},El.prototype.vr=function(){return this.xi},El.prototype.Vr=function(t){var e=this.rc[t.bs()];return e||(e=new jc(this.xi,this.Br),this.rc[t.bs()]=e),e},El.prototype.gr=function(){return this.Ci},El.prototype.pr=function(){return this.Li},El.prototype.Sr=function(){return this.br},El.prototype.runTransaction=function(t,e,n){var r=this;Sr("MemoryPersistence","Starting transaction:",t);var i=new Hc(this.oc.next());return this.Br._c(),n(i).next(function(t){return r.Br.fc(i).next(function(){return t})}).Cn().then(function(t){return i.dc(),t})},El.prototype.wc=function(e,n){return va.$n(Object.values(this.rc).map(function(t){return function(){return t.lo(e,n)}}))},El),Hc=(bl.prototype.Ec=function(t){this.mc.push(t)},bl.prototype.dc=function(){this.mc.forEach(function(t){return t()})},n(wl,Mc=bl),wl),Yc=(ml.Ic=function(t){return new ml(t)},Object.defineProperty(ml.prototype,"Rc",{get:function(){if(this.Ac)return this.Ac;throw _r()},enumerable:!1,configurable:!0}),ml.prototype.so=function(t,e,n){return this.Tc.so(n,e),this.Rc.delete(n.toString()),va.resolve()},ml.prototype.ro=function(t,e,n){return this.Tc.ro(n,e),this.Rc.add(n.toString()),va.resolve()},ml.prototype.La=function(t,e){return this.Rc.add(e.toString()),va.resolve()},ml.prototype.removeTarget=function(t,e){var n=this;this.Tc.ao(e.targetId).forEach(function(t){return n.Rc.add(t.toString())});var r=this.persistence.gr();return r.Hr(t,e.targetId).next(function(t){t.forEach(function(t){return n.Rc.add(t.toString())})}).next(function(){return r.Za(t,e)})},ml.prototype._c=function(){this.Ac=new Set},ml.prototype.fc=function(n){var r=this,i=this.persistence.pr().vi();return va.forEach(this.Rc,function(t){var e=qr.D(t);return r.yc(n,e).next(function(t){t||i.jr(e)})}).next(function(){return r.Ac=null,i.apply(n)})},ml.prototype.qr=function(t,e){var n=this;return this.yc(t,e).next(function(t){t?n.Rc.delete(e.toString()):n.Rc.add(e.toString())})},ml.prototype.ac=function(t){return 0},ml.prototype.yc=function(t,e){var n=this;return va.$n([function(){return va.resolve(n.Tc.lo(e))},function(){return n.persistence.gr().lo(t,e)},function(){return n.persistence.wc(t,e)}])},ml),Wc=(gl.prototype.Wo=function(t){this.gc=t},gl.prototype.Uo=function(t){this.vc=t},gl.prototype.onMessage=function(t){this.bc=t},gl.prototype.close=function(){this.Vc()},gl.prototype.send=function(t){this.Pc(t)},gl.prototype.Sc=function(){this.gc()},gl.prototype.Dc=function(t){this.vc(t)},gl.prototype.Cc=function(t){this.bc(t)},gl),Kc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Xc=(vl.prototype.iu=function(e,t,n,r){var i=this.Lc(e,t);return Sr("RestConnection","Sending: ",i,n),t={},this.Oc(t,r),this.xc(e,i,t,n).then(function(t){return Sr("RestConnection","Received: ",t),t},function(t){throw Dr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},vl.prototype.ru=function(t,e,n,r){return this.iu(t,e,n,r)},vl.prototype.Oc=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.22.1-alpha.96ae6a5fe",t["Content-Type"]="text/plain",e)for(var n in e.fo)e.fo.hasOwnProperty(n)&&(t[n]=e.fo[n])},vl.prototype.Lc=function(t,e){return t=Kc[t],this.Fc+"/v1/"+e+":"+t},n(yl,Cc=vl),yl.prototype.xc=function(o,e,s,u){return new Promise(function(n,r){var i=new mr;i.listenOnce(vr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case yr.NO_ERROR:var t=i.getResponseJson();Sr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case yr.TIMEOUT:Sr("Connection",'RPC "'+o+'" timed out'),r(new Tr(Ir.DEADLINE_EXCEEDED,"Request time out"));break;case yr.HTTP_ERROR:var e=i.getStatus();Sr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Ir).indexOf(e)?e:Ir.UNKNOWN,r(new Tr(e,t.message))):r(new Tr(Ir.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Tr(Ir.UNAVAILABLE,"Connection failed."));break;default:_r()}}finally{Sr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},yl.prototype.Go=function(t,e){var n,r=[this.Fc,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=dr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.B.projectId+"/databases/"+this.B.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.Oc(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),Sr("Connection","Creating WebChannel: "+(r=r.join("")),t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new Wc({Pc:function(t){u?Sr("Connection","Not sending because WebChannel is closed:",t):(s||(Sr("Connection","Opening WebChannel transport."),o.open(),s=!0),Sr("Connection","WebChannel sending:",t),o.send(t))},Vc:function(){return o.close()}});return(t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})})(gr.EventType.OPEN,function(){u||Sr("Connection","WebChannel transport opened.")}),t(gr.EventType.CLOSE,function(){u||(u=!0,Sr("Connection","WebChannel transport closed"),a.Dc())}),t(gr.EventType.ERROR,function(t){u||(u=!0,Dr("Connection","WebChannel transport errored:",t),a.Dc(new Tr(Ir.UNAVAILABLE,"The operation could not be completed")))}),t(gr.EventType.MESSAGE,function(t){var e,n,r,i;u||(kr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Sr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=qi[r];if(void 0!==t)return Hi(t)}(),i=n.message,void 0===t&&(t=Ir.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.Dc(new Tr(t,i)),o.close()):(Sr("Connection","WebChannel received:",e),a.Cc(e)))}),setTimeout(function(){a.Sc()},0),a},yl),$c=(dl.prototype.Ru=function(t){this.Bc.push(t)},dl.prototype.Zs=function(){window.removeEventListener("online",this.kc),window.removeEventListener("offline",this.Uc)},dl.prototype.Qc=function(){window.addEventListener("online",this.kc),window.addEventListener("offline",this.Uc)},dl.prototype.Mc=function(){Sr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Bc;t<e.length;t++)(0,e[t])(0)},dl.prototype.qc=function(){Sr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Bc;t<e.length;t++)(0,e[t])(1)},dl.jc=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},dl),Jc=(pl.prototype.Ru=function(t){},pl.prototype.Zs=function(){},pl),Zc="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",tl=(fl.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.serializer=Ya(e.Nc.B),this.Yu=this.Wc(e),this.persistence=this.Gc(e),[4,this.persistence.start()];case 1:return t.sent(),this.zc=this.Kc(e),this.Vi=this.Hc(e),[2]}})})},fl.prototype.Kc=function(t){return null},fl.prototype.Hc=function(t){return e=this.persistence,n=new Fc,r=t.Yc,t=this.serializer,new yh(e,n,r,t);var e,n,r},fl.prototype.Gc=function(t){if(t.persistenceSettings.Jc)throw new Tr(Ir.FAILED_PRECONDITION,Zc);return new Qc(Yc.Ic,this.serializer)},fl.prototype.Wc=function(t){return new xa},fl.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.zc&&this.zc.stop(),[4,this.Yu.Zs()];case 1:return t.sent(),[4,this.persistence.Zs()];case 2:return t.sent(),[2]}})})},fl.prototype.clearPersistence=function(t,e){throw new Tr(Ir.FAILED_PRECONDITION,Zc)},fl),el=(ll.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Vi?[3,2]:(this.Vi=n.Vi,this.Yu=n.Yu,this.du=this.Xc(r),this.Ku=this.Zc(r),this.Hu=this.th(r),this.eh=this.nh(r),this.Yu.qs=function(t){return Rc(e.eh,t,1)},this.Ku.wu.sh=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Sr("SyncEngine","User change. New user:",o.bs()),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Oi,m=e.$i,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Oi.ma(v).next(function(t){return g=t,n=e.persistence.Vr(o),m=new rh(e.bi,n,e.persistence.vr()),n.ma(v)}).next(function(t){for(var e=[],n=[],r=ao(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Qi(v,r).next(function(t){return{Ea:t,Ta:e,Aa:n}})})})];case 1:return r=t.sent(),[2,(e.Oi=n,e.$i=m,e.Ir.Dr(e.$i),r)]}})})}(n.Vi,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).oa.forEach(function(t){t.forEach(function(t){t.reject(new Tr(Ir.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.oa.clear(),n.Yu.Js(o,r.Ta,r.Aa),[4,kc(n,r.Ea)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this.eh),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Tu.delete(2),[4,Jh(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Tu.add(2),[4,Zh(e)]);case 3:t.sent(),e.yu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.Ku,this.eh.ca)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},ll.prototype.th=function(t){return new La},ll.prototype.Xc=function(t){var e=Ya(t.Nc.B),n=(n=t.Nc,new Xc(n));return t=t.credentials,new Fh(t,n,e)},ll.prototype.Zc=function(t){var e=this;return new Lh(this.Vi,this.du,t.Ln,function(t){return Rc(e.eh,t,0)},t=new($c.jc()?$c:Jc))},ll.prototype.nh=function(t){return e=this.Vi,n=this.Ku,r=this.Hu,i=this.Yu,o=t.Yc,s=t.Ju,u=!t.persistenceSettings.Jc||!t.persistenceSettings.synchronizeTabs,s=new Ec(e,n,r,i,o,s),u&&(s.aa=!0),s;var e,n,r,i,o,s,u},ll.prototype.terminate=function(){return tc(this.Ku)},ll),nl=(cl.prototype.next=function(t){this.observer.next&&this.ih(this.observer.next,t)},cl.prototype.error=function(t){this.observer.error?this.ih(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},cl.prototype.rh=function(){this.muted=!0},cl.prototype.ih=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},cl),rl=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Tr(Ir.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if($r("FieldPath","string",e,t[e]),0===t[e].length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.oh=new Br(t)},il=(n(hl,Pc=rl),hl.documentId=function(){return new hl(Br.v().R())},hl.prototype.isEqual=function(t){if(!(t instanceof hl))throw ai("isEqual","FieldPath",1,t);return this.oh.isEqual(t.oh)},hl),ol=new RegExp("[~\\*/\\[\\]]"),sl=function(t){this.uh=t},ul=(n(al,Uc=sl),al.prototype.ah=function(t){if(2!==t.hh)throw 1===t.hh?t.lh(this.uh+"() can only appear at the top level of your update data"):t.lh(this.uh+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},al.prototype.isEqual=function(t){return t instanceof al},al);function al(){return null!==Uc&&Uc.apply(this,arguments)||this}function hl(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Pc.call(this,t)||this}function cl(t){this.observer=t,this.muted=!1}function ll(){}function fl(){}function pl(){}function dl(){var t=this;this.kc=function(){return t.Mc()},this.Uc=function(){return t.qc()},this.Bc=[],this.Qc()}function yl(t){var e=this;return(e=Cc.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function vl(t){this.Nc=t,this.B=t.B;var e=t.ssl?"https":"http";this.Fc=e+"://"+t.host,this.$c="projects/"+this.B.projectId+"/databases/"+this.B.database+"/documents"}function gl(t){this.Pc=t.Pc,this.Vc=t.Vc}function ml(t){this.persistence=t,this.Tc=new Vh,this.Ac=null}function wl(t){var e=this;return(e=Mc.call(this)||this).Mr=t,e}function bl(){this.mc=[]}function El(t,e){var n=this;this.rc={},this.oc=new Pa(0),this.uc=!1,this.uc=!0,this.Br=t(this),this.Ci=new Gc(this),this.xi=new fh,this.Li=(t=this.xi,new Bc(t,function(t){return n.Br.ac(t)})),this.serializer=new ch(e),this.br=new zc(this.serializer)}function Il(t){this.serializer=t,this.nc=new Map,this.sc=new Map}function Tl(t){this.persistence=t,this.za=new Ri(xi,Fi),this.lastRemoteSnapshotVersion=Si.min(),this.highestTargetId=0,this.Ka=0,this.Ha=new Vh,this.targetCount=0,this.Ya=dh.Tr()}function Al(t){var e=this;return(e=xc.call(this)||this).Ga=t,e}function Nl(){this.fa=new Ri(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.qa=!1}function Rl(t,e){this.xi=t,this.xa=e,this.docs=new Yi(qr.i),this.size=0}function Ll(t,e){this.xi=t,this.Br=e,this.Oi=[],this.ba=1,this.Sa=new to(_h.Zr)}function Sl(){}function Ol(t,e,n){return new Jl({hh:3,_h:e.settings._h,methodName:t.uh,fh:n},e.B,e.serializer,e.ignoreUndefinedProperties)}var Dl,Vl,_l,kl,Ul=(n(Xl,kl=sl),Xl.prototype.ah=function(t){return new Ps(t.path,new Es)},Xl.prototype.isEqual=function(t){return t instanceof Xl},Xl),Pl=(n(Kl,_l=sl),Kl.prototype.ah=function(t){var e=Ol(this,t,!0),n=this.dh.map(function(t){return uf(t,e)}),n=new Is(n);return new Ps(t.path,n)},Kl.prototype.isEqual=function(t){return this===t},Kl),Cl=(n(Wl,Vl=sl),Wl.prototype.ah=function(t){var e=Ol(this,t,!0),n=this.dh.map(function(t){return uf(t,e)}),n=new Ls(n);return new Ps(t.path,n)},Wl.prototype.isEqual=function(t){return this===t},Wl),Ml=(n(Yl,Dl=sl),Yl.prototype.ah=function(t){var e=new Vs(t.serializer,Zo(t.serializer,this.wh));return new Ps(t.path,e)},Yl.prototype.isEqual=function(t){return this===t},Yl),xl=(Object.defineProperty(Hl.prototype,"latitude",{get:function(){return this.mh},enumerable:!1,configurable:!0}),Object.defineProperty(Hl.prototype,"longitude",{get:function(){return this.Eh},enumerable:!1,configurable:!0}),Hl.prototype.isEqual=function(t){return this.mh===t.mh&&this.Eh===t.Eh},Hl.prototype.toJSON=function(){return{latitude:this.mh,longitude:this.Eh}},Hl.prototype.H=function(t){return di(this.mh,t.mh)||di(this.Eh,t.Eh)},Hl),Fl=function(t){this.Th=t},jl=/^__.*__$/,Bl=function(t,e,n){this.Ah=t,this.Ih=e,this.Rh=n},ql=(Ql.prototype.yh=function(t,e){var n=[];return null!==this.Qe?n.push(new Ws(t,this.data,this.Qe,e)):n.push(new Ys(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Zs(t,this.fieldTransforms)),n},Ql),Gl=(zl.prototype.yh=function(t,e){return e=[new Ws(t,this.data,this.Qe,e)],0<this.fieldTransforms.length&&e.push(new Zs(t,this.fieldTransforms)),e},zl);function zl(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function Ql(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function Hl(t,e){if(Wr("GeoPoint",arguments,2),$r("GeoPoint","number",1,t),$r("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Tr(Ir.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Tr(Ir.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.mh=t,this.Eh=e}function Yl(t,e){var n=this;return(n=Dl.call(this,t)||this).wh=e,n}function Wl(t,e){var n=this;return(n=Vl.call(this,t)||this).dh=e,n}function Kl(t,e){var n=this;return(n=_l.call(this,t)||this).dh=e,n}function Xl(){return null!==kl&&kl.apply(this,arguments)||this}function $l(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw _r()}}var Jl=(Object.defineProperty(ef.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(ef.prototype,"hh",{get:function(){return this.settings.hh},enumerable:!1,configurable:!0}),ef.prototype.Vh=function(t){return new ef(Object.assign(Object.assign({},this.settings),t),this.B,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},ef.prototype.ph=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.Vh({path:e,fh:!1})).gh(t),e},ef.prototype.bh=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.Vh({path:t,fh:!1})).Ph(),t},ef.prototype.Sh=function(t){return this.Vh({path:void 0,fh:!0})},ef.prototype.lh=function(t){return pf(t,this.settings.methodName,this.settings.Dh||!1,this.path,this.settings._h)},ef.prototype.contains=function(e){return void 0!==this.Qe.find(function(t){return e.T(t)})||void 0!==this.fieldTransforms.find(function(t){return e.T(t.field)})},ef.prototype.Ph=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.gh(this.path.get(t))},ef.prototype.gh=function(t){if(0===t.length)throw this.lh("Document fields must not be empty");if($l(this.hh)&&jl.test(t))throw this.lh('Document fields cannot begin and end with "__"')},ef),Zl=(tf.prototype.Ch=function(t,e,n,r){return void 0===r&&(r=!1),new Jl({hh:t,methodName:e,_h:n,path:Br.V(),fh:!1,Dh:r},this.B,this.serializer,this.ignoreUndefinedProperties)},tf);function tf(t,e,n){this.B=t,this.ignoreUndefinedProperties=e,this.serializer=n||Ya(t)}function ef(t,e,n,r,i,o){this.settings=t,this.B=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Ph(),this.fieldTransforms=i||[],this.Qe=o||[]}function nf(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Ch(o.merge||o.mergeFields?2:0,e,n,i);cf("Data must be an object, but it was:",s,r);var u,a,r=af(r,s);if(o.merge)u=new Cs(s.Qe),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],c=0,l=o.mergeFields;c<l.length;c++){var f=l[c],p=void 0;if(f instanceof rl)p=f.oh;else{if("string"!=typeof f)throw _r();p=ff(e,f,n)}if(!s.contains(p))throw new Tr(Ir.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");df(h,p)||h.push(p)}u=new Cs(h),a=s.fieldTransforms.filter(function(t){return u.Ke(t.field)})}else u=null,a=s.fieldTransforms;return new ql(new su(r),u,a)}function rf(t,r,i,e){var o=t.Ch(1,r,i);cf("Data must be an object, but it was:",o,e);var s=[],u=new uu;return Pr(e,function(t,e){var n=ff(r,t,i),t=o.bh(n);e instanceof ul||e instanceof Fl&&e.Th instanceof ul?s.push(n):null!=(t=uf(e,t))&&(s.push(n),u.set(n,t))}),e=new Cs(s),new Gl(u.Je(),e,o.fieldTransforms)}function of(t,e,n,r,i,o){var s=t.Ch(1,e,n),u=[lf(e,r,n)],a=[i];if(o.length%2!=0)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(lf(e,o[h])),a.push(o[h+1]);for(var c,l,f,p=[],d=new uu,y=u.length-1;0<=y;--y)df(p,u[y])||(c=u[y],l=a[y],f=s.bh(c),l instanceof ul||l instanceof Fl&&l.Th instanceof ul?p.push(c):null!=(f=uf(l,f))&&(p.push(c),d.set(c,f)));return i=new Cs(p),new Gl(d.Je(),i,s.fieldTransforms)}function sf(t,e,n,r){return void 0===r&&(r=!1),uf(n,t.Ch(r?4:3,e))}function uf(s,t){if(s instanceof Fl&&(s=s.Th),hf(s))return cf("Unsupported field value:",t,s),af(s,t);if(s instanceof sl)return function(t,e){if(!$l(e.hh))throw e.lh(t.uh+"() can only be used with update() and set()");if(!e.path)throw e.lh(t.uh+"() is not currently supported inside arrays");(t=t.ah(e))&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.Qe.push(t.path),s instanceof Array){if(t.settings.fh&&4!==t.hh)throw t.lh("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=uf(i[r],t.Sh(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Zo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Li.fromDate(t);return{timestampValue:ts(e.serializer,n)}}if(t instanceof Li){var r=new Li(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:ts(e.serializer,r)}}if(t instanceof xl)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof mi)return{bytesValue:es(e.serializer,t.q)};if(t instanceof Bl){if(n=e.B,!(r=t.Ah).isEqual(n))throw e.lh("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:rs(t.Ah||e.B,t.Ih.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.lh("Unsupported field value: "+oi(t))}(s,t)}function af(t,n){var r={};return Cr(t)?n.path&&0<n.path.length&&n.Qe.push(n.path):Pr(t,function(t,e){null!=(e=uf(e,n.ph(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function hf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Li||t instanceof xl||t instanceof mi||t instanceof Bl||t instanceof sl)}function cf(t,e,n){if(!hf(n)||!ii(n))throw"an object"===(n=oi(n))?e.lh(t+" a custom object"):e.lh(t+" "+n)}function lf(t,e,n){if(e instanceof rl)return e.oh;if("string"==typeof e)return ff(t,e);throw pf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function ff(t,e,n){try{return function(e){if(0<=e.search(ol))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(il.bind.apply(il,i([void 0],e.split("."))))}catch(t){throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).oh}catch(e){throw pf(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function pf(t,e,n,r,i){var o=r&&!r.m(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Tr(Ir.INVALID_ARGUMENT,(e+=". ")+t+n)}function df(t,e){return t.some(function(t){return t.isEqual(e)})}var yf=(bf.prototype.Oh=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.xh(),0<this.mutations.length)throw new Tr(Ir.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var i,e,n,o,r;return v(this,function(t){switch(t.label){case 0:return e=as((i=s).serializer)+"/documents",n={documents:u.map(function(t){return os(i.serializer,t)})},[4,i.ru("BatchGetDocuments",e,n)];case 1:return n=t.sent(),o=new Map,n.forEach(function(t){var e,n,r,t=(e=i.serializer,"found"in(t=t)?function(t,e){kr(!!e.found),e.found.name,e.found.updateTime;var n=ss(t,e.found.name),t=ns(e.found.updateTime),e=new su({mapValue:{fields:e.found.fields}});return new yu(n,t,e,{})}(e,t):"missing"in t?(n=e,kr(!!(r=t).missing),kr(!!r.readTime),n=ss(n,r.missing),r=ns(r.readTime),new vu(n,r)):_r());o.set(t.key.toString(),t)}),r=[],[2,(u.forEach(function(t){kr(!!(t=o.get(t.toString()))),r.push(t)}),r)]}})})}(this.du,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof vu||t instanceof yu?n.kh(t):_r()}),e)]}})})},bf.prototype.set=function(t,e){this.write(e.yh(t,this.Ge(t))),this.Lh.add(t.toString())},bf.prototype.update=function(t,e){try{this.write(e.yh(t,this.Mh(t)))}catch(t){this.$h=t}this.Lh.add(t.toString())},bf.prototype.delete=function(t){this.write([new iu(t,this.Ge(t))]),this.Lh.add(t.toString())},bf.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.xh(),this.$h)throw this.$h;return e=this.Nh,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=qr.D(e),n.mutations.push(new ou(e,n.Ge(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=as((e=i).serializer)+"/documents",r={writes:o.map(function(t){return ls(e.serializer,t)})},[4,e.iu("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.du,this.mutations)];case 1:return t.sent(),this.Fh=!0,[2]}})})},bf.prototype.kh=function(t){var e;if(t instanceof yu)e=t.version;else{if(!(t instanceof vu))throw _r();e=Si.min()}var n=this.Nh.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Tr(Ir.ABORTED,"Document version changed between two reads.")}else this.Nh.set(t.key.toString(),e)},bf.prototype.Ge=function(t){var e=this.Nh.get(t.toString());return!this.Lh.has(t.toString())&&e?Fs.updateTime(e):Fs.He()},bf.prototype.Mh=function(t){var e=this.Nh.get(t.toString());if(this.Lh.has(t.toString())||!e)return Fs.exists(!0);if(e.isEqual(Si.min()))throw new Tr(Ir.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Fs.updateTime(e)},bf.prototype.write=function(t){this.xh(),this.mutations=this.mutations.concat(t)},bf.prototype.xh=function(){},bf),vf=(wf.prototype.run=function(){this.qh()},wf.prototype.qh=function(){var t=this;this.Yn.In(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new yf(this.du),(n=this.Bh(e))&&n.then(function(t){r.Ln.Bn(function(){return e.commit().then(function(){r.kn.resolve(t)}).catch(function(t){r.Qh(t)})})}).catch(function(t){r.Qh(t)}),[2]})})})},wf.prototype.Bh=function(t){try{var e=this.updateFunction(t);return!Ui(e)&&e.catch&&e.then?e:(this.kn.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.kn.reject(t),null}},wf.prototype.Qh=function(t){var e=this;0<this.Uh&&this.jh(t)?(--this.Uh,this.Ln.Bn(function(){return e.qh(),Promise.resolve()})):this.kn.reject(t)},wf.prototype.jh=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!Qi(t))},wf),gf=(mf.prototype.start=function(t,e,n,r){var i=this;this.Gh(),this.Nc=t;var o=new da,s=!1;return this.credentials.Eo(function(t){return s?void i.Ln.ss(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).Ln.us(),Sr("RemoteStore","RemoteStore received new credentials"),n=uc(e),e.Tu.add(3),[4,Zh(e)];case 1:return t.sent(),n&&e.yu.set("Unknown"),[4,e.wu.sh(i)];case 2:return t.sent(),e.Tu.delete(3),[4,Jh(e)];case 3:return t.sent(),[2]}})})}(i.Ku,t)}):(s=!0,Sr("FirestoreClient","Initializing. user=",t.uid),i.zh(e,n,r,t,o).then(i.Wh.resolve,i.Wh.reject))}),this.Ln.Bn(function(){return i.Wh.promise}),o.promise},mf.prototype.enableNetwork=function(){var e=this;return this.Gh(),this.Ln.enqueue(function(){return e.persistence.lc(!0),(t=e.Ku).Tu.delete(0),Jh(t);var t})},mf.prototype.zh=function(r,i,o,s,u){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={Ln:this.Ln,Nc:this.Nc,clientId:this.clientId,credentials:this.credentials,Yc:s,Ju:100,persistenceSettings:o},[4,r.initialize(e)];case 1:return t.sent(),[4,i.initialize(r,e)];case 2:return t.sent(),this.persistence=r.persistence,this.Yu=r.Yu,this.Vi=r.Vi,this.zc=r.zc,this.du=i.du,this.Ku=i.Ku,this.eh=i.eh,this.Kh=i.Hu,this.Kh.ws=function(u,a){return y(this,void 0,void 0,function(){var n,r,i,o,s;return v(this,function(t){switch(t.label){case 0:return(e=u).Ku.wu.pu=Nc.bind(null,e),e.Ku.wu.Ue=function(t,e){var n=t;if((t=n.sa.get(e))&&t.zu)return ao().add(t.key);var r=ao();if(!(e=n.ta.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.Zu.get(s),r=r.Lt(s.view.Lu);return r}.bind(null,e),e.Ku.wu.Vu=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Yu.Ws(s,"rejected",u),i=e.sa.get(s),(n=i&&i.key)?(r=(r=new Yi(qr.i)).rt(n,new vu(n,Si.min())),i=ao().add(n),i=new po(Si.min(),new Map,new to(di),r,i),[4,Nc(e,i)]):[3,2];case 1:return t.sent(),e.na=e.na.remove(n),e.sa.delete(s),_c(e),[3,4];case 2:return[4,Th(e.Vi,s,!1).then(function(){return Oc(e,s,u)}).catch(Nh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.Xu.zo=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.queries.get(u)){for(var a=0,h=u.listeners;a<h.length;a++)h[a].Ts(s)&&(r=!0);u.fs=s}}r&&Da(n)}.bind(null,e.Hu),e.Xu.ha=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,e.Hu),(s=(n=e).Zu.get(a))?(r=s.targetId,n.Yu.js(r),i=s.view.Gu(),[3,4]):[3,1];case 1:return[4,Ih(n.Vi,Ou(a))];case 2:return o=t.sent(),s=n.Yu.js(o.targetId),r=o.targetId,[4,function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.la=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.Ou(o)).Mu?[4,Ah(r.Vi,i.query,!1).then(function(t){return t=t.documents,i.view.Ou(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.zt.get(i.targetId),n=i.view.Uu(e,r.ca,n),[2,(Vc(r,i.targetId,n.Qu),n.snapshot)]}})})}(i,t,e,n)},[4,Ah(i.Vi,o,!0)];case 1:return n=t.sent(),r=new wc(o,n.Yr),e=r.Ou(n.documents),n=yo.Xt(s,u&&"Offline"!==i.onlineState),n=r.Uu(e,i.ca,n),Vc(i,s,n.Qu),r=new vc(o,s,r),i.Zu.set(o,r),i.ta.has(s)?i.ta.get(s).push(o):i.ta.set(s,[o]),[2,n.snapshot]}})})}(n,a,r,"current"===s)];case 3:i=t.sent(),n.ca&&ec(n.Ku,o),t.label=4;case 4:return[2,i]}var e})})}.bind(null,this.eh),this.Kh.As=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Zu.get(o),1<(r=e.ta.get(n.targetId)).length?[2,(e.ta.set(n.targetId,r.filter(function(t){return!ku(t,o)})),void e.Zu.delete(o))]:e.ca?(e.Yu.Gs(n.targetId),e.Yu.Ys(n.targetId)?[3,2]:[4,Th(e.Vi,n.targetId,!1).then(function(){e.Yu.Ks(n.targetId),nc(e.Ku,n.targetId),Oc(e,n.targetId)}).catch(Nh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Oc(e,n.targetId),[4,Th(e.Vi,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,this.eh),this.persistence.hc(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),u.resolve(),[3,4];case 3:if(e=t.sent(),u.reject(e),!this.Hh(e))throw e;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),this.zh(new tl,new el,{Jc:!1},s,u))];case 4:return[2]}})})},mf.prototype.Hh=function(t){return"FirebaseError"===t.name?t.code===Ir.FAILED_PRECONDITION||t.code===Ir.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},mf.prototype.Gh=function(){if(this.Ln.Xn)throw new Tr(Ir.FAILED_PRECONDITION,"The client has already been terminated.")},mf.prototype.disableNetwork=function(){var t=this;return this.Gh(),this.Ln.enqueue(function(){return t.persistence.lc(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Tu.add(0),[4,Zh(e)];case 1:return t.sent(),e.yu.set("Offline"),[2]}})})}(t.Ku)})},mf.prototype.terminate=function(){var t=this;this.Ln.ns();var n=new da;return this.Ln.Zn(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.zc&&this.zc.stop(),[4,tc(this.Ku)];case 1:return t.sent(),[4,this.Yu.Zs()];case 2:return t.sent(),[4,this.persistence.Zs()];case 3:return t.sent(),this.credentials.To(),n.resolve(),[3,5];case 4:return e=Na(e=t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,5];case 5:return[2]}})})}),n.promise},mf.prototype.waitForPendingWrites=function(){var t=this;this.Gh();var e=new da;return this.Ln.Bn(function(){return function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:uc((n=o).Ku)||Sr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Vi).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Oi.wa(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.oa.get(r)||[]).push(s),n.oa.set(r,i),[3,4]);case 3:return i=Na(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}(t.eh,e)}),e.promise},mf.prototype.listen=function(t,e,n){var r=this;this.Gh();var i=new nl(n),o=new Va(t,i,e);return this.Ln.Bn(function(){return Sa(r.Kh,o)}),function(){i.rh(),r.Ln.Bn(function(){return Oa(r.Kh,o)})}},mf.prototype.Yh=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.Gh(),[4,this.Wh.promise];case 1:return t.sent(),e=new da,[2,(this.Ln.Bn(function(){return function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.$i.ki(t,e)}))];case 1:return(r=t.sent())instanceof yu?s.resolve(r):r instanceof vu?s.resolve(null):s.reject(new Tr(Ir.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=Na(r=t.sent(),"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(n.Vi,r,e)}),e.promise)]}})})},mf.prototype.Jh=function(h,c){return void 0===c&&(c={}),y(this,void 0,void 0,function(){var e,a=this;return v(this,function(t){switch(t.label){case 0:return this.Gh(),[4,this.Wh.promise];case 1:return t.sent(),e=new da,[2,(this.Ln.Bn(function(){return n=a.Kh,r=a.Ln,i=h,o=c,s=e,t=new nl({next:function(t){r.Bn(function(){return Oa(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Tr(Ir.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Tr(Ir.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Va(Iu(i.path),t,{includeMetadataChanges:!0,gs:!0}),Sa(n,u);var n,r,i,o,s,t,u}),e.promise)]}})})},mf.prototype.Xh=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.Gh(),[4,this.Wh.promise];case 1:return t.sent(),e=new da,[2,(this.Ln.Bn(function(){return function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Ah(r,i,!0)];case 1:return n=t.sent(),e=new wc(i,n.Yr),n=e.Ou(n.documents),n=e.Uu(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=Na(n=t.sent(),"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(n.Vi,r,e)}),e.promise)]}})})},mf.prototype.Zh=function(h,c){return void 0===c&&(c={}),y(this,void 0,void 0,function(){var u,a=this;return v(this,function(t){switch(t.label){case 0:return this.Gh(),[4,this.Wh.promise];case 1:return t.sent(),u=new da,[2,(this.Ln.Bn(function(){return e=a.Kh,n=a.Ln,t=h,r=c,i=u,o=new nl({next:function(t){n.Bn(function(){return Oa(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Tr(Ir.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Va(t,o,{includeMetadataChanges:!0,gs:!0}),Sa(e,s);var e,n,t,r,i,o,s}),u.promise)]}})})},mf.prototype.write=function(t){var e=this;this.Gh();var n=new da;return this.Ln.Bn(function(){return Ac(e.eh,t,n)}),n.promise},mf.prototype.B=function(){return this.Nc.B},mf.prototype.tl=function(t){var e=this;this.Gh();var r=new nl(t);return this.Ln.Bn(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,(e=this.Kh,n=r,e.ds.add(n),void n.next())];var e,n})})}),function(){r.rh(),e.Ln.Bn(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,void this.Kh.ds.delete(r)]})})})}},Object.defineProperty(mf.prototype,"el",{get:function(){return this.Ln.Xn},enumerable:!1,configurable:!0}),mf.prototype.transaction=function(t){var e=this;this.Gh();var n=new da;return this.Ln.Bn(function(){return new vf(e.Ln,e.du,t,n).run(),Promise.resolve()}),n.promise},mf.prototype.loadBundle=function(t,r){var e=this;this.Gh();var n,i,o=(n=t,i=Ya(this.Nc.B),n="string"==typeof n?(new TextEncoder).encode(n):n,new Ka(Ha(n),i));this.Ln.Bn(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,(e=this.eh,function(f,p,d){return y(this,void 0,void 0,function(){var u,a,h,c,l;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,14,,15]),[4,p.getMetadata()];case 1:return u=t.sent(),[4,(r=f.Vi,i=u,s=new Xa((o=r).serializer).Ri(i.createTime),o.persistence.runTransaction("hasNewerBundle","readonly",function(t){return o.br.Ia(t,i.id)}).then(function(t){return!!t&&0<=t.createTime.M(s)}))];case 2:return t.sent()?[4,p.close()]:[3,4];case 3:return[2,(t.sent(),void d.Ra({taskState:"Success",documentsLoaded:u.totalDocuments,bytesLoaded:u.totalBytes,totalDocuments:u.totalDocuments,totalBytes:u.totalBytes}))];case 4:return d.ya(th(u)),a=new nh(u,f.Vi,p.serializer),[4,p.fi()];case 5:h=t.sent(),t.label=6;case 6:return h?[4,a.pi(h)]:[3,10];case 7:return(c=t.sent())&&d.ya(c),[4,p.fi()];case 8:h=t.sent(),t.label=9;case 9:return[3,6];case 10:return[4,a.complete()];case 11:return l=t.sent(),[4,kc(f,l.yi,void 0)];case 12:return t.sent(),[4,(r=f.Vi,e=u,(n=r).persistence.runTransaction("Save bundle","readwrite",function(t){return n.br.Pa(t,e)}))];case 13:return t.sent(),d.Ra(l.progress),[3,15];case 14:return l=t.sent(),d.Va(l),[3,15];case 15:return[2]}var e,n,r,i,o,s})})}(n=e,o,r).then(function(){n.Yu.ti()}),r.catch(function(t){Dr("FirestoreClient","Loading bundle failed with "+t)}))];var e,n})})})},mf.prototype.ic=function(t){return this.Gh(),e=this.Vi,n=t,(r=e).persistence.runTransaction("Get named query","readonly",function(t){return r.br.ic(t,n)});var e,n,r},mf);function mf(t,e){this.credentials=t,this.Ln=e,this.clientId=fi.L(),this.Wh=new da}function wf(t,e,n,r){this.Ln=t,this.du=e,this.updateFunction=n,this.kn=r,this.Uh=5,this.Yn=new ya(this.Ln,"transaction_retry")}function bf(t){this.du=t,this.Nh=new Map,this.mutations=[],this.Fh=!1,this.$h=null,this.Lh=new Set}function Ef(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var If,Tf,Af=(zf.prototype.rl=function(t){switch(ko(t)){case 0:return null;case 1:return t.booleanValue;case 2:return jo(t.integerValue||t.doubleValue);case 3:return this.ol(t.timestampValue);case 4:return this.ul(t);case 5:return t.stringValue;case 6:return this.il(Bo(t.bytesValue));case 7:return this.al(t.referenceValue);case 8:return this.cl(t.geoPointValue);case 9:return this.hl(t.arrayValue);case 10:return this.ll(t.mapValue);default:throw _r()}},zf.prototype.ll=function(t){var n=this,r={};return Pr(t.fields||{},function(t,e){r[t]=n.rl(e)}),r},zf.prototype.cl=function(t){return new xl(jo(t.latitude),jo(t.longitude))},zf.prototype.hl=function(t){var e=this;return(t.values||[]).map(function(t){return e.rl(t)})},zf.prototype.ul=function(t){switch(this.nl){case"previous":var e=function t(e){return Do(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==e?null:this.rl(e);case"estimate":return this.ol(Vo(t));default:return null}},zf.prototype.ol=function(t){return t=Fo(t),t=new Li(t.seconds,t.nanos),this.timestampsInSnapshots?t:t.toDate()},zf.prototype.al=function(t){var e=Fr.P(t);return kr(gs(e)),t=new Ni(e.get(1),e.get(3)),e=new qr(e.u(5)),t.isEqual(this.B)||Or("Document "+e+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+this.B.projectId+"/"+this.B.database+") instead."),this.sl(e)},zf),Nf=(Gf.prototype.onProgress=function(t,e,n){this._l={next:t,error:e,complete:n}},Gf.prototype.catch=function(t){return this.fl.promise.catch(t)},Gf.prototype.then=function(t,e){return this.fl.promise.then(t,e)},Gf.prototype.Ra=function(t){this.ya(t),this._l.complete&&this._l.complete(),this.fl.resolve(t)},Gf.prototype.Va=function(t){this.dl.taskState="Error",this._l.next&&this._l.next(this.dl),this._l.error&&this._l.error(t),this.fl.reject(t)},Gf.prototype.ya=function(t){this.dl=t,this._l.next&&this._l.next(t)},Gf),Rf=oh.ar,Lf=(qf.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},qf),Sf=(Object.defineProperty(Bf.prototype,"pl",{get:function(){return this.gl||(this.gl=new Zl(this.Ah,this.Vl.ignoreUndefinedProperties)),this.gl},enumerable:!1,configurable:!0}),Bf.prototype.settings=function(t){if(Wr("Firestore.settings",arguments,1),$r("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.Vl),t)).merge,t=new Lf(t),this.Il&&!this.Vl.isEqual(t))throw new Tr(Ir.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Vl=t).credentials&&(this.Pl=function(t){if(!t)return new kh;switch(t.type){case"gapi":var e=t.client;return kr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Ch(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Tr(Ir.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Bf.prototype.enableNetwork=function(){return this.Al(),this.Il.enableNetwork()},Bf.prototype.disableNetwork=function(){return this.Al(),this.Il.disableNetwork()},Bf.prototype.enablePersistence=function(t){var e;if(this.Il)throw new Tr(Ir.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var n=!1,r=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Or("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),n=null!==(e=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==e&&e,r=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,n&&r))throw new Tr(Ir.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.vl(this.wl,this.ml,{Jc:!0,cacheSizeBytes:this.Vl.cacheSizeBytes,synchronizeTabs:n,bl:r})},Bf.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){var n,e=this;return v(this,function(t){if(void 0!==this.Il&&!this.Il.el)throw new Tr(Ir.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new da,[2,(this.Tl.Zn(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.wl.clearPersistence(this.Ah,this.yl)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},Bf.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Bf.prototype,"Sl",{get:function(){return this.Al(),this.Il.el},enumerable:!1,configurable:!0}),Bf.prototype.waitForPendingWrites=function(){return this.Al(),this.Il.waitForPendingWrites()},Bf.prototype.onSnapshotsInSync=function(t){return this.Al(),Ef(t)||($r("Firestore.onSnapshotsInSync","function",1,t),t={next:t}),this.Il.tl(t)},Bf.prototype.loadBundle=function(t){this.Al();var e=new Nf;return this.Il.loadBundle(t,e),e},Bf.prototype.namedQuery=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.Al(),[4,this.Il.ic(n)];case 1:return[2,(e=t.sent())?new Xf(e.query,this,null):null]}})})},Bf.prototype.Al=function(){return this.Il||this.vl(new tl,new el,{Jc:!1}),this.Il},Bf.prototype.Dl=function(){return new Ii(this.Ah,this.yl,this.Vl.host,this.Vl.ssl,this.Vl.experimentalForceLongPolling)},Bf.prototype.vl=function(t,e,n){var r=this.Dl();return this.Il=new gf(this.Pl,this.Tl),this.Il.start(r,t,e,n)},Bf.Rl=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Tr(Ir.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e;if(!(t=t.options.projectId)||"string"!=typeof t)throw new Tr(Ir.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Ni(t)},Object.defineProperty(Bf.prototype,"app",{get:function(){if(!this.El)throw new Tr(Ir.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.El},enumerable:!1,configurable:!0}),Bf.prototype.collection=function(t){return Wr("Firestore.collection",arguments,1),$r("Firestore.collection","non-empty string",1,t),this.Al(),new Jf(Fr.P(t),this,null)},Bf.prototype.doc=function(t){return Wr("Firestore.doc",arguments,1),$r("Firestore.doc","non-empty string",1,t),this.Al(),Vf.Cl(Fr.P(t),this,null)},Bf.prototype.collectionGroup=function(t){if(Wr("Firestore.collectionGroup",arguments,1),$r("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.Al(),new Xf((t=t,new mu(Fr.V(),t)),this,null)},Bf.prototype.runTransaction=function(e){var n=this;return Wr("Firestore.runTransaction",arguments,1),$r("Firestore.runTransaction","function",1,e),this.Al().transaction(function(t){return e(new Of(n,t))})},Bf.prototype.batch=function(){return this.Al(),new Df(this)},Object.defineProperty(Bf,"logLevel",{get:function(){switch(Lr()){case u.DEBUG:return"debug";case u.ERROR:return"error";case u.SILENT:return"silent";case u.WARN:return"warn";case u.INFO:return"info";case u.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),Bf.setLogLevel=function(t){Wr("Firestore.setLogLevel",arguments,1),ni("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Nr.setLogLevel(t)},Bf.prototype.Nl=function(){return this.Vl.timestampsInSnapshots},Bf.prototype.Fl=function(){return this.Vl},Bf),Of=(jf.prototype.get=function(t){var e=this;Wr("Transaction.get",arguments,1);var n=op("Transaction.get",t,this.$l);return this.Ll.Oh([n.Ih]).then(function(t){if(!t||1!==t.length)return _r();if((t=t[0])instanceof vu)return new kf(e.$l,n.Ih,null,!1,!1,n.Rh);if(t instanceof yu)return new kf(e.$l,n.Ih,t,!1,!1,n.Rh);throw _r()})},jf.prototype.set=function(t,e,n){return Xr("Transaction.set",arguments,2,3),t=op("Transaction.set",t,this.$l),n=np("Transaction.set",n),e=sp(t.Rh,e,n),n=nf(this.$l.pl,"Transaction.set",t.Ih,e,null!==t.Rh,n),this.Ll.set(t.Ih,n),this},jf.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return e="string"==typeof e||e instanceof il?(Kr("Transaction.update",arguments,3),r=op("Transaction.update",t,this.$l),of(this.$l.pl,"Transaction.update",r.Ih,e,n,i)):(Wr("Transaction.update",arguments,2),r=op("Transaction.update",t,this.$l),rf(this.$l.pl,"Transaction.update",r.Ih,e)),this.Ll.update(r.Ih,e),this},jf.prototype.delete=function(t){return Wr("Transaction.delete",arguments,1),t=op("Transaction.delete",t,this.$l),this.Ll.delete(t.Ih),this},jf),Df=(Ff.prototype.set=function(t,e,n){return Xr("WriteBatch.set",arguments,2,3),this.kl(),t=op("WriteBatch.set",t,this.$l),n=np("WriteBatch.set",n),e=sp(t.Rh,e,n),n=nf(this.$l.pl,"WriteBatch.set",t.Ih,e,null!==t.Rh,n),this.Ol=this.Ol.concat(n.yh(t.Ih,Fs.He())),this},Ff.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return this.kl(),e="string"==typeof e||e instanceof il?(Kr("WriteBatch.update",arguments,3),r=op("WriteBatch.update",t,this.$l),of(this.$l.pl,"WriteBatch.update",r.Ih,e,n,i)):(Wr("WriteBatch.update",arguments,2),r=op("WriteBatch.update",t,this.$l),rf(this.$l.pl,"WriteBatch.update",r.Ih,e)),this.Ol=this.Ol.concat(e.yh(r.Ih,Fs.exists(!0))),this},Ff.prototype.delete=function(t){return Wr("WriteBatch.delete",arguments,1),this.kl(),t=op("WriteBatch.delete",t,this.$l),this.Ol=this.Ol.concat(new iu(t.Ih,Fs.He())),this},Ff.prototype.commit=function(){return this.kl(),this.xl=!0,0<this.Ol.length?this.$l.Al().write(this.Ol):Promise.resolve()},Ff.prototype.kl=function(){if(this.xl)throw new Tr(Ir.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Ff),Vf=(n(xf,Tf=Bl),xf.Cl=function(t,e,n){if(t.length%2!=0)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.R()+" has "+t.length);return new xf(new qr(t),e,n)},Object.defineProperty(xf.prototype,"id",{get:function(){return this.Ih.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(xf.prototype,"parent",{get:function(){return new Jf(this.Ih.path.h(),this.firestore,this.Rh)},enumerable:!1,configurable:!0}),Object.defineProperty(xf.prototype,"path",{get:function(){return this.Ih.path.R()},enumerable:!1,configurable:!0}),xf.prototype.collection=function(t){if(Wr("DocumentReference.collection",arguments,1),$r("DocumentReference.collection","non-empty string",1,t),!t)throw new Tr(Ir.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");return t=Fr.P(t),new Jf(this.Ih.path.child(t),this.firestore,null)},xf.prototype.isEqual=function(t){if(!(t instanceof xf))throw ai("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Ih.isEqual(t.Ih)&&this.Rh===t.Rh},xf.prototype.set=function(t,e){return Xr("DocumentReference.set",arguments,1,2),e=np("DocumentReference.set",e),t=sp(this.Rh,t,e),e=nf(this.firestore.pl,"DocumentReference.set",this.Ih,t,null!==this.Rh,e),this.Il.write(e.yh(this.Ih,Fs.He()))},xf.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return t="string"==typeof t||t instanceof il?(Kr("DocumentReference.update",arguments,2),of(this.firestore.pl,"DocumentReference.update",this.Ih,t,e,n)):(Wr("DocumentReference.update",arguments,1),rf(this.firestore.pl,"DocumentReference.update",this.Ih,t)),this.Il.write(t.yh(this.Ih,Fs.exists(!0)))},xf.prototype.delete=function(){return Wr("DocumentReference.delete",arguments,0),this.Il.write([new iu(this.Ih,Fs.He())])},xf.prototype.onSnapshot=function(){for(var e=this,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];Xr("DocumentReference.onSnapshot",arguments,1,4);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||Ef(n[i])||(ui("DocumentReference.onSnapshot",r=n[i],["includeMetadataChanges"]),ti("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};Ef(n[i])?(s=n[i],n[i]=null===(r=s.next)||void 0===r?void 0:r.bind(s),n[i+1]=null===(r=s.error)||void 0===r?void 0:r.bind(s),n[i+2]=null===(r=s.complete)||void 0===r?void 0:r.bind(s)):($r("DocumentReference.onSnapshot","function",i,n[i]),Jr("DocumentReference.onSnapshot","function",i+1,n[i+1]),Jr("DocumentReference.onSnapshot","function",i+2,n[i+2]));var s={next:function(t){n[i]&&n[i](e.Ml(t))},error:n[i+1],complete:n[i+2]};return this.Il.listen(Iu(this.Ih.path),o,s)},xf.prototype.get=function(t){var e=this;Xr("DocumentReference.get",arguments,0,1),ip("DocumentReference.get",t);var n=this.firestore.Al();return t&&"cache"===t.source?n.Yh(this.Ih).then(function(t){return new kf(e.firestore,e.Ih,t,!0,t instanceof yu&&t.Ye,e.Rh)}):n.Jh(this.Ih,t).then(function(t){return e.Ml(t)})},xf.prototype.withConverter=function(t){return new xf(this.Ih,this.firestore,t)},xf.prototype.Ml=function(t){var e=t.docs.get(this.Ih);return new kf(this.firestore,this.Ih,e,t.fromCache,t.hasPendingWrites,this.Rh)},xf),_f=(Mf.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Mf),kf=(Cf.prototype.data=function(t){var e=this;if(Xr("DocumentSnapshot.data",arguments,0,1),t=rp("DocumentSnapshot.data",t),this.Ul){if(this.Rh){var n=new Uf(this.$l,this.Ih,this.Ul,this.ql,this.Bl,null);return this.Rh.fromFirestore(n,t)}return new Af(this.$l.Ah,this.$l.Nl(),t.serverTimestamps||"none",function(t){return new Vf(t,e.$l,null)},function(t){return new Ai(t)}).rl(this.Ul.sn())}},Cf.prototype.get=function(t,e){var n=this;if(Xr("DocumentSnapshot.get",arguments,1,2),e=rp("DocumentSnapshot.get",e),this.Ul&&null!==(t=this.Ul.data().field(lf("DocumentSnapshot.get",t,this.Ih))))return new Af(this.$l.Ah,this.$l.Nl(),e.serverTimestamps||"none",function(t){return new Vf(t,n.$l,n.Rh)},function(t){return new Ai(t)}).rl(t)},Object.defineProperty(Cf.prototype,"id",{get:function(){return this.Ih.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Cf.prototype,"ref",{get:function(){return new Vf(this.Ih,this.$l,this.Rh)},enumerable:!1,configurable:!0}),Object.defineProperty(Cf.prototype,"exists",{get:function(){return null!==this.Ul},enumerable:!1,configurable:!0}),Object.defineProperty(Cf.prototype,"metadata",{get:function(){return new _f(this.Bl,this.ql)},enumerable:!1,configurable:!0}),Cf.prototype.isEqual=function(t){if(!(t instanceof Cf))throw ai("isEqual","DocumentSnapshot",1,t);return this.$l===t.$l&&this.ql===t.ql&&this.Ih.isEqual(t.Ih)&&(null===this.Ul?null===t.Ul:this.Ul.isEqual(t.Ul))&&this.Rh===t.Rh},Cf),Uf=(n(Pf,If=kf),Pf.prototype.data=function(t){return If.prototype.data.call(this,t)},Pf);function Pf(){return null!==If&&If.apply(this,arguments)||this}function Cf(t,e,n,r,i,o){this.$l=t,this.Ih=e,this.Ul=n,this.ql=r,this.Bl=i,this.Rh=o}function Mf(t,e){this.hasPendingWrites=t,this.fromCache=e}function xf(t,e,n){var r=this;return(r=Tf.call(this,e.Ah,t,n)||this).Ih=t,r.firestore=e,r.Rh=n,r.Il=r.firestore.Al(),r}function Ff(t){this.$l=t,this.Ol=[],this.xl=!1}function jf(t,e){this.$l=t,this.Ll=e}function Bf(t,e,n,r){var i=this;if(void 0===n&&(n=new tl),void 0===r&&(r=new el),this.wl=n,this.ml=r,this.El=null,this.Tl=new Ia,this.INTERNAL={delete:function(){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Al(),[4,this.Il.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options)r=t,this.El=r,this.Ah=Bf.Rl(r),this.yl=r.name,this.Pl=new Uh(e);else{if(!(t=t).projectId)throw new Tr(Ir.INVALID_ARGUMENT,"Must provide projectId");this.Ah=new Ni(t.projectId,t.database),this.yl="[DEFAULT]",this.Pl=new kh}this.Vl=new Lf({})}function qf(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Tr(Ir.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Zr("settings","non-empty string","host",t.host),this.host=t.host,ti("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(ui("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),ti("settings","object","credentials",t.credentials),this.credentials=t.credentials,ti("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),ti("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Or("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Or("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(e=t.timestampsInSnapshots)||void 0===e||e,this.ignoreUndefinedProperties=null!==(e=t.ignoreUndefinedProperties)&&void 0!==e&&e,ti("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=oh.hr;else{if(t.cacheSizeBytes!==Rf&&t.cacheSizeBytes<oh.cr)throw new Tr(Ir.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+oh.cr);this.cacheSizeBytes=t.cacheSizeBytes}ti("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(t=t.experimentalForceLongPolling)&&void 0!==t&&t}function Gf(){this._l={},this.fl=new da,this.dl={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function zf(t,e,n,r,i){this.B=t,this.timestampsInSnapshots=e,this.nl=n,this.sl=r,this.il=i}function Qf(t,e,n){if("string"==typeof n){if(""===n)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Lu(e)&&-1!==n.indexOf("/"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(Fr.P(n)),!qr.F(e))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return qo(t,new qr(e))}if(n instanceof Bl)return qo(t,n.Ih);throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+oi(n)+".")}function Hf(t,e){if(!Array.isArray(t)||0===t.length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function Yf(t,e,n){if(!n.isEqual(e))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Wf(t){if(Au(t)&&0===t.rn.length)throw new Tr(Ir.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Kf,Xf=(ep.prototype.where=function(t,e,n){return Wr("Query.where",arguments,3),si("Query.where",3,n),e=ni("Query.where",["<","<=","==","!=",">=",">","array-contains","in","array-contains-any","not-in"],2,e),t=lf("Query.where",t),e=function(t,e,n,r,i,o){if(r.g()){if("array-contains"===i||"array-contains-any"===i)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){Hf(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var h=a[u];s.push(Qf(n,t,h))}c={arrayValue:{values:s}}}else c=Qf(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Hf(o,i),c=sf(e,"Query.where",o,"in"===i||"not-in"===i);var c=Fu.create(r,i,c);return function(t,e){if(e.an()){var n=Ru(t);if(null!==n&&!n.isEqual(e.field))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=Nu(t))&&Yf(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,c),c}(this.Ql,this.firestore.pl,this.firestore.Ah,t,e,n),new ep((e=(n=this.Ql).filters.concat([e]),new mu(n.path,n.collectionGroup,n.rn.slice(),e,n.limit,n.limitType,n.startAt,n.endAt)),this.firestore,this.Rh)},ep.prototype.orderBy=function(t,e){if(Xr("Query.orderBy",arguments,1,2),Jr("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Tr(Ir.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=lf("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new pa(e,n);return e=r,null!==Nu(n=t)||null!==(t=Ru(n))&&Yf(0,t,e.field),r}(this.Ql,t,n);return new ep((t=(n=this.Ql).rn.concat([t]),new mu(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.limitType,n.startAt,n.endAt)),this.firestore,this.Rh)},ep.prototype.limit=function(t){return Wr("Query.limit",arguments,1),$r("Query.limit","number",1,t),hi("Query.limit",1,t),new ep(Du(this.Ql,t,"F"),this.firestore,this.Rh)},ep.prototype.limitToLast=function(t){return Wr("Query.limitToLast",arguments,1),$r("Query.limitToLast","number",1,t),hi("Query.limitToLast",1,t),new ep(Du(this.Ql,t,"L"),this.firestore,this.Rh)},ep.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Kr("Query.startAt",arguments,1),t=this.jl("Query.startAt",t,e,!0),new ep(Vu(this.Ql,t),this.firestore,this.Rh)},ep.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Kr("Query.startAfter",arguments,1),t=this.jl("Query.startAfter",t,e,!1),new ep(Vu(this.Ql,t),this.firestore,this.Rh)},ep.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Kr("Query.endBefore",arguments,1),t=this.jl("Query.endBefore",t,e,!0),new ep(_u(this.Ql,t),this.firestore,this.Rh)},ep.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Kr("Query.endAt",arguments,1),t=this.jl("Query.endAt",t,e,!1),new ep(_u(this.Ql,t),this.firestore,this.Rh)},ep.prototype.isEqual=function(t){if(!(t instanceof ep))throw ai("isEqual","Query",1,t);return this.firestore===t.firestore&&ku(this.Ql,t.Ql)&&this.Rh===t.Rh},ep.prototype.withConverter=function(t){return new ep(this.Ql,this.firestore,t)},ep.prototype.jl=function(h,t,e,n){return si(h,1,t),t instanceof kf?(Wr(h,i([t],e),1),function(t,e,n,r){if(!n)throw new Tr(Ir.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+h+"().");for(var i=[],o=0,s=Su(t);o<s.length;o++){var u=s[o];if(u.field.g())i.push(qo(e,n.key));else{var a=n.field(u.field);if(Do(a))throw new Tr(Ir.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.R(),new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new oa(i,r)}(this.Ql,this.firestore.Ah,t.Ul,n)):(e=[t].concat(e),function(t,e,n,r,i,o){var s=t.rn;if(i.length>s.length)throw new Tr(Ir.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.g()){if("string"!=typeof h)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!Lu(t)&&-1!==h.indexOf("/"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(Fr.P(h));if(!qr.F(c))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");c=new qr(c),u.push(qo(e,c))}else h=sf(n,r,h),u.push(h)}return new oa(u,o)}(this.Ql,this.firestore.Ah,this.firestore.pl,h,e,n))},ep.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Xr("Query.onSnapshot",arguments,1,4);var i={},o=0;"object"!=typeof n[o]||Ef(n[o])||(ui("Query.onSnapshot",i=n[o],["includeMetadataChanges"]),ti("Query.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),o++),Ef(n[o])?(s=n[o],n[o]=null===(t=s.next)||void 0===t?void 0:t.bind(s),n[o+1]=null===(t=s.error)||void 0===t?void 0:t.bind(s),n[o+2]=null===(t=s.complete)||void 0===t?void 0:t.bind(s)):($r("Query.onSnapshot","function",o,n[o]),Jr("Query.onSnapshot","function",o+1,n[o+1]),Jr("Query.onSnapshot","function",o+2,n[o+2]));var s={next:function(t){n[o]&&n[o](new $f(e.firestore,e.Ql,t,e.Rh))},error:n[o+1],complete:n[o+2]};return Wf(this.Ql),this.firestore.Al().listen(this.Ql,i,s)},ep.prototype.get=function(t){var e=this;Xr("Query.get",arguments,0,1),ip("Query.get",t),Wf(this.Ql);var n=this.firestore.Al();return(t&&"cache"===t.source?n.Xh(this.Ql):n.Zh(this.Ql,t)).then(function(t){return new $f(e.firestore,e.Ql,t,e.Rh)})},ep),$f=(Object.defineProperty(tp.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(tp.prototype,"empty",{get:function(){return this.Gl.docs.m()},enumerable:!1,configurable:!0}),Object.defineProperty(tp.prototype,"size",{get:function(){return this.Gl.docs.size},enumerable:!1,configurable:!0}),tp.prototype.forEach=function(e,n){var r=this;Xr("QuerySnapshot.forEach",arguments,1,2),$r("QuerySnapshot.forEach","function",1,e),this.Gl.docs.forEach(function(t){e.call(n,r.Hl(t,r.metadata.fromCache,r.Gl.Qt.has(t.key)))})},Object.defineProperty(tp.prototype,"query",{get:function(){return new Xf(this.Wl,this.$l,this.Rh)},enumerable:!1,configurable:!0}),tp.prototype.docChanges=function(t){if(t&&(ui("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),ti("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges)),(t=!(!t||!t.includeMetadataChanges))&&this.Gl.Wt)throw new Tr(Ir.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.zl&&this.Kl===t||(this.zl=function(i,e,o){if(i.Bt.m()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Bt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _r()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.Gl,t,this.Hl.bind(this)),this.Kl=t),this.zl},tp.prototype.isEqual=function(t){if(!(t instanceof tp))throw ai("isEqual","QuerySnapshot",1,t);return this.$l===t.$l&&ku(this.Wl,t.Wl)&&this.Gl.isEqual(t.Gl)&&this.Rh===t.Rh},tp.prototype.Hl=function(t,e,n){return new Uf(this.$l,t.key,t,e,n,this.Rh)},tp),Jf=(n(Zf,Kf=Xf),Object.defineProperty(Zf.prototype,"id",{get:function(){return this.Ql.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Zf.prototype,"parent",{get:function(){var t=this.Ql.path.h();return t.m()?null:new Vf(new qr(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Zf.prototype,"path",{get:function(){return this.Ql.path.R()},enumerable:!1,configurable:!0}),Zf.prototype.doc=function(t){return Xr("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=fi.L()),$r("CollectionReference.doc","non-empty string",1,t),t=Fr.P(t),Vf.Cl(this.Ql.path.child(t),this.firestore,this.Rh)},Zf.prototype.add=function(t){Wr("CollectionReference.add",arguments,1),$r("CollectionReference.add","object",1,t=this.Rh?this.Rh.toFirestore(t):t);var e=this.doc();return new Vf(e.Ih,this.firestore,null).set(t).then(function(){return e})},Zf.prototype.withConverter=function(t){return new Zf(this.Yl,this.firestore,t)},Zf);function Zf(t,e,n){var r=this;if(((r=Kf.call(this,Iu(t),e,n)||this).Yl=t).length%2!=1)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.R()+" has "+t.length);return r}function tp(t,e,n,r){this.$l=t,this.Wl=e,this.Gl=n,this.Rh=r,this.zl=null,this.Kl=null,this.metadata=new _f(n.hasPendingWrites,n.fromCache)}function ep(t,e,n){this.Ql=t,this.firestore=e,this.Rh=n}function np(t,e){if(void 0===e)return{merge:!1};if(ui(t,e,["merge","mergeFields"]),ti(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+oi(n));for(var r,i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof il))throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+oi(n[i]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function rp(t,e){return void 0===e?{}:(ui(t,e,["serverTimestamps"]),ei(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function ip(t,e){Jr(t,"object",1,e),e&&(ui(t,e,["source"]),ei(t,0,"source",e.source,["default","server","cache"]))}function op(t,e,n){if(e instanceof Bl){if(e.firestore!==n)throw new Tr(Ir.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw ai(t,"DocumentReference",1,e)}function sp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var up,ap,l=(n(cp,up=Fl),cp.serverTimestamp=function(){Yr("FieldValue.serverTimestamp",arguments);var t=new Ul("serverTimestamp");return t.uh="FieldValue.serverTimestamp",new cp(t)},cp.delete=function(){Yr("FieldValue.delete",arguments);var t=new ul("deleteField");return t.uh="FieldValue.delete",new cp(t)},cp.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Kr("FieldValue.arrayUnion",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Kr("arrayUnion()",arguments,1),new Pl("arrayUnion",t)}.apply(void 0,t);return n.uh="FieldValue.arrayUnion",new cp(n)},cp.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Kr("FieldValue.arrayRemove",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Kr("arrayRemove()",arguments,1),new Cl("arrayRemove",t)}.apply(void 0,t);return n.uh="FieldValue.arrayRemove",new cp(n)},cp.increment=function(t){return $r("FieldValue.increment","number",1,t),Wr("FieldValue.increment",arguments,1),(t=new Ml("increment",t)).uh="FieldValue.increment",new cp(t)},cp.prototype.isEqual=function(t){return this.Th.isEqual(t.Th)},cp),hp={Firestore:Sf,GeoPoint:xl,Timestamp:Li,Blob:Ai,Transaction:Of,WriteBatch:Df,DocumentReference:Vf,DocumentSnapshot:kf,Query:Xf,QueryDocumentSnapshot:Uf,QuerySnapshot:$f,CollectionReference:Jf,FieldPath:il,FieldValue:l,setLogLevel:Sf.setLogLevel,CACHE_SIZE_UNLIMITED:Rf};function cp(){return null!==up&&up.apply(this,arguments)||this}(ap=e.default).INTERNAL.registerComponent(new wr("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new Sf(e,t,new tl,new el);var e},"PUBLIC").setServiceProps(Object.assign({},hp))),ap.registerVersion("@firebase/firestore","1.18.0-alpha.96ae6a5fe")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t=t||self).firebase)}(this,function(lf){"use strict";try{(function(){lf=lf&&Object.prototype.hasOwnProperty.call(lf,"default")?lf.default:lf;var t,p,e,i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function l(t,s,u,a){return new(u=u||Promise)(function(n,e){function i(t){try{o(a.next(t))}catch(t){e(t)}}function r(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(i,r)}o((a=a.apply(t,s||[])).next())})}function d(n,i){var r,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=i.call(n,u)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function y(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,r++)i[r]=o[s];return i}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,r++)i[r]=o[s];return i}function r(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var r=(new Date).toISOString(),o=a[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+r+"]  "+t.name+":"],n))}}(e=p=p||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";var o={debug:p.DEBUG,verbose:p.VERBOSE,info:p.INFO,warn:p.WARN,error:p.ERROR,silent:p.SILENT},u=p.INFO,a=((t={})[p.DEBUG]="log",t[p.VERBOSE]="log",t[p.INFO]="info",t[p.WARN]="warn",t[p.ERROR]="error",t),h=(Object.defineProperty(c.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in p))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!0,configurable:!0}),c.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(c.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!0,configurable:!0}),c.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.DEBUG],t)),this._logHandler.apply(this,s([this,p.DEBUG],t))},c.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.VERBOSE],t)),this._logHandler.apply(this,s([this,p.VERBOSE],t))},c.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.INFO],t)),this._logHandler.apply(this,s([this,p.INFO],t))},c.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.WARN],t)),this._logHandler.apply(this,s([this,p.WARN],t))},c.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.ERROR],t)),this._logHandler.apply(this,s([this,p.ERROR],t))},c);function c(t){this.name=t,this._logLevel=u,this._logHandler=r,this._userLogHandler=null}function v(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var f,g=(n(m,f=Error),m);function m(t,e){var n=f.call(this,e)||this;return n.code=t,n.name="FirebaseError",Object.setPrototypeOf(n,m.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,w.prototype.create),n}var w=(b.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i,r=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(i=r,s.replace(E,function(t,e){var n=i[e];return null!=n?n.toString():"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new g(o,a),c=0,f=Object.keys(r);c<f.length;c++){var l=f[c];"_"!==l.slice(-1)&&(l in h&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),h[l]=r[l])}return h},b);function b(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g,I=(T.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},T.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},T.prototype.setServiceProps=function(t){return this.serviceProps=t,this},T);function T(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,_="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},R=R||{},D=_||self;function S(){}function O(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function k(t){var e=O(t);return"array"==e||"object"==e&&"number"==typeof t.length}function L(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),V=0;function U(t,e,n){return t.call.apply(t.bind,arguments)}function M(e,n,t){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,i),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?U:M).apply(null,arguments)}function q(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var x=Date.now||function(){return+new Date};function j(t,e){function n(){}n.prototype=e.prototype,t.M=e.prototype,t.prototype=new n,t.prototype.constructor=t}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.da=function(){!this.j&&(this.j=!0,this.C(),0)&&(Object.prototype.hasOwnProperty.call(this,P)&&this[P]||(this[P]=++V))},F.prototype.C=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var B=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,r="string"==typeof t?t.split(""):t,o=0;o<i;o++)o in r&&e.call(n,r[o],o,t)};function z(t){return Array.prototype.concat.apply([],arguments)}function H(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}function W(t){return/^[\s\xa0]*$/.test(t)}var Q,X=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function K(t,e){return t<e?-1:e<t?1:0}t:{var $=D.navigator;if($){var J=$.userAgent;if(J){Q=J;break t}}Q=""}function Z(t,e,n){for(var i in t)e.call(n,t[i],i,t)}function tt(t){var e={};for(var n in t)e[n]=t[n];return e}var et="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function nt(t,e){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])t[n]=i[n];for(var o=0;o<et.length;o++)n=et[o],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function it(t){return it[" "](t),t}it[" "]=S;var rt,ot,st=Y(Q,"Opera"),ut=Y(Q,"Trident")||Y(Q,"MSIE"),at=Y(Q,"Edge"),ht=at||ut,ct=Y(Q,"Gecko")&&!(Y(Q.toLowerCase(),"webkit")&&!Y(Q,"Edge"))&&!(Y(Q,"Trident")||Y(Q,"MSIE"))&&!Y(Q,"Edge"),ft=Y(Q.toLowerCase(),"webkit")&&!Y(Q,"Edge");function lt(){var t=D.document;return t?t.documentMode:void 0}t:{var pt="",dt=(ot=Q,ct?/rv:([^\);]+)(\)|;)/.exec(ot):at?/Edge\/([\d\.]+)/.exec(ot):ut?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ot):ft?/WebKit\/(\S+)/.exec(ot):st?/(?:Version)[ \/]?(\S+)/.exec(ot):void 0);if(dt&&(pt=dt?dt[1]:""),ut){var yt=lt();if(null!=yt&&yt>parseFloat(pt)){rt=String(yt);break t}}rt=pt}var vt={};function gt(u){return t=u,e=function(){for(var t=0,e=X(String(rt)).split("."),n=X(String(u)).split("."),i=Math.max(e.length,n.length),r=0;0==t&&r<i;r++){var o=e[r]||"",s=n[r]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=K(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||K(0==o[2].length,0==s[2].length)||K(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=vt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var mt=D.document&&ut&&(lt()||parseInt(rt,10))||void 0,wt=!ut||9<=Number(mt),bt=ut&&!gt("9"),Et=function(){if(!D.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{D.addEventListener("test",S,e),D.removeEventListener("test",S,e)}catch(t){}return t}();function It(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Tt(t,e){if(It.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ct){t:{try{it(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:At[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}It.prototype.b=function(){this.defaultPrevented=!0},j(Tt,It);var At={2:"touch",3:"pen",4:"mouse"};Tt.prototype.b=function(){Tt.M.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,bt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Nt="closure_listenable_"+(1e6*Math.random()|0),_t=0;function Rt(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.aa=r,this.key=++_t,this.V=this.X=!1}function Dt(t){t.V=!0,t.listener=null,t.proxy=null,t.src=null,t.aa=null}function St(t){this.src=t,this.a={},this.b=0}function Ot(t,e){var n,i,r,o=e.type;o in t.a&&(i=t.a[o],(n=0<=(r=B(i,e)))&&Array.prototype.splice.call(i,r,1),n&&(Dt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function kt(t,e,n,i){for(var r=0;r<t.length;++r){var o=t[r];if(!o.V&&o.listener==e&&o.capture==!!n&&o.aa==i)return r}return-1}St.prototype.add=function(t,e,n,i,r){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=kt(t,e,i,r);return-1<s?(e=t[s],n||(e.X=!1)):((e=new Rt(e,this.src,o,!!i,r)).X=n,t.push(e)),e};var Lt="closure_lm_"+(1e6*Math.random()|0),Pt={};function Vt(t,e,n,i,r){if(i&&i.once)return function t(e,n,i,r,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);return null}return i=Bt(i),e&&e[Nt]?e.sa(n,i,L(r)?!!r.capture:!!r,o):Ut(e,n,i,!0,r,o)}(t,e,n,i,r);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Vt(t,e[o],n,i,r);return null}return n=Bt(n),t&&t[Nt]?t.ra(e,n,L(i)?!!i.capture:!!i,r):Ut(t,e,n,!1,i,r)}function Ut(t,e,n,i,r,o){if(!e)throw Error("Invalid event type");var s=L(r)?!!r.capture:!!r;if(s&&!wt)return null;var u,a,h=jt(t);if(h||(t[Lt]=h=new St(t)),(n=h.add(e,n,i,s,o)).proxy)return n;if(u=xt,i=a=wt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=i).src=t,i.listener=n,t.addEventListener)Et||(r=s),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(Ct(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function Mt(t){var e,n,i;"number"!=typeof t&&t&&!t.V&&((e=t.src)&&e[Nt]?Ot(e.c,t):(n=t.type,i=t.proxy,e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(Ct(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=jt(e))?(Ot(n,t),0==n.b&&(n.src=null,e[Lt]=null)):Dt(t)))}function Ct(t){return t in Pt?Pt[t]:Pt[t]="on"+t}function qt(t,e){var n=t.listener,i=t.aa||t.src;return t.X&&Mt(t),n.call(i,e)}function xt(t,e){if(t.V)return!0;if(wt)return qt(t,new Tt(e,this));if(!e)t:{e=["window","event"];for(var n=D,i=0;i<e.length;i++)if(null==(n=n[e[i]])){e=null;break t}e=n}return qt(t,e=new Tt(e,this))}function jt(t){return(t=t[Lt])instanceof St?t:null}var Ft="__closure_events_fn_"+(1e9*Math.random()>>>0);function Bt(e){return"function"==O(e)?e:(e[Ft]||(e[Ft]=function(t){return e.handleEvent(t)}),e[Ft])}function Gt(){F.call(this),this.c=new St(this),(this.J=this).A=null}function zt(t,e,n,i){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var r=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.V&&a.capture==n&&(s=a.listener,u=a.aa||a.src,a.X&&Ot(t.c,a),r=!1!==s.call(u,i)&&r)}return r&&!i.defaultPrevented}j(Gt,F),Gt.prototype[Nt]=!0,(N=Gt.prototype).addEventListener=function(t,e,n,i){Vt(this,t,e,n,i)},N.removeEventListener=function(t,e,n,i){!function t(e,n,i,r,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);else r=L(r)?!!r.capture:!!r,i=Bt(i),e&&e[Nt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(i=kt(s=e.a[n],i,r,o))&&(Dt(s[i]),Array.prototype.splice.call(s,i,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&jt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=kt(n,i,r,o)),(i=-1<e?n[e]:null)&&Mt(i))}(this,t,e,n,i)},N.dispatchEvent=function(t){var e,n=this.A;if(n)for(e=[];n;n=n.A)e.push(n);n=this.J;var i=t.type||t;if("string"==typeof t?t=new It(t,n):t instanceof It?t.target=t.target||n:(s=t,nt(t=new It(i,n),s)),s=!0,e)for(var r=e.length-1;0<=r;r--)var o=t.a=e[r],s=zt(o,i,!0,t)&&s;if(s=zt(o=t.a=n,i,!0,t)&&s,s=zt(o,i,!1,t)&&s,e)for(r=0;r<e.length;r++)s=zt(o=t.a=e[r],i,!1,t)&&s;return s},N.C=function(){if(Gt.M.C.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],i=0;i<n.length;i++)Dt(n[i]);delete e.a[t],e.b--}}this.A=null},N.ra=function(t,e,n,i){return this.c.add(String(t),e,!1,n,i)},N.sa=function(t,e,n,i){return this.c.add(String(t),e,!0,n,i)};var Ht=D.JSON.stringify;function Wt(){this.b=this.a=null}var Qt,Xt=(Yt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Yt(function(){return new Kt},function(t){t.reset()},100));function Yt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Kt(){this.next=this.b=this.a=null}function $t(t){D.setTimeout(function(){throw t},0)}function Jt(t,e){var n;Qt||(n=D.Promise.resolve(void 0),Qt=function(){n.then(ee)}),Zt||(Qt(),Zt=!0),te.add(t,e)}Wt.prototype.add=function(t,e){var n=Xt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Kt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Zt=!(Kt.prototype.reset=function(){this.next=this.b=this.a=null}),te=new Wt;function ee(){for(var t,e,n;n=e=void 0,n=null,(e=te).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){$t(t)}var i=Xt;i.g(t),i.b<i.f&&(i.b++,t.next=i.a,i.a=t)}Zt=!1}function ne(t,e){Gt.call(this),this.b=t||1,this.a=e||D,this.f=C(this.Ua,this),this.g=x()}function ie(t){t.Z=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function re(t,e,n){if("function"==O(t))n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:D.setTimeout(t,e||0)}function oe(t,e,n){F.call(this),this.f=null!=n?C(t,n):t,this.c=e,this.b=C(this.Pa,this),this.a=[]}function se(t){t.T=re(t.b,t.c),t.f.apply(null,t.a)}function ue(t){F.call(this),this.b=t,this.a={}}j(ne,Gt),(N=ne.prototype).Z=!1,N.L=null,N.Ua=function(){var t;this.Z&&(0<(t=x()-this.g)&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.Z&&(ie(this),this.start())))},N.start=function(){this.Z=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=x())},N.C=function(){ne.M.C.call(this),ie(this),delete this.a},j(oe,F),(N=oe.prototype).ba=!1,N.T=null,N.Ia=function(t){this.a=arguments,this.T?this.ba=!0:se(this)},N.C=function(){oe.M.C.call(this),this.T&&(D.clearTimeout(this.T),this.T=null,this.ba=!1,this.a=[])},N.Pa=function(){this.T=null,this.ba&&(this.ba=!1,se(this))},j(ue,F);var ae=[];function he(t,e,n,i){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var r=0;r<n.length;r++){var o=Vt(e,n[r],i||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ce(t){Z(t.a,function(t,e){this.a.hasOwnProperty(e)&&Mt(t)},t),t.a={}}function fe(){}ue.prototype.C=function(){ue.M.C.call(this),ce(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var le=null;function pe(){return le=le||new Gt}function de(t){It.call(this,"serverreachability",t)}function ye(){var t=pe();t.dispatchEvent(new de(t))}function ve(t){It.call(this,"statevent",t)}function ge(){var t=pe();t.dispatchEvent(new ve(t))}function me(t){It.call(this,"timingevent",t)}function we(t,e){if("function"!=O(t))throw Error("Fn must not be null and must be a function");return D.setTimeout(function(){t()},e)}j(de,It),j(ve,It),j(me,It);var be={NO_ERROR:0,Va:1,bb:2,ab:3,Ya:4,$a:5,cb:6,za:7,TIMEOUT:8,gb:9},Ee={Xa:"complete",kb:"success",Aa:"error",za:"abort",ib:"ready",jb:"readystatechange",TIMEOUT:"timeout",eb:"incrementaldata",hb:"progress",Za:"downloadprogress",lb:"uploadprogress"};function Ie(){}function Te(t){var e;return(e=t.a)||(e=t.a={}),e}function Ae(){}Ie.prototype.a=null;var Ne,_e={OPEN:"a",Wa:"b",Aa:"c",fb:"d"};function Re(){It.call(this,"d")}function De(){It.call(this,"c")}function Se(){}function Oe(t,e,n){this.g=t,this.W=e,this.U=n||1,this.G=new ue(this),this.N=ke,t=ht?125:void 0,this.O=new ne(t),this.m=null,this.b=!1,this.j=this.A=this.f=this.B=this.s=this.P=this.h=null,this.i=[],this.a=null,this.w=0,this.c=this.v=null,this.H=-1,this.l=!1,this.J=0,this.D=null,this.o=this.R=this.F=!1}j(Re,It),j(De,It),j(Se,Ie),Ne=new Se;var ke=45e3,Le={},Pe={};function Ve(t,e,n){t.B=1,t.f=en(Ye(e)),t.j=n,t.F=!0,Ue(t,null)}function Ue(t,e){t.s=x(),Ce(t),t.A=Ye(t.f);var n=t.A,i=t.U;Array.isArray(i)||(i=[String(i)]),yn(n.b,"t",i),t.w=0,t.a=si(t.g,t.g.w?e:null),0<t.J&&(t.D=new oe(C(t.ya,t,t.a),t.J)),he(t.G,t.a,"readystatechange",t.Sa),e=t.m?tt(t.m):{},t.j?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.$(t.A,t.v,t.j,e)):(t.v="GET",t.a.$(t.A,t.v,null,e)),ye()}function Me(t,e,n){for(var i,r,o,s,u=!0;!t.l&&t.w<n.length;){var a=(r=n,s=o=void 0,o=(i=t).w,-1==(s=r.indexOf("\n",o))?Pe:(o=Number(r.substring(o,s)),isNaN(o)?Le:(s+=1)+o>r.length?Pe:(r=r.substr(s,o),i.w=s+o,r)));if(a==Pe){4==e&&(t.c=4,ge(),u=!1);break}if(a==Le){t.c=4,ge(),u=!1;break}Be(t,a)}4==e&&0==n.length&&(t.c=1,ge(),u=!1),t.b=t.b&&u,u||(Fe(t),je(t))}function Ce(t){t.P=x()+t.N,qe(t,t.N)}function qe(t,e){if(null!=t.h)throw Error("WatchDog timer not null");t.h=we(C(t.Qa,t),e)}function xe(t){t.h&&(D.clearTimeout(t.h),t.h=null)}function je(t){0==t.g.u||t.l||ei(t.g,t)}function Fe(t){xe(t);var e=t.D;e&&"function"==typeof e.da&&e.da(),t.D=null,ie(t.O),ce(t.G),t.a&&(e=t.a,t.a=null,e.abort(),e.da())}function Be(t,e){try{var n,i,r,o,s,u,a,h,c,f,l=t.g;if(0!=l.u&&(l.a==t||In(l.b,t)))if(l.A=t.H,!t.o&&In(l.b,t)&&3==l.u){try{var p=l.ja.a.parse(e)}catch(t){p=null}if(Array.isArray(p)&&3==p.length){var d=p;if(0==d[0]){t:if(!l.i){if(l.a){if(!(l.a.s+3e3<t.s))break t;ti(l),l.a.cancel(),l.a=null}Zn(l),ge()}}else l.ia=d[1],0<l.ia-l.G&&d[2]<37500&&l.U&&0==l.m&&!l.l&&(l.l=we(C(l.Na,l),6e3));if(En(l.b)<=1&&l.O){try{l.O()}catch(t){}l.O=void 0}}else ii(l,11)}else if(!t.o&&l.a!=t||ti(l),!W(e))for(e=p=l.ja.a.parse(e),p=0;p<e.length;p++){d=e[p],l.G=d[0],d=d[1],2==l.u?"c"==d[0]?(l.B=d[1],l.R=d[2],null!=(n=d[3])&&(l.oa=n),null!=(i=d[5])&&"number"==typeof i&&0<i&&(l.D=1.5*i),r=l,(o=t.a)&&(!(s=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(u=r.b).a&&(Y(s,"spdy")||Y(s,"quic")||Y(s,"h2"))&&(u.f=u.g,u.a=new Set,u.b&&(Tn(u,u.b),u.b=null)),!r.s||(a=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(r.ha=a,tn(r.v,r.s,a))),l.u=3,l.c&&l.c.na(),h=t,(r=l).ea=oi(r,r.w?r.R:null,r.P),h.o?(An(r.b,h),c=h,(f=r.D)&&c.setTimeout(f),c.h&&(xe(c),Ce(c)),r.a=h):Jn(r),0<l.f.length&&Xn(l)):"stop"!=d[0]&&"close"!=d[0]||ii(l,7):3==l.u&&("stop"==d[0]||"close"==d[0]?"stop"==d[0]?ii(l,7):Hn(l):"noop"!=d[0]&&l.c&&l.c.ma(d),l.m=0)}ye()}catch(t){}}function Ge(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(k(t)||"string"==typeof t)G(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.I&&"function"==typeof t.I)n=void 0;else if(k(t)||"string"==typeof t){n=[];for(var i=t.length,r=0;r<i;r++)n.push(r)}else for(r in n=[],i=0,t)n[i++]=r;r=(i=function(t){if(t.I&&"function"==typeof t.I)return t.I();if("string"==typeof t)return t.split("");if(k(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t)).length;for(var o=0;o<r;o++)e.call(void 0,i[o],n&&n[o],t)}}function ze(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof ze)for(n=t.K(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function He(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var i=t.a[e];We(t.b,i)&&(t.a[n++]=i),e++}t.a.length=n}if(t.c!=t.a.length){for(var r={},n=e=0;e<t.a.length;)We(r,i=t.a[e])||(r[t.a[n++]=i]=1),e++;t.a.length=n}}function We(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=Oe.prototype).setTimeout=function(t){this.N=t},N.Sa=function(t){t=t.target;var e=this.D;e&&3==Fn(t)?e.Ia():this.ya(t)},N.ya=function(t){try{if(t==this.a)t:{var e=Fn(this.a),n=this.a.qa();this.a.S();if(!(e<3||3==e&&!ht&&!this.a.Y())){this.l||4!=e||7==n||ye(),xe(this);var i=this.a.S();this.H=i;var r=this.a.Y();if(this.b=200==i){if(this.R&&!this.o){e:{if(this.a){var o,s=this.a;if((o=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!W(o)){var u=o;break e}}u=null}if(!u){this.b=!1,this.c=3,ge(),Fe(this),je(this);break t}this.o=!0,Be(this,u)}this.F?(Me(this,e,r),ht&&this.b&&3==e&&(he(this.G,this.O,"tick",this.Ra),this.O.start())):Be(this,r),4==e&&Fe(this),this.b&&!this.l&&(4==e?ei(this.g,this):(this.b=!1,Ce(this)))}else 400==i&&0<r.indexOf("Unknown SID")?this.c=3:this.c=0,ge(),Fe(this),je(this)}}}catch(t){}},N.Ra=function(){var t,e;this.a&&(t=Fn(this.a),e=this.a.Y(),this.w<e.length&&(xe(this),Me(this,t,e),this.b&&4!=t&&Ce(this)))},N.cancel=function(){this.l=!0,Fe(this)},N.Qa=function(){this.h=null;var t=x();0<=t-this.P?(2!=this.B&&(ye(),ge()),Fe(this),this.c=2,je(this)):qe(this,this.P-t)},(N=ze.prototype).I=function(){He(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.K=function(){return He(this),this.a.concat()},N.get=function(t,e){return We(this.b,t)?this.b[t]:e},N.set=function(t,e){We(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.K(),i=0;i<n.length;i++){var r=n[i],o=this.get(r);t.call(e,o,r,this)}};var Qe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Xe(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Xe?(this.a=void 0!==e?e:t.a,Ke(this,t.f),this.j=t.j,$e(this,t.c),Je(this,t.h),this.g=t.g,e=t.b,(n=new fn).c=e.c,e.a&&(n.a=new ze(e.a),n.b=e.b),Ze(this,n),this.i=t.i):t&&(n=String(t).match(Qe))?(this.a=!!e,Ke(this,n[1]||"",!0),this.j=nn(n[2]||""),$e(this,n[3]||"",!0),Je(this,n[4]),this.g=nn(n[5]||"",!0),Ze(this,n[6]||"",!0),this.i=nn(n[7]||"")):(this.a=!!e,this.b=new fn(null,this.a))}function Ye(t){return new Xe(t)}function Ke(t,e,n){t.f=n?nn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function $e(t,e,n){t.c=n?nn(e,!0):e}function Je(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ze(t,e,n){var i,r;e instanceof fn?(t.b=e,i=t.b,(r=t.a)&&!i.f&&(ln(i),i.c=null,i.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(pn(this,e),yn(this,n,t))},i)),i.f=r):(n||(e=rn(e,hn)),t.b=new fn(e,t.a))}function tn(t,e,n){t.b.set(e,n)}function en(t){return tn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^x()).toString(36)),t}function nn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function rn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,on),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function on(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Xe.prototype.toString=function(){var t=[],e=this.f;e&&t.push(rn(e,sn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(rn(e,sn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(rn(n,"/"==n.charAt(0)?an:un,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",rn(n,cn)),t.join("")};var sn=/[#\/\?@]/g,un=/[#\?:]/g,an=/[#\?]/g,hn=/[#\?@]/g,cn=/#/g;function fn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function ln(u){u.a||(u.a=new ze,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,i=t[e].indexOf("="),r=null;0<=i?(n=t[e].substring(0,i),r=t[e].substring(i+1)):n=t[e],o=n,s=r?decodeURIComponent(r.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function pn(t,e){ln(t),e=vn(t,e),We(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,We((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&He(t)))}function dn(t,e){return ln(t),e=vn(t,e),We(t.a.b,e)}function yn(t,e,n){pn(t,e),0<n.length&&(t.c=null,t.a.set(vn(t,e),H(n)),t.b+=n.length)}function vn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function gn(t,e){this.b=t,this.a=e}function mn(t){this.g=t||wn,t=D.PerformanceNavigationTiming?0<(t=D.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(D.ca&&D.ca.ua&&D.ca.ua()&&D.ca.ua().mb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(N=fn.prototype).add=function(t,e){ln(this),this.c=null,t=vn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,i){ln(this),this.a.forEach(function(t,e){G(t,function(t){n.call(i,t,e,this)},this)},this)},N.K=function(){ln(this);for(var t=this.a.I(),e=this.a.K(),n=[],i=0;i<e.length;i++)for(var r=t[i],o=0;o<r.length;o++)n.push(e[i]);return n},N.I=function(t){ln(this);var e=[];if("string"==typeof t)dn(this,t)&&(e=z(e,this.a.get(vn(this,t))));else{t=this.a.I();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},N.set=function(t,e){return ln(this),this.c=null,dn(this,t=vn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.I(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++)for(var i=e[n],r=encodeURIComponent(String(i)),i=this.I(i),o=0;o<i.length;o++){var s=r;""!==i[o]&&(s+="="+encodeURIComponent(String(i[o]))),t.push(s)}return this.c=t.join("&")};var wn=10;function bn(t){return t.b||t.a&&t.a.size>=t.f}function En(t){return t.b?1:t.a?t.a.size:0}function In(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Tn(t,e){t.a?t.a.add(e):t.b=e}function An(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Nn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.i);if(null==t.a||0===t.a.size)return H(t.c);var i=t.c;try{for(var r=A(t.a.values()),o=r.next();!o.done;o=r.next())var s=o.value,i=i.concat(s.i)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return i}function _n(){}function Rn(){this.a=new _n}function Dn(t,i,e){var r=e||"";try{Ge(t,function(t,e){var n=t;L(t)&&(n=Ht(t)),i.push(r+e+"="+encodeURIComponent(n))})}catch(t){throw i.push(r+"type="+encodeURIComponent("_badmap")),t}}function Sn(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}mn.prototype.cancel=function(){var t,e;if(this.c=Nn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),i=n.next();!i.done;i=n.next())i.value.cancel()}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},_n.prototype.stringify=function(t){return D.JSON.stringify(t,void 0)},_n.prototype.parse=function(t){return D.JSON.parse(t,void 0)};var On=D.JSON.parse;function kn(t){Gt.call(this),this.headers=new ze,this.G=t||null,this.b=!1,this.s=this.a=null,this.D="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.H=Ln,this.B=this.F=!1}j(kn,Gt);var Ln="",Pn=/^https?$/i,Vn=["POST","PUT"];function Un(t){return"content-type"==t.toLowerCase()}function Mn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Cn(t),xn(t)}function Cn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function qn(t){if(t.b&&void 0!==R&&(!t.s[1]||4!=Fn(t)||2!=t.S()))if(t.l&&4==Fn(t))re(t.va,0,t);else if(t.dispatchEvent("readystatechange"),4==Fn(t)){t.b=!1;try{var e,n,i,r,o=t.S();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(r=String(t.D).match(Qe)[1]||null)&&D.self&&D.self.location&&(r=(i=D.self.location.protocol).substr(0,i.length-1)),n=!Pn.test(r?r.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Fn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.S()+"]",Cn(t)}}finally{xn(t)}}}function xn(t,e){if(t.a){jn(t);var n=t.a,i=t.s[0]?S:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=i}catch(t){}}}function jn(t){t.a&&t.B&&(t.a.ontimeout=null),t.m&&(D.clearTimeout(t.m),t.m=null)}function Fn(t){return t.a?t.a.readyState:0}function Bn(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}var r;i||(r="",Z(n,function(t,e){r+=e,r+=":",r+=t,r+="\r\n"}),n=r,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):tn(t,e,n))}function Gn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function zn(t){this.f=[],this.R=this.ea=this.v=this.P=this.a=this.ha=this.s=this.N=this.h=this.F=this.j=null,this.Fa=this.H=0,this.Ca=Gn("failFast",!1,t),this.U=this.l=this.i=this.g=this.c=null,this.W=!0,this.A=this.ia=this.G=-1,this.J=this.m=this.o=0,this.Ba=Gn("baseRetryDelayMs",5e3,t),this.Ga=Gn("retryDelaySeedMs",1e4,t),this.Da=Gn("forwardChannelMaxRetries",2,t),this.ga=Gn("forwardChannelRequestTimeoutMs",2e4,t),this.Ea=t&&t.nb||void 0,this.D=void 0,this.w=t&&t.supportsCrossDomainXhr||!1,this.B="",this.b=new mn(t&&t.concurrentRequestLimit),this.ja=new Rn,this.fa=t&&t.fastHandshake||!1,t&&t.forceLongPolling&&(this.W=!1),this.O=void 0}function Hn(t){var e,n;Wn(t),3==t.u&&(e=t.H++,tn(n=Ye(t.v),"SID",t.B),tn(n,"RID",e),tn(n,"TYPE","terminate"),Kn(t,n),(e=new Oe(t,e,void 0)).B=2,e.f=en(Ye(n)),n=!1,D.navigator&&D.navigator.sendBeacon&&(n=D.navigator.sendBeacon(e.f.toString(),"")),!n&&D.Image&&((new Image).src=e.f,n=!0),n||(e.a=si(e.g,null),e.a.$(e.f)),e.s=x(),Ce(e)),ri(t)}function Wn(t){t.a&&(t.a.cancel(),t.a=null),t.i&&(D.clearTimeout(t.i),t.i=null),ti(t),t.b.cancel(),t.g&&("number"==typeof t.g&&D.clearTimeout(t.g),t.g=null)}function Qn(t,e){t.f.push(new gn(t.Fa++,e)),3==t.u&&Xn(t)}function Xn(t){bn(t.b)||t.g||(t.g=!0,Jt(t.xa,t),t.o=0)}function Yn(t,e){var n=e?e.W:t.H++,i=Ye(t.v);tn(i,"SID",t.B),tn(i,"RID",n),tn(i,"AID",t.G),Kn(t,i),t.h&&t.j&&Bn(i,t.h,t.j),n=new Oe(t,n,t.o+1),null===t.h&&(n.m=t.j),e&&(t.f=e.i.concat(t.f)),e=$n(t,n,1e3),n.setTimeout(Math.round(.5*t.ga)+Math.round(.5*t.ga*Math.random())),Tn(t.b,n),Ve(n,i,e)}function Kn(t,n){t.c&&Ge({},function(t,e){tn(n,e,t)})}function $n(t,e,n){n=Math.min(t.f.length,n);var i=t.c?C(t.c.Ha,t.c,t):null;t:for(var r=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=r[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=r[a].b,c=r[a].a;if((h-=o)<0)o=Math.max(0,r[a].b-100),u=!1;else try{Dn(c,s,"req"+h+"_")}catch(t){i&&i(c)}}if(u){i=s.join("&");break t}}return t=t.f.splice(0,n),e.i=t,i}function Jn(t){t.a||t.i||(t.J=1,Jt(t.wa,t),t.m=0)}function Zn(t){return!(t.a||t.i||3<=t.m)&&(t.J++,t.i=we(C(t.wa,t),ni(t,t.m)),t.m++,1)}function ti(t){null!=t.l&&(D.clearTimeout(t.l),t.l=null)}function ei(t,e){var n,i=null;if(t.a==e){ti(t),t.a=null;var r=2}else{if(!In(t.b,e))return;i=e.i,An(t.b,e),r=1}if(t.A=e.H,0!=t.u)if(e.b){1==r?(i=e.j?e.j.length:0,e=x()-e.s,n=t.o,(r=pe()).dispatchEvent(new me(r)),Xn(t)):Jn(t)}else if(3==(n=e.c)||0==n&&0<t.A||!(1==r&&function(t,e){if(!(En(t.b)>=t.b.f-(t.g?1:0))){if(t.g)return t.f=e.i.concat(t.f),1;if(!(1==t.u||2==t.u||t.o>=(t.Ca?0:t.Da)))return t.g=we(C(t.xa,t,e),ni(t,t.o)),t.o++,1}}(t,e)||2==r&&Zn(t)))switch(i&&0<i.length&&(e=t.b,e.c=e.c.concat(i)),n){case 1:ii(t,5);break;case 4:ii(t,10);break;case 3:ii(t,6);break;default:ii(t,2)}}function ni(t,e){var n=t.Ba+Math.floor(Math.random()*t.Ga);return t.c||(n*=2),n*e}function ii(t,e){var n,i,r,o,s,u;2==e?(n=null,t.c&&(n=null),i=C(t.Ta,t),n||(n=new Xe("//www.google.com/images/cleardot.gif"),D.location&&"http"==D.location.protocol||Ke(n,"https"),en(n)),r=n.toString(),o=i,u=new fe,D.Image?((s=new Image).onload=q(Sn,u,s,"TestLoadImage: loaded",!0,o),s.onerror=q(Sn,u,s,"TestLoadImage: error",!1,o),s.onabort=q(Sn,u,s,"TestLoadImage: abort",!1,o),s.ontimeout=q(Sn,u,s,"TestLoadImage: timeout",!1,o),D.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=r):o(!1)):ge(),t.u=0,t.c&&t.c.la(e),ri(t),Wn(t)}function ri(t){t.u=0,t.A=-1,t.c&&(0==Nn(t.b).length&&0==t.f.length||(t.b.c.length=0,H(t.f),t.f.length=0),t.c.ka())}function oi(t,e,n){var i,r,o,s,u,a,h,c=(i=n)instanceof Xe?Ye(i):new Xe(i,void 0);return""!=c.c?(e&&$e(c,e+"."+c.c),Je(c,c.h)):(o=(r=D.location).protocol,s=e?e+"."+r.hostname:r.hostname,u=+r.port,a=n,h=new Xe(null,void 0),o&&Ke(h,o),s&&$e(h,s),u&&Je(h,u),a&&(h.g=a),c=h),t.N&&Z(t.N,function(t,e){tn(c,e,t)}),e=t.s,n=t.ha,e&&n&&tn(c,e,n),tn(c,"VER",t.oa),Kn(t,c),c}function si(t,e){if(e&&!t.w)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new kn(t.Ea)).F=t.w,e}function ui(){}function ai(){if(ut&&!(10<=Number(mt)))throw Error("Environmental error: no available transport.")}function hi(t,e){Gt.call(this),this.a=new zn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.j=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.pa&&(t?t["X-WebChannel-Client-Profile"]=e.pa:t={"X-WebChannel-Client-Profile":e.pa}),this.a.F=t,(t=e&&e.httpHeadersOverwriteParam)&&!W(t)&&(this.a.h=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!W(e)&&(this.a.s=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new li(this)}function ci(t){Re.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function fi(){De.call(this),this.status=1}function li(t){this.a=t}(N=kn.prototype).$=function(t,e,n,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.G?Te(this.G):Te(Ne),this.a.onreadystatechange=C(this.va,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void Mn(this,t)}t=n||"";var r,o=new ze(this.headers);i&&Ge(i,function(t,e){o.set(e,t)}),i=function(t){t:{for(var e=Un,n=t.length,i="string"==typeof t?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.K()),n=D.FormData&&t instanceof D.FormData,0<=B(Vn,e)&&!i&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.H&&(this.a.responseType=this.H),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{jn(this),0<this.o&&((this.B=(r=this.a,ut&&gt(9)&&"number"==typeof r.timeout&&void 0!==r.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=C(this.ta,this)):this.m=re(this.ta,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Mn(this,t)}},N.ta=function(){void 0!==R&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),xn(this))},N.C=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),xn(this,!0)),kn.M.C.call(this)},N.va=function(){this.j||(this.w||this.l||this.g?qn(this):this.Oa())},N.Oa=function(){qn(this)},N.S=function(){try{return 2<Fn(this)?this.a.status:-1}catch(t){return-1}},N.Y=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Ja=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),On(e)}},N.qa=function(){return this.h},N.Ma=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=zn.prototype).oa=8,N.u=1,N.xa=function(t){if(this.g)if(this.g=null,1==this.u){if(!t){this.H=Math.floor(1e5*Math.random()),t=this.H++;var e,n=new Oe(this,t,void 0),i=this.j;if(this.F&&(i?nt(i=tt(i),this.F):i=this.F),null===this.h&&(n.m=i),this.fa)t:{for(var r=e=0;r<this.f.length;r++){var o=this.f[r];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=r;break t}if(4096===e||r===this.f.length-1){e=r+1;break t}}e=1e3}else e=1e3;e=$n(this,n,e),tn(r=Ye(this.v),"RID",t),tn(r,"CVER",22),this.s&&tn(r,"X-HTTP-Session-Id",this.s),Kn(this,r),this.h&&i&&Bn(r,this.h,i),Tn(this.b,n),this.fa?(tn(r,"$req",e),tn(r,"SID","null"),n.R=!0,Ve(n,r,null)):Ve(n,r,e),this.u=2}}else 3==this.u&&(t?Yn(this,t):0==this.f.length||bn(this.b)||Yn(this))},N.wa=function(){this.i=null,this.a=new Oe(this,"rpc",this.J),null===this.h&&(this.a.m=this.j),this.a.J=0;var t=Ye(this.ea);tn(t,"RID","rpc"),tn(t,"SID",this.B),tn(t,"CI",this.U?"0":"1"),tn(t,"AID",this.G),Kn(this,t),tn(t,"TYPE","xmlhttp"),this.h&&this.j&&Bn(t,this.h,this.j),this.D&&this.a.setTimeout(this.D);var e=this.a,n=this.R;e.B=1,e.f=en(Ye(t)),e.j=null,e.F=!0,Ue(e,n)},N.Na=function(){null!=this.l&&(this.l=null,this.a.cancel(),this.a=null,Zn(this),ge())},N.Ta=function(t){ge()},(N=ui.prototype).na=function(){},N.ma=function(){},N.la=function(){},N.ka=function(){},N.Ha=function(){},ai.prototype.a=function(t,e){return new hi(t,e)},j(hi,Gt),(N=hi.prototype).addEventListener=function(t,e,n,i){hi.M.addEventListener.call(this,t,e,n,i)},N.removeEventListener=function(t,e,n,i){hi.M.removeEventListener.call(this,t,e,n,i)},N.Ka=function(){this.a.c=this.f,this.h&&(this.a.w=!0);var t=this.a,e=this.l,n=this.b||void 0;ge(),t.P=e,t.N=n||{},t.U=t.W,t.v=oi(t,null,t.P),Xn(t)},N.close=function(){Hn(this.a)},N.La=function(t){var e;"string"==typeof t?((e={}).__data__=t,Qn(this.a,e)):this.g?((e={}).__data__=Ht(t),Qn(this.a,e)):Qn(this.a,t)},N.C=function(){this.a.c=null,delete this.f,Hn(this.a),delete this.a,hi.M.C.call(this)},j(ci,Re),j(fi,De),j(li,ui),li.prototype.na=function(){this.a.dispatchEvent("a")},li.prototype.ma=function(t){this.a.dispatchEvent(new ci(t))},li.prototype.la=function(t){this.a.dispatchEvent(new fi)},li.prototype.ka=function(){this.a.dispatchEvent("b")},ai.prototype.createWebChannel=ai.prototype.a,hi.prototype.send=hi.prototype.La,hi.prototype.open=hi.prototype.Ka,hi.prototype.close=hi.prototype.close,be.NO_ERROR=0,be.TIMEOUT=8,be.HTTP_ERROR=6,Ee.COMPLETE="complete",(Ae.EventType=_e).OPEN="a",_e.CLOSE="b",_e.ERROR="c",_e.MESSAGE="d",Gt.prototype.listen=Gt.prototype.ra,kn.prototype.listenOnce=kn.prototype.sa,kn.prototype.getLastError=kn.prototype.Ma,kn.prototype.getLastErrorCode=kn.prototype.qa,kn.prototype.getStatus=kn.prototype.S,kn.prototype.getResponseJson=kn.prototype.Ja,kn.prototype.getResponseText=kn.prototype.Y,kn.prototype.send=kn.prototype.$;var pi={createWebChannelTransport:function(){return new ai},ErrorCode:be,EventType:Ee,WebChannel:Ae,XhrIo:kn},di=pi.createWebChannelTransport,yi=pi.ErrorCode,vi=pi.EventType,gi=pi.WebChannel,mi=pi.XhrIo,wi=lf.SDK_VERSION,bi=(Ei.prototype.t=function(){return null!=this.uid},Ei.prototype.s=function(){return this.t()?"uid:"+this.uid:"anonymous-user"},Ei.prototype.isEqual=function(t){return t.uid===this.uid},Ei);function Ei(t){this.uid=t}function Ii(t,e){this.user=e,this.type="OAuth",this.o={},this.o.Authorization="Bearer "+t}bi.UNAUTHENTICATED=new bi(null),bi.i=new bi("google-credentials-uid"),bi.h=new bi("first-party-uid");var Ti,Ai,Ni={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},_i=(n(Gi,Ai=Error),Gi),Ri=(Bi.prototype.getToken=function(){return Promise.resolve(null)},Bi.prototype.l=function(){},Bi.prototype._=function(t){(this.u=t)(bi.UNAUTHENTICATED)},Bi.prototype.T=function(){this.u=null},Bi),Di=(Fi.prototype.getToken=function(){var e=this,n=this.R,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.R!==n?(js("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(zs("string"==typeof t.accessToken),new Ii(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Fi.prototype.l=function(){this.forceRefresh=!0},Fi.prototype._=function(t){this.u=t,this.m&&t(this.currentUser)},Fi.prototype.T=function(){this.auth&&this.auth.removeAuthTokenListener(this.I),this.I=null,this.u=null},Fi.prototype.A=function(){var t=this.auth&&this.auth.getUid();return zs(null===t||"string"==typeof t),new bi(t)},Fi),Si=(Object.defineProperty(ji.prototype,"o",{get:function(){var t={"X-Goog-AuthUser":this.V},e=this.P.auth.p([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),ji),Oi=(xi.prototype.getToken=function(){return Promise.resolve(new Si(this.P,this.V))},xi.prototype._=function(t){t(bi.h)},xi.prototype.T=function(){},xi.prototype.l=function(){},xi),ki=(qi.now=function(){return qi.fromMillis(Date.now())},qi.fromDate=function(t){return qi.fromMillis(t.getTime())},qi.fromMillis=function(t){var e=Math.floor(t/1e3);return new qi(e,1e6*(t-1e3*e))},qi.prototype.toDate=function(){return new Date(this.toMillis())},qi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},qi.prototype.g=function(t){return this.seconds===t.seconds?Qs(this.nanoseconds,t.nanoseconds):Qs(this.seconds,t.seconds)},qi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},qi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},qi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},qi),Li=(Ci.v=function(t){return new Ci(t)},Ci.min=function(){return new Ci(new ki(0,0))},Ci.prototype.S=function(t){return this.timestamp.g(t.timestamp)},Ci.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Ci.prototype.C=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Ci.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Ci.prototype.D=function(){return this.timestamp},Ci),Pi=(Object.defineProperty(Mi.prototype,"length",{get:function(){return this.F},enumerable:!0,configurable:!0}),Mi.prototype.isEqual=function(t){return 0===Mi.N(this,t)},Mi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Mi?t.forEach(function(t){e.push(t)}):e.push(t),this.$(e)},Mi.prototype.limit=function(){return this.offset+this.length},Mi.prototype.L=function(t){return t=void 0===t?1:t,this.$(this.segments,this.offset+t,this.length-t)},Mi.prototype.O=function(){return this.$(this.segments,this.offset,this.length-1)},Mi.prototype.k=function(){return this.segments[this.offset]},Mi.prototype.q=function(){return this.get(this.length-1)},Mi.prototype.get=function(t){return this.segments[this.offset+t]},Mi.prototype.M=function(){return 0===this.length},Mi.prototype.B=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Mi.prototype.U=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Mi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Mi.prototype.W=function(){return this.segments.slice(this.offset,this.limit())},Mi.N=function(t,e){for(var n=Math.min(t.length,e.length),i=0;i<n;i++){var r=t.get(i),o=e.get(i);if(r<o)return-1;if(o<r)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Mi),Vi=(n(Ui,Ti=Pi),Ui.prototype.$=function(t,e,n){return new Ui(t,e,n)},Ui.prototype.j=function(){return this.W().join("/")},Ui.prototype.toString=function(){return this.j()},Ui.G=function(t){if(0<=t.indexOf("//"))throw new _i(Ni.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new Ui(t.split("/").filter(function(t){return 0<t.length}))},Ui);function Ui(){return null!==Ti&&Ti.apply(this,arguments)||this}function Mi(t,e,n){void 0===e?e=0:e>t.length&&Gs(),void 0===n?n=t.length-e:n>t.length-e&&Gs(),this.segments=t,this.offset=e,this.F=n}function Ci(t){this.timestamp=t}function qi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new _i(Ni.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new _i(Ni.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new _i(Ni.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new _i(Ni.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function xi(t,e){this.P=t,this.V=e}function ji(t,e){this.P=t,this.V=e,this.type="FirstParty",this.user=bi.h}function Fi(t){var e=this;this.I=null,this.currentUser=bi.UNAUTHENTICATED,this.m=!1,this.R=0,this.u=null,this.forceRefresh=!1,this.I=function(){e.R++,e.currentUser=e.A(),e.m=!0,e.u&&e.u(e.currentUser)},this.R=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.I):(this.I(null),t.get().then(function(t){e.auth=t,e.I&&e.auth.addAuthTokenListener(e.I)},function(){}))}function Bi(){this.u=null}function Gi(t,e){var n=this;return(n=Ai.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}Vi.H=new Vi([]);var zi,Hi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Wi=(n(Qi,zi=Pi),Qi.prototype.$=function(t,e,n){return new Qi(t,e,n)},Qi.K=function(t){return Hi.test(t)},Qi.prototype.j=function(){return this.W().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),Qi.K(t)||(t="`"+t+"`"),t}).join(".")},Qi.prototype.toString=function(){return this.j()},Qi.prototype.Y=function(){return 1===this.length&&"__name__"===this.get(0)},Qi.X=function(){return new Qi(["__name__"])},Qi.J=function(t){for(var e=[],n="",i=0,r=function(){if(0===n.length)throw new _i(Ni.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new _i(Ni.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new _i(Ni.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,i+=2}else"`"===s?o=!o:"."!==s||o?n+=s:r(),i++}if(r(),o)throw new _i(Ni.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Qi(e)},Qi);function Qi(){return null!==zi&&zi.apply(this,arguments)||this}Wi.H=new Wi([]);var Xi=(Yi.Z=function(t){return new Yi(Vi.G(t).L(5))},Yi.prototype.tt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Yi.prototype.isEqual=function(t){return null!==t&&0===Vi.N(this.path,t.path)},Yi.prototype.toString=function(){return this.path.toString()},Yi.N=function(t,e){return Vi.N(t.path,e.path)},Yi.et=function(t){return t.length%2==0},Yi.st=function(t){return new Yi(new Vi(t.slice()))},Yi);function Yi(t){this.path=t}function Ki(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function $i(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Ji(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}Xi.EMPTY=new Xi(new Vi([]));var Zi=(tr.fromBase64String=function(t){return new tr(Ms.nt().atob(t))},tr.fromUint8Array=function(t){return new tr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},tr.prototype.toBase64=function(){return Ms.nt().btoa(this.it)},tr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.it)},tr.prototype.rt=function(){return 2*this.it.length},tr.prototype.S=function(t){return Qs(this.it,t.it)},tr.prototype.isEqual=function(t){return this.it===t.it},tr);function tr(t){this.it=t}function er(t){return null==t}function nr(t){return-0===t&&1/t==-1/0}function ir(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function rr(t){var e=lr(t.mapValue.fields.__local_write_time__.timestampValue);return new ki(e.seconds,e.nanos)}Zi.ht=new Zi("");var or=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function sr(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ir(t)?4:10:Gs()}function ur(i,r){var t,e,n,o=sr(i);if(o!==sr(r))return!1;switch(o){case 0:return!0;case 1:return i.booleanValue===r.booleanValue;case 4:return rr(i).isEqual(rr(r));case 3:return function(t){if("string"==typeof i.timestampValue&&"string"==typeof t.timestampValue&&i.timestampValue.length===t.timestampValue.length)return i.timestampValue===t.timestampValue;var e=lr(i.timestampValue),n=lr(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(r);case 5:return i.stringValue===r.stringValue;case 6:return n=r,dr(i.bytesValue).isEqual(dr(n.bytesValue));case 7:return i.referenceValue===r.referenceValue;case 8:return e=r,pr((t=i).geoPointValue.latitude)===pr(e.geoPointValue.latitude)&&pr(t.geoPointValue.longitude)===pr(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return pr(t.integerValue)===pr(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=pr(t.doubleValue),i=pr(e.doubleValue);return n===i?nr(n)===nr(i):isNaN(n)&&isNaN(i)}return!1}(i,r);case 9:return Xs(i.arrayValue.values||[],r.arrayValue.values||[],ur);case 10:return function(){var t=i.mapValue.fields||{},e=r.mapValue.fields||{};if(Ki(t)!==Ki(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!ur(t[n],e[n])))return!1;return!0}();default:return Gs()}}function ar(t,e){return void 0!==(t.values||[]).find(function(t){return ur(t,e)})}function hr(t,e){var n,i,r,o,s,u,a,h,c,f,l=sr(t),p=sr(e);if(l!==p)return Qs(l,p);switch(l){case 0:return 0;case 1:return Qs(t.booleanValue,e.booleanValue);case 2:return h=e,(c=pr(t.integerValue||t.doubleValue))<(f=pr(h.integerValue||h.doubleValue))?-1:f<c?1:c===f?0:isNaN(c)?isNaN(f)?0:-1:1;case 3:return cr(t.timestampValue,e.timestampValue);case 4:return cr(rr(t),rr(e));case 5:return Qs(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=dr(o),a=dr(s),u.S(a);case 7:return function(t,e){for(var n=t.split("/"),i=e.split("/"),r=0;r<n.length&&r<i.length;r++){var o=Qs(n[r],i[r]);if(0!==o)return o}return Qs(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,i=e.geoPointValue,0!==(r=Qs(pr(n.latitude),pr(i.latitude)))?r:Qs(pr(n.longitude),pr(i.longitude));case 9:return function(t,e){for(var n=t.values||[],i=e.values||[],r=0;r<n.length&&r<i.length;++r){var o=hr(n[r],i[r]);if(o)return o}return Qs(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},i=Object.keys(n),r=e.fields||{},o=Object.keys(r);i.sort(),o.sort();for(var s=0;s<i.length&&s<o.length;++s){var u=Qs(i[s],o[s]);if(0!==u)return u;var a=hr(n[i[s]],r[o[s]]);if(0!==a)return a}return Qs(i.length,o.length)}(t.mapValue,e.mapValue);default:throw Gs()}}function cr(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Qs(t,e);var n=lr(t),i=lr(e),r=Qs(n.seconds,i.seconds);return 0!==r?r:Qs(n.nanos,i.nanos)}function fr(t){return function s(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?"time("+(t=lr(r.timestampValue)).seconds+","+t.nanos+")":"stringValue"in r?r.stringValue:"bytesValue"in r?dr(r.bytesValue).toBase64():"referenceValue"in r?(n=r.referenceValue,Xi.Z(n).toString()):"geoPointValue"in r?"geo("+(e=r.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in r?function(){for(var t="[",e=!0,n=0,i=r.arrayValue.values||[];n<i.length;n++)e?e=!1:t+=",",t+=s(i[n]);return t+"]"}():"mapValue"in r?function(t){for(var e="{",n=!0,i=0,r=Object.keys(t.fields||{}).sort();i<r.length;i++){var o=r[i];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(r.mapValue):Gs();var t,e,n}(t)}function lr(t){if(zs(!!t),"string"!=typeof t)return{seconds:pr(t.seconds),nanos:pr(t.nanos)};var e,n=0,i=or.exec(t);zs(!!i),i[1]&&(e=((e=i[1])+"000000000").substr(0,9),n=Number(e));var r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:n}}function pr(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function dr(t){return"string"==typeof t?Zi.fromBase64String(t):Zi.fromUint8Array(t)}function yr(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.j()}}function vr(t){return t&&"integerValue"in t}function gr(t){return!!t&&"arrayValue"in t}function mr(t){return t&&"nullValue"in t}function wr(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function br(t){return t&&"mapValue"in t}var Er=(Ir.prototype.ot=function(t,e){return n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},t&&(n.fields.__previous_value__=t),{mapValue:n};var n},Ir.prototype.at=function(t,e){return e},Ir.prototype.ut=function(t){return null},Ir.prototype.isEqual=function(t){return t instanceof Ir},Ir);function Ir(){}Er.instance=new Er;var Tr=(Dr.prototype.ot=function(t,e){return this.apply(t)},Dr.prototype.at=function(t,e){return this.apply(t)},Dr.prototype.apply=function(t){for(var n=Sr(t),e=function(e){n.some(function(t){return ur(t,e)})||n.push(e)},i=0,r=this.elements;i<r.length;i++)e(r[i]);return{arrayValue:{values:n}}},Dr.prototype.ut=function(t){return null},Dr.prototype.isEqual=function(t){return t instanceof Dr&&Xs(this.elements,t.elements,ur)},Dr),Ar=(Rr.prototype.ot=function(t,e){return this.apply(t)},Rr.prototype.at=function(t,e){return this.apply(t)},Rr.prototype.apply=function(t){for(var n=Sr(t),e=function(e){n=n.filter(function(t){return!ur(t,e)})},i=0,r=this.elements;i<r.length;i++)e(r[i]);return{arrayValue:{values:n}}},Rr.prototype.ut=function(t){return null},Rr.prototype.isEqual=function(t){return t instanceof Rr&&Xs(this.elements,t.elements,ur)},Rr),Nr=(_r.prototype.ot=function(t,e){var n=this.ut(t),i=this.asNumber(n)+this.asNumber(this.ct);return vr(n)&&vr(this.ct)?this.serializer.lt(i):this.serializer._t(i)},_r.prototype.at=function(t,e){return e},_r.prototype.ut=function(t){return vr(e=t)||e&&"doubleValue"in e?t:{integerValue:0};var e},_r.prototype.isEqual=function(t){return t instanceof _r&&ur(this.ct,t.ct)},_r.prototype.asNumber=function(t){return pr(t.integerValue||t.doubleValue)},_r);function _r(t,e){this.serializer=t,this.ct=e}function Rr(t){this.elements=t}function Dr(t){this.elements=t}function Sr(t){return gr(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Or(t,e){this.version=t,this.transformResults=e}var kr,Lr,Pr,Vr,Ur,Mr=(io.prototype.ft=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].B(t))return!0;return!1},io.prototype.isEqual=function(t){return Xs(this.fields,t.fields,function(t,e){return t.isEqual(e)})},io),Cr=(no.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},no),qr=(eo.dt=function(){return new eo},eo.exists=function(t){return new eo(void 0,t)},eo.updateTime=function(t){return new eo(t)},Object.defineProperty(eo.prototype,"wt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),eo.prototype.Tt=function(t){return void 0!==this.updateTime?t instanceof wo&&t.version.isEqual(this.updateTime):void 0===this.exists||this.exists===t instanceof wo},eo.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},eo),xr=(to.prototype.Et=function(t){},to.It=function(t){return t instanceof wo?t.version:Li.min()},to),jr=(n(Zr,Ur=xr),Zr.prototype.at=function(t,e){this.Et(t);var n=e.version;return new wo(this.key,n,this.value,{hasCommittedMutations:!0})},Zr.prototype.ot=function(t,e,n){if(this.Et(t),!this.Rt.Tt(t))return t;var i=xr.It(t);return new wo(this.key,i,this.value,{At:!0})},Zr.prototype.Pt=function(t){return null},Zr.prototype.isEqual=function(t){return t instanceof Zr&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.Rt.isEqual(t.Rt)},Zr),Fr=(n(Jr,Vr=xr),Jr.prototype.at=function(t,e){if(this.Et(t),!this.Rt.Tt(t))return new Eo(this.key,e.version);var n=this.pt(t);return new wo(this.key,e.version,n,{hasCommittedMutations:!0})},Jr.prototype.ot=function(t,e,n){if(this.Et(t),!this.Rt.Tt(t))return t;var i=xr.It(t),r=this.pt(t);return new wo(this.key,i,r,{At:!0})},Jr.prototype.Pt=function(t){return null},Jr.prototype.isEqual=function(t){return t instanceof Jr&&this.key.isEqual(t.key)&&this.Vt.isEqual(t.Vt)&&this.Rt.isEqual(t.Rt)},Jr.prototype.pt=function(t){var e=t instanceof wo?t.data():Hr.empty();return this.yt(e)},Jr.prototype.yt=function(t){var n=this,i=new Wr(t);return this.Vt.fields.forEach(function(t){var e;t.M()||(null!==(e=n.data.field(t))?i.set(t,e):i.delete(t))}),i.gt()},Jr),Br=(n($r,Pr=xr),$r.prototype.at=function(t,e){if(this.Et(t),zs(null!=e.transformResults),!this.Rt.Tt(t))return new Eo(this.key,e.version);var n=this.bt(t),i=this.vt(t,e.transformResults),r=e.version,o=this.St(n.data(),i);return new wo(this.key,r,o,{hasCommittedMutations:!0})},$r.prototype.ot=function(t,e,n){if(this.Et(t),!this.Rt.Tt(t))return t;var i=this.bt(t),r=this.Ct(n,t,e),o=this.St(i.data(),r);return new wo(this.key,i.version,o,{At:!0})},$r.prototype.Pt=function(t){for(var e=null,n=0,i=this.fieldTransforms;n<i.length;n++){var r=i[n],o=t instanceof wo?t.field(r.field):void 0,s=r.transform.ut(o||null);null!=s&&(e=null==e?(new Wr).set(r.field,s):e.set(r.field,s))}return e?e.gt():null},$r.prototype.isEqual=function(t){return t instanceof $r&&this.key.isEqual(t.key)&&Xs(this.fieldTransforms,t.fieldTransforms,function(t,e){return t.isEqual(e)})&&this.Rt.isEqual(t.Rt)},$r.prototype.bt=function(t){return t},$r.prototype.vt=function(t,e){var n=[];zs(this.fieldTransforms.length===e.length);for(var i=0;i<e.length;i++){var r=this.fieldTransforms[i],o=r.transform,s=null;t instanceof wo&&(s=t.field(r.field)),n.push(o.at(s,e[i]))}return n},$r.prototype.Ct=function(t,e,n){for(var i=[],r=0,o=this.fieldTransforms;r<o.length;r++){var s=o[r],u=s.transform,a=null;e instanceof wo&&(a=e.field(s.field)),null===a&&n instanceof wo&&(a=n.field(s.field)),i.push(u.ot(a,t))}return i},$r.prototype.St=function(t,e){for(var n=new Wr(t),i=0;i<this.fieldTransforms.length;i++){var r=this.fieldTransforms[i].field;n.set(r,e[i])}return n.gt()},$r),Gr=(n(Kr,Lr=xr),Kr.prototype.at=function(t,e){return this.Et(t),new bo(this.key,e.version,{hasCommittedMutations:!0})},Kr.prototype.ot=function(t,e,n){return this.Et(t),this.Rt.Tt(t)?new bo(this.key,Li.min()):t},Kr.prototype.Pt=function(t){return null},Kr.prototype.isEqual=function(t){return t instanceof Kr&&this.key.isEqual(t.key)&&this.Rt.isEqual(t.Rt)},Kr),zr=(n(Yr,kr=xr),Yr.prototype.at=function(t,e){Gs()},Yr.prototype.ot=function(t,e,n){Gs()},Yr.prototype.Pt=function(t){Gs()},Yr.prototype.isEqual=function(t){return t instanceof Yr&&this.key.isEqual(t.key)&&this.Rt.isEqual(t.Rt)},Yr),Hr=(Xr.empty=function(){return new Xr({mapValue:{}})},Xr.prototype.field=function(t){if(t.M())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!br(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.q()])||null},Xr.prototype.isEqual=function(t){return ur(this.proto,t.proto)},Xr),Wr=(Qr.prototype.set=function(t,e){return this.Nt(t,e),this},Qr.prototype.delete=function(t){return this.Nt(t,null),this},Qr.prototype.Nt=function(t,e){for(var n=this.Ft,i=0;i<t.length-1;++i){var r=t.get(i),o=n.get(r);o instanceof Map||(o=o&&10===sr(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(r,o)),n=o}n.set(t.q(),e)},Qr.prototype.gt=function(){var t=this.$t(Wi.H,this.Ft);return null!=t?new Hr(t):this.Dt},Qr.prototype.$t=function(i,t){var r=this,o=!1,e=this.Dt.field(i),s=br(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=r.$t(i.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Qr);function Qr(t){void 0===t&&(t=Hr.empty()),this.Dt=t,this.Ft=new Map}function Xr(t){this.proto=t}function Yr(t,e){var n=this;return(n=kr.call(this)||this).key=t,n.Rt=e,n.type=4,n}function Kr(t,e){var n=this;return(n=Lr.call(this)||this).key=t,n.Rt=e,n.type=3,n}function $r(t,e){var n=this;return(n=Pr.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Rt=qr.exists(!0),n}function Jr(t,e,n,i){var r=this;return(r=Vr.call(this)||this).key=t,r.data=e,r.Vt=n,r.Rt=i,r.type=1,r}function Zr(t,e,n){var i=this;return(i=Ur.call(this)||this).key=t,i.value=e,i.Rt=n,i.type=0,i}function to(){}function eo(t,e){this.updateTime=t,this.exists=e}function no(t,e){this.field=t,this.transform=e}function io(t){(this.fields=t).sort(Wi.N)}function ro(t){var u=[];return $i(t.fields||{},function(t,e){var n=new Wi([t]);if(br(e)){var i=ro(e.mapValue).fields;if(0===i.length)u.push(n);else for(var r=0,o=i;r<o.length;r++){var s=o[r];u.push(n.child(s))}}else u.push(n)}),new Mr(u)}function oo(t,e){this.key=t,this.version=e}function so(t){this.count=t}var uo,ao,ho,co,fo,lo,po,yo,vo,go,mo,wo=(n(Wo,mo=oo),Wo.prototype.field=function(t){return this.Lt.field(t)},Wo.prototype.data=function(){return this.Lt},Wo.prototype.Ot=function(){return this.Lt.proto},Wo.prototype.isEqual=function(t){return t instanceof Wo&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.At===t.At&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Lt.isEqual(t.Lt)},Wo.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Lt.toString()+", {hasLocalMutations: "+this.At+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Wo.prototype,"hasPendingWrites",{get:function(){return this.At||this.hasCommittedMutations},enumerable:!0,configurable:!0}),Wo),bo=(n(Ho,go=oo),Ho.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Ho.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),Ho.prototype.isEqual=function(t){return t instanceof Ho&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Ho),Eo=(n(zo,vo=oo),zo.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(zo.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),zo.prototype.isEqual=function(t){return t instanceof zo&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},zo),Io=(Go.prototype.canonicalId=function(){var t;return null===this.kt&&(t=this.path.j(),null!==this.collectionGroup&&(t+="|cg:"+this.collectionGroup),t+="|f:",t+=this.filters.map(function(t){return t.canonicalId()}).join(","),t+="|ob:",t+=this.orderBy.map(function(t){return t.canonicalId()}).join(","),er(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.kt=t),this.kt},Go.prototype.toString=function(){var t=this.path.j();return null!==this.collectionGroup&&(t+=" collectionGroup="+this.collectionGroup),0<this.filters.length&&(t+=", filters: ["+this.filters.join(", ")+"]"),er(this.limit)||(t+=", limit: "+this.limit),0<this.orderBy.length&&(t+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),"Target("+t+")"},Go.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(var n=0;n<this.filters.length;n++)if(!this.filters[n].isEqual(t.filters[n]))return!1;return this.collectionGroup===t.collectionGroup&&!!this.path.isEqual(t.path)&&!!(null!==this.startAt?this.startAt.isEqual(t.startAt):null===t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)},Go.prototype.qt=function(){return Xi.et(this.path)&&null===this.collectionGroup&&0===this.filters.length},Go),To=(Bo.Wt=function(t){return new Bo(t)},Object.defineProperty(Bo.prototype,"orderBy",{get:function(){if(null===this.Bt){this.Bt=[];var t=this.jt(),e=this.Gt();if(null!==t&&null===e)t.Y()||this.Bt.push(new ko(t)),this.Bt.push(new ko(Wi.X(),"asc"));else{for(var n,i=!1,r=0,o=this.Mt;r<o.length;r++){var s=o[r];this.Bt.push(s),s.field.Y()&&(i=!0)}i||(n=0<this.Mt.length?this.Mt[this.Mt.length-1].dir:"asc",this.Bt.push(new ko(Wi.X(),n)))}}return this.Bt},enumerable:!0,configurable:!0}),Bo.prototype.Ht=function(t){var e=this.filters.concat([t]);return new Bo(this.path,this.collectionGroup,this.Mt.slice(),e,this.limit,this.xt,this.startAt,this.endAt)},Bo.prototype.Kt=function(t){var e=this.Mt.concat([t]);return new Bo(this.path,this.collectionGroup,e,this.filters.slice(),this.limit,this.xt,this.startAt,this.endAt)},Bo.prototype.zt=function(t){return new Bo(this.path,this.collectionGroup,this.Mt.slice(),this.filters.slice(),t,"F",this.startAt,this.endAt)},Bo.prototype.Yt=function(t){return new Bo(this.path,this.collectionGroup,this.Mt.slice(),this.filters.slice(),t,"L",this.startAt,this.endAt)},Bo.prototype.Xt=function(t){return new Bo(this.path,this.collectionGroup,this.Mt.slice(),this.filters.slice(),this.limit,this.xt,t,this.endAt)},Bo.prototype.Jt=function(t){return new Bo(this.path,this.collectionGroup,this.Mt.slice(),this.filters.slice(),this.limit,this.xt,this.startAt,t)},Bo.prototype.Zt=function(t){return new Bo(t,null,this.Mt.slice(),this.filters.slice(),this.limit,this.xt,this.startAt,this.endAt)},Bo.prototype.te=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.Mt.length||1===this.Mt.length&&this.Mt[0].field.Y())},Bo.prototype.canonicalId=function(){return this.ee().canonicalId()+"|lt:"+this.xt},Bo.prototype.toString=function(){return"Query(target="+this.ee().toString()+"; limitType="+this.xt+")"},Bo.prototype.isEqual=function(t){return this.ee().isEqual(t.ee())&&this.xt===t.xt},Bo.prototype.se=function(t,e){for(var n=!1,i=0,r=this.orderBy;i<r.length;i++){var o=r[i],s=o.compare(t,e);if(0!==s)return s;n=n||o.field.Y()}return 0},Bo.prototype.matches=function(t){return this.ie(t)&&this.ne(t)&&this.re(t)&&this.he(t)},Bo.prototype.oe=function(){return!er(this.limit)&&"F"===this.xt},Bo.prototype.ae=function(){return!er(this.limit)&&"L"===this.xt},Bo.prototype.Gt=function(){return 0<this.Mt.length?this.Mt[0].field:null},Bo.prototype.jt=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof Ao&&n.ue())return n.field}return null},Bo.prototype.ce=function(t){for(var e=0,n=this.filters;e<n.length;e++){var i=n[e];if(i instanceof Ao&&0<=t.indexOf(i.op))return i.op}return null},Bo.prototype.qt=function(){return this.ee().qt()},Bo.prototype.le=function(){return null!==this.collectionGroup},Bo.prototype.ee=function(){if(!this.Ut)if("F"===this.xt)this.Ut=new Io(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var i=n[e],r="desc"===i.dir?"asc":"desc";t.push(new ko(i.field,r))}var o=this.endAt?new Oo(this.endAt.position,!this.endAt.before):null,s=this.startAt?new Oo(this.startAt.position,!this.startAt.before):null;this.Ut=new Io(this.path,this.collectionGroup,t,this.filters,this.limit,o,s)}return this.Ut},Bo.prototype.ie=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.tt(this.collectionGroup)&&this.path.B(e):Xi.et(this.path)?this.path.isEqual(e):this.path.U(e)},Bo.prototype.ne=function(t){for(var e=0,n=this.Mt;e<n.length;e++){var i=n[e];if(!i.field.Y()&&null===t.field(i.field))return!1}return!0},Bo.prototype.re=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},Bo.prototype.he=function(t){return!(this.startAt&&!this.startAt._e(this.orderBy,t)||this.endAt&&this.endAt._e(this.orderBy,t))},Bo.prototype.Qt=function(t){},Bo),Ao=(n(Fo,yo=function(){}),Fo.create=function(t,e,n){if(t.Y())return"in"===e?new _o(t,n):new No(t,e,n);if(mr(n)){if("=="!==e)throw new _i(Ni.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new Fo(t,e,n)}if(wr(n)){if("=="!==e)throw new _i(Ni.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new Fo(t,e,n)}return"array-contains"===e?new Ro(t,n):"in"===e?new Do(t,n):"array-contains-any"===e?new So(t,n):new Fo(t,e,n)},Fo.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&sr(this.value)===sr(e)&&this.fe(hr(e,this.value))},Fo.prototype.fe=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return 0<t;case">=":return 0<=t;default:return Gs()}},Fo.prototype.ue=function(){return 0<=["<","<=",">",">="].indexOf(this.op)},Fo.prototype.canonicalId=function(){return this.field.j()+this.op.toString()+fr(this.value)},Fo.prototype.isEqual=function(t){return t instanceof Fo&&this.op===t.op&&this.field.isEqual(t.field)&&ur(this.value,t.value)},Fo.prototype.toString=function(){return this.field.j()+" "+this.op+" "+fr(this.value)},Fo),No=(n(jo,po=Ao),jo.prototype.matches=function(t){var e=Xi.N(t.key,this.key);return this.fe(e)},jo),_o=(n(xo,lo=Ao),xo.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},xo),Ro=(n(qo,fo=Ao),qo.prototype.matches=function(t){var e=t.field(this.field);return gr(e)&&ar(e.arrayValue,this.value)},qo),Do=(n(Co,co=Ao),Co.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&ar(this.value.arrayValue,e)},Co),So=(n(Mo,ho=Ao),Mo.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!gr(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return ar(e.value.arrayValue,t)})},Mo),Oo=(Uo.prototype.canonicalId=function(){return(this.before?"b":"a")+":"+this.position.map(fr).join(",")},Uo.prototype._e=function(t,e){for(var n=0,i=0;i<this.position.length;i++){var r=t[i],o=this.position[i],n=r.field.Y()?Xi.N(Xi.Z(o.referenceValue),e.key):hr(o,e.field(r.field));if("desc"===r.dir&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},Uo.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++)if(!ur(this.position[e],t.position[e]))return!1;return!0},Uo),ko=(Vo.prototype.compare=function(t,e){var n,i,r,o,s=this.de?Xi.N(t.key,e.key):(n=this.field,i=e,r=t.field(n),o=i.field(n),null!==r&&null!==o?hr(r,o):Gs());switch(this.dir){case"asc":return s;case"desc":return-1*s;default:return Gs()}},Vo.prototype.canonicalId=function(){return this.field.j()+this.dir.toString()},Vo.prototype.toString=function(){return this.field.j()+" ("+this.dir+")"},Vo.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},Vo),Lo=(Po.prototype.Ee=function(t){return new Po(this.target,this.targetId,this.we,t,this.Te,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Po.prototype.Ie=function(t,e){return new Po(this.target,this.targetId,this.we,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Po.prototype.me=function(t){return new Po(this.target,this.targetId,this.we,this.sequenceNumber,this.Te,t,this.resumeToken)},Po);function Po(t,e,n,i,r,o,s){void 0===r&&(r=Li.min()),void 0===o&&(o=Li.min()),void 0===s&&(s=Zi.ht),this.target=t,this.targetId=e,this.we=n,this.sequenceNumber=i,this.Te=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Vo(t,e){this.field=t,void 0===e&&(e="asc"),this.dir=e,this.de=t.Y()}function Uo(t,e){this.position=t,this.before=e}function Mo(t,e){return ho.call(this,t,"array-contains-any",e)||this}function Co(t,e){return co.call(this,t,"in",e)||this}function qo(t,e){return fo.call(this,t,"array-contains",e)||this}function xo(t,e){var n=this;return(n=lo.call(this,t,"in",e)||this).keys=(e.arrayValue.values||[]).map(function(t){return Xi.Z(t.referenceValue)}),n}function jo(t,e,n){var i=this;return(i=po.call(this,t,e,n)||this).key=Xi.Z(n.referenceValue),i}function Fo(t,e,n){var i=this;return(i=yo.call(this)||this).field=t,i.op=e,i.value=n,i}function Bo(t,e,n,i,r,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Mt=n,this.filters=i,this.limit=r,this.xt=o,this.startAt=s,this.endAt=u,this.Bt=null,this.Ut=null,this.startAt&&this.Qt(this.startAt),this.endAt&&this.Qt(this.endAt)}function Go(t,e,n,i,r,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=o,this.endAt=s,this.kt=null}function zo(){return null!==vo&&vo.apply(this,arguments)||this}function Ho(t,e,n){var i=this;return(i=go.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),i}function Wo(t,e,n,i){var r=this;return(r=mo.call(this,t,e)||this).Lt=n,r.At=!!i.At,r.hasCommittedMutations=!!i.hasCommittedMutations,r}function Qo(t){switch(t){case Ni.OK:return Gs();case Ni.CANCELLED:case Ni.UNKNOWN:case Ni.DEADLINE_EXCEEDED:case Ni.RESOURCE_EXHAUSTED:case Ni.INTERNAL:case Ni.UNAVAILABLE:case Ni.UNAUTHENTICATED:return;case Ni.INVALID_ARGUMENT:case Ni.NOT_FOUND:case Ni.ALREADY_EXISTS:case Ni.PERMISSION_DENIED:case Ni.FAILED_PRECONDITION:case Ni.ABORTED:case Ni.OUT_OF_RANGE:case Ni.UNIMPLEMENTED:case Ni.DATA_LOSS:return 1;default:return Gs()}}function Xo(t){if(void 0===t)return Fs("GRPC error has no .code"),Ni.UNKNOWN;switch(t){case uo.OK:return Ni.OK;case uo.CANCELLED:return Ni.CANCELLED;case uo.UNKNOWN:return Ni.UNKNOWN;case uo.DEADLINE_EXCEEDED:return Ni.DEADLINE_EXCEEDED;case uo.RESOURCE_EXHAUSTED:return Ni.RESOURCE_EXHAUSTED;case uo.INTERNAL:return Ni.INTERNAL;case uo.UNAVAILABLE:return Ni.UNAVAILABLE;case uo.UNAUTHENTICATED:return Ni.UNAUTHENTICATED;case uo.INVALID_ARGUMENT:return Ni.INVALID_ARGUMENT;case uo.NOT_FOUND:return Ni.NOT_FOUND;case uo.ALREADY_EXISTS:return Ni.ALREADY_EXISTS;case uo.PERMISSION_DENIED:return Ni.PERMISSION_DENIED;case uo.FAILED_PRECONDITION:return Ni.FAILED_PRECONDITION;case uo.ABORTED:return Ni.ABORTED;case uo.OUT_OF_RANGE:return Ni.OUT_OF_RANGE;case uo.UNIMPLEMENTED:return Ni.UNIMPLEMENTED;case uo.DATA_LOSS:return Ni.DATA_LOSS;default:return Gs()}}(ao=uo=uo||{})[ao.OK=0]="OK",ao[ao.CANCELLED=1]="CANCELLED",ao[ao.UNKNOWN=2]="UNKNOWN",ao[ao.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ao[ao.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ao[ao.NOT_FOUND=5]="NOT_FOUND",ao[ao.ALREADY_EXISTS=6]="ALREADY_EXISTS",ao[ao.PERMISSION_DENIED=7]="PERMISSION_DENIED",ao[ao.UNAUTHENTICATED=16]="UNAUTHENTICATED",ao[ao.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ao[ao.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ao[ao.ABORTED=10]="ABORTED",ao[ao.OUT_OF_RANGE=11]="OUT_OF_RANGE",ao[ao.UNIMPLEMENTED=12]="UNIMPLEMENTED",ao[ao.INTERNAL=13]="INTERNAL",ao[ao.UNAVAILABLE=14]="UNAVAILABLE",ao[ao.DATA_LOSS=15]="DATA_LOSS";var Yo=(ts.prototype.Re=function(t,e){return new ts(this.N,this.root.Re(t,e,this.N).Ae(null,null,$o.Pe,null,null))},ts.prototype.remove=function(t){return new ts(this.N,this.root.remove(t,this.N).Ae(null,null,$o.Pe,null,null))},ts.prototype.get=function(t){for(var e=this.root;!e.M();){var n=this.N(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},ts.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.M();){var i=this.N(t,n.key);if(0===i)return e+n.left.size;n=i<0?n.left:(e+=n.left.size+1,n.right)}return-1},ts.prototype.M=function(){return this.root.M()},Object.defineProperty(ts.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),ts.prototype.Ve=function(){return this.root.Ve()},ts.prototype.pe=function(){return this.root.pe()},ts.prototype.ye=function(t){return this.root.ye(t)},ts.prototype.forEach=function(n){this.ye(function(t,e){return n(t,e),!1})},ts.prototype.toString=function(){var n=[];return this.ye(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},ts.prototype.ge=function(t){return this.root.ge(t)},ts.prototype.be=function(){return new Ko(this.root,null,this.N,!1)},ts.prototype.ve=function(t){return new Ko(this.root,t,this.N,!1)},ts.prototype.Se=function(){return new Ko(this.root,null,this.N,!0)},ts.prototype.Ce=function(t){return new Ko(this.root,t,this.N,!0)},ts),Ko=(Zo.prototype.Ne=function(){var t=this.Fe.pop(),e={key:t.key,value:t.value};if(this.De)for(t=t.left;!t.M();)this.Fe.push(t),t=t.right;else for(t=t.right;!t.M();)this.Fe.push(t),t=t.left;return e},Zo.prototype.$e=function(){return 0<this.Fe.length},Zo.prototype.Le=function(){if(0===this.Fe.length)return null;var t=this.Fe[this.Fe.length-1];return{key:t.key,value:t.value}},Zo),$o=(Jo.prototype.Ae=function(t,e,n,i,r){return new Jo(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)},Jo.prototype.M=function(){return!1},Jo.prototype.ye=function(t){return this.left.ye(t)||t(this.key,this.value)||this.right.ye(t)},Jo.prototype.ge=function(t){return this.right.ge(t)||t(this.key,this.value)||this.left.ge(t)},Jo.prototype.min=function(){return this.left.M()?this:this.left.min()},Jo.prototype.Ve=function(){return this.min().key},Jo.prototype.pe=function(){return this.right.M()?this.key:this.right.pe()},Jo.prototype.Re=function(t,e,n){var i=this,r=n(t,i.key);return(i=r<0?i.Ae(null,null,null,i.left.Re(t,e,n),null):0===r?i.Ae(null,e,null,null,null):i.Ae(null,null,null,null,i.right.Re(t,e,n))).Oe()},Jo.prototype.ke=function(){if(this.left.M())return Jo.EMPTY;var t=this;return t.left.qe()||t.left.left.qe()||(t=t.Me()),(t=t.Ae(null,null,null,t.left.ke(),null)).Oe()},Jo.prototype.remove=function(t,e){var n,i=this;if(e(t,i.key)<0)i.left.M()||i.left.qe()||i.left.left.qe()||(i=i.Me()),i=i.Ae(null,null,null,i.left.remove(t,e),null);else{if(i.left.qe()&&(i=i.xe()),i.right.M()||i.right.qe()||i.right.left.qe()||(i=i.Be()),0===e(t,i.key)){if(i.right.M())return Jo.EMPTY;n=i.right.min(),i=i.Ae(n.key,n.value,null,null,i.right.ke())}i=i.Ae(null,null,null,null,i.right.remove(t,e))}return i.Oe()},Jo.prototype.qe=function(){return this.color},Jo.prototype.Oe=function(){var t=this;return t.right.qe()&&!t.left.qe()&&(t=t.Ue()),t.left.qe()&&t.left.left.qe()&&(t=t.xe()),t.left.qe()&&t.right.qe()&&(t=t.Qe()),t},Jo.prototype.Me=function(){var t=this.Qe();return t.right.left.qe()&&(t=(t=(t=t.Ae(null,null,null,null,t.right.xe())).Ue()).Qe()),t},Jo.prototype.Be=function(){var t=this.Qe();return t.left.left.qe()&&(t=(t=t.xe()).Qe()),t},Jo.prototype.Ue=function(){var t=this.Ae(null,null,Jo.RED,null,this.right.left);return this.right.Ae(null,null,this.color,t,null)},Jo.prototype.xe=function(){var t=this.Ae(null,null,Jo.RED,this.left.right,null);return this.left.Ae(null,null,this.color,null,t)},Jo.prototype.Qe=function(){var t=this.left.Ae(null,null,!this.left.color,null,null),e=this.right.Ae(null,null,!this.right.color,null,null);return this.Ae(null,null,!this.color,t,e)},Jo.prototype.We=function(){var t=this.je();return Math.pow(2,t)<=this.size+1},Jo.prototype.je=function(){if(this.qe()&&this.left.qe())throw Gs();if(this.right.qe())throw Gs();var t=this.left.je();if(t!==this.right.je())throw Gs();return t+(this.qe()?0:1)},Jo);function Jo(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:Jo.RED,this.left=null!=i?i:Jo.EMPTY,this.right=null!=r?r:Jo.EMPTY,this.size=this.left.size+1+this.right.size}function Zo(t,e,n,i){this.De=i,this.Fe=[];for(var r=1;!t.M();)if(r=e?n(t.key,e):1,i&&(r*=-1),r<0)t=this.De?t.left:t.right;else{if(0===r){this.Fe.push(t);break}this.Fe.push(t),t=this.De?t.right:t.left}}function ts(t,e){this.N=t,this.root=e||$o.EMPTY}function es(){this.size=0}$o.EMPTY=null,$o.RED=!0,$o.Pe=!1,$o.EMPTY=(Object.defineProperty(es.prototype,"key",{get:function(){throw Gs()},enumerable:!0,configurable:!0}),Object.defineProperty(es.prototype,"value",{get:function(){throw Gs()},enumerable:!0,configurable:!0}),Object.defineProperty(es.prototype,"color",{get:function(){throw Gs()},enumerable:!0,configurable:!0}),Object.defineProperty(es.prototype,"left",{get:function(){throw Gs()},enumerable:!0,configurable:!0}),Object.defineProperty(es.prototype,"right",{get:function(){throw Gs()},enumerable:!0,configurable:!0}),es.prototype.Ae=function(t,e,n,i,r){return this},es.prototype.Re=function(t,e,n){return new $o(t,e)},es.prototype.remove=function(t,e){return this},es.prototype.M=function(){return!0},es.prototype.ye=function(t){return!1},es.prototype.ge=function(t){return!1},es.prototype.Ve=function(){return null},es.prototype.pe=function(){return null},es.prototype.qe=function(){return!1},es.prototype.We=function(){return!0},es.prototype.je=function(){return 0},new es);var ns=(ss.prototype.has=function(t){return null!==this.data.get(t)},ss.prototype.first=function(){return this.data.Ve()},ss.prototype.last=function(){return this.data.pe()},Object.defineProperty(ss.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),ss.prototype.indexOf=function(t){return this.data.indexOf(t)},ss.prototype.forEach=function(n){this.data.ye(function(t,e){return n(t),!1})},ss.prototype.Ge=function(t,e){for(var n=this.data.ve(t[0]);n.$e();){var i=n.Ne();if(0<=this.N(i.key,t[1]))return;e(i.key)}},ss.prototype.He=function(t,e){for(var n=void 0!==e?this.data.ve(e):this.data.be();n.$e();)if(!t(n.Ne().key))return},ss.prototype.Ke=function(t){var e=this.data.ve(t);return e.$e()?e.Ne().key:null},ss.prototype.be=function(){return new is(this.data.be())},ss.prototype.ve=function(t){return new is(this.data.ve(t))},ss.prototype.add=function(t){return this.Ae(this.data.remove(t).Re(t,!0))},ss.prototype.delete=function(t){return this.has(t)?this.Ae(this.data.remove(t)):this},ss.prototype.M=function(){return this.data.M()},ss.prototype.ze=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},ss.prototype.isEqual=function(t){if(!(t instanceof ss))return!1;if(this.size!==t.size)return!1;for(var e=this.data.be(),n=t.data.be();e.$e();){var i=e.Ne().key,r=n.Ne().key;if(0!==this.N(i,r))return!1}return!0},ss.prototype.W=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},ss.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},ss.prototype.Ae=function(t){var e=new ss(this.N);return e.data=t,e},ss),is=(os.prototype.Ne=function(){return this.Ye.Ne().key},os.prototype.$e=function(){return this.Ye.$e()},os),rs=new Yo(Xi.N);function os(t){this.Ye=t}function ss(t){this.N=t,this.data=new Yo(this.N)}var us=new Yo(Xi.N);var as=new Yo(Xi.N),hs=new ns(Xi.N);function cs(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=hs,i=0,r=t;i<r.length;i++)var o=r[i],n=n.add(o);return n}var fs=new ns(Qs);function ls(t,e,n,i){this.Is=t,this.removedTargetIds=e,this.key=n,this.ms=i}function ps(t,e){this.targetId=t,this.Rs=e}function ds(t,e,n,i){void 0===n&&(n=Zi.ht),void 0===i&&(i=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}var ys=(Ds.Ze=function(t){return new Ds(t.N)},Ds.prototype.has=function(t){return null!=this.Xe.get(t)},Ds.prototype.get=function(t){return this.Xe.get(t)},Ds.prototype.first=function(){return this.Je.Ve()},Ds.prototype.last=function(){return this.Je.pe()},Ds.prototype.M=function(){return this.Je.M()},Ds.prototype.indexOf=function(t){var e=this.Xe.get(t);return e?this.Je.indexOf(e):-1},Object.defineProperty(Ds.prototype,"size",{get:function(){return this.Je.size},enumerable:!0,configurable:!0}),Ds.prototype.forEach=function(n){this.Je.ye(function(t,e){return n(t),!1})},Ds.prototype.add=function(t){var e=this.delete(t.key);return e.Ae(e.Xe.Re(t.key,t),e.Je.Re(t,null))},Ds.prototype.delete=function(t){var e=this.get(t);return e?this.Ae(this.Xe.remove(t),this.Je.remove(e)):this},Ds.prototype.isEqual=function(t){if(!(t instanceof Ds))return!1;if(this.size!==t.size)return!1;for(var e=this.Je.be(),n=t.Je.be();e.$e();){var i=e.Ne().key,r=n.Ne().key;if(!i.isEqual(r))return!1}return!0},Ds.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Ds.prototype.Ae=function(t,e){var n=new Ds;return n.N=this.N,n.Xe=t,n.Je=e,n},Ds),vs=(Rs.prototype.track=function(t){var e=t.doc.key,n=this.ts.get(e);!n||0!==t.type&&3===n.type?this.ts=this.ts.Re(e,t):3===t.type&&1!==n.type?this.ts=this.ts.Re(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ts=this.ts.Re(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ts=this.ts.Re(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ts=this.ts.remove(e):1===t.type&&2===n.type?this.ts=this.ts.Re(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ts=this.ts.Re(e,{type:2,doc:t.doc}):Gs()},Rs.prototype.es=function(){var n=[];return this.ts.ye(function(t,e){n.push(e)}),n},Rs),gs=(_s.os=function(t,e,n,i){var r=[];return e.forEach(function(t){r.push({type:0,doc:t})}),new _s(t,e,ys.Ze(e),r,n,i,!0,!1)},Object.defineProperty(_s.prototype,"hasPendingWrites",{get:function(){return!this.ns.M()},enumerable:!0,configurable:!0}),_s.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.rs===t.rs&&this.ns.isEqual(t.ns)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.ss.isEqual(t.ss)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var i=0;i<e.length;i++)if(e[i].type!==n[i].type||!e[i].doc.isEqual(n[i].doc))return!1;return!0},_s),ms=(Ns._s=function(t,e){var n=new Map;return n.set(t,ws.fs(t,e)),new Ns(Li.min(),n,fs,rs,cs())},Ns),ws=(As.fs=function(t,e){return new As(Zi.ht,e,cs(),cs(),cs())},As),bs=(Object.defineProperty(Ts.prototype,"ds",{get:function(){return this.ps},enumerable:!0,configurable:!0}),Object.defineProperty(Ts.prototype,"resumeToken",{get:function(){return this.Vs},enumerable:!0,configurable:!0}),Object.defineProperty(Ts.prototype,"gs",{get:function(){return 0!==this.As},enumerable:!0,configurable:!0}),Object.defineProperty(Ts.prototype,"bs",{get:function(){return this.ys},enumerable:!0,configurable:!0}),Ts.prototype.vs=function(t){0<t.rt()&&(this.ys=!0,this.Vs=t)},Ts.prototype.Ss=function(){var n=cs(),i=cs(),r=cs();return this.Ps.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:i=i.add(t);break;case 1:r=r.add(t);break;default:Gs()}}),new ws(this.Vs,this.ps,n,i,r)},Ts.prototype.Cs=function(){this.ys=!1,this.Ps=Os()},Ts.prototype.Ds=function(t,e){this.ys=!0,this.Ps=this.Ps.Re(t,e)},Ts.prototype.Fs=function(t){this.ys=!0,this.Ps=this.Ps.remove(t)},Ts.prototype.Ns=function(){this.As+=1},Ts.prototype.$s=function(){--this.As},Ts.prototype.Ls=function(){this.ys=!0,this.ps=!0},Ts),Es=(Is.prototype.Bs=function(t){for(var e=0,n=t.Is;e<n.length;e++){var i=n[e];t.ms instanceof wo?this.Us(i,t.ms):t.ms instanceof bo&&this.Qs(i,t.key,t.ms)}for(var r=0,o=t.removedTargetIds;r<o.length;r++){var s=o[r];this.Qs(s,t.key,t.ms)}},Is.prototype.Ws=function(n){var i=this;this.js(n,function(t){var e=i.Gs(t);switch(n.state){case 0:i.Hs(t)&&e.vs(n.resumeToken);break;case 1:e.$s(),e.gs||e.Cs(),e.vs(n.resumeToken);break;case 2:e.$s(),e.gs||i.removeTarget(t);break;case 3:i.Hs(t)&&(e.Ls(),e.vs(n.resumeToken));break;case 4:i.Hs(t)&&(i.Ks(t),e.vs(n.resumeToken));break;default:Gs()}})},Is.prototype.js=function(t,n){var i=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ks.forEach(function(t,e){i.Hs(e)&&n(e)})},Is.prototype.zs=function(t){var e,n,i=t.targetId,r=t.Rs.count,o=this.Ys(i);o&&((e=o.target).qt()?0===r?(n=new Xi(e.path),this.Qs(i,n,new bo(n,Li.min()))):zs(1===r):this.Xs(i)!==r&&(this.Ks(i),this.xs=this.xs.add(i)))},Is.prototype.Js=function(r){var o=this,s=new Map;this.ks.forEach(function(t,e){var n,i=o.Ys(e);i&&(t.ds&&i.target.qt()&&(n=new Xi(i.target.path),null!==o.qs.get(n)||o.Zs(e,n)||o.Qs(e,n,new bo(n,r))),t.bs&&(s.set(e,t.Ss()),t.Cs()))});var i=cs();this.Ms.forEach(function(t,e){var n=!0;e.He(function(t){var e=o.Ys(t);return!e||2===e.we||(n=!1)}),n&&(i=i.add(t))});var t=new ms(r,s,this.xs,this.qs,i);return this.qs=rs,this.Ms=Ss(),this.xs=new ns(Qs),t},Is.prototype.Us=function(t,e){var n;this.Hs(t)&&(n=this.Zs(t,e.key)?2:0,this.Gs(t).Ds(e.key,n),this.qs=this.qs.Re(e.key,e),this.Ms=this.Ms.Re(e.key,this.ti(e.key).add(t)))},Is.prototype.Qs=function(t,e,n){var i;this.Hs(t)&&(i=this.Gs(t),this.Zs(t,e)?i.Ds(e,1):i.Fs(e),this.Ms=this.Ms.Re(e,this.ti(e).delete(t)),n&&(this.qs=this.qs.Re(e,n)))},Is.prototype.removeTarget=function(t){this.ks.delete(t)},Is.prototype.Xs=function(t){var e=this.Gs(t).Ss();return this.Os.ei(t).size+e.ws.size-e.Es.size},Is.prototype.Ns=function(t){this.Gs(t).Ns()},Is.prototype.Gs=function(t){var e=this.ks.get(t);return e||(e=new bs,this.ks.set(t,e)),e},Is.prototype.ti=function(t){var e=this.Ms.get(t);return e||(e=new ns(Qs),this.Ms=this.Ms.Re(t,e)),e},Is.prototype.Hs=function(t){var e=null!==this.Ys(t);return e||js("WatchChangeAggregator","Detected inactive target",t),e},Is.prototype.Ys=function(t){var e=this.ks.get(t);return e&&e.gs?null:this.Os.si(t)},Is.prototype.Ks=function(e){var n=this;this.ks.set(e,new bs),this.Os.ei(e).forEach(function(t){n.Qs(e,t,null)})},Is.prototype.Zs=function(t,e){return this.Os.ei(t).has(e)},Is);function Is(t){this.Os=t,this.ks=new Map,this.qs=rs,this.Ms=Ss(),this.xs=new ns(Qs)}function Ts(){this.As=0,this.Ps=Os(),this.Vs=Zi.ht,this.ps=!1,this.ys=!0}function As(t,e,n,i,r){this.resumeToken=t,this.ds=e,this.ws=n,this.Ts=i,this.Es=r}function Ns(t,e,n,i,r){this.Te=t,this.as=e,this.us=n,this.cs=i,this.ls=r}function _s(t,e,n,i,r,o,s,u){this.query=t,this.docs=e,this.ss=n,this.docChanges=i,this.ns=r,this.fromCache=o,this.rs=s,this.hs=u}function Rs(){this.ts=new Yo(Xi.N)}function Ds(n){this.N=n?function(t,e){return n(t,e)||Xi.N(t.key,e.key)}:function(t,e){return Xi.N(t.key,e.key)},this.Xe=us,this.Je=new Yo(this.N)}function Ss(){return new Yo(Xi.N)}function Os(){return new Yo(Xi.N)}var ks={asc:"ASCENDING",desc:"DESCENDING"},Ls={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ps=(Vs.prototype.ni=function(t){var e=void 0===t.code?Ni.UNKNOWN:Xo(t.code);return new _i(e,t.message||"")},Vs.prototype.ri=function(t){return this.options.hi||er(t)?t:{value:t}},Vs.prototype.oi=function(t){var e;return er(e="object"==typeof t?t.value:t)?null:e},Vs.prototype.lt=function(t){return{integerValue:""+t}},Vs.prototype._t=function(t){if(this.options.hi){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:nr(t)?"-0":t}},Vs.prototype.ai=function(t){return"number"==typeof(e=t)&&Number.isInteger(e)&&!nr(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER?this.lt(t):this._t(t);var e},Vs.prototype.D=function(t){return this.options.hi?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}},Vs.prototype.v=function(t){var e=lr(t);return new ki(e.seconds,e.nanos)},Vs.prototype.ui=function(t){return this.options.hi?t.toBase64():t.toUint8Array()},Vs.prototype.ci=function(t){return this.options.hi?(zs(void 0===t||"string"==typeof t),Zi.fromBase64String(t||"")):(zs(void 0===t||t instanceof Uint8Array),Zi.fromUint8Array(t||new Uint8Array))},Vs.prototype.toVersion=function(t){return this.D(t.D())},Vs.prototype.fromVersion=function(t){return zs(!!t),Li.v(this.v(t))},Vs.prototype.li=function(t,e){return this._i(e||this.ii).child("documents").child(t).j()},Vs.prototype.fi=function(t){var e=Vi.G(t);return zs(Us(e)),e},Vs.prototype.di=function(t){return this.li(t.path)},Vs.prototype.Z=function(t){var e=this.fi(t);return zs(e.get(1)===this.ii.projectId),zs(!e.get(3)&&!this.ii.database||e.get(3)===this.ii.database),new Xi(this.wi(e))},Vs.prototype.Ti=function(t){return this.li(t)},Vs.prototype.Ei=function(t){var e=this.fi(t);return 4===e.length?Vi.H:this.wi(e)},Object.defineProperty(Vs.prototype,"Ii",{get:function(){return new Vi(["projects",this.ii.projectId,"databases",this.ii.database]).j()},enumerable:!0,configurable:!0}),Vs.prototype._i=function(t){return new Vi(["projects",t.projectId,"databases",t.database])},Vs.prototype.wi=function(t){return zs(4<t.length&&"documents"===t.get(4)),t.L(5)},Vs.prototype.mi=function(t,e){return{name:this.di(t),fields:e.proto.mapValue.fields}},Vs.prototype.Ri=function(t){return{name:this.di(t.key),fields:t.Ot().mapValue.fields,updateTime:this.D(t.version.D())}},Vs.prototype.Ai=function(t,e){var n=this.Z(t.name),i=this.fromVersion(t.updateTime),r=new Hr({mapValue:{fields:t.fields}});return new wo(n,i,r,{hasCommittedMutations:!!e})},Vs.prototype.Pi=function(t){zs(!!t.found),t.found.name,t.found.updateTime;var e=this.Z(t.found.name),n=this.fromVersion(t.found.updateTime),i=new Hr({mapValue:{fields:t.found.fields}});return new wo(e,n,i,{})},Vs.prototype.Vi=function(t){zs(!!t.missing),zs(!!t.readTime);var e=this.Z(t.missing),n=this.fromVersion(t.readTime);return new bo(e,n)},Vs.prototype.pi=function(t){return"found"in t?this.Pi(t):"missing"in t?this.Vi(t):Gs()},Vs.prototype.yi=function(t){if("targetChange"in t){t.targetChange;var e=this.gi(t.targetChange.targetChangeType||"NO_CHANGE"),n=t.targetChange.targetIds||[],i=this.ci(t.targetChange.resumeToken),r=t.targetChange.cause,o=new ds(e,n,i,r&&this.ni(r)||null)}else if("documentChange"in t){t.documentChange;var s=t.documentChange;s.document,s.document.name,s.document.updateTime;var u=this.Z(s.document.name),a=this.fromVersion(s.document.updateTime),h=new Hr({mapValue:{fields:s.document.fields}}),c=new wo(u,a,h,{});o=new ls(s.targetIds||[],s.removedTargetIds||[],c.key,c)}else if("documentDelete"in t){t.documentDelete;var f=t.documentDelete;f.document;var l=this.Z(f.document),p=f.readTime?this.fromVersion(f.readTime):Li.min(),d=new bo(l,p);o=new ls([],f.removedTargetIds||[],d.key,d)}else if("documentRemove"in t){t.documentRemove;var y=t.documentRemove;y.document;var v=this.Z(y.document);o=new ls([],y.removedTargetIds||[],v,null)}else{if(!("filter"in t))return Gs();t.filter;var g=t.filter;g.targetId;var m=new so(g.count||0);o=new ps(g.targetId,m)}return o},Vs.prototype.gi=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Gs()},Vs.prototype.bi=function(t){if(!("targetChange"in t))return Li.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Li.min():this.fromVersion(e.readTime)},Vs.prototype.vi=function(t){var e,n=this;if(t instanceof jr)e={update:this.mi(t.key,t.value)};else if(t instanceof Gr)e={delete:this.di(t.key)};else if(t instanceof Fr)e={update:this.mi(t.key,t.data),updateMask:this.Si(t.Vt)};else if(t instanceof Br)e={transform:{document:this.di(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.Ci(t)})}};else{if(!(t instanceof zr))return Gs();e={verify:this.di(t.key)}}return t.Rt.wt||(e.currentDocument=this.Di(t.Rt)),e},Vs.prototype.Fi=function(t){var e=this,n=t.currentDocument?this.Ni(t.currentDocument):qr.dt();if(t.update){t.update.name;var i=this.Z(t.update.name),r=new Hr({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=this.$i(t.updateMask);return new Fr(i,r,o,n)}return new jr(i,r,n)}if(t.delete){var s=this.Z(t.delete);return new Gr(s,n)}if(t.transform){var u=this.Z(t.transform.document),a=t.transform.fieldTransforms.map(function(t){return e.Li(t)});return zs(!0===n.exists),new Br(u,a)}if(t.verify){var h=this.Z(t.verify);return new zr(h,n)}return Gs()},Vs.prototype.Di=function(t){return void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Gs()},Vs.prototype.Ni=function(t){return void 0!==t.updateTime?qr.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?qr.exists(t.exists):qr.dt()},Vs.prototype.Oi=function(t,e){var n=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e);n.isEqual(Li.min())&&(n=this.fromVersion(e));var i=null;return t.transformResults&&0<t.transformResults.length&&(i=t.transformResults),new Or(n,i)},Vs.prototype.ki=function(t,e){var n=this;return t&&0<t.length?(zs(void 0!==e),t.map(function(t){return n.Oi(t,e)})):[]},Vs.prototype.Ci=function(t){var e=t.transform;if(e instanceof Er)return{fieldPath:t.field.j(),setToServerValue:"REQUEST_TIME"};if(e instanceof Tr)return{fieldPath:t.field.j(),appendMissingElements:{values:e.elements}};if(e instanceof Ar)return{fieldPath:t.field.j(),removeAllFromArray:{values:e.elements}};if(e instanceof Nr)return{fieldPath:t.field.j(),increment:e.ct};throw Gs()},Vs.prototype.Li=function(t){var e,n,i=null;"setToServerValue"in t?(zs("REQUEST_TIME"===t.setToServerValue),i=Er.instance):"appendMissingElements"in t?(e=t.appendMissingElements.values||[],i=new Tr(e)):"removeAllFromArray"in t?(n=t.removeAllFromArray.values||[],i=new Ar(n)):"increment"in t?i=new Nr(this,t.increment):Gs();var r=Wi.J(t.fieldPath);return new Cr(r,i)},Vs.prototype.qi=function(t){return{documents:[this.Ti(t.path)]}},Vs.prototype.Mi=function(t){zs(1===t.documents.length);var e=t.documents[0];return To.Wt(this.Ei(e)).ee()},Vs.prototype.xi=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(e.parent=this.Ti(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=this.Ti(n.O()),e.structuredQuery.from=[{collectionId:n.q()}]);var i=this.Bi(t.filters);i&&(e.structuredQuery.where=i);var r=this.Ui(t.orderBy);r&&(e.structuredQuery.orderBy=r);var o=this.ri(t.limit);return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.Qi(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.Qi(t.endAt)),e},Vs.prototype.Wi=function(t){var e,n=this.Ei(t.parent),i=t.structuredQuery,r=i.from?i.from.length:0,o=null;0<r&&(zs(1===r),(e=i.from[0]).allDescendants?o=e.collectionId:n=n.child(e.collectionId));var s=[];i.where&&(s=this.ji(i.where));var u=[];i.orderBy&&(u=this.Gi(i.orderBy));var a=null;i.limit&&(a=this.oi(i.limit));var h=null;i.startAt&&(h=this.Hi(i.startAt));var c=null;return i.endAt&&(c=this.Hi(i.endAt)),new To(n,o,u,s,a,"F",h,c).ee()},Vs.prototype.Ki=function(t){var e=this.zi(t.we);return null==e?null:{"goog-listen-tags":e}},Vs.prototype.zi=function(t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Gs()}},Vs.prototype.ee=function(t){var e,n=t.target;return(e=n.qt()?{documents:this.qi(n)}:{query:this.xi(n)}).targetId=t.targetId,0<t.resumeToken.rt()&&(e.resumeToken=this.ui(t.resumeToken)),e},Vs.prototype.Bi=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof Ao?e.Yi(t):Gs()});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},Vs.prototype.ji=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.Xi(t)]:void 0!==t.fieldFilter?[this.Ji(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.ji(t)}).reduce(function(t,e){return t.concat(e)}):Gs():[]},Vs.prototype.Ui=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.Zi(t)})},Vs.prototype.Gi=function(t){var e=this;return t.map(function(t){return e.tn(t)})},Vs.prototype.Qi=function(t){return{before:t.before,values:t.position}},Vs.prototype.Hi=function(t){var e=!!t.before,n=t.values||[];return new Oo(n,e)},Vs.prototype.en=function(t){return ks[t]},Vs.prototype.sn=function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}},Vs.prototype.nn=function(t){return Ls[t]},Vs.prototype.rn=function(t){switch(t){case"EQUAL":return"==";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Gs()}},Vs.prototype.hn=function(t){return{fieldPath:t.j()}},Vs.prototype.on=function(t){return Wi.J(t.fieldPath)},Vs.prototype.Zi=function(t){return{field:this.hn(t.field),direction:this.en(t.dir)}},Vs.prototype.tn=function(t){return new ko(this.on(t.field),this.sn(t.direction))},Vs.prototype.Ji=function(t){return Ao.create(this.on(t.fieldFilter.field),this.rn(t.fieldFilter.op),t.fieldFilter.value)},Vs.prototype.Yi=function(t){if("=="===t.op){if(wr(t.value))return{unaryFilter:{field:this.hn(t.field),op:"IS_NAN"}};if(mr(t.value))return{unaryFilter:{field:this.hn(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.hn(t.field),op:this.nn(t.op),value:t.value}}},Vs.prototype.Xi=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.on(t.unaryFilter.field);return Ao.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=this.on(t.unaryFilter.field);return Ao.create(n,"==",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Gs()}},Vs.prototype.Si=function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.j())}),{fieldPaths:e}},Vs.prototype.$i=function(t){var e=t.fieldPaths||[];return new Mr(e.map(function(t){return Wi.J(t)}))},Vs);function Vs(t,e){this.ii=t,this.options=e}function Us(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var Ms=(qs.an=function(t){qs.platform&&Gs(),qs.platform=t},qs.nt=function(){return qs.platform||Gs(),qs.platform},qs),Cs=new h("@firebase/firestore");function qs(){}function xs(){return Cs.logLevel}function js(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];Cs.logLevel<=p.DEBUG&&(e=n.map(Bs),Cs.debug.apply(Cs,y(["Firestore ("+wi+"): "+t],e)))}function Fs(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];Cs.logLevel<=p.ERROR&&(e=n.map(Bs),Cs.error.apply(Cs,y(["Firestore ("+wi+"): "+t],e)))}function Bs(t){if("string"==typeof t)return t;var e=Ms.nt();try{return e.un(t)}catch(e){return t}}function Gs(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+wi+") INTERNAL ASSERTION FAILED: "+t;throw Fs(e),new Error(e)}function zs(t){t||Gs()}var Hs=(Ws.cn=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var i=Ms.nt().ln(40),r=0;r<i.length;++r)n.length<20&&i[r]<e&&(n+=t.charAt(i[r]%t.length));return n},Ws);function Ws(){}function Qs(t,e){return t<e?-1:e<t?1:0}function Xs(t,n,i){return t.length===n.length&&t.every(function(t,e){return i(t,n[e])})}function Ys(t,e,n,i,r){this.ii=t,this.persistenceKey=e,this.host=n,this.ssl=i,this.forceLongPolling=r}var Ks=(Object.defineProperty(fu.prototype,"_n",{get:function(){return"(default)"===this.database},enumerable:!0,configurable:!0}),fu.prototype.isEqual=function(t){return t instanceof fu&&t.projectId===this.projectId&&t.database===this.database},fu.prototype.S=function(t){return Qs(this.projectId,t.projectId)||Qs(this.database,t.database)},fu),$s=(cu.prototype.get=function(t){var e=this.fn(t),n=this.dn[e];if(void 0!==n)for(var i=0,r=n;i<r.length;i++){var o=r[i],s=o[0],u=o[1];if(s.isEqual(t))return u}},cu.prototype.has=function(t){return void 0!==this.get(t)},cu.prototype.set=function(t,e){var n=this.fn(t),i=this.dn[n];if(void 0!==i){for(var r=0;r<i.length;r++)if(i[r][0].isEqual(t))return void(i[r]=[t,e]);i.push([t,e])}else this.dn[n]=[[t,e]]},cu.prototype.delete=function(t){var e=this.fn(t),n=this.dn[e];if(void 0===n)return!1;for(var i=0;i<n.length;i++)if(n[i][0].isEqual(t))return 1===n.length?delete this.dn[e]:n.splice(i,1),!0;return!1},cu.prototype.forEach=function(u){$i(this.dn,function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n],o=r[0],s=r[1];u(o,s)}})},cu.prototype.M=function(){return Ji(this.dn)},cu),Js=(hu.prototype.at=function(t,e,n){for(var i=n.Tn,r=0;r<this.mutations.length;r++){var o,s=this.mutations[r];s.key.isEqual(t)&&(o=i[r],e=s.at(e,o))}return e},hu.prototype.ot=function(t,e){for(var n=0,i=this.baseMutations;n<i.length;n++){var r=i[n];r.key.isEqual(t)&&(e=r.ot(e,e,this.wn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=a.ot(e,o,this.wn))}return e},hu.prototype.En=function(n){var i=this,r=n;return this.mutations.forEach(function(t){var e=i.ot(t.key,n.get(t.key));e&&(r=r.Re(t.key,e))}),r},hu.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},cs())},hu.prototype.isEqual=function(t){return this.batchId===t.batchId&&Xs(this.mutations,t.mutations,function(t,e){return t.isEqual(e)})&&Xs(this.baseMutations,t.baseMutations,function(t,e){return t.isEqual(e)})},hu),Zs=(au.from=function(t,e,n){zs(t.mutations.length===n.length);for(var i=as,r=t.mutations,o=0;o<r.length;o++)i=i.Re(r[o].key,n[o].version);return new au(t,e,n,i)},au),tu=(uu.prototype.catch=function(t){return this.next(void 0,t)},uu.prototype.next=function(i,r){var o=this;return this.Vn&&Gs(),this.Vn=!0,this.Pn?this.error?this.pn(r,this.error):this.yn(i,this.result):new uu(function(e,n){o.Rn=function(t){o.yn(i,t).next(e,n)},o.An=function(t){o.pn(r,t).next(e,n)}})},uu.prototype.gn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},uu.prototype.bn=function(t){try{var e=t();return e instanceof uu?e:uu.resolve(e)}catch(t){return uu.reject(t)}},uu.prototype.yn=function(t,e){return t?this.bn(function(){return t(e)}):uu.resolve(e)},uu.prototype.pn=function(t,e){return t?this.bn(function(){return t(e)}):uu.reject(e)},uu.resolve=function(n){return new uu(function(t,e){t(n)})},uu.reject=function(n){return new uu(function(t,e){e(n)})},uu.vn=function(t){return new uu(function(e,n){var i=0,r=0,o=!1;t.forEach(function(t){++i,t.next(function(){++r,o&&r===i&&e()},function(t){return n(t)})}),o=!0,r===i&&e()})},uu.Sn=function(t){for(var n=uu.resolve(!1),e=function(e){n=n.next(function(t){return t?uu.resolve(t):e()})},i=0,r=t;i<r.length;i++)e(r[i]);return n},uu.forEach=function(t,n){var i=this,r=[];return t.forEach(function(t,e){r.push(n.call(i,t,e))}),this.vn(r)},uu),eu=(su.prototype.Nn=function(e,n){var i=this;return this.Dn.$n(e,n).next(function(t){return i.Ln(e,n,t)})},su.prototype.Ln=function(t,i,r){return this.Cn.On(t,i).next(function(t){for(var e=0,n=r;e<n.length;e++)t=n[e].ot(i,t);return t})},su.prototype.kn=function(t,e,r){var o=rs;return e.forEach(function(t,e){for(var n=0,i=r;n<i.length;n++)e=i[n].ot(t,e);o=o.Re(t,e)}),o},su.prototype.qn=function(e,t){var n=this;return this.Cn.getEntries(e,t).next(function(t){return n.Mn(e,t)})},su.prototype.Mn=function(i,r){var o=this;return this.Dn.xn(i,r).next(function(t){var e=o.kn(i,r,t),n=rs;return e.forEach(function(t,e){e=e||new bo(t,Li.min()),n=n.Re(t,e)}),n})},su.prototype.Bn=function(t,e,n){return e.qt()?this.Un(t,e.path):e.le()?this.Qn(t,e,n):this.Wn(t,e,n)},su.prototype.Un=function(t,e){return this.Nn(t,new Xi(e)).next(function(t){var e=us;return t instanceof wo&&(e=e.Re(t.key,t)),e})},su.prototype.Qn=function(n,i,r){var o=this,s=i.collectionGroup,u=us;return this.Fn.jn(n,s).next(function(t){return tu.forEach(t,function(t){var e=i.Zt(t.child(s));return o.Wn(n,e,r).next(function(t){t.forEach(function(t,e){u=u.Re(t,e)})})}).next(function(){return u})})},su.prototype.Wn=function(e,n,t){var c,f,i=this;return this.Cn.Bn(e,n,t).next(function(t){return c=t,i.Dn.Gn(e,n)}).next(function(t){return f=t,i.Hn(e,f,c).next(function(t){c=t;for(var e=0,n=f;e<n.length;e++)for(var i=n[e],r=0,o=i.mutations;r<o.length;r++){var s=o[r],u=s.key,a=c.get(u),h=s.ot(a,a,i.wn);c=h instanceof wo?c.Re(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){n.matches(e)||(c=c.remove(t))}),c})},su.prototype.Hn=function(t,e,n){for(var i=cs(),r=0,o=e;r<o.length;r++)for(var s=0,u=o[r].mutations;s<u.length;s++){var a=u[s];a instanceof Fr&&null===n.get(a.key)&&(i=i.add(a.key))}var h=n;return this.Cn.getEntries(t,i).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof wo&&(h=h.Re(t,e))}),h})},su),nu=(ou.Yn=function(t,e){for(var n=cs(),i=cs(),r=0,o=e.docChanges;r<o.length;r++){var s=o[r];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new ou(t,e.fromCache,n,i)},ou),iu=(ru.prototype.Jn=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},ru.prototype.next=function(){var t=++this.previousValue;return this.Zn&&this.Zn(t),t},ru);function ru(t,e){var n=this;this.previousValue=t,e&&(e.Xn=function(t){return n.Jn(t)},this.Zn=function(t){return e.tr(t)})}function ou(t,e,n,i){this.targetId=t,this.fromCache=e,this.Kn=n,this.zn=i}function su(t,e,n){this.Cn=t,this.Dn=e,this.Fn=n}function uu(t){var e=this;this.Rn=null,this.An=null,this.result=void 0,this.error=void 0,this.Pn=!1,this.Vn=!1,t(function(t){e.Pn=!0,e.result=t,e.Rn&&e.Rn(t)},function(t){e.Pn=!0,e.error=t,e.An&&e.An(t)})}function au(t,e,n,i){this.batch=t,this.In=e,this.Tn=n,this.mn=i}function hu(t,e,n,i){this.batchId=t,this.wn=e,this.baseMutations=n,this.mutations=i}function cu(t){this.fn=t,this.dn={}}function fu(t,e){this.projectId=t,this.database=e||"(default)"}function lu(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}iu.er=-1;var pu=(bu.prototype.reset=function(){this.or=0},bu.prototype.cr=function(){this.or=this.hr},bu.prototype.lr=function(t){var e=this;this.cancel();var n=Math.floor(this.or+this._r()),i=Math.max(0,Date.now()-this.ur),r=Math.max(0,n-i);0<r&&js("ExponentialBackoff","Backing off for "+r+" ms (base delay: "+this.or+" ms, delay with jitter: "+n+" ms, last attempt: "+i+" ms ago)"),this.ar=this.sr.dr(this.ir,r,function(){return e.ur=Date.now(),t()}),this.or*=this.rr,this.or<this.nr&&(this.or=this.nr),this.or>this.hr&&(this.or=this.hr)},bu.prototype.wr=function(){null!==this.ar&&(this.ar.Tr(),this.ar=null)},bu.prototype.cancel=function(){null!==this.ar&&(this.ar.cancel(),this.ar=null)},bu.prototype._r=function(){return(Math.random()-.5)*this.or},bu),du=(wu.prototype.Ir=function(t,e){return this.Er.add(e),tu.resolve()},wu.prototype.jn=function(t,e){return tu.resolve(this.Er.getEntries(e))},wu),yu=(mu.prototype.add=function(t){var e=t.q(),n=t.O(),i=this.index[e]||new ns(Vi.N),r=!i.has(n);return this.index[e]=i.add(n),r},mu.prototype.has=function(t){var e=t.q(),n=t.O(),i=this.index[e];return i&&i.has(n)},mu.prototype.getEntries=function(t){return(this.index[t]||new ns(Vi.N)).W()},mu),vu=(gu.prototype.next=function(){return this.mr+=2,this.mr},gu.Rr=function(){return new gu(0)},gu.Ar=function(){return new gu(-1)},gu);function gu(t){this.mr=t}function mu(){this.index={}}function wu(){this.Er=new yu}function bu(t,e,n,i,r){void 0===n&&(n=1e3),void 0===i&&(i=1.5),void 0===r&&(r=6e4),this.sr=t,this.ir=e,this.nr=n,this.rr=i,this.hr=r,this.or=0,this.ar=null,this.ur=Date.now(),this.reset()}function Eu(t){return"IndexedDbTransactionError"===t.name}var Iu=(Nu.gr=function(t,e,n,i,r){var o=new Nu(t,e,Date.now()+n,i,r);return o.start(n),o},Nu.prototype.start=function(t){var e=this;this.br=setTimeout(function(){return e.vr()},t)},Nu.prototype.Tr=function(){return this.vr()},Nu.prototype.cancel=function(t){null!==this.br&&(this.clearTimeout(),this.yr.reject(new _i(Ni.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Nu.prototype.vr=function(){var e=this;this.Pr.Sr(function(){return null!==e.br?(e.clearTimeout(),e.op().then(function(t){return e.yr.resolve(t)})):Promise.resolve()})},Nu.prototype.clearTimeout=function(){null!==this.br&&(this.pr(this),clearTimeout(this.br),this.br=null)},Nu),Tu=(Object.defineProperty(Au.prototype,"Mr",{get:function(){return this.Fr},enumerable:!0,configurable:!0}),Au.prototype.Sr=function(t){this.enqueue(t)},Au.prototype.xr=function(t){this.Br(),this.Ur(t)},Au.prototype.Qr=function(t){return this.Br(),this.Ur(t)},Au.prototype.Wr=function(n){return l(this,void 0,void 0,function(){var e;return d(this,function(t){switch(t.label){case 0:return this.Br(),this.Fr?[3,2]:(this.Fr=!0,(e=Ms.nt().window)&&e.removeEventListener("visibilitychange",this.qr),[4,this.Qr(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Au.prototype.enqueue=function(t){return this.Br(),this.Fr?new Promise(function(t){}):this.Ur(t)},Au.prototype.jr=function(r){var t=this;this.Br(),this.Fr||(this.Dr=this.Dr.then(function(){var n=new lu,i=function(){return l(t,void 0,void 0,function(){var e;return d(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,r()];case 1:return t.sent(),n.resolve(),this.kr.reset(),[3,3];case 2:if(!Eu(e=t.sent()))throw n.resolve(),e;return js("AsyncQueue","Operation failed with retryable error: "+e),this.kr.lr(i),[3,3];case 3:return[2]}})})};return t.Sr(i),n.promise}))},Au.prototype.Ur=function(t){var i=this,e=this.Cr.then(function(){return i.Lr=!0,t().catch(function(t){throw i.$r=t,i.Lr=!1,Fs("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return i.Lr=!1,t})});return this.Cr=e},Au.prototype.dr=function(t,e,n){var i=this;this.Br(),-1<this.Or.indexOf(t)&&(e=0);var r=Iu.gr(this,t,e,n,function(t){return i.Gr(t)});return this.Nr.push(r),r},Au.prototype.Br=function(){this.$r&&Gs()},Au.prototype.Hr=function(){},Au.prototype.Kr=function(){return l(this,void 0,void 0,function(){var e;return d(this,function(t){switch(t.label){case 0:return[4,e=this.Cr];case 1:t.sent(),t.label=2;case 2:if(e!==this.Cr)return[3,0];t.label=3;case 3:return[2]}})})},Au.prototype.zr=function(t){for(var e=0,n=this.Nr;e<n.length;e++)if(n[e].ir===t)return!0;return!1},Au.prototype.Yr=function(i){var r=this;return this.Kr().then(function(){r.Nr.sort(function(t,e){return t.Vr-e.Vr});for(var t=0,e=r.Nr;t<e.length;t++){var n=e[t];if(n.Tr(),"all"!==i&&n.ir===i)break}return r.Kr()})},Au.prototype.Xr=function(t){this.Or.push(t)},Au.prototype.Gr=function(t){var e=this.Nr.indexOf(t);this.Nr.splice(e,1)},Au);function Au(){var t=this;this.Cr=Promise.resolve(),this.Dr=Promise.resolve(),this.Fr=!1,this.Nr=[],this.$r=null,this.Lr=!1,this.Or=[],this.kr=new pu(this,"async_queue_retry"),this.qr=function(){return t.kr.wr()};var e=Ms.nt().window;e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.qr)}function Nu(t,e,n,i,r){this.Pr=t,this.ir=e,this.Vr=n,this.op=i,this.pr=r,this.yr=new lu,this.then=this.yr.promise.then.bind(this.yr.promise),this.yr.promise.catch(function(t){})}function _u(t,e){if(Fs("AsyncQueue",e+": "+t),Eu(t))return new _i(Ni.UNAVAILABLE,e+": "+t);throw t}var Ru=(Du.eh=function(t){return new Du(t,Du.sh,Du.ih)},Du);function Du(t,e,n){this.Jr=t,this.Zr=e,this.th=n}Ru.nh=-1,Ru.rh=1048576,Ru.hh=41943040,Ru.sh=10,Ru.ih=1e3,Ru.oh=new Ru(Ru.hh,Ru.sh,Ru.ih),Ru.DISABLED=new Ru(Ru.nh,0,0);var Su=(Ou.prototype.start=function(){return Promise.resolve()},Ou.prototype.Ah=function(r){return l(this,void 0,void 0,function(){var e,m,n,i=this;return d(this,function(t){switch(t.label){case 0:return e=this.Dn,m=this.Ih,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return i.Dn.Ph(v).next(function(t){return g=t,e=i.persistence.fh(r),m=new eu(i.dh,e,i.persistence.mh()),e.Ph(v)}).next(function(t){for(var e=[],n=[],i=cs(),r=0,o=g;r<o.length;r++){var s=o[r];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],i=i.add(h.key)}for(var c=0,f=t;c<f.length;c++){var l=f[c];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];i=i.add(y.key)}}return m.qn(v,i).next(function(t){return{Vh:t,ph:e,yh:n}})})})];case 1:return n=t.sent(),[2,(this.Dn=e,this.Ih=m,this.ah.Rh(this.Ih),n)]}})})},Ou.prototype.gh=function(u){var a,h=this,c=ki.now(),t=u.reduce(function(t,e){return t.add(e.key)},cs());return this.persistence.runTransaction("Locally write mutations","readwrite",function(s){return h.Ih.qn(s,t).next(function(t){a=t;for(var e=[],n=0,i=u;n<i.length;n++){var r=i[n],o=r.Pt(a.get(r.key));null!=o&&e.push(new Fr(r.key,o,ro(o.proto.mapValue),qr.exists(!0)))}return h.Dn.bh(s,c,e,u)})}).then(function(t){var e=t.En(a);return{batchId:t.batchId,vh:e}})},Ou.prototype.Sh=function(i){var r=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=i.batch.keys(),n=r.dh.Ch({Dh:!0});return r.Fh(t,i,n).next(function(){return n.apply(t)}).next(function(){return r.Dn.Nh(t)}).next(function(){return r.Ih.qn(t,e)})})},Ou.prototype.$h=function(t){var i=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Dn.Lh(e,t).next(function(t){return zs(null!==t),n=t.keys(),i.Dn.Oh(e,t)}).next(function(){return i.Dn.Nh(e)}).next(function(){return i.Ih.qn(e,n)})})},Ou.prototype.kh=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Dn.kh(t)})},Ou.prototype.qh=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Th.qh(t)})},Ou.prototype.Mh=function(a){var h=this,c=a.Te,f=this.uh;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var r=h.dh.Ch({Dh:!0});f=h.uh;var s=[];a.as.forEach(function(t,e){var n,i,r=f.get(e);r&&(s.push(h.Th.xh(o,t.Es,e).next(function(){return h.Th.Bh(o,t.ws,e)})),0<(n=t.resumeToken).rt()&&(i=r.Ie(n,c).Ee(o.Uh),f=f.Re(e,i),Ou.Qh(r,i,t)&&s.push(h.Th.Wh(o,i))))});var t,u=rs,n=cs();return a.cs.forEach(function(t,e){n=n.add(t)}),s.push(r.getEntries(o,n).next(function(i){a.cs.forEach(function(t,e){var n=i.get(t);e instanceof bo&&e.version.isEqual(Li.min())?(r.jh(t,c),u=u.Re(t,e)):null==n||0<e.version.S(n.version)||0===e.version.S(n.version)&&n.hasPendingWrites?(r.Gh(e,c),u=u.Re(t,e)):js("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.ls.has(t)&&s.push(h.persistence.Kh.Hh(o,t))})})),c.isEqual(Li.min())||(t=h.Th.qh(o).next(function(t){return h.Th.zh(o,o.Uh,c)}),s.push(t)),tu.vn(s).next(function(){return r.apply(o)}).next(function(){return h.Ih.Mn(o,u)})}).then(function(t){return h.uh=f,t})},Ou.Qh=function(t,e,n){return zs(0<e.resumeToken.rt()),0===t.resumeToken.rt()||e.Te.C()-t.Te.C()>=this.Yh||0<n.ws.size+n.Ts.size+n.Es.size},Ou.prototype.Xh=function(c){return l(this,void 0,void 0,function(){var e,n,i,r,o,s,u,a,h=this;return d(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return tu.forEach(c,function(e){return tu.forEach(e.Kn,function(t){return h.persistence.Kh.Jh(n,e.targetId,t)}).next(function(){return tu.forEach(e.zn,function(t){return h.persistence.Kh.Zh(n,e.targetId,t)})})})})];case 1:return t.sent(),[3,3];case 2:if(!Eu(e=t.sent()))throw e;return js("LocalStore","Failed to update sequence numbers: "+e),[3,3];case 3:for(n=0,i=c;n<i.length;n++)r=i[n],o=r.targetId,r.fromCache||(s=this.uh.get(o),u=s.Te,a=s.me(u),this.uh=this.uh.Re(o,a));return[2]}})})},Ou.prototype.to=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Dn.eo(t,e)})},Ou.prototype.so=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Ih.Nn(t,e)})},Ou.prototype.io=function(i){var r=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return r.Th.no(e,i).next(function(t){return t?(n=t,tu.resolve(n)):r.Th.ro(e).next(function(t){return n=new Lo(i,t,0,e.Uh),r.Th.ho(e,n).next(function(){return n})})})}).then(function(t){var e=r.uh.get(t.targetId);return(null===e||0<t.Te.S(e.Te))&&(r.uh=r.uh.Re(t.targetId,t),r.lh.set(i,t.targetId)),t})},Ou.prototype.no=function(t,e){var n=this.lh.get(e);return void 0!==n?tu.resolve(this.uh.get(n)):this.Th.no(t,e)},Ou.prototype.oo=function(t,e){var n=this,i=this.uh.get(t),r=e?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release target",r,function(t){return e?tu.resolve():n.persistence.Kh.removeTarget(t,i)}).then(function(){n.uh=n.uh.remove(t),n.lh.delete(i.target)})},Ou.prototype.ao=function(t,n){var i=this,r=Li.min(),o=cs();return this.persistence.runTransaction("Execute query","readonly",function(e){return i.no(e,t.ee()).next(function(t){if(t)return r=t.lastLimboFreeSnapshotVersion,i.Th.uo(e,t.targetId).next(function(t){o=t})}).next(function(){return i.ah.Bn(e,t,n?r:Li.min(),n?o:cs())}).next(function(t){return{documents:t,co:o}})})},Ou.prototype.Fh=function(t,r,o){var e=this,s=r.batch,n=s.keys(),u=tu.resolve();return n.forEach(function(i){u=u.next(function(){return o.On(t,i)}).next(function(t){var e=t,n=r.mn.get(i);zs(null!==n),(!e||e.version.S(n)<0)&&(e=s.at(i,e,r))&&o.Gh(e,r.In)})}),u.next(function(){return e.Dn.Oh(t,s)})},Ou.prototype.lo=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e._o(t,n.uh)})},Ou);function Ou(t,e,n){this.persistence=t,this.ah=e,this.uh=new Yo(Qs),this.lh=new $s(function(t){return t.canonicalId()}),this._h=Li.min(),this.Dn=t.fh(n),this.dh=t.wh(),this.Th=t.Eh(),this.Ih=new eu(this.dh,this.Dn,this.persistence.mh()),this.ah.Rh(this.Ih)}function ku(e){return l(this,void 0,void 0,function(){return d(this,function(t){if(e.code!==Ni.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return js("LocalStore","Unexpectedly lost primary lease"),[2]})})}Su.Yh=3e8;var Lu=(Uu.prototype.M=function(){return this.fo.M()},Uu.prototype.Jh=function(t,e){var n=new Pu(t,e);this.fo=this.fo.add(n),this.wo=this.wo.add(n)},Uu.prototype.Eo=function(t,e){var n=this;t.forEach(function(t){return n.Jh(t,e)})},Uu.prototype.Zh=function(t,e){this.Io(new Pu(t,e))},Uu.prototype.mo=function(t,e){var n=this;t.forEach(function(t){return n.Zh(t,e)})},Uu.prototype.Ro=function(t){var e=this,n=Xi.EMPTY,i=new Pu(n,t),r=new Pu(n,t+1),o=[];return this.wo.Ge([i,r],function(t){e.Io(t),o.push(t.key)}),o},Uu.prototype.Ao=function(){var e=this;this.fo.forEach(function(t){return e.Io(t)})},Uu.prototype.Io=function(t){this.fo=this.fo.delete(t),this.wo=this.wo.delete(t)},Uu.prototype.Po=function(t){var e=Xi.EMPTY,n=new Pu(e,t),i=new Pu(e,t+1),r=cs();return this.wo.Ge([n,i],function(t){r=r.add(t.key)}),r},Uu.prototype.Vo=function(t){var e=new Pu(t,0),n=this.fo.Ke(e);return null!==n&&t.isEqual(n.key)},Uu),Pu=(Vu.do=function(t,e){return Xi.N(t.key,e.key)||Qs(t.po,e.po)},Vu.To=function(t,e){return Qs(t.po,e.po)||Xi.N(t.key,e.key)},Vu);function Vu(t,e){this.key=t,this.po=e}function Uu(){this.fo=new ns(Pu.do),this.wo=new ns(Pu.To)}function Mu(t,e){if(0!==e.length)throw new _i(Ni.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+ta(e.length,"argument")+".")}function Cu(t,e,n){if(e.length!==n)throw new _i(Ni.INVALID_ARGUMENT,"Function "+t+"() requires "+ta(n,"argument")+", but was called with "+ta(e.length,"argument")+".")}function qu(t,e,n){if(e.length<n)throw new _i(Ni.INVALID_ARGUMENT,"Function "+t+"() requires at least "+ta(n,"argument")+", but was called with "+ta(e.length,"argument")+".")}function xu(t,e,n,i){if(e.length<n||e.length>i)throw new _i(Ni.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+i+" arguments, but was called with "+ta(e.length,"argument")+".")}function ju(t,e,n,i){Wu(t,e,Zu(n)+" argument",i)}function Fu(t,e,n,i){void 0!==i&&ju(t,e,n,i)}function Bu(t,e,n,i){Wu(t,e,n+" option",i)}function Gu(t,e,n,i){void 0!==i&&Bu(t,e,n,i)}function zu(t,e,n,i,a){void 0!==i&&function(t,e,n){for(var i=[],r=0,o=a;r<o.length;r++){var s=o[r];if(s===n)return;i.push(Xu(s))}var u=Xu(n);throw new _i(Ni.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+i.join(", "))}(t,n,i)}function Hu(t,e,n,i){if(!e.some(function(t){return t===i}))throw new _i(Ni.INVALID_ARGUMENT,"Invalid value "+Xu(i)+" provided to function "+t+"() for its "+Zu(n)+" argument. Acceptable values: "+e.join(", "));return i}function Wu(t,e,n,i){if(!("object"===e?Qu(i):"non-empty string"===e?"string"==typeof i&&""!==i:typeof i===e)){var r=Xu(i);throw new _i(Ni.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}}function Qu(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Xu(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Gs();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Yu(t,e,n){if(void 0===n)throw new _i(Ni.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Zu(e)+" argument, but it was undefined.")}function Ku(n,t,i){$i(t,function(t,e){if(i.indexOf(t)<0)throw new _i(Ni.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+i.join(", "))})}function $u(t,e,n,i){var r=Xu(i);return new _i(Ni.INVALID_ARGUMENT,"Function "+t+"() requires its "+Zu(n)+" argument to be a "+e+", but it was: "+r)}function Ju(t,e,n){if(n<=0)throw new _i(Ni.INVALID_ARGUMENT,"Function "+t+"() requires its "+Zu(e)+" argument to be a positive number, but it was: "+n+".")}function Zu(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function ta(t,e){return t+" "+e+(1===t?"":"s")}function ea(){if("undefined"==typeof Uint8Array)throw new _i(Ni.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function na(){if(!Ms.nt().yo)throw new _i(Ni.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function ia(t){!function(){if(!(t instanceof Array)||t.length<1)throw new _i(Ni.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(ju("FieldPath","string",e,t[e]),0===t[e].length)throw new _i(Ni.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.vo=new Wi(t)}var ra,oa=(aa.fromBase64String=function(t){Cu("Blob.fromBase64String",arguments,1),ju("Blob.fromBase64String","string",1,t),na();try{return new aa(Zi.fromBase64String(t))}catch(t){throw new _i(Ni.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},aa.fromUint8Array=function(t){if(Cu("Blob.fromUint8Array",arguments,1),ea(),!(t instanceof Uint8Array))throw $u("Blob.fromUint8Array","Uint8Array",1,t);return new aa(Zi.fromUint8Array(t))},aa.prototype.toBase64=function(){return Cu("Blob.toBase64",arguments,0),na(),this.bo.toBase64()},aa.prototype.toUint8Array=function(){return Cu("Blob.toUint8Array",arguments,0),ea(),this.bo.toUint8Array()},aa.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},aa.prototype.isEqual=function(t){return this.bo.isEqual(t.bo)},aa),sa=(n(ua,ra=ia),ua.documentId=function(){return ua.So},ua.prototype.isEqual=function(t){if(!(t instanceof ua))throw $u("isEqual","FieldPath",1,t);return this.vo.isEqual(t.vo)},ua);function ua(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ra.call(this,t)||this}function aa(t){na(),this.bo=t}sa.So=new sa(Wi.X().j());var ha,ca,fa,la,pa,da,ya,va=new RegExp("[~\\*/\\[\\]]"),ga=function(){this.Co=this},ma=(n(xa,ya=ga),xa.prototype.Fo=function(t){if(2!==t.No)throw 1===t.No?t.$o(this.Do+"() can only appear at the top level of your update data"):t.$o(this.Do+"() cannot be used with set() unless you pass {merge:true}");return t.Vt.push(t.path),null},xa.prototype.isEqual=function(t){return t instanceof xa},xa),wa=(n(qa,da=ga),qa.prototype.Fo=function(t){return new Cr(t.path,Er.instance)},qa.prototype.isEqual=function(t){return t instanceof qa},qa),ba=(n(Ca,pa=ga),Ca.prototype.Fo=function(t){var e=new Fa({No:3,methodName:this.Do,Oo:!0},t.ii,t.serializer,t.ignoreUndefinedProperties),n=this.Lo.map(function(t){return Ha(t,e)}),i=new Tr(n);return new Cr(t.path,i)},Ca.prototype.isEqual=function(t){return this===t},Ca),Ea=(n(Ma,la=ga),Ma.prototype.Fo=function(t){var e=new Fa({No:3,methodName:this.Do,Oo:!0},t.ii,t.serializer,t.ignoreUndefinedProperties),n=this.Lo.map(function(t){return Ha(t,e)}),i=new Ar(n);return new Cr(t.path,i)},Ma.prototype.isEqual=function(t){return this===t},Ma),Ia=(n(Ua,fa=ga),Ua.prototype.Fo=function(t){var e=new Fa({No:3,methodName:this.Do},t.ii,t.serializer,t.ignoreUndefinedProperties),n=Ha(this.ko,e),i=new Nr(t.serializer,n);return new Cr(t.path,i)},Ua.prototype.isEqual=function(t){return this===t},Ua),Ta=(n(Va,ca=ga),Va.delete=function(){return Mu("FieldValue.delete",arguments),new Aa(new ma("FieldValue.delete"))},Va.serverTimestamp=function(){return Mu("FieldValue.serverTimestamp",arguments),new Aa(new wa("FieldValue.serverTimestamp"))},Va.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return qu("FieldValue.arrayUnion",arguments,1),new Aa(new ba("FieldValue.arrayUnion",t))},Va.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return qu("FieldValue.arrayRemove",arguments,1),new Aa(new Ea("FieldValue.arrayRemove",t))},Va.increment=function(t){return ju("FieldValue.increment","number",1,t),Cu("FieldValue.increment",arguments,1),new Aa(new Ia("FieldValue.increment",t))},Va),Aa=(n(Pa,ha=Ta),Pa.prototype.Fo=function(t){return this.Co.Fo(t)},Pa.prototype.isEqual=function(t){return t instanceof Pa&&this.Co.isEqual(t.Co)},Pa),Na=(Object.defineProperty(La.prototype,"latitude",{get:function(){return this.qo},enumerable:!0,configurable:!0}),Object.defineProperty(La.prototype,"longitude",{get:function(){return this.Mo},enumerable:!0,configurable:!0}),La.prototype.isEqual=function(t){return this.qo===t.qo&&this.Mo===t.Mo},La.prototype.g=function(t){return Qs(this.qo,t.qo)||Qs(this.Mo,t.Mo)},La),_a=/^__.*__$/,Ra=function(t,e,n){this.xo=t,this.Bo=e,this.Uo=n},Da=(ka.prototype.Qo=function(t,e){var n=[];return null!==this.Vt?n.push(new Fr(t,this.data,this.Vt,e)):n.push(new jr(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Br(t,this.fieldTransforms)),n},ka),Sa=(Oa.prototype.Qo=function(t,e){var n=[new Fr(t,this.data,this.Vt,e)];return 0<this.fieldTransforms.length&&n.push(new Br(t,this.fieldTransforms)),n},Oa);function Oa(t,e,n){this.data=t,this.Vt=e,this.fieldTransforms=n}function ka(t,e,n){this.data=t,this.Vt=e,this.fieldTransforms=n}function La(t,e){if(Cu("GeoPoint",arguments,2),ju("GeoPoint","number",1,t),ju("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new _i(Ni.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new _i(Ni.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.qo=t,this.Mo=e}function Pa(t){var e=this;return(e=ha.call(this)||this).Co=t,e.Do=t.Do,e}function Va(){return null!==ca&&ca.apply(this,arguments)||this}function Ua(t,e){var n=this;return(n=fa.call(this)||this).Do=t,n.ko=e,n}function Ma(t,e){var n=this;return(n=la.call(this)||this).Do=t,n.Lo=e,n}function Ca(t,e){var n=this;return(n=pa.call(this)||this).Do=t,n.Lo=e,n}function qa(t){var e=this;return(e=da.call(this)||this).Do=t,e}function xa(t){var e=this;return(e=ya.call(this)||this).Do=t,e}function ja(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Gs()}}var Fa=(Object.defineProperty(za.prototype,"path",{get:function(){return this.settings.path},enumerable:!0,configurable:!0}),Object.defineProperty(za.prototype,"No",{get:function(){return this.settings.No},enumerable:!0,configurable:!0}),za.prototype.jo=function(t){return new za(Object.assign(Object.assign({},this.settings),t),this.ii,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Vt)},za.prototype.Go=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.jo({path:n,Oo:!1});return i.Ho(t),i},za.prototype.Ko=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),i=this.jo({path:n,Oo:!1});return i.Wo(),i},za.prototype.zo=function(t){return this.jo({path:void 0,Oo:!0})},za.prototype.$o=function(t){var e=!this.path||this.path.M()?"":" (found in field "+this.path.toString()+")";return new _i(Ni.INVALID_ARGUMENT,"Function "+this.settings.methodName+"() called with invalid data. "+t+e)},za.prototype.contains=function(e){return void 0!==this.Vt.find(function(t){return e.B(t)})||void 0!==this.fieldTransforms.find(function(t){return e.B(t.field)})},za.prototype.Wo=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Ho(this.path.get(t))},za.prototype.Ho=function(t){if(0===t.length)throw this.$o("Document fields must not be empty");if(ja(this.No)&&_a.test(t))throw this.$o('Document fields cannot begin and end with "__"')},za),Ba=(Ga.prototype.Xo=function(t,e,n){void 0===n&&(n={});var i=this.Jo(n.merge||n.mergeFields?2:0,t);Xa("Data must be an object, but it was:",i,e);var r,o,s=Wa(e,i);if(n.merge)r=new Mr(i.Vt),o=i.fieldTransforms;else if(n.mergeFields){for(var u=[],a=0,h=n.mergeFields;a<h.length;a++){var c=h[a],f=void 0;if(c instanceof ia)f=c.vo;else{if("string"!=typeof c)throw Gs();f=Ka(t,c)}if(!i.contains(f))throw new _i(Ni.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");$a(u,f)||u.push(f)}r=new Mr(u),o=i.fieldTransforms.filter(function(t){return r.ft(t.field)})}else r=null,o=i.fieldTransforms;return new Da(new Hr(s),r,o)},Ga.prototype.Zo=function(o,t){var s=this.Jo(1,o);Xa("Data must be an object, but it was:",s,t);var u=[],a=new Wr;$i(t,function(t,e){var n,i=Ka(o,t),r=s.Ko(i);e instanceof ga&&e.Co instanceof ma?u.push(i):null!=(n=Ha(e,r))&&(u.push(i),a.set(i,n))});var e=new Mr(u);return new Sa(a.gt(),e,s.fieldTransforms)},Ga.prototype.ta=function(t,e,n,i){var r=this.Jo(1,t),o=[Ya(t,e)],s=[n];if(i.length%2!=0)throw new _i(Ni.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var u=0;u<i.length;u+=2)o.push(Ya(t,i[u])),s.push(i[u+1]);for(var a,h,c,f,l=[],p=new Wr,d=o.length-1;0<=d;--d){$a(l,o[d])||(a=o[d],h=s[d],c=r.Ko(a),h instanceof ga&&h.Co instanceof ma?l.push(a):null!=(f=Ha(h,c))&&(l.push(a),p.set(a,f)))}var y=new Mr(l);return new Sa(p.gt(),y,r.fieldTransforms)},Ga.prototype.Jo=function(t,e){return new Fa({No:t,methodName:e,path:Wi.H,Oo:!1},this.ii,this.serializer,this.ignoreUndefinedProperties)},Ga.prototype.ea=function(t,e,n){return void 0===n&&(n=!1),Ha(e,this.Jo(n?4:3,t))},Ga);function Ga(t,e,n){this.ii=t,this.ignoreUndefinedProperties=e,this.serializer=n||Ms.nt().Yo(t)}function za(t,e,n,i,r,o){this.settings=t,this.ii=e,this.serializer=n,this.ignoreUndefinedProperties=i,void 0===r&&this.Wo(),this.fieldTransforms=r||[],this.Vt=o||[]}function Ha(s,t){if(Qa(s))return Xa("Unsupported field value:",t,s),Wa(s,t);if(s instanceof ga)return function(t,e){if(!ja(e.No))throw e.$o(t.Do+"() can only be used with update() and set()");if(!e.path)throw e.$o(t.Do+"() is not currently supported inside arrays");var n=t.Fo(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Vt.push(t.path),s instanceof Array){if(t.settings.Oo&&4!==t.No)throw t.$o("Nested arrays are not supported");return function(t){for(var e=[],n=0,i=0,r=s;i<r.length;i++){var o=Ha(r[i],t.zo(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return e.serializer.ai(t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ki.fromDate(t);return{timestampValue:e.serializer.D(n)}}if(t instanceof ki){var i=new ki(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:e.serializer.D(i)}}if(t instanceof Na)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof oa)return{bytesValue:e.serializer.ui(t)};if(t instanceof Ra){var r=e.ii,o=t.xo;if(!o.isEqual(r))throw e.$o("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+r.projectId+"/"+r.database);return{referenceValue:e.serializer.li(t.Bo.path,t.xo)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.$o("Unsupported field value: "+Xu(t))}(s,t)}function Wa(t,i){var r={};return Ji(t)?i.path&&0<i.path.length&&i.Vt.push(i.path):$i(t,function(t,e){var n=Ha(e,i.Go(t));null!=n&&(r[t]=n)}),{mapValue:{fields:r}}}function Qa(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ki||t instanceof Na||t instanceof oa||t instanceof Ra||t instanceof ga)}function Xa(t,e,n){if(!Qa(n)||!Qu(n)){var i=Xu(n);throw"an object"===i?e.$o(t+" a custom object"):e.$o(t+" "+i)}}function Ya(t,e){if(e instanceof ia)return e.vo;if("string"==typeof e)return Ka(t,e);throw new _i(Ni.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function Ka(t,e){try{return function(e){if(0<=e.search(va))throw new _i(Ni.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(sa.bind.apply(sa,y([void 0],e.split("."))))}catch(t){throw new _i(Ni.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).vo}catch(e){var n=e instanceof Error?e.message:e.toString();throw new _i(Ni.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function $a(t,e){return t.some(function(t){return t.isEqual(e)})}function Ja(t){this.key=t}function Za(t){this.key=t}function th(t,e,n){this.query=t,this.targetId=e,this.view=n}function eh(t){this.key=t,this.Cc=!1}function nh(){this.al=void 0,this.ul=[]}var ih,rh,oh,sh,uh=(jh.prototype.oa=function(){return 1===this.state||2===this.state||4===this.state},jh.prototype.aa=function(){return 2===this.state},jh.prototype.start=function(){3!==this.state?this.auth():this.ua()},jh.prototype.stop=function(){return l(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return this.oa()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},jh.prototype.ca=function(){this.state=0,this.kr.reset()},jh.prototype.la=function(){var t=this;this.aa()&&null===this.ha&&(this.ha=this.sr.dr(this.sa,6e4,function(){return t._a()}))},jh.prototype.fa=function(t){this.da(),this.stream.send(t)},jh.prototype._a=function(){return l(this,void 0,void 0,function(){return d(this,function(t){return this.aa()?[2,this.close(0)]:[2]})})},jh.prototype.da=function(){this.ha&&(this.ha.cancel(),this.ha=null)},jh.prototype.close=function(e,n){return l(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return this.da(),this.kr.cancel(),this.ra++,3!==e?this.kr.reset():n&&n.code===Ni.RESOURCE_EXHAUSTED?(Fs(n.toString()),Fs("Using maximum backoff delay to prevent overloading the backend."),this.kr.cr()):n&&n.code===Ni.UNAUTHENTICATED&&this.na.l(),null!==this.stream&&(this.wa(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Ta(n)];case 1:return t.sent(),[2]}})})},jh.prototype.wa=function(){},jh.prototype.auth=function(){var n=this;this.state=1;var t=this.Ea(this.ra),e=this.ra;this.na.getToken().then(function(t){n.ra===e&&n.Ia(t)},function(e){t(function(){var t=new _i(Ni.UNKNOWN,"Fetching auth token failed: "+e.message);return n.ma(t)})})},jh.prototype.Ia=function(t){var e=this,n=this.Ea(this.ra);this.stream=this.Ra(t),this.stream.Aa(function(){n(function(){return e.state=2,e.listener.Aa()})}),this.stream.Ta(function(t){n(function(){return e.ma(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},jh.prototype.ua=function(){var t=this;this.state=4,this.kr.lr(function(){return l(t,void 0,void 0,function(){return d(this,function(t){return this.state=0,this.start(),[2]})})})},jh.prototype.ma=function(t){return js("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},jh.prototype.Ea=function(e){var n=this;return function(t){n.sr.Sr(function(){return n.ra===e?t():(js("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},jh),ah=(n(xh,oh=uh),xh.prototype.Ra=function(t){return this.ia.Pa("Listen",t)},xh.prototype.onMessage=function(t){this.kr.reset();var e=this.serializer.yi(t),n=this.serializer.bi(t);return this.listener.Va(e,n)},xh.prototype.pa=function(t){var e={};e.database=this.serializer.Ii,e.addTarget=this.serializer.ee(t);var n=this.serializer.Ki(t);n&&(e.labels=n),this.fa(e)},xh.prototype.ya=function(t){var e={};e.database=this.serializer.Ii,e.removeTarget=t,this.fa(e)},xh),hh=(n(qh,rh=uh),Object.defineProperty(qh.prototype,"ba",{get:function(){return this.ga},enumerable:!0,configurable:!0}),qh.prototype.start=function(){this.ga=!1,this.lastStreamToken=Zi.ht,rh.prototype.start.call(this)},qh.prototype.wa=function(){this.ga&&this.va([])},qh.prototype.Ra=function(t){return this.ia.Pa("Write",t)},qh.prototype.onMessage=function(t){if(zs(!!t.streamToken),this.lastStreamToken=this.serializer.ci(t.streamToken),this.ga){this.kr.reset();var e=this.serializer.ki(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.Sa(n,e)}return zs(!t.writeResults||0===t.writeResults.length),this.ga=!0,this.listener.Ca()},qh.prototype.Da=function(){var t={};t.database=this.serializer.Ii,this.fa(t)},qh.prototype.va=function(t){var e=this,n={streamToken:this.serializer.ui(this.lastStreamToken),writes:t.map(function(t){return e.serializer.vi(t)})};this.fa(n)},qh),ch=(n(Ch,ih=function(){this.Fa=void 0}),Ch.prototype.$a=function(){if(this.Na)throw new _i(Ni.FAILED_PRECONDITION,"The client has already been terminated.")},Ch.prototype.La=function(e,n){var i=this;return this.$a(),this.credentials.getToken().then(function(t){return i.ia.La(e,n,t)}).catch(function(t){throw t.code===Ni.UNAUTHENTICATED&&i.credentials.l(),t})},Ch.prototype.Oa=function(e,n){var i=this;return this.$a(),this.credentials.getToken().then(function(t){return i.ia.Oa(e,n,t)}).catch(function(t){throw t.code===Ni.UNAUTHENTICATED&&i.credentials.l(),t})},Ch),fh=(Mh.prototype.Ua=function(i){return l(this,void 0,void 0,function(){var e,n=this;return d(this,function(t){switch(t.label){case 0:if(this.Qa(),0<this.mutations.length)throw new _i(Ni.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return l(this,void 0,void 0,function(){var n,e,i,r,o;return d(this,function(t){switch(t.label){case 0:return e={database:(n=s).serializer.Ii,documents:u.map(function(t){return n.serializer.di(t)})},[4,n.Oa("BatchGetDocuments",e)];case 1:return i=t.sent(),r=new Map,i.forEach(function(t){var e=n.serializer.pi(t);r.set(e.key.toString(),e)}),o=[],[2,(u.forEach(function(t){var e=r.get(t.toString());zs(!!e),o.push(e)}),o)]}})})}(this.ka,i)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof bo||t instanceof wo?n.Wa(t):Gs()}),e)]}})})},Mh.prototype.set=function(t,e){this.write(e.Qo(t,this.Rt(t))),this.Ba.add(t)},Mh.prototype.update=function(t,e){try{this.write(e.Qo(t,this.ja(t)))}catch(t){this.xa=t}this.Ba.add(t)},Mh.prototype.delete=function(t){this.write([new Gr(t,this.Rt(t))]),this.Ba.add(t)},Mh.prototype.commit=function(){return l(this,void 0,void 0,function(){var e,i=this;return d(this,function(t){switch(t.label){case 0:if(this.Qa(),this.xa)throw this.xa;return e=this.qa,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=new Xi(Vi.G(e));i.mutations.push(new zr(n,i.Rt(n)))}),[4,function(i,r){return l(this,void 0,void 0,function(){var e,n;return d(this,function(t){switch(t.label){case 0:return n={database:(e=i).serializer.Ii,writes:r.map(function(t){return e.serializer.vi(t)})},[4,e.La("Commit",n)];case 1:return t.sent(),[2]}})})}(this.ka,this.mutations)];case 1:return t.sent(),this.Ma=!0,[2]}})})},Mh.prototype.Wa=function(t){var e;if(t instanceof wo)e=t.version;else{if(!(t instanceof bo))throw Gs();e=Li.min()}var n=this.qa.get(t.key.toString());if(n){if(!e.isEqual(n))throw new _i(Ni.ABORTED,"Document version changed between two reads.")}else this.qa.set(t.key.toString(),e)},Mh.prototype.Rt=function(t){var e=this.qa.get(t.toString());return!this.Ba.has(t)&&e?qr.updateTime(e):qr.dt()},Mh.prototype.ja=function(t){var e=this.qa.get(t.toString());if(this.Ba.has(t)||!e)return qr.exists(!0);if(e.isEqual(Li.min()))throw new _i(Ni.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return qr.updateTime(e)},Mh.prototype.write=function(t){this.Qa(),this.mutations=this.mutations.concat(t)},Mh.prototype.Qa=function(){},Mh),lh=(Uh.prototype.Ya=function(){var t=this;0===this.Ha&&(this.Xa("Unknown"),this.Ka=this.Pr.dr("online_state_timeout",1e4,function(){return t.Ka=null,t.Ja("Backend didn't respond within 10 seconds."),t.Xa("Offline"),Promise.resolve()}))},Uh.prototype.Za=function(t){"Online"===this.state?this.Xa("Unknown"):(this.Ha++,1<=this.Ha&&(this.tu(),this.Ja("Connection failed 1 times. Most recent error: "+t.toString()),this.Xa("Offline")))},Uh.prototype.set=function(t){this.tu(),this.Ha=0,"Online"===t&&(this.za=!1),this.Xa(t)},Uh.prototype.Xa=function(t){t!==this.state&&(this.state=t,this.Ga(t))},Uh.prototype.Ja=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.za?(Fs(e),this.za=!1):js("OnlineStateTracker",e)},Uh.prototype.tu=function(){null!==this.Ka&&(this.Ka.cancel(),this.Ka=null)},Uh),ph=(Vh.prototype.start=function(){return this.enableNetwork()},Vh.prototype.enableNetwork=function(){return this.networkEnabled=!0,this.mu()},Vh.prototype.mu=function(){return l(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return this.au()?(this.Ru()?this.Au():this.cu.set("Unknown"),[4,this.Pu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Vh.prototype.disableNetwork=function(){return l(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.Vu()];case 1:return t.sent(),this.cu.set("Offline"),[2]}})})},Vh.prototype.Vu=function(){return l(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return[4,this.wu.stop()];case 1:return t.sent(),[4,this.lu.stop()];case 2:return t.sent(),0<this.su.length&&(js("RemoteStore","Stopping write stream with "+this.su.length+" pending writes"),this.su=[]),this.pu(),[2]}})})},Vh.prototype.yu=function(){return l(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return js("RemoteStore","RemoteStore shutting down."),this.networkEnabled=!1,[4,this.Vu()];case 1:return t.sent(),this.hu.yu(),this.cu.set("Unknown"),[2]}})})},Vh.prototype.listen=function(t){this.iu.has(t.targetId)||(this.iu.set(t.targetId,t),this.Ru()?this.Au():this.lu.aa()&&this.gu(t))},Vh.prototype.bu=function(t){this.iu.delete(t),this.lu.aa()&&this.vu(t),0===this.iu.size&&(this.lu.aa()?this.lu.la():this.au()&&this.cu.set("Unknown"))},Vh.prototype.si=function(t){return this.iu.get(t)||null},Vh.prototype.ei=function(t){return this.Su.ei(t)},Vh.prototype.gu=function(t){this.nu.Ns(t.targetId),this.lu.pa(t)},Vh.prototype.vu=function(t){this.nu.Ns(t),this.lu.ya(t)},Vh.prototype.Au=function(){this.nu=new Es(this),this.lu.start(),this.cu.Ya()},Vh.prototype.Ru=function(){return this.au()&&!this.lu.oa()&&0<this.iu.size},Vh.prototype.au=function(){return!this.ru&&this.isPrimary&&this.networkEnabled},Vh.prototype.pu=function(){this.nu=null},Vh.prototype._u=function(){return l(this,void 0,void 0,function(){var n=this;return d(this,function(t){return this.iu.forEach(function(t,e){n.gu(t)}),[2]})})},Vh.prototype.fu=function(e){return l(this,void 0,void 0,function(){return d(this,function(t){return this.pu(),this.Ru()?(this.cu.Za(e),this.Au()):this.cu.set("Unknown"),[2]})})},Vh.prototype.du=function(r,o){return l(this,void 0,void 0,function(){var e,n,i;return d(this,function(t){switch(t.label){case 0:if(this.cu.set("Online"),!(r instanceof ds&&2===r.state&&r.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.Cu(r)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),js("RemoteStore","Failed to remove targets %s: %s ",r.targetIds.join(","),e),[4,this.Du(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(r instanceof ls?this.nu.Bs(r):r instanceof ps?this.nu.zs(r):this.nu.Ws(r),o.isEqual(Li.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,this.eu.qh()];case 8:return n=t.sent(),0<=o.S(n)?[4,this.Fu(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return js("RemoteStore","Failed to raise snapshot:",i=t.sent()),[4,this.Du(i)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},Vh.prototype.Du=function(n,i){return l(this,void 0,void 0,function(){var e=this;return d(this,function(t){switch(t.label){case 0:if(!Eu(n))throw n;return this.ru=!0,[4,this.Vu()];case 1:return t.sent(),this.cu.set("Offline"),i=i||function(){return e.eu.qh()},this.Pr.jr(function(){return l(e,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return js("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),this.ru=!1,[4,this.mu()];case 2:return t.sent(),[2]}})})}),[2]}})})},Vh.prototype.Nu=function(e){var n=this;return e().catch(function(t){return n.Du(t,e)})},Vh.prototype.Fu=function(i){var r=this,t=this.nu.Js(i);return t.as.forEach(function(t,e){var n;0<t.resumeToken.rt()&&((n=r.iu.get(e))&&r.iu.set(e,n.Ie(t.resumeToken,i)))}),t.us.forEach(function(t){var e,n=r.iu.get(t);n&&(r.iu.set(t,n.Ie(Zi.ht,n.Te)),r.vu(t),e=new Lo(n.target,t,1,n.sequenceNumber),r.gu(e))}),this.Su.Mh(t)},Vh.prototype.Cu=function(o){return l(this,void 0,void 0,function(){var e,n,i,r;return d(this,function(t){switch(t.label){case 0:e=o.cause,n=0,i=o.targetIds,t.label=1;case 1:return n<i.length?(r=i[n],this.iu.has(r)?[4,this.Su.$u(r,e)]:[3,3]):[3,5];case 2:t.sent(),this.iu.delete(r),this.nu.removeTarget(r),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},Vh.prototype.Pu=function(){return l(this,void 0,void 0,function(){var e,n,i;return d(this,function(t){switch(t.label){case 0:e=0<this.su.length?this.su[this.su.length-1].batchId:-1,t.label=1;case 1:if(!this.Lu())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,this.eu.to(e)];case 3:return null===(n=t.sent())?(0===this.su.length&&this.wu.la(),[3,7]):(e=n.batchId,this.Ou(n),[3,6]);case 4:return i=t.sent(),[4,this.Du(i)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.ku()&&this.qu(),[2]}})})},Vh.prototype.Lu=function(){return this.au()&&this.su.length<10},Vh.prototype.Mu=function(){return this.su.length},Vh.prototype.Ou=function(t){this.su.push(t),this.wu.aa()&&this.wu.ba&&this.wu.va(t.mutations)},Vh.prototype.ku=function(){return this.au()&&!this.wu.oa()&&0<this.su.length},Vh.prototype.qu=function(){this.wu.start()},Vh.prototype.Tu=function(){return l(this,void 0,void 0,function(){return d(this,function(t){return this.wu.Da(),[2]})})},Vh.prototype.Iu=function(){return l(this,void 0,void 0,function(){var e,n,i;return d(this,function(t){for(e=0,n=this.su;e<n.length;e++)i=n[e],this.wu.va(i.mutations);return[2]})})},Vh.prototype.Sa=function(r,o){return l(this,void 0,void 0,function(){var e,n,i=this;return d(this,function(t){switch(t.label){case 0:return e=this.su.shift(),n=Zs.from(e,r,o),[4,this.Nu(function(){return i.Su.xu(n)})];case 1:return t.sent(),[4,this.Pu()];case 2:return t.sent(),[2]}})})},Vh.prototype.Eu=function(e){return l(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return e&&this.wu.ba?[4,this.Bu(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.ku()&&this.qu(),[2]}})})},Vh.prototype.Bu=function(r){return l(this,void 0,void 0,function(){var e,n,i=this;return d(this,function(t){switch(t.label){case 0:return Qo(n=r.code)&&n!==Ni.ABORTED?(e=this.su.shift(),this.wu.ca(),[4,this.Nu(function(){return i.Su.Uu(e.batchId,r)})]):[3,3];case 1:return t.sent(),[4,this.Pu()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Vh.prototype.Qu=function(){return new fh(this.ka)},Vh.prototype.uu=function(){return l(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.Vu()];case 1:return t.sent(),this.cu.set("Unknown"),[4,this.enableNetwork()];case 2:return t.sent(),[2]}})})},Vh.prototype.Wu=function(){return l(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return this.au()?(js("RemoteStore","RemoteStore restarting streams for new credential"),[4,this.uu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Vh.prototype.ju=function(e){return l(this,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return(this.isPrimary=e)&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:[4,this.Vu()];case 3:t.sent(),this.cu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},Vh),dh=(Ph.prototype.Gu=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Ph.prototype.Hu=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Ph.prototype.Ku=function(){var t={activeTargetIds:this.activeTargetIds.W(),updateTimeMs:Date.now()};return JSON.stringify(t)},Ph),yh=(Lh.prototype.Xu=function(t){},Lh.prototype.Ju=function(t,e,n){},Lh.prototype.Zu=function(t){return this.zu.Gu(t),this.Yu[t]||"not-current"},Lh.prototype.tc=function(t,e,n){this.Yu[t]=e},Lh.prototype.ec=function(t){this.zu.Hu(t)},Lh.prototype.sc=function(t){return this.zu.activeTargetIds.has(t)},Lh.prototype.ic=function(t){delete this.Yu[t]},Lh.prototype.nc=function(){return this.zu.activeTargetIds},Lh.prototype.rc=function(t){return this.zu.activeTargetIds.has(t)},Lh.prototype.start=function(){return this.zu=new dh,Promise.resolve()},Lh.prototype.Ah=function(t,e,n){},Lh.prototype.hc=function(t){},Lh.prototype.yu=function(){},Lh.prototype.tr=function(t){},Lh),vh=(Object.defineProperty(kh.prototype,"lc",{get:function(){return this.oc},enumerable:!0,configurable:!0}),kh.prototype._c=function(t,e){var u=this,a=e?e.fc:new vs,h=e?e.cc:this.cc,c=e?e.ns:this.ns,f=h,l=!1,p=this.query.oe()&&h.size===this.query.limit?h.last():null,d=this.query.ae()&&h.size===this.query.limit?h.first():null;if(t.ye(function(t,e){var n=h.get(t),i=(i=e instanceof wo?e:null)&&(u.query.matches(i)?i:null),r=!!n&&u.ns.has(n.key),o=!!i&&(i.At||u.ns.has(i.key)&&i.hasCommittedMutations),s=!1;n&&i?n.data().isEqual(i.data())?r!==o&&(a.track({type:3,doc:i}),s=!0):u.dc(n,i)||(a.track({type:2,doc:i}),s=!0,(p&&0<u.query.se(i,p)||d&&u.query.se(i,d)<0)&&(l=!0)):!n&&i?(a.track({type:0,doc:i}),s=!0):n&&!i&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(l=!0)),s&&(c=i?(f=f.add(i),o?c.add(t):c.delete(t)):(f=f.delete(t),c.delete(t)))}),this.query.oe()||this.query.ae())for(;f.size>this.query.limit;){var n=this.query.oe()?f.last():f.first(),f=f.delete(n.key),c=c.delete(n.key);a.track({type:1,doc:n})}return{cc:f,fc:a,wc:l,ns:c}},kh.prototype.dc=function(t,e){return t.At&&e.hasCommittedMutations&&!e.At},kh.prototype.Tc=function(t,e,n){var o=this,i=this.cc;this.cc=t.cc,this.ns=t.ns;var r=t.fc.es();r.sort(function(t,e){return i=t.type,r=e.type,n(i)-n(r)||o.query.se(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Gs()}}var i,r}),this.Ec(n);var s=e?this.Ic():[],u=0===this.uc.size&&this.ds?1:0,a=u!==this.ac;return this.ac=u,0!==r.length||a?{snapshot:new gs(this.query,t.cc,i,r,t.ns,0==u,a,!1),mc:s}:{mc:s}},kh.prototype.Rc=function(t){return this.ds&&"Offline"===t?(this.ds=!1,this.Tc({cc:this.cc,fc:new vs,ns:this.ns,wc:!1},!1)):{mc:[]}},kh.prototype.Ac=function(t){return!this.oc.has(t)&&!!this.cc.has(t)&&!this.cc.get(t).At},kh.prototype.Ec=function(t){var e=this;t&&(t.ws.forEach(function(t){return e.oc=e.oc.add(t)}),t.Ts.forEach(function(t){}),t.Es.forEach(function(t){return e.oc=e.oc.delete(t)}),this.ds=t.ds)},kh.prototype.Ic=function(){var e=this;if(!this.ds)return[];var n=this.uc;this.uc=cs(),this.cc.forEach(function(t){e.Ac(t.key)&&(e.uc=e.uc.add(t.key))});var i=[];return n.forEach(function(t){e.uc.has(t)||i.push(new Za(t))}),this.uc.forEach(function(t){n.has(t)||i.push(new Ja(t))}),i},kh.prototype.Pc=function(t){this.oc=t.co,this.uc=cs();var e=this._c(t.documents);return this.Tc(e,!0)},kh.prototype.Vc=function(){return gs.os(this.query,this.cc,this.ns,0===this.ac)},kh),gh=(Oh.prototype.yc=function(){this.gc()},Oh.prototype.gc=function(){var t=this;this.kr.lr(function(){return l(t,void 0,void 0,function(){var e,n,i=this;return d(this,function(t){return e=new fh(this.ka),(n=this.bc(e))&&n.then(function(t){i.Pr.Sr(function(){return e.commit().then(function(){i.yr.resolve(t)}).catch(function(t){i.vc(t)})})}).catch(function(t){i.vc(t)}),[2]})})})},Oh.prototype.bc=function(t){try{var e=this.updateFunction(t);return!er(e)&&e.catch&&e.then?e:(this.yr.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.yr.reject(t),null}},Oh.prototype.vc=function(t){var e=this;0<this.pc&&this.Sc(t)?(--this.pc,this.Pr.Sr(function(){return e.gc(),Promise.resolve()})):this.yr.reject(t)},Oh.prototype.Sc=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Qo(e)},Oh),mh=(Object.defineProperty(Sh.prototype,"Wc",{get:function(){return!0},enumerable:!0,configurable:!0}),Sh.prototype.subscribe=function(t){this.$c=t},Sh.prototype.listen=function(s){return l(this,void 0,void 0,function(){var e,n,i,r,o;return d(this,function(t){switch(t.label){case 0:return this.jc("listen()"),(i=this.Lc.get(s))?(e=i.targetId,this.Fc.Zu(e),n=i.view.Vc(),[3,4]):[3,1];case 1:return[4,this.eu.io(s.ee())];case 2:return r=t.sent(),o=this.Fc.Zu(r.targetId),e=r.targetId,[4,this.Gc(s,e,"current"===o)];case 3:n=t.sent(),this.Wc&&this.Dc.listen(r),t.label=4;case 4:return[2,n]}})})},Sh.prototype.Gc=function(u,a,h){return l(this,void 0,void 0,function(){var e,n,i,r,o,s;return d(this,function(t){switch(t.label){case 0:return[4,this.eu.ao(u,!0)];case 1:return e=t.sent(),n=new vh(u,e.co),i=n._c(e.documents),r=ws.fs(a,h&&"Offline"!==this.onlineState),o=n.Tc(i,this.Wc,r),this.Hc(a,o.mc),s=new th(u,a,n),[2,(this.Lc.set(u,s),this.Oc.has(a)?this.Oc.get(a).push(u):this.Oc.set(a,[u]),o.snapshot)]}})})},Sh.prototype.bu=function(r){return l(this,void 0,void 0,function(){var e,n,i=this;return d(this,function(t){switch(t.label){case 0:return this.jc("unlisten()"),e=this.Lc.get(r),1<(n=this.Oc.get(e.targetId)).length?[2,(this.Oc.set(e.targetId,n.filter(function(t){return!t.isEqual(r)})),void this.Lc.delete(r))]:this.Wc?(this.Fc.ec(e.targetId),this.Fc.rc(e.targetId)?[3,2]:[4,this.eu.oo(e.targetId,!1).then(function(){i.Fc.ic(e.targetId),i.Dc.bu(e.targetId),i.Kc(e.targetId)}).catch(ku)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.Kc(e.targetId),[4,this.eu.oo(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},Sh.prototype.write=function(r,o){return l(this,void 0,void 0,function(){var e,n,i;return d(this,function(t){switch(t.label){case 0:this.jc("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,this.eu.gh(r)];case 2:return e=t.sent(),this.Fc.Xu(e.batchId),this.zc(e.batchId,o),[4,this.Yc(e.vh)];case 3:return t.sent(),[4,this.Dc.Pu()];case 4:return t.sent(),[3,6];case 5:return n=t.sent(),i=_u(n,"Failed to persist write"),o.reject(i),[3,6];case 6:return[2]}})})},Sh.prototype.runTransaction=function(t,e,n){new gh(t,this.ka,e,n).yc()},Sh.prototype.Mh=function(n){return l(this,void 0,void 0,function(){var e,i=this;return d(this,function(t){switch(t.label){case 0:this.jc("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.eu.Mh(n)];case 2:return e=t.sent(),n.as.forEach(function(t,e){var n=i.Mc.get(e);n&&(zs(t.ws.size+t.Ts.size+t.Es.size<=1),0<t.ws.size?n.Cc=!0:0<t.Ts.size?zs(n.Cc):0<t.Es.size&&(zs(n.Cc),n.Cc=!1))}),[4,this.Yc(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,ku(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Sh.prototype.Rc=function(i,t){this.jc("applyOnlineStateChange()");var r=[];this.Lc.forEach(function(t,e){var n=e.view.Rc(i);n.snapshot&&r.push(n.snapshot)}),this.$c.Xc(i),this.$c.Va(r),this.onlineState=i},Sh.prototype.$u=function(u,a){return l(this,void 0,void 0,function(){var e,n,i,r,o,s=this;return d(this,function(t){switch(t.label){case 0:return this.jc("rejectListens()"),this.Fc.tc(u,"rejected",a),e=this.Mc.get(u),(n=e&&e.key)?(i=(i=new Yo(Xi.N)).Re(n,new bo(n,Li.min())),r=cs().add(n),o=new ms(Li.min(),new Map,new ns(Qs),i,r),[4,this.Mh(o)]):[3,2];case 1:return t.sent(),this.qc=this.qc.remove(n),this.Mc.delete(u),this.Jc(),[3,4];case 2:return[4,this.eu.oo(u,!1).then(function(){return s.Kc(u,a)}).catch(ku)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},Sh.prototype.xu=function(i){return l(this,void 0,void 0,function(){var e,n;return d(this,function(t){switch(t.label){case 0:this.jc("applySuccessfulWrite()"),e=i.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.eu.Sh(i)];case 2:return n=t.sent(),this.Zc(e,null),this.tl(e),this.Fc.Ju(e,"acknowledged"),[4,this.Yc(n)];case 3:return t.sent(),[3,6];case 4:return[4,ku(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Sh.prototype.Uu=function(n,i){return l(this,void 0,void 0,function(){var e;return d(this,function(t){switch(t.label){case 0:this.jc("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.eu.$h(n)];case 2:return e=t.sent(),this.Zc(n,i),this.tl(n),this.Fc.Ju(n,"rejected",i),[4,this.Yc(e)];case 3:return t.sent(),[3,6];case 4:return[4,ku(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Sh.prototype.el=function(o){return l(this,void 0,void 0,function(){var e,n,i,r;return d(this,function(t){switch(t.label){case 0:this.Dc.au()||js("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.eu.kh()];case 2:return-1===(e=t.sent())?[2,void o.resolve()]:((n=this.Uc.get(e)||[]).push(o),this.Uc.set(e,n),[3,4]);case 3:return i=t.sent(),r=_u(i,"Initialization of waitForPendingWrites() operation failed"),o.reject(r),[3,4];case 4:return[2]}})})},Sh.prototype.tl=function(t){(this.Uc.get(t)||[]).forEach(function(t){t.resolve()}),this.Uc.delete(t)},Sh.prototype.sl=function(e){this.Uc.forEach(function(t){t.forEach(function(t){t.reject(new _i(Ni.CANCELLED,e))})}),this.Uc.clear()},Sh.prototype.zc=function(t,e){var n=(n=(n=this.Bc[this.currentUser.s()])||new Yo(Qs)).Re(t,e);this.Bc[this.currentUser.s()]=n},Sh.prototype.Zc=function(t,e){var n,i=this.Bc[this.currentUser.s()];i&&((n=i.get(t))&&(e?n.reject(e):n.resolve(),i=i.remove(t)),this.Bc[this.currentUser.s()]=i)},Sh.prototype.Kc=function(t,e){var n=this;void 0===e&&(e=null),this.Fc.ec(t);for(var i=0,r=this.Oc.get(t);i<r.length;i++){var o=r[i];this.Lc.delete(o),e&&this.$c.il(o,e)}this.Oc.delete(t),this.Wc&&this.xc.Ro(t).forEach(function(t){n.xc.Vo(t)||n.nl(t)})},Sh.prototype.nl=function(t){var e=this.qc.get(t);null!==e&&(this.Dc.bu(e),this.qc=this.qc.remove(t),this.Mc.delete(e),this.Jc())},Sh.prototype.Hc=function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n];r instanceof Ja?(this.xc.Jh(r.key,t),this.rl(r)):r instanceof Za?(js("SyncEngine","Document no longer in limbo: "+r.key),this.xc.Zh(r.key,t),this.xc.Vo(r.key)||this.nl(r.key)):Gs()}},Sh.prototype.rl=function(t){var e=t.key;this.qc.get(e)||(js("SyncEngine","New document in limbo: "+e),this.kc.push(e),this.Jc())},Sh.prototype.Jc=function(){for(;0<this.kc.length&&this.qc.size<this.Nc;){var t=this.kc.shift(),e=this.Qc.next();this.Mc.set(e,new eh(t)),this.qc=this.qc.Re(t,e),this.Dc.listen(new Lo(To.Wt(t.path).ee(),e,2,iu.er))}},Sh.prototype.hl=function(){return this.qc},Sh.prototype.ol=function(){return this.kc},Sh.prototype.Yc=function(i,a){return l(this,void 0,void 0,function(){var o,s,e,u=this;return d(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.Lc.forEach(function(t,r){e.push(Promise.resolve().then(function(){var n=r.view._c(i);return n.wc?u.eu.ao(r.query,!1).then(function(t){var e=t.documents;return r.view._c(e,n)}):n}).then(function(t){var e,n=a&&a.as.get(r.targetId),i=r.view.Tc(t,u.Wc,n);u.Hc(r.targetId,i.mc),i.snapshot&&(u.Wc&&u.Fc.tc(r.targetId,i.snapshot.fromCache?"not-current":"current"),o.push(i.snapshot),e=nu.Yn(r.targetId,i.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.$c.Va(o),[4,this.eu.Xh(s)];case 2:return t.sent(),[2]}})})},Sh.prototype.jc=function(t){},Sh.prototype.Wu=function(n){return l(this,void 0,void 0,function(){var e;return d(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:[4,this.eu.Ah(n)];case 1:return e=t.sent(),this.currentUser=n,this.sl("'waitForPendingWrites' promise is rejected due to a user change."),this.Fc.Ah(n,e.ph,e.yh),[4,this.Yc(e.Vh)];case 2:t.sent(),t.label=3;case 3:return[4,this.Dc.Wu()];case 4:return t.sent(),[2]}})})},Sh.prototype.enableNetwork=function(){return this.Dc.enableNetwork()},Sh.prototype.disableNetwork=function(){return this.Dc.disableNetwork()},Sh.prototype.ei=function(t){var e=this.Mc.get(t);if(e&&e.Cc)return cs().add(e.key);var n=cs(),i=this.Oc.get(t);if(!i)return n;for(var r=0,o=i;r<o.length;r++)var s=o[r],u=this.Lc.get(s),n=n.ze(u.view.lc);return n},Sh),wh=(Dh.prototype.listen=function(u){return l(this,void 0,void 0,function(){var e,n,i,r,o,s;return d(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(i=this.cl.get(e))||(n=!0,i=new nh),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),r=i,[4,this.Su.listen(e)];case 2:return r.al=t.sent(),[3,4];case 3:return o=t.sent(),s=_u(o,"Initialization of query '"+u.query+"' failed"),[2,void u.onError(s)];case 4:return this.cl.set(e,i),i.ul.push(u),u.Rc(this.onlineState),i.al&&u._l(i.al)&&this.fl(),[2]}})})},Dh.prototype.bu=function(o){return l(this,void 0,void 0,function(){var e,n,i,r;return d(this,function(t){return e=o.query,n=!1,(i=this.cl.get(e))&&0<=(r=i.ul.indexOf(o))&&(i.ul.splice(r,1),n=0===i.ul.length),n?[2,(this.cl.delete(e),this.Su.bu(e))]:[2]})})},Dh.prototype.Va=function(t){for(var e=!1,n=0,i=t;n<i.length;n++){var r=i[n],o=r.query,s=this.cl.get(o);if(s){for(var u=0,a=s.ul;u<a.length;u++)a[u]._l(r)&&(e=!0);s.al=r}}e&&this.fl()},Dh.prototype.il=function(t,e){var n=this.cl.get(t);if(n)for(var i=0,r=n.ul;i<r.length;i++)r[i].onError(e);this.cl.delete(t)},Dh.prototype.Xc=function(r){this.onlineState=r;var o=!1;this.cl.forEach(function(t,e){for(var n=0,i=e.ul;n<i.length;n++)i[n].Rc(r)&&(o=!0)}),o&&this.fl()},Dh.prototype.dl=function(t){this.ll.add(t),t.next()},Dh.prototype.wl=function(t){this.ll.delete(t)},Dh.prototype.fl=function(){this.ll.forEach(function(t){t.next()})},Dh),bh=(Rh.prototype._l=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,i=t.docChanges;n<i.length;n++){var r=i[n];3!==r.type&&e.push(r)}t=new gs(t.query,t.docs,t.ss,e,t.ns,t.fromCache,t.rs,!0)}var o=!1;return this.El?this.ml(t)&&(this.Tl.next(t),o=!0):this.Rl(t,this.onlineState)&&(this.Al(t),o=!0),this.Il=t,o},Rh.prototype.onError=function(t){this.Tl.error(t)},Rh.prototype.Rc=function(t){this.onlineState=t;var e=!1;return this.Il&&!this.El&&this.Rl(this.Il,t)&&(this.Al(this.Il),e=!0),e},Rh.prototype.Rl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Pl&&n||t.docs.M()&&"Offline"!==e)},Rh.prototype.ml=function(t){if(0<t.docChanges.length)return!0;var e=this.Il&&this.Il.hasPendingWrites!==t.hasPendingWrites;return!(!t.rs&&!e)&&!0===this.options.includeMetadataChanges},Rh.prototype.Al=function(t){t=gs.os(t.query,t.docs,t.ns,t.fromCache),this.El=!0,this.Tl.next(t)},Rh),Eh=(_h.prototype.Rh=function(t){this.Vl=t},_h.prototype.Bn=function(e,i,r,o){var s=this;return i.te()||r.isEqual(Li.min())?this.pl(e,i):this.Vl.qn(e,o).next(function(t){var n=s.yl(i,t);return(i.oe()||i.ae())&&s.wc(i.xt,n,o,r)?s.pl(e,i):(xs()<=p.DEBUG&&js("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),i.toString()),s.Vl.Bn(e,i,r).next(function(e){return n.forEach(function(t){e=e.Re(t.key,t)}),e}))})},_h.prototype.yl=function(n,t){var i=new ns(function(t,e){return n.se(t,e)});return t.forEach(function(t,e){e instanceof wo&&n.matches(e)&&(i=i.add(e))}),i},_h.prototype.wc=function(t,e,n,i){if(n.size!==e.size)return!0;var r="F"===t?e.last():e.first();return!!r&&(r.hasPendingWrites||0<r.version.S(i))},_h.prototype.pl=function(t,e){return xs()<=p.DEBUG&&js("IndexFreeQueryEngine","Using full collection scan to execute query:",e.toString()),this.Vl.Bn(t,e,Li.min())},_h),Ih=(Nh.prototype.vl=function(t){return tu.resolve(0===this.Dn.length)},Nh.prototype.bh=function(t,e,n,i){var r=this.gl;this.gl++,0<this.Dn.length&&this.Dn[this.Dn.length-1];var o=new Js(r,e,n,i);this.Dn.push(o);for(var s=0,u=i;s<u.length;s++){var a=u[s];this.bl=this.bl.add(new Pu(a.key,r)),this.Fn.Ir(t,a.key.path.O())}return tu.resolve(o)},Nh.prototype.Lh=function(t,e){return tu.resolve(this.Sl(e))},Nh.prototype.eo=function(t,e){var n=e+1,i=this.Cl(n),r=i<0?0:i;return tu.resolve(this.Dn.length>r?this.Dn[r]:null)},Nh.prototype.kh=function(){return tu.resolve(0===this.Dn.length?-1:this.gl-1)},Nh.prototype.Ph=function(t){return tu.resolve(this.Dn.slice())},Nh.prototype.$n=function(t,e){var n=this,i=new Pu(e,0),r=new Pu(e,Number.POSITIVE_INFINITY),o=[];return this.bl.Ge([i,r],function(t){var e=n.Sl(t.po);o.push(e)}),tu.resolve(o)},Nh.prototype.xn=function(t,e){var i=this,r=new ns(Qs);return e.forEach(function(t){var e=new Pu(t,0),n=new Pu(t,Number.POSITIVE_INFINITY);i.bl.Ge([e,n],function(t){r=r.add(t.po)})}),tu.resolve(this.Dl(r))},Nh.prototype.Gn=function(t,e){var n=e.path,i=n.length+1,r=n;Xi.et(r)||(r=r.child(""));var o=new Pu(new Xi(r),0),s=new ns(Qs);return this.bl.He(function(t){var e=t.key.path;return!!n.B(e)&&(e.length===i&&(s=s.add(t.po)),!0)},o),tu.resolve(this.Dl(s))},Nh.prototype.Dl=function(t){var n=this,i=[];return t.forEach(function(t){var e=n.Sl(t);null!==e&&i.push(e)}),i},Nh.prototype.Oh=function(n,i){var r=this;zs(0===this.Fl(i.batchId,"removed")),this.Dn.shift();var o=this.bl;return tu.forEach(i.mutations,function(t){var e=new Pu(t.key,i.batchId);return o=o.delete(e),r.Kh.Nl(n,t.key)}).next(function(){r.bl=o})},Nh.prototype.$l=function(t){},Nh.prototype.Vo=function(t,e){var n=new Pu(e,0),i=this.bl.Ke(n);return tu.resolve(e.isEqual(i&&i.key))},Nh.prototype.Nh=function(t){return this.Dn.length,tu.resolve()},Nh.prototype.Fl=function(t,e){return this.Cl(t)},Nh.prototype.Cl=function(t){return 0===this.Dn.length?0:t-this.Dn[0].batchId},Nh.prototype.Sl=function(t){var e=this.Cl(t);return e<0||e>=this.Dn.length?null:this.Dn[e]},Nh),Th=(Ah.prototype.Gh=function(t,e,n){var i=e.key,r=this.docs.get(i),o=r?r.size:0,s=this.Ll(e);return this.docs=this.docs.Re(i,{Ol:e,size:s,readTime:n}),this.size+=s-o,this.Fn.Ir(t,i.path.O())},Ah.prototype.jh=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Ah.prototype.On=function(t,e){var n=this.docs.get(e);return tu.resolve(n?n.Ol:null)},Ah.prototype.getEntries=function(t,e){var n=this,i=rs;return e.forEach(function(t){var e=n.docs.get(t);i=i.Re(t,e?e.Ol:null)}),tu.resolve(i)},Ah.prototype.Bn=function(t,e,n){for(var i=us,r=new Xi(e.path.child("")),o=this.docs.ve(r);o.$e();){var s=o.Ne(),u=s.key,a=s.value,h=a.Ol,c=a.readTime;if(!e.path.B(u.path))break;c.S(n)<=0||h instanceof wo&&e.matches(h)&&(i=i.Re(h.key,h))}return tu.resolve(i)},Ah.prototype.kl=function(t,e){return tu.forEach(this.docs,function(t){return e(t)})},Ah.prototype.Ch=function(t){return new Ah.ql(this)},Ah.prototype.Ml=function(t){return tu.resolve(this.size)},Ah);function Ah(t,e){this.Fn=t,this.Ll=e,this.docs=new Yo(Xi.N),this.size=0}function Nh(t,e){this.Fn=t,this.Kh=e,this.Dn=[],this.gl=1,this.bl=new ns(Pu.do)}function _h(){}function Rh(t,e,n){this.query=t,this.Tl=e,this.El=!1,this.Il=null,this.onlineState="Unknown",this.options=n||{}}function Dh(t){this.Su=t,this.cl=new $s(function(t){return t.canonicalId()}),this.onlineState="Unknown",this.ll=new Set,this.Su.subscribe(this)}function Sh(t,e,n,i,r,o){this.eu=t,this.Dc=e,this.ka=n,this.Fc=i,this.currentUser=r,this.Nc=o,this.$c=null,this.Lc=new $s(function(t){return t.canonicalId()}),this.Oc=new Map,this.kc=[],this.qc=new Yo(Xi.N),this.Mc=new Map,this.xc=new Lu,this.Bc={},this.Uc=new Map,this.Qc=vu.Ar(),this.onlineState="Unknown"}function Oh(t,e,n,i){this.Pr=t,this.ka=e,this.updateFunction=n,this.yr=i,this.pc=5,this.kr=new pu(this.Pr,"transaction_retry")}function kh(t,e){this.query=t,this.oc=e,this.ac=null,this.ds=!1,this.uc=cs(),this.ns=cs(),this.cc=new ys(t.se.bind(t))}function Lh(){this.zu=new dh,this.Yu={},this.Su=null,this.Ga=null,this.Xn=null}function Ph(){this.activeTargetIds=fs}function Vh(t,e,n,i,r){var o,s,u,a,h,c,f=this;this.eu=t,this.ka=e,this.Pr=n,this.su=[],this.iu=new Map,this.nu=null,this.networkEnabled=!1,this.isPrimary=!1,this.ru=!1,this.hu=r,this.hu.ou(function(t){n.Sr(function(){return l(f,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return this.au()?(js("RemoteStore","Restarting streams for network reachability change."),[4,this.uu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.cu=new lh(n,i),this.lu=(a=this.ka,h=n,c={Aa:this._u.bind(this),Ta:this.fu.bind(this),Va:this.du.bind(this)},new ah(h,a.ia,a.credentials,a.serializer,c)),this.wu=(o=this.ka,s=n,u={Aa:this.Tu.bind(this),Ta:this.Eu.bind(this),Ca:this.Iu.bind(this),Sa:this.Sa.bind(this)},new hh(s,o.ia,o.credentials,o.serializer,u))}function Uh(t,e){this.Pr=t,this.Ga=e,this.state="Unknown",this.Ha=0,this.Ka=null,this.za=!0}function Mh(t){this.ka=t,this.qa=new Map,this.mutations=[],this.Ma=!1,this.xa=null,this.Ba=new Set}function Ch(t,e,n){var i=this;return(i=ih.call(this)||this).ia=t,i.credentials=e,i.serializer=n,i.Na=!1,i}function qh(t,e,n,i,r){var o=this;return(o=rh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,r)||this).serializer=i,o.ga=!1,o.lastStreamToken=Zi.ht,o}function xh(t,e,n,i,r){var o=this;return(o=oh.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,r)||this).serializer=i,o}function jh(t,e,n,i,r,o){this.sr=t,this.sa=n,this.ia=i,this.na=r,this.listener=o,this.state=0,this.ra=0,this.ha=null,this.stream=null,this.kr=new pu(t,e)}function Fh(t){var e=this;return(e=sh.call(this)||this).jl=t,e}function Bh(){this.vh=new $s(function(t){return t.toString()}),this.xl=!1}Th.ql=(Object.defineProperty(Bh.prototype,"readTime",{get:function(){return this.Bl},set:function(t){this.Bl=t},enumerable:!0,configurable:!0}),Bh.prototype.Gh=function(t,e){this.Ul(),this.readTime=e,this.vh.set(t.key,t)},Bh.prototype.jh=function(t,e){this.Ul(),e&&(this.readTime=e),this.vh.set(t,null)},Bh.prototype.On=function(t,e){this.Ul();var n=this.vh.get(e);return void 0!==n?tu.resolve(n):this.Ql(t,e)},Bh.prototype.getEntries=function(t,e){return this.Wl(t,e)},Bh.prototype.apply=function(t){return this.Ul(),this.xl=!0,this.Tc(t)},Bh.prototype.Ul=function(){},n(Fh,sh=Bh),Fh.prototype.Tc=function(n){var i=this,r=[];return this.vh.forEach(function(t,e){e?r.push(i.jl.Gh(n,e,i.readTime)):i.jl.jh(t)}),tu.vn(r)},Fh.prototype.Ql=function(t,e){return this.jl.On(t,e)},Fh.prototype.Wl=function(t,e){return this.jl.getEntries(t,e)},Fh);var Gh,zh=(oc.prototype.js=function(t,n){return this.Gl.forEach(function(t,e){return n(e)}),tu.resolve()},oc.prototype.qh=function(t){return tu.resolve(this.lastRemoteSnapshotVersion)},oc.prototype.Yl=function(t){return tu.resolve(this.Hl)},oc.prototype.ro=function(t){return this.highestTargetId=this.zl.next(),tu.resolve(this.highestTargetId)},oc.prototype.zh=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Hl&&(this.Hl=e),tu.resolve()},oc.prototype.Xl=function(t){this.Gl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.zl=new vu(e),this.highestTargetId=e),t.sequenceNumber>this.Hl&&(this.Hl=t.sequenceNumber)},oc.prototype.ho=function(t,e){return this.Xl(e),this.targetCount+=1,tu.resolve()},oc.prototype.Wh=function(t,e){return this.Xl(e),tu.resolve()},oc.prototype.Jl=function(t,e){return this.Gl.delete(e.target),this.Kl.Ro(e.targetId),--this.targetCount,tu.resolve()},oc.prototype.Zl=function(n,i,r){var o=this,s=0,u=[];return this.Gl.forEach(function(t,e){e.sequenceNumber<=i&&null===r.get(e.targetId)&&(o.Gl.delete(t),u.push(o.t_(n,e.targetId)),s++)}),tu.vn(u).next(function(){return s})},oc.prototype.e_=function(t){return tu.resolve(this.targetCount)},oc.prototype.no=function(t,e){var n=this.Gl.get(e)||null;return tu.resolve(n)},oc.prototype.Bh=function(t,e,n){return this.Kl.Eo(e,n),tu.resolve()},oc.prototype.xh=function(e,t,n){this.Kl.mo(t,n);var i=this.persistence.Kh,r=[];return i&&t.forEach(function(t){r.push(i.Nl(e,t))}),tu.vn(r)},oc.prototype.t_=function(t,e){return this.Kl.Ro(e),tu.resolve()},oc.prototype.uo=function(t,e){var n=this.Kl.Po(e);return tu.resolve(n)},oc.prototype.Vo=function(t,e){return tu.resolve(this.Kl.Vo(e))},oc),Hh=(rc.prototype.start=function(){return Promise.resolve()},rc.prototype.yu=function(){return this.n_=!1,Promise.resolve()},Object.defineProperty(rc.prototype,"h_",{get:function(){return this.n_},enumerable:!0,configurable:!0}),rc.prototype.o_=function(){},rc.prototype.mh=function(){return this.Fn},rc.prototype.fh=function(t){var e=this.s_[t.s()];return e||(e=new Ih(this.Fn,this.Kh),this.s_[t.s()]=e),e},rc.prototype.Eh=function(){return this.Th},rc.prototype.wh=function(){return this.Cn},rc.prototype.runTransaction=function(t,e,n){var i=this;js("MemoryPersistence","Starting transaction:",t);var r=new Wh(this.i_.next());return this.Kh.a_(),n(r).next(function(t){return i.Kh.u_(r).next(function(){return t})}).gn().then(function(t){return r.c_(),t})},rc.prototype.l_=function(e,n){return tu.Sn(Object.values(this.s_).map(function(t){return function(){return t.Vo(e,n)}}))},rc),Wh=(ic.prototype.f_=function(t){this.__.push(t)},ic.prototype.c_=function(){this.__.forEach(function(t){return t()})},n(nc,Gh=ic),nc),Qh=(ec.T_=function(t){return new ec(t)},Object.defineProperty(ec.prototype,"E_",{get:function(){if(this.w_)return this.w_;throw Gs()},enumerable:!0,configurable:!0}),ec.prototype.Jh=function(t,e,n){return this.d_.Jh(n,e),this.E_.delete(n),tu.resolve()},ec.prototype.Zh=function(t,e,n){return this.d_.Zh(n,e),this.E_.add(n),tu.resolve()},ec.prototype.Nl=function(t,e){return this.E_.add(e),tu.resolve()},ec.prototype.removeTarget=function(t,e){var n=this;this.d_.Ro(e.targetId).forEach(function(t){return n.E_.add(t)});var i=this.persistence.Eh();return i.uo(t,e.targetId).next(function(t){t.forEach(function(t){return n.E_.add(t)})}).next(function(){return i.Jl(t,e)})},ec.prototype.a_=function(){this.w_=new Set},ec.prototype.u_=function(t){var n=this,i=this.persistence.wh().Ch();return tu.forEach(this.E_,function(e){return n.I_(t,e).next(function(t){t||i.jh(e)})}).next(function(){return n.w_=null,i.apply(t)})},ec.prototype.Hh=function(t,e){var n=this;return this.I_(t,e).next(function(t){t?n.E_.delete(e):n.E_.add(e)})},ec.prototype.r_=function(t){return 0},ec.prototype.I_=function(t,e){var n=this;return tu.Sn([function(){return tu.resolve(n.d_.Vo(e))},function(){return n.persistence.Eh().Vo(t,e)},function(){return n.persistence.l_(t,e)}])},ec),Xh="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Yh=(tc.prototype.initialize=function(n){return l(this,void 0,void 0,function(){var e=this;return d(this,function(t){switch(t.label){case 0:return this.Fc=this.m_(n),this.persistence=this.R_(n),[4,this.persistence.start()];case 1:return t.sent(),this.A_=this.P_(n),this.eu=this.V_(n),this.Dc=this.p_(n),this.Su=this.y_(n),this.g_=this.b_(n),this.Fc.Ga=function(t){return e.Su.Rc(t,1)},this.Dc.Su=this.Su,[4,this.eu.start()];case 2:return t.sent(),[4,this.Fc.start()];case 3:return t.sent(),[4,this.Dc.start()];case 4:return t.sent(),[4,this.Dc.ju(this.Su.Wc)];case 5:return t.sent(),[2]}})})},tc.prototype.b_=function(t){return new wh(this.Su)},tc.prototype.P_=function(t){return null},tc.prototype.V_=function(t){return new Su(this.persistence,new Eh,t.v_)},tc.prototype.R_=function(t){if(t.C_.S_)throw new _i(Ni.FAILED_PRECONDITION,Xh);return new Hh(Qh.T_)},tc.prototype.p_=function(t){var e=this;return new ph(this.eu,t.ka,t.Pr,function(t){return e.Su.Rc(t,0)},t.platform.D_())},tc.prototype.m_=function(t){return new yh},tc.prototype.y_=function(t){return new mh(this.eu,this.Dc,t.ka,this.Fc,t.v_,t.Nc)},tc.prototype.clearPersistence=function(t){throw new _i(Ni.FAILED_PRECONDITION,Xh)},tc),Kh=(Zh.prototype.start=function(e,n){var i=this;this.$a();var r=new lu,o=new lu,s=!1;return this.credentials._(function(t){if(!s)return s=!0,js("FirestoreClient","Initializing. user=",t.uid),i.N_(e,n,t,o).then(r.resolve,r.reject);i.Pr.jr(function(){return i.Wu(t)})}),this.Pr.Sr(function(){return r.promise}),o.promise},Zh.prototype.enableNetwork=function(){var t=this;return this.$a(),this.Pr.enqueue(function(){return t.Su.enableNetwork()})},Zh.prototype.N_=function(u,a,h,c){return l(this,void 0,void 0,function(){var n,i,r,o,s=this;return d(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,this.platform.L_(this.F_)];case 1:return n=t.sent(),i=this.platform.Yo(this.F_.ii),e=this.credentials,r=new ch(n,e,i),[4,u.initialize({Pr:this.Pr,F_:this.F_,platform:this.platform,ka:r,clientId:this.clientId,v_:h,Nc:100,C_:a})];case 2:return t.sent(),this.persistence=u.persistence,this.Fc=u.Fc,this.eu=u.eu,this.Dc=u.Dc,this.Su=u.Su,this.A_=u.A_,this.O_=u.g_,this.persistence.o_(function(){return l(s,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),c.resolve(),[3,4];case 3:if(o=t.sent(),c.reject(o),!this.k_(o))throw o;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+o),this.N_(new Yh,{S_:!1},h,c))];case 4:return[2]}var e})})},Zh.prototype.k_=function(t){return"FirebaseError"===t.name?t.code===Ni.FAILED_PRECONDITION||t.code===Ni.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Zh.prototype.$a=function(){if(this.Pr.Mr)throw new _i(Ni.FAILED_PRECONDITION,"The client has already been terminated.")},Zh.prototype.Wu=function(t){return this.Pr.Hr(),js("FirestoreClient","Credential Changed. Current user: "+t.uid),this.Su.Wu(t)},Zh.prototype.disableNetwork=function(){var t=this;return this.$a(),this.Pr.enqueue(function(){return t.Su.disableNetwork()})},Zh.prototype.terminate=function(){var t=this;return this.Pr.Wr(function(){return l(t,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return this.A_&&this.A_.stop(),[4,this.Dc.yu()];case 1:return t.sent(),[4,this.Fc.yu()];case 2:return t.sent(),[4,this.persistence.yu()];case 3:return t.sent(),this.credentials.T(),[2]}})})})},Zh.prototype.waitForPendingWrites=function(){var t=this;this.$a();var e=new lu;return this.Pr.Sr(function(){return t.Su.el(e)}),e.promise},Zh.prototype.listen=function(t,e,n){var i=this;this.$a();var r=new bh(t,e,n);return this.Pr.Sr(function(){return i.O_.listen(r)}),r},Zh.prototype.bu=function(t){var e=this;this.q_||this.Pr.Sr(function(){return e.O_.bu(t)})},Zh.prototype.M_=function(o){return l(this,void 0,void 0,function(){var r,e=this;return d(this,function(t){switch(t.label){case 0:return this.$a(),r=new lu,[4,this.Pr.enqueue(function(){return l(e,void 0,void 0,function(){var e,n,i;return d(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.eu.so(o)];case 1:return(e=t.sent())instanceof wo?r.resolve(e):e instanceof bo?r.resolve(null):r.reject(new _i(Ni.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return n=t.sent(),i=_u(n,"Failed to get document '"+o+" from cache"),r.reject(i),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),r.promise)]}})})},Zh.prototype.x_=function(a){return l(this,void 0,void 0,function(){var u,e=this;return d(this,function(t){switch(t.label){case 0:return this.$a(),u=new lu,[4,this.Pr.enqueue(function(){return l(e,void 0,void 0,function(){var e,n,i,r,o,s;return d(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.eu.ao(a,!0)];case 1:return e=t.sent(),n=new vh(a,e.co),i=n._c(e.documents),r=n.Tc(i,!1),u.resolve(r.snapshot),[3,3];case 2:return o=t.sent(),s=_u(o,"Failed to execute query '"+a+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})},Zh.prototype.write=function(t){var e=this;this.$a();var n=new lu;return this.Pr.Sr(function(){return e.Su.write(t,n)}),n.promise},Zh.prototype.ii=function(){return this.F_.ii},Zh.prototype.dl=function(t){var e=this;this.$a(),this.Pr.Sr(function(){return e.O_.dl(t),Promise.resolve()})},Zh.prototype.wl=function(t){var e=this;this.q_||this.Pr.Sr(function(){return e.O_.wl(t),Promise.resolve()})},Object.defineProperty(Zh.prototype,"q_",{get:function(){return this.Pr.Mr},enumerable:!0,configurable:!0}),Zh.prototype.transaction=function(t){var e=this;this.$a();var n=new lu;return this.Pr.Sr(function(){return e.Su.runTransaction(e.Pr,t,n),Promise.resolve()}),n.promise},Zh),$h=(Jh.prototype.next=function(t){this.B_(this.observer.next,t)},Jh.prototype.error=function(t){this.B_(this.observer.error,t)},Jh.prototype.U_=function(){this.muted=!0},Jh.prototype.B_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Jh);function Jh(t){this.observer=t,this.muted=!1}function Zh(t,e,n,i){this.platform=t,this.F_=e,this.credentials=n,this.Pr=i,this.clientId=Hs.cn()}function tc(){}function ec(t){this.persistence=t,this.d_=new Lu,this.w_=null}function nc(t){var e=this;return(e=Gh.call(this)||this).Uh=t,e}function ic(){this.__=[]}function rc(t){var e=this;this.s_={},this.i_=new iu(0),this.n_=!1,this.n_=!0,this.Kh=t(this),this.Th=new zh(this),this.Fn=new du,this.Cn=new Th(this.Fn,function(t){return e.Kh.r_(t)})}function oc(t){this.persistence=t,this.Gl=new $s(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=Li.min(),this.highestTargetId=0,this.Hl=0,this.Kl=new Lu,this.targetCount=0,this.zl=vu.Rr()}function sc(r){return function(){if("object"==typeof r&&null!==r)for(var t=r,e=0,n=["next","error","complete"];e<n.length;e++){var i=n[e];if(i in t&&"function"==typeof t[i])return 1}}()}var uc,ac,hc,cc=(Vc.prototype.j_=function(t){switch(sr(t)){case 0:return null;case 1:return t.booleanValue;case 2:return pr(t.integerValue||t.doubleValue);case 3:return this.G_(t.timestampValue);case 4:return this.H_(t);case 5:return t.stringValue;case 6:return new oa(dr(t.bytesValue));case 7:return this.K_(t.referenceValue);case 8:return this.z_(t.geoPointValue);case 9:return this.Y_(t.arrayValue);case 10:return this.X_(t.mapValue);default:throw Gs()}},Vc.prototype.X_=function(t){var n=this,i={};return $i(t.fields||{},function(t,e){i[t]=n.j_(e)}),i},Vc.prototype.z_=function(t){return new Na(pr(t.latitude),pr(t.longitude))},Vc.prototype.Y_=function(t){var e=this;return(t.values||[]).map(function(t){return e.j_(t)})},Vc.prototype.H_=function(t){switch(this.Q_){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return ir(n)?t(n):n}(t);return null==e?null:this.j_(e);case"estimate":return this.G_(rr(t));default:return null}},Vc.prototype.G_=function(t){var e=lr(t),n=new ki(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},Vc.prototype.K_=function(t){var e=Vi.G(t);zs(Us(e));var n=new Ks(e.get(1),e.get(3)),i=new Xi(e.L(5));return n.isEqual(this.ii)||Fs("Document "+i+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.ii.projectId+"/"+this.ii.database+") instead."),this.W_(i)},Vc),fc=Ru.nh,lc=(Pc.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Pc),pc=(Object.defineProperty(Lc.prototype,"af",{get:function(){return this.uf||(this.uf=new Ba(this.xo,this.hf.ignoreUndefinedProperties)),this.uf},enumerable:!0,configurable:!0}),Lc.prototype.settings=function(t){Cu("Firestore.settings",arguments,1),ju("Firestore.settings","object",1,t);var e=new lc(t);if(this.ef&&!this.hf.isEqual(e))throw new _i(Ni.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.hf=e).credentials&&(this.nf=function(t){if(!t)return new Ri;switch(t.type){case"gapi":var e=t.cf;return zs(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Oi(e,t.V||"0");case"provider":return t.cf;default:throw new _i(Ni.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},Lc.prototype.enableNetwork=function(){return this.tf(),this.ef.enableNetwork()},Lc.prototype.disableNetwork=function(){return this.tf(),this.ef.disableNetwork()},Lc.prototype.enablePersistence=function(t){var e,n;if(this.ef)throw new _i(Ni.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var i=!1,r=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Fs("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),i=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,r=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,i&&r))throw new _i(Ni.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.lf(this.rf,{S_:!0,cacheSizeBytes:this.hf.cacheSizeBytes,synchronizeTabs:i,_f:r})},Lc.prototype.clearPersistence=function(){return l(this,void 0,void 0,function(){var i,e=this;return d(this,function(t){if(void 0!==this.ef&&!this.ef.q_)throw new _i(Ni.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return i=new lu,[2,(this.Z_.xr(function(){return l(e,void 0,void 0,function(){var e,n;return d(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),e=this.ff(),[4,this.rf.clearPersistence(e)];case 1:return t.sent(),i.resolve(),[3,3];case 2:return n=t.sent(),i.reject(n),[3,3];case 3:return[2]}})})}),i.promise)]})})},Lc.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Lc.prototype,"df",{get:function(){return this.tf(),this.ef.q_},enumerable:!0,configurable:!0}),Lc.prototype.waitForPendingWrites=function(){return this.tf(),this.ef.waitForPendingWrites()},Lc.prototype.onSnapshotsInSync=function(t){if(this.tf(),sc(t))return this.wf(t);ju("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.wf(e)},Lc.prototype.wf=function(t){var e=this,n=new $h({next:function(){t.next&&t.next()},error:function(t){throw Gs()}});return this.ef.dl(n),function(){n.U_(),e.ef.wl(n)}},Lc.prototype.tf=function(){return this.ef||this.lf(new Yh,{S_:!1}),this.ef},Lc.prototype.ff=function(){return new Ys(this.xo,this.if,this.hf.host,this.hf.ssl,this.hf.forceLongPolling)},Lc.prototype.lf=function(t,e){var n=this.ff();return this.ef=new Kh(Ms.nt(),n,this.nf,this.Z_),this.ef.start(t,e)},Lc.sf=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new _i(Ni.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new _i(Ni.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Ks(n)},Object.defineProperty(Lc.prototype,"app",{get:function(){if(!this.J_)throw new _i(Ni.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.J_},enumerable:!0,configurable:!0}),Lc.prototype.collection=function(t){return Cu("Firestore.collection",arguments,1),ju("Firestore.collection","non-empty string",1,t),this.tf(),new Ic(Vi.G(t),this,null)},Lc.prototype.doc=function(t){return Cu("Firestore.doc",arguments,1),ju("Firestore.doc","non-empty string",1,t),this.tf(),vc.Tf(Vi.G(t),this,null)},Lc.prototype.collectionGroup=function(t){if(Cu("Firestore.collectionGroup",arguments,1),ju("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new _i(Ni.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.tf(),new bc(new To(Vi.H,t),this,null)},Lc.prototype.runTransaction=function(e){var n=this;return Cu("Firestore.runTransaction",arguments,1),ju("Firestore.runTransaction","function",1,e),this.tf().transaction(function(t){return e(new dc(n,t))})},Lc.prototype.batch=function(){return this.tf(),new yc(this)},Object.defineProperty(Lc,"logLevel",{get:function(){switch(xs()){case p.DEBUG:return"debug";case p.ERROR:return"error";case p.SILENT:return"silent";case p.WARN:return"warn";case p.INFO:return"info";case p.VERBOSE:return"verbose";default:return"error"}},enumerable:!0,configurable:!0}),Lc.setLogLevel=function(t){Cu("Firestore.setLogLevel",arguments,1),Hu("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Cs.setLogLevel(t)},Lc.prototype.Ef=function(){return this.hf.timestampsInSnapshots},Lc),dc=(kc.prototype.get=function(t){var n=this;Cu("Transaction.get",arguments,1);var i=qc("Transaction.get",t,this.If);return this.mf.Ua([i.Bo]).then(function(t){if(!t||1!==t.length)return Gs();var e=t[0];if(e instanceof bo)return new mc(n.If,i.Bo,null,!1,!1,i.Uo);if(e instanceof wo)return new mc(n.If,i.Bo,e,!1,!1,i.Uo);throw Gs()})},kc.prototype.set=function(t,e,n){xu("Transaction.set",arguments,2,3);var i=qc("Transaction.set",t,this.If);n=Uc("Transaction.set",n);var r=xc(i.Uo,e,"Transaction.set"),o=r[0],s=r[1],u=this.If.af.Xo(s,o,n);return this.mf.set(i.Bo,u),this},kc.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return r="string"==typeof e||e instanceof sa?(qu("Transaction.update",arguments,3),i=qc("Transaction.update",t,this.If),this.If.af.ta("Transaction.update",e,n,o)):(Cu("Transaction.update",arguments,2),i=qc("Transaction.update",t,this.If),this.If.af.Zo("Transaction.update",e)),this.mf.update(i.Bo,r),this},kc.prototype.delete=function(t){Cu("Transaction.delete",arguments,1);var e=qc("Transaction.delete",t,this.If);return this.mf.delete(e.Bo),this},kc),yc=(Oc.prototype.set=function(t,e,n){xu("WriteBatch.set",arguments,2,3),this.Pf();var i=qc("WriteBatch.set",t,this.If);n=Uc("WriteBatch.set",n);var r=xc(i.Uo,e,"WriteBatch.set"),o=r[0],s=r[1],u=this.If.af.Xo(s,o,n);return this.Rf=this.Rf.concat(u.Qo(i.Bo,qr.dt())),this},Oc.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Pf(),r="string"==typeof e||e instanceof sa?(qu("WriteBatch.update",arguments,3),i=qc("WriteBatch.update",t,this.If),this.If.af.ta("WriteBatch.update",e,n,o)):(Cu("WriteBatch.update",arguments,2),i=qc("WriteBatch.update",t,this.If),this.If.af.Zo("WriteBatch.update",e)),this.Rf=this.Rf.concat(r.Qo(i.Bo,qr.exists(!0))),this},Oc.prototype.delete=function(t){Cu("WriteBatch.delete",arguments,1),this.Pf();var e=qc("WriteBatch.delete",t,this.If);return this.Rf=this.Rf.concat(new Gr(e.Bo,qr.dt())),this},Oc.prototype.commit=function(){return this.Pf(),this.Af=!0,0<this.Rf.length?this.If.tf().write(this.Rf):Promise.resolve()},Oc.prototype.Pf=function(){if(this.Af)throw new _i(Ni.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Oc),vc=(n(Sc,hc=Ra),Sc.Tf=function(t,e,n){if(t.length%2!=0)throw new _i(Ni.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.j()+" has "+t.length);return new Sc(new Xi(t),e,n)},Object.defineProperty(Sc.prototype,"id",{get:function(){return this.Bo.path.q()},enumerable:!0,configurable:!0}),Object.defineProperty(Sc.prototype,"parent",{get:function(){return new Ic(this.Bo.path.O(),this.firestore,this.Uo)},enumerable:!0,configurable:!0}),Object.defineProperty(Sc.prototype,"path",{get:function(){return this.Bo.path.j()},enumerable:!0,configurable:!0}),Sc.prototype.collection=function(t){if(Cu("DocumentReference.collection",arguments,1),ju("DocumentReference.collection","non-empty string",1,t),!t)throw new _i(Ni.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Vi.G(t);return new Ic(this.Bo.path.child(e),this.firestore,null)},Sc.prototype.isEqual=function(t){if(!(t instanceof Sc))throw $u("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Bo.isEqual(t.Bo)&&this.Uo===t.Uo},Sc.prototype.set=function(t,e){xu("DocumentReference.set",arguments,1,2),e=Uc("DocumentReference.set",e);var n=xc(this.Uo,t,"DocumentReference.set"),i=n[0],r=n[1],o=this.firestore.af.Xo(r,i,e);return this.ef.write(o.Qo(this.Bo,qr.dt()))},Sc.prototype.update=function(t,e){for(var n,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return n="string"==typeof t||t instanceof sa?(qu("DocumentReference.update",arguments,2),this.firestore.af.ta("DocumentReference.update",t,e,i)):(Cu("DocumentReference.update",arguments,1),this.firestore.af.Zo("DocumentReference.update",t)),this.ef.write(n.Qo(this.Bo,qr.exists(!0)))},Sc.prototype.delete=function(){return Cu("DocumentReference.delete",arguments,0),this.ef.write([new Gr(this.Bo,qr.dt())])},Sc.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];xu("DocumentReference.onSnapshot",arguments,1,4);var n={includeMetadataChanges:!1},i=0;"object"!=typeof t[i]||sc(t[i])||(Ku("DocumentReference.onSnapshot",n=t[i],["includeMetadataChanges"]),Gu("DocumentReference.onSnapshot","boolean","includeMetadataChanges",n.includeMetadataChanges),i++);var r={includeMetadataChanges:n.includeMetadataChanges},o=sc(t[i])?t[i]:(ju("DocumentReference.onSnapshot","function",i,t[i]),Fu("DocumentReference.onSnapshot","function",i+1,t[i+1]),Fu("DocumentReference.onSnapshot","function",i+2,t[i+2]),{next:t[i],error:t[i+1],complete:t[i+2]});return this.Vf(r,o)},Sc.prototype.Vf=function(t,n){var i=this,e=function(t){console.error("Uncaught Error in onSnapshot:",t)};n.error&&(e=n.error.bind(n));var r=new $h({next:function(t){var e;n.next&&(e=t.docs.get(i.Bo),n.next(new mc(i.firestore,i.Bo,e,t.fromCache,t.hasPendingWrites,i.Uo)))},error:e}),o=this.ef.listen(To.Wt(this.Bo.path),r,t);return function(){r.U_(),i.ef.bu(o)}},Sc.prototype.get=function(n){var i=this;return xu("DocumentReference.get",arguments,0,1),Cc("DocumentReference.get",n),new Promise(function(e,t){n&&"cache"===n.source?i.firestore.tf().M_(i.Bo).then(function(t){e(new mc(i.firestore,i.Bo,t,!0,t instanceof wo&&t.At,i.Uo))},t):i.pf(e,t,n)})},Sc.prototype.pf=function(e,n,i){var r=this.Vf({includeMetadataChanges:!0,Pl:!0},{next:function(t){r(),!t.exists&&t.metadata.fromCache?n(new _i(Ni.UNAVAILABLE,"Failed to get document because the client is offline.")):t.exists&&t.metadata.fromCache&&i&&"server"===i.source?n(new _i(Ni.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):e(t)},error:n})},Sc.prototype.withConverter=function(t){return new Sc(this.Bo,this.firestore,t)},Sc),gc=(Dc.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Dc),mc=(Rc.prototype.data=function(t){var e=this;if(xu("DocumentSnapshot.data",arguments,0,1),t=Mc("DocumentSnapshot.data",t),this.yf){if(this.Uo){var n=new wc(this.If,this.Bo,this.yf,this.gf,this.bf,null);return this.Uo.fromFirestore(n,t)}return new cc(this.If.xo,this.If.Ef(),t.serverTimestamps||"none",function(t){return new vc(t,e.If,null)}).j_(this.yf.Ot())}},Rc.prototype.get=function(t,e){var n=this;if(xu("DocumentSnapshot.get",arguments,1,2),e=Mc("DocumentSnapshot.get",e),this.yf){var i=this.yf.data().field(Ya("DocumentSnapshot.get",t));if(null!==i)return new cc(this.If.xo,this.If.Ef(),e.serverTimestamps||"none",function(t){return new vc(t,n.If,n.Uo)}).j_(i)}},Object.defineProperty(Rc.prototype,"id",{get:function(){return this.Bo.path.q()},enumerable:!0,configurable:!0}),Object.defineProperty(Rc.prototype,"ref",{get:function(){return new vc(this.Bo,this.If,this.Uo)},enumerable:!0,configurable:!0}),Object.defineProperty(Rc.prototype,"exists",{get:function(){return null!==this.yf},enumerable:!0,configurable:!0}),Object.defineProperty(Rc.prototype,"metadata",{get:function(){return new gc(this.bf,this.gf)},enumerable:!0,configurable:!0}),Rc.prototype.isEqual=function(t){if(!(t instanceof Rc))throw $u("isEqual","DocumentSnapshot",1,t);return this.If===t.If&&this.gf===t.gf&&this.Bo.isEqual(t.Bo)&&(null===this.yf?null===t.yf:this.yf.isEqual(t.yf))&&this.Uo===t.Uo},Rc),wc=(n(_c,ac=mc),_c.prototype.data=function(t){return ac.prototype.data.call(this,t)},_c),bc=(Nc.prototype.where=function(t,e,n){Cu("Query.where",arguments,3),Yu("Query.where",3,n);var i,r=Hu("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e),o=Ya("Query.where",t);if(o.Y()){if("array-contains"===r||"array-contains-any"===r)throw new _i(Ni.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+r+"' queries on FieldPath.documentId().");if("in"===r){this.Sf(n,r);for(var s=[],u=0,a=n;u<a.length;u++){var h=a[u];s.push(this.Cf(h))}i={arrayValue:{values:s}}}else i=this.Cf(n)}else"in"!==r&&"array-contains-any"!==r||this.Sf(n,r),i=this.firestore.af.ea("Query.where",n,"in"===r);var c=Ao.create(o,r,i);return this.Df(c),new Nc(this.vf.Ht(c),this.firestore,this.Uo)},Nc.prototype.orderBy=function(t,e){var n;if(xu("Query.orderBy",arguments,1,2),Fu("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new _i(Ni.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}if(null!==this.vf.startAt)throw new _i(Ni.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.vf.endAt)throw new _i(Ni.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=Ya("Query.orderBy",t),r=new ko(i,n);return this.Ff(r),new Nc(this.vf.Kt(r),this.firestore,this.Uo)},Nc.prototype.limit=function(t){return Cu("Query.limit",arguments,1),ju("Query.limit","number",1,t),Ju("Query.limit",1,t),new Nc(this.vf.zt(t),this.firestore,this.Uo)},Nc.prototype.limitToLast=function(t){return Cu("Query.limitToLast",arguments,1),ju("Query.limitToLast","number",1,t),Ju("Query.limitToLast",1,t),new Nc(this.vf.Yt(t),this.firestore,this.Uo)},Nc.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];qu("Query.startAt",arguments,1);var i=this.Nf("Query.startAt",t,e,!0);return new Nc(this.vf.Xt(i),this.firestore,this.Uo)},Nc.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];qu("Query.startAfter",arguments,1);var i=this.Nf("Query.startAfter",t,e,!1);return new Nc(this.vf.Xt(i),this.firestore,this.Uo)},Nc.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];qu("Query.endBefore",arguments,1);var i=this.Nf("Query.endBefore",t,e,!0);return new Nc(this.vf.Jt(i),this.firestore,this.Uo)},Nc.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];qu("Query.endAt",arguments,1);var i=this.Nf("Query.endAt",t,e,!1);return new Nc(this.vf.Jt(i),this.firestore,this.Uo)},Nc.prototype.isEqual=function(t){if(!(t instanceof Nc))throw $u("isEqual","Query",1,t);return this.firestore===t.firestore&&this.vf.isEqual(t.vf)&&this.Uo===t.Uo},Nc.prototype.withConverter=function(t){return new Nc(this.vf,this.firestore,t)},Nc.prototype.Nf=function(t,e,n,i){if(Yu(t,1,e),e instanceof mc){if(0<n.length)throw new _i(Ni.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var r=e;if(!r.exists)throw new _i(Ni.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.$f(r.yf,i)}var o=[e].concat(n);return this.Lf(t,o,i)},Nc.prototype.$f=function(t,e){for(var n=[],i=0,r=this.vf.orderBy;i<r.length;i++){var o=r[i];if(o.field.Y())n.push(yr(this.firestore.xo,t.key));else{var s=t.field(o.field);if(ir(s))throw new _i(Ni.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===s){var u=o.field.j();throw new _i(Ni.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}n.push(s)}}return new Oo(n,e)},Nc.prototype.Lf=function(t,e,n){var i=this.vf.Mt;if(e.length>i.length)throw new _i(Ni.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var r=[],o=0;o<e.length;o++){var s=e[o];if(i[o].field.Y()){if("string"!=typeof s)throw new _i(Ni.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof s);if(!this.vf.le()&&-1!==s.indexOf("/"))throw new _i(Ni.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+s+"' contains a slash.");var u=this.vf.path.child(Vi.G(s));if(!Xi.et(u))throw new _i(Ni.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+u+"' is not because it contains an odd number of segments.");var a=new Xi(u);r.push(yr(this.firestore.xo,a))}else{var h=this.firestore.af.ea(t,s);r.push(h)}}return new Oo(r,n)},Nc.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];xu("Query.onSnapshot",arguments,1,4);var n,i={},r=0;return"object"!=typeof t[r]||sc(t[r])||(Ku("Query.onSnapshot",i=t[r],["includeMetadataChanges"]),Gu("Query.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),r++),n=sc(t[r])?t[r]:(ju("Query.onSnapshot","function",r,t[r]),Fu("Query.onSnapshot","function",r+1,t[r+1]),Fu("Query.onSnapshot","function",r+2,t[r+2]),{next:t[r],error:t[r+1],complete:t[r+2]}),this.Of(this.vf),this.Vf(i,n)},Nc.prototype.Vf=function(t,e){var n=this,i=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(i=e.error.bind(e));var r=new $h({next:function(t){e.next&&e.next(new Ec(n.firestore,n.vf,t,n.Uo))},error:i}),o=this.firestore.tf(),s=o.listen(this.vf,r,t);return function(){r.U_(),o.bu(s)}},Nc.prototype.Of=function(t){if(t.ae()&&0===t.Mt.length)throw new _i(Ni.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},Nc.prototype.get=function(n){var i=this;return xu("Query.get",arguments,0,1),Cc("Query.get",n),this.Of(this.vf),new Promise(function(e,t){n&&"cache"===n.source?i.firestore.tf().x_(i.vf).then(function(t){e(new Ec(i.firestore,i.vf,t,i.Uo))},t):i.pf(e,t,n)})},Nc.prototype.pf=function(e,n,i){var r=this.Vf({includeMetadataChanges:!0,Pl:!0},{next:function(t){r(),t.metadata.fromCache&&i&&"server"===i.source?n(new _i(Ni.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):e(t)},error:n})},Nc.prototype.Cf=function(t){if("string"==typeof t){if(""===t)throw new _i(Ni.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.vf.le()&&-1!==t.indexOf("/"))throw new _i(Ni.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this.vf.path.child(Vi.G(t));if(!Xi.et(e))throw new _i(Ni.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return yr(this.firestore.xo,new Xi(e))}if(t instanceof vc)return yr(this.firestore.xo,t.Bo);throw new _i(Ni.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Xu(t)+".")},Nc.prototype.Sf=function(t,e){if(!Array.isArray(t)||0===t.length)throw new _i(Ni.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new _i(Ni.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new _i(Ni.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new _i(Ni.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},Nc.prototype.Df=function(t){if(t instanceof Ao){var e=["array-contains","array-contains-any"],n=["in","array-contains-any"],i=0<=e.indexOf(t.op),r=0<=n.indexOf(t.op);if(t.ue()){var o=this.vf.jt();if(null!==o&&!o.isEqual(t.field))throw new _i(Ni.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var s=this.vf.Gt();null!==s&&this.kf(t.field,s)}else if(r||i){var u=null;if(r&&(u=this.vf.ce(n)),null===u&&i&&(u=this.vf.ce(e)),null!=u)throw u===t.op?new _i(Ni.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new _i(Ni.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+u.toString()+"' filters.")}}},Nc.prototype.Ff=function(t){var e;null!==this.vf.Gt()||null!==(e=this.vf.jt())&&this.kf(e,t.field)},Nc.prototype.kf=function(t,e){if(!e.isEqual(t))throw new _i(Ni.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},Nc),Ec=(Object.defineProperty(Ac.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!0,configurable:!0}),Object.defineProperty(Ac.prototype,"empty",{get:function(){return this.Mf.docs.M()},enumerable:!0,configurable:!0}),Object.defineProperty(Ac.prototype,"size",{get:function(){return this.Mf.docs.size},enumerable:!0,configurable:!0}),Ac.prototype.forEach=function(e,n){var i=this;xu("QuerySnapshot.forEach",arguments,1,2),ju("QuerySnapshot.forEach","function",1,e),this.Mf.docs.forEach(function(t){e.call(n,i.Uf(t))})},Object.defineProperty(Ac.prototype,"query",{get:function(){return new bc(this.qf,this.If,this.Uo)},enumerable:!0,configurable:!0}),Ac.prototype.docChanges=function(t){t&&(Ku("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Gu("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.Mf.hs)throw new _i(Ni.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.xf&&this.Bf===e||(this.xf=function(r,e,o,s){if(o.ss.M()){var n=0;return o.docChanges.map(function(t){var e=new wc(r,t.doc.key,t.doc,o.fromCache,o.ns.has(t.doc.key),s);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var u=o.ss;return o.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new wc(r,t.doc.key,t.doc,o.fromCache,o.ns.has(t.doc.key),s),n=-1,i=-1;return 0!==t.type&&(n=u.indexOf(t.doc.key),u=u.delete(t.doc.key)),1!==t.type&&(i=(u=u.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Gs()}}(),doc:e,oldIndex:n,newIndex:i}})}(this.If,e,this.Mf,this.Uo),this.Bf=e),this.xf},Ac.prototype.isEqual=function(t){if(!(t instanceof Ac))throw $u("isEqual","QuerySnapshot",1,t);return this.If===t.If&&this.qf.isEqual(t.qf)&&this.Mf.isEqual(t.Mf)&&this.Uo===t.Uo},Ac.prototype.Uf=function(t){return new wc(this.If,t.key,t,this.metadata.fromCache,this.Mf.ns.has(t.key),this.Uo)},Ac),Ic=(n(Tc,uc=bc),Object.defineProperty(Tc.prototype,"id",{get:function(){return this.vf.path.q()},enumerable:!0,configurable:!0}),Object.defineProperty(Tc.prototype,"parent",{get:function(){var t=this.vf.path.O();return t.M()?null:new vc(new Xi(t),this.firestore,null)},enumerable:!0,configurable:!0}),Object.defineProperty(Tc.prototype,"path",{get:function(){return this.vf.path.j()},enumerable:!0,configurable:!0}),Tc.prototype.doc=function(t){xu("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Hs.cn()),ju("CollectionReference.doc","non-empty string",1,t);var e=Vi.G(t);return vc.Tf(this.vf.path.child(e),this.firestore,this.Uo)},Tc.prototype.add=function(t){Cu("CollectionReference.add",arguments,1),ju("CollectionReference.add","object",1,this.Uo?this.Uo.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},Tc.prototype.withConverter=function(t){return new Tc(this.Qf,this.firestore,t)},Tc);function Tc(t,e,n){var i=this;if(((i=uc.call(this,To.Wt(t),e,n)||this).Qf=t).length%2!=1)throw new _i(Ni.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.j()+" has "+t.length);return i}function Ac(t,e,n,i){this.If=t,this.qf=e,this.Mf=n,this.Uo=i,this.xf=null,this.Bf=null,this.metadata=new gc(n.hasPendingWrites,n.fromCache)}function Nc(t,e,n){this.vf=t,this.firestore=e,this.Uo=n}function _c(){return null!==ac&&ac.apply(this,arguments)||this}function Rc(t,e,n,i,r,o){this.If=t,this.Bo=e,this.yf=n,this.gf=i,this.bf=r,this.Uo=o}function Dc(t,e){this.hasPendingWrites=t,this.fromCache=e}function Sc(t,e,n){var i=this;return(i=hc.call(this,e.xo,t,n)||this).Bo=t,i.firestore=e,i.Uo=n,i.ef=i.firestore.tf(),i}function Oc(t){this.If=t,this.Rf=[],this.Af=!1}function kc(t,e){this.If=t,this.mf=e}function Lc(t,e,n){var i=this;if(void 0===n&&(n=new Yh),this.J_=null,this.Z_=new Tu,this.INTERNAL={delete:function(){return l(i,void 0,void 0,function(){return d(this,function(t){switch(t.label){case 0:return this.tf(),[4,this.ef.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var r=t;this.J_=r,this.xo=Lc.sf(r),this.if=r.name,this.nf=new Di(e)}else{var o=t;if(!o.projectId)throw new _i(Ni.INVALID_ARGUMENT,"Must provide projectId");this.xo=new Ks(o.projectId,o.database),this.if="[DEFAULT]",this.nf=new Ri}this.rf=n,this.hf=new lc({})}function Pc(t){var e,n,i,r;if(void 0===t.host){if(void 0!==t.ssl)throw new _i(Ni.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Bu("settings","non-empty string","host",t.host),this.host=t.host,Gu("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(Ku("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),Gu("settings","object","credentials",t.credentials),this.credentials=t.credentials,Gu("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),Gu("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Fs("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Fs("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(i=t.ignoreUndefinedProperties)&&void 0!==i&&i,Gu("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Ru.hh;else{if(t.cacheSizeBytes!==fc&&t.cacheSizeBytes<Ru.rh)throw new _i(Ni.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Ru.rh);this.cacheSizeBytes=t.cacheSizeBytes}Gu("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(r=t.experimentalForceLongPolling)&&void 0!==r&&r}function Vc(t,e,n,i){this.ii=t,this.timestampsInSnapshots=e,this.Q_=n,this.W_=i}function Uc(t,e){if(void 0===e)return{merge:!1};if(Ku(t,e,["merge","mergeFields"]),Gu(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new _i(Ni.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Xu(n));for(var i,r=0;r<n.length;++r)if(!("string"==typeof(i=n[r])||i instanceof sa))throw new _i(Ni.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+r+" was: "+Xu(n[r]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new _i(Ni.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function Mc(t,e){return void 0===e?{}:(Ku(t,e,["serverTimestamps"]),zu(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Cc(t,e){Fu(t,"object",1,e),e&&(Ku(t,e,["source"]),zu(t,0,"source",e.source,["default","server","cache"]))}function qc(t,e,n){if(e instanceof Ra){if(e.firestore!==n)throw new _i(Ni.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw $u(t,"DocumentReference",1,e)}function xc(t,e,n){var i;return t?(i=t.toFirestore(e),n="toFirestore() in "+n):i=e,[i,n]}function jc(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new _i(Ni.INVALID_ARGUMENT,t)}return n.prototype=t.prototype,Object.assign(n,t),n}var Fc,Bc=jc(pc,"Use firebase.firestore() instead."),Gc=jc(dc,"Use firebase.firestore().runTransaction() instead."),zc=jc(yc,"Use firebase.firestore().batch() instead."),Hc=jc(vc,"Use firebase.firestore().doc() instead."),Wc=jc(mc),Qc=jc(wc),Xc=jc(bc),Yc=jc(Ec),Kc=jc(Ic,"Use firebase.firestore().collection() instead."),$c=jc(Ta,"Use FieldValue.<field>() instead."),Jc=jc(oa,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),Zc={Firestore:Bc,GeoPoint:Na,Timestamp:ki,Blob:Jc,Transaction:Gc,WriteBatch:zc,DocumentReference:Hc,DocumentSnapshot:Wc,Query:Xc,QueryDocumentSnapshot:Qc,QuerySnapshot:Yc,CollectionReference:Kc,FieldPath:sa,FieldValue:$c,setLogLevel:pc.setLogLevel,CACHE_SIZE_UNLIMITED:fc},tf=(cf.prototype.ou=function(t){},cf.prototype.yu=function(){},cf),ef=(hf.prototype.ou=function(t){this.Kf.push(t)},hf.prototype.yu=function(){window.removeEventListener("online",this.Wf),window.removeEventListener("offline",this.Gf)},hf.prototype.zf=function(){window.addEventListener("online",this.Wf),window.addEventListener("offline",this.Gf)},hf.prototype.jf=function(){js("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Kf;t<e.length;t++)(0,e[t])(0)},hf.prototype.Hf=function(){js("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Kf;t<e.length;t++)(0,e[t])(1)},hf.Yf=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},hf),nf=(af.prototype.Aa=function(t){this.Zf=t},af.prototype.Ta=function(t){this.td=t},af.prototype.onMessage=function(t){this.ed=t},af.prototype.close=function(){this.Jf()},af.prototype.send=function(t){this.Xf(t)},af.prototype.sd=function(){this.Zf()},af.prototype.nd=function(t){this.td(t)},af.prototype.rd=function(t){this.ed(t)},af),rf={BatchGetDocuments:"batchGet",Commit:"commit"},of="gl-js/ fire/"+wi,sf=(uf.prototype.od=function(t,e){if(e)for(var n in e.o)e.o.hasOwnProperty(n)&&(t[n]=e.o[n]);t["X-Goog-Api-Client"]=of},uf.prototype.La=function(a,i,r){var h=this,c=this.ad(a);return new Promise(function(o,s){var u=new mi;u.listenOnce(vi.COMPLETE,function(){try{switch(u.getLastErrorCode()){case yi.NO_ERROR:var t=u.getResponseJson();js("Connection","XHR received:",JSON.stringify(t)),o(t);break;case yi.TIMEOUT:js("Connection",'RPC "'+a+'" timed out'),s(new _i(Ni.DEADLINE_EXCEEDED,"Request time out"));break;case yi.HTTP_ERROR:var e,n,i=u.getStatus();js("Connection",'RPC "'+a+'" failed with status:',i,"response text:",u.getResponseText()),0<i?(e=u.getResponseJson().error)&&e.status&&e.message?(r=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(Ni).indexOf(r)?r:Ni.UNKNOWN,s(new _i(n,e.message))):s(new _i(Ni.UNKNOWN,"Server responded with status "+u.getStatus())):(js("Connection",'RPC "'+a+'" failed'),s(new _i(Ni.UNAVAILABLE,"Connection failed.")));break;default:Gs()}}finally{js("Connection",'RPC "'+a+'" completed.')}var r});var t=Object.assign({},i);delete t.database;var e=JSON.stringify(t);js("Connection","XHR sending: ",c+" "+e);var n={"Content-Type":"text/plain"};h.od(n,r),u.send(c,"POST",e,n,15)})},uf.prototype.Oa=function(t,e,n){return this.La(t,e,n)},uf.prototype.Pa=function(t,e){var n,i,r=[this.hd,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=di(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.ii.projectId+"/databases/"+this.ii.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.od(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(v())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=v().indexOf("Electron/")||0<=(i=v()).indexOf("MSIE ")||0<=i.indexOf("Trident/")||0<=v().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=r.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}js("Connection","Creating WebChannel: "+u+" "+s);var h=o.createWebChannel(u,s),c=!1,f=!1,l=new nf({Xf:function(t){f?js("Connection","Not sending because WebChannel is closed:",t):(c||(js("Connection","Opening WebChannel transport."),h.open(),c=!0),js("Connection","WebChannel sending:",t),h.send(t))},Jf:function(){return h.close()}});return a(gi.EventType.OPEN,function(){f||js("Connection","WebChannel transport opened.")}),a(gi.EventType.CLOSE,function(){f||(f=!0,js("Connection","WebChannel transport closed"),l.nd())}),a(gi.EventType.ERROR,function(t){f||(f=!0,function(t){for(var e,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];Cs.logLevel<=p.WARN&&(e=n.map(Bs),Cs.warn.apply(Cs,y(["Firestore ("+wi+"): Connection"],e)))}("Connection","WebChannel transport errored:",t),l.nd(new _i(Ni.UNAVAILABLE,"The operation could not be completed")))}),a(gi.EventType.MESSAGE,function(t){var e,n,i,r,o,s;f||(zs(!!(n=t.data[0])),(i=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(js("Connection","WebChannel received error:",i),r=i.status,o=function(){var t=uo[r];if(void 0!==t)return Xo(t)}(),s=i.message,void 0===o&&(o=Ni.INTERNAL,s="Unknown error status: "+r+" with message "+i.message),f=!0,l.nd(new _i(o,s)),h.close()):(js("Connection","WebChannel received:",n),l.rd(n)))}),setTimeout(function(){l.sd()},0),l},uf.prototype.ad=function(t){var e=rf[t];return this.hd+"/v1/projects/"+this.ii.projectId+"/databases/"+this.ii.database+"/documents:"+e},uf);function uf(t){this.ii=t.ii;var e=t.ssl?"https":"http";this.hd=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function af(t){this.Xf=t.Xf,this.Jf=t.Jf}function hf(){var t=this;this.Wf=function(){return t.jf()},this.Gf=function(){return t.Hf()},this.Kf=[],this.zf()}function cf(){}function ff(){this.yo="undefined"!=typeof atob}Ms.an((Object.defineProperty(ff.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(ff.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),ff.prototype.L_=function(t){return Promise.resolve(new sf(t))},ff.prototype.D_=function(){return new(ef.Yf()?ef:tf)},ff.prototype.Yo=function(t){return new Ps(t,{hi:!0})},ff.prototype.un=function(t){return JSON.stringify(t)},ff.prototype.atob=function(t){return atob(t)},ff.prototype.btoa=function(t){return btoa(t)},ff.prototype.ln=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e)e.getRandomValues(n);else for(var i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n},new ff)),(Fc=lf).INTERNAL.registerComponent(new I("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new pc(e,n,new Yh);var e,n},"PUBLIC").setServiceProps(Object.assign({},Zc))),Fc.registerVersion("@firebase/firestore","1.15.1-0")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
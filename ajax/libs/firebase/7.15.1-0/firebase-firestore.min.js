!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t=t||self).firebase)}(this,function(pp){"use strict";try{(function(){pp=pp&&Object.prototype.hasOwnProperty.call(pp,"default")?pp.default:pp;var t,p,e,r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function d(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function i(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=a[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(e=p=p||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";var o={debug:p.DEBUG,verbose:p.VERBOSE,info:p.INFO,warn:p.WARN,error:p.ERROR,silent:p.SILENT},u=p.INFO,a=((t={})[p.DEBUG]="log",t[p.VERBOSE]="log",t[p.INFO]="info",t[p.WARN]="warn",t[p.ERROR]="error",t),h=(Object.defineProperty(c.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in p))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!0,configurable:!0}),c.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(c.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!0,configurable:!0}),c.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.DEBUG],t)),this._logHandler.apply(this,s([this,p.DEBUG],t))},c.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.VERBOSE],t)),this._logHandler.apply(this,s([this,p.VERBOSE],t))},c.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.INFO],t)),this._logHandler.apply(this,s([this,p.INFO],t))},c.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.WARN],t)),this._logHandler.apply(this,s([this,p.WARN],t))},c.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.ERROR],t)),this._logHandler.apply(this,s([this,p.ERROR],t))},c);function c(t){this.name=t,this._logLevel=u,this._logHandler=i,this._userLogHandler=null}function g(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var f,m=(n(l,f=Error),l);function l(t,e){var n=f.call(this,e)||this;return n.code=t,n.name="FirebaseError",Object.setPrototypeOf(n,l.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,w.prototype.create),n}var w=(b.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(r=i,s.replace(E,function(t,e){var n=r[e];return null!=n?n.toString():"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new m(o,a),c=0,f=Object.keys(i);c<f.length;c++){var l=f[c];"_"!==l.slice(-1)&&(l in h&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),h[l]=i[l])}return h},b);function b(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g,T=(I.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},I.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},I.prototype.setServiceProps=function(t){return this.serviceProps=t,this},I);function I(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}function N(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var _,A="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S=S||{},R=A||self;function x(){}function D(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function P(t){var e=D(t);return"array"==e||"object"==e&&"number"==typeof t.length}function O(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var k="closure_uid_"+(1e9*Math.random()>>>0),L=0;function V(t,e,n){return t.call.apply(t.bind,arguments)}function C(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function U(t,e,n){return(U=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?V:C).apply(null,arguments)}function j(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var M=Date.now||function(){return+new Date};function q(t,e){function n(){}n.prototype=e.prototype,t.M=e.prototype,t.prototype=new n,t.prototype.constructor=t}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.da=function(){!this.j&&(this.j=!0,this.C(),0)&&(Object.prototype.hasOwnProperty.call(this,k)&&this[k]||(this[k]=++L))},F.prototype.C=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var B=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function z(t){return Array.prototype.concat.apply([],arguments)}function W(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function K(t){return/^[\s\xa0]*$/.test(t)}var H,Q=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}t:{var J=R.navigator;if(J){var $=J.userAgent;if($){H=$;break t}}H=""}function Z(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function tt(t){var e={};for(var n in t)e[n]=t[n];return e}var et="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function nt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<et.length;o++)n=et[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function rt(t){return rt[" "](t),t}rt[" "]=x;var it,ot,st=Y(H,"Opera"),ut=Y(H,"Trident")||Y(H,"MSIE"),at=Y(H,"Edge"),ht=at||ut,ct=Y(H,"Gecko")&&!(Y(H.toLowerCase(),"webkit")&&!Y(H,"Edge"))&&!(Y(H,"Trident")||Y(H,"MSIE"))&&!Y(H,"Edge"),ft=Y(H.toLowerCase(),"webkit")&&!Y(H,"Edge");function lt(){var t=R.document;return t?t.documentMode:void 0}t:{var pt="",dt=(ot=H,ct?/rv:([^\);]+)(\)|;)/.exec(ot):at?/Edge\/([\d\.]+)/.exec(ot):ut?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ot):ft?/WebKit\/(\S+)/.exec(ot):st?/(?:Version)[ \/]?(\S+)/.exec(ot):void 0);if(dt&&(pt=dt?dt[1]:""),ut){var yt=lt();if(null!=yt&&yt>parseFloat(pt)){it=String(yt);break t}}it=pt}var vt={};function gt(u){return t=u,e=function(){for(var t=0,e=Q(String(it)).split("."),n=Q(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=vt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var mt=R.document&&ut&&(lt()||parseInt(it,10))||void 0,wt=!ut||9<=Number(mt),bt=ut&&!gt("9"),Et=function(){if(!R.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{R.addEventListener("test",x,e),R.removeEventListener("test",x,e)}catch(t){}return t}();function Tt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function It(t,e){if(Tt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ct){t:{try{rt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Nt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Tt.prototype.b=function(){this.defaultPrevented=!0},q(It,Tt);var Nt={2:"touch",3:"pen",4:"mouse"};It.prototype.b=function(){It.M.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,bt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var _t="closure_listenable_"+(1e6*Math.random()|0),At=0;function St(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.aa=i,this.key=++At,this.V=this.X=!1}function Rt(t){t.V=!0,t.listener=null,t.proxy=null,t.src=null,t.aa=null}function xt(t){this.src=t,this.a={},this.b=0}function Dt(t,e){var n,r,i,o=e.type;o in t.a&&(r=t.a[o],(n=0<=(i=B(r,e)))&&Array.prototype.splice.call(r,i,1),n&&(Rt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Pt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.V&&o.listener==e&&o.capture==!!n&&o.aa==r)return i}return-1}xt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Pt(t,e,r,i);return-1<s?(e=t[s],n||(e.X=!1)):((e=new St(e,this.src,o,!!r,i)).X=n,t.push(e)),e};var Ot="closure_lm_"+(1e6*Math.random()|0),kt={};function Lt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Bt(r),e&&e[_t]?e.sa(n,r,O(i)?!!i.capture:!!i,o):Vt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Lt(t,e[o],n,r,i);return null}return n=Bt(n),t&&t[_t]?t.ra(e,n,O(r)?!!r.capture:!!r,i):Vt(t,e,n,!1,r,i)}function Vt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=O(i)?!!i.capture:!!i;if(s&&!wt)return null;var u,a,h=qt(t);if(h||(t[Ot]=h=new xt(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Mt,r=a=wt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)Et||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ut(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ct(t){var e,n,r;"number"!=typeof t&&t&&!t.V&&((e=t.src)&&e[_t]?Dt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ut(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=qt(e))?(Dt(n,t),0==n.b&&(n.src=null,e[Ot]=null)):Rt(t)))}function Ut(t){return t in kt?kt[t]:kt[t]="on"+t}function jt(t,e){var n=t.listener,r=t.aa||t.src;return t.X&&Ct(t),n.call(r,e)}function Mt(t,e){if(t.V)return!0;if(wt)return jt(t,new It(e,this));if(!e)t:{e=["window","event"];for(var n=R,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return jt(t,e=new It(e,this))}function qt(t){return(t=t[Ot])instanceof xt?t:null}var Ft="__closure_events_fn_"+(1e9*Math.random()>>>0);function Bt(e){return"function"==D(e)?e:(e[Ft]||(e[Ft]=function(t){return e.handleEvent(t)}),e[Ft])}function Gt(){F.call(this),this.c=new xt(this),(this.J=this).A=null}function zt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.V&&a.capture==n&&(s=a.listener,u=a.aa||a.src,a.X&&Dt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}q(Gt,F),Gt.prototype[_t]=!0,(_=Gt.prototype).addEventListener=function(t,e,n,r){Lt(this,t,e,n,r)},_.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=O(i)?!!i.capture:!!i,r=Bt(r),e&&e[_t]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Pt(s=e.a[n],r,i,o))&&(Rt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&qt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Pt(n,r,i,o)),(r=-1<e?n[e]:null)&&Ct(r))}(this,t,e,n,r)},_.dispatchEvent=function(t){var e,n=this.A;if(n)for(e=[];n;n=n.A)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new Tt(t,n):t instanceof Tt?t.target=t.target||n:(s=t,nt(t=new Tt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=zt(o,r,!0,t)&&s;if(s=zt(o=t.a=n,r,!0,t)&&s,s=zt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=zt(o=t.a=e[i],r,!1,t)&&s;return s},_.C=function(){if(Gt.M.C.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Rt(n[r]);delete e.a[t],e.b--}}this.A=null},_.ra=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},_.sa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Wt=R.JSON.stringify;function Kt(){this.b=this.a=null}var Ht,Qt=(Yt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Yt(function(){return new Xt},function(t){t.reset()},100));function Yt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Xt(){this.next=this.b=this.a=null}function Jt(t){R.setTimeout(function(){throw t},0)}function $t(t,e){var n;Ht||(n=R.Promise.resolve(void 0),Ht=function(){n.then(ee)}),Zt||(Ht(),Zt=!0),te.add(t,e)}Kt.prototype.add=function(t,e){var n=Qt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Xt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Zt=!(Xt.prototype.reset=function(){this.next=this.b=this.a=null}),te=new Kt;function ee(){for(var t,e,n;n=e=void 0,n=null,(e=te).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){Jt(t)}var r=Qt;r.g(t),r.b<r.f&&(r.b++,t.next=r.a,r.a=t)}Zt=!1}function ne(t,e){Gt.call(this),this.b=t||1,this.a=e||R,this.f=U(this.Ua,this),this.g=M()}function re(t){t.Z=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function ie(t,e,n){if("function"==D(t))n&&(t=U(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=U(t.handleEvent,t)}return 2147483647<Number(e)?-1:R.setTimeout(t,e||0)}function oe(t,e,n){F.call(this),this.f=null!=n?U(t,n):t,this.c=e,this.b=U(this.Pa,this),this.a=[]}function se(t){t.T=ie(t.b,t.c),t.f.apply(null,t.a)}function ue(t){F.call(this),this.b=t,this.a={}}q(ne,Gt),(_=ne.prototype).Z=!1,_.L=null,_.Ua=function(){var t;this.Z&&(0<(t=M()-this.g)&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.Z&&(re(this),this.start())))},_.start=function(){this.Z=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=M())},_.C=function(){ne.M.C.call(this),re(this),delete this.a},q(oe,F),(_=oe.prototype).ba=!1,_.T=null,_.Ia=function(t){this.a=arguments,this.T?this.ba=!0:se(this)},_.C=function(){oe.M.C.call(this),this.T&&(R.clearTimeout(this.T),this.T=null,this.ba=!1,this.a=[])},_.Pa=function(){this.T=null,this.ba&&(this.ba=!1,se(this))},q(ue,F);var ae=[];function he(t,e,n,r){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var i=0;i<n.length;i++){var o=Lt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ce(t){Z(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ct(t)},t),t.a={}}function fe(){}ue.prototype.C=function(){ue.M.C.call(this),ce(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var le=null;function pe(){return le=le||new Gt}function de(t){Tt.call(this,"serverreachability",t)}function ye(){var t=pe();t.dispatchEvent(new de(t))}function ve(t){Tt.call(this,"statevent",t)}function ge(){var t=pe();t.dispatchEvent(new ve(t))}function me(t){Tt.call(this,"timingevent",t)}function we(t,e){if("function"!=D(t))throw Error("Fn must not be null and must be a function");return R.setTimeout(function(){t()},e)}q(de,Tt),q(ve,Tt),q(me,Tt);var be={NO_ERROR:0,Va:1,bb:2,ab:3,Ya:4,$a:5,cb:6,za:7,TIMEOUT:8,gb:9},Ee={Xa:"complete",kb:"success",Aa:"error",za:"abort",ib:"ready",jb:"readystatechange",TIMEOUT:"timeout",eb:"incrementaldata",hb:"progress",Za:"downloadprogress",lb:"uploadprogress"};function Te(){}function Ie(t){var e;return(e=t.a)||(e=t.a={}),e}function Ne(){}Te.prototype.a=null;var _e,Ae={OPEN:"a",Wa:"b",Aa:"c",fb:"d"};function Se(){Tt.call(this,"d")}function Re(){Tt.call(this,"c")}function xe(){}function De(t,e,n){this.g=t,this.W=e,this.U=n||1,this.G=new ue(this),this.N=Pe,t=ht?125:void 0,this.O=new ne(t),this.m=null,this.b=!1,this.j=this.A=this.f=this.B=this.s=this.P=this.h=null,this.i=[],this.a=null,this.w=0,this.c=this.v=null,this.H=-1,this.l=!1,this.J=0,this.D=null,this.o=this.R=this.F=!1}q(Se,Tt),q(Re,Tt),q(xe,Te),_e=new xe;var Pe=45e3,Oe={},ke={};function Le(t,e,n){t.B=1,t.f=en(Ye(e)),t.j=n,t.F=!0,Ve(t,null)}function Ve(t,e){t.s=M(),Ue(t),t.A=Ye(t.f);var n=t.A,r=t.U;Array.isArray(r)||(r=[String(r)]),yn(n.b,"t",r),t.w=0,t.a=sr(t.g,t.g.w?e:null),0<t.J&&(t.D=new oe(U(t.ya,t,t.a),t.J)),he(t.G,t.a,"readystatechange",t.Sa),e=t.m?tt(t.m):{},t.j?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.$(t.A,t.v,t.j,e)):(t.v="GET",t.a.$(t.A,t.v,null,e)),ye()}function Ce(t,e,n){for(var r,i,o,s,u=!0;!t.l&&t.w<n.length;){var a=(i=n,s=o=void 0,o=(r=t).w,-1==(s=i.indexOf("\n",o))?ke:(o=Number(i.substring(o,s)),isNaN(o)?Oe:(s+=1)+o>i.length?ke:(i=i.substr(s,o),r.w=s+o,i)));if(a==ke){4==e&&(t.c=4,ge(),u=!1);break}if(a==Oe){t.c=4,ge(),u=!1;break}Be(t,a)}4==e&&0==n.length&&(t.c=1,ge(),u=!1),t.b=t.b&&u,u||(Fe(t),qe(t))}function Ue(t){t.P=M()+t.N,je(t,t.N)}function je(t,e){if(null!=t.h)throw Error("WatchDog timer not null");t.h=we(U(t.Qa,t),e)}function Me(t){t.h&&(R.clearTimeout(t.h),t.h=null)}function qe(t){0==t.g.u||t.l||er(t.g,t)}function Fe(t){Me(t);var e=t.D;e&&"function"==typeof e.da&&e.da(),t.D=null,re(t.O),ce(t.G),t.a&&(e=t.a,t.a=null,e.abort(),e.da())}function Be(t,e){try{var n,r,i,o,s,u,a,h,c,f,l=t.g;if(0!=l.u&&(l.a==t||Tn(l.b,t)))if(l.A=t.H,!t.o&&Tn(l.b,t)&&3==l.u){try{var p=l.ja.a.parse(e)}catch(t){p=null}if(Array.isArray(p)&&3==p.length){var d=p;if(0==d[0]){t:if(!l.i){if(l.a){if(!(l.a.s+3e3<t.s))break t;tr(l),l.a.cancel(),l.a=null}Zn(l),ge()}}else l.ia=d[1],0<l.ia-l.G&&d[2]<37500&&l.U&&0==l.m&&!l.l&&(l.l=we(U(l.Na,l),6e3));if(En(l.b)<=1&&l.O){try{l.O()}catch(t){}l.O=void 0}}else rr(l,11)}else if(!t.o&&l.a!=t||tr(l),!K(e))for(e=p=l.ja.a.parse(e),p=0;p<e.length;p++){d=e[p],l.G=d[0],d=d[1],2==l.u?"c"==d[0]?(l.B=d[1],l.R=d[2],null!=(n=d[3])&&(l.oa=n),null!=(r=d[5])&&"number"==typeof r&&0<r&&(l.D=1.5*r),i=l,(o=t.a)&&(!(s=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(u=i.b).a&&(Y(s,"spdy")||Y(s,"quic")||Y(s,"h2"))&&(u.f=u.g,u.a=new Set,u.b&&(In(u,u.b),u.b=null)),!i.s||(a=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(i.ha=a,tn(i.v,i.s,a))),l.u=3,l.c&&l.c.na(),h=t,(i=l).ea=or(i,i.w?i.R:null,i.P),h.o?(Nn(i.b,h),c=h,(f=i.D)&&c.setTimeout(f),c.h&&(Me(c),Ue(c)),i.a=h):$n(i),0<l.f.length&&Qn(l)):"stop"!=d[0]&&"close"!=d[0]||rr(l,7):3==l.u&&("stop"==d[0]||"close"==d[0]?"stop"==d[0]?rr(l,7):Wn(l):"noop"!=d[0]&&l.c&&l.c.ma(d),l.m=0)}ye()}catch(t){}}function Ge(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(P(t)||"string"==typeof t)G(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.I&&"function"==typeof t.I)n=void 0;else if(P(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.I&&"function"==typeof t.I)return t.I();if("string"==typeof t)return t.split("");if(P(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function ze(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof ze)for(n=t.K(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function We(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ke(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Ke(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Ke(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(_=De.prototype).setTimeout=function(t){this.N=t},_.Sa=function(t){t=t.target;var e=this.D;e&&3==Fn(t)?e.Ia():this.ya(t)},_.ya=function(t){try{if(t==this.a)t:{var e=Fn(this.a),n=this.a.qa();this.a.S();if(!(e<3||3==e&&!ht&&!this.a.Y())){this.l||4!=e||7==n||ye(),Me(this);var r=this.a.S();this.H=r;var i=this.a.Y();if(this.b=200==r){if(this.R&&!this.o){e:{if(this.a){var o,s=this.a;if((o=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(o)){var u=o;break e}}u=null}if(!u){this.b=!1,this.c=3,ge(),Fe(this),qe(this);break t}this.o=!0,Be(this,u)}this.F?(Ce(this,e,i),ht&&this.b&&3==e&&(he(this.G,this.O,"tick",this.Ra),this.O.start())):Be(this,i),4==e&&Fe(this),this.b&&!this.l&&(4==e?er(this.g,this):(this.b=!1,Ue(this)))}else 400==r&&0<i.indexOf("Unknown SID")?this.c=3:this.c=0,ge(),Fe(this),qe(this)}}}catch(t){}},_.Ra=function(){var t,e;this.a&&(t=Fn(this.a),e=this.a.Y(),this.w<e.length&&(Me(this),Ce(this,t,e),this.b&&4!=t&&Ue(this)))},_.cancel=function(){this.l=!0,Fe(this)},_.Qa=function(){this.h=null;var t=M();0<=t-this.P?(2!=this.B&&(ye(),ge()),Fe(this),this.c=2,qe(this)):je(this,this.P-t)},(_=ze.prototype).I=function(){We(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},_.K=function(){return We(this),this.a.concat()},_.get=function(t,e){return Ke(this.b,t)?this.b[t]:e},_.set=function(t,e){Ke(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},_.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var He=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Qe(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Qe?(this.a=void 0!==e?e:t.a,Xe(this,t.f),this.j=t.j,Je(this,t.c),$e(this,t.h),this.g=t.g,e=t.b,(n=new fn).c=e.c,e.a&&(n.a=new ze(e.a),n.b=e.b),Ze(this,n),this.i=t.i):t&&(n=String(t).match(He))?(this.a=!!e,Xe(this,n[1]||"",!0),this.j=nn(n[2]||""),Je(this,n[3]||"",!0),$e(this,n[4]),this.g=nn(n[5]||"",!0),Ze(this,n[6]||"",!0),this.i=nn(n[7]||"")):(this.a=!!e,this.b=new fn(null,this.a))}function Ye(t){return new Qe(t)}function Xe(t,e,n){t.f=n?nn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Je(t,e,n){t.c=n?nn(e,!0):e}function $e(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ze(t,e,n){var r,i;e instanceof fn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(ln(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(pn(this,e),yn(this,n,t))},r)),r.f=i):(n||(e=rn(e,hn)),t.b=new fn(e,t.a))}function tn(t,e,n){t.b.set(e,n)}function en(t){return tn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^M()).toString(36)),t}function nn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function rn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,on),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function on(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Qe.prototype.toString=function(){var t=[],e=this.f;e&&t.push(rn(e,sn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(rn(e,sn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(rn(n,"/"==n.charAt(0)?an:un,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",rn(n,cn)),t.join("")};var sn=/[#\/\?@]/g,un=/[#\?:]/g,an=/[#\?]/g,hn=/[#\?@]/g,cn=/#/g;function fn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function ln(u){u.a||(u.a=new ze,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function pn(t,e){ln(t),e=vn(t,e),Ke(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ke((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&We(t)))}function dn(t,e){return ln(t),e=vn(t,e),Ke(t.a.b,e)}function yn(t,e,n){pn(t,e),0<n.length&&(t.c=null,t.a.set(vn(t,e),W(n)),t.b+=n.length)}function vn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function gn(t,e){this.b=t,this.a=e}function mn(t){this.g=t||wn,t=R.PerformanceNavigationTiming?0<(t=R.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(R.ca&&R.ca.ua&&R.ca.ua()&&R.ca.ua().mb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(_=fn.prototype).add=function(t,e){ln(this),this.c=null,t=vn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},_.forEach=function(n,r){ln(this),this.a.forEach(function(t,e){G(t,function(t){n.call(r,t,e,this)},this)},this)},_.K=function(){ln(this);for(var t=this.a.I(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},_.I=function(t){ln(this);var e=[];if("string"==typeof t)dn(this,t)&&(e=z(e,this.a.get(vn(this,t))));else{t=this.a.I();for(var n=0;n<t.length;n++)e=z(e,t[n])}return e},_.set=function(t,e){return ln(this),this.c=null,dn(this,t=vn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},_.get=function(t,e){return t&&0<(t=this.I(t)).length?String(t[0]):e},_.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.I(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var wn=10;function bn(t){return t.b||t.a&&t.a.size>=t.f}function En(t){return t.b?1:t.a?t.a.size:0}function Tn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function In(t,e){t.a?t.a.add(e):t.b=e}function Nn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function _n(t){var e,n;if(null!=t.b)return t.c.concat(t.b.i);if(null==t.a||0===t.a.size)return W(t.c);var r=t.c;try{for(var i=N(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.i)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function An(){}function Sn(){this.a=new An}function Rn(t,r,e){var i=e||"";try{Ge(t,function(t,e){var n=t;O(t)&&(n=Wt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}function xn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}mn.prototype.cancel=function(){var t,e;if(this.c=_n(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=N(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},An.prototype.stringify=function(t){return R.JSON.stringify(t,void 0)},An.prototype.parse=function(t){return R.JSON.parse(t,void 0)};var Dn=R.JSON.parse;function Pn(t){Gt.call(this),this.headers=new ze,this.G=t||null,this.b=!1,this.s=this.a=null,this.D="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.H=On,this.B=this.F=!1}q(Pn,Gt);var On="",kn=/^https?$/i,Ln=["POST","PUT"];function Vn(t){return"content-type"==t.toLowerCase()}function Cn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Un(t),Mn(t)}function Un(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function jn(t){if(t.b&&void 0!==S&&(!t.s[1]||4!=Fn(t)||2!=t.S()))if(t.l&&4==Fn(t))ie(t.va,0,t);else if(t.dispatchEvent("readystatechange"),4==Fn(t)){t.b=!1;try{var e,n,r,i,o=t.S();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.D).match(He)[1]||null)&&R.self&&R.self.location&&(i=(r=R.self.location.protocol).substr(0,r.length-1)),n=!kn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Fn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.S()+"]",Un(t)}}finally{Mn(t)}}}function Mn(t,e){if(t.a){qn(t);var n=t.a,r=t.s[0]?x:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function qn(t){t.a&&t.B&&(t.a.ontimeout=null),t.m&&(R.clearTimeout(t.m),t.m=null)}function Fn(t){return t.a?t.a.readyState:0}function Bn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Z(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):tn(t,e,n))}function Gn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function zn(t){this.f=[],this.R=this.ea=this.v=this.P=this.a=this.ha=this.s=this.N=this.h=this.F=this.j=null,this.Fa=this.H=0,this.Ca=Gn("failFast",!1,t),this.U=this.l=this.i=this.g=this.c=null,this.W=!0,this.A=this.ia=this.G=-1,this.J=this.m=this.o=0,this.Ba=Gn("baseRetryDelayMs",5e3,t),this.Ga=Gn("retryDelaySeedMs",1e4,t),this.Da=Gn("forwardChannelMaxRetries",2,t),this.ga=Gn("forwardChannelRequestTimeoutMs",2e4,t),this.Ea=t&&t.nb||void 0,this.D=void 0,this.w=t&&t.supportsCrossDomainXhr||!1,this.B="",this.b=new mn(t&&t.concurrentRequestLimit),this.ja=new Sn,this.fa=t&&t.fastHandshake||!1,t&&t.forceLongPolling&&(this.W=!1),this.O=void 0}function Wn(t){var e,n;Kn(t),3==t.u&&(e=t.H++,tn(n=Ye(t.v),"SID",t.B),tn(n,"RID",e),tn(n,"TYPE","terminate"),Xn(t,n),(e=new De(t,e,void 0)).B=2,e.f=en(Ye(n)),n=!1,R.navigator&&R.navigator.sendBeacon&&(n=R.navigator.sendBeacon(e.f.toString(),"")),!n&&R.Image&&((new Image).src=e.f,n=!0),n||(e.a=sr(e.g,null),e.a.$(e.f)),e.s=M(),Ue(e)),ir(t)}function Kn(t){t.a&&(t.a.cancel(),t.a=null),t.i&&(R.clearTimeout(t.i),t.i=null),tr(t),t.b.cancel(),t.g&&("number"==typeof t.g&&R.clearTimeout(t.g),t.g=null)}function Hn(t,e){t.f.push(new gn(t.Fa++,e)),3==t.u&&Qn(t)}function Qn(t){bn(t.b)||t.g||(t.g=!0,$t(t.xa,t),t.o=0)}function Yn(t,e){var n=e?e.W:t.H++,r=Ye(t.v);tn(r,"SID",t.B),tn(r,"RID",n),tn(r,"AID",t.G),Xn(t,r),t.h&&t.j&&Bn(r,t.h,t.j),n=new De(t,n,t.o+1),null===t.h&&(n.m=t.j),e&&(t.f=e.i.concat(t.f)),e=Jn(t,n,1e3),n.setTimeout(Math.round(.5*t.ga)+Math.round(.5*t.ga*Math.random())),In(t.b,n),Le(n,r,e)}function Xn(t,n){t.c&&Ge({},function(t,e){tn(n,e,t)})}function Jn(t,e,n){n=Math.min(t.f.length,n);var r=t.c?U(t.c.Ha,t.c,t):null;t:for(var i=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{Rn(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.f.splice(0,n),e.i=t,r}function $n(t){t.a||t.i||(t.J=1,$t(t.wa,t),t.m=0)}function Zn(t){return!(t.a||t.i||3<=t.m)&&(t.J++,t.i=we(U(t.wa,t),nr(t,t.m)),t.m++,1)}function tr(t){null!=t.l&&(R.clearTimeout(t.l),t.l=null)}function er(t,e){var n,r=null;if(t.a==e){tr(t),t.a=null;var i=2}else{if(!Tn(t.b,e))return;r=e.i,Nn(t.b,e),i=1}if(t.A=e.H,0!=t.u)if(e.b){1==i?(r=e.j?e.j.length:0,e=M()-e.s,n=t.o,(i=pe()).dispatchEvent(new me(i)),Qn(t)):$n(t)}else if(3==(n=e.c)||0==n&&0<t.A||!(1==i&&function(t,e){if(!(En(t.b)>=t.b.f-(t.g?1:0))){if(t.g)return t.f=e.i.concat(t.f),1;if(!(1==t.u||2==t.u||t.o>=(t.Ca?0:t.Da)))return t.g=we(U(t.xa,t,e),nr(t,t.o)),t.o++,1}}(t,e)||2==i&&Zn(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:rr(t,5);break;case 4:rr(t,10);break;case 3:rr(t,6);break;default:rr(t,2)}}function nr(t,e){var n=t.Ba+Math.floor(Math.random()*t.Ga);return t.c||(n*=2),n*e}function rr(t,e){var n,r,i,o,s,u;2==e?(n=null,t.c&&(n=null),r=U(t.Ta,t),n||(n=new Qe("//www.google.com/images/cleardot.gif"),R.location&&"http"==R.location.protocol||Xe(n,"https"),en(n)),i=n.toString(),o=r,u=new fe,R.Image?((s=new Image).onload=j(xn,u,s,"TestLoadImage: loaded",!0,o),s.onerror=j(xn,u,s,"TestLoadImage: error",!1,o),s.onabort=j(xn,u,s,"TestLoadImage: abort",!1,o),s.ontimeout=j(xn,u,s,"TestLoadImage: timeout",!1,o),R.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=i):o(!1)):ge(),t.u=0,t.c&&t.c.la(e),ir(t),Kn(t)}function ir(t){t.u=0,t.A=-1,t.c&&(0==_n(t.b).length&&0==t.f.length||(t.b.c.length=0,W(t.f),t.f.length=0),t.c.ka())}function or(t,e,n){var r,i,o,s,u,a,h,c=(r=n)instanceof Qe?Ye(r):new Qe(r,void 0);return""!=c.c?(e&&Je(c,e+"."+c.c),$e(c,c.h)):(o=(i=R.location).protocol,s=e?e+"."+i.hostname:i.hostname,u=+i.port,a=n,h=new Qe(null,void 0),o&&Xe(h,o),s&&Je(h,s),u&&$e(h,u),a&&(h.g=a),c=h),t.N&&Z(t.N,function(t,e){tn(c,e,t)}),e=t.s,n=t.ha,e&&n&&tn(c,e,n),tn(c,"VER",t.oa),Xn(t,c),c}function sr(t,e){if(e&&!t.w)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Pn(t.Ea)).F=t.w,e}function ur(){}function ar(){if(ut&&!(10<=Number(mt)))throw Error("Environmental error: no available transport.")}function hr(t,e){Gt.call(this),this.a=new zn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.j=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.pa&&(t?t["X-WebChannel-Client-Profile"]=e.pa:t={"X-WebChannel-Client-Profile":e.pa}),this.a.F=t,(t=e&&e.httpHeadersOverwriteParam)&&!K(t)&&(this.a.h=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!K(e)&&(this.a.s=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new lr(this)}function cr(t){Se.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function fr(){Re.call(this),this.status=1}function lr(t){this.a=t}(_=Pn.prototype).$=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.G?Ie(this.G):Ie(_e),this.a.onreadystatechange=U(this.va,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void Cn(this,t)}t=n||"";var i,o=new ze(this.headers);r&&Ge(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Vn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.K()),n=R.FormData&&t instanceof R.FormData,0<=B(Ln,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.H&&(this.a.responseType=this.H),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{qn(this),0<this.o&&((this.B=(i=this.a,ut&&gt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=U(this.ta,this)):this.m=ie(this.ta,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Cn(this,t)}},_.ta=function(){void 0!==S&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},_.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Mn(this))},_.C=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Mn(this,!0)),Pn.M.C.call(this)},_.va=function(){this.j||(this.w||this.l||this.g?jn(this):this.Oa())},_.Oa=function(){jn(this)},_.S=function(){try{return 2<Fn(this)?this.a.status:-1}catch(t){return-1}},_.Y=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},_.Ja=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Dn(e)}},_.qa=function(){return this.h},_.Ma=function(){return"string"==typeof this.f?this.f:String(this.f)},(_=zn.prototype).oa=8,_.u=1,_.xa=function(t){if(this.g)if(this.g=null,1==this.u){if(!t){this.H=Math.floor(1e5*Math.random()),t=this.H++;var e,n=new De(this,t,void 0),r=this.j;if(this.F&&(r?nt(r=tt(r),this.F):r=this.F),null===this.h&&(n.m=r),this.fa)t:{for(var i=e=0;i<this.f.length;i++){var o=this.f[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.f.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Jn(this,n,e),tn(i=Ye(this.v),"RID",t),tn(i,"CVER",22),this.s&&tn(i,"X-HTTP-Session-Id",this.s),Xn(this,i),this.h&&r&&Bn(i,this.h,r),In(this.b,n),this.fa?(tn(i,"$req",e),tn(i,"SID","null"),n.R=!0,Le(n,i,null)):Le(n,i,e),this.u=2}}else 3==this.u&&(t?Yn(this,t):0==this.f.length||bn(this.b)||Yn(this))},_.wa=function(){this.i=null,this.a=new De(this,"rpc",this.J),null===this.h&&(this.a.m=this.j),this.a.J=0;var t=Ye(this.ea);tn(t,"RID","rpc"),tn(t,"SID",this.B),tn(t,"CI",this.U?"0":"1"),tn(t,"AID",this.G),Xn(this,t),tn(t,"TYPE","xmlhttp"),this.h&&this.j&&Bn(t,this.h,this.j),this.D&&this.a.setTimeout(this.D);var e=this.a,n=this.R;e.B=1,e.f=en(Ye(t)),e.j=null,e.F=!0,Ve(e,n)},_.Na=function(){null!=this.l&&(this.l=null,this.a.cancel(),this.a=null,Zn(this),ge())},_.Ta=function(t){ge()},(_=ur.prototype).na=function(){},_.ma=function(){},_.la=function(){},_.ka=function(){},_.Ha=function(){},ar.prototype.a=function(t,e){return new hr(t,e)},q(hr,Gt),(_=hr.prototype).addEventListener=function(t,e,n,r){hr.M.addEventListener.call(this,t,e,n,r)},_.removeEventListener=function(t,e,n,r){hr.M.removeEventListener.call(this,t,e,n,r)},_.Ka=function(){this.a.c=this.f,this.h&&(this.a.w=!0);var t=this.a,e=this.l,n=this.b||void 0;ge(),t.P=e,t.N=n||{},t.U=t.W,t.v=or(t,null,t.P),Qn(t)},_.close=function(){Wn(this.a)},_.La=function(t){var e;"string"==typeof t?((e={}).__data__=t,Hn(this.a,e)):this.g?((e={}).__data__=Wt(t),Hn(this.a,e)):Hn(this.a,t)},_.C=function(){this.a.c=null,delete this.f,Wn(this.a),delete this.a,hr.M.C.call(this)},q(cr,Se),q(fr,Re),q(lr,ur),lr.prototype.na=function(){this.a.dispatchEvent("a")},lr.prototype.ma=function(t){this.a.dispatchEvent(new cr(t))},lr.prototype.la=function(t){this.a.dispatchEvent(new fr)},lr.prototype.ka=function(){this.a.dispatchEvent("b")},ar.prototype.createWebChannel=ar.prototype.a,hr.prototype.send=hr.prototype.La,hr.prototype.open=hr.prototype.Ka,hr.prototype.close=hr.prototype.close,be.NO_ERROR=0,be.TIMEOUT=8,be.HTTP_ERROR=6,Ee.COMPLETE="complete",(Ne.EventType=Ae).OPEN="a",Ae.CLOSE="b",Ae.ERROR="c",Ae.MESSAGE="d",Gt.prototype.listen=Gt.prototype.ra,Pn.prototype.listenOnce=Pn.prototype.sa,Pn.prototype.getLastError=Pn.prototype.Ma,Pn.prototype.getLastErrorCode=Pn.prototype.qa,Pn.prototype.getStatus=Pn.prototype.S,Pn.prototype.getResponseJson=Pn.prototype.Ja,Pn.prototype.getResponseText=Pn.prototype.Y,Pn.prototype.send=Pn.prototype.$;var pr={createWebChannelTransport:function(){return new ar},ErrorCode:be,EventType:Ee,WebChannel:Ne,XhrIo:Pn},dr=pr.createWebChannelTransport,yr=pr.ErrorCode,vr=pr.EventType,gr=pr.WebChannel,mr=pr.XhrIo,wr=pp.SDK_VERSION,br=(Er.prototype.t=function(){return null!=this.uid},Er.prototype.s=function(){return this.t()?"uid:"+this.uid:"anonymous-user"},Er.prototype.isEqual=function(t){return t.uid===this.uid},Er);function Er(t){this.uid=t}function Tr(t,e){this.user=e,this.type="OAuth",this.o={},this.o.Authorization="Bearer "+t}br.UNAUTHENTICATED=new br(null),br.i=new br("google-credentials-uid"),br.h=new br("first-party-uid");var Ir,Nr,_r={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ar=(n(Gr,Nr=Error),Gr),Sr=(Br.prototype.getToken=function(){return Promise.resolve(null)},Br.prototype._=function(){},Br.prototype.l=function(t){(this.u=t)(br.UNAUTHENTICATED)},Br.prototype.T=function(){this.u=null},Br),Rr=(Fr.prototype.getToken=function(){var e=this,n=this.A,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.A!==n?(Fs("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Ws("string"==typeof t.accessToken),new Tr(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Fr.prototype._=function(){this.forceRefresh=!0},Fr.prototype.l=function(t){this.u=t,this.R&&t(this.currentUser)},Fr.prototype.T=function(){this.auth&&this.auth.removeAuthTokenListener(this.I),this.I=null,this.u=null},Fr.prototype.m=function(){var t=this.auth&&this.auth.getUid();return Ws(null===t||"string"==typeof t),new br(t)},Fr),xr=(Object.defineProperty(qr.prototype,"o",{get:function(){var t={"X-Goog-AuthUser":this.V},e=this.P.auth.g([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),qr),Dr=(Mr.prototype.getToken=function(){return Promise.resolve(new xr(this.P,this.V))},Mr.prototype.l=function(t){t(br.h)},Mr.prototype.T=function(){},Mr.prototype._=function(){},Mr),Pr=(jr.now=function(){return jr.fromMillis(Date.now())},jr.fromDate=function(t){return jr.fromMillis(t.getTime())},jr.fromMillis=function(t){var e=Math.floor(t/1e3);return new jr(e,1e6*(t-1e3*e))},jr.prototype.toDate=function(){return new Date(this.toMillis())},jr.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},jr.prototype.p=function(t){return this.seconds===t.seconds?Qs(this.nanoseconds,t.nanoseconds):Qs(this.seconds,t.seconds)},jr.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},jr.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},jr.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},jr),Or=(Ur.v=function(t){return new Ur(t)},Ur.min=function(){return new Ur(new Pr(0,0))},Ur.prototype.S=function(t){return this.timestamp.p(t.timestamp)},Ur.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Ur.prototype.D=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Ur.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Ur.prototype.C=function(){return this.timestamp},Ur),kr=(Object.defineProperty(Cr.prototype,"length",{get:function(){return this.F},enumerable:!0,configurable:!0}),Cr.prototype.isEqual=function(t){return 0===Cr.N(this,t)},Cr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Cr?t.forEach(function(t){e.push(t)}):e.push(t),this.$(e)},Cr.prototype.limit=function(){return this.offset+this.length},Cr.prototype.k=function(t){return t=void 0===t?1:t,this.$(this.segments,this.offset+t,this.length-t)},Cr.prototype.M=function(){return this.$(this.segments,this.offset,this.length-1)},Cr.prototype.L=function(){return this.segments[this.offset]},Cr.prototype.O=function(){return this.get(this.length-1)},Cr.prototype.get=function(t){return this.segments[this.offset+t]},Cr.prototype.B=function(){return 0===this.length},Cr.prototype.q=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Cr.prototype.U=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Cr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Cr.prototype.W=function(){return this.segments.slice(this.offset,this.limit())},Cr.N=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Cr),Lr=(n(Vr,Ir=kr),Vr.prototype.$=function(t,e,n){return new Vr(t,e,n)},Vr.prototype.j=function(){return this.W().join("/")},Vr.prototype.toString=function(){return this.j()},Vr.K=function(t){if(0<=t.indexOf("//"))throw new Ar(_r.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new Vr(t.split("/").filter(function(t){return 0<t.length}))},Vr);function Vr(){return null!==Ir&&Ir.apply(this,arguments)||this}function Cr(t,e,n){void 0===e?e=0:e>t.length&&zs(),void 0===n?n=t.length-e:n>t.length-e&&zs(),this.segments=t,this.offset=e,this.F=n}function Ur(t){this.timestamp=t}function jr(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Ar(_r.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Ar(_r.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Ar(_r.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Ar(_r.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Mr(t,e){this.P=t,this.V=e}function qr(t,e){this.P=t,this.V=e,this.type="FirstParty",this.user=br.h}function Fr(t){var e=this;this.I=null,this.currentUser=br.UNAUTHENTICATED,this.R=!1,this.A=0,this.u=null,this.forceRefresh=!1,this.I=function(){e.A++,e.currentUser=e.m(),e.R=!0,e.u&&e.u(e.currentUser)},this.A=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.I):(this.I(null),t.get().then(function(t){e.auth=t,e.I&&e.auth.addAuthTokenListener(e.I)},function(){}))}function Br(){this.u=null}function Gr(t,e){var n=this;return(n=Nr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}Lr.G=new Lr([]);var zr,Wr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Kr=(n(Hr,zr=kr),Hr.prototype.$=function(t,e,n){return new Hr(t,e,n)},Hr.H=function(t){return Wr.test(t)},Hr.prototype.j=function(){return this.W().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),Hr.H(t)||(t="`"+t+"`"),t}).join(".")},Hr.prototype.toString=function(){return this.j()},Hr.prototype.Y=function(){return 1===this.length&&"__name__"===this.get(0)},Hr.J=function(){return new Hr(["__name__"])},Hr.X=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Ar(_r.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Ar(_r.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Ar(_r.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Ar(_r.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Hr(e)},Hr);function Hr(){return null!==zr&&zr.apply(this,arguments)||this}Kr.G=new Kr([]);var Qr=(Yr.Z=function(t){return new Yr(Lr.K(t).k(5))},Yr.prototype.tt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Yr.prototype.isEqual=function(t){return null!==t&&0===Lr.N(this.path,t.path)},Yr.prototype.toString=function(){return this.path.toString()},Yr.N=function(t,e){return Lr.N(t.path,e.path)},Yr.et=function(t){return t.length%2==0},Yr.st=function(t){return new Yr(new Lr(t.slice()))},Yr);function Yr(t){this.path=t}function Xr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Jr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function $r(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}Qr.EMPTY=new Qr(new Lr([]));var Zr=(ti.fromBase64String=function(t){return new ti(Us.nt().atob(t))},ti.fromUint8Array=function(t){return new ti(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},ti.prototype.toBase64=function(){return Us.nt().btoa(this.it)},ti.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.it)},ti.prototype.rt=function(){return 2*this.it.length},ti.prototype.S=function(t){return Qs(this.it,t.it)},ti.prototype.isEqual=function(t){return this.it===t.it},ti);function ti(t){this.it=t}function ei(t){return null==t}function ni(t){return-0===t&&1/t==-1/0}function ri(t){return"number"==typeof t&&Number.isInteger(t)&&!ni(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function ii(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function oi(t){var e=pi(t.mapValue.fields.__local_write_time__.timestampValue);return new Pr(e.seconds,e.nanos)}Zr.ht=new Zr("");var si=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ui(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ii(t)?4:10:zs()}function ai(r,i){var t,e,n,o=ui(r);if(o!==ui(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return oi(r).isEqual(oi(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=pi(r.timestampValue),n=pi(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return n=i,yi(r.bytesValue).isEqual(yi(n.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,di((t=r).geoPointValue.latitude)===di(e.geoPointValue.latitude)&&di(t.geoPointValue.longitude)===di(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return di(t.integerValue)===di(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=di(t.doubleValue),r=di(e.doubleValue);return n===r?ni(n)===ni(r):isNaN(n)&&isNaN(r)}return!1}(r,i);case 9:return Ys(r.arrayValue.values||[],i.arrayValue.values||[],ai);case 10:return function(){var t=r.mapValue.fields||{},e=i.mapValue.fields||{};if(Xr(t)!==Xr(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!ai(t[n],e[n])))return!1;return!0}();default:return zs()}}function hi(t,e){return void 0!==(t.values||[]).find(function(t){return ai(t,e)})}function ci(t,e){var n,r,i,o,s,u,a,h,c,f,l=ui(t),p=ui(e);if(l!==p)return Qs(l,p);switch(l){case 0:return 0;case 1:return Qs(t.booleanValue,e.booleanValue);case 2:return h=e,(c=di(t.integerValue||t.doubleValue))<(f=di(h.integerValue||h.doubleValue))?-1:f<c?1:c===f?0:isNaN(c)?isNaN(f)?0:-1:1;case 3:return fi(t.timestampValue,e.timestampValue);case 4:return fi(oi(t),oi(e));case 5:return Qs(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=yi(o),a=yi(s),u.S(a);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Qs(n[i],r[i]);if(0!==o)return o}return Qs(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=Qs(di(n.latitude),di(r.latitude)))?i:Qs(di(n.longitude),di(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=ci(n[i],r[i]);if(o)return o}return Qs(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Qs(r[s],o[s]);if(0!==u)return u;var a=ci(n[r[s]],i[o[s]]);if(0!==a)return a}return Qs(r.length,o.length)}(t.mapValue,e.mapValue);default:throw zs()}}function fi(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Qs(t,e);var n=pi(t),r=pi(e),i=Qs(n.seconds,r.seconds);return 0!==i?i:Qs(n.nanos,r.nanos)}function li(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=pi(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?yi(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,Qr.Z(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):zs();var t,e,n}(t)}function pi(t){if(Ws(!!t),"string"!=typeof t)return{seconds:di(t.seconds),nanos:di(t.nanos)};var e,n=0,r=si.exec(t);Ws(!!r),r[1]&&(e=((e=r[1])+"000000000").substr(0,9),n=Number(e));var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:n}}function di(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function yi(t){return"string"==typeof t?Zr.fromBase64String(t):Zr.fromUint8Array(t)}function vi(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.j()}}function gi(t){return t&&"integerValue"in t}function mi(t){return!!t&&"arrayValue"in t}function wi(t){return t&&"nullValue"in t}function bi(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ei(t){return t&&"mapValue"in t}var Ti=(Ii.prototype.ot=function(t,e){return n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},t&&(n.fields.__previous_value__=t),{mapValue:n};var n},Ii.prototype.at=function(t,e){return e},Ii.prototype.ut=function(t){return null},Ii.prototype.isEqual=function(t){return t instanceof Ii},Ii);function Ii(){}Ti.instance=new Ti;var Ni=(xi.prototype.ot=function(t,e){return this.apply(t)},xi.prototype.at=function(t,e){return this.apply(t)},xi.prototype.apply=function(t){for(var n=Di(t),e=function(e){n.some(function(t){return ai(t,e)})||n.push(e)},r=0,i=this.elements;r<i.length;r++)e(i[r]);return{arrayValue:{values:n}}},xi.prototype.ut=function(t){return null},xi.prototype.isEqual=function(t){return t instanceof xi&&Ys(this.elements,t.elements,ai)},xi),_i=(Ri.prototype.ot=function(t,e){return this.apply(t)},Ri.prototype.at=function(t,e){return this.apply(t)},Ri.prototype.apply=function(t){for(var n=Di(t),e=function(e){n=n.filter(function(t){return!ai(t,e)})},r=0,i=this.elements;r<i.length;r++)e(i[r]);return{arrayValue:{values:n}}},Ri.prototype.ut=function(t){return null},Ri.prototype.isEqual=function(t){return t instanceof Ri&&Ys(this.elements,t.elements,ai)},Ri),Ai=(Si.prototype.ot=function(t,e){var n=this.ut(t),r=this.asNumber(n)+this.asNumber(this.ct);return gi(n)&&gi(this.ct)?this.serializer._t(r):this.serializer.lt(r)},Si.prototype.at=function(t,e){return e},Si.prototype.ut=function(t){return gi(e=t)||e&&"doubleValue"in e?t:{integerValue:0};var e},Si.prototype.isEqual=function(t){return t instanceof Si&&ai(this.ct,t.ct)},Si.prototype.asNumber=function(t){return di(t.integerValue||t.doubleValue)},Si);function Si(t,e){this.serializer=t,this.ct=e}function Ri(t){this.elements=t}function xi(t){this.elements=t}function Di(t){return mi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Pi(t,e){this.version=t,this.transformResults=e}var Oi,ki,Li,Vi,Ci,Ui=(io.prototype.dt=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].q(t))return!0;return!1},io.prototype.isEqual=function(t){return Ys(this.fields,t.fields,function(t,e){return t.isEqual(e)})},io),ji=(ro.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},ro),Mi=(no.ft=function(){return new no},no.exists=function(t){return new no(void 0,t)},no.updateTime=function(t){return new no(t)},Object.defineProperty(no.prototype,"Tt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),no.prototype.Et=function(t){return void 0!==this.updateTime?t instanceof bo&&t.version.isEqual(this.updateTime):void 0===this.exists||this.exists===t instanceof bo},no.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},no),qi=(eo.prototype.It=function(t){},eo.wt=function(t){return t instanceof bo?t.version:Or.min()},eo),Fi=(n(to,Ci=qi),to.prototype.at=function(t,e){this.It(t);var n=e.version;return new bo(this.key,n,this.value,{hasCommittedMutations:!0})},to.prototype.ot=function(t,e,n){if(this.It(t),!this.Rt.Et(t))return t;var r=qi.wt(t);return new bo(this.key,r,this.value,{At:!0})},to.prototype.Pt=function(t){return null},to.prototype.isEqual=function(t){return t instanceof to&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.Rt.isEqual(t.Rt)},to),Bi=(n(Zi,Vi=qi),Zi.prototype.at=function(t,e){if(this.It(t),!this.Rt.Et(t))return new To(this.key,e.version);var n=this.gt(t);return new bo(this.key,e.version,n,{hasCommittedMutations:!0})},Zi.prototype.ot=function(t,e,n){if(this.It(t),!this.Rt.Et(t))return t;var r=qi.wt(t),i=this.gt(t);return new bo(this.key,r,i,{At:!0})},Zi.prototype.Pt=function(t){return null},Zi.prototype.isEqual=function(t){return t instanceof Zi&&this.key.isEqual(t.key)&&this.Vt.isEqual(t.Vt)&&this.Rt.isEqual(t.Rt)},Zi.prototype.gt=function(t){var e=t instanceof bo?t.data():Ki.empty();return this.pt(e)},Zi.prototype.pt=function(t){var n=this,r=new Hi(t);return this.Vt.fields.forEach(function(t){var e;t.B()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.yt()},Zi),Gi=(n($i,Li=qi),$i.prototype.at=function(t,e){if(this.It(t),Ws(null!=e.transformResults),!this.Rt.Et(t))return new To(this.key,e.version);var n=this.bt(t),r=this.vt(t,e.transformResults),i=e.version,o=this.St(n.data(),r);return new bo(this.key,i,o,{hasCommittedMutations:!0})},$i.prototype.ot=function(t,e,n){if(this.It(t),!this.Rt.Et(t))return t;var r=this.bt(t),i=this.Dt(n,t,e),o=this.St(r.data(),i);return new bo(this.key,r.version,o,{At:!0})},$i.prototype.Pt=function(t){for(var e=null,n=0,r=this.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof bo?t.field(i.field):void 0,s=i.transform.ut(o||null);null!=s&&(e=null==e?(new Hi).set(i.field,s):e.set(i.field,s))}return e?e.yt():null},$i.prototype.isEqual=function(t){return t instanceof $i&&this.key.isEqual(t.key)&&Ys(this.fieldTransforms,t.fieldTransforms,function(t,e){return t.isEqual(e)})&&this.Rt.isEqual(t.Rt)},$i.prototype.bt=function(t){return t},$i.prototype.vt=function(t,e){var n=[];Ws(this.fieldTransforms.length===e.length);for(var r=0;r<e.length;r++){var i=this.fieldTransforms[r],o=i.transform,s=null;t instanceof bo&&(s=t.field(i.field)),n.push(o.at(s,e[r]))}return n},$i.prototype.Dt=function(t,e,n){for(var r=[],i=0,o=this.fieldTransforms;i<o.length;i++){var s=o[i],u=s.transform,a=null;e instanceof bo&&(a=e.field(s.field)),null===a&&n instanceof bo&&(a=n.field(s.field)),r.push(u.ot(a,t))}return r},$i.prototype.St=function(t,e){for(var n=new Hi(t),r=0;r<this.fieldTransforms.length;r++){var i=this.fieldTransforms[r].field;n.set(i,e[r])}return n.yt()},$i),zi=(n(Ji,ki=qi),Ji.prototype.at=function(t,e){return this.It(t),new Eo(this.key,e.version,{hasCommittedMutations:!0})},Ji.prototype.ot=function(t,e,n){return this.It(t),this.Rt.Et(t)?new Eo(this.key,Or.min()):t},Ji.prototype.Pt=function(t){return null},Ji.prototype.isEqual=function(t){return t instanceof Ji&&this.key.isEqual(t.key)&&this.Rt.isEqual(t.Rt)},Ji),Wi=(n(Xi,Oi=qi),Xi.prototype.at=function(t,e){zs()},Xi.prototype.ot=function(t,e,n){zs()},Xi.prototype.Pt=function(t){zs()},Xi.prototype.isEqual=function(t){return t instanceof Xi&&this.key.isEqual(t.key)&&this.Rt.isEqual(t.Rt)},Xi),Ki=(Yi.empty=function(){return new Yi({mapValue:{}})},Yi.prototype.field=function(t){if(t.B())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Ei(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.O()])||null},Yi.prototype.isEqual=function(t){return ai(this.proto,t.proto)},Yi),Hi=(Qi.prototype.set=function(t,e){return this.Nt(t,e),this},Qi.prototype.delete=function(t){return this.Nt(t,null),this},Qi.prototype.Nt=function(t,e){for(var n=this.Ft,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map||(o=o&&10===ui(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),n=o}n.set(t.O(),e)},Qi.prototype.yt=function(){var t=this.$t(Kr.G,this.Ft);return null!=t?new Ki(t):this.Ct},Qi.prototype.$t=function(r,t){var i=this,o=!1,e=this.Ct.field(r),s=Ei(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.$t(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Qi);function Qi(t){void 0===t&&(t=Ki.empty()),this.Ct=t,this.Ft=new Map}function Yi(t){this.proto=t}function Xi(t,e){var n=this;return(n=Oi.call(this)||this).key=t,n.Rt=e,n.type=4,n}function Ji(t,e){var n=this;return(n=ki.call(this)||this).key=t,n.Rt=e,n.type=3,n}function $i(t,e){var n=this;return(n=Li.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Rt=Mi.exists(!0),n}function Zi(t,e,n,r){var i=this;return(i=Vi.call(this)||this).key=t,i.data=e,i.Vt=n,i.Rt=r,i.type=1,i}function to(t,e,n){var r=this;return(r=Ci.call(this)||this).key=t,r.value=e,r.Rt=n,r.type=0,r}function eo(){}function no(t,e){this.updateTime=t,this.exists=e}function ro(t,e){this.field=t,this.transform=e}function io(t){(this.fields=t).sort(Kr.N)}function oo(t){var u=[];return Jr(t.fields||{},function(t,e){var n=new Kr([t]);if(Ei(e)){var r=oo(e.mapValue).fields;if(0===r.length)u.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];u.push(n.child(s))}}else u.push(n)}),new Ui(u)}function so(t,e){this.key=t,this.version=e}function uo(t){this.count=t}var ao,ho,co,fo,lo,po,yo,vo,go,mo,wo,bo=(n(Ho,wo=so),Ho.prototype.field=function(t){return this.kt.field(t)},Ho.prototype.data=function(){return this.kt},Ho.prototype.Mt=function(){return this.kt.proto},Ho.prototype.isEqual=function(t){return t instanceof Ho&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.At===t.At&&this.hasCommittedMutations===t.hasCommittedMutations&&this.kt.isEqual(t.kt)},Ho.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.kt.toString()+", {hasLocalMutations: "+this.At+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Ho.prototype,"hasPendingWrites",{get:function(){return this.At||this.hasCommittedMutations},enumerable:!0,configurable:!0}),Ho),Eo=(n(Ko,mo=so),Ko.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Ko.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),Ko.prototype.isEqual=function(t){return t instanceof Ko&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Ko),To=(n(Wo,go=so),Wo.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Wo.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),Wo.prototype.isEqual=function(t){return t instanceof Wo&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Wo),Io=(zo.prototype.canonicalId=function(){var t;return null===this.xt&&(t=this.path.j(),null!==this.collectionGroup&&(t+="|cg:"+this.collectionGroup),t+="|f:",t+=this.filters.map(function(t){return t.canonicalId()}).join(","),t+="|ob:",t+=this.orderBy.map(function(t){return t.canonicalId()}).join(","),ei(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.xt=t),this.xt},zo.prototype.toString=function(){var t=this.path.j();return null!==this.collectionGroup&&(t+=" collectionGroup="+this.collectionGroup),0<this.filters.length&&(t+=", filters: ["+this.filters.join(", ")+"]"),ei(this.limit)||(t+=", limit: "+this.limit),0<this.orderBy.length&&(t+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),"Target("+t+")"},zo.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(var n=0;n<this.filters.length;n++)if(!this.filters[n].isEqual(t.filters[n]))return!1;return this.collectionGroup===t.collectionGroup&&!!this.path.isEqual(t.path)&&!!(null!==this.startAt?this.startAt.isEqual(t.startAt):null===t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)},zo.prototype.Lt=function(){return Qr.et(this.path)&&null===this.collectionGroup&&0===this.filters.length},zo),No=(Go.Wt=function(t){return new Go(t)},Object.defineProperty(Go.prototype,"orderBy",{get:function(){if(null===this.qt){this.qt=[];var t=this.jt(),e=this.Kt();if(null!==t&&null===e)t.Y()||this.qt.push(new Oo(t)),this.qt.push(new Oo(Kr.J(),"asc"));else{for(var n,r=!1,i=0,o=this.Ot;i<o.length;i++){var s=o[i];this.qt.push(s),s.field.Y()&&(r=!0)}r||(n=0<this.Ot.length?this.Ot[this.Ot.length-1].dir:"asc",this.qt.push(new Oo(Kr.J(),n)))}}return this.qt},enumerable:!0,configurable:!0}),Go.prototype.Gt=function(t){var e=this.filters.concat([t]);return new Go(this.path,this.collectionGroup,this.Ot.slice(),e,this.limit,this.Bt,this.startAt,this.endAt)},Go.prototype.zt=function(t){var e=this.Ot.concat([t]);return new Go(this.path,this.collectionGroup,e,this.filters.slice(),this.limit,this.Bt,this.startAt,this.endAt)},Go.prototype.Ht=function(t){return new Go(this.path,this.collectionGroup,this.Ot.slice(),this.filters.slice(),t,"F",this.startAt,this.endAt)},Go.prototype.Yt=function(t){return new Go(this.path,this.collectionGroup,this.Ot.slice(),this.filters.slice(),t,"L",this.startAt,this.endAt)},Go.prototype.Jt=function(t){return new Go(this.path,this.collectionGroup,this.Ot.slice(),this.filters.slice(),this.limit,this.Bt,t,this.endAt)},Go.prototype.Xt=function(t){return new Go(this.path,this.collectionGroup,this.Ot.slice(),this.filters.slice(),this.limit,this.Bt,this.startAt,t)},Go.prototype.Zt=function(t){return new Go(t,null,this.Ot.slice(),this.filters.slice(),this.limit,this.Bt,this.startAt,this.endAt)},Go.prototype.te=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.Ot.length||1===this.Ot.length&&this.Ot[0].field.Y())},Go.prototype.canonicalId=function(){return this.ee().canonicalId()+"|lt:"+this.Bt},Go.prototype.toString=function(){return"Query(target="+this.ee().toString()+"; limitType="+this.Bt+")"},Go.prototype.isEqual=function(t){return this.ee().isEqual(t.ee())&&this.Bt===t.Bt},Go.prototype.se=function(t,e){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],s=o.compare(t,e);if(0!==s)return s;n=n||o.field.Y()}return 0},Go.prototype.matches=function(t){return this.ie(t)&&this.ne(t)&&this.re(t)&&this.he(t)},Go.prototype.oe=function(){return!ei(this.limit)&&"F"===this.Bt},Go.prototype.ae=function(){return!ei(this.limit)&&"L"===this.Bt},Go.prototype.Kt=function(){return 0<this.Ot.length?this.Ot[0].field:null},Go.prototype.jt=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof _o&&n.ue())return n.field}return null},Go.prototype.ce=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(r instanceof _o&&0<=t.indexOf(r.op))return r.op}return null},Go.prototype.Lt=function(){return this.ee().Lt()},Go.prototype._e=function(){return null!==this.collectionGroup},Go.prototype.ee=function(){if(!this.Ut)if("F"===this.Bt)this.Ut=new Io(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var r=n[e],i="desc"===r.dir?"asc":"desc";t.push(new Oo(r.field,i))}var o=this.endAt?new Po(this.endAt.position,!this.endAt.before):null,s=this.startAt?new Po(this.startAt.position,!this.startAt.before):null;this.Ut=new Io(this.path,this.collectionGroup,t,this.filters,this.limit,o,s)}return this.Ut},Go.prototype.ie=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.tt(this.collectionGroup)&&this.path.q(e):Qr.et(this.path)?this.path.isEqual(e):this.path.U(e)},Go.prototype.ne=function(t){for(var e=0,n=this.Ot;e<n.length;e++){var r=n[e];if(!r.field.Y()&&null===t.field(r.field))return!1}return!0},Go.prototype.re=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},Go.prototype.he=function(t){return!(this.startAt&&!this.startAt.le(this.orderBy,t)||this.endAt&&this.endAt.le(this.orderBy,t))},Go.prototype.Qt=function(t){},Go),_o=(n(Bo,vo=function(){}),Bo.create=function(t,e,n){if(t.Y())return"in"===e?new So(t,n):new Ao(t,e,n);if(wi(n)){if("=="!==e)throw new Ar(_r.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new Bo(t,e,n)}if(bi(n)){if("=="!==e)throw new Ar(_r.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new Bo(t,e,n)}return"array-contains"===e?new Ro(t,n):"in"===e?new xo(t,n):"array-contains-any"===e?new Do(t,n):new Bo(t,e,n)},Bo.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&ui(this.value)===ui(e)&&this.de(ci(e,this.value))},Bo.prototype.de=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return 0<t;case">=":return 0<=t;default:return zs()}},Bo.prototype.ue=function(){return 0<=["<","<=",">",">="].indexOf(this.op)},Bo.prototype.canonicalId=function(){return this.field.j()+this.op.toString()+li(this.value)},Bo.prototype.isEqual=function(t){return t instanceof Bo&&this.op===t.op&&this.field.isEqual(t.field)&&ai(this.value,t.value)},Bo.prototype.toString=function(){return this.field.j()+" "+this.op+" "+li(this.value)},Bo),Ao=(n(Fo,yo=_o),Fo.prototype.matches=function(t){var e=Qr.N(t.key,this.key);return this.de(e)},Fo),So=(n(qo,po=_o),qo.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},qo),Ro=(n(Mo,lo=_o),Mo.prototype.matches=function(t){var e=t.field(this.field);return mi(e)&&hi(e.arrayValue,this.value)},Mo),xo=(n(jo,fo=_o),jo.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&hi(this.value.arrayValue,e)},jo),Do=(n(Uo,co=_o),Uo.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!mi(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return hi(e.value.arrayValue,t)})},Uo),Po=(Co.prototype.canonicalId=function(){return(this.before?"b":"a")+":"+this.position.map(li).join(",")},Co.prototype.le=function(t,e){for(var n=0,r=0;r<this.position.length;r++){var i=t[r],o=this.position[r],n=i.field.Y()?Qr.N(Qr.Z(o.referenceValue),e.key):ci(o,e.field(i.field));if("desc"===i.dir&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},Co.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++)if(!ai(this.position[e],t.position[e]))return!1;return!0},Co),Oo=(Vo.prototype.compare=function(t,e){var n,r,i,o,s=this.fe?Qr.N(t.key,e.key):(n=this.field,r=e,i=t.field(n),o=r.field(n),null!==i&&null!==o?ci(i,o):zs());switch(this.dir){case"asc":return s;case"desc":return-1*s;default:return zs()}},Vo.prototype.canonicalId=function(){return this.field.j()+this.dir.toString()},Vo.prototype.toString=function(){return this.field.j()+" ("+this.dir+")"},Vo.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},Vo),ko=(Lo.prototype.Ie=function(t){return new Lo(this.target,this.targetId,this.Te,t,this.Ee,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Lo.prototype.we=function(t,e){return new Lo(this.target,this.targetId,this.Te,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Lo.prototype.Re=function(t){return new Lo(this.target,this.targetId,this.Te,this.sequenceNumber,this.Ee,t,this.resumeToken)},Lo);function Lo(t,e,n,r,i,o,s){void 0===i&&(i=Or.min()),void 0===o&&(o=Or.min()),void 0===s&&(s=Zr.ht),this.target=t,this.targetId=e,this.Te=n,this.sequenceNumber=r,this.Ee=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Vo(t,e){this.field=t,void 0===e&&(e="asc"),this.dir=e,this.fe=t.Y()}function Co(t,e){this.position=t,this.before=e}function Uo(t,e){return co.call(this,t,"array-contains-any",e)||this}function jo(t,e){return fo.call(this,t,"in",e)||this}function Mo(t,e){return lo.call(this,t,"array-contains",e)||this}function qo(t,e){var n=this;return(n=po.call(this,t,"in",e)||this).keys=(e.arrayValue.values||[]).map(function(t){return Qr.Z(t.referenceValue)}),n}function Fo(t,e,n){var r=this;return(r=yo.call(this,t,e,n)||this).key=Qr.Z(n.referenceValue),r}function Bo(t,e,n){var r=this;return(r=vo.call(this)||this).field=t,r.op=e,r.value=n,r}function Go(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.Ot=n,this.filters=r,this.limit=i,this.Bt=o,this.startAt=s,this.endAt=u,this.qt=null,this.Ut=null,this.startAt&&this.Qt(this.startAt),this.endAt&&this.Qt(this.endAt)}function zo(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.xt=null}function Wo(){return null!==go&&go.apply(this,arguments)||this}function Ko(t,e,n){var r=this;return(r=mo.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Ho(t,e,n,r){var i=this;return(i=wo.call(this,t,e)||this).kt=n,i.At=!!r.At,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Qo(t){switch(t){case _r.OK:return zs();case _r.CANCELLED:case _r.UNKNOWN:case _r.DEADLINE_EXCEEDED:case _r.RESOURCE_EXHAUSTED:case _r.INTERNAL:case _r.UNAVAILABLE:case _r.UNAUTHENTICATED:return;case _r.INVALID_ARGUMENT:case _r.NOT_FOUND:case _r.ALREADY_EXISTS:case _r.PERMISSION_DENIED:case _r.FAILED_PRECONDITION:case _r.ABORTED:case _r.OUT_OF_RANGE:case _r.UNIMPLEMENTED:case _r.DATA_LOSS:return 1;default:return zs()}}function Yo(t){if(void 0===t)return Bs("GRPC error has no .code"),_r.UNKNOWN;switch(t){case ao.OK:return _r.OK;case ao.CANCELLED:return _r.CANCELLED;case ao.UNKNOWN:return _r.UNKNOWN;case ao.DEADLINE_EXCEEDED:return _r.DEADLINE_EXCEEDED;case ao.RESOURCE_EXHAUSTED:return _r.RESOURCE_EXHAUSTED;case ao.INTERNAL:return _r.INTERNAL;case ao.UNAVAILABLE:return _r.UNAVAILABLE;case ao.UNAUTHENTICATED:return _r.UNAUTHENTICATED;case ao.INVALID_ARGUMENT:return _r.INVALID_ARGUMENT;case ao.NOT_FOUND:return _r.NOT_FOUND;case ao.ALREADY_EXISTS:return _r.ALREADY_EXISTS;case ao.PERMISSION_DENIED:return _r.PERMISSION_DENIED;case ao.FAILED_PRECONDITION:return _r.FAILED_PRECONDITION;case ao.ABORTED:return _r.ABORTED;case ao.OUT_OF_RANGE:return _r.OUT_OF_RANGE;case ao.UNIMPLEMENTED:return _r.UNIMPLEMENTED;case ao.DATA_LOSS:return _r.DATA_LOSS;default:return zs()}}(ho=ao=ao||{})[ho.OK=0]="OK",ho[ho.CANCELLED=1]="CANCELLED",ho[ho.UNKNOWN=2]="UNKNOWN",ho[ho.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ho[ho.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ho[ho.NOT_FOUND=5]="NOT_FOUND",ho[ho.ALREADY_EXISTS=6]="ALREADY_EXISTS",ho[ho.PERMISSION_DENIED=7]="PERMISSION_DENIED",ho[ho.UNAUTHENTICATED=16]="UNAUTHENTICATED",ho[ho.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ho[ho.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ho[ho.ABORTED=10]="ABORTED",ho[ho.OUT_OF_RANGE=11]="OUT_OF_RANGE",ho[ho.UNIMPLEMENTED=12]="UNIMPLEMENTED",ho[ho.INTERNAL=13]="INTERNAL",ho[ho.UNAVAILABLE=14]="UNAVAILABLE",ho[ho.DATA_LOSS=15]="DATA_LOSS";var Xo=(es.prototype.Ae=function(t,e){return new es(this.N,this.root.Ae(t,e,this.N).me(null,null,$o.Pe,null,null))},es.prototype.remove=function(t){return new es(this.N,this.root.remove(t,this.N).me(null,null,$o.Pe,null,null))},es.prototype.get=function(t){for(var e=this.root;!e.B();){var n=this.N(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},es.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.B();){var r=this.N(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},es.prototype.B=function(){return this.root.B()},Object.defineProperty(es.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),es.prototype.Ve=function(){return this.root.Ve()},es.prototype.ge=function(){return this.root.ge()},es.prototype.pe=function(t){return this.root.pe(t)},es.prototype.forEach=function(n){this.pe(function(t,e){return n(t,e),!1})},es.prototype.toString=function(){var n=[];return this.pe(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},es.prototype.ye=function(t){return this.root.ye(t)},es.prototype.be=function(){return new Jo(this.root,null,this.N,!1)},es.prototype.ve=function(t){return new Jo(this.root,t,this.N,!1)},es.prototype.Se=function(){return new Jo(this.root,null,this.N,!0)},es.prototype.De=function(t){return new Jo(this.root,t,this.N,!0)},es),Jo=(ts.prototype.Ne=function(){var t=this.Fe.pop(),e={key:t.key,value:t.value};if(this.Ce)for(t=t.left;!t.B();)this.Fe.push(t),t=t.right;else for(t=t.right;!t.B();)this.Fe.push(t),t=t.left;return e},ts.prototype.$e=function(){return 0<this.Fe.length},ts.prototype.ke=function(){if(0===this.Fe.length)return null;var t=this.Fe[this.Fe.length-1];return{key:t.key,value:t.value}},ts),$o=(Zo.prototype.me=function(t,e,n,r,i){return new Zo(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Zo.prototype.B=function(){return!1},Zo.prototype.pe=function(t){return this.left.pe(t)||t(this.key,this.value)||this.right.pe(t)},Zo.prototype.ye=function(t){return this.right.ye(t)||t(this.key,this.value)||this.left.ye(t)},Zo.prototype.min=function(){return this.left.B()?this:this.left.min()},Zo.prototype.Ve=function(){return this.min().key},Zo.prototype.ge=function(){return this.right.B()?this.key:this.right.ge()},Zo.prototype.Ae=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.me(null,null,null,r.left.Ae(t,e,n),null):0===i?r.me(null,e,null,null,null):r.me(null,null,null,null,r.right.Ae(t,e,n))).Me()},Zo.prototype.xe=function(){if(this.left.B())return Zo.EMPTY;var t=this;return t.left.Le()||t.left.left.Le()||(t=t.Oe()),(t=t.me(null,null,null,t.left.xe(),null)).Me()},Zo.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.B()||r.left.Le()||r.left.left.Le()||(r=r.Oe()),r=r.me(null,null,null,r.left.remove(t,e),null);else{if(r.left.Le()&&(r=r.Be()),r.right.B()||r.right.Le()||r.right.left.Le()||(r=r.qe()),0===e(t,r.key)){if(r.right.B())return Zo.EMPTY;n=r.right.min(),r=r.me(n.key,n.value,null,null,r.right.xe())}r=r.me(null,null,null,null,r.right.remove(t,e))}return r.Me()},Zo.prototype.Le=function(){return this.color},Zo.prototype.Me=function(){var t=this;return t.right.Le()&&!t.left.Le()&&(t=t.Ue()),t.left.Le()&&t.left.left.Le()&&(t=t.Be()),t.left.Le()&&t.right.Le()&&(t=t.Qe()),t},Zo.prototype.Oe=function(){var t=this.Qe();return t.right.left.Le()&&(t=(t=(t=t.me(null,null,null,null,t.right.Be())).Ue()).Qe()),t},Zo.prototype.qe=function(){var t=this.Qe();return t.left.left.Le()&&(t=(t=t.Be()).Qe()),t},Zo.prototype.Ue=function(){var t=this.me(null,null,Zo.RED,null,this.right.left);return this.right.me(null,null,this.color,t,null)},Zo.prototype.Be=function(){var t=this.me(null,null,Zo.RED,this.left.right,null);return this.left.me(null,null,this.color,null,t)},Zo.prototype.Qe=function(){var t=this.left.me(null,null,!this.left.color,null,null),e=this.right.me(null,null,!this.right.color,null,null);return this.me(null,null,!this.color,t,e)},Zo.prototype.We=function(){var t=this.je();return Math.pow(2,t)<=this.size+1},Zo.prototype.je=function(){if(this.Le()&&this.left.Le())throw zs();if(this.right.Le())throw zs();var t=this.left.je();if(t!==this.right.je())throw zs();return t+(this.Le()?0:1)},Zo);function Zo(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Zo.RED,this.left=null!=r?r:Zo.EMPTY,this.right=null!=i?i:Zo.EMPTY,this.size=this.left.size+1+this.right.size}function ts(t,e,n,r){this.Ce=r,this.Fe=[];for(var i=1;!t.B();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Ce?t.left:t.right;else{if(0===i){this.Fe.push(t);break}this.Fe.push(t),t=this.Ce?t.right:t.left}}function es(t,e){this.N=t,this.root=e||$o.EMPTY}function ns(){this.size=0}$o.EMPTY=null,$o.RED=!0,$o.Pe=!1,$o.EMPTY=(Object.defineProperty(ns.prototype,"key",{get:function(){throw zs()},enumerable:!0,configurable:!0}),Object.defineProperty(ns.prototype,"value",{get:function(){throw zs()},enumerable:!0,configurable:!0}),Object.defineProperty(ns.prototype,"color",{get:function(){throw zs()},enumerable:!0,configurable:!0}),Object.defineProperty(ns.prototype,"left",{get:function(){throw zs()},enumerable:!0,configurable:!0}),Object.defineProperty(ns.prototype,"right",{get:function(){throw zs()},enumerable:!0,configurable:!0}),ns.prototype.me=function(t,e,n,r,i){return this},ns.prototype.Ae=function(t,e,n){return new $o(t,e)},ns.prototype.remove=function(t,e){return this},ns.prototype.B=function(){return!0},ns.prototype.pe=function(t){return!1},ns.prototype.ye=function(t){return!1},ns.prototype.Ve=function(){return null},ns.prototype.ge=function(){return null},ns.prototype.Le=function(){return!1},ns.prototype.We=function(){return!0},ns.prototype.je=function(){return 0},new ns);var rs=(us.prototype.has=function(t){return null!==this.data.get(t)},us.prototype.first=function(){return this.data.Ve()},us.prototype.last=function(){return this.data.ge()},Object.defineProperty(us.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),us.prototype.indexOf=function(t){return this.data.indexOf(t)},us.prototype.forEach=function(n){this.data.pe(function(t,e){return n(t),!1})},us.prototype.Ke=function(t,e){for(var n=this.data.ve(t[0]);n.$e();){var r=n.Ne();if(0<=this.N(r.key,t[1]))return;e(r.key)}},us.prototype.Ge=function(t,e){for(var n=void 0!==e?this.data.ve(e):this.data.be();n.$e();)if(!t(n.Ne().key))return},us.prototype.ze=function(t){var e=this.data.ve(t);return e.$e()?e.Ne().key:null},us.prototype.be=function(){return new is(this.data.be())},us.prototype.ve=function(t){return new is(this.data.ve(t))},us.prototype.add=function(t){return this.me(this.data.remove(t).Ae(t,!0))},us.prototype.delete=function(t){return this.has(t)?this.me(this.data.remove(t)):this},us.prototype.B=function(){return this.data.B()},us.prototype.He=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},us.prototype.isEqual=function(t){if(!(t instanceof us))return!1;if(this.size!==t.size)return!1;for(var e=this.data.be(),n=t.data.be();e.$e();){var r=e.Ne().key,i=n.Ne().key;if(0!==this.N(r,i))return!1}return!0},us.prototype.W=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},us.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},us.prototype.me=function(t){var e=new us(this.N);return e.data=t,e},us),is=(ss.prototype.Ne=function(){return this.Ye.Ne().key},ss.prototype.$e=function(){return this.Ye.$e()},ss),os=new Xo(Qr.N);function ss(t){this.Ye=t}function us(t){this.N=t,this.data=new Xo(this.N)}var as=new Xo(Qr.N);var hs=new Xo(Qr.N),cs=new rs(Qr.N);function fs(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=cs,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var ls=new rs(Qs);function ps(t,e,n,r){this.ws=t,this.removedTargetIds=e,this.key=n,this.Rs=r}function ds(t,e){this.targetId=t,this.As=e}function ys(t,e,n,r){void 0===n&&(n=Zr.ht),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}var vs=(xs.Ze=function(t){return new xs(t.N)},xs.prototype.has=function(t){return null!=this.Je.get(t)},xs.prototype.get=function(t){return this.Je.get(t)},xs.prototype.first=function(){return this.Xe.Ve()},xs.prototype.last=function(){return this.Xe.ge()},xs.prototype.B=function(){return this.Xe.B()},xs.prototype.indexOf=function(t){var e=this.Je.get(t);return e?this.Xe.indexOf(e):-1},Object.defineProperty(xs.prototype,"size",{get:function(){return this.Xe.size},enumerable:!0,configurable:!0}),xs.prototype.forEach=function(n){this.Xe.pe(function(t,e){return n(t),!1})},xs.prototype.add=function(t){var e=this.delete(t.key);return e.me(e.Je.Ae(t.key,t),e.Xe.Ae(t,null))},xs.prototype.delete=function(t){var e=this.get(t);return e?this.me(this.Je.remove(t),this.Xe.remove(e)):this},xs.prototype.isEqual=function(t){if(!(t instanceof xs))return!1;if(this.size!==t.size)return!1;for(var e=this.Xe.be(),n=t.Xe.be();e.$e();){var r=e.Ne().key,i=n.Ne().key;if(!r.isEqual(i))return!1}return!0},xs.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},xs.prototype.me=function(t,e){var n=new xs;return n.N=this.N,n.Je=t,n.Xe=e,n},xs),gs=(Rs.prototype.track=function(t){var e=t.doc.key,n=this.ts.get(e);!n||0!==t.type&&3===n.type?this.ts=this.ts.Ae(e,t):3===t.type&&1!==n.type?this.ts=this.ts.Ae(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ts=this.ts.Ae(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ts=this.ts.Ae(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ts=this.ts.remove(e):1===t.type&&2===n.type?this.ts=this.ts.Ae(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ts=this.ts.Ae(e,{type:2,doc:t.doc}):zs()},Rs.prototype.es=function(){var n=[];return this.ts.pe(function(t,e){n.push(e)}),n},Rs),ms=(Ss.os=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Ss(t,e,vs.Ze(e),i,n,r,!0,!1)},Object.defineProperty(Ss.prototype,"hasPendingWrites",{get:function(){return!this.ns.B()},enumerable:!0,configurable:!0}),Ss.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.rs===t.rs&&this.ns.isEqual(t.ns)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.ss.isEqual(t.ss)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Ss),ws=(As.ls=function(t,e){var n=new Map;return n.set(t,bs.ds(t,e)),new As(Or.min(),n,ls,os,fs())},As),bs=(_s.ds=function(t,e){return new _s(Zr.ht,e,fs(),fs(),fs())},_s),Es=(Object.defineProperty(Ns.prototype,"fs",{get:function(){return this.gs},enumerable:!0,configurable:!0}),Object.defineProperty(Ns.prototype,"resumeToken",{get:function(){return this.Vs},enumerable:!0,configurable:!0}),Object.defineProperty(Ns.prototype,"ys",{get:function(){return 0!==this.ms},enumerable:!0,configurable:!0}),Object.defineProperty(Ns.prototype,"bs",{get:function(){return this.ps},enumerable:!0,configurable:!0}),Ns.prototype.vs=function(t){0<t.rt()&&(this.ps=!0,this.Vs=t)},Ns.prototype.Ss=function(){var n=fs(),r=fs(),i=fs();return this.Ps.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:zs()}}),new bs(this.Vs,this.gs,n,r,i)},Ns.prototype.Ds=function(){this.ps=!1,this.Ps=Ps()},Ns.prototype.Cs=function(t,e){this.ps=!0,this.Ps=this.Ps.Ae(t,e)},Ns.prototype.Fs=function(t){this.ps=!0,this.Ps=this.Ps.remove(t)},Ns.prototype.Ns=function(){this.ms+=1},Ns.prototype.$s=function(){--this.ms},Ns.prototype.ks=function(){this.ps=!0,this.gs=!0},Ns),Ts=(Is.prototype.qs=function(t){for(var e=0,n=t.ws;e<n.length;e++){var r=n[e];t.Rs instanceof bo?this.Us(r,t.Rs):t.Rs instanceof Eo&&this.Qs(r,t.key,t.Rs)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.Qs(s,t.key,t.Rs)}},Is.prototype.Ws=function(n){var r=this;this.js(n,function(t){var e=r.Ks(t);switch(n.state){case 0:r.Gs(t)&&e.vs(n.resumeToken);break;case 1:e.$s(),e.ys||e.Ds(),e.vs(n.resumeToken);break;case 2:e.$s(),e.ys||r.removeTarget(t);break;case 3:r.Gs(t)&&(e.ks(),e.vs(n.resumeToken));break;case 4:r.Gs(t)&&(r.zs(t),e.vs(n.resumeToken));break;default:zs()}})},Is.prototype.js=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.xs.forEach(function(t,e){r.Gs(e)&&n(e)})},Is.prototype.Hs=function(t){var e,n,r=t.targetId,i=t.As.count,o=this.Ys(r);o&&((e=o.target).Lt()?0===i?(n=new Qr(e.path),this.Qs(r,n,new Eo(n,Or.min()))):Ws(1===i):this.Js(r)!==i&&(this.zs(r),this.Bs=this.Bs.add(r)))},Is.prototype.Xs=function(i){var o=this,s=new Map;this.xs.forEach(function(t,e){var n,r=o.Ys(e);r&&(t.fs&&r.target.Lt()&&(n=new Qr(r.target.path),null!==o.Ls.get(n)||o.Zs(e,n)||o.Qs(e,n,new Eo(n,i))),t.bs&&(s.set(e,t.Ss()),t.Ds()))});var r=fs();this.Os.forEach(function(t,e){var n=!0;e.Ge(function(t){var e=o.Ys(t);return!e||2===e.Te||(n=!1)}),n&&(r=r.add(t))});var t=new ws(i,s,this.Bs,this.Ls,r);return this.Ls=os,this.Os=Ds(),this.Bs=new rs(Qs),t},Is.prototype.Us=function(t,e){var n;this.Gs(t)&&(n=this.Zs(t,e.key)?2:0,this.Ks(t).Cs(e.key,n),this.Ls=this.Ls.Ae(e.key,e),this.Os=this.Os.Ae(e.key,this.ti(e.key).add(t)))},Is.prototype.Qs=function(t,e,n){var r;this.Gs(t)&&(r=this.Ks(t),this.Zs(t,e)?r.Cs(e,1):r.Fs(e),this.Os=this.Os.Ae(e,this.ti(e).delete(t)),n&&(this.Ls=this.Ls.Ae(e,n)))},Is.prototype.removeTarget=function(t){this.xs.delete(t)},Is.prototype.Js=function(t){var e=this.Ks(t).Ss();return this.Ms.ei(t).size+e.Ts.size-e.Is.size},Is.prototype.Ns=function(t){this.Ks(t).Ns()},Is.prototype.Ks=function(t){var e=this.xs.get(t);return e||(e=new Es,this.xs.set(t,e)),e},Is.prototype.ti=function(t){var e=this.Os.get(t);return e||(e=new rs(Qs),this.Os=this.Os.Ae(t,e)),e},Is.prototype.Gs=function(t){var e=null!==this.Ys(t);return e||Fs("WatchChangeAggregator","Detected inactive target",t),e},Is.prototype.Ys=function(t){var e=this.xs.get(t);return e&&e.ys?null:this.Ms.si(t)},Is.prototype.zs=function(e){var n=this;this.xs.set(e,new Es),this.Ms.ei(e).forEach(function(t){n.Qs(e,t,null)})},Is.prototype.Zs=function(t,e){return this.Ms.ei(t).has(e)},Is);function Is(t){this.Ms=t,this.xs=new Map,this.Ls=os,this.Os=Ds(),this.Bs=new rs(Qs)}function Ns(){this.ms=0,this.Ps=Ps(),this.Vs=Zr.ht,this.gs=!1,this.ps=!0}function _s(t,e,n,r,i){this.resumeToken=t,this.fs=e,this.Ts=n,this.Es=r,this.Is=i}function As(t,e,n,r,i){this.Ee=t,this.as=e,this.us=n,this.cs=r,this._s=i}function Ss(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.ss=n,this.docChanges=r,this.ns=i,this.fromCache=o,this.rs=s,this.hs=u}function Rs(){this.ts=new Xo(Qr.N)}function xs(n){this.N=n?function(t,e){return n(t,e)||Qr.N(t.key,e.key)}:function(t,e){return Qr.N(t.key,e.key)},this.Je=as,this.Xe=new Xo(this.N)}function Ds(){return new Xo(Qr.N)}function Ps(){return new Xo(Qr.N)}var Os={asc:"ASCENDING",desc:"DESCENDING"},ks={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ls=(Vs.prototype.ni=function(t){var e=void 0===t.code?_r.UNKNOWN:Yo(t.code);return new Ar(e,t.message||"")},Vs.prototype.ri=function(t){return this.options.hi||ei(t)?t:{value:t}},Vs.prototype.oi=function(t){var e;return ei(e="object"==typeof t?t.value:t)?null:e},Vs.prototype._t=function(t){return{integerValue:""+t}},Vs.prototype.lt=function(t){if(this.options.hi){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ni(t)?"-0":t}},Vs.prototype.ai=function(t){return ri(t)?this._t(t):this.lt(t)},Vs.prototype.C=function(t){return this.options.hi?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}},Vs.prototype.v=function(t){var e=pi(t);return new Pr(e.seconds,e.nanos)},Vs.prototype.ui=function(t){return this.options.hi?t.toBase64():t.toUint8Array()},Vs.prototype.ci=function(t){return this.options.hi?(Ws(void 0===t||"string"==typeof t),Zr.fromBase64String(t||"")):(Ws(void 0===t||t instanceof Uint8Array),Zr.fromUint8Array(t||new Uint8Array))},Vs.prototype.toVersion=function(t){return this.C(t.C())},Vs.prototype.fromVersion=function(t){return Ws(!!t),Or.v(this.v(t))},Vs.prototype._i=function(t,e){return this.li(e||this.ii).child("documents").child(t).j()},Vs.prototype.di=function(t){var e=Lr.K(t);return Ws(Cs(e)),e},Vs.prototype.fi=function(t){return this._i(t.path)},Vs.prototype.Z=function(t){var e=this.di(t);return Ws(e.get(1)===this.ii.projectId),Ws(!e.get(3)&&!this.ii.database||e.get(3)===this.ii.database),new Qr(this.Ti(e))},Vs.prototype.Ei=function(t){return this._i(t)},Vs.prototype.Ii=function(t){var e=this.di(t);return 4===e.length?Lr.G:this.Ti(e)},Object.defineProperty(Vs.prototype,"wi",{get:function(){return new Lr(["projects",this.ii.projectId,"databases",this.ii.database]).j()},enumerable:!0,configurable:!0}),Vs.prototype.li=function(t){return new Lr(["projects",t.projectId,"databases",t.database])},Vs.prototype.Ti=function(t){return Ws(4<t.length&&"documents"===t.get(4)),t.k(5)},Vs.prototype.Ri=function(t,e){return{name:this.fi(t),fields:e.proto.mapValue.fields}},Vs.prototype.Ai=function(t){return{name:this.fi(t.key),fields:t.Mt().mapValue.fields,updateTime:this.C(t.version.C())}},Vs.prototype.mi=function(t,e){var n=this.Z(t.name),r=this.fromVersion(t.updateTime),i=new Ki({mapValue:{fields:t.fields}});return new bo(n,r,i,{hasCommittedMutations:!!e})},Vs.prototype.Pi=function(t){Ws(!!t.found),t.found.name,t.found.updateTime;var e=this.Z(t.found.name),n=this.fromVersion(t.found.updateTime),r=new Ki({mapValue:{fields:t.found.fields}});return new bo(e,n,r,{})},Vs.prototype.Vi=function(t){Ws(!!t.missing),Ws(!!t.readTime);var e=this.Z(t.missing),n=this.fromVersion(t.readTime);return new Eo(e,n)},Vs.prototype.gi=function(t){return"found"in t?this.Pi(t):"missing"in t?this.Vi(t):zs()},Vs.prototype.pi=function(t){if("targetChange"in t){t.targetChange;var e=this.yi(t.targetChange.targetChangeType||"NO_CHANGE"),n=t.targetChange.targetIds||[],r=this.ci(t.targetChange.resumeToken),i=t.targetChange.cause,o=new ys(e,n,r,i&&this.ni(i)||null)}else if("documentChange"in t){t.documentChange;var s=t.documentChange;s.document,s.document.name,s.document.updateTime;var u=this.Z(s.document.name),a=this.fromVersion(s.document.updateTime),h=new Ki({mapValue:{fields:s.document.fields}}),c=new bo(u,a,h,{});o=new ps(s.targetIds||[],s.removedTargetIds||[],c.key,c)}else if("documentDelete"in t){t.documentDelete;var f=t.documentDelete;f.document;var l=this.Z(f.document),p=f.readTime?this.fromVersion(f.readTime):Or.min(),d=new Eo(l,p);o=new ps([],f.removedTargetIds||[],d.key,d)}else if("documentRemove"in t){t.documentRemove;var y=t.documentRemove;y.document;var v=this.Z(y.document);o=new ps([],y.removedTargetIds||[],v,null)}else{if(!("filter"in t))return zs();t.filter;var g=t.filter;g.targetId;var m=new uo(g.count||0);o=new ds(g.targetId,m)}return o},Vs.prototype.yi=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:zs()},Vs.prototype.bi=function(t){if(!("targetChange"in t))return Or.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Or.min():this.fromVersion(e.readTime)},Vs.prototype.vi=function(t){var e,n=this;if(t instanceof Fi)e={update:this.Ri(t.key,t.value)};else if(t instanceof zi)e={delete:this.fi(t.key)};else if(t instanceof Bi)e={update:this.Ri(t.key,t.data),updateMask:this.Si(t.Vt)};else if(t instanceof Gi)e={transform:{document:this.fi(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.Di(t)})}};else{if(!(t instanceof Wi))return zs();e={verify:this.fi(t.key)}}return t.Rt.Tt||(e.currentDocument=this.Ci(t.Rt)),e},Vs.prototype.Fi=function(t){var e=this,n=t.currentDocument?this.Ni(t.currentDocument):Mi.ft();if(t.update){t.update.name;var r=this.Z(t.update.name),i=new Ki({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=this.$i(t.updateMask);return new Bi(r,i,o,n)}return new Fi(r,i,n)}if(t.delete){var s=this.Z(t.delete);return new zi(s,n)}if(t.transform){var u=this.Z(t.transform.document),a=t.transform.fieldTransforms.map(function(t){return e.ki(t)});return Ws(!0===n.exists),new Gi(u,a)}if(t.verify){var h=this.Z(t.verify);return new Wi(h,n)}return zs()},Vs.prototype.Ci=function(t){return void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:zs()},Vs.prototype.Ni=function(t){return void 0!==t.updateTime?Mi.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?Mi.exists(t.exists):Mi.ft()},Vs.prototype.Mi=function(t,e){var n=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e);n.isEqual(Or.min())&&(n=this.fromVersion(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new Pi(n,r)},Vs.prototype.xi=function(t,e){var n=this;return t&&0<t.length?(Ws(void 0!==e),t.map(function(t){return n.Mi(t,e)})):[]},Vs.prototype.Di=function(t){var e=t.transform;if(e instanceof Ti)return{fieldPath:t.field.j(),setToServerValue:"REQUEST_TIME"};if(e instanceof Ni)return{fieldPath:t.field.j(),appendMissingElements:{values:e.elements}};if(e instanceof _i)return{fieldPath:t.field.j(),removeAllFromArray:{values:e.elements}};if(e instanceof Ai)return{fieldPath:t.field.j(),increment:e.ct};throw zs()},Vs.prototype.ki=function(t){var e,n,r=null;"setToServerValue"in t?(Ws("REQUEST_TIME"===t.setToServerValue),r=Ti.instance):"appendMissingElements"in t?(e=t.appendMissingElements.values||[],r=new Ni(e)):"removeAllFromArray"in t?(n=t.removeAllFromArray.values||[],r=new _i(n)):"increment"in t?r=new Ai(this,t.increment):zs();var i=Kr.X(t.fieldPath);return new ji(i,r)},Vs.prototype.Li=function(t){return{documents:[this.Ei(t.path)]}},Vs.prototype.Oi=function(t){Ws(1===t.documents.length);var e=t.documents[0];return No.Wt(this.Ii(e)).ee()},Vs.prototype.Bi=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(e.parent=this.Ei(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=this.Ei(n.M()),e.structuredQuery.from=[{collectionId:n.O()}]);var r=this.qi(t.filters);r&&(e.structuredQuery.where=r);var i=this.Ui(t.orderBy);i&&(e.structuredQuery.orderBy=i);var o=this.ri(t.limit);return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.Qi(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.Qi(t.endAt)),e},Vs.prototype.Wi=function(t){var e,n=this.Ii(t.parent),r=t.structuredQuery,i=r.from?r.from.length:0,o=null;0<i&&(Ws(1===i),(e=r.from[0]).allDescendants?o=e.collectionId:n=n.child(e.collectionId));var s=[];r.where&&(s=this.ji(r.where));var u=[];r.orderBy&&(u=this.Ki(r.orderBy));var a=null;r.limit&&(a=this.oi(r.limit));var h=null;r.startAt&&(h=this.Gi(r.startAt));var c=null;return r.endAt&&(c=this.Gi(r.endAt)),new No(n,o,u,s,a,"F",h,c).ee()},Vs.prototype.zi=function(t){var e=this.Hi(t.Te);return null==e?null:{"goog-listen-tags":e}},Vs.prototype.Hi=function(t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return zs()}},Vs.prototype.ee=function(t){var e,n=t.target;return(e=n.Lt()?{documents:this.Li(n)}:{query:this.Bi(n)}).targetId=t.targetId,0<t.resumeToken.rt()&&(e.resumeToken=this.ui(t.resumeToken)),e},Vs.prototype.qi=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof _o?e.Yi(t):zs()});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},Vs.prototype.ji=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.Ji(t)]:void 0!==t.fieldFilter?[this.Xi(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.ji(t)}).reduce(function(t,e){return t.concat(e)}):zs():[]},Vs.prototype.Ui=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.Zi(t)})},Vs.prototype.Ki=function(t){var e=this;return t.map(function(t){return e.tn(t)})},Vs.prototype.Qi=function(t){return{before:t.before,values:t.position}},Vs.prototype.Gi=function(t){var e=!!t.before,n=t.values||[];return new Po(n,e)},Vs.prototype.en=function(t){return Os[t]},Vs.prototype.sn=function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}},Vs.prototype.nn=function(t){return ks[t]},Vs.prototype.rn=function(t){switch(t){case"EQUAL":return"==";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return zs()}},Vs.prototype.hn=function(t){return{fieldPath:t.j()}},Vs.prototype.on=function(t){return Kr.X(t.fieldPath)},Vs.prototype.Zi=function(t){return{field:this.hn(t.field),direction:this.en(t.dir)}},Vs.prototype.tn=function(t){return new Oo(this.on(t.field),this.sn(t.direction))},Vs.prototype.Xi=function(t){return _o.create(this.on(t.fieldFilter.field),this.rn(t.fieldFilter.op),t.fieldFilter.value)},Vs.prototype.Yi=function(t){if("=="===t.op){if(bi(t.value))return{unaryFilter:{field:this.hn(t.field),op:"IS_NAN"}};if(wi(t.value))return{unaryFilter:{field:this.hn(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.hn(t.field),op:this.nn(t.op),value:t.value}}},Vs.prototype.Ji=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.on(t.unaryFilter.field);return _o.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=this.on(t.unaryFilter.field);return _o.create(n,"==",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return zs()}},Vs.prototype.Si=function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.j())}),{fieldPaths:e}},Vs.prototype.$i=function(t){var e=t.fieldPaths||[];return new Ui(e.map(function(t){return Kr.X(t)}))},Vs);function Vs(t,e){this.ii=t,this.options=e}function Cs(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var Us=(Ms.an=function(t){Ms.platform&&zs(),Ms.platform=t},Ms.nt=function(){return Ms.platform||zs(),Ms.platform},Ms),js=new h("@firebase/firestore");function Ms(){}function qs(){return js.logLevel}function Fs(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];js.logLevel<=p.DEBUG&&(e=n.map(Gs),js.debug.apply(js,d(["Firestore ("+wr+"): "+t],e)))}function Bs(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];js.logLevel<=p.ERROR&&(e=n.map(Gs),js.error.apply(js,d(["Firestore ("+wr+"): "+t],e)))}function Gs(t){if("string"==typeof t)return t;var e=Us.nt();try{return e.un(t)}catch(e){return t}}function zs(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+wr+") INTERNAL ASSERTION FAILED: "+t;throw Bs(e),new Error(e)}function Ws(t){t||zs()}var Ks=(Hs.cn=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Us.nt()._n(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Hs);function Hs(){}function Qs(t,e){return t<e?-1:e<t?1:0}function Ys(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Xs(t){return t+"\0"}function Js(t,e,n,r,i){this.ii=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var $s=(Object.defineProperty(mu.prototype,"ln",{get:function(){return"(default)"===this.database},enumerable:!0,configurable:!0}),mu.prototype.isEqual=function(t){return t instanceof mu&&t.projectId===this.projectId&&t.database===this.database},mu.prototype.S=function(t){return Qs(this.projectId,t.projectId)||Qs(this.database,t.database)},mu),Zs=(gu.prototype.get=function(t){var e=this.dn(t),n=this.fn[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(s.isEqual(t))return u}},gu.prototype.has=function(t){return void 0!==this.get(t)},gu.prototype.set=function(t,e){var n=this.dn(t),r=this.fn[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(t))return void(r[i]=[t,e]);r.push([t,e])}else this.fn[n]=[[t,e]]},gu.prototype.delete=function(t){var e=this.dn(t),n=this.fn[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(t))return 1===n.length?delete this.fn[e]:n.splice(r,1),!0;return!1},gu.prototype.forEach=function(u){Jr(this.fn,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];u(o,s)}})},gu.prototype.B=function(){return $r(this.fn)},gu),tu=(vu.prototype.at=function(t,e,n){for(var r=n.En,i=0;i<this.mutations.length;i++){var o,s=this.mutations[i];s.key.isEqual(t)&&(o=r[i],e=s.at(e,o))}return e},vu.prototype.ot=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=i.ot(e,e,this.Tn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=a.ot(e,o,this.Tn))}return e},vu.prototype.In=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ot(t.key,n.get(t.key));e&&(i=i.Ae(t.key,e))}),i},vu.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},fs())},vu.prototype.isEqual=function(t){return this.batchId===t.batchId&&Ys(this.mutations,t.mutations,function(t,e){return t.isEqual(e)})&&Ys(this.baseMutations,t.baseMutations,function(t,e){return t.isEqual(e)})},vu),eu=(yu.from=function(t,e,n){Ws(t.mutations.length===n.length);for(var r=hs,i=t.mutations,o=0;o<i.length;o++)r=r.Ae(i[o].key,n[o].version);return new yu(t,e,n,r)},yu),nu=(du.prototype.catch=function(t){return this.next(void 0,t)},du.prototype.next=function(r,i){var o=this;return this.Vn&&zs(),this.Vn=!0,this.Pn?this.error?this.gn(i,this.error):this.pn(r,this.result):new du(function(e,n){o.An=function(t){o.pn(r,t).next(e,n)},o.mn=function(t){o.gn(i,t).next(e,n)}})},du.prototype.yn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},du.prototype.bn=function(t){try{var e=t();return e instanceof du?e:du.resolve(e)}catch(t){return du.reject(t)}},du.prototype.pn=function(t,e){return t?this.bn(function(){return t(e)}):du.resolve(e)},du.prototype.gn=function(t,e){return t?this.bn(function(){return t(e)}):du.reject(e)},du.resolve=function(n){return new du(function(t,e){t(n)})},du.reject=function(n){return new du(function(t,e){e(n)})},du.vn=function(t){return new du(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},du.Sn=function(t){for(var n=du.resolve(!1),e=function(e){n=n.next(function(t){return t?du.resolve(t):e()})},r=0,i=t;r<i.length;r++)e(i[r]);return n},du.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.vn(i)},du),ru=(Object.defineProperty(pu.prototype,"readTime",{get:function(){return this.Fn},set:function(t){this.Fn=t},enumerable:!0,configurable:!0}),pu.prototype.Nn=function(t,e){this.$n(),this.readTime=e,this.Dn.set(t.key,t)},pu.prototype.kn=function(t,e){this.$n(),e&&(this.readTime=e),this.Dn.set(t,null)},pu.prototype.Mn=function(t,e){this.$n();var n=this.Dn.get(e);return void 0!==n?nu.resolve(n):this.xn(t,e)},pu.prototype.getEntries=function(t,e){return this.Ln(t,e)},pu.prototype.apply=function(t){return this.$n(),this.Cn=!0,this.On(t)},pu.prototype.$n=function(){},pu),iu="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ou=(lu.prototype.qn=function(t){this.Bn.push(t)},lu.prototype.Un=function(){this.Bn.forEach(function(t){return t()})},lu),su=(fu.prototype.Kn=function(e,n){var r=this;return this.Wn.Gn(e,n).next(function(t){return r.zn(e,n,t)})},fu.prototype.zn=function(t,r,i){return this.Qn.Mn(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ot(r,t);return t})},fu.prototype.Hn=function(t,e,i){var o=os;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ot(t,e);o=o.Ae(t,e)}),o},fu.prototype.Yn=function(e,t){var n=this;return this.Qn.getEntries(e,t).next(function(t){return n.Jn(e,t)})},fu.prototype.Jn=function(r,i){var o=this;return this.Wn.Xn(r,i).next(function(t){var e=o.Hn(r,i,t),n=os;return e.forEach(function(t,e){e=e||new Eo(t,Or.min()),n=n.Ae(t,e)}),n})},fu.prototype.Zn=function(t,e,n){return e.Lt()?this.tr(t,e.path):e._e()?this.er(t,e,n):this.sr(t,e,n)},fu.prototype.tr=function(t,e){return this.Kn(t,new Qr(e)).next(function(t){var e=as;return t instanceof bo&&(e=e.Ae(t.key,t)),e})},fu.prototype.er=function(n,r,i){var o=this,s=r.collectionGroup,u=as;return this.jn.ir(n,s).next(function(t){return nu.forEach(t,function(t){var e=r.Zt(t.child(s));return o.sr(n,e,i).next(function(t){t.forEach(function(t,e){u=u.Ae(t,e)})})}).next(function(){return u})})},fu.prototype.sr=function(e,n,t){var c,f,r=this;return this.Qn.Zn(e,n,t).next(function(t){return c=t,r.Wn.nr(e,n)}).next(function(t){return f=t,r.rr(e,f,c).next(function(t){c=t;for(var e=0,n=f;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),h=s.ot(a,a,r.Tn);c=h instanceof bo?c.Ae(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){n.matches(e)||(c=c.remove(t))}),c})},fu.prototype.rr=function(t,e,n){for(var r=fs(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Bi&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.Qn.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof bo&&(h=h.Ae(t,e))}),h})},fu),uu=(cu.ar=function(t,e){for(var n=fs(),r=fs(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new cu(t,e.fromCache,n,r)},cu),au=(hu.prototype.cr=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},hu.prototype.next=function(){var t=++this.previousValue;return this._r&&this._r(t),t},hu);function hu(t,e){var n=this;this.previousValue=t,e&&(e.ur=function(t){return n.cr(t)},this._r=function(t){return e.lr(t)})}function cu(t,e,n,r){this.targetId=t,this.fromCache=e,this.hr=n,this.or=r}function fu(t,e,n){this.Qn=t,this.Wn=e,this.jn=n}function lu(){this.Bn=[]}function pu(){this.Dn=new Zs(function(t){return t.toString()}),this.Cn=!1}function du(t){var e=this;this.An=null,this.mn=null,this.result=void 0,this.error=void 0,this.Pn=!1,this.Vn=!1,t(function(t){e.Pn=!0,e.result=t,e.An&&e.An(t)},function(t){e.Pn=!0,e.error=t,e.mn&&e.mn(t)})}function yu(t,e,n,r){this.batch=t,this.wn=e,this.En=n,this.Rn=r}function vu(t,e,n,r){this.batchId=t,this.Tn=e,this.baseMutations=n,this.mutations=r}function gu(t){this.dn=t,this.fn={}}function mu(t,e){this.projectId=t,this.database=e||"(default)"}function wu(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}au.dr=-1;var bu=(Eu.prototype.reset=function(){this.Ar=0},Eu.prototype.Vr=function(){this.Ar=this.Rr},Eu.prototype.gr=function(t){var e=this;this.cancel();var n=Math.floor(this.Ar+this.pr()),r=Math.max(0,Date.now()-this.Pr),i=Math.max(0,n-r);0<i&&Fs("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Ar+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.mr=this.Tr.yr(this.Er,i,function(){return e.Pr=Date.now(),t()}),this.Ar*=this.wr,this.Ar<this.Ir&&(this.Ar=this.Ir),this.Ar>this.Rr&&(this.Ar=this.Rr)},Eu.prototype.br=function(){null!==this.mr&&(this.mr.vr(),this.mr=null)},Eu.prototype.cancel=function(){null!==this.mr&&(this.mr.cancel(),this.mr=null)},Eu.prototype.pr=function(){return(Math.random()-.5)*this.Ar},Eu);function Eu(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Tr=t,this.Er=e,this.Ir=n,this.wr=r,this.Rr=i,this.Ar=0,this.mr=null,this.Pr=Date.now(),this.reset()}function Tu(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=Nu(e)),e=Iu(t.get(n),e);return Nu(e)}function Iu(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function Nu(t){return t+""}function _u(t){var e=t.length;if(Ws(2<=e),2===e)return Ws(""===t.charAt(0)&&""===t.charAt(1)),Lr.G;for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&zs(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:zs()}o=s+2}return new Lr(r)}var Au=(Pu.prototype.Dr=function(t,e){return this.Sr.add(e),nu.resolve()},Pu.prototype.ir=function(t,e){return nu.resolve(this.Sr.getEntries(e))},Pu),Su=(Du.prototype.add=function(t){var e=t.O(),n=t.M(),r=this.index[e]||new rs(Lr.N),i=!r.has(n);return this.index[e]=r.add(n),i},Du.prototype.has=function(t){var e=t.O(),n=t.M(),r=this.index[e];return r&&r.has(n)},Du.prototype.getEntries=function(t){return(this.index[t]||new rs(Lr.N)).W()},Du),Ru=(xu.prototype.Dr=function(t,e){var n=this;if(this.Cr.has(e))return nu.resolve();var r=e.O(),i=e.M();t.qn(function(){n.Cr.add(e)});var o={collectionId:r,parent:Tu(i)};return Ou(t).put(o)},xu.prototype.ir=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Xs(i),""],!1,!0);return Ou(t).Fr(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(_u(r.parent))}return o})},xu);function xu(){this.Cr=new Su}function Du(){this.index={}}function Pu(){this.Sr=new Su}function Ou(t){return $u.Nr(t,Da.store)}var ku,Lu=(Vu.prototype.Nn=function(t,e,n){return Uu(t).put(ju(e),n)},Vu.prototype.kn=function(t,e){var n=Uu(t),r=ju(e);return n.delete(r)},Vu.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.$r(e,t)})},Vu.prototype.Mn=function(t,e){var n=this;return Uu(t).get(ju(e)).next(function(t){return n.kr(t)})},Vu.prototype.Mr=function(t,e){var n=this;return Uu(t).get(ju(e)).next(function(t){var e=n.kr(t);return e?{xr:e,size:Mu(t)}:null})},Vu.prototype.getEntries=function(t,e){var r=this,i=os;return this.Lr(t,e,function(t,e){var n=r.kr(e);i=i.Ae(t,n)}).next(function(){return i})},Vu.prototype.Or=function(t,e){var r=this,i=os,o=new Xo(Qr.N);return this.Lr(t,e,function(t,e){var n=r.kr(e);o=n?(i=i.Ae(t,n),o.Ae(t,Mu(e))):(i=i.Ae(t,null),o.Ae(t,0))}).next(function(){return{Br:i,qr:o}})},Vu.prototype.Lr=function(t,e,i){if(e.B())return nu.resolve();var n=IDBKeyRange.bound(e.first().path.W(),e.last().path.W()),o=e.be(),s=o.Ne();return Uu(t).Ur({range:n},function(t,e,n){for(var r=Qr.st(t);s&&Qr.N(s,r)<0;)i(s,null),s=o.Ne();s&&s.isEqual(r)&&(i(s,e),s=o.$e()?o.Ne():null),s?n.Qr(s.path.W()):n.done()}).next(function(){for(;s;)i(s,null),s=o.$e()?o.Ne():null})},Vu.prototype.Zn=function(t,i,e){var n,r,o,s=this,u=as,a=i.path.length+1,h={};return e.isEqual(Or.min())?(n=i.path.W(),h.range=IDBKeyRange.lowerBound(n)):(r=i.path.W(),o=this.serializer.Wr(e),h.range=IDBKeyRange.lowerBound([r,o],!0),h.index=_a.collectionReadTimeIndex),Uu(t).Ur(h,function(t,e,n){var r;t.length===a&&(r=s.serializer.jr(e),i.path.q(r.key.path)?r instanceof bo&&i.matches(r)&&(u=u.Ae(r.key,r)):n.done())}).next(function(){return u})},Vu.prototype.Kr=function(t,e){var r=this,i=os,o=this.serializer.Wr(e),n=Uu(t),s=IDBKeyRange.lowerBound(o,!0);return n.Ur({index:_a.readTimeIndex,range:s},function(t,e){var n=r.serializer.jr(e);i=i.Ae(n.key,n),o=e.readTime}).next(function(){return{Gr:i,readTime:r.serializer.zr(o)}})},Vu.prototype.Hr=function(t){var r=this,e=Uu(t),i=Or.min();return e.Ur({index:_a.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(i=r.serializer.zr(e.readTime)),n.done()}).next(function(){return i})},Vu.prototype.Yr=function(t){return new Vu.Jr(this,!!t&&t.Xr)},Vu.prototype.Zr=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Vu.prototype.getMetadata=function(t){return Cu(t).get(Aa.key).next(function(t){return Ws(!!t),t})},Vu.prototype.$r=function(t,e){return Cu(t).put(Aa.key,e)},Vu.prototype.kr=function(t){if(t){var e=this.serializer.jr(t);return e instanceof Eo&&e.version.isEqual(Or.min())?null:e}return null},Vu);function Vu(t,e){this.serializer=t,this.jn=e}function Cu(t){return $u.Nr(t,Aa.store)}function Uu(t){return $u.Nr(t,_a.store)}function ju(t){return t.path.W()}function Mu(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw zs();e=t.noDocument}return JSON.stringify(e).length}function qu(t,e){var n=this;return(n=ku.call(this)||this).th=t,n.Xr=e,n.eh=new Zs(function(t){return t.toString()}),n}Lu.Jr=(n(qu,ku=ru),qu.prototype.On=function(s){var u=this,a=[],h=0,c=new rs(function(t,e){return Qs(t.j(),e.j())});return this.Dn.forEach(function(t,e){var n,r,i,o=u.eh.get(t);e?(n=u.th.serializer.sh(e,u.readTime),c=c.add(t.path.M()),r=Mu(n),h+=r-o,a.push(u.th.Nn(s,t,n))):(h-=o,u.Xr?(i=u.th.serializer.sh(new Eo(t,Or.min()),u.readTime),a.push(u.th.Nn(s,t,i))):a.push(u.th.kn(s,t)))}),c.forEach(function(t){a.push(u.th.jn.Dr(s,t))}),a.push(this.th.updateMetadata(s,h)),nu.vn(a)},qu.prototype.xn=function(t,e){var n=this;return this.th.Mr(t,e).next(function(t){return null===t?(n.eh.set(e,0),null):(n.eh.set(e,t.size),t.xr)})},qu.prototype.Ln=function(t,e){var n=this;return this.th.Or(t,e).next(function(t){var e=t.Br;return t.qr.forEach(function(t,e){n.eh.set(t,e)}),e})},qu);var Fu=(zu.prototype.next=function(){return this.ih+=2,this.ih},zu.nh=function(){return new zu(0)},zu.rh=function(){return new zu(-1)},zu),Bu=(Gu.prototype.oh=function(n){var r=this;return this.ah(n).next(function(t){var e=new Fu(t.highestTargetId);return t.highestTargetId=e.next(),r.uh(n,t).next(function(){return t.highestTargetId})})},Gu.prototype._h=function(t){return this.ah(t).next(function(t){return Or.v(new Pr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},Gu.prototype.lh=function(t){return this.ah(t).next(function(t){return t.highestListenSequenceNumber})},Gu.prototype.dh=function(e,n,r){var i=this;return this.ah(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.C()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.uh(e,t)})},Gu.prototype.fh=function(e,n){var r=this;return this.Th(e,n).next(function(){return r.ah(e).next(function(t){return t.targetCount+=1,r.Eh(n,t),r.uh(e,t)})})},Gu.prototype.Ih=function(t,e){return this.Th(t,e)},Gu.prototype.wh=function(e,t){var n=this;return this.Rh(e,t.targetId).next(function(){return Wu(e).delete(t.targetId)}).next(function(){return n.ah(e)}).next(function(t){return Ws(0<t.targetCount),--t.targetCount,n.uh(e,t)})},Gu.prototype.Ah=function(r,i,o){var s=this,u=0,a=[];return Wu(r).Ur(function(t,e){var n=s.serializer.mh(e);n.sequenceNumber<=i&&null===o.get(n.targetId)&&(u++,a.push(s.wh(r,n)))}).next(function(){return nu.vn(a)}).next(function(){return u})},Gu.prototype.js=function(t,r){var i=this;return Wu(t).Ur(function(t,e){var n=i.serializer.mh(e);r(n)})},Gu.prototype.ah=function(t){return Ku(t).get(xa.key).next(function(t){return Ws(null!==t),t})},Gu.prototype.uh=function(t,e){return Ku(t).put(xa.key,e)},Gu.prototype.Th=function(t,e){return Wu(t).put(this.serializer.Ph(e))},Gu.prototype.Eh=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},Gu.prototype.Vh=function(t){return this.ah(t).next(function(t){return t.targetCount})},Gu.prototype.gh=function(t,i){var o=this,e=i.canonicalId(),n=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),s=null;return Wu(t).Ur({range:n,index:Sa.queryTargetsIndexName},function(t,e,n){var r=o.serializer.mh(e);i.isEqual(r.target)&&(s=r,n.done())}).next(function(){return s})},Gu.prototype.ph=function(n,t,r){var i=this,o=[],s=Hu(n);return t.forEach(function(t){var e=Tu(t.path);o.push(s.put(new Ra(r,e))),o.push(i.hh.yh(n,r,t))}),nu.vn(o)},Gu.prototype.bh=function(n,t,r){var i=this,o=Hu(n);return nu.forEach(t,function(t){var e=Tu(t.path);return nu.vn([o.delete([r,e]),i.hh.vh(n,r,t)])})},Gu.prototype.Rh=function(t,e){var n=Hu(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},Gu.prototype.Sh=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Hu(t),o=fs();return r.Ur({range:n,Dh:!0},function(t,e,n){var r=_u(t[1]),i=new Qr(r);o=o.add(i)}).next(function(){return o})},Gu.prototype.Ch=function(t,e){var n=Tu(e.path),r=IDBKeyRange.bound([n],[Xs(n)],!1,!0),i=0;return Hu(t).Ur({index:Ra.documentTargetsIndex,Dh:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},Gu.prototype.si=function(t,e){var n=this;return Wu(t).get(e).next(function(t){return t?n.serializer.mh(t):null})},Gu);function Gu(t,e){this.hh=t,this.serializer=e}function zu(t){this.ih=t}function Wu(t){return $u.Nr(t,Sa.store)}function Ku(t){return $u.Nr(t,xa.store)}function Hu(t){return $u.Nr(t,Ra.store)}var Qu,Yu=(ea.prototype.jr=function(t){if(t.document)return this.Fh.mi(t.document,!!t.hasCommittedMutations);if(t.noDocument){var e=Qr.st(t.noDocument.path),n=this.Nh(t.noDocument.readTime);return new Eo(e,n,{hasCommittedMutations:!!t.hasCommittedMutations})}if(t.unknownDocument){var r=Qr.st(t.unknownDocument.path),i=this.Nh(t.unknownDocument.version);return new To(r,i)}return zs()},ea.prototype.sh=function(t,e){var n=this.Wr(e),r=t.key.path.M().W();if(t instanceof bo){var i=this.Fh.Ai(t),o=t.hasCommittedMutations;return new _a(null,null,i,o,n,r)}if(t instanceof Eo){var s=t.key.path.W(),u=this.$h(t.version),a=t.hasCommittedMutations;return new _a(null,new Ia(s,u),null,a,n,r)}if(t instanceof To){var h=t.key.path.W(),c=this.$h(t.version);return new _a(new Na(h,c),null,null,!0,n,r)}return zs()},ea.prototype.Wr=function(t){var e=t.C();return[e.seconds,e.nanoseconds]},ea.prototype.zr=function(t){var e=new Pr(t[0],t[1]);return Or.v(e)},ea.prototype.$h=function(t){var e=t.C();return new va(e.seconds,e.nanoseconds)},ea.prototype.Nh=function(t){var e=new Pr(t.seconds,t.nanoseconds);return Or.v(e)},ea.prototype.kh=function(t,e){var n=this,r=e.baseMutations.map(function(t){return n.Fh.vi(t)}),i=e.mutations.map(function(t){return n.Fh.vi(t)});return new ba(t,e.batchId,e.Tn.toMillis(),r,i)},ea.prototype.Mh=function(t){var e=this,n=(t.baseMutations||[]).map(function(t){return e.Fh.Fi(t)}),r=t.mutations.map(function(t){return e.Fh.Fi(t)}),i=Pr.fromMillis(t.localWriteTimeMs);return new tu(t.batchId,i,n,r)},ea.prototype.mh=function(t){var e=this.Nh(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?this.Nh(t.lastLimboFreeSnapshotVersion):Or.min(),r=void 0!==t.query.documents?this.Fh.Oi(t.query):this.Fh.Wi(t.query);return new ko(r,t.targetId,0,t.lastListenSequenceNumber,e,n,Zr.fromBase64String(t.resumeToken))},ea.prototype.Ph=function(t){var e=this.$h(t.Ee),n=this.$h(t.lastLimboFreeSnapshotVersion),r=t.target.Lt()?this.Fh.Li(t.target):this.Fh.Bi(t.target),i=t.resumeToken.toBase64();return new Sa(t.targetId,t.target.canonicalId(),e,i,t.sequenceNumber,n,r)},ea),Xu="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Ju=(n(ta,Qu=ou),ta),$u=(Zu.Nr=function(t,e){if(t instanceof Ju)return Va.Nr(t.xh,e);throw zs()},Zu.prototype.start=function(){var e=this;return Va.Zh(this.Hh,da,new ya(this.serializer)).then(function(t){return e.to=t,e.eo()}).then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Ar(_r.FAILED_PRECONDITION,Xu);return e.so(),e.io(),e.no(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.Jh.lh(t)})}).then(function(t){e.qh=new au(t,e.Oh)}).then(function(){e.Uh=!0}).catch(function(t){return e.to&&e.to.close(),Promise.reject(t)})},Zu.prototype.ro=function(n){var t=this;return this.Gh=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.ho?[2,n(e)]:[2]})})},n(this.isPrimary)},Zu.prototype.oo=function(n){var t=this;this.to.ao(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},Zu.prototype.uo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Tr.co(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.ho?[4,this.eo()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},Zu.prototype.eo=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return ra(e).put(new Oa(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n._o(e).next(function(t){t||(n.isPrimary=!1,n.Tr.lo(function(){return n.Gh(!1)}))})}).next(function(){return n.do(e)}).next(function(t){return n.isPrimary&&!t?n.fo(e).next(function(){return!1}):!!t&&n.To(e).next(function(){return!0})})}).catch(function(t){if(Fa(t))return Fs("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Fs("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.Tr.lo(function(){return n.Gh(t)}),n.isPrimary=t})},Zu.prototype._o=function(t){var e=this;return na(t).get(ga.key).next(function(t){return nu.resolve(e.Eo(t))})},Zu.prototype.Io=function(t){return ra(t).delete(this.clientId)},Zu.prototype.wo=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.Ro(this.Kh,18e5)?[3,2]:(this.Kh=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=Zu.Nr(t,Oa.store);return r.Fr().next(function(t){var e=o.Ao(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return nu.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.Xh)for(n=0,r=e;n<r.length;n++)i=r[n],this.Xh.removeItem(this.mo(i.clientId));t.label=2;case 2:return[2]}})})},Zu.prototype.no=function(){var t=this;this.jh=this.Tr.yr("client_metadata_refresh",4e3,function(){return t.eo().then(function(){return t.wo()}).then(function(){return t.no()})})},Zu.prototype.Eo=function(t){return!!t&&t.ownerId===this.clientId},Zu.prototype.do=function(e){var i=this;return this.Bh?nu.resolve(!0):na(e).get(ga.key).next(function(t){if(null!==t&&i.Ro(t.leaseTimestampMs,5e3)&&!i.Po(t.ownerId)){if(i.Eo(t)&&i.networkEnabled)return!0;if(!i.Eo(t)){if(!t.allowTabSynchronization)throw new Ar(_r.FAILED_PRECONDITION,Xu);return!1}}return!(!i.networkEnabled||!i.inForeground)||ra(e).Fr().next(function(t){return void 0===i.Ao(t,5e3).find(function(t){if(i.clientId!==t.clientId){var e=!i.networkEnabled&&t.networkEnabled,n=!i.inForeground&&t.inForeground,r=i.networkEnabled===t.networkEnabled;if(e||n&&r)return!0}return!1})})}).next(function(t){return i.isPrimary!==t&&Fs("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},Zu.prototype.Vo=function(){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Uh=!1,this.po(),this.jh&&(this.jh.cancel(),this.jh=null),this.yo(),this.bo(),[4,this.runTransaction("shutdown","readwrite",function(t){return e.fo(t).next(function(){return e.Io(t)})}).catch(function(t){Fs("IndexedDbPersistence","Proceeding with shutdown despite failure: ",t)})];case 1:return t.sent(),this.to.close(),this.vo(),[2]}})})},Zu.prototype.Ao=function(t,e){var n=this;return t.filter(function(t){return n.Ro(t.updateTimeMs,e)&&!n.Po(t.clientId)})},Zu.prototype.So=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return ra(t).Fr().next(function(t){return e.Ao(t,18e5).map(function(t){return t.clientId})})})},Zu.clearPersistence=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return Zu.zh()?(e=n+Zu.Yh,[4,Va.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})},Object.defineProperty(Zu.prototype,"ho",{get:function(){return this.Uh},enumerable:!0,configurable:!0}),Zu.prototype.Do=function(t){return ua.Co(t,this.serializer,this.jn,this.hh)},Zu.prototype.Fo=function(){return this.Jh},Zu.prototype.No=function(){return this.Qn},Zu.prototype.$o=function(){return this.jn},Zu.prototype.runTransaction=function(e,n,r){var i=this;Fs("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.to.runTransaction(t,La,function(t){return o=new Ju(t,i.qh?i.qh.next():au.dr),"readwrite-primary"===n?i._o(o).next(function(t){return!!t||i.do(o)}).next(function(t){if(!t)throw Bs("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.Tr.lo(function(){return i.Gh(!1)}),new Ar(_r.FAILED_PRECONDITION,iu);return r(o)}).next(function(t){return i.To(o).next(function(){return t})}):i.ko(o).next(function(){return r(o)})}).then(function(t){return o.Un(),t})},Zu.prototype.ko=function(t){var e=this;return na(t).get(ga.key).next(function(t){if(null!==t&&e.Ro(t.leaseTimestampMs,5e3)&&!e.Po(t.ownerId)&&!e.Eo(t)&&!(e.Bh||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Ar(_r.FAILED_PRECONDITION,Xu)})},Zu.prototype.To=function(t){var e=new ga(this.clientId,this.allowTabSynchronization,Date.now());return na(t).put(ga.key,e)},Zu.zh=function(){return Va.zh()},Zu.Mo=function(t){var e=t.ii.projectId;return t.ii.ln||(e+="."+t.ii.database),"firestore/"+t.persistenceKey+"/"+e+"/"},Zu.prototype.fo=function(t){var e=this,n=na(t);return n.get(ga.key).next(function(t){return e.Eo(t)?(Fs("IndexedDbPersistence","Releasing primary lease."),n.delete(ga.key)):nu.resolve()})},Zu.prototype.Ro=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Bs("Detected an update time that is in the future: "+t+" > "+n),1))},Zu.prototype.so=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Wh=function(){t.Tr.co(function(){return t.inForeground="visible"===t.document.visibilityState,t.eo()})},this.document.addEventListener("visibilitychange",this.Wh),this.inForeground="visible"===this.document.visibilityState)},Zu.prototype.yo=function(){this.Wh&&(this.document.removeEventListener("visibilitychange",this.Wh),this.Wh=null)},Zu.prototype.io=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Qh=function(){e.po(),e.Tr.co(function(){return e.Vo()})},this.window.addEventListener("unload",this.Qh))},Zu.prototype.bo=function(){this.Qh&&(this.window.removeEventListener("unload",this.Qh),this.Qh=null)},Zu.prototype.Po=function(t){var e;try{var n=null!==(null===(e=this.Xh)||void 0===e?void 0:e.getItem(this.mo(t)));return Fs("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Bs("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},Zu.prototype.po=function(){if(this.Xh)try{this.Xh.setItem(this.mo(this.clientId),String(Date.now()))}catch(t){Bs("Failed to set zombie client id.",t)}},Zu.prototype.vo=function(){if(this.Xh)try{this.Xh.removeItem(this.mo(this.clientId))}catch(t){}},Zu.prototype.mo=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},Zu);function Zu(t,e,n,r,i,o,s,u,a){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Tr=o,this.Oh=u,this.Bh=a,this.qh=null,this.Uh=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Qh=null,this.inForeground=!1,this.Wh=null,this.jh=null,this.Kh=Number.NEGATIVE_INFINITY,this.Gh=function(t){return Promise.resolve()},!Zu.zh())throw new Ar(_r.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.hh=new ia(this,i),this.Hh=e+Zu.Yh,this.serializer=new Yu(s),this.document=r.document,this.Jh=new Bu(this.hh,this.serializer),this.jn=new Ru,this.Qn=new Lu(this.serializer,this.jn),this.window=r.window,r.window&&r.window.localStorage?this.Xh=r.window.localStorage:(this.Xh=null,!1===a&&Bs("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function ta(t,e){var n=this;return(n=Qu.call(this)||this).xh=t,n.Lh=e,n}function ea(t){this.Fh=t}function na(t){return $u.Nr(t,ga.store)}function ra(t){return $u.Nr(t,Oa.store)}$u.Yh="main";var ia=(oa.prototype.Lo=function(t){var n=this.Oo(t);return this.db.Fo().Vh(t).next(function(e){return n.next(function(t){return e+t})})},oa.prototype.Oo=function(t){var e=0;return this.Bo(t,function(t){e++}).next(function(){return e})},oa.prototype.js=function(t,e){return this.db.Fo().js(t,e)},oa.prototype.Bo=function(t,n){return this.qo(t,function(t,e){return n(e)})},oa.prototype.yh=function(t,e,n){return sa(t,n)},oa.prototype.vh=function(t,e,n){return sa(t,n)},oa.prototype.Ah=function(t,e,n){return this.db.Fo().Ah(t,e,n)},oa.prototype.Uo=sa,oa.prototype.Qo=function(t,e){return r=e,i=!1,pa(n=t).Wo(function(t){return ha(n,t,r).next(function(t){return t&&(i=!0),nu.resolve(!t)})}).next(function(){return i});var n,r,i},oa.prototype.jo=function(r,i){var o=this,s=this.db.No().Yr(),u=[],a=0;return this.qo(r,function(e,t){var n;t<=i&&(n=o.Qo(r,e).next(function(t){if(!t)return a++,s.Mn(r,e).next(function(){return s.kn(e),Hu(r).delete([0,Tu(e.path)])})}),u.push(n))}).next(function(){return nu.vn(u)}).next(function(){return s.apply(r)}).next(function(){return a})},oa.prototype.removeTarget=function(t,e){var n=e.Ie(t.Lh);return this.db.Fo().Ih(t,n)},oa.prototype.Ko=sa,oa.prototype.qo=function(t,o){var s,e=Hu(t),u=au.dr;return e.Ur({index:Ra.documentTargetsIndex},function(t,e){var n=t[0],r=(t[1],e.path),i=e.sequenceNumber;0===n?(u!==au.dr&&o(new Qr(_u(s)),u),u=i,s=r):u=au.dr}).next(function(){u!==au.dr&&o(new Qr(_u(s)),u)})},oa.prototype.Go=function(t){return this.db.No().Zr(t)},oa);function oa(t,e){this.db=t,this.xo=new uh(this,e)}function sa(t,e){return Hu(t).put((n=t.Lh,new Ra(0,Tu(e.path),n)));var n}var ua=(aa.Co=function(t,e,n,r){return Ws(""!==t.uid),new aa(t.t()?t.uid:"",e,n,r)},aa.prototype.Ho=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return fa(t).Ur({index:ba.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},aa.prototype.Yo=function(h,c,f,l){var p=this,d=la(h),y=fa(h);return y.add({}).next(function(t){Ws("number"==typeof t);for(var e=new tu(t,c,f,l),n=p.serializer.kh(p.userId,e),r=[],i=new rs(function(t,e){return Qs(t.j(),e.j())}),o=0,s=l;o<s.length;o++){var u=s[o],a=Ea.key(p.userId,u.key.path,t),i=i.add(u.key.path.M());r.push(y.put(n)),r.push(d.put(a,Ea.PLACEHOLDER))}return i.forEach(function(t){r.push(p.jn.Dr(h,t))}),h.qn(function(){p.zo[t]=e.keys()}),nu.vn(r).next(function(){return e})})},aa.prototype.Jo=function(t,e){var n=this;return fa(t).get(e).next(function(t){return t?(Ws(t.userId===n.userId),n.serializer.Mh(t)):null})},aa.prototype.Xo=function(t,n){var r=this;return this.zo[n]?nu.resolve(this.zo[n]):this.Jo(t,n).next(function(t){if(t){var e=t.keys();return r.zo[n]=e}return null})},aa.prototype.Zo=function(t,e){var r=this,i=e+1,n=IDBKeyRange.lowerBound([this.userId,i]),o=null;return fa(t).Ur({index:ba.userMutationsIndex,range:n},function(t,e,n){e.userId===r.userId&&(Ws(e.batchId>=i),o=r.serializer.Mh(e)),n.done()}).next(function(){return o})},aa.prototype.ta=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return fa(t).Ur({index:ba.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},aa.prototype.ea=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return fa(t).Fr(ba.userMutationsIndex,n).next(function(t){return t.map(function(t){return e.serializer.Mh(t)})})},aa.prototype.Gn=function(u,a){var h=this,t=Ea.prefixForPath(this.userId,a.path),e=IDBKeyRange.lowerBound(t),c=[];return la(u).Ur({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=_u(i);if(r===h.userId&&a.path.isEqual(s))return fa(u).get(o).next(function(t){if(!t)throw zs();Ws(t.userId===h.userId),c.push(h.serializer.Mh(t))});n.done()}).next(function(){return c})},aa.prototype.Xn=function(r,t){var a=this,h=new rs(Qs),i=[];return t.forEach(function(u){var t=Ea.prefixForPath(a.userId,u.path),e=IDBKeyRange.lowerBound(t),n=la(r).Ur({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=_u(i);r===a.userId&&u.path.isEqual(s)?h=h.add(o):n.done()});i.push(n)}),nu.vn(i).next(function(){return a.sa(r,h)})},aa.prototype.nr=function(t,e){var u=this,a=e.path,h=a.length+1,n=Ea.prefixForPath(this.userId,a),r=IDBKeyRange.lowerBound(n),c=new rs(Qs);return la(t).Ur({range:r},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=_u(i);r===u.userId&&a.q(s)?s.length===h&&(c=c.add(o)):n.done()}).next(function(){return u.sa(t,c)})},aa.prototype.sa=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(fa(e).get(t).next(function(t){if(null===t)throw zs();Ws(t.userId===n.userId),r.push(n.serializer.Mh(t))}))}),nu.vn(i).next(function(){return r})},aa.prototype.ia=function(e,n){var r=this;return ca(e.xh,this.userId,n).next(function(t){return e.qn(function(){r.na(n.batchId)}),nu.forEach(t,function(t){return r.hh.Uo(e,t)})})},aa.prototype.na=function(t){delete this.zo[t]},aa.prototype.ra=function(n){var o=this;return this.Ho(n).next(function(t){if(!t)return nu.resolve();var e=IDBKeyRange.lowerBound(Ea.prefixForUser(o.userId)),i=[];return la(n).Ur({range:e},function(t,e,n){var r;t[0]===o.userId?(r=_u(t[1]),i.push(r)):n.done()}).next(function(){Ws(0===i.length)})})},aa.prototype.Ch=function(t,e){return ha(t,this.userId,e)},aa.prototype.ha=function(t){var e=this;return pa(t).get(this.userId).next(function(t){return t||new wa(e.userId,-1,"")})},aa);function aa(t,e,n,r){this.userId=t,this.serializer=e,this.jn=n,this.hh=r,this.zo={}}function ha(t,o,e){var n=Ea.prefixForPath(o,e.path),s=n[1],r=IDBKeyRange.lowerBound(n),u=!1;return la(t).Ur({range:r,Dh:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function ca(t,e,n){var r=t.store(ba.store),i=t.store(Ea.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.Ur({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){Ws(1===u)}));for(var h=[],c=0,f=n.mutations;c<f.length;c++){var l=f[c],p=Ea.key(e,l.key.path,n.batchId);o.push(i.delete(p)),h.push(l.key)}return nu.vn(o).next(function(){return h})}function fa(t){return $u.Nr(t,ba.store)}function la(t){return $u.Nr(t,Ea.store)}function pa(t){return $u.Nr(t,wa.store)}var da=10,ya=(ma.prototype.createOrUpgrade=function(n,r,t,e){var i=this;Ws(t<e&&0<=t&&e<=da);var o,s=new Ba(r);t<1&&1<=e&&(n.createObjectStore(ga.store),(o=n).createObjectStore(wa.store,{keyPath:wa.keyPath}),o.createObjectStore(ba.store,{keyPath:ba.keyPath,autoIncrement:!0}).createIndex(ba.userMutationsIndex,ba.userMutationsKeyPath,{unique:!0}),o.createObjectStore(Ea.store),Pa(n),n.createObjectStore(_a.store));var u,a=nu.resolve();return t<3&&3<=e&&(0!==t&&((u=n).deleteObjectStore(Ra.store),u.deleteObjectStore(Sa.store),u.deleteObjectStore(xa.store),Pa(n)),a=a.next(function(){return t=s.store(xa.store),e=new xa(0,0,Or.min().C(),0),t.put(xa.key,e);var t,e})),t<4&&4<=e&&(0!==t&&(a=a.next(function(){return r=n,(i=s).store(ba.store).Fr().next(function(t){r.deleteObjectStore(ba.store),r.createObjectStore(ba.store,{keyPath:ba.keyPath,autoIncrement:!0}).createIndex(ba.userMutationsIndex,ba.userMutationsKeyPath,{unique:!0});var e=i.store(ba.store),n=t.map(function(t){return e.put(t)});return nu.vn(n)});var r,i})),a=a.next(function(){n.createObjectStore(Oa.store,{keyPath:Oa.keyPath})})),t<5&&5<=e&&(a=a.next(function(){return i.removeAcknowledgedMutations(s)})),t<6&&6<=e&&(a=a.next(function(){return n.createObjectStore(Aa.store),i.addDocumentGlobal(s)})),t<7&&7<=e&&(a=a.next(function(){return i.ensureSequenceNumbers(s)})),t<8&&8<=e&&(a=a.next(function(){return i.createCollectionParentIndex(n,s)})),t<9&&9<=e&&(a=a.next(function(){var t,e;(e=n).objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges"),(t=r.objectStore(_a.store)).createIndex(_a.readTimeIndex,_a.readTimeIndexPath,{unique:!1}),t.createIndex(_a.collectionReadTimeIndex,_a.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=e&&(a=a.next(function(){return i.rewriteCanonicalIds(s)})),a},ma.prototype.addDocumentGlobal=function(e){var n=0;return e.store(_a.store).Ur(function(t,e){n+=Mu(e)}).next(function(){var t=new Aa(n);return e.store(Aa.store).put(Aa.key,t)})},ma.prototype.removeAcknowledgedMutations=function(r){var i=this,t=r.store(wa.store),e=r.store(ba.store);return t.Fr().next(function(t){return nu.forEach(t,function(n){var t=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return e.Fr(ba.userMutationsIndex,t).next(function(t){return nu.forEach(t,function(t){Ws(t.userId===n.userId);var e=i.serializer.Mh(t);return ca(r,n.userId,e).next(function(){})})})})})},ma.prototype.ensureSequenceNumbers=function(t){var s=t.store(Ra.store),e=t.store(_a.store);return t.store(xa.store).get(xa.key).next(function(i){var o=[];return e.Ur(function(t,e){var n=new Lr(t),r=[0,Tu(n)];o.push(s.get(r).next(function(t){return t?nu.resolve():s.put(new Ra(0,Tu(n),i.highestListenSequenceNumber))}))}).next(function(){return nu.vn(o)})})},ma.prototype.createCollectionParentIndex=function(t,e){function r(t){if(o.add(t)){var e=t.O(),n=t.M();return i.put({collectionId:e,parent:Tu(n)})}}t.createObjectStore(Da.store,{keyPath:Da.keyPath});var i=e.store(Da.store),o=new Su;return e.store(_a.store).Ur({Dh:!0},function(t,e){return r(new Lr(t).M())}).next(function(){return e.store(Ea.store).Ur({Dh:!0},function(t,e){t[0];var n=t[1];return r((t[2],_u(n)).M())})})},ma.prototype.rewriteCanonicalIds=function(t){var i=this,o=t.store(Sa.store);return o.Ur(function(t,e){var n=i.serializer.mh(e),r=i.serializer.Ph(n);return o.put(r)})},ma),va=function(t,e){this.seconds=t,this.nanoseconds=e},ga=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function ma(t){this.serializer=t}ga.store="owner",ga.key="owner";var wa=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};wa.store="mutationQueues",wa.keyPath="userId";var ba=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};ba.store="mutations",ba.keyPath="batchId",ba.userMutationsIndex="userMutationsIndex",ba.userMutationsKeyPath=["userId","batchId"];var Ea=(Ta.prefixForUser=function(t){return[t]},Ta.prefixForPath=function(t,e){return[t,Tu(e)]},Ta.key=function(t,e,n){return[t,Tu(e),n]},Ta);function Ta(){}Ea.store="documentMutations",Ea.PLACEHOLDER=new Ea;var Ia=function(t,e){this.path=t,this.readTime=e},Na=function(t,e){this.path=t,this.version=e},_a=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};_a.store="remoteDocuments",_a.readTimeIndex="readTimeIndex",_a.readTimeIndexPath="readTime",_a.collectionReadTimeIndex="collectionReadTimeIndex",_a.collectionReadTimeIndexPath=["parentPath","readTime"];var Aa=function(t){this.byteSize=t};Aa.store="remoteDocumentGlobal",Aa.key="remoteDocumentGlobalKey";var Sa=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Sa.store="targets",Sa.keyPath="targetId",Sa.queryTargetsIndexName="queryTargetsIndex",Sa.queryTargetsKeyPath=["canonicalId","targetId"];var Ra=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Ra.store="targetDocuments",Ra.keyPath=["targetId","path"],Ra.documentTargetsIndex="documentTargetsIndex",Ra.documentTargetsKeyPath=["path","targetId"];var xa=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};xa.key="targetGlobalKey",xa.store="targetGlobal";var Da=function(t,e){this.collectionId=t,this.parent=e};function Pa(t){t.createObjectStore(Ra.store,{keyPath:Ra.keyPath}).createIndex(Ra.documentTargetsIndex,Ra.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Sa.store,{keyPath:Sa.keyPath}).createIndex(Sa.queryTargetsIndexName,Sa.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(xa.store)}Da.store="collectionParents",Da.keyPath=["collectionId","parent"];var Oa=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};Oa.store="clientMetadata",Oa.keyPath="clientId";var ka,La=d(d(d([wa.store,ba.store,Ea.store,_a.store,Sa.store,ga.store,xa.store,Ra.store],[Oa.store]),[Aa.store]),[Da.store]),Va=(qa.Zh=function(o,t,s){return Fs("SimpleDb","Opening database:",o),new nu(function(n,r){var i=indexedDB.open(o,t);i.onsuccess=function(t){var e=t.target.result;n(new qa(e))},i.onblocked=function(){r(new Ar(_r.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(t){var e=t.target.error;"VersionError"===e.name?r(new Ar(_r.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(e)},i.onupgradeneeded=function(t){Fs("SimpleDb",'Database "'+o+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;s.createOrUpgrade(e,i.transaction,t.oldVersion,da).next(function(){Fs("SimpleDb","Database upgrade to version "+da+" complete")})}}).yn()},qa.delete=function(t){return Fs("SimpleDb","Removing database:",t),Ka(window.indexedDB.deleteDatabase(t)).yn()},qa.zh=function(){if("undefined"==typeof indexedDB)return!1;if(qa.aa())return!0;var t=g(),e=qa.oa(t),n=0<e&&e<10,r=qa.ua(t),i=0<r&&r<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||i)},qa.aa=function(){var t;return"undefined"!=typeof __PRIVATE_process&&"YES"===(null===(t=__PRIVATE_process.__PRIVATE_env)||void 0===t?void 0:t.ca)},qa.Nr=function(t,e){return t.store(e)},qa.oa=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},qa.ua=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},qa.prototype.ao=function(e){this.db.onversionchange=function(t){return e(t)}},qa.prototype.runTransaction=function(r,h,c){return y(this,void 0,void 0,function(){var s,u,e,a,n;return v(this,function(t){switch(t.label){case 0:s="readonly"===r,u=0,e=function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:++u,e=Ba.open(a.db,s?"readonly":"readwrite",h),t.label=1;case 1:return t.trys.push([1,3,,4]),n=c(e).catch(function(t){return e.abort(t),nu.reject(t)}).yn(),r={},n.catch(function(){}),[4,e._a];case 2:return[2,(r.value=(t.sent(),n),r)];case 3:return i=t.sent(),o="FirebaseError"!==i.name&&u<3,Fs("SimpleDb","Transaction failed with error: %s. Retrying: %s.",i.message,o),o?[3,4]:[2,{value:Promise.reject(i)}];case 4:return[2]}})},a=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(n=t.sent()))return[2,n.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},qa.prototype.close=function(){this.db.close()},qa),Ca=(Object.defineProperty(Ma.prototype,"Pn",{get:function(){return this.da},enumerable:!0,configurable:!0}),Object.defineProperty(Ma.prototype,"Ta",{get:function(){return this.fa},enumerable:!0,configurable:!0}),Object.defineProperty(Ma.prototype,"cursor",{set:function(t){this.la=t},enumerable:!0,configurable:!0}),Ma.prototype.done=function(){this.da=!0},Ma.prototype.Qr=function(t){this.fa=t},Ma.prototype.delete=function(){return Ka(this.la.delete())},Ma),Ua=(n(ja,ka=Ar),ja);function ja(t){var e=this;return(e=ka.call(this,_r.UNAVAILABLE,"IndexedDB transaction failed: "+t)||this).name="IndexedDbTransactionError",e}function Ma(t){this.la=t,this.da=!1,this.fa=null}function qa(t){this.db=t,12.2===qa.oa(g())&&Bs("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function Fa(t){return"IndexedDbTransactionError"===t.name}var Ba=(Wa.open=function(t,e,n){return new Wa(t.transaction(n,e))},Object.defineProperty(Wa.prototype,"_a",{get:function(){return this.Ea.promise},enumerable:!0,configurable:!0}),Wa.prototype.abort=function(t){t&&this.Ea.reject(t),this.aborted||(Fs("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Wa.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Ga(e)},Wa),Ga=(za.prototype.put=function(t,e){return Ka(void 0!==e?(Fs("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Fs("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},za.prototype.add=function(t){return Fs("SimpleDb","ADD",this.store.name,t,t),Ka(this.store.add(t))},za.prototype.get=function(e){var n=this;return Ka(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Fs("SimpleDb","GET",n.store.name,e,t),t})},za.prototype.delete=function(t){return Fs("SimpleDb","DELETE",this.store.name,t),Ka(this.store.delete(t))},za.prototype.count=function(){return Fs("SimpleDb","COUNT",this.store.name),Ka(this.store.count())},za.prototype.Fr=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.Ia(n,function(t,e){r.push(e)}).next(function(){return r})},za.prototype.wa=function(t,e){Fs("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.Dh=!1;var r=this.cursor(n);return this.Ia(r,function(t,e,n){return n.delete()})},za.prototype.Ur=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.Ia(r,e)},za.prototype.Wo=function(i){var t=this.cursor({});return new nu(function(n,r){t.onerror=function(t){var e=Qa(t.target.error);r(e)},t.onsuccess=function(t){var e=t.target.result;e?i(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},za.prototype.Ia=function(t,s){var u=[];return new nu(function(o,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n,r,i=t.target.result;i?(e=new Ca(i),(n=s(i.primaryKey,i.value,e))instanceof nu&&(r=n.catch(function(t){return e.done(),nu.reject(t)}),u.push(r)),e.Pn?o():null===e.Ta?i.continue():i.continue(e.Ta)):o()}}).next(function(){return nu.vn(u)})},za.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},za.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Dh?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},za);function za(t){this.store=t}function Wa(t){var n=this;this.transaction=t,this.aborted=!1,this.Ea=new wu,this.transaction.oncomplete=function(){n.Ea.resolve()},this.transaction.onabort=function(){t.error?n.Ea.reject(new Ua(t.error)):n.Ea.resolve()},this.transaction.onerror=function(t){var e=Qa(t.target.error);n.Ea.reject(new Ua(e))}}function Ka(t){return new nu(function(n,r){t.onsuccess=function(t){var e=t.target.result;n(e)},t.onerror=function(t){var e=Qa(t.target.error);r(e)}})}var Ha=!1;function Qa(t){var e=Va.oa(g());if(12.2<=e&&e<13){var n="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(n)){var r=new Ar("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return Ha||(Ha=!0,setTimeout(function(){throw r},0)),r}}return t}var Ya=($a.Va=function(t,e,n,r,i){var o=new $a(t,e,Date.now()+n,r,i);return o.start(n),o},$a.prototype.start=function(t){var e=this;this.ga=setTimeout(function(){return e.pa()},t)},$a.prototype.vr=function(){return this.pa()},$a.prototype.cancel=function(t){null!==this.ga&&(this.clearTimeout(),this.Pa.reject(new Ar(_r.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},$a.prototype.pa=function(){var e=this;this.Ra.co(function(){return null!==e.ga?(e.clearTimeout(),e.op().then(function(t){return e.Pa.resolve(t)})):Promise.resolve()})},$a.prototype.clearTimeout=function(){null!==this.ga&&(this.ma(this),clearTimeout(this.ga),this.ga=null)},$a),Xa=(Object.defineProperty(Ja.prototype,"ka",{get:function(){return this.va},enumerable:!0,configurable:!0}),Ja.prototype.co=function(t){this.enqueue(t)},Ja.prototype.Ma=function(t){this.xa(),this.La(t)},Ja.prototype.Oa=function(t){return this.xa(),this.La(t)},Ja.prototype.Ba=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.xa(),this.va?[3,2]:(this.va=!0,(e=Us.nt().window)&&e.removeEventListener("visibilitychange",this.$a),[4,this.Oa(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Ja.prototype.enqueue=function(t){return this.xa(),this.va?new Promise(function(t){}):this.La(t)},Ja.prototype.lo=function(i){var t=this;this.xa(),this.va||(this.ba=this.ba.then(function(){var n=new wu,r=function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,i()];case 1:return t.sent(),n.resolve(),this.Na.reset(),[3,3];case 2:if(!Fa(e=t.sent()))throw n.resolve(),e;return Fs("AsyncQueue","Operation failed with retryable error: "+e),this.Na.gr(r),[3,3];case 3:return[2]}})})};return t.co(r),n.promise}))},Ja.prototype.La=function(t){var r=this,e=this.ya.then(function(){return r.Ca=!0,t().catch(function(t){throw r.Da=t,r.Ca=!1,Bs("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Ca=!1,t})});return this.ya=e},Ja.prototype.yr=function(t,e,n){var r=this;this.xa(),-1<this.Fa.indexOf(t)&&(e=0);var i=Ya.Va(this,t,e,n,function(t){return r.qa(t)});return this.Sa.push(i),i},Ja.prototype.xa=function(){this.Da&&zs()},Ja.prototype.Ua=function(){},Ja.prototype.Qa=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.ya];case 1:t.sent(),t.label=2;case 2:if(e!==this.ya)return[3,0];t.label=3;case 3:return[2]}})})},Ja.prototype.Wa=function(t){for(var e=0,n=this.Sa;e<n.length;e++)if(n[e].Er===t)return!0;return!1},Ja.prototype.ja=function(r){var i=this;return this.Qa().then(function(){i.Sa.sort(function(t,e){return t.Aa-e.Aa});for(var t=0,e=i.Sa;t<e.length;t++){var n=e[t];if(n.vr(),"all"!==r&&n.Er===r)break}return i.Qa()})},Ja.prototype.Ka=function(t){this.Fa.push(t)},Ja.prototype.qa=function(t){var e=this.Sa.indexOf(t);this.Sa.splice(e,1)},Ja);function Ja(){var t=this;this.ya=Promise.resolve(),this.ba=Promise.resolve(),this.va=!1,this.Sa=[],this.Da=null,this.Ca=!1,this.Fa=[],this.Na=new bu(this,"async_queue_retry"),this.$a=function(){return t.Na.br()};var e=Us.nt().window;e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.$a)}function $a(t,e,n,r,i){this.Ra=t,this.Er=e,this.Aa=n,this.op=r,this.ma=i,this.Pa=new wu,this.then=this.Pa.promise.then.bind(this.Pa.promise),this.Pa.promise.catch(function(t){})}function Za(t,e){if(Bs("AsyncQueue",e+": "+t),Fa(t))return new Ar(_r.UNAVAILABLE,e+": "+t);throw t}function th(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=Qs(n,i);return 0===s?Qs(r,o):s}var eh=(oh.prototype.Ha=function(){return++this.za},oh.prototype.Ya=function(t){var e,n=[t,this.Ha()];this.buffer.size<this.Ga?this.buffer=this.buffer.add(n):th(n,e=this.buffer.last())<0&&(this.buffer=this.buffer.delete(e).add(n))},Object.defineProperty(oh.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),oh),nh={Ja:!1,Xa:0,Za:0,tu:0},rh=(ih.nu=function(t){return new ih(t,ih.ru,ih.hu)},ih);function ih(t,e,n){this.eu=t,this.su=e,this.iu=n}function oh(t){this.Ga=t,this.buffer=new rs(th),this.za=0}rh.ou=-1,rh.au=1048576,rh.uu=41943040,rh.ru=10,rh.hu=1e3,rh.cu=new rh(rh.uu,rh.ru,rh.hu),rh.DISABLED=new rh(rh.ou,0,0);var sh=(fh.prototype.start=function(t){this.xo.du.eu!==rh.ou&&this.fu(t)},fh.prototype.stop=function(){this.lu&&(this.lu.cancel(),this.lu=null)},Object.defineProperty(fh.prototype,"ho",{get:function(){return null!==this.lu},enumerable:!0,configurable:!0}),fh.prototype.fu=function(n){var t=this,e=this._u?3e5:6e4;Fs("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.lu=this.Ra.yr("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.lu=null,this._u=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.Tu(this.xo)];case 2:return t.sent(),[3,7];case 3:return Fa(e=t.sent())?(Fs("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,yh(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.fu(n)];case 8:return t.sent(),[2]}})})})},fh),uh=(ch.prototype.Iu=function(t,e){return this.Eu.Lo(t).next(function(t){return Math.floor(e/100*t)})},ch.prototype.wu=function(t,e){var n=this;if(0===e)return nu.resolve(au.dr);var r=new eh(e);return this.Eu.js(t,function(t){return r.Ya(t.sequenceNumber)}).next(function(){return n.Eu.Bo(t,function(t){return r.Ya(t)})}).next(function(){return r.maxValue})},ch.prototype.Ah=function(t,e,n){return this.Eu.Ah(t,e,n)},ch.prototype.jo=function(t,e){return this.Eu.jo(t,e)},ch.prototype.Ru=function(e,n){var r=this;return this.du.eu===rh.ou?(Fs("LruGarbageCollector","Garbage collection skipped; disabled"),nu.resolve(nh)):this.Go(e).next(function(t){return t<r.du.eu?(Fs("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.du.eu),nh):r.Au(e,n)})},ch.prototype.Go=function(t){return this.Eu.Go(t)},ch.prototype.Au=function(e,n){var r,i,o,s,u,a,h,c=this,f=Date.now();return this.Iu(e,this.du.su).next(function(t){return i=t>c.du.iu?(Fs("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.du.iu+" from "+t),c.du.iu):t,s=Date.now(),c.wu(e,i)}).next(function(t){return r=t,u=Date.now(),c.Ah(e,r,n)}).next(function(t){return o=t,a=Date.now(),c.jo(e,r)}).next(function(t){return h=Date.now(),qs()<=p.DEBUG&&Fs("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(h-a)+"ms\nTotal Duration: "+(h-f)+"ms"),nu.resolve({Ja:!0,Xa:i,Za:o,tu:t})})},ch),ah=(hh.prototype.start=function(){return Promise.resolve()},hh.prototype.vu=function(i){return y(this,void 0,void 0,function(){var e,m,n,r=this;return v(this,function(t){switch(t.label){case 0:return e=this.Wn,m=this.yu,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return r.Wn.ea(v).next(function(t){return g=t,e=r.persistence.Do(i),m=new su(r.pu,e,r.persistence.$o()),e.ea(v)}).next(function(t){for(var e=[],n=[],r=fs(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,f=t;c<f.length;c++){var l=f[c];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Yn(v,r).next(function(t){return{Su:t,Du:e,Cu:n}})})})];case 1:return n=t.sent(),[2,(this.Wn=e,this.yu=m,this.mu.bu(this.yu),n)]}})})},hh.prototype.Fu=function(u){var a,h=this,c=Pr.now(),t=u.reduce(function(t,e){return t.add(e.key)},fs());return this.persistence.runTransaction("Locally write mutations","readwrite",function(s){return h.yu.Yn(s,t).next(function(t){a=t;for(var e=[],n=0,r=u;n<r.length;n++){var i=r[n],o=i.Pt(a.get(i.key));null!=o&&e.push(new Bi(i.key,o,oo(o.proto.mapValue),Mi.exists(!0)))}return h.Wn.Yo(s,c,e,u)})}).then(function(t){var e=t.In(a);return{batchId:t.batchId,Dn:e}})},hh.prototype.Nu=function(r){var i=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=r.batch.keys(),n=i.pu.Yr({Xr:!0});return i.$u(t,r,n).next(function(){return n.apply(t)}).next(function(){return i.Wn.ra(t)}).next(function(){return i.yu.Yn(t,e)})})},hh.prototype.ku=function(t){var r=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return r.Wn.Jo(e,t).next(function(t){return Ws(null!==t),n=t.keys(),r.Wn.ia(e,t)}).next(function(){return r.Wn.ra(e)}).next(function(){return r.yu.Yn(e,n)})})},hh.prototype.ta=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Wn.ta(t)})},hh.prototype._h=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Jh._h(t)})},hh.prototype.Mu=function(a){var h=this,c=a.Ee,f=this.Pu;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var i=h.pu.Yr({Xr:!0});f=h.Pu;var s=[];a.as.forEach(function(t,e){var n,r,i=f.get(e);i&&(s.push(h.Jh.bh(o,t.Is,e).next(function(){return h.Jh.ph(o,t.Ts,e)})),0<(n=t.resumeToken).rt()&&(r=i.we(n,c).Ie(o.Lh),f=f.Ae(e,r),hh.xu(i,r,t)&&s.push(h.Jh.Ih(o,r))))});var t,u=os,n=fs();return a.cs.forEach(function(t,e){n=n.add(t)}),s.push(i.getEntries(o,n).next(function(r){a.cs.forEach(function(t,e){var n=r.get(t);e instanceof Eo&&e.version.isEqual(Or.min())?(i.kn(t,c),u=u.Ae(t,e)):null==n||0<e.version.S(n.version)||0===e.version.S(n.version)&&n.hasPendingWrites?(i.Nn(e,c),u=u.Ae(t,e)):Fs("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a._s.has(t)&&s.push(h.persistence.hh.Ko(o,t))})})),c.isEqual(Or.min())||(t=h.Jh._h(o).next(function(t){return h.Jh.dh(o,o.Lh,c)}),s.push(t)),nu.vn(s).next(function(){return i.apply(o)}).next(function(){return h.yu.Jn(o,u)})}).then(function(t){return h.Pu=f,t})},hh.xu=function(t,e,n){return Ws(0<e.resumeToken.rt()),0===t.resumeToken.rt()||e.Ee.D()-t.Ee.D()>=this.Lu||0<n.Ts.size+n.Es.size+n.Is.size},hh.prototype.Ou=function(c){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return nu.forEach(c,function(e){return nu.forEach(e.hr,function(t){return h.persistence.hh.yh(n,e.targetId,t)}).next(function(){return nu.forEach(e.or,function(t){return h.persistence.hh.vh(n,e.targetId,t)})})})})];case 1:return t.sent(),[3,3];case 2:if(!Fa(e=t.sent()))throw e;return Fs("LocalStore","Failed to update sequence numbers: "+e),[3,3];case 3:for(n=0,r=c;n<r.length;n++)i=r[n],o=i.targetId,i.fromCache||(s=this.Pu.get(o),u=s.Ee,a=s.Re(u),this.Pu=this.Pu.Ae(o,a));return[2]}})})},hh.prototype.Bu=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Wn.Zo(t,e)})},hh.prototype.qu=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.yu.Kn(t,e)})},hh.prototype.Uu=function(r){var i=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Jh.gh(e,r).next(function(t){return t?(n=t,nu.resolve(n)):i.Jh.oh(e).next(function(t){return n=new ko(r,t,0,e.Lh),i.Jh.fh(e,n).next(function(){return n})})})}).then(function(t){var e=i.Pu.get(t.targetId);return(null===e||0<t.Ee.S(e.Ee))&&(i.Pu=i.Pu.Ae(t.targetId,t),i.Vu.set(r,t.targetId)),t})},hh.prototype.gh=function(t,e){var n=this.Vu.get(e);return void 0!==n?nu.resolve(this.Pu.get(n)):this.Jh.gh(t,e)},hh.prototype.Qu=function(t,e){var n=this,r=this.Pu.get(t),i=e?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release target",i,function(t){return e?nu.resolve():n.persistence.hh.removeTarget(t,r)}).then(function(){n.Pu=n.Pu.remove(t),n.Vu.delete(r.target)})},hh.prototype.Wu=function(t,n){var r=this,i=Or.min(),o=fs();return this.persistence.runTransaction("Execute query","readonly",function(e){return r.gh(e,t.ee()).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.Jh.Sh(e,t.targetId).next(function(t){o=t})}).next(function(){return r.mu.Zn(e,t,n?i:Or.min(),n?o:fs())}).next(function(t){return{documents:t,ju:o}})})},hh.prototype.$u=function(t,i,o){var e=this,s=i.batch,n=s.keys(),u=nu.resolve();return n.forEach(function(r){u=u.next(function(){return o.Mn(t,r)}).next(function(t){var e=t,n=i.Rn.get(r);Ws(null!==n),(!e||e.version.S(n)<0)&&(e=s.at(r,e,i))&&o.Nn(e,i.wn)})}),u.next(function(){return e.Wn.ia(t,s)})},hh.prototype.Tu=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Ru(t,n.Pu)})},hh);function hh(t,e,n){this.persistence=t,this.mu=e,this.Pu=new Xo(Qs),this.Vu=new Zs(function(t){return t.canonicalId()}),this.gu=Or.min(),this.Wn=t.Do(n),this.pu=t.No(),this.Jh=t.Fo(),this.yu=new su(this.pu,this.Wn,this.persistence.$o()),this.mu.bu(this.yu)}function ch(t,e){this.Eu=t,this.du=e}function fh(t,e){this.xo=t,this.Ra=e,this._u=!1,this.lu=null}ah.Lu=3e8;var lh,ph=(n(dh,lh=ah),dh.prototype.start=function(){return this.Ku()},dh.prototype.Gu=function(t){var n=this;return this.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return n.Wn.Xo(e,t).next(function(t){return t?n.yu.Yn(e,t):nu.resolve(null)})})},dh.prototype.zu=function(t){this.Wn.na(t)},dh.prototype.uo=function(t){this.persistence.uo(t)},dh.prototype.So=function(){return this.persistence.So()},dh.prototype.Hu=function(e){var n=this,t=this.Pu.get(e);return t?Promise.resolve(t.target):this.persistence.runTransaction("Get target data","readonly",function(t){return n.Jh.si(t,e).next(function(t){return t?t.target:null})})},dh.prototype.Kr=function(){var r=this;return this.persistence.runTransaction("Get new document changes","readonly",function(t){return r.pu.Kr(t,r.gu)}).then(function(t){var e=t.Gr,n=t.readTime;return r.gu=n,e})},dh.prototype.Ku=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,(e=this).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return n.pu.Hr(t)})];case 1:return e.gu=t.sent(),[2]}})})},dh);function dh(t,e,n){var r=this;return(r=lh.call(this,t,e,n)||this).persistence=t,r.Wn=t.Do(n),r.pu=t.No(),r.Jh=t.Fo(),r}function yh(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==_r.FAILED_PRECONDITION||e.message!==iu)throw e;return Fs("LocalStore","Unexpectedly lost primary lease"),[2]})})}var vh=(wh.prototype.B=function(){return this.Yu.B()},wh.prototype.yh=function(t,e){var n=new gh(t,e);this.Yu=this.Yu.add(n),this.Xu=this.Xu.add(n)},wh.prototype.tc=function(t,e){var n=this;t.forEach(function(t){return n.yh(t,e)})},wh.prototype.vh=function(t,e){this.ec(new gh(t,e))},wh.prototype.sc=function(t,e){var n=this;t.forEach(function(t){return n.vh(t,e)})},wh.prototype.ic=function(t){var e=this,n=Qr.EMPTY,r=new gh(n,t),i=new gh(n,t+1),o=[];return this.Xu.Ke([r,i],function(t){e.ec(t),o.push(t.key)}),o},wh.prototype.nc=function(){var e=this;this.Yu.forEach(function(t){return e.ec(t)})},wh.prototype.ec=function(t){this.Yu=this.Yu.delete(t),this.Xu=this.Xu.delete(t)},wh.prototype.rc=function(t){var e=Qr.EMPTY,n=new gh(e,t),r=new gh(e,t+1),i=fs();return this.Xu.Ke([n,r],function(t){i=i.add(t.key)}),i},wh.prototype.Ch=function(t){var e=new gh(t,0),n=this.Yu.ze(e);return null!==n&&t.isEqual(n.key)},wh),gh=(mh.Ju=function(t,e){return Qr.N(t.key,e.key)||Qs(t.hc,e.hc)},mh.Zu=function(t,e){return Qs(t.hc,e.hc)||Qr.N(t.key,e.key)},mh);function mh(t,e){this.key=t,this.hc=e}function wh(){this.Yu=new rs(gh.Ju),this.Xu=new rs(gh.Zu)}function bh(t,e){if(0!==e.length)throw new Ar(_r.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+jh(e.length,"argument")+".")}function Eh(t,e,n){if(e.length!==n)throw new Ar(_r.INVALID_ARGUMENT,"Function "+t+"() requires "+jh(n,"argument")+", but was called with "+jh(e.length,"argument")+".")}function Th(t,e,n){if(e.length<n)throw new Ar(_r.INVALID_ARGUMENT,"Function "+t+"() requires at least "+jh(n,"argument")+", but was called with "+jh(e.length,"argument")+".")}function Ih(t,e,n,r){if(e.length<n||e.length>r)throw new Ar(_r.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+jh(e.length,"argument")+".")}function Nh(t,e,n,r){Dh(t,e,Uh(n)+" argument",r)}function _h(t,e,n,r){void 0!==r&&Nh(t,e,n,r)}function Ah(t,e,n,r){Dh(t,e,n+" option",r)}function Sh(t,e,n,r){void 0!==r&&Ah(t,e,n,r)}function Rh(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(Oh(s))}var u=Oh(n);throw new Ar(_r.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function xh(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Ar(_r.INVALID_ARGUMENT,"Invalid value "+Oh(r)+" provided to function "+t+"() for its "+Uh(n)+" argument. Acceptable values: "+e.join(", "));return r}function Dh(t,e,n,r){if(!("object"===e?Ph(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=Oh(r);throw new Ar(_r.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function Ph(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Oh(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":zs();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function kh(t,e,n){if(void 0===n)throw new Ar(_r.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Uh(e)+" argument, but it was undefined.")}function Lh(n,t,r){Jr(t,function(t,e){if(r.indexOf(t)<0)throw new Ar(_r.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function Vh(t,e,n,r){var i=Oh(r);return new Ar(_r.INVALID_ARGUMENT,"Function "+t+"() requires its "+Uh(n)+" argument to be a "+e+", but it was: "+i)}function Ch(t,e,n){if(n<=0)throw new Ar(_r.INVALID_ARGUMENT,"Function "+t+"() requires its "+Uh(e)+" argument to be a positive number, but it was: "+n+".")}function Uh(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function jh(t,e){return t+" "+e+(1===t?"":"s")}function Mh(){if("undefined"==typeof Uint8Array)throw new Ar(_r.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function qh(){if(!Us.nt().oc)throw new Ar(_r.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function Fh(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Ar(_r.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(Nh("FieldPath","string",e,t[e]),0===t[e].length)throw new Ar(_r.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.uc=new Kr(t)}var Bh,Gh=(Kh.fromBase64String=function(t){Eh("Blob.fromBase64String",arguments,1),Nh("Blob.fromBase64String","string",1,t),qh();try{return new Kh(Zr.fromBase64String(t))}catch(t){throw new Ar(_r.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Kh.fromUint8Array=function(t){if(Eh("Blob.fromUint8Array",arguments,1),Mh(),!(t instanceof Uint8Array))throw Vh("Blob.fromUint8Array","Uint8Array",1,t);return new Kh(Zr.fromUint8Array(t))},Kh.prototype.toBase64=function(){return Eh("Blob.toBase64",arguments,0),qh(),this.ac.toBase64()},Kh.prototype.toUint8Array=function(){return Eh("Blob.toUint8Array",arguments,0),Mh(),this.ac.toUint8Array()},Kh.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Kh.prototype.isEqual=function(t){return this.ac.isEqual(t.ac)},Kh),zh=(n(Wh,Bh=Fh),Wh.documentId=function(){return Wh.cc},Wh.prototype.isEqual=function(t){if(!(t instanceof Wh))throw Vh("isEqual","FieldPath",1,t);return this.uc.isEqual(t.uc)},Wh);function Wh(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Bh.call(this,t)||this}function Kh(t){qh(),this.ac=t}zh.cc=new zh(Kr.J().j());var Hh,Qh,Yh,Xh,Jh,$h,Zh,tc=new RegExp("[~\\*/\\[\\]]"),ec=function(){this._c=this},nc=(n(Ic,Zh=ec),Ic.prototype.dc=function(t){if(2!==t.fc)throw 1===t.fc?t.Tc(this.lc+"() can only appear at the top level of your update data"):t.Tc(this.lc+"() cannot be used with set() unless you pass {merge:true}");return t.Vt.push(t.path),null},Ic.prototype.isEqual=function(t){return t instanceof Ic},Ic),rc=(n(Tc,$h=ec),Tc.prototype.dc=function(t){return new ji(t.path,Ti.instance)},Tc.prototype.isEqual=function(t){return t instanceof Tc},Tc),ic=(n(Ec,Jh=ec),Ec.prototype.dc=function(t){var e=new _c({fc:3,methodName:this.lc,Ic:!0},t.ii,t.serializer,t.ignoreUndefinedProperties),n=this.Ec.map(function(t){return xc(t,e)}),r=new Ni(n);return new ji(t.path,r)},Ec.prototype.isEqual=function(t){return this===t},Ec),oc=(n(bc,Xh=ec),bc.prototype.dc=function(t){var e=new _c({fc:3,methodName:this.lc,Ic:!0},t.ii,t.serializer,t.ignoreUndefinedProperties),n=this.Ec.map(function(t){return xc(t,e)}),r=new _i(n);return new ji(t.path,r)},bc.prototype.isEqual=function(t){return this===t},bc),sc=(n(wc,Yh=ec),wc.prototype.dc=function(t){var e=new _c({fc:3,methodName:this.lc},t.ii,t.serializer,t.ignoreUndefinedProperties),n=xc(this.wc,e),r=new Ai(t.serializer,n);return new ji(t.path,r)},wc.prototype.isEqual=function(t){return this===t},wc),uc=(n(mc,Qh=ec),mc.delete=function(){return bh("FieldValue.delete",arguments),new ac(new nc("FieldValue.delete"))},mc.serverTimestamp=function(){return bh("FieldValue.serverTimestamp",arguments),new ac(new rc("FieldValue.serverTimestamp"))},mc.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Th("FieldValue.arrayUnion",arguments,1),new ac(new ic("FieldValue.arrayUnion",t))},mc.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Th("FieldValue.arrayRemove",arguments,1),new ac(new oc("FieldValue.arrayRemove",t))},mc.increment=function(t){return Nh("FieldValue.increment","number",1,t),Eh("FieldValue.increment",arguments,1),new ac(new sc("FieldValue.increment",t))},mc),ac=(n(gc,Hh=uc),gc.prototype.dc=function(t){return this._c.dc(t)},gc.prototype.isEqual=function(t){return t instanceof gc&&this._c.isEqual(t._c)},gc),hc=(Object.defineProperty(vc.prototype,"latitude",{get:function(){return this.Rc},enumerable:!0,configurable:!0}),Object.defineProperty(vc.prototype,"longitude",{get:function(){return this.Ac},enumerable:!0,configurable:!0}),vc.prototype.isEqual=function(t){return this.Rc===t.Rc&&this.Ac===t.Ac},vc.prototype.p=function(t){return Qs(this.Rc,t.Rc)||Qs(this.Ac,t.Ac)},vc),cc=/^__.*__$/,fc=function(t,e,n){this.mc=t,this.Pc=e,this.Vc=n},lc=(yc.prototype.gc=function(t,e){var n=[];return null!==this.Vt?n.push(new Bi(t,this.data,this.Vt,e)):n.push(new Fi(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Gi(t,this.fieldTransforms)),n},yc),pc=(dc.prototype.gc=function(t,e){var n=[new Bi(t,this.data,this.Vt,e)];return 0<this.fieldTransforms.length&&n.push(new Gi(t,this.fieldTransforms)),n},dc);function dc(t,e,n){this.data=t,this.Vt=e,this.fieldTransforms=n}function yc(t,e,n){this.data=t,this.Vt=e,this.fieldTransforms=n}function vc(t,e){if(Eh("GeoPoint",arguments,2),Nh("GeoPoint","number",1,t),Nh("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Ar(_r.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Ar(_r.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Rc=t,this.Ac=e}function gc(t){var e=this;return(e=Hh.call(this)||this)._c=t,e.lc=t.lc,e}function mc(){return null!==Qh&&Qh.apply(this,arguments)||this}function wc(t,e){var n=this;return(n=Yh.call(this)||this).lc=t,n.wc=e,n}function bc(t,e){var n=this;return(n=Xh.call(this)||this).lc=t,n.Ec=e,n}function Ec(t,e){var n=this;return(n=Jh.call(this)||this).lc=t,n.Ec=e,n}function Tc(t){var e=this;return(e=$h.call(this)||this).lc=t,e}function Ic(t){var e=this;return(e=Zh.call(this)||this).lc=t,e}function Nc(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw zs()}}var _c=(Object.defineProperty(Rc.prototype,"path",{get:function(){return this.settings.path},enumerable:!0,configurable:!0}),Object.defineProperty(Rc.prototype,"fc",{get:function(){return this.settings.fc},enumerable:!0,configurable:!0}),Rc.prototype.yc=function(t){return new Rc(Object.assign(Object.assign({},this.settings),t),this.ii,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Vt)},Rc.prototype.bc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.yc({path:n,Ic:!1});return r.vc(t),r},Rc.prototype.Sc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.yc({path:n,Ic:!1});return r.pc(),r},Rc.prototype.Dc=function(t){return this.yc({path:void 0,Ic:!0})},Rc.prototype.Tc=function(t){var e=!this.path||this.path.B()?"":" (found in field "+this.path.toString()+")";return new Ar(_r.INVALID_ARGUMENT,"Function "+this.settings.methodName+"() called with invalid data. "+t+e)},Rc.prototype.contains=function(e){return void 0!==this.Vt.find(function(t){return e.q(t)})||void 0!==this.fieldTransforms.find(function(t){return e.q(t.field)})},Rc.prototype.pc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.vc(this.path.get(t))},Rc.prototype.vc=function(t){if(0===t.length)throw this.Tc("Document fields must not be empty");if(Nc(this.fc)&&cc.test(t))throw this.Tc('Document fields cannot begin and end with "__"')},Rc),Ac=(Sc.prototype.Fc=function(t,e,n){void 0===n&&(n={});var r=this.Nc(n.merge||n.mergeFields?2:0,t);Oc("Data must be an object, but it was:",r,e);var i,o,s=Dc(e,r);if(n.merge)i=new Ui(r.Vt),o=r.fieldTransforms;else if(n.mergeFields){for(var u=[],a=0,h=n.mergeFields;a<h.length;a++){var c=h[a],f=void 0;if(c instanceof Fh)f=c.uc;else{if("string"!=typeof c)throw zs();f=Lc(t,c)}if(!r.contains(f))throw new Ar(_r.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");Vc(u,f)||u.push(f)}i=new Ui(u),o=r.fieldTransforms.filter(function(t){return i.dt(t.field)})}else i=null,o=r.fieldTransforms;return new lc(new Ki(s),i,o)},Sc.prototype.$c=function(o,t){var s=this.Nc(1,o);Oc("Data must be an object, but it was:",s,t);var u=[],a=new Hi;Jr(t,function(t,e){var n,r=Lc(o,t),i=s.Sc(r);e instanceof ec&&e._c instanceof nc?u.push(r):null!=(n=xc(e,i))&&(u.push(r),a.set(r,n))});var e=new Ui(u);return new pc(a.yt(),e,s.fieldTransforms)},Sc.prototype.kc=function(t,e,n,r){var i=this.Nc(1,t),o=[kc(t,e)],s=[n];if(r.length%2!=0)throw new Ar(_r.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var u=0;u<r.length;u+=2)o.push(kc(t,r[u])),s.push(r[u+1]);for(var a,h,c,f,l=[],p=new Hi,d=o.length-1;0<=d;--d){Vc(l,o[d])||(a=o[d],h=s[d],c=i.Sc(a),h instanceof ec&&h._c instanceof nc?l.push(a):null!=(f=xc(h,c))&&(l.push(a),p.set(a,f)))}var y=new Ui(l);return new pc(p.yt(),y,i.fieldTransforms)},Sc.prototype.Nc=function(t,e){return new _c({fc:t,methodName:e,path:Kr.G,Ic:!1},this.ii,this.serializer,this.ignoreUndefinedProperties)},Sc.prototype.Mc=function(t,e,n){return void 0===n&&(n=!1),xc(e,this.Nc(n?4:3,t))},Sc);function Sc(t,e,n){this.ii=t,this.ignoreUndefinedProperties=e,this.serializer=n||Us.nt().Cc(t)}function Rc(t,e,n,r,i,o){this.settings=t,this.ii=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.pc(),this.fieldTransforms=i||[],this.Vt=o||[]}function xc(s,t){if(Pc(s))return Oc("Unsupported field value:",t,s),Dc(s,t);if(s instanceof ec)return function(t,e){if(!Nc(e.fc))throw e.Tc(t.lc+"() can only be used with update() and set()");if(!e.path)throw e.Tc(t.lc+"() is not currently supported inside arrays");var n=t.dc(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Vt.push(t.path),s instanceof Array){if(t.settings.Ic&&4!==t.fc)throw t.Tc("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=xc(i[r],t.Dc(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return e.serializer.ai(t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Pr.fromDate(t);return{timestampValue:e.serializer.C(n)}}if(t instanceof Pr){var r=new Pr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:e.serializer.C(r)}}if(t instanceof hc)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Gh)return{bytesValue:e.serializer.ui(t)};if(t instanceof fc){var i=e.ii,o=t.mc;if(!o.isEqual(i))throw e.Tc("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+i.projectId+"/"+i.database);return{referenceValue:e.serializer._i(t.Pc.path,t.mc)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.Tc("Unsupported field value: "+Oh(t))}(s,t)}function Dc(t,r){var i={};return $r(t)?r.path&&0<r.path.length&&r.Vt.push(r.path):Jr(t,function(t,e){var n=xc(e,r.bc(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function Pc(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Pr||t instanceof hc||t instanceof Gh||t instanceof fc||t instanceof ec)}function Oc(t,e,n){if(!Pc(n)||!Ph(n)){var r=Oh(n);throw"an object"===r?e.Tc(t+" a custom object"):e.Tc(t+" "+r)}}function kc(t,e){if(e instanceof Fh)return e.uc;if("string"==typeof e)return Lc(t,e);throw new Ar(_r.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function Lc(t,e){try{return function(e){if(0<=e.search(tc))throw new Ar(_r.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(zh.bind.apply(zh,d([void 0],e.split("."))))}catch(t){throw new Ar(_r.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).uc}catch(e){var n=e instanceof Error?e.message:e.toString();throw new Ar(_r.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function Vc(t,e){return t.some(function(t){return t.isEqual(e)})}var Cc,Uc,jc,Mc=($c.prototype.Uc=function(){return 1===this.state||2===this.state||4===this.state},$c.prototype.Qc=function(){return 2===this.state},$c.prototype.start=function(){3!==this.state?this.auth():this.Wc()},$c.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Uc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},$c.prototype.jc=function(){this.state=0,this.Na.reset()},$c.prototype.Kc=function(){var t=this;this.Qc()&&null===this.qc&&(this.qc=this.Tr.yr(this.xc,6e4,function(){return t.Gc()}))},$c.prototype.zc=function(t){this.Hc(),this.stream.send(t)},$c.prototype.Gc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.Qc()?[2,this.close(0)]:[2]})})},$c.prototype.Hc=function(){this.qc&&(this.qc.cancel(),this.qc=null)},$c.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Hc(),this.Na.cancel(),this.Bc++,3!==e?this.Na.reset():n&&n.code===_r.RESOURCE_EXHAUSTED?(Bs(n.toString()),Bs("Using maximum backoff delay to prevent overloading the backend."),this.Na.Vr()):n&&n.code===_r.UNAUTHENTICATED&&this.Oc._(),null!==this.stream&&(this.Yc(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Jc(n)];case 1:return t.sent(),[2]}})})},$c.prototype.Yc=function(){},$c.prototype.auth=function(){var n=this;this.state=1;var t=this.Xc(this.Bc),e=this.Bc;this.Oc.getToken().then(function(t){n.Bc===e&&n.Zc(t)},function(e){t(function(){var t=new Ar(_r.UNKNOWN,"Fetching auth token failed: "+e.message);return n.t_(t)})})},$c.prototype.Zc=function(t){var e=this,n=this.Xc(this.Bc);this.stream=this.e_(t),this.stream.s_(function(){n(function(){return e.state=2,e.listener.s_()})}),this.stream.Jc(function(t){n(function(){return e.t_(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},$c.prototype.Wc=function(){var t=this;this.state=4,this.Na.gr(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},$c.prototype.t_=function(t){return Fs("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},$c.prototype.Xc=function(e){var n=this;return function(t){n.Tr.co(function(){return n.Bc===e?t():(Fs("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},$c),qc=(n(Jc,jc=Mc),Jc.prototype.e_=function(t){return this.Lc.i_("Listen",t)},Jc.prototype.onMessage=function(t){this.Na.reset();var e=this.serializer.pi(t),n=this.serializer.bi(t);return this.listener.n_(e,n)},Jc.prototype.r_=function(t){var e={};e.database=this.serializer.wi,e.addTarget=this.serializer.ee(t);var n=this.serializer.zi(t);n&&(e.labels=n),this.zc(e)},Jc.prototype.h_=function(t){var e={};e.database=this.serializer.wi,e.removeTarget=t,this.zc(e)},Jc),Fc=(n(Xc,Uc=Mc),Object.defineProperty(Xc.prototype,"a_",{get:function(){return this.o_},enumerable:!0,configurable:!0}),Xc.prototype.start=function(){this.o_=!1,this.lastStreamToken=Zr.ht,Uc.prototype.start.call(this)},Xc.prototype.Yc=function(){this.o_&&this.u_([])},Xc.prototype.e_=function(t){return this.Lc.i_("Write",t)},Xc.prototype.onMessage=function(t){if(Ws(!!t.streamToken),this.lastStreamToken=this.serializer.ci(t.streamToken),this.o_){this.Na.reset();var e=this.serializer.xi(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.c_(n,e)}return Ws(!t.writeResults||0===t.writeResults.length),this.o_=!0,this.listener.__()},Xc.prototype.l_=function(){var t={};t.database=this.serializer.wi,this.zc(t)},Xc.prototype.u_=function(t){var e=this,n={streamToken:this.serializer.ui(this.lastStreamToken),writes:t.map(function(t){return e.serializer.vi(t)})};this.zc(n)},Xc),Bc=(n(Yc,Cc=function(){this.d_=void 0}),Yc.prototype.T_=function(){if(this.f_)throw new Ar(_r.FAILED_PRECONDITION,"The client has already been terminated.")},Yc.prototype.E_=function(e,n){var r=this;return this.T_(),this.credentials.getToken().then(function(t){return r.Lc.E_(e,n,t)}).catch(function(t){throw t.code===_r.UNAUTHENTICATED&&r.credentials._(),t})},Yc.prototype.I_=function(e,n){var r=this;return this.T_(),this.credentials.getToken().then(function(t){return r.Lc.I_(e,n,t)}).catch(function(t){throw t.code===_r.UNAUTHENTICATED&&r.credentials._(),t})},Yc),Gc=(Qc.prototype.V_=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.g_(),0<this.mutations.length)throw new Ar(_r.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e={database:(n=s).serializer.wi,documents:u.map(function(t){return n.serializer.fi(t)})},[4,n.I_("BatchGetDocuments",e)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e=n.serializer.gi(t);i.set(e.key.toString(),e)}),o=[],[2,(u.forEach(function(t){var e=i.get(t.toString());Ws(!!e),o.push(e)}),o)]}})})}(this.w_,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Eo||t instanceof bo?n.p_(t):zs()}),e)]}})})},Qc.prototype.set=function(t,e){this.write(e.gc(t,this.Rt(t))),this.P_.add(t)},Qc.prototype.update=function(t,e){try{this.write(e.gc(t,this.y_(t)))}catch(t){this.m_=t}this.P_.add(t)},Qc.prototype.delete=function(t){this.write([new zi(t,this.Rt(t))]),this.P_.add(t)},Qc.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,r=this;return v(this,function(t){switch(t.label){case 0:if(this.g_(),this.m_)throw this.m_;return e=this.R_,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=new Qr(Lr.K(e));r.mutations.push(new Wi(n,r.Rt(n)))}),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return n={database:(e=r).serializer.wi,writes:i.map(function(t){return e.serializer.vi(t)})},[4,e.E_("Commit",n)];case 1:return t.sent(),[2]}})})}(this.w_,this.mutations)];case 1:return t.sent(),this.A_=!0,[2]}})})},Qc.prototype.p_=function(t){var e;if(t instanceof bo)e=t.version;else{if(!(t instanceof Eo))throw zs();e=Or.min()}var n=this.R_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Ar(_r.ABORTED,"Document version changed between two reads.")}else this.R_.set(t.key.toString(),e)},Qc.prototype.Rt=function(t){var e=this.R_.get(t.toString());return!this.P_.has(t)&&e?Mi.updateTime(e):Mi.ft()},Qc.prototype.y_=function(t){var e=this.R_.get(t.toString());if(this.P_.has(t)||!e)return Mi.exists(!0);if(e.isEqual(Or.min()))throw new Ar(_r.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Mi.updateTime(e)},Qc.prototype.write=function(t){this.g_(),this.mutations=this.mutations.concat(t)},Qc.prototype.g_=function(){},Qc),zc=(Hc.prototype.C_=function(){var t=this;0===this.v_&&(this.F_("Unknown"),this.S_=this.Ra.yr("online_state_timeout",1e4,function(){return t.S_=null,t.N_("Backend didn't respond within 10 seconds."),t.F_("Offline"),Promise.resolve()}))},Hc.prototype.k_=function(t){"Online"===this.state?this.F_("Unknown"):(this.v_++,1<=this.v_&&(this.M_(),this.N_("Connection failed 1 times. Most recent error: "+t.toString()),this.F_("Offline")))},Hc.prototype.set=function(t){this.M_(),this.v_=0,"Online"===t&&(this.D_=!1),this.F_(t)},Hc.prototype.F_=function(t){t!==this.state&&(this.state=t,this.b_(t))},Hc.prototype.N_=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.D_?(Bs(e),this.D_=!1):Fs("OnlineStateTracker",e)},Hc.prototype.M_=function(){null!==this.S_&&(this.S_.cancel(),this.S_=null)},Hc),Wc=(Kc.prototype.start=function(){return this.enableNetwork()},Kc.prototype.enableNetwork=function(){return this.networkEnabled=!0,this.el()},Kc.prototype.el=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.W_()?(this.sl()?this.il():this.K_.set("Unknown"),[4,this.nl()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Kc.prototype.disableNetwork=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.rl()];case 1:return t.sent(),this.K_.set("Offline"),[2]}})})},Kc.prototype.rl=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.J_.stop()];case 1:return t.sent(),[4,this.G_.stop()];case 2:return t.sent(),0<this.L_.length&&(Fs("RemoteStore","Stopping write stream with "+this.L_.length+" pending writes"),this.L_=[]),this.hl(),[2]}})})},Kc.prototype.Vo=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Fs("RemoteStore","RemoteStore shutting down."),this.networkEnabled=!1,[4,this.rl()];case 1:return t.sent(),this.U_.Vo(),this.K_.set("Unknown"),[2]}})})},Kc.prototype.listen=function(t){this.O_.has(t.targetId)||(this.O_.set(t.targetId,t),this.sl()?this.il():this.G_.Qc()&&this.ol(t))},Kc.prototype.al=function(t){this.O_.delete(t),this.G_.Qc()&&this.ul(t),0===this.O_.size&&(this.G_.Qc()?this.G_.Kc():this.W_()&&this.K_.set("Unknown"))},Kc.prototype.si=function(t){return this.O_.get(t)||null},Kc.prototype.ei=function(t){return this.cl.ei(t)},Kc.prototype.ol=function(t){this.B_.Ns(t.targetId),this.G_.r_(t)},Kc.prototype.ul=function(t){this.B_.Ns(t),this.G_.h_(t)},Kc.prototype.il=function(){this.B_=new Ts(this),this.G_.start(),this.K_.C_()},Kc.prototype.sl=function(){return this.W_()&&!this.G_.Uc()&&0<this.O_.size},Kc.prototype.W_=function(){return!this.q_&&this.isPrimary&&this.networkEnabled},Kc.prototype.hl=function(){this.B_=null},Kc.prototype.z_=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){return this.O_.forEach(function(t,e){n.ol(t)}),[2]})})},Kc.prototype.H_=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return this.hl(),this.sl()?(this.K_.k_(e),this.il()):this.K_.set("Unknown"),[2]})})},Kc.prototype.Y_=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:if(this.K_.set("Online"),!(i instanceof ys&&2===i.state&&i.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this._l(i)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Fs("RemoteStore","Failed to remove targets %s: %s ",i.targetIds.join(","),e),[4,this.ll(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(i instanceof ps?this.B_.qs(i):i instanceof ds?this.B_.Hs(i):this.B_.Ws(i),o.isEqual(Or.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,this.x_._h()];case 8:return n=t.sent(),0<=o.S(n)?[4,this.dl(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Fs("RemoteStore","Failed to raise snapshot:",r=t.sent()),[4,this.ll(r)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},Kc.prototype.ll=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!Fa(n))throw n;return this.q_=!0,[4,this.rl()];case 1:return t.sent(),this.K_.set("Offline"),r=r||function(){return e.x_._h()},this.Ra.lo(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Fs("RemoteStore","Retrying IndexedDB access"),[4,r()];case 1:return t.sent(),this.q_=!1,[4,this.el()];case 2:return t.sent(),[2]}})})}),[2]}})})},Kc.prototype.fl=function(e){var n=this;return e().catch(function(t){return n.ll(t,e)})},Kc.prototype.dl=function(r){var i=this,t=this.B_.Xs(r);return t.as.forEach(function(t,e){var n;0<t.resumeToken.rt()&&((n=i.O_.get(e))&&i.O_.set(e,n.we(t.resumeToken,r)))}),t.us.forEach(function(t){var e,n=i.O_.get(t);n&&(i.O_.set(t,n.we(Zr.ht,n.Ee)),i.ul(t),e=new ko(n.target,t,1,n.sequenceNumber),i.ol(e))}),this.cl.Mu(t)},Kc.prototype._l=function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=o.cause,n=0,r=o.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],this.O_.has(i)?[4,this.cl.Tl(i,e)]:[3,3]):[3,5];case 2:t.sent(),this.O_.delete(i),this.B_.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},Kc.prototype.nl=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=0<this.L_.length?this.L_[this.L_.length-1].batchId:-1,t.label=1;case 1:if(!this.El())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,this.x_.Bu(e)];case 3:return null===(n=t.sent())?(0===this.L_.length&&this.J_.Kc(),[3,7]):(e=n.batchId,this.Il(n),[3,6]);case 4:return r=t.sent(),[4,this.ll(r)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.wl()&&this.Rl(),[2]}})})},Kc.prototype.El=function(){return this.W_()&&this.L_.length<10},Kc.prototype.Al=function(){return this.L_.length},Kc.prototype.Il=function(t){this.L_.push(t),this.J_.Qc()&&this.J_.a_&&this.J_.u_(t.mutations)},Kc.prototype.wl=function(){return this.W_()&&!this.J_.Uc()&&0<this.L_.length},Kc.prototype.Rl=function(){this.J_.start()},Kc.prototype.X_=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.J_.l_(),[2]})})},Kc.prototype.tl=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){for(e=0,n=this.L_;e<n.length;e++)r=n[e],this.J_.u_(r.mutations);return[2]})})},Kc.prototype.c_=function(i,o){return y(this,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){switch(t.label){case 0:return e=this.L_.shift(),n=eu.from(e,i,o),[4,this.fl(function(){return r.cl.ml(n)})];case 1:return t.sent(),[4,this.nl()];case 2:return t.sent(),[2]}})})},Kc.prototype.Z_=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e&&this.J_.a_?[4,this.Pl(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.wl()&&this.Rl(),[2]}})})},Kc.prototype.Pl=function(i){return y(this,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){switch(t.label){case 0:return Qo(n=i.code)&&n!==_r.ABORTED?(e=this.L_.shift(),this.J_.jc(),[4,this.fl(function(){return r.cl.Vl(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,this.nl()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Kc.prototype.gl=function(){return new Gc(this.w_)},Kc.prototype.j_=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.rl()];case 1:return t.sent(),this.K_.set("Unknown"),[4,this.enableNetwork()];case 2:return t.sent(),[2]}})})},Kc.prototype.pl=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.W_()?(Fs("RemoteStore","RemoteStore restarting streams for new credential"),[4,this.j_()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Kc.prototype.yl=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return(this.isPrimary=e)&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:[4,this.rl()];case 3:t.sent(),this.K_.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},Kc);function Kc(t,e,n,r,i){var o,s,u,a,h,c,f=this;this.x_=t,this.w_=e,this.Ra=n,this.L_=[],this.O_=new Map,this.B_=null,this.networkEnabled=!1,this.isPrimary=!1,this.q_=!1,this.U_=i,this.U_.Q_(function(t){n.co(function(){return y(f,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.W_()?(Fs("RemoteStore","Restarting streams for network reachability change."),[4,this.j_()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.K_=new zc(n,r),this.G_=(a=this.w_,h=n,c={s_:this.z_.bind(this),Jc:this.H_.bind(this),n_:this.Y_.bind(this)},new qc(h,a.Lc,a.credentials,a.serializer,c)),this.J_=(o=this.w_,s=n,u={s_:this.X_.bind(this),Jc:this.Z_.bind(this),__:this.tl.bind(this),c_:this.c_.bind(this)},new Fc(s,o.Lc,o.credentials,o.serializer,u))}function Hc(t,e){this.Ra=t,this.b_=e,this.state="Unknown",this.v_=0,this.S_=null,this.D_=!0}function Qc(t){this.w_=t,this.R_=new Map,this.mutations=[],this.A_=!1,this.m_=null,this.P_=new Set}function Yc(t,e,n){var r=this;return(r=Cc.call(this)||this).Lc=t,r.credentials=e,r.serializer=n,r.f_=!1,r}function Xc(t,e,n,r,i){var o=this;return(o=Uc.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.o_=!1,o.lastStreamToken=Zr.ht,o}function Jc(t,e,n,r,i){var o=this;return(o=jc.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function $c(t,e,n,r,i,o){this.Tr=t,this.xc=n,this.Lc=r,this.Oc=i,this.listener=o,this.state=0,this.Bc=0,this.qc=null,this.stream=null,this.Na=new bu(t,e)}function Zc(t,e){return"firestore_clients_"+t+"_"+e}function tf(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.t()&&(r+="_"+e.uid),r}function ef(t,e){return"firestore_targets_"+t+"_"+e}function nf(t){this.key=t}function rf(t){this.key=t}function of(t,e,n){this.query=t,this.targetId=e,this.view=n}function sf(t){this.key=t,this.Qd=!1}function uf(){this.bf=void 0,this.vf=[]}var af,hf,cf=(Ff.bl=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Ar(r.error.code,r.error.message)),i?new Ff(t,e,r.state,o):(Bs("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},Ff.prototype.vl=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Ff),ff=(qf.bl=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Ar(n.error.code,n.error.message)),r?new qf(t,n.state,i):(Bs("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},qf.prototype.vl=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},qf),lf=(Mf.bl=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=ls,o=0;r&&o<n.activeTargetIds.length;++o)r=ri(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new Mf(t,i):(Bs("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},Mf),pf=(jf.bl=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new jf(e.clientId,e.onlineState):(Bs("SharedClientState","Failed to parse online state: "+t),null)},jf),df=(Uf.prototype.Sl=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Uf.prototype.Dl=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Uf.prototype.vl=function(){var t={activeTargetIds:this.activeTargetIds.W(),updateTimeMs:Date.now()};return JSON.stringify(t)},Uf),yf=(Cf.zh=function(t){return!(!t.window||null==t.window.localStorage)},Cf.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f,l=this;return v(this,function(t){switch(t.label){case 0:return[4,this.cl.So()];case 1:for(e=t.sent(),n=0,r=e;n<r.length;n++)(i=r[n])!==this.Cl&&(o=this.getItem(Zc(this.persistenceKey,i)))&&(s=lf.bl(i,o))&&(this.$l=this.$l.Ae(s.clientId,s));for(this.Ul(),(u=this.storage.getItem(this.ql))&&(a=this.Ql(u))&&this.Wl(a),h=0,c=this.kl;h<c.length;h++)f=c[h],this.Nl(f);return this.kl=[],this.platform.window.addEventListener("unload",function(){return l.Vo()}),this.ho=!0,[2]}})})},Cf.prototype.lr=function(t){this.setItem(this.xl,JSON.stringify(t))},Cf.prototype.jl=function(){return this.Kl(this.$l)},Cf.prototype.Gl=function(n){var r=!1;return this.$l.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},Cf.prototype.zl=function(t){this.Hl(t,"pending")},Cf.prototype.Yl=function(t,e,n){this.Hl(t,e,n),this.Jl(t)},Cf.prototype.Xl=function(t){var e,n,r="not-current";return this.Gl(t)&&(!(e=this.storage.getItem(ef(this.persistenceKey,t)))||(n=ff.bl(t,e))&&(r=n.state)),this.Zl.Sl(t),this.Ul(),r},Cf.prototype.td=function(t){this.Zl.Dl(t),this.Ul()},Cf.prototype.ed=function(t){return this.Zl.activeTargetIds.has(t)},Cf.prototype.sd=function(t){this.removeItem(ef(this.persistenceKey,t))},Cf.prototype.nd=function(t,e,n){this.rd(t,e,n)},Cf.prototype.vu=function(t,e,n){var r=this;e.forEach(function(t){r.Jl(t)}),this.currentUser=t,n.forEach(function(t){r.zl(t)})},Cf.prototype.hd=function(t){this.od(t)},Cf.prototype.Vo=function(){this.ho&&(this.platform.window.removeEventListener("storage",this.Fl),this.removeItem(this.Ml),this.ho=!1)},Cf.prototype.getItem=function(t){var e=this.storage.getItem(t);return Fs("SharedClientState","READ",t,e),e},Cf.prototype.setItem=function(t,e){Fs("SharedClientState","SET",t,e),this.storage.setItem(t,e)},Cf.prototype.removeItem=function(t){Fs("SharedClientState","REMOVE",t),this.storage.removeItem(t)},Cf.prototype.Nl=function(u){var t=this;if(u.storageArea===this.storage){if(Fs("SharedClientState","EVENT",u.key,u.newValue),u.key===this.Ml)return void Bs("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Tr.lo(function(){return y(t,void 0,void 0,function(){var e,n,r,i,o,s;return v(this,function(t){if(this.ho){if(null!==u.key)if(this.Ll.test(u.key)){if(null==u.newValue)return e=this.ad(u.key),[2,this.ud(e,null)];if(n=this._d(u.key,u.newValue))return[2,this.ud(n.clientId,n)]}else if(this.Ol.test(u.key)){if(null!==u.newValue&&(r=this.ld(u.key,u.newValue)))return[2,this.dd(r)]}else if(this.Bl.test(u.key)){if(null!==u.newValue&&(i=this.fd(u.key,u.newValue)))return[2,this.Td(i)]}else if(u.key===this.ql){if(null!==u.newValue&&(o=this.Ql(u.newValue)))return[2,this.Wl(o)]}else u.key===this.xl&&(s=function(t){var e=au.dr;if(null!=t)try{var n=JSON.parse(t);Ws("number"==typeof n),e=n}catch(t){Bs("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(u.newValue))!==au.dr&&this.ur(s)}else this.kl.push(u);return[2]})})})}},Object.defineProperty(Cf.prototype,"Zl",{get:function(){return this.$l.get(this.Cl)},enumerable:!0,configurable:!0}),Cf.prototype.Ul=function(){this.setItem(this.Ml,this.Zl.vl())},Cf.prototype.Hl=function(t,e,n){var r=new cf(this.currentUser,t,e,n),i=tf(this.persistenceKey,this.currentUser,t);this.setItem(i,r.vl())},Cf.prototype.Jl=function(t){var e=tf(this.persistenceKey,this.currentUser,t);this.removeItem(e)},Cf.prototype.od=function(t){var e={clientId:this.Cl,onlineState:t};this.storage.setItem(this.ql,JSON.stringify(e))},Cf.prototype.rd=function(t,e,n){var r=ef(this.persistenceKey,t),i=new ff(t,e,n);this.setItem(r,i.vl())},Cf.prototype.ad=function(t){var e=this.Ll.exec(t);return e?e[1]:null},Cf.prototype._d=function(t,e){var n=this.ad(t);return lf.bl(n,e)},Cf.prototype.ld=function(t,e){var n=this.Ol.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return cf.bl(new br(i),r,e)},Cf.prototype.fd=function(t,e){var n=this.Bl.exec(t),r=Number(n[1]);return ff.bl(r,e)},Cf.prototype.Ql=function(t){return pf.bl(t)},Cf.prototype.dd=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.cl.Ed(e.batchId,e.state,e.error)]:(Fs("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},Cf.prototype.Td=function(t){return this.cl.Id(t.targetId,t.state,t.error)},Cf.prototype.ud=function(t,e){var n=this,r=e?this.$l.Ae(t,e):this.$l.remove(t),i=this.Kl(this.$l),o=this.Kl(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.cl.wd(s,u).then(function(){n.$l=r})},Cf.prototype.Wl=function(t){this.$l.get(t.clientId)&&this.b_(t.onlineState)},Cf.prototype.Kl=function(t){var n=ls;return t.forEach(function(t,e){n=n.He(e.activeTargetIds)}),n},Cf),vf=(Vf.prototype.zl=function(t){},Vf.prototype.Yl=function(t,e,n){},Vf.prototype.Xl=function(t){return this.Rd.Sl(t),this.Ad[t]||"not-current"},Vf.prototype.nd=function(t,e,n){this.Ad[t]=e},Vf.prototype.td=function(t){this.Rd.Dl(t)},Vf.prototype.ed=function(t){return this.Rd.activeTargetIds.has(t)},Vf.prototype.sd=function(t){delete this.Ad[t]},Vf.prototype.jl=function(){return this.Rd.activeTargetIds},Vf.prototype.Gl=function(t){return this.Rd.activeTargetIds.has(t)},Vf.prototype.start=function(){return this.Rd=new df,Promise.resolve()},Vf.prototype.vu=function(t,e,n){},Vf.prototype.hd=function(t){},Vf.prototype.Vo=function(){},Vf.prototype.lr=function(t){},Vf),gf=(Object.defineProperty(Lf.prototype,"pd",{get:function(){return this.md},enumerable:!0,configurable:!0}),Lf.prototype.yd=function(t,e){var u=this,a=e?e.bd:new gs,h=e?e.gd:this.gd,c=e?e.ns:this.ns,f=h,l=!1,p=this.query.oe()&&h.size===this.query.limit?h.last():null,d=this.query.ae()&&h.size===this.query.limit?h.first():null;if(t.pe(function(t,e){var n=h.get(t),r=(r=e instanceof bo?e:null)&&(u.query.matches(r)?r:null),i=!!n&&u.ns.has(n.key),o=!!r&&(r.At||u.ns.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(a.track({type:3,doc:r}),s=!0):u.vd(n,r)||(a.track({type:2,doc:r}),s=!0,(p&&0<u.query.se(r,p)||d&&u.query.se(r,d)<0)&&(l=!0)):!n&&r?(a.track({type:0,doc:r}),s=!0):n&&!r&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(l=!0)),s&&(c=r?(f=f.add(r),o?c.add(t):c.delete(t)):(f=f.delete(t),c.delete(t)))}),this.query.oe()||this.query.ae())for(;f.size>this.query.limit;){var n=this.query.oe()?f.last():f.first(),f=f.delete(n.key),c=c.delete(n.key);a.track({type:1,doc:n})}return{gd:f,bd:a,Sd:l,ns:c}},Lf.prototype.vd=function(t,e){return t.At&&e.hasCommittedMutations&&!e.At},Lf.prototype.On=function(t,e,n){var o=this,r=this.gd;this.gd=t.gd,this.ns=t.ns;var i=t.bd.es();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.query.se(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return zs()}}var r,i}),this.Dd(n);var s=e?this.Cd():[],u=0===this.Vd.size&&this.fs?1:0,a=u!==this.Pd;return this.Pd=u,0!==i.length||a?{snapshot:new ms(this.query,t.gd,r,i,t.ns,0==u,a,!1),Fd:s}:{Fd:s}},Lf.prototype.Nd=function(t){return this.fs&&"Offline"===t?(this.fs=!1,this.On({gd:this.gd,bd:new gs,ns:this.ns,Sd:!1},!1)):{Fd:[]}},Lf.prototype.$d=function(t){return!this.md.has(t)&&!!this.gd.has(t)&&!this.gd.get(t).At},Lf.prototype.Dd=function(t){var e=this;t&&(t.Ts.forEach(function(t){return e.md=e.md.add(t)}),t.Es.forEach(function(t){}),t.Is.forEach(function(t){return e.md=e.md.delete(t)}),this.fs=t.fs)},Lf.prototype.Cd=function(){var e=this;if(!this.fs)return[];var n=this.Vd;this.Vd=fs(),this.gd.forEach(function(t){e.$d(t.key)&&(e.Vd=e.Vd.add(t.key))});var r=[];return n.forEach(function(t){e.Vd.has(t)||r.push(new rf(t))}),this.Vd.forEach(function(t){n.has(t)||r.push(new nf(t))}),r},Lf.prototype.kd=function(t){this.md=t.ju,this.Vd=fs();var e=this.yd(t.documents);return this.On(e,!0)},Lf.prototype.Md=function(){return ms.os(this.query,this.gd,this.ns,0===this.Pd)},Lf),mf=(kf.prototype.Ld=function(){this.Od()},kf.prototype.Od=function(){var t=this;this.Na.gr(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Gc(this.w_),(n=this.Bd(e))&&n.then(function(t){r.Ra.co(function(){return e.commit().then(function(){r.Pa.resolve(t)}).catch(function(t){r.qd(t)})})}).catch(function(t){r.qd(t)}),[2]})})})},kf.prototype.Bd=function(t){try{var e=this.updateFunction(t);return!ei(e)&&e.catch&&e.then?e:(this.Pa.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Pa.reject(t),null}},kf.prototype.qd=function(t){var e=this;0<this.xd&&this.Ud(t)?(--this.xd,this.Ra.co(function(){return e.Od(),Promise.resolve()})):this.Pa.reject(t)},kf.prototype.Ud=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Qo(e)},kf),wf=(Object.defineProperty(Of.prototype,"if",{get:function(){return!0},enumerable:!0,configurable:!0}),Of.prototype.subscribe=function(t){this.Gd=t},Of.prototype.listen=function(s){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return this.nf("listen()"),(r=this.zd.get(s))?(e=r.targetId,this.jd.Xl(e),n=r.view.Md(),[3,4]):[3,1];case 1:return[4,this.x_.Uu(s.ee())];case 2:return i=t.sent(),o=this.jd.Xl(i.targetId),e=i.targetId,[4,this.rf(s,e,"current"===o)];case 3:n=t.sent(),this.if&&this.Wd.listen(i),t.label=4;case 4:return[2,n]}})})},Of.prototype.rf=function(u,a,h){return y(this,void 0,void 0,function(){var e,n,r,i,o,s;return v(this,function(t){switch(t.label){case 0:return[4,this.x_.Wu(u,!0)];case 1:return e=t.sent(),n=new gf(u,e.ju),r=n.yd(e.documents),i=bs.ds(a,h&&"Offline"!==this.onlineState),o=n.On(r,this.if,i),this.hf(a,o.Fd),s=new of(u,a,n),[2,(this.zd.set(u,s),this.Hd.has(a)?this.Hd.get(a).push(u):this.Hd.set(a,[u]),o.snapshot)]}})})},Of.prototype.al=function(i){return y(this,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){switch(t.label){case 0:return this.nf("unlisten()"),e=this.zd.get(i),1<(n=this.Hd.get(e.targetId)).length?[2,(this.Hd.set(e.targetId,n.filter(function(t){return!t.isEqual(i)})),void this.zd.delete(i))]:this.if?(this.jd.td(e.targetId),this.jd.Gl(e.targetId)?[3,2]:[4,this.x_.Qu(e.targetId,!1).then(function(){r.jd.sd(e.targetId),r.Wd.al(e.targetId),r.af(e.targetId)}).catch(yh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.af(e.targetId),[4,this.x_.Qu(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},Of.prototype.write=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:this.nf("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,this.x_.Fu(i)];case 2:return e=t.sent(),this.jd.zl(e.batchId),this.uf(e.batchId,o),[4,this.cf(e.Dn)];case 3:return t.sent(),[4,this.Wd.nl()];case 4:return t.sent(),[3,6];case 5:return n=t.sent(),r=Za(n,"Failed to persist write"),o.reject(r),[3,6];case 6:return[2]}})})},Of.prototype.runTransaction=function(t,e,n){new mf(t,this.w_,e,n).Ld()},Of.prototype.Mu=function(n){return y(this,void 0,void 0,function(){var e,r=this;return v(this,function(t){switch(t.label){case 0:this.nf("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.x_.Mu(n)];case 2:return e=t.sent(),n.as.forEach(function(t,e){var n=r.Xd.get(e);n&&(Ws(t.Ts.size+t.Es.size+t.Is.size<=1),0<t.Ts.size?n.Qd=!0:0<t.Es.size?Ws(n.Qd):0<t.Is.size&&(Ws(n.Qd),n.Qd=!1))}),[4,this.cf(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,yh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Of.prototype.Nd=function(r,t){this.nf("applyOnlineStateChange()");var i=[];this.zd.forEach(function(t,e){var n=e.view.Nd(r);n.snapshot&&i.push(n.snapshot)}),this.Gd._f(r),this.Gd.n_(i),this.onlineState=r},Of.prototype.Tl=function(u,a){return y(this,void 0,void 0,function(){var e,n,r,i,o,s=this;return v(this,function(t){switch(t.label){case 0:return this.nf("rejectListens()"),this.jd.nd(u,"rejected",a),e=this.Xd.get(u),(n=e&&e.key)?(r=(r=new Xo(Qr.N)).Ae(n,new Eo(n,Or.min())),i=fs().add(n),o=new ws(Or.min(),new Map,new rs(Qs),r,i),[4,this.Mu(o)]):[3,2];case 1:return t.sent(),this.Jd=this.Jd.remove(n),this.Xd.delete(u),this.lf(),[3,4];case 2:return[4,this.x_.Qu(u,!1).then(function(){return s.af(u,a)}).catch(yh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},Of.prototype.ml=function(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:this.nf("applySuccessfulWrite()"),e=r.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.x_.Nu(r)];case 2:return n=t.sent(),this.df(e,null),this.ff(e),this.jd.Yl(e,"acknowledged"),[4,this.cf(n)];case 3:return t.sent(),[3,6];case 4:return[4,yh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Of.prototype.Vl=function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.nf("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.x_.ku(n)];case 2:return e=t.sent(),this.df(n,r),this.ff(n),this.jd.Yl(n,"rejected",r),[4,this.cf(e)];case 3:return t.sent(),[3,6];case 4:return[4,yh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},Of.prototype.Tf=function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:this.Wd.W_()||Fs("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.x_.ta()];case 2:return-1===(e=t.sent())?[2,void o.resolve()]:((n=this.ef.get(e)||[]).push(o),this.ef.set(e,n),[3,4]);case 3:return r=t.sent(),i=Za(r,"Initialization of waitForPendingWrites() operation failed"),o.reject(i),[3,4];case 4:return[2]}})})},Of.prototype.ff=function(t){(this.ef.get(t)||[]).forEach(function(t){t.resolve()}),this.ef.delete(t)},Of.prototype.Ef=function(e){this.ef.forEach(function(t){t.forEach(function(t){t.reject(new Ar(_r.CANCELLED,e))})}),this.ef.clear()},Of.prototype.uf=function(t,e){var n=(n=(n=this.tf[this.currentUser.s()])||new Xo(Qs)).Ae(t,e);this.tf[this.currentUser.s()]=n},Of.prototype.df=function(t,e){var n,r=this.tf[this.currentUser.s()];r&&((n=r.get(t))&&(e?n.reject(e):n.resolve(),r=r.remove(t)),this.tf[this.currentUser.s()]=r)},Of.prototype.af=function(t,e){var n=this;void 0===e&&(e=null),this.jd.td(t);for(var r=0,i=this.Hd.get(t);r<i.length;r++){var o=i[r];this.zd.delete(o),e&&this.Gd.If(o,e)}this.Hd.delete(t),this.if&&this.Zd.ic(t).forEach(function(t){n.Zd.Ch(t)||n.wf(t)})},Of.prototype.wf=function(t){var e=this.Jd.get(t);null!==e&&(this.Wd.al(e),this.Jd=this.Jd.remove(t),this.Xd.delete(e),this.lf())},Of.prototype.hf=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof nf?(this.Zd.yh(i.key,t),this.Rf(i)):i instanceof rf?(Fs("SyncEngine","Document no longer in limbo: "+i.key),this.Zd.vh(i.key,t),this.Zd.Ch(i.key)||this.wf(i.key)):zs()}},Of.prototype.Rf=function(t){var e=t.key;this.Jd.get(e)||(Fs("SyncEngine","New document in limbo: "+e),this.Yd.push(e),this.lf())},Of.prototype.lf=function(){for(;0<this.Yd.length&&this.Jd.size<this.Kd;){var t=this.Yd.shift(),e=this.sf.next();this.Xd.set(e,new sf(t)),this.Jd=this.Jd.Ae(t,e),this.Wd.listen(new ko(No.Wt(t.path).ee(),e,2,au.dr))}},Of.prototype.Af=function(){return this.Jd},Of.prototype.mf=function(){return this.Yd},Of.prototype.cf=function(r,a){return y(this,void 0,void 0,function(){var o,s,e,u=this;return v(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.zd.forEach(function(t,i){e.push(Promise.resolve().then(function(){var n=i.view.yd(r);return n.Sd?u.x_.Wu(i.query,!1).then(function(t){var e=t.documents;return i.view.yd(e,n)}):n}).then(function(t){var e,n=a&&a.as.get(i.targetId),r=i.view.On(t,u.if,n);u.hf(i.targetId,r.Fd),r.snapshot&&(u.if&&u.jd.nd(i.targetId,r.snapshot.fromCache?"not-current":"current"),o.push(r.snapshot),e=uu.ar(i.targetId,r.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.Gd.n_(o),[4,this.x_.Ou(s)];case 2:return t.sent(),[2]}})})},Of.prototype.nf=function(t){},Of.prototype.pl=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:[4,this.x_.vu(n)];case 1:return e=t.sent(),this.currentUser=n,this.Ef("'waitForPendingWrites' promise is rejected due to a user change."),this.jd.vu(n,e.Du,e.Cu),[4,this.cf(e.Su)];case 2:t.sent(),t.label=3;case 3:return[4,this.Wd.pl()];case 4:return t.sent(),[2]}})})},Of.prototype.enableNetwork=function(){return this.Wd.enableNetwork()},Of.prototype.disableNetwork=function(){return this.Wd.disableNetwork()},Of.prototype.ei=function(t){var e=this.Xd.get(t);if(e&&e.Qd)return fs().add(e.key);var n=fs(),r=this.Hd.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++)var s=o[i],u=this.zd.get(s),n=n.He(u.view.pd);return n},Of),bf=(n(Pf,af=wf),Object.defineProperty(Pf.prototype,"if",{get:function(){return!0===this.Pf},enumerable:!0,configurable:!0}),Pf.prototype.enableNetwork=function(){return this.x_.uo(!0),af.prototype.enableNetwork.call(this)},Pf.prototype.disableNetwork=function(){return this.x_.uo(!1),af.prototype.disableNetwork.call(this)},Pf.prototype.Vf=function(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.x_.Wu(r.query,!0)];case 1:return e=t.sent(),n=r.view.kd(e),[2,(this.Pf&&this.hf(r.targetId,n.Fd),n)]}})})},Pf.prototype.Nd=function(t,e){this.if&&0===e&&(af.prototype.Nd.call(this,t,e),this.jd.hd(t)),this.if||1!==e||af.prototype.Nd.call(this,t,e)},Pf.prototype.Ed=function(n,r,i){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.nf("applyBatchState()"),[4,this.x_.Gu(n)];case 1:return null===(e=t.sent())?[3,6]:"pending"!==r?[3,3]:[4,this.Wd.nl()];case 2:return t.sent(),[3,4];case 3:"acknowledged"===r||"rejected"===r?(this.df(n,i||null),this.x_.zu(n)):zs(),t.label=4;case 4:return[4,this.cf(e)];case 5:return t.sent(),[3,7];case 6:Fs("SyncEngine","Cannot apply mutation batch with id: "+n),t.label=7;case 7:return[2]}})})},Pf.prototype.yl=function(h){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a=this;return v(this,function(t){switch(t.label){case 0:return!0!==h||!0===this.Pf?[3,3]:(e=this.jd.jl(),[4,this.gf(e.W(),!0)]);case 1:return n=t.sent(),this.Pf=!0,[4,this.Wd.yl(!0)];case 2:for(t.sent(),r=0,i=n;r<i.length;r++)o=i[r],this.Wd.listen(o);return[3,7];case 3:return!1!==h||!1===this.Pf?[3,7]:(s=[],u=Promise.resolve(),this.Hd.forEach(function(t,e){a.jd.ed(e)?s.push(e):u=u.then(function(){return a.af(e),a.x_.Qu(e,!0)}),a.Wd.al(e)}),[4,u]);case 4:return t.sent(),[4,this.gf(s,!1)];case 5:return t.sent(),this.pf(),this.Pf=!1,[4,this.Wd.yl(!1)];case 6:t.sent(),t.label=7;case 7:return[2]}})})},Pf.prototype.pf=function(){var n=this;this.Xd.forEach(function(t,e){n.Wd.al(e)}),this.Zd.nc(),this.Xd=new Map,this.Jd=new Xo(Qr.N)},Pf.prototype.gf=function(d,t){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f,l,p;return v(this,function(t){switch(t.label){case 0:e=[],n=[],r=0,i=d,t.label=1;case 1:return r<i.length?(o=i[r],s=void 0,(u=this.Hd.get(o))&&0!==u.length?[4,this.x_.Uu(u[0].ee())]:[3,7]):[3,13];case 2:s=t.sent(),a=0,h=u,t.label=3;case 3:return a<h.length?(c=h[a],f=this.zd.get(c),[4,this.Vf(f)]):[3,6];case 4:(l=t.sent()).snapshot&&n.push(l.snapshot),t.label=5;case 5:return a++,[3,3];case 6:return[3,11];case 7:return[4,this.x_.Hu(o)];case 8:return p=t.sent(),[4,this.x_.Uu(p)];case 9:return s=t.sent(),[4,this.rf(this.yf(p),o,!1)];case 10:t.sent(),t.label=11;case 11:e.push(s),t.label=12;case 12:return r++,[3,1];case 13:return[2,(this.Gd.n_(n),e)]}})})},Pf.prototype.yf=function(t){return new No(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)},Pf.prototype.So=function(){return this.x_.So()},Pf.prototype.Id=function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.Pf?(Fs("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!this.Hd.has(r))return[3,8];switch(i){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,this.x_.Kr()];case 3:return e=t.sent(),n=ws.ls(r,"current"===i),[4,this.cf(e,n)];case 4:return t.sent(),[3,8];case 5:return[4,this.x_.Qu(r,!0)];case 6:return t.sent(),this.af(r,o),[3,8];case 7:zs(),t.label=8;case 8:return[2]}})})},Pf.prototype.wd=function(l,p){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f=this;return v(this,function(t){switch(t.label){case 0:if(!this.Pf)return[3,10];e=0,n=l,t.label=1;case 1:return e<n.length?(r=n[e],this.Hd.has(r)?(Fs("SyncEngine","Adding an already active target "+r),[3,5]):[4,this.x_.Hu(r)]):[3,6];case 2:return i=t.sent(),[4,this.x_.Uu(i)];case 3:return o=t.sent(),[4,this.rf(this.yf(i),o.targetId,!1)];case 4:t.sent(),this.Wd.listen(o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return u.Hd.has(e)?[4,u.x_.Qu(e,!1).then(function(){f.Wd.al(e),f.af(e)}).catch(yh)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=this,a=0,h=p,t.label=7;case 7:return a<h.length?(c=h[a],[5,s(c)]):[3,10];case 8:t.sent(),t.label=9;case 9:return a++,[3,7];case 10:return[2]}})})},Pf),Ef=(Df.prototype.listen=function(u){return y(this,void 0,void 0,function(){var e,n,r,i,o,s;return v(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(r=this.Sf.get(e))||(n=!0,r=new uf),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),i=r,[4,this.cl.listen(e)];case 2:return i.bf=t.sent(),[3,4];case 3:return o=t.sent(),s=Za(o,"Initialization of query '"+u.query+"' failed"),[2,void u.onError(s)];case 4:return this.Sf.set(e,r),r.vf.push(u),u.Nd(this.onlineState),r.bf&&u.Cf(r.bf)&&this.Ff(),[2]}})})},Df.prototype.al=function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){return e=o.query,n=!1,(r=this.Sf.get(e))&&0<=(i=r.vf.indexOf(o))&&(r.vf.splice(i,1),n=0===r.vf.length),n?[2,(this.Sf.delete(e),this.cl.al(e))]:[2]})})},Df.prototype.n_=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.Sf.get(o);if(s){for(var u=0,a=s.vf;u<a.length;u++)a[u].Cf(i)&&(e=!0);s.bf=i}}e&&this.Ff()},Df.prototype.If=function(t,e){var n=this.Sf.get(t);if(n)for(var r=0,i=n.vf;r<i.length;r++)i[r].onError(e);this.Sf.delete(t)},Df.prototype._f=function(i){this.onlineState=i;var o=!1;this.Sf.forEach(function(t,e){for(var n=0,r=e.vf;n<r.length;n++)r[n].Nd(i)&&(o=!0)}),o&&this.Ff()},Df.prototype.Nf=function(t){this.Df.add(t),t.next()},Df.prototype.$f=function(t){this.Df.delete(t)},Df.prototype.Ff=function(){this.Df.forEach(function(t){t.next()})},Df),Tf=(xf.prototype.Cf=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new ms(t.query,t.docs,t.ss,e,t.ns,t.fromCache,t.rs,!0)}var o=!1;return this.Mf?this.Lf(t)&&(this.kf.next(t),o=!0):this.Of(t,this.onlineState)&&(this.Bf(t),o=!0),this.xf=t,o},xf.prototype.onError=function(t){this.kf.error(t)},xf.prototype.Nd=function(t){this.onlineState=t;var e=!1;return this.xf&&!this.Mf&&this.Of(this.xf,t)&&(this.Bf(this.xf),e=!0),e},xf.prototype.Of=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.qf&&n||t.docs.B()&&"Offline"!==e)},xf.prototype.Lf=function(t){if(0<t.docChanges.length)return!0;var e=this.xf&&this.xf.hasPendingWrites!==t.hasPendingWrites;return!(!t.rs&&!e)&&!0===this.options.includeMetadataChanges},xf.prototype.Bf=function(t){t=ms.os(t.query,t.docs,t.ns,t.fromCache),this.Mf=!0,this.kf.next(t)},xf),If=(Rf.prototype.bu=function(t){this.Uf=t},Rf.prototype.Zn=function(e,r,i,o){var s=this;return r.te()||i.isEqual(Or.min())?this.Qf(e,r):this.Uf.Yn(e,o).next(function(t){var n=s.Wf(r,t);return(r.oe()||r.ae())&&s.Sd(r.Bt,n,o,i)?s.Qf(e,r):(qs()<=p.DEBUG&&Fs("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),r.toString()),s.Uf.Zn(e,r,i).next(function(e){return n.forEach(function(t){e=e.Ae(t.key,t)}),e}))})},Rf.prototype.Wf=function(n,t){var r=new rs(function(t,e){return n.se(t,e)});return t.forEach(function(t,e){e instanceof bo&&n.matches(e)&&(r=r.add(e))}),r},Rf.prototype.Sd=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.S(r))},Rf.prototype.Qf=function(t,e){return qs()<=p.DEBUG&&Fs("IndexFreeQueryEngine","Using full collection scan to execute query:",e.toString()),this.Uf.Zn(t,e,Or.min())},Rf),Nf=(Sf.prototype.Ho=function(t){return nu.resolve(0===this.Wn.length)},Sf.prototype.Yo=function(t,e,n,r){var i=this.jf;this.jf++,0<this.Wn.length&&this.Wn[this.Wn.length-1];var o=new tu(i,e,n,r);this.Wn.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.Kf=this.Kf.add(new gh(a.key,i)),this.jn.Dr(t,a.key.path.M())}return nu.resolve(o)},Sf.prototype.Jo=function(t,e){return nu.resolve(this.Gf(e))},Sf.prototype.Zo=function(t,e){var n=e+1,r=this.zf(n),i=r<0?0:r;return nu.resolve(this.Wn.length>i?this.Wn[i]:null)},Sf.prototype.ta=function(){return nu.resolve(0===this.Wn.length?-1:this.jf-1)},Sf.prototype.ea=function(t){return nu.resolve(this.Wn.slice())},Sf.prototype.Gn=function(t,e){var n=this,r=new gh(e,0),i=new gh(e,Number.POSITIVE_INFINITY),o=[];return this.Kf.Ke([r,i],function(t){var e=n.Gf(t.hc);o.push(e)}),nu.resolve(o)},Sf.prototype.Xn=function(t,e){var r=this,i=new rs(Qs);return e.forEach(function(t){var e=new gh(t,0),n=new gh(t,Number.POSITIVE_INFINITY);r.Kf.Ke([e,n],function(t){i=i.add(t.hc)})}),nu.resolve(this.Hf(i))},Sf.prototype.nr=function(t,e){var n=e.path,r=n.length+1,i=n;Qr.et(i)||(i=i.child(""));var o=new gh(new Qr(i),0),s=new rs(Qs);return this.Kf.Ge(function(t){var e=t.key.path;return!!n.q(e)&&(e.length===r&&(s=s.add(t.hc)),!0)},o),nu.resolve(this.Hf(s))},Sf.prototype.Hf=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.Gf(t);null!==e&&r.push(e)}),r},Sf.prototype.ia=function(n,r){var i=this;Ws(0===this.Yf(r.batchId,"removed")),this.Wn.shift();var o=this.Kf;return nu.forEach(r.mutations,function(t){var e=new gh(t.key,r.batchId);return o=o.delete(e),i.hh.Uo(n,t.key)}).next(function(){i.Kf=o})},Sf.prototype.na=function(t){},Sf.prototype.Ch=function(t,e){var n=new gh(e,0),r=this.Kf.ze(n);return nu.resolve(e.isEqual(r&&r.key))},Sf.prototype.ra=function(t){return this.Wn.length,nu.resolve()},Sf.prototype.Yf=function(t,e){return this.zf(t)},Sf.prototype.zf=function(t){return 0===this.Wn.length?0:t-this.Wn[0].batchId},Sf.prototype.Gf=function(t){var e=this.zf(t);return e<0||e>=this.Wn.length?null:this.Wn[e]},Sf),_f=(Af.prototype.Nn=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.Jf(e);return this.docs=this.docs.Ae(r,{xr:e,size:s,readTime:n}),this.size+=s-o,this.jn.Dr(t,r.path.M())},Af.prototype.kn=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Af.prototype.Mn=function(t,e){var n=this.docs.get(e);return nu.resolve(n?n.xr:null)},Af.prototype.getEntries=function(t,e){var n=this,r=os;return e.forEach(function(t){var e=n.docs.get(t);r=r.Ae(t,e?e.xr:null)}),nu.resolve(r)},Af.prototype.Zn=function(t,e,n){for(var r=as,i=new Qr(e.path.child("")),o=this.docs.ve(i);o.$e();){var s=o.Ne(),u=s.key,a=s.value,h=a.xr,c=a.readTime;if(!e.path.q(u.path))break;c.S(n)<=0||h instanceof bo&&e.matches(h)&&(r=r.Ae(h.key,h))}return nu.resolve(r)},Af.prototype.Xf=function(t,e){return nu.forEach(this.docs,function(t){return e(t)})},Af.prototype.Yr=function(t){return new Af.Jr(this)},Af.prototype.Zr=function(t){return nu.resolve(this.size)},Af);function Af(t,e){this.jn=t,this.Jf=e,this.docs=new Xo(Qr.N),this.size=0}function Sf(t,e){this.jn=t,this.hh=e,this.Wn=[],this.jf=1,this.Kf=new rs(gh.Ju)}function Rf(){}function xf(t,e,n){this.query=t,this.kf=e,this.Mf=!1,this.xf=null,this.onlineState="Unknown",this.options=n||{}}function Df(t){this.cl=t,this.Sf=new Zs(function(t){return t.canonicalId()}),this.onlineState="Unknown",this.Df=new Set,this.cl.subscribe(this)}function Pf(t,e,n,r,i,o){var s=this;return(s=af.call(this,t,e,n,r,i,o)||this).x_=t,s.Pf=void 0,s}function Of(t,e,n,r,i,o){this.x_=t,this.Wd=e,this.w_=n,this.jd=r,this.currentUser=i,this.Kd=o,this.Gd=null,this.zd=new Zs(function(t){return t.canonicalId()}),this.Hd=new Map,this.Yd=[],this.Jd=new Xo(Qr.N),this.Xd=new Map,this.Zd=new vh,this.tf={},this.ef=new Map,this.sf=Fu.rh(),this.onlineState="Unknown"}function kf(t,e,n,r){this.Ra=t,this.w_=e,this.updateFunction=n,this.Pa=r,this.xd=5,this.Na=new bu(this.Ra,"transaction_retry")}function Lf(t,e){this.query=t,this.md=e,this.Pd=null,this.fs=!1,this.Vd=fs(),this.ns=fs(),this.gd=new vs(t.se.bind(t))}function Vf(){this.Rd=new df,this.Ad={},this.cl=null,this.b_=null,this.ur=null}function Cf(t,e,n,r,i){if(this.Tr=t,this.platform=e,this.persistenceKey=n,this.Cl=r,this.cl=null,this.b_=null,this.ur=null,this.Fl=this.Nl.bind(this),this.$l=new Xo(Qs),this.ho=!1,this.kl=[],!Cf.zh(this.platform))throw new Ar(_r.UNIMPLEMENTED,"LocalStorage is not available on this platform.");var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.platform.window.localStorage,this.currentUser=i,this.Ml=Zc(this.persistenceKey,this.Cl),this.xl="firestore_sequence_number_"+this.persistenceKey,this.$l=this.$l.Ae(this.Cl,new df),this.Ll=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Ol=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Bl=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.ql="firestore_online_state_"+this.persistenceKey,this.platform.window.addEventListener("storage",this.Fl)}function Uf(){this.activeTargetIds=ls}function jf(t,e){this.clientId=t,this.onlineState=e}function Mf(t,e){this.clientId=t,this.activeTargetIds=e}function qf(t,e,n){this.targetId=t,this.state=e,this.error=n}function Ff(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function Bf(t){var e=this;return(e=hf.call(this)||this).th=t,e}_f.Jr=(n(Bf,hf=ru),Bf.prototype.On=function(n){var r=this,i=[];return this.Dn.forEach(function(t,e){e?i.push(r.th.Nn(n,e,r.readTime)):r.th.kn(t)}),nu.vn(i)},Bf.prototype.xn=function(t,e){return this.th.Mn(t,e)},Bf.prototype.Ln=function(t,e){return this.th.getEntries(t,e)},Bf);var Gf,zf,Wf=(ul.prototype.js=function(t,n){return this.Zf.forEach(function(t,e){return n(e)}),nu.resolve()},ul.prototype._h=function(t){return nu.resolve(this.lastRemoteSnapshotVersion)},ul.prototype.lh=function(t){return nu.resolve(this.tT)},ul.prototype.oh=function(t){return this.highestTargetId=this.sT.next(),nu.resolve(this.highestTargetId)},ul.prototype.dh=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.tT&&(this.tT=e),nu.resolve()},ul.prototype.Th=function(t){this.Zf.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.sT=new Fu(e),this.highestTargetId=e),t.sequenceNumber>this.tT&&(this.tT=t.sequenceNumber)},ul.prototype.fh=function(t,e){return this.Th(e),this.targetCount+=1,nu.resolve()},ul.prototype.Ih=function(t,e){return this.Th(e),nu.resolve()},ul.prototype.wh=function(t,e){return this.Zf.delete(e.target),this.eT.ic(e.targetId),--this.targetCount,nu.resolve()},ul.prototype.Ah=function(n,r,i){var o=this,s=0,u=[];return this.Zf.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Zf.delete(t),u.push(o.Rh(n,e.targetId)),s++)}),nu.vn(u).next(function(){return s})},ul.prototype.Vh=function(t){return nu.resolve(this.targetCount)},ul.prototype.gh=function(t,e){var n=this.Zf.get(e)||null;return nu.resolve(n)},ul.prototype.ph=function(t,e,n){return this.eT.tc(e,n),nu.resolve()},ul.prototype.bh=function(e,t,n){this.eT.sc(t,n);var r=this.persistence.hh,i=[];return r&&t.forEach(function(t){i.push(r.Uo(e,t))}),nu.vn(i)},ul.prototype.Rh=function(t,e){return this.eT.ic(e),nu.resolve()},ul.prototype.Sh=function(t,e){var n=this.eT.rc(e);return nu.resolve(n)},ul.prototype.Ch=function(t,e){return nu.resolve(this.eT.Ch(e))},ul),Kf=(sl.prototype.start=function(){return Promise.resolve()},sl.prototype.Vo=function(){return this.Uh=!1,Promise.resolve()},Object.defineProperty(sl.prototype,"ho",{get:function(){return this.Uh},enumerable:!0,configurable:!0}),sl.prototype.oo=function(){},sl.prototype.$o=function(){return this.jn},sl.prototype.Do=function(t){var e=this.iT[t.s()];return e||(e=new Nf(this.jn,this.hh),this.iT[t.s()]=e),e},sl.prototype.Fo=function(){return this.Jh},sl.prototype.No=function(){return this.Qn},sl.prototype.runTransaction=function(t,e,n){var r=this;Fs("MemoryPersistence","Starting transaction:",t);var i=new Hf(this.qh.next());return this.hh.rT(),n(i).next(function(t){return r.hh.hT(i).next(function(){return t})}).yn().then(function(t){return i.Un(),t})},sl.prototype.oT=function(e,n){return nu.Sn(Object.values(this.iT).map(function(t){return function(){return t.Ch(e,n)}}))},sl),Hf=(n(ol,zf=ou),ol),Qf=(il.cT=function(t){return new il(t)},Object.defineProperty(il.prototype,"_T",{get:function(){if(this.uT)return this.uT;throw zs()},enumerable:!0,configurable:!0}),il.prototype.yh=function(t,e,n){return this.aT.yh(n,e),this._T.delete(n),nu.resolve()},il.prototype.vh=function(t,e,n){return this.aT.vh(n,e),this._T.add(n),nu.resolve()},il.prototype.Uo=function(t,e){return this._T.add(e),nu.resolve()},il.prototype.removeTarget=function(t,e){var n=this;this.aT.ic(e.targetId).forEach(function(t){return n._T.add(t)});var r=this.persistence.Fo();return r.Sh(t,e.targetId).next(function(t){t.forEach(function(t){return n._T.add(t)})}).next(function(){return r.wh(t,e)})},il.prototype.rT=function(){this.uT=new Set},il.prototype.hT=function(t){var n=this,r=this.persistence.No().Yr();return nu.forEach(this._T,function(e){return n.lT(t,e).next(function(t){t||r.kn(e)})}).next(function(){return n.uT=null,r.apply(t)})},il.prototype.Ko=function(t,e){var n=this;return this.lT(t,e).next(function(t){t?n._T.delete(e):n._T.add(e)})},il.prototype.nT=function(t){return 0},il.prototype.lT=function(t,e){var n=this;return nu.Sn([function(){return nu.resolve(n.aT.Ch(e))},function(){return n.persistence.Fo().Ch(t,e)},function(){return n.persistence.oT(t,e)}])},il),Yf="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Xf=(rl.prototype.initialize=function(n){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.jd=this.dT(n),this.persistence=this.fT(n),[4,this.persistence.start()];case 1:return t.sent(),this.TT=this.ET(n),this.x_=this.IT(n),this.Wd=this.wT(n),this.cl=this.RT(n),this.AT=this.mT(n),this.jd.b_=function(t){return e.cl.Nd(t,1)},this.Wd.cl=this.cl,[4,this.x_.start()];case 2:return t.sent(),[4,this.jd.start()];case 3:return t.sent(),[4,this.Wd.start()];case 4:return t.sent(),[4,this.Wd.yl(this.cl.if)];case 5:return t.sent(),[2]}})})},rl.prototype.mT=function(t){return new Ef(this.cl)},rl.prototype.ET=function(t){return null},rl.prototype.IT=function(t){return new ah(this.persistence,new If,t.PT)},rl.prototype.fT=function(t){if(t.gT.VT)throw new Ar(_r.FAILED_PRECONDITION,Yf);return new Kf(Qf.cT)},rl.prototype.wT=function(t){var e=this;return new Wc(this.x_,t.w_,t.Ra,function(t){return e.cl.Nd(t,0)},t.platform.pT())},rl.prototype.dT=function(t){return new vf},rl.prototype.RT=function(t){return new wf(this.x_,this.Wd,t.w_,this.jd,t.PT,t.Kd)},rl.prototype.clearPersistence=function(t){throw new Ar(_r.FAILED_PRECONDITION,Yf)},rl),Jf=(n(nl,Gf=Xf),nl.prototype.initialize=function(e){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return[4,Gf.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,this.persistence.ro(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.cl.yl(e)];case 1:return t.sent(),this.TT&&(e&&!this.TT.ho?this.TT.start(this.x_):e||this.TT.stop()),[2]}})})})];case 2:return t.sent(),[2]}})})},nl.prototype.IT=function(t){return new ph(this.persistence,new If,t.PT)},nl.prototype.RT=function(t){var e=new bf(this.x_,this.Wd,t.w_,this.jd,t.PT,t.Kd);return this.jd instanceof yf&&(this.jd.cl=e),e},nl.prototype.ET=function(t){var e=this.persistence.hh.xo;return new sh(e,t.Ra)},nl.prototype.fT=function(t){var e=$u.Mo(t.yT),n=t.platform.Cc(t.yT.ii);return new $u(t.gT.synchronizeTabs,e,t.clientId,t.platform,rh.nu(t.gT.cacheSizeBytes),t.Ra,n,this.jd,t.gT.Bh)},nl.prototype.dT=function(t){if(t.gT.VT&&t.gT.synchronizeTabs){if(!yf.zh(t.platform))throw new Ar(_r.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var e=$u.Mo(t.yT);return new yf(t.Ra,t.platform,e,t.clientId,t.PT)}return new vf},nl.prototype.clearPersistence=function(t){var e=$u.Mo(t);return $u.clearPersistence(e)},nl),$f=(el.prototype.start=function(e,n){var r=this;this.T_();var i=new wu,o=new wu,s=!1;return this.credentials.l(function(t){if(!s)return s=!0,Fs("FirestoreClient","Initializing. user=",t.uid),r.bT(e,n,t,o).then(i.resolve,i.reject);r.Ra.lo(function(){return r.pl(t)})}),this.Ra.co(function(){return i.promise}),o.promise},el.prototype.enableNetwork=function(){var t=this;return this.T_(),this.Ra.enqueue(function(){return t.cl.enableNetwork()})},el.prototype.bT=function(u,a,h,c){return y(this,void 0,void 0,function(){var n,r,i,o,s=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,this.platform.vT(this.yT)];case 1:return n=t.sent(),r=this.platform.Cc(this.yT.ii),e=this.credentials,i=new Bc(n,e,r),[4,u.initialize({Ra:this.Ra,yT:this.yT,platform:this.platform,w_:i,clientId:this.clientId,PT:h,Kd:100,gT:a})];case 2:return t.sent(),this.persistence=u.persistence,this.jd=u.jd,this.x_=u.x_,this.Wd=u.Wd,this.cl=u.cl,this.TT=u.TT,this.ST=u.AT,this.persistence.oo(function(){return y(s,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),c.resolve(),[3,4];case 3:if(o=t.sent(),c.reject(o),!this.DT(o))throw o;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+o),this.bT(new Xf,{VT:!1},h,c))];case 4:return[2]}var e})})},el.prototype.DT=function(t){return"FirebaseError"===t.name?t.code===_r.FAILED_PRECONDITION||t.code===_r.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},el.prototype.T_=function(){if(this.Ra.ka)throw new Ar(_r.FAILED_PRECONDITION,"The client has already been terminated.")},el.prototype.pl=function(t){return this.Ra.Ua(),Fs("FirestoreClient","Credential Changed. Current user: "+t.uid),this.cl.pl(t)},el.prototype.disableNetwork=function(){var t=this;return this.T_(),this.Ra.enqueue(function(){return t.cl.disableNetwork()})},el.prototype.terminate=function(){var t=this;return this.Ra.Ba(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.TT&&this.TT.stop(),[4,this.Wd.Vo()];case 1:return t.sent(),[4,this.jd.Vo()];case 2:return t.sent(),[4,this.persistence.Vo()];case 3:return t.sent(),this.credentials.T(),[2]}})})})},el.prototype.waitForPendingWrites=function(){var t=this;this.T_();var e=new wu;return this.Ra.co(function(){return t.cl.Tf(e)}),e.promise},el.prototype.listen=function(t,e,n){var r=this;this.T_();var i=new Tf(t,e,n);return this.Ra.co(function(){return r.ST.listen(i)}),i},el.prototype.al=function(t){var e=this;this.CT||this.Ra.co(function(){return e.ST.al(t)})},el.prototype.FT=function(o){return y(this,void 0,void 0,function(){var i,e=this;return v(this,function(t){switch(t.label){case 0:return this.T_(),i=new wu,[4,this.Ra.enqueue(function(){return y(e,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.x_.qu(o)];case 1:return(e=t.sent())instanceof bo?i.resolve(e):e instanceof Eo?i.resolve(null):i.reject(new Ar(_r.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return n=t.sent(),r=Za(n,"Failed to get document '"+o+" from cache"),i.reject(r),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),i.promise)]}})})},el.prototype.NT=function(a){return y(this,void 0,void 0,function(){var u,e=this;return v(this,function(t){switch(t.label){case 0:return this.T_(),u=new wu,[4,this.Ra.enqueue(function(){return y(e,void 0,void 0,function(){var e,n,r,i,o,s;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.x_.Wu(a,!0)];case 1:return e=t.sent(),n=new gf(a,e.ju),r=n.yd(e.documents),i=n.On(r,!1),u.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=Za(o,"Failed to execute query '"+a+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})},el.prototype.write=function(t){var e=this;this.T_();var n=new wu;return this.Ra.co(function(){return e.cl.write(t,n)}),n.promise},el.prototype.ii=function(){return this.yT.ii},el.prototype.Nf=function(t){var e=this;this.T_(),this.Ra.co(function(){return e.ST.Nf(t),Promise.resolve()})},el.prototype.$f=function(t){var e=this;this.CT||this.Ra.co(function(){return e.ST.$f(t),Promise.resolve()})},Object.defineProperty(el.prototype,"CT",{get:function(){return this.Ra.ka},enumerable:!0,configurable:!0}),el.prototype.transaction=function(t){var e=this;this.T_();var n=new wu;return this.Ra.co(function(){return e.cl.runTransaction(e.Ra,t,n),Promise.resolve()}),n.promise},el),Zf=(tl.prototype.next=function(t){this.$T(this.observer.next,t)},tl.prototype.error=function(t){this.$T(this.observer.error,t)},tl.prototype.kT=function(){this.muted=!0},tl.prototype.$T=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},tl);function tl(t){this.observer=t,this.muted=!1}function el(t,e,n,r){this.platform=t,this.yT=e,this.credentials=n,this.Ra=r,this.clientId=Ks.cn()}function nl(){return null!==Gf&&Gf.apply(this,arguments)||this}function rl(){}function il(t){this.persistence=t,this.aT=new vh,this.uT=null}function ol(t){var e=this;return(e=zf.call(this)||this).Lh=t,e}function sl(t){var e=this;this.iT={},this.qh=new au(0),this.Uh=!1,this.Uh=!0,this.hh=t(this),this.Jh=new Wf(this),this.jn=new Au,this.Qn=new _f(this.jn,function(t){return e.hh.nT(t)})}function ul(t){this.persistence=t,this.Zf=new Zs(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=Or.min(),this.highestTargetId=0,this.tT=0,this.eT=new vh,this.targetCount=0,this.sT=Fu.nh()}function al(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var hl,cl,fl,ll=(Cl.prototype.LT=function(t){switch(ui(t)){case 0:return null;case 1:return t.booleanValue;case 2:return di(t.integerValue||t.doubleValue);case 3:return this.OT(t.timestampValue);case 4:return this.BT(t);case 5:return t.stringValue;case 6:return new Gh(yi(t.bytesValue));case 7:return this.qT(t.referenceValue);case 8:return this.UT(t.geoPointValue);case 9:return this.QT(t.arrayValue);case 10:return this.WT(t.mapValue);default:throw zs()}},Cl.prototype.WT=function(t){var n=this,r={};return Jr(t.fields||{},function(t,e){r[t]=n.LT(e)}),r},Cl.prototype.UT=function(t){return new hc(di(t.latitude),di(t.longitude))},Cl.prototype.QT=function(t){var e=this;return(t.values||[]).map(function(t){return e.LT(t)})},Cl.prototype.BT=function(t){switch(this.MT){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return ii(n)?t(n):n}(t);return null==e?null:this.LT(e);case"estimate":return this.OT(oi(t));default:return null}},Cl.prototype.OT=function(t){var e=pi(t),n=new Pr(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},Cl.prototype.qT=function(t){var e=Lr.K(t);Ws(Cs(e));var n=new $s(e.get(1),e.get(3)),r=new Qr(e.k(5));return n.isEqual(this.ii)||Bs("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.ii.projectId+"/"+this.ii.database+") instead."),this.xT(r)},Cl),pl=rh.ou,dl=(Vl.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Vl),yl=(Object.defineProperty(Ll.prototype,"tE",{get:function(){return this.eE||(this.eE=new Ac(this.mc,this.ZT.ignoreUndefinedProperties)),this.eE},enumerable:!0,configurable:!0}),Ll.prototype.settings=function(t){Eh("Firestore.settings",arguments,1),Nh("Firestore.settings","object",1,t);var e=new dl(t);if(this.zT&&!this.ZT.isEqual(e))throw new Ar(_r.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.ZT=e).credentials&&(this.JT=function(t){if(!t)return new Sr;switch(t.type){case"gapi":var e=t.sE;return Ws(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Dr(e,t.V||"0");case"provider":return t.sE;default:throw new Ar(_r.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},Ll.prototype.enableNetwork=function(){return this.GT(),this.zT.enableNetwork()},Ll.prototype.disableNetwork=function(){return this.GT(),this.zT.disableNetwork()},Ll.prototype.enablePersistence=function(t){var e,n;if(this.zT)throw new Ar(_r.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Bs("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new Ar(_r.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.iE(this.XT,{VT:!0,cacheSizeBytes:this.ZT.cacheSizeBytes,synchronizeTabs:r,Bh:i})},Ll.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){var r,e=this;return v(this,function(t){if(void 0!==this.zT&&!this.zT.CT)throw new Ar(_r.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return r=new wu,[2,(this.KT.Ma(function(){return y(e,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),e=this.nE(),[4,this.XT.clearPersistence(e)];case 1:return t.sent(),r.resolve(),[3,3];case 2:return n=t.sent(),r.reject(n),[3,3];case 3:return[2]}})})}),r.promise)]})})},Ll.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Ll.prototype,"rE",{get:function(){return this.GT(),this.zT.CT},enumerable:!0,configurable:!0}),Ll.prototype.waitForPendingWrites=function(){return this.GT(),this.zT.waitForPendingWrites()},Ll.prototype.onSnapshotsInSync=function(t){if(this.GT(),al(t))return this.hE(t);Nh("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.hE(e)},Ll.prototype.hE=function(t){var e=this,n=new Zf({next:function(){t.next&&t.next()},error:function(t){throw zs()}});return this.zT.Nf(n),function(){n.kT(),e.zT.$f(n)}},Ll.prototype.GT=function(){return this.zT||this.iE(new Xf,{VT:!1}),this.zT},Ll.prototype.nE=function(){return new Js(this.mc,this.YT,this.ZT.host,this.ZT.ssl,this.ZT.forceLongPolling)},Ll.prototype.iE=function(t,e){var n=this.nE();return this.zT=new $f(Us.nt(),n,this.JT,this.KT),this.zT.start(t,e)},Ll.HT=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Ar(_r.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Ar(_r.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new $s(n)},Object.defineProperty(Ll.prototype,"app",{get:function(){if(!this.jT)throw new Ar(_r.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.jT},enumerable:!0,configurable:!0}),Ll.prototype.collection=function(t){return Eh("Firestore.collection",arguments,1),Nh("Firestore.collection","non-empty string",1,t),this.GT(),new Nl(Lr.K(t),this,null)},Ll.prototype.doc=function(t){return Eh("Firestore.doc",arguments,1),Nh("Firestore.doc","non-empty string",1,t),this.GT(),ml.oE(Lr.K(t),this,null)},Ll.prototype.collectionGroup=function(t){if(Eh("Firestore.collectionGroup",arguments,1),Nh("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Ar(_r.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.GT(),new Tl(new No(Lr.G,t),this,null)},Ll.prototype.runTransaction=function(e){var n=this;return Eh("Firestore.runTransaction",arguments,1),Nh("Firestore.runTransaction","function",1,e),this.GT().transaction(function(t){return e(new vl(n,t))})},Ll.prototype.batch=function(){return this.GT(),new gl(this)},Object.defineProperty(Ll,"logLevel",{get:function(){switch(qs()){case p.DEBUG:return"debug";case p.ERROR:return"error";case p.SILENT:return"silent";case p.WARN:return"warn";case p.INFO:return"info";case p.VERBOSE:return"verbose";default:return"error"}},enumerable:!0,configurable:!0}),Ll.setLogLevel=function(t){Eh("Firestore.setLogLevel",arguments,1),xh("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),js.setLogLevel(t)},Ll.prototype.aE=function(){return this.ZT.timestampsInSnapshots},Ll),vl=(kl.prototype.get=function(t){var n=this;Eh("Transaction.get",arguments,1);var r=ql("Transaction.get",t,this.uE);return this.cE.V_([r.Pc]).then(function(t){if(!t||1!==t.length)return zs();var e=t[0];if(e instanceof Eo)return new bl(n.uE,r.Pc,null,!1,!1,r.Vc);if(e instanceof bo)return new bl(n.uE,r.Pc,e,!1,!1,r.Vc);throw zs()})},kl.prototype.set=function(t,e,n){Ih("Transaction.set",arguments,2,3);var r=ql("Transaction.set",t,this.uE);n=Ul("Transaction.set",n);var i=Fl(r.Vc,e,"Transaction.set"),o=i[0],s=i[1],u=this.uE.tE.Fc(s,o,n);return this.cE.set(r.Pc,u),this},kl.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof zh?(Th("Transaction.update",arguments,3),r=ql("Transaction.update",t,this.uE),this.uE.tE.kc("Transaction.update",e,n,o)):(Eh("Transaction.update",arguments,2),r=ql("Transaction.update",t,this.uE),this.uE.tE.$c("Transaction.update",e)),this.cE.update(r.Pc,i),this},kl.prototype.delete=function(t){Eh("Transaction.delete",arguments,1);var e=ql("Transaction.delete",t,this.uE);return this.cE.delete(e.Pc),this},kl),gl=(Ol.prototype.set=function(t,e,n){Ih("WriteBatch.set",arguments,2,3),this.dE();var r=ql("WriteBatch.set",t,this.uE);n=Ul("WriteBatch.set",n);var i=Fl(r.Vc,e,"WriteBatch.set"),o=i[0],s=i[1],u=this.uE.tE.Fc(s,o,n);return this._E=this._E.concat(u.gc(r.Pc,Mi.ft())),this},Ol.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.dE(),i="string"==typeof e||e instanceof zh?(Th("WriteBatch.update",arguments,3),r=ql("WriteBatch.update",t,this.uE),this.uE.tE.kc("WriteBatch.update",e,n,o)):(Eh("WriteBatch.update",arguments,2),r=ql("WriteBatch.update",t,this.uE),this.uE.tE.$c("WriteBatch.update",e)),this._E=this._E.concat(i.gc(r.Pc,Mi.exists(!0))),this},Ol.prototype.delete=function(t){Eh("WriteBatch.delete",arguments,1),this.dE();var e=ql("WriteBatch.delete",t,this.uE);return this._E=this._E.concat(new zi(e.Pc,Mi.ft())),this},Ol.prototype.commit=function(){return this.dE(),this.lE=!0,0<this._E.length?this.uE.GT().write(this._E):Promise.resolve()},Ol.prototype.dE=function(){if(this.lE)throw new Ar(_r.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Ol),ml=(n(Pl,fl=fc),Pl.oE=function(t,e,n){if(t.length%2!=0)throw new Ar(_r.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.j()+" has "+t.length);return new Pl(new Qr(t),e,n)},Object.defineProperty(Pl.prototype,"id",{get:function(){return this.Pc.path.O()},enumerable:!0,configurable:!0}),Object.defineProperty(Pl.prototype,"parent",{get:function(){return new Nl(this.Pc.path.M(),this.firestore,this.Vc)},enumerable:!0,configurable:!0}),Object.defineProperty(Pl.prototype,"path",{get:function(){return this.Pc.path.j()},enumerable:!0,configurable:!0}),Pl.prototype.collection=function(t){if(Eh("DocumentReference.collection",arguments,1),Nh("DocumentReference.collection","non-empty string",1,t),!t)throw new Ar(_r.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Lr.K(t);return new Nl(this.Pc.path.child(e),this.firestore,null)},Pl.prototype.isEqual=function(t){if(!(t instanceof Pl))throw Vh("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Pc.isEqual(t.Pc)&&this.Vc===t.Vc},Pl.prototype.set=function(t,e){Ih("DocumentReference.set",arguments,1,2),e=Ul("DocumentReference.set",e);var n=Fl(this.Vc,t,"DocumentReference.set"),r=n[0],i=n[1],o=this.firestore.tE.Fc(i,r,e);return this.zT.write(o.gc(this.Pc,Mi.ft()))},Pl.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof zh?(Th("DocumentReference.update",arguments,2),this.firestore.tE.kc("DocumentReference.update",t,e,r)):(Eh("DocumentReference.update",arguments,1),this.firestore.tE.$c("DocumentReference.update",t)),this.zT.write(n.gc(this.Pc,Mi.exists(!0)))},Pl.prototype.delete=function(){return Eh("DocumentReference.delete",arguments,0),this.zT.write([new zi(this.Pc,Mi.ft())])},Pl.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Ih("DocumentReference.onSnapshot",arguments,1,4);var n={includeMetadataChanges:!1},r=0;"object"!=typeof t[r]||al(t[r])||(Lh("DocumentReference.onSnapshot",n=t[r],["includeMetadataChanges"]),Sh("DocumentReference.onSnapshot","boolean","includeMetadataChanges",n.includeMetadataChanges),r++);var i={includeMetadataChanges:n.includeMetadataChanges},o=al(t[r])?t[r]:(Nh("DocumentReference.onSnapshot","function",r,t[r]),_h("DocumentReference.onSnapshot","function",r+1,t[r+1]),_h("DocumentReference.onSnapshot","function",r+2,t[r+2]),{next:t[r],error:t[r+1],complete:t[r+2]});return this.fE(i,o)},Pl.prototype.fE=function(t,n){var r=this,e=function(t){console.error("Uncaught Error in onSnapshot:",t)};n.error&&(e=n.error.bind(n));var i=new Zf({next:function(t){var e;n.next&&(e=t.docs.get(r.Pc),n.next(new bl(r.firestore,r.Pc,e,t.fromCache,t.hasPendingWrites,r.Vc)))},error:e}),o=this.zT.listen(No.Wt(this.Pc.path),i,t);return function(){i.kT(),r.zT.al(o)}},Pl.prototype.get=function(n){var r=this;return Ih("DocumentReference.get",arguments,0,1),Ml("DocumentReference.get",n),new Promise(function(e,t){n&&"cache"===n.source?r.firestore.GT().FT(r.Pc).then(function(t){e(new bl(r.firestore,r.Pc,t,!0,t instanceof bo&&t.At,r.Vc))},t):r.TE(e,t,n)})},Pl.prototype.TE=function(e,n,r){var i=this.fE({includeMetadataChanges:!0,qf:!0},{next:function(t){i(),!t.exists&&t.metadata.fromCache?n(new Ar(_r.UNAVAILABLE,"Failed to get document because the client is offline.")):t.exists&&t.metadata.fromCache&&r&&"server"===r.source?n(new Ar(_r.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):e(t)},error:n})},Pl.prototype.withConverter=function(t){return new Pl(this.Pc,this.firestore,t)},Pl),wl=(Dl.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Dl),bl=(xl.prototype.data=function(t){var e=this;if(Ih("DocumentSnapshot.data",arguments,0,1),t=jl("DocumentSnapshot.data",t),this.EE){if(this.Vc){var n=new El(this.uE,this.Pc,this.EE,this.IE,this.wE,null);return this.Vc.fromFirestore(n,t)}return new ll(this.uE.mc,this.uE.aE(),t.serverTimestamps||"none",function(t){return new ml(t,e.uE,null)}).LT(this.EE.Mt())}},xl.prototype.get=function(t,e){var n=this;if(Ih("DocumentSnapshot.get",arguments,1,2),e=jl("DocumentSnapshot.get",e),this.EE){var r=this.EE.data().field(kc("DocumentSnapshot.get",t));if(null!==r)return new ll(this.uE.mc,this.uE.aE(),e.serverTimestamps||"none",function(t){return new ml(t,n.uE,n.Vc)}).LT(r)}},Object.defineProperty(xl.prototype,"id",{get:function(){return this.Pc.path.O()},enumerable:!0,configurable:!0}),Object.defineProperty(xl.prototype,"ref",{get:function(){return new ml(this.Pc,this.uE,this.Vc)},enumerable:!0,configurable:!0}),Object.defineProperty(xl.prototype,"exists",{get:function(){return null!==this.EE},enumerable:!0,configurable:!0}),Object.defineProperty(xl.prototype,"metadata",{get:function(){return new wl(this.wE,this.IE)},enumerable:!0,configurable:!0}),xl.prototype.isEqual=function(t){if(!(t instanceof xl))throw Vh("isEqual","DocumentSnapshot",1,t);return this.uE===t.uE&&this.IE===t.IE&&this.Pc.isEqual(t.Pc)&&(null===this.EE?null===t.EE:this.EE.isEqual(t.EE))&&this.Vc===t.Vc},xl),El=(n(Rl,cl=bl),Rl.prototype.data=function(t){return cl.prototype.data.call(this,t)},Rl),Tl=(Sl.prototype.where=function(t,e,n){Eh("Query.where",arguments,3),kh("Query.where",3,n);var r,i=xh("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e),o=kc("Query.where",t);if(o.Y()){if("array-contains"===i||"array-contains-any"===i)throw new Ar(_r.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i){this.AE(n,i);for(var s=[],u=0,a=n;u<a.length;u++){var h=a[u];s.push(this.mE(h))}r={arrayValue:{values:s}}}else r=this.mE(n)}else"in"!==i&&"array-contains-any"!==i||this.AE(n,i),r=this.firestore.tE.Mc("Query.where",n,"in"===i);var c=_o.create(o,i,r);return this.PE(c),new Sl(this.RE.Gt(c),this.firestore,this.Vc)},Sl.prototype.orderBy=function(t,e){var n;if(Ih("Query.orderBy",arguments,1,2),_h("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Ar(_r.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}if(null!==this.RE.startAt)throw new Ar(_r.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.RE.endAt)throw new Ar(_r.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var r=kc("Query.orderBy",t),i=new Oo(r,n);return this.VE(i),new Sl(this.RE.zt(i),this.firestore,this.Vc)},Sl.prototype.limit=function(t){return Eh("Query.limit",arguments,1),Nh("Query.limit","number",1,t),Ch("Query.limit",1,t),new Sl(this.RE.Ht(t),this.firestore,this.Vc)},Sl.prototype.limitToLast=function(t){return Eh("Query.limitToLast",arguments,1),Nh("Query.limitToLast","number",1,t),Ch("Query.limitToLast",1,t),new Sl(this.RE.Yt(t),this.firestore,this.Vc)},Sl.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Th("Query.startAt",arguments,1);var r=this.gE("Query.startAt",t,e,!0);return new Sl(this.RE.Jt(r),this.firestore,this.Vc)},Sl.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Th("Query.startAfter",arguments,1);var r=this.gE("Query.startAfter",t,e,!1);return new Sl(this.RE.Jt(r),this.firestore,this.Vc)},Sl.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Th("Query.endBefore",arguments,1);var r=this.gE("Query.endBefore",t,e,!0);return new Sl(this.RE.Xt(r),this.firestore,this.Vc)},Sl.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Th("Query.endAt",arguments,1);var r=this.gE("Query.endAt",t,e,!1);return new Sl(this.RE.Xt(r),this.firestore,this.Vc)},Sl.prototype.isEqual=function(t){if(!(t instanceof Sl))throw Vh("isEqual","Query",1,t);return this.firestore===t.firestore&&this.RE.isEqual(t.RE)&&this.Vc===t.Vc},Sl.prototype.withConverter=function(t){return new Sl(this.RE,this.firestore,t)},Sl.prototype.gE=function(t,e,n,r){if(kh(t,1,e),e instanceof bl){if(0<n.length)throw new Ar(_r.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var i=e;if(!i.exists)throw new Ar(_r.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.pE(i.EE,r)}var o=[e].concat(n);return this.yE(t,o,r)},Sl.prototype.pE=function(t,e){for(var n=[],r=0,i=this.RE.orderBy;r<i.length;r++){var o=i[r];if(o.field.Y())n.push(vi(this.firestore.mc,t.key));else{var s=t.field(o.field);if(ii(s))throw new Ar(_r.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===s){var u=o.field.j();throw new Ar(_r.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}n.push(s)}}return new Po(n,e)},Sl.prototype.yE=function(t,e,n){var r=this.RE.Ot;if(e.length>r.length)throw new Ar(_r.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<e.length;o++){var s=e[o];if(r[o].field.Y()){if("string"!=typeof s)throw new Ar(_r.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof s);if(!this.RE._e()&&-1!==s.indexOf("/"))throw new Ar(_r.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+s+"' contains a slash.");var u=this.RE.path.child(Lr.K(s));if(!Qr.et(u))throw new Ar(_r.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+u+"' is not because it contains an odd number of segments.");var a=new Qr(u);i.push(vi(this.firestore.mc,a))}else{var h=this.firestore.tE.Mc(t,s);i.push(h)}}return new Po(i,n)},Sl.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Ih("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!=typeof t[i]||al(t[i])||(Lh("Query.onSnapshot",r=t[i],["includeMetadataChanges"]),Sh("Query.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++),n=al(t[i])?t[i]:(Nh("Query.onSnapshot","function",i,t[i]),_h("Query.onSnapshot","function",i+1,t[i+1]),_h("Query.onSnapshot","function",i+2,t[i+2]),{next:t[i],error:t[i+1],complete:t[i+2]}),this.bE(this.RE),this.fE(r,n)},Sl.prototype.fE=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Zf({next:function(t){e.next&&e.next(new Il(n.firestore,n.RE,t,n.Vc))},error:r}),o=this.firestore.GT(),s=o.listen(this.RE,i,t);return function(){i.kT(),o.al(s)}},Sl.prototype.bE=function(t){if(t.ae()&&0===t.Ot.length)throw new Ar(_r.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},Sl.prototype.get=function(n){var r=this;return Ih("Query.get",arguments,0,1),Ml("Query.get",n),this.bE(this.RE),new Promise(function(e,t){n&&"cache"===n.source?r.firestore.GT().NT(r.RE).then(function(t){e(new Il(r.firestore,r.RE,t,r.Vc))},t):r.TE(e,t,n)})},Sl.prototype.TE=function(e,n,r){var i=this.fE({includeMetadataChanges:!0,qf:!0},{next:function(t){i(),t.metadata.fromCache&&r&&"server"===r.source?n(new Ar(_r.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):e(t)},error:n})},Sl.prototype.mE=function(t){if("string"==typeof t){if(""===t)throw new Ar(_r.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.RE._e()&&-1!==t.indexOf("/"))throw new Ar(_r.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this.RE.path.child(Lr.K(t));if(!Qr.et(e))throw new Ar(_r.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return vi(this.firestore.mc,new Qr(e))}if(t instanceof ml)return vi(this.firestore.mc,t.Pc);throw new Ar(_r.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Oh(t)+".")},Sl.prototype.AE=function(t,e){if(!Array.isArray(t)||0===t.length)throw new Ar(_r.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Ar(_r.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new Ar(_r.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Ar(_r.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},Sl.prototype.PE=function(t){if(t instanceof _o){var e=["array-contains","array-contains-any"],n=["in","array-contains-any"],r=0<=e.indexOf(t.op),i=0<=n.indexOf(t.op);if(t.ue()){var o=this.RE.jt();if(null!==o&&!o.isEqual(t.field))throw new Ar(_r.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var s=this.RE.Kt();null!==s&&this.vE(t.field,s)}else if(i||r){var u=null;if(i&&(u=this.RE.ce(n)),null===u&&r&&(u=this.RE.ce(e)),null!=u)throw u===t.op?new Ar(_r.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new Ar(_r.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+u.toString()+"' filters.")}}},Sl.prototype.VE=function(t){var e;null!==this.RE.Kt()||null!==(e=this.RE.jt())&&this.vE(e,t.field)},Sl.prototype.vE=function(t,e){if(!e.isEqual(t))throw new Ar(_r.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},Sl),Il=(Object.defineProperty(Al.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!0,configurable:!0}),Object.defineProperty(Al.prototype,"empty",{get:function(){return this.DE.docs.B()},enumerable:!0,configurable:!0}),Object.defineProperty(Al.prototype,"size",{get:function(){return this.DE.docs.size},enumerable:!0,configurable:!0}),Al.prototype.forEach=function(e,n){var r=this;Ih("QuerySnapshot.forEach",arguments,1,2),Nh("QuerySnapshot.forEach","function",1,e),this.DE.docs.forEach(function(t){e.call(n,r.NE(t))})},Object.defineProperty(Al.prototype,"query",{get:function(){return new Tl(this.SE,this.uE,this.Vc)},enumerable:!0,configurable:!0}),Al.prototype.docChanges=function(t){t&&(Lh("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Sh("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.DE.hs)throw new Ar(_r.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.CE&&this.FE===e||(this.CE=function(i,e,o,s){if(o.ss.B()){var n=0;return o.docChanges.map(function(t){var e=new El(i,t.doc.key,t.doc,o.fromCache,o.ns.has(t.doc.key),s);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var u=o.ss;return o.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new El(i,t.doc.key,t.doc,o.fromCache,o.ns.has(t.doc.key),s),n=-1,r=-1;return 0!==t.type&&(n=u.indexOf(t.doc.key),u=u.delete(t.doc.key)),1!==t.type&&(r=(u=u.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return zs()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.uE,e,this.DE,this.Vc),this.FE=e),this.CE},Al.prototype.isEqual=function(t){if(!(t instanceof Al))throw Vh("isEqual","QuerySnapshot",1,t);return this.uE===t.uE&&this.SE.isEqual(t.SE)&&this.DE.isEqual(t.DE)&&this.Vc===t.Vc},Al.prototype.NE=function(t){return new El(this.uE,t.key,t,this.metadata.fromCache,this.DE.ns.has(t.key),this.Vc)},Al),Nl=(n(_l,hl=Tl),Object.defineProperty(_l.prototype,"id",{get:function(){return this.RE.path.O()},enumerable:!0,configurable:!0}),Object.defineProperty(_l.prototype,"parent",{get:function(){var t=this.RE.path.M();return t.B()?null:new ml(new Qr(t),this.firestore,null)},enumerable:!0,configurable:!0}),Object.defineProperty(_l.prototype,"path",{get:function(){return this.RE.path.j()},enumerable:!0,configurable:!0}),_l.prototype.doc=function(t){Ih("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Ks.cn()),Nh("CollectionReference.doc","non-empty string",1,t);var e=Lr.K(t);return ml.oE(this.RE.path.child(e),this.firestore,this.Vc)},_l.prototype.add=function(t){Eh("CollectionReference.add",arguments,1),Nh("CollectionReference.add","object",1,this.Vc?this.Vc.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},_l.prototype.withConverter=function(t){return new _l(this.$E,this.firestore,t)},_l);function _l(t,e,n){var r=this;if(((r=hl.call(this,No.Wt(t),e,n)||this).$E=t).length%2!=1)throw new Ar(_r.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.j()+" has "+t.length);return r}function Al(t,e,n,r){this.uE=t,this.SE=e,this.DE=n,this.Vc=r,this.CE=null,this.FE=null,this.metadata=new wl(n.hasPendingWrites,n.fromCache)}function Sl(t,e,n){this.RE=t,this.firestore=e,this.Vc=n}function Rl(){return null!==cl&&cl.apply(this,arguments)||this}function xl(t,e,n,r,i,o){this.uE=t,this.Pc=e,this.EE=n,this.IE=r,this.wE=i,this.Vc=o}function Dl(t,e){this.hasPendingWrites=t,this.fromCache=e}function Pl(t,e,n){var r=this;return(r=fl.call(this,e.mc,t,n)||this).Pc=t,r.firestore=e,r.Vc=n,r.zT=r.firestore.GT(),r}function Ol(t){this.uE=t,this._E=[],this.lE=!1}function kl(t,e){this.uE=t,this.cE=e}function Ll(t,e,n){var r=this;if(void 0===n&&(n=new Xf),this.jT=null,this.KT=new Xa,this.INTERNAL={delete:function(){return y(r,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.GT(),[4,this.zT.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var i=t;this.jT=i,this.mc=Ll.HT(i),this.YT=i.name,this.JT=new Rr(e)}else{var o=t;if(!o.projectId)throw new Ar(_r.INVALID_ARGUMENT,"Must provide projectId");this.mc=new $s(o.projectId,o.database),this.YT="[DEFAULT]",this.JT=new Sr}this.XT=n,this.ZT=new dl({})}function Vl(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new Ar(_r.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Ah("settings","non-empty string","host",t.host),this.host=t.host,Sh("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(Lh("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),Sh("settings","object","credentials",t.credentials),this.credentials=t.credentials,Sh("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),Sh("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Bs("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Bs("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,Sh("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=rh.uu;else{if(t.cacheSizeBytes!==pl&&t.cacheSizeBytes<rh.au)throw new Ar(_r.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+rh.au);this.cacheSizeBytes=t.cacheSizeBytes}Sh("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}function Cl(t,e,n,r){this.ii=t,this.timestampsInSnapshots=e,this.MT=n,this.xT=r}function Ul(t,e){if(void 0===e)return{merge:!1};if(Lh(t,e,["merge","mergeFields"]),Sh(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Ar(_r.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Oh(n));for(var r,i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof zh))throw new Ar(_r.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+Oh(n[i]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Ar(_r.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function jl(t,e){return void 0===e?{}:(Lh(t,e,["serverTimestamps"]),Rh(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Ml(t,e){_h(t,"object",1,e),e&&(Lh(t,e,["source"]),Rh(t,0,"source",e.source,["default","server","cache"]))}function ql(t,e,n){if(e instanceof fc){if(e.firestore!==n)throw new Ar(_r.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Vh(t,"DocumentReference",1,e)}function Fl(t,e,n){var r;return t?(r=t.toFirestore(e),n="toFirestore() in "+n):r=e,[r,n]}function Bl(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new Ar(_r.INVALID_ARGUMENT,t)}return n.prototype=t.prototype,Object.assign(n,t),n}var Gl,zl=Bl(yl,"Use firebase.firestore() instead."),Wl=Bl(vl,"Use firebase.firestore().runTransaction() instead."),Kl=Bl(gl,"Use firebase.firestore().batch() instead."),Hl=Bl(ml,"Use firebase.firestore().doc() instead."),Ql=Bl(bl),Yl=Bl(El),Xl=Bl(Tl),Jl=Bl(Il),$l=Bl(Nl,"Use firebase.firestore().collection() instead."),Zl=Bl(uc,"Use FieldValue.<field>() instead."),tp=Bl(Gh,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),ep={Firestore:zl,GeoPoint:hc,Timestamp:Pr,Blob:tp,Transaction:Wl,WriteBatch:Kl,DocumentReference:Hl,DocumentSnapshot:Ql,Query:Xl,QueryDocumentSnapshot:Yl,QuerySnapshot:Jl,CollectionReference:$l,FieldPath:zh,FieldValue:Zl,setLogLevel:yl.setLogLevel,CACHE_SIZE_UNLIMITED:pl},np=(fp.prototype.Q_=function(t){},fp.prototype.Vo=function(){},fp),rp=(cp.prototype.Q_=function(t){this.OE.push(t)},cp.prototype.Vo=function(){window.removeEventListener("online",this.kE),window.removeEventListener("offline",this.xE)},cp.prototype.BE=function(){window.addEventListener("online",this.kE),window.addEventListener("offline",this.xE)},cp.prototype.ME=function(){Fs("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.OE;t<e.length;t++)(0,e[t])(0)},cp.prototype.LE=function(){Fs("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.OE;t<e.length;t++)(0,e[t])(1)},cp.zh=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},cp),ip=(hp.prototype.s_=function(t){this.QE=t},hp.prototype.Jc=function(t){this.WE=t},hp.prototype.onMessage=function(t){this.jE=t},hp.prototype.close=function(){this.UE()},hp.prototype.send=function(t){this.qE(t)},hp.prototype.KE=function(){this.QE()},hp.prototype.GE=function(t){this.WE(t)},hp.prototype.zE=function(t){this.jE(t)},hp),op={BatchGetDocuments:"batchGet",Commit:"commit"},sp="gl-js/ fire/"+wr,up=(ap.prototype.YE=function(t,e){if(e)for(var n in e.o)e.o.hasOwnProperty(n)&&(t[n]=e.o[n]);t["X-Goog-Api-Client"]=sp},ap.prototype.E_=function(a,r,i){var h=this,c=this.JE(a);return new Promise(function(o,s){var u=new mr;u.listenOnce(vr.COMPLETE,function(){try{switch(u.getLastErrorCode()){case yr.NO_ERROR:var t=u.getResponseJson();Fs("Connection","XHR received:",JSON.stringify(t)),o(t);break;case yr.TIMEOUT:Fs("Connection",'RPC "'+a+'" timed out'),s(new Ar(_r.DEADLINE_EXCEEDED,"Request time out"));break;case yr.HTTP_ERROR:var e,n,r=u.getStatus();Fs("Connection",'RPC "'+a+'" failed with status:',r,"response text:",u.getResponseText()),0<r?(e=u.getResponseJson().error)&&e.status&&e.message?(i=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(_r).indexOf(i)?i:_r.UNKNOWN,s(new Ar(n,e.message))):s(new Ar(_r.UNKNOWN,"Server responded with status "+u.getStatus())):(Fs("Connection",'RPC "'+a+'" failed'),s(new Ar(_r.UNAVAILABLE,"Connection failed.")));break;default:zs()}}finally{Fs("Connection",'RPC "'+a+'" completed.')}var i});var t=Object.assign({},r);delete t.database;var e=JSON.stringify(t);Fs("Connection","XHR sending: ",c+" "+e);var n={"Content-Type":"text/plain"};h.YE(n,i),u.send(c,"POST",e,n,15)})},ap.prototype.I_=function(t,e,n){return this.E_(t,e,n)},ap.prototype.i_=function(t,e){var n,r,i=[this.HE,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=dr(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.ii.projectId+"/databases/"+this.ii.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.YE(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(g())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=g().indexOf("Electron/")||0<=(r=g()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=g().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Fs("Connection","Creating WebChannel: "+u+" "+s);var h=o.createWebChannel(u,s),c=!1,f=!1,l=new ip({qE:function(t){f?Fs("Connection","Not sending because WebChannel is closed:",t):(c||(Fs("Connection","Opening WebChannel transport."),h.open(),c=!0),Fs("Connection","WebChannel sending:",t),h.send(t))},UE:function(){return h.close()}});return a(gr.EventType.OPEN,function(){f||Fs("Connection","WebChannel transport opened.")}),a(gr.EventType.CLOSE,function(){f||(f=!0,Fs("Connection","WebChannel transport closed"),l.GE())}),a(gr.EventType.ERROR,function(t){f||(f=!0,function(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];js.logLevel<=p.WARN&&(e=n.map(Gs),js.warn.apply(js,d(["Firestore ("+wr+"): Connection"],e)))}("Connection","WebChannel transport errored:",t),l.GE(new Ar(_r.UNAVAILABLE,"The operation could not be completed")))}),a(gr.EventType.MESSAGE,function(t){var e,n,r,i,o,s;f||(Ws(!!(n=t.data[0])),(r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(Fs("Connection","WebChannel received error:",r),i=r.status,o=function(){var t=ao[i];if(void 0!==t)return Yo(t)}(),s=r.message,void 0===o&&(o=_r.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),f=!0,l.GE(new Ar(o,s)),h.close()):(Fs("Connection","WebChannel received:",n),l.zE(n)))}),setTimeout(function(){l.KE()},0),l},ap.prototype.JE=function(t){var e=op[t];return this.HE+"/v1/projects/"+this.ii.projectId+"/databases/"+this.ii.database+"/documents:"+e},ap);function ap(t){this.ii=t.ii;var e=t.ssl?"https":"http";this.HE=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function hp(t){this.qE=t.qE,this.UE=t.UE}function cp(){var t=this;this.kE=function(){return t.ME()},this.xE=function(){return t.LE()},this.OE=[],this.BE()}function fp(){}function lp(){this.oc="undefined"!=typeof atob}Us.an((Object.defineProperty(lp.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(lp.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),lp.prototype.vT=function(t){return Promise.resolve(new up(t))},lp.prototype.pT=function(){return new(rp.zh()?rp:np)},lp.prototype.Cc=function(t){return new Ls(t,{hi:!0})},lp.prototype.un=function(t){return JSON.stringify(t)},lp.prototype.atob=function(t){return atob(t)},lp.prototype.btoa=function(t){return btoa(t)},lp.prototype._n=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n},new lp)),(Gl=pp).INTERNAL.registerComponent(new T("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new yl(e,n,new Jf);var e,n},"PUBLIC").setServiceProps(Object.assign({},ep))),Gl.registerVersion("@firebase/firestore","1.15.1-0")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Py){"use strict";try{(function(){var f,t,e=(t=Py)&&"object"==typeof t&&"default"in t?t:{default:t},r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(be=f=f||{})[be.DEBUG=0]="DEBUG",be[be.VERBOSE=1]="VERBOSE",be[be.INFO=2]="INFO",be[be.WARN=3]="WARN",be[be.ERROR=4]="ERROR",be[be.SILENT=5]="SILENT";var u={debug:f.DEBUG,verbose:f.VERBOSE,info:f.INFO,warn:f.WARN,error:f.ERROR,silent:f.SILENT},a=f.INFO,c=((Ee={})[f.DEBUG]="log",Ee[f.VERBOSE]="log",Ee[f.INFO]="info",Ee[f.WARN]="warn",Ee[f.ERROR]="error",Ee),h=(Object.defineProperty(l.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in f))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),l.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?u[t]:t},Object.defineProperty(l.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),l.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.DEBUG],t)),this._logHandler.apply(this,s([this,f.DEBUG],t))},l.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.VERBOSE],t)),this._logHandler.apply(this,s([this,f.VERBOSE],t))},l.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.INFO],t)),this._logHandler.apply(this,s([this,f.INFO],t))},l.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.WARN],t)),this._logHandler.apply(this,s([this,f.WARN],t))},l.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,f.ERROR],t)),this._logHandler.apply(this,s([this,f.ERROR],t))},l);function l(t){this.name=t,this._logLevel=a,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e){return(e=d.call(this,e)||this).code=t,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,t=(t=this.errors[t])?(r=i,t.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").",s=new m(o,t),u=0,a=Object.keys(i);u<a.length;u++){var c=a[u];"_"!==c.slice(-1)&&(c in s&&console.warn('Overwriting FirebaseError base field "'+c+'" can cause unexpected behavior.'),s[c]=i[c])}return s},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function _(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S=N||self;function D(){}function R(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function O(t){var e=R(t);return"array"==e||"object"==e&&"number"==typeof t.length}function x(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var L="closure_uid_"+(1e9*Math.random()>>>0),k=0;function P(t,e,n){return t.call.apply(t.bind,arguments)}function U(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?P:U).apply(null,arguments)}function V(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var M=Date.now;function F(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function j(){this.j=this.j,this.i=this.i}j.prototype.j=!1,j.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,L)&&this[L]||(this[L]=++k))},j.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var G=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},q=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function B(){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function K(t){return/^[\s\xa0]*$/.test(t)}var Q,H=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function W(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}var Y=S.navigator;function J(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Z(t){var e,n={};for(e in t)n[e]=t[e];return n}Q=(Y=Y&&Y.userAgent)?Y:"";var $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<$.length;i++)e=$[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function et(t){return et[" "](t),t}et[" "]=D;var nt,rt=W(Q,"Opera"),it=W(Q,"Trident")||W(Q,"MSIE"),ot=W(Q,"Edge"),st=ot||it,ut=W(Q,"Gecko")&&!(W(Q.toLowerCase(),"webkit")&&!W(Q,"Edge"))&&!(W(Q,"Trident")||W(Q,"MSIE"))&&!W(Q,"Edge"),at=W(Q.toLowerCase(),"webkit")&&!W(Q,"Edge");function ct(){var t=S.document;return t?t.documentMode:void 0}var ht="",lt=(lt=Q,ut?/rv:([^\);]+)(\)|;)/.exec(lt):ot?/Edge\/([\d\.]+)/.exec(lt):it?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(lt):at?/WebKit\/(\S+)/.exec(lt):rt?/(?:Version)[ \/]?(\S+)/.exec(lt):void 0);lt&&(ht=lt?lt[1]:""),nt=it&&null!=(lt=ct())&&lt>parseFloat(ht)?String(lt):ht;var ft={};function pt(u){return t=u,e=function(){for(var t=0,e=H(String(nt)).split("."),n=H(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=ft,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var dt=S.document&&it&&(ct()||parseInt(nt,10))||void 0,yt=!it||9<=Number(dt),vt=it&&!pt("9"),gt=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",D,e),S.removeEventListener("test",D,e)}catch(t){}return t}();function mt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function wt(t,e){if(mt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ut){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:bt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}mt.prototype.b=function(){this.defaultPrevented=!0},F(wt,mt);var bt={2:"touch",3:"pen",4:"mouse"};wt.prototype.b=function(){wt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,vt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Et="closure_listenable_"+(1e6*Math.random()|0),It=0;function Tt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++It,this.Y=this.Z=!1}function _t(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function At(t){this.src=t,this.a={},this.b=0}function Nt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=G(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(_t(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function St(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}At.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=St(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Tt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Dt="closure_lm_"+(1e6*Math.random()|0),Rt={};function Ot(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Mt(r),e&&e[Et]?e.wa(n,r,x(i)?!!i.capture:!!i,o):xt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ot(t,e[o],n,r,i);return null}return n=Mt(n),t&&t[Et]?t.va(e,n,x(r)?!!r.capture:!!r,i):xt(t,e,n,!1,r,i)}function xt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=x(i)?!!i.capture:!!i;if(s&&!yt)return null;var u,a,c=Ct(t);if(c||(t[Dt]=c=new At(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Ut,r=a=yt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)gt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(kt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Lt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Et]?Nt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(kt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ct(e))?(Nt(n,t),0==n.b&&(n.src=null,e[Dt]=null)):_t(t)))}function kt(t){return t in Rt?Rt[t]:Rt[t]="on"+t}function Pt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Lt(t),n.call(r,e)}function Ut(t,e){if(t.Y)return!0;if(yt)return Pt(t,new wt(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Pt(t,e=new wt(e,this))}function Ct(t){return(t=t[Dt])instanceof At?t:null}var Vt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Mt(e){return"function"==R(e)?e:(e[Vt]||(e[Vt]=function(t){return e.handleEvent(t)}),e[Vt])}function Ft(){j.call(this),this.c=new At(this),(this.J=this).C=null}function jt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Nt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}F(Ft,j),Ft.prototype[Et]=!0,(A=Ft.prototype).addEventListener=function(t,e,n,r){Ot(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=x(i)?!!i.capture:!!i,r=Mt(r),e&&e[Et]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=St(s=e.a[n],r,i,o))&&(_t(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ct(e))&&(n=e.a[n.toString()],e=-1,n&&(e=St(n,r,i,o)),(r=-1<e?n[e]:null)&&Lt(r))}(this,t,e,n,r)},A.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new mt(t,n):t instanceof mt?t.target=t.target||n:(s=t,tt(t=new mt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=jt(o,r,!0,t)&&s;if(s=jt(o=t.a=n,r,!0,t)&&s,s=jt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=jt(o=t.a=e[i],r,!1,t)&&s;return s},A.G=function(){if(Ft.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)_t(n[r]);delete e.a[t],e.b--}}this.C=null},A.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},A.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Gt=S.JSON.stringify;function qt(){this.b=this.a=null}var Bt,zt=(Kt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Kt(function(){return new Qt},function(t){t.reset()},100));function Kt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Qt(){this.next=this.b=this.a=null}function Ht(t,e){var n;Bt||(n=S.Promise.resolve(void 0),Bt=function(){n.then(Yt)}),Wt||(Bt(),Wt=!0),Xt.add(t,e)}qt.prototype.add=function(t,e){var n=zt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Qt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Wt=!(Qt.prototype.reset=function(){this.next=this.b=this.a=null}),Xt=new qt;function Yt(){for(var t,e;n=e=void 0,n=null,(e=Xt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var n=zt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Wt=!1}function Jt(t,e){Ft.call(this),this.b=t||1,this.a=e||S,this.f=C(this.Ya,this),this.g=M()}function Zt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function $t(t,e,n){if("function"==R(t))n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}F(Jt,Ft),(A=Jt.prototype).aa=!1,A.M=null,A.Ya=function(){var t;this.aa&&(0<(t=M()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(Zt(this),this.start())))},A.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=M())},A.G=function(){Jt.S.G.call(this),Zt(this),delete this.a};var te,ee,ne,re=(T(ee=oe,ne=te=j),ee.prototype=null===ne?Object.create(ne):(ie.prototype=ne.prototype,new ie),oe.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=$t(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},oe.prototype.G=function(){te.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},oe);function ie(){this.constructor=ee}function oe(t,e,n){var r=te.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function se(t){j.call(this),this.b=t,this.a={}}F(se,j);var ue=[];function ae(t,e,n,r){Array.isArray(n)||(n&&(ue[0]=n.toString()),n=ue);for(var i=0;i<n.length;i++){var o=Ot(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ce(t){J(t.a,function(t,e){this.a.hasOwnProperty(e)&&Lt(t)},t),t.a={}}function he(){this.a=!0}function le(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return Gt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}se.prototype.G=function(){se.S.G.call(this),ce(this)},se.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},he.prototype.info=function(){};var fe=null;function pe(){return fe=fe||new Ft}function de(t){mt.call(this,"serverreachability",t)}function ye(){var t=pe();t.dispatchEvent(new de(t))}function ve(t){mt.call(this,"statevent",t)}function ge(){var t=pe();t.dispatchEvent(new ve(t))}function me(t){mt.call(this,"timingevent",t)}function we(t,e){if("function"!=R(t))throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}F(de,mt),F(ve,mt),F(me,mt);var be={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ee={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Ie(){}function Te(t){var e;return(e=t.a)||(e=t.a={}),e}function _e(){}Ie.prototype.a=null;var Ae,N={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Ne(){mt.call(this,"d")}function Se(){mt.call(this,"c")}function De(){}function Re(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new se(this),this.P=Oe,t=st?125:void 0,this.R=new Jt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}F(Ne,mt),F(Se,mt),F(De,Ie),Ae=new De;var Oe=45e3,xe={},Le={};function ke(t,e,n){t.H=1,t.i=tn(We(e)),t.j=n,t.I=!0,Pe(t,null)}function Pe(t,e){t.u=M(),Ce(t),t.l=We(t.i);var s,u,a,c,h,l,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),dn(n.b,"t",r),t.D=0,t.a=ur(t.g,t.g.C?e:null),0<t.O&&(t.F=new re(C(t.Ca,t,t.a),t.O)),ae(t.J,t.a,"readystatechange",t.Wa),e=t.B?Z(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ye(),s=t.c,u=t.m,a=t.l,c=t.f,h=t.T,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Ue(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Le:(i=Number(u.substring(i,o)),isNaN(i)?xe:(o+=1)+i>u.length?Le:(u=u.substr(o,i),r.D=o+i,u)));if(u==Le){4==e&&(t.h=4,ge(),s=!1),le(t.c,t.f,null,"[Incomplete Response]");break}if(u==xe){t.h=4,ge(),le(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}le(t.c,t.f,u,null),Ge(t,u)}4==e&&0==n.length&&(t.h=1,ge(),s=!1),t.b=t.b&&s,s?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),$n(e),e.F=!0)):(le(t.c,t.f,n,"[Invalid Chunked Response]"),je(t),Fe(t))}function Ce(t){t.U=M()+t.P,Ve(t,t.P)}function Ve(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=we(C(t.Ua,t),e)}function Me(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function Fe(t){0==t.g.v||t.A||nr(t.g,t)}function je(t){Me(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Zt(t.R),ce(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ge(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||En(u.b,t)))if(u.I=t.N,!t.C&&En(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;er(u),zn(u)}Zn(u),ge()}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=we(C(u.Ra,u),6e3));if(bn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else ir(u,11)}else if(!t.C&&u.a!=t||er(u),!K(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(W(r,"spdy")||W(r,"quic")||W(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(In(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,$e(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.V&&(u.N=M()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=sr(n,n.C?n.ga:null,n.fa),i.C?(Tn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Me(o),Ce(o)),n.a=i):Jn(n),0<u.g.length&&Hn(u)):"stop"!=c[0]&&"close"!=c[0]||ir(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?ir(u,7):Bn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0);ye()}catch(t){}}function qe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(O(t)||"string"==typeof t)q(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(O(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(O(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Be(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Be)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function ze(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Ke(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Ke(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Ke(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=Re.prototype).setTimeout=function(t){this.P=t},A.Wa=function(t){t=t.target;var e=this.F;e&&3==Fn(t)?e.f():this.Ca(t)},A.Ca=function(t){try{if(t==this.a)t:{var e=Fn(this.a),n=this.a.ua(),r=this.a.X();if(!(e<3||3==e&&!st&&!this.a.$())){this.A||4!=e||7==n||ye(),Me(this);var i=this.a.X();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,u=this.m,a=this.l,c=this.f,h=this.T,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+c+") [ attempt "+h+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.V&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!K(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,ge(),je(this),Fe(this);break t}le(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ge(this,s)}this.I?(Ue(this,e,n),st&&this.b&&3==e&&(ae(this.J,this.R,"tick",this.Va),this.R.start())):(le(this.c,this.f,n,null),Ge(this,n)),4==e&&je(this),this.b&&!this.A&&(4==e?nr(this.g,this):(this.b=!1,Ce(this)))}else 400==i&&0<n.indexOf("Unknown SID")?this.h=3:this.h=0,ge(),je(this),Fe(this)}}}catch(t){}var u,a,c,h,l,f},A.Va=function(){var t,e;this.a&&(t=Fn(this.a),e=this.a.$(),this.D<e.length&&(Me(this),Ue(this,t,e),this.b&&4!=t&&Ce(this)))},A.cancel=function(){this.A=!0,je(this)},A.Ua=function(){this.o=null;var t,e,n=M();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ye(),ge()),je(this),this.h=2,Fe(this)):Ve(this,this.U-n)},(A=Be.prototype).K=function(){ze(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.L=function(){return ze(this),this.a.concat()},A.get=function(t,e){return Ke(this.b,t)?this.b[t]:e},A.set=function(t,e){Ke(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Qe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function He(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof He?(this.a=void 0!==e?e:t.a,Xe(this,t.f),this.j=t.j,Ye(this,t.c),Je(this,t.h),this.g=t.g,e=t.b,(n=new hn).c=e.c,e.a&&(n.a=new Be(e.a),n.b=e.b),Ze(this,n),this.i=t.i):t&&(n=String(t).match(Qe))?(this.a=!!e,Xe(this,n[1]||"",!0),this.j=en(n[2]||""),Ye(this,n[3]||"",!0),Je(this,n[4]),this.g=en(n[5]||"",!0),Ze(this,n[6]||"",!0),this.i=en(n[7]||"")):(this.a=!!e,this.b=new hn(null,this.a))}function We(t){return new He(t)}function Xe(t,e,n){t.f=n?en(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ye(t,e,n){t.c=n?en(e,!0):e}function Je(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ze(t,e,n){var r,i;e instanceof hn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(ln(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(fn(this,e),dn(this,n,t))},r)),r.f=i):(n||(e=nn(e,an)),t.b=new hn(e,t.a))}function $e(t,e,n){t.b.set(e,n)}function tn(t){return $e(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^M()).toString(36)),t}function en(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function nn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,rn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function rn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}He.prototype.toString=function(){var t=[],e=this.f;e&&t.push(nn(e,on,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(nn(e,on,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(nn(n,"/"==n.charAt(0)?un:sn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",nn(n,cn)),t.join("")};var on=/[#\/\?@]/g,sn=/[#\?:]/g,un=/[#\?]/g,an=/[#\?@]/g,cn=/#/g;function hn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function ln(u){u.a||(u.a=new Be,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function fn(t,e){ln(t),e=yn(t,e),Ke(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ke((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&ze(t)))}function pn(t,e){return ln(t),e=yn(t,e),Ke(t.a.b,e)}function dn(t,e,n){fn(t,e),0<n.length&&(t.c=null,t.a.set(yn(t,e),z(n)),t.b+=n.length)}function yn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function vn(t,e){this.b=t,this.a=e}function gn(t){this.g=t||mn,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(A=hn.prototype).add=function(t,e){ln(this),this.c=null,t=yn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,r){ln(this),this.a.forEach(function(t,e){q(t,function(t){n.call(r,t,e,this)},this)},this)},A.L=function(){ln(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},A.K=function(t){ln(this);var e=[];if("string"==typeof t)pn(this,t)&&(e=B(e,this.a.get(yn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},A.set=function(t,e){return ln(this),this.c=null,pn(this,t=yn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var mn=10;function wn(t){return t.b||t.a&&t.a.size>=t.f}function bn(t){return t.b?1:t.a?t.a.size:0}function En(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function In(t,e){t.a?t.a.add(e):t.b=e}function Tn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function _n(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=_(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function An(){}function Nn(){this.a=new An}function Sn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}gn.prototype.cancel=function(){var t,e;if(this.c=_n(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=_(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},An.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},An.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var Dn=S.JSON.parse;function Rn(t){Ft.call(this),this.headers=new Be,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=On,this.D=this.F=!1}F(Rn,Ft);var On="",xn=/^https?$/i,Ln=["POST","PUT"];function kn(t){return"content-type"==t.toLowerCase()}function Pn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Un(t),Vn(t)}function Un(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Cn(t){if(t.b&&(!t.s[1]||4!=Fn(t)||2!=t.X()))if(t.l&&4==Fn(t))$t(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==Fn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Qe)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!xn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Fn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Un(t)}}finally{Vn(t)}}}function Vn(t,e){if(t.a){Mn(t);var n=t.a,r=t.s[0]?D:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Mn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function Fn(t){return t.a?t.a.readyState:0}function jn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",J(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):$e(t,e,n))}function Gn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function qn(t){this.pa=0,this.g=[],this.c=new he,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Gn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Gn("baseRetryDelayMs",5e3,t),this.Ma=Gn("retryDelaySeedMs",1e4,t),this.Ja=Gn("forwardChannelMaxRetries",2,t),this.ma=Gn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new gn(t&&t.concurrentRequestLimit),this.ka=new Nn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Bn(t){var e,n;Kn(t),3==t.v&&(e=t.R++,$e(n=We(t.B),"SID",t.J),$e(n,"RID",e),$e(n,"TYPE","terminate"),Xn(t,n),(e=new Re(t,t.c,e,void 0)).H=2,e.i=tn(We(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.i.toString(),"")),!n&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=ur(e.g,null),e.a.ba(e.i)),e.u=M(),Ce(e)),or(t)}function zn(t){t.a&&($n(t),t.a.cancel(),t.a=null)}function Kn(t){zn(t),t.j&&(S.clearTimeout(t.j),t.j=null),er(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function Qn(t,e){t.g.push(new vn(t.La++,e)),3==t.v&&Hn(t)}function Hn(t){wn(t.b)||t.h||(t.h=!0,Ht(t.Ba,t),t.u=0)}function Wn(t,e){var n=e?e.f:t.R++,r=We(t.B);$e(r,"SID",t.J),$e(r,"RID",n),$e(r,"AID",t.P),Xn(t,r),t.i&&t.l&&jn(r,t.i,t.l),n=new Re(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Yn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),In(t.b,n),ke(n,r,e)}function Xn(t,n){t.f&&qe({},function(t,e){$e(n,e,t)})}function Yn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?C(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+c+"_"||"";try{qe(t,function(t,e){var n=t;x(t)&&(n=Gt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s)}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Jn(t){t.a||t.j||(t.U=1,Ht(t.Aa,t),t.o=0)}function Zn(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=we(C(t.Aa,t),rr(t,t.o)),t.o++,1)}function $n(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function tr(t){t.a=new Re(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=We(t.la);$e(e,"RID","rpc"),$e(e,"SID",t.J),$e(e,"CI",t.H?"0":"1"),$e(e,"AID",t.P),Xn(t,e),$e(e,"TYPE","xmlhttp"),t.i&&t.l&&jn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=tn(We(e)),n.j=null,n.I=!0,Pe(n,t)}function er(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function nr(t,e){var n,r=null;if(t.a==e){er(t),$n(t),t.a=null;var i=2}else{if(!En(t.b,e))return;r=e.s,Tn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b)1==i?(r=e.j?e.j.length:0,e=M()-e.u,n=t.u,(i=pe()).dispatchEvent(new me(i)),Hn(t)):Jn(t);else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(bn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=we(C(t.Ba,t,e),rr(t,t.u)),t.u++,1}}(t,e)||2==i&&Zn(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:ir(t,5);break;case 4:ir(t,10);break;case 3:ir(t,6);break;default:ir(t,2)}}function rr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function ir(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=C(t.Xa,t),r||(r=new He("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||Xe(r,"https"),tn(r)),n=r.toString(),r=o,o=new he,S.Image?((i=new Image).onload=V(Sn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=V(Sn,o,i,"TestLoadImage: error",!1,r),i.onabort=V(Sn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=V(Sn,o,i,"TestLoadImage: timeout",!1,r),S.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):ge(),t.v=0,t.f&&t.f.ra(e),or(t),Kn(t)}function or(t){t.v=0,t.I=-1,t.f&&(0==_n(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function sr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof He?We(s):new He(s,void 0);return""!=a.c?(e&&Ye(a,e+"."+a.c),Je(a,a.h)):(r=(u=S.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new He(null,void 0),r&&Xe(u,r),i&&Ye(u,i),o&&Je(u,o),s&&(u.g=s),a=u),t.W&&J(t.W,function(t,e){$e(a,e,t)}),e=t.A,n=t.na,e&&n&&$e(a,e,n),$e(a,"VER",t.ha),Xn(t,a),a}function ur(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Rn(t.Ka)).F=t.C,e}function ar(){}function cr(){if(it&&!(10<=Number(dt)))throw Error("Environmental error: no available transport.")}function hr(t,e){Ft.call(this),this.a=new qn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!K(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!K(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new pr(this)}function lr(t){Ne.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function fr(){Se.call(this),this.status=1}function pr(t){this.a=t}(A=Rn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Te(this.H):Te(Ae),this.a.onreadystatechange=C(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Pn(this,t)}t=n||"";var i,o=new Be(this.headers);r&&qe(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=kn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=G(Ln,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Mn(this),0<this.o&&((this.D=(i=this.a,it&&pt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=C(this.xa,this)):this.m=$t(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Pn(this,t)}},A.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Vn(this))},A.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Vn(this,!0)),Rn.S.G.call(this)},A.za=function(){this.j||(this.A||this.l||this.g?Cn(this):this.Ta())},A.Ta=function(){Cn(this)},A.X=function(){try{return 2<Fn(this)?this.a.status:-1}catch(t){return-1}},A.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Dn(e)}},A.ua=function(){return this.h},A.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=qn.prototype).ha=8,A.v=1,A.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Re(this,this.c,t,void 0),r=this.l;if(this.O&&(r?tt(r=Z(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Yn(this,n,e),$e(i=We(this.B),"RID",t),$e(i,"CVER",22),this.A&&$e(i,"X-HTTP-Session-Id",this.A),Xn(this,i),this.i&&r&&jn(i,this.i,r),In(this.b,n),this.Ga&&$e(i,"TYPE","init"),this.da?($e(i,"$req",e),$e(i,"SID","null"),n.V=!0,ke(n,i,null)):ke(n,i,e),this.v=2}}else 3==this.v&&(t?Wn(this,t):0==this.g.length||wn(this.b)||Wn(this))},A.Aa=function(){var t;this.j=null,tr(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=we(C(this.Sa,this),t))},A.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,zn(this),tr(this))},A.Ra=function(){null!=this.m&&(this.m=null,zn(this),Zn(this),ge())},A.Xa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),ge()},(A=ar.prototype).ta=function(){},A.sa=function(){},A.ra=function(){},A.qa=function(){},A.Ha=function(){},cr.prototype.a=function(t,e){return new hr(t,e)},F(hr,Ft),(A=hr.prototype).addEventListener=function(t,e,n,r){hr.S.addEventListener.call(this,t,e,n,r)},A.removeEventListener=function(t,e,n,r){hr.S.removeEventListener.call(this,t,e,n,r)},A.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;ge(),t.fa=e,t.W=n||{},t.H=t.T,t.B=sr(t,null,t.fa),Hn(t)},A.close=function(){Bn(this.a)},A.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Qn(this.a,e)):this.g?((e={}).__data__=Gt(t),Qn(this.a,e)):Qn(this.a,t)},A.G=function(){this.a.f=null,delete this.f,Bn(this.a),delete this.a,hr.S.G.call(this)},F(lr,Ne),F(fr,Se),F(pr,ar),pr.prototype.ta=function(){this.a.dispatchEvent("a")},pr.prototype.sa=function(t){this.a.dispatchEvent(new lr(t))},pr.prototype.ra=function(t){this.a.dispatchEvent(new fr)},pr.prototype.qa=function(){this.a.dispatchEvent("b")},cr.prototype.createWebChannel=cr.prototype.a,hr.prototype.send=hr.prototype.Pa,hr.prototype.open=hr.prototype.Oa,be.NO_ERROR=0,be.TIMEOUT=8,be.HTTP_ERROR=6,Ee.COMPLETE="complete",(_e.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",Ft.prototype.listen=Ft.prototype.va,Rn.prototype.listenOnce=Rn.prototype.wa,Rn.prototype.getLastError=Rn.prototype.Qa,Rn.prototype.getLastErrorCode=Rn.prototype.ua,Rn.prototype.getStatus=Rn.prototype.X,Rn.prototype.getResponseJson=Rn.prototype.Na,Rn.prototype.getResponseText=Rn.prototype.$,Rn.prototype.send=Rn.prototype.ba;var dr=(be={createWebChannelTransport:function(){return new cr},ErrorCode:be,EventType:Ee,WebChannel:_e,XhrIo:Rn}).createWebChannelTransport,yr=be.ErrorCode,vr=be.EventType,gr=be.WebChannel,mr=be.XhrIo,wr=(br.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},br.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},br.prototype.setServiceProps=function(t){return this.serviceProps=t,this},br);function br(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Er,Ir={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Tr=(n(Nr,Er=Error),Nr),_r="7.22.1-alpha.01492c06e",Ar=new h("@firebase/firestore");function Nr(t,e){var n=this;return(n=Er.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Sr(){return Ar.logLevel}function Dr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=f.DEBUG&&(e=n.map(xr),Ar.debug.apply(Ar,i(["Firestore ("+_r+"): "+t],e)))}function Rr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=f.ERROR&&(e=n.map(xr),Ar.error.apply(Ar,i(["Firestore ("+_r+"): "+t],e)))}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=f.WARN&&(e=n.map(xr),Ar.warn.apply(Ar,i(["Firestore ("+_r+"): "+t],e)))}function xr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Lr(t){throw void 0===t&&(t="Unexpected state"),Rr(t="FIRESTORE ("+_r+") INTERNAL ASSERTION FAILED: "+t),new Error(t)}function kr(t){t||Lr()}function Pr(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Ur(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Cr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Vr,Mr,Ee=(Object.defineProperty(Qr.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),Qr.prototype.isEqual=function(t){return 0===Qr.i(this,t)},Qr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Qr?t.forEach(function(t){e.push(t)}):e.push(t),this.o(e)},Qr.prototype.limit=function(){return this.offset+this.length},Qr.prototype.u=function(t){return t=void 0===t?1:t,this.o(this.segments,this.offset+t,this.length-t)},Qr.prototype.h=function(){return this.o(this.segments,this.offset,this.length-1)},Qr.prototype.l=function(){return this.segments[this.offset]},Qr.prototype._=function(){return this.get(this.length-1)},Qr.prototype.get=function(t){return this.segments[this.offset+t]},Qr.prototype.m=function(){return 0===this.length},Qr.prototype.T=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Qr.prototype.I=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Qr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Qr.prototype.A=function(){return this.segments.slice(this.offset,this.limit())},Qr.i=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Qr),Fr=(n(Kr,Mr=Ee),Kr.prototype.o=function(t,e,n){return new Kr(t,e,n)},Kr.prototype.R=function(){return this.A().join("/")},Kr.prototype.toString=function(){return this.R()},Kr.P=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new Kr(n)},Kr.g=function(){return new Kr([])},Kr),jr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Gr=(n(zr,Vr=Ee),zr.prototype.o=function(t,e,n){return new zr(t,e,n)},zr.V=function(t){return jr.test(t)},zr.prototype.R=function(){return this.A().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),zr.V(t)||(t="`"+t+"`"),t}).join(".")},zr.prototype.toString=function(){return this.R()},zr.prototype.p=function(){return 1===this.length&&"__name__"===this.get(0)},zr.v=function(){return new zr(["__name__"])},zr.S=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Tr(Ir.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Tr(Ir.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Tr(Ir.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new zr(e)},zr.g=function(){return new zr([])},zr),qr=(Br.D=function(t){return new Br(Fr.P(t))},Br.C=function(t){return new Br(Fr.P(t).u(5))},Br.prototype.N=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Br.prototype.isEqual=function(t){return null!==t&&0===Fr.i(this.path,t.path)},Br.prototype.toString=function(){return this.path.toString()},Br.i=function(t,e){return Fr.i(t.path,e.path)},Br.F=function(t){return t.length%2==0},Br.$=function(t){return new Br(new Fr(t.slice()))},Br);function Br(t){this.path=t}function zr(){return null!==Vr&&Vr.apply(this,arguments)||this}function Kr(){return null!==Mr&&Mr.apply(this,arguments)||this}function Qr(t,e,n){void 0===e?e=0:e>t.length&&Lr(),void 0===n?n=t.length-e:n>t.length-e&&Lr(),this.segments=t,this.offset=e,this.t=n}function Hr(t,e){if(0!==e.length)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+li(e.length,"argument")+".")}function Wr(t,e,n){if(e.length!==n)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires "+li(n,"argument")+", but was called with "+li(e.length,"argument")+".")}function Xr(t,e,n){if(e.length<n)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires at least "+li(n,"argument")+", but was called with "+li(e.length,"argument")+".")}function Yr(t,e,n,r){if(e.length<n||e.length>r)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+li(e.length,"argument")+".")}function Jr(t,e,n,r){ri(t,e,hi(n)+" argument",r)}function Zr(t,e,n,r){void 0!==r&&Jr(t,e,n,r)}function $r(t,e,n,r){ri(t,e,n+" option",r)}function ti(t,e,n,r){void 0!==r&&$r(t,e,n,r)}function ei(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(oi(s))}var u=oi(n);throw new Tr(Ir.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function ni(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid value "+oi(r)+" provided to function "+t+"() for its "+hi(n)+" argument. Acceptable values: "+e.join(", "));return r}function ri(t,e,n,r){if(!("object"===e?ii(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e))throw r=oi(r),new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}function ii(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function oi(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Lr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function si(t,e,n){if(void 0===n)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+hi(e)+" argument, but it was undefined.")}function ui(n,t,r){Ur(t,function(t,e){if(r.indexOf(t)<0)throw new Tr(Ir.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function ai(t,e,n,r){return r=oi(r),new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires its "+hi(n)+" argument to be a "+e+", but it was: "+r)}function ci(t,e,n){if(n<=0)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires its "+hi(e)+" argument to be a positive number, but it was: "+n+".")}function hi(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function li(t,e){return t+" "+e+(1===t?"":"s")}var fi=(pi.k=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},pi);function pi(){}function di(t,e){return t<e?-1:e<t?1:0}function yi(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function vi(t){return t+"\0"}var gi=(mi.fromBase64String=function(t){return new mi(atob(t))},mi.fromUint8Array=function(t){return new mi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},mi.prototype.toBase64=function(){return t=this.M,btoa(t);var t},mi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.M)},mi.prototype.O=function(){return 2*this.M.length},mi.prototype.L=function(t){return di(this.M,t.M)},mi.prototype.isEqual=function(t){return this.M===t.M},mi);function mi(t){this.M=t}gi.B=new gi("");var wi=(bi.fromBase64String=function(t){try{return new bi(gi.fromBase64String(t))}catch(t){throw new Tr(Ir.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},bi.fromUint8Array=function(t){return new bi(gi.fromUint8Array(t))},bi.prototype.toBase64=function(){return this.q.toBase64()},bi.prototype.toUint8Array=function(){return this.q.toUint8Array()},bi.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},bi.prototype.isEqual=function(t){return this.q.isEqual(t.q)},bi);function bi(t){this.q=t}function Ei(){if("undefined"==typeof Uint8Array)throw new Tr(Ir.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Ii(){if("undefined"==typeof atob)throw new Tr(Ir.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function Ti(t,e,n,r,i){this.U=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var _i,Ai=(n(Pi,_i=wi),Pi.fromBase64String=function(t){Wr("Blob.fromBase64String",arguments,1),Jr("Blob.fromBase64String","string",1,t),Ii();try{return new Pi(gi.fromBase64String(t))}catch(t){throw new Tr(Ir.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},Pi.fromUint8Array=function(t){if(Wr("Blob.fromUint8Array",arguments,1),Ei(),!(t instanceof Uint8Array))throw ai("Blob.fromUint8Array","Uint8Array",1,t);return new Pi(gi.fromUint8Array(t))},Pi.prototype.toBase64=function(){return Wr("Blob.toBase64",arguments,0),Ii(),_i.prototype.toBase64.call(this)},Pi.prototype.toUint8Array=function(){return Wr("Blob.toUint8Array",arguments,0),Ei(),_i.prototype.toUint8Array.call(this)},Pi.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},Pi),Ni=(Object.defineProperty(ki.prototype,"W",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),ki.prototype.isEqual=function(t){return t instanceof ki&&t.projectId===this.projectId&&t.database===this.database},ki.prototype.L=function(t){return di(this.projectId,t.projectId)||di(this.database,t.database)},ki),Si=(Li.prototype.get=function(t){var e=this.j(t);if(void 0!==(e=this.G[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.K(i,t))return o}},Li.prototype.has=function(t){return void 0!==this.get(t)},Li.prototype.set=function(t,e){var n=this.j(t),r=this.G[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.K(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.G[n]=[[t,e]]},Li.prototype.delete=function(t){var e=this.j(t),n=this.G[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.K(n[r][0],t))return 1===n.length?delete this.G[e]:n.splice(r,1),!0;return!1},Li.prototype.forEach=function(s){Ur(this.G,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},Li.prototype.m=function(){return Cr(this.G)},Li),Di=(xi.now=function(){return xi.fromMillis(Date.now())},xi.fromDate=function(t){return xi.fromMillis(t.getTime())},xi.fromMillis=function(t){var e=Math.floor(t/1e3);return new xi(e,1e6*(t-1e3*e))},xi.prototype.toDate=function(){return new Date(this.toMillis())},xi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},xi.prototype.H=function(t){return this.seconds===t.seconds?di(this.nanoseconds,t.nanoseconds):di(this.seconds,t.seconds)},xi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},xi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},xi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},xi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},xi),Ri=(Oi.J=function(t){return new Oi(t)},Oi.min=function(){return new Oi(new Di(0,0))},Oi.prototype.L=function(t){return this.timestamp.H(t.timestamp)},Oi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Oi.prototype.Y=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Oi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Oi.prototype.X=function(){return this.timestamp},Oi);function Oi(t){this.timestamp=t}function xi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Li(t,e){this.j=t,this.K=e,this.G={}}function ki(t,e){this.projectId=t,this.database=e||"(default)"}function Pi(){return null!==_i&&_i.apply(this,arguments)||this}function Ui(t){return null==t}function Ci(t){return 0===t&&1/t==-1/0}function Vi(t){return"number"==typeof t&&Number.isInteger(t)&&!Ci(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Mi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Z=null};function Fi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Mi(t,e,n,r,i,o,s)}function ji(t){var e=t;return null===e.Z&&(t=e.path.R(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.R()+t.op.toString()+jo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.R()+t.dir}).join(","),Ui(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=ma(e.startAt)),e.endAt&&(t+="|ub:",t+=ma(e.endAt)),e.Z=t),e.Z}function Gi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Co(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ba(t.startAt,e.startAt)&&ba(t.endAt,e.endAt)}function qi(t){return qr.F(t.path)&&null===t.collectionGroup&&0===t.filters.length}function Bi(t){this.count=t}var zi,Ki=(Qi.prototype.nt=function(t){return new Qi(this.target,this.targetId,this.tt,t,this.et,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Qi.prototype.st=function(t,e){return new Qi(this.target,this.targetId,this.tt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Qi.prototype.it=function(t){return new Qi(this.target,this.targetId,this.tt,this.sequenceNumber,this.et,t,this.resumeToken)},Qi);function Qi(t,e,n,r,i,o,s){void 0===i&&(i=Ri.min()),void 0===o&&(o=Ri.min()),void 0===s&&(s=gi.B),this.target=t,this.targetId=e,this.tt=n,this.sequenceNumber=r,this.et=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Hi(t){switch(t){case Ir.OK:return Lr(),0;case Ir.CANCELLED:case Ir.UNKNOWN:case Ir.DEADLINE_EXCEEDED:case Ir.RESOURCE_EXHAUSTED:case Ir.INTERNAL:case Ir.UNAVAILABLE:case Ir.UNAUTHENTICATED:return;case Ir.INVALID_ARGUMENT:case Ir.NOT_FOUND:case Ir.ALREADY_EXISTS:case Ir.PERMISSION_DENIED:case Ir.FAILED_PRECONDITION:case Ir.ABORTED:case Ir.OUT_OF_RANGE:case Ir.UNIMPLEMENTED:case Ir.DATA_LOSS:return 1;default:return Lr(),0}}function Wi(t){if(void 0===t)return Rr("GRPC error has no .code"),Ir.UNKNOWN;switch(t){case zi.OK:return Ir.OK;case zi.CANCELLED:return Ir.CANCELLED;case zi.UNKNOWN:return Ir.UNKNOWN;case zi.DEADLINE_EXCEEDED:return Ir.DEADLINE_EXCEEDED;case zi.RESOURCE_EXHAUSTED:return Ir.RESOURCE_EXHAUSTED;case zi.INTERNAL:return Ir.INTERNAL;case zi.UNAVAILABLE:return Ir.UNAVAILABLE;case zi.UNAUTHENTICATED:return Ir.UNAUTHENTICATED;case zi.INVALID_ARGUMENT:return Ir.INVALID_ARGUMENT;case zi.NOT_FOUND:return Ir.NOT_FOUND;case zi.ALREADY_EXISTS:return Ir.ALREADY_EXISTS;case zi.PERMISSION_DENIED:return Ir.PERMISSION_DENIED;case zi.FAILED_PRECONDITION:return Ir.FAILED_PRECONDITION;case zi.ABORTED:return Ir.ABORTED;case zi.OUT_OF_RANGE:return Ir.OUT_OF_RANGE;case zi.UNIMPLEMENTED:return Ir.UNIMPLEMENTED;case zi.DATA_LOSS:return Ir.DATA_LOSS;default:return Lr()}}(be=zi=zi||{})[be.OK=0]="OK",be[be.CANCELLED=1]="CANCELLED",be[be.UNKNOWN=2]="UNKNOWN",be[be.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",be[be.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",be[be.NOT_FOUND=5]="NOT_FOUND",be[be.ALREADY_EXISTS=6]="ALREADY_EXISTS",be[be.PERMISSION_DENIED=7]="PERMISSION_DENIED",be[be.UNAUTHENTICATED=16]="UNAUTHENTICATED",be[be.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",be[be.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",be[be.ABORTED=10]="ABORTED",be[be.OUT_OF_RANGE=11]="OUT_OF_RANGE",be[be.UNIMPLEMENTED=12]="UNIMPLEMENTED",be[be.INTERNAL=13]="INTERNAL",be[be.UNAVAILABLE=14]="UNAVAILABLE",be[be.DATA_LOSS=15]="DATA_LOSS";var Xi=(to.prototype.rt=function(t,e){return new to(this.i,this.root.rt(t,e,this.i).copy(null,null,Ji.ot,null,null))},to.prototype.remove=function(t){return new to(this.i,this.root.remove(t,this.i).copy(null,null,Ji.ot,null,null))},to.prototype.get=function(t){for(var e=this.root;!e.m();){var n=this.i(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},to.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.m();){var r=this.i(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},to.prototype.m=function(){return this.root.m()},Object.defineProperty(to.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),to.prototype.at=function(){return this.root.at()},to.prototype.ut=function(){return this.root.ut()},to.prototype.ct=function(t){return this.root.ct(t)},to.prototype.forEach=function(n){this.ct(function(t,e){return n(t,e),!1})},to.prototype.toString=function(){var n=[];return this.ct(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},to.prototype.ht=function(t){return this.root.ht(t)},to.prototype.lt=function(){return new Yi(this.root,null,this.i,!1)},to.prototype._t=function(t){return new Yi(this.root,t,this.i,!1)},to.prototype.ft=function(){return new Yi(this.root,null,this.i,!0)},to.prototype.dt=function(t){return new Yi(this.root,t,this.i,!0)},to),Yi=($i.prototype.Et=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.m();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.m();)this.Tt.push(t),t=t.left;return e},$i.prototype.It=function(){return 0<this.Tt.length},$i.prototype.At=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},$i),Ji=(Zi.prototype.copy=function(t,e,n,r,i){return new Zi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Zi.prototype.m=function(){return!1},Zi.prototype.ct=function(t){return this.left.ct(t)||t(this.key,this.value)||this.right.ct(t)},Zi.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},Zi.prototype.min=function(){return this.left.m()?this:this.left.min()},Zi.prototype.at=function(){return this.min().key},Zi.prototype.ut=function(){return this.right.m()?this.key:this.right.ut()},Zi.prototype.rt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.rt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.rt(t,e,n))).Rt()},Zi.prototype.Pt=function(){if(this.left.m())return Zi.EMPTY;var t=this;return t.left.yt()||t.left.left.yt()||(t=t.gt()),(t=t.copy(null,null,null,t.left.Pt(),null)).Rt()},Zi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.m()||r.left.yt()||r.left.left.yt()||(r=r.gt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.yt()&&(r=r.Vt()),r.right.m()||r.right.yt()||r.right.left.yt()||(r=r.bt()),0===e(t,r.key)){if(r.right.m())return Zi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.Pt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Rt()},Zi.prototype.yt=function(){return this.color},Zi.prototype.Rt=function(){var t=this;return t.right.yt()&&!t.left.yt()&&(t=t.vt()),t.left.yt()&&t.left.left.yt()&&(t=t.Vt()),t.left.yt()&&t.right.yt()&&(t=t.St()),t},Zi.prototype.gt=function(){var t=this.St();return t.right.left.yt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Vt())).vt()).St()),t},Zi.prototype.bt=function(){var t=this.St();return t.left.left.yt()&&(t=(t=t.Vt()).St()),t},Zi.prototype.vt=function(){var t=this.copy(null,null,Zi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Zi.prototype.Vt=function(){var t=this.copy(null,null,Zi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Zi.prototype.St=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Zi.prototype.Dt=function(){var t=this.Ct();return Math.pow(2,t)<=this.size+1},Zi.prototype.Ct=function(){if(this.yt()&&this.left.yt())throw Lr();if(this.right.yt())throw Lr();var t=this.left.Ct();if(t!==this.right.Ct())throw Lr();return t+(this.yt()?0:1)},Zi);function Zi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Zi.RED,this.left=null!=r?r:Zi.EMPTY,this.right=null!=i?i:Zi.EMPTY,this.size=this.left.size+1+this.right.size}function $i(t,e,n,r){this.wt=r,this.Tt=[];for(var i=1;!t.m();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.wt?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.wt?t.right:t.left}}function to(t,e){this.i=t,this.root=e||Ji.EMPTY}function eo(){this.size=0}Ji.EMPTY=null,Ji.RED=!0,Ji.ot=!1,Ji.EMPTY=(Object.defineProperty(eo.prototype,"key",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"value",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"color",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"left",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),Object.defineProperty(eo.prototype,"right",{get:function(){throw Lr()},enumerable:!1,configurable:!0}),eo.prototype.copy=function(t,e,n,r,i){return this},eo.prototype.rt=function(t,e,n){return new Ji(t,e)},eo.prototype.remove=function(t,e){return this},eo.prototype.m=function(){return!0},eo.prototype.ct=function(t){return!1},eo.prototype.ht=function(t){return!1},eo.prototype.at=function(){return null},eo.prototype.ut=function(){return null},eo.prototype.yt=function(){return!1},eo.prototype.Dt=function(){return!0},eo.prototype.Ct=function(){return 0},new eo);var no=(so.prototype.has=function(t){return null!==this.data.get(t)},so.prototype.first=function(){return this.data.at()},so.prototype.last=function(){return this.data.ut()},Object.defineProperty(so.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),so.prototype.indexOf=function(t){return this.data.indexOf(t)},so.prototype.forEach=function(n){this.data.ct(function(t,e){return n(t),!1})},so.prototype.Nt=function(t,e){for(var n=this.data._t(t[0]);n.It();){var r=n.Et();if(0<=this.i(r.key,t[1]))return;e(r.key)}},so.prototype.Ft=function(t,e){for(var n=void 0!==e?this.data._t(e):this.data.lt();n.It();)if(!t(n.Et().key))return},so.prototype.$t=function(t){return(t=this.data._t(t)).It()?t.Et().key:null},so.prototype.lt=function(){return new ro(this.data.lt())},so.prototype._t=function(t){return new ro(this.data._t(t))},so.prototype.add=function(t){return this.copy(this.data.remove(t).rt(t,!0))},so.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},so.prototype.m=function(){return this.data.m()},so.prototype.xt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},so.prototype.isEqual=function(t){if(!(t instanceof so))return!1;if(this.size!==t.size)return!1;for(var e=this.data.lt(),n=t.data.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(0!==this.i(r,i))return!1}return!0},so.prototype.A=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},so.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},so.prototype.copy=function(t){var e=new so(this.i);return e.data=t,e},so),ro=(oo.prototype.Et=function(){return this.kt.Et().key},oo.prototype.It=function(){return this.kt.It()},oo),io=new Xi(qr.i);function oo(t){this.kt=t}function so(t){this.i=t,this.data=new Xi(this.i)}var uo=new Xi(qr.i),ao=new Xi(qr.i),co=new no(qr.i);function ho(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=co,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var lo=new no(di),fo=(Ro.Lt=function(t){return new Ro(t.i)},Ro.prototype.has=function(t){return null!=this.Mt.get(t)},Ro.prototype.get=function(t){return this.Mt.get(t)},Ro.prototype.first=function(){return this.Ot.at()},Ro.prototype.last=function(){return this.Ot.ut()},Ro.prototype.m=function(){return this.Ot.m()},Ro.prototype.indexOf=function(t){return(t=this.Mt.get(t))?this.Ot.indexOf(t):-1},Object.defineProperty(Ro.prototype,"size",{get:function(){return this.Ot.size},enumerable:!1,configurable:!0}),Ro.prototype.forEach=function(n){this.Ot.ct(function(t,e){return n(t),!1})},Ro.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Mt.rt(t.key,t),e.Ot.rt(t,null))},Ro.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Mt.remove(t),this.Ot.remove(e)):this},Ro.prototype.isEqual=function(t){if(!(t instanceof Ro))return!1;if(this.size!==t.size)return!1;for(var e=this.Ot.lt(),n=t.Ot.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(!r.isEqual(i))return!1}return!0},Ro.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Ro.prototype.copy=function(t,e){var n=new Ro;return n.i=this.i,n.Mt=t,n.Ot=e,n},Ro),po=(Do.prototype.track=function(t){var e=t.doc.key,n=this.Bt.get(e);!n||0!==t.type&&3===n.type?this.Bt=this.Bt.rt(e,t):3===t.type&&1!==n.type?this.Bt=this.Bt.rt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Bt=this.Bt.rt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Bt=this.Bt.remove(e):1===t.type&&2===n.type?this.Bt=this.Bt.rt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Bt=this.Bt.rt(e,{type:2,doc:t.doc}):Lr()},Do.prototype.qt=function(){var n=[];return this.Bt.ct(function(t,e){n.push(e)}),n},Do),yo=(So.Kt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new So(t,e,fo.Lt(e),i,n,r,!0,!1)},Object.defineProperty(So.prototype,"hasPendingWrites",{get:function(){return!this.Qt.m()},enumerable:!1,configurable:!0}),So.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Wt===t.Wt&&this.Qt.isEqual(t.Qt)&&Gu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Ut.isEqual(t.Ut)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},So),vo=(No.Yt=function(t,e){var n=new Map;return n.set(t,go.Xt(t,e)),new No(Ri.min(),n,lo,io,ho())},No),go=(Ao.Xt=function(t,e){return new Ao(gi.B,e,ho(),ho(),ho())},Ao),mo=function(t,e,n,r){this.se=t,this.removedTargetIds=e,this.key=n,this.ie=r},wo=function(t,e){this.targetId=t,this.re=e},bo=function(t,e,n,r){void 0===n&&(n=gi.B),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},Eo=(Object.defineProperty(_o.prototype,"Zt",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(_o.prototype,"resumeToken",{get:function(){return this.ue},enumerable:!1,configurable:!0}),Object.defineProperty(_o.prototype,"le",{get:function(){return 0!==this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(_o.prototype,"_e",{get:function(){return this.he},enumerable:!1,configurable:!0}),_o.prototype.fe=function(t){0<t.O()&&(this.he=!0,this.ue=t)},_o.prototype.de=function(){var n=ho(),r=ho(),i=ho();return this.ae.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Lr()}}),new go(this.ue,this.ce,n,r,i)},_o.prototype.we=function(){this.he=!1,this.ae=xo()},_o.prototype.me=function(t,e){this.he=!0,this.ae=this.ae.rt(t,e)},_o.prototype.Te=function(t){this.he=!0,this.ae=this.ae.remove(t)},_o.prototype.Ee=function(){this.oe+=1},_o.prototype.Ie=function(){--this.oe},_o.prototype.Ae=function(){this.he=!0,this.ce=!0},_o),Io=(To.prototype.pe=function(t){for(var e=0,n=t.se;e<n.length;e++){var r=n[e];t.ie instanceof Iu?this.be(r,t.ie):t.ie instanceof Tu&&this.ve(r,t.key,t.ie)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.ve(s,t.key,t.ie)}},To.prototype.Se=function(n){var r=this;this.De(n,function(t){var e=r.Ce(t);switch(n.state){case 0:r.Ne(t)&&e.fe(n.resumeToken);break;case 1:e.Ie(),e.le||e.we(),e.fe(n.resumeToken);break;case 2:e.Ie(),e.le||r.removeTarget(t);break;case 3:r.Ne(t)&&(e.Ae(),e.fe(n.resumeToken));break;case 4:r.Ne(t)&&(r.Fe(t),e.fe(n.resumeToken));break;default:Lr()}})},To.prototype.De=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Pe.forEach(function(t,e){r.Ne(e)&&n(e)})},To.prototype.$e=function(t){var e=t.targetId,n=t.re.count;(t=this.xe(e))&&(qi(t=t.target)?0===n?(t=new qr(t.path),this.ve(e,t,new Tu(t,Ri.min()))):kr(1===n):this.ke(e)!==n&&(this.Fe(e),this.Ve=this.Ve.add(e)))},To.prototype.Me=function(r){var i=this,o=new Map;this.Pe.forEach(function(t,e){var n=i.xe(e);n&&(t.Zt&&qi(n.target)&&(n=new qr(n.target.path),null!==i.ye.get(n)||i.Oe(e,n)||i.ve(e,n,new Tu(n,r))),t._e&&(o.set(e,t.de()),t.we()))});var s=ho();this.ge.forEach(function(t,e){var n=!0;e.Ft(function(t){return!(t=i.xe(t))||2===t.tt||(n=!1)}),n&&(s=s.add(t))});var t=new vo(r,o,this.Ve,this.ye,s);return this.ye=io,this.ge=Oo(),this.Ve=new no(di),t},To.prototype.be=function(t,e){var n;this.Ne(t)&&(n=this.Oe(t,e.key)?2:0,this.Ce(t).me(e.key,n),this.ye=this.ye.rt(e.key,e),this.ge=this.ge.rt(e.key,this.Le(e.key).add(t)))},To.prototype.ve=function(t,e,n){var r;this.Ne(t)&&(r=this.Ce(t),this.Oe(t,e)?r.me(e,1):r.Te(e),this.ge=this.ge.rt(e,this.Le(e).delete(t)),n&&(this.ye=this.ye.rt(e,n)))},To.prototype.removeTarget=function(t){this.Pe.delete(t)},To.prototype.ke=function(t){var e=this.Ce(t).de();return this.Re.Be(t).size+e.te.size-e.ne.size},To.prototype.Ee=function(t){this.Ce(t).Ee()},To.prototype.Ce=function(t){var e=this.Pe.get(t);return e||(e=new Eo,this.Pe.set(t,e)),e},To.prototype.Le=function(t){var e=this.ge.get(t);return e||(e=new no(di),this.ge=this.ge.rt(t,e)),e},To.prototype.Ne=function(t){var e=null!==this.xe(t);return e||Dr("WatchChangeAggregator","Detected inactive target",t),e},To.prototype.xe=function(t){var e=this.Pe.get(t);return e&&e.le?null:this.Re.qe(t)},To.prototype.Fe=function(e){var n=this;this.Pe.set(e,new Eo),this.Re.Be(e).forEach(function(t){n.ve(e,t,null)})},To.prototype.Oe=function(t,e){return this.Re.Be(t).has(e)},To);function To(t){this.Re=t,this.Pe=new Map,this.ye=io,this.ge=Oo(),this.Ve=new no(di)}function _o(){this.oe=0,this.ae=xo(),this.ue=gi.B,this.ce=!1,this.he=!0}function Ao(t,e,n,r,i){this.resumeToken=t,this.Zt=e,this.te=n,this.ee=r,this.ne=i}function No(t,e,n,r,i){this.et=t,this.Gt=e,this.zt=n,this.Ht=r,this.Jt=i}function So(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Ut=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.Wt=s,this.jt=u}function Do(){this.Bt=new Xi(qr.i)}function Ro(n){this.i=n?function(t,e){return n(t,e)||qr.i(t.key,e.key)}:function(t,e){return qr.i(t.key,e.key)},this.Mt=uo,this.Ot=new Xi(this.i)}function Oo(){return new Xi(qr.i)}function xo(){return new Xi(qr.i)}function Lo(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function ko(t){return t=Go(t.mapValue.fields.__local_write_time__.timestampValue),new Di(t.seconds,t.nanos)}var Po=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Uo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Lo(t)?4:10:Lr()}function Co(r,i){var t,e,n,o=Uo(r);if(o!==Uo(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return ko(r).isEqual(ko(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Go(r.timestampValue),t=Go(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Bo(r.bytesValue).isEqual(Bo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return o=i,qo((t=r).geoPointValue.latitude)===qo(o.geoPointValue.latitude)&&qo(t.geoPointValue.longitude)===qo(o.geoPointValue.longitude);case 2:return n=i,"integerValue"in(e=r)&&"integerValue"in n?qo(e.integerValue)===qo(n.integerValue):"doubleValue"in e&&"doubleValue"in n&&((e=qo(e.doubleValue))===(n=qo(n.doubleValue))?Ci(e)===Ci(n):isNaN(e)&&isNaN(n));case 9:return yi(r.arrayValue.values||[],i.arrayValue.values||[],Co);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Pr(e)!==Pr(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Co(e[t],n[t])))return!1;return!0}();default:return Lr()}}function Vo(t,e){return void 0!==(t.values||[]).find(function(t){return Co(t,e)})}function Mo(t,e){var n,r,i,o,s=Uo(t),u=Uo(e);if(s!==u)return di(s,u);switch(s){case 0:return 0;case 1:return di(t.booleanValue,e.booleanValue);case 2:return n=e,(r=qo(t.integerValue||t.doubleValue))<(n=qo(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return Fo(t.timestampValue,e.timestampValue);case 4:return Fo(ko(t),ko(e));case 5:return di(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,o=e.bytesValue,i=Bo(i),o=Bo(o),i.L(o);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=di(n[i],r[i]);if(0!==o)return o}return di(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return s=t.geoPointValue,r=e.geoPointValue,0!==(n=di(qo(s.latitude),qo(r.latitude)))?n:di(qo(s.longitude),qo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Mo(n[i],r[i]);if(o)return o}return di(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=di(r[s],o[s]);if(0!==u)return u;if(0!==(u=Mo(n[r[s]],i[o[s]])))return u}return di(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Lr()}}function Fo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return di(t,e);var n=Go(t),t=Go(e);return 0!==(e=di(n.seconds,t.seconds))?e:di(n.nanos,t.nanos)}function jo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=Go(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?Bo(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,qr.C(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Lr();var t,e}(t)}function Go(t){if(kr(!!t),"string"!=typeof t)return{seconds:qo(t.seconds),nanos:qo(t.nanos)};var e=0,n=Po.exec(t);return kr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function qo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Bo(t){return"string"==typeof t?gi.fromBase64String(t):gi.fromUint8Array(t)}function zo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.R()}}function Ko(t){return t&&"integerValue"in t}function Qo(t){return!!t&&"arrayValue"in t}function Ho(t){return t&&"nullValue"in t}function Wo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Xo(t){return t&&"mapValue"in t}var Yo={asc:"ASCENDING",desc:"DESCENDING"},Jo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Zo=function(t,e){this.U=t,this.Ue=e};function $o(t){return{integerValue:""+t}}function ts(t,e){if(t.Ue){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ci(e)?"-0":e}}function es(t,e){return Vi(e)?$o(e):ts(t,e)}function ns(t,e){return t.Ue?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function rs(t,e){return t.Ue?e.toBase64():e.toUint8Array()}function is(t){return kr(!!t),Ri.J((t=Go(t),new Di(t.seconds,t.nanos)))}function os(t,e){return new Fr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).R()}function ss(t){return kr(_s(t=Fr.P(t))),t}function us(t,e){return os(t.U,e.path)}function as(t,e){return kr((e=ss(e)).get(1)===t.U.projectId),kr(!e.get(3)&&!t.U.database||e.get(3)===t.U.database),new qr(fs(e))}function cs(t,e){return os(t.U,e)}function hs(t){return 4===(t=ss(t)).length?Fr.g():fs(t)}function ls(t){return new Fr(["projects",t.U.projectId,"databases",t.U.database]).R()}function fs(t){return kr(4<t.length&&"documents"===t.get(4)),t.u(5)}function ps(t,e,n){return{name:us(t,e),fields:n.proto.mapValue.fields}}function ds(t,e,n){var r=as(t,e.name),t=is(e.updateTime),e=new pu({mapValue:{fields:e.fields}});return new Iu(r,t,e,{hasCommittedMutations:!!n})}function ys(t,e){var n,r,i;if(e instanceof tu)n={update:ps(t,e.key,e.value)};else if(e instanceof lu)n={delete:us(t,e.key)};else if(e instanceof eu)n={update:ps(t,e.key,e.data),updateMask:(i=e.Qe,r=[],i.fields.forEach(function(t){return r.push(t.R())}),{fieldPaths:r})};else if(e instanceof su)n={transform:{document:us(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Ds)return{fieldPath:t.field.R(),setToServerValue:"REQUEST_TIME"};if(e instanceof Rs)return{fieldPath:t.field.R(),appendMissingElements:{values:e.elements}};if(e instanceof Ps)return{fieldPath:t.field.R(),removeAllFromArray:{values:e.elements}};if(e instanceof Ms)return{fieldPath:t.field.R(),increment:e.We};throw Lr()})}};else{if(!(e instanceof fu))return Lr();n={verify:us(t,e.key)}}return e.Ke.je||(n.currentDocument=void 0!==(i=e.Ke).updateTime?{updateTime:ns(e=t,(t=i.updateTime).X())}:void 0!==i.exists?{exists:i.exists}:Lr()),n}function vs(o,t){var e=t.currentDocument?void 0!==(i=t.currentDocument).updateTime?Qs.updateTime(is(i.updateTime)):void 0!==i.exists?Qs.exists(i.exists):Qs.Ge():Qs.Ge();if(t.update){t.update.name;var n=as(o,t.update.name),r=new pu({mapValue:{fields:t.update.fields}});if(t.updateMask){var i=(i=t.updateMask.fieldPaths||[],new qs(i.map(function(t){return Gr.S(t)})));return new eu(n,r,i,e)}return new tu(n,r,e)}if(t.delete){var s=as(o,t.delete);return new lu(s,e)}return t.transform?(r=as(o,t.transform.document),s=t.transform.fieldTransforms.map(function(t){return e=o,i=null,"setToServerValue"in(n=t)?(kr("REQUEST_TIME"===n.setToServerValue),i=new Ds):"appendMissingElements"in n?(r=n.appendMissingElements.values||[],i=new Rs(r)):"removeAllFromArray"in n?(r=n.removeAllFromArray.values||[],i=new Ps(r)):"increment"in n?i=new Ms(e,n.increment):Lr(),n=Gr.S(n.fieldPath),new Bs(n,i);var e,n,r,i}),kr(!0===e.exists),new su(r,s)):t.verify?(t=as(o,t.verify),new fu(t,e)):Lr()}function gs(t,e){return{documents:[cs(t,e.path)]}}function ms(t,e){var n={structuredQuery:{}},r=e.path;return null!==e.collectionGroup?(n.parent=cs(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=cs(t,r.h()),n.structuredQuery.from=[{collectionId:r._()}]),(r=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(Wo(t.value))return{unaryFilter:{field:Is(t.field),op:"IS_NAN"}};if(Ho(t.value))return{unaryFilter:{field:Is(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Wo(t.value))return{unaryFilter:{field:Is(t.field),op:"IS_NOT_NAN"}};if(Ho(t.value))return{unaryFilter:{field:Is(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Is(t.field),op:(e=t.op,Jo[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(e.filters))&&(n.structuredQuery.where=r),(r=function(t){if(0!==t.length)return t.map(function(t){return{field:Is((t=t).field),direction:(t=t.dir,Yo[t])}})}(e.orderBy))&&(n.structuredQuery.orderBy=r),r=e.limit,null!==(r=t.Ue||Ui(r)?r:{value:r})&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=bs(e.startAt)),e.endAt&&(n.structuredQuery.endAt=bs(e.endAt)),n}function ws(t){var e=hs(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(kr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Ts(t.unaryFilter.field);return Hu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Ts(t.unaryFilter.field);return Hu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":return n=Ts(t.unaryFilter.field),Hu.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return t=Ts(t.unaryFilter.field),Hu.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Lr()}}(e)]:void 0!==e.fieldFilter?[(n=e,Hu.create(Ts(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Lr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Lr():[];var n}(n.where)),t=[],n.orderBy&&(t=n.orderBy.map(function(t){return new Ea(Ts((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e})),r=null,n.limit&&(r=Ui(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=Es(n.startAt));var u=null;return n.endAt&&(u=Es(n.endAt)),Ru(e,i,t,o,r,"F",s,u)}function bs(t){return{before:t.before,values:t.position}}function Es(t){var e=!!t.before,t=t.values||[];return new pa(t,e)}function Is(t){return{fieldPath:t.R()}}function Ts(t){return Gr.S(t.fieldPath)}function _s(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function As(t,e){return t instanceof Ms?Ko(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var Ns,Ss,Ds=(n(xs,Ss=h=function(){this.ze=void 0}),xs),Rs=(n(Os,Ns=h),Os);function Os(t){var e=this;return(e=Ns.call(this)||this).elements=t,e}function xs(){return null!==Ss&&Ss.apply(this,arguments)||this}function Ls(t,e){for(var n=Gs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Co(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var ks,Ps=(n(Us,ks=h),Us);function Us(t){var e=this;return(e=ks.call(this)||this).elements=t,e}function Cs(t,e){for(var n=Gs(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Co(t,e)})}(i[r]);return{arrayValue:{values:n}}}var Vs,Ms=(n(Fs,Vs=h),Fs);function Fs(t,e){var n=this;return(n=Vs.call(this)||this).serializer=t,n.We=e,n}function js(t){return qo(t.integerValue||t.doubleValue)}function Gs(t){return Qo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var qs=(zs.prototype.He=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].T(t))return!0;return!1},zs.prototype.isEqual=function(t){return yi(this.fields,t.fields,function(t,e){return t.isEqual(e)})},zs),Bs=function(t,e){this.field=t,this.transform=e};function zs(t){(this.fields=t).sort(Gr.i)}function Ks(t,e){this.version=t,this.transformResults=e}var Qs=(Hs.Ge=function(){return new Hs},Hs.exists=function(t){return new Hs(void 0,t)},Hs.updateTime=function(t){return new Hs(t)},Object.defineProperty(Hs.prototype,"je",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Hs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Hs);function Hs(t,e){this.updateTime=t,this.exists=e}function Ws(t,e){return void 0!==t.updateTime?e instanceof Iu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Iu}function Xs(t,e,n,r){return t instanceof tu?(o=e,Ws((i=t).Ke,o)?(o=Js(o),new Iu(i.key,o,i.value,{Je:!0})):o):t instanceof eu?function(t,e){if(!Ws(t.Ke,e))return e;var n=Js(e),e=iu(t,e);return new Iu(t.key,n,e,{Je:!0})}(t,e):t instanceof su?function(t,e,n,r){if(!Ws(t.Ke,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],c=a.transform,h=null;n instanceof Iu&&(h=n.field(a.field)),null===h&&r instanceof Iu&&(h=r.field(a.field)),o.push((i=h,a=e,h=void 0,(c=c)instanceof Ds?(h={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(h.fields.__previous_value__=i),{mapValue:h}):c instanceof Rs?Ls(c,i):c instanceof Ps?Cs(c,i):(i=js(c=As(h=c,i))+js(h.We),Ko(c)&&Ko(h.We)?$o(i):ts(h.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=au(t,i.data(),r);return new Iu(t.key,i.version,r,{Je:!0})}(t,e,r,n):(e=e,Ws((t=t).Ke,e)?new Tu(t.key,Ri.min()):e);var i,o}function Ys(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ke.isEqual(e.Ke)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||yi(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof Rs&&e instanceof Rs||t instanceof Ps&&e instanceof Ps?yi(t.elements,e.elements,Co):t instanceof Ms&&e instanceof Ms?Co(t.We,e.We):t instanceof Ds&&e instanceof Ds)}))}function Js(t){return t instanceof Iu?t.version:Ri.min()}var Zs,$s,tu=(n(ru,$s=Ee=function(){}),ru),eu=(n(nu,Zs=Ee),nu);function nu(t,e,n,r){var i=this;return(i=Zs.call(this)||this).key=t,i.data=e,i.Qe=n,i.Ke=r,i.type=1,i}function ru(t,e,n){var r=this;return(r=$s.call(this)||this).key=t,r.value=e,r.Ke=n,r.type=0,r}function iu(t,e){return n=t,e=e instanceof Iu?e.data():pu.empty(),r=new du(e),n.Qe.fields.forEach(function(t){var e;t.m()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Ye();var n,r}var ou,su=(n(uu,ou=Ee),uu);function uu(t,e){var n=this;return(n=ou.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ke=Qs.exists(!0),n}function au(t,e,n){for(var r=new du(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Ye()}var cu,hu,lu=(n(mu,hu=Ee),mu),fu=(n(gu,cu=Ee),gu),pu=(vu.empty=function(){return new vu({mapValue:{}})},vu.prototype.field=function(t){if(t.m())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Xo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t._()])||null},vu.prototype.isEqual=function(t){return Co(this.proto,t.proto)},vu),du=(yu.prototype.set=function(t,e){return this.tn(t,e),this},yu.prototype.delete=function(t){return this.tn(t,null),this},yu.prototype.tn=function(t,e){for(var n=this.Ze,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===Uo(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t._(),e)},yu.prototype.Ye=function(){var t=this.en(Gr.g(),this.Ze);return null!=t?new pu(t):this.Xe},yu.prototype.en=function(r,t){var i=this,o=!1,e=this.Xe.field(r),s=Xo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.en(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},yu);function yu(t){void 0===t&&(t=pu.empty()),this.Xe=t,this.Ze=new Map}function vu(t){this.proto=t}function gu(t,e){var n=this;return(n=cu.call(this)||this).key=t,n.Ke=e,n.type=4,n}function mu(t,e){var n=this;return(n=hu.call(this)||this).key=t,n.Ke=e,n.type=3,n}var wu,bu,Eu,Iu=(n(Du,Eu=be=function(t,e){this.key=t,this.version=e}),Du.prototype.field=function(t){return this.nn.field(t)},Du.prototype.data=function(){return this.nn},Du.prototype.sn=function(){return this.nn.proto},Du.prototype.isEqual=function(t){return t instanceof Du&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Je===t.Je&&this.hasCommittedMutations===t.hasCommittedMutations&&this.nn.isEqual(t.nn)},Du.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.nn.toString()+", {hasLocalMutations: "+this.Je+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Du.prototype,"hasPendingWrites",{get:function(){return this.Je||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Du),Tu=(n(Su,bu=be),Su.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Su.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Su.prototype.isEqual=function(t){return t instanceof Su&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Su),_u=(n(Nu,wu=be),Nu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Nu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Nu.prototype.isEqual=function(t){return t instanceof Nu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Nu),Au=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.rn=n,this.filters=r,this.limit=i,this.on=o,this.startAt=s,this.endAt=u,this.an=null,this.un=null,this.startAt,this.endAt};function Nu(){return null!==wu&&wu.apply(this,arguments)||this}function Su(t,e,n){var r=this;return(r=bu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Du(t,e,n,r){var i=this;return(i=Eu.call(this,t,e)||this).nn=n,i.Je=!!r.Je,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Ru(t,e,n,r,i,o,s,u){return new Au(t,e,n,r,i,o,s,u)}function Ou(t){return new Au(t)}function xu(t){return!Ui(t.limit)&&"F"===t.on}function Lu(t){return!Ui(t.limit)&&"L"===t.on}function ku(t){return 0<t.rn.length?t.rn[0].field:null}function Pu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.cn())return r.field}return null}function Uu(t){return null!==t.collectionGroup}function Cu(t){var e=t;if(null===e.an){e.an=[];var n=Pu(e),t=ku(e);if(null!==n&&null===t)n.p()||e.an.push(new Ea(n)),e.an.push(new Ea(Gr.v(),"asc"));else{for(var r=!1,i=0,o=e.rn;i<o.length;i++){var s=o[i];e.an.push(s),s.field.p()&&(r=!0)}r||(n=0<e.rn.length?e.rn[e.rn.length-1].dir:"asc",e.an.push(new Ea(Gr.v(),n)))}}return e.an}function Vu(t){var e=t;if(!e.un)if("F"===e.on)e.un=Fi(e.path,e.collectionGroup,Cu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Cu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Ea(o.field,s))}var u=e.endAt?new pa(e.endAt.position,!e.endAt.before):null,t=e.startAt?new pa(e.startAt.position,!e.startAt.before):null;e.un=Fi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.un}function Mu(t,e,n){return new Au(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Fu(t,e){return new Au(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,e,t.endAt)}function ju(t,e){return new Au(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,t.startAt,e)}function Gu(t,e){return Gi(Vu(t),Vu(e))&&t.on===e.on}function qu(t){return ji(Vu(t))+"|lt:"+t.on}function Bu(t){return"Query(target="+(n=(e=Vu(t)).path.R(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.R()+" "+t.op+" "+jo(t.value)}).join(", ")+"]"),Ui(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.R()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+ma(e.startAt)),e.endAt&&(n+=", endAt: "+ma(e.endAt)),"Target("+n+")")+"; limitType="+t.on+")";var e,n}function zu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.N(e.collectionGroup)&&e.path.T(n):qr.F(e.path)?e.path.isEqual(n):e.path.I(n))&&function(t){for(var e=0,n=i.rn;e<n.length;e++){var r=n[e];if(!r.field.p()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||wa(t.startAt,Cu(t),n))&&(!t.endAt||!wa(t.endAt,Cu(t),n)));var e,n}function Ku(u){return function(t,e){for(var n=!1,r=0,i=Cu(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i,o;switch(n=t.field.p()?qr.i(e.key,n.key):(r=t.field,i=n,o=e.field(r),r=i.field(r),null!==o&&null!==r?Mo(o,r):Lr()),t.dir){case"asc":return n;case"desc":return-1*n;default:return Lr()}}(o,t,e);if(0!==s)return s;n=n||o.field.p()}return 0}}var Qu,Hu=(n(Wu,Qu=function(){}),Wu.create=function(t,e,n){if(t.p())return"in"===e||"not-in"===e?this.hn(t,e,n):new Zu(t,e,n);if(Ho(n)){if("=="!==e&&"!="!==e)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. Null only supports '==' and '!=' comparisons.");return new Wu(t,e,n)}if(Wo(n)){if("=="!==e&&"!="!==e)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. NaN only supports '==' and '!=' comparisons.");return new Wu(t,e,n)}return"array-contains"===e?new ca(t,n):"in"===e?new ha(t,n):"not-in"===e?new la(t,n):"array-contains-any"===e?new fa(t,n):new Wu(t,e,n)},Wu.hn=function(t,e,n){return new("in"===e?$u:ta)(t,n)},Wu.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this.ln(Mo(t,this.value)):null!==t&&Uo(this.value)===Uo(t)&&this.ln(Mo(t,this.value))},Wu.prototype.ln=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Lr()}},Wu.prototype.cn=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Wu);function Wu(t,e,n){var r=this;return(r=Qu.call(this)||this).field=t,r.op=e,r.value=n,r}var Xu,Yu,Ju,Zu=(n(ra,Ju=Hu),ra.prototype.matches=function(t){return t=qr.i(t.key,this.key),this.ln(t)},ra),$u=(n(na,Yu=Hu),na.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},na),ta=(n(ea,Xu=Hu),ea.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},ea);function ea(t,e){var n=this;return(n=Xu.call(this,t,"not-in",e)||this).keys=ia(0,e),n}function na(t,e){var n=this;return(n=Yu.call(this,t,"in",e)||this).keys=ia(0,e),n}function ra(t,e,n){var r=this;return(r=Ju.call(this,t,e,n)||this).key=qr.C(n.referenceValue),r}function ia(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return qr.C(t.referenceValue)})}var oa,sa,ua,aa,ca=(n(ga,aa=Hu),ga.prototype.matches=function(t){return Qo(t=t.field(this.field))&&Vo(t.arrayValue,this.value)},ga),ha=(n(va,ua=Hu),va.prototype.matches=function(t){return null!==(t=t.field(this.field))&&Vo(this.value.arrayValue,t)},va),la=(n(ya,sa=Hu),ya.prototype.matches=function(t){return!Vo(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!Vo(this.value.arrayValue,t))},ya),fa=(n(da,oa=Hu),da.prototype.matches=function(t){var e=this;return!(!Qo(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return Vo(e.value.arrayValue,t)})},da),pa=function(t,e){this.position=t,this.before=e};function da(t,e){return oa.call(this,t,"array-contains-any",e)||this}function ya(t,e){return sa.call(this,t,"not-in",e)||this}function va(t,e){return ua.call(this,t,"in",e)||this}function ga(t,e){return aa.call(this,t,"array-contains",e)||this}function ma(t){return(t.before?"b":"a")+":"+t.position.map(jo).join(",")}function wa(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.p()?qr.i(qr.C(s.referenceValue),n.key):Mo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function ba(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Co(t.position[n],e.position[n]))return!1;return!0}var Ea=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Ia(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var Ta,_a=(ka.prototype.reset=function(){this.Tn=0},ka.prototype.An=function(){this.Tn=this.mn},ka.prototype.Rn=function(t){var e=this;this.cancel();var n=Math.floor(this.Tn+this.Pn()),r=Math.max(0,Date.now()-this.In),i=Math.max(0,n-r);0<i&&Dr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Tn+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.En=this._n.yn(this.fn,i,function(){return e.In=Date.now(),t()}),this.Tn*=this.wn,this.Tn<this.dn&&(this.Tn=this.dn),this.Tn>this.mn&&(this.Tn=this.mn)},ka.prototype.gn=function(){null!==this.En&&(this.En.Vn(),this.En=null)},ka.prototype.cancel=function(){null!==this.En&&(this.En.cancel(),this.En=null)},ka.prototype.Pn=function(){return(Math.random()-.5)*this.Tn},ka),Aa=(La.prototype.catch=function(t){return this.next(void 0,t)},La.prototype.next=function(r,i){var o=this;return this.Sn&&Lr(),this.Sn=!0,this.vn?this.error?this.Dn(i,this.error):this.Cn(r,this.result):new La(function(e,n){o.pn=function(t){o.Cn(r,t).next(e,n)},o.bn=function(t){o.Dn(i,t).next(e,n)}})},La.prototype.Nn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},La.prototype.Fn=function(t){try{var e=t();return e instanceof La?e:La.resolve(e)}catch(t){return La.reject(t)}},La.prototype.Cn=function(t,e){return t?this.Fn(function(){return t(e)}):La.resolve(e)},La.prototype.Dn=function(t,e){return t?this.Fn(function(){return t(e)}):La.reject(e)},La.resolve=function(n){return new La(function(t,e){t(n)})},La.reject=function(n){return new La(function(t,e){e(n)})},La.$n=function(t){return new La(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},La.xn=function(t){for(var n=La.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?La.resolve(t):e()})}(r[e]);return n},La.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.$n(i)},La),Na=(xa.delete=function(t){return Dr("SimpleDb","Removing database:",t),Fa(window.indexedDB.deleteDatabase(t)).Nn()},xa.On=function(){if("undefined"==typeof indexedDB)return!1;if(xa.Ln())return!0;var t=p(),e=0<(n=xa.Mn(t))&&n<10,n=0<(n=xa.Bn(t))&&n<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||e||n)},xa.Ln=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.qn)},xa.Un=function(t,e){return t.store(e)},xa.Mn=function(t){return t=(t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i))?t[1].split("_").slice(0,2).join("."):"-1",Number(t)},xa.Bn=function(t){return t=(t=t.match(/Android ([\d.]+)/i))?t[1].split(".").slice(0,2).join("."):"-1",Number(t)},xa.prototype.Qn=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Dr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result,e(t)},r.onblocked=function(){n(new Da(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){"VersionError"===(t=t.target.error).name?n(new Tr(Ir.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new Da(o,t))},r.onupgradeneeded=function(t){Dr("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.kn.createOrUpgrade(e,r.transaction,t.oldVersion,i.version).next(function(){Dr("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.Wn&&(this.db.onversionchange=function(t){return i.Wn(t)}),this.db)]}})})},xa.prototype.jn=function(e){this.Wn=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},xa.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.Qn(u)];case 2:return s.db=t.sent(),e=Ua.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),Aa.reject(t)}).Nn(),r={},n.catch(function(){}),[4,e.Kn];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,Dr("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},xa.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},xa),Sa=(Object.defineProperty(Oa.prototype,"vn",{get:function(){return this.zn},enumerable:!1,configurable:!0}),Object.defineProperty(Oa.prototype,"Jn",{get:function(){return this.Hn},enumerable:!1,configurable:!0}),Object.defineProperty(Oa.prototype,"cursor",{set:function(t){this.Gn=t},enumerable:!1,configurable:!0}),Oa.prototype.done=function(){this.zn=!0},Oa.prototype.Yn=function(t){this.Hn=t},Oa.prototype.delete=function(){return Fa(this.Gn.delete())},Oa),Da=(n(Ra,Ta=Tr),Ra);function Ra(t,e){var n=this;return(n=Ta.call(this,Ir.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function Oa(t){this.Gn=t,this.zn=!1,this.Hn=null}function xa(t,e,n){this.name=t,this.version=e,this.kn=n,12.2===xa.Mn(p())&&Rr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function La(t){var e=this;this.pn=null,this.bn=null,this.result=void 0,this.error=void 0,this.vn=!1,this.Sn=!1,t(function(t){e.vn=!0,e.result=t,e.pn&&e.pn(t)},function(t){e.vn=!0,e.error=t,e.bn&&e.bn(t)})}function ka(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this._n=t,this.fn=e,this.dn=n,this.wn=r,this.mn=i,this.Tn=0,this.En=null,this.In=Date.now(),this.reset()}function Pa(t){return"IndexedDbTransactionError"===t.name}var Ua=(Ma.open=function(t,e,n,r){try{return new Ma(e,t.transaction(r,n))}catch(t){throw new Da(e,t)}},Object.defineProperty(Ma.prototype,"Kn",{get:function(){return this.Xn.promise},enumerable:!1,configurable:!0}),Ma.prototype.abort=function(t){t&&this.Xn.reject(t),this.aborted||(Dr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},Ma.prototype.store=function(t){return t=this.transaction.objectStore(t),new Ca(t)},Ma),Ca=(Va.prototype.put=function(t,e){return Fa(t=void 0!==e?(Dr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Dr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},Va.prototype.add=function(t){return Dr("SimpleDb","ADD",this.store.name,t,t),Fa(this.store.add(t))},Va.prototype.get=function(e){var n=this;return Fa(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Dr("SimpleDb","GET",n.store.name,e,t),t})},Va.prototype.delete=function(t){return Dr("SimpleDb","DELETE",this.store.name,t),Fa(this.store.delete(t))},Va.prototype.count=function(){return Dr("SimpleDb","COUNT",this.store.name),Fa(this.store.count())},Va.prototype.Zn=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.ts(e,function(t,e){n.push(e)}).next(function(){return n})},Va.prototype.es=function(t,e){return Dr("SimpleDb","DELETE ALL",this.store.name),(e=this.options(t,e)).ns=!1,e=this.cursor(e),this.ts(e,function(t,e,n){return n.delete()})},Va.prototype.ss=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.ts(n,e)},Va.prototype.rs=function(r){var t=this.cursor({});return new Aa(function(n,e){t.onerror=function(t){t=Ga(t.target.error),e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},Va.prototype.ts=function(t,i){var o=[];return new Aa(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new Sa(n),(t=i(n.primaryKey,n.value,e))instanceof Aa&&(t=t.catch(function(t){return e.done(),Aa.reject(t)}),o.push(t)),e.vn?r():null===e.Jn?n.continue():n.continue(e.Jn)):r()}}).next(function(){return Aa.$n(o)})},Va.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},Va.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.ns?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},Va);function Va(t){this.store=t}function Ma(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.Xn=new Ia,this.transaction.oncomplete=function(){n.Xn.resolve()},this.transaction.onabort=function(){t.error?n.Xn.reject(new Da(e,t.error)):n.Xn.resolve()},this.transaction.onerror=function(t){t=Ga(t.target.error),n.Xn.reject(new Da(e,t))}}function Fa(t){return new Aa(function(e,n){t.onsuccess=function(t){t=t.target.result,e(t)},t.onerror=function(t){t=Ga(t.target.error),n(t)}})}var ja=!1;function Ga(t){var e=Na.Mn(p());if(12.2<=e&&e<13&&(e="An internal error was encountered in the Indexed Database server",0<=t.message.indexOf(e))){var n=new Tr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return ja||(ja=!0,setTimeout(function(){throw n},0)),n}return t}function qa(){return"undefined"!=typeof window?window:null}function Ba(){return"undefined"!=typeof document?document:null}var za=(Ha.ls=function(t,e,n,r,i){return(i=new Ha(t,e,Date.now()+n,r,i)).start(n),i},Ha.prototype.start=function(t){var e=this;this._s=setTimeout(function(){return e.fs()},t)},Ha.prototype.Vn=function(){return this.fs()},Ha.prototype.cancel=function(t){null!==this._s&&(this.clearTimeout(),this.hs.reject(new Tr(Ir.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Ha.prototype.fs=function(){var e=this;this.os.ds(function(){return null!==e._s?(e.clearTimeout(),e.op().then(function(t){return e.hs.resolve(t)})):Promise.resolve()})},Ha.prototype.clearTimeout=function(){null!==this._s&&(this.cs(this),clearTimeout(this._s),this._s=null)},Ha),Ka=(Object.defineProperty(Qa.prototype,"Vs",{get:function(){return this.Es},enumerable:!1,configurable:!0}),Qa.prototype.ds=function(t){this.enqueue(t)},Qa.prototype.ps=function(t){this.bs(),this.vs(t)},Qa.prototype.Ss=function(){var t;this.Es||(this.Es=!0,(t=Ba())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.gs))},Qa.prototype.enqueue=function(t){return this.bs(),this.Es?new Promise(function(t){}):this.vs(t)},Qa.prototype.Ds=function(t){var e=this;this.Ts.push(t),this.ds(function(){return e.Cs()})},Qa.prototype.Cs=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Ts.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Ts[0]()];case 2:return t.sent(),this.Ts.shift(),this.ys.reset(),[3,4];case 3:if(!Pa(e=t.sent()))throw e;return Dr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Ts.length&&this.ys.Rn(function(){return n.Cs()}),t.label=5;case 5:return[2]}})})},Qa.prototype.vs=function(t){var r=this,e=this.ws.then(function(){return r.Rs=!0,t().catch(function(t){throw r.As=t,r.Rs=!1,Rr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Rs=!1,t})});return this.ws=e},Qa.prototype.yn=function(t,e,n){var r=this;return this.bs(),-1<this.Ps.indexOf(t)&&(e=0),n=za.ls(this,t,e,n,function(t){return r.Ns(t)}),this.Is.push(n),n},Qa.prototype.bs=function(){this.As&&Lr()},Qa.prototype.Fs=function(){},Qa.prototype.$s=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.ws];case 1:t.sent(),t.label=2;case 2:if(e!==this.ws)return[3,0];t.label=3;case 3:return[2]}})})},Qa.prototype.xs=function(t){for(var e=0,n=this.Is;e<n.length;e++)if(n[e].fn===t)return!0;return!1},Qa.prototype.ks=function(r){var i=this;return this.$s().then(function(){i.Is.sort(function(t,e){return t.us-e.us});for(var t=0,e=i.Is;t<e.length;t++){var n=e[t];if(n.Vn(),"all"!==r&&n.fn===r)break}return i.$s()})},Qa.prototype.Ms=function(t){this.Ps.push(t)},Qa.prototype.Ns=function(t){t=this.Is.indexOf(t),this.Is.splice(t,1)},Qa);function Qa(){var e=this;this.ws=Promise.resolve(),this.Ts=[],this.Es=!1,this.Is=[],this.As=null,this.Rs=!1,this.Ps=[],this.ys=new _a(this,"async_queue_retry"),this.gs=function(){var t=Ba();t&&Dr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.ys.gn()};var t=Ba();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.gs)}function Ha(t,e,n,r,i){this.os=t,this.fn=e,this.us=n,this.op=r,this.cs=i,this.hs=new Ia,this.then=this.hs.promise.then.bind(this.hs.promise),this.hs.promise.catch(function(t){})}function Wa(t,e){if(Rr("AsyncQueue",e+": "+t),Pa(t))return new Tr(Ir.UNAVAILABLE,e+": "+t);throw t}function Xa(){this.Os=void 0,this.listeners=[]}function Ya(){this.Ls=new Si(qu,Gu),this.onlineState="Unknown",this.Bs=new Set}function Ja(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.Ls.get(n))||(r=!0,i=new Xa),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.qs(n)];case 2:return o.Os=t.sent(),[3,4];case 3:return o=Wa(o=t.sent(),"Initialization of query '"+Bu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.Ls.set(n,i),i.listeners.push(u),u.Us(e.onlineState),i.Os&&u.Qs(i.Os)&&$a(e),[2]}})})}function Za(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.Ls.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.Ls.delete(n),e.Ws(n))]:[2]})})}function $a(t){t.Bs.forEach(function(t){t.next()})}var tc=(rc.prototype.Qs=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new yo(t.query,t.docs,t.Ut,e,t.Qt,t.fromCache,t.Wt,!0)}var o=!1;return this.Ks?this.zs(t)&&(this.js.next(t),o=!0):this.Hs(t,this.onlineState)&&(this.Js(t),o=!0),this.Gs=t,o},rc.prototype.onError=function(t){this.js.error(t)},rc.prototype.Us=function(t){this.onlineState=t;var e=!1;return this.Gs&&!this.Ks&&this.Hs(this.Gs,t)&&(this.Js(this.Gs),e=!0),e},rc.prototype.Hs=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Ys&&n||t.docs.m()&&"Offline"!==e)},rc.prototype.zs=function(t){if(0<t.docChanges.length)return!0;var e=this.Gs&&this.Gs.hasPendingWrites!==t.hasPendingWrites;return!(!t.Wt&&!e)&&!0===this.options.includeMetadataChanges},rc.prototype.Js=function(t){t=yo.Kt(t.query,t.docs,t.Qt,t.fromCache),this.Ks=!0,this.js.next(t)},rc),ec=(nc.prototype.Xs=function(){return null!=this.uid},nc.prototype.Zs=function(){return this.Xs()?"uid:"+this.uid:"anonymous-user"},nc.prototype.isEqual=function(t){return t.uid===this.uid},nc);function nc(t){this.uid=t}function rc(t,e,n){this.query=t,this.js=e,this.Ks=!1,this.Gs=null,this.onlineState="Unknown",this.options=n||{}}ec.UNAUTHENTICATED=new ec(null),ec.ti=new ec("google-credentials-uid"),ec.ei=new ec("first-party-uid");var ic=(oc.prototype.si=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},oc.prototype.next=function(){var t=++this.previousValue;return this.ii&&this.ii(t),t},oc);function oc(t,e){var n=this;this.previousValue=t,e&&(e.ni=function(t){return n.si(t)},this.ii=function(t){return e.ri(t)})}function sc(t,e){return"firestore_clients_"+t+"_"+e}function uc(t,e,n){return n="firestore_mutations_"+t+"_"+n,e.Xs()&&(n+="_"+e.uid),n}function ac(t,e){return"firestore_targets_"+t+"_"+e}ic.oi=-1;var cc=(Sc.ai=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Tr(r.error.code,r.error.message)),i?new Sc(t,e,r.state,o):(Rr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},Sc.prototype.ui=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Sc),hc=(Nc.ai=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Tr(n.error.code,n.error.message)),r?new Nc(t,n.state,i):(Rr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},Nc.prototype.ui=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Nc),lc=(Ac.ai=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=lo,o=0;r&&o<n.activeTargetIds.length;++o)r=Vi(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new Ac(t,i):(Rr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},Ac),fc=(_c.ai=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new _c(e.clientId,e.onlineState):(Rr("SharedClientState","Failed to parse online state: "+t),null)},_c),pc=(Tc.prototype.ci=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Tc.prototype.hi=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Tc.prototype.ui=function(){var t={activeTargetIds:this.activeTargetIds.A(),updateTimeMs:Date.now()};return JSON.stringify(t)},Tc),dc=(Ic.On=function(t){return!(!t||!t.localStorage)},Ic.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,l=this;return v(this,function(t){switch(t.label){case 0:return[4,this._i.pi()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this.li&&(i=this.getItem(sc(this.persistenceKey,r)))&&(o=lc.ai(r,i))&&(this.mi=this.mi.rt(o.clientId,o));for(this.bi(),(s=this.storage.getItem(this.gi))&&(u=this.vi(s))&&this.Si(u),a=0,c=this.Ei;a<c.length;a++)h=c[a],this.wi(h);return this.Ei=[],this.window.addEventListener("unload",function(){return l.Di()}),this.Ti=!0,[2]}})})},Ic.prototype.ri=function(t){this.setItem(this.Ai,JSON.stringify(t))},Ic.prototype.Ci=function(){return this.Ni(this.mi)},Ic.prototype.Fi=function(n){var r=!1;return this.mi.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},Ic.prototype.$i=function(t){this.xi(t,"pending")},Ic.prototype.ki=function(t,e,n){this.xi(t,e,n),this.Mi(t)},Ic.prototype.Oi=function(t){var e,n="not-current";return this.Fi(t)&&(!(e=this.storage.getItem(ac(this.persistenceKey,t)))||(e=hc.ai(t,e))&&(n=e.state)),this.Li.ci(t),this.bi(),n},Ic.prototype.Bi=function(t){this.Li.hi(t),this.bi()},Ic.prototype.qi=function(t){return this.Li.activeTargetIds.has(t)},Ic.prototype.Ui=function(t){this.removeItem(ac(this.persistenceKey,t))},Ic.prototype.Qi=function(t,e,n){this.Wi(t,e,n)},Ic.prototype.ji=function(t,e,n){var r=this;e.forEach(function(t){r.Mi(t)}),this.currentUser=t,n.forEach(function(t){r.$i(t)})},Ic.prototype.Ki=function(t){this.Gi(t)},Ic.prototype.zi=function(){this.Hi()},Ic.prototype.Di=function(){this.Ti&&(this.window.removeEventListener("storage",this.di),this.removeItem(this.Ii),this.Ti=!1)},Ic.prototype.getItem=function(t){var e=this.storage.getItem(t);return Dr("SharedClientState","READ",t,e),e},Ic.prototype.setItem=function(t,e){Dr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},Ic.prototype.removeItem=function(t){Dr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},Ic.prototype.wi=function(t){var e=this,o=t;if(o.storageArea===this.storage){if(Dr("SharedClientState","EVENT",o.key,o.newValue),o.key===this.Ii)return void Rr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this._n.Ds(function(){return y(e,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){if(this.Ti){if(null!==o.key)if(this.Ri.test(o.key)){if(null==o.newValue)return e=this.Ji(o.key),[2,this.Yi(e,null)];if(e=this.Xi(o.key,o.newValue))return[2,this.Yi(e.clientId,e)]}else if(this.Pi.test(o.key)){if(null!==o.newValue&&(n=this.Zi(o.key,o.newValue)))return[2,this.tr(n)]}else if(this.yi.test(o.key)){if(null!==o.newValue&&(r=this.er(o.key,o.newValue)))return[2,this.nr(r)]}else if(o.key===this.gi){if(null!==o.newValue&&(i=this.vi(o.newValue)))return[2,this.Si(i)]}else if(o.key===this.Ai)(i=function(t){var e=ic.oi;if(null!=t)try{var n=JSON.parse(t);kr("number"==typeof n),e=n}catch(t){Rr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(o.newValue))!==ic.oi&&this.ni(i);else if(o.key===this.Vi)return[2,this._i.sr()]}else this.Ei.push(o);return[2]})})})}},Object.defineProperty(Ic.prototype,"Li",{get:function(){return this.mi.get(this.li)},enumerable:!1,configurable:!0}),Ic.prototype.bi=function(){this.setItem(this.Ii,this.Li.ui())},Ic.prototype.xi=function(t,e,n){n=new cc(this.currentUser,t,e,n),t=uc(this.persistenceKey,this.currentUser,t),this.setItem(t,n.ui())},Ic.prototype.Mi=function(t){t=uc(this.persistenceKey,this.currentUser,t),this.removeItem(t)},Ic.prototype.Gi=function(t){t={clientId:this.li,onlineState:t},this.storage.setItem(this.gi,JSON.stringify(t))},Ic.prototype.Wi=function(t,e,n){var r=ac(this.persistenceKey,t),n=new hc(t,e,n);this.setItem(r,n.ui())},Ic.prototype.Hi=function(){this.setItem(this.Vi,"value-not-used")},Ic.prototype.Ji=function(t){return(t=this.Ri.exec(t))?t[1]:null},Ic.prototype.Xi=function(t,e){return t=this.Ji(t),lc.ai(t,e)},Ic.prototype.Zi=function(t,e){var n=this.Pi.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return cc.ai(new ec(n),t,e)},Ic.prototype.er=function(t,e){return t=this.yi.exec(t),t=Number(t[1]),hc.ai(t,e)},Ic.prototype.vi=function(t){return fc.ai(t)},Ic.prototype.tr=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this._i.ir(e.batchId,e.state,e.error)]:(Dr("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},Ic.prototype.nr=function(t){return this._i.rr(t.targetId,t.state,t.error)},Ic.prototype.Yi=function(t,e){var n=this,r=e?this.mi.rt(t,e):this.mi.remove(t),i=this.Ni(this.mi),o=this.Ni(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this._i.ar(s,u).then(function(){n.mi=r})},Ic.prototype.Si=function(t){this.mi.get(t.clientId)&&this.fi(t.onlineState)},Ic.prototype.Ni=function(t){var n=lo;return t.forEach(function(t,e){n=n.xt(e.activeTargetIds)}),n},Ic),yc=(Ec.prototype.$i=function(t){},Ec.prototype.ki=function(t,e,n){},Ec.prototype.Oi=function(t){return this.ur.ci(t),this.cr[t]||"not-current"},Ec.prototype.Qi=function(t,e,n){this.cr[t]=e},Ec.prototype.Bi=function(t){this.ur.hi(t)},Ec.prototype.qi=function(t){return this.ur.activeTargetIds.has(t)},Ec.prototype.Ui=function(t){delete this.cr[t]},Ec.prototype.Ci=function(){return this.ur.activeTargetIds},Ec.prototype.Fi=function(t){return this.ur.activeTargetIds.has(t)},Ec.prototype.start=function(){return this.ur=new pc,Promise.resolve()},Ec.prototype.ji=function(t,e,n){},Ec.prototype.Ki=function(t){},Ec.prototype.Di=function(){},Ec.prototype.ri=function(t){},Ec.prototype.zi=function(){},Ec),vc=(bc.prototype.lr=function(t,e,n){for(var r,i,o,s,u,a,c=n._r,h=0;h<this.mutations.length;h++){var l=this.mutations[h];l.key.isEqual(t)&&(r=l,i=e,o=c[h],a=u=s=void 0,e=r instanceof tu?new Iu(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof eu?(u=i,a=o,Ws((s=r).Ke,u)?(u=iu(s,u),new Iu(s.key,a.version,u,{hasCommittedMutations:!0})):new _u(s.key,a.version)):r instanceof su?function(t,e,n){if(kr(null!=n.transformResults),!Ws(t.Ke,e))return new _u(t.key,n.version);var r=e,e=function(t,e,n){var r=[];kr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Iu&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof Rs?Ls(o,s):o instanceof Ps?Cs(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=au(t,r.data(),e);return new Iu(t.key,n,e,{hasCommittedMutations:!0})}(r,i,o):new Tu(r.key,o.version,{hasCommittedMutations:!0}))}return e},bc.prototype.dr=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Xs(i,e,e,this.hr))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Xs(a,e,o,this.hr))}return e},bc.prototype.wr=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.dr(t.key,n.get(t.key));e&&(i=i.rt(t.key,e))}),i},bc.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},ho())},bc.prototype.isEqual=function(t){return this.batchId===t.batchId&&yi(this.mutations,t.mutations,Ys)&&yi(this.baseMutations,t.baseMutations,Ys)},bc),gc=(wc.from=function(t,e,n){kr(t.mutations.length===n.length);for(var r=ao,i=t.mutations,o=0;o<i.length;o++)r=r.rt(i[o].key,n[o].version);return new wc(t,e,n,r)},wc),h=(mc.prototype.Ar=function(t){return(t=this.Er.get(t))?t.readTime:Ri.min()},mc.prototype.Rr=function(t,e){this.Pr(),this.Er.set(t.key,{yr:t,readTime:e})},mc.prototype.gr=function(t,e){void 0===e&&(e=null),this.Pr(),this.Er.set(t,{yr:null,readTime:e})},mc.prototype.Vr=function(t,e){this.Pr();var n=this.Er.get(e);return void 0!==n?Aa.resolve(n.yr):this.pr(t,e)},mc.prototype.getEntries=function(t,e){return this.br(t,e)},mc.prototype.apply=function(t){return this.Pr(),this.Ir=!0,this.vr(t)},mc.prototype.Pr=function(){},mc);function mc(){this.Er=new Si(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.Ir=!1}function wc(t,e,n,r){this.batch=t,this.mr=e,this._r=n,this.Tr=r}function bc(t,e,n,r){this.batchId=t,this.hr=e,this.baseMutations=n,this.mutations=r}function Ec(){this.ur=new pc,this.cr={},this.fi=null,this.ni=null}function Ic(t,e,n,r,i){this.window=t,this._n=e,this.persistenceKey=n,this.li=r,this._i=null,this.fi=null,this.ni=null,this.di=this.wi.bind(this),this.mi=new Xi(di),this.Ti=!1,this.Ei=[],n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),this.storage=this.window.localStorage,this.currentUser=i,this.Ii=sc(this.persistenceKey,this.li),this.Ai="firestore_sequence_number_"+this.persistenceKey,this.mi=this.mi.rt(this.li,new pc),this.Ri=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.Pi=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.yi=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.gi="firestore_online_state_"+this.persistenceKey,this.Vi="firestore_bundle_loaded_"+this.persistenceKey,this.window.addEventListener("storage",this.di)}function Tc(){this.activeTargetIds=lo}function _c(t,e){this.clientId=t,this.onlineState=e}function Ac(t,e){this.clientId=t,this.activeTargetIds=e}function Nc(t,e,n){this.targetId=t,this.state=e,this.error=n}function Sc(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function Dc(n,r){void 0===r&&(r=10240);var i=0;return{read:function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return i<n.byteLength?(e={value:n.slice(i,i+r),done:!1},[2,(i+=r,e)]):[2,{value:void 0,done:!0}]})})},cancel:function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2]})})},releaseLock:function(){}}}function Rc(t,e){if(t instanceof Uint8Array)return Dc(t,e);if(t instanceof ArrayBuffer)return Dc(new Uint8Array(t),e);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}function Oc(t){return new Zo(t,!0)}var xc=(Cc.prototype.Sr=function(){return"metadata"in this.payload},Cc),Lc=(Uc.Fr=function(t,e){return new Uc(Rc(t,10240),e)},Uc.prototype.close=function(){return this.Dr.cancel()},Uc.prototype.getMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.metadata.promise]})})},Uc.prototype.$r=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Nr())]}})})},Uc.prototype.Nr=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return[4,this.kr()];case 1:return null===(e=t.sent())?[2,null]:(r=this.Cr.decode(e),n=Number(r),isNaN(n)&&this.Mr("length string ("+r+") is not valid number"),[4,this.Or(n)]);case 2:return r=t.sent(),[2,new xc(JSON.parse(r),e.length+n)]}})})},Uc.prototype.Lr=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},Uc.prototype.kr=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.Lr()<0?[4,this.Br()]:[3,3];case 1:if(t.sent())return[3,3];t.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.Lr())<0&&this.Mr("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),n)])}})})},Uc.prototype.Or=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.buffer.length<n?[4,this.Br()]:[3,3];case 1:t.sent()&&this.Mr("Reached the end of bundle when more is expected."),t.label=2;case 2:return[3,0];case 3:return e=this.Cr.decode(this.buffer.slice(0,n)),[2,(this.buffer=this.buffer.slice(n),e)]}})})},Uc.prototype.Mr=function(t){throw this.Dr.cancel(),new Error("Invalid bundle format: "+t)},Uc.prototype.Br=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.Dr.read()];case 1:return(e=t.sent()).done||((n=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n),[2,e.done]}})})},Uc),kc=(Pc.prototype.qr=function(t){return as(this.serializer,t)},Pc.prototype.Ur=function(t){return t.metadata.exists?ds(this.serializer,t.document,!1):new Tu(this.qr(t.metadata.name),this.Qr(t.metadata.readTime))},Pc.prototype.Qr=is,Pc);function Pc(t){this.serializer=t}function Uc(t,e){var n=this;this.Dr=t,this.serializer=e,this.metadata=new Ia,this.buffer=new Uint8Array,this.Cr=new TextDecoder("utf-8"),this.Nr().then(function(t){t&&t.Sr()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function Cc(t,e){this.payload=t,this.byteLength=e}function Vc(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}function Mc(t,e){this.progress=t,this.Wr=e}var Fc=(Qc.prototype.Gr=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.Ls.push(t.payload.namedQuery):t.payload.zr?(this.documents.push({metadata:t.payload.zr}),t.payload.zr.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},Qc.prototype.Hr=function(t){for(var e=new Map,n=new kc(this.serializer),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.Ls)for(var s=n.qr(o.metadata.name),u=0,a=o.metadata.Ls;u<a.length;u++){var c=a[u],h=(e.get(c)||ho()).add(s);e.set(c,h)}}return e},Qc.prototype.complete=function(){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return[4,function(f,p,d){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a,c,h,l;return v(this,function(t){switch(t.label){case 0:for(e=new kc((n=f).serializer),r=ho(),i=io,o=ao,s=0,u=p;s<u.length;s++)a=u[s],c=e.qr(a.metadata.name),a.document&&(r=r.add(c)),i=i.rt(c,e.Ur(a)),o=o.rt(c,e.Qr(a.metadata.readTime));return h=n.Yr.Jr({Xr:!0}),[4,Ul(n,Vu(Ou(Fr.P("__bundle__/docs/"+d))))];case 1:return l=t.sent(),[2,n.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return Pl(e,h,i,Ri.min(),o).next(function(t){return h.apply(e),t}).next(function(t){return n.eo.Zr(e,l.targetId).next(function(){return n.eo.no(e,r,l.targetId)}).next(function(){return n.io.so(e,t)})})})]}})})}(this.Kr,this.documents,this.jr.id)];case 1:e=t.sent(),n=this.Hr(this.documents),r=0,i=this.Ls,t.label=2;case 2:return r<i.length?(i=i[r],[4,function(e,i,o){return void 0===o&&(o=ho()),y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return[4,Ul(e,Vu(vh(i.bundledQuery)))];case 1:return n=t.sent(),[2,(r=e).persistence.runTransaction("Save named query","readwrite",function(t){var e=is(i.readTime);return 0<=n.et.L(e)?r.yu.Qa(t,i):(e=n.st(gi.B,e),r.ic=r.ic.rt(e.targetId,e),r.eo.su(t,e).next(function(){return r.eo.Zr(t,n.targetId)}).next(function(){return r.eo.no(t,o,n.targetId)}).next(function(){return r.yu.Qa(t,i)}))})]}})})}(this.Kr,i,n.get(i.name))]):[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Mc(Object.assign({},this.progress),e))]}})})},Qc),jc="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ee=(Kc.prototype.oo=function(t){this.ro.push(t)},Kc.prototype.ao=function(){this.ro.forEach(function(t){return t()})},Kc),Gc=(zc.prototype.lo=function(e,n){var r=this;return this.co._o(e,n).next(function(t){return r.fo(e,n,t)})},zc.prototype.fo=function(t,r,i){return this.uo.Vr(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].dr(r,t);return t})},zc.prototype.wo=function(t,e,i){var o=io;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].dr(t,e);o=o.rt(t,e)}),o},zc.prototype.mo=function(e,t){var n=this;return this.uo.getEntries(e,t).next(function(t){return n.so(e,t)})},zc.prototype.so=function(e,r){var i=this;return this.co.To(e,r).next(function(t){var t=i.wo(e,r,t),n=io;return t.forEach(function(t,e){e=e||new Tu(t,Ri.min()),n=n.rt(t,e)}),n})},zc.prototype.Eo=function(t,e,n){return r=e,qr.F(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Io(t,e.path):Uu(e)?this.Ao(t,e,n):this.Ro(t,e,n);var r},zc.prototype.Io=function(t,e){return this.lo(t,new qr(e)).next(function(t){var e=uo;return t instanceof Iu&&(e=e.rt(t.key,t)),e})},zc.prototype.Ao=function(n,r,i){var o=this,s=r.collectionGroup,u=uo;return this.ho.Po(n,s).next(function(t){return Aa.forEach(t,function(t){var e=(e=r,t=t.child(s),new Au(t,null,e.rn.slice(),e.filters.slice(),e.limit,e.on,e.startAt,e.endAt));return o.Ro(n,e,i).next(function(t){t.forEach(function(t,e){u=u.rt(t,e)})})}).next(function(){return u})})},zc.prototype.Ro=function(e,n,t){var c,h,r=this;return this.uo.Eo(e,n,t).next(function(t){return c=t,r.co.yo(e,n)}).next(function(t){return h=t,r.Vo(e,h,c).next(function(t){c=t;for(var e=0,n=h;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=Xs(s,a=c.get(u),a,r.hr);c=a instanceof Iu?c.rt(u,a):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){zu(n,e)||(c=c.remove(t))}),c})},zc.prototype.Vo=function(t,e,n){for(var r=ho(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof eu&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.uo.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Iu&&(c=c.rt(t,e))}),c})},zc),qc=(Bc.vo=function(t,e){for(var n=ho(),r=ho(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Bc(t,e.fromCache,n,r)},Bc);function Bc(t,e,n,r){this.targetId=t,this.fromCache=e,this.po=n,this.bo=r}function zc(t,e,n){this.uo=t,this.co=e,this.ho=n}function Kc(){this.ro=[]}function Qc(t,e,n){this.jr=t,this.Kr=e,this.serializer=n,this.Ls=[],this.documents=[],this.progress=Vc(t)}function Hc(t,e){var n=t[0],r=t[1],t=e[0],e=e[1];return 0===(t=di(n,t))?di(r,e):t}var Wc=(Zc.prototype.Co=function(){return++this.Do},Zc.prototype.No=function(t){var e=[t,this.Co()];this.buffer.size<this.So?this.buffer=this.buffer.add(e):Hc(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(Zc.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),Zc),Xc={Fo:!1,$o:0,xo:0,ko:0},Yc=(Jc.Bo=function(t){return new Jc(t,Jc.qo,Jc.Uo)},Jc);function Jc(t,e,n){this.Mo=t,this.Oo=e,this.Lo=n}function Zc(t){this.So=t,this.buffer=new no(Hc),this.Do=0}Yc.Qo=-1,Yc.Wo=1048576,Yc.jo=41943040,Yc.qo=10,Yc.Uo=1e3,Yc.Ko=new Yc(Yc.jo,Yc.qo,Yc.Uo),Yc.Go=new Yc(Yc.Qo,0,0);var $c=(nh.prototype.start=function(t){this.zo.params.Mo!==Yc.Qo&&this.Yo(t)},nh.prototype.stop=function(){this.Jo&&(this.Jo.cancel(),this.Jo=null)},Object.defineProperty(nh.prototype,"Ti",{get:function(){return null!==this.Jo},enumerable:!1,configurable:!0}),nh.prototype.Yo=function(n){var t=this,e=this.Ho?3e5:6e4;Dr("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.Jo=this.os.yn("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.Jo=null,this.Ho=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.Xo(this.zo)];case 2:return t.sent(),[3,7];case 3:return Pa(e=t.sent())?(Dr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,jl(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.Yo(n)];case 8:return t.sent(),[2]}})})})},nh),th=(eh.prototype.ta=function(t,e){return this.Zo.ea(t).next(function(t){return Math.floor(e/100*t)})},eh.prototype.na=function(t,e){var n=this;if(0===e)return Aa.resolve(ic.oi);var r=new Wc(e);return this.Zo.De(t,function(t){return r.No(t.sequenceNumber)}).next(function(){return n.Zo.sa(t,function(t){return r.No(t)})}).next(function(){return r.maxValue})},eh.prototype.ia=function(t,e,n){return this.Zo.ia(t,e,n)},eh.prototype.ra=function(t,e){return this.Zo.ra(t,e)},eh.prototype.oa=function(e,n){var r=this;return this.params.Mo===Yc.Qo?(Dr("LruGarbageCollector","Garbage collection skipped; disabled"),Aa.resolve(Xc)):this.aa(e).next(function(t){return t<r.params.Mo?(Dr("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.Mo),Xc):r.ua(e,n)})},eh.prototype.aa=function(t){return this.Zo.aa(t)},eh.prototype.ua=function(e,n){var r,i,o,s,u,a,c,h=this,l=Date.now();return this.ta(e,this.params.Oo).next(function(t){return i=t>h.params.Lo?(Dr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.Lo+" from "+t),h.params.Lo):t,s=Date.now(),h.na(e,i)}).next(function(t){return r=t,u=Date.now(),h.ia(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.ra(e,r)}).next(function(t){return c=Date.now(),Sr()<=f.DEBUG&&Dr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-l)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-l)+"ms"),Aa.resolve({Fo:!0,$o:i,xo:o,ko:t})})},eh);function eh(t,e){this.Zo=t,this.params=e}function nh(t,e){this.zo=t,this.os=e,this.Ho=!1,this.Jo=null}function rh(t){for(var o="",e=0;e<t.length;e++)0<o.length&&(o=ih(o)),o=function(t){for(var e=o,n=t.length,r=0;r<n;r++){var i=t.charAt(r);switch(i){case"\0":e+="";break;case"":e+="";break;default:e+=i}}return e}(t.get(e));return ih(o)}function ih(t){return t+""}function oh(t){var e=t.length;if(kr(2<=e),2===e)return kr(""===t.charAt(0)&&""===t.charAt(1)),Fr.g();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&Lr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Lr()}o=s+2}return new Fr(r)}var sh=function(t){this.ca=t};function uh(t,e){if(e.document)return ds(t.ca,e.document,!!e.hasCommittedMutations);if(e.noDocument){var t=qr.$(e.noDocument.path),n=fh(e.noDocument.readTime);return new Tu(t,n,{hasCommittedMutations:!!e.hasCommittedMutations})}return e.unknownDocument?(n=qr.$(e.unknownDocument.path),e=fh(e.unknownDocument.version),new _u(n,e)):Lr()}function ah(t,e,n){var r=ch(n),n=e.key.path.h().A();if(e instanceof Iu){var i={name:us(i=t.ca,(o=e).key),fields:o.sn().mapValue.fields,updateTime:ns(i,o.version.X())},o=e.hasCommittedMutations;return new Hh(null,null,i,o,r,n)}if(e instanceof Tu){var i=e.key.path.A(),o=lh(e.version),s=e.hasCommittedMutations;return new Hh(null,new Kh(i,o),null,s,r,n)}return e instanceof _u?(s=e.key.path.A(),e=lh(e.version),new Hh(new Qh(s,e),null,null,!0,r,n)):Lr()}function ch(t){return[(t=t.X()).seconds,t.nanoseconds]}function hh(t){return t=new Di(t[0],t[1]),Ri.J(t)}function lh(t){return t=t.X(),new Ch(t.seconds,t.nanoseconds)}function fh(t){return t=new Di(t.seconds,t.nanoseconds),Ri.J(t)}function ph(e,t){var n=(t.baseMutations||[]).map(function(t){return vs(e.ca,t)}),r=t.mutations.map(function(t){return vs(e.ca,t)}),i=Di.fromMillis(t.localWriteTimeMs);return new vc(t.batchId,i,n,r)}function dh(t){var e=fh(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?fh(t.lastLimboFreeSnapshotVersion):Ri.min(),r=void 0!==t.query.documents?(kr(1===(r=t.query).documents.length),Vu(Ou(hs(r.documents[0])))):Vu(ws(t.query));return new Ki(r,t.targetId,0,t.lastListenSequenceNumber,e,n,gi.fromBase64String(t.resumeToken))}function yh(t,e){var n=lh(e.et),r=lh(e.lastLimboFreeSnapshotVersion),i=(qi(e.target)?gs:ms)(t.ca,e.target),t=e.resumeToken.toBase64();return new Xh(e.targetId,ji(e.target),n,t,e.sequenceNumber,r,i)}function vh(t){var e=ws({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.on?Mu(e,e.limit,"L"):e}var gh=(mh._a=function(t,e,n,r){return kr(""!==t.uid),new mh(t.Xs()?t.uid:"",e,n,r)},mh.prototype.fa=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Eh(t).ss({index:qh.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},mh.prototype.da=function(d,y,v,g){var m=this,w=Ih(d),b=Eh(d);return b.add({}).next(function(t){kr("number"==typeof t);for(var e,n,r,i,o,s=new vc(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return ys(e.ca,t)}),o=r.mutations.map(function(t){return ys(e.ca,t)}),new qh(n,r.batchId,r.hr.toMillis(),i,o)),a=[],c=new no(function(t,e){return di(t.R(),e.R())}),h=0,l=g;h<l.length;h++){var f=l[h],p=Bh.key(m.userId,f.key.path,t),c=c.add(f.key.path.h());a.push(b.put(u)),a.push(w.put(p,Bh.PLACEHOLDER))}return c.forEach(function(t){a.push(m.ho.wa(d,t))}),d.oo(function(){m.la[t]=s.keys()}),Aa.$n(a).next(function(){return s})})},mh.prototype.ma=function(t,e){var n=this;return Eh(t).get(e).next(function(t){return t?(kr(t.userId===n.userId),ph(n.serializer,t)):null})},mh.prototype.Ta=function(t,e){var n=this;return this.la[e]?Aa.resolve(this.la[e]):this.ma(t,e).next(function(t){return t?(t=t.keys(),n.la[e]=t):null})},mh.prototype.Ea=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return Eh(t).ss({index:qh.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(kr(e.batchId>=i),o=ph(r.serializer,e)),n.done()}).next(function(){return o})},mh.prototype.Ia=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Eh(t).ss({index:qh.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},mh.prototype.Aa=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Eh(t).Zn(qh.userMutationsIndex,n).next(function(t){return t.map(function(t){return ph(e.serializer,t)})})},mh.prototype._o=function(o,s){var u=this,t=Bh.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return Ih(o).ss({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=oh(i);if(r===u.userId&&s.path.isEqual(i))return Eh(o).get(t).next(function(t){if(!t)throw Lr();kr(t.userId===u.userId),a.push(ph(u.serializer,t))});n.done()}).next(function(){return a})},mh.prototype.To=function(e,t){var s=this,u=new no(di),n=[];return t.forEach(function(o){var t=Bh.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=Ih(e).ss({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=oh(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),Aa.$n(n).next(function(){return s.Ra(e,u)})},mh.prototype.yo=function(t,e){var o=this,s=e.path,u=s.length+1,e=Bh.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new no(di);return Ih(t).ss({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=oh(i);r===o.userId&&s.T(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.Ra(t,a)})},mh.prototype.Ra=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(Eh(e).get(t).next(function(t){if(null===t)throw Lr();kr(t.userId===n.userId),r.push(ph(n.serializer,t))}))}),Aa.$n(i).next(function(){return r})},mh.prototype.Pa=function(e,n){var r=this;return bh(e.ya,this.userId,n).next(function(t){return e.oo(function(){r.ga(n.batchId)}),Aa.forEach(t,function(t){return r.ha.Va(e,t)})})},mh.prototype.ga=function(t){delete this.la[t]},mh.prototype.pa=function(e){var i=this;return this.fa(e).next(function(t){if(!t)return Aa.resolve();var t=IDBKeyRange.lowerBound(Bh.prefixForUser(i.userId)),r=[];return Ih(e).ss({range:t},function(t,e,n){t[0]===i.userId?(t=oh(t[1]),r.push(t)):n.done()}).next(function(){kr(0===r.length)})})},mh.prototype.ba=function(t,e){return wh(t,this.userId,e)},mh.prototype.va=function(t){var e=this;return Th(t).get(this.userId).next(function(t){return t||new Gh(e.userId,-1,"")})},mh);function mh(t,e,n,r){this.userId=t,this.serializer=e,this.ho=n,this.ha=r,this.la={}}function wh(t,o,e){var s=(e=Bh.prefixForPath(o,e.path))[1],e=IDBKeyRange.lowerBound(e),u=!1;return Ih(t).ss({range:e,ns:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function bh(t,e,n){var r=t.store(qh.store),i=t.store(Bh.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r.ss({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){kr(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],l=Bh.key(e,h.key.path,n.batchId);o.push(i.delete(l)),u.push(h.key)}return Aa.$n(o).next(function(){return u})}function Eh(t){return El.Un(t,qh.store)}function Ih(t){return El.Un(t,Bh.store)}function Th(t){return El.Un(t,Gh.store)}var _h,Ah=(Dh.prototype.Rr=function(t,e,n){return Oh(t).put(xh(e),n)},Dh.prototype.gr=function(t,e){return t=Oh(t),e=xh(e),t.delete(e)},Dh.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.Sa(e,t)})},Dh.prototype.Vr=function(t,e){var n=this;return Oh(t).get(xh(e)).next(function(t){return n.Da(t)})},Dh.prototype.Ca=function(t,e){var n=this;return Oh(t).get(xh(e)).next(function(t){var e=n.Da(t);return e?{yr:e,size:Lh(t)}:null})},Dh.prototype.getEntries=function(t,e){var n=this,r=io;return this.Na(t,e,function(t,e){e=n.Da(e),r=r.rt(t,e)}).next(function(){return r})},Dh.prototype.Fa=function(t,e){var r=this,i=io,o=new Xi(qr.i);return this.Na(t,e,function(t,e){var n=r.Da(e);o=n?(i=i.rt(t,n),o.rt(t,Lh(e))):(i=i.rt(t,null),o.rt(t,0))}).next(function(){return{$a:i,xa:o}})},Dh.prototype.Na=function(t,e,i){if(e.m())return Aa.resolve();var n=IDBKeyRange.bound(e.first().path.A(),e.last().path.A()),o=e.lt(),s=o.Et();return Oh(t).ss({range:n},function(t,e,n){for(var r=qr.$(t);s&&qr.i(s,r)<0;)i(s,null),s=o.Et();s&&s.isEqual(r)&&(i(s,e),s=o.It()?o.Et():null),s?n.Yn(s.path.A()):n.done()}).next(function(){for(;s;)i(s,null),s=o.It()?o.Et():null})},Dh.prototype.Eo=function(t,r,e){var n,i=this,o=uo,s=r.path.length+1,u={};return e.isEqual(Ri.min())?(n=r.path.A(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.A(),e=ch(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=Hh.collectionReadTimeIndex),Oh(t).ss(u,function(t,e,n){t.length===s&&(e=uh(i.serializer,e),r.path.T(e.key.path)?e instanceof Iu&&zu(r,e)&&(o=o.rt(e.key,e)):n.done())}).next(function(){return o})},Dh.prototype.Jr=function(t){return new Nh(this,!!t&&t.Xr)},Dh.prototype.ka=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},Dh.prototype.getMetadata=function(t){return Rh(t).get(Wh.key).next(function(t){return kr(!!t),t})},Dh.prototype.Sa=function(t,e){return Rh(t).put(Wh.key,e)},Dh.prototype.Da=function(t){return!t||(t=uh(this.serializer,t))instanceof Tu&&t.version.isEqual(Ri.min())?null:t},Dh),Nh=(n(Sh,_h=h),Sh.prototype.vr=function(i){var o=this,s=[],u=0,a=new no(function(t,e){return di(t.R(),e.R())});return this.Er.forEach(function(t,e){var n,r=o.Oa.get(t);e.yr?(n=ah(o.Ma.serializer,e.yr,o.Ar(t)),a=a.add(t.path.h()),e=Lh(n),u+=e-r,s.push(o.Ma.Rr(i,t,n))):(u-=r,o.Xr?(r=ah(o.Ma.serializer,new Tu(t,Ri.min()),o.Ar(t)),s.push(o.Ma.Rr(i,t,r))):s.push(o.Ma.gr(i,t)))}),a.forEach(function(t){s.push(o.Ma.ho.wa(i,t))}),s.push(this.Ma.updateMetadata(i,u)),Aa.$n(s)},Sh.prototype.pr=function(t,e){var n=this;return this.Ma.Ca(t,e).next(function(t){return null===t?(n.Oa.set(e,0),null):(n.Oa.set(e,t.size),t.yr)})},Sh.prototype.br=function(t,e){var n=this;return this.Ma.Fa(t,e).next(function(t){var e=t.$a;return t.xa.forEach(function(t,e){n.Oa.set(t,e)}),e})},Sh);function Sh(t,e){var n=this;return(n=_h.call(this)||this).Ma=t,n.Xr=e,n.Oa=new Si(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function Dh(t,e){this.serializer=t,this.ho=e}function Rh(t){return El.Un(t,Wh.store)}function Oh(t){return El.Un(t,Hh.store)}function xh(t){return t.path.A()}function Lh(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Lr();e=t.noDocument}return JSON.stringify(e).length}var kh=(jh.prototype.wa=function(t,e){return this.La.add(e),Aa.resolve()},jh.prototype.Po=function(t,e){return Aa.resolve(this.La.getEntries(e))},jh),Ph=(Fh.prototype.add=function(t){var e=t._(),n=t.h(),r=this.index[e]||new no(Fr.i),t=!r.has(n);return this.index[e]=r.add(n),t},Fh.prototype.has=function(t){var e=t._(),t=t.h();return(e=this.index[e])&&e.has(t)},Fh.prototype.getEntries=function(t){return(this.index[t]||new no(Fr.i)).A()},Fh),Uh=(Mh.prototype.createOrUpgrade=function(e,n,t,r){var i=this;kr(t<r&&0<=t&&r<=11);var o=new Ua("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(Vh.store),(s=e).createObjectStore(Gh.store,{keyPath:Gh.keyPath}),s.createObjectStore(qh.store,{keyPath:qh.keyPath,autoIncrement:!0}).createIndex(qh.userMutationsIndex,qh.userMutationsKeyPath,{unique:!0}),s.createObjectStore(Bh.store),$h(e),e.createObjectStore(Hh.store));var s,u=Aa.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(Yh.store),s.deleteObjectStore(Xh.store),s.deleteObjectStore(Jh.store),$h(e)),u=u.next(function(){return t=o.store(Jh.store),e=new Jh(0,0,Ri.min().X(),0),t.put(Jh.key,e);var t,e})),t<4&&4<=r&&(0!==t&&(u=u.next(function(){return n=e,(r=o).store(qh.store).Zn().next(function(t){n.deleteObjectStore(qh.store),n.createObjectStore(qh.store,{keyPath:qh.keyPath,autoIncrement:!0}).createIndex(qh.userMutationsIndex,qh.userMutationsKeyPath,{unique:!0});var e=r.store(qh.store),t=t.map(function(t){return e.put(t)});return Aa.$n(t)});var n,r})),u=u.next(function(){e.createObjectStore(tl.store,{keyPath:tl.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.removeAcknowledgedMutations(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(Wh.store),i.addDocumentGlobal(o)})),t<7&&7<=r&&(u=u.next(function(){return i.ensureSequenceNumbers(o)})),t<8&&8<=r&&(u=u.next(function(){return i.createCollectionParentIndex(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(Hh.store)).createIndex(Hh.readTimeIndex,Hh.readTimeIndexPath,{unique:!1}),t.createIndex(Hh.collectionReadTimeIndex,Hh.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.rewriteCanonicalIds(o)})),t<11&&11<=r&&(u=u.next(function(){e.createObjectStore(el.store,{keyPath:el.keyPath}),e.createObjectStore(nl.store,{keyPath:nl.keyPath})})),u},Mh.prototype.addDocumentGlobal=function(e){var n=0;return e.store(Hh.store).ss(function(t,e){n+=Lh(e)}).next(function(){var t=new Wh(n);return e.store(Wh.store).put(Wh.key,t)})},Mh.prototype.removeAcknowledgedMutations=function(n){var r=this,t=n.store(Gh.store),i=n.store(qh.store);return t.Zn().next(function(t){return Aa.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.Zn(qh.userMutationsIndex,t).next(function(t){return Aa.forEach(t,function(t){return kr(t.userId===e.userId),t=ph(r.serializer,t),bh(n,e.userId,t).next(function(){})})})})})},Mh.prototype.ensureSequenceNumbers=function(t){var o=t.store(Yh.store),e=t.store(Hh.store);return t.store(Jh.store).get(Jh.key).next(function(r){var i=[];return e.ss(function(t,e){var n=new Fr(t),t=[0,rh(n)];i.push(o.get(t).next(function(t){return t?Aa.resolve():o.put(new Yh(0,rh(n),r.highestListenSequenceNumber))}))}).next(function(){return Aa.$n(i)})})},Mh.prototype.createCollectionParentIndex=function(t,e){function r(t){if(i.add(t)){var e=t._(),t=t.h();return n.put({collectionId:e,parent:rh(t)})}}t.createObjectStore(Zh.store,{keyPath:Zh.keyPath});var n=e.store(Zh.store),i=new Ph;return e.store(Hh.store).ss({ns:!0},function(t,e){return r((t=new Fr(t)).h())}).next(function(){return e.store(Bh.store).ss({ns:!0},function(t,e){t[0];var n=t[1];return r((n=(t[2],oh(n))).h())})})},Mh.prototype.rewriteCanonicalIds=function(t){var n=this,r=t.store(Xh.store);return r.ss(function(t,e){return e=dh(e),e=yh(n.serializer,e),r.put(e)})},Mh),Ch=function(t,e){this.seconds=t,this.nanoseconds=e},Vh=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function Mh(t){this.serializer=t}function Fh(){this.index={}}function jh(){this.La=new Ph}Vh.store="owner",Vh.key="owner";var Gh=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Gh.store="mutationQueues",Gh.keyPath="userId";var qh=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};qh.store="mutations",qh.keyPath="batchId",qh.userMutationsIndex="userMutationsIndex",qh.userMutationsKeyPath=["userId","batchId"];var Bh=(zh.prefixForUser=function(t){return[t]},zh.prefixForPath=function(t,e){return[t,rh(e)]},zh.key=function(t,e,n){return[t,rh(e),n]},zh);function zh(){}Bh.store="documentMutations",Bh.PLACEHOLDER=new Bh;var Kh=function(t,e){this.path=t,this.readTime=e},Qh=function(t,e){this.path=t,this.version=e},Hh=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Hh.store="remoteDocuments",Hh.readTimeIndex="readTimeIndex",Hh.readTimeIndexPath="readTime",Hh.collectionReadTimeIndex="collectionReadTimeIndex",Hh.collectionReadTimeIndexPath=["parentPath","readTime"];var Wh=function(t){this.byteSize=t};Wh.store="remoteDocumentGlobal",Wh.key="remoteDocumentGlobalKey";var Xh=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Xh.store="targets",Xh.keyPath="targetId",Xh.queryTargetsIndexName="queryTargetsIndex",Xh.queryTargetsKeyPath=["canonicalId","targetId"];var Yh=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Yh.store="targetDocuments",Yh.keyPath=["targetId","path"],Yh.documentTargetsIndex="documentTargetsIndex",Yh.documentTargetsKeyPath=["path","targetId"];var Jh=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Jh.key="targetGlobalKey",Jh.store="targetGlobal";var Zh=function(t,e){this.collectionId=t,this.parent=e};function $h(t){t.createObjectStore(Yh.store,{keyPath:Yh.keyPath}).createIndex(Yh.documentTargetsIndex,Yh.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Xh.store,{keyPath:Xh.keyPath}).createIndex(Xh.queryTargetsIndexName,Xh.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Jh.store)}Zh.store="collectionParents",Zh.keyPath=["collectionId","parent"];var tl=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};tl.store="clientMetadata",tl.keyPath="clientId";var el=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};el.store="bundles",el.keyPath="bundleId";var nl=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};nl.store="namedQueries",nl.keyPath="name";var rl=i(i(i(i([Gh.store,qh.store,Bh.store,Hh.store,Xh.store,Vh.store,Jh.store,Yh.store],[tl.store]),[Wh.store]),[Zh.store]),[el.store,nl.store]),il=(ol.prototype.Ba=function(t,e){return sl(t).get(e).next(function(t){if(t)return{id:(t=t).bundleId,createTime:fh(t.createTime),version:t.version}})},ol.prototype.qa=function(t,e){return sl(t).put({bundleId:(e=e).id,createTime:lh(is(e.createTime)),version:e.version})},ol.prototype.Ua=function(t,e){return ul(t).get(e).next(function(t){if(t)return{name:(t=t).name,query:vh(t.bundledQuery),readTime:fh(t.readTime)}})},ol.prototype.Qa=function(t,e){return ul(t).put({name:(e=e).name,readTime:lh(is(e.readTime)),bundledQuery:e.bundledQuery})},ol);function ol(t){this.serializer=t}function sl(t){return El.Un(t,el.store)}function ul(t){return El.Un(t,nl.store)}var al=(cl.prototype.wa=function(t,e){var n=this;if(this.Wa.has(e))return Aa.resolve();var r=e._(),i=e.h();return t.oo(function(){n.Wa.add(e)}),i={collectionId:r,parent:rh(i)},hl(t).put(i)},cl.prototype.Po=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[vi(i),""],!1,!0);return hl(t).Zn(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(oh(r.parent))}return o})},cl);function cl(){this.Wa=new Ph}function hl(t){return El.Un(t,Zh.store)}var ll=(dl.prototype.next=function(){return this.ja+=2,this.ja},dl.Ka=function(){return new dl(0)},dl.Ga=function(){return new dl(-1)},dl),fl=(pl.prototype.za=function(n){var r=this;return this.Ha(n).next(function(t){var e=new ll(t.highestTargetId);return t.highestTargetId=e.next(),r.Ja(n,t).next(function(){return t.highestTargetId})})},pl.prototype.Ya=function(t){return this.Ha(t).next(function(t){return Ri.J(new Di(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},pl.prototype.Xa=function(t){return this.Ha(t).next(function(t){return t.highestListenSequenceNumber})},pl.prototype.Za=function(e,n,r){var i=this;return this.Ha(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.X()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.Ja(e,t)})},pl.prototype.tu=function(e,n){var r=this;return this.eu(e,n).next(function(){return r.Ha(e).next(function(t){return t.targetCount+=1,r.nu(n,t),r.Ja(e,t)})})},pl.prototype.su=function(t,e){return this.eu(t,e)},pl.prototype.iu=function(e,t){var n=this;return this.Zr(e,t.targetId).next(function(){return yl(e).delete(t.targetId)}).next(function(){return n.Ha(e)}).next(function(t){return kr(0<t.targetCount),--t.targetCount,n.Ja(e,t)})},pl.prototype.ia=function(n,r,i){var o=this,s=0,u=[];return yl(n).ss(function(t,e){(e=dh(e)).sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.iu(n,e)))}).next(function(){return Aa.$n(u)}).next(function(){return s})},pl.prototype.De=function(t,n){return yl(t).ss(function(t,e){e=dh(e),n(e)})},pl.prototype.Ha=function(t){return vl(t).get(Jh.key).next(function(t){return kr(null!==t),t})},pl.prototype.Ja=function(t,e){return vl(t).put(Jh.key,e)},pl.prototype.eu=function(t,e){return yl(t).put(yh(this.serializer,e))},pl.prototype.nu=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},pl.prototype.ru=function(t){return this.Ha(t).next(function(t){return t.targetCount})},pl.prototype.ou=function(t,r){var e=ji(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return yl(t).ss({range:e,index:Xh.queryTargetsIndexName},function(t,e,n){e=dh(e),Gi(r,e.target)&&(i=e,n.done())}).next(function(){return i})},pl.prototype.no=function(n,t,r){var i=this,o=[],s=gl(n);return t.forEach(function(t){var e=rh(t.path);o.push(s.put(new Yh(r,e))),o.push(i.ha.au(n,r,t))}),Aa.$n(o)},pl.prototype.uu=function(n,t,r){var i=this,o=gl(n);return Aa.forEach(t,function(t){var e=rh(t.path);return Aa.$n([o.delete([r,e]),i.ha.cu(n,r,t)])})},pl.prototype.Zr=function(t,e){return t=gl(t),e=IDBKeyRange.bound([e],[e+1],!1,!0),t.delete(e)},pl.prototype.hu=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=gl(t),r=ho();return t.ss({range:e,ns:!0},function(t,e,n){t=oh(t[1]),t=new qr(t),r=r.add(t)}).next(function(){return r})},pl.prototype.ba=function(t,e){var e=rh(e.path),e=IDBKeyRange.bound([e],[vi(e)],!1,!0),i=0;return gl(t).ss({index:Yh.documentTargetsIndex,ns:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},pl.prototype.qe=function(t,e){return yl(t).get(e).next(function(t){return t?dh(t):null})},pl);function pl(t,e){this.ha=t,this.serializer=e}function dl(t){this.ja=t}function yl(t){return El.Un(t,Xh.store)}function vl(t){return El.Un(t,Jh.store)}function gl(t){return El.Un(t,Yh.store)}var ml,wl="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",bl=(n(Tl,ml=Ee),Tl),El=(Il.Un=function(t,e){if(t instanceof bl)return Na.Un(t.ya,e);throw Lr()},Il.prototype.start=function(){var e=this;return this.Vu().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Tr(Ir.FAILED_PRECONDITION,wl);return e.pu(),e.bu(),e.vu(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.eo.Xa(t)})}).then(function(t){e.du=new ic(t,e._u)}).then(function(){e.wu=!0}).catch(function(t){return e.Pu&&e.Pu.close(),Promise.reject(t)})},Il.prototype.Su=function(n){var t=this;return this.Au=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.Ti?[2,n(e)]:[2]})})},n(this.isPrimary)},Il.prototype.Du=function(n){var t=this;this.Pu.jn(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},Il.prototype.Cu=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this._n.ds(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ti?[4,this.Vu()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},Il.prototype.Vu=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Al(e).put(new tl(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.Nu(e).next(function(t){t||(n.isPrimary=!1,n._n.Ds(function(){return n.Au(!1)}))})}).next(function(){return n.Fu(e)}).next(function(t){return n.isPrimary&&!t?n.$u(e).next(function(){return!1}):!!t&&n.xu(e).next(function(){return!0})})}).catch(function(t){if(Pa(t))return Dr("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Dr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n._n.Ds(function(){return n.Au(t)}),n.isPrimary=t})},Il.prototype.Nu=function(t){var e=this;return _l(t).get(Vh.key).next(function(t){return Aa.resolve(e.ku(t))})},Il.prototype.Mu=function(t){return Al(t).delete(this.clientId)},Il.prototype.Ou=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.Lu(this.Iu,18e5)?[3,2]:(this.Iu=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=Il.Un(t,tl.store);return r.Zn().next(function(t){var e=o.Bu(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return Aa.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.gu)for(n=0,r=e;n<r.length;n++)i=r[n],this.gu.removeItem(this.qu(i.clientId));t.label=2;case 2:return[2]}})})},Il.prototype.vu=function(){var t=this;this.Eu=this._n.yn("client_metadata_refresh",4e3,function(){return t.Vu().then(function(){return t.Ou()}).then(function(){return t.vu()})})},Il.prototype.ku=function(t){return!!t&&t.ownerId===this.clientId},Il.prototype.Fu=function(e){var r=this;return this.fu?Aa.resolve(!0):_l(e).get(Vh.key).next(function(t){if(null!==t&&r.Lu(t.leaseTimestampMs,5e3)&&!r.Uu(t.ownerId)){if(r.ku(t)&&r.networkEnabled)return!0;if(!r.ku(t)){if(!t.allowTabSynchronization)throw new Tr(Ir.FAILED_PRECONDITION,wl);return!1}}return!(!r.networkEnabled||!r.inForeground)||Al(e).Zn().next(function(t){return void 0===r.Bu(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&Dr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},Il.prototype.Di=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this.wu=!1,this.Qu(),this.Eu&&(this.Eu.cancel(),this.Eu=null),this.Wu(),this.ju(),[4,this.Pu.runTransaction("shutdown","readwrite",[Vh.store,tl.store],function(t){var e=new bl(t,ic.oi);return n.$u(e).next(function(){return n.Mu(e)})})];case 1:return t.sent(),this.Pu.close(),this.Ku(),[2]}})})},Il.prototype.Bu=function(t,e){var n=this;return t.filter(function(t){return n.Lu(t.updateTimeMs,e)&&!n.Uu(t.clientId)})},Il.prototype.pi=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return Al(t).Zn().next(function(t){return e.Bu(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(Il.prototype,"Ti",{get:function(){return this.wu},enumerable:!1,configurable:!0}),Il.prototype.Gu=function(t){return gh._a(t,this.serializer,this.ho,this.ha)},Il.prototype.zu=function(){return this.eo},Il.prototype.Hu=function(){return this.uo},Il.prototype.Ju=function(){return this.ho},Il.prototype.Yu=function(){return this.yu},Il.prototype.runTransaction=function(e,n,r){var i=this;Dr("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Pu.runTransaction(e,t,rl,function(t){return o=new bl(t,i.du?i.du.next():ic.oi),"readwrite-primary"===n?i.Nu(o).next(function(t){return!!t||i.Fu(o)}).next(function(t){if(!t)throw Rr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i._n.Ds(function(){return i.Au(!1)}),new Tr(Ir.FAILED_PRECONDITION,jc);return r(o)}).next(function(t){return i.xu(o).next(function(){return t})}):i.Xu(o).next(function(){return r(o)})}).then(function(t){return o.ao(),t})},Il.prototype.Xu=function(t){var e=this;return _l(t).get(Vh.key).next(function(t){if(null!==t&&e.Lu(t.leaseTimestampMs,5e3)&&!e.Uu(t.ownerId)&&!e.ku(t)&&!(e.fu||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Tr(Ir.FAILED_PRECONDITION,wl)})},Il.prototype.xu=function(t){var e=new Vh(this.clientId,this.allowTabSynchronization,Date.now());return _l(t).put(Vh.key,e)},Il.On=function(){return Na.On()},Il.prototype.$u=function(t){var e=this,n=_l(t);return n.get(Vh.key).next(function(t){return e.ku(t)?(Dr("IndexedDbPersistence","Releasing primary lease."),n.delete(Vh.key)):Aa.resolve()})},Il.prototype.Lu=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Rr("Detected an update time that is in the future: "+t+" > "+n),1))},Il.prototype.pu=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Tu=function(){t._n.ds(function(){return t.inForeground="visible"===t.document.visibilityState,t.Vu()})},this.document.addEventListener("visibilitychange",this.Tu),this.inForeground="visible"===this.document.visibilityState)},Il.prototype.Wu=function(){this.Tu&&(this.document.removeEventListener("visibilitychange",this.Tu),this.Tu=null)},Il.prototype.bu=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.mu=function(){e.Qu(),e._n.ds(function(){return e.Di()})},this.window.addEventListener("unload",this.mu))},Il.prototype.ju=function(){this.mu&&(this.window.removeEventListener("unload",this.mu),this.mu=null)},Il.prototype.Uu=function(t){try{var e=null!==(null===(e=this.gu)||void 0===e?void 0:e.getItem(this.qu(t)));return Dr("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return Rr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},Il.prototype.Qu=function(){if(this.gu)try{this.gu.setItem(this.qu(this.clientId),String(Date.now()))}catch(t){Rr("Failed to set zombie client id.",t)}},Il.prototype.Ku=function(){if(this.gu)try{this.gu.removeItem(this.qu(this.clientId))}catch(t){}},Il.prototype.qu=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},Il);function Il(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this._n=i,this.window=o,this.document=s,this._u=a,this.fu=c,this.du=null,this.wu=!1,this.isPrimary=!1,this.networkEnabled=!0,this.mu=null,this.inForeground=!1,this.Tu=null,this.Eu=null,this.Iu=Number.NEGATIVE_INFINITY,this.Au=function(t){return Promise.resolve()},!Il.On())throw new Tr(Ir.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.ha=new Nl(this,r),this.Ru=e+"main",this.serializer=new sh(u),this.Pu=new Na(this.Ru,11,new Uh(this.serializer)),this.eo=new fl(this.ha,this.serializer),this.ho=new al,this.uo=(e=this.serializer,u=this.ho,new Ah(e,u)),this.yu=new il(this.serializer),this.window&&this.window.localStorage?this.gu=this.window.localStorage:(this.gu=null,!1===c&&Rr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function Tl(t,e){var n=this;return(n=ml.call(this)||this).ya=t,n.lu=e,n}function _l(t){return El.Un(t,Vh.store)}function Al(t){return El.Un(t,tl.store)}var Nl=(Sl.prototype.ea=function(t){var n=this.Zu(t);return this.db.zu().ru(t).next(function(e){return n.next(function(t){return e+t})})},Sl.prototype.Zu=function(t){var e=0;return this.sa(t,function(t){e++}).next(function(){return e})},Sl.prototype.De=function(t,e){return this.db.zu().De(t,e)},Sl.prototype.sa=function(t,n){return this.tc(t,function(t,e){return n(e)})},Sl.prototype.au=function(t,e,n){return Dl(t,n)},Sl.prototype.cu=function(t,e,n){return Dl(t,n)},Sl.prototype.ia=function(t,e,n){return this.db.zu().ia(t,e,n)},Sl.prototype.Va=Dl,Sl.prototype.ec=function(t,e){return r=e,i=!1,Th(n=t).rs(function(t){return wh(n,t,r).next(function(t){return t&&(i=!0),Aa.resolve(!t)})}).next(function(){return i});var n,r,i},Sl.prototype.ra=function(n,r){var i=this,o=this.db.Hu().Jr(),s=[],u=0;return this.tc(n,function(e,t){t<=r&&(t=i.ec(n,e).next(function(t){if(!t)return u++,o.Vr(n,e).next(function(){return o.gr(e),gl(n).delete([0,rh(e.path)])})}),s.push(t))}).next(function(){return Aa.$n(s)}).next(function(){return o.apply(n)}).next(function(){return u})},Sl.prototype.removeTarget=function(t,e){return e=e.nt(t.lu),this.db.zu().su(t,e)},Sl.prototype.nc=Dl,Sl.prototype.tc=function(t,r){var i,t=gl(t),o=ic.oi;return t.ss({index:Yh.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==ic.oi&&r(new qr(oh(i)),o),o=e,i=t):o=ic.oi}).next(function(){o!==ic.oi&&r(new qr(oh(i)),o)})},Sl.prototype.aa=function(t){return this.db.Hu().ka(t)},Sl);function Sl(t,e){this.db=t,this.zo=new th(this,e)}function Dl(t,e){return gl(t).put((t=t.lu,new Yh(0,rh(e.path),t)))}function Rl(t,e){var n=t.projectId;return t.W||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Ol=(xl.prototype.Xo=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.oa(t,n.ic)})},xl);function xl(t,e,n,r){this.persistence=t,this.sc=e,this.serializer=r,this.ic=new Xi(di),this.rc=new Si(ji,Gi),this.oc=Ri.min(),this.co=t.Gu(n),this.Yr=t.Hu(),this.eo=t.zu(),this.io=new Gc(this.Yr,this.co,this.persistence.Ju()),this.yu=t.Yu(),this.sc.ac(this.io)}function Ll(t,e,n,r){return new Ol(t,e,n,r)}function kl(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.eo.Ya(t)})}function Pl(t,s,e,u,a){var n=ho();return e.forEach(function(t){return n=n.add(t)}),s.getEntries(t,n).next(function(i){var o=io;return e.forEach(function(t,e){var n=i.get(t),r=(null==a?void 0:a.get(t))||u;e instanceof Tu&&e.version.isEqual(Ri.min())?(s.gr(t,r),o=o.rt(t,e)):null==n||0<e.version.L(n.version)||0===e.version.L(n.version)&&n.hasPendingWrites?(s.Rr(e,r),o=o.rt(t,e)):Dr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o})}function Ul(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.eo.ou(e,r).next(function(t){return t?(n=t,Aa.resolve(n)):i.eo.za(e).next(function(t){return n=new Ki(r,t,0,e.lu),i.eo.tu(e,n).next(function(){return n})})})}).then(function(t){var e=i.ic.get(t.targetId);return(null===e||0<t.et.L(e.et))&&(i.ic=i.ic.rt(t.targetId,t),i.rc.set(r,t.targetId)),t})}function Cl(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).ic.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.ha.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Pa(r=t.sent()))throw r;return Dr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.ic=e.ic.remove(o),e.rc.delete(n.target),[2]}})})}function Vl(t,o,s){var u=t,a=Ri.min(),c=ho();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=Vu(o),(void 0!==(t=(i=t).rc.get(r))?Aa.resolve(i.ic.get(t)):i.eo.ou(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.eo.hu(e,t.targetId).next(function(t){c=t})}).next(function(){return u.sc.Eo(e,o,s?a:Ri.min(),s?c:ho())}).next(function(t){return{documents:t,uc:c}});var t,n,r,i})}function Ml(t,e){var n=t,r=n.eo;return(t=n.ic.get(e))?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.qe(t,e).next(function(t){return t?t.target:null})})}function Fl(t){var s=t;return s.persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.Yr,n=t,t=s.oc,r=e,i=io,o=ch(t),t=Oh(n),n=IDBKeyRange.lowerBound(o,!0),t.ss({index:Hh.readTimeIndex,range:n},function(t,e){var n=uh(r.serializer,e);i=i.rt(n.key,n),o=e.readTime}).next(function(){return{Wr:i,readTime:hh(o)}});var e,n,r,i,o}).then(function(t){var e=t.Wr,t=t.readTime;return s.oc=t,e})}function jl(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Ir.FAILED_PRECONDITION||e.message!==jc)throw e;return Dr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Gl(t,e){this.user=e,this.type="OAuth",this.Ac={},this.Ac.Authorization="Bearer "+t}function ql(t,e,n,r,i){var o=this;this.Kr=t,this.Rh=e,this.os=n,this.Ph={},this.yh=[],this.gh=new Map,this.Vh=new Set,this.ph=[],this.bh=i,this.bh.Sh(function(t){n.ds(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Tf(this)?(Dr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Vh.add(4),[4,yf(e)];case 1:return t.sent(),e.Dh.set("Unknown"),e.Vh.delete(4),[4,df(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Dh=new ef(n,r)}var Bl,zl,Kl,Ql=(pf.prototype.m=function(){return this.cc.m()},pf.prototype.au=function(t,e){e=new Hl(t,e),this.cc=this.cc.add(e),this.lc=this.lc.add(e)},pf.prototype.fc=function(t,e){var n=this;t.forEach(function(t){return n.au(t,e)})},pf.prototype.cu=function(t,e){this.dc(new Hl(t,e))},pf.prototype.wc=function(t,e){var n=this;t.forEach(function(t){return n.cu(t,e)})},pf.prototype.mc=function(t){var e=this,n=new qr(new Fr([])),r=new Hl(n,t),t=new Hl(n,t+1),i=[];return this.lc.Nt([r,t],function(t){e.dc(t),i.push(t.key)}),i},pf.prototype.Tc=function(){var e=this;this.cc.forEach(function(t){return e.dc(t)})},pf.prototype.dc=function(t){this.cc=this.cc.delete(t),this.lc=this.lc.delete(t)},pf.prototype.Ec=function(t){var e=new qr(new Fr([])),n=new Hl(e,t),t=new Hl(e,t+1),r=ho();return this.lc.Nt([n,t],function(t){r=r.add(t.key)}),r},pf.prototype.ba=function(t){var e=new Hl(t,0);return null!==(e=this.cc.$t(e))&&t.isEqual(e.key)},pf),Hl=(ff.hc=function(t,e){return qr.i(t.key,e.key)||di(t.Ic,e.Ic)},ff._c=function(t,e){return di(t.Ic,e.Ic)||qr.i(t.key,e.key)},ff),Wl=(lf.prototype.getToken=function(){return Promise.resolve(null)},lf.prototype.Pc=function(){},lf.prototype.yc=function(t){(this.Rc=t)(ec.UNAUTHENTICATED)},lf.prototype.gc=function(){this.Rc=null},lf),Xl=(hf.prototype.getToken=function(){var e=this,n=this.vc,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.vc!==n?(Dr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(kr("string"==typeof t.accessToken),new Gl(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},hf.prototype.Pc=function(){this.forceRefresh=!0},hf.prototype.yc=function(t){this.Rc=t,this.bc&&t(this.currentUser)},hf.prototype.gc=function(){this.auth&&this.auth.removeAuthTokenListener(this.Vc),this.Vc=null,this.Rc=null},hf.prototype.Sc=function(){var t=this.auth&&this.auth.getUid();return kr(null===t||"string"==typeof t),new ec(t)},hf),Yl=(Object.defineProperty(cf.prototype,"Ac",{get:function(){var t={"X-Goog-AuthUser":this.Cc},e=this.Dc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),cf),Jl=(af.prototype.getToken=function(){return Promise.resolve(new Yl(this.Dc,this.Cc))},af.prototype.yc=function(t){t(ec.ei)},af.prototype.gc=function(){},af.prototype.Pc=function(){},af),be=(uf.prototype.Mc=function(){return 1===this.state||2===this.state||4===this.state},uf.prototype.Oc=function(){return 2===this.state},uf.prototype.start=function(){3!==this.state?this.auth():this.Lc()},uf.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Mc()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},uf.prototype.Bc=function(){this.state=0,this.ys.reset()},uf.prototype.qc=function(){var t=this;this.Oc()&&null===this.kc&&(this.kc=this._n.yn(this.Nc,6e4,function(){return t.Uc()}))},uf.prototype.Qc=function(t){this.Wc(),this.stream.send(t)},uf.prototype.Uc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.Oc()?[2,this.close(0)]:[2]})})},uf.prototype.Wc=function(){this.kc&&(this.kc.cancel(),this.kc=null)},uf.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Wc(),this.ys.cancel(),this.xc++,3!==e?this.ys.reset():n&&n.code===Ir.RESOURCE_EXHAUSTED?(Rr(n.toString()),Rr("Using maximum backoff delay to prevent overloading the backend."),this.ys.An()):n&&n.code===Ir.UNAUTHENTICATED&&this.$c.Pc(),null!==this.stream&&(this.jc(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Kc(n)];case 1:return t.sent(),[2]}})})},uf.prototype.jc=function(){},uf.prototype.auth=function(){var n=this;this.state=1;var t=this.Gc(this.xc),e=this.xc;this.$c.getToken().then(function(t){n.xc===e&&n.zc(t)},function(e){t(function(){var t=new Tr(Ir.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Hc(t)})})},uf.prototype.zc=function(t){var e=this,n=this.Gc(this.xc);this.stream=this.Jc(t),this.stream.Yc(function(){n(function(){return e.state=2,e.listener.Yc()})}),this.stream.Kc(function(t){n(function(){return e.Hc(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},uf.prototype.Lc=function(){var t=this;this.state=4,this.ys.Rn(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},uf.prototype.Hc=function(t){return Dr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},uf.prototype.Gc=function(e){var n=this;return function(t){n._n.ds(function(){return n.xc===e?t():(Dr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},uf),Zl=(n(sf,Kl=be),sf.prototype.Jc=function(t){return this.Fc.Xc("Listen",t)},sf.prototype.onMessage=function(t){this.ys.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Lr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Ue?(kr(void 0===o||"string"==typeof o),gi.fromBase64String(o||"")):(kr(void 0===o||o instanceof Uint8Array),gi.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Ir.UNKNOWN:Wi(s.code),new Tr(o,s.message||"")),r=new bo(n,r,i,s||null)}else if("documentChange"in e){e.documentChange,(a=e.documentChange).document,a.document.name,a.document.updateTime;var i=as(t,a.document.name),u=is(a.document.updateTime),s=new pu({mapValue:{fields:a.document.fields}}),u=new Iu(i,u,s,{}),s=a.targetIds||[],a=a.removedTargetIds||[];r=new mo(s,a,u.key,u)}else if("documentDelete"in e){e.documentDelete,(a=e.documentDelete).document;var u=as(t,a.document),c=a.readTime?is(a.readTime):Ri.min(),c=new Tu(u,c),a=a.removedTargetIds||[];r=new mo([],a,c.key,c)}else if("documentRemove"in e){e.documentRemove,(c=e.documentRemove).document;var h=as(t,c.document),c=c.removedTargetIds||[];r=new mo([],c,h,null)}else{if(!("filter"in e))return Lr();e.filter,(h=e.filter).targetId,e=new Bi(e=h.count||0),h=h.targetId,r=new wo(h,e)}return r}(this.serializer,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?Ri.min():is(e.readTime);return this.listener.Zc(n,t)},sf.prototype.th=function(t){var e,n,r,i,o={};o.database=ls(this.serializer),o.addTarget=(e=this.serializer,(r=qi(r=(n=t).target)?{documents:gs(e,r)}:{query:ms(e,r)}).targetId=n.targetId,0<n.resumeToken.O()?r.resumeToken=rs(e,n.resumeToken):0<n.et.L(Ri.min())&&(r.readTime=ns(e,n.et.X())),r),(t=(this.serializer,i=t,null==(t=function(){switch(i.tt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Lr()}}())?null:{"goog-listen-tags":t}))&&(o.labels=t),this.Qc(o)},sf.prototype.eh=function(t){var e={};e.database=ls(this.serializer),e.removeTarget=t,this.Qc(e)},sf),$l=(n(of,zl=be),Object.defineProperty(of.prototype,"sh",{get:function(){return this.nh},enumerable:!1,configurable:!0}),of.prototype.start=function(){this.nh=!1,this.lastStreamToken=void 0,zl.prototype.start.call(this)},of.prototype.jc=function(){this.nh&&this.ih([])},of.prototype.Jc=function(t){return this.Fc.Xc("Write",t)},of.prototype.onMessage=function(t){if(kr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.nh){this.ys.reset();var e=(n=t.writeResults,i=t.commitTime,n&&0<n.length?(kr(void 0!==i),n.map(function(t){return n=i,(r=(e=t).updateTime?is(e.updateTime):is(n)).isEqual(Ri.min())&&(r=is(n)),n=null,e.transformResults&&0<e.transformResults.length&&(n=e.transformResults),new Ks(r,n);var e,n,r})):[]),n=is(t.commitTime);return this.listener.rh(n,e)}var i;return kr(!t.writeResults||0===t.writeResults.length),this.nh=!0,this.listener.oh()},of.prototype.ah=function(){var t={};t.database=ls(this.serializer),this.Qc(t)},of.prototype.ih=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return ys(e.serializer,t)})};this.Qc(t)},of),tf=(n(rf,Bl=function(){}),rf.prototype.hh=function(){if(this.uh)throw new Tr(Ir.FAILED_PRECONDITION,"The client has already been terminated.")},rf.prototype.lh=function(e,n,r){var i=this;return this.hh(),this.credentials.getToken().then(function(t){return i.Fc.lh(e,n,r,t)}).catch(function(t){throw t.code===Ir.UNAUTHENTICATED&&i.credentials.Pc(),t})},rf.prototype._h=function(e,n,r){var i=this;return this.hh(),this.credentials.getToken().then(function(t){return i.Fc._h(e,n,r,t)}).catch(function(t){throw t.code===Ir.UNAUTHENTICATED&&i.credentials.Pc(),t})},rf.prototype.terminate=function(){this.uh=!1},rf),ef=(nf.prototype.mh=function(){var t=this;0===this.fh&&(this.Th("Unknown"),this.dh=this.os.yn("online_state_timeout",1e4,function(){return t.dh=null,t.Eh("Backend didn't respond within 10 seconds."),t.Th("Offline"),Promise.resolve()}))},nf.prototype.Ih=function(t){"Online"===this.state?this.Th("Unknown"):(this.fh++,1<=this.fh&&(this.Ah(),this.Eh("Connection failed 1 times. Most recent error: "+t.toString()),this.Th("Offline")))},nf.prototype.set=function(t){this.Ah(),this.fh=0,"Online"===t&&(this.wh=!1),this.Th(t)},nf.prototype.Th=function(t){t!==this.state&&(this.state=t,this.fi(t))},nf.prototype.Eh=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.wh?(Rr(t),this.wh=!1):Dr("OnlineStateTracker",t)},nf.prototype.Ah=function(){null!==this.dh&&(this.dh.cancel(),this.dh=null)},nf);function nf(t,e){this.os=t,this.fi=e,this.state="Unknown",this.fh=0,this.dh=null,this.wh=!0}function rf(t,e,n){var r=this;return(r=Bl.call(this)||this).credentials=t,r.Fc=e,r.serializer=n,r.uh=!1,r}function of(t,e,n,r,i){var o=this;return(o=zl.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.nh=!1,o}function sf(t,e,n,r,i){var o=this;return(o=Kl.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function uf(t,e,n,r,i,o){this._n=t,this.Nc=n,this.Fc=r,this.$c=i,this.listener=o,this.state=0,this.xc=0,this.kc=null,this.stream=null,this.ys=new _a(t,e)}function af(t,e){this.Dc=t,this.Cc=e}function cf(t,e){this.Dc=t,this.Cc=e,this.type="FirstParty",this.user=ec.ei}function hf(t){var e=this;this.Vc=null,this.currentUser=ec.UNAUTHENTICATED,this.bc=!1,this.vc=0,this.Rc=null,this.forceRefresh=!1,this.Vc=function(){e.vc++,e.currentUser=e.Sc(),e.bc=!0,e.Rc&&e.Rc(e.currentUser)},this.vc=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Vc):(this.Vc(null),t.get().then(function(t){e.auth=t,e.Vc&&e.auth.addAuthTokenListener(e.Vc)},function(){}))}function lf(){this.Rc=null}function ff(t,e){this.key=t,this.Ic=e}function pf(){this.cc=new no(Hl.hc),this.lc=new no(Hl._c)}function df(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!Tf(r))return[3,4];e=0,n=r.ph,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function yf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.ph,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function vf(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Dr("RemoteStore","RemoteStore shutting down."),e.Vh.add(5),[4,yf(e)];case 1:return t.sent(),e.bh.Di(),e.Dh.set("Unknown"),[2]}})})}function gf(t,e){t.gh.has(e.targetId)||(t.gh.set(e.targetId,e),If(t)?Ef(t):xf(t).Oc()&&wf(t,e))}function mf(t,e){var n=t,t=xf(n);n.gh.delete(e),t.Oc()&&bf(n,e),0===n.gh.size&&(t.Oc()?t.qc():Tf(n)&&n.Dh.set("Unknown"))}function wf(t,e){t.Ch.Ee(e.targetId),xf(t).th(e)}function bf(t,e){t.Ch.Ee(e),xf(t).eh(e)}function Ef(e){e.Ch=new Io({Be:function(t){return e.Ph.Be(t)},qe:function(t){return e.gh.get(t)||null}}),xf(e).start(),e.Dh.mh()}function If(t){return Tf(t)&&!xf(t).Mc()&&0<t.gh.size}function Tf(t){return 0===t.Vh.size}function _f(t){t.Ch=void 0}function Af(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!Pa(r))throw r;return n.Vh.add(1),[4,yf(n)];case 1:return t.sent(),n.Dh.set("Offline"),i=i||function(){return kl(n.Kr)},n.os.Ds(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Dr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Vh.delete(1),[4,df(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function Nf(e,n){return n().catch(function(t){return Af(e,t,n)})}function Sf(h){return y(this,void 0,void 0,function(){var s,u,a,c;return v(this,function(t){switch(t.label){case 0:u=Lf(s=h),a=0<s.yh.length?s.yh[s.yh.length-1].batchId:-1,t.label=1;case 1:if(!(Tf(s)&&s.yh.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(r=s.Kr,i=a,(o=r).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===i&&(i=-1),o.co.Ea(t,i)}))];case 3:return null===(c=t.sent())?(0===s.yh.length&&u.qc(),[3,7]):(a=c.batchId,n=c,(e=s).yh.push(n),(e=Lf(e)).Oc()&&e.sh&&e.ih(n.mutations),[3,6]);case 4:return c=t.sent(),[4,Af(s,c)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Df(s)&&Rf(s),[2]}var e,n,r,i,o})})}function Df(t){return Tf(t)&&!Lf(t).Mc()&&0<t.yh.length}function Rf(t){Lf(t).start()}function Of(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Vh.delete(2),[4,df(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Vh.add(2),[4,yf(e)]);case 3:t.sent(),e.Dh.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function xf(n){var t,e,r,i=this;return n.kh||(n.kh=(t=n.Rh,e=n.os,r={Yc:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.gh.forEach(function(t,e){wf(n,t)}),[2]})})}.bind(null,n),Kc:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return _f(e),If(e)?(e.Dh.Ih(n),Ef(e)):e.Dh.set("Unknown"),[2]})})}.bind(null,n),Zc:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Dh.set("Online"),!(u instanceof bo&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.gh.has(i)?[4,o.Ph.Nh(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.gh.delete(i),o.Ch.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Dr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,Af(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof mo?s.Ch.pe(u):u instanceof wo?s.Ch.$e(u):s.Ch.Se(u),a.isEqual(Ri.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,kl(s.Kr)];case 8:return o=t.sent(),0<=a.L(o)?[4,(i=a,(e=(r=s).Ch.Me(i)).Gt.forEach(function(t,e){var n;0<t.resumeToken.O()&&(n=r.gh.get(e))&&r.gh.set(e,n.st(t.resumeToken,i))}),e.zt.forEach(function(t){var e=r.gh.get(t);e&&(r.gh.set(t,e.st(gi.B,e.et)),bf(r,t),e=new Ki(e.target,t,1,e.sequenceNumber),wf(r,e))}),r.Ph.Fh(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Dr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,Af(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},t.hh(),new Zl(e,t.Fc,t.credentials,t.serializer,r)),n.ph.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.kh.Bc(),If(n)?Ef(n):n.Dh.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.kh.stop()];case 2:t.sent(),_f(n),t.label=3;case 3:return[2]}})})})),n.kh}function Lf(n){var t,e,r,i=this;return n.Mh||(n.Mh=(t=n.Rh,e=n.os,r={Yc:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Lf(e).ah(),[2]})})}.bind(null,n),Kc:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Lf(e).sh?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Hi(n=i.code)&&n!==Ir.ABORTED?(e=r.yh.shift(),Lf(r).Bc(),[4,Nf(r,function(){return r.Ph.xh(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,Sf(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Df(e)&&Rf(e),[2]}})})}.bind(null,n),oh:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Lf(o),n=0,r=o.yh;n<r.length;n++)i=r[n],e.ih(i.mutations);return[2]})})}.bind(null,n),rh:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.yh.shift(),n=gc.from(e,i,o),[4,Nf(r,function(){return r.Ph.$h(n)})];case 1:return t.sent(),[4,Sf(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.hh(),new $l(e,t.Fc,t.credentials,t.serializer,r)),n.ph.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Mh.Bc(),[4,Sf(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Mh.stop()];case 3:t.sent(),0<n.yh.length&&(Dr("RemoteStore","Stopping write stream with "+n.yh.length+" pending writes"),n.yh=[]),t.label=4;case 4:return[2]}})})})),n.Mh}var kf=function(t){this.key=t},Pf=function(t){this.key=t},Uf=(Object.defineProperty(jf.prototype,"Qh",{get:function(){return this.Oh},enumerable:!1,configurable:!0}),jf.prototype.Wh=function(t,e){var s=this,u=e?e.jh:new po,a=(e||this).Uh,c=(e||this).Qt,h=a,l=!1,f=xu(this.query)&&a.size===this.query.limit?a.last():null,p=Lu(this.query)&&a.size===this.query.limit?a.first():null;if(t.ct(function(t,e){var n=a.get(t),r=(r=e instanceof Iu?e:null)&&(zu(s.query,r)?r:null),i=!!n&&s.Qt.has(n.key),o=!!r&&(r.Je||s.Qt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.Kh(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.qh(r,f)||p&&s.qh(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),xu(this.query)||Lu(this.query))for(;h.size>this.query.limit;){var n=xu(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{Uh:h,jh:u,Gh:l,Qt:c}},jf.prototype.Kh=function(t,e){return t.Je&&e.hasCommittedMutations&&!e.Je},jf.prototype.vr=function(t,e,n){var o=this,r=this.Uh;this.Uh=t.Uh,this.Qt=t.Qt;var i=t.jh.qt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.qh(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Lr()}}var r,i}),this.zh(n);var s=e?this.Hh():[],e=(n=0===this.Bh.size&&this.Zt?1:0)!==this.Lh;return this.Lh=n,0!==i.length||e?{snapshot:new yo(this.query,t.Uh,r,i,t.Qt,0==n,e,!1),Jh:s}:{Jh:s}},jf.prototype.Us=function(t){return this.Zt&&"Offline"===t?(this.Zt=!1,this.vr({Uh:this.Uh,jh:new po,Qt:this.Qt,Gh:!1},!1)):{Jh:[]}},jf.prototype.Yh=function(t){return!this.Oh.has(t)&&!!this.Uh.has(t)&&!this.Uh.get(t).Je},jf.prototype.zh=function(t){var e=this;t&&(t.te.forEach(function(t){return e.Oh=e.Oh.add(t)}),t.ee.forEach(function(t){}),t.ne.forEach(function(t){return e.Oh=e.Oh.delete(t)}),this.Zt=t.Zt)},jf.prototype.Hh=function(){var e=this;if(!this.Zt)return[];var n=this.Bh;this.Bh=ho(),this.Uh.forEach(function(t){e.Yh(t.key)&&(e.Bh=e.Bh.add(t.key))});var r=[];return n.forEach(function(t){e.Bh.has(t)||r.push(new Pf(t))}),this.Bh.forEach(function(t){n.has(t)||r.push(new kf(t))}),r},jf.prototype.Xh=function(t){return this.Oh=t.uc,this.Bh=ho(),t=this.Wh(t.documents),this.vr(t,!0)},jf.prototype.Zh=function(){return yo.Kt(this.query,this.Uh,this.Qt,0===this.Lh)},jf),Cf=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Vf=function(t){this.key=t,this.tl=!1},Mf=(Object.defineProperty(Ff.prototype,"ml",{get:function(){return!0===this.wl},enumerable:!1,configurable:!0}),Ff);function Ff(t,e,n,r,i,o){this.Kr=t,this.el=e,this.nl=n,this.sl=r,this.currentUser=i,this.il=o,this.rl={},this.ol=new Si(qu,Gu),this.al=new Map,this.ul=[],this.cl=new Xi(qr.i),this.hl=new Map,this.ll=new Ql,this._l={},this.fl=new Map,this.dl=ll.Ga(),this.onlineState="Unknown",this.wl=void 0}function jf(t,e){this.query=t,this.Oh=e,this.Lh=null,this.Zt=!1,this.Bh=ho(),this.Qt=ho(),this.qh=Ku(t),this.Uh=new fo(this.qh)}function Gf(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Tl=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.Wh(o)).Gh?[4,Vl(r.Kr,i.query,!1).then(function(t){return t=t.documents,i.view.Wh(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.Gt.get(i.targetId),n=i.view.vr(e,r.ml,n),[2,(Wf(r,i.targetId,n.Jh),n.snapshot)]}})})}(i,t,e,n)},[4,Vl(i.Kr,o,!0)];case 1:return n=t.sent(),r=new Uf(o,n.uc),e=r.Wh(n.documents),n=go.Xt(s,u&&"Offline"!==i.onlineState),n=r.vr(e,i.ml,n),Wf(i,s,n.Jh),r=new Cf(o,s,r),[2,(i.ol.set(o,r),i.al.has(s)?i.al.get(s).push(o):i.al.set(s,[o]),n.snapshot)]}})})}function qf(o,s){return y(this,void 0,void 0,function(){var n,i;return v(this,function(t){switch(t.label){case 0:n=o,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Kr,a=e,c=(r=s).et,h=a.ic,a.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=a.Yr.Jr({Xr:!0});h=a.ic;var u=[];r.Gt.forEach(function(t,e){var n,r,i,o=h.get(e);o&&(u.push(a.eo.uu(s,t.ne,e).next(function(){return a.eo.no(s,t.te,e)})),0<(i=t.resumeToken).O()&&(n=o.st(i,c).nt(s.lu),h=h.rt(e,n),r=o,i=t,kr(0<(o=n).resumeToken.O()),(0===r.resumeToken.O()||3e8<=o.et.Y()-r.et.Y()||0<i.te.size+i.ee.size+i.ne.size)&&u.push(a.eo.su(s,n))))});var e,n=io;return r.Ht.forEach(function(t,e){r.Jt.has(t)&&u.push(a.persistence.ha.nc(s,t))}),u.push(Pl(s,t,r.Ht,c,void 0).next(function(t){n=t})),c.isEqual(Ri.min())||(e=a.eo.Ya(s).next(function(t){return a.eo.Za(s,s.lu,c)}),u.push(e)),Aa.$n(u).next(function(){return t.apply(s)}).next(function(){return a.io.so(s,n)})}).then(function(t){return a.ic=h,t}))];case 2:return i=t.sent(),s.Gt.forEach(function(t,e){(e=n.hl.get(e))&&(kr(t.te.size+t.ee.size+t.ne.size<=1),0<t.te.size?e.tl=!0:0<t.ee.size?kr(e.tl):0<t.ne.size&&(kr(e.tl),e.tl=!1))}),[4,Yf(n,i,s)];case 3:return t.sent(),[3,6];case 4:return[4,jl(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,a,c,h})})}function Bf(t,n,e){var r;((t=t).ml&&0===e||!t.ml&&1===e)&&(r=[],t.ol.forEach(function(t,e){(e=e.view.Us(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.Ls.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Us(i)&&(o=!0)}),o&&$a(t)}(t.nl,n),r.length&&t.rl.Zc(r),t.onlineState=n,t.ml&&t.sl.Ki(n))}function zf(t,e){(t.fl.get(e)||[]).forEach(function(t){t.resolve()}),t.fl.delete(e)}function Kf(t,e,n){var r=t,i=r._l[r.currentUser.Zs()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r._l[r.currentUser.Zs()]=i)}function Qf(e,t,n){void 0===n&&(n=null),e.sl.Bi(t);for(var r=0,i=e.al.get(t);r<i.length;r++){var o=i[r];e.ol.delete(o),n&&e.rl.El(o,n)}e.al.delete(t),e.ml&&e.ll.mc(t).forEach(function(t){e.ll.ba(t)||Hf(e,t)})}function Hf(t,e){var n=t.cl.get(e);null!==n&&(mf(t.el,n),t.cl=t.cl.remove(e),t.hl.delete(n),Xf(t))}function Wf(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof kf?(t.ll.au(u.key,e),r=t,i=(i=u).key,r.cl.get(i)||(Dr("SyncEngine","New document in limbo: "+i),r.ul.push(i),Xf(r))):u instanceof Pf?(Dr("SyncEngine","Document no longer in limbo: "+u.key),t.ll.cu(u.key,e),t.ll.ba(u.key)||Hf(t,u.key)):Lr()}}function Xf(t){for(;0<t.ul.length&&t.cl.size<t.il;){var e=t.ul.shift(),n=t.dl.next();t.hl.set(n,new Vf(e)),t.cl=t.cl.rt(e,n),gf(t.el,new Ki(Vu(Ou(e.path)),n,2,ic.oi))}}function Yf(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).ol.m()?[3,3]:(n.ol.forEach(function(t,e){o.push(n.Tl(e,s,u).then(function(t){t&&(n.ml&&n.sl.Qi(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=qc.vo(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.rl.Zc(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Aa.forEach(c,function(e){return Aa.forEach(e.po,function(t){return r.persistence.ha.au(n,e.targetId,t)}).next(function(){return Aa.forEach(e.bo,function(t){return r.persistence.ha.cu(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Pa(e=t.sent()))throw e;return Dr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.ic.get(o),u=s.et,u=s.it(u),r.ic=r.ic.rt(o,u));return[2]}})})}(n.Kr,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function Jf(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,l,f;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.al.get(s))&&0!==a.length?[4,Ul(e.Kr,Vu(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(l=h[c],l=e.ol.get(l),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Vl((e=r).Kr,i.query,!0)];case 1:return n=t.sent(),n=i.view.Xh(n),[2,(e.ml&&Wf(e,i.targetId,n.Jh),n)]}})})}(e,l)]):[3,6];case 4:(l=t.sent()).snapshot&&r.push(l.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,Ml(e.Kr,s)];case 8:return f=t.sent(),[4,Ul(e.Kr,f)];case 9:return u=t.sent(),[4,Gf(e,Zf(f),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.rl.Zc(r),n)]}})})}function Zf(t){return Ru(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function $f(t){return t.el.Ph.Fh=qf.bind(null,t),t.el.Ph.Be=function(t,e){var n=t;if((t=n.hl.get(e))&&t.tl)return ho().add(t.key);var r=ho();if(!(e=n.al.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.ol.get(s),r=r.xt(s.view.Qh);return r}.bind(null,t),t.el.Ph.Nh=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).sl.Qi(s,"rejected",u),i=e.hl.get(s),(n=i&&i.key)?(r=(r=new Xi(qr.i)).rt(n,new Tu(n,Ri.min())),i=ho().add(n),i=new vo(Ri.min(),new Map,new no(di),r,i),[4,qf(e,i)]):[3,2];case 1:return t.sent(),e.cl=e.cl.remove(n),e.hl.delete(s),Xf(e),[3,4];case 2:return[4,Cl(e.Kr,s,!1).then(function(){return Qf(e,s,u)}).catch(jl)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.rl.Zc=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.Ls.get(u)){for(var a=0,c=u.listeners;a<c.length;a++)c[a].Qs(s)&&(r=!0);u.Os=s}}r&&$a(n)}.bind(null,t.nl),t.rl.El=function(t,e,n){var r=t;if(t=r.Ls.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.Ls.delete(e)}.bind(null,t.nl),t}function tp(t){return t.el.Ph.$h=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Kr,h=s,(l=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=h.batch.keys(),n=l.Yr.Jr({Xr:!0}),i=l,o=t,s=n,u=(r=h).batch,a=u.keys(),c=Aa.resolve();return a.forEach(function(n){c=c.next(function(){return s.Vr(o,n)}).next(function(t){var e=t;kr(null!==(t=r.Tr.get(n))),(!e||e.version.L(t)<0)&&(e=u.lr(n,e,r))&&s.Rr(e,r.mr)})}),c.next(function(){return i.co.Pa(o,u)}).next(function(){return n.apply(t)}).next(function(){return l.co.pa(t)}).next(function(){return l.io.mo(t,e)})}))];case 2:return i=t.sent(),Kf(n,r,null),zf(n,r),n.sl.ki(r,"acknowledged"),[4,Yf(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,jl(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,h,l})})}.bind(null,t),t.el.Ph.xh=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Kr,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.co.ma(e,r).next(function(t){return kr(null!==t),n=t.keys(),i.co.Pa(e,t)}).next(function(){return i.co.pa(e)}).next(function(){return i.io.mo(e,n)})}))];case 2:return o=t.sent(),Kf(n,u,a),zf(n,u),n.sl.ki(u,"rejected",a),[4,Yf(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,jl(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,t),t}var ep,np,rp,ip,op,sp,up,ap=(Zp.prototype.ac=function(t){this.Vl=t},Zp.prototype.Eo=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.rn.length||1===r.rn.length&&r.rn[0].field.p())||i.isEqual(Ri.min())?this.pl(e,r):this.Vl.mo(e,o).next(function(t){var n=s.bl(r,t);return(xu(r)||Lu(r))&&s.Gh(r.on,n,o,i)?s.pl(e,r):(Sr()<=f.DEBUG&&Dr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Bu(r)),s.Vl.Eo(e,r,i).next(function(e){return n.forEach(function(t){e=e.rt(t.key,t)}),e}))})},Zp.prototype.bl=function(n,t){var r=new no(Ku(n));return t.forEach(function(t,e){e instanceof Iu&&zu(n,e)&&(r=r.add(e))}),r},Zp.prototype.Gh=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.L(r))},Zp.prototype.pl=function(t,e){return Sr()<=f.DEBUG&&Dr("IndexFreeQueryEngine","Using full collection scan to execute query:",Bu(e)),this.Vl.Eo(t,e,Ri.min())},Zp),cp=(Jp.prototype.fa=function(t){return Aa.resolve(0===this.co.length)},Jp.prototype.da=function(t,e,n,r){var i=this.vl;this.vl++,0<this.co.length&&this.co[this.co.length-1],n=new vc(i,e,n,r),this.co.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Sl=this.Sl.add(new Hl(u.key,i)),this.ho.wa(t,u.key.path.h())}return Aa.resolve(n)},Jp.prototype.ma=function(t,e){return Aa.resolve(this.Dl(e))},Jp.prototype.Ea=function(t,e){return e+=1,e=(e=this.Cl(e))<0?0:e,Aa.resolve(this.co.length>e?this.co[e]:null)},Jp.prototype.Ia=function(){return Aa.resolve(0===this.co.length?-1:this.vl-1)},Jp.prototype.Aa=function(t){return Aa.resolve(this.co.slice())},Jp.prototype._o=function(t,e){var n=this,r=new Hl(e,0),e=new Hl(e,Number.POSITIVE_INFINITY),i=[];return this.Sl.Nt([r,e],function(t){t=n.Dl(t.Ic),i.push(t)}),Aa.resolve(i)},Jp.prototype.To=function(t,e){var n=this,r=new no(di);return e.forEach(function(t){var e=new Hl(t,0),t=new Hl(t,Number.POSITIVE_INFINITY);n.Sl.Nt([e,t],function(t){r=r.add(t.Ic)})}),Aa.resolve(this.Nl(r))},Jp.prototype.yo=function(t,e){var n=e.path,r=n.length+1,e=n;qr.F(e)||(e=e.child(""));var e=new Hl(new qr(e),0),i=new no(di);return this.Sl.Ft(function(t){var e=t.key.path;return!!n.T(e)&&(e.length===r&&(i=i.add(t.Ic)),!0)},e),Aa.resolve(this.Nl(i))},Jp.prototype.Nl=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.Dl(t))&&n.push(t)}),n},Jp.prototype.Pa=function(n,r){var i=this;kr(0===this.Fl(r.batchId,"removed")),this.co.shift();var o=this.Sl;return Aa.forEach(r.mutations,function(t){var e=new Hl(t.key,r.batchId);return o=o.delete(e),i.ha.Va(n,t.key)}).next(function(){i.Sl=o})},Jp.prototype.ga=function(t){},Jp.prototype.ba=function(t,e){var n=new Hl(e,0),n=this.Sl.$t(n);return Aa.resolve(e.isEqual(n&&n.key))},Jp.prototype.pa=function(t){return this.co.length,Aa.resolve()},Jp.prototype.Fl=function(t,e){return this.Cl(t)},Jp.prototype.Cl=function(t){return 0===this.co.length?0:t-this.co[0].batchId},Jp.prototype.Dl=function(t){return(t=this.Cl(t))<0||t>=this.co.length?null:this.co[t]},Jp),hp=(Yp.prototype.Rr=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.$l(e);return this.docs=this.docs.rt(r,{yr:e,size:o,readTime:n}),this.size+=o-i,this.ho.wa(t,r.path.h())},Yp.prototype.gr=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Yp.prototype.Vr=function(t,e){return e=this.docs.get(e),Aa.resolve(e?e.yr:null)},Yp.prototype.getEntries=function(t,e){var n=this,r=io;return e.forEach(function(t){var e=n.docs.get(t);r=r.rt(t,e?e.yr:null)}),Aa.resolve(r)},Yp.prototype.Eo=function(t,e,n){for(var r=uo,i=new qr(e.path.child("")),o=this.docs._t(i);o.It();){var s=(u=o.Et()).key,u=(a=u.value).yr,a=a.readTime;if(!e.path.T(s.path))break;a.L(n)<=0||u instanceof Iu&&zu(e,u)&&(r=r.rt(u.key,u))}return Aa.resolve(r)},Yp.prototype.xl=function(t,e){return Aa.forEach(this.docs,function(t){return e(t)})},Yp.prototype.Jr=function(t){return new lp(this)},Yp.prototype.ka=function(t){return Aa.resolve(this.size)},Yp),lp=(n(Xp,up=h),Xp.prototype.vr=function(n){var r=this,i=[];return this.Er.forEach(function(t,e){e&&e.yr?i.push(r.Ma.Rr(n,e.yr,r.Ar(t))):r.Ma.gr(t)}),Aa.$n(i)},Xp.prototype.pr=function(t,e){return this.Ma.Vr(t,e)},Xp.prototype.br=function(t,e){return this.Ma.getEntries(t,e)},Xp),fp=(Wp.prototype.De=function(t,n){return this.kl.forEach(function(t,e){return n(e)}),Aa.resolve()},Wp.prototype.Ya=function(t){return Aa.resolve(this.lastRemoteSnapshotVersion)},Wp.prototype.Xa=function(t){return Aa.resolve(this.Ml)},Wp.prototype.za=function(t){return this.highestTargetId=this.Ll.next(),Aa.resolve(this.highestTargetId)},Wp.prototype.Za=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Ml&&(this.Ml=e),Aa.resolve()},Wp.prototype.eu=function(t){this.kl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Ll=new ll(e),this.highestTargetId=e),t.sequenceNumber>this.Ml&&(this.Ml=t.sequenceNumber)},Wp.prototype.tu=function(t,e){return this.eu(e),this.targetCount+=1,Aa.resolve()},Wp.prototype.su=function(t,e){return this.eu(e),Aa.resolve()},Wp.prototype.iu=function(t,e){return this.kl.delete(e.target),this.Ol.mc(e.targetId),--this.targetCount,Aa.resolve()},Wp.prototype.ia=function(n,r,i){var o=this,s=0,u=[];return this.kl.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.kl.delete(t),u.push(o.Zr(n,e.targetId)),s++)}),Aa.$n(u).next(function(){return s})},Wp.prototype.ru=function(t){return Aa.resolve(this.targetCount)},Wp.prototype.ou=function(t,e){return e=this.kl.get(e)||null,Aa.resolve(e)},Wp.prototype.no=function(t,e,n){return this.Ol.fc(e,n),Aa.resolve()},Wp.prototype.uu=function(e,t,n){this.Ol.wc(t,n);var r=this.persistence.ha,i=[];return r&&t.forEach(function(t){i.push(r.Va(e,t))}),Aa.$n(i)},Wp.prototype.Zr=function(t,e){return this.Ol.mc(e),Aa.resolve()},Wp.prototype.hu=function(t,e){return e=this.Ol.Ec(e),Aa.resolve(e)},Wp.prototype.ba=function(t,e){return Aa.resolve(this.Ol.ba(e))},Wp),pp=(Hp.prototype.Ba=function(t,e){return Aa.resolve(this.Bl.get(e))},Hp.prototype.qa=function(t,e){return this.Bl.set(e.id,{id:e.id,version:e.version,createTime:is(e.createTime)}),Aa.resolve()},Hp.prototype.Ua=function(t,e){return Aa.resolve(this.ql.get(e))},Hp.prototype.Qa=function(t,e){return this.ql.set(e.name,{name:(e=e).name,query:vh(e.bundledQuery),readTime:is(e.readTime)}),Aa.resolve()},Hp),dp=(Qp.prototype.start=function(){return Promise.resolve()},Qp.prototype.Di=function(){return this.wu=!1,Promise.resolve()},Object.defineProperty(Qp.prototype,"Ti",{get:function(){return this.wu},enumerable:!1,configurable:!0}),Qp.prototype.Du=function(){},Qp.prototype.Cu=function(){},Qp.prototype.Ju=function(){return this.ho},Qp.prototype.Gu=function(t){var e=this.Ul[t.Zs()];return e||(e=new cp(this.ho,this.ha),this.Ul[t.Zs()]=e),e},Qp.prototype.zu=function(){return this.eo},Qp.prototype.Hu=function(){return this.uo},Qp.prototype.Yu=function(){return this.yu},Qp.prototype.runTransaction=function(t,e,n){var r=this;Dr("MemoryPersistence","Starting transaction:",t);var i=new yp(this.du.next());return this.ha.Wl(),n(i).next(function(t){return r.ha.jl(i).next(function(){return t})}).Nn().then(function(t){return i.ao(),t})},Qp.prototype.Kl=function(e,n){return Aa.xn(Object.values(this.Ul).map(function(t){return function(){return t.ba(e,n)}}))},Qp),yp=(n(Kp,sp=Ee),Kp),vp=(zp.Hl=function(t){return new zp(t)},Object.defineProperty(zp.prototype,"Jl",{get:function(){if(this.zl)return this.zl;throw Lr()},enumerable:!1,configurable:!0}),zp.prototype.au=function(t,e,n){return this.Gl.au(n,e),this.Jl.delete(n.toString()),Aa.resolve()},zp.prototype.cu=function(t,e,n){return this.Gl.cu(n,e),this.Jl.add(n.toString()),Aa.resolve()},zp.prototype.Va=function(t,e){return this.Jl.add(e.toString()),Aa.resolve()},zp.prototype.removeTarget=function(t,e){var n=this;this.Gl.mc(e.targetId).forEach(function(t){return n.Jl.add(t.toString())});var r=this.persistence.zu();return r.hu(t,e.targetId).next(function(t){t.forEach(function(t){return n.Jl.add(t.toString())})}).next(function(){return r.iu(t,e)})},zp.prototype.Wl=function(){this.zl=new Set},zp.prototype.jl=function(n){var r=this,i=this.persistence.Hu().Jr();return Aa.forEach(this.Jl,function(t){var e=qr.D(t);return r.Yl(n,e).next(function(t){t||i.gr(e)})}).next(function(){return r.zl=null,i.apply(n)})},zp.prototype.nc=function(t,e){var n=this;return this.Yl(t,e).next(function(t){t?n.Jl.delete(e.toString()):n.Jl.add(e.toString())})},zp.prototype.Ql=function(t){return 0},zp.prototype.Yl=function(t,e){var n=this;return Aa.xn([function(){return Aa.resolve(n.Gl.ba(e))},function(){return n.persistence.zu().ba(t,e)},function(){return n.persistence.Kl(t,e)}])},zp),gp=(Bp.prototype.Yc=function(t){this.t_=t},Bp.prototype.Kc=function(t){this.e_=t},Bp.prototype.onMessage=function(t){this.n_=t},Bp.prototype.close=function(){this.Zl()},Bp.prototype.send=function(t){this.Xl(t)},Bp.prototype.s_=function(){this.t_()},Bp.prototype.i_=function(t){this.e_(t)},Bp.prototype.r_=function(t){this.n_(t)},Bp),mp={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},wp=(qp.prototype.lh=function(e,t,n,r){var i=this.c_(e,t);return Dr("RestConnection","Sending: ",i,n),t={},this.h_(t,r),this.l_(e,i,t,n).then(function(t){return Dr("RestConnection","Received: ",t),t},function(t){throw Or("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},qp.prototype._h=function(t,e,n,r){return this.lh(t,e,n,r)},qp.prototype.h_=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.22.1-alpha.01492c06e",t["Content-Type"]="text/plain",e)for(var n in e.Ac)e.Ac.hasOwnProperty(n)&&(t[n]=e.Ac[n])},qp.prototype.c_=function(t,e){return t=mp[t],this.a_+"/v1/"+e+":"+t},n(Gp,op=qp),Gp.prototype.l_=function(o,e,s,u){return new Promise(function(n,r){var i=new mr;i.listenOnce(vr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case yr.NO_ERROR:var t=i.getResponseJson();Dr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case yr.TIMEOUT:Dr("Connection",'RPC "'+o+'" timed out'),r(new Tr(Ir.DEADLINE_EXCEEDED,"Request time out"));break;case yr.HTTP_ERROR:var e=i.getStatus();Dr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Ir).indexOf(e)?e:Ir.UNKNOWN,r(new Tr(e,t.message))):r(new Tr(Ir.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Tr(Ir.UNAVAILABLE,"Connection failed."));break;default:Lr()}}finally{Dr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Gp.prototype.Xc=function(t,e){var n,r=[this.a_,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=dr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.U.projectId+"/databases/"+this.U.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.h_(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),Dr("Connection","Creating WebChannel: "+(r=r.join("")),t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new gp({Xl:function(t){u?Dr("Connection","Not sending because WebChannel is closed:",t):(s||(Dr("Connection","Opening WebChannel transport."),o.open(),s=!0),Dr("Connection","WebChannel sending:",t),o.send(t))},Zl:function(){return o.close()}});return(t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})})(gr.EventType.OPEN,function(){u||Dr("Connection","WebChannel transport opened.")}),t(gr.EventType.CLOSE,function(){u||(u=!0,Dr("Connection","WebChannel transport closed"),a.i_())}),t(gr.EventType.ERROR,function(t){u||(u=!0,Or("Connection","WebChannel transport errored:",t),a.i_(new Tr(Ir.UNAVAILABLE,"The operation could not be completed")))}),t(gr.EventType.MESSAGE,function(t){var e,n,r,i;u||(kr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Dr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=zi[r];if(void 0!==t)return Wi(t)}(),i=n.message,void 0===t&&(t=Ir.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.i_(new Tr(t,i)),o.close()):(Dr("Connection","WebChannel received:",e),a.r_(e)))}),setTimeout(function(){a.s_()},0),a},Gp),bp=(jp.prototype.Sh=function(t){this.m_.push(t)},jp.prototype.Di=function(){window.removeEventListener("online",this.__),window.removeEventListener("offline",this.d_)},jp.prototype.T_=function(){window.addEventListener("online",this.__),window.addEventListener("offline",this.d_)},jp.prototype.f_=function(){Dr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.m_;t<e.length;t++)(0,e[t])(0)},jp.prototype.w_=function(){Dr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.m_;t<e.length;t++)(0,e[t])(1)},jp.On=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},jp),Ep=(Fp.prototype.Sh=function(t){},Fp.prototype.Di=function(){},Fp),Ip="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Tp=(Mp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.serializer=Oc(e.o_.U),this.sl=this.E_(e),this.persistence=this.I_(e),[4,this.persistence.start()];case 1:return t.sent(),this.A_=this.R_(e),this.Kr=this.P_(e),[2]}})})},Mp.prototype.R_=function(t){return null},Mp.prototype.P_=function(t){return Ll(this.persistence,new ap,t.y_,this.serializer)},Mp.prototype.I_=function(t){if(t.persistenceSettings.g_)throw new Tr(Ir.FAILED_PRECONDITION,Ip);return new dp(vp.Hl,this.serializer)},Mp.prototype.E_=function(t){return new yc},Mp.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.A_&&this.A_.stop(),[4,this.sl.Di()];case 1:return t.sent(),[4,this.persistence.Di()];case 2:return t.sent(),[2]}})})},Mp.prototype.clearPersistence=function(t,e){throw new Tr(Ir.FAILED_PRECONDITION,Ip)},Mp),_p=(n(Vp,ip=Tp),Vp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,ip.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=Oh(t),r=Ri.min(),t.ss({index:Hh.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=hh(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.oc=t})]})})}(this.Kr)];case 2:return t.sent(),[4,this.V_.initialize(this,e)];case 3:return t.sent(),[4,tp(this.V_._i)];case 4:return t.sent(),[4,Sf(this.V_.el)];case 5:return t.sent(),[2]}})})},Vp.prototype.P_=function(t){return Ll(this.persistence,new ap,t.y_,this.serializer)},Vp.prototype.R_=function(t){var e=this.persistence.ha.zo;return new $c(e,t.os)},Vp.prototype.I_=function(t){var e=Rl(t.o_.U,t.o_.persistenceKey);return new El(t.persistenceSettings.synchronizeTabs,e,t.clientId,Yc.Bo(t.persistenceSettings.cacheSizeBytes),t.os,qa(),Ba(),this.serializer,this.sl,t.persistenceSettings.fu)},Vp.prototype.E_=function(t){return new yc},Vp.prototype.clearPersistence=function(t,e){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return Na.On()?(e=n+"main",[4,Na.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(Rl(t,e))},n(Cp,rp=Vp),Cp.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,rp.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.V_._i,this.sl instanceof dc?(this.sl._i={ir:function(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).Kr,n=a,i=(r=e).co,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.Ta(e,n).next(function(t){return t?r.io.mo(e,t):Aa.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,Sf(o.el)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(Kf(o,a,h||null),zf(o,a),o.Kr.co.ga(a)):Lr(),t.label=4;case 4:return[4,Yf(o,s)];case 5:return t.sent(),[3,7];case 6:Dr("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}.bind(null,e),rr:function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return(e=i).wl?(Dr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!e.al.has(o))return[3,8];switch(s){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Fl(e.Kr)];case 3:return n=t.sent(),r=vo.Yt(o,"current"===s),[4,Yf(e,n,r)];case 4:return t.sent(),[3,8];case 5:return[4,Cl(e.Kr,o,!0)];case 6:return t.sent(),Qf(e,o,u),[3,8];case 7:Lr(),t.label=8;case 8:return[2]}})})}.bind(null,e),ar:function(c,h,l){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=$f(c)).wl)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.al.has(r)?(Dr("SyncEngine","Adding an already active target "+r),[3,5]):[4,Ml(n.Kr,r)]):[3,6];case 2:return i=t.sent(),[4,Ul(n.Kr,i)];case 3:return o=t.sent(),[4,Gf(n,Zf(i),o.targetId,!1)];case 4:t.sent(),gf(n.el,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.al.has(e)?[4,Cl(n.Kr,e,!1).then(function(){mf(n.el,e),Qf(n,e)}).catch(jl)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=l,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),pi:function(t){return t.Kr.persistence.pi()}.bind(null,e),sr:function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,Fl((e=n).Kr).then(function(t){return Yf(e,t)})]})})}.bind(null,e)},[4,this.sl.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.Su(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,function(h,l){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return $f(r=h),tp(r),!0!==l||!0===r.wl?[3,3]:(e=r.sl.Ci(),[4,Jf(r,e.A())]);case 1:return i=t.sent(),r.wl=!0,[4,Of(r.el,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],gf(r.el,u);return[3,7];case 3:return!1!==l||!1===r.wl?[3,7]:(a=[],c=Promise.resolve(),r.al.forEach(function(t,e){r.sl.qi(e)?a.push(e):c=c.then(function(){return Qf(r,e),Cl(r.Kr,e,!0)}),mf(r.el,e)}),[4,c]);case 4:return t.sent(),[4,Jf(r,a)];case 5:return t.sent(),(n=r).hl.forEach(function(t,e){mf(n.el,e)}),n.ll.Tc(),n.hl=new Map,n.cl=new Xi(qr.i),r.wl=!1,[4,Of(r.el,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}(this.V_._i,e)];case 1:return t.sent(),this.A_&&(e&&!this.A_.Ti?this.A_.start(this.Kr):e||this.A_.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},Cp.prototype.E_=function(t){if(t.persistenceSettings.g_&&t.persistenceSettings.synchronizeTabs){var e=qa();if(!dc.On(e))throw new Tr(Ir.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Rl(t.o_.U,t.o_.persistenceKey);return new dc(e,t.os,n,t.clientId,t.y_)}return new yc},Cp),Ap=(Up.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Kr?[3,2]:(this.Kr=n.Kr,this.sl=n.sl,this.Rh=this.p_(r),this.el=this.b_(r),this.nl=this.v_(r),this._i=this.S_(r),this.sl.fi=function(t){return Bf(e._i,t,1)},this.el.Ph.D_=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Dr("SyncEngine","User change. New user:",o.Zs()),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).co,m=e.io,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.co.Aa(v).next(function(t){return g=t,n=e.persistence.Gu(o),m=new Gc(e.Yr,n,e.persistence.Ju()),n.Aa(v)}).next(function(t){for(var e=[],n=[],r=ho(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,l=t;h<l.length;h++){var f=l[h];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.mo(v,r).next(function(t){return{Il:t,Al:e,Rl:n}})})})];case 1:return r=t.sent(),[2,(e.co=n,e.io=m,e.sc.ac(e.io),r)]}})})}(n.Kr,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).fl.forEach(function(t){t.forEach(function(t){t.reject(new Tr(Ir.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.fl.clear(),n.sl.ji(o,r.Al,r.Rl),[4,Yf(n,r.Il)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this._i),[4,Of(this.el,this._i.ml)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Up.prototype.v_=function(t){return new Ya},Up.prototype.p_=function(t){var e=Oc(t.o_.U),n=(n=t.o_,new wp(n));return t=t.credentials,new tf(t,n,e)},Up.prototype.b_=function(t){var e=this;return new ql(this.Kr,this.Rh,t.os,function(t){return Bf(e._i,t,0)},t=new(bp.On()?bp:Ep))},Up.prototype.S_=function(t){return e=this.Kr,n=this.el,r=this.nl,i=this.sl,o=t.y_,s=t.il,u=!t.persistenceSettings.g_||!t.persistenceSettings.synchronizeTabs,s=new Mf(e,n,r,i,o,s),u&&(s.wl=!0),s;var e,n,r,i,o,s,u},Up.prototype.terminate=function(){return vf(this.el)},Up),Np=(Pp.prototype.next=function(t){this.observer.next&&this.C_(this.observer.next,t)},Pp.prototype.error=function(t){this.observer.error?this.C_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},Pp.prototype.N_=function(){this.muted=!0},Pp.prototype.C_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Pp),Sp=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Tr(Ir.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(Jr("FieldPath","string",e,t[e]),0===t[e].length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.F_=new Gr(t)},Dp=(n(kp,np=Sp),kp.documentId=function(){return new kp(Gr.v().R())},kp.prototype.isEqual=function(t){if(!(t instanceof kp))throw ai("isEqual","FieldPath",1,t);return this.F_.isEqual(t.F_)},kp),Rp=new RegExp("[~\\*/\\[\\]]"),Op=function(t){this.x_=t},xp=(n(Lp,ep=Op),Lp.prototype.k_=function(t){if(2!==t.M_)throw 1===t.M_?t.O_(this.x_+"() can only appear at the top level of your update data"):t.O_(this.x_+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},Lp.prototype.isEqual=function(t){return t instanceof Lp},Lp);function Lp(){return null!==ep&&ep.apply(this,arguments)||this}function kp(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return np.call(this,t)||this}function Pp(t){this.observer=t,this.muted=!1}function Up(){}function Cp(){return null!==rp&&rp.apply(this,arguments)||this}function Vp(t){var e=this;return(e=ip.call(this)||this).V_=t,e}function Mp(){}function Fp(){}function jp(){var t=this;this.__=function(){return t.f_()},this.d_=function(){return t.w_()},this.m_=[],this.T_()}function Gp(t){var e=this;return(e=op.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function qp(t){this.o_=t,this.U=t.U;var e=t.ssl?"https":"http";this.a_=e+"://"+t.host,this.u_="projects/"+this.U.projectId+"/databases/"+this.U.database+"/documents"}function Bp(t){this.Xl=t.Xl,this.Zl=t.Zl}function zp(t){this.persistence=t,this.Gl=new Ql,this.zl=null}function Kp(t){var e=this;return(e=sp.call(this)||this).lu=t,e}function Qp(t,e){var n=this;this.Ul={},this.du=new ic(0),this.wu=!1,this.wu=!0,this.ha=t(this),this.eo=new fp(this),this.ho=new kh,this.uo=(t=this.ho,new hp(t,function(t){return n.ha.Ql(t)})),this.serializer=new sh(e),this.yu=new pp(this.serializer)}function Hp(t){this.serializer=t,this.Bl=new Map,this.ql=new Map}function Wp(t){this.persistence=t,this.kl=new Si(ji,Gi),this.lastRemoteSnapshotVersion=Ri.min(),this.highestTargetId=0,this.Ml=0,this.Ol=new Ql,this.targetCount=0,this.Ll=ll.Ka()}function Xp(t){var e=this;return(e=up.call(this)||this).Ma=t,e}function Yp(t,e){this.ho=t,this.$l=e,this.docs=new Xi(qr.i),this.size=0}function Jp(t,e){this.ho=t,this.ha=e,this.co=[],this.vl=1,this.Sl=new no(Hl.hc)}function Zp(){}function $p(t,e,n){return new Id({M_:3,L_:e.settings.L_,methodName:t.x_,B_:n},e.U,e.serializer,e.ignoreUndefinedProperties)}var td,ed,nd,rd,id=(n(bd,rd=Op),bd.prototype.k_=function(t){return new Bs(t.path,new Ds)},bd.prototype.isEqual=function(t){return t instanceof bd},bd),od=(n(wd,nd=Op),wd.prototype.k_=function(t){var e=$p(this,t,!0),n=this.q_.map(function(t){return Od(t,e)}),n=new Rs(n);return new Bs(t.path,n)},wd.prototype.isEqual=function(t){return this===t},wd),sd=(n(md,ed=Op),md.prototype.k_=function(t){var e=$p(this,t,!0),n=this.q_.map(function(t){return Od(t,e)}),n=new Ps(n);return new Bs(t.path,n)},md.prototype.isEqual=function(t){return this===t},md),ud=(n(gd,td=Op),gd.prototype.k_=function(t){var e=new Ms(t.serializer,es(t.serializer,this.U_));return new Bs(t.path,e)},gd.prototype.isEqual=function(t){return this===t},gd),ad=(Object.defineProperty(vd.prototype,"latitude",{get:function(){return this.Q_},enumerable:!1,configurable:!0}),Object.defineProperty(vd.prototype,"longitude",{get:function(){return this.W_},enumerable:!1,configurable:!0}),vd.prototype.isEqual=function(t){return this.Q_===t.Q_&&this.W_===t.W_},vd.prototype.toJSON=function(){return{latitude:this.Q_,longitude:this.W_}},vd.prototype.H=function(t){return di(this.Q_,t.Q_)||di(this.W_,t.W_)},vd),cd=function(t){this.j_=t},hd=/^__.*__$/,ld=function(t,e,n){this.K_=t,this.G_=e,this.z_=n},fd=(yd.prototype.H_=function(t,e){var n=[];return null!==this.Qe?n.push(new eu(t,this.data,this.Qe,e)):n.push(new tu(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new su(t,this.fieldTransforms)),n},yd),pd=(dd.prototype.H_=function(t,e){return e=[new eu(t,this.data,this.Qe,e)],0<this.fieldTransforms.length&&e.push(new su(t,this.fieldTransforms)),e},dd);function dd(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function yd(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function vd(t,e){if(Wr("GeoPoint",arguments,2),Jr("GeoPoint","number",1,t),Jr("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Tr(Ir.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Tr(Ir.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Q_=t,this.W_=e}function gd(t,e){var n=this;return(n=td.call(this,t)||this).U_=e,n}function md(t,e){var n=this;return(n=ed.call(this,t)||this).q_=e,n}function wd(t,e){var n=this;return(n=nd.call(this,t)||this).q_=e,n}function bd(){return null!==rd&&rd.apply(this,arguments)||this}function Ed(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Lr()}}var Id=(Object.defineProperty(Ad.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Ad.prototype,"M_",{get:function(){return this.settings.M_},enumerable:!1,configurable:!0}),Ad.prototype.Y_=function(t){return new Ad(Object.assign(Object.assign({},this.settings),t),this.U,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},Ad.prototype.X_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.Y_({path:e,B_:!1})).Z_(t),e},Ad.prototype.tf=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.Y_({path:t,B_:!1})).J_(),t},Ad.prototype.ef=function(t){return this.Y_({path:void 0,B_:!0})},Ad.prototype.O_=function(t){return Cd(t,this.settings.methodName,this.settings.nf||!1,this.path,this.settings.L_)},Ad.prototype.contains=function(e){return void 0!==this.Qe.find(function(t){return e.T(t)})||void 0!==this.fieldTransforms.find(function(t){return e.T(t.field)})},Ad.prototype.J_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Z_(this.path.get(t))},Ad.prototype.Z_=function(t){if(0===t.length)throw this.O_("Document fields must not be empty");if(Ed(this.M_)&&hd.test(t))throw this.O_('Document fields cannot begin and end with "__"')},Ad),Td=(_d.prototype.sf=function(t,e,n,r){return void 0===r&&(r=!1),new Id({M_:t,methodName:e,L_:n,path:Gr.g(),B_:!1,nf:r},this.U,this.serializer,this.ignoreUndefinedProperties)},_d);function _d(t,e,n){this.U=t,this.ignoreUndefinedProperties=e,this.serializer=n||Oc(t)}function Ad(t,e,n,r,i,o){this.settings=t,this.U=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.J_(),this.fieldTransforms=i||[],this.Qe=o||[]}function Nd(t,e,n,r,i,o){void 0===o&&(o={});var s=t.sf(o.merge||o.mergeFields?2:0,e,n,i);kd("Data must be an object, but it was:",s,r);var u,a,r=xd(r,s);if(o.merge)u=new qs(s.Qe),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,l=o.mergeFields;h<l.length;h++){var f=l[h],p=void 0;if(f instanceof Sp)p=f.F_;else{if("string"!=typeof f)throw Lr();p=Ud(e,f,n)}if(!s.contains(p))throw new Tr(Ir.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Vd(c,p)||c.push(p)}u=new qs(c),a=s.fieldTransforms.filter(function(t){return u.He(t.field)})}else u=null,a=s.fieldTransforms;return new fd(new pu(r),u,a)}function Sd(t,r,i,e){var o=t.sf(1,r,i);kd("Data must be an object, but it was:",o,e);var s=[],u=new du;return Ur(e,function(t,e){var n=Ud(r,t,i),t=o.tf(n);e instanceof xp||e instanceof cd&&e.j_ instanceof xp?s.push(n):null!=(t=Od(e,t))&&(s.push(n),u.set(n,t))}),e=new qs(s),new pd(u.Ye(),e,o.fieldTransforms)}function Dd(t,e,n,r,i,o){var s=t.sf(1,e,n),u=[Pd(e,r,n)],a=[i];if(o.length%2!=0)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Pd(e,o[c])),a.push(o[c+1]);for(var h,l,f,p=[],d=new du,y=u.length-1;0<=y;--y)Vd(p,u[y])||(h=u[y],l=a[y],f=s.tf(h),l instanceof xp||l instanceof cd&&l.j_ instanceof xp?p.push(h):null!=(f=Od(l,f))&&(p.push(h),d.set(h,f)));return i=new qs(p),new pd(d.Ye(),i,s.fieldTransforms)}function Rd(t,e,n,r){return void 0===r&&(r=!1),Od(n,t.sf(r?4:3,e))}function Od(s,t){if(s instanceof cd&&(s=s.j_),Ld(s))return kd("Unsupported field value:",t,s),xd(s,t);if(s instanceof Op)return function(t,e){if(!Ed(e.M_))throw e.O_(t.x_+"() can only be used with update() and set()");if(!e.path)throw e.O_(t.x_+"() is not currently supported inside arrays");(t=t.k_(e))&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.Qe.push(t.path),s instanceof Array){if(t.settings.B_&&4!==t.M_)throw t.O_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Od(i[r],t.ef(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return es(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Di.fromDate(t);return{timestampValue:ns(e.serializer,n)}}if(t instanceof Di){var r=new Di(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:ns(e.serializer,r)}}if(t instanceof ad)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof wi)return{bytesValue:rs(e.serializer,t.q)};if(t instanceof ld){if(n=e.U,!(r=t.K_).isEqual(n))throw e.O_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:os(t.K_||e.U,t.G_.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.O_("Unsupported field value: "+oi(t))}(s,t)}function xd(t,n){var r={};return Cr(t)?n.path&&0<n.path.length&&n.Qe.push(n.path):Ur(t,function(t,e){null!=(e=Od(e,n.X_(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function Ld(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Di||t instanceof ad||t instanceof wi||t instanceof ld||t instanceof Op)}function kd(t,e,n){if(!Ld(n)||!ii(n))throw"an object"===(n=oi(n))?e.O_(t+" a custom object"):e.O_(t+" "+n)}function Pd(t,e,n){if(e instanceof Sp)return e.F_;if("string"==typeof e)return Ud(t,e);throw Cd("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Ud(t,e,n){try{return function(e){if(0<=e.search(Rp))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Dp.bind.apply(Dp,i([void 0],e.split("."))))}catch(t){throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).F_}catch(e){throw Cd(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Cd(t,e,n,r,i){var o=r&&!r.m(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Tr(Ir.INVALID_ARGUMENT,(e+=". ")+t+n)}function Vd(t,e){return t.some(function(t){return t.isEqual(e)})}var Md=(Bd.prototype.cf=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.hf(),0<this.mutations.length)throw new Tr(Ir.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var i,e,n,o,r;return v(this,function(t){switch(t.label){case 0:return e=ls((i=s).serializer)+"/documents",n={documents:u.map(function(t){return us(i.serializer,t)})},[4,i._h("BatchGetDocuments",e,n)];case 1:return n=t.sent(),o=new Map,n.forEach(function(t){var e,n,r,t=(e=i.serializer,"found"in(t=t)?function(t,e){kr(!!e.found),e.found.name,e.found.updateTime;var n=as(t,e.found.name),t=is(e.found.updateTime),e=new pu({mapValue:{fields:e.found.fields}});return new Iu(n,t,e,{})}(e,t):"missing"in t?(n=e,kr(!!(r=t).missing),kr(!!r.readTime),n=as(n,r.missing),r=is(r.readTime),new Tu(n,r)):Lr());o.set(t.key.toString(),t)}),r=[],[2,(u.forEach(function(t){kr(!!(t=o.get(t.toString()))),r.push(t)}),r)]}})})}(this.Rh,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Tu||t instanceof Iu?n.lf(t):Lr()}),e)]}})})},Bd.prototype.set=function(t,e){this.write(e.H_(t,this.Ke(t))),this.uf.add(t.toString())},Bd.prototype.update=function(t,e){try{this.write(e.H_(t,this._f(t)))}catch(t){this.af=t}this.uf.add(t.toString())},Bd.prototype.delete=function(t){this.write([new lu(t,this.Ke(t))]),this.uf.add(t.toString())},Bd.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.hf(),this.af)throw this.af;return e=this.if,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=qr.D(e),n.mutations.push(new fu(e,n.Ke(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=ls((e=i).serializer)+"/documents",r={writes:o.map(function(t){return ys(e.serializer,t)})},[4,e.lh("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Rh,this.mutations)];case 1:return t.sent(),this.rf=!0,[2]}})})},Bd.prototype.lf=function(t){var e;if(t instanceof Iu)e=t.version;else{if(!(t instanceof Tu))throw Lr();e=Ri.min()}var n=this.if.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Tr(Ir.ABORTED,"Document version changed between two reads.")}else this.if.set(t.key.toString(),e)},Bd.prototype.Ke=function(t){var e=this.if.get(t.toString());return!this.uf.has(t.toString())&&e?Qs.updateTime(e):Qs.Ge()},Bd.prototype._f=function(t){var e=this.if.get(t.toString());if(this.uf.has(t.toString())||!e)return Qs.exists(!0);if(e.isEqual(Ri.min()))throw new Tr(Ir.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Qs.updateTime(e)},Bd.prototype.write=function(t){this.hf(),this.mutations=this.mutations.concat(t)},Bd.prototype.hf=function(){},Bd),Fd=(qd.prototype.run=function(){this.df()},qd.prototype.df=function(){var t=this;this.ys.Rn(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Md(this.Rh),(n=this.wf(e))&&n.then(function(t){r.os.ds(function(){return e.commit().then(function(){r.hs.resolve(t)}).catch(function(t){r.mf(t)})})}).catch(function(t){r.mf(t)}),[2]})})})},qd.prototype.wf=function(t){try{var e=this.updateFunction(t);return!Ui(e)&&e.catch&&e.then?e:(this.hs.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.hs.reject(t),null}},qd.prototype.mf=function(t){var e=this;0<this.ff&&this.Tf(t)?(--this.ff,this.os.ds(function(){return e.df(),Promise.resolve()})):this.hs.reject(t)},qd.prototype.Tf=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!Hi(t))},qd),jd=(Gd.prototype.start=function(t,e,n,r){var i=this;this.If(),this.o_=t;var o=new Ia,s=!1;return this.credentials.yc(function(t){return s?void i.os.Ds(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).os.Fs(),Dr("RemoteStore","RemoteStore received new credentials"),n=Tf(e),e.Vh.add(3),[4,yf(e)];case 1:return t.sent(),n&&e.Dh.set("Unknown"),[4,e.Ph.D_(i)];case 2:return t.sent(),e.Vh.delete(3),[4,df(e)];case 3:return t.sent(),[2]}})})}(i.el,t)}):(s=!0,Dr("FirestoreClient","Initializing. user=",t.uid),i.Af(e,n,r,t,o).then(i.Ef.resolve,i.Ef.reject))}),this.os.ds(function(){return i.Ef.promise}),o.promise},Gd.prototype.enableNetwork=function(){var e=this;return this.If(),this.os.enqueue(function(){return e.persistence.Cu(!0),(t=e.el).Vh.delete(0),df(t);var t})},Gd.prototype.Af=function(r,i,o,s,u){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={os:this.os,o_:this.o_,clientId:this.clientId,credentials:this.credentials,y_:s,il:100,persistenceSettings:o},[4,r.initialize(e)];case 1:return t.sent(),[4,i.initialize(r,e)];case 2:return t.sent(),this.persistence=r.persistence,this.sl=r.sl,this.Kr=r.Kr,this.A_=r.A_,this.Rh=i.Rh,this.el=i.el,this._i=i._i,this.Rf=i.nl,this.Rf.qs=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=$f(s),(o=e.ol.get(u))?(n=o.targetId,e.sl.Oi(n),r=o.view.Zh(),[3,4]):[3,1];case 1:return[4,Ul(e.Kr,Vu(u))];case 2:return i=t.sent(),o=e.sl.Oi(i.targetId),n=i.targetId,[4,Gf(e,u,n,"current"===o)];case 3:r=t.sent(),e.ml&&gf(e.el,i),t.label=4;case 4:return[2,r]}})})}.bind(null,this._i),this.Rf.Ws=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).ol.get(o),1<(r=e.al.get(n.targetId)).length?[2,(e.al.set(n.targetId,r.filter(function(t){return!Gu(t,o)})),void e.ol.delete(o))]:e.ml?(e.sl.Bi(n.targetId),e.sl.Fi(n.targetId)?[3,2]:[4,Cl(e.Kr,n.targetId,!1).then(function(){e.sl.Ui(n.targetId),mf(e.el,n.targetId),Qf(e,n.targetId)}).catch(jl)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Qf(e,n.targetId),[4,Cl(e.Kr,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,this._i),this.persistence.Du(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),u.resolve(),[3,4];case 3:if(e=t.sent(),u.reject(e),!this.Pf(e))throw e;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),this.Af(new Tp,new Ap,{g_:!1},s,u))];case 4:return[2]}})})},Gd.prototype.Pf=function(t){return"FirebaseError"===t.name?t.code===Ir.FAILED_PRECONDITION||t.code===Ir.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Gd.prototype.If=function(){if(this.os.Vs)throw new Tr(Ir.FAILED_PRECONDITION,"The client has already been terminated.")},Gd.prototype.disableNetwork=function(){var t=this;return this.If(),this.os.enqueue(function(){return t.persistence.Cu(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Vh.add(0),[4,yf(e)];case 1:return t.sent(),e.Dh.set("Offline"),[2]}})})}(t.el)})},Gd.prototype.terminate=function(){var t=this;this.os.Ss();var n=new Ia;return this.os.ps(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.A_&&this.A_.stop(),[4,vf(this.el)];case 1:return t.sent(),[4,this.sl.Di()];case 2:return t.sent(),[4,this.persistence.Di()];case 3:return t.sent(),this.credentials.gc(),n.resolve(),[3,5];case 4:return e=Wa(e=t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,5];case 5:return[2]}})})}),n.promise},Gd.prototype.waitForPendingWrites=function(){var t=this;this.If();var e=new Ia;return this.os.ds(function(){return function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:Tf((n=o).el)||Dr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Kr).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.co.Ia(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.fl.get(r)||[]).push(s),n.fl.set(r,i),[3,4]);case 3:return i=Wa(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}(t._i,e)}),e.promise},Gd.prototype.listen=function(t,e,n){var r=this;this.If();var i=new Np(n),o=new tc(t,i,e);return this.os.ds(function(){return Ja(r.Rf,o)}),function(){i.N_(),r.os.ds(function(){return Za(r.Rf,o)})}},Gd.prototype.yf=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.If(),[4,this.Ef.promise];case 1:return t.sent(),e=new Ia,[2,(this.os.ds(function(){return function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.io.lo(t,e)}))];case 1:return(r=t.sent())instanceof Iu?s.resolve(r):r instanceof Tu?s.resolve(null):s.reject(new Tr(Ir.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=Wa(r=t.sent(),"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(n.Kr,r,e)}),e.promise)]}})})},Gd.prototype.gf=function(c,h){return void 0===h&&(h={}),y(this,void 0,void 0,function(){var e,a=this;return v(this,function(t){switch(t.label){case 0:return this.If(),[4,this.Ef.promise];case 1:return t.sent(),e=new Ia,[2,(this.os.ds(function(){return n=a.Rf,r=a.os,i=c,o=h,s=e,t=new Np({next:function(t){r.ds(function(){return Za(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Tr(Ir.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Tr(Ir.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new tc(Ou(i.path),t,{includeMetadataChanges:!0,Ys:!0}),Ja(n,u);var n,r,i,o,s,t,u}),e.promise)]}})})},Gd.prototype.Vf=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.If(),[4,this.Ef.promise];case 1:return t.sent(),e=new Ia,[2,(this.os.ds(function(){return function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Vl(r,i,!0)];case 1:return n=t.sent(),e=new Uf(i,n.uc),n=e.Wh(n.documents),n=e.vr(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=Wa(n=t.sent(),"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(n.Kr,r,e)}),e.promise)]}})})},Gd.prototype.pf=function(c,h){return void 0===h&&(h={}),y(this,void 0,void 0,function(){var u,a=this;return v(this,function(t){switch(t.label){case 0:return this.If(),[4,this.Ef.promise];case 1:return t.sent(),u=new Ia,[2,(this.os.ds(function(){return e=a.Rf,n=a.os,t=c,r=h,i=u,o=new Np({next:function(t){n.ds(function(){return Za(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Tr(Ir.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new tc(t,o,{includeMetadataChanges:!0,Ys:!0}),Ja(e,s);var e,n,t,r,i,o,s}),u.promise)]}})})},Gd.prototype.write=function(t){var e=this;this.If();var n=new Ia;return this.os.ds(function(){return function(f,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=tp(f),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.Kr,a=p,h=i,l=Di.now(),o=a.reduce(function(t,e){return t.add(e.key)},ho()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.io.mo(u,o).next(function(t){c=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=c.get(i.key),s instanceof su?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Iu?t.field(i.field):void 0;null!=(o=As(i.transform,o||null))&&(e=(null==e?new du:e).set(i.field,o))}return e?e.Ye():null}(o):null);null!=o&&e.push(new eu(i.key,o,function s(t){var u=[];return Ur(t.fields||{},function(t,e){var n=new Gr([t]);if(Xo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new qs(u)}(o.proto.mapValue),Qs.exists(!0)))}return h.co.da(u,l,e,a)})}).then(function(t){var e=t.wr(c);return{batchId:t.batchId,Er:e}}))];case 2:return s=t.sent(),u.sl.$i(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e._l[e.currentUser.Zs()])||new Xi(di)).rt(n,r),e._l[e.currentUser.Zs()]=i,[4,Yf(u,s.Er)];case 3:return t.sent(),[4,Sf(u.el)];case 4:return t.sent(),[3,6];case 5:return u=Wa(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,l,o})})}(e._i,t,n)}),n.promise},Gd.prototype.U=function(){return this.o_.U},Gd.prototype.bf=function(t){var e=this;this.If();var r=new Np(t);return this.os.ds(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,(e=this.Rf,n=r,e.Bs.add(n),void n.next())];var e,n})})}),function(){r.N_(),e.os.ds(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,void this.Rf.Bs.delete(r)]})})})}},Object.defineProperty(Gd.prototype,"vf",{get:function(){return this.os.Vs},enumerable:!1,configurable:!0}),Gd.prototype.transaction=function(t){var e=this;this.If();var n=new Ia;return this.os.ds(function(){return new Fd(e.os,e.Rh,t,n).run(),Promise.resolve()}),n.promise},Gd.prototype.loadBundle=function(t,r){var e=this;this.If();var n,i,o=(n=t,i=Oc(this.o_.U),n="string"==typeof n?(new TextEncoder).encode(n):n,new Lc(Rc(n),i));this.os.ds(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,(e=this._i,function(f,p,d){return y(this,void 0,void 0,function(){var u,a,c,h,l;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,14,,15]),[4,p.getMetadata()];case 1:return u=t.sent(),[4,(r=f.Kr,i=u,s=new kc((o=r).serializer).Qr(i.createTime),o.persistence.runTransaction("hasNewerBundle","readonly",function(t){return o.yu.Ba(t,i.id)}).then(function(t){return!!t&&0<=t.createTime.L(s)}))];case 2:return t.sent()?[4,p.close()]:[3,4];case 3:return[2,(t.sent(),void d.Pl({taskState:"Success",documentsLoaded:u.totalDocuments,bytesLoaded:u.totalBytes,totalDocuments:u.totalDocuments,totalBytes:u.totalBytes}))];case 4:return d.yl(Vc(u)),a=new Fc(u,f.Kr,p.serializer),[4,p.$r()];case 5:c=t.sent(),t.label=6;case 6:return c?[4,a.Gr(c)]:[3,10];case 7:return(h=t.sent())&&d.yl(h),[4,p.$r()];case 8:c=t.sent(),t.label=9;case 9:return[3,6];case 10:return[4,a.complete()];case 11:return l=t.sent(),[4,Yf(f,l.Wr,void 0)];case 12:return t.sent(),[4,(r=f.Kr,e=u,(n=r).persistence.runTransaction("Save bundle","readwrite",function(t){return n.yu.qa(t,e)}))];case 13:return t.sent(),d.Pl(l.progress),[3,15];case 14:return l=t.sent(),d.gl(l),[3,15];case 15:return[2]}var e,n,r,i,o,s})})}(n=e,o,r).then(function(){n.sl.zi()}),r.catch(function(t){Or("FirestoreClient","Loading bundle failed with "+t)}))];var e,n})})})},Gd.prototype.Ua=function(t){return this.If(),e=this.Kr,n=t,(r=e).persistence.runTransaction("Get named query","readonly",function(t){return r.yu.Ua(t,n)});var e,n,r},Gd);function Gd(t,e){this.credentials=t,this.os=e,this.clientId=fi.k(),this.Ef=new Ia}function qd(t,e,n,r){this.os=t,this.Rh=e,this.updateFunction=n,this.hs=r,this.ff=5,this.ys=new _a(this.os,"transaction_retry")}function Bd(t){this.Rh=t,this.if=new Map,this.mutations=[],this.rf=!1,this.af=null,this.uf=new Set}function zd(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Kd,Qd,Hd=(py.prototype.Nf=function(t){switch(Uo(t)){case 0:return null;case 1:return t.booleanValue;case 2:return qo(t.integerValue||t.doubleValue);case 3:return this.Ff(t.timestampValue);case 4:return this.$f(t);case 5:return t.stringValue;case 6:return this.Cf(Bo(t.bytesValue));case 7:return this.xf(t.referenceValue);case 8:return this.kf(t.geoPointValue);case 9:return this.Mf(t.arrayValue);case 10:return this.Of(t.mapValue);default:throw Lr()}},py.prototype.Of=function(t){var n=this,r={};return Ur(t.fields||{},function(t,e){r[t]=n.Nf(e)}),r},py.prototype.kf=function(t){return new ad(qo(t.latitude),qo(t.longitude))},py.prototype.Mf=function(t){var e=this;return(t.values||[]).map(function(t){return e.Nf(t)})},py.prototype.$f=function(t){switch(this.Sf){case"previous":var e=function t(e){return Lo(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==e?null:this.Nf(e);case"estimate":return this.Ff(ko(t));default:return null}},py.prototype.Ff=function(t){return t=Go(t),t=new Di(t.seconds,t.nanos),this.timestampsInSnapshots?t:t.toDate()},py.prototype.xf=function(t){var e=Fr.P(t);return kr(_s(e)),t=new Ni(e.get(1),e.get(3)),e=new qr(e.u(5)),t.isEqual(this.U)||Rr("Document "+e+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+this.U.projectId+"/"+this.U.database+") instead."),this.Df(e)},py),Wd=(fy.prototype.onProgress=function(t,e,n){this.Lf={next:t,error:e,complete:n}},fy.prototype.catch=function(t){return this.Bf.promise.catch(t)},fy.prototype.then=function(t,e){return this.Bf.promise.then(t,e)},fy.prototype.Pl=function(t){this.yl(t),this.Lf.complete&&this.Lf.complete(),this.Bf.resolve(t)},fy.prototype.gl=function(t){this.qf.taskState="Error",this.Lf.next&&this.Lf.next(this.qf),this.Lf.error&&this.Lf.error(t),this.Bf.reject(t)},fy.prototype.yl=function(t){this.qf=t,this.Lf.next&&this.Lf.next(t)},fy),Xd=Yc.Qo,Yd=(ly.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},ly),Jd=(Object.defineProperty(hy.prototype,"Xf",{get:function(){return this.Zf||(this.Zf=new Td(this.K_,this.Yf.ignoreUndefinedProperties)),this.Zf},enumerable:!1,configurable:!0}),hy.prototype.settings=function(t){if(Wr("Firestore.settings",arguments,1),Jr("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.Yf),t)).merge,t=new Yd(t),this.Gf&&!this.Yf.isEqual(t))throw new Tr(Ir.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Yf=t).credentials&&(this.Jf=function(t){if(!t)return new Wl;switch(t.type){case"gapi":var e=t.client;return kr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Jl(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Tr(Ir.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},hy.prototype.enableNetwork=function(){return this.Kf(),this.Gf.enableNetwork()},hy.prototype.disableNetwork=function(){return this.Kf(),this.Gf.disableNetwork()},hy.prototype.enablePersistence=function(t){var e;if(this.Gf)throw new Tr(Ir.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var n=!1,r=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Rr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),n=null!==(e=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==e&&e,r=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,n&&r))throw new Tr(Ir.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.td(this.Uf,this.Qf,{g_:!0,cacheSizeBytes:this.Yf.cacheSizeBytes,synchronizeTabs:n,fu:r})},hy.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){var n,e=this;return v(this,function(t){if(void 0!==this.Gf&&!this.Gf.vf)throw new Tr(Ir.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new Ia,[2,(this.jf.ps(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Uf.clearPersistence(this.K_,this.Hf)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},hy.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(hy.prototype,"ed",{get:function(){return this.Kf(),this.Gf.vf},enumerable:!1,configurable:!0}),hy.prototype.waitForPendingWrites=function(){return this.Kf(),this.Gf.waitForPendingWrites()},hy.prototype.onSnapshotsInSync=function(t){return this.Kf(),zd(t)||(Jr("Firestore.onSnapshotsInSync","function",1,t),t={next:t}),this.Gf.bf(t)},hy.prototype.loadBundle=function(t){this.Kf();var e=new Wd;return this.Gf.loadBundle(t,e),e},hy.prototype.namedQuery=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.Kf(),[4,this.Gf.Ua(n)];case 1:return[2,(e=t.sent())?new wy(e.query,this,null):null]}})})},hy.prototype.Kf=function(){return this.Gf||this.td(new Tp,new Ap,{g_:!1}),this.Gf},hy.prototype.nd=function(){return new Ti(this.K_,this.Hf,this.Yf.host,this.Yf.ssl,this.Yf.experimentalForceLongPolling)},hy.prototype.td=function(t,e,n){var r=this.nd();return this.Gf=new jd(this.Jf,this.jf),this.Gf.start(r,t,e,n)},hy.zf=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Tr(Ir.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e;if(!(t=t.options.projectId)||"string"!=typeof t)throw new Tr(Ir.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Ni(t)},Object.defineProperty(hy.prototype,"app",{get:function(){if(!this.Wf)throw new Tr(Ir.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Wf},enumerable:!1,configurable:!0}),hy.prototype.collection=function(t){return Wr("Firestore.collection",arguments,1),Jr("Firestore.collection","non-empty string",1,t),this.Kf(),new Ey(Fr.P(t),this,null)},hy.prototype.doc=function(t){return Wr("Firestore.doc",arguments,1),Jr("Firestore.doc","non-empty string",1,t),this.Kf(),ty.sd(Fr.P(t),this,null)},hy.prototype.collectionGroup=function(t){if(Wr("Firestore.collectionGroup",arguments,1),Jr("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.Kf(),new wy((t=t,new Au(Fr.g(),t)),this,null)},hy.prototype.runTransaction=function(e){var n=this;return Wr("Firestore.runTransaction",arguments,1),Jr("Firestore.runTransaction","function",1,e),this.Kf().transaction(function(t){return e(new Zd(n,t))})},hy.prototype.batch=function(){return this.Kf(),new $d(this)},Object.defineProperty(hy,"logLevel",{get:function(){switch(Sr()){case f.DEBUG:return"debug";case f.ERROR:return"error";case f.SILENT:return"silent";case f.WARN:return"warn";case f.INFO:return"info";case f.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),hy.setLogLevel=function(t){Wr("Firestore.setLogLevel",arguments,1),ni("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Ar.setLogLevel(t)},hy.prototype.rd=function(){return this.Yf.timestampsInSnapshots},hy.prototype.od=function(){return this.Yf},hy),Zd=(cy.prototype.get=function(t){var e=this;Wr("Transaction.get",arguments,1);var n=Dy("Transaction.get",t,this.ad);return this.ud.cf([n.G_]).then(function(t){if(!t||1!==t.length)return Lr();if((t=t[0])instanceof Tu)return new ny(e.ad,n.G_,null,!1,!1,n.z_);if(t instanceof Iu)return new ny(e.ad,n.G_,t,!1,!1,n.z_);throw Lr()})},cy.prototype.set=function(t,e,n){return Yr("Transaction.set",arguments,2,3),t=Dy("Transaction.set",t,this.ad),n=Ay("Transaction.set",n),e=Ry(t.z_,e,n),n=Nd(this.ad.Xf,"Transaction.set",t.G_,e,null!==t.z_,n),this.ud.set(t.G_,n),this},cy.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return e="string"==typeof e||e instanceof Dp?(Xr("Transaction.update",arguments,3),r=Dy("Transaction.update",t,this.ad),Dd(this.ad.Xf,"Transaction.update",r.G_,e,n,i)):(Wr("Transaction.update",arguments,2),r=Dy("Transaction.update",t,this.ad),Sd(this.ad.Xf,"Transaction.update",r.G_,e)),this.ud.update(r.G_,e),this},cy.prototype.delete=function(t){return Wr("Transaction.delete",arguments,1),t=Dy("Transaction.delete",t,this.ad),this.ud.delete(t.G_),this},cy),$d=(ay.prototype.set=function(t,e,n){return Yr("WriteBatch.set",arguments,2,3),this._d(),t=Dy("WriteBatch.set",t,this.ad),n=Ay("WriteBatch.set",n),e=Ry(t.z_,e,n),n=Nd(this.ad.Xf,"WriteBatch.set",t.G_,e,null!==t.z_,n),this.hd=this.hd.concat(n.H_(t.G_,Qs.Ge())),this},ay.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return this._d(),e="string"==typeof e||e instanceof Dp?(Xr("WriteBatch.update",arguments,3),r=Dy("WriteBatch.update",t,this.ad),Dd(this.ad.Xf,"WriteBatch.update",r.G_,e,n,i)):(Wr("WriteBatch.update",arguments,2),r=Dy("WriteBatch.update",t,this.ad),Sd(this.ad.Xf,"WriteBatch.update",r.G_,e)),this.hd=this.hd.concat(e.H_(r.G_,Qs.exists(!0))),this},ay.prototype.delete=function(t){return Wr("WriteBatch.delete",arguments,1),this._d(),t=Dy("WriteBatch.delete",t,this.ad),this.hd=this.hd.concat(new lu(t.G_,Qs.Ge())),this},ay.prototype.commit=function(){return this._d(),this.ld=!0,0<this.hd.length?this.ad.Kf().write(this.hd):Promise.resolve()},ay.prototype._d=function(){if(this.ld)throw new Tr(Ir.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},ay),ty=(n(uy,Qd=ld),uy.sd=function(t,e,n){if(t.length%2!=0)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.R()+" has "+t.length);return new uy(new qr(t),e,n)},Object.defineProperty(uy.prototype,"id",{get:function(){return this.G_.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(uy.prototype,"parent",{get:function(){return new Ey(this.G_.path.h(),this.firestore,this.z_)},enumerable:!1,configurable:!0}),Object.defineProperty(uy.prototype,"path",{get:function(){return this.G_.path.R()},enumerable:!1,configurable:!0}),uy.prototype.collection=function(t){if(Wr("DocumentReference.collection",arguments,1),Jr("DocumentReference.collection","non-empty string",1,t),!t)throw new Tr(Ir.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");return t=Fr.P(t),new Ey(this.G_.path.child(t),this.firestore,null)},uy.prototype.isEqual=function(t){if(!(t instanceof uy))throw ai("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.G_.isEqual(t.G_)&&this.z_===t.z_},uy.prototype.set=function(t,e){return Yr("DocumentReference.set",arguments,1,2),e=Ay("DocumentReference.set",e),t=Ry(this.z_,t,e),e=Nd(this.firestore.Xf,"DocumentReference.set",this.G_,t,null!==this.z_,e),this.Gf.write(e.H_(this.G_,Qs.Ge()))},uy.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return t="string"==typeof t||t instanceof Dp?(Xr("DocumentReference.update",arguments,2),Dd(this.firestore.Xf,"DocumentReference.update",this.G_,t,e,n)):(Wr("DocumentReference.update",arguments,1),Sd(this.firestore.Xf,"DocumentReference.update",this.G_,t)),this.Gf.write(t.H_(this.G_,Qs.exists(!0)))},uy.prototype.delete=function(){return Wr("DocumentReference.delete",arguments,0),this.Gf.write([new lu(this.G_,Qs.Ge())])},uy.prototype.onSnapshot=function(){for(var e=this,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];Yr("DocumentReference.onSnapshot",arguments,1,4);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||zd(n[i])||(ui("DocumentReference.onSnapshot",r=n[i],["includeMetadataChanges"]),ti("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};zd(n[i])?(s=n[i],n[i]=null===(r=s.next)||void 0===r?void 0:r.bind(s),n[i+1]=null===(r=s.error)||void 0===r?void 0:r.bind(s),n[i+2]=null===(r=s.complete)||void 0===r?void 0:r.bind(s)):(Jr("DocumentReference.onSnapshot","function",i,n[i]),Zr("DocumentReference.onSnapshot","function",i+1,n[i+1]),Zr("DocumentReference.onSnapshot","function",i+2,n[i+2]));var s={next:function(t){n[i]&&n[i](e.fd(t))},error:n[i+1],complete:n[i+2]};return this.Gf.listen(Ou(this.G_.path),o,s)},uy.prototype.get=function(t){var e=this;Yr("DocumentReference.get",arguments,0,1),Sy("DocumentReference.get",t);var n=this.firestore.Kf();return t&&"cache"===t.source?n.yf(this.G_).then(function(t){return new ny(e.firestore,e.G_,t,!0,t instanceof Iu&&t.Je,e.z_)}):n.gf(this.G_,t).then(function(t){return e.fd(t)})},uy.prototype.withConverter=function(t){return new uy(this.G_,this.firestore,t)},uy.prototype.fd=function(t){var e=t.docs.get(this.G_);return new ny(this.firestore,this.G_,e,t.fromCache,t.hasPendingWrites,this.z_)},uy),ey=(sy.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},sy),ny=(oy.prototype.data=function(t){var e=this;if(Yr("DocumentSnapshot.data",arguments,0,1),t=Ny("DocumentSnapshot.data",t),this.dd){if(this.z_){var n=new ry(this.ad,this.G_,this.dd,this.wd,this.md,null);return this.z_.fromFirestore(n,t)}return new Hd(this.ad.K_,this.ad.rd(),t.serverTimestamps||"none",function(t){return new ty(t,e.ad,null)},function(t){return new Ai(t)}).Nf(this.dd.sn())}},oy.prototype.get=function(t,e){var n=this;if(Yr("DocumentSnapshot.get",arguments,1,2),e=Ny("DocumentSnapshot.get",e),this.dd&&null!==(t=this.dd.data().field(Pd("DocumentSnapshot.get",t,this.G_))))return new Hd(this.ad.K_,this.ad.rd(),e.serverTimestamps||"none",function(t){return new ty(t,n.ad,n.z_)},function(t){return new Ai(t)}).Nf(t)},Object.defineProperty(oy.prototype,"id",{get:function(){return this.G_.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(oy.prototype,"ref",{get:function(){return new ty(this.G_,this.ad,this.z_)},enumerable:!1,configurable:!0}),Object.defineProperty(oy.prototype,"exists",{get:function(){return null!==this.dd},enumerable:!1,configurable:!0}),Object.defineProperty(oy.prototype,"metadata",{get:function(){return new ey(this.md,this.wd)},enumerable:!1,configurable:!0}),oy.prototype.isEqual=function(t){if(!(t instanceof oy))throw ai("isEqual","DocumentSnapshot",1,t);return this.ad===t.ad&&this.wd===t.wd&&this.G_.isEqual(t.G_)&&(null===this.dd?null===t.dd:this.dd.isEqual(t.dd))&&this.z_===t.z_},oy),ry=(n(iy,Kd=ny),iy.prototype.data=function(t){return Kd.prototype.data.call(this,t)},iy);function iy(){return null!==Kd&&Kd.apply(this,arguments)||this}function oy(t,e,n,r,i,o){this.ad=t,this.G_=e,this.dd=n,this.wd=r,this.md=i,this.z_=o}function sy(t,e){this.hasPendingWrites=t,this.fromCache=e}function uy(t,e,n){var r=this;return(r=Qd.call(this,e.K_,t,n)||this).G_=t,r.firestore=e,r.z_=n,r.Gf=r.firestore.Kf(),r}function ay(t){this.ad=t,this.hd=[],this.ld=!1}function cy(t,e){this.ad=t,this.ud=e}function hy(t,e,n,r){var i=this;if(void 0===n&&(n=new Tp),void 0===r&&(r=new Ap),this.Uf=n,this.Qf=r,this.Wf=null,this.jf=new Ka,this.INTERNAL={delete:function(){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Kf(),[4,this.Gf.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options)r=t,this.Wf=r,this.K_=hy.zf(r),this.Hf=r.name,this.Jf=new Xl(e);else{if(!(t=t).projectId)throw new Tr(Ir.INVALID_ARGUMENT,"Must provide projectId");this.K_=new Ni(t.projectId,t.database),this.Hf="[DEFAULT]",this.Jf=new Wl}this.Yf=new Yd({})}function ly(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Tr(Ir.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else $r("settings","non-empty string","host",t.host),this.host=t.host,ti("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(ui("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),ti("settings","object","credentials",t.credentials),this.credentials=t.credentials,ti("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),ti("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Rr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Rr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(e=t.timestampsInSnapshots)||void 0===e||e,this.ignoreUndefinedProperties=null!==(e=t.ignoreUndefinedProperties)&&void 0!==e&&e,ti("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Yc.jo;else{if(t.cacheSizeBytes!==Xd&&t.cacheSizeBytes<Yc.Wo)throw new Tr(Ir.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Yc.Wo);this.cacheSizeBytes=t.cacheSizeBytes}ti("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(t=t.experimentalForceLongPolling)&&void 0!==t&&t}function fy(){this.Lf={},this.Bf=new Ia,this.qf={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function py(t,e,n,r,i){this.U=t,this.timestampsInSnapshots=e,this.Sf=n,this.Df=r,this.Cf=i}function dy(t,e,n){if("string"==typeof n){if(""===n)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Uu(e)&&-1!==n.indexOf("/"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(Fr.P(n)),!qr.F(e))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return zo(t,new qr(e))}if(n instanceof ld)return zo(t,n.G_);throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+oi(n)+".")}function yy(t,e){if(!Array.isArray(t)||0===t.length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function vy(t,e,n){if(!n.isEqual(e))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function gy(t){if(Lu(t)&&0===t.rn.length)throw new Tr(Ir.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var my,wy=(_y.prototype.where=function(t,e,n){return Wr("Query.where",arguments,3),si("Query.where",3,n),e=ni("Query.where",["<","<=","==","!=",">=",">","array-contains","in","array-contains-any","not-in"],2,e),t=Pd("Query.where",t),e=function(t,e,n,r,i,o){if(r.p()){if("array-contains"===i||"array-contains-any"===i)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){yy(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(dy(n,t,c))}h={arrayValue:{values:s}}}else h=dy(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||yy(o,i),h=Rd(e,"Query.where",o,"in"===i||"not-in"===i);var h=Hu.create(r,i,h);return function(t,e){if(e.cn()){var n=Pu(t);if(null!==n&&!n.isEqual(e.field))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=ku(t))&&vy(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(this.Td,this.firestore.Xf,this.firestore.K_,t,e,n),new _y((e=(n=this.Td).filters.concat([e]),new Au(n.path,n.collectionGroup,n.rn.slice(),e,n.limit,n.on,n.startAt,n.endAt)),this.firestore,this.z_)},_y.prototype.orderBy=function(t,e){if(Yr("Query.orderBy",arguments,1,2),Zr("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Tr(Ir.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=Pd("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Ea(e,n);return e=r,null!==ku(n=t)||null!==(t=Pu(n))&&vy(0,t,e.field),r}(this.Td,t,n);return new _y((t=(n=this.Td).rn.concat([t]),new Au(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.on,n.startAt,n.endAt)),this.firestore,this.z_)},_y.prototype.limit=function(t){return Wr("Query.limit",arguments,1),Jr("Query.limit","number",1,t),ci("Query.limit",1,t),new _y(Mu(this.Td,t,"F"),this.firestore,this.z_)},_y.prototype.limitToLast=function(t){return Wr("Query.limitToLast",arguments,1),Jr("Query.limitToLast","number",1,t),ci("Query.limitToLast",1,t),new _y(Mu(this.Td,t,"L"),this.firestore,this.z_)},_y.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Xr("Query.startAt",arguments,1),t=this.Ed("Query.startAt",t,e,!0),new _y(Fu(this.Td,t),this.firestore,this.z_)},_y.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Xr("Query.startAfter",arguments,1),t=this.Ed("Query.startAfter",t,e,!1),new _y(Fu(this.Td,t),this.firestore,this.z_)},_y.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Xr("Query.endBefore",arguments,1),t=this.Ed("Query.endBefore",t,e,!0),new _y(ju(this.Td,t),this.firestore,this.z_)},_y.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Xr("Query.endAt",arguments,1),t=this.Ed("Query.endAt",t,e,!1),new _y(ju(this.Td,t),this.firestore,this.z_)},_y.prototype.isEqual=function(t){if(!(t instanceof _y))throw ai("isEqual","Query",1,t);return this.firestore===t.firestore&&Gu(this.Td,t.Td)&&this.z_===t.z_},_y.prototype.withConverter=function(t){return new _y(this.Td,this.firestore,t)},_y.prototype.Ed=function(c,t,e,n){return si(c,1,t),t instanceof ny?(Wr(c,i([t],e),1),function(t,e,n,r){if(!n)throw new Tr(Ir.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=Cu(t);o<s.length;o++){var u=s[o];if(u.field.p())i.push(zo(e,n.key));else{var a=n.field(u.field);if(Lo(a))throw new Tr(Ir.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.R(),new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new pa(i,r)}(this.Td,this.firestore.K_,t.dd,n)):(e=[t].concat(e),function(t,e,n,r,i,o){var s=t.rn;if(i.length>s.length)throw new Tr(Ir.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.p()){if("string"!=typeof c)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Uu(t)&&-1!==c.indexOf("/"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(Fr.P(c));if(!qr.F(h))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new qr(h),u.push(zo(e,h))}else c=Rd(n,r,c),u.push(c)}return new pa(u,o)}(this.Td,this.firestore.K_,this.firestore.Xf,c,e,n))},_y.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Yr("Query.onSnapshot",arguments,1,4);var i={},o=0;"object"!=typeof n[o]||zd(n[o])||(ui("Query.onSnapshot",i=n[o],["includeMetadataChanges"]),ti("Query.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),o++),zd(n[o])?(s=n[o],n[o]=null===(t=s.next)||void 0===t?void 0:t.bind(s),n[o+1]=null===(t=s.error)||void 0===t?void 0:t.bind(s),n[o+2]=null===(t=s.complete)||void 0===t?void 0:t.bind(s)):(Jr("Query.onSnapshot","function",o,n[o]),Zr("Query.onSnapshot","function",o+1,n[o+1]),Zr("Query.onSnapshot","function",o+2,n[o+2]));var s={next:function(t){n[o]&&n[o](new by(e.firestore,e.Td,t,e.z_))},error:n[o+1],complete:n[o+2]};return gy(this.Td),this.firestore.Kf().listen(this.Td,i,s)},_y.prototype.get=function(t){var e=this;Yr("Query.get",arguments,0,1),Sy("Query.get",t),gy(this.Td);var n=this.firestore.Kf();return(t&&"cache"===t.source?n.Vf(this.Td):n.pf(this.Td,t)).then(function(t){return new by(e.firestore,e.Td,t,e.z_)})},_y),by=(Object.defineProperty(Ty.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Ty.prototype,"empty",{get:function(){return this.Ad.docs.m()},enumerable:!1,configurable:!0}),Object.defineProperty(Ty.prototype,"size",{get:function(){return this.Ad.docs.size},enumerable:!1,configurable:!0}),Ty.prototype.forEach=function(e,n){var r=this;Yr("QuerySnapshot.forEach",arguments,1,2),Jr("QuerySnapshot.forEach","function",1,e),this.Ad.docs.forEach(function(t){e.call(n,r.yd(t,r.metadata.fromCache,r.Ad.Qt.has(t.key)))})},Object.defineProperty(Ty.prototype,"query",{get:function(){return new wy(this.Id,this.ad,this.z_)},enumerable:!1,configurable:!0}),Ty.prototype.docChanges=function(t){if(t&&(ui("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),ti("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges)),(t=!(!t||!t.includeMetadataChanges))&&this.Ad.jt)throw new Tr(Ir.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Rd&&this.Pd===t||(this.Rd=function(i,e,o){if(i.Ut.m()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Ut;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Lr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.Ad,t,this.yd.bind(this)),this.Pd=t),this.Rd},Ty.prototype.isEqual=function(t){if(!(t instanceof Ty))throw ai("isEqual","QuerySnapshot",1,t);return this.ad===t.ad&&Gu(this.Id,t.Id)&&this.Ad.isEqual(t.Ad)&&this.z_===t.z_},Ty.prototype.yd=function(t,e,n){return new ry(this.ad,t.key,t,e,n,this.z_)},Ty),Ey=(n(Iy,my=wy),Object.defineProperty(Iy.prototype,"id",{get:function(){return this.Td.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Iy.prototype,"parent",{get:function(){var t=this.Td.path.h();return t.m()?null:new ty(new qr(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Iy.prototype,"path",{get:function(){return this.Td.path.R()},enumerable:!1,configurable:!0}),Iy.prototype.doc=function(t){return Yr("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=fi.k()),Jr("CollectionReference.doc","non-empty string",1,t),t=Fr.P(t),ty.sd(this.Td.path.child(t),this.firestore,this.z_)},Iy.prototype.add=function(t){Wr("CollectionReference.add",arguments,1),Jr("CollectionReference.add","object",1,t=this.z_?this.z_.toFirestore(t):t);var e=this.doc();return new ty(e.G_,this.firestore,null).set(t).then(function(){return e})},Iy.prototype.withConverter=function(t){return new Iy(this.gd,this.firestore,t)},Iy);function Iy(t,e,n){var r=this;if(((r=my.call(this,Ou(t),e,n)||this).gd=t).length%2!=1)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.R()+" has "+t.length);return r}function Ty(t,e,n,r){this.ad=t,this.Id=e,this.Ad=n,this.z_=r,this.Rd=null,this.Pd=null,this.metadata=new ey(n.hasPendingWrites,n.fromCache)}function _y(t,e,n){this.Td=t,this.firestore=e,this.z_=n}function Ay(t,e){if(void 0===e)return{merge:!1};if(ui(t,e,["merge","mergeFields"]),ti(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+oi(n));for(var r,i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof Dp))throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+oi(n[i]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function Ny(t,e){return void 0===e?{}:(ui(t,e,["serverTimestamps"]),ei(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Sy(t,e){Zr(t,"object",1,e),e&&(ui(t,e,["source"]),ei(t,0,"source",e.source,["default","server","cache"]))}function Dy(t,e,n){if(e instanceof ld){if(e.firestore!==n)throw new Tr(Ir.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw ai(t,"DocumentReference",1,e)}function Ry(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Oy,xy,Ee=(n(ky,Oy=cd),ky.serverTimestamp=function(){Hr("FieldValue.serverTimestamp",arguments);var t=new id("serverTimestamp");return t.x_="FieldValue.serverTimestamp",new ky(t)},ky.delete=function(){Hr("FieldValue.delete",arguments);var t=new xp("deleteField");return t.x_="FieldValue.delete",new ky(t)},ky.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Xr("FieldValue.arrayUnion",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Xr("arrayUnion()",arguments,1),new od("arrayUnion",t)}.apply(void 0,t);return n.x_="FieldValue.arrayUnion",new ky(n)},ky.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Xr("FieldValue.arrayRemove",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Xr("arrayRemove()",arguments,1),new sd("arrayRemove",t)}.apply(void 0,t);return n.x_="FieldValue.arrayRemove",new ky(n)},ky.increment=function(t){return Jr("FieldValue.increment","number",1,t),Wr("FieldValue.increment",arguments,1),(t=new ud("increment",t)).x_="FieldValue.increment",new ky(t)},ky.prototype.isEqual=function(t){return this.j_.isEqual(t.j_)},ky),Ly={Firestore:Jd,GeoPoint:ad,Timestamp:Di,Blob:Ai,Transaction:Zd,WriteBatch:$d,DocumentReference:ty,DocumentSnapshot:ny,Query:wy,QueryDocumentSnapshot:ry,QuerySnapshot:by,CollectionReference:Ey,FieldPath:Dp,FieldValue:Ee,setLogLevel:Jd.setLogLevel,CACHE_SIZE_UNLIMITED:Xd};function ky(){return null!==Oy&&Oy.apply(this,arguments)||this}(xy=e.default).INTERNAL.registerComponent(new wr("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),r=new Ap,t=new _p(r),new Jd(e,n,t,r);var e,n,r},"PUBLIC").setServiceProps(Object.assign({},Ly))),xy.registerVersion("@firebase/firestore","1.17.2-alpha.01492c06e")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
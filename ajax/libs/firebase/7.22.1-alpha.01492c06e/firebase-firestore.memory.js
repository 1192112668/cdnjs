!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(Ep){"use strict";try{(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var u,e=t(Ep),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}(Ee=u=u||{})[Ee.DEBUG=0]="DEBUG",Ee[Ee.VERBOSE=1]="VERBOSE",Ee[Ee.INFO=2]="INFO",Ee[Ee.WARN=3]="WARN",Ee[Ee.ERROR=4]="ERROR",Ee[Ee.SILENT=5]="SILENT";function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}var a={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},h=u.INFO,c=((Ie={})[u.DEBUG]="log",Ie[u.VERBOSE]="log",Ie[u.INFO]="info",Ie[u.WARN]="warn",Ie[u.ERROR]="error",Ie),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?a[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=h,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e){e=d.call(this,e)||this;return e.code=t,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").",s=new m(o,t),u=0,a=Object.keys(i);u<a.length;u++){var h=a[u];"_"!==h.slice(-1)&&(h in s&&console.warn('Overwriting FirebaseError base field "'+h+'" can cause unexpected behavior.'),s[h]=i[h])}return s},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,R="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S={},O=R||self;function P(){}function L(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function V(t){var e=L(t);return"array"==e||"object"==e&&"number"==typeof t.length}function D(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var _="closure_uid_"+(1e9*Math.random()>>>0),k=0;function U(t,e,n){return t.call.apply(t.bind,arguments)}function C(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function M(t,e,n){return(M=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?U:C).apply(null,arguments)}function x(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var F=Date.now;function j(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function q(){this.j=this.j,this.i=this.i}q.prototype.j=!1,q.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,_)&&t[_]||(t[_]=++k))},q.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var G=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function Q(){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var W,Y=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function J(t,e){return t<e?-1:e<t?1:0}t:{var K=O.navigator;if(K){K=K.userAgent;if(K){W=K;break t}}W=""}function Z(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function $(t){var e,n={};for(e in t)n[e]=t[e];return n}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<tt.length;i++)e=tt[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function nt(t){return nt[" "](t),t}nt[" "]=P;var rt,it=X(W,"Opera"),ot=X(W,"Trident")||X(W,"MSIE"),st=X(W,"Edge"),ut=st||ot,at=X(W,"Gecko")&&!(X(W.toLowerCase(),"webkit")&&!X(W,"Edge"))&&!(X(W,"Trident")||X(W,"MSIE"))&&!X(W,"Edge"),ht=X(W.toLowerCase(),"webkit")&&!X(W,"Edge");function ct(){var t=O.document;return t?t.documentMode:void 0}t:{var lt="",ft=(ft=W,at?/rv:([^\);]+)(\)|;)/.exec(ft):st?/Edge\/([\d\.]+)/.exec(ft):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ft):ht?/WebKit\/(\S+)/.exec(ft):it?/(?:Version)[ \/]?(\S+)/.exec(ft):void 0);if(ft&&(lt=ft?ft[1]:""),ot){ft=ct();if(null!=ft&&ft>parseFloat(lt)){rt=String(ft);break t}}rt=lt}var pt={};function dt(u){return t=u,e=function(){for(var t=0,e=Y(String(rt)).split("."),n=Y(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=J(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||J(0==o[2].length,0==s[2].length)||J(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=pt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}var yt=O.document&&ot?ct()||(parseInt(rt,10)||void 0):void 0,vt=!ot||9<=Number(yt),gt=ot&&!dt("9"),mt=function(){if(!O.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{O.addEventListener("test",P,e),O.removeEventListener("test",P,e)}catch(t){}return t}();function wt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function bt(t,e){if(wt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(at){t:{try{nt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Et[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}wt.prototype.b=function(){this.defaultPrevented=!0},j(bt,wt);var Et={2:"touch",3:"pen",4:"mouse"};bt.prototype.b=function(){bt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,gt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var It="closure_listenable_"+(1e6*Math.random()|0),Tt=0;function At(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++Tt,this.Y=this.Z=!1}function Nt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Rt(t){this.src=t,this.a={},this.b=0}function St(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=G(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Nt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Ot(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Rt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Ot(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new At(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Pt="closure_lm_"+(1e6*Math.random()|0),Lt={};function Vt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=Ft(r);return e&&e[It]?e.wa(n,r,D(i)?!!i.capture:!!i,o):Dt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Vt(t,e[o],n,r,i);return null}return n=Ft(n),t&&t[It]?t.va(e,n,D(r)?!!r.capture:!!r,i):Dt(t,e,n,!1,r,i)}function Dt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=D(i)?!!i.capture:!!i;if(s&&!vt)return null;var u,a,h=Mt(t);if(h||(t[Pt]=h=new Rt(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Ct,r=a=vt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)mt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(kt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function _t(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[It]?St(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(kt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Mt(e))?(St(n,t),0==n.b&&(n.src=null,e[Pt]=null)):Nt(t)))}function kt(t){return t in Lt?Lt[t]:Lt[t]="on"+t}function Ut(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&_t(t),n.call(r,e)}function Ct(t,e){if(t.Y)return!0;if(vt)return Ut(t,new bt(e,this));if(!e)t:{e=["window","event"];for(var n=O,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ut(t,e=new bt(e,this))}function Mt(t){return(t=t[Pt])instanceof Rt?t:null}var xt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ft(e){return"function"==L(e)?e:(e[xt]||(e[xt]=function(t){return e.handleEvent(t)}),e[xt])}function jt(){q.call(this),this.c=new Rt(this),(this.J=this).C=null}function qt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&St(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}j(jt,q),jt.prototype[It]=!0,(N=jt.prototype).addEventListener=function(t,e,n,r){Vt(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=D(i)?!!i.capture:!!i,r=Ft(r),e&&e[It]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Ot(s=e.a[n],r,i,o))&&(Nt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Mt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Ot(n,r,i,o)),(r=-1<e?n[e]:null)&&_t(r))}(this,t,e,n,r)},N.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new wt(t,n):t instanceof wt?t.target=t.target||n:(s=t,et(t=new wt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=qt(o,r,!0,t)&&s;if(s=qt(o=t.a=n,r,!0,t)&&s,s=qt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=qt(o=t.a=e[i],r,!1,t)&&s;return s},N.G=function(){if(jt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Nt(n[r]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},N.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Gt=O.JSON.stringify;function Bt(){this.b=this.a=null}var Qt,zt=(Ht.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Ht(function(){return new Wt},function(t){t.reset()},100));function Ht(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Wt(){this.next=this.b=this.a=null}function Yt(t,e){var n;Qt||(n=O.Promise.resolve(void 0),Qt=function(){n.then(Kt)}),Xt||(Qt(),Xt=!0),Jt.add(t,e)}Bt.prototype.add=function(t,e){var n=zt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Wt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Xt=!(Wt.prototype.reset=function(){this.next=this.b=this.a=null}),Jt=new Bt;function Kt(){for(var t,e;n=e=void 0,n=null,(e=Jt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){O.setTimeout(function(){throw t},0)}(t)}var n=zt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Xt=!1}function Zt(t,e){jt.call(this),this.b=t||1,this.a=e||O,this.f=M(this.Ya,this),this.g=F()}function $t(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function te(t,e,n){if("function"==L(t))n&&(t=M(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=M(t.handleEvent,t)}return 2147483647<Number(e)?-1:O.setTimeout(t,e||0)}j(Zt,jt),(N=Zt.prototype).aa=!1,N.M=null,N.Ya=function(){var t;this.aa&&(0<(t=F()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&($t(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=F())},N.G=function(){Zt.S.G.call(this),$t(this),delete this.a};var ee,ne,re,ie=(T(ne=se,re=ee=q),ne.prototype=null===re?Object.create(re):(oe.prototype=re.prototype,new oe),se.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=te(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},se.prototype.G=function(){ee.prototype.G.call(this),this.a&&(O.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},se);function oe(){this.constructor=ne}function se(t,e,n){var r=ee.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function ue(t){q.call(this),this.b=t,this.a={}}j(ue,q);var ae=[];function he(t,e,n,r){Array.isArray(n)||(n&&(ae[0]=n.toString()),n=ae);for(var i=0;i<n.length;i++){var o=Vt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ce(t){Z(t.a,function(t,e){this.a.hasOwnProperty(e)&&_t(t)},t),t.a={}}function le(){this.a=!0}function fe(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)){r=i[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}}return Gt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ue.prototype.G=function(){ue.S.G.call(this),ce(this)},ue.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},le.prototype.info=function(){};var pe=null;function de(){return pe=pe||new jt}function ye(t){wt.call(this,"serverreachability",t)}function ve(t){var e=de();e.dispatchEvent(new ye(e))}function ge(t){wt.call(this,"statevent",t)}function me(t){var e=de();e.dispatchEvent(new ge(e))}function we(t){wt.call(this,"timingevent",t)}function be(t,e){if("function"!=L(t))throw Error("Fn must not be null and must be a function");return O.setTimeout(function(){t()},e)}j(ye,wt),j(ge,wt),j(we,wt);var Ee={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ie={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Te(){}function Ae(t){var e;return(e=t.a)||(e=t.a={}),e}function Ne(){}Te.prototype.a=null;var Re,R={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Se(){wt.call(this,"d")}function Oe(){wt.call(this,"c")}function Pe(){}function Le(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new ue(this),this.P=Ve,t=ut?125:void 0,this.R=new Zt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}j(Se,wt),j(Oe,wt),j(Pe,Te),Re=new Pe;var Ve=45e3,De={},_e={};function ke(t,e,n){t.H=1,t.i=en(Xe(e)),t.j=n,t.I=!0,Ue(t,null)}function Ue(t,e){t.u=F(),Me(t),t.l=Xe(t.i);var s,u,a,h,c,l,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),yn(n.b,"t",r),t.D=0,t.a=ar(t.g,t.g.C?e:null),0<t.O&&(t.F=new ie(M(t.Ca,t,t.a),t.O)),he(t.J,t.a,"readystatechange",t.Wa),e=t.B?$(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ve(1),s=t.c,u=t.m,a=t.l,h=t.f,c=t.T,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function Ce(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?_e:(i=Number(u.substring(i,o)),isNaN(i)?De:(o+=1)+i>u.length?_e:(u=u.substr(o,i),r.D=o+i,u)));if(u==_e){4==e&&(t.h=4,me(14),s=!1),fe(t.c,t.f,null,"[Incomplete Response]");break}if(u==De){t.h=4,me(15),fe(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}fe(t.c,t.f,u,null),Ge(t,u)}4==e&&0==n.length&&(t.h=1,me(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),tr(e),e.F=!0)):(fe(t.c,t.f,n,"[Invalid Chunked Response]"),qe(t),je(t))}function Me(t){t.U=F()+t.P,xe(t,t.P)}function xe(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=be(M(t.Ua,t),e)}function Fe(t){t.o&&(O.clearTimeout(t.o),t.o=null)}function je(t){0==t.g.v||t.A||rr(t.g,t)}function qe(t){Fe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,$t(t.R),ce(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ge(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||In(u.b,t)))if(u.I=t.N,!t.C&&In(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var h=a;if(0==h[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;nr(u),zn(u)}$n(u),me(18)}}else u.oa=h[1],0<u.oa-u.P&&h[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=be(M(u.Ra,u),6e3));if(En(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else or(u,11)}else if(!t.C&&u.a!=t||nr(u),!H(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++){h=e[a],u.P=h[0],h=h[1],2==u.v?"c"==h[0]?(u.J=h[1],u.ga=h[2],null!=(r=h[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=h[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=h[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(X(r,"spdy")||X(r,"quic")||X(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(Tn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,tn(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.V&&(u.N=F()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=ur(n,n.C?n.ga:null,n.fa),i.C?(An(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Fe(o),Me(o)),n.a=i):Zn(n),0<u.g.length&&Yn(u)):"stop"!=h[0]&&"close"!=h[0]||or(u,7):3==u.v&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?or(u,7):Qn(u):"noop"!=h[0]&&u.f&&u.f.sa(h),u.o=0)}ve(4)}catch(t){}}function Be(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(V(t)||"string"==typeof t)B(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(V(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(V(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Qe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Qe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function ze(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];He(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)He(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function He(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=Le.prototype).setTimeout=function(t){this.P=t},N.Wa=function(t){t=t.target;var e=this.F;e&&3==jn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=jn(this.a),n=this.a.ua(),r=this.a.X();if(!(e<3||3==e&&!ut&&!this.a.$())){this.A||4!=e||7==n||ve(8==n||r<=0?3:2),Fe(this);var i=this.a.X();this.N=i;n=this.a.$();if(this.b=200==i,r=this.c,u=this.m,a=this.l,h=this.f,c=this.T,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+c+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.V&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,me(12),qe(this),je(this);break t}fe(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ge(this,s)}this.I?(Ce(this,e,n),ut&&this.b&&3==e&&(he(this.J,this.R,"tick",this.Va),this.R.start())):(fe(this.c,this.f,n,null),Ge(this,n)),4==e&&qe(this),this.b&&!this.A&&(4==e?rr(this.g,this):(this.b=!1,Me(this)))}else 400==i&&0<n.indexOf("Unknown SID")?(this.h=3,me(12)):(this.h=0,me(13)),qe(this),je(this)}}}catch(t){}var u,a,h,c,l,f},N.Va=function(){var t,e;this.a&&(t=jn(this.a),e=this.a.$(),this.D<e.length&&(Fe(this),Ce(this,t,e),this.b&&4!=t&&Me(this)))},N.cancel=function(){this.A=!0,qe(this)},N.Ua=function(){this.o=null;var t,e,n=F();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ve(3),me(17)),qe(this),this.h=2,je(this)):xe(this,this.U-n)},(N=Qe.prototype).K=function(){ze(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return ze(this),this.a.concat()},N.get=function(t,e){return He(this.b,t)?this.b[t]:e},N.set=function(t,e){He(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var We=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ye(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ye?(this.a=void 0!==e?e:t.a,Je(this,t.f),this.j=t.j,Ke(this,t.c),Ze(this,t.h),this.g=t.g,e=t.b,(n=new ln).c=e.c,e.a&&(n.a=new Qe(e.a),n.b=e.b),$e(this,n),this.i=t.i):t&&(n=String(t).match(We))?(this.a=!!e,Je(this,n[1]||"",!0),this.j=nn(n[2]||""),Ke(this,n[3]||"",!0),Ze(this,n[4]),this.g=nn(n[5]||"",!0),$e(this,n[6]||"",!0),this.i=nn(n[7]||"")):(this.a=!!e,this.b=new ln(null,this.a))}function Xe(t){return new Ye(t)}function Je(t,e,n){t.f=n?nn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ke(t,e,n){t.c=n?nn(e,!0):e}function Ze(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function $e(t,e,n){var r,i;e instanceof ln?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(fn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(pn(this,e),yn(this,n,t))},r)),r.f=i):(n||(e=rn(e,hn)),t.b=new ln(e,t.a))}function tn(t,e,n){t.b.set(e,n)}function en(t){return tn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^F()).toString(36)),t}function nn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function rn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,on),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function on(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ye.prototype.toString=function(){var t=[],e=this.f;e&&t.push(rn(e,sn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(rn(e,sn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(rn(n,"/"==n.charAt(0)?an:un,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",rn(n,cn)),t.join("")};var sn=/[#\/\?@]/g,un=/[#\?:]/g,an=/[#\?]/g,hn=/[#\?@]/g,cn=/#/g;function ln(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function fn(n){n.a||(n.a=new Qe,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function pn(t,e){fn(t),e=vn(t,e),He(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,He((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&ze(t)))}function dn(t,e){return fn(t),e=vn(t,e),He(t.a.b,e)}function yn(t,e,n){pn(t,e),0<n.length&&(t.c=null,t.a.set(vn(t,e),z(n)),t.b+=n.length)}function vn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function gn(t,e){this.b=t,this.a=e}function mn(t){this.g=t||wn,t=O.PerformanceNavigationTiming?0<(t=O.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(O.ia&&O.ia.ya&&O.ia.ya()&&O.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(N=ln.prototype).add=function(t,e){fn(this),this.c=null,t=vn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,r){fn(this),this.a.forEach(function(t,e){B(t,function(t){n.call(r,t,e,this)},this)},this)},N.L=function(){fn(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},N.K=function(t){fn(this);var e=[];if("string"==typeof t)dn(this,t)&&(e=Q(e,this.a.get(vn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=Q(e,t[n])}return e},N.set=function(t,e){return fn(this),this.c=null,dn(this,t=vn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var wn=10;function bn(t){return t.b||t.a&&t.a.size>=t.f}function En(t){return t.b?1:t.a?t.a.size:0}function In(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Tn(t,e){t.a?t.a.add(e):t.b=e}function An(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Nn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return z(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Rn(){}function Sn(){this.a=new Rn}function On(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}mn.prototype.cancel=function(){var e,t;if(this.c=Nn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Rn.prototype.stringify=function(t){return O.JSON.stringify(t,void 0)},Rn.prototype.parse=function(t){return O.JSON.parse(t,void 0)};var Pn=O.JSON.parse;function Ln(t){jt.call(this),this.headers=new Qe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Vn,this.D=this.F=!1}j(Ln,jt);var Vn="",Dn=/^https?$/i,_n=["POST","PUT"];function kn(t){return"content-type"==t.toLowerCase()}function Un(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Cn(t),xn(t)}function Cn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Mn(t){if(t.b&&void 0!==S&&(!t.s[1]||4!=jn(t)||2!=t.X()))if(t.l&&4==jn(t))te(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==jn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(We)[1]||null)&&O.self&&O.self.location&&(i=(r=O.self.location.protocol).substr(0,r.length-1)),n=!Dn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<jn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Cn(t)}}finally{xn(t)}}}function xn(t,e){if(t.a){Fn(t);var n=t.a,r=t.s[0]?P:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Fn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(O.clearTimeout(t.m),t.m=null)}function jn(t){return t.a?t.a.readyState:0}function qn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",Z(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):tn(t,e,n))}function Gn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Bn(t){this.pa=0,this.g=[],this.c=new le,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Gn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Gn("baseRetryDelayMs",5e3,t),this.Ma=Gn("retryDelaySeedMs",1e4,t),this.Ja=Gn("forwardChannelMaxRetries",2,t),this.ma=Gn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new mn(t&&t.concurrentRequestLimit),this.ka=new Sn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Qn(t){var e,n;Hn(t),3==t.v&&(e=t.R++,tn(n=Xe(t.B),"SID",t.J),tn(n,"RID",e),tn(n,"TYPE","terminate"),Jn(t,n),(e=new Le(t,t.c,e,void 0)).H=2,e.i=en(Xe(n)),n=!1,O.navigator&&O.navigator.sendBeacon&&(n=O.navigator.sendBeacon(e.i.toString(),"")),!n&&O.Image&&((new Image).src=e.i,n=!0),n||(e.a=ar(e.g,null),e.a.ba(e.i)),e.u=F(),Me(e)),sr(t)}function zn(t){t.a&&(tr(t),t.a.cancel(),t.a=null)}function Hn(t){zn(t),t.j&&(O.clearTimeout(t.j),t.j=null),nr(t),t.b.cancel(),t.h&&("number"==typeof t.h&&O.clearTimeout(t.h),t.h=null)}function Wn(t,e){t.g.push(new gn(t.La++,e)),3==t.v&&Yn(t)}function Yn(t){bn(t.b)||t.h||(t.h=!0,Yt(t.Ba,t),t.u=0)}function Xn(t,e){var n=e?e.f:t.R++,r=Xe(t.B);tn(r,"SID",t.J),tn(r,"RID",n),tn(r,"AID",t.P),Jn(t,r),t.i&&t.l&&qn(r,t.i,t.l),n=new Le(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Kn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),Tn(t.b,n),ke(n,r,e)}function Jn(t,n){t.f&&Be({},function(t,e){tn(n,e,t)})}function Kn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?M(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r,e){var i=e||"";try{Be(t,function(t,e){var n=t;D(t)&&(n=Gt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Zn(t){t.a||t.j||(t.U=1,Yt(t.Aa,t),t.o=0)}function $n(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=be(M(t.Aa,t),ir(t,t.o)),t.o++,1)}function tr(t){null!=t.s&&(O.clearTimeout(t.s),t.s=null)}function er(t){t.a=new Le(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Xe(t.la);tn(e,"RID","rpc"),tn(e,"SID",t.J),tn(e,"CI",t.H?"0":"1"),tn(e,"AID",t.P),Jn(t,e),tn(e,"TYPE","xmlhttp"),t.i&&t.l&&qn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=en(Xe(e)),n.j=null,n.I=!0,Ue(n,t)}function nr(t){null!=t.m&&(O.clearTimeout(t.m),t.m=null)}function rr(t,e){var n,r=null;if(t.a==e){nr(t),tr(t),t.a=null;var i=2}else{if(!In(t.b,e))return;r=e.s,An(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b){1==i?(r=e.j?e.j.length:0,e=F()-e.u,n=t.u,(i=de()).dispatchEvent(new we(i)),Yn(t)):Zn(t)}else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(En(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=be(M(t.Ba,t,e),ir(t,t.u)),t.u++,1}}(t,e)||2==i&&$n(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:or(t,5);break;case 4:or(t,10);break;case 3:or(t,6);break;default:or(t,2)}}function ir(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function or(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=M(t.Xa,t),r||(r=new Ye("//www.google.com/images/cleardot.gif"),O.location&&"http"==O.location.protocol||Je(r,"https"),en(r)),n=r.toString(),r=o,o=new le,O.Image?((i=new Image).onload=x(On,o,i,"TestLoadImage: loaded",!0,r),i.onerror=x(On,o,i,"TestLoadImage: error",!1,r),i.onabort=x(On,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=x(On,o,i,"TestLoadImage: timeout",!1,r),O.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):me(2),t.v=0,t.f&&t.f.ra(e),sr(t),Hn(t)}function sr(t){t.v=0,t.I=-1,t.f&&(0==Nn(t.b).length&&0==t.g.length||(t.b.c.length=0,z(t.g),t.g.length=0),t.f.qa())}function ur(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Ye?Xe(s):new Ye(s,void 0);return""!=a.c?(e&&Ke(a,e+"."+a.c),Ze(a,a.h)):(u=O.location,r=u.protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Ye(null,void 0),r&&Je(u,r),i&&Ke(u,i),o&&Ze(u,o),s&&(u.g=s),a=u),t.W&&Z(t.W,function(t,e){tn(a,e,t)}),e=t.A,n=t.na,e&&n&&tn(a,e,n),tn(a,"VER",t.ha),Jn(t,a),a}function ar(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Ln(t.Ka)).F=t.C,e}function hr(){}function cr(){if(ot&&!(10<=Number(yt)))throw Error("Environmental error: no available transport.")}function lr(t,e){jt.call(this),this.a=new Bn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new dr(this)}function fr(t){Se.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function pr(){Oe.call(this),this.status=1}function dr(t){this.a=t}(N=Ln.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ae(this.H):Ae(Re),this.a.onreadystatechange=M(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Un(this,t)}t=n||"";var i,o=new Qe(this.headers);r&&Be(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=kn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=O.FormData&&t instanceof O.FormData,0<=G(_n,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Fn(this),0<this.o&&((this.D=(i=this.a,ot&&dt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=M(this.xa,this)):this.m=te(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Un(this,t)}},N.xa=function(){void 0!==S&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),xn(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),xn(this,!0)),Ln.S.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?Mn(this):this.Ta())},N.Ta=function(){Mn(this)},N.X=function(){try{return 2<jn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Pn(e)}},N.ua=function(){return this.h},N.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=Bn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Le(this,this.c,t,void 0),r=this.l;if(this.O&&(r?et(r=$(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Kn(this,n,e),tn(i=Xe(this.B),"RID",t),tn(i,"CVER",22),this.A&&tn(i,"X-HTTP-Session-Id",this.A),Jn(this,i),this.i&&r&&qn(i,this.i,r),Tn(this.b,n),this.Ga&&tn(i,"TYPE","init"),this.da?(tn(i,"$req",e),tn(i,"SID","null"),n.V=!0,ke(n,i,null)):ke(n,i,e),this.v=2}}else 3==this.v&&(t?Xn(this,t):0==this.g.length||bn(this.b)||Xn(this))},N.Aa=function(){var t;this.j=null,er(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=be(M(this.Sa,this),t))},N.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,zn(this),er(this))},N.Ra=function(){null!=this.m&&(this.m=null,zn(this),$n(this),me(19))},N.Xa=function(t){t?(this.c.info("Successfully pinged google.com"),me(2)):(this.c.info("Failed to ping google.com"),me(1))},(N=hr.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ha=function(){},cr.prototype.a=function(t,e){return new lr(t,e)},j(lr,jt),(N=lr.prototype).addEventListener=function(t,e,n,r){lr.S.addEventListener.call(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){lr.S.removeEventListener.call(this,t,e,n,r)},N.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;me(0),t.fa=e,t.W=n||{},t.H=t.T,t.B=ur(t,null,t.fa),Yn(t)},N.close=function(){Qn(this.a)},N.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Wn(this.a,e)):this.g?((e={}).__data__=Gt(t),Wn(this.a,e)):Wn(this.a,t)},N.G=function(){this.a.f=null,delete this.f,Qn(this.a),delete this.a,lr.S.G.call(this)},j(fr,Se),j(pr,Oe),j(dr,hr),dr.prototype.ta=function(){this.a.dispatchEvent("a")},dr.prototype.sa=function(t){this.a.dispatchEvent(new fr(t))},dr.prototype.ra=function(t){this.a.dispatchEvent(new pr)},dr.prototype.qa=function(){this.a.dispatchEvent("b")},cr.prototype.createWebChannel=cr.prototype.a,lr.prototype.send=lr.prototype.Pa,lr.prototype.open=lr.prototype.Oa,Ee.NO_ERROR=0,Ee.TIMEOUT=8,Ee.HTTP_ERROR=6,Ie.COMPLETE="complete",(Ne.EventType=R).OPEN="a",R.CLOSE="b",R.ERROR="c",R.MESSAGE="d",jt.prototype.listen=jt.prototype.va,Ln.prototype.listenOnce=Ln.prototype.wa,Ln.prototype.getLastError=Ln.prototype.Qa,Ln.prototype.getLastErrorCode=Ln.prototype.ua,Ln.prototype.getStatus=Ln.prototype.X,Ln.prototype.getResponseJson=Ln.prototype.Na,Ln.prototype.getResponseText=Ln.prototype.$,Ln.prototype.send=Ln.prototype.ba;var Ie={createWebChannelTransport:function(){return new cr},ErrorCode:Ee,EventType:Ie,WebChannel:Ne,XhrIo:Ln},yr=Ie.createWebChannelTransport,vr=Ie.ErrorCode,gr=Ie.EventType,mr=Ie.WebChannel,wr=Ie.XhrIo,br=(Er.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},Er.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},Er.prototype.setServiceProps=function(t){return this.serviceProps=t,this},Er);function Er(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Ir,Tr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ar=(n(Sr,Ir=Error),Sr),Nr="7.22.1-alpha.01492c06e",Rr=new l("@firebase/firestore");function Sr(t,e){var n=this;return(n=Ir.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Or(){return Rr.logLevel}function Pr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Rr.logLevel<=u.DEBUG&&(e=n.map(Dr),Rr.debug.apply(Rr,i(["Firestore ("+Nr+"): "+t],e)))}function Lr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Rr.logLevel<=u.ERROR&&(e=n.map(Dr),Rr.error.apply(Rr,i(["Firestore ("+Nr+"): "+t],e)))}function Vr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Rr.logLevel<=u.WARN&&(e=n.map(Dr),Rr.warn.apply(Rr,i(["Firestore ("+Nr+"): "+t],e)))}function Dr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function _r(t){void 0===t&&(t="Unexpected state");t="FIRESTORE ("+Nr+") INTERNAL ASSERTION FAILED: "+t;throw Lr(t),new Error(t)}function kr(t){t||_r()}function Ur(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Cr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Mr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var xr,Fr,l=(Object.defineProperty(Wr.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),Wr.prototype.isEqual=function(t){return 0===Wr.i(this,t)},Wr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Wr?t.forEach(function(t){e.push(t)}):e.push(t),this.o(e)},Wr.prototype.limit=function(){return this.offset+this.length},Wr.prototype.u=function(t){return t=void 0===t?1:t,this.o(this.segments,this.offset+t,this.length-t)},Wr.prototype.h=function(){return this.o(this.segments,this.offset,this.length-1)},Wr.prototype.l=function(){return this.segments[this.offset]},Wr.prototype._=function(){return this.get(this.length-1)},Wr.prototype.get=function(t){return this.segments[this.offset+t]},Wr.prototype.m=function(){return 0===this.length},Wr.prototype.T=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Wr.prototype.A=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Wr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Wr.prototype.I=function(){return this.segments.slice(this.offset,this.limit())},Wr.i=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Wr),jr=(n(Hr,Fr=l),Hr.prototype.o=function(t,e,n){return new Hr(t,e,n)},Hr.prototype.R=function(){return this.I().join("/")},Hr.prototype.toString=function(){return this.R()},Hr.P=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new Hr(n)},Hr.V=function(){return new Hr([])},Hr),qr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Gr=(n(zr,xr=l),zr.prototype.o=function(t,e,n){return new zr(t,e,n)},zr.p=function(t){return qr.test(t)},zr.prototype.R=function(){return this.I().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),zr.p(t)||(t="`"+t+"`"),t}).join(".")},zr.prototype.toString=function(){return this.R()},zr.prototype.g=function(){return 1===this.length&&"__name__"===this.get(0)},zr.v=function(){return new zr(["__name__"])},zr.S=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Ar(Tr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Ar(Tr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Ar(Tr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new zr(e)},zr.V=function(){return new zr([])},zr),Br=(Qr.D=function(t){return new Qr(jr.P(t))},Qr.C=function(t){return new Qr(jr.P(t).u(5))},Qr.prototype.N=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Qr.prototype.isEqual=function(t){return null!==t&&0===jr.i(this.path,t.path)},Qr.prototype.toString=function(){return this.path.toString()},Qr.i=function(t,e){return jr.i(t.path,e.path)},Qr.F=function(t){return t.length%2==0},Qr.$=function(t){return new Qr(new jr(t.slice()))},Qr);function Qr(t){this.path=t}function zr(){return null!==xr&&xr.apply(this,arguments)||this}function Hr(){return null!==Fr&&Fr.apply(this,arguments)||this}function Wr(t,e,n){void 0===e?e=0:e>t.length&&_r(),void 0===n?n=t.length-e:n>t.length-e&&_r(),this.segments=t,this.offset=e,this.t=n}function Yr(t,e){if(0!==e.length)throw new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+fi(e.length,"argument")+".")}function Xr(t,e,n){if(e.length!==n)throw new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() requires "+fi(n,"argument")+", but was called with "+fi(e.length,"argument")+".")}function Jr(t,e,n){if(e.length<n)throw new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() requires at least "+fi(n,"argument")+", but was called with "+fi(e.length,"argument")+".")}function Kr(t,e,n,r){if(e.length<n||e.length>r)throw new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+fi(e.length,"argument")+".")}function Zr(t,e,n,r){ii(t,e,li(n)+" argument",r)}function $r(t,e,n,r){void 0!==r&&Zr(t,e,n,r)}function ti(t,e,n,r){ii(t,e,n+" option",r)}function ei(t,e,n,r){void 0!==r&&ti(t,e,n,r)}function ni(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(si(s))}var u=si(n);throw new Ar(Tr.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function ri(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid value "+si(r)+" provided to function "+t+"() for its "+li(n)+" argument. Acceptable values: "+e.join(", "));return r}function ii(t,e,n,r){if(!("object"===e?oi(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){r=si(r);throw new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}}function oi(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function si(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":_r();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function ui(t,e,n){if(void 0===n)throw new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+li(e)+" argument, but it was undefined.")}function ai(n,t,r){Cr(t,function(t,e){if(r.indexOf(t)<0)throw new Ar(Tr.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function hi(t,e,n,r){r=si(r);return new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() requires its "+li(n)+" argument to be a "+e+", but it was: "+r)}function ci(t,e,n){if(n<=0)throw new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() requires its "+li(e)+" argument to be a positive number, but it was: "+n+".")}function li(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function fi(t,e){return t+" "+e+(1===t?"":"s")}var pi=(di.L=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},di);function di(){}function yi(t,e){return t<e?-1:e<t?1:0}function vi(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var gi=(mi.fromBase64String=function(t){return new mi(atob(t))},mi.fromUint8Array=function(t){return new mi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},mi.prototype.toBase64=function(){return t=this.O,btoa(t);var t},mi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.O)},mi.prototype.k=function(){return 2*this.O.length},mi.prototype.M=function(t){return yi(this.O,t.O)},mi.prototype.isEqual=function(t){return this.O===t.O},mi);function mi(t){this.O=t}gi.U=new gi("");var wi=(bi.fromBase64String=function(t){try{return new bi(gi.fromBase64String(t))}catch(t){throw new Ar(Tr.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},bi.fromUint8Array=function(t){return new bi(gi.fromUint8Array(t))},bi.prototype.toBase64=function(){return this.q.toBase64()},bi.prototype.toUint8Array=function(){return this.q.toUint8Array()},bi.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},bi.prototype.isEqual=function(t){return this.q.isEqual(t.q)},bi);function bi(t){this.q=t}function Ei(){if("undefined"==typeof Uint8Array)throw new Ar(Tr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Ii(){if("undefined"==typeof atob)throw new Ar(Tr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function Ti(t,e,n,r,i){this.B=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var Ai,Ni=(n(ki,Ai=wi),ki.fromBase64String=function(t){Xr("Blob.fromBase64String",arguments,1),Zr("Blob.fromBase64String","string",1,t),Ii();try{return new ki(gi.fromBase64String(t))}catch(t){throw new Ar(Tr.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},ki.fromUint8Array=function(t){if(Xr("Blob.fromUint8Array",arguments,1),Ei(),!(t instanceof Uint8Array))throw hi("Blob.fromUint8Array","Uint8Array",1,t);return new ki(gi.fromUint8Array(t))},ki.prototype.toBase64=function(){return Xr("Blob.toBase64",arguments,0),Ii(),Ai.prototype.toBase64.call(this)},ki.prototype.toUint8Array=function(){return Xr("Blob.toUint8Array",arguments,0),Ei(),Ai.prototype.toUint8Array.call(this)},ki.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},ki),Ri=(Object.defineProperty(_i.prototype,"j",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),_i.prototype.isEqual=function(t){return t instanceof _i&&t.projectId===this.projectId&&t.database===this.database},_i.prototype.M=function(t){return yi(this.projectId,t.projectId)||yi(this.database,t.database)},_i),Si=(Di.prototype.get=function(t){var e=this.W(t),e=this.K[e];if(void 0!==e)for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];if(this.G(o,t))return i}},Di.prototype.has=function(t){return void 0!==this.get(t)},Di.prototype.set=function(t,e){var n=this.W(t),r=this.K[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.G(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.K[n]=[[t,e]]},Di.prototype.delete=function(t){var e=this.W(t),n=this.K[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.G(n[r][0],t))return 1===n.length?delete this.K[e]:n.splice(r,1),!0;return!1},Di.prototype.forEach=function(s){Cr(this.K,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],i=i[1];s(o,i)}})},Di.prototype.m=function(){return Mr(this.K)},Di),Oi=(Vi.now=function(){return Vi.fromMillis(Date.now())},Vi.fromDate=function(t){return Vi.fromMillis(t.getTime())},Vi.fromMillis=function(t){var e=Math.floor(t/1e3);return new Vi(e,1e6*(t-1e3*e))},Vi.prototype.toDate=function(){return new Date(this.toMillis())},Vi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Vi.prototype.H=function(t){return this.seconds===t.seconds?yi(this.nanoseconds,t.nanoseconds):yi(this.seconds,t.seconds)},Vi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Vi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Vi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},Vi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Vi),Pi=(Li.Y=function(t){return new Li(t)},Li.min=function(){return new Li(new Oi(0,0))},Li.prototype.M=function(t){return this.timestamp.H(t.timestamp)},Li.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Li.prototype.J=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Li.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Li.prototype.X=function(){return this.timestamp},Li);function Li(t){this.timestamp=t}function Vi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Ar(Tr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Ar(Tr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Ar(Tr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Ar(Tr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Di(t,e){this.W=t,this.G=e,this.K={}}function _i(t,e){this.projectId=t,this.database=e||"(default)"}function ki(){return null!==Ai&&Ai.apply(this,arguments)||this}function Ui(t){return null==t}function Ci(t){return 0===t&&1/t==-1/0}var Mi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Z=null};function xi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Mi(t,e,n,r,i,o,s)}function Fi(t){var e=t;return null===e.Z&&(t=e.path.R(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.R()+t.op.toString()+Fo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.R()+t.dir}).join(","),Ui(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=da(e.startAt)),e.endAt&&(t+="|ub:",t+=da(e.endAt)),e.Z=t),e.Z}function ji(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Uo(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!va(t.startAt,e.startAt)&&va(t.endAt,e.endAt)}function qi(t){return Br.F(t.path)&&null===t.collectionGroup&&0===t.filters.length}function Gi(t){this.count=t}var Bi,Qi=(zi.prototype.nt=function(t){return new zi(this.target,this.targetId,this.tt,t,this.et,this.lastLimboFreeSnapshotVersion,this.resumeToken)},zi.prototype.st=function(t,e){return new zi(this.target,this.targetId,this.tt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},zi.prototype.it=function(t){return new zi(this.target,this.targetId,this.tt,this.sequenceNumber,this.et,t,this.resumeToken)},zi);function zi(t,e,n,r,i,o,s){void 0===i&&(i=Pi.min()),void 0===o&&(o=Pi.min()),void 0===s&&(s=gi.U),this.target=t,this.targetId=e,this.tt=n,this.sequenceNumber=r,this.et=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Hi(t){switch(t){case Tr.OK:return _r(),0;case Tr.CANCELLED:case Tr.UNKNOWN:case Tr.DEADLINE_EXCEEDED:case Tr.RESOURCE_EXHAUSTED:case Tr.INTERNAL:case Tr.UNAVAILABLE:case Tr.UNAUTHENTICATED:return;case Tr.INVALID_ARGUMENT:case Tr.NOT_FOUND:case Tr.ALREADY_EXISTS:case Tr.PERMISSION_DENIED:case Tr.FAILED_PRECONDITION:case Tr.ABORTED:case Tr.OUT_OF_RANGE:case Tr.UNIMPLEMENTED:case Tr.DATA_LOSS:return 1;default:return _r(),0}}function Wi(t){if(void 0===t)return Lr("GRPC error has no .code"),Tr.UNKNOWN;switch(t){case Bi.OK:return Tr.OK;case Bi.CANCELLED:return Tr.CANCELLED;case Bi.UNKNOWN:return Tr.UNKNOWN;case Bi.DEADLINE_EXCEEDED:return Tr.DEADLINE_EXCEEDED;case Bi.RESOURCE_EXHAUSTED:return Tr.RESOURCE_EXHAUSTED;case Bi.INTERNAL:return Tr.INTERNAL;case Bi.UNAVAILABLE:return Tr.UNAVAILABLE;case Bi.UNAUTHENTICATED:return Tr.UNAUTHENTICATED;case Bi.INVALID_ARGUMENT:return Tr.INVALID_ARGUMENT;case Bi.NOT_FOUND:return Tr.NOT_FOUND;case Bi.ALREADY_EXISTS:return Tr.ALREADY_EXISTS;case Bi.PERMISSION_DENIED:return Tr.PERMISSION_DENIED;case Bi.FAILED_PRECONDITION:return Tr.FAILED_PRECONDITION;case Bi.ABORTED:return Tr.ABORTED;case Bi.OUT_OF_RANGE:return Tr.OUT_OF_RANGE;case Bi.UNIMPLEMENTED:return Tr.UNIMPLEMENTED;case Bi.DATA_LOSS:return Tr.DATA_LOSS;default:return _r()}}(l=Bi=Bi||{})[l.OK=0]="OK",l[l.CANCELLED=1]="CANCELLED",l[l.UNKNOWN=2]="UNKNOWN",l[l.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",l[l.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",l[l.NOT_FOUND=5]="NOT_FOUND",l[l.ALREADY_EXISTS=6]="ALREADY_EXISTS",l[l.PERMISSION_DENIED=7]="PERMISSION_DENIED",l[l.UNAUTHENTICATED=16]="UNAUTHENTICATED",l[l.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",l[l.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",l[l.ABORTED=10]="ABORTED",l[l.OUT_OF_RANGE=11]="OUT_OF_RANGE",l[l.UNIMPLEMENTED=12]="UNIMPLEMENTED",l[l.INTERNAL=13]="INTERNAL",l[l.UNAVAILABLE=14]="UNAVAILABLE",l[l.DATA_LOSS=15]="DATA_LOSS";var Yi=($i.prototype.rt=function(t,e){return new $i(this.i,this.root.rt(t,e,this.i).copy(null,null,Ji.ot,null,null))},$i.prototype.remove=function(t){return new $i(this.i,this.root.remove(t,this.i).copy(null,null,Ji.ot,null,null))},$i.prototype.get=function(t){for(var e=this.root;!e.m();){var n=this.i(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},$i.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.m();){var r=this.i(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},$i.prototype.m=function(){return this.root.m()},Object.defineProperty($i.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),$i.prototype.ut=function(){return this.root.ut()},$i.prototype.at=function(){return this.root.at()},$i.prototype.ct=function(t){return this.root.ct(t)},$i.prototype.forEach=function(n){this.ct(function(t,e){return n(t,e),!1})},$i.prototype.toString=function(){var n=[];return this.ct(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},$i.prototype.ht=function(t){return this.root.ht(t)},$i.prototype.lt=function(){return new Xi(this.root,null,this.i,!1)},$i.prototype._t=function(t){return new Xi(this.root,t,this.i,!1)},$i.prototype.ft=function(){return new Xi(this.root,null,this.i,!0)},$i.prototype.dt=function(t){return new Xi(this.root,t,this.i,!0)},$i),Xi=(Zi.prototype.Tt=function(){var t=this.Et.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.m();)this.Et.push(t),t=t.right;else for(t=t.right;!t.m();)this.Et.push(t),t=t.left;return e},Zi.prototype.At=function(){return 0<this.Et.length},Zi.prototype.It=function(){if(0===this.Et.length)return null;var t=this.Et[this.Et.length-1];return{key:t.key,value:t.value}},Zi),Ji=(Ki.prototype.copy=function(t,e,n,r,i){return new Ki(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ki.prototype.m=function(){return!1},Ki.prototype.ct=function(t){return this.left.ct(t)||t(this.key,this.value)||this.right.ct(t)},Ki.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},Ki.prototype.min=function(){return this.left.m()?this:this.left.min()},Ki.prototype.ut=function(){return this.min().key},Ki.prototype.at=function(){return this.right.m()?this.key:this.right.at()},Ki.prototype.rt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.rt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.rt(t,e,n))).Rt()},Ki.prototype.yt=function(){if(this.left.m())return Ki.EMPTY;var t=this;return t.left.Pt()||t.left.left.Pt()||(t=t.Vt()),(t=t.copy(null,null,null,t.left.yt(),null)).Rt()},Ki.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.m()||r.left.Pt()||r.left.left.Pt()||(r=r.Vt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Pt()&&(r=r.gt()),r.right.m()||r.right.Pt()||r.right.left.Pt()||(r=r.vt()),0===e(t,r.key)){if(r.right.m())return Ki.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.yt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Rt()},Ki.prototype.Pt=function(){return this.color},Ki.prototype.Rt=function(){var t=this;return t.right.Pt()&&!t.left.Pt()&&(t=t.bt()),t.left.Pt()&&t.left.left.Pt()&&(t=t.gt()),t.left.Pt()&&t.right.Pt()&&(t=t.St()),t},Ki.prototype.Vt=function(){var t=this.St();return t.right.left.Pt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.gt())).bt()).St()),t},Ki.prototype.vt=function(){var t=this.St();return t.left.left.Pt()&&(t=(t=t.gt()).St()),t},Ki.prototype.bt=function(){var t=this.copy(null,null,Ki.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Ki.prototype.gt=function(){var t=this.copy(null,null,Ki.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Ki.prototype.St=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Ki.prototype.Dt=function(){var t=this.Ct();return Math.pow(2,t)<=this.size+1},Ki.prototype.Ct=function(){if(this.Pt()&&this.left.Pt())throw _r();if(this.right.Pt())throw _r();var t=this.left.Ct();if(t!==this.right.Ct())throw _r();return t+(this.Pt()?0:1)},Ki);function Ki(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Ki.RED,this.left=null!=r?r:Ki.EMPTY,this.right=null!=i?i:Ki.EMPTY,this.size=this.left.size+1+this.right.size}function Zi(t,e,n,r){this.wt=r,this.Et=[];for(var i=1;!t.m();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.wt?t.left:t.right;else{if(0===i){this.Et.push(t);break}this.Et.push(t),t=this.wt?t.right:t.left}}function $i(t,e){this.i=t,this.root=e||Ji.EMPTY}function to(){this.size=0}Ji.EMPTY=null,Ji.RED=!0,Ji.ot=!1,Ji.EMPTY=(Object.defineProperty(to.prototype,"key",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(to.prototype,"value",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(to.prototype,"color",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(to.prototype,"left",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(to.prototype,"right",{get:function(){throw _r()},enumerable:!1,configurable:!0}),to.prototype.copy=function(t,e,n,r,i){return this},to.prototype.rt=function(t,e,n){return new Ji(t,e)},to.prototype.remove=function(t,e){return this},to.prototype.m=function(){return!0},to.prototype.ct=function(t){return!1},to.prototype.ht=function(t){return!1},to.prototype.ut=function(){return null},to.prototype.at=function(){return null},to.prototype.Pt=function(){return!1},to.prototype.Dt=function(){return!0},to.prototype.Ct=function(){return 0},new to);var eo=(oo.prototype.has=function(t){return null!==this.data.get(t)},oo.prototype.first=function(){return this.data.ut()},oo.prototype.last=function(){return this.data.at()},Object.defineProperty(oo.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),oo.prototype.indexOf=function(t){return this.data.indexOf(t)},oo.prototype.forEach=function(n){this.data.ct(function(t,e){return n(t),!1})},oo.prototype.Nt=function(t,e){for(var n=this.data._t(t[0]);n.At();){var r=n.Tt();if(0<=this.i(r.key,t[1]))return;e(r.key)}},oo.prototype.Ft=function(t,e){for(var n=void 0!==e?this.data._t(e):this.data.lt();n.At();)if(!t(n.Tt().key))return},oo.prototype.$t=function(t){t=this.data._t(t);return t.At()?t.Tt().key:null},oo.prototype.lt=function(){return new no(this.data.lt())},oo.prototype._t=function(t){return new no(this.data._t(t))},oo.prototype.add=function(t){return this.copy(this.data.remove(t).rt(t,!0))},oo.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},oo.prototype.m=function(){return this.data.m()},oo.prototype.Lt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},oo.prototype.isEqual=function(t){if(!(t instanceof oo))return!1;if(this.size!==t.size)return!1;for(var e=this.data.lt(),n=t.data.lt();e.At();){var r=e.Tt().key,i=n.Tt().key;if(0!==this.i(r,i))return!1}return!0},oo.prototype.I=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},oo.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},oo.prototype.copy=function(t){var e=new oo(this.i);return e.data=t,e},oo),no=(io.prototype.Tt=function(){return this.Ot.Tt().key},io.prototype.At=function(){return this.Ot.At()},io),ro=new Yi(Br.i);function io(t){this.Ot=t}function oo(t){this.i=t,this.data=new Yi(this.i)}var so=new Yi(Br.i);var uo=new Yi(Br.i);var ao=new eo(Br.i);function ho(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=ao,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var co=new eo(yi);var lo=(Oo.Mt=function(t){return new Oo(t.i)},Oo.prototype.has=function(t){return null!=this.xt.get(t)},Oo.prototype.get=function(t){return this.xt.get(t)},Oo.prototype.first=function(){return this.kt.ut()},Oo.prototype.last=function(){return this.kt.at()},Oo.prototype.m=function(){return this.kt.m()},Oo.prototype.indexOf=function(t){t=this.xt.get(t);return t?this.kt.indexOf(t):-1},Object.defineProperty(Oo.prototype,"size",{get:function(){return this.kt.size},enumerable:!1,configurable:!0}),Oo.prototype.forEach=function(n){this.kt.ct(function(t,e){return n(t),!1})},Oo.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.xt.rt(t.key,t),e.kt.rt(t,null))},Oo.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.xt.remove(t),this.kt.remove(e)):this},Oo.prototype.isEqual=function(t){if(!(t instanceof Oo))return!1;if(this.size!==t.size)return!1;for(var e=this.kt.lt(),n=t.kt.lt();e.At();){var r=e.Tt().key,i=n.Tt().key;if(!r.isEqual(i))return!1}return!0},Oo.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Oo.prototype.copy=function(t,e){var n=new Oo;return n.i=this.i,n.xt=t,n.kt=e,n},Oo),fo=(So.prototype.track=function(t){var e=t.doc.key,n=this.Ut.get(e);!n||0!==t.type&&3===n.type?this.Ut=this.Ut.rt(e,t):3===t.type&&1!==n.type?this.Ut=this.Ut.rt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Ut=this.Ut.rt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Ut=this.Ut.rt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Ut=this.Ut.remove(e):1===t.type&&2===n.type?this.Ut=this.Ut.rt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Ut=this.Ut.rt(e,{type:2,doc:t.doc}):_r()},So.prototype.qt=function(){var n=[];return this.Ut.ct(function(t,e){n.push(e)}),n},So),po=(Ro.Gt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Ro(t,e,lo.Mt(e),i,n,r,!0,!1)},Object.defineProperty(Ro.prototype,"hasPendingWrites",{get:function(){return!this.Qt.m()},enumerable:!1,configurable:!0}),Ro.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.jt===t.jt&&this.Qt.isEqual(t.Qt)&&Mu(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Bt.isEqual(t.Bt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Ro),yo=(No.Jt=function(t,e){var n=new Map;return n.set(t,vo.Xt(t,e)),new No(Pi.min(),n,co,ro,ho())},No),vo=(Ao.Xt=function(t,e){return new Ao(gi.U,e,ho(),ho(),ho())},Ao),go=function(t,e,n,r){this.se=t,this.removedTargetIds=e,this.key=n,this.ie=r},mo=function(t,e){this.targetId=t,this.re=e},wo=function(t,e,n,r){void 0===n&&(n=gi.U),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},bo=(Object.defineProperty(To.prototype,"Zt",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(To.prototype,"resumeToken",{get:function(){return this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(To.prototype,"le",{get:function(){return 0!==this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(To.prototype,"_e",{get:function(){return this.he},enumerable:!1,configurable:!0}),To.prototype.fe=function(t){0<t.k()&&(this.he=!0,this.ae=t)},To.prototype.de=function(){var n=ho(),r=ho(),i=ho();return this.ue.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:_r()}}),new vo(this.ae,this.ce,n,r,i)},To.prototype.we=function(){this.he=!1,this.ue=Lo()},To.prototype.me=function(t,e){this.he=!0,this.ue=this.ue.rt(t,e)},To.prototype.Ee=function(t){this.he=!0,this.ue=this.ue.remove(t)},To.prototype.Te=function(){this.oe+=1},To.prototype.Ae=function(){--this.oe},To.prototype.Ie=function(){this.he=!0,this.ce=!0},To),Eo=(Io.prototype.ge=function(t){for(var e=0,n=t.se;e<n.length;e++){var r=n[e];t.ie instanceof wu?this.ve(r,t.ie):t.ie instanceof bu&&this.be(r,t.key,t.ie)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.be(s,t.key,t.ie)}},Io.prototype.Se=function(n){var r=this;this.De(n,function(t){var e=r.Ce(t);switch(n.state){case 0:r.Ne(t)&&e.fe(n.resumeToken);break;case 1:e.Ae(),e.le||e.we(),e.fe(n.resumeToken);break;case 2:e.Ae(),e.le||r.removeTarget(t);break;case 3:r.Ne(t)&&(e.Ie(),e.fe(n.resumeToken));break;case 4:r.Ne(t)&&(r.Fe(t),e.fe(n.resumeToken));break;default:_r()}})},Io.prototype.De=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ye.forEach(function(t,e){r.Ne(e)&&n(e)})},Io.prototype.$e=function(t){var e=t.targetId,n=t.re.count,t=this.Le(e);t&&(qi(t=t.target)?0===n?(t=new Br(t.path),this.be(e,t,new bu(t,Pi.min()))):kr(1===n):this.Oe(e)!==n&&(this.Fe(e),this.pe=this.pe.add(e)))},Io.prototype.xe=function(r){var i=this,o=new Map;this.ye.forEach(function(t,e){var n=i.Le(e);n&&(t.Zt&&qi(n.target)&&(n=new Br(n.target.path),null!==i.Pe.get(n)||i.ke(e,n)||i.be(e,n,new bu(n,r))),t._e&&(o.set(e,t.de()),t.we()))});var s=ho();this.Ve.forEach(function(t,e){var n=!0;e.Ft(function(t){t=i.Le(t);return!t||2===t.tt||(n=!1)}),n&&(s=s.add(t))});var t=new yo(r,o,this.pe,this.Pe,s);return this.Pe=ro,this.Ve=Po(),this.pe=new eo(yi),t},Io.prototype.ve=function(t,e){var n;this.Ne(t)&&(n=this.ke(t,e.key)?2:0,this.Ce(t).me(e.key,n),this.Pe=this.Pe.rt(e.key,e),this.Ve=this.Ve.rt(e.key,this.Me(e.key).add(t)))},Io.prototype.be=function(t,e,n){var r;this.Ne(t)&&(r=this.Ce(t),this.ke(t,e)?r.me(e,1):r.Ee(e),this.Ve=this.Ve.rt(e,this.Me(e).delete(t)),n&&(this.Pe=this.Pe.rt(e,n)))},Io.prototype.removeTarget=function(t){this.ye.delete(t)},Io.prototype.Oe=function(t){var e=this.Ce(t).de();return this.Re.Ue(t).size+e.te.size-e.ne.size},Io.prototype.Te=function(t){this.Ce(t).Te()},Io.prototype.Ce=function(t){var e=this.ye.get(t);return e||(e=new bo,this.ye.set(t,e)),e},Io.prototype.Me=function(t){var e=this.Ve.get(t);return e||(e=new eo(yi),this.Ve=this.Ve.rt(t,e)),e},Io.prototype.Ne=function(t){var e=null!==this.Le(t);return e||Pr("WatchChangeAggregator","Detected inactive target",t),e},Io.prototype.Le=function(t){var e=this.ye.get(t);return e&&e.le?null:this.Re.qe(t)},Io.prototype.Fe=function(e){var n=this;this.ye.set(e,new bo),this.Re.Ue(e).forEach(function(t){n.be(e,t,null)})},Io.prototype.ke=function(t,e){return this.Re.Ue(t).has(e)},Io);function Io(t){this.Re=t,this.ye=new Map,this.Pe=ro,this.Ve=Po(),this.pe=new eo(yi)}function To(){this.oe=0,this.ue=Lo(),this.ae=gi.U,this.ce=!1,this.he=!0}function Ao(t,e,n,r,i){this.resumeToken=t,this.Zt=e,this.te=n,this.ee=r,this.ne=i}function No(t,e,n,r,i){this.et=t,this.zt=e,this.Kt=n,this.Ht=r,this.Yt=i}function Ro(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Bt=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.jt=s,this.Wt=u}function So(){this.Ut=new Yi(Br.i)}function Oo(n){this.i=n?function(t,e){return n(t,e)||Br.i(t.key,e.key)}:function(t,e){return Br.i(t.key,e.key)},this.xt=so,this.kt=new Yi(this.i)}function Po(){return new Yi(Br.i)}function Lo(){return new Yi(Br.i)}function Vo(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Do(t){t=jo(t.mapValue.fields.__local_write_time__.timestampValue);return new Oi(t.seconds,t.nanos)}var _o=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ko(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Vo(t)?4:10:_r()}function Uo(r,i){var t,e=ko(r);if(e!==ko(i))return!1;switch(e){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return Do(r).isEqual(Do(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=jo(r.timestampValue),t=jo(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,Go(r.bytesValue).isEqual(Go(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,qo((t=r).geoPointValue.latitude)===qo(e.geoPointValue.latitude)&&qo(t.geoPointValue.longitude)===qo(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return qo(t.integerValue)===qo(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){t=qo(t.doubleValue),e=qo(e.doubleValue);return t===e?Ci(t)===Ci(e):isNaN(t)&&isNaN(e)}return!1}(r,i);case 9:return vi(r.arrayValue.values||[],i.arrayValue.values||[],Uo);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(Ur(e)!==Ur(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Uo(e[t],n[t])))return!1;return!0}();default:return _r()}}function Co(t,e){return void 0!==(t.values||[]).find(function(t){return Uo(t,e)})}function Mo(t,e){var n,r,i=ko(t),o=ko(e);if(i!==o)return yi(i,o);switch(i){case 0:return 0;case 1:return yi(t.booleanValue,e.booleanValue);case 2:return n=e,r=qo(t.integerValue||t.doubleValue),n=qo(n.integerValue||n.doubleValue),r<n?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return xo(t.timestampValue,e.timestampValue);case 4:return xo(Do(t),Do(e));case 5:return yi(t.stringValue,e.stringValue);case 6:return function(t,e){t=Go(t),e=Go(e);return t.M(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=yi(n[i],r[i]);if(0!==o)return o}return yi(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return i=t.geoPointValue,r=e.geoPointValue,0!==(n=yi(qo(i.latitude),qo(r.latitude)))?n:yi(qo(i.longitude),qo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Mo(n[i],r[i]);if(o)return o}return yi(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=yi(r[s],o[s]);if(0!==u)return u;u=Mo(n[r[s]],i[o[s]]);if(0!==u)return u}return yi(r.length,o.length)}(t.mapValue,e.mapValue);default:throw _r()}}function xo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return yi(t,e);var n=jo(t),t=jo(e),e=yi(n.seconds,t.seconds);return 0!==e?e:yi(n.nanos,t.nanos)}function Fo(t){return function s(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var t=jo(t);return"time("+t.seconds+","+t.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Go(t.bytesValue).toBase64():"referenceValue"in t?(e=t.referenceValue,Br.C(e).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=s(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(t.mapValue):_r();var e}(t)}function jo(t){if(kr(!!t),"string"!=typeof t)return{seconds:qo(t.seconds),nanos:qo(t.nanos)};var e=0,n=_o.exec(t);kr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n));t=new Date(t);return{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function qo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Go(t){return"string"==typeof t?gi.fromBase64String(t):gi.fromUint8Array(t)}function Bo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.R()}}function Qo(t){return t&&"integerValue"in t}function zo(t){return!!t&&"arrayValue"in t}function Ho(t){return t&&"nullValue"in t}function Wo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Yo(t){return t&&"mapValue"in t}var Xo={asc:"ASCENDING",desc:"DESCENDING"},Jo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ko=function(t,e){this.B=t,this.Be=e};function Zo(t){return{integerValue:""+t}}function $o(t,e){if(t.Be){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ci(e)?"-0":e}}function ts(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!Ci(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Zo(e):$o(t,e);var n}function es(t,e){return t.Be?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function ns(t,e){return t.Be?e.toBase64():e.toUint8Array()}function rs(t){return kr(!!t),Pi.Y((t=jo(t),new Oi(t.seconds,t.nanos)))}function is(t,e){return new jr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).R()}function os(t){t=jr.P(t);return kr(bs(t)),t}function ss(t,e){return is(t.B,e.path)}function us(t,e){e=os(e);return kr(e.get(1)===t.B.projectId),kr(!e.get(3)&&!t.B.database||e.get(3)===t.B.database),new Br(cs(e))}function as(t,e){return is(t.B,e)}function hs(t){return new jr(["projects",t.B.projectId,"databases",t.B.database]).R()}function cs(t){return kr(4<t.length&&"documents"===t.get(4)),t.u(5)}function ls(t,e,n){return{name:ss(t,e),fields:n.proto.mapValue.fields}}function fs(t,e){var n,r,i;if(e instanceof Ks)n={update:ls(t,e.key,e.value)};else if(e instanceof au)n={delete:ss(t,e.key)};else if(e instanceof Zs)n={update:ls(t,e.key,e.data),updateMask:(i=e.Qe,r=[],i.fields.forEach(function(t){return r.push(t.R())}),{fieldPaths:r})};else if(e instanceof ru)n={transform:{document:ss(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof As)return{fieldPath:t.field.R(),setToServerValue:"REQUEST_TIME"};if(e instanceof Ns)return{fieldPath:t.field.R(),appendMissingElements:{values:e.elements}};if(e instanceof Ls)return{fieldPath:t.field.R(),removeAllFromArray:{values:e.elements}};if(e instanceof ks)return{fieldPath:t.field.R(),increment:e.je};throw _r()})}};else{if(!(e instanceof hu))return _r();n={verify:ss(t,e.key)}}return e.Ge.We||(n.currentDocument=void 0!==(i=e.Ge).updateTime?{updateTime:(e=t,t=i.updateTime,es(e,t.X()))}:void 0!==i.exists?{exists:i.exists}:_r()),n}function ps(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=as(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=as(t,r.h()),n.structuredQuery.from=[{collectionId:r._()}]);r=function(t){if(0!==t.length){t=t.map(function(t){if("=="===t.op){if(Wo(t.value))return{unaryFilter:{field:gs(t.field),op:"IS_NAN"}};if(Ho(t.value))return{unaryFilter:{field:gs(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Wo(t.value))return{unaryFilter:{field:gs(t.field),op:"IS_NOT_NAN"}};if(Ho(t.value))return{unaryFilter:{field:gs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:gs(t.field),op:(e=t.op,Jo[e]),value:t.value}};var e});return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(e.filters);r&&(n.structuredQuery.where=r);r=function(t){if(0!==t.length)return t.map(function(t){return{field:gs((t=t).field),direction:(t=t.dir,Xo[t])}})}(e.orderBy);r&&(n.structuredQuery.orderBy=r);r=e.limit,r=t.Be||Ui(r)?r:{value:r};return null!==r&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=ys(e.startAt)),e.endAt&&(n.structuredQuery.endAt=ys(e.endAt)),n}function ds(t){var e=4===(o=os(t.parent)).length?jr.V():cs(o),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(kr(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function e(t){return t?void 0!==t.unaryFilter?[ws(t)]:void 0!==t.fieldFilter?[(n=t,Bu.create(ms(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return _r()}}(),n.fieldFilter.value))]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e(t)}).reduce(function(t,e){return t.concat(e)}):_r():[];var n}(n.where));t=[];n.orderBy&&(t=n.orderBy.map(function(t){return new ga(ms((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));r=null;n.limit&&(r=Ui(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=vs(n.startAt));var u=null;return n.endAt&&(u=vs(n.endAt)),new Iu(e,i,t,o,r,"F",s,u)}function ys(t){return{before:t.before,values:t.position}}function vs(t){var e=!!t.before,t=t.values||[];return new ha(t,e)}function gs(t){return{fieldPath:t.R()}}function ms(t){return Gr.S(t.fieldPath)}function ws(t){switch(t.unaryFilter.op){case"IS_NAN":var e=ms(t.unaryFilter.field);return Bu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=ms(t.unaryFilter.field);return Bu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":n=ms(t.unaryFilter.field);return Bu.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":t=ms(t.unaryFilter.field);return Bu.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return _r()}}function bs(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}l=function(){this.ze=void 0};function Es(t,e){return t instanceof ks?Qo(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var Is,Ts,As=(n(Ss,Ts=l),Ss),Ns=(n(Rs,Is=l),Rs);function Rs(t){var e=this;return(e=Is.call(this)||this).elements=t,e}function Ss(){return null!==Ts&&Ts.apply(this,arguments)||this}function Os(t,e){for(var n=Ms(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Uo(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var Ps,Ls=(n(Vs,Ps=l),Vs);function Vs(t){var e=this;return(e=Ps.call(this)||this).elements=t,e}function Ds(t,e){for(var n=Ms(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Uo(t,e)})}(i[r]);return{arrayValue:{values:n}}}var _s,ks=(n(Us,_s=l),Us);function Us(t,e){var n=this;return(n=_s.call(this)||this).serializer=t,n.je=e,n}function Cs(t){return qo(t.integerValue||t.doubleValue)}function Ms(t){return zo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function xs(t,e){this.field=t,this.transform=e}var Fs=(js.prototype.Ke=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].T(t))return!0;return!1},js.prototype.isEqual=function(t){return vi(this.fields,t.fields,function(t,e){return t.isEqual(e)})},js);function js(t){(this.fields=t).sort(Gr.i)}function qs(t,e){this.version=t,this.transformResults=e}var Gs=(Bs.He=function(){return new Bs},Bs.exists=function(t){return new Bs(void 0,t)},Bs.updateTime=function(t){return new Bs(t)},Object.defineProperty(Bs.prototype,"We",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Bs.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Bs);function Bs(t,e){this.updateTime=t,this.exists=e}function Qs(t,e){return void 0!==t.updateTime?e instanceof wu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof wu}l=function(){};function zs(t,e,n){return t instanceof Ks?new wu(t.key,n.version,t.value,{hasCommittedMutations:!0}):t instanceof Zs?function(t,e,n){if(!Qs(t.Ge,e))return new Eu(t.key,n.version);e=eu(t,e);return new wu(t.key,n.version,e,{hasCommittedMutations:!0})}(t,e,n):t instanceof ru?function(t,e,n){if(kr(null!=n.transformResults),!Qs(t.Ge,e))return new Eu(t.key,n.version);var r=e,e=function(t,e,n){var r=[];kr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof wu&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof Ns?Os(o,s):o instanceof Ls?Ds(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=ou(t,r.data(),e);return new wu(t.key,n,e,{hasCommittedMutations:!0})}(t,e,n):new bu(t.key,n.version,{hasCommittedMutations:!0})}function Hs(t,e,n,r){return t instanceof Ks?function(t,e){if(!Qs(t.Ge,e))return e;e=Ys(e);return new wu(t.key,e,t.value,{Ye:!0})}(t,e):t instanceof Zs?function(t,e){if(!Qs(t.Ge,e))return e;var n=Ys(e),e=eu(t,e);return new wu(t.key,n,e,{Ye:!0})}(t,e):t instanceof ru?function(t,e,n,r){if(!Qs(t.Ge,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],h=a.transform,c=null;n instanceof wu&&(c=n.field(a.field)),null===c&&r instanceof wu&&(c=r.field(a.field)),o.push((i=c,a=e,c=void 0,(h=h)instanceof As?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(c.fields.__previous_value__=i),{mapValue:c}):h instanceof Ns?Os(h,i):h instanceof Ls?Ds(h,i):(h=Es(c=h,i),i=Cs(h)+Cs(c.je),Qo(h)&&Qo(c.je)?Zo(i):$o(c.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=ou(t,i.data(),r);return new wu(t.key,i.version,r,{Ye:!0})}(t,e,r,n):(e=e,Qs((t=t).Ge,e)?new bu(t.key,Pi.min()):e)}function Ws(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ge.isEqual(e.Ge)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||vi(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof Ns&&e instanceof Ns||t instanceof Ls&&e instanceof Ls?vi(t.elements,e.elements,Uo):t instanceof ks&&e instanceof ks?Uo(t.je,e.je):t instanceof As&&e instanceof As)}))}function Ys(t){return t instanceof wu?t.version:Pi.min()}var Xs,Js,Ks=(n(tu,Js=l),tu),Zs=(n($s,Xs=l),$s);function $s(t,e,n,r){var i=this;return(i=Xs.call(this)||this).key=t,i.data=e,i.Qe=n,i.Ge=r,i.type=1,i}function tu(t,e,n){var r=this;return(r=Js.call(this)||this).key=t,r.value=e,r.Ge=n,r.type=0,r}function eu(t,e){return n=t,e=e instanceof wu?e.data():cu.empty(),r=new lu(e),n.Qe.fields.forEach(function(t){var e;t.m()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Je();var n,r}var nu,ru=(n(iu,nu=l),iu);function iu(t,e){var n=this;return(n=nu.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ge=Gs.exists(!0),n}function ou(t,e,n){for(var r=new lu(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Je()}var su,uu,au=(n(yu,uu=l),yu),hu=(n(du,su=l),du),cu=(pu.empty=function(){return new pu({mapValue:{}})},pu.prototype.field=function(t){if(t.m())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Yo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t._()])||null},pu.prototype.isEqual=function(t){return Uo(this.proto,t.proto)},pu),lu=(fu.prototype.set=function(t,e){return this.tn(t,e),this},fu.prototype.delete=function(t){return this.tn(t,null),this},fu.prototype.tn=function(t,e){for(var n=this.Ze,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===ko(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t._(),e)},fu.prototype.Je=function(){var t=this.en(Gr.V(),this.Ze);return null!=t?new cu(t):this.Xe},fu.prototype.en=function(r,t){var i=this,o=!1,e=this.Xe.field(r),s=Yo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.en(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},fu);function fu(t){void 0===t&&(t=cu.empty()),this.Xe=t,this.Ze=new Map}function pu(t){this.proto=t}function du(t,e){var n=this;return(n=su.call(this)||this).key=t,n.Ge=e,n.type=4,n}function yu(t,e){var n=this;return(n=uu.call(this)||this).key=t,n.Ge=e,n.type=3,n}var vu,gu,mu,l=function(t,e){this.key=t,this.version=e},wu=(n(Nu,mu=l),Nu.prototype.field=function(t){return this.nn.field(t)},Nu.prototype.data=function(){return this.nn},Nu.prototype.sn=function(){return this.nn.proto},Nu.prototype.isEqual=function(t){return t instanceof Nu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ye===t.Ye&&this.hasCommittedMutations===t.hasCommittedMutations&&this.nn.isEqual(t.nn)},Nu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.nn.toString()+", {hasLocalMutations: "+this.Ye+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Nu.prototype,"hasPendingWrites",{get:function(){return this.Ye||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Nu),bu=(n(Au,gu=l),Au.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Au.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Au.prototype.isEqual=function(t){return t instanceof Au&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Au),Eu=(n(Tu,vu=l),Tu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Tu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Tu.prototype.isEqual=function(t){return t instanceof Tu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Tu),Iu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.rn=n,this.filters=r,this.limit=i,this.on=o,this.startAt=s,this.endAt=u,this.un=null,this.an=null,this.startAt,this.endAt};function Tu(){return null!==vu&&vu.apply(this,arguments)||this}function Au(t,e,n){var r=this;return(r=gu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Nu(t,e,n,r){var i=this;return(i=mu.call(this,t,e)||this).nn=n,i.Ye=!!r.Ye,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Ru(t){return new Iu(t)}function Su(t){return!Ui(t.limit)&&"F"===t.on}function Ou(t){return!Ui(t.limit)&&"L"===t.on}function Pu(t){return 0<t.rn.length?t.rn[0].field:null}function Lu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.cn())return r.field}return null}function Vu(t){return null!==t.collectionGroup}function Du(t){var e=t;if(null===e.un){e.un=[];var n=Lu(e),t=Pu(e);if(null!==n&&null===t)n.g()||e.un.push(new ga(n)),e.un.push(new ga(Gr.v(),"asc"));else{for(var r=!1,i=0,o=e.rn;i<o.length;i++){var s=o[i];e.un.push(s),s.field.g()&&(r=!0)}r||(n=0<e.rn.length?e.rn[e.rn.length-1].dir:"asc",e.un.push(new ga(Gr.v(),n)))}}return e.un}function _u(t){var e=t;if(!e.an)if("F"===e.on)e.an=xi(e.path,e.collectionGroup,Du(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Du(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new ga(o.field,s))}var u=e.endAt?new ha(e.endAt.position,!e.endAt.before):null,t=e.startAt?new ha(e.startAt.position,!e.startAt.before):null;e.an=xi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.an}function ku(t,e,n){return new Iu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Uu(t,e){return new Iu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,e,t.endAt)}function Cu(t,e){return new Iu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,t.startAt,e)}function Mu(t,e){return ji(_u(t),_u(e))&&t.on===e.on}function xu(t){return Fi(_u(t))+"|lt:"+t.on}function Fu(t){return"Query(target="+(e=_u(t),n=e.path.R(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.R()+" "+t.op+" "+Fo(t.value)}).join(", ")+"]"),Ui(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.R()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+da(e.startAt)),e.endAt&&(n+=", endAt: "+da(e.endAt)),"Target("+n+")")+"; limitType="+t.on+")";var e,n}function ju(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.N(e.collectionGroup)&&e.path.T(n):Br.F(e.path)?e.path.isEqual(n):e.path.A(n))&&function(t){for(var e=0,n=i.rn;e<n.length;e++){var r=n[e];if(!r.field.g()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||ya(t.startAt,Du(t),n))&&(!t.endAt||!ya(t.endAt,Du(t),n)));var e,n}function qu(u){return function(t,e){for(var n=!1,r=0,i=Du(u);r<i.length;r++){var o=i[r],s=function(t,r,e){e=t.field.g()?Br.i(r.key,e.key):function(t,e){var n=r.field(t),t=e.field(t);return null!==n&&null!==t?Mo(n,t):_r()}(t.field,e);switch(t.dir){case"asc":return e;case"desc":return-1*e;default:return _r()}}(o,t,e);if(0!==s)return s;n=n||o.field.g()}return 0}}var Gu,Bu=(n(Qu,Gu=function(){}),Qu.create=function(t,e,n){if(t.g())return"in"===e||"not-in"===e?this.hn(t,e,n):new Yu(t,e,n);if(Ho(n)){if("=="!==e&&"!="!==e)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. Null only supports '==' and '!=' comparisons.");return new Qu(t,e,n)}if(Wo(n)){if("=="!==e&&"!="!==e)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. NaN only supports '==' and '!=' comparisons.");return new Qu(t,e,n)}return"array-contains"===e?new oa(t,n):"in"===e?new sa(t,n):"not-in"===e?new ua(t,n):"array-contains-any"===e?new aa(t,n):new Qu(t,e,n)},Qu.hn=function(t,e,n){return new("in"===e?Xu:Ju)(t,n)},Qu.prototype.matches=function(t){t=t.field(this.field);return"!="===this.op?null!==t&&this.ln(Mo(t,this.value)):null!==t&&ko(this.value)===ko(t)&&this.ln(Mo(t,this.value))},Qu.prototype.ln=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return _r()}},Qu.prototype.cn=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Qu);function Qu(t,e,n){var r=this;return(r=Gu.call(this)||this).field=t,r.op=e,r.value=n,r}var zu,Hu,Wu,Yu=(n($u,Wu=Bu),$u.prototype.matches=function(t){t=Br.i(t.key,this.key);return this.ln(t)},$u),Xu=(n(Zu,Hu=Bu),Zu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Zu),Ju=(n(Ku,zu=Bu),Ku.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Ku);function Ku(t,e){var n=this;return(n=zu.call(this,t,"not-in",e)||this).keys=ta(0,e),n}function Zu(t,e){var n=this;return(n=Hu.call(this,t,"in",e)||this).keys=ta(0,e),n}function $u(t,e,n){var r=this;return(r=Wu.call(this,t,e,n)||this).key=Br.C(n.referenceValue),r}function ta(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return Br.C(t.referenceValue)})}var ea,na,ra,ia,oa=(n(pa,ia=Bu),pa.prototype.matches=function(t){t=t.field(this.field);return zo(t)&&Co(t.arrayValue,this.value)},pa),sa=(n(fa,ra=Bu),fa.prototype.matches=function(t){t=t.field(this.field);return null!==t&&Co(this.value.arrayValue,t)},fa),ua=(n(la,na=Bu),la.prototype.matches=function(t){if(Co(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;t=t.field(this.field);return null!==t&&!Co(this.value.arrayValue,t)},la),aa=(n(ca,ea=Bu),ca.prototype.matches=function(t){var e=this,t=t.field(this.field);return!(!zo(t)||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return Co(e.value.arrayValue,t)})},ca),ha=function(t,e){this.position=t,this.before=e};function ca(t,e){return ea.call(this,t,"array-contains-any",e)||this}function la(t,e){return na.call(this,t,"not-in",e)||this}function fa(t,e){return ra.call(this,t,"in",e)||this}function pa(t,e){return ia.call(this,t,"array-contains",e)||this}function da(t){return(t.before?"b":"a")+":"+t.position.map(Fo).join(",")}function ya(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.g()?Br.i(Br.C(s.referenceValue),n.key):Mo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function va(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Uo(t.position[n],e.position[n]))return!1;return!0}var ga=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function ma(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var wa=(Ia.prototype.reset=function(){this.En=0},Ia.prototype.In=function(){this.En=this.mn},Ia.prototype.Rn=function(t){var e=this;this.cancel();var n=Math.floor(this.En+this.yn()),r=Math.max(0,Date.now()-this.An),i=Math.max(0,n-r);0<i&&Pr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.En+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Tn=this._n.Pn(this.fn,i,function(){return e.An=Date.now(),t()}),this.En*=this.wn,this.En<this.dn&&(this.En=this.dn),this.En>this.mn&&(this.En=this.mn)},Ia.prototype.Vn=function(){null!==this.Tn&&(this.Tn.pn(),this.Tn=null)},Ia.prototype.cancel=function(){null!==this.Tn&&(this.Tn.cancel(),this.Tn=null)},Ia.prototype.yn=function(){return(Math.random()-.5)*this.En},Ia),ba=(Ea.prototype.catch=function(t){return this.next(void 0,t)},Ea.prototype.next=function(r,i){var o=this;return this.Sn&&_r(),this.Sn=!0,this.bn?this.error?this.Dn(i,this.error):this.Cn(r,this.result):new Ea(function(e,n){o.gn=function(t){o.Cn(r,t).next(e,n)},o.vn=function(t){o.Dn(i,t).next(e,n)}})},Ea.prototype.Nn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},Ea.prototype.Fn=function(t){try{var e=t();return e instanceof Ea?e:Ea.resolve(e)}catch(t){return Ea.reject(t)}},Ea.prototype.Cn=function(t,e){return t?this.Fn(function(){return t(e)}):Ea.resolve(e)},Ea.prototype.Dn=function(t,e){return t?this.Fn(function(){return t(e)}):Ea.reject(e)},Ea.resolve=function(n){return new Ea(function(t,e){t(n)})},Ea.reject=function(n){return new Ea(function(t,e){e(n)})},Ea.$n=function(t){return new Ea(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},Ea.Ln=function(t){for(var n=Ea.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?Ea.resolve(t):e()})}(r[e]);return n},Ea.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.$n(i)},Ea);function Ea(t){var e=this;this.gn=null,this.vn=null,this.result=void 0,this.error=void 0,this.bn=!1,this.Sn=!1,t(function(t){e.bn=!0,e.result=t,e.gn&&e.gn(t)},function(t){e.bn=!0,e.error=t,e.vn&&e.vn(t)})}function Ia(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this._n=t,this.fn=e,this.dn=n,this.wn=r,this.mn=i,this.En=0,this.Tn=null,this.An=Date.now(),this.reset()}function Ta(t){return"IndexedDbTransactionError"===t.name}function Aa(){return"undefined"!=typeof document?document:null}var Na=(Oa.Un=function(t,e,n,r,i){i=new Oa(t,e,Date.now()+n,r,i);return i.start(n),i},Oa.prototype.start=function(t){var e=this;this.qn=setTimeout(function(){return e.Bn()},t)},Oa.prototype.pn=function(){return this.Bn()},Oa.prototype.cancel=function(t){null!==this.qn&&(this.clearTimeout(),this.Mn.reject(new Ar(Tr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Oa.prototype.Bn=function(){var e=this;this.On.Qn(function(){return null!==e.qn?(e.clearTimeout(),e.op().then(function(t){return e.Mn.resolve(t)})):Promise.resolve()})},Oa.prototype.clearTimeout=function(){null!==this.qn&&(this.kn(this),clearTimeout(this.qn),this.qn=null)},Oa),Ra=(Object.defineProperty(Sa.prototype,"Zn",{get:function(){return this.Gn},enumerable:!1,configurable:!0}),Sa.prototype.Qn=function(t){this.enqueue(t)},Sa.prototype.ts=function(t){this.es(),this.ns(t)},Sa.prototype.ss=function(){var t;this.Gn||(this.Gn=!0,(t=Aa())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xn))},Sa.prototype.enqueue=function(t){return this.es(),this.Gn?new Promise(function(t){}):this.ns(t)},Sa.prototype.rs=function(t){var e=this;this.Wn.push(t),this.Qn(function(){return e.os()})},Sa.prototype.os=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Wn.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Wn[0]()];case 2:return t.sent(),this.Wn.shift(),this.Jn.reset(),[3,4];case 3:if(!Ta(e=t.sent()))throw e;return Pr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Wn.length&&this.Jn.Rn(function(){return n.os()}),t.label=5;case 5:return[2]}})})},Sa.prototype.ns=function(t){var r=this,e=this.jn.then(function(){return r.Hn=!0,t().catch(function(t){throw r.Kn=t,r.Hn=!1,Lr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Hn=!1,t})});return this.jn=e},Sa.prototype.Pn=function(t,e,n){var r=this;this.es(),-1<this.Yn.indexOf(t)&&(e=0);n=Na.Un(this,t,e,n,function(t){return r.us(t)});return this.zn.push(n),n},Sa.prototype.es=function(){this.Kn&&_r()},Sa.prototype.cs=function(){},Sa.prototype.hs=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.jn];case 1:t.sent(),t.label=2;case 2:if(e!==this.jn)return[3,0];t.label=3;case 3:return[2]}})})},Sa.prototype.ls=function(t){for(var e=0,n=this.zn;e<n.length;e++)if(n[e].fn===t)return!0;return!1},Sa.prototype._s=function(r){var i=this;return this.hs().then(function(){i.zn.sort(function(t,e){return t.xn-e.xn});for(var t=0,e=i.zn;t<e.length;t++){var n=e[t];if(n.pn(),"all"!==r&&n.fn===r)break}return i.hs()})},Sa.prototype.fs=function(t){this.Yn.push(t)},Sa.prototype.us=function(t){t=this.zn.indexOf(t);this.zn.splice(t,1)},Sa);function Sa(){var e=this;this.jn=Promise.resolve(),this.Wn=[],this.Gn=!1,this.zn=[],this.Kn=null,this.Hn=!1,this.Yn=[],this.Jn=new wa(this,"async_queue_retry"),this.Xn=function(){var t=Aa();t&&Pr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.Jn.Vn()};var t=Aa();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Xn)}function Oa(t,e,n,r,i){this.On=t,this.fn=e,this.xn=n,this.op=r,this.kn=i,this.Mn=new ma,this.then=this.Mn.promise.then.bind(this.Mn.promise),this.Mn.promise.catch(function(t){})}function Pa(t,e){if(Lr("AsyncQueue",e+": "+t),Ta(t))return new Ar(Tr.UNAVAILABLE,e+": "+t);throw t}function La(){this.ds=void 0,this.listeners=[]}function Va(){this.ws=new Si(xu,Mu),this.onlineState="Unknown",this.Es=new Set}function Da(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.ws.get(n))||(r=!0,i=new La),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Ts(n)];case 2:return o.ds=t.sent(),[3,4];case 3:return o=t.sent(),o=Pa(o,"Initialization of query '"+Fu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.ws.set(n,i),i.listeners.push(u),u.As(e.onlineState),i.ds&&u.Is(i.ds)&&ka(e),[2]}})})}function _a(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.ws.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.ws.delete(n),e.Rs(n))]:[2]})})}function ka(t){t.Es.forEach(function(t){t.next()})}var Ua=(xa.prototype.Is=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new po(t.query,t.docs,t.Bt,e,t.Qt,t.fromCache,t.jt,!0)}var o=!1;return this.Ps?this.ps(t)&&(this.ys.next(t),o=!0):this.gs(t,this.onlineState)&&(this.vs(t),o=!0),this.Vs=t,o},xa.prototype.onError=function(t){this.ys.error(t)},xa.prototype.As=function(t){this.onlineState=t;var e=!1;return this.Vs&&!this.Ps&&this.gs(this.Vs,t)&&(this.vs(this.Vs),e=!0),e},xa.prototype.gs=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.bs&&n||t.docs.m()&&"Offline"!==e)},xa.prototype.ps=function(t){if(0<t.docChanges.length)return!0;var e=this.Vs&&this.Vs.hasPendingWrites!==t.hasPendingWrites;return!(!t.jt&&!e)&&!0===this.options.includeMetadataChanges},xa.prototype.vs=function(t){t=po.Gt(t.query,t.docs,t.Qt,t.fromCache),this.Ps=!0,this.ys.next(t)},xa),Ca=(Ma.prototype.Ss=function(){return null!=this.uid},Ma.prototype.Ds=function(){return this.Ss()?"uid:"+this.uid:"anonymous-user"},Ma.prototype.isEqual=function(t){return t.uid===this.uid},Ma);function Ma(t){this.uid=t}function xa(t,e,n){this.query=t,this.ys=e,this.Ps=!1,this.Vs=null,this.onlineState="Unknown",this.options=n||{}}Ca.UNAUTHENTICATED=new Ca(null),Ca.Cs=new Ca("google-credentials-uid"),Ca.Ns=new Ca("first-party-uid");var Fa=(ja.prototype.$s=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},ja.prototype.next=function(){var t=++this.previousValue;return this.Ls&&this.Ls(t),t},ja);function ja(t,e){var n=this;this.previousValue=t,e&&(e.Fs=function(t){return n.$s(t)},this.Ls=function(t){return e.Os(t)})}Fa.xs=-1;var qa=(Ya.prototype.ks=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Ya.prototype.Ms=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Ya.prototype.Us=function(){var t={activeTargetIds:this.activeTargetIds.I(),updateTimeMs:Date.now()};return JSON.stringify(t)},Ya),Ga=(Wa.prototype.js=function(t){},Wa.prototype.Ws=function(t,e,n){},Wa.prototype.Gs=function(t){return this.qs.ks(t),this.Bs[t]||"not-current"},Wa.prototype.zs=function(t,e,n){this.Bs[t]=e},Wa.prototype.Ks=function(t){this.qs.Ms(t)},Wa.prototype.Hs=function(t){return this.qs.activeTargetIds.has(t)},Wa.prototype.Ys=function(t){delete this.Bs[t]},Wa.prototype.Js=function(){return this.qs.activeTargetIds},Wa.prototype.Xs=function(t){return this.qs.activeTargetIds.has(t)},Wa.prototype.start=function(){return this.qs=new qa,Promise.resolve()},Wa.prototype.Zs=function(t,e,n){},Wa.prototype.ti=function(t){},Wa.prototype.ei=function(){},Wa.prototype.Os=function(t){},Wa.prototype.ni=function(){},Wa),Ba=(Ha.prototype.ii=function(t,e,n){for(var r=n.ri,i=0;i<this.mutations.length;i++){var o=this.mutations[i];o.key.isEqual(t)&&(e=zs(o,e,r[i]))}return e},Ha.prototype.oi=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Hs(i,e,e,this.si))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Hs(a,e,o,this.si))}return e},Ha.prototype.ui=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.oi(t.key,n.get(t.key));e&&(i=i.rt(t.key,e))}),i},Ha.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},ho())},Ha.prototype.isEqual=function(t){return this.batchId===t.batchId&&vi(this.mutations,t.mutations,Ws)&&vi(this.baseMutations,t.baseMutations,Ws)},Ha),Qa=(za.from=function(t,e,n){kr(t.mutations.length===n.length);for(var r=uo,i=t.mutations,o=0;o<i.length;o++)r=r.rt(i[o].key,n[o].version);return new za(t,e,n,r)},za);function za(t,e,n,r){this.batch=t,this.ai=e,this.ri=n,this.ci=r}function Ha(t,e,n,r){this.batchId=t,this.si=e,this.baseMutations=n,this.mutations=r}function Wa(){this.qs=new qa,this.Bs={},this.Qs=null,this.Fs=null}function Ya(){this.activeTargetIds=co}function Xa(n,r){void 0===r&&(r=10240);var i=0;return{read:function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return i<n.byteLength?(e={value:n.slice(i,i+r),done:!1},[2,(i+=r,e)]):[2,{value:void 0,done:!0}]})})},cancel:function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2]})})},releaseLock:function(){}}}function Ja(t,e){if(t instanceof Uint8Array)return Xa(t,e);if(t instanceof ArrayBuffer)return Xa(new Uint8Array(t),e);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}function Ka(t){return new Ko(t,!0)}var Za=(rh.prototype.hi=function(){return"metadata"in this.payload},rh),$a=(nh.di=function(t,e){return new nh(Ja(t,10240),e)},nh.prototype.close=function(){return this.li.cancel()},nh.prototype.getMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.metadata.promise]})})},nh.prototype.wi=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.fi())]}})})},nh.prototype.fi=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return[4,this.mi()];case 1:return null===(e=t.sent())?[2,null]:(r=this._i.decode(e),n=Number(r),isNaN(n)&&this.Ei("length string ("+r+") is not valid number"),[4,this.Ti(n)]);case 2:return r=t.sent(),[2,new Za(JSON.parse(r),e.length+n)]}})})},nh.prototype.Ai=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},nh.prototype.mi=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.Ai()<0?[4,this.Ii()]:[3,3];case 1:if(t.sent())return[3,3];t.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.Ai())<0&&this.Ei("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),n)])}})})},nh.prototype.Ti=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.buffer.length<n?[4,this.Ii()]:[3,3];case 1:t.sent()&&this.Ei("Reached the end of bundle when more is expected."),t.label=2;case 2:return[3,0];case 3:return e=this._i.decode(this.buffer.slice(0,n)),[2,(this.buffer=this.buffer.slice(n),e)]}})})},nh.prototype.Ei=function(t){throw this.li.cancel(),new Error("Invalid bundle format: "+t)},nh.prototype.Ii=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.li.read()];case 1:return(e=t.sent()).done||((n=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n),[2,e.done]}})})},nh),th=(eh.prototype.Ri=function(t){return us(this.serializer,t)},eh.prototype.yi=function(t){return t.metadata.exists?(e=this.serializer,n=t.document,r=us(e,n.name),e=rs(n.updateTime),n=new cu({mapValue:{fields:n.fields}}),new wu(r,e,n,{hasCommittedMutations:!1})):new bu(this.Ri(t.metadata.name),this.Pi(t.metadata.readTime));var e,n,r},eh.prototype.Pi=rs,eh);function eh(t){this.serializer=t}function nh(t,e){var n=this;this.li=t,this.serializer=e,this.metadata=new ma,this.buffer=new Uint8Array,this._i=new TextDecoder("utf-8"),this.fi().then(function(t){t&&t.hi()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function rh(t,e){this.payload=t,this.byteLength=e}function ih(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}function oh(t,e){this.progress=t,this.Vi=e}var sh=(ph.prototype.vi=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.ws.push(t.payload.namedQuery):t.payload.bi?(this.documents.push({metadata:t.payload.bi}),t.payload.bi.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},ph.prototype.Si=function(t){for(var e=new Map,n=new th(this.serializer),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.ws)for(var s=n.Ri(o.metadata.name),u=0,a=o.metadata.ws;u<a.length;u++){var h=a[u],c=(e.get(h)||ho()).add(s);e.set(h,c)}}return e},ph.prototype.complete=function(){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return[4,function(f,p,d){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a,h,c,l;return v(this,function(t){switch(t.label){case 0:for(e=new th((n=f).serializer),r=ho(),i=ro,o=uo,s=0,u=p;s<u.length;s++)a=u[s],h=e.Ri(a.metadata.name),a.document&&(r=r.add(h)),i=i.rt(h,e.yi(a)),o=o.rt(h,e.Pi(a.metadata.readTime));return c=n.Ci.Di({Ni:!0}),[4,Oh(n,_u(Ru(jr.P("__bundle__/docs/"+d))))];case 1:return l=t.sent(),[2,n.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return Sh(e,c,i,Pi.min(),o).next(function(t){return c.apply(e),t}).next(function(t){return n.$i.Fi(e,l.targetId).next(function(){return n.$i.Li(e,r,l.targetId)}).next(function(){return n.xi.Oi(e,t)})})})]}})})}(this.gi,this.documents,this.pi.id)];case 1:e=t.sent(),n=this.Si(this.documents),r=0,i=this.ws,t.label=2;case 2:return r<i.length?(i=i[r],[4,function(e,i,o){return void 0===o&&(o=ho()),y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return[4,Oh(e,_u(yh(i.bundledQuery)))];case 1:return n=t.sent(),[2,(r=e).persistence.runTransaction("Save named query","readwrite",function(t){var e=rs(i.readTime);if(0<=n.et.M(e))return r.Cr.eo(t,i);e=n.st(gi.U,e);return r.Vr=r.Vr.rt(e.targetId,e),r.$i.Qr(t,e).next(function(){return r.$i.Fi(t,n.targetId)}).next(function(){return r.$i.Li(t,o,n.targetId)}).next(function(){return r.Cr.eo(t,i)})})]}})})}(this.gi,i,n.get(i.name))]):[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[2,(this.progress.taskState="Success",new oh(Object.assign({},this.progress),e))]}})})},ph),uh=(fh.prototype.qi=function(e,n){var r=this;return this.Mi.Bi(e,n).next(function(t){return r.Qi(e,n,t)})},fh.prototype.Qi=function(t,r,i){return this.ki.ji(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].oi(r,t);return t})},fh.prototype.Wi=function(t,e,i){var o=ro;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].oi(t,e);o=o.rt(t,e)}),o},fh.prototype.Gi=function(e,t){var n=this;return this.ki.getEntries(e,t).next(function(t){return n.Oi(e,t)})},fh.prototype.Oi=function(e,r){var i=this;return this.Mi.zi(e,r).next(function(t){var t=i.Wi(e,r,t),n=ro;return t.forEach(function(t,e){e=e||new bu(t,Pi.min()),n=n.rt(t,e)}),n})},fh.prototype.Ki=function(t,e,n){return r=e,Br.F(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Hi(t,e.path):Vu(e)?this.Yi(t,e,n):this.Ji(t,e,n);var r},fh.prototype.Hi=function(t,e){return this.qi(t,new Br(e)).next(function(t){var e=so;return t instanceof wu&&(e=e.rt(t.key,t)),e})},fh.prototype.Yi=function(n,r,i){var o=this,s=r.collectionGroup,u=so;return this.Ui.Xi(n,s).next(function(t){return ba.forEach(t,function(t){var e,e=(e=r,t=t.child(s),new Iu(t,null,e.rn.slice(),e.filters.slice(),e.limit,e.on,e.startAt,e.endAt));return o.Ji(n,e,i).next(function(t){t.forEach(function(t,e){u=u.rt(t,e)})})}).next(function(){return u})})},fh.prototype.Ji=function(e,n,t){var h,c,r=this;return this.ki.Ki(e,n,t).next(function(t){return h=t,r.Mi.Zi(e,n)}).next(function(t){return c=t,r.tr(e,c,h).next(function(t){h=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=h.get(u),a=Hs(s,a,a,r.si);h=a instanceof wu?h.rt(u,a):h.remove(u)}})}).next(function(){return h.forEach(function(t,e){ju(n,e)||(h=h.remove(t))}),h})},fh.prototype.tr=function(t,e,n){for(var r=ho(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Zs&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.ki.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof wu&&(h=h.rt(t,e))}),h})},fh),ah=(lh.sr=function(t,e){for(var n=ho(),r=ho(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new lh(t,e.fromCache,n,r)},lh),hh=(ch.ar=function(t){return new ch(t,ch.cr,ch.hr)},ch);function ch(t,e,n){this.ir=t,this.rr=e,this.ur=n}function lh(t,e,n,r){this.targetId=t,this.fromCache=e,this.er=n,this.nr=r}function fh(t,e,n){this.ki=t,this.Mi=e,this.Ui=n}function ph(t,e,n){this.pi=t,this.gi=e,this.serializer=n,this.ws=[],this.documents=[],this.progress=ih(t)}hh.lr=-1,hh._r=1048576,hh.dr=41943040,hh.cr=10,hh.hr=1e3,hh.wr=new hh(hh.dr,hh.cr,hh.hr),hh.mr=new hh(hh.lr,0,0);function dh(t){this.Er=t}function yh(t){var e=ds({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.on?ku(e,e.limit,"L"):e}var vh=(Th.prototype.Ar=function(t,e){return this.Tr.add(e),ba.resolve()},Th.prototype.Xi=function(t,e){return ba.resolve(this.Tr.getEntries(e))},Th),gh=(Ih.prototype.add=function(t){var e=t._(),n=t.h(),r=this.index[e]||new eo(jr.i),t=!r.has(n);return this.index[e]=r.add(n),t},Ih.prototype.has=function(t){var e=t._(),t=t.h(),e=this.index[e];return e&&e.has(t)},Ih.prototype.getEntries=function(t){return(this.index[t]||new eo(jr.i)).I()},Ih),mh=(Eh.prototype.next=function(){return this.Ir+=2,this.Ir},Eh.Rr=function(){return new Eh(0)},Eh.yr=function(){return new Eh(-1)},Eh),wh=(bh.prototype.$r=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Lr(t,n.Vr)})},bh);function bh(t,e,n,r){this.persistence=t,this.Pr=e,this.serializer=r,this.Vr=new Yi(yi),this.pr=new Si(Fi,ji),this.gr=Pi.min(),this.Mi=t.vr(n),this.Ci=t.br(),this.$i=t.Sr(),this.xi=new uh(this.Ci,this.Mi,this.persistence.Dr()),this.Cr=t.Nr(),this.Pr.Fr(this.xi)}function Eh(t){this.Ir=t}function Ih(){this.index={}}function Th(){this.Tr=new gh}function Ah(t,c){var l=t;return l.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e,r,i,o,s,n,u,a=c.batch.keys(),h=l.Ci.Di({Ni:!0});return e=l,r=t,o=h,s=(i=c).batch,n=s.keys(),u=ba.resolve(),n.forEach(function(n){u=u.next(function(){return o.ji(r,n)}).next(function(t){var e=t,t=i.ci.get(n);kr(null!==t),(!e||e.version.M(t)<0)&&(e=s.ii(n,e,i))&&o.Or(e,i.ai)})}),u.next(function(){return e.Mi.kr(r,s)}).next(function(){return h.apply(t)}).next(function(){return l.Mi.Mr(t)}).next(function(){return l.xi.Gi(t,a)})})}function Nh(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.$i.Ur(t)})}function Rh(t,r){var a=t,h=r.et,c=a.Vr;return a.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=a.Ci.Di({Ni:!0});c=a.Vr;var u=[];r.zt.forEach(function(t,e){var n,r,i,o=c.get(e);o&&(u.push(a.$i.qr(s,t.ne,e).next(function(){return a.$i.Li(s,t.te,e)})),0<(i=t.resumeToken).k()&&(n=o.st(i,h).nt(s.Br),c=c.rt(e,n),r=o,i=t,kr(0<(o=n).resumeToken.k()),(0===r.resumeToken.k()||3e8<=o.et.J()-r.et.J()||0<i.te.size+i.ee.size+i.ne.size)&&u.push(a.$i.Qr(s,n))))});var e,n=ro;return r.Ht.forEach(function(t,e){r.Yt.has(t)&&u.push(a.persistence.Wr.jr(s,t))}),u.push(Sh(s,t,r.Ht,h,void 0).next(function(t){n=t})),h.isEqual(Pi.min())||(e=a.$i.Ur(s).next(function(t){return a.$i.Gr(s,s.Br,h)}),u.push(e)),ba.$n(u).next(function(){return t.apply(s)}).next(function(){return a.xi.Oi(s,n)})}).then(function(t){return a.Vr=c,t})}function Sh(t,s,e,u,a){var n=ho();return e.forEach(function(t){return n=n.add(t)}),s.getEntries(t,n).next(function(i){var o=ro;return e.forEach(function(t,e){var n=i.get(t),r=(null==a?void 0:a.get(t))||u;e instanceof bu&&e.version.isEqual(Pi.min())?(s.zr(t,r),o=o.rt(t,e)):null==n||0<e.version.M(n.version)||0===e.version.M(n.version)&&n.hasPendingWrites?(s.Or(e,r),o=o.rt(t,e)):Pr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o})}function Oh(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.$i.Hr(e,r).next(function(t){return t?(n=t,ba.resolve(n)):i.$i.Yr(e).next(function(t){return n=new Qi(r,t,0,e.Br),i.$i.Jr(e,n).next(function(){return n})})})}).then(function(t){var e=i.Vr.get(t.targetId);return(null===e||0<t.et.M(e.et))&&(i.Vr=i.Vr.rt(t.targetId,t),i.pr.set(r,t.targetId)),t})}function Ph(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).Vr.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Wr.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!Ta(r=t.sent()))throw r;return Pr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.Vr=e.Vr.remove(o),e.pr.delete(n.target),[2]}})})}function Lh(t,o,s){var u=t,a=Pi.min(),h=ho();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=_u(o),(void 0!==(t=(i=t).pr.get(r))?ba.resolve(i.Vr.get(t)):i.$i.Hr(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.$i.Xr(e,t.targetId).next(function(t){h=t})}).next(function(){return u.Pr.Ki(e,o,s?a:Pi.min(),s?h:ho())}).next(function(t){return{documents:t,Zr:h}});var t,n,r,i})}function Vh(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Tr.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Pr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Dh(t,e){this.user=e,this.type="OAuth",this.Eo={},this.Eo.Authorization="Bearer "+t}function _h(t,e,n,r,i){var o=this;this.gi=t,this.Eu=e,this.On=n,this.Tu={},this.Au=[],this.Iu=new Map,this.Ru=new Set,this.yu=[],this.Pu=i,this.Pu.Vu(function(t){n.Qn(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return pc(this)?(Pr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Ru.add(4),[4,oc(e)];case 1:return t.sent(),e.pu.set("Unknown"),e.Ru.delete(4),[4,ic(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.pu=new Hh(n,r)}var kh,Uh,Ch,Mh=(rc.prototype.m=function(){return this.no.m()},rc.prototype.oo=function(t,e){e=new xh(t,e);this.no=this.no.add(e),this.io=this.io.add(e)},rc.prototype.uo=function(t,e){var n=this;t.forEach(function(t){return n.oo(t,e)})},rc.prototype.ao=function(t,e){this.co(new xh(t,e))},rc.prototype.ho=function(t,e){var n=this;t.forEach(function(t){return n.ao(t,e)})},rc.prototype.lo=function(t){var e=this,n=new Br(new jr([])),r=new xh(n,t),t=new xh(n,t+1),i=[];return this.io.Nt([r,t],function(t){e.co(t),i.push(t.key)}),i},rc.prototype._o=function(){var e=this;this.no.forEach(function(t){return e.co(t)})},rc.prototype.co=function(t){this.no=this.no.delete(t),this.io=this.io.delete(t)},rc.prototype.fo=function(t){var e=new Br(new jr([])),n=new xh(e,t),t=new xh(e,t+1),r=ho();return this.io.Nt([n,t],function(t){r=r.add(t.key)}),r},rc.prototype.wo=function(t){var e=new xh(t,0),e=this.no.$t(e);return null!==e&&t.isEqual(e.key)},rc),xh=(nc.so=function(t,e){return Br.i(t.key,e.key)||yi(t.mo,e.mo)},nc.ro=function(t,e){return yi(t.mo,e.mo)||Br.i(t.key,e.key)},nc),Fh=(ec.prototype.getToken=function(){return Promise.resolve(null)},ec.prototype.Ao=function(){},ec.prototype.Io=function(t){(this.To=t)(Ca.UNAUTHENTICATED)},ec.prototype.Ro=function(){this.To=null},ec),jh=(tc.prototype.getToken=function(){var e=this,n=this.Vo,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.Vo!==n?(Pr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(kr("string"==typeof t.accessToken),new Dh(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},tc.prototype.Ao=function(){this.forceRefresh=!0},tc.prototype.Io=function(t){this.To=t,this.Po&&t(this.currentUser)},tc.prototype.Ro=function(){this.auth&&this.auth.removeAuthTokenListener(this.yo),this.yo=null,this.To=null},tc.prototype.po=function(){var t=this.auth&&this.auth.getUid();return kr(null===t||"string"==typeof t),new Ca(t)},tc),qh=(Object.defineProperty($h.prototype,"Eo",{get:function(){var t={"X-Goog-AuthUser":this.bo},e=this.vo.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),$h),Gh=(Zh.prototype.getToken=function(){return Promise.resolve(new qh(this.vo,this.bo))},Zh.prototype.Io=function(t){t(Ca.Ns)},Zh.prototype.Ro=function(){},Zh.prototype.Ao=function(){},Zh),l=(Kh.prototype.$o=function(){return 1===this.state||2===this.state||4===this.state},Kh.prototype.Lo=function(){return 2===this.state},Kh.prototype.start=function(){3!==this.state?this.auth():this.Oo()},Kh.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.$o()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Kh.prototype.xo=function(){this.state=0,this.Jn.reset()},Kh.prototype.ko=function(){var t=this;this.Lo()&&null===this.Fo&&(this.Fo=this._n.Pn(this.So,6e4,function(){return t.Mo()}))},Kh.prototype.Uo=function(t){this.qo(),this.stream.send(t)},Kh.prototype.Mo=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.Lo()?[2,this.close(0)]:[2]})})},Kh.prototype.qo=function(){this.Fo&&(this.Fo.cancel(),this.Fo=null)},Kh.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.qo(),this.Jn.cancel(),this.No++,3!==e?this.Jn.reset():n&&n.code===Tr.RESOURCE_EXHAUSTED?(Lr(n.toString()),Lr("Using maximum backoff delay to prevent overloading the backend."),this.Jn.In()):n&&n.code===Tr.UNAUTHENTICATED&&this.Co.Ao(),null!==this.stream&&(this.Bo(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Qo(n)];case 1:return t.sent(),[2]}})})},Kh.prototype.Bo=function(){},Kh.prototype.auth=function(){var n=this;this.state=1;var t=this.jo(this.No),e=this.No;this.Co.getToken().then(function(t){n.No===e&&n.Wo(t)},function(e){t(function(){var t=new Ar(Tr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Go(t)})})},Kh.prototype.Wo=function(t){var e=this,n=this.jo(this.No);this.stream=this.zo(t),this.stream.Ko(function(){n(function(){return e.state=2,e.listener.Ko()})}),this.stream.Qo(function(t){n(function(){return e.Go(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Kh.prototype.Oo=function(){var t=this;this.state=4,this.Jn.Rn(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},Kh.prototype.Go=function(t){return Pr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Kh.prototype.jo=function(e){var n=this;return function(t){n._n.Qn(function(){return n.No===e?t():(Pr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Kh),Bh=(n(Jh,Ch=l),Jh.prototype.zo=function(t){return this.Do.Ho("Listen",t)},Jh.prototype.onMessage=function(t){this.Jn.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:_r(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Be?(kr(void 0===o||"string"==typeof o),gi.fromBase64String(o||"")):(kr(void 0===o||o instanceof Uint8Array),gi.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Tr.UNKNOWN:Wi(s.code),new Ar(o,s.message||"")),r=new wo(n,r,i,s||null)}else if("documentChange"in e){e.documentChange;var u=e.documentChange;u.document,u.document.name,u.document.updateTime;var i=us(t,u.document.name),a=rs(u.document.updateTime),s=new cu({mapValue:{fields:u.document.fields}}),a=new wu(i,a,s,{}),s=u.targetIds||[],u=u.removedTargetIds||[];r=new go(s,u,a.key,a)}else if("documentDelete"in e){e.documentDelete;u=e.documentDelete;u.document;var a=us(t,u.document),h=u.readTime?rs(u.readTime):Pi.min(),h=new bu(a,h),u=u.removedTargetIds||[];r=new go([],u,h.key,h)}else if("documentRemove"in e){e.documentRemove;h=e.documentRemove;h.document;var c=us(t,h.document),h=h.removedTargetIds||[];r=new go([],h,c,null)}else{if(!("filter"in e))return _r();e.filter;c=e.filter;c.targetId;e=c.count||0,e=new Gi(e),c=c.targetId;r=new mo(c,e)}return r}(this.serializer,t),t=function(t){if(!("targetChange"in t))return Pi.min();t=t.targetChange;return(!t.targetIds||!t.targetIds.length)&&t.readTime?rs(t.readTime):Pi.min()}(t);return this.listener.Yo(e,t)},Jh.prototype.Jo=function(t){var e,n,r,i={};i.database=hs(this.serializer),i.addTarget=(e=this.serializer,(r=qi(r=(n=t).target)?{documents:{documents:[as(e,r.path)]}}:{query:ps(e,r)}).targetId=n.targetId,0<n.resumeToken.k()?r.resumeToken=ns(e,n.resumeToken):0<n.et.M(Pi.min())&&(r.readTime=es(e,n.et.X())),r);var o,t=(this.serializer,o=t,null==(t=function(){switch(o.tt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return _r()}}())?null:{"goog-listen-tags":t});t&&(i.labels=t),this.Uo(i)},Jh.prototype.Xo=function(t){var e={};e.database=hs(this.serializer),e.removeTarget=t,this.Uo(e)},Jh),Qh=(n(Xh,Uh=l),Object.defineProperty(Xh.prototype,"tu",{get:function(){return this.Zo},enumerable:!1,configurable:!0}),Xh.prototype.start=function(){this.Zo=!1,this.lastStreamToken=void 0,Uh.prototype.start.call(this)},Xh.prototype.Bo=function(){this.Zo&&this.eu([])},Xh.prototype.zo=function(t){return this.Do.Ho("Write",t)},Xh.prototype.onMessage=function(t){if(kr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Zo){this.Jn.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(kr(void 0!==r),n.map(function(t){return function(t,e){var n=t.updateTime?rs(t.updateTime):rs(e);n.isEqual(Pi.min())&&(n=rs(e));e=null;return t.transformResults&&0<t.transformResults.length&&(e=t.transformResults),new qs(n,e)}(t,r)})):[]),n=rs(t.commitTime);return this.listener.nu(n,e)}var n,r;return kr(!t.writeResults||0===t.writeResults.length),this.Zo=!0,this.listener.su()},Xh.prototype.iu=function(){var t={};t.database=hs(this.serializer),this.Uo(t)},Xh.prototype.eu=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return fs(e.serializer,t)})};this.Uo(t)},Xh),zh=(n(Yh,kh=function(){}),Yh.prototype.ou=function(){if(this.ru)throw new Ar(Tr.FAILED_PRECONDITION,"The client has already been terminated.")},Yh.prototype.uu=function(e,n,r){var i=this;return this.ou(),this.credentials.getToken().then(function(t){return i.Do.uu(e,n,r,t)}).catch(function(t){throw t.code===Tr.UNAUTHENTICATED&&i.credentials.Ao(),t})},Yh.prototype.au=function(e,n,r){var i=this;return this.ou(),this.credentials.getToken().then(function(t){return i.Do.au(e,n,r,t)}).catch(function(t){throw t.code===Tr.UNAUTHENTICATED&&i.credentials.Ao(),t})},Yh.prototype.terminate=function(){this.ru=!1},Yh),Hh=(Wh.prototype._u=function(){var t=this;0===this.cu&&(this.fu("Unknown"),this.hu=this.On.Pn("online_state_timeout",1e4,function(){return t.hu=null,t.du("Backend didn't respond within 10 seconds."),t.fu("Offline"),Promise.resolve()}))},Wh.prototype.wu=function(t){"Online"===this.state?this.fu("Unknown"):(this.cu++,1<=this.cu&&(this.mu(),this.du("Connection failed 1 times. Most recent error: "+t.toString()),this.fu("Offline")))},Wh.prototype.set=function(t){this.mu(),this.cu=0,"Online"===t&&(this.lu=!1),this.fu(t)},Wh.prototype.fu=function(t){t!==this.state&&(this.state=t,this.Qs(t))},Wh.prototype.du=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.lu?(Lr(t),this.lu=!1):Pr("OnlineStateTracker",t)},Wh.prototype.mu=function(){null!==this.hu&&(this.hu.cancel(),this.hu=null)},Wh);function Wh(t,e){this.On=t,this.Qs=e,this.state="Unknown",this.cu=0,this.hu=null,this.lu=!0}function Yh(t,e,n){var r=this;return(r=kh.call(this)||this).credentials=t,r.Do=e,r.serializer=n,r.ru=!1,r}function Xh(t,e,n,r,i){var o=this;return(o=Uh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Zo=!1,o}function Jh(t,e,n,r,i){var o=this;return(o=Ch.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Kh(t,e,n,r,i,o){this._n=t,this.So=n,this.Do=r,this.Co=i,this.listener=o,this.state=0,this.No=0,this.Fo=null,this.stream=null,this.Jn=new wa(t,e)}function Zh(t,e){this.vo=t,this.bo=e}function $h(t,e){this.vo=t,this.bo=e,this.type="FirstParty",this.user=Ca.Ns}function tc(t){var e=this;this.yo=null,this.currentUser=Ca.UNAUTHENTICATED,this.Po=!1,this.Vo=0,this.To=null,this.forceRefresh=!1,this.yo=function(){e.Vo++,e.currentUser=e.po(),e.Po=!0,e.To&&e.To(e.currentUser)},this.Vo=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.yo):(this.yo(null),t.get().then(function(t){e.auth=t,e.yo&&e.auth.addAuthTokenListener(e.yo)},function(){}))}function ec(){this.To=null}function nc(t,e){this.key=t,this.mo=e}function rc(){this.no=new eo(xh.so),this.io=new eo(xh.ro)}function ic(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!pc(r))return[3,4];e=0,n=r.yu,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function oc(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.yu,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function sc(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Pr("RemoteStore","RemoteStore shutting down."),e.Ru.add(5),[4,oc(e)];case 1:return t.sent(),e.Pu.ei(),e.pu.set("Unknown"),[2]}})})}function uc(t,e){t.Iu.has(e.targetId)||(t.Iu.set(e.targetId,e),fc(t)?lc(t):Ec(t).Lo()&&hc(t,e))}function ac(t,e){var n=t,t=Ec(n);n.Iu.delete(e),t.Lo()&&cc(n,e),0===n.Iu.size&&(t.Lo()?t.ko():pc(n)&&n.pu.set("Unknown"))}function hc(t,e){t.gu.Te(e.targetId),Ec(t).Jo(e)}function cc(t,e){t.gu.Te(e),Ec(t).Xo(e)}function lc(e){e.gu=new Eo({Ue:function(t){return e.Tu.Ue(t)},qe:function(t){return e.Iu.get(t)||null}}),Ec(e).start(),e.pu._u()}function fc(t){return pc(t)&&!Ec(t).$o()&&0<t.Iu.size}function pc(t){return 0===t.Ru.size}function dc(t){t.gu=void 0}function yc(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.pu.set("Online"),!(u instanceof wo&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Iu.has(i)?[4,o.Tu.vu(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Iu.delete(i),o.gu.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Pr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,vc(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof go?s.gu.ge(u):u instanceof mo?s.gu.$e(u):s.gu.Se(u),a.isEqual(Pi.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Nh(s.gi)];case 8:return o=t.sent(),0<=a.M(o)?[4,(i=a,(e=(r=s).gu.xe(i)).zt.forEach(function(t,e){var n;0<t.resumeToken.k()&&((n=r.Iu.get(e))&&r.Iu.set(e,n.st(t.resumeToken,i)))}),e.Kt.forEach(function(t){var e=r.Iu.get(t);e&&(r.Iu.set(t,e.st(gi.U,e.et)),cc(r,t),e=new Qi(e.target,t,1,e.sequenceNumber),hc(r,e))}),r.Tu.bu(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Pr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,vc(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}function vc(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!Ta(r))throw r;return n.Ru.add(1),[4,oc(n)];case 1:return t.sent(),n.pu.set("Offline"),i=i||function(){return Nh(n.gi)},n.On.rs(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Pr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Ru.delete(1),[4,ic(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function gc(e,n){return n().catch(function(t){return vc(e,t,n)})}function mc(a){return y(this,void 0,void 0,function(){var i,o,s,u;return v(this,function(t){switch(t.label){case 0:o=Ic(i=a),s=0<i.Au.length?i.Au[i.Au.length-1].batchId:-1,t.label=1;case 1:if(!(pc(i)&&i.Au.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(e=i.gi,n=s,(r=e).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===n&&(n=-1),r.Mi.Kr(t,n)}))];case 3:return null===(u=t.sent())?(0===i.Au.length&&o.ko(),[3,7]):(s=u.batchId,function(t,e){t.Au.push(e);t=Ic(t);t.Lo()&&t.tu&&t.eu(e.mutations)}(i,u),[3,6]);case 4:return u=t.sent(),[4,vc(i,u)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return wc(i)&&bc(i),[2]}var e,n,r})})}function wc(t){return pc(t)&&!Ic(t).$o()&&0<t.Au.length}function bc(t){Ic(t).start()}function Ec(n){var t,e,r,i=this;return n.Cu||(n.Cu=(t=n.Eu,e=n.On,r={Ko:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Iu.forEach(function(t,e){hc(n,t)}),[2]})})}.bind(null,n),Qo:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return dc(e),fc(e)?(e.pu.wu(n),lc(e)):e.pu.set("Unknown"),[2]})})}.bind(null,n),Yo:yc.bind(null,n)},t.ou(),new Bh(e,t.Do,t.credentials,t.serializer,r)),n.yu.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Cu.xo(),fc(n)?lc(n):n.pu.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.Cu.stop()];case 2:t.sent(),dc(n),t.label=3;case 3:return[2]}})})})),n.Cu}function Ic(n){var t,e,r,i=this;return n.Nu||(n.Nu=(t=n.Eu,e=n.On,r={Ko:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Ic(e).iu(),[2]})})}.bind(null,n),Qo:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Ic(e).tu?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Hi(n=i.code)&&n!==Tr.ABORTED?(e=r.Au.shift(),Ic(r).xo(),[4,gc(r,function(){return r.Tu.Du(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,mc(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return wc(e)&&bc(e),[2]}})})}.bind(null,n),su:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Ic(o),n=0,r=o.Au;n<r.length;n++)i=r[n],e.eu(i.mutations);return[2]})})}.bind(null,n),nu:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Au.shift(),n=Qa.from(e,i,o),[4,gc(r,function(){return r.Tu.Su(n)})];case 1:return t.sent(),[4,mc(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.ou(),new Qh(e,t.Do,t.credentials,t.serializer,r)),n.yu.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Nu.xo(),[4,mc(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Nu.stop()];case 3:t.sent(),0<n.Au.length&&(Pr("RemoteStore","Stopping write stream with "+n.Au.length+" pending writes"),n.Au=[]),t.label=4;case 4:return[2]}})})})),n.Nu}function Tc(t,e,n){this.query=t,this.targetId=e,this.view=n}var Ac=function(t){this.key=t},Nc=function(t){this.key=t},Rc=(Object.defineProperty(Lc.prototype,"ku",{get:function(){return this.Fu},enumerable:!1,configurable:!0}),Lc.prototype.Mu=function(t,e){var s=this,u=e?e.Uu:new fo,a=(e||this).xu,h=(e||this).Qt,c=a,l=!1,f=Su(this.query)&&a.size===this.query.limit?a.last():null,p=Ou(this.query)&&a.size===this.query.limit?a.first():null;if(t.ct(function(t,e){var n=a.get(t),r=(r=e instanceof wu?e:null)&&(ju(s.query,r)?r:null),i=!!n&&s.Qt.has(n.key),o=!!r&&(r.Ye||s.Qt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.qu(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.Ou(r,f)||p&&s.Ou(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(h=r?(c=c.add(r),o?h.add(t):h.delete(t)):(c=c.delete(t),h.delete(t)))}),Su(this.query)||Ou(this.query))for(;c.size>this.query.limit;){var n=Su(this.query)?c.last():c.first(),c=c.delete(n.key),h=h.delete(n.key);u.track({type:1,doc:n})}return{xu:c,Uu:u,Bu:l,Qt:h}},Lc.prototype.qu=function(t,e){return t.Ye&&e.hasCommittedMutations&&!e.Ye},Lc.prototype.Qu=function(t,e,n){var o=this,r=this.xu;this.xu=t.xu,this.Qt=t.Qt;var i=t.Uu.qt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.Ou(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _r()}}var r,i}),this.ju(n);var s=e?this.Wu():[],n=0===this.Lu.size&&this.Zt?1:0,e=n!==this.$u;return this.$u=n,0!==i.length||e?{snapshot:new po(this.query,t.xu,r,i,t.Qt,0==n,e,!1),Gu:s}:{Gu:s}},Lc.prototype.As=function(t){return this.Zt&&"Offline"===t?(this.Zt=!1,this.Qu({xu:this.xu,Uu:new fo,Qt:this.Qt,Bu:!1},!1)):{Gu:[]}},Lc.prototype.zu=function(t){return!this.Fu.has(t)&&!!this.xu.has(t)&&!this.xu.get(t).Ye},Lc.prototype.ju=function(t){var e=this;t&&(t.te.forEach(function(t){return e.Fu=e.Fu.add(t)}),t.ee.forEach(function(t){}),t.ne.forEach(function(t){return e.Fu=e.Fu.delete(t)}),this.Zt=t.Zt)},Lc.prototype.Wu=function(){var e=this;if(!this.Zt)return[];var n=this.Lu;this.Lu=ho(),this.xu.forEach(function(t){e.zu(t.key)&&(e.Lu=e.Lu.add(t.key))});var r=[];return n.forEach(function(t){e.Lu.has(t)||r.push(new Nc(t))}),this.Lu.forEach(function(t){n.has(t)||r.push(new Ac(t))}),r},Lc.prototype.Ku=function(t){this.Fu=t.Zr,this.Lu=ho();t=this.Mu(t.documents);return this.Qu(t,!0)},Lc.prototype.Hu=function(){return po.Gt(this.query,this.xu,this.Qt,0===this.$u)},Lc),Sc=function(t){this.key=t,this.Yu=!1},Oc=(Object.defineProperty(Pc.prototype,"_a",{get:function(){return!0===this.la},enumerable:!1,configurable:!0}),Pc);function Pc(t,e,n,r,i,o){this.gi=t,this.Ju=e,this.Xu=n,this.Zu=r,this.currentUser=i,this.ta=o,this.ea={},this.na=new Si(xu,Mu),this.sa=new Map,this.ia=[],this.ra=new Yi(Br.i),this.oa=new Map,this.ua=new Mh,this.aa={},this.ca=new Map,this.ha=mh.yr(),this.onlineState="Unknown",this.la=void 0}function Lc(t,e){this.query=t,this.Fu=e,this.$u=null,this.Zt=!1,this.Lu=ho(),this.Qt=ho(),this.Ou=qu(t),this.xu=new lo(this.Ou)}function Vc(u,a){return y(this,void 0,void 0,function(){var n,r,i,o,s;return v(this,function(t){switch(t.label){case 0:return(e=u).Ju.Tu.bu=_c.bind(null,e),e.Ju.Tu.Ue=function(t,e){var n=t,t=n.oa.get(e);if(t&&t.Yu)return ho().add(t.key);var r=ho(),e=n.sa.get(e);if(!e)return r;for(var i=0,o=e;i<o.length;i++){var s=o[i],s=n.na.get(s);r=r.Lt(s.view.ku)}return r}.bind(null,e),e.Ju.Tu.vu=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Zu.zs(s,"rejected",u),i=e.oa.get(s),(n=i&&i.key)?(r=(r=new Yi(Br.i)).rt(n,new bu(n,Pi.min())),i=ho().add(n),i=new yo(Pi.min(),new Map,new eo(yi),r,i),[4,_c(e,i)]):[3,2];case 1:return t.sent(),e.ra=e.ra.remove(n),e.oa.delete(s),jc(e),[3,4];case 2:return[4,Ph(e.gi,s,!1).then(function(){return Mc(e,s,u)}).catch(Vh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.ea.Yo=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query,u=n.ws.get(u);if(u){for(var a=0,h=u.listeners;a<h.length;a++)h[a].Is(s)&&(r=!0);u.ds=s}}r&&ka(n)}.bind(null,e.Xu),e.ea.fa=function(t,e,n){var r=t;if(t=r.ws.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.ws.delete(e)}.bind(null,e.Xu),(s=(n=e).na.get(a))?(r=s.targetId,n.Zu.Gs(r),i=s.view.Hu(),[3,4]):[3,1];case 1:return[4,Oh(n.gi,_u(a))];case 2:return o=t.sent(),s=n.Zu.Gs(o.targetId),r=o.targetId,[4,function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.da=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.Mu(o)).Bu?[4,Lh(r.gi,i.query,!1).then(function(t){t=t.documents;return i.view.Mu(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.zt.get(i.targetId),n=i.view.Qu(e,r._a,n),[2,(Fc(r,i.targetId,n.Gu),n.snapshot)]}})})}(i,t,e,n)},[4,Lh(i.gi,o,!0)];case 1:return n=t.sent(),r=new Rc(o,n.Zr),e=r.Mu(n.documents),n=vo.Xt(s,u&&"Offline"!==i.onlineState),n=r.Qu(e,i._a,n),Fc(i,s,n.Gu),r=new Tc(o,s,r),i.na.set(o,r),i.sa.has(s)?i.sa.get(s).push(o):i.sa.set(s,[o]),[2,n.snapshot]}})})}(n,a,r,"current"===s)];case 3:i=t.sent(),n._a&&uc(n.Ju,o),t.label=4;case 4:return[2,i]}var e})})}function Dc(f,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:(o=f).Ju.Tu.Su=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=i,n=o.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Ah(e.gi,o)];case 2:return r=t.sent(),Cc(e,n,null),Uc(e,n),e.Zu.Ws(n,"acknowledged"),[4,qc(e,r)];case 3:return t.sent(),[3,6];case 4:return[4,Vh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}.bind(null,o),o.Ju.Tu.Du=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.gi,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Mi.Ea(e,r).next(function(t){return kr(null!==t),n=t.keys(),i.Mi.kr(e,t)}).next(function(){return i.Mi.Mr(e)}).next(function(){return i.xi.Gi(e,n)})}))];case 2:return o=t.sent(),Cc(n,u,a),Uc(n,u),n.Zu.Ws(u,"rejected",a),[4,qc(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Vh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.gi,a=p,c=r,l=Oi.now(),i=a.reduce(function(t,e){return t.add(e.key)},ho()),c.persistence.runTransaction("Locally write mutations","readwrite",function(u){return c.xi.Gi(u,i).next(function(t){h=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=h.get(i.key),s instanceof ru?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof wu?t.field(i.field):void 0,o=Es(i.transform,o||null);null!=o&&(e=(null==e?new lu:e).set(i.field,o))}return e?e.Je():null}(o):null);null!=o&&e.push(new Zs(i.key,o,function s(t){var u=[];return Cr(t.fields||{},function(t,e){var n=new Gr([t]);if(Yo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Fs(u)}(o.proto.mapValue),Gs.exists(!0)))}return c.Mi.wa(u,l,e,a)})}).then(function(t){var e=t.ui(h);return{batchId:t.batchId,ma:e}}))];case 2:return s=t.sent(),u.Zu.js(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.aa[e.currentUser.Ds()])||new Yi(yi)).rt(n,o),e.aa[e.currentUser.Ds()]=r,[4,qc(u,s.ma)];case 3:return t.sent(),[4,mc(u.Ju)];case 4:return t.sent(),[3,6];case 5:return u=t.sent(),u=Pa(u,"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,h,c,l,i,o})})}function _c(r,i){return y(this,void 0,void 0,function(){var n,e;return v(this,function(t){switch(t.label){case 0:n=r,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,Rh(n.gi,i)];case 2:return e=t.sent(),i.zt.forEach(function(t,e){e=n.oa.get(e);e&&(kr(t.te.size+t.ee.size+t.ne.size<=1),0<t.te.size?e.Yu=!0:0<t.ee.size?kr(e.Yu):0<t.ne.size&&(kr(e.Yu),e.Yu=!1))}),[4,qc(n,e,i)];case 3:return t.sent(),[3,6];case 4:return[4,Vh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})}function kc(t,n,e){var r,t=t;(t._a&&0===e||!t._a&&1===e)&&(r=[],t.na.forEach(function(t,e){e=e.view.As(n);e.snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.ws.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].As(i)&&(o=!0)}),o&&ka(t)}(t.Xu,n),r.length&&t.ea.Yo(r),t.onlineState=n,t._a&&t.Zu.ti(n))}function Uc(t,e){(t.ca.get(e)||[]).forEach(function(t){t.resolve()}),t.ca.delete(e)}function Cc(t,e,n){var r=t,i=r.aa[r.currentUser.Ds()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.aa[r.currentUser.Ds()]=i)}function Mc(e,t,n){void 0===n&&(n=null),e.Zu.Ks(t);for(var r=0,i=e.sa.get(t);r<i.length;r++){var o=i[r];e.na.delete(o),n&&e.ea.fa(o,n)}e.sa.delete(t),e._a&&e.ua.lo(t).forEach(function(t){e.ua.wo(t)||xc(e,t)})}function xc(t,e){var n=t.ra.get(e);null!==n&&(ac(t.Ju,n),t.ra=t.ra.remove(e),t.oa.delete(n),jc(t))}function Fc(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof Ac?(t.ua.oo(o.key,e),function(t,e){e=e.key;t.ra.get(e)||(Pr("SyncEngine","New document in limbo: "+e),t.ia.push(e),jc(t))}(t,o)):o instanceof Nc?(Pr("SyncEngine","Document no longer in limbo: "+o.key),t.ua.ao(o.key,e),t.ua.wo(o.key)||xc(t,o.key)):_r()}}function jc(t){for(;0<t.ia.length&&t.ra.size<t.ta;){var e=t.ia.shift(),n=t.ha.next();t.oa.set(n,new Sc(e)),t.ra=t.ra.rt(e,n),uc(t.Ju,new Qi(_u(Ru(e.path)),n,2,Fa.xs))}}function qc(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).na.m()?[3,3]:(n.na.forEach(function(t,e){o.push(n.da(e,s,u).then(function(t){t&&(n._a&&n.Zu.zs(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=ah.sr(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.ea.Yo(r),[4,function(a,h){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ba.forEach(h,function(e){return ba.forEach(e.er,function(t){return r.persistence.Wr.oo(n,e.targetId,t)}).next(function(){return ba.forEach(e.nr,function(t){return r.persistence.Wr.ao(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!Ta(e=t.sent()))throw e;return Pr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=h;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.Vr.get(o),u=s.et,u=s.it(u),r.Vr=r.Vr.rt(o,u));return[2]}})})}(n.gi,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function Gc(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Pr("SyncEngine","User change. New user:",o.Ds()),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Mi,m=e.xi,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Mi.Aa(v).next(function(t){return g=t,n=e.persistence.vr(o),m=new uh(e.Ci,n,e.persistence.Dr()),n.Aa(v)}).next(function(t){for(var e=[],n=[],r=ho(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Gi(v,r).next(function(t){return{Ia:t,Ra:e,ya:n}})})})];case 1:return r=t.sent(),[2,(e.Mi=n,e.xi=m,e.Pr.Fr(e.xi),r)]}})})}(n.gi,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).ca.forEach(function(t){t.forEach(function(t){t.reject(new Ar(Tr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.ca.clear(),n.Zu.Zs(o,r.Ra,r.ya),[4,qc(n,r.Ia)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}function Bc(t,e,n){var r=t;(function(f,p,d){return y(this,void 0,void 0,function(){var u,a,h,c,l;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,14,,15]),[4,p.getMetadata()];case 1:return u=t.sent(),[4,(r=f.gi,i=u,s=new th((o=r).serializer).Pi(i.createTime),o.persistence.runTransaction("hasNewerBundle","readonly",function(t){return o.Cr.Pa(t,i.id)}).then(function(t){return!!t&&0<=t.createTime.M(s)}))];case 2:return t.sent()?[4,p.close()]:[3,4];case 3:return[2,(t.sent(),void d.Va({taskState:"Success",documentsLoaded:u.totalDocuments,bytesLoaded:u.totalBytes,totalDocuments:u.totalDocuments,totalBytes:u.totalBytes}))];case 4:return d.pa(ih(u)),a=new sh(u,f.gi,p.serializer),[4,p.wi()];case 5:h=t.sent(),t.label=6;case 6:return h?[4,a.vi(h)]:[3,10];case 7:return(c=t.sent())&&d.pa(c),[4,p.wi()];case 8:h=t.sent(),t.label=9;case 9:return[3,6];case 10:return[4,a.complete()];case 11:return l=t.sent(),[4,qc(f,l.Vi,void 0)];case 12:return t.sent(),[4,(r=f.gi,e=u,(n=r).persistence.runTransaction("Save bundle","readwrite",function(t){return n.Cr.ga(t,e)}))];case 13:return t.sent(),d.Va(l.progress),[3,15];case 14:return l=t.sent(),d.va(l),[3,15];case 15:return[2]}var e,n,r,i,o,s})})})(r,e,n).then(function(){r.Zu.ni()})}var Qc,zc,Hc,Wc,Yc,Xc=(xl.prototype.Fr=function(t){this.ba=t},xl.prototype.Ki=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.rn.length||1===r.rn.length&&r.rn[0].field.g())||i.isEqual(Pi.min())?this.Sa(e,r):this.ba.Gi(e,o).next(function(t){var n=s.Da(r,t);return(Su(r)||Ou(r))&&s.Bu(r.on,n,o,i)?s.Sa(e,r):(Or()<=u.DEBUG&&Pr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Fu(r)),s.ba.Ki(e,r,i).next(function(e){return n.forEach(function(t){e=e.rt(t.key,t)}),e}))})},xl.prototype.Da=function(n,t){var r=new eo(qu(n));return t.forEach(function(t,e){e instanceof wu&&ju(n,e)&&(r=r.add(e))}),r},xl.prototype.Bu=function(t,e,n,r){if(n.size!==e.size)return!0;e="F"===t?e.last():e.first();return!!e&&(e.hasPendingWrites||0<e.version.M(r))},xl.prototype.Sa=function(t,e){return Or()<=u.DEBUG&&Pr("IndexFreeQueryEngine","Using full collection scan to execute query:",Fu(e)),this.ba.Ki(t,e,Pi.min())},xl),Jc=(Ml.prototype.Fa=function(t){return ba.resolve(0===this.Mi.length)},Ml.prototype.wa=function(t,e,n,r){var i=this.Ca;this.Ca++,0<this.Mi.length&&this.Mi[this.Mi.length-1];n=new Ba(i,e,n,r);this.Mi.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Na=this.Na.add(new xh(u.key,i)),this.Ui.Ar(t,u.key.path.h())}return ba.resolve(n)},Ml.prototype.Ea=function(t,e){return ba.resolve(this.$a(e))},Ml.prototype.Kr=function(t,e){e+=1,e=this.La(e),e=e<0?0:e;return ba.resolve(this.Mi.length>e?this.Mi[e]:null)},Ml.prototype.Ta=function(){return ba.resolve(0===this.Mi.length?-1:this.Ca-1)},Ml.prototype.Aa=function(t){return ba.resolve(this.Mi.slice())},Ml.prototype.Bi=function(t,e){var n=this,r=new xh(e,0),e=new xh(e,Number.POSITIVE_INFINITY),i=[];return this.Na.Nt([r,e],function(t){t=n.$a(t.mo);i.push(t)}),ba.resolve(i)},Ml.prototype.zi=function(t,e){var n=this,r=new eo(yi);return e.forEach(function(t){var e=new xh(t,0),t=new xh(t,Number.POSITIVE_INFINITY);n.Na.Nt([e,t],function(t){r=r.add(t.mo)})}),ba.resolve(this.Oa(r))},Ml.prototype.Zi=function(t,e){var n=e.path,r=n.length+1,e=n;Br.F(e)||(e=e.child(""));var e=new xh(new Br(e),0),i=new eo(yi);return this.Na.Ft(function(t){var e=t.key.path;return!!n.T(e)&&(e.length===r&&(i=i.add(t.mo)),!0)},e),ba.resolve(this.Oa(i))},Ml.prototype.Oa=function(t){var e=this,n=[];return t.forEach(function(t){t=e.$a(t);null!==t&&n.push(t)}),n},Ml.prototype.kr=function(n,r){var i=this;kr(0===this.xa(r.batchId,"removed")),this.Mi.shift();var o=this.Na;return ba.forEach(r.mutations,function(t){var e=new xh(t.key,r.batchId);return o=o.delete(e),i.Wr.ka(n,t.key)}).next(function(){i.Na=o})},Ml.prototype.Ma=function(t){},Ml.prototype.wo=function(t,e){var n=new xh(e,0),n=this.Na.$t(n);return ba.resolve(e.isEqual(n&&n.key))},Ml.prototype.Mr=function(t){return this.Mi.length,ba.resolve()},Ml.prototype.xa=function(t,e){return this.La(t)},Ml.prototype.La=function(t){return 0===this.Mi.length?0:t-this.Mi[0].batchId},Ml.prototype.$a=function(t){t=this.La(t);return t<0||t>=this.Mi.length?null:this.Mi[t]},Ml),Kc=(Cl.prototype.Or=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,i=this.Ua(e);return this.docs=this.docs.rt(r,{qa:e,size:i,readTime:n}),this.size+=i-o,this.Ui.Ar(t,r.path.h())},Cl.prototype.zr=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Cl.prototype.ji=function(t,e){e=this.docs.get(e);return ba.resolve(e?e.qa:null)},Cl.prototype.getEntries=function(t,e){var n=this,r=ro;return e.forEach(function(t){var e=n.docs.get(t);r=r.rt(t,e?e.qa:null)}),ba.resolve(r)},Cl.prototype.Ki=function(t,e,n){for(var r=so,i=new Br(e.path.child("")),o=this.docs._t(i);o.At();){var s=o.Tt(),u=s.key,a=s.value,s=a.qa,a=a.readTime;if(!e.path.T(u.path))break;a.M(n)<=0||s instanceof wu&&ju(e,s)&&(r=r.rt(s.key,s))}return ba.resolve(r)},Cl.prototype.Ba=function(t,e){return ba.forEach(this.docs,function(t){return e(t)})},Cl.prototype.Di=function(t){return new Zc(this)},Cl.prototype.Qa=function(t){return ba.resolve(this.size)},Cl),Zc=(Ul.prototype.Wa=function(t){t=this.ma.get(t);return t?t.readTime:Pi.min()},Ul.prototype.Or=function(t,e){this.Ga(),this.ma.set(t.key,{qa:t,readTime:e})},Ul.prototype.zr=function(t,e){void 0===e&&(e=null),this.Ga(),this.ma.set(t,{qa:null,readTime:e})},Ul.prototype.ji=function(t,e){this.Ga();var n=this.ma.get(e);return void 0!==n?ba.resolve(n.qa):this.za(t,e)},Ul.prototype.getEntries=function(t,e){return this.Ka(t,e)},Ul.prototype.apply=function(t){return this.Ga(),this.ja=!0,this.Qu(t)},Ul.prototype.Ga=function(){},n(kl,Yc=Ul),kl.prototype.Qu=function(n){var r=this,i=[];return this.ma.forEach(function(t,e){e&&e.qa?i.push(r.Ha.Or(n,e.qa,r.Wa(t))):r.Ha.zr(t)}),ba.$n(i)},kl.prototype.za=function(t,e){return this.Ha.ji(t,e)},kl.prototype.Ka=function(t,e){return this.Ha.getEntries(t,e)},kl),$c=(_l.prototype.De=function(t,n){return this.Ya.forEach(function(t,e){return n(e)}),ba.resolve()},_l.prototype.Ur=function(t){return ba.resolve(this.lastRemoteSnapshotVersion)},_l.prototype.tc=function(t){return ba.resolve(this.Ja)},_l.prototype.Yr=function(t){return this.highestTargetId=this.Za.next(),ba.resolve(this.highestTargetId)},_l.prototype.Gr=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Ja&&(this.Ja=e),ba.resolve()},_l.prototype.ec=function(t){this.Ya.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Za=new mh(e),this.highestTargetId=e),t.sequenceNumber>this.Ja&&(this.Ja=t.sequenceNumber)},_l.prototype.Jr=function(t,e){return this.ec(e),this.targetCount+=1,ba.resolve()},_l.prototype.Qr=function(t,e){return this.ec(e),ba.resolve()},_l.prototype.nc=function(t,e){return this.Ya.delete(e.target),this.Xa.lo(e.targetId),--this.targetCount,ba.resolve()},_l.prototype.sc=function(n,r,i){var o=this,s=0,u=[];return this.Ya.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Ya.delete(t),u.push(o.Fi(n,e.targetId)),s++)}),ba.$n(u).next(function(){return s})},_l.prototype.ic=function(t){return ba.resolve(this.targetCount)},_l.prototype.Hr=function(t,e){e=this.Ya.get(e)||null;return ba.resolve(e)},_l.prototype.Li=function(t,e,n){return this.Xa.uo(e,n),ba.resolve()},_l.prototype.qr=function(e,t,n){this.Xa.ho(t,n);var r=this.persistence.Wr,i=[];return r&&t.forEach(function(t){i.push(r.ka(e,t))}),ba.$n(i)},_l.prototype.Fi=function(t,e){return this.Xa.lo(e),ba.resolve()},_l.prototype.Xr=function(t,e){e=this.Xa.fo(e);return ba.resolve(e)},_l.prototype.wo=function(t,e){return ba.resolve(this.Xa.wo(e))},_l),tl=(Dl.prototype.Pa=function(t,e){return ba.resolve(this.rc.get(e))},Dl.prototype.ga=function(t,e){return this.rc.set(e.id,{id:e.id,version:e.version,createTime:rs(e.createTime)}),ba.resolve()},Dl.prototype.uc=function(t,e){return ba.resolve(this.oc.get(e))},Dl.prototype.eo=function(t,e){return this.oc.set(e.name,{name:(e=e).name,query:yh(e.bundledQuery),readTime:rs(e.readTime)}),ba.resolve()},Dl),el=(Vl.prototype.start=function(){return Promise.resolve()},Vl.prototype.ei=function(){return this.hc=!1,Promise.resolve()},Object.defineProperty(Vl.prototype,"_c",{get:function(){return this.hc},enumerable:!1,configurable:!0}),Vl.prototype.fc=function(){},Vl.prototype.dc=function(){},Vl.prototype.Dr=function(){return this.Ui},Vl.prototype.vr=function(t){var e=this.ac[t.Ds()];return e||(e=new Jc(this.Ui,this.Wr),this.ac[t.Ds()]=e),e},Vl.prototype.Sr=function(){return this.$i},Vl.prototype.br=function(){return this.ki},Vl.prototype.Nr=function(){return this.Cr},Vl.prototype.runTransaction=function(t,e,n){var r=this;Pr("MemoryPersistence","Starting transaction:",t);var i=new nl(this.cc.next());return this.Wr.wc(),n(i).next(function(t){return r.Wr.mc(i).next(function(){return t})}).Nn().then(function(t){return i.Ec(),t})},Vl.prototype.Tc=function(e,n){return ba.Ln(Object.values(this.ac).map(function(t){return function(){return t.wo(e,n)}}))},Vl),nl=(Ll.prototype.Ic=function(t){this.Ac.push(t)},Ll.prototype.Ec=function(){this.Ac.forEach(function(t){return t()})},n(Pl,Wc=Ll),Pl),rl=(Ol.Pc=function(t){return new Ol(t)},Object.defineProperty(Ol.prototype,"Vc",{get:function(){if(this.yc)return this.yc;throw _r()},enumerable:!1,configurable:!0}),Ol.prototype.oo=function(t,e,n){return this.Rc.oo(n,e),this.Vc.delete(n.toString()),ba.resolve()},Ol.prototype.ao=function(t,e,n){return this.Rc.ao(n,e),this.Vc.add(n.toString()),ba.resolve()},Ol.prototype.ka=function(t,e){return this.Vc.add(e.toString()),ba.resolve()},Ol.prototype.removeTarget=function(t,e){var n=this;this.Rc.lo(e.targetId).forEach(function(t){return n.Vc.add(t.toString())});var r=this.persistence.Sr();return r.Xr(t,e.targetId).next(function(t){t.forEach(function(t){return n.Vc.add(t.toString())})}).next(function(){return r.nc(t,e)})},Ol.prototype.wc=function(){this.yc=new Set},Ol.prototype.mc=function(n){var r=this,i=this.persistence.br().Di();return ba.forEach(this.Vc,function(t){var e=Br.D(t);return r.gc(n,e).next(function(t){t||i.zr(e)})}).next(function(){return r.yc=null,i.apply(n)})},Ol.prototype.jr=function(t,e){var n=this;return this.gc(t,e).next(function(t){t?n.Vc.delete(e.toString()):n.Vc.add(e.toString())})},Ol.prototype.lc=function(t){return 0},Ol.prototype.gc=function(t,e){var n=this;return ba.Ln([function(){return ba.resolve(n.Rc.wo(e))},function(){return n.persistence.Sr().wo(t,e)},function(){return n.persistence.Tc(t,e)}])},Ol),il=(Sl.prototype.Ko=function(t){this.Sc=t},Sl.prototype.Qo=function(t){this.Dc=t},Sl.prototype.onMessage=function(t){this.Cc=t},Sl.prototype.close=function(){this.bc()},Sl.prototype.send=function(t){this.vc(t)},Sl.prototype.Nc=function(){this.Sc()},Sl.prototype.Fc=function(t){this.Dc(t)},Sl.prototype.$c=function(t){this.Cc(t)},Sl),ol={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},sl=(Rl.prototype.uu=function(e,t,n,r){var i=this.kc(e,t);Pr("RestConnection","Sending: ",i,n);t={};return this.Mc(t,r),this.Uc(e,i,t,n).then(function(t){return Pr("RestConnection","Received: ",t),t},function(t){throw Vr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Rl.prototype.au=function(t,e,n,r){return this.uu(t,e,n,r)},Rl.prototype.Mc=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.22.1-alpha.01492c06e",t["Content-Type"]="text/plain",e)for(var n in e.Eo)e.Eo.hasOwnProperty(n)&&(t[n]=e.Eo[n])},Rl.prototype.kc=function(t,e){t=ol[t];return this.Oc+"/v1/"+e+":"+t},n(Nl,Hc=Rl),Nl.prototype.Uc=function(o,e,s,u){return new Promise(function(n,r){var i=new wr;i.listenOnce(gr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case vr.NO_ERROR:var t=i.getResponseJson();Pr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case vr.TIMEOUT:Pr("Connection",'RPC "'+o+'" timed out'),r(new Ar(Tr.DEADLINE_EXCEEDED,"Request time out"));break;case vr.HTTP_ERROR:var e=i.getStatus();Pr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Tr).indexOf(e)?e:Tr.UNKNOWN,r(new Ar(e,t.message))):r(new Ar(Tr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Ar(Tr.UNAVAILABLE,"Connection failed."));break;default:_r()}}finally{Pr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Nl.prototype.Ho=function(t,e){var n,r=[this.Oc,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=yr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.B.projectId+"/databases/"+this.B.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.Mc(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||(0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/"))||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders");r=r.join("");Pr("Connection","Creating WebChannel: "+r,t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new il({vc:function(t){u?Pr("Connection","Not sending because WebChannel is closed:",t):(s||(Pr("Connection","Opening WebChannel transport."),o.open(),s=!0),Pr("Connection","WebChannel sending:",t),o.send(t))},bc:function(){return o.close()}}),t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return t(mr.EventType.OPEN,function(){u||Pr("Connection","WebChannel transport opened.")}),t(mr.EventType.CLOSE,function(){u||(u=!0,Pr("Connection","WebChannel transport closed"),a.Fc())}),t(mr.EventType.ERROR,function(t){u||(u=!0,Vr("Connection","WebChannel transport errored:",t),a.Fc(new Ar(Tr.UNAVAILABLE,"The operation could not be completed")))}),t(mr.EventType.MESSAGE,function(t){var e,n,r,i;u||(kr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Pr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Bi[r];if(void 0!==t)return Wi(t)}(),i=n.message,void 0===t&&(t=Tr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.Fc(new Ar(t,i)),o.close()):(Pr("Connection","WebChannel received:",e),a.$c(e)))}),setTimeout(function(){a.Nc()},0),a},Nl),ul=(Al.prototype.Vu=function(t){this.Wc.push(t)},Al.prototype.ei=function(){window.removeEventListener("online",this.qc),window.removeEventListener("offline",this.Qc)},Al.prototype.Gc=function(){window.addEventListener("online",this.qc),window.addEventListener("offline",this.Qc)},Al.prototype.Bc=function(){Pr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Wc;t<e.length;t++)(0,e[t])(0)},Al.prototype.jc=function(){Pr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Wc;t<e.length;t++)(0,e[t])(1)},Al.zc=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Al),al=(Tl.prototype.Vu=function(t){},Tl.prototype.ei=function(){},Tl),hl="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",cl=(Il.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.serializer=Ka(e.Lc.B),this.Zu=this.Kc(e),this.persistence=this.Hc(e),[4,this.persistence.start()];case 1:return t.sent(),this.Yc=this.Jc(e),this.gi=this.Xc(e),[2]}})})},Il.prototype.Jc=function(t){return null},Il.prototype.Xc=function(t){return e=this.persistence,n=new Xc,r=t.Zc,t=this.serializer,new wh(e,n,r,t);var e,n,r},Il.prototype.Hc=function(t){if(t.persistenceSettings.th)throw new Ar(Tr.FAILED_PRECONDITION,hl);return new el(rl.Pc,this.serializer)},Il.prototype.Kc=function(t){return new Ga},Il.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Yc&&this.Yc.stop(),[4,this.Zu.ei()];case 1:return t.sent(),[4,this.persistence.ei()];case 2:return t.sent(),[2]}})})},Il.prototype.clearPersistence=function(t,e){throw new Ar(Tr.FAILED_PRECONDITION,hl)},Il),ll=(El.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.gi?[3,2]:(this.gi=n.gi,this.Zu=n.Zu,this.Eu=this.eh(r),this.Ju=this.nh(r),this.Xu=this.sh(r),this.ih=this.rh(r),this.Zu.Qs=function(t){return kc(e.ih,t,1)},this.Ju.Tu.oh=Gc.bind(null,this.ih),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Ru.delete(2),[4,ic(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Ru.add(2),[4,oc(e)]);case 3:t.sent(),e.pu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.Ju,this.ih._a)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},El.prototype.sh=function(t){return new Va},El.prototype.eh=function(t){var e=Ka(t.Lc.B),n=(n=t.Lc,new sl(n));return t=t.credentials,new zh(t,n,e)},El.prototype.nh=function(t){var e=this,n=this.gi,r=this.Eu,i=t.On,o=function(t){return kc(e.ih,t,0)},t=new(ul.zc()?ul:al);return new _h(n,r,i,o,t)},El.prototype.rh=function(t){return function(t,e,n,r,i,o,s){o=new Oc(t,e,n,r,i,o);return s&&(o.la=!0),o}(this.gi,this.Ju,this.Xu,this.Zu,t.Zc,t.ta,!t.persistenceSettings.th||!t.persistenceSettings.synchronizeTabs)},El.prototype.terminate=function(){return sc(this.Ju)},El),fl=(bl.prototype.next=function(t){this.observer.next&&this.uh(this.observer.next,t)},bl.prototype.error=function(t){this.observer.error?this.uh(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},bl.prototype.ah=function(){this.muted=!0},bl.prototype.uh=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},bl),pl=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Ar(Tr.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(Zr("FieldPath","string",e,t[e]),0===t[e].length)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.hh=new Gr(t)},dl=(n(wl,zc=pl),wl.documentId=function(){return new wl(Gr.v().R())},wl.prototype.isEqual=function(t){if(!(t instanceof wl))throw hi("isEqual","FieldPath",1,t);return this.hh.isEqual(t.hh)},wl),yl=new RegExp("[~\\*/\\[\\]]"),vl=function(t){this.lh=t},gl=(n(ml,Qc=vl),ml.prototype._h=function(t){if(2!==t.fh)throw 1===t.fh?t.dh(this.lh+"() can only appear at the top level of your update data"):t.dh(this.lh+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},ml.prototype.isEqual=function(t){return t instanceof ml},ml);function ml(){return null!==Qc&&Qc.apply(this,arguments)||this}function wl(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return zc.call(this,t)||this}function bl(t){this.observer=t,this.muted=!1}function El(){}function Il(){}function Tl(){}function Al(){var t=this;this.qc=function(){return t.Bc()},this.Qc=function(){return t.jc()},this.Wc=[],this.Gc()}function Nl(t){var e=this;return(e=Hc.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function Rl(t){this.Lc=t,this.B=t.B;var e=t.ssl?"https":"http";this.Oc=e+"://"+t.host,this.xc="projects/"+this.B.projectId+"/databases/"+this.B.database+"/documents"}function Sl(t){this.vc=t.vc,this.bc=t.bc}function Ol(t){this.persistence=t,this.Rc=new Mh,this.yc=null}function Pl(t){var e=this;return(e=Wc.call(this)||this).Br=t,e}function Ll(){this.Ac=[]}function Vl(t,e){var n=this;this.ac={},this.cc=new Fa(0),this.hc=!1,this.hc=!0,this.Wr=t(this),this.$i=new $c(this),this.Ui=new vh,this.ki=(t=this.Ui,new Kc(t,function(t){return n.Wr.lc(t)})),this.serializer=new dh(e),this.Cr=new tl(this.serializer)}function Dl(t){this.serializer=t,this.rc=new Map,this.oc=new Map}function _l(t){this.persistence=t,this.Ya=new Si(Fi,ji),this.lastRemoteSnapshotVersion=Pi.min(),this.highestTargetId=0,this.Ja=0,this.Xa=new Mh,this.targetCount=0,this.Za=mh.Rr()}function kl(t){var e=this;return(e=Yc.call(this)||this).Ha=t,e}function Ul(){this.ma=new Si(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.ja=!1}function Cl(t,e){this.Ui=t,this.Ua=e,this.docs=new Yi(Br.i),this.size=0}function Ml(t,e){this.Ui=t,this.Wr=e,this.Mi=[],this.Ca=1,this.Na=new eo(xh.so)}function xl(){}function Fl(t,e,n){return new hf({fh:3,wh:e.settings.wh,methodName:t.lh,mh:n},e.B,e.serializer,e.ignoreUndefinedProperties)}var jl,ql,Gl,Bl,Ql=(n(uf,Bl=vl),uf.prototype._h=function(t){return new xs(t.path,new As)},uf.prototype.isEqual=function(t){return t instanceof uf},uf),zl=(n(sf,Gl=vl),sf.prototype._h=function(t){var e=Fl(this,t,!0),n=this.Eh.map(function(t){return gf(t,e)}),n=new Ns(n);return new xs(t.path,n)},sf.prototype.isEqual=function(t){return this===t},sf),Hl=(n(of,ql=vl),of.prototype._h=function(t){var e=Fl(this,t,!0),n=this.Eh.map(function(t){return gf(t,e)}),n=new Ls(n);return new xs(t.path,n)},of.prototype.isEqual=function(t){return this===t},of),Wl=(n(rf,jl=vl),rf.prototype._h=function(t){var e=new ks(t.serializer,ts(t.serializer,this.Th));return new xs(t.path,e)},rf.prototype.isEqual=function(t){return this===t},rf),Yl=(Object.defineProperty(nf.prototype,"latitude",{get:function(){return this.Ah},enumerable:!1,configurable:!0}),Object.defineProperty(nf.prototype,"longitude",{get:function(){return this.Ih},enumerable:!1,configurable:!0}),nf.prototype.isEqual=function(t){return this.Ah===t.Ah&&this.Ih===t.Ih},nf.prototype.toJSON=function(){return{latitude:this.Ah,longitude:this.Ih}},nf.prototype.H=function(t){return yi(this.Ah,t.Ah)||yi(this.Ih,t.Ih)},nf),Xl=function(t){this.Rh=t},Jl=/^__.*__$/,Kl=function(t,e,n){this.yh=t,this.Ph=e,this.Vh=n},Zl=(ef.prototype.ph=function(t,e){var n=[];return null!==this.Qe?n.push(new Zs(t,this.data,this.Qe,e)):n.push(new Ks(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new ru(t,this.fieldTransforms)),n},ef),$l=(tf.prototype.ph=function(t,e){e=[new Zs(t,this.data,this.Qe,e)];return 0<this.fieldTransforms.length&&e.push(new ru(t,this.fieldTransforms)),e},tf);function tf(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function ef(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function nf(t,e){if(Xr("GeoPoint",arguments,2),Zr("GeoPoint","number",1,t),Zr("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Ar(Tr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Ar(Tr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Ah=t,this.Ih=e}function rf(t,e){var n=this;return(n=jl.call(this,t)||this).Th=e,n}function of(t,e){var n=this;return(n=ql.call(this,t)||this).Eh=e,n}function sf(t,e){var n=this;return(n=Gl.call(this,t)||this).Eh=e,n}function uf(){return null!==Bl&&Bl.apply(this,arguments)||this}function af(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw _r()}}var hf=(Object.defineProperty(ff.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(ff.prototype,"fh",{get:function(){return this.settings.fh},enumerable:!1,configurable:!0}),ff.prototype.bh=function(t){return new ff(Object.assign(Object.assign({},this.settings),t),this.B,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},ff.prototype.Sh=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t),e=this.bh({path:e,mh:!1});return e.Dh(t),e},ff.prototype.Ch=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t),t=this.bh({path:t,mh:!1});return t.gh(),t},ff.prototype.Nh=function(t){return this.bh({path:void 0,mh:!0})},ff.prototype.dh=function(t){return Tf(t,this.settings.methodName,this.settings.Fh||!1,this.path,this.settings.wh)},ff.prototype.contains=function(e){return void 0!==this.Qe.find(function(t){return e.T(t)})||void 0!==this.fieldTransforms.find(function(t){return e.T(t.field)})},ff.prototype.gh=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Dh(this.path.get(t))},ff.prototype.Dh=function(t){if(0===t.length)throw this.dh("Document fields must not be empty");if(af(this.fh)&&Jl.test(t))throw this.dh('Document fields cannot begin and end with "__"')},ff),cf=(lf.prototype.$h=function(t,e,n,r){return void 0===r&&(r=!1),new hf({fh:t,methodName:e,wh:n,path:Gr.V(),mh:!1,Fh:r},this.B,this.serializer,this.ignoreUndefinedProperties)},lf);function lf(t,e,n){this.B=t,this.ignoreUndefinedProperties=e,this.serializer=n||Ka(t)}function ff(t,e,n,r,i,o){this.settings=t,this.B=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.gh(),this.fieldTransforms=i||[],this.Qe=o||[]}function pf(t,e,n,r,i,o){void 0===o&&(o={});var s=t.$h(o.merge||o.mergeFields?2:0,e,n,i);bf("Data must be an object, but it was:",s,r);var u,a,r=mf(r,s);if(o.merge)u=new Fs(s.Qe),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],c=0,l=o.mergeFields;c<l.length;c++){var f=l[c],p=void 0;if(f instanceof pl)p=f.hh;else{if("string"!=typeof f)throw _r();p=If(e,f,n)}if(!s.contains(p))throw new Ar(Tr.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Af(h,p)||h.push(p)}u=new Fs(h),a=s.fieldTransforms.filter(function(t){return u.Ke(t.field)})}else u=null,a=s.fieldTransforms;return new Zl(new cu(r),u,a)}function df(t,r,i,e){var o=t.$h(1,r,i);bf("Data must be an object, but it was:",o,e);var s=[],u=new lu;Cr(e,function(t,e){var n=If(r,t,i),t=o.Ch(n);e instanceof gl||e instanceof Xl&&e.Rh instanceof gl?s.push(n):null!=(t=gf(e,t))&&(s.push(n),u.set(n,t))});e=new Fs(s);return new $l(u.Je(),e,o.fieldTransforms)}function yf(t,e,n,r,i,o){var s=t.$h(1,e,n),u=[Ef(e,r,n)],a=[i];if(o.length%2!=0)throw new Ar(Tr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(Ef(e,o[h])),a.push(o[h+1]);for(var c,l,f,p=[],d=new lu,y=u.length-1;0<=y;--y){Af(p,u[y])||(c=u[y],l=a[y],f=s.Ch(c),l instanceof gl||l instanceof Xl&&l.Rh instanceof gl?p.push(c):null!=(f=gf(l,f))&&(p.push(c),d.set(c,f)))}i=new Fs(p);return new $l(d.Je(),i,s.fieldTransforms)}function vf(t,e,n,r){return void 0===r&&(r=!1),gf(n,t.$h(r?4:3,e))}function gf(s,t){if(s instanceof Xl&&(s=s.Rh),wf(s))return bf("Unsupported field value:",t,s),mf(s,t);if(s instanceof vl)return function(t,e){if(!af(e.fh))throw e.dh(t.lh+"() can only be used with update() and set()");if(!e.path)throw e.dh(t.lh+"() is not currently supported inside arrays");t=t._h(e);t&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.Qe.push(t.path),s instanceof Array){if(t.settings.mh&&4!==t.fh)throw t.dh("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=gf(i[r],t.Nh(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return ts(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Oi.fromDate(t);return{timestampValue:es(e.serializer,n)}}if(t instanceof Oi){var r=new Oi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:es(e.serializer,r)}}if(t instanceof Yl)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof wi)return{bytesValue:ns(e.serializer,t.q)};if(t instanceof Kl){n=e.B,r=t.yh;if(!r.isEqual(n))throw e.dh("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:is(t.yh||e.B,t.Ph.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.dh("Unsupported field value: "+si(t))}(s,t)}function mf(t,n){var r={};return Mr(t)?n.path&&0<n.path.length&&n.Qe.push(n.path):Cr(t,function(t,e){e=gf(e,n.Sh(t));null!=e&&(r[t]=e)}),{mapValue:{fields:r}}}function wf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Oi||t instanceof Yl||t instanceof wi||t instanceof Kl||t instanceof vl)}function bf(t,e,n){if(!wf(n)||!oi(n)){n=si(n);throw"an object"===n?e.dh(t+" a custom object"):e.dh(t+" "+n)}}function Ef(t,e,n){if(e instanceof pl)return e.hh;if("string"==typeof e)return If(t,e);throw Tf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function If(t,e,n){try{return function(e){if(0<=e.search(yl))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(dl.bind.apply(dl,i([void 0],e.split("."))))}catch(t){throw new Ar(Tr.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).hh}catch(e){throw Tf(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Tf(t,e,n,r,i){var o=r&&!r.m(),s=void 0!==i,e="Function "+e+"() called with invalid data";n&&(e+=" (via `toFirestore()`)");n="";return(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Ar(Tr.INVALID_ARGUMENT,(e+=". ")+t+n)}function Af(t,e){return t.some(function(t){return t.isEqual(e)})}var Nf=(Lf.prototype.Mh=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.Uh(),0<this.mutations.length)throw new Ar(Tr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var n,e,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=hs((n=s).serializer)+"/documents",r={documents:u.map(function(t){return ss(n.serializer,t)})},[4,n.au("BatchGetDocuments",e,r)];case 1:return r=t.sent(),i=new Map,r.forEach(function(t){var e,t=(e=n.serializer,"found"in(t=t)?function(t,e){kr(!!e.found),e.found.name,e.found.updateTime;var n=us(t,e.found.name),t=rs(e.found.updateTime),e=new cu({mapValue:{fields:e.found.fields}});return new wu(n,t,e,{})}(e,t):"missing"in t?function(t,e){kr(!!e.missing),kr(!!e.readTime);t=us(t,e.missing),e=rs(e.readTime);return new bu(t,e)}(e,t):_r());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){t=i.get(t.toString());kr(!!t),o.push(t)}),o)]}})})}(this.Eu,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof bu||t instanceof wu?n.qh(t):_r()}),e)]}})})},Lf.prototype.set=function(t,e){this.write(e.ph(t,this.Ge(t))),this.kh.add(t.toString())},Lf.prototype.update=function(t,e){try{this.write(e.ph(t,this.Bh(t)))}catch(t){this.xh=t}this.kh.add(t.toString())},Lf.prototype.delete=function(t){this.write([new au(t,this.Ge(t))]),this.kh.add(t.toString())},Lf.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.Uh(),this.xh)throw this.xh;return e=this.Lh,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=Br.D(e);n.mutations.push(new hu(e,n.Ge(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=hs((e=i).serializer)+"/documents",r={writes:o.map(function(t){return fs(e.serializer,t)})},[4,e.uu("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Eu,this.mutations)];case 1:return t.sent(),this.Oh=!0,[2]}})})},Lf.prototype.qh=function(t){var e;if(t instanceof wu)e=t.version;else{if(!(t instanceof bu))throw _r();e=Pi.min()}var n=this.Lh.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Ar(Tr.ABORTED,"Document version changed between two reads.")}else this.Lh.set(t.key.toString(),e)},Lf.prototype.Ge=function(t){var e=this.Lh.get(t.toString());return!this.kh.has(t.toString())&&e?Gs.updateTime(e):Gs.He()},Lf.prototype.Bh=function(t){var e=this.Lh.get(t.toString());if(this.kh.has(t.toString())||!e)return Gs.exists(!0);if(e.isEqual(Pi.min()))throw new Ar(Tr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Gs.updateTime(e)},Lf.prototype.write=function(t){this.Uh(),this.mutations=this.mutations.concat(t)},Lf.prototype.Uh=function(){},Lf),Rf=(Pf.prototype.run=function(){this.jh()},Pf.prototype.jh=function(){var t=this;this.Jn.Rn(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Nf(this.Eu),(n=this.Wh(e))&&n.then(function(t){r.On.Qn(function(){return e.commit().then(function(){r.Mn.resolve(t)}).catch(function(t){r.Gh(t)})})}).catch(function(t){r.Gh(t)}),[2]})})})},Pf.prototype.Wh=function(t){try{var e=this.updateFunction(t);return!Ui(e)&&e.catch&&e.then?e:(this.Mn.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Mn.reject(t),null}},Pf.prototype.Gh=function(t){var e=this;0<this.Qh&&this.zh(t)?(--this.Qh,this.On.Qn(function(){return e.jh(),Promise.resolve()})):this.Mn.reject(t)},Pf.prototype.zh=function(t){if("FirebaseError"!==t.name)return!1;t=t.code;return"aborted"===t||"failed-precondition"===t||!Hi(t)},Pf),Sf=(Of.prototype.start=function(t,e,n,r){var i=this;this.Hh(),this.Lc=t;var o=new ma,s=!1;return this.credentials.Io(function(t){return s?void i.On.rs(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).On.cs(),Pr("RemoteStore","RemoteStore received new credentials"),n=pc(e),e.Ru.add(3),[4,oc(e)];case 1:return t.sent(),n&&e.pu.set("Unknown"),[4,e.Tu.oh(i)];case 2:return t.sent(),e.Ru.delete(3),[4,ic(e)];case 3:return t.sent(),[2]}})})}(i.Ju,t)}):(s=!0,Pr("FirestoreClient","Initializing. user=",t.uid),i.Yh(e,n,r,t,o).then(i.Kh.resolve,i.Kh.reject))}),this.On.Qn(function(){return i.Kh.promise}),o.promise},Of.prototype.enableNetwork=function(){var e=this;return this.Hh(),this.On.enqueue(function(){return e.persistence.dc(!0),(t=e.Ju).Ru.delete(0),ic(t);var t})},Of.prototype.Yh=function(r,i,o,s,u){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={On:this.On,Lc:this.Lc,clientId:this.clientId,credentials:this.credentials,Zc:s,ta:100,persistenceSettings:o},[4,r.initialize(e)];case 1:return t.sent(),[4,i.initialize(r,e)];case 2:return t.sent(),this.persistence=r.persistence,this.Zu=r.Zu,this.gi=r.gi,this.Yc=r.Yc,this.Eu=i.Eu,this.Ju=i.Ju,this.ih=i.ih,this.Jh=i.Xu,this.Jh.Ts=Vc.bind(null,this.ih),this.Jh.Rs=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).na.get(o),1<(r=e.sa.get(n.targetId)).length?[2,(e.sa.set(n.targetId,r.filter(function(t){return!Mu(t,o)})),void e.na.delete(o))]:e._a?(e.Zu.Ks(n.targetId),e.Zu.Xs(n.targetId)?[3,2]:[4,Ph(e.gi,n.targetId,!1).then(function(){e.Zu.Ys(n.targetId),ac(e.Ju,n.targetId),Mc(e,n.targetId)}).catch(Vh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Mc(e,n.targetId),[4,Ph(e.gi,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,this.ih),this.persistence.fc(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),u.resolve(),[3,4];case 3:if(e=t.sent(),u.reject(e),!this.Xh(e))throw e;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),this.Yh(new cl,new ll,{th:!1},s,u))];case 4:return[2]}})})},Of.prototype.Xh=function(t){return"FirebaseError"===t.name?t.code===Tr.FAILED_PRECONDITION||t.code===Tr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Of.prototype.Hh=function(){if(this.On.Zn)throw new Ar(Tr.FAILED_PRECONDITION,"The client has already been terminated.")},Of.prototype.disableNetwork=function(){var t=this;return this.Hh(),this.On.enqueue(function(){return t.persistence.dc(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Ru.add(0),[4,oc(e)];case 1:return t.sent(),e.pu.set("Offline"),[2]}})})}(t.Ju)})},Of.prototype.terminate=function(){var t=this;this.On.ss();var n=new ma;return this.On.ts(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.Yc&&this.Yc.stop(),[4,sc(this.Ju)];case 1:return t.sent(),[4,this.Zu.ei()];case 2:return t.sent(),[4,this.persistence.ei()];case 3:return t.sent(),this.credentials.Ro(),n.resolve(),[3,5];case 4:return e=t.sent(),e=Pa(e,"Failed to shutdown persistence"),n.reject(e),[3,5];case 5:return[2]}})})}),n.promise},Of.prototype.waitForPendingWrites=function(){var t=this;this.Hh();var e=new ma;return this.On.Qn(function(){return function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:pc((n=o).Ju)||Pr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.gi).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Mi.Ta(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.ca.get(r)||[]).push(s),n.ca.set(r,i),[3,4]);case 3:return i=t.sent(),i=Pa(i,"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}(t.ih,e)}),e.promise},Of.prototype.listen=function(t,e,n){var r=this;this.Hh();var i=new fl(n),o=new Ua(t,i,e);return this.On.Qn(function(){return Da(r.Jh,o)}),function(){i.ah(),r.On.Qn(function(){return _a(r.Jh,o)})}},Of.prototype.Zh=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.Hh(),[4,this.Kh.promise];case 1:return t.sent(),e=new ma,[2,(this.On.Qn(function(){return function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.xi.qi(t,e)}))];case 1:return(r=t.sent())instanceof wu?s.resolve(r):r instanceof bu?s.resolve(null):s.reject(new Ar(Tr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),r=Pa(r,"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(n.gi,r,e)}),e.promise)]}})})},Of.prototype.tl=function(h,c){return void 0===c&&(c={}),y(this,void 0,void 0,function(){var e,a=this;return v(this,function(t){switch(t.label){case 0:return this.Hh(),[4,this.Kh.promise];case 1:return t.sent(),e=new ma,[2,(this.On.Qn(function(){return n=a.Jh,r=a.On,i=h,o=c,s=e,t=new fl({next:function(t){r.Qn(function(){return _a(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Ar(Tr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Ar(Tr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Ua(Ru(i.path),t,{includeMetadataChanges:!0,bs:!0}),Da(n,u);var n,r,i,o,s,t,u}),e.promise)]}})})},Of.prototype.el=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.Hh(),[4,this.Kh.promise];case 1:return t.sent(),e=new ma,[2,(this.On.Qn(function(){return function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Lh(r,i,!0)];case 1:return n=t.sent(),e=new Rc(i,n.Zr),n=e.Mu(n.documents),n=e.Qu(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),n=Pa(n,"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(n.gi,r,e)}),e.promise)]}})})},Of.prototype.nl=function(h,c){return void 0===c&&(c={}),y(this,void 0,void 0,function(){var u,a=this;return v(this,function(t){switch(t.label){case 0:return this.Hh(),[4,this.Kh.promise];case 1:return t.sent(),u=new ma,[2,(this.On.Qn(function(){return e=a.Jh,n=a.On,t=h,r=c,i=u,o=new fl({next:function(t){n.Qn(function(){return _a(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Ar(Tr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Ua(t,o,{includeMetadataChanges:!0,bs:!0}),Da(e,s);var e,n,t,r,i,o,s}),u.promise)]}})})},Of.prototype.write=function(t){var e=this;this.Hh();var n=new ma;return this.On.Qn(function(){return Dc(e.ih,t,n)}),n.promise},Of.prototype.B=function(){return this.Lc.B},Of.prototype.sl=function(t){var e=this;this.Hh();var r=new fl(t);return this.On.Qn(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,(e=this.Jh,n=r,e.Es.add(n),void n.next())];var e,n})})}),function(){r.ah(),e.On.Qn(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,void this.Jh.Es.delete(r)]})})})}},Object.defineProperty(Of.prototype,"il",{get:function(){return this.On.Zn},enumerable:!1,configurable:!0}),Of.prototype.transaction=function(t){var e=this;this.Hh();var n=new ma;return this.On.Qn(function(){return new Rf(e.On,e.Eu,t,n).run(),Promise.resolve()}),n.promise},Of.prototype.loadBundle=function(t,e){var n=this;this.Hh();var r=function(t,e){t="string"==typeof t?(new TextEncoder).encode(t):t;return new $a(Ja(t),e)}(t,Ka(this.Lc.B));this.On.Qn(function(){return y(n,void 0,void 0,function(){return v(this,function(t){return[2,(Bc(this.ih,r,e),e.catch(function(t){Vr("FirestoreClient","Loading bundle failed with "+t)}))]})})})},Of.prototype.uc=function(t){return this.Hh(),e=this.gi,n=t,(r=e).persistence.runTransaction("Get named query","readonly",function(t){return r.Cr.uc(t,n)});var e,n,r},Of);function Of(t,e){this.credentials=t,this.On=e,this.clientId=pi.L(),this.Kh=new ma}function Pf(t,e,n,r){this.On=t,this.Eu=e,this.updateFunction=n,this.Mn=r,this.Qh=5,this.Jn=new wa(this.On,"transaction_retry")}function Lf(t){this.Eu=t,this.Lh=new Map,this.mutations=[],this.Oh=!1,this.xh=null,this.kh=new Set}function Vf(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Df,_f,kf=(tp.prototype.al=function(t){switch(ko(t)){case 0:return null;case 1:return t.booleanValue;case 2:return qo(t.integerValue||t.doubleValue);case 3:return this.cl(t.timestampValue);case 4:return this.hl(t);case 5:return t.stringValue;case 6:return this.ul(Go(t.bytesValue));case 7:return this.ll(t.referenceValue);case 8:return this._l(t.geoPointValue);case 9:return this.fl(t.arrayValue);case 10:return this.dl(t.mapValue);default:throw _r()}},tp.prototype.dl=function(t){var n=this,r={};return Cr(t.fields||{},function(t,e){r[t]=n.al(e)}),r},tp.prototype._l=function(t){return new Yl(qo(t.latitude),qo(t.longitude))},tp.prototype.fl=function(t){var e=this;return(t.values||[]).map(function(t){return e.al(t)})},tp.prototype.hl=function(t){switch(this.rl){case"previous":var e=function t(e){e=e.mapValue.fields.__previous_value__;return Vo(e)?t(e):e}(t);return null==e?null:this.al(e);case"estimate":return this.cl(Do(t));default:return null}},tp.prototype.cl=function(t){t=jo(t),t=new Oi(t.seconds,t.nanos);return this.timestampsInSnapshots?t:t.toDate()},tp.prototype.ll=function(t){var e=jr.P(t);kr(bs(e));t=new Ri(e.get(1),e.get(3)),e=new Br(e.u(5));return t.isEqual(this.B)||Lr("Document "+e+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+this.B.projectId+"/"+this.B.database+") instead."),this.ol(e)},tp),Uf=($f.prototype.onProgress=function(t,e,n){this.wl={next:t,error:e,complete:n}},$f.prototype.catch=function(t){return this.ml.promise.catch(t)},$f.prototype.then=function(t,e){return this.ml.promise.then(t,e)},$f.prototype.Va=function(t){this.pa(t),this.wl.complete&&this.wl.complete(),this.ml.resolve(t)},$f.prototype.va=function(t){this.El.taskState="Error",this.wl.next&&this.wl.next(this.El),this.wl.error&&this.wl.error(t),this.ml.reject(t)},$f.prototype.pa=function(t){this.El=t,this.wl.next&&this.wl.next(t)},$f),Cf=hh.lr,Mf=(Zf.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Zf),xf=(Object.defineProperty(Kf.prototype,"bl",{get:function(){return this.Sl||(this.Sl=new cf(this.yh,this.vl.ignoreUndefinedProperties)),this.Sl},enumerable:!1,configurable:!0}),Kf.prototype.settings=function(t){Xr("Firestore.settings",arguments,1),Zr("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.vl),t)).merge;t=new Mf(t);if(this.Pl&&!this.vl.isEqual(t))throw new Ar(Tr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.vl=t).credentials&&(this.gl=function(t){if(!t)return new Fh;switch(t.type){case"gapi":var e=t.client;return kr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Gh(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Ar(Tr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Kf.prototype.enableNetwork=function(){return this.yl(),this.Pl.enableNetwork()},Kf.prototype.disableNetwork=function(){return this.yl(),this.Pl.disableNetwork()},Kf.prototype.enablePersistence=function(t){var e;if(this.Pl)throw new Ar(Tr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var n=!1,r=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Lr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),n=null!==(e=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==e&&e,r=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,n&&r))throw new Ar(Tr.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Dl(this.Tl,this.Al,{th:!0,cacheSizeBytes:this.vl.cacheSizeBytes,synchronizeTabs:n,Cl:r})},Kf.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){var n,e=this;return v(this,function(t){if(void 0!==this.Pl&&!this.Pl.il)throw new Ar(Tr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new ma,[2,(this.Rl.ts(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Tl.clearPersistence(this.yh,this.pl)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},Kf.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Kf.prototype,"Nl",{get:function(){return this.yl(),this.Pl.il},enumerable:!1,configurable:!0}),Kf.prototype.waitForPendingWrites=function(){return this.yl(),this.Pl.waitForPendingWrites()},Kf.prototype.onSnapshotsInSync=function(t){if(this.yl(),Vf(t))return this.Pl.sl(t);Zr("Firestore.onSnapshotsInSync","function",1,t);t={next:t};return this.Pl.sl(t)},Kf.prototype.loadBundle=function(t){this.yl();var e=new Uf;return this.Pl.loadBundle(t,e),e},Kf.prototype.namedQuery=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.yl(),[4,this.Pl.uc(n)];case 1:return[2,(e=t.sent())?new sp(e.query,this,null):null]}})})},Kf.prototype.yl=function(){return this.Pl||this.Dl(new cl,new ll,{th:!1}),this.Pl},Kf.prototype.Fl=function(){return new Ti(this.yh,this.pl,this.vl.host,this.vl.ssl,this.vl.experimentalForceLongPolling)},Kf.prototype.Dl=function(t,e,n){var r=this.Fl();return this.Pl=new Sf(this.gl,this.Rl),this.Pl.start(r,t,e,n)},Kf.Vl=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Ar(Tr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,t=t.options.projectId;if(!t||"string"!=typeof t)throw new Ar(Tr.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Ri(t)},Object.defineProperty(Kf.prototype,"app",{get:function(){if(!this.Il)throw new Ar(Tr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Il},enumerable:!1,configurable:!0}),Kf.prototype.collection=function(t){return Xr("Firestore.collection",arguments,1),Zr("Firestore.collection","non-empty string",1,t),this.yl(),new ap(jr.P(t),this,null)},Kf.prototype.doc=function(t){return Xr("Firestore.doc",arguments,1),Zr("Firestore.doc","non-empty string",1,t),this.yl(),qf.$l(jr.P(t),this,null)},Kf.prototype.collectionGroup=function(t){if(Xr("Firestore.collectionGroup",arguments,1),Zr("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.yl(),new sp((t=t,new Iu(jr.V(),t)),this,null)},Kf.prototype.runTransaction=function(e){var n=this;return Xr("Firestore.runTransaction",arguments,1),Zr("Firestore.runTransaction","function",1,e),this.yl().transaction(function(t){return e(new Ff(n,t))})},Kf.prototype.batch=function(){return this.yl(),new jf(this)},Object.defineProperty(Kf,"logLevel",{get:function(){switch(Or()){case u.DEBUG:return"debug";case u.ERROR:return"error";case u.SILENT:return"silent";case u.WARN:return"warn";case u.INFO:return"info";case u.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),Kf.setLogLevel=function(t){Xr("Firestore.setLogLevel",arguments,1),ri("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Rr.setLogLevel(t)},Kf.prototype.Ll=function(){return this.vl.timestampsInSnapshots},Kf.prototype.Ol=function(){return this.vl},Kf),Ff=(Jf.prototype.get=function(t){var e=this;Xr("Transaction.get",arguments,1);var n=yp("Transaction.get",t,this.xl);return this.kl.Mh([n.Ph]).then(function(t){if(!t||1!==t.length)return _r();t=t[0];if(t instanceof bu)return new Bf(e.xl,n.Ph,null,!1,!1,n.Vh);if(t instanceof wu)return new Bf(e.xl,n.Ph,t,!1,!1,n.Vh);throw _r()})},Jf.prototype.set=function(t,e,n){Kr("Transaction.set",arguments,2,3);t=yp("Transaction.set",t,this.xl);n=fp("Transaction.set",n);e=vp(t.Vh,e,n),n=pf(this.xl.bl,"Transaction.set",t.Ph,e,null!==t.Vh,n);return this.kl.set(t.Ph,n),this},Jf.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return e="string"==typeof e||e instanceof dl?(Jr("Transaction.update",arguments,3),r=yp("Transaction.update",t,this.xl),yf(this.xl.bl,"Transaction.update",r.Ph,e,n,i)):(Xr("Transaction.update",arguments,2),r=yp("Transaction.update",t,this.xl),df(this.xl.bl,"Transaction.update",r.Ph,e)),this.kl.update(r.Ph,e),this},Jf.prototype.delete=function(t){Xr("Transaction.delete",arguments,1);t=yp("Transaction.delete",t,this.xl);return this.kl.delete(t.Ph),this},Jf),jf=(Xf.prototype.set=function(t,e,n){Kr("WriteBatch.set",arguments,2,3),this.ql();t=yp("WriteBatch.set",t,this.xl);n=fp("WriteBatch.set",n);e=vp(t.Vh,e,n),n=pf(this.xl.bl,"WriteBatch.set",t.Ph,e,null!==t.Vh,n);return this.Ml=this.Ml.concat(n.ph(t.Ph,Gs.He())),this},Xf.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return this.ql(),e="string"==typeof e||e instanceof dl?(Jr("WriteBatch.update",arguments,3),r=yp("WriteBatch.update",t,this.xl),yf(this.xl.bl,"WriteBatch.update",r.Ph,e,n,i)):(Xr("WriteBatch.update",arguments,2),r=yp("WriteBatch.update",t,this.xl),df(this.xl.bl,"WriteBatch.update",r.Ph,e)),this.Ml=this.Ml.concat(e.ph(r.Ph,Gs.exists(!0))),this},Xf.prototype.delete=function(t){Xr("WriteBatch.delete",arguments,1),this.ql();t=yp("WriteBatch.delete",t,this.xl);return this.Ml=this.Ml.concat(new au(t.Ph,Gs.He())),this},Xf.prototype.commit=function(){return this.ql(),this.Ul=!0,0<this.Ml.length?this.xl.yl().write(this.Ml):Promise.resolve()},Xf.prototype.ql=function(){if(this.Ul)throw new Ar(Tr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Xf),qf=(n(Yf,_f=Kl),Yf.$l=function(t,e,n){if(t.length%2!=0)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.R()+" has "+t.length);return new Yf(new Br(t),e,n)},Object.defineProperty(Yf.prototype,"id",{get:function(){return this.Ph.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Yf.prototype,"parent",{get:function(){return new ap(this.Ph.path.h(),this.firestore,this.Vh)},enumerable:!1,configurable:!0}),Object.defineProperty(Yf.prototype,"path",{get:function(){return this.Ph.path.R()},enumerable:!1,configurable:!0}),Yf.prototype.collection=function(t){if(Xr("DocumentReference.collection",arguments,1),Zr("DocumentReference.collection","non-empty string",1,t),!t)throw new Ar(Tr.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");t=jr.P(t);return new ap(this.Ph.path.child(t),this.firestore,null)},Yf.prototype.isEqual=function(t){if(!(t instanceof Yf))throw hi("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Ph.isEqual(t.Ph)&&this.Vh===t.Vh},Yf.prototype.set=function(t,e){Kr("DocumentReference.set",arguments,1,2),e=fp("DocumentReference.set",e);t=vp(this.Vh,t,e),e=pf(this.firestore.bl,"DocumentReference.set",this.Ph,t,null!==this.Vh,e);return this.Pl.write(e.ph(this.Ph,Gs.He()))},Yf.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return t="string"==typeof t||t instanceof dl?(Jr("DocumentReference.update",arguments,2),yf(this.firestore.bl,"DocumentReference.update",this.Ph,t,e,n)):(Xr("DocumentReference.update",arguments,1),df(this.firestore.bl,"DocumentReference.update",this.Ph,t)),this.Pl.write(t.ph(this.Ph,Gs.exists(!0)))},Yf.prototype.delete=function(){return Xr("DocumentReference.delete",arguments,0),this.Pl.write([new au(this.Ph,Gs.He())])},Yf.prototype.onSnapshot=function(){for(var e=this,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];Kr("DocumentReference.onSnapshot",arguments,1,4);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||Vf(n[i])||(ai("DocumentReference.onSnapshot",r=n[i],["includeMetadataChanges"]),ei("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};Vf(n[i])?(s=n[i],n[i]=null===(r=s.next)||void 0===r?void 0:r.bind(s),n[i+1]=null===(r=s.error)||void 0===r?void 0:r.bind(s),n[i+2]=null===(r=s.complete)||void 0===r?void 0:r.bind(s)):(Zr("DocumentReference.onSnapshot","function",i,n[i]),$r("DocumentReference.onSnapshot","function",i+1,n[i+1]),$r("DocumentReference.onSnapshot","function",i+2,n[i+2]));var s={next:function(t){n[i]&&n[i](e.Bl(t))},error:n[i+1],complete:n[i+2]};return this.Pl.listen(Ru(this.Ph.path),o,s)},Yf.prototype.get=function(t){var e=this;Kr("DocumentReference.get",arguments,0,1),dp("DocumentReference.get",t);var n=this.firestore.yl();return t&&"cache"===t.source?n.Zh(this.Ph).then(function(t){return new Bf(e.firestore,e.Ph,t,!0,t instanceof wu&&t.Ye,e.Vh)}):n.tl(this.Ph,t).then(function(t){return e.Bl(t)})},Yf.prototype.withConverter=function(t){return new Yf(this.Ph,this.firestore,t)},Yf.prototype.Bl=function(t){var e=t.docs.get(this.Ph);return new Bf(this.firestore,this.Ph,e,t.fromCache,t.hasPendingWrites,this.Vh)},Yf),Gf=(Wf.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Wf),Bf=(Hf.prototype.data=function(t){var e=this;if(Kr("DocumentSnapshot.data",arguments,0,1),t=pp("DocumentSnapshot.data",t),this.Ql){if(this.Vh){var n=new Qf(this.xl,this.Ph,this.Ql,this.jl,this.Wl,null);return this.Vh.fromFirestore(n,t)}return new kf(this.xl.yh,this.xl.Ll(),t.serverTimestamps||"none",function(t){return new qf(t,e.xl,null)},function(t){return new Ni(t)}).al(this.Ql.sn())}},Hf.prototype.get=function(t,e){var n=this;if(Kr("DocumentSnapshot.get",arguments,1,2),e=pp("DocumentSnapshot.get",e),this.Ql){t=this.Ql.data().field(Ef("DocumentSnapshot.get",t,this.Ph));if(null!==t)return new kf(this.xl.yh,this.xl.Ll(),e.serverTimestamps||"none",function(t){return new qf(t,n.xl,n.Vh)},function(t){return new Ni(t)}).al(t)}},Object.defineProperty(Hf.prototype,"id",{get:function(){return this.Ph.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Hf.prototype,"ref",{get:function(){return new qf(this.Ph,this.xl,this.Vh)},enumerable:!1,configurable:!0}),Object.defineProperty(Hf.prototype,"exists",{get:function(){return null!==this.Ql},enumerable:!1,configurable:!0}),Object.defineProperty(Hf.prototype,"metadata",{get:function(){return new Gf(this.Wl,this.jl)},enumerable:!1,configurable:!0}),Hf.prototype.isEqual=function(t){if(!(t instanceof Hf))throw hi("isEqual","DocumentSnapshot",1,t);return this.xl===t.xl&&this.jl===t.jl&&this.Ph.isEqual(t.Ph)&&(null===this.Ql?null===t.Ql:this.Ql.isEqual(t.Ql))&&this.Vh===t.Vh},Hf),Qf=(n(zf,Df=Bf),zf.prototype.data=function(t){return Df.prototype.data.call(this,t)},zf);function zf(){return null!==Df&&Df.apply(this,arguments)||this}function Hf(t,e,n,r,i,o){this.xl=t,this.Ph=e,this.Ql=n,this.jl=r,this.Wl=i,this.Vh=o}function Wf(t,e){this.hasPendingWrites=t,this.fromCache=e}function Yf(t,e,n){var r=this;return(r=_f.call(this,e.yh,t,n)||this).Ph=t,r.firestore=e,r.Vh=n,r.Pl=r.firestore.yl(),r}function Xf(t){this.xl=t,this.Ml=[],this.Ul=!1}function Jf(t,e){this.xl=t,this.kl=e}function Kf(t,e,n,r){var i=this;if(void 0===n&&(n=new cl),void 0===r&&(r=new ll),this.Tl=n,this.Al=r,this.Il=null,this.Rl=new Ra,this.INTERNAL={delete:function(){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.yl(),[4,this.Pl.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){r=t;this.Il=r,this.yh=Kf.Vl(r),this.pl=r.name,this.gl=new jh(e)}else{t=t;if(!t.projectId)throw new Ar(Tr.INVALID_ARGUMENT,"Must provide projectId");this.yh=new Ri(t.projectId,t.database),this.pl="[DEFAULT]",this.gl=new Fh}this.vl=new Mf({})}function Zf(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Ar(Tr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else ti("settings","non-empty string","host",t.host),this.host=t.host,ei("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(ai("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),ei("settings","object","credentials",t.credentials),this.credentials=t.credentials,ei("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),ei("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Lr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Lr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(e=t.timestampsInSnapshots)||void 0===e||e,this.ignoreUndefinedProperties=null!==(e=t.ignoreUndefinedProperties)&&void 0!==e&&e,ei("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=hh.dr;else{if(t.cacheSizeBytes!==Cf&&t.cacheSizeBytes<hh._r)throw new Ar(Tr.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+hh._r);this.cacheSizeBytes=t.cacheSizeBytes}ei("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(t=t.experimentalForceLongPolling)&&void 0!==t&&t}function $f(){this.wl={},this.ml=new ma,this.El={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function tp(t,e,n,r,i){this.B=t,this.timestampsInSnapshots=e,this.rl=n,this.ol=r,this.ul=i}function ep(t,e,n){if("string"==typeof n){if(""===n)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Vu(e)&&-1!==n.indexOf("/"))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");e=e.path.child(jr.P(n));if(!Br.F(e))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Bo(t,new Br(e))}if(n instanceof Kl)return Bo(t,n.Ph);throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+si(n)+".")}function np(t,e){if(!Array.isArray(t)||0===t.length)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function rp(t,e,n){if(!n.isEqual(e))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function ip(t){if(Ou(t)&&0===t.rn.length)throw new Ar(Tr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var op,sp=(lp.prototype.where=function(t,e,n){Xr("Query.where",arguments,3),ui("Query.where",3,n);e=ri("Query.where",["<","<=","==","!=",">=",">","array-contains","in","array-contains-any","not-in"],2,e),t=Ef("Query.where",t),e=function(t,e,n,r,i,o,s){if(i.g()){if("array-contains"===o||"array-contains-any"===o)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){np(s,o);for(var u=[],a=0,h=s;a<h.length;a++){var c=h[a];u.push(ep(r,t,c))}l={arrayValue:{values:u}}}else l=ep(r,t,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||np(s,o),l=vf(n,e,s,"in"===o||"not-in"===o);var l=Bu.create(i,o,l);return function(t,e){if(e.cn()){var n=Lu(t);if(null!==n&&!n.isEqual(e.field))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");n=Pu(t);null!==n&&rp(0,e.field,n)}t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}());if(null!==t)throw t===e.op?new Ar(Tr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Ar(Tr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,l),l}(this.Gl,"Query.where",this.firestore.bl,this.firestore.yh,t,e,n);return new lp((n=this.Gl,e=n.filters.concat([e]),new Iu(n.path,n.collectionGroup,n.rn.slice(),e,n.limit,n.on,n.startAt,n.endAt)),this.firestore,this.Vh)},lp.prototype.orderBy=function(t,e){if(Kr("Query.orderBy",arguments,1,2),$r("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Ar(Tr.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=Ef("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new ga(e,n);return e=r,null!==Pu(n=t)||null!==(t=Lu(n))&&rp(0,t,e.field),r}(this.Gl,t,n);return new lp((n=this.Gl,t=n.rn.concat([t]),new Iu(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.on,n.startAt,n.endAt)),this.firestore,this.Vh)},lp.prototype.limit=function(t){return Xr("Query.limit",arguments,1),Zr("Query.limit","number",1,t),ci("Query.limit",1,t),new lp(ku(this.Gl,t,"F"),this.firestore,this.Vh)},lp.prototype.limitToLast=function(t){return Xr("Query.limitToLast",arguments,1),Zr("Query.limitToLast","number",1,t),ci("Query.limitToLast",1,t),new lp(ku(this.Gl,t,"L"),this.firestore,this.Vh)},lp.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Jr("Query.startAt",arguments,1);t=this.zl("Query.startAt",t,e,!0);return new lp(Uu(this.Gl,t),this.firestore,this.Vh)},lp.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Jr("Query.startAfter",arguments,1);t=this.zl("Query.startAfter",t,e,!1);return new lp(Uu(this.Gl,t),this.firestore,this.Vh)},lp.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Jr("Query.endBefore",arguments,1);t=this.zl("Query.endBefore",t,e,!0);return new lp(Cu(this.Gl,t),this.firestore,this.Vh)},lp.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Jr("Query.endAt",arguments,1);t=this.zl("Query.endAt",t,e,!1);return new lp(Cu(this.Gl,t),this.firestore,this.Vh)},lp.prototype.isEqual=function(t){if(!(t instanceof lp))throw hi("isEqual","Query",1,t);return this.firestore===t.firestore&&Mu(this.Gl,t.Gl)&&this.Vh===t.Vh},lp.prototype.withConverter=function(t){return new lp(this.Gl,this.firestore,t)},lp.prototype.zl=function(h,t,e,n){if(ui(h,1,t),t instanceof Bf)return Xr(h,i([t],e),1),function(t,e,n,r){if(!n)throw new Ar(Tr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+h+"().");for(var i=[],o=0,s=Du(t);o<s.length;o++){var u=s[o];if(u.field.g())i.push(Bo(e,n.key));else{var a=n.field(u.field);if(Vo(a))throw new Ar(Tr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){u=u.field.R();throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}i.push(a)}}return new ha(i,r)}(this.Gl,this.firestore.yh,t.Ql,n);e=[t].concat(e);return function(t,e,n,r,i,o){var s=t.rn;if(i.length>s.length)throw new Ar(Tr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.g()){if("string"!=typeof h)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!Vu(t)&&-1!==h.indexOf("/"))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(jr.P(h));if(!Br.F(c))throw new Ar(Tr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");c=new Br(c);u.push(Bo(e,c))}else{h=vf(n,r,h);u.push(h)}}return new ha(u,o)}(this.Gl,this.firestore.yh,this.firestore.bl,h,e,n)},lp.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Kr("Query.onSnapshot",arguments,1,4);var i={},o=0;"object"!=typeof n[o]||Vf(n[o])||(ai("Query.onSnapshot",i=n[o],["includeMetadataChanges"]),ei("Query.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),o++),Vf(n[o])?(s=n[o],n[o]=null===(t=s.next)||void 0===t?void 0:t.bind(s),n[o+1]=null===(t=s.error)||void 0===t?void 0:t.bind(s),n[o+2]=null===(t=s.complete)||void 0===t?void 0:t.bind(s)):(Zr("Query.onSnapshot","function",o,n[o]),$r("Query.onSnapshot","function",o+1,n[o+1]),$r("Query.onSnapshot","function",o+2,n[o+2]));var s={next:function(t){n[o]&&n[o](new up(e.firestore,e.Gl,t,e.Vh))},error:n[o+1],complete:n[o+2]};return ip(this.Gl),this.firestore.yl().listen(this.Gl,i,s)},lp.prototype.get=function(t){var e=this;Kr("Query.get",arguments,0,1),dp("Query.get",t),ip(this.Gl);var n=this.firestore.yl();return(t&&"cache"===t.source?n.el(this.Gl):n.nl(this.Gl,t)).then(function(t){return new up(e.firestore,e.Gl,t,e.Vh)})},lp),up=(Object.defineProperty(cp.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(cp.prototype,"empty",{get:function(){return this.Hl.docs.m()},enumerable:!1,configurable:!0}),Object.defineProperty(cp.prototype,"size",{get:function(){return this.Hl.docs.size},enumerable:!1,configurable:!0}),cp.prototype.forEach=function(e,n){var r=this;Kr("QuerySnapshot.forEach",arguments,1,2),Zr("QuerySnapshot.forEach","function",1,e),this.Hl.docs.forEach(function(t){e.call(n,r.Xl(t,r.metadata.fromCache,r.Hl.Qt.has(t.key)))})},Object.defineProperty(cp.prototype,"query",{get:function(){return new sp(this.Kl,this.xl,this.Vh)},enumerable:!1,configurable:!0}),cp.prototype.docChanges=function(t){t&&(ai("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),ei("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));t=!(!t||!t.includeMetadataChanges);if(t&&this.Hl.Wt)throw new Ar(Tr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Yl&&this.Jl===t||(this.Yl=function(i,e,o){if(i.Bt.m()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Bt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _r()}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this.Hl,t,this.Xl.bind(this)),this.Jl=t),this.Yl},cp.prototype.isEqual=function(t){if(!(t instanceof cp))throw hi("isEqual","QuerySnapshot",1,t);return this.xl===t.xl&&Mu(this.Kl,t.Kl)&&this.Hl.isEqual(t.Hl)&&this.Vh===t.Vh},cp.prototype.Xl=function(t,e,n){return new Qf(this.xl,t.key,t,e,n,this.Vh)},cp),ap=(n(hp,op=sp),Object.defineProperty(hp.prototype,"id",{get:function(){return this.Gl.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(hp.prototype,"parent",{get:function(){var t=this.Gl.path.h();return t.m()?null:new qf(new Br(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(hp.prototype,"path",{get:function(){return this.Gl.path.R()},enumerable:!1,configurable:!0}),hp.prototype.doc=function(t){Kr("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=pi.L()),Zr("CollectionReference.doc","non-empty string",1,t);t=jr.P(t);return qf.$l(this.Gl.path.child(t),this.firestore,this.Vh)},hp.prototype.add=function(t){Xr("CollectionReference.add",arguments,1);t=this.Vh?this.Vh.toFirestore(t):t;Zr("CollectionReference.add","object",1,t);var e=this.doc();return new qf(e.Ph,this.firestore,null).set(t).then(function(){return e})},hp.prototype.withConverter=function(t){return new hp(this.Zl,this.firestore,t)},hp);function hp(t,e,n){var r=this;if(((r=op.call(this,Ru(t),e,n)||this).Zl=t).length%2!=1)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.R()+" has "+t.length);return r}function cp(t,e,n,r){this.xl=t,this.Kl=e,this.Hl=n,this.Vh=r,this.Yl=null,this.Jl=null,this.metadata=new Gf(n.hasPendingWrites,n.fromCache)}function lp(t,e,n){this.Gl=t,this.firestore=e,this.Vh=n}function fp(t,e){if(void 0===e)return{merge:!1};if(ai(t,e,["merge","mergeFields"]),ei(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n,r){if(!(n instanceof Array))throw new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+si(n));for(var i=0;i<n.length;++i)if(!r(n[i]))throw new Ar(Tr.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+si(n[i]))}(t,"mergeFields",n,function(t){return"string"==typeof t||t instanceof dl}),void 0!==e.mergeFields&&void 0!==e.merge)throw new Ar(Tr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function pp(t,e){return void 0===e?{}:(ai(t,e,["serverTimestamps"]),ni(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function dp(t,e){$r(t,"object",1,e),e&&(ai(t,e,["source"]),ni(t,0,"source",e.source,["default","server","cache"]))}function yp(t,e,n){if(e instanceof Kl){if(e.firestore!==n)throw new Ar(Tr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw hi(t,"DocumentReference",1,e)}function vp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var gp,mp,l=(n(bp,gp=Xl),bp.serverTimestamp=function(){Yr("FieldValue.serverTimestamp",arguments);var t=new Ql("serverTimestamp");return t.lh="FieldValue.serverTimestamp",new bp(t)},bp.delete=function(){Yr("FieldValue.delete",arguments);var t=new gl("deleteField");return t.lh="FieldValue.delete",new bp(t)},bp.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Jr("FieldValue.arrayUnion",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Jr("arrayUnion()",arguments,1),new zl("arrayUnion",t)}.apply(void 0,t);return n.lh="FieldValue.arrayUnion",new bp(n)},bp.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Jr("FieldValue.arrayRemove",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Jr("arrayRemove()",arguments,1),new Hl("arrayRemove",t)}.apply(void 0,t);return n.lh="FieldValue.arrayRemove",new bp(n)},bp.increment=function(t){Zr("FieldValue.increment","number",1,t),Xr("FieldValue.increment",arguments,1);t=new Wl("increment",t);return t.lh="FieldValue.increment",new bp(t)},bp.prototype.isEqual=function(t){return this.Rh.isEqual(t.Rh)},bp),wp={Firestore:xf,GeoPoint:Yl,Timestamp:Oi,Blob:Ni,Transaction:Ff,WriteBatch:jf,DocumentReference:qf,DocumentSnapshot:Bf,Query:sp,QueryDocumentSnapshot:Qf,QuerySnapshot:up,CollectionReference:ap,FieldPath:dl,FieldValue:l,setLogLevel:xf.setLogLevel,CACHE_SIZE_UNLIMITED:Cf};function bp(){return null!==gp&&gp.apply(this,arguments)||this}(mp=e.default).INTERNAL.registerComponent(new br("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new xf(e,t,new cl,new ll);var e},"PUBLIC").setServiceProps(Object.assign({},wp))),mp.registerVersion("@firebase/firestore","1.17.2-alpha.01492c06e")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(lp){"use strict";try{(function(){var u,t,e=(t=lp)&&"object"==typeof t&&"default"in t?t:{default:t},r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(be=u=u||{})[be.DEBUG=0]="DEBUG",be[be.VERBOSE=1]="VERBOSE",be[be.INFO=2]="INFO",be[be.WARN=3]="WARN",be[be.ERROR=4]="ERROR",be[be.SILENT=5]="SILENT";var a={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},h=u.INFO,c=((Ee={})[u.DEBUG]="log",Ee[u.VERBOSE]="log",Ee[u.INFO]="info",Ee[u.WARN]="warn",Ee[u.ERROR]="error",Ee),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?a[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=h,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e){return(e=d.call(this,e)||this).code=t,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,t=(t=this.errors[t])?(r=i,t.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").",s=new m(o,t),u=0,a=Object.keys(i);u<a.length;u++){var h=a[u];"_"!==h.slice(-1)&&(h in s&&console.warn('Overwriting FirebaseError base field "'+h+'" can cause unexpected behavior.'),s[h]=i[h])}return s},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,R="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S=R||self;function O(){}function P(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function L(t){var e=P(t);return"array"==e||"object"==e&&"number"==typeof t.length}function V(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var D="closure_uid_"+(1e9*Math.random()>>>0),_=0;function k(t,e,n){return t.call.apply(t.bind,arguments)}function U(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?k:U).apply(null,arguments)}function M(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var x=Date.now;function F(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function j(){this.j=this.j,this.i=this.i}j.prototype.j=!1,j.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,D)&&this[D]||(this[D]=++_))},j.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var q=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function B(){return Array.prototype.concat.apply([],arguments)}function Q(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function z(t){return/^[\s\xa0]*$/.test(t)}var H,W=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}var J=S.navigator;function K(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Z(t){var e,n={};for(e in t)n[e]=t[e];return n}H=(J=J&&J.userAgent)?J:"";var $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<$.length;i++)e=$[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function et(t){return et[" "](t),t}et[" "]=O;var nt,rt=Y(H,"Opera"),it=Y(H,"Trident")||Y(H,"MSIE"),ot=Y(H,"Edge"),st=ot||it,ut=Y(H,"Gecko")&&!(Y(H.toLowerCase(),"webkit")&&!Y(H,"Edge"))&&!(Y(H,"Trident")||Y(H,"MSIE"))&&!Y(H,"Edge"),at=Y(H.toLowerCase(),"webkit")&&!Y(H,"Edge");function ht(){var t=S.document;return t?t.documentMode:void 0}var ct="",lt=(lt=H,ut?/rv:([^\);]+)(\)|;)/.exec(lt):ot?/Edge\/([\d\.]+)/.exec(lt):it?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(lt):at?/WebKit\/(\S+)/.exec(lt):rt?/(?:Version)[ \/]?(\S+)/.exec(lt):void 0);lt&&(ct=lt?lt[1]:""),nt=it&&null!=(lt=ht())&&lt>parseFloat(ct)?String(lt):ct;var ft={};function pt(u){return t=u,e=function(){for(var t=0,e=W(String(nt)).split("."),n=W(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=ft,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var dt=S.document&&it&&(ht()||parseInt(nt,10))||void 0,yt=!it||9<=Number(dt),vt=it&&!pt("9"),gt=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",O,e),S.removeEventListener("test",O,e)}catch(t){}return t}();function mt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function wt(t,e){if(mt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ut){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:bt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}mt.prototype.b=function(){this.defaultPrevented=!0},F(wt,mt);var bt={2:"touch",3:"pen",4:"mouse"};wt.prototype.b=function(){wt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,vt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Et="closure_listenable_"+(1e6*Math.random()|0),It=0;function Tt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++It,this.Y=this.Z=!1}function At(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Nt(t){this.src=t,this.a={},this.b=0}function Rt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=q(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(At(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function St(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Nt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=St(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Tt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Ot="closure_lm_"+(1e6*Math.random()|0),Pt={};function Lt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=xt(r),e&&e[Et]?e.wa(n,r,V(i)?!!i.capture:!!i,o):Vt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Lt(t,e[o],n,r,i);return null}return n=xt(n),t&&t[Et]?t.va(e,n,V(r)?!!r.capture:!!r,i):Vt(t,e,n,!1,r,i)}function Vt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=V(i)?!!i.capture:!!i;if(s&&!yt)return null;var u,a,h=Ct(t);if(h||(t[Ot]=h=new Nt(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Ut,r=a=yt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)gt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(_t(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Dt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Et]?Rt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(_t(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ct(e))?(Rt(n,t),0==n.b&&(n.src=null,e[Ot]=null)):At(t)))}function _t(t){return t in Pt?Pt[t]:Pt[t]="on"+t}function kt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Dt(t),n.call(r,e)}function Ut(t,e){if(t.Y)return!0;if(yt)return kt(t,new wt(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return kt(t,e=new wt(e,this))}function Ct(t){return(t=t[Ot])instanceof Nt?t:null}var Mt="__closure_events_fn_"+(1e9*Math.random()>>>0);function xt(e){return"function"==P(e)?e:(e[Mt]||(e[Mt]=function(t){return e.handleEvent(t)}),e[Mt])}function Ft(){j.call(this),this.c=new Nt(this),(this.J=this).C=null}function jt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Rt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}F(Ft,j),Ft.prototype[Et]=!0,(N=Ft.prototype).addEventListener=function(t,e,n,r){Lt(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=V(i)?!!i.capture:!!i,r=xt(r),e&&e[Et]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=St(s=e.a[n],r,i,o))&&(At(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ct(e))&&(n=e.a[n.toString()],e=-1,n&&(e=St(n,r,i,o)),(r=-1<e?n[e]:null)&&Dt(r))}(this,t,e,n,r)},N.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new mt(t,n):t instanceof mt?t.target=t.target||n:(s=t,tt(t=new mt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=jt(o,r,!0,t)&&s;if(s=jt(o=t.a=n,r,!0,t)&&s,s=jt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=jt(o=t.a=e[i],r,!1,t)&&s;return s},N.G=function(){if(Ft.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)At(n[r]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},N.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var qt=S.JSON.stringify;function Gt(){this.b=this.a=null}var Bt,Qt=(zt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new zt(function(){return new Ht},function(t){t.reset()},100));function zt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Ht(){this.next=this.b=this.a=null}function Wt(t,e){var n;Bt||(n=S.Promise.resolve(void 0),Bt=function(){n.then(Jt)}),Yt||(Bt(),Yt=!0),Xt.add(t,e)}Gt.prototype.add=function(t,e){var n=Qt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Ht.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Yt=!(Ht.prototype.reset=function(){this.next=this.b=this.a=null}),Xt=new Gt;function Jt(){for(var t,e;n=e=void 0,n=null,(e=Xt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var n=Qt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Yt=!1}function Kt(t,e){Ft.call(this),this.b=t||1,this.a=e||S,this.f=C(this.Ya,this),this.g=x()}function Zt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function $t(t,e,n){if("function"==P(t))n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}F(Kt,Ft),(N=Kt.prototype).aa=!1,N.M=null,N.Ya=function(){var t;this.aa&&(0<(t=x()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(Zt(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=x())},N.G=function(){Kt.S.G.call(this),Zt(this),delete this.a};var te,ee,ne,re=(T(ee=oe,ne=te=j),ee.prototype=null===ne?Object.create(ne):(ie.prototype=ne.prototype,new ie),oe.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=$t(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},oe.prototype.G=function(){te.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},oe);function ie(){this.constructor=ee}function oe(t,e,n){var r=te.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function se(t){j.call(this),this.b=t,this.a={}}F(se,j);var ue=[];function ae(t,e,n,r){Array.isArray(n)||(n&&(ue[0]=n.toString()),n=ue);for(var i=0;i<n.length;i++){var o=Lt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function he(t){K(t.a,function(t,e){this.a.hasOwnProperty(e)&&Dt(t)},t),t.a={}}function ce(){this.a=!0}function le(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return qt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}se.prototype.G=function(){se.S.G.call(this),he(this)},se.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ce.prototype.info=function(){};var fe=null;function pe(){return fe=fe||new Ft}function de(t){mt.call(this,"serverreachability",t)}function ye(){var t=pe();t.dispatchEvent(new de(t))}function ve(t){mt.call(this,"statevent",t)}function ge(){var t=pe();t.dispatchEvent(new ve(t))}function me(t){mt.call(this,"timingevent",t)}function we(t,e){if("function"!=P(t))throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}F(de,mt),F(ve,mt),F(me,mt);var be={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ee={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Ie(){}function Te(t){var e;return(e=t.a)||(e=t.a={}),e}function Ae(){}Ie.prototype.a=null;var Ne,R={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Re(){mt.call(this,"d")}function Se(){mt.call(this,"c")}function Oe(){}function Pe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new se(this),this.P=Le,t=st?125:void 0,this.R=new Kt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}F(Re,mt),F(Se,mt),F(Oe,Ie),Ne=new Oe;var Le=45e3,Ve={},De={};function _e(t,e,n){t.H=1,t.i=tn(Ye(e)),t.j=n,t.I=!0,ke(t,null)}function ke(t,e){t.u=x(),Ce(t),t.l=Ye(t.i);var s,u,a,h,c,l,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),dn(n.b,"t",r),t.D=0,t.a=ur(t.g,t.g.C?e:null),0<t.O&&(t.F=new re(C(t.Ca,t,t.a),t.O)),ae(t.J,t.a,"readystatechange",t.Wa),e=t.B?Z(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ye(),s=t.c,u=t.m,a=t.l,h=t.f,c=t.T,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function Ue(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?De:(i=Number(u.substring(i,o)),isNaN(i)?Ve:(o+=1)+i>u.length?De:(u=u.substr(o,i),r.D=o+i,u)));if(u==De){4==e&&(t.h=4,ge(),s=!1),le(t.c,t.f,null,"[Incomplete Response]");break}if(u==Ve){t.h=4,ge(),le(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}le(t.c,t.f,u,null),qe(t,u)}4==e&&0==n.length&&(t.h=1,ge(),s=!1),t.b=t.b&&s,s?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),$n(e),e.F=!0)):(le(t.c,t.f,n,"[Invalid Chunked Response]"),je(t),Fe(t))}function Ce(t){t.U=x()+t.P,Me(t,t.P)}function Me(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=we(C(t.Ua,t),e)}function xe(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function Fe(t){0==t.g.v||t.A||nr(t.g,t)}function je(t){xe(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Zt(t.R),he(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function qe(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||En(u.b,t)))if(u.I=t.N,!t.C&&En(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var h=a;if(0==h[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;er(u),Qn(u)}Zn(u),ge()}}else u.oa=h[1],0<u.oa-u.P&&h[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=we(C(u.Ra,u),6e3));if(bn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else ir(u,11)}else if(!t.C&&u.a!=t||er(u),!z(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)h=e[a],u.P=h[0],h=h[1],2==u.v?"c"==h[0]?(u.J=h[1],u.ga=h[2],null!=(r=h[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=h[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=h[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(Y(r,"spdy")||Y(r,"quic")||Y(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(In(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,$e(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.V&&(u.N=x()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=sr(n,n.C?n.ga:null,n.fa),i.C?(Tn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(xe(o),Ce(o)),n.a=i):Kn(n),0<u.g.length&&Wn(u)):"stop"!=h[0]&&"close"!=h[0]||ir(u,7):3==u.v&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?ir(u,7):Bn(u):"noop"!=h[0]&&u.f&&u.f.sa(h),u.o=0);ye()}catch(t){}}function Ge(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(L(t)||"string"==typeof t)G(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(L(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(L(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Be(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Be)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Qe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];ze(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)ze(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function ze(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=Pe.prototype).setTimeout=function(t){this.P=t},N.Wa=function(t){t=t.target;var e=this.F;e&&3==Fn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=Fn(this.a),n=this.a.ua(),r=this.a.X();if(!(e<3||3==e&&!st&&!this.a.$())){this.A||4!=e||7==n||ye(),xe(this);var i=this.a.X();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,u=this.m,a=this.l,h=this.f,c=this.T,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+c+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.V&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,ge(),je(this),Fe(this);break t}le(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,qe(this,s)}this.I?(Ue(this,e,n),st&&this.b&&3==e&&(ae(this.J,this.R,"tick",this.Va),this.R.start())):(le(this.c,this.f,n,null),qe(this,n)),4==e&&je(this),this.b&&!this.A&&(4==e?nr(this.g,this):(this.b=!1,Ce(this)))}else 400==i&&0<n.indexOf("Unknown SID")?this.h=3:this.h=0,ge(),je(this),Fe(this)}}}catch(t){}var u,a,h,c,l,f},N.Va=function(){var t,e;this.a&&(t=Fn(this.a),e=this.a.$(),this.D<e.length&&(xe(this),Ue(this,t,e),this.b&&4!=t&&Ce(this)))},N.cancel=function(){this.A=!0,je(this)},N.Ua=function(){this.o=null;var t,e,n=x();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ye(),ge()),je(this),this.h=2,Fe(this)):Me(this,this.U-n)},(N=Be.prototype).K=function(){Qe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return Qe(this),this.a.concat()},N.get=function(t,e){return ze(this.b,t)?this.b[t]:e},N.set=function(t,e){ze(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var He=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function We(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof We?(this.a=void 0!==e?e:t.a,Xe(this,t.f),this.j=t.j,Je(this,t.c),Ke(this,t.h),this.g=t.g,e=t.b,(n=new cn).c=e.c,e.a&&(n.a=new Be(e.a),n.b=e.b),Ze(this,n),this.i=t.i):t&&(n=String(t).match(He))?(this.a=!!e,Xe(this,n[1]||"",!0),this.j=en(n[2]||""),Je(this,n[3]||"",!0),Ke(this,n[4]),this.g=en(n[5]||"",!0),Ze(this,n[6]||"",!0),this.i=en(n[7]||"")):(this.a=!!e,this.b=new cn(null,this.a))}function Ye(t){return new We(t)}function Xe(t,e,n){t.f=n?en(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Je(t,e,n){t.c=n?en(e,!0):e}function Ke(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ze(t,e,n){var r,i;e instanceof cn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(ln(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(fn(this,e),dn(this,n,t))},r)),r.f=i):(n||(e=nn(e,an)),t.b=new cn(e,t.a))}function $e(t,e,n){t.b.set(e,n)}function tn(t){return $e(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^x()).toString(36)),t}function en(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function nn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,rn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function rn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}We.prototype.toString=function(){var t=[],e=this.f;e&&t.push(nn(e,on,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(nn(e,on,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(nn(n,"/"==n.charAt(0)?un:sn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",nn(n,hn)),t.join("")};var on=/[#\/\?@]/g,sn=/[#\?:]/g,un=/[#\?]/g,an=/[#\?@]/g,hn=/#/g;function cn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function ln(u){u.a||(u.a=new Be,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function fn(t,e){ln(t),e=yn(t,e),ze(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,ze((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Qe(t)))}function pn(t,e){return ln(t),e=yn(t,e),ze(t.a.b,e)}function dn(t,e,n){fn(t,e),0<n.length&&(t.c=null,t.a.set(yn(t,e),Q(n)),t.b+=n.length)}function yn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function vn(t,e){this.b=t,this.a=e}function gn(t){this.g=t||mn,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(N=cn.prototype).add=function(t,e){ln(this),this.c=null,t=yn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,r){ln(this),this.a.forEach(function(t,e){G(t,function(t){n.call(r,t,e,this)},this)},this)},N.L=function(){ln(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},N.K=function(t){ln(this);var e=[];if("string"==typeof t)pn(this,t)&&(e=B(e,this.a.get(yn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},N.set=function(t,e){return ln(this),this.c=null,pn(this,t=yn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var mn=10;function wn(t){return t.b||t.a&&t.a.size>=t.f}function bn(t){return t.b?1:t.a?t.a.size:0}function En(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function In(t,e){t.a?t.a.add(e):t.b=e}function Tn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function An(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return Q(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Nn(){}function Rn(){this.a=new Nn}function Sn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}gn.prototype.cancel=function(){var t,e;if(this.c=An(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Nn.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},Nn.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var On=S.JSON.parse;function Pn(t){Ft.call(this),this.headers=new Be,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Ln,this.D=this.F=!1}F(Pn,Ft);var Ln="",Vn=/^https?$/i,Dn=["POST","PUT"];function _n(t){return"content-type"==t.toLowerCase()}function kn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Un(t),Mn(t)}function Un(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Cn(t){if(t.b&&(!t.s[1]||4!=Fn(t)||2!=t.X()))if(t.l&&4==Fn(t))$t(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==Fn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(He)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!Vn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Fn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Un(t)}}finally{Mn(t)}}}function Mn(t,e){if(t.a){xn(t);var n=t.a,r=t.s[0]?O:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function xn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function Fn(t){return t.a?t.a.readyState:0}function jn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",K(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):$e(t,e,n))}function qn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Gn(t){this.pa=0,this.g=[],this.c=new ce,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=qn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=qn("baseRetryDelayMs",5e3,t),this.Ma=qn("retryDelaySeedMs",1e4,t),this.Ja=qn("forwardChannelMaxRetries",2,t),this.ma=qn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new gn(t&&t.concurrentRequestLimit),this.ka=new Rn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Bn(t){var e,n;zn(t),3==t.v&&(e=t.R++,$e(n=Ye(t.B),"SID",t.J),$e(n,"RID",e),$e(n,"TYPE","terminate"),Xn(t,n),(e=new Pe(t,t.c,e,void 0)).H=2,e.i=tn(Ye(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.i.toString(),"")),!n&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=ur(e.g,null),e.a.ba(e.i)),e.u=x(),Ce(e)),or(t)}function Qn(t){t.a&&($n(t),t.a.cancel(),t.a=null)}function zn(t){Qn(t),t.j&&(S.clearTimeout(t.j),t.j=null),er(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function Hn(t,e){t.g.push(new vn(t.La++,e)),3==t.v&&Wn(t)}function Wn(t){wn(t.b)||t.h||(t.h=!0,Wt(t.Ba,t),t.u=0)}function Yn(t,e){var n=e?e.f:t.R++,r=Ye(t.B);$e(r,"SID",t.J),$e(r,"RID",n),$e(r,"AID",t.P),Xn(t,r),t.i&&t.l&&jn(r,t.i,t.l),n=new Pe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Jn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),In(t.b,n),_e(n,r,e)}function Xn(t,n){t.f&&Ge({},function(t,e){$e(n,e,t)})}function Jn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?C(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+h+"_"||"";try{Ge(t,function(t,e){var n=t;V(t)&&(n=qt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s)}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Kn(t){t.a||t.j||(t.U=1,Wt(t.Aa,t),t.o=0)}function Zn(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=we(C(t.Aa,t),rr(t,t.o)),t.o++,1)}function $n(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function tr(t){t.a=new Pe(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Ye(t.la);$e(e,"RID","rpc"),$e(e,"SID",t.J),$e(e,"CI",t.H?"0":"1"),$e(e,"AID",t.P),Xn(t,e),$e(e,"TYPE","xmlhttp"),t.i&&t.l&&jn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=tn(Ye(e)),n.j=null,n.I=!0,ke(n,t)}function er(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function nr(t,e){var n,r=null;if(t.a==e){er(t),$n(t),t.a=null;var i=2}else{if(!En(t.b,e))return;r=e.s,Tn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b)1==i?(r=e.j?e.j.length:0,e=x()-e.u,n=t.u,(i=pe()).dispatchEvent(new me(i)),Wn(t)):Kn(t);else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(bn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=we(C(t.Ba,t,e),rr(t,t.u)),t.u++,1}}(t,e)||2==i&&Zn(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:ir(t,5);break;case 4:ir(t,10);break;case 3:ir(t,6);break;default:ir(t,2)}}function rr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function ir(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=C(t.Xa,t),r||(r=new We("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||Xe(r,"https"),tn(r)),n=r.toString(),r=o,o=new ce,S.Image?((i=new Image).onload=M(Sn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=M(Sn,o,i,"TestLoadImage: error",!1,r),i.onabort=M(Sn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=M(Sn,o,i,"TestLoadImage: timeout",!1,r),S.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):ge(),t.v=0,t.f&&t.f.ra(e),or(t),zn(t)}function or(t){t.v=0,t.I=-1,t.f&&(0==An(t.b).length&&0==t.g.length||(t.b.c.length=0,Q(t.g),t.g.length=0),t.f.qa())}function sr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof We?Ye(s):new We(s,void 0);return""!=a.c?(e&&Je(a,e+"."+a.c),Ke(a,a.h)):(r=(u=S.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new We(null,void 0),r&&Xe(u,r),i&&Je(u,i),o&&Ke(u,o),s&&(u.g=s),a=u),t.W&&K(t.W,function(t,e){$e(a,e,t)}),e=t.A,n=t.na,e&&n&&$e(a,e,n),$e(a,"VER",t.ha),Xn(t,a),a}function ur(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Pn(t.Ka)).F=t.C,e}function ar(){}function hr(){if(it&&!(10<=Number(dt)))throw Error("Environmental error: no available transport.")}function cr(t,e){Ft.call(this),this.a=new Gn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!z(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!z(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new pr(this)}function lr(t){Re.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function fr(){Se.call(this),this.status=1}function pr(t){this.a=t}(N=Pn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Te(this.H):Te(Ne),this.a.onreadystatechange=C(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void kn(this,t)}t=n||"";var i,o=new Be(this.headers);r&&Ge(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=_n,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=q(Dn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{xn(this),0<this.o&&((this.D=(i=this.a,it&&pt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=C(this.xa,this)):this.m=$t(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){kn(this,t)}},N.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Mn(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Mn(this,!0)),Pn.S.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?Cn(this):this.Ta())},N.Ta=function(){Cn(this)},N.X=function(){try{return 2<Fn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),On(e)}},N.ua=function(){return this.h},N.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=Gn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Pe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?tt(r=Z(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Jn(this,n,e),$e(i=Ye(this.B),"RID",t),$e(i,"CVER",22),this.A&&$e(i,"X-HTTP-Session-Id",this.A),Xn(this,i),this.i&&r&&jn(i,this.i,r),In(this.b,n),this.Ga&&$e(i,"TYPE","init"),this.da?($e(i,"$req",e),$e(i,"SID","null"),n.V=!0,_e(n,i,null)):_e(n,i,e),this.v=2}}else 3==this.v&&(t?Yn(this,t):0==this.g.length||wn(this.b)||Yn(this))},N.Aa=function(){var t;this.j=null,tr(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=we(C(this.Sa,this),t))},N.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Qn(this),tr(this))},N.Ra=function(){null!=this.m&&(this.m=null,Qn(this),Zn(this),ge())},N.Xa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),ge()},(N=ar.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ha=function(){},hr.prototype.a=function(t,e){return new cr(t,e)},F(cr,Ft),(N=cr.prototype).addEventListener=function(t,e,n,r){cr.S.addEventListener.call(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){cr.S.removeEventListener.call(this,t,e,n,r)},N.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;ge(),t.fa=e,t.W=n||{},t.H=t.T,t.B=sr(t,null,t.fa),Wn(t)},N.close=function(){Bn(this.a)},N.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Hn(this.a,e)):this.g?((e={}).__data__=qt(t),Hn(this.a,e)):Hn(this.a,t)},N.G=function(){this.a.f=null,delete this.f,Bn(this.a),delete this.a,cr.S.G.call(this)},F(lr,Re),F(fr,Se),F(pr,ar),pr.prototype.ta=function(){this.a.dispatchEvent("a")},pr.prototype.sa=function(t){this.a.dispatchEvent(new lr(t))},pr.prototype.ra=function(t){this.a.dispatchEvent(new fr)},pr.prototype.qa=function(){this.a.dispatchEvent("b")},hr.prototype.createWebChannel=hr.prototype.a,cr.prototype.send=cr.prototype.Pa,cr.prototype.open=cr.prototype.Oa,be.NO_ERROR=0,be.TIMEOUT=8,be.HTTP_ERROR=6,Ee.COMPLETE="complete",(Ae.EventType=R).OPEN="a",R.CLOSE="b",R.ERROR="c",R.MESSAGE="d",Ft.prototype.listen=Ft.prototype.va,Pn.prototype.listenOnce=Pn.prototype.wa,Pn.prototype.getLastError=Pn.prototype.Qa,Pn.prototype.getLastErrorCode=Pn.prototype.ua,Pn.prototype.getStatus=Pn.prototype.X,Pn.prototype.getResponseJson=Pn.prototype.Na,Pn.prototype.getResponseText=Pn.prototype.$,Pn.prototype.send=Pn.prototype.ba;var dr=(Ee={createWebChannelTransport:function(){return new hr},ErrorCode:be,EventType:Ee,WebChannel:Ae,XhrIo:Pn}).createWebChannelTransport,yr=Ee.ErrorCode,vr=Ee.EventType,gr=Ee.WebChannel,mr=Ee.XhrIo,wr=(br.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},br.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},br.prototype.setServiceProps=function(t){return this.serviceProps=t,this},br);function br(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Er,Ir={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Tr=(n(Rr,Er=Error),Rr),Ar="7.22.1-alpha.01492c06e",Nr=new l("@firebase/firestore");function Rr(t,e){var n=this;return(n=Er.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Sr(){return Nr.logLevel}function Or(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=u.DEBUG&&(e=n.map(Vr),Nr.debug.apply(Nr,i(["Firestore ("+Ar+"): "+t],e)))}function Pr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=u.ERROR&&(e=n.map(Vr),Nr.error.apply(Nr,i(["Firestore ("+Ar+"): "+t],e)))}function Lr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Nr.logLevel<=u.WARN&&(e=n.map(Vr),Nr.warn.apply(Nr,i(["Firestore ("+Ar+"): "+t],e)))}function Vr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Dr(t){throw void 0===t&&(t="Unexpected state"),Pr(t="FIRESTORE ("+Ar+") INTERNAL ASSERTION FAILED: "+t),new Error(t)}function _r(t){t||Dr()}function kr(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Ur(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Cr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Mr,xr,l=(Object.defineProperty(Hr.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),Hr.prototype.isEqual=function(t){return 0===Hr.i(this,t)},Hr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Hr?t.forEach(function(t){e.push(t)}):e.push(t),this.o(e)},Hr.prototype.limit=function(){return this.offset+this.length},Hr.prototype.u=function(t){return t=void 0===t?1:t,this.o(this.segments,this.offset+t,this.length-t)},Hr.prototype.h=function(){return this.o(this.segments,this.offset,this.length-1)},Hr.prototype.l=function(){return this.segments[this.offset]},Hr.prototype._=function(){return this.get(this.length-1)},Hr.prototype.get=function(t){return this.segments[this.offset+t]},Hr.prototype.m=function(){return 0===this.length},Hr.prototype.T=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Hr.prototype.A=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Hr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Hr.prototype.I=function(){return this.segments.slice(this.offset,this.limit())},Hr.i=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Hr),Fr=(n(zr,xr=l),zr.prototype.o=function(t,e,n){return new zr(t,e,n)},zr.prototype.R=function(){return this.I().join("/")},zr.prototype.toString=function(){return this.R()},zr.P=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new zr(n)},zr.V=function(){return new zr([])},zr),jr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,qr=(n(Qr,Mr=l),Qr.prototype.o=function(t,e,n){return new Qr(t,e,n)},Qr.p=function(t){return jr.test(t)},Qr.prototype.R=function(){return this.I().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),Qr.p(t)||(t="`"+t+"`"),t}).join(".")},Qr.prototype.toString=function(){return this.R()},Qr.prototype.g=function(){return 1===this.length&&"__name__"===this.get(0)},Qr.v=function(){return new Qr(["__name__"])},Qr.S=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Tr(Ir.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Tr(Ir.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Tr(Ir.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Qr(e)},Qr.V=function(){return new Qr([])},Qr),Gr=(Br.D=function(t){return new Br(Fr.P(t))},Br.C=function(t){return new Br(Fr.P(t).u(5))},Br.prototype.N=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Br.prototype.isEqual=function(t){return null!==t&&0===Fr.i(this.path,t.path)},Br.prototype.toString=function(){return this.path.toString()},Br.i=function(t,e){return Fr.i(t.path,e.path)},Br.F=function(t){return t.length%2==0},Br.$=function(t){return new Br(new Fr(t.slice()))},Br);function Br(t){this.path=t}function Qr(){return null!==Mr&&Mr.apply(this,arguments)||this}function zr(){return null!==xr&&xr.apply(this,arguments)||this}function Hr(t,e,n){void 0===e?e=0:e>t.length&&Dr(),void 0===n?n=t.length-e:n>t.length-e&&Dr(),this.segments=t,this.offset=e,this.t=n}function Wr(t,e){if(0!==e.length)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+li(e.length,"argument")+".")}function Yr(t,e,n){if(e.length!==n)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires "+li(n,"argument")+", but was called with "+li(e.length,"argument")+".")}function Xr(t,e,n){if(e.length<n)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires at least "+li(n,"argument")+", but was called with "+li(e.length,"argument")+".")}function Jr(t,e,n,r){if(e.length<n||e.length>r)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+li(e.length,"argument")+".")}function Kr(t,e,n,r){ri(t,e,ci(n)+" argument",r)}function Zr(t,e,n,r){void 0!==r&&Kr(t,e,n,r)}function $r(t,e,n,r){ri(t,e,n+" option",r)}function ti(t,e,n,r){void 0!==r&&$r(t,e,n,r)}function ei(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(oi(s))}var u=oi(n);throw new Tr(Ir.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function ni(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid value "+oi(r)+" provided to function "+t+"() for its "+ci(n)+" argument. Acceptable values: "+e.join(", "));return r}function ri(t,e,n,r){if(!("object"===e?ii(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e))throw r=oi(r),new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}function ii(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function oi(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Dr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function si(t,e,n){if(void 0===n)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+ci(e)+" argument, but it was undefined.")}function ui(n,t,r){Ur(t,function(t,e){if(r.indexOf(t)<0)throw new Tr(Ir.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function ai(t,e,n,r){return r=oi(r),new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires its "+ci(n)+" argument to be a "+e+", but it was: "+r)}function hi(t,e,n){if(n<=0)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires its "+ci(e)+" argument to be a positive number, but it was: "+n+".")}function ci(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function li(t,e){return t+" "+e+(1===t?"":"s")}var fi=(pi.L=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},pi);function pi(){}function di(t,e){return t<e?-1:e<t?1:0}function yi(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var vi=(gi.fromBase64String=function(t){return new gi(atob(t))},gi.fromUint8Array=function(t){return new gi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},gi.prototype.toBase64=function(){return t=this.O,btoa(t);var t},gi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.O)},gi.prototype.k=function(){return 2*this.O.length},gi.prototype.M=function(t){return di(this.O,t.O)},gi.prototype.isEqual=function(t){return this.O===t.O},gi);function gi(t){this.O=t}vi.U=new vi("");var mi=(wi.fromBase64String=function(t){try{return new wi(vi.fromBase64String(t))}catch(t){throw new Tr(Ir.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},wi.fromUint8Array=function(t){return new wi(vi.fromUint8Array(t))},wi.prototype.toBase64=function(){return this.q.toBase64()},wi.prototype.toUint8Array=function(){return this.q.toUint8Array()},wi.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},wi.prototype.isEqual=function(t){return this.q.isEqual(t.q)},wi);function wi(t){this.q=t}function bi(){if("undefined"==typeof Uint8Array)throw new Tr(Ir.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Ei(){if("undefined"==typeof atob)throw new Tr(Ir.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function Ii(t,e,n,r,i){this.B=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var Ti,Ai=(n(_i,Ti=mi),_i.fromBase64String=function(t){Yr("Blob.fromBase64String",arguments,1),Kr("Blob.fromBase64String","string",1,t),Ei();try{return new _i(vi.fromBase64String(t))}catch(t){throw new Tr(Ir.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},_i.fromUint8Array=function(t){if(Yr("Blob.fromUint8Array",arguments,1),bi(),!(t instanceof Uint8Array))throw ai("Blob.fromUint8Array","Uint8Array",1,t);return new _i(vi.fromUint8Array(t))},_i.prototype.toBase64=function(){return Yr("Blob.toBase64",arguments,0),Ei(),Ti.prototype.toBase64.call(this)},_i.prototype.toUint8Array=function(){return Yr("Blob.toUint8Array",arguments,0),bi(),Ti.prototype.toUint8Array.call(this)},_i.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},_i),Ni=(Object.defineProperty(Di.prototype,"j",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Di.prototype.isEqual=function(t){return t instanceof Di&&t.projectId===this.projectId&&t.database===this.database},Di.prototype.M=function(t){return di(this.projectId,t.projectId)||di(this.database,t.database)},Di),Ri=(Vi.prototype.get=function(t){var e=this.W(t);if(void 0!==(e=this.K[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.G(i,t))return o}},Vi.prototype.has=function(t){return void 0!==this.get(t)},Vi.prototype.set=function(t,e){var n=this.W(t),r=this.K[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.G(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.K[n]=[[t,e]]},Vi.prototype.delete=function(t){var e=this.W(t),n=this.K[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.G(n[r][0],t))return 1===n.length?delete this.K[e]:n.splice(r,1),!0;return!1},Vi.prototype.forEach=function(s){Ur(this.K,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},Vi.prototype.m=function(){return Cr(this.K)},Vi),Si=(Li.now=function(){return Li.fromMillis(Date.now())},Li.fromDate=function(t){return Li.fromMillis(t.getTime())},Li.fromMillis=function(t){var e=Math.floor(t/1e3);return new Li(e,1e6*(t-1e3*e))},Li.prototype.toDate=function(){return new Date(this.toMillis())},Li.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Li.prototype.H=function(t){return this.seconds===t.seconds?di(this.nanoseconds,t.nanoseconds):di(this.seconds,t.seconds)},Li.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Li.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Li.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},Li.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Li),Oi=(Pi.Y=function(t){return new Pi(t)},Pi.min=function(){return new Pi(new Si(0,0))},Pi.prototype.M=function(t){return this.timestamp.H(t.timestamp)},Pi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Pi.prototype.J=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Pi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Pi.prototype.X=function(){return this.timestamp},Pi);function Pi(t){this.timestamp=t}function Li(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Vi(t,e){this.W=t,this.G=e,this.K={}}function Di(t,e){this.projectId=t,this.database=e||"(default)"}function _i(){return null!==Ti&&Ti.apply(this,arguments)||this}function ki(t){return null==t}function Ui(t){return 0===t&&1/t==-1/0}var Ci=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Z=null};function Mi(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Ci(t,e,n,r,i,o,s)}function xi(t){var e=t;return null===e.Z&&(t=e.path.R(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.R()+t.op.toString()+xo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.R()+t.dir}).join(","),ki(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=ca(e.startAt)),e.endAt&&(t+="|ub:",t+=ca(e.endAt)),e.Z=t),e.Z}function Fi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!ko(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!fa(t.startAt,e.startAt)&&fa(t.endAt,e.endAt)}function ji(t){return Gr.F(t.path)&&null===t.collectionGroup&&0===t.filters.length}function qi(t){this.count=t}var Gi,Bi=(Qi.prototype.nt=function(t){return new Qi(this.target,this.targetId,this.tt,t,this.et,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Qi.prototype.st=function(t,e){return new Qi(this.target,this.targetId,this.tt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Qi.prototype.it=function(t){return new Qi(this.target,this.targetId,this.tt,this.sequenceNumber,this.et,t,this.resumeToken)},Qi);function Qi(t,e,n,r,i,o,s){void 0===i&&(i=Oi.min()),void 0===o&&(o=Oi.min()),void 0===s&&(s=vi.U),this.target=t,this.targetId=e,this.tt=n,this.sequenceNumber=r,this.et=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function zi(t){switch(t){case Ir.OK:return Dr(),0;case Ir.CANCELLED:case Ir.UNKNOWN:case Ir.DEADLINE_EXCEEDED:case Ir.RESOURCE_EXHAUSTED:case Ir.INTERNAL:case Ir.UNAVAILABLE:case Ir.UNAUTHENTICATED:return;case Ir.INVALID_ARGUMENT:case Ir.NOT_FOUND:case Ir.ALREADY_EXISTS:case Ir.PERMISSION_DENIED:case Ir.FAILED_PRECONDITION:case Ir.ABORTED:case Ir.OUT_OF_RANGE:case Ir.UNIMPLEMENTED:case Ir.DATA_LOSS:return 1;default:return Dr(),0}}function Hi(t){if(void 0===t)return Pr("GRPC error has no .code"),Ir.UNKNOWN;switch(t){case Gi.OK:return Ir.OK;case Gi.CANCELLED:return Ir.CANCELLED;case Gi.UNKNOWN:return Ir.UNKNOWN;case Gi.DEADLINE_EXCEEDED:return Ir.DEADLINE_EXCEEDED;case Gi.RESOURCE_EXHAUSTED:return Ir.RESOURCE_EXHAUSTED;case Gi.INTERNAL:return Ir.INTERNAL;case Gi.UNAVAILABLE:return Ir.UNAVAILABLE;case Gi.UNAUTHENTICATED:return Ir.UNAUTHENTICATED;case Gi.INVALID_ARGUMENT:return Ir.INVALID_ARGUMENT;case Gi.NOT_FOUND:return Ir.NOT_FOUND;case Gi.ALREADY_EXISTS:return Ir.ALREADY_EXISTS;case Gi.PERMISSION_DENIED:return Ir.PERMISSION_DENIED;case Gi.FAILED_PRECONDITION:return Ir.FAILED_PRECONDITION;case Gi.ABORTED:return Ir.ABORTED;case Gi.OUT_OF_RANGE:return Ir.OUT_OF_RANGE;case Gi.UNIMPLEMENTED:return Ir.UNIMPLEMENTED;case Gi.DATA_LOSS:return Ir.DATA_LOSS;default:return Dr()}}(l=Gi=Gi||{})[l.OK=0]="OK",l[l.CANCELLED=1]="CANCELLED",l[l.UNKNOWN=2]="UNKNOWN",l[l.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",l[l.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",l[l.NOT_FOUND=5]="NOT_FOUND",l[l.ALREADY_EXISTS=6]="ALREADY_EXISTS",l[l.PERMISSION_DENIED=7]="PERMISSION_DENIED",l[l.UNAUTHENTICATED=16]="UNAUTHENTICATED",l[l.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",l[l.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",l[l.ABORTED=10]="ABORTED",l[l.OUT_OF_RANGE=11]="OUT_OF_RANGE",l[l.UNIMPLEMENTED=12]="UNIMPLEMENTED",l[l.INTERNAL=13]="INTERNAL",l[l.UNAVAILABLE=14]="UNAVAILABLE",l[l.DATA_LOSS=15]="DATA_LOSS";var Wi=(Zi.prototype.rt=function(t,e){return new Zi(this.i,this.root.rt(t,e,this.i).copy(null,null,Xi.ot,null,null))},Zi.prototype.remove=function(t){return new Zi(this.i,this.root.remove(t,this.i).copy(null,null,Xi.ot,null,null))},Zi.prototype.get=function(t){for(var e=this.root;!e.m();){var n=this.i(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Zi.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.m();){var r=this.i(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Zi.prototype.m=function(){return this.root.m()},Object.defineProperty(Zi.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Zi.prototype.ut=function(){return this.root.ut()},Zi.prototype.at=function(){return this.root.at()},Zi.prototype.ct=function(t){return this.root.ct(t)},Zi.prototype.forEach=function(n){this.ct(function(t,e){return n(t,e),!1})},Zi.prototype.toString=function(){var n=[];return this.ct(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Zi.prototype.ht=function(t){return this.root.ht(t)},Zi.prototype.lt=function(){return new Yi(this.root,null,this.i,!1)},Zi.prototype._t=function(t){return new Yi(this.root,t,this.i,!1)},Zi.prototype.ft=function(){return new Yi(this.root,null,this.i,!0)},Zi.prototype.dt=function(t){return new Yi(this.root,t,this.i,!0)},Zi),Yi=(Ki.prototype.Tt=function(){var t=this.Et.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.m();)this.Et.push(t),t=t.right;else for(t=t.right;!t.m();)this.Et.push(t),t=t.left;return e},Ki.prototype.At=function(){return 0<this.Et.length},Ki.prototype.It=function(){if(0===this.Et.length)return null;var t=this.Et[this.Et.length-1];return{key:t.key,value:t.value}},Ki),Xi=(Ji.prototype.copy=function(t,e,n,r,i){return new Ji(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ji.prototype.m=function(){return!1},Ji.prototype.ct=function(t){return this.left.ct(t)||t(this.key,this.value)||this.right.ct(t)},Ji.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},Ji.prototype.min=function(){return this.left.m()?this:this.left.min()},Ji.prototype.ut=function(){return this.min().key},Ji.prototype.at=function(){return this.right.m()?this.key:this.right.at()},Ji.prototype.rt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.rt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.rt(t,e,n))).Rt()},Ji.prototype.yt=function(){if(this.left.m())return Ji.EMPTY;var t=this;return t.left.Pt()||t.left.left.Pt()||(t=t.Vt()),(t=t.copy(null,null,null,t.left.yt(),null)).Rt()},Ji.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.m()||r.left.Pt()||r.left.left.Pt()||(r=r.Vt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Pt()&&(r=r.gt()),r.right.m()||r.right.Pt()||r.right.left.Pt()||(r=r.vt()),0===e(t,r.key)){if(r.right.m())return Ji.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.yt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Rt()},Ji.prototype.Pt=function(){return this.color},Ji.prototype.Rt=function(){var t=this;return t.right.Pt()&&!t.left.Pt()&&(t=t.bt()),t.left.Pt()&&t.left.left.Pt()&&(t=t.gt()),t.left.Pt()&&t.right.Pt()&&(t=t.St()),t},Ji.prototype.Vt=function(){var t=this.St();return t.right.left.Pt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.gt())).bt()).St()),t},Ji.prototype.vt=function(){var t=this.St();return t.left.left.Pt()&&(t=(t=t.gt()).St()),t},Ji.prototype.bt=function(){var t=this.copy(null,null,Ji.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Ji.prototype.gt=function(){var t=this.copy(null,null,Ji.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Ji.prototype.St=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Ji.prototype.Dt=function(){var t=this.Ct();return Math.pow(2,t)<=this.size+1},Ji.prototype.Ct=function(){if(this.Pt()&&this.left.Pt())throw Dr();if(this.right.Pt())throw Dr();var t=this.left.Ct();if(t!==this.right.Ct())throw Dr();return t+(this.Pt()?0:1)},Ji);function Ji(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Ji.RED,this.left=null!=r?r:Ji.EMPTY,this.right=null!=i?i:Ji.EMPTY,this.size=this.left.size+1+this.right.size}function Ki(t,e,n,r){this.wt=r,this.Et=[];for(var i=1;!t.m();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.wt?t.left:t.right;else{if(0===i){this.Et.push(t);break}this.Et.push(t),t=this.wt?t.right:t.left}}function Zi(t,e){this.i=t,this.root=e||Xi.EMPTY}function $i(){this.size=0}Xi.EMPTY=null,Xi.RED=!0,Xi.ot=!1,Xi.EMPTY=(Object.defineProperty($i.prototype,"key",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),Object.defineProperty($i.prototype,"value",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),Object.defineProperty($i.prototype,"color",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),Object.defineProperty($i.prototype,"left",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),Object.defineProperty($i.prototype,"right",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),$i.prototype.copy=function(t,e,n,r,i){return this},$i.prototype.rt=function(t,e,n){return new Xi(t,e)},$i.prototype.remove=function(t,e){return this},$i.prototype.m=function(){return!0},$i.prototype.ct=function(t){return!1},$i.prototype.ht=function(t){return!1},$i.prototype.ut=function(){return null},$i.prototype.at=function(){return null},$i.prototype.Pt=function(){return!1},$i.prototype.Dt=function(){return!0},$i.prototype.Ct=function(){return 0},new $i);var to=(io.prototype.has=function(t){return null!==this.data.get(t)},io.prototype.first=function(){return this.data.ut()},io.prototype.last=function(){return this.data.at()},Object.defineProperty(io.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),io.prototype.indexOf=function(t){return this.data.indexOf(t)},io.prototype.forEach=function(n){this.data.ct(function(t,e){return n(t),!1})},io.prototype.Nt=function(t,e){for(var n=this.data._t(t[0]);n.At();){var r=n.Tt();if(0<=this.i(r.key,t[1]))return;e(r.key)}},io.prototype.Ft=function(t,e){for(var n=void 0!==e?this.data._t(e):this.data.lt();n.At();)if(!t(n.Tt().key))return},io.prototype.$t=function(t){return(t=this.data._t(t)).At()?t.Tt().key:null},io.prototype.lt=function(){return new eo(this.data.lt())},io.prototype._t=function(t){return new eo(this.data._t(t))},io.prototype.add=function(t){return this.copy(this.data.remove(t).rt(t,!0))},io.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},io.prototype.m=function(){return this.data.m()},io.prototype.Lt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},io.prototype.isEqual=function(t){if(!(t instanceof io))return!1;if(this.size!==t.size)return!1;for(var e=this.data.lt(),n=t.data.lt();e.At();){var r=e.Tt().key,i=n.Tt().key;if(0!==this.i(r,i))return!1}return!0},io.prototype.I=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},io.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},io.prototype.copy=function(t){var e=new io(this.i);return e.data=t,e},io),eo=(ro.prototype.Tt=function(){return this.Ot.Tt().key},ro.prototype.At=function(){return this.Ot.At()},ro),no=new Wi(Gr.i);function ro(t){this.Ot=t}function io(t){this.i=t,this.data=new Wi(this.i)}var oo=new Wi(Gr.i),so=new Wi(Gr.i),uo=new to(Gr.i);function ao(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=uo,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var ho=new to(di),co=(So.Mt=function(t){return new So(t.i)},So.prototype.has=function(t){return null!=this.xt.get(t)},So.prototype.get=function(t){return this.xt.get(t)},So.prototype.first=function(){return this.kt.ut()},So.prototype.last=function(){return this.kt.at()},So.prototype.m=function(){return this.kt.m()},So.prototype.indexOf=function(t){return(t=this.xt.get(t))?this.kt.indexOf(t):-1},Object.defineProperty(So.prototype,"size",{get:function(){return this.kt.size},enumerable:!1,configurable:!0}),So.prototype.forEach=function(n){this.kt.ct(function(t,e){return n(t),!1})},So.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.xt.rt(t.key,t),e.kt.rt(t,null))},So.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.xt.remove(t),this.kt.remove(e)):this},So.prototype.isEqual=function(t){if(!(t instanceof So))return!1;if(this.size!==t.size)return!1;for(var e=this.kt.lt(),n=t.kt.lt();e.At();){var r=e.Tt().key,i=n.Tt().key;if(!r.isEqual(i))return!1}return!0},So.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},So.prototype.copy=function(t,e){var n=new So;return n.i=this.i,n.xt=t,n.kt=e,n},So),lo=(Ro.prototype.track=function(t){var e=t.doc.key,n=this.Ut.get(e);!n||0!==t.type&&3===n.type?this.Ut=this.Ut.rt(e,t):3===t.type&&1!==n.type?this.Ut=this.Ut.rt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Ut=this.Ut.rt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Ut=this.Ut.rt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Ut=this.Ut.remove(e):1===t.type&&2===n.type?this.Ut=this.Ut.rt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Ut=this.Ut.rt(e,{type:2,doc:t.doc}):Dr()},Ro.prototype.qt=function(){var n=[];return this.Ut.ct(function(t,e){n.push(e)}),n},Ro),fo=(No.Gt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new No(t,e,co.Mt(e),i,n,r,!0,!1)},Object.defineProperty(No.prototype,"hasPendingWrites",{get:function(){return!this.Qt.m()},enumerable:!1,configurable:!0}),No.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.jt===t.jt&&this.Qt.isEqual(t.Qt)&&_u(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Bt.isEqual(t.Bt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},No),po=(Ao.Jt=function(t,e){var n=new Map;return n.set(t,yo.Xt(t,e)),new Ao(Oi.min(),n,ho,no,ao())},Ao),yo=(To.Xt=function(t,e){return new To(vi.U,e,ao(),ao(),ao())},To),vo=function(t,e,n,r){this.se=t,this.removedTargetIds=e,this.key=n,this.ie=r},go=function(t,e){this.targetId=t,this.re=e},mo=function(t,e,n,r){void 0===n&&(n=vi.U),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},wo=(Object.defineProperty(Io.prototype,"Zt",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(Io.prototype,"resumeToken",{get:function(){return this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(Io.prototype,"le",{get:function(){return 0!==this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(Io.prototype,"_e",{get:function(){return this.he},enumerable:!1,configurable:!0}),Io.prototype.fe=function(t){0<t.k()&&(this.he=!0,this.ae=t)},Io.prototype.de=function(){var n=ao(),r=ao(),i=ao();return this.ue.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Dr()}}),new yo(this.ae,this.ce,n,r,i)},Io.prototype.we=function(){this.he=!1,this.ue=Po()},Io.prototype.me=function(t,e){this.he=!0,this.ue=this.ue.rt(t,e)},Io.prototype.Ee=function(t){this.he=!0,this.ue=this.ue.remove(t)},Io.prototype.Te=function(){this.oe+=1},Io.prototype.Ae=function(){--this.oe},Io.prototype.Ie=function(){this.he=!0,this.ce=!0},Io),bo=(Eo.prototype.ge=function(t){for(var e=0,n=t.se;e<n.length;e++){var r=n[e];t.ie instanceof yu?this.ve(r,t.ie):t.ie instanceof vu&&this.be(r,t.key,t.ie)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.be(s,t.key,t.ie)}},Eo.prototype.Se=function(n){var r=this;this.De(n,function(t){var e=r.Ce(t);switch(n.state){case 0:r.Ne(t)&&e.fe(n.resumeToken);break;case 1:e.Ae(),e.le||e.we(),e.fe(n.resumeToken);break;case 2:e.Ae(),e.le||r.removeTarget(t);break;case 3:r.Ne(t)&&(e.Ie(),e.fe(n.resumeToken));break;case 4:r.Ne(t)&&(r.Fe(t),e.fe(n.resumeToken));break;default:Dr()}})},Eo.prototype.De=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ye.forEach(function(t,e){r.Ne(e)&&n(e)})},Eo.prototype.$e=function(t){var e=t.targetId,n=t.re.count;(t=this.Le(e))&&(ji(t=t.target)?0===n?(t=new Gr(t.path),this.be(e,t,new vu(t,Oi.min()))):_r(1===n):this.Oe(e)!==n&&(this.Fe(e),this.pe=this.pe.add(e)))},Eo.prototype.xe=function(r){var i=this,o=new Map;this.ye.forEach(function(t,e){var n=i.Le(e);n&&(t.Zt&&ji(n.target)&&(n=new Gr(n.target.path),null!==i.Pe.get(n)||i.ke(e,n)||i.be(e,n,new vu(n,r))),t._e&&(o.set(e,t.de()),t.we()))});var s=ao();this.Ve.forEach(function(t,e){var n=!0;e.Ft(function(t){return!(t=i.Le(t))||2===t.tt||(n=!1)}),n&&(s=s.add(t))});var t=new po(r,o,this.pe,this.Pe,s);return this.Pe=no,this.Ve=Oo(),this.pe=new to(di),t},Eo.prototype.ve=function(t,e){var n;this.Ne(t)&&(n=this.ke(t,e.key)?2:0,this.Ce(t).me(e.key,n),this.Pe=this.Pe.rt(e.key,e),this.Ve=this.Ve.rt(e.key,this.Me(e.key).add(t)))},Eo.prototype.be=function(t,e,n){var r;this.Ne(t)&&(r=this.Ce(t),this.ke(t,e)?r.me(e,1):r.Ee(e),this.Ve=this.Ve.rt(e,this.Me(e).delete(t)),n&&(this.Pe=this.Pe.rt(e,n)))},Eo.prototype.removeTarget=function(t){this.ye.delete(t)},Eo.prototype.Oe=function(t){var e=this.Ce(t).de();return this.Re.Ue(t).size+e.te.size-e.ne.size},Eo.prototype.Te=function(t){this.Ce(t).Te()},Eo.prototype.Ce=function(t){var e=this.ye.get(t);return e||(e=new wo,this.ye.set(t,e)),e},Eo.prototype.Me=function(t){var e=this.Ve.get(t);return e||(e=new to(di),this.Ve=this.Ve.rt(t,e)),e},Eo.prototype.Ne=function(t){var e=null!==this.Le(t);return e||Or("WatchChangeAggregator","Detected inactive target",t),e},Eo.prototype.Le=function(t){var e=this.ye.get(t);return e&&e.le?null:this.Re.qe(t)},Eo.prototype.Fe=function(e){var n=this;this.ye.set(e,new wo),this.Re.Ue(e).forEach(function(t){n.be(e,t,null)})},Eo.prototype.ke=function(t,e){return this.Re.Ue(t).has(e)},Eo);function Eo(t){this.Re=t,this.ye=new Map,this.Pe=no,this.Ve=Oo(),this.pe=new to(di)}function Io(){this.oe=0,this.ue=Po(),this.ae=vi.U,this.ce=!1,this.he=!0}function To(t,e,n,r,i){this.resumeToken=t,this.Zt=e,this.te=n,this.ee=r,this.ne=i}function Ao(t,e,n,r,i){this.et=t,this.zt=e,this.Kt=n,this.Ht=r,this.Yt=i}function No(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Bt=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.jt=s,this.Wt=u}function Ro(){this.Ut=new Wi(Gr.i)}function So(n){this.i=n?function(t,e){return n(t,e)||Gr.i(t.key,e.key)}:function(t,e){return Gr.i(t.key,e.key)},this.xt=oo,this.kt=new Wi(this.i)}function Oo(){return new Wi(Gr.i)}function Po(){return new Wi(Gr.i)}function Lo(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Vo(t){return t=Fo(t.mapValue.fields.__local_write_time__.timestampValue),new Si(t.seconds,t.nanos)}var Do=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function _o(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Lo(t)?4:10:Dr()}function ko(r,i){var t,e,n,o=_o(r);if(o!==_o(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return Vo(r).isEqual(Vo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Fo(r.timestampValue),t=Fo(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,qo(r.bytesValue).isEqual(qo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return o=i,jo((t=r).geoPointValue.latitude)===jo(o.geoPointValue.latitude)&&jo(t.geoPointValue.longitude)===jo(o.geoPointValue.longitude);case 2:return n=i,"integerValue"in(e=r)&&"integerValue"in n?jo(e.integerValue)===jo(n.integerValue):"doubleValue"in e&&"doubleValue"in n&&((e=jo(e.doubleValue))===(n=jo(n.doubleValue))?Ui(e)===Ui(n):isNaN(e)&&isNaN(n));case 9:return yi(r.arrayValue.values||[],i.arrayValue.values||[],ko);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(kr(e)!==kr(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!ko(e[t],n[t])))return!1;return!0}();default:return Dr()}}function Uo(t,e){return void 0!==(t.values||[]).find(function(t){return ko(t,e)})}function Co(t,e){var n,r,i,o,s=_o(t),u=_o(e);if(s!==u)return di(s,u);switch(s){case 0:return 0;case 1:return di(t.booleanValue,e.booleanValue);case 2:return n=e,(r=jo(t.integerValue||t.doubleValue))<(n=jo(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return Mo(t.timestampValue,e.timestampValue);case 4:return Mo(Vo(t),Vo(e));case 5:return di(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,o=e.bytesValue,i=qo(i),o=qo(o),i.M(o);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=di(n[i],r[i]);if(0!==o)return o}return di(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return s=t.geoPointValue,r=e.geoPointValue,0!==(n=di(jo(s.latitude),jo(r.latitude)))?n:di(jo(s.longitude),jo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Co(n[i],r[i]);if(o)return o}return di(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=di(r[s],o[s]);if(0!==u)return u;if(0!==(u=Co(n[r[s]],i[o[s]])))return u}return di(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Dr()}}function Mo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return di(t,e);var n=Fo(t),t=Fo(e);return 0!==(e=di(n.seconds,t.seconds))?e:di(n.nanos,t.nanos)}function xo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=Fo(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?qo(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,Gr.C(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Dr();var t,e}(t)}function Fo(t){if(_r(!!t),"string"!=typeof t)return{seconds:jo(t.seconds),nanos:jo(t.nanos)};var e=0,n=Do.exec(t);return _r(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function jo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function qo(t){return"string"==typeof t?vi.fromBase64String(t):vi.fromUint8Array(t)}function Go(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.R()}}function Bo(t){return t&&"integerValue"in t}function Qo(t){return!!t&&"arrayValue"in t}function zo(t){return t&&"nullValue"in t}function Ho(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Wo(t){return t&&"mapValue"in t}var Yo={asc:"ASCENDING",desc:"DESCENDING"},Xo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Jo=function(t,e){this.B=t,this.Be=e};function Ko(t){return{integerValue:""+t}}function Zo(t,e){if(t.Be){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ui(e)?"-0":e}}function $o(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!Ui(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Ko(e):Zo(t,e);var n}function ts(t,e){return t.Be?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function es(t,e){return t.Be?e.toBase64():e.toUint8Array()}function ns(t){return _r(!!t),Oi.Y((t=Fo(t),new Si(t.seconds,t.nanos)))}function rs(t,e){return new Fr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).R()}function is(t){return _r(gs(t=Fr.P(t))),t}function os(t,e){return rs(t.B,e.path)}function ss(t,e){return _r((e=is(e)).get(1)===t.B.projectId),_r(!e.get(3)&&!t.B.database||e.get(3)===t.B.database),new Gr(hs(e))}function us(t,e){return rs(t.B,e)}function as(t){return new Fr(["projects",t.B.projectId,"databases",t.B.database]).R()}function hs(t){return _r(4<t.length&&"documents"===t.get(4)),t.u(5)}function cs(t,e,n){return{name:os(t,e),fields:n.proto.mapValue.fields}}function ls(t,e){var n,r,i;if(e instanceof Ws)n={update:cs(t,e.key,e.value)};else if(e instanceof iu)n={delete:os(t,e.key)};else if(e instanceof Ys)n={update:cs(t,e.key,e.data),updateMask:(i=e.Qe,r=[],i.fields.forEach(function(t){return r.push(t.R())}),{fieldPaths:r})};else if(e instanceof $s)n={transform:{document:os(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Es)return{fieldPath:t.field.R(),setToServerValue:"REQUEST_TIME"};if(e instanceof Is)return{fieldPath:t.field.R(),appendMissingElements:{values:e.elements}};if(e instanceof Ss)return{fieldPath:t.field.R(),removeAllFromArray:{values:e.elements}};if(e instanceof Vs)return{fieldPath:t.field.R(),increment:e.je};throw Dr()})}};else{if(!(e instanceof ou))return Dr();n={verify:os(t,e.key)}}return e.Ge.We||(n.currentDocument=void 0!==(i=e.Ge).updateTime?{updateTime:ts(e=t,(t=i.updateTime).X())}:void 0!==i.exists?{exists:i.exists}:Dr()),n}function fs(t){var e=4===(o=is(t.parent)).length?Fr.V():hs(o),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;0<r&&(_r(1===r),(s=n.from[0]).allDescendants?i=s.collectionId:e=e.child(s.collectionId));var o=[];n.where&&(o=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=vs(t.unaryFilter.field);return Fu.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=vs(t.unaryFilter.field);return Fu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":return n=vs(t.unaryFilter.field),Fu.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return t=vs(t.unaryFilter.field),Fu.create(t,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Dr()}}(e)]:void 0!==e.fieldFilter?[(n=e,Fu.create(vs(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Dr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Dr():[];var n}(n.where)),t=[],n.orderBy&&(t=n.orderBy.map(function(t){return new pa(vs((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e})),r=null,n.limit&&(r=ki(u="object"==typeof(u=n.limit)?u.value:u)?null:u);var s=null;n.startAt&&(s=ds(n.startAt));var u=null;return n.endAt&&(u=ds(n.endAt)),new mu(e,i,t,o,r,"F",s,u)}function ps(t){return{before:t.before,values:t.position}}function ds(t){var e=!!t.before,t=t.values||[];return new oa(t,e)}function ys(t){return{fieldPath:t.R()}}function vs(t){return qr.S(t.fieldPath)}function gs(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function ms(t,e){return t instanceof Vs?Bo(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var ws,bs,Es=(n(As,bs=l=function(){this.ze=void 0}),As),Is=(n(Ts,ws=l),Ts);function Ts(t){var e=this;return(e=ws.call(this)||this).elements=t,e}function As(){return null!==bs&&bs.apply(this,arguments)||this}function Ns(t,e){for(var n=ks(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return ko(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var Rs,Ss=(n(Os,Rs=l),Os);function Os(t){var e=this;return(e=Rs.call(this)||this).elements=t,e}function Ps(t,e){for(var n=ks(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!ko(t,e)})}(i[r]);return{arrayValue:{values:n}}}var Ls,Vs=(n(Ds,Ls=l),Ds);function Ds(t,e){var n=this;return(n=Ls.call(this)||this).serializer=t,n.je=e,n}function _s(t){return jo(t.integerValue||t.doubleValue)}function ks(t){return Qo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Us(t,e){this.field=t,this.transform=e}var Cs=(Ms.prototype.Ke=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].T(t))return!0;return!1},Ms.prototype.isEqual=function(t){return yi(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Ms);function Ms(t){(this.fields=t).sort(qr.i)}function xs(t,e){this.version=t,this.transformResults=e}var Fs=(js.He=function(){return new js},js.exists=function(t){return new js(void 0,t)},js.updateTime=function(t){return new js(t)},Object.defineProperty(js.prototype,"We",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),js.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},js);function js(t,e){this.updateTime=t,this.exists=e}function qs(t,e){return void 0!==t.updateTime?e instanceof yu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof yu}function Gs(t,e,n,r){return t instanceof Ws?(o=e,qs((i=t).Ge,o)?(o=Qs(o),new yu(i.key,o,i.value,{Ye:!0})):o):t instanceof Ys?function(t,e){if(!qs(t.Ge,e))return e;var n=Qs(e),e=Ks(t,e);return new yu(t.key,n,e,{Ye:!0})}(t,e):t instanceof $s?function(t,e,n,r){if(!qs(t.Ge,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],h=a.transform,c=null;n instanceof yu&&(c=n.field(a.field)),null===c&&r instanceof yu&&(c=r.field(a.field)),o.push((i=c,a=e,c=void 0,(h=h)instanceof Es?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(c.fields.__previous_value__=i),{mapValue:c}):h instanceof Is?Ns(h,i):h instanceof Ss?Ps(h,i):(i=_s(h=ms(c=h,i))+_s(c.je),Bo(h)&&Bo(c.je)?Ko(i):Zo(c.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=eu(t,i.data(),r);return new yu(t.key,i.version,r,{Ye:!0})}(t,e,r,n):(e=e,qs((t=t).Ge,e)?new vu(t.key,Oi.min()):e);var i,o}function Bs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ge.isEqual(e.Ge)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||yi(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof Is&&e instanceof Is||t instanceof Ss&&e instanceof Ss?yi(t.elements,e.elements,ko):t instanceof Vs&&e instanceof Vs?ko(t.je,e.je):t instanceof Es&&e instanceof Es)}))}function Qs(t){return t instanceof yu?t.version:Oi.min()}var zs,Hs,Ws=(n(Js,Hs=l=function(){}),Js),Ys=(n(Xs,zs=l),Xs);function Xs(t,e,n,r){var i=this;return(i=zs.call(this)||this).key=t,i.data=e,i.Qe=n,i.Ge=r,i.type=1,i}function Js(t,e,n){var r=this;return(r=Hs.call(this)||this).key=t,r.value=e,r.Ge=n,r.type=0,r}function Ks(t,e){return n=t,e=e instanceof yu?e.data():su.empty(),r=new uu(e),n.Qe.fields.forEach(function(t){var e;t.m()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Je();var n,r}var Zs,$s=(n(tu,Zs=l),tu);function tu(t,e){var n=this;return(n=Zs.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ge=Fs.exists(!0),n}function eu(t,e,n){for(var r=new uu(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Je()}var nu,ru,iu=(n(lu,ru=l),lu),ou=(n(cu,nu=l),cu),su=(hu.empty=function(){return new hu({mapValue:{}})},hu.prototype.field=function(t){if(t.m())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Wo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t._()])||null},hu.prototype.isEqual=function(t){return ko(this.proto,t.proto)},hu),uu=(au.prototype.set=function(t,e){return this.tn(t,e),this},au.prototype.delete=function(t){return this.tn(t,null),this},au.prototype.tn=function(t,e){for(var n=this.Ze,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===_o(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t._(),e)},au.prototype.Je=function(){var t=this.en(qr.V(),this.Ze);return null!=t?new su(t):this.Xe},au.prototype.en=function(r,t){var i=this,o=!1,e=this.Xe.field(r),s=Wo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.en(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},au);function au(t){void 0===t&&(t=su.empty()),this.Xe=t,this.Ze=new Map}function hu(t){this.proto=t}function cu(t,e){var n=this;return(n=nu.call(this)||this).key=t,n.Ge=e,n.type=4,n}function lu(t,e){var n=this;return(n=ru.call(this)||this).key=t,n.Ge=e,n.type=3,n}var fu,pu,du,yu=(n(Eu,du=l=function(t,e){this.key=t,this.version=e}),Eu.prototype.field=function(t){return this.nn.field(t)},Eu.prototype.data=function(){return this.nn},Eu.prototype.sn=function(){return this.nn.proto},Eu.prototype.isEqual=function(t){return t instanceof Eu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ye===t.Ye&&this.hasCommittedMutations===t.hasCommittedMutations&&this.nn.isEqual(t.nn)},Eu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.nn.toString()+", {hasLocalMutations: "+this.Ye+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Eu.prototype,"hasPendingWrites",{get:function(){return this.Ye||this.hasCommittedMutations},enumerable:!1,configurable:!0}),Eu),vu=(n(bu,pu=l),bu.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(bu.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),bu.prototype.isEqual=function(t){return t instanceof bu&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},bu),gu=(n(wu,fu=l),wu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(wu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),wu.prototype.isEqual=function(t){return t instanceof wu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},wu),mu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.rn=n,this.filters=r,this.limit=i,this.on=o,this.startAt=s,this.endAt=u,this.un=null,this.an=null,this.startAt,this.endAt};function wu(){return null!==fu&&fu.apply(this,arguments)||this}function bu(t,e,n){var r=this;return(r=pu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function Eu(t,e,n,r){var i=this;return(i=du.call(this,t,e)||this).nn=n,i.Ye=!!r.Ye,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function Iu(t){return new mu(t)}function Tu(t){return!ki(t.limit)&&"F"===t.on}function Au(t){return!ki(t.limit)&&"L"===t.on}function Nu(t){return 0<t.rn.length?t.rn[0].field:null}function Ru(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.cn())return r.field}return null}function Su(t){return null!==t.collectionGroup}function Ou(t){var e=t;if(null===e.un){e.un=[];var n=Ru(e),t=Nu(e);if(null!==n&&null===t)n.g()||e.un.push(new pa(n)),e.un.push(new pa(qr.v(),"asc"));else{for(var r=!1,i=0,o=e.rn;i<o.length;i++){var s=o[i];e.un.push(s),s.field.g()&&(r=!0)}r||(n=0<e.rn.length?e.rn[e.rn.length-1].dir:"asc",e.un.push(new pa(qr.v(),n)))}}return e.un}function Pu(t){var e=t;if(!e.an)if("F"===e.on)e.an=Mi(e.path,e.collectionGroup,Ou(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Ou(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new pa(o.field,s))}var u=e.endAt?new oa(e.endAt.position,!e.endAt.before):null,t=e.startAt?new oa(e.startAt.position,!e.startAt.before):null;e.an=Mi(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.an}function Lu(t,e,n){return new mu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Vu(t,e){return new mu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,e,t.endAt)}function Du(t,e){return new mu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,t.startAt,e)}function _u(t,e){return Fi(Pu(t),Pu(e))&&t.on===e.on}function ku(t){return xi(Pu(t))+"|lt:"+t.on}function Uu(t){return"Query(target="+(n=(e=Pu(t)).path.R(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.R()+" "+t.op+" "+xo(t.value)}).join(", ")+"]"),ki(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.R()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+ca(e.startAt)),e.endAt&&(n+=", endAt: "+ca(e.endAt)),"Target("+n+")")+"; limitType="+t.on+")";var e,n}function Cu(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.N(e.collectionGroup)&&e.path.T(n):Gr.F(e.path)?e.path.isEqual(n):e.path.A(n))&&function(t){for(var e=0,n=i.rn;e<n.length;e++){var r=n[e];if(!r.field.g()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||la(t.startAt,Ou(t),n))&&(!t.endAt||!la(t.endAt,Ou(t),n)));var e,n}function Mu(u){return function(t,e){for(var n=!1,r=0,i=Ou(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i,o;switch(n=t.field.g()?Gr.i(e.key,n.key):(r=t.field,i=n,o=e.field(r),r=i.field(r),null!==o&&null!==r?Co(o,r):Dr()),t.dir){case"asc":return n;case"desc":return-1*n;default:return Dr()}}(o,t,e);if(0!==s)return s;n=n||o.field.g()}return 0}}var xu,Fu=(n(ju,xu=function(){}),ju.create=function(t,e,n){if(t.g())return"in"===e||"not-in"===e?this.hn(t,e,n):new Qu(t,e,n);if(zo(n)){if("=="!==e&&"!="!==e)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. Null only supports '==' and '!=' comparisons.");return new ju(t,e,n)}if(Ho(n)){if("=="!==e&&"!="!==e)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. NaN only supports '==' and '!=' comparisons.");return new ju(t,e,n)}return"array-contains"===e?new ea(t,n):"in"===e?new na(t,n):"not-in"===e?new ra(t,n):"array-contains-any"===e?new ia(t,n):new ju(t,e,n)},ju.hn=function(t,e,n){return new("in"===e?zu:Hu)(t,n)},ju.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this.ln(Co(t,this.value)):null!==t&&_o(this.value)===_o(t)&&this.ln(Co(t,this.value))},ju.prototype.ln=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Dr()}},ju.prototype.cn=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},ju);function ju(t,e,n){var r=this;return(r=xu.call(this)||this).field=t,r.op=e,r.value=n,r}var qu,Gu,Bu,Qu=(n(Xu,Bu=Fu),Xu.prototype.matches=function(t){return t=Gr.i(t.key,this.key),this.ln(t)},Xu),zu=(n(Yu,Gu=Fu),Yu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Yu),Hu=(n(Wu,qu=Fu),Wu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Wu);function Wu(t,e){var n=this;return(n=qu.call(this,t,"not-in",e)||this).keys=Ju(0,e),n}function Yu(t,e){var n=this;return(n=Gu.call(this,t,"in",e)||this).keys=Ju(0,e),n}function Xu(t,e,n){var r=this;return(r=Bu.call(this,t,e,n)||this).key=Gr.C(n.referenceValue),r}function Ju(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return Gr.C(t.referenceValue)})}var Ku,Zu,$u,ta,ea=(n(ha,ta=Fu),ha.prototype.matches=function(t){return Qo(t=t.field(this.field))&&Uo(t.arrayValue,this.value)},ha),na=(n(aa,$u=Fu),aa.prototype.matches=function(t){return null!==(t=t.field(this.field))&&Uo(this.value.arrayValue,t)},aa),ra=(n(ua,Zu=Fu),ua.prototype.matches=function(t){return!Uo(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!Uo(this.value.arrayValue,t))},ua),ia=(n(sa,Ku=Fu),sa.prototype.matches=function(t){var e=this;return!(!Qo(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return Uo(e.value.arrayValue,t)})},sa),oa=function(t,e){this.position=t,this.before=e};function sa(t,e){return Ku.call(this,t,"array-contains-any",e)||this}function ua(t,e){return Zu.call(this,t,"not-in",e)||this}function aa(t,e){return $u.call(this,t,"in",e)||this}function ha(t,e){return ta.call(this,t,"array-contains",e)||this}function ca(t){return(t.before?"b":"a")+":"+t.position.map(xo).join(",")}function la(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.g()?Gr.i(Gr.C(s.referenceValue),n.key):Co(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function fa(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!ko(t.position[n],e.position[n]))return!1;return!0}var pa=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function da(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var ya=(ma.prototype.reset=function(){this.En=0},ma.prototype.In=function(){this.En=this.mn},ma.prototype.Rn=function(t){var e=this;this.cancel();var n=Math.floor(this.En+this.yn()),r=Math.max(0,Date.now()-this.An),i=Math.max(0,n-r);0<i&&Or("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.En+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Tn=this._n.Pn(this.fn,i,function(){return e.An=Date.now(),t()}),this.En*=this.wn,this.En<this.dn&&(this.En=this.dn),this.En>this.mn&&(this.En=this.mn)},ma.prototype.Vn=function(){null!==this.Tn&&(this.Tn.pn(),this.Tn=null)},ma.prototype.cancel=function(){null!==this.Tn&&(this.Tn.cancel(),this.Tn=null)},ma.prototype.yn=function(){return(Math.random()-.5)*this.En},ma),va=(ga.prototype.catch=function(t){return this.next(void 0,t)},ga.prototype.next=function(r,i){var o=this;return this.Sn&&Dr(),this.Sn=!0,this.bn?this.error?this.Dn(i,this.error):this.Cn(r,this.result):new ga(function(e,n){o.gn=function(t){o.Cn(r,t).next(e,n)},o.vn=function(t){o.Dn(i,t).next(e,n)}})},ga.prototype.Nn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ga.prototype.Fn=function(t){try{var e=t();return e instanceof ga?e:ga.resolve(e)}catch(t){return ga.reject(t)}},ga.prototype.Cn=function(t,e){return t?this.Fn(function(){return t(e)}):ga.resolve(e)},ga.prototype.Dn=function(t,e){return t?this.Fn(function(){return t(e)}):ga.reject(e)},ga.resolve=function(n){return new ga(function(t,e){t(n)})},ga.reject=function(n){return new ga(function(t,e){e(n)})},ga.$n=function(t){return new ga(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ga.Ln=function(t){for(var n=ga.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?ga.resolve(t):e()})}(r[e]);return n},ga.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.$n(i)},ga);function ga(t){var e=this;this.gn=null,this.vn=null,this.result=void 0,this.error=void 0,this.bn=!1,this.Sn=!1,t(function(t){e.bn=!0,e.result=t,e.gn&&e.gn(t)},function(t){e.bn=!0,e.error=t,e.vn&&e.vn(t)})}function ma(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this._n=t,this.fn=e,this.dn=n,this.wn=r,this.mn=i,this.En=0,this.Tn=null,this.An=Date.now(),this.reset()}function wa(t){return"IndexedDbTransactionError"===t.name}function ba(){return"undefined"!=typeof document?document:null}var Ea=(Aa.Un=function(t,e,n,r,i){return(i=new Aa(t,e,Date.now()+n,r,i)).start(n),i},Aa.prototype.start=function(t){var e=this;this.qn=setTimeout(function(){return e.Bn()},t)},Aa.prototype.pn=function(){return this.Bn()},Aa.prototype.cancel=function(t){null!==this.qn&&(this.clearTimeout(),this.Mn.reject(new Tr(Ir.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Aa.prototype.Bn=function(){var e=this;this.On.Qn(function(){return null!==e.qn?(e.clearTimeout(),e.op().then(function(t){return e.Mn.resolve(t)})):Promise.resolve()})},Aa.prototype.clearTimeout=function(){null!==this.qn&&(this.kn(this),clearTimeout(this.qn),this.qn=null)},Aa),Ia=(Object.defineProperty(Ta.prototype,"Zn",{get:function(){return this.Gn},enumerable:!1,configurable:!0}),Ta.prototype.Qn=function(t){this.enqueue(t)},Ta.prototype.ts=function(t){this.es(),this.ns(t)},Ta.prototype.ss=function(){var t;this.Gn||(this.Gn=!0,(t=ba())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xn))},Ta.prototype.enqueue=function(t){return this.es(),this.Gn?new Promise(function(t){}):this.ns(t)},Ta.prototype.rs=function(t){var e=this;this.Wn.push(t),this.Qn(function(){return e.os()})},Ta.prototype.os=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Wn.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Wn[0]()];case 2:return t.sent(),this.Wn.shift(),this.Jn.reset(),[3,4];case 3:if(!wa(e=t.sent()))throw e;return Or("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Wn.length&&this.Jn.Rn(function(){return n.os()}),t.label=5;case 5:return[2]}})})},Ta.prototype.ns=function(t){var r=this,e=this.jn.then(function(){return r.Hn=!0,t().catch(function(t){throw r.Kn=t,r.Hn=!1,Pr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Hn=!1,t})});return this.jn=e},Ta.prototype.Pn=function(t,e,n){var r=this;return this.es(),-1<this.Yn.indexOf(t)&&(e=0),n=Ea.Un(this,t,e,n,function(t){return r.us(t)}),this.zn.push(n),n},Ta.prototype.es=function(){this.Kn&&Dr()},Ta.prototype.cs=function(){},Ta.prototype.hs=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.jn];case 1:t.sent(),t.label=2;case 2:if(e!==this.jn)return[3,0];t.label=3;case 3:return[2]}})})},Ta.prototype.ls=function(t){for(var e=0,n=this.zn;e<n.length;e++)if(n[e].fn===t)return!0;return!1},Ta.prototype._s=function(r){var i=this;return this.hs().then(function(){i.zn.sort(function(t,e){return t.xn-e.xn});for(var t=0,e=i.zn;t<e.length;t++){var n=e[t];if(n.pn(),"all"!==r&&n.fn===r)break}return i.hs()})},Ta.prototype.fs=function(t){this.Yn.push(t)},Ta.prototype.us=function(t){t=this.zn.indexOf(t),this.zn.splice(t,1)},Ta);function Ta(){var e=this;this.jn=Promise.resolve(),this.Wn=[],this.Gn=!1,this.zn=[],this.Kn=null,this.Hn=!1,this.Yn=[],this.Jn=new ya(this,"async_queue_retry"),this.Xn=function(){var t=ba();t&&Or("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.Jn.Vn()};var t=ba();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Xn)}function Aa(t,e,n,r,i){this.On=t,this.fn=e,this.xn=n,this.op=r,this.kn=i,this.Mn=new da,this.then=this.Mn.promise.then.bind(this.Mn.promise),this.Mn.promise.catch(function(t){})}function Na(t,e){if(Pr("AsyncQueue",e+": "+t),wa(t))return new Tr(Ir.UNAVAILABLE,e+": "+t);throw t}function Ra(){this.ds=void 0,this.listeners=[]}function Sa(){this.ws=new Ri(ku,_u),this.onlineState="Unknown",this.Es=new Set}function Oa(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.ws.get(n))||(r=!0,i=new Ra),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Ts(n)];case 2:return o.ds=t.sent(),[3,4];case 3:return o=Na(o=t.sent(),"Initialization of query '"+Uu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.ws.set(n,i),i.listeners.push(u),u.As(e.onlineState),i.ds&&u.Is(i.ds)&&La(e),[2]}})})}function Pa(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.ws.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.ws.delete(n),e.Rs(n))]:[2]})})}function La(t){t.Es.forEach(function(t){t.next()})}var Va=(ka.prototype.Is=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new fo(t.query,t.docs,t.Bt,e,t.Qt,t.fromCache,t.jt,!0)}var o=!1;return this.Ps?this.ps(t)&&(this.ys.next(t),o=!0):this.gs(t,this.onlineState)&&(this.vs(t),o=!0),this.Vs=t,o},ka.prototype.onError=function(t){this.ys.error(t)},ka.prototype.As=function(t){this.onlineState=t;var e=!1;return this.Vs&&!this.Ps&&this.gs(this.Vs,t)&&(this.vs(this.Vs),e=!0),e},ka.prototype.gs=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.bs&&n||t.docs.m()&&"Offline"!==e)},ka.prototype.ps=function(t){if(0<t.docChanges.length)return!0;var e=this.Vs&&this.Vs.hasPendingWrites!==t.hasPendingWrites;return!(!t.jt&&!e)&&!0===this.options.includeMetadataChanges},ka.prototype.vs=function(t){t=fo.Gt(t.query,t.docs,t.Qt,t.fromCache),this.Ps=!0,this.ys.next(t)},ka),Da=(_a.prototype.Ss=function(){return null!=this.uid},_a.prototype.Ds=function(){return this.Ss()?"uid:"+this.uid:"anonymous-user"},_a.prototype.isEqual=function(t){return t.uid===this.uid},_a);function _a(t){this.uid=t}function ka(t,e,n){this.query=t,this.ys=e,this.Ps=!1,this.Vs=null,this.onlineState="Unknown",this.options=n||{}}Da.UNAUTHENTICATED=new Da(null),Da.Cs=new Da("google-credentials-uid"),Da.Ns=new Da("first-party-uid");var Ua=(Ca.prototype.$s=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Ca.prototype.next=function(){var t=++this.previousValue;return this.Ls&&this.Ls(t),t},Ca);function Ca(t,e){var n=this;this.previousValue=t,e&&(e.Fs=function(t){return n.$s(t)},this.Ls=function(t){return e.Os(t)})}Ua.xs=-1;var Ma=(Qa.prototype.ks=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Qa.prototype.Ms=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Qa.prototype.Us=function(){var t={activeTargetIds:this.activeTargetIds.I(),updateTimeMs:Date.now()};return JSON.stringify(t)},Qa),xa=(Ba.prototype.js=function(t){},Ba.prototype.Ws=function(t,e,n){},Ba.prototype.Gs=function(t){return this.qs.ks(t),this.Bs[t]||"not-current"},Ba.prototype.zs=function(t,e,n){this.Bs[t]=e},Ba.prototype.Ks=function(t){this.qs.Ms(t)},Ba.prototype.Hs=function(t){return this.qs.activeTargetIds.has(t)},Ba.prototype.Ys=function(t){delete this.Bs[t]},Ba.prototype.Js=function(){return this.qs.activeTargetIds},Ba.prototype.Xs=function(t){return this.qs.activeTargetIds.has(t)},Ba.prototype.start=function(){return this.qs=new Ma,Promise.resolve()},Ba.prototype.Zs=function(t,e,n){},Ba.prototype.ti=function(t){},Ba.prototype.ei=function(){},Ba.prototype.Os=function(t){},Ba.prototype.ni=function(){},Ba),Fa=(Ga.prototype.ii=function(t,e,n){for(var r,i,o,s,u,a,h=n.ri,c=0;c<this.mutations.length;c++){var l=this.mutations[c];l.key.isEqual(t)&&(r=l,i=e,o=h[c],a=u=s=void 0,e=r instanceof Ws?new yu(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof Ys?(u=i,a=o,qs((s=r).Ge,u)?(u=Ks(s,u),new yu(s.key,a.version,u,{hasCommittedMutations:!0})):new gu(s.key,a.version)):r instanceof $s?function(t,e,n){if(_r(null!=n.transformResults),!qs(t.Ge,e))return new gu(t.key,n.version);var r=e,e=function(t,e,n){var r=[];_r(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof yu&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof Is?Ns(o,s):o instanceof Ss?Ps(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=eu(t,r.data(),e);return new yu(t.key,n,e,{hasCommittedMutations:!0})}(r,i,o):new vu(r.key,o.version,{hasCommittedMutations:!0}))}return e},Ga.prototype.oi=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Gs(i,e,e,this.si))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Gs(a,e,o,this.si))}return e},Ga.prototype.ui=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.oi(t.key,n.get(t.key));e&&(i=i.rt(t.key,e))}),i},Ga.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},ao())},Ga.prototype.isEqual=function(t){return this.batchId===t.batchId&&yi(this.mutations,t.mutations,Bs)&&yi(this.baseMutations,t.baseMutations,Bs)},Ga),ja=(qa.from=function(t,e,n){_r(t.mutations.length===n.length);for(var r=so,i=t.mutations,o=0;o<i.length;o++)r=r.rt(i[o].key,n[o].version);return new qa(t,e,n,r)},qa);function qa(t,e,n,r){this.batch=t,this.ai=e,this.ri=n,this.ci=r}function Ga(t,e,n,r){this.batchId=t,this.si=e,this.baseMutations=n,this.mutations=r}function Ba(){this.qs=new Ma,this.Bs={},this.Qs=null,this.Fs=null}function Qa(){this.activeTargetIds=ho}function za(n,r){void 0===r&&(r=10240);var i=0;return{read:function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return i<n.byteLength?(e={value:n.slice(i,i+r),done:!1},[2,(i+=r,e)]):[2,{value:void 0,done:!0}]})})},cancel:function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2]})})},releaseLock:function(){}}}function Ha(t,e){if(t instanceof Uint8Array)return za(t,e);if(t instanceof ArrayBuffer)return za(new Uint8Array(t),e);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}function Wa(t){return new Jo(t,!0)}var Ya=($a.prototype.hi=function(){return"metadata"in this.payload},$a),Xa=(Za.di=function(t,e){return new Za(Ha(t,10240),e)},Za.prototype.close=function(){return this.li.cancel()},Za.prototype.getMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.metadata.promise]})})},Za.prototype.wi=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.fi())]}})})},Za.prototype.fi=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return[4,this.mi()];case 1:return null===(e=t.sent())?[2,null]:(r=this._i.decode(e),n=Number(r),isNaN(n)&&this.Ei("length string ("+r+") is not valid number"),[4,this.Ti(n)]);case 2:return r=t.sent(),[2,new Ya(JSON.parse(r),e.length+n)]}})})},Za.prototype.Ai=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},Za.prototype.mi=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.Ai()<0?[4,this.Ii()]:[3,3];case 1:if(t.sent())return[3,3];t.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.Ai())<0&&this.Ei("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),n)])}})})},Za.prototype.Ti=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.buffer.length<n?[4,this.Ii()]:[3,3];case 1:t.sent()&&this.Ei("Reached the end of bundle when more is expected."),t.label=2;case 2:return[3,0];case 3:return e=this._i.decode(this.buffer.slice(0,n)),[2,(this.buffer=this.buffer.slice(n),e)]}})})},Za.prototype.Ei=function(t){throw this.li.cancel(),new Error("Invalid bundle format: "+t)},Za.prototype.Ii=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.li.read()];case 1:return(e=t.sent()).done||((n=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n),[2,e.done]}})})},Za),Ja=(Ka.prototype.Ri=function(t){return ss(this.serializer,t)},Ka.prototype.yi=function(t){return t.metadata.exists?(r=ss(e=this.serializer,(n=t.document).name),e=ns(n.updateTime),n=new su({mapValue:{fields:n.fields}}),new yu(r,e,n,{hasCommittedMutations:!1})):new vu(this.Ri(t.metadata.name),this.Pi(t.metadata.readTime));var e,n,r},Ka.prototype.Pi=ns,Ka);function Ka(t){this.serializer=t}function Za(t,e){var n=this;this.li=t,this.serializer=e,this.metadata=new da,this.buffer=new Uint8Array,this._i=new TextDecoder("utf-8"),this.fi().then(function(t){t&&t.hi()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function $a(t,e){this.payload=t,this.byteLength=e}function th(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}function eh(t,e){this.progress=t,this.Vi=e}var nh=(hh.prototype.vi=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.ws.push(t.payload.namedQuery):t.payload.bi?(this.documents.push({metadata:t.payload.bi}),t.payload.bi.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},hh.prototype.Si=function(t){for(var e=new Map,n=new Ja(this.serializer),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.ws)for(var s=n.Ri(o.metadata.name),u=0,a=o.metadata.ws;u<a.length;u++){var h=a[u],c=(e.get(h)||ao()).add(s);e.set(h,c)}}return e},hh.prototype.complete=function(){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return[4,function(f,p,d){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a,h,c,l;return v(this,function(t){switch(t.label){case 0:for(e=new Ja((n=f).serializer),r=ao(),i=no,o=so,s=0,u=p;s<u.length;s++)a=u[s],h=e.Ri(a.metadata.name),a.document&&(r=r.add(h)),i=i.rt(h,e.yi(a)),o=o.rt(h,e.Pi(a.metadata.readTime));return c=n.Ci.Di({Ni:!0}),[4,Ih(n,Pu(Iu(Fr.P("__bundle__/docs/"+d))))];case 1:return l=t.sent(),[2,n.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return Eh(e,c,i,Oi.min(),o).next(function(t){return c.apply(e),t}).next(function(t){return n.$i.Fi(e,l.targetId).next(function(){return n.$i.Li(e,r,l.targetId)}).next(function(){return n.xi.Oi(e,t)})})})]}})})}(this.gi,this.documents,this.pi.id)];case 1:e=t.sent(),n=this.Si(this.documents),r=0,i=this.ws,t.label=2;case 2:return r<i.length?(i=i[r],[4,function(e,i,o){return void 0===o&&(o=ao()),y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return[4,Ih(e,Pu(lh(i.bundledQuery)))];case 1:return n=t.sent(),[2,(r=e).persistence.runTransaction("Save named query","readwrite",function(t){var e=ns(i.readTime);return 0<=n.et.M(e)?r.Cr.eo(t,i):(e=n.st(vi.U,e),r.Vr=r.Vr.rt(e.targetId,e),r.$i.Qr(t,e).next(function(){return r.$i.Fi(t,n.targetId)}).next(function(){return r.$i.Li(t,o,n.targetId)}).next(function(){return r.Cr.eo(t,i)}))})]}})})}(this.gi,i,n.get(i.name))]):[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[2,(this.progress.taskState="Success",new eh(Object.assign({},this.progress),e))]}})})},hh),rh=(ah.prototype.qi=function(e,n){var r=this;return this.Mi.Bi(e,n).next(function(t){return r.Qi(e,n,t)})},ah.prototype.Qi=function(t,r,i){return this.ki.ji(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].oi(r,t);return t})},ah.prototype.Wi=function(t,e,i){var o=no;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].oi(t,e);o=o.rt(t,e)}),o},ah.prototype.Gi=function(e,t){var n=this;return this.ki.getEntries(e,t).next(function(t){return n.Oi(e,t)})},ah.prototype.Oi=function(e,r){var i=this;return this.Mi.zi(e,r).next(function(t){var t=i.Wi(e,r,t),n=no;return t.forEach(function(t,e){e=e||new vu(t,Oi.min()),n=n.rt(t,e)}),n})},ah.prototype.Ki=function(t,e,n){return r=e,Gr.F(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Hi(t,e.path):Su(e)?this.Yi(t,e,n):this.Ji(t,e,n);var r},ah.prototype.Hi=function(t,e){return this.qi(t,new Gr(e)).next(function(t){var e=oo;return t instanceof yu&&(e=e.rt(t.key,t)),e})},ah.prototype.Yi=function(n,r,i){var o=this,s=r.collectionGroup,u=oo;return this.Ui.Xi(n,s).next(function(t){return va.forEach(t,function(t){var e=(e=r,t=t.child(s),new mu(t,null,e.rn.slice(),e.filters.slice(),e.limit,e.on,e.startAt,e.endAt));return o.Ji(n,e,i).next(function(t){t.forEach(function(t,e){u=u.rt(t,e)})})}).next(function(){return u})})},ah.prototype.Ji=function(e,n,t){var h,c,r=this;return this.ki.Ki(e,n,t).next(function(t){return h=t,r.Mi.Zi(e,n)}).next(function(t){return c=t,r.tr(e,c,h).next(function(t){h=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=Gs(s,a=h.get(u),a,r.si);h=a instanceof yu?h.rt(u,a):h.remove(u)}})}).next(function(){return h.forEach(function(t,e){Cu(n,e)||(h=h.remove(t))}),h})},ah.prototype.tr=function(t,e,n){for(var r=ao(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Ys&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.ki.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof yu&&(h=h.rt(t,e))}),h})},ah),ih=(uh.sr=function(t,e){for(var n=ao(),r=ao(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new uh(t,e.fromCache,n,r)},uh),oh=(sh.ar=function(t){return new sh(t,sh.cr,sh.hr)},sh);function sh(t,e,n){this.ir=t,this.rr=e,this.ur=n}function uh(t,e,n,r){this.targetId=t,this.fromCache=e,this.er=n,this.nr=r}function ah(t,e,n){this.ki=t,this.Mi=e,this.Ui=n}function hh(t,e,n){this.pi=t,this.gi=e,this.serializer=n,this.ws=[],this.documents=[],this.progress=th(t)}function ch(t){this.Er=t}function lh(t){var e=fs({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.on?Lu(e,e.limit,"L"):e}oh.lr=-1,oh._r=1048576,oh.dr=41943040,oh.cr=10,oh.hr=1e3,oh.wr=new oh(oh.dr,oh.cr,oh.hr),oh.mr=new oh(oh.lr,0,0);var fh=(wh.prototype.Ar=function(t,e){return this.Tr.add(e),va.resolve()},wh.prototype.Xi=function(t,e){return va.resolve(this.Tr.getEntries(e))},wh),ph=(mh.prototype.add=function(t){var e=t._(),n=t.h(),r=this.index[e]||new to(Fr.i),t=!r.has(n);return this.index[e]=r.add(n),t},mh.prototype.has=function(t){var e=t._(),t=t.h();return(e=this.index[e])&&e.has(t)},mh.prototype.getEntries=function(t){return(this.index[t]||new to(Fr.i)).I()},mh),dh=(gh.prototype.next=function(){return this.Ir+=2,this.Ir},gh.Rr=function(){return new gh(0)},gh.yr=function(){return new gh(-1)},gh),yh=(vh.prototype.$r=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Lr(t,n.Vr)})},vh);function vh(t,e,n,r){this.persistence=t,this.Pr=e,this.serializer=r,this.Vr=new Wi(di),this.pr=new Ri(xi,Fi),this.gr=Oi.min(),this.Mi=t.vr(n),this.Ci=t.br(),this.$i=t.Sr(),this.xi=new rh(this.Ci,this.Mi,this.persistence.Dr()),this.Cr=t.Nr(),this.Pr.Fr(this.xi)}function gh(t){this.Ir=t}function mh(){this.index={}}function wh(){this.Tr=new ph}function bh(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.$i.Ur(t)})}function Eh(t,s,e,u,a){var n=ao();return e.forEach(function(t){return n=n.add(t)}),s.getEntries(t,n).next(function(i){var o=no;return e.forEach(function(t,e){var n=i.get(t),r=(null==a?void 0:a.get(t))||u;e instanceof vu&&e.version.isEqual(Oi.min())?(s.zr(t,r),o=o.rt(t,e)):null==n||0<e.version.M(n.version)||0===e.version.M(n.version)&&n.hasPendingWrites?(s.Or(e,r),o=o.rt(t,e)):Or("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o})}function Ih(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.$i.Hr(e,r).next(function(t){return t?(n=t,va.resolve(n)):i.$i.Yr(e).next(function(t){return n=new Bi(r,t,0,e.Br),i.$i.Jr(e,n).next(function(){return n})})})}).then(function(t){var e=i.Vr.get(t.targetId);return(null===e||0<t.et.M(e.et))&&(i.Vr=i.Vr.rt(t.targetId,t),i.pr.set(r,t.targetId)),t})}function Th(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).Vr.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Wr.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!wa(r=t.sent()))throw r;return Or("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.Vr=e.Vr.remove(o),e.pr.delete(n.target),[2]}})})}function Ah(t,o,s){var u=t,a=Oi.min(),h=ao();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=Pu(o),(void 0!==(t=(i=t).pr.get(r))?va.resolve(i.Vr.get(t)):i.$i.Hr(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.$i.Xr(e,t.targetId).next(function(t){h=t})}).next(function(){return u.Pr.Ki(e,o,s?a:Oi.min(),s?h:ao())}).next(function(t){return{documents:t,Zr:h}});var t,n,r,i})}function Nh(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Ir.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Or("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Rh(t,e){this.user=e,this.type="OAuth",this.Eo={},this.Eo.Authorization="Bearer "+t}function Sh(t,e,n,r,i){var o=this;this.gi=t,this.Eu=e,this.On=n,this.Tu={},this.Au=[],this.Iu=new Map,this.Ru=new Set,this.yu=[],this.Pu=i,this.Pu.Vu(function(t){n.Qn(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return uc(this)?(Or("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Ru.add(4),[4,$h(e)];case 1:return t.sent(),e.pu.set("Unknown"),e.Ru.delete(4),[4,Zh(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.pu=new jh(n,r)}var Oh,Ph,Lh,Vh=(Kh.prototype.m=function(){return this.no.m()},Kh.prototype.oo=function(t,e){e=new Dh(t,e),this.no=this.no.add(e),this.io=this.io.add(e)},Kh.prototype.uo=function(t,e){var n=this;t.forEach(function(t){return n.oo(t,e)})},Kh.prototype.ao=function(t,e){this.co(new Dh(t,e))},Kh.prototype.ho=function(t,e){var n=this;t.forEach(function(t){return n.ao(t,e)})},Kh.prototype.lo=function(t){var e=this,n=new Gr(new Fr([])),r=new Dh(n,t),t=new Dh(n,t+1),i=[];return this.io.Nt([r,t],function(t){e.co(t),i.push(t.key)}),i},Kh.prototype._o=function(){var e=this;this.no.forEach(function(t){return e.co(t)})},Kh.prototype.co=function(t){this.no=this.no.delete(t),this.io=this.io.delete(t)},Kh.prototype.fo=function(t){var e=new Gr(new Fr([])),n=new Dh(e,t),t=new Dh(e,t+1),r=ao();return this.io.Nt([n,t],function(t){r=r.add(t.key)}),r},Kh.prototype.wo=function(t){var e=new Dh(t,0);return null!==(e=this.no.$t(e))&&t.isEqual(e.key)},Kh),Dh=(Jh.so=function(t,e){return Gr.i(t.key,e.key)||di(t.mo,e.mo)},Jh.ro=function(t,e){return di(t.mo,e.mo)||Gr.i(t.key,e.key)},Jh),_h=(Xh.prototype.getToken=function(){return Promise.resolve(null)},Xh.prototype.Ao=function(){},Xh.prototype.Io=function(t){(this.To=t)(Da.UNAUTHENTICATED)},Xh.prototype.Ro=function(){this.To=null},Xh),kh=(Yh.prototype.getToken=function(){var e=this,n=this.Vo,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.Vo!==n?(Or("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(_r("string"==typeof t.accessToken),new Rh(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Yh.prototype.Ao=function(){this.forceRefresh=!0},Yh.prototype.Io=function(t){this.To=t,this.Po&&t(this.currentUser)},Yh.prototype.Ro=function(){this.auth&&this.auth.removeAuthTokenListener(this.yo),this.yo=null,this.To=null},Yh.prototype.po=function(){var t=this.auth&&this.auth.getUid();return _r(null===t||"string"==typeof t),new Da(t)},Yh),Uh=(Object.defineProperty(Wh.prototype,"Eo",{get:function(){var t={"X-Goog-AuthUser":this.bo},e=this.vo.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Wh),Ch=(Hh.prototype.getToken=function(){return Promise.resolve(new Uh(this.vo,this.bo))},Hh.prototype.Io=function(t){t(Da.Ns)},Hh.prototype.Ro=function(){},Hh.prototype.Ao=function(){},Hh),l=(zh.prototype.$o=function(){return 1===this.state||2===this.state||4===this.state},zh.prototype.Lo=function(){return 2===this.state},zh.prototype.start=function(){3!==this.state?this.auth():this.Oo()},zh.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.$o()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},zh.prototype.xo=function(){this.state=0,this.Jn.reset()},zh.prototype.ko=function(){var t=this;this.Lo()&&null===this.Fo&&(this.Fo=this._n.Pn(this.So,6e4,function(){return t.Mo()}))},zh.prototype.Uo=function(t){this.qo(),this.stream.send(t)},zh.prototype.Mo=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.Lo()?[2,this.close(0)]:[2]})})},zh.prototype.qo=function(){this.Fo&&(this.Fo.cancel(),this.Fo=null)},zh.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.qo(),this.Jn.cancel(),this.No++,3!==e?this.Jn.reset():n&&n.code===Ir.RESOURCE_EXHAUSTED?(Pr(n.toString()),Pr("Using maximum backoff delay to prevent overloading the backend."),this.Jn.In()):n&&n.code===Ir.UNAUTHENTICATED&&this.Co.Ao(),null!==this.stream&&(this.Bo(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Qo(n)];case 1:return t.sent(),[2]}})})},zh.prototype.Bo=function(){},zh.prototype.auth=function(){var n=this;this.state=1;var t=this.jo(this.No),e=this.No;this.Co.getToken().then(function(t){n.No===e&&n.Wo(t)},function(e){t(function(){var t=new Tr(Ir.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Go(t)})})},zh.prototype.Wo=function(t){var e=this,n=this.jo(this.No);this.stream=this.zo(t),this.stream.Ko(function(){n(function(){return e.state=2,e.listener.Ko()})}),this.stream.Qo(function(t){n(function(){return e.Go(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},zh.prototype.Oo=function(){var t=this;this.state=4,this.Jn.Rn(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},zh.prototype.Go=function(t){return Or("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},zh.prototype.jo=function(e){var n=this;return function(t){n._n.Qn(function(){return n.No===e?t():(Or("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},zh),Mh=(n(Qh,Lh=l),Qh.prototype.zo=function(t){return this.Do.Ho("Listen",t)},Qh.prototype.onMessage=function(t){this.Jn.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Dr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Be?(_r(void 0===o||"string"==typeof o),vi.fromBase64String(o||"")):(_r(void 0===o||o instanceof Uint8Array),vi.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Ir.UNKNOWN:Hi(s.code),new Tr(o,s.message||"")),r=new mo(n,r,i,s||null)}else if("documentChange"in e){e.documentChange,(a=e.documentChange).document,a.document.name,a.document.updateTime;var i=ss(t,a.document.name),u=ns(a.document.updateTime),s=new su({mapValue:{fields:a.document.fields}}),u=new yu(i,u,s,{}),s=a.targetIds||[],a=a.removedTargetIds||[];r=new vo(s,a,u.key,u)}else if("documentDelete"in e){e.documentDelete,(a=e.documentDelete).document;var u=ss(t,a.document),h=a.readTime?ns(a.readTime):Oi.min(),h=new vu(u,h),a=a.removedTargetIds||[];r=new vo([],a,h.key,h)}else if("documentRemove"in e){e.documentRemove,(h=e.documentRemove).document;var c=ss(t,h.document),h=h.removedTargetIds||[];r=new vo([],h,c,null)}else{if(!("filter"in e))return Dr();e.filter,(c=e.filter).targetId,e=new qi(e=c.count||0),c=c.targetId,r=new go(c,e)}return r}(this.serializer,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?Oi.min():ns(e.readTime);return this.listener.Yo(n,t)},Qh.prototype.Jo=function(t){var e,n,r,i,o,s,u,a,h={};h.database=as(this.serializer),h.addTarget=(e=this.serializer,(r=ji(r=(n=t).target)?{documents:{documents:[us(e,r.path)]}}:{query:(i=e,s={structuredQuery:{}},u=(o=r).path,null!==o.collectionGroup?(s.parent=us(i,u),s.structuredQuery.from=[{collectionId:o.collectionGroup,allDescendants:!0}]):(s.parent=us(i,u.h()),s.structuredQuery.from=[{collectionId:u._()}]),(u=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(Ho(t.value))return{unaryFilter:{field:ys(t.field),op:"IS_NAN"}};if(zo(t.value))return{unaryFilter:{field:ys(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Ho(t.value))return{unaryFilter:{field:ys(t.field),op:"IS_NOT_NAN"}};if(zo(t.value))return{unaryFilter:{field:ys(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ys(t.field),op:(e=t.op,Xo[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(o.filters))&&(s.structuredQuery.where=u),(u=function(t){if(0!==t.length)return t.map(function(t){return{field:ys((t=t).field),direction:(t=t.dir,Yo[t])}})}(o.orderBy))&&(s.structuredQuery.orderBy=u),u=o.limit,null!==(u=i.Be||ki(u)?u:{value:u})&&(s.structuredQuery.limit=u),o.startAt&&(s.structuredQuery.startAt=ps(o.startAt)),o.endAt&&(s.structuredQuery.endAt=ps(o.endAt)),s)}).targetId=n.targetId,0<n.resumeToken.k()?r.resumeToken=es(e,n.resumeToken):0<n.et.M(Oi.min())&&(r.readTime=ts(e,n.et.X())),r),(t=(this.serializer,a=t,null==(t=function(){switch(a.tt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Dr()}}())?null:{"goog-listen-tags":t}))&&(h.labels=t),this.Uo(h)},Qh.prototype.Xo=function(t){var e={};e.database=as(this.serializer),e.removeTarget=t,this.Uo(e)},Qh),xh=(n(Bh,Ph=l),Object.defineProperty(Bh.prototype,"tu",{get:function(){return this.Zo},enumerable:!1,configurable:!0}),Bh.prototype.start=function(){this.Zo=!1,this.lastStreamToken=void 0,Ph.prototype.start.call(this)},Bh.prototype.Bo=function(){this.Zo&&this.eu([])},Bh.prototype.zo=function(t){return this.Do.Ho("Write",t)},Bh.prototype.onMessage=function(t){if(_r(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Zo){this.Jn.reset();var e=(n=t.writeResults,i=t.commitTime,n&&0<n.length?(_r(void 0!==i),n.map(function(t){return n=i,(r=(e=t).updateTime?ns(e.updateTime):ns(n)).isEqual(Oi.min())&&(r=ns(n)),n=null,e.transformResults&&0<e.transformResults.length&&(n=e.transformResults),new xs(r,n);var e,n,r})):[]),n=ns(t.commitTime);return this.listener.nu(n,e)}var i;return _r(!t.writeResults||0===t.writeResults.length),this.Zo=!0,this.listener.su()},Bh.prototype.iu=function(){var t={};t.database=as(this.serializer),this.Uo(t)},Bh.prototype.eu=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return ls(e.serializer,t)})};this.Uo(t)},Bh),Fh=(n(Gh,Oh=function(){}),Gh.prototype.ou=function(){if(this.ru)throw new Tr(Ir.FAILED_PRECONDITION,"The client has already been terminated.")},Gh.prototype.uu=function(e,n,r){var i=this;return this.ou(),this.credentials.getToken().then(function(t){return i.Do.uu(e,n,r,t)}).catch(function(t){throw t.code===Ir.UNAUTHENTICATED&&i.credentials.Ao(),t})},Gh.prototype.au=function(e,n,r){var i=this;return this.ou(),this.credentials.getToken().then(function(t){return i.Do.au(e,n,r,t)}).catch(function(t){throw t.code===Ir.UNAUTHENTICATED&&i.credentials.Ao(),t})},Gh.prototype.terminate=function(){this.ru=!1},Gh),jh=(qh.prototype._u=function(){var t=this;0===this.cu&&(this.fu("Unknown"),this.hu=this.On.Pn("online_state_timeout",1e4,function(){return t.hu=null,t.du("Backend didn't respond within 10 seconds."),t.fu("Offline"),Promise.resolve()}))},qh.prototype.wu=function(t){"Online"===this.state?this.fu("Unknown"):(this.cu++,1<=this.cu&&(this.mu(),this.du("Connection failed 1 times. Most recent error: "+t.toString()),this.fu("Offline")))},qh.prototype.set=function(t){this.mu(),this.cu=0,"Online"===t&&(this.lu=!1),this.fu(t)},qh.prototype.fu=function(t){t!==this.state&&(this.state=t,this.Qs(t))},qh.prototype.du=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.lu?(Pr(t),this.lu=!1):Or("OnlineStateTracker",t)},qh.prototype.mu=function(){null!==this.hu&&(this.hu.cancel(),this.hu=null)},qh);function qh(t,e){this.On=t,this.Qs=e,this.state="Unknown",this.cu=0,this.hu=null,this.lu=!0}function Gh(t,e,n){var r=this;return(r=Oh.call(this)||this).credentials=t,r.Do=e,r.serializer=n,r.ru=!1,r}function Bh(t,e,n,r,i){var o=this;return(o=Ph.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Zo=!1,o}function Qh(t,e,n,r,i){var o=this;return(o=Lh.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function zh(t,e,n,r,i,o){this._n=t,this.So=n,this.Do=r,this.Co=i,this.listener=o,this.state=0,this.No=0,this.Fo=null,this.stream=null,this.Jn=new ya(t,e)}function Hh(t,e){this.vo=t,this.bo=e}function Wh(t,e){this.vo=t,this.bo=e,this.type="FirstParty",this.user=Da.Ns}function Yh(t){var e=this;this.yo=null,this.currentUser=Da.UNAUTHENTICATED,this.Po=!1,this.Vo=0,this.To=null,this.forceRefresh=!1,this.yo=function(){e.Vo++,e.currentUser=e.po(),e.Po=!0,e.To&&e.To(e.currentUser)},this.Vo=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.yo):(this.yo(null),t.get().then(function(t){e.auth=t,e.yo&&e.auth.addAuthTokenListener(e.yo)},function(){}))}function Xh(){this.To=null}function Jh(t,e){this.key=t,this.mo=e}function Kh(){this.no=new to(Dh.so),this.io=new to(Dh.ro)}function Zh(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!uc(r))return[3,4];e=0,n=r.yu,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function $h(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.yu,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function tc(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Or("RemoteStore","RemoteStore shutting down."),e.Ru.add(5),[4,$h(e)];case 1:return t.sent(),e.Pu.ei(),e.pu.set("Unknown"),[2]}})})}function ec(t,e){t.Iu.has(e.targetId)||(t.Iu.set(e.targetId,e),sc(t)?oc(t):dc(t).Lo()&&rc(t,e))}function nc(t,e){var n=t,t=dc(n);n.Iu.delete(e),t.Lo()&&ic(n,e),0===n.Iu.size&&(t.Lo()?t.ko():uc(n)&&n.pu.set("Unknown"))}function rc(t,e){t.gu.Te(e.targetId),dc(t).Jo(e)}function ic(t,e){t.gu.Te(e),dc(t).Xo(e)}function oc(e){e.gu=new bo({Ue:function(t){return e.Tu.Ue(t)},qe:function(t){return e.Iu.get(t)||null}}),dc(e).start(),e.pu._u()}function sc(t){return uc(t)&&!dc(t).$o()&&0<t.Iu.size}function uc(t){return 0===t.Ru.size}function ac(t){t.gu=void 0}function hc(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!wa(r))throw r;return n.Ru.add(1),[4,$h(n)];case 1:return t.sent(),n.pu.set("Offline"),i=i||function(){return bh(n.gi)},n.On.rs(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Or("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Ru.delete(1),[4,Zh(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function cc(e,n){return n().catch(function(t){return hc(e,t,n)})}function lc(c){return y(this,void 0,void 0,function(){var s,u,a,h;return v(this,function(t){switch(t.label){case 0:u=yc(s=c),a=0<s.Au.length?s.Au[s.Au.length-1].batchId:-1,t.label=1;case 1:if(!(uc(s)&&s.Au.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(r=s.gi,i=a,(o=r).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===i&&(i=-1),o.Mi.Kr(t,i)}))];case 3:return null===(h=t.sent())?(0===s.Au.length&&u.ko(),[3,7]):(a=h.batchId,n=h,(e=s).Au.push(n),(e=yc(e)).Lo()&&e.tu&&e.eu(n.mutations),[3,6]);case 4:return h=t.sent(),[4,hc(s,h)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return fc(s)&&pc(s),[2]}var e,n,r,i,o})})}function fc(t){return uc(t)&&!yc(t).$o()&&0<t.Au.length}function pc(t){yc(t).start()}function dc(n){var t,e,r,i=this;return n.Cu||(n.Cu=(t=n.Eu,e=n.On,r={Ko:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Iu.forEach(function(t,e){rc(n,t)}),[2]})})}.bind(null,n),Qo:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return ac(e),sc(e)?(e.pu.wu(n),oc(e)):e.pu.set("Unknown"),[2]})})}.bind(null,n),Yo:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.pu.set("Online"),!(u instanceof mo&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Iu.has(i)?[4,o.Tu.vu(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Iu.delete(i),o.gu.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Or("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,hc(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof vo?s.gu.ge(u):u instanceof go?s.gu.$e(u):s.gu.Se(u),a.isEqual(Oi.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,bh(s.gi)];case 8:return o=t.sent(),0<=a.M(o)?[4,(i=a,(e=(r=s).gu.xe(i)).zt.forEach(function(t,e){var n;0<t.resumeToken.k()&&(n=r.Iu.get(e))&&r.Iu.set(e,n.st(t.resumeToken,i))}),e.Kt.forEach(function(t){var e=r.Iu.get(t);e&&(r.Iu.set(t,e.st(vi.U,e.et)),ic(r,t),e=new Bi(e.target,t,1,e.sequenceNumber),rc(r,e))}),r.Tu.bu(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Or("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,hc(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},t.ou(),new Mh(e,t.Do,t.credentials,t.serializer,r)),n.yu.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Cu.xo(),sc(n)?oc(n):n.pu.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.Cu.stop()];case 2:t.sent(),ac(n),t.label=3;case 3:return[2]}})})})),n.Cu}function yc(n){var t,e,r,i=this;return n.Nu||(n.Nu=(t=n.Eu,e=n.On,r={Ko:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return yc(e).iu(),[2]})})}.bind(null,n),Qo:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&yc(e).tu?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return zi(n=i.code)&&n!==Ir.ABORTED?(e=r.Au.shift(),yc(r).xo(),[4,cc(r,function(){return r.Tu.Du(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,lc(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return fc(e)&&pc(e),[2]}})})}.bind(null,n),su:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=yc(o),n=0,r=o.Au;n<r.length;n++)i=r[n],e.eu(i.mutations);return[2]})})}.bind(null,n),nu:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Au.shift(),n=ja.from(e,i,o),[4,cc(r,function(){return r.Tu.Su(n)})];case 1:return t.sent(),[4,lc(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.ou(),new xh(e,t.Do,t.credentials,t.serializer,r)),n.yu.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Nu.xo(),[4,lc(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Nu.stop()];case 3:t.sent(),0<n.Au.length&&(Or("RemoteStore","Stopping write stream with "+n.Au.length+" pending writes"),n.Au=[]),t.label=4;case 4:return[2]}})})})),n.Nu}function vc(t,e,n){this.query=t,this.targetId=e,this.view=n}var gc=function(t){this.key=t},mc=function(t){this.key=t},wc=(Object.defineProperty(Tc.prototype,"ku",{get:function(){return this.Fu},enumerable:!1,configurable:!0}),Tc.prototype.Mu=function(t,e){var s=this,u=e?e.Uu:new lo,a=(e||this).xu,h=(e||this).Qt,c=a,l=!1,f=Tu(this.query)&&a.size===this.query.limit?a.last():null,p=Au(this.query)&&a.size===this.query.limit?a.first():null;if(t.ct(function(t,e){var n=a.get(t),r=(r=e instanceof yu?e:null)&&(Cu(s.query,r)?r:null),i=!!n&&s.Qt.has(n.key),o=!!r&&(r.Ye||s.Qt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.qu(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.Ou(r,f)||p&&s.Ou(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(h=r?(c=c.add(r),o?h.add(t):h.delete(t)):(c=c.delete(t),h.delete(t)))}),Tu(this.query)||Au(this.query))for(;c.size>this.query.limit;){var n=Tu(this.query)?c.last():c.first(),c=c.delete(n.key),h=h.delete(n.key);u.track({type:1,doc:n})}return{xu:c,Uu:u,Bu:l,Qt:h}},Tc.prototype.qu=function(t,e){return t.Ye&&e.hasCommittedMutations&&!e.Ye},Tc.prototype.Qu=function(t,e,n){var o=this,r=this.xu;this.xu=t.xu,this.Qt=t.Qt;var i=t.Uu.qt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.Ou(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Dr()}}var r,i}),this.ju(n);var s=e?this.Wu():[],e=(n=0===this.Lu.size&&this.Zt?1:0)!==this.$u;return this.$u=n,0!==i.length||e?{snapshot:new fo(this.query,t.xu,r,i,t.Qt,0==n,e,!1),Gu:s}:{Gu:s}},Tc.prototype.As=function(t){return this.Zt&&"Offline"===t?(this.Zt=!1,this.Qu({xu:this.xu,Uu:new lo,Qt:this.Qt,Bu:!1},!1)):{Gu:[]}},Tc.prototype.zu=function(t){return!this.Fu.has(t)&&!!this.xu.has(t)&&!this.xu.get(t).Ye},Tc.prototype.ju=function(t){var e=this;t&&(t.te.forEach(function(t){return e.Fu=e.Fu.add(t)}),t.ee.forEach(function(t){}),t.ne.forEach(function(t){return e.Fu=e.Fu.delete(t)}),this.Zt=t.Zt)},Tc.prototype.Wu=function(){var e=this;if(!this.Zt)return[];var n=this.Lu;this.Lu=ao(),this.xu.forEach(function(t){e.zu(t.key)&&(e.Lu=e.Lu.add(t.key))});var r=[];return n.forEach(function(t){e.Lu.has(t)||r.push(new mc(t))}),this.Lu.forEach(function(t){n.has(t)||r.push(new gc(t))}),r},Tc.prototype.Ku=function(t){return this.Fu=t.Zr,this.Lu=ao(),t=this.Mu(t.documents),this.Qu(t,!0)},Tc.prototype.Hu=function(){return fo.Gt(this.query,this.xu,this.Qt,0===this.$u)},Tc),bc=function(t){this.key=t,this.Yu=!1},Ec=(Object.defineProperty(Ic.prototype,"_a",{get:function(){return!0===this.la},enumerable:!1,configurable:!0}),Ic);function Ic(t,e,n,r,i,o){this.gi=t,this.Ju=e,this.Xu=n,this.Zu=r,this.currentUser=i,this.ta=o,this.ea={},this.na=new Ri(ku,_u),this.sa=new Map,this.ia=[],this.ra=new Wi(Gr.i),this.oa=new Map,this.ua=new Vh,this.aa={},this.ca=new Map,this.ha=dh.yr(),this.onlineState="Unknown",this.la=void 0}function Tc(t,e){this.query=t,this.Fu=e,this.$u=null,this.Zt=!1,this.Lu=ao(),this.Qt=ao(),this.Ou=Mu(t),this.xu=new co(this.Ou)}function Ac(f,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:(o=f).Ju.Tu.Su=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.gi,c=s,(l=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=c.batch.keys(),n=l.Ci.Di({Ni:!0}),i=l,o=t,s=n,u=(r=c).batch,a=u.keys(),h=va.resolve();return a.forEach(function(n){h=h.next(function(){return s.ji(o,n)}).next(function(t){var e=t;_r(null!==(t=r.ci.get(n))),(!e||e.version.M(t)<0)&&(e=u.ii(n,e,r))&&s.Or(e,r.ai)})}),h.next(function(){return i.Mi.kr(o,u)}).next(function(){return n.apply(t)}).next(function(){return l.Mi.Mr(t)}).next(function(){return l.xi.Gi(t,e)})}))];case 2:return i=t.sent(),Oc(n,r,null),Sc(n,r),n.Zu.Ws(r,"acknowledged"),[4,_c(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,Nh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,c,l})})}.bind(null,o),o.Ju.Tu.Du=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.gi,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.Mi.Ea(e,r).next(function(t){return _r(null!==t),n=t.keys(),i.Mi.kr(e,t)}).next(function(){return i.Mi.Mr(e)}).next(function(){return i.xi.Gi(e,n)})}))];case 2:return o=t.sent(),Oc(n,u,a),Sc(n,u),n.Zu.Ws(u,"rejected",a),[4,_c(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Nh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.gi,a=p,c=r,l=Si.now(),i=a.reduce(function(t,e){return t.add(e.key)},ao()),c.persistence.runTransaction("Locally write mutations","readwrite",function(u){return c.xi.Gi(u,i).next(function(t){h=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=h.get(i.key),s instanceof $s?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof yu?t.field(i.field):void 0;null!=(o=ms(i.transform,o||null))&&(e=(null==e?new uu:e).set(i.field,o))}return e?e.Je():null}(o):null);null!=o&&e.push(new Ys(i.key,o,function s(t){var u=[];return Ur(t.fields||{},function(t,e){var n=new qr([t]);if(Wo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Cs(u)}(o.proto.mapValue),Fs.exists(!0)))}return c.Mi.wa(u,l,e,a)})}).then(function(t){var e=t.ui(h);return{batchId:t.batchId,ma:e}}))];case 2:return s=t.sent(),u.Zu.js(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.aa[e.currentUser.Ds()])||new Wi(di)).rt(n,o),e.aa[e.currentUser.Ds()]=r,[4,_c(u,s.ma)];case 3:return t.sent(),[4,lc(u.Ju)];case 4:return t.sent(),[3,6];case 5:return u=Na(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,h,c,l,i,o})})}function Nc(o,s){return y(this,void 0,void 0,function(){var n,i;return v(this,function(t){switch(t.label){case 0:n=o,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.gi,a=e,h=(r=s).et,c=a.Vr,a.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=a.Ci.Di({Ni:!0});c=a.Vr;var u=[];r.zt.forEach(function(t,e){var n,r,i,o=c.get(e);o&&(u.push(a.$i.qr(s,t.ne,e).next(function(){return a.$i.Li(s,t.te,e)})),0<(i=t.resumeToken).k()&&(n=o.st(i,h).nt(s.Br),c=c.rt(e,n),r=o,i=t,_r(0<(o=n).resumeToken.k()),(0===r.resumeToken.k()||3e8<=o.et.J()-r.et.J()||0<i.te.size+i.ee.size+i.ne.size)&&u.push(a.$i.Qr(s,n))))});var e,n=no;return r.Ht.forEach(function(t,e){r.Yt.has(t)&&u.push(a.persistence.Wr.jr(s,t))}),u.push(Eh(s,t,r.Ht,h,void 0).next(function(t){n=t})),h.isEqual(Oi.min())||(e=a.$i.Ur(s).next(function(t){return a.$i.Gr(s,s.Br,h)}),u.push(e)),va.$n(u).next(function(){return t.apply(s)}).next(function(){return a.xi.Oi(s,n)})}).then(function(t){return a.Vr=c,t}))];case 2:return i=t.sent(),s.zt.forEach(function(t,e){(e=n.oa.get(e))&&(_r(t.te.size+t.ee.size+t.ne.size<=1),0<t.te.size?e.Yu=!0:0<t.ee.size?_r(e.Yu):0<t.ne.size&&(_r(e.Yu),e.Yu=!1))}),[4,_c(n,i,s)];case 3:return t.sent(),[3,6];case 4:return[4,Nh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,a,h,c})})}function Rc(t,n,e){var r;((t=t)._a&&0===e||!t._a&&1===e)&&(r=[],t.na.forEach(function(t,e){(e=e.view.As(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.ws.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].As(i)&&(o=!0)}),o&&La(t)}(t.Xu,n),r.length&&t.ea.Yo(r),t.onlineState=n,t._a&&t.Zu.ti(n))}function Sc(t,e){(t.ca.get(e)||[]).forEach(function(t){t.resolve()}),t.ca.delete(e)}function Oc(t,e,n){var r=t,i=r.aa[r.currentUser.Ds()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.aa[r.currentUser.Ds()]=i)}function Pc(e,t,n){void 0===n&&(n=null),e.Zu.Ks(t);for(var r=0,i=e.sa.get(t);r<i.length;r++){var o=i[r];e.na.delete(o),n&&e.ea.fa(o,n)}e.sa.delete(t),e._a&&e.ua.lo(t).forEach(function(t){e.ua.wo(t)||Lc(e,t)})}function Lc(t,e){var n=t.ra.get(e);null!==n&&(nc(t.Ju,n),t.ra=t.ra.remove(e),t.oa.delete(n),Dc(t))}function Vc(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof gc?(t.ua.oo(u.key,e),r=t,i=(i=u).key,r.ra.get(i)||(Or("SyncEngine","New document in limbo: "+i),r.ia.push(i),Dc(r))):u instanceof mc?(Or("SyncEngine","Document no longer in limbo: "+u.key),t.ua.ao(u.key,e),t.ua.wo(u.key)||Lc(t,u.key)):Dr()}}function Dc(t){for(;0<t.ia.length&&t.ra.size<t.ta;){var e=t.ia.shift(),n=t.ha.next();t.oa.set(n,new bc(e)),t.ra=t.ra.rt(e,n),ec(t.Ju,new Bi(Pu(Iu(e.path)),n,2,Ua.xs))}}function _c(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).na.m()?[3,3]:(n.na.forEach(function(t,e){o.push(n.da(e,s,u).then(function(t){t&&(n._a&&n.Zu.zs(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=ih.sr(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.ea.Yo(r),[4,function(a,h){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return va.forEach(h,function(e){return va.forEach(e.er,function(t){return r.persistence.Wr.oo(n,e.targetId,t)}).next(function(){return va.forEach(e.nr,function(t){return r.persistence.Wr.ao(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!wa(e=t.sent()))throw e;return Or("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=h;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.Vr.get(o),u=s.et,u=s.it(u),r.Vr=r.Vr.rt(o,u));return[2]}})})}(n.gi,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}var kc,Uc,Cc,Mc,xc,Fc=(Ol.prototype.Fr=function(t){this.ba=t},Ol.prototype.Ki=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.rn.length||1===r.rn.length&&r.rn[0].field.g())||i.isEqual(Oi.min())?this.Sa(e,r):this.ba.Gi(e,o).next(function(t){var n=s.Da(r,t);return(Tu(r)||Au(r))&&s.Bu(r.on,n,o,i)?s.Sa(e,r):(Sr()<=u.DEBUG&&Or("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Uu(r)),s.ba.Ki(e,r,i).next(function(e){return n.forEach(function(t){e=e.rt(t.key,t)}),e}))})},Ol.prototype.Da=function(n,t){var r=new to(Mu(n));return t.forEach(function(t,e){e instanceof yu&&Cu(n,e)&&(r=r.add(e))}),r},Ol.prototype.Bu=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.M(r))},Ol.prototype.Sa=function(t,e){return Sr()<=u.DEBUG&&Or("IndexFreeQueryEngine","Using full collection scan to execute query:",Uu(e)),this.ba.Ki(t,e,Oi.min())},Ol),jc=(Sl.prototype.Fa=function(t){return va.resolve(0===this.Mi.length)},Sl.prototype.wa=function(t,e,n,r){var i=this.Ca;this.Ca++,0<this.Mi.length&&this.Mi[this.Mi.length-1],n=new Fa(i,e,n,r),this.Mi.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Na=this.Na.add(new Dh(u.key,i)),this.Ui.Ar(t,u.key.path.h())}return va.resolve(n)},Sl.prototype.Ea=function(t,e){return va.resolve(this.$a(e))},Sl.prototype.Kr=function(t,e){return e+=1,e=(e=this.La(e))<0?0:e,va.resolve(this.Mi.length>e?this.Mi[e]:null)},Sl.prototype.Ta=function(){return va.resolve(0===this.Mi.length?-1:this.Ca-1)},Sl.prototype.Aa=function(t){return va.resolve(this.Mi.slice())},Sl.prototype.Bi=function(t,e){var n=this,r=new Dh(e,0),e=new Dh(e,Number.POSITIVE_INFINITY),i=[];return this.Na.Nt([r,e],function(t){t=n.$a(t.mo),i.push(t)}),va.resolve(i)},Sl.prototype.zi=function(t,e){var n=this,r=new to(di);return e.forEach(function(t){var e=new Dh(t,0),t=new Dh(t,Number.POSITIVE_INFINITY);n.Na.Nt([e,t],function(t){r=r.add(t.mo)})}),va.resolve(this.Oa(r))},Sl.prototype.Zi=function(t,e){var n=e.path,r=n.length+1,e=n;Gr.F(e)||(e=e.child(""));var e=new Dh(new Gr(e),0),i=new to(di);return this.Na.Ft(function(t){var e=t.key.path;return!!n.T(e)&&(e.length===r&&(i=i.add(t.mo)),!0)},e),va.resolve(this.Oa(i))},Sl.prototype.Oa=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.$a(t))&&n.push(t)}),n},Sl.prototype.kr=function(n,r){var i=this;_r(0===this.xa(r.batchId,"removed")),this.Mi.shift();var o=this.Na;return va.forEach(r.mutations,function(t){var e=new Dh(t.key,r.batchId);return o=o.delete(e),i.Wr.ka(n,t.key)}).next(function(){i.Na=o})},Sl.prototype.Ma=function(t){},Sl.prototype.wo=function(t,e){var n=new Dh(e,0),n=this.Na.$t(n);return va.resolve(e.isEqual(n&&n.key))},Sl.prototype.Mr=function(t){return this.Mi.length,va.resolve()},Sl.prototype.xa=function(t,e){return this.La(t)},Sl.prototype.La=function(t){return 0===this.Mi.length?0:t-this.Mi[0].batchId},Sl.prototype.$a=function(t){return(t=this.La(t))<0||t>=this.Mi.length?null:this.Mi[t]},Sl),qc=(Rl.prototype.Or=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.Ua(e);return this.docs=this.docs.rt(r,{qa:e,size:o,readTime:n}),this.size+=o-i,this.Ui.Ar(t,r.path.h())},Rl.prototype.zr=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Rl.prototype.ji=function(t,e){return e=this.docs.get(e),va.resolve(e?e.qa:null)},Rl.prototype.getEntries=function(t,e){var n=this,r=no;return e.forEach(function(t){var e=n.docs.get(t);r=r.rt(t,e?e.qa:null)}),va.resolve(r)},Rl.prototype.Ki=function(t,e,n){for(var r=oo,i=new Gr(e.path.child("")),o=this.docs._t(i);o.At();){var s=(u=o.Tt()).key,u=(a=u.value).qa,a=a.readTime;if(!e.path.T(s.path))break;a.M(n)<=0||u instanceof yu&&Cu(e,u)&&(r=r.rt(u.key,u))}return va.resolve(r)},Rl.prototype.Ba=function(t,e){return va.forEach(this.docs,function(t){return e(t)})},Rl.prototype.Di=function(t){return new Gc(this)},Rl.prototype.Qa=function(t){return va.resolve(this.size)},Rl),Gc=(Nl.prototype.Wa=function(t){return(t=this.ma.get(t))?t.readTime:Oi.min()},Nl.prototype.Or=function(t,e){this.Ga(),this.ma.set(t.key,{qa:t,readTime:e})},Nl.prototype.zr=function(t,e){void 0===e&&(e=null),this.Ga(),this.ma.set(t,{qa:null,readTime:e})},Nl.prototype.ji=function(t,e){this.Ga();var n=this.ma.get(e);return void 0!==n?va.resolve(n.qa):this.za(t,e)},Nl.prototype.getEntries=function(t,e){return this.Ka(t,e)},Nl.prototype.apply=function(t){return this.Ga(),this.ja=!0,this.Qu(t)},Nl.prototype.Ga=function(){},n(Al,xc=Nl),Al.prototype.Qu=function(n){var r=this,i=[];return this.ma.forEach(function(t,e){e&&e.qa?i.push(r.Ha.Or(n,e.qa,r.Wa(t))):r.Ha.zr(t)}),va.$n(i)},Al.prototype.za=function(t,e){return this.Ha.ji(t,e)},Al.prototype.Ka=function(t,e){return this.Ha.getEntries(t,e)},Al),Bc=(Tl.prototype.De=function(t,n){return this.Ya.forEach(function(t,e){return n(e)}),va.resolve()},Tl.prototype.Ur=function(t){return va.resolve(this.lastRemoteSnapshotVersion)},Tl.prototype.tc=function(t){return va.resolve(this.Ja)},Tl.prototype.Yr=function(t){return this.highestTargetId=this.Za.next(),va.resolve(this.highestTargetId)},Tl.prototype.Gr=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Ja&&(this.Ja=e),va.resolve()},Tl.prototype.ec=function(t){this.Ya.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Za=new dh(e),this.highestTargetId=e),t.sequenceNumber>this.Ja&&(this.Ja=t.sequenceNumber)},Tl.prototype.Jr=function(t,e){return this.ec(e),this.targetCount+=1,va.resolve()},Tl.prototype.Qr=function(t,e){return this.ec(e),va.resolve()},Tl.prototype.nc=function(t,e){return this.Ya.delete(e.target),this.Xa.lo(e.targetId),--this.targetCount,va.resolve()},Tl.prototype.sc=function(n,r,i){var o=this,s=0,u=[];return this.Ya.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Ya.delete(t),u.push(o.Fi(n,e.targetId)),s++)}),va.$n(u).next(function(){return s})},Tl.prototype.ic=function(t){return va.resolve(this.targetCount)},Tl.prototype.Hr=function(t,e){return e=this.Ya.get(e)||null,va.resolve(e)},Tl.prototype.Li=function(t,e,n){return this.Xa.uo(e,n),va.resolve()},Tl.prototype.qr=function(e,t,n){this.Xa.ho(t,n);var r=this.persistence.Wr,i=[];return r&&t.forEach(function(t){i.push(r.ka(e,t))}),va.$n(i)},Tl.prototype.Fi=function(t,e){return this.Xa.lo(e),va.resolve()},Tl.prototype.Xr=function(t,e){return e=this.Xa.fo(e),va.resolve(e)},Tl.prototype.wo=function(t,e){return va.resolve(this.Xa.wo(e))},Tl),Qc=(Il.prototype.Pa=function(t,e){return va.resolve(this.rc.get(e))},Il.prototype.ga=function(t,e){return this.rc.set(e.id,{id:e.id,version:e.version,createTime:ns(e.createTime)}),va.resolve()},Il.prototype.uc=function(t,e){return va.resolve(this.oc.get(e))},Il.prototype.eo=function(t,e){return this.oc.set(e.name,{name:(e=e).name,query:lh(e.bundledQuery),readTime:ns(e.readTime)}),va.resolve()},Il),zc=(El.prototype.start=function(){return Promise.resolve()},El.prototype.ei=function(){return this.hc=!1,Promise.resolve()},Object.defineProperty(El.prototype,"_c",{get:function(){return this.hc},enumerable:!1,configurable:!0}),El.prototype.fc=function(){},El.prototype.dc=function(){},El.prototype.Dr=function(){return this.Ui},El.prototype.vr=function(t){var e=this.ac[t.Ds()];return e||(e=new jc(this.Ui,this.Wr),this.ac[t.Ds()]=e),e},El.prototype.Sr=function(){return this.$i},El.prototype.br=function(){return this.ki},El.prototype.Nr=function(){return this.Cr},El.prototype.runTransaction=function(t,e,n){var r=this;Or("MemoryPersistence","Starting transaction:",t);var i=new Hc(this.cc.next());return this.Wr.wc(),n(i).next(function(t){return r.Wr.mc(i).next(function(){return t})}).Nn().then(function(t){return i.Ec(),t})},El.prototype.Tc=function(e,n){return va.Ln(Object.values(this.ac).map(function(t){return function(){return t.wo(e,n)}}))},El),Hc=(bl.prototype.Ic=function(t){this.Ac.push(t)},bl.prototype.Ec=function(){this.Ac.forEach(function(t){return t()})},n(wl,Mc=bl),wl),Wc=(ml.Pc=function(t){return new ml(t)},Object.defineProperty(ml.prototype,"Vc",{get:function(){if(this.yc)return this.yc;throw Dr()},enumerable:!1,configurable:!0}),ml.prototype.oo=function(t,e,n){return this.Rc.oo(n,e),this.Vc.delete(n.toString()),va.resolve()},ml.prototype.ao=function(t,e,n){return this.Rc.ao(n,e),this.Vc.add(n.toString()),va.resolve()},ml.prototype.ka=function(t,e){return this.Vc.add(e.toString()),va.resolve()},ml.prototype.removeTarget=function(t,e){var n=this;this.Rc.lo(e.targetId).forEach(function(t){return n.Vc.add(t.toString())});var r=this.persistence.Sr();return r.Xr(t,e.targetId).next(function(t){t.forEach(function(t){return n.Vc.add(t.toString())})}).next(function(){return r.nc(t,e)})},ml.prototype.wc=function(){this.yc=new Set},ml.prototype.mc=function(n){var r=this,i=this.persistence.br().Di();return va.forEach(this.Vc,function(t){var e=Gr.D(t);return r.gc(n,e).next(function(t){t||i.zr(e)})}).next(function(){return r.yc=null,i.apply(n)})},ml.prototype.jr=function(t,e){var n=this;return this.gc(t,e).next(function(t){t?n.Vc.delete(e.toString()):n.Vc.add(e.toString())})},ml.prototype.lc=function(t){return 0},ml.prototype.gc=function(t,e){var n=this;return va.Ln([function(){return va.resolve(n.Rc.wo(e))},function(){return n.persistence.Sr().wo(t,e)},function(){return n.persistence.Tc(t,e)}])},ml),Yc=(gl.prototype.Ko=function(t){this.Sc=t},gl.prototype.Qo=function(t){this.Dc=t},gl.prototype.onMessage=function(t){this.Cc=t},gl.prototype.close=function(){this.bc()},gl.prototype.send=function(t){this.vc(t)},gl.prototype.Nc=function(){this.Sc()},gl.prototype.Fc=function(t){this.Dc(t)},gl.prototype.$c=function(t){this.Cc(t)},gl),Xc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Jc=(vl.prototype.uu=function(e,t,n,r){var i=this.kc(e,t);return Or("RestConnection","Sending: ",i,n),t={},this.Mc(t,r),this.Uc(e,i,t,n).then(function(t){return Or("RestConnection","Received: ",t),t},function(t){throw Lr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},vl.prototype.au=function(t,e,n,r){return this.uu(t,e,n,r)},vl.prototype.Mc=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.22.1-alpha.01492c06e",t["Content-Type"]="text/plain",e)for(var n in e.Eo)e.Eo.hasOwnProperty(n)&&(t[n]=e.Eo[n])},vl.prototype.kc=function(t,e){return t=Xc[t],this.Oc+"/v1/"+e+":"+t},n(yl,Cc=vl),yl.prototype.Uc=function(o,e,s,u){return new Promise(function(n,r){var i=new mr;i.listenOnce(vr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case yr.NO_ERROR:var t=i.getResponseJson();Or("Connection","XHR received:",JSON.stringify(t)),n(t);break;case yr.TIMEOUT:Or("Connection",'RPC "'+o+'" timed out'),r(new Tr(Ir.DEADLINE_EXCEEDED,"Request time out"));break;case yr.HTTP_ERROR:var e=i.getStatus();Or("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Ir).indexOf(e)?e:Ir.UNKNOWN,r(new Tr(e,t.message))):r(new Tr(Ir.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Tr(Ir.UNAVAILABLE,"Connection failed."));break;default:Dr()}}finally{Or("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},yl.prototype.Ho=function(t,e){var n,r=[this.Oc,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=dr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.B.projectId+"/databases/"+this.B.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.Mc(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),Or("Connection","Creating WebChannel: "+(r=r.join("")),t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new Yc({vc:function(t){u?Or("Connection","Not sending because WebChannel is closed:",t):(s||(Or("Connection","Opening WebChannel transport."),o.open(),s=!0),Or("Connection","WebChannel sending:",t),o.send(t))},bc:function(){return o.close()}});return(t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})})(gr.EventType.OPEN,function(){u||Or("Connection","WebChannel transport opened.")}),t(gr.EventType.CLOSE,function(){u||(u=!0,Or("Connection","WebChannel transport closed"),a.Fc())}),t(gr.EventType.ERROR,function(t){u||(u=!0,Lr("Connection","WebChannel transport errored:",t),a.Fc(new Tr(Ir.UNAVAILABLE,"The operation could not be completed")))}),t(gr.EventType.MESSAGE,function(t){var e,n,r,i;u||(_r(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Or("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Gi[r];if(void 0!==t)return Hi(t)}(),i=n.message,void 0===t&&(t=Ir.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.Fc(new Tr(t,i)),o.close()):(Or("Connection","WebChannel received:",e),a.$c(e)))}),setTimeout(function(){a.Nc()},0),a},yl),Kc=(dl.prototype.Vu=function(t){this.Wc.push(t)},dl.prototype.ei=function(){window.removeEventListener("online",this.qc),window.removeEventListener("offline",this.Qc)},dl.prototype.Gc=function(){window.addEventListener("online",this.qc),window.addEventListener("offline",this.Qc)},dl.prototype.Bc=function(){Or("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Wc;t<e.length;t++)(0,e[t])(0)},dl.prototype.jc=function(){Or("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Wc;t<e.length;t++)(0,e[t])(1)},dl.zc=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},dl),Zc=(pl.prototype.Vu=function(t){},pl.prototype.ei=function(){},pl),$c="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",tl=(fl.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.serializer=Wa(e.Lc.B),this.Zu=this.Kc(e),this.persistence=this.Hc(e),[4,this.persistence.start()];case 1:return t.sent(),this.Yc=this.Jc(e),this.gi=this.Xc(e),[2]}})})},fl.prototype.Jc=function(t){return null},fl.prototype.Xc=function(t){return e=this.persistence,n=new Fc,r=t.Zc,t=this.serializer,new yh(e,n,r,t);var e,n,r},fl.prototype.Hc=function(t){if(t.persistenceSettings.th)throw new Tr(Ir.FAILED_PRECONDITION,$c);return new zc(Wc.Pc,this.serializer)},fl.prototype.Kc=function(t){return new xa},fl.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Yc&&this.Yc.stop(),[4,this.Zu.ei()];case 1:return t.sent(),[4,this.persistence.ei()];case 2:return t.sent(),[2]}})})},fl.prototype.clearPersistence=function(t,e){throw new Tr(Ir.FAILED_PRECONDITION,$c)},fl),el=(ll.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.gi?[3,2]:(this.gi=n.gi,this.Zu=n.Zu,this.Eu=this.eh(r),this.Ju=this.nh(r),this.Xu=this.sh(r),this.ih=this.rh(r),this.Zu.Qs=function(t){return Rc(e.ih,t,1)},this.Ju.Tu.oh=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Or("SyncEngine","User change. New user:",o.Ds()),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).Mi,m=e.xi,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.Mi.Aa(v).next(function(t){return g=t,n=e.persistence.vr(o),m=new rh(e.Ci,n,e.persistence.Dr()),n.Aa(v)}).next(function(t){for(var e=[],n=[],r=ao(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Gi(v,r).next(function(t){return{Ia:t,Ra:e,ya:n}})})})];case 1:return r=t.sent(),[2,(e.Mi=n,e.xi=m,e.Pr.Fr(e.xi),r)]}})})}(n.gi,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).ca.forEach(function(t){t.forEach(function(t){t.reject(new Tr(Ir.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.ca.clear(),n.Zu.Zs(o,r.Ra,r.ya),[4,_c(n,r.Ia)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this.ih),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Ru.delete(2),[4,Zh(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Ru.add(2),[4,$h(e)]);case 3:t.sent(),e.pu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.Ju,this.ih._a)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},ll.prototype.sh=function(t){return new Sa},ll.prototype.eh=function(t){var e=Wa(t.Lc.B),n=(n=t.Lc,new Jc(n));return t=t.credentials,new Fh(t,n,e)},ll.prototype.nh=function(t){var e=this;return new Sh(this.gi,this.Eu,t.On,function(t){return Rc(e.ih,t,0)},t=new(Kc.zc()?Kc:Zc))},ll.prototype.rh=function(t){return e=this.gi,n=this.Ju,r=this.Xu,i=this.Zu,o=t.Zc,s=t.ta,u=!t.persistenceSettings.th||!t.persistenceSettings.synchronizeTabs,s=new Ec(e,n,r,i,o,s),u&&(s.la=!0),s;var e,n,r,i,o,s,u},ll.prototype.terminate=function(){return tc(this.Ju)},ll),nl=(cl.prototype.next=function(t){this.observer.next&&this.uh(this.observer.next,t)},cl.prototype.error=function(t){this.observer.error?this.uh(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},cl.prototype.ah=function(){this.muted=!0},cl.prototype.uh=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},cl),rl=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Tr(Ir.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(Kr("FieldPath","string",e,t[e]),0===t[e].length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.hh=new qr(t)},il=(n(hl,Uc=rl),hl.documentId=function(){return new hl(qr.v().R())},hl.prototype.isEqual=function(t){if(!(t instanceof hl))throw ai("isEqual","FieldPath",1,t);return this.hh.isEqual(t.hh)},hl),ol=new RegExp("[~\\*/\\[\\]]"),sl=function(t){this.lh=t},ul=(n(al,kc=sl),al.prototype._h=function(t){if(2!==t.fh)throw 1===t.fh?t.dh(this.lh+"() can only appear at the top level of your update data"):t.dh(this.lh+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},al.prototype.isEqual=function(t){return t instanceof al},al);function al(){return null!==kc&&kc.apply(this,arguments)||this}function hl(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Uc.call(this,t)||this}function cl(t){this.observer=t,this.muted=!1}function ll(){}function fl(){}function pl(){}function dl(){var t=this;this.qc=function(){return t.Bc()},this.Qc=function(){return t.jc()},this.Wc=[],this.Gc()}function yl(t){var e=this;return(e=Cc.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function vl(t){this.Lc=t,this.B=t.B;var e=t.ssl?"https":"http";this.Oc=e+"://"+t.host,this.xc="projects/"+this.B.projectId+"/databases/"+this.B.database+"/documents"}function gl(t){this.vc=t.vc,this.bc=t.bc}function ml(t){this.persistence=t,this.Rc=new Vh,this.yc=null}function wl(t){var e=this;return(e=Mc.call(this)||this).Br=t,e}function bl(){this.Ac=[]}function El(t,e){var n=this;this.ac={},this.cc=new Ua(0),this.hc=!1,this.hc=!0,this.Wr=t(this),this.$i=new Bc(this),this.Ui=new fh,this.ki=(t=this.Ui,new qc(t,function(t){return n.Wr.lc(t)})),this.serializer=new ch(e),this.Cr=new Qc(this.serializer)}function Il(t){this.serializer=t,this.rc=new Map,this.oc=new Map}function Tl(t){this.persistence=t,this.Ya=new Ri(xi,Fi),this.lastRemoteSnapshotVersion=Oi.min(),this.highestTargetId=0,this.Ja=0,this.Xa=new Vh,this.targetCount=0,this.Za=dh.Rr()}function Al(t){var e=this;return(e=xc.call(this)||this).Ha=t,e}function Nl(){this.ma=new Ri(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.ja=!1}function Rl(t,e){this.Ui=t,this.Ua=e,this.docs=new Wi(Gr.i),this.size=0}function Sl(t,e){this.Ui=t,this.Wr=e,this.Mi=[],this.Ca=1,this.Na=new to(Dh.so)}function Ol(){}function Pl(t,e,n){return new Zl({fh:3,wh:e.settings.wh,methodName:t.lh,mh:n},e.B,e.serializer,e.ignoreUndefinedProperties)}var Ll,Vl,Dl,_l,kl=(n(Jl,_l=sl),Jl.prototype._h=function(t){return new Us(t.path,new Es)},Jl.prototype.isEqual=function(t){return t instanceof Jl},Jl),Ul=(n(Xl,Dl=sl),Xl.prototype._h=function(t){var e=Pl(this,t,!0),n=this.Eh.map(function(t){return uf(t,e)}),n=new Is(n);return new Us(t.path,n)},Xl.prototype.isEqual=function(t){return this===t},Xl),Cl=(n(Yl,Vl=sl),Yl.prototype._h=function(t){var e=Pl(this,t,!0),n=this.Eh.map(function(t){return uf(t,e)}),n=new Ss(n);return new Us(t.path,n)},Yl.prototype.isEqual=function(t){return this===t},Yl),Ml=(n(Wl,Ll=sl),Wl.prototype._h=function(t){var e=new Vs(t.serializer,$o(t.serializer,this.Th));return new Us(t.path,e)},Wl.prototype.isEqual=function(t){return this===t},Wl),xl=(Object.defineProperty(Hl.prototype,"latitude",{get:function(){return this.Ah},enumerable:!1,configurable:!0}),Object.defineProperty(Hl.prototype,"longitude",{get:function(){return this.Ih},enumerable:!1,configurable:!0}),Hl.prototype.isEqual=function(t){return this.Ah===t.Ah&&this.Ih===t.Ih},Hl.prototype.toJSON=function(){return{latitude:this.Ah,longitude:this.Ih}},Hl.prototype.H=function(t){return di(this.Ah,t.Ah)||di(this.Ih,t.Ih)},Hl),Fl=function(t){this.Rh=t},jl=/^__.*__$/,ql=function(t,e,n){this.yh=t,this.Ph=e,this.Vh=n},Gl=(zl.prototype.ph=function(t,e){var n=[];return null!==this.Qe?n.push(new Ys(t,this.data,this.Qe,e)):n.push(new Ws(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new $s(t,this.fieldTransforms)),n},zl),Bl=(Ql.prototype.ph=function(t,e){return e=[new Ys(t,this.data,this.Qe,e)],0<this.fieldTransforms.length&&e.push(new $s(t,this.fieldTransforms)),e},Ql);function Ql(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function zl(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function Hl(t,e){if(Yr("GeoPoint",arguments,2),Kr("GeoPoint","number",1,t),Kr("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Tr(Ir.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Tr(Ir.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Ah=t,this.Ih=e}function Wl(t,e){var n=this;return(n=Ll.call(this,t)||this).Th=e,n}function Yl(t,e){var n=this;return(n=Vl.call(this,t)||this).Eh=e,n}function Xl(t,e){var n=this;return(n=Dl.call(this,t)||this).Eh=e,n}function Jl(){return null!==_l&&_l.apply(this,arguments)||this}function Kl(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Dr()}}var Zl=(Object.defineProperty(ef.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(ef.prototype,"fh",{get:function(){return this.settings.fh},enumerable:!1,configurable:!0}),ef.prototype.bh=function(t){return new ef(Object.assign(Object.assign({},this.settings),t),this.B,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},ef.prototype.Sh=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.bh({path:e,mh:!1})).Dh(t),e},ef.prototype.Ch=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.bh({path:t,mh:!1})).gh(),t},ef.prototype.Nh=function(t){return this.bh({path:void 0,mh:!0})},ef.prototype.dh=function(t){return pf(t,this.settings.methodName,this.settings.Fh||!1,this.path,this.settings.wh)},ef.prototype.contains=function(e){return void 0!==this.Qe.find(function(t){return e.T(t)})||void 0!==this.fieldTransforms.find(function(t){return e.T(t.field)})},ef.prototype.gh=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Dh(this.path.get(t))},ef.prototype.Dh=function(t){if(0===t.length)throw this.dh("Document fields must not be empty");if(Kl(this.fh)&&jl.test(t))throw this.dh('Document fields cannot begin and end with "__"')},ef),$l=(tf.prototype.$h=function(t,e,n,r){return void 0===r&&(r=!1),new Zl({fh:t,methodName:e,wh:n,path:qr.V(),mh:!1,Fh:r},this.B,this.serializer,this.ignoreUndefinedProperties)},tf);function tf(t,e,n){this.B=t,this.ignoreUndefinedProperties=e,this.serializer=n||Wa(t)}function ef(t,e,n,r,i,o){this.settings=t,this.B=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.gh(),this.fieldTransforms=i||[],this.Qe=o||[]}function nf(t,e,n,r,i,o){void 0===o&&(o={});var s=t.$h(o.merge||o.mergeFields?2:0,e,n,i);cf("Data must be an object, but it was:",s,r);var u,a,r=af(r,s);if(o.merge)u=new Cs(s.Qe),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],c=0,l=o.mergeFields;c<l.length;c++){var f=l[c],p=void 0;if(f instanceof rl)p=f.hh;else{if("string"!=typeof f)throw Dr();p=ff(e,f,n)}if(!s.contains(p))throw new Tr(Ir.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");df(h,p)||h.push(p)}u=new Cs(h),a=s.fieldTransforms.filter(function(t){return u.Ke(t.field)})}else u=null,a=s.fieldTransforms;return new Gl(new su(r),u,a)}function rf(t,r,i,e){var o=t.$h(1,r,i);cf("Data must be an object, but it was:",o,e);var s=[],u=new uu;return Ur(e,function(t,e){var n=ff(r,t,i),t=o.Ch(n);e instanceof ul||e instanceof Fl&&e.Rh instanceof ul?s.push(n):null!=(t=uf(e,t))&&(s.push(n),u.set(n,t))}),e=new Cs(s),new Bl(u.Je(),e,o.fieldTransforms)}function of(t,e,n,r,i,o){var s=t.$h(1,e,n),u=[lf(e,r,n)],a=[i];if(o.length%2!=0)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(lf(e,o[h])),a.push(o[h+1]);for(var c,l,f,p=[],d=new uu,y=u.length-1;0<=y;--y)df(p,u[y])||(c=u[y],l=a[y],f=s.Ch(c),l instanceof ul||l instanceof Fl&&l.Rh instanceof ul?p.push(c):null!=(f=uf(l,f))&&(p.push(c),d.set(c,f)));return i=new Cs(p),new Bl(d.Je(),i,s.fieldTransforms)}function sf(t,e,n,r){return void 0===r&&(r=!1),uf(n,t.$h(r?4:3,e))}function uf(s,t){if(s instanceof Fl&&(s=s.Rh),hf(s))return cf("Unsupported field value:",t,s),af(s,t);if(s instanceof sl)return function(t,e){if(!Kl(e.fh))throw e.dh(t.lh+"() can only be used with update() and set()");if(!e.path)throw e.dh(t.lh+"() is not currently supported inside arrays");(t=t._h(e))&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.Qe.push(t.path),s instanceof Array){if(t.settings.mh&&4!==t.fh)throw t.dh("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=uf(i[r],t.Nh(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return $o(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Si.fromDate(t);return{timestampValue:ts(e.serializer,n)}}if(t instanceof Si){var r=new Si(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:ts(e.serializer,r)}}if(t instanceof xl)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof mi)return{bytesValue:es(e.serializer,t.q)};if(t instanceof ql){if(n=e.B,!(r=t.yh).isEqual(n))throw e.dh("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:rs(t.yh||e.B,t.Ph.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.dh("Unsupported field value: "+oi(t))}(s,t)}function af(t,n){var r={};return Cr(t)?n.path&&0<n.path.length&&n.Qe.push(n.path):Ur(t,function(t,e){null!=(e=uf(e,n.Sh(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function hf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Si||t instanceof xl||t instanceof mi||t instanceof ql||t instanceof sl)}function cf(t,e,n){if(!hf(n)||!ii(n))throw"an object"===(n=oi(n))?e.dh(t+" a custom object"):e.dh(t+" "+n)}function lf(t,e,n){if(e instanceof rl)return e.hh;if("string"==typeof e)return ff(t,e);throw pf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function ff(t,e,n){try{return function(e){if(0<=e.search(ol))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(il.bind.apply(il,i([void 0],e.split("."))))}catch(t){throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).hh}catch(e){throw pf(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function pf(t,e,n,r,i){var o=r&&!r.m(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Tr(Ir.INVALID_ARGUMENT,(e+=". ")+t+n)}function df(t,e){return t.some(function(t){return t.isEqual(e)})}var yf=(bf.prototype.Mh=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.Uh(),0<this.mutations.length)throw new Tr(Ir.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var i,e,n,o,r;return v(this,function(t){switch(t.label){case 0:return e=as((i=s).serializer)+"/documents",n={documents:u.map(function(t){return os(i.serializer,t)})},[4,i.au("BatchGetDocuments",e,n)];case 1:return n=t.sent(),o=new Map,n.forEach(function(t){var e,n,r,t=(e=i.serializer,"found"in(t=t)?function(t,e){_r(!!e.found),e.found.name,e.found.updateTime;var n=ss(t,e.found.name),t=ns(e.found.updateTime),e=new su({mapValue:{fields:e.found.fields}});return new yu(n,t,e,{})}(e,t):"missing"in t?(n=e,_r(!!(r=t).missing),_r(!!r.readTime),n=ss(n,r.missing),r=ns(r.readTime),new vu(n,r)):Dr());o.set(t.key.toString(),t)}),r=[],[2,(u.forEach(function(t){_r(!!(t=o.get(t.toString()))),r.push(t)}),r)]}})})}(this.Eu,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof vu||t instanceof yu?n.qh(t):Dr()}),e)]}})})},bf.prototype.set=function(t,e){this.write(e.ph(t,this.Ge(t))),this.kh.add(t.toString())},bf.prototype.update=function(t,e){try{this.write(e.ph(t,this.Bh(t)))}catch(t){this.xh=t}this.kh.add(t.toString())},bf.prototype.delete=function(t){this.write([new iu(t,this.Ge(t))]),this.kh.add(t.toString())},bf.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.Uh(),this.xh)throw this.xh;return e=this.Lh,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=Gr.D(e),n.mutations.push(new ou(e,n.Ge(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=as((e=i).serializer)+"/documents",r={writes:o.map(function(t){return ls(e.serializer,t)})},[4,e.uu("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Eu,this.mutations)];case 1:return t.sent(),this.Oh=!0,[2]}})})},bf.prototype.qh=function(t){var e;if(t instanceof yu)e=t.version;else{if(!(t instanceof vu))throw Dr();e=Oi.min()}var n=this.Lh.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Tr(Ir.ABORTED,"Document version changed between two reads.")}else this.Lh.set(t.key.toString(),e)},bf.prototype.Ge=function(t){var e=this.Lh.get(t.toString());return!this.kh.has(t.toString())&&e?Fs.updateTime(e):Fs.He()},bf.prototype.Bh=function(t){var e=this.Lh.get(t.toString());if(this.kh.has(t.toString())||!e)return Fs.exists(!0);if(e.isEqual(Oi.min()))throw new Tr(Ir.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Fs.updateTime(e)},bf.prototype.write=function(t){this.Uh(),this.mutations=this.mutations.concat(t)},bf.prototype.Uh=function(){},bf),vf=(wf.prototype.run=function(){this.jh()},wf.prototype.jh=function(){var t=this;this.Jn.Rn(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new yf(this.Eu),(n=this.Wh(e))&&n.then(function(t){r.On.Qn(function(){return e.commit().then(function(){r.Mn.resolve(t)}).catch(function(t){r.Gh(t)})})}).catch(function(t){r.Gh(t)}),[2]})})})},wf.prototype.Wh=function(t){try{var e=this.updateFunction(t);return!ki(e)&&e.catch&&e.then?e:(this.Mn.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Mn.reject(t),null}},wf.prototype.Gh=function(t){var e=this;0<this.Qh&&this.zh(t)?(--this.Qh,this.On.Qn(function(){return e.jh(),Promise.resolve()})):this.Mn.reject(t)},wf.prototype.zh=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!zi(t))},wf),gf=(mf.prototype.start=function(t,e,n,r){var i=this;this.Hh(),this.Lc=t;var o=new da,s=!1;return this.credentials.Io(function(t){return s?void i.On.rs(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).On.cs(),Or("RemoteStore","RemoteStore received new credentials"),n=uc(e),e.Ru.add(3),[4,$h(e)];case 1:return t.sent(),n&&e.pu.set("Unknown"),[4,e.Tu.oh(i)];case 2:return t.sent(),e.Ru.delete(3),[4,Zh(e)];case 3:return t.sent(),[2]}})})}(i.Ju,t)}):(s=!0,Or("FirestoreClient","Initializing. user=",t.uid),i.Yh(e,n,r,t,o).then(i.Kh.resolve,i.Kh.reject))}),this.On.Qn(function(){return i.Kh.promise}),o.promise},mf.prototype.enableNetwork=function(){var e=this;return this.Hh(),this.On.enqueue(function(){return e.persistence.dc(!0),(t=e.Ju).Ru.delete(0),Zh(t);var t})},mf.prototype.Yh=function(r,i,o,s,u){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={On:this.On,Lc:this.Lc,clientId:this.clientId,credentials:this.credentials,Zc:s,ta:100,persistenceSettings:o},[4,r.initialize(e)];case 1:return t.sent(),[4,i.initialize(r,e)];case 2:return t.sent(),this.persistence=r.persistence,this.Zu=r.Zu,this.gi=r.gi,this.Yc=r.Yc,this.Eu=i.Eu,this.Ju=i.Ju,this.ih=i.ih,this.Jh=i.Xu,this.Jh.Ts=function(u,a){return y(this,void 0,void 0,function(){var n,r,i,o,s;return v(this,function(t){switch(t.label){case 0:return(e=u).Ju.Tu.bu=Nc.bind(null,e),e.Ju.Tu.Ue=function(t,e){var n=t;if((t=n.oa.get(e))&&t.Yu)return ao().add(t.key);var r=ao();if(!(e=n.sa.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.na.get(s),r=r.Lt(s.view.ku);return r}.bind(null,e),e.Ju.Tu.vu=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Zu.zs(s,"rejected",u),i=e.oa.get(s),(n=i&&i.key)?(r=(r=new Wi(Gr.i)).rt(n,new vu(n,Oi.min())),i=ao().add(n),i=new po(Oi.min(),new Map,new to(di),r,i),[4,Nc(e,i)]):[3,2];case 1:return t.sent(),e.ra=e.ra.remove(n),e.oa.delete(s),Dc(e),[3,4];case 2:return[4,Th(e.gi,s,!1).then(function(){return Pc(e,s,u)}).catch(Nh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.ea.Yo=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.ws.get(u)){for(var a=0,h=u.listeners;a<h.length;a++)h[a].Is(s)&&(r=!0);u.ds=s}}r&&La(n)}.bind(null,e.Xu),e.ea.fa=function(t,e,n){var r=t;if(t=r.ws.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.ws.delete(e)}.bind(null,e.Xu),(s=(n=e).na.get(a))?(r=s.targetId,n.Zu.Gs(r),i=s.view.Hu(),[3,4]):[3,1];case 1:return[4,Ih(n.gi,Pu(a))];case 2:return o=t.sent(),s=n.Zu.Gs(o.targetId),r=o.targetId,[4,function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.da=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.Mu(o)).Bu?[4,Ah(r.gi,i.query,!1).then(function(t){return t=t.documents,i.view.Mu(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.zt.get(i.targetId),n=i.view.Qu(e,r._a,n),[2,(Vc(r,i.targetId,n.Gu),n.snapshot)]}})})}(i,t,e,n)},[4,Ah(i.gi,o,!0)];case 1:return n=t.sent(),r=new wc(o,n.Zr),e=r.Mu(n.documents),n=yo.Xt(s,u&&"Offline"!==i.onlineState),n=r.Qu(e,i._a,n),Vc(i,s,n.Gu),r=new vc(o,s,r),i.na.set(o,r),i.sa.has(s)?i.sa.get(s).push(o):i.sa.set(s,[o]),[2,n.snapshot]}})})}(n,a,r,"current"===s)];case 3:i=t.sent(),n._a&&ec(n.Ju,o),t.label=4;case 4:return[2,i]}var e})})}.bind(null,this.ih),this.Jh.Rs=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).na.get(o),1<(r=e.sa.get(n.targetId)).length?[2,(e.sa.set(n.targetId,r.filter(function(t){return!_u(t,o)})),void e.na.delete(o))]:e._a?(e.Zu.Ks(n.targetId),e.Zu.Xs(n.targetId)?[3,2]:[4,Th(e.gi,n.targetId,!1).then(function(){e.Zu.Ys(n.targetId),nc(e.Ju,n.targetId),Pc(e,n.targetId)}).catch(Nh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Pc(e,n.targetId),[4,Th(e.gi,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,this.ih),this.persistence.fc(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),u.resolve(),[3,4];case 3:if(e=t.sent(),u.reject(e),!this.Xh(e))throw e;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),this.Yh(new tl,new el,{th:!1},s,u))];case 4:return[2]}})})},mf.prototype.Xh=function(t){return"FirebaseError"===t.name?t.code===Ir.FAILED_PRECONDITION||t.code===Ir.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},mf.prototype.Hh=function(){if(this.On.Zn)throw new Tr(Ir.FAILED_PRECONDITION,"The client has already been terminated.")},mf.prototype.disableNetwork=function(){var t=this;return this.Hh(),this.On.enqueue(function(){return t.persistence.dc(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Ru.add(0),[4,$h(e)];case 1:return t.sent(),e.pu.set("Offline"),[2]}})})}(t.Ju)})},mf.prototype.terminate=function(){var t=this;this.On.ss();var n=new da;return this.On.ts(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.Yc&&this.Yc.stop(),[4,tc(this.Ju)];case 1:return t.sent(),[4,this.Zu.ei()];case 2:return t.sent(),[4,this.persistence.ei()];case 3:return t.sent(),this.credentials.Ro(),n.resolve(),[3,5];case 4:return e=Na(e=t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,5];case 5:return[2]}})})}),n.promise},mf.prototype.waitForPendingWrites=function(){var t=this;this.Hh();var e=new da;return this.On.Qn(function(){return function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:uc((n=o).Ju)||Or("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.gi).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Mi.Ta(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.ca.get(r)||[]).push(s),n.ca.set(r,i),[3,4]);case 3:return i=Na(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}(t.ih,e)}),e.promise},mf.prototype.listen=function(t,e,n){var r=this;this.Hh();var i=new nl(n),o=new Va(t,i,e);return this.On.Qn(function(){return Oa(r.Jh,o)}),function(){i.ah(),r.On.Qn(function(){return Pa(r.Jh,o)})}},mf.prototype.Zh=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.Hh(),[4,this.Kh.promise];case 1:return t.sent(),e=new da,[2,(this.On.Qn(function(){return function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.xi.qi(t,e)}))];case 1:return(r=t.sent())instanceof yu?s.resolve(r):r instanceof vu?s.resolve(null):s.reject(new Tr(Ir.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=Na(r=t.sent(),"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(n.gi,r,e)}),e.promise)]}})})},mf.prototype.tl=function(h,c){return void 0===c&&(c={}),y(this,void 0,void 0,function(){var e,a=this;return v(this,function(t){switch(t.label){case 0:return this.Hh(),[4,this.Kh.promise];case 1:return t.sent(),e=new da,[2,(this.On.Qn(function(){return n=a.Jh,r=a.On,i=h,o=c,s=e,t=new nl({next:function(t){r.Qn(function(){return Pa(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Tr(Ir.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Tr(Ir.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Va(Iu(i.path),t,{includeMetadataChanges:!0,bs:!0}),Oa(n,u);var n,r,i,o,s,t,u}),e.promise)]}})})},mf.prototype.el=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.Hh(),[4,this.Kh.promise];case 1:return t.sent(),e=new da,[2,(this.On.Qn(function(){return function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,Ah(r,i,!0)];case 1:return n=t.sent(),e=new wc(i,n.Zr),n=e.Mu(n.documents),n=e.Qu(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=Na(n=t.sent(),"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(n.gi,r,e)}),e.promise)]}})})},mf.prototype.nl=function(h,c){return void 0===c&&(c={}),y(this,void 0,void 0,function(){var u,a=this;return v(this,function(t){switch(t.label){case 0:return this.Hh(),[4,this.Kh.promise];case 1:return t.sent(),u=new da,[2,(this.On.Qn(function(){return e=a.Jh,n=a.On,t=h,r=c,i=u,o=new nl({next:function(t){n.Qn(function(){return Pa(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Tr(Ir.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Va(t,o,{includeMetadataChanges:!0,bs:!0}),Oa(e,s);var e,n,t,r,i,o,s}),u.promise)]}})})},mf.prototype.write=function(t){var e=this;this.Hh();var n=new da;return this.On.Qn(function(){return Ac(e.ih,t,n)}),n.promise},mf.prototype.B=function(){return this.Lc.B},mf.prototype.sl=function(t){var e=this;this.Hh();var r=new nl(t);return this.On.Qn(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,(e=this.Jh,n=r,e.Es.add(n),void n.next())];var e,n})})}),function(){r.ah(),e.On.Qn(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,void this.Jh.Es.delete(r)]})})})}},Object.defineProperty(mf.prototype,"il",{get:function(){return this.On.Zn},enumerable:!1,configurable:!0}),mf.prototype.transaction=function(t){var e=this;this.Hh();var n=new da;return this.On.Qn(function(){return new vf(e.On,e.Eu,t,n).run(),Promise.resolve()}),n.promise},mf.prototype.loadBundle=function(t,r){var e=this;this.Hh();var n,i,o=(n=t,i=Wa(this.Lc.B),n="string"==typeof n?(new TextEncoder).encode(n):n,new Xa(Ha(n),i));this.On.Qn(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,(e=this.ih,function(f,p,d){return y(this,void 0,void 0,function(){var u,a,h,c,l;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,14,,15]),[4,p.getMetadata()];case 1:return u=t.sent(),[4,(r=f.gi,i=u,s=new Ja((o=r).serializer).Pi(i.createTime),o.persistence.runTransaction("hasNewerBundle","readonly",function(t){return o.Cr.Pa(t,i.id)}).then(function(t){return!!t&&0<=t.createTime.M(s)}))];case 2:return t.sent()?[4,p.close()]:[3,4];case 3:return[2,(t.sent(),void d.Va({taskState:"Success",documentsLoaded:u.totalDocuments,bytesLoaded:u.totalBytes,totalDocuments:u.totalDocuments,totalBytes:u.totalBytes}))];case 4:return d.pa(th(u)),a=new nh(u,f.gi,p.serializer),[4,p.wi()];case 5:h=t.sent(),t.label=6;case 6:return h?[4,a.vi(h)]:[3,10];case 7:return(c=t.sent())&&d.pa(c),[4,p.wi()];case 8:h=t.sent(),t.label=9;case 9:return[3,6];case 10:return[4,a.complete()];case 11:return l=t.sent(),[4,_c(f,l.Vi,void 0)];case 12:return t.sent(),[4,(r=f.gi,e=u,(n=r).persistence.runTransaction("Save bundle","readwrite",function(t){return n.Cr.ga(t,e)}))];case 13:return t.sent(),d.Va(l.progress),[3,15];case 14:return l=t.sent(),d.va(l),[3,15];case 15:return[2]}var e,n,r,i,o,s})})}(n=e,o,r).then(function(){n.Zu.ni()}),r.catch(function(t){Lr("FirestoreClient","Loading bundle failed with "+t)}))];var e,n})})})},mf.prototype.uc=function(t){return this.Hh(),e=this.gi,n=t,(r=e).persistence.runTransaction("Get named query","readonly",function(t){return r.Cr.uc(t,n)});var e,n,r},mf);function mf(t,e){this.credentials=t,this.On=e,this.clientId=fi.L(),this.Kh=new da}function wf(t,e,n,r){this.On=t,this.Eu=e,this.updateFunction=n,this.Mn=r,this.Qh=5,this.Jn=new ya(this.On,"transaction_retry")}function bf(t){this.Eu=t,this.Lh=new Map,this.mutations=[],this.Oh=!1,this.xh=null,this.kh=new Set}function Ef(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var If,Tf,Af=(Qf.prototype.al=function(t){switch(_o(t)){case 0:return null;case 1:return t.booleanValue;case 2:return jo(t.integerValue||t.doubleValue);case 3:return this.cl(t.timestampValue);case 4:return this.hl(t);case 5:return t.stringValue;case 6:return this.ul(qo(t.bytesValue));case 7:return this.ll(t.referenceValue);case 8:return this._l(t.geoPointValue);case 9:return this.fl(t.arrayValue);case 10:return this.dl(t.mapValue);default:throw Dr()}},Qf.prototype.dl=function(t){var n=this,r={};return Ur(t.fields||{},function(t,e){r[t]=n.al(e)}),r},Qf.prototype._l=function(t){return new xl(jo(t.latitude),jo(t.longitude))},Qf.prototype.fl=function(t){var e=this;return(t.values||[]).map(function(t){return e.al(t)})},Qf.prototype.hl=function(t){switch(this.rl){case"previous":var e=function t(e){return Lo(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==e?null:this.al(e);case"estimate":return this.cl(Vo(t));default:return null}},Qf.prototype.cl=function(t){return t=Fo(t),t=new Si(t.seconds,t.nanos),this.timestampsInSnapshots?t:t.toDate()},Qf.prototype.ll=function(t){var e=Fr.P(t);return _r(gs(e)),t=new Ni(e.get(1),e.get(3)),e=new Gr(e.u(5)),t.isEqual(this.B)||Pr("Document "+e+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+this.B.projectId+"/"+this.B.database+") instead."),this.ol(e)},Qf),Nf=(Bf.prototype.onProgress=function(t,e,n){this.wl={next:t,error:e,complete:n}},Bf.prototype.catch=function(t){return this.ml.promise.catch(t)},Bf.prototype.then=function(t,e){return this.ml.promise.then(t,e)},Bf.prototype.Va=function(t){this.pa(t),this.wl.complete&&this.wl.complete(),this.ml.resolve(t)},Bf.prototype.va=function(t){this.El.taskState="Error",this.wl.next&&this.wl.next(this.El),this.wl.error&&this.wl.error(t),this.ml.reject(t)},Bf.prototype.pa=function(t){this.El=t,this.wl.next&&this.wl.next(t)},Bf),Rf=oh.lr,Sf=(Gf.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Gf),Of=(Object.defineProperty(qf.prototype,"bl",{get:function(){return this.Sl||(this.Sl=new $l(this.yh,this.vl.ignoreUndefinedProperties)),this.Sl},enumerable:!1,configurable:!0}),qf.prototype.settings=function(t){if(Yr("Firestore.settings",arguments,1),Kr("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.vl),t)).merge,t=new Sf(t),this.Pl&&!this.vl.isEqual(t))throw new Tr(Ir.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.vl=t).credentials&&(this.gl=function(t){if(!t)return new _h;switch(t.type){case"gapi":var e=t.client;return _r(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Ch(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Tr(Ir.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},qf.prototype.enableNetwork=function(){return this.yl(),this.Pl.enableNetwork()},qf.prototype.disableNetwork=function(){return this.yl(),this.Pl.disableNetwork()},qf.prototype.enablePersistence=function(t){var e;if(this.Pl)throw new Tr(Ir.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var n=!1,r=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Pr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),n=null!==(e=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==e&&e,r=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,n&&r))throw new Tr(Ir.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Dl(this.Tl,this.Al,{th:!0,cacheSizeBytes:this.vl.cacheSizeBytes,synchronizeTabs:n,Cl:r})},qf.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){var n,e=this;return v(this,function(t){if(void 0!==this.Pl&&!this.Pl.il)throw new Tr(Ir.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new da,[2,(this.Rl.ts(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Tl.clearPersistence(this.yh,this.pl)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},qf.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(qf.prototype,"Nl",{get:function(){return this.yl(),this.Pl.il},enumerable:!1,configurable:!0}),qf.prototype.waitForPendingWrites=function(){return this.yl(),this.Pl.waitForPendingWrites()},qf.prototype.onSnapshotsInSync=function(t){return this.yl(),Ef(t)||(Kr("Firestore.onSnapshotsInSync","function",1,t),t={next:t}),this.Pl.sl(t)},qf.prototype.loadBundle=function(t){this.yl();var e=new Nf;return this.Pl.loadBundle(t,e),e},qf.prototype.namedQuery=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.yl(),[4,this.Pl.uc(n)];case 1:return[2,(e=t.sent())?new Jf(e.query,this,null):null]}})})},qf.prototype.yl=function(){return this.Pl||this.Dl(new tl,new el,{th:!1}),this.Pl},qf.prototype.Fl=function(){return new Ii(this.yh,this.pl,this.vl.host,this.vl.ssl,this.vl.experimentalForceLongPolling)},qf.prototype.Dl=function(t,e,n){var r=this.Fl();return this.Pl=new gf(this.gl,this.Rl),this.Pl.start(r,t,e,n)},qf.Vl=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Tr(Ir.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e;if(!(t=t.options.projectId)||"string"!=typeof t)throw new Tr(Ir.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Ni(t)},Object.defineProperty(qf.prototype,"app",{get:function(){if(!this.Il)throw new Tr(Ir.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Il},enumerable:!1,configurable:!0}),qf.prototype.collection=function(t){return Yr("Firestore.collection",arguments,1),Kr("Firestore.collection","non-empty string",1,t),this.yl(),new Zf(Fr.P(t),this,null)},qf.prototype.doc=function(t){return Yr("Firestore.doc",arguments,1),Kr("Firestore.doc","non-empty string",1,t),this.yl(),Vf.$l(Fr.P(t),this,null)},qf.prototype.collectionGroup=function(t){if(Yr("Firestore.collectionGroup",arguments,1),Kr("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.yl(),new Jf((t=t,new mu(Fr.V(),t)),this,null)},qf.prototype.runTransaction=function(e){var n=this;return Yr("Firestore.runTransaction",arguments,1),Kr("Firestore.runTransaction","function",1,e),this.yl().transaction(function(t){return e(new Pf(n,t))})},qf.prototype.batch=function(){return this.yl(),new Lf(this)},Object.defineProperty(qf,"logLevel",{get:function(){switch(Sr()){case u.DEBUG:return"debug";case u.ERROR:return"error";case u.SILENT:return"silent";case u.WARN:return"warn";case u.INFO:return"info";case u.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),qf.setLogLevel=function(t){Yr("Firestore.setLogLevel",arguments,1),ni("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Nr.setLogLevel(t)},qf.prototype.Ll=function(){return this.vl.timestampsInSnapshots},qf.prototype.Ol=function(){return this.vl},qf),Pf=(jf.prototype.get=function(t){var e=this;Yr("Transaction.get",arguments,1);var n=op("Transaction.get",t,this.xl);return this.kl.Mh([n.Ph]).then(function(t){if(!t||1!==t.length)return Dr();if((t=t[0])instanceof vu)return new _f(e.xl,n.Ph,null,!1,!1,n.Vh);if(t instanceof yu)return new _f(e.xl,n.Ph,t,!1,!1,n.Vh);throw Dr()})},jf.prototype.set=function(t,e,n){return Jr("Transaction.set",arguments,2,3),t=op("Transaction.set",t,this.xl),n=np("Transaction.set",n),e=sp(t.Vh,e,n),n=nf(this.xl.bl,"Transaction.set",t.Ph,e,null!==t.Vh,n),this.kl.set(t.Ph,n),this},jf.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return e="string"==typeof e||e instanceof il?(Xr("Transaction.update",arguments,3),r=op("Transaction.update",t,this.xl),of(this.xl.bl,"Transaction.update",r.Ph,e,n,i)):(Yr("Transaction.update",arguments,2),r=op("Transaction.update",t,this.xl),rf(this.xl.bl,"Transaction.update",r.Ph,e)),this.kl.update(r.Ph,e),this},jf.prototype.delete=function(t){return Yr("Transaction.delete",arguments,1),t=op("Transaction.delete",t,this.xl),this.kl.delete(t.Ph),this},jf),Lf=(Ff.prototype.set=function(t,e,n){return Jr("WriteBatch.set",arguments,2,3),this.ql(),t=op("WriteBatch.set",t,this.xl),n=np("WriteBatch.set",n),e=sp(t.Vh,e,n),n=nf(this.xl.bl,"WriteBatch.set",t.Ph,e,null!==t.Vh,n),this.Ml=this.Ml.concat(n.ph(t.Ph,Fs.He())),this},Ff.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return this.ql(),e="string"==typeof e||e instanceof il?(Xr("WriteBatch.update",arguments,3),r=op("WriteBatch.update",t,this.xl),of(this.xl.bl,"WriteBatch.update",r.Ph,e,n,i)):(Yr("WriteBatch.update",arguments,2),r=op("WriteBatch.update",t,this.xl),rf(this.xl.bl,"WriteBatch.update",r.Ph,e)),this.Ml=this.Ml.concat(e.ph(r.Ph,Fs.exists(!0))),this},Ff.prototype.delete=function(t){return Yr("WriteBatch.delete",arguments,1),this.ql(),t=op("WriteBatch.delete",t,this.xl),this.Ml=this.Ml.concat(new iu(t.Ph,Fs.He())),this},Ff.prototype.commit=function(){return this.ql(),this.Ul=!0,0<this.Ml.length?this.xl.yl().write(this.Ml):Promise.resolve()},Ff.prototype.ql=function(){if(this.Ul)throw new Tr(Ir.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Ff),Vf=(n(xf,Tf=ql),xf.$l=function(t,e,n){if(t.length%2!=0)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.R()+" has "+t.length);return new xf(new Gr(t),e,n)},Object.defineProperty(xf.prototype,"id",{get:function(){return this.Ph.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(xf.prototype,"parent",{get:function(){return new Zf(this.Ph.path.h(),this.firestore,this.Vh)},enumerable:!1,configurable:!0}),Object.defineProperty(xf.prototype,"path",{get:function(){return this.Ph.path.R()},enumerable:!1,configurable:!0}),xf.prototype.collection=function(t){if(Yr("DocumentReference.collection",arguments,1),Kr("DocumentReference.collection","non-empty string",1,t),!t)throw new Tr(Ir.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");return t=Fr.P(t),new Zf(this.Ph.path.child(t),this.firestore,null)},xf.prototype.isEqual=function(t){if(!(t instanceof xf))throw ai("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Ph.isEqual(t.Ph)&&this.Vh===t.Vh},xf.prototype.set=function(t,e){return Jr("DocumentReference.set",arguments,1,2),e=np("DocumentReference.set",e),t=sp(this.Vh,t,e),e=nf(this.firestore.bl,"DocumentReference.set",this.Ph,t,null!==this.Vh,e),this.Pl.write(e.ph(this.Ph,Fs.He()))},xf.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return t="string"==typeof t||t instanceof il?(Xr("DocumentReference.update",arguments,2),of(this.firestore.bl,"DocumentReference.update",this.Ph,t,e,n)):(Yr("DocumentReference.update",arguments,1),rf(this.firestore.bl,"DocumentReference.update",this.Ph,t)),this.Pl.write(t.ph(this.Ph,Fs.exists(!0)))},xf.prototype.delete=function(){return Yr("DocumentReference.delete",arguments,0),this.Pl.write([new iu(this.Ph,Fs.He())])},xf.prototype.onSnapshot=function(){for(var e=this,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];Jr("DocumentReference.onSnapshot",arguments,1,4);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||Ef(n[i])||(ui("DocumentReference.onSnapshot",r=n[i],["includeMetadataChanges"]),ti("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};Ef(n[i])?(s=n[i],n[i]=null===(r=s.next)||void 0===r?void 0:r.bind(s),n[i+1]=null===(r=s.error)||void 0===r?void 0:r.bind(s),n[i+2]=null===(r=s.complete)||void 0===r?void 0:r.bind(s)):(Kr("DocumentReference.onSnapshot","function",i,n[i]),Zr("DocumentReference.onSnapshot","function",i+1,n[i+1]),Zr("DocumentReference.onSnapshot","function",i+2,n[i+2]));var s={next:function(t){n[i]&&n[i](e.Bl(t))},error:n[i+1],complete:n[i+2]};return this.Pl.listen(Iu(this.Ph.path),o,s)},xf.prototype.get=function(t){var e=this;Jr("DocumentReference.get",arguments,0,1),ip("DocumentReference.get",t);var n=this.firestore.yl();return t&&"cache"===t.source?n.Zh(this.Ph).then(function(t){return new _f(e.firestore,e.Ph,t,!0,t instanceof yu&&t.Ye,e.Vh)}):n.tl(this.Ph,t).then(function(t){return e.Bl(t)})},xf.prototype.withConverter=function(t){return new xf(this.Ph,this.firestore,t)},xf.prototype.Bl=function(t){var e=t.docs.get(this.Ph);return new _f(this.firestore,this.Ph,e,t.fromCache,t.hasPendingWrites,this.Vh)},xf),Df=(Mf.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Mf),_f=(Cf.prototype.data=function(t){var e=this;if(Jr("DocumentSnapshot.data",arguments,0,1),t=rp("DocumentSnapshot.data",t),this.Ql){if(this.Vh){var n=new kf(this.xl,this.Ph,this.Ql,this.jl,this.Wl,null);return this.Vh.fromFirestore(n,t)}return new Af(this.xl.yh,this.xl.Ll(),t.serverTimestamps||"none",function(t){return new Vf(t,e.xl,null)},function(t){return new Ai(t)}).al(this.Ql.sn())}},Cf.prototype.get=function(t,e){var n=this;if(Jr("DocumentSnapshot.get",arguments,1,2),e=rp("DocumentSnapshot.get",e),this.Ql&&null!==(t=this.Ql.data().field(lf("DocumentSnapshot.get",t,this.Ph))))return new Af(this.xl.yh,this.xl.Ll(),e.serverTimestamps||"none",function(t){return new Vf(t,n.xl,n.Vh)},function(t){return new Ai(t)}).al(t)},Object.defineProperty(Cf.prototype,"id",{get:function(){return this.Ph.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Cf.prototype,"ref",{get:function(){return new Vf(this.Ph,this.xl,this.Vh)},enumerable:!1,configurable:!0}),Object.defineProperty(Cf.prototype,"exists",{get:function(){return null!==this.Ql},enumerable:!1,configurable:!0}),Object.defineProperty(Cf.prototype,"metadata",{get:function(){return new Df(this.Wl,this.jl)},enumerable:!1,configurable:!0}),Cf.prototype.isEqual=function(t){if(!(t instanceof Cf))throw ai("isEqual","DocumentSnapshot",1,t);return this.xl===t.xl&&this.jl===t.jl&&this.Ph.isEqual(t.Ph)&&(null===this.Ql?null===t.Ql:this.Ql.isEqual(t.Ql))&&this.Vh===t.Vh},Cf),kf=(n(Uf,If=_f),Uf.prototype.data=function(t){return If.prototype.data.call(this,t)},Uf);function Uf(){return null!==If&&If.apply(this,arguments)||this}function Cf(t,e,n,r,i,o){this.xl=t,this.Ph=e,this.Ql=n,this.jl=r,this.Wl=i,this.Vh=o}function Mf(t,e){this.hasPendingWrites=t,this.fromCache=e}function xf(t,e,n){var r=this;return(r=Tf.call(this,e.yh,t,n)||this).Ph=t,r.firestore=e,r.Vh=n,r.Pl=r.firestore.yl(),r}function Ff(t){this.xl=t,this.Ml=[],this.Ul=!1}function jf(t,e){this.xl=t,this.kl=e}function qf(t,e,n,r){var i=this;if(void 0===n&&(n=new tl),void 0===r&&(r=new el),this.Tl=n,this.Al=r,this.Il=null,this.Rl=new Ia,this.INTERNAL={delete:function(){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.yl(),[4,this.Pl.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options)r=t,this.Il=r,this.yh=qf.Vl(r),this.pl=r.name,this.gl=new kh(e);else{if(!(t=t).projectId)throw new Tr(Ir.INVALID_ARGUMENT,"Must provide projectId");this.yh=new Ni(t.projectId,t.database),this.pl="[DEFAULT]",this.gl=new _h}this.vl=new Sf({})}function Gf(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Tr(Ir.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else $r("settings","non-empty string","host",t.host),this.host=t.host,ti("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(ui("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),ti("settings","object","credentials",t.credentials),this.credentials=t.credentials,ti("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),ti("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Pr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Pr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(e=t.timestampsInSnapshots)||void 0===e||e,this.ignoreUndefinedProperties=null!==(e=t.ignoreUndefinedProperties)&&void 0!==e&&e,ti("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=oh.dr;else{if(t.cacheSizeBytes!==Rf&&t.cacheSizeBytes<oh._r)throw new Tr(Ir.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+oh._r);this.cacheSizeBytes=t.cacheSizeBytes}ti("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(t=t.experimentalForceLongPolling)&&void 0!==t&&t}function Bf(){this.wl={},this.ml=new da,this.El={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function Qf(t,e,n,r,i){this.B=t,this.timestampsInSnapshots=e,this.rl=n,this.ol=r,this.ul=i}function zf(t,e,n){if("string"==typeof n){if(""===n)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Su(e)&&-1!==n.indexOf("/"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(Fr.P(n)),!Gr.F(e))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Go(t,new Gr(e))}if(n instanceof ql)return Go(t,n.Ph);throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+oi(n)+".")}function Hf(t,e){if(!Array.isArray(t)||0===t.length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function Wf(t,e,n){if(!n.isEqual(e))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Yf(t){if(Au(t)&&0===t.rn.length)throw new Tr(Ir.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Xf,Jf=(ep.prototype.where=function(t,e,n){return Yr("Query.where",arguments,3),si("Query.where",3,n),e=ni("Query.where",["<","<=","==","!=",">=",">","array-contains","in","array-contains-any","not-in"],2,e),t=lf("Query.where",t),e=function(t,e,n,r,i,o){if(r.g()){if("array-contains"===i||"array-contains-any"===i)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){Hf(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var h=a[u];s.push(zf(n,t,h))}c={arrayValue:{values:s}}}else c=zf(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Hf(o,i),c=sf(e,"Query.where",o,"in"===i||"not-in"===i);var c=Fu.create(r,i,c);return function(t,e){if(e.cn()){var n=Ru(t);if(null!==n&&!n.isEqual(e.field))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=Nu(t))&&Wf(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,c),c}(this.Gl,this.firestore.bl,this.firestore.yh,t,e,n),new ep((e=(n=this.Gl).filters.concat([e]),new mu(n.path,n.collectionGroup,n.rn.slice(),e,n.limit,n.on,n.startAt,n.endAt)),this.firestore,this.Vh)},ep.prototype.orderBy=function(t,e){if(Jr("Query.orderBy",arguments,1,2),Zr("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Tr(Ir.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=lf("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new pa(e,n);return e=r,null!==Nu(n=t)||null!==(t=Ru(n))&&Wf(0,t,e.field),r}(this.Gl,t,n);return new ep((t=(n=this.Gl).rn.concat([t]),new mu(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.on,n.startAt,n.endAt)),this.firestore,this.Vh)},ep.prototype.limit=function(t){return Yr("Query.limit",arguments,1),Kr("Query.limit","number",1,t),hi("Query.limit",1,t),new ep(Lu(this.Gl,t,"F"),this.firestore,this.Vh)},ep.prototype.limitToLast=function(t){return Yr("Query.limitToLast",arguments,1),Kr("Query.limitToLast","number",1,t),hi("Query.limitToLast",1,t),new ep(Lu(this.Gl,t,"L"),this.firestore,this.Vh)},ep.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Xr("Query.startAt",arguments,1),t=this.zl("Query.startAt",t,e,!0),new ep(Vu(this.Gl,t),this.firestore,this.Vh)},ep.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Xr("Query.startAfter",arguments,1),t=this.zl("Query.startAfter",t,e,!1),new ep(Vu(this.Gl,t),this.firestore,this.Vh)},ep.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Xr("Query.endBefore",arguments,1),t=this.zl("Query.endBefore",t,e,!0),new ep(Du(this.Gl,t),this.firestore,this.Vh)},ep.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Xr("Query.endAt",arguments,1),t=this.zl("Query.endAt",t,e,!1),new ep(Du(this.Gl,t),this.firestore,this.Vh)},ep.prototype.isEqual=function(t){if(!(t instanceof ep))throw ai("isEqual","Query",1,t);return this.firestore===t.firestore&&_u(this.Gl,t.Gl)&&this.Vh===t.Vh},ep.prototype.withConverter=function(t){return new ep(this.Gl,this.firestore,t)},ep.prototype.zl=function(h,t,e,n){return si(h,1,t),t instanceof _f?(Yr(h,i([t],e),1),function(t,e,n,r){if(!n)throw new Tr(Ir.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+h+"().");for(var i=[],o=0,s=Ou(t);o<s.length;o++){var u=s[o];if(u.field.g())i.push(Go(e,n.key));else{var a=n.field(u.field);if(Lo(a))throw new Tr(Ir.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.R(),new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new oa(i,r)}(this.Gl,this.firestore.yh,t.Ql,n)):(e=[t].concat(e),function(t,e,n,r,i,o){var s=t.rn;if(i.length>s.length)throw new Tr(Ir.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.g()){if("string"!=typeof h)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!Su(t)&&-1!==h.indexOf("/"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(Fr.P(h));if(!Gr.F(c))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");c=new Gr(c),u.push(Go(e,c))}else h=sf(n,r,h),u.push(h)}return new oa(u,o)}(this.Gl,this.firestore.yh,this.firestore.bl,h,e,n))},ep.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Jr("Query.onSnapshot",arguments,1,4);var i={},o=0;"object"!=typeof n[o]||Ef(n[o])||(ui("Query.onSnapshot",i=n[o],["includeMetadataChanges"]),ti("Query.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),o++),Ef(n[o])?(s=n[o],n[o]=null===(t=s.next)||void 0===t?void 0:t.bind(s),n[o+1]=null===(t=s.error)||void 0===t?void 0:t.bind(s),n[o+2]=null===(t=s.complete)||void 0===t?void 0:t.bind(s)):(Kr("Query.onSnapshot","function",o,n[o]),Zr("Query.onSnapshot","function",o+1,n[o+1]),Zr("Query.onSnapshot","function",o+2,n[o+2]));var s={next:function(t){n[o]&&n[o](new Kf(e.firestore,e.Gl,t,e.Vh))},error:n[o+1],complete:n[o+2]};return Yf(this.Gl),this.firestore.yl().listen(this.Gl,i,s)},ep.prototype.get=function(t){var e=this;Jr("Query.get",arguments,0,1),ip("Query.get",t),Yf(this.Gl);var n=this.firestore.yl();return(t&&"cache"===t.source?n.el(this.Gl):n.nl(this.Gl,t)).then(function(t){return new Kf(e.firestore,e.Gl,t,e.Vh)})},ep),Kf=(Object.defineProperty(tp.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(tp.prototype,"empty",{get:function(){return this.Hl.docs.m()},enumerable:!1,configurable:!0}),Object.defineProperty(tp.prototype,"size",{get:function(){return this.Hl.docs.size},enumerable:!1,configurable:!0}),tp.prototype.forEach=function(e,n){var r=this;Jr("QuerySnapshot.forEach",arguments,1,2),Kr("QuerySnapshot.forEach","function",1,e),this.Hl.docs.forEach(function(t){e.call(n,r.Xl(t,r.metadata.fromCache,r.Hl.Qt.has(t.key)))})},Object.defineProperty(tp.prototype,"query",{get:function(){return new Jf(this.Kl,this.xl,this.Vh)},enumerable:!1,configurable:!0}),tp.prototype.docChanges=function(t){if(t&&(ui("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),ti("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges)),(t=!(!t||!t.includeMetadataChanges))&&this.Hl.Wt)throw new Tr(Ir.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Yl&&this.Jl===t||(this.Yl=function(i,e,o){if(i.Bt.m()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Bt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Dr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.Hl,t,this.Xl.bind(this)),this.Jl=t),this.Yl},tp.prototype.isEqual=function(t){if(!(t instanceof tp))throw ai("isEqual","QuerySnapshot",1,t);return this.xl===t.xl&&_u(this.Kl,t.Kl)&&this.Hl.isEqual(t.Hl)&&this.Vh===t.Vh},tp.prototype.Xl=function(t,e,n){return new kf(this.xl,t.key,t,e,n,this.Vh)},tp),Zf=(n($f,Xf=Jf),Object.defineProperty($f.prototype,"id",{get:function(){return this.Gl.path._()},enumerable:!1,configurable:!0}),Object.defineProperty($f.prototype,"parent",{get:function(){var t=this.Gl.path.h();return t.m()?null:new Vf(new Gr(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty($f.prototype,"path",{get:function(){return this.Gl.path.R()},enumerable:!1,configurable:!0}),$f.prototype.doc=function(t){return Jr("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=fi.L()),Kr("CollectionReference.doc","non-empty string",1,t),t=Fr.P(t),Vf.$l(this.Gl.path.child(t),this.firestore,this.Vh)},$f.prototype.add=function(t){Yr("CollectionReference.add",arguments,1),Kr("CollectionReference.add","object",1,t=this.Vh?this.Vh.toFirestore(t):t);var e=this.doc();return new Vf(e.Ph,this.firestore,null).set(t).then(function(){return e})},$f.prototype.withConverter=function(t){return new $f(this.Zl,this.firestore,t)},$f);function $f(t,e,n){var r=this;if(((r=Xf.call(this,Iu(t),e,n)||this).Zl=t).length%2!=1)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.R()+" has "+t.length);return r}function tp(t,e,n,r){this.xl=t,this.Kl=e,this.Hl=n,this.Vh=r,this.Yl=null,this.Jl=null,this.metadata=new Df(n.hasPendingWrites,n.fromCache)}function ep(t,e,n){this.Gl=t,this.firestore=e,this.Vh=n}function np(t,e){if(void 0===e)return{merge:!1};if(ui(t,e,["merge","mergeFields"]),ti(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+oi(n));for(var r,i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof il))throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+oi(n[i]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function rp(t,e){return void 0===e?{}:(ui(t,e,["serverTimestamps"]),ei(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function ip(t,e){Zr(t,"object",1,e),e&&(ui(t,e,["source"]),ei(t,0,"source",e.source,["default","server","cache"]))}function op(t,e,n){if(e instanceof ql){if(e.firestore!==n)throw new Tr(Ir.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw ai(t,"DocumentReference",1,e)}function sp(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var up,ap,l=(n(cp,up=Fl),cp.serverTimestamp=function(){Wr("FieldValue.serverTimestamp",arguments);var t=new kl("serverTimestamp");return t.lh="FieldValue.serverTimestamp",new cp(t)},cp.delete=function(){Wr("FieldValue.delete",arguments);var t=new ul("deleteField");return t.lh="FieldValue.delete",new cp(t)},cp.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Xr("FieldValue.arrayUnion",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Xr("arrayUnion()",arguments,1),new Ul("arrayUnion",t)}.apply(void 0,t);return n.lh="FieldValue.arrayUnion",new cp(n)},cp.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Xr("FieldValue.arrayRemove",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Xr("arrayRemove()",arguments,1),new Cl("arrayRemove",t)}.apply(void 0,t);return n.lh="FieldValue.arrayRemove",new cp(n)},cp.increment=function(t){return Kr("FieldValue.increment","number",1,t),Yr("FieldValue.increment",arguments,1),(t=new Ml("increment",t)).lh="FieldValue.increment",new cp(t)},cp.prototype.isEqual=function(t){return this.Rh.isEqual(t.Rh)},cp),hp={Firestore:Of,GeoPoint:xl,Timestamp:Si,Blob:Ai,Transaction:Pf,WriteBatch:Lf,DocumentReference:Vf,DocumentSnapshot:_f,Query:Jf,QueryDocumentSnapshot:kf,QuerySnapshot:Kf,CollectionReference:Zf,FieldPath:il,FieldValue:l,setLogLevel:Of.setLogLevel,CACHE_SIZE_UNLIMITED:Rf};function cp(){return null!==up&&up.apply(this,arguments)||this}(ap=e.default).INTERNAL.registerComponent(new wr("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new Of(e,t,new tl,new el);var e},"PUBLIC").setServiceProps(Object.assign({},hp))),ap.registerVersion("@firebase/firestore","1.17.2-alpha.01492c06e")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
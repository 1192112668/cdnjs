!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t=t||self).firebase)}(this,function(Zp){"use strict";try{(function(){Zp=Zp&&Object.prototype.hasOwnProperty.call(Zp,"default")?Zp.default:Zp;var t,p,e,r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function d(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function i(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=a[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(e=p=p||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";var o={debug:p.DEBUG,verbose:p.VERBOSE,info:p.INFO,warn:p.WARN,error:p.ERROR,silent:p.SILENT},u=p.INFO,a=((t={})[p.DEBUG]="log",t[p.VERBOSE]="log",t[p.INFO]="info",t[p.WARN]="warn",t[p.ERROR]="error",t),h=(Object.defineProperty(c.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in p))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!0,configurable:!0}),c.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(c.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!0,configurable:!0}),c.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.DEBUG],t)),this._logHandler.apply(this,s([this,p.DEBUG],t))},c.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.VERBOSE],t)),this._logHandler.apply(this,s([this,p.VERBOSE],t))},c.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.INFO],t)),this._logHandler.apply(this,s([this,p.INFO],t))},c.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.WARN],t)),this._logHandler.apply(this,s([this,p.WARN],t))},c.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,p.ERROR],t)),this._logHandler.apply(this,s([this,p.ERROR],t))},c);function c(t){this.name=t,this._logLevel=u,this._logHandler=i,this._userLogHandler=null}function g(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var f,m=(n(l,f=Error),l);function l(t,e){var n=f.call(this,e)||this;return n.code=t,n.name="FirebaseError",Object.setPrototypeOf(n,l.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,w.prototype.create),n}var w=(b.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(r=i,s.replace(E,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new m(o,a),c=0,f=Object.keys(i);c<f.length;c++){var l=f[c];"_"!==l.slice(-1)&&(l in h&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),h[l]=i[l])}return h},b);function b(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g;function I(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var T,_="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},N=N||{},A=_||self;function S(){}function D(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function O(t){var e=D(t);return"array"==e||"object"==e&&"number"==typeof t.length}function x(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var P="closure_uid_"+(1e9*Math.random()>>>0),R=0;function k(t,e,n){return t.call.apply(t.bind,arguments)}function L(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function U(t,e,n){return(U=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?k:L).apply(null,arguments)}function C(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var V=Date.now||function(){return+new Date};function M(t,e){function n(){}n.prototype=e.prototype,t.M=e.prototype,t.prototype=new n,t.prototype.constructor=t}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.da=function(){!this.j&&(this.j=!0,this.C(),0)&&(Object.prototype.hasOwnProperty.call(this,P)&&this[P]||(this[P]=++R))},F.prototype.C=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var q=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},j=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function B(t){return Array.prototype.concat.apply([],arguments)}function G(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function Q(t){return/^[\s\xa0]*$/.test(t)}var z,H=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function W(t,e){return-1!=t.indexOf(e)}function K(t,e){return t<e?-1:e<t?1:0}t:{var X=A.navigator;if(X){var Y=X.userAgent;if(Y){z=Y;break t}}z=""}function $(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function J(t){var e={};for(var n in t)e[n]=t[n];return e}var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<Z.length;o++)n=Z[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function et(t){return et[" "](t),t}et[" "]=S;var nt,rt,it=W(z,"Opera"),ot=W(z,"Trident")||W(z,"MSIE"),st=W(z,"Edge"),ut=st||ot,at=W(z,"Gecko")&&!(W(z.toLowerCase(),"webkit")&&!W(z,"Edge"))&&!(W(z,"Trident")||W(z,"MSIE"))&&!W(z,"Edge"),ht=W(z.toLowerCase(),"webkit")&&!W(z,"Edge");function ct(){var t=A.document;return t?t.documentMode:void 0}t:{var ft="",lt=(rt=z,at?/rv:([^\);]+)(\)|;)/.exec(rt):st?/Edge\/([\d\.]+)/.exec(rt):ot?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(rt):ht?/WebKit\/(\S+)/.exec(rt):it?/(?:Version)[ \/]?(\S+)/.exec(rt):void 0);if(lt&&(ft=lt?lt[1]:""),ot){var pt=ct();if(null!=pt&&pt>parseFloat(ft)){nt=String(pt);break t}}nt=ft}var dt={};function yt(u){return t=u,e=function(){for(var t=0,e=H(String(nt)).split("."),n=H(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=K(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||K(0==o[2].length,0==s[2].length)||K(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=dt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var vt=A.document&&ot&&(ct()||parseInt(nt,10))||void 0,gt=!ot||9<=Number(vt),mt=ot&&!yt("9"),wt=function(){if(!A.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{A.addEventListener("test",S,e),A.removeEventListener("test",S,e)}catch(t){}return t}();function bt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function Et(t,e){if(bt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(at){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:It[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}bt.prototype.b=function(){this.defaultPrevented=!0},M(Et,bt);var It={2:"touch",3:"pen",4:"mouse"};Et.prototype.b=function(){Et.M.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,mt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Tt="closure_listenable_"+(1e6*Math.random()|0),_t=0;function Nt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.aa=i,this.key=++_t,this.V=this.X=!1}function At(t){t.V=!0,t.listener=null,t.proxy=null,t.src=null,t.aa=null}function St(t){this.src=t,this.a={},this.b=0}function Dt(t,e){var n,r,i,o=e.type;o in t.a&&(r=t.a[o],(n=0<=(i=q(r,e)))&&Array.prototype.splice.call(r,i,1),n&&(At(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Ot(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.V&&o.listener==e&&o.capture==!!n&&o.aa==r)return i}return-1}St.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Ot(t,e,r,i);return-1<s?(e=t[s],n||(e.X=!1)):((e=new Nt(e,this.src,o,!!r,i)).X=n,t.push(e)),e};var xt="closure_lm_"+(1e6*Math.random()|0),Pt={};function Rt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=qt(r),e&&e[Tt]?e.sa(n,r,x(i)?!!i.capture:!!i,o):kt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Rt(t,e[o],n,r,i);return null}return n=qt(n),t&&t[Tt]?t.ra(e,n,x(r)?!!r.capture:!!r,i):kt(t,e,n,!1,r,i)}function kt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=x(i)?!!i.capture:!!i;if(s&&!gt)return null;var u,a,h=Mt(t);if(h||(t[xt]=h=new St(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Vt,r=a=gt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)wt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ut(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Lt(t){var e,n,r;"number"!=typeof t&&t&&!t.V&&((e=t.src)&&e[Tt]?Dt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ut(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Mt(e))?(Dt(n,t),0==n.b&&(n.src=null,e[xt]=null)):At(t)))}function Ut(t){return t in Pt?Pt[t]:Pt[t]="on"+t}function Ct(t,e){var n=t.listener,r=t.aa||t.src;return t.X&&Lt(t),n.call(r,e)}function Vt(t,e){if(t.V)return!0;if(gt)return Ct(t,new Et(e,this));if(!e)t:{e=["window","event"];for(var n=A,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ct(t,e=new Et(e,this))}function Mt(t){return(t=t[xt])instanceof St?t:null}var Ft="__closure_events_fn_"+(1e9*Math.random()>>>0);function qt(e){return"function"==D(e)?e:(e[Ft]||(e[Ft]=function(t){return e.handleEvent(t)}),e[Ft])}function jt(){F.call(this),this.c=new St(this),(this.J=this).A=null}function Bt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.V&&a.capture==n&&(s=a.listener,u=a.aa||a.src,a.X&&Dt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}M(jt,F),jt.prototype[Tt]=!0,(T=jt.prototype).addEventListener=function(t,e,n,r){Rt(this,t,e,n,r)},T.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=x(i)?!!i.capture:!!i,r=qt(r),e&&e[Tt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Ot(s=e.a[n],r,i,o))&&(At(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Mt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Ot(n,r,i,o)),(r=-1<e?n[e]:null)&&Lt(r))}(this,t,e,n,r)},T.dispatchEvent=function(t){var e,n=this.A;if(n)for(e=[];n;n=n.A)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new bt(t,n):t instanceof bt?t.target=t.target||n:(s=t,tt(t=new bt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=Bt(o,r,!0,t)&&s;if(s=Bt(o=t.a=n,r,!0,t)&&s,s=Bt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=Bt(o=t.a=e[i],r,!1,t)&&s;return s},T.C=function(){if(jt.M.C.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)At(n[r]);delete e.a[t],e.b--}}this.A=null},T.ra=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},T.sa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Gt=A.JSON.stringify;function Qt(){this.b=this.a=null}var zt,Ht=(Wt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Wt(function(){return new Kt},function(t){t.reset()},100));function Wt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Kt(){this.next=this.b=this.a=null}function Xt(t){A.setTimeout(function(){throw t},0)}function Yt(t,e){var n;zt||(n=A.Promise.resolve(void 0),zt=function(){n.then(Zt)}),$t||(zt(),$t=!0),Jt.add(t,e)}Qt.prototype.add=function(t,e){var n=Ht.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Kt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var $t=!(Kt.prototype.reset=function(){this.next=this.b=this.a=null}),Jt=new Qt;function Zt(){for(var t,e,n;n=e=void 0,n=null,(e=Jt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){Xt(t)}var r=Ht;r.g(t),r.b<r.f&&(r.b++,t.next=r.a,r.a=t)}$t=!1}function te(t,e){jt.call(this),this.b=t||1,this.a=e||A,this.f=U(this.Ua,this),this.g=V()}function ee(t){t.Z=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function ne(t,e,n){if("function"==D(t))n&&(t=U(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=U(t.handleEvent,t)}return 2147483647<Number(e)?-1:A.setTimeout(t,e||0)}function re(t,e,n){F.call(this),this.f=null!=n?U(t,n):t,this.c=e,this.b=U(this.Pa,this),this.a=[]}function ie(t){t.T=ne(t.b,t.c),t.f.apply(null,t.a)}function oe(t){F.call(this),this.b=t,this.a={}}M(te,jt),(T=te.prototype).Z=!1,T.L=null,T.Ua=function(){var t;this.Z&&(0<(t=V()-this.g)&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.Z&&(ee(this),this.start())))},T.start=function(){this.Z=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=V())},T.C=function(){te.M.C.call(this),ee(this),delete this.a},M(re,F),(T=re.prototype).ba=!1,T.T=null,T.Ia=function(t){this.a=arguments,this.T?this.ba=!0:ie(this)},T.C=function(){re.M.C.call(this),this.T&&(A.clearTimeout(this.T),this.T=null,this.ba=!1,this.a=[])},T.Pa=function(){this.T=null,this.ba&&(this.ba=!1,ie(this))},M(oe,F);var se=[];function ue(t,e,n,r){Array.isArray(n)||(n&&(se[0]=n.toString()),n=se);for(var i=0;i<n.length;i++){var o=Rt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ae(t){$(t.a,function(t,e){this.a.hasOwnProperty(e)&&Lt(t)},t),t.a={}}function he(){}oe.prototype.C=function(){oe.M.C.call(this),ae(this)},oe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ce=null;function fe(){return ce=ce||new jt}function le(t){bt.call(this,"serverreachability",t)}function pe(){var t=fe();t.dispatchEvent(new le(t))}function de(t){bt.call(this,"statevent",t)}function ye(){var t=fe();t.dispatchEvent(new de(t))}function ve(t){bt.call(this,"timingevent",t)}function ge(t,e){if("function"!=D(t))throw Error("Fn must not be null and must be a function");return A.setTimeout(function(){t()},e)}M(le,bt),M(de,bt),M(ve,bt);var me={NO_ERROR:0,Va:1,bb:2,ab:3,Ya:4,$a:5,cb:6,za:7,TIMEOUT:8,gb:9},we={Xa:"complete",kb:"success",Aa:"error",za:"abort",ib:"ready",jb:"readystatechange",TIMEOUT:"timeout",eb:"incrementaldata",hb:"progress",Za:"downloadprogress",lb:"uploadprogress"};function be(){}function Ee(t){var e;return(e=t.a)||(e=t.a={}),e}function Ie(){}be.prototype.a=null;var Te,_e={OPEN:"a",Wa:"b",Aa:"c",fb:"d"};function Ne(){bt.call(this,"d")}function Ae(){bt.call(this,"c")}function Se(){}function De(t,e,n){this.g=t,this.W=e,this.U=n||1,this.G=new oe(this),this.N=Oe,t=ut?125:void 0,this.O=new te(t),this.m=null,this.b=!1,this.j=this.A=this.f=this.B=this.s=this.P=this.h=null,this.i=[],this.a=null,this.w=0,this.c=this.v=null,this.H=-1,this.l=!1,this.J=0,this.D=null,this.o=this.R=this.F=!1}M(Ne,bt),M(Ae,bt),M(Se,be),Te=new Se;var Oe=45e3,xe={},Pe={};function Re(t,e,n){t.B=1,t.f=Ze(We(e)),t.j=n,t.F=!0,ke(t,null)}function ke(t,e){t.s=V(),Ue(t),t.A=We(t.f);var n=t.A,r=t.U;Array.isArray(r)||(r=[String(r)]),pn(n.b,"t",r),t.w=0,t.a=ir(t.g,t.g.w?e:null),0<t.J&&(t.D=new re(U(t.ya,t,t.a),t.J)),ue(t.G,t.a,"readystatechange",t.Sa),e=t.m?J(t.m):{},t.j?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.$(t.A,t.v,t.j,e)):(t.v="GET",t.a.$(t.A,t.v,null,e)),pe()}function Le(t,e,n){for(var r,i,o,s,u=!0;!t.l&&t.w<n.length;){var a=(i=n,s=o=void 0,o=(r=t).w,-1==(s=i.indexOf("\n",o))?Pe:(o=Number(i.substring(o,s)),isNaN(o)?xe:(s+=1)+o>i.length?Pe:(i=i.substr(s,o),r.w=s+o,i)));if(a==Pe){4==e&&(t.c=4,ye(),u=!1);break}if(a==xe){t.c=4,ye(),u=!1;break}qe(t,a)}4==e&&0==n.length&&(t.c=1,ye(),u=!1),t.b=t.b&&u,u||(Fe(t),Me(t))}function Ue(t){t.P=V()+t.N,Ce(t,t.N)}function Ce(t,e){if(null!=t.h)throw Error("WatchDog timer not null");t.h=ge(U(t.Qa,t),e)}function Ve(t){t.h&&(A.clearTimeout(t.h),t.h=null)}function Me(t){0==t.g.u||t.l||Zn(t.g,t)}function Fe(t){Ve(t);var e=t.D;e&&"function"==typeof e.da&&e.da(),t.D=null,ee(t.O),ae(t.G),t.a&&(e=t.a,t.a=null,e.abort(),e.da())}function qe(t,e){try{var n,r,i,o,s,u,a,h,c,f,l=t.g;if(0!=l.u&&(l.a==t||bn(l.b,t)))if(l.A=t.H,!t.o&&bn(l.b,t)&&3==l.u){try{var p=l.ja.a.parse(e)}catch(t){p=null}if(Array.isArray(p)&&3==p.length){var d=p;if(0==d[0]){t:if(!l.i){if(l.a){if(!(l.a.s+3e3<t.s))break t;Jn(l),l.a.cancel(),l.a=null}$n(l),ye()}}else l.ia=d[1],0<l.ia-l.G&&d[2]<37500&&l.U&&0==l.m&&!l.l&&(l.l=ge(U(l.Na,l),6e3));if(wn(l.b)<=1&&l.O){try{l.O()}catch(t){}l.O=void 0}}else er(l,11)}else if(!t.o&&l.a!=t||Jn(l),!Q(e))for(e=p=l.ja.a.parse(e),p=0;p<e.length;p++){d=e[p],l.G=d[0],d=d[1],2==l.u?"c"==d[0]?(l.B=d[1],l.R=d[2],null!=(n=d[3])&&(l.oa=n),null!=(r=d[5])&&"number"==typeof r&&0<r&&(l.D=1.5*r),i=l,(o=t.a)&&(!(s=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(u=i.b).a&&(W(s,"spdy")||W(s,"quic")||W(s,"h2"))&&(u.f=u.g,u.a=new Set,u.b&&(En(u,u.b),u.b=null)),!i.s||(a=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(i.ha=a,Je(i.v,i.s,a))),l.u=3,l.c&&l.c.na(),h=t,(i=l).ea=rr(i,i.w?i.R:null,i.P),h.o?(In(i.b,h),c=h,(f=i.D)&&c.setTimeout(f),c.h&&(Ve(c),Ue(c)),i.a=h):Yn(i),0<l.f.length&&Hn(l)):"stop"!=d[0]&&"close"!=d[0]||er(l,7):3==l.u&&("stop"==d[0]||"close"==d[0]?"stop"==d[0]?er(l,7):Gn(l):"noop"!=d[0]&&l.c&&l.c.ma(d),l.m=0)}pe()}catch(t){}}function je(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(O(t)||"string"==typeof t)j(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.I&&"function"==typeof t.I)n=void 0;else if(O(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.I&&"function"==typeof t.I)return t.I();if("string"==typeof t)return t.split("");if(O(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Be(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Be)for(n=t.K(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Ge(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Qe(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Qe(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Qe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(T=De.prototype).setTimeout=function(t){this.N=t},T.Sa=function(t){t=t.target;var e=this.D;e&&3==Fn(t)?e.Ia():this.ya(t)},T.ya=function(t){try{if(t==this.a)t:{var e=Fn(this.a),n=this.a.qa();this.a.S();if(!(e<3||3==e&&!ut&&!this.a.Y())){this.l||4!=e||7==n||pe(),Ve(this);var r=this.a.S();this.H=r;var i=this.a.Y();if(this.b=200==r){if(this.R&&!this.o){e:{if(this.a){var o,s=this.a;if((o=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Q(o)){var u=o;break e}}u=null}if(!u){this.b=!1,this.c=3,ye(),Fe(this),Me(this);break t}this.o=!0,qe(this,u)}this.F?(Le(this,e,i),ut&&this.b&&3==e&&(ue(this.G,this.O,"tick",this.Ra),this.O.start())):qe(this,i),4==e&&Fe(this),this.b&&!this.l&&(4==e?Zn(this.g,this):(this.b=!1,Ue(this)))}else 400==r&&0<i.indexOf("Unknown SID")?this.c=3:this.c=0,ye(),Fe(this),Me(this)}}}catch(t){}},T.Ra=function(){var t,e;this.a&&(t=Fn(this.a),e=this.a.Y(),this.w<e.length&&(Ve(this),Le(this,t,e),this.b&&4!=t&&Ue(this)))},T.cancel=function(){this.l=!0,Fe(this)},T.Qa=function(){this.h=null;var t=V();0<=t-this.P?(2!=this.B&&(pe(),ye()),Fe(this),this.c=2,Me(this)):Ce(this,this.P-t)},(T=Be.prototype).I=function(){Ge(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},T.K=function(){return Ge(this),this.a.concat()},T.get=function(t,e){return Qe(this.b,t)?this.b[t]:e},T.set=function(t,e){Qe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},T.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var ze=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function He(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof He?(this.a=void 0!==e?e:t.a,Ke(this,t.f),this.j=t.j,Xe(this,t.c),Ye(this,t.h),this.g=t.g,e=t.b,(n=new hn).c=e.c,e.a&&(n.a=new Be(e.a),n.b=e.b),$e(this,n),this.i=t.i):t&&(n=String(t).match(ze))?(this.a=!!e,Ke(this,n[1]||"",!0),this.j=tn(n[2]||""),Xe(this,n[3]||"",!0),Ye(this,n[4]),this.g=tn(n[5]||"",!0),$e(this,n[6]||"",!0),this.i=tn(n[7]||"")):(this.a=!!e,this.b=new hn(null,this.a))}function We(t){return new He(t)}function Ke(t,e,n){t.f=n?tn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Xe(t,e,n){t.c=n?tn(e,!0):e}function Ye(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function $e(t,e,n){var r,i;e instanceof hn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(cn(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(fn(this,e),pn(this,n,t))},r)),r.f=i):(n||(e=en(e,un)),t.b=new hn(e,t.a))}function Je(t,e,n){t.b.set(e,n)}function Ze(t){return Je(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^V()).toString(36)),t}function tn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function en(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,nn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function nn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}He.prototype.toString=function(){var t=[],e=this.f;e&&t.push(en(e,rn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(en(e,rn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(en(n,"/"==n.charAt(0)?sn:on,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",en(n,an)),t.join("")};var rn=/[#\/\?@]/g,on=/[#\?:]/g,sn=/[#\?]/g,un=/[#\?@]/g,an=/#/g;function hn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function cn(u){u.a||(u.a=new Be,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function fn(t,e){cn(t),e=dn(t,e),Qe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Qe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Ge(t)))}function ln(t,e){return cn(t),e=dn(t,e),Qe(t.a.b,e)}function pn(t,e,n){fn(t,e),0<n.length&&(t.c=null,t.a.set(dn(t,e),G(n)),t.b+=n.length)}function dn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function yn(t,e){this.b=t,this.a=e}function vn(t){this.g=t||gn,t=A.PerformanceNavigationTiming?0<(t=A.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(A.ca&&A.ca.ua&&A.ca.ua()&&A.ca.ua().mb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(T=hn.prototype).add=function(t,e){cn(this),this.c=null,t=dn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},T.forEach=function(n,r){cn(this),this.a.forEach(function(t,e){j(t,function(t){n.call(r,t,e,this)},this)},this)},T.K=function(){cn(this);for(var t=this.a.I(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},T.I=function(t){cn(this);var e=[];if("string"==typeof t)ln(this,t)&&(e=B(e,this.a.get(dn(this,t))));else{t=this.a.I();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},T.set=function(t,e){return cn(this),this.c=null,ln(this,t=dn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},T.get=function(t,e){return t&&0<(t=this.I(t)).length?String(t[0]):e},T.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.I(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var gn=10;function mn(t){return t.b||t.a&&t.a.size>=t.f}function wn(t){return t.b?1:t.a?t.a.size:0}function bn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function En(t,e){t.a?t.a.add(e):t.b=e}function In(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Tn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.i);if(null==t.a||0===t.a.size)return G(t.c);var r=t.c;try{for(var i=I(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.i)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function _n(){}function Nn(){this.a=new _n}function An(t,r,e){var i=e||"";try{je(t,function(t,e){var n=t;x(t)&&(n=Gt(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}function Sn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}vn.prototype.cancel=function(){var t,e;if(this.c=Tn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=I(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},_n.prototype.stringify=function(t){return A.JSON.stringify(t,void 0)},_n.prototype.parse=function(t){return A.JSON.parse(t,void 0)};var Dn=A.JSON.parse;function On(t){jt.call(this),this.headers=new Be,this.G=t||null,this.b=!1,this.s=this.a=null,this.D="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.H=xn,this.B=this.F=!1}M(On,jt);var xn="",Pn=/^https?$/i,Rn=["POST","PUT"];function kn(t){return"content-type"==t.toLowerCase()}function Ln(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Un(t),Vn(t)}function Un(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Cn(t){if(t.b&&void 0!==N&&(!t.s[1]||4!=Fn(t)||2!=t.S()))if(t.l&&4==Fn(t))ne(t.va,0,t);else if(t.dispatchEvent("readystatechange"),4==Fn(t)){t.b=!1;try{var e,n,r,i,o=t.S();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.D).match(ze)[1]||null)&&A.self&&A.self.location&&(i=(r=A.self.location.protocol).substr(0,r.length-1)),n=!Pn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Fn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.S()+"]",Un(t)}}finally{Vn(t)}}}function Vn(t,e){if(t.a){Mn(t);var n=t.a,r=t.s[0]?S:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Mn(t){t.a&&t.B&&(t.a.ontimeout=null),t.m&&(A.clearTimeout(t.m),t.m=null)}function Fn(t){return t.a?t.a.readyState:0}function qn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",$(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Je(t,e,n))}function jn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Bn(t){this.f=[],this.R=this.ea=this.v=this.P=this.a=this.ha=this.s=this.N=this.h=this.F=this.j=null,this.Fa=this.H=0,this.Ca=jn("failFast",!1,t),this.U=this.l=this.i=this.g=this.c=null,this.W=!0,this.A=this.ia=this.G=-1,this.J=this.m=this.o=0,this.Ba=jn("baseRetryDelayMs",5e3,t),this.Ga=jn("retryDelaySeedMs",1e4,t),this.Da=jn("forwardChannelMaxRetries",2,t),this.ga=jn("forwardChannelRequestTimeoutMs",2e4,t),this.Ea=t&&t.nb||void 0,this.D=void 0,this.w=t&&t.supportsCrossDomainXhr||!1,this.B="",this.b=new vn(t&&t.concurrentRequestLimit),this.ja=new Nn,this.fa=t&&t.fastHandshake||!1,t&&t.forceLongPolling&&(this.W=!1),this.O=void 0}function Gn(t){var e,n;Qn(t),3==t.u&&(e=t.H++,Je(n=We(t.v),"SID",t.B),Je(n,"RID",e),Je(n,"TYPE","terminate"),Kn(t,n),(e=new De(t,e,void 0)).B=2,e.f=Ze(We(n)),n=!1,A.navigator&&A.navigator.sendBeacon&&(n=A.navigator.sendBeacon(e.f.toString(),"")),!n&&A.Image&&((new Image).src=e.f,n=!0),n||(e.a=ir(e.g,null),e.a.$(e.f)),e.s=V(),Ue(e)),nr(t)}function Qn(t){t.a&&(t.a.cancel(),t.a=null),t.i&&(A.clearTimeout(t.i),t.i=null),Jn(t),t.b.cancel(),t.g&&("number"==typeof t.g&&A.clearTimeout(t.g),t.g=null)}function zn(t,e){t.f.push(new yn(t.Fa++,e)),3==t.u&&Hn(t)}function Hn(t){mn(t.b)||t.g||(t.g=!0,Yt(t.xa,t),t.o=0)}function Wn(t,e){var n=e?e.W:t.H++,r=We(t.v);Je(r,"SID",t.B),Je(r,"RID",n),Je(r,"AID",t.G),Kn(t,r),t.h&&t.j&&qn(r,t.h,t.j),n=new De(t,n,t.o+1),null===t.h&&(n.m=t.j),e&&(t.f=e.i.concat(t.f)),e=Xn(t,n,1e3),n.setTimeout(Math.round(.5*t.ga)+Math.round(.5*t.ga*Math.random())),En(t.b,n),Re(n,r,e)}function Kn(t,n){t.c&&je({},function(t,e){Je(n,e,t)})}function Xn(t,e,n){n=Math.min(t.f.length,n);var r=t.c?U(t.c.Ha,t.c,t):null;t:for(var i=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{An(c,s,"req"+h+"_")}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.f.splice(0,n),e.i=t,r}function Yn(t){t.a||t.i||(t.J=1,Yt(t.wa,t),t.m=0)}function $n(t){return!(t.a||t.i||3<=t.m)&&(t.J++,t.i=ge(U(t.wa,t),tr(t,t.m)),t.m++,1)}function Jn(t){null!=t.l&&(A.clearTimeout(t.l),t.l=null)}function Zn(t,e){var n,r=null;if(t.a==e){Jn(t),t.a=null;var i=2}else{if(!bn(t.b,e))return;r=e.i,In(t.b,e),i=1}if(t.A=e.H,0!=t.u)if(e.b){1==i?(r=e.j?e.j.length:0,e=V()-e.s,n=t.o,(i=fe()).dispatchEvent(new ve(i)),Hn(t)):Yn(t)}else if(3==(n=e.c)||0==n&&0<t.A||!(1==i&&function(t,e){if(!(wn(t.b)>=t.b.f-(t.g?1:0))){if(t.g)return t.f=e.i.concat(t.f),1;if(!(1==t.u||2==t.u||t.o>=(t.Ca?0:t.Da)))return t.g=ge(U(t.xa,t,e),tr(t,t.o)),t.o++,1}}(t,e)||2==i&&$n(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:er(t,5);break;case 4:er(t,10);break;case 3:er(t,6);break;default:er(t,2)}}function tr(t,e){var n=t.Ba+Math.floor(Math.random()*t.Ga);return t.c||(n*=2),n*e}function er(t,e){var n,r,i,o,s,u;2==e?(n=null,t.c&&(n=null),r=U(t.Ta,t),n||(n=new He("//www.google.com/images/cleardot.gif"),A.location&&"http"==A.location.protocol||Ke(n,"https"),Ze(n)),i=n.toString(),o=r,u=new he,A.Image?((s=new Image).onload=C(Sn,u,s,"TestLoadImage: loaded",!0,o),s.onerror=C(Sn,u,s,"TestLoadImage: error",!1,o),s.onabort=C(Sn,u,s,"TestLoadImage: abort",!1,o),s.ontimeout=C(Sn,u,s,"TestLoadImage: timeout",!1,o),A.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=i):o(!1)):ye(),t.u=0,t.c&&t.c.la(e),nr(t),Qn(t)}function nr(t){t.u=0,t.A=-1,t.c&&(0==Tn(t.b).length&&0==t.f.length||(t.b.c.length=0,G(t.f),t.f.length=0),t.c.ka())}function rr(t,e,n){var r,i,o,s,u,a,h,c=(r=n)instanceof He?We(r):new He(r,void 0);return""!=c.c?(e&&Xe(c,e+"."+c.c),Ye(c,c.h)):(o=(i=A.location).protocol,s=e?e+"."+i.hostname:i.hostname,u=+i.port,a=n,h=new He(null,void 0),o&&Ke(h,o),s&&Xe(h,s),u&&Ye(h,u),a&&(h.g=a),c=h),t.N&&$(t.N,function(t,e){Je(c,e,t)}),e=t.s,n=t.ha,e&&n&&Je(c,e,n),Je(c,"VER",t.oa),Kn(t,c),c}function ir(t,e){if(e&&!t.w)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new On(t.Ea)).F=t.w,e}function or(){}function sr(){if(ot&&!(10<=Number(vt)))throw Error("Environmental error: no available transport.")}function ur(t,e){jt.call(this),this.a=new Bn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.j=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.pa&&(t?t["X-WebChannel-Client-Profile"]=e.pa:t={"X-WebChannel-Client-Profile":e.pa}),this.a.F=t,(t=e&&e.httpHeadersOverwriteParam)&&!Q(t)&&(this.a.h=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Q(e)&&(this.a.s=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new cr(this)}function ar(t){Ne.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function hr(){Ae.call(this),this.status=1}function cr(t){this.a=t}(T=On.prototype).$=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.G?Ee(this.G):Ee(Te),this.a.onreadystatechange=U(this.va,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void Ln(this,t)}t=n||"";var i,o=new Be(this.headers);r&&je(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=kn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.K()),n=A.FormData&&t instanceof A.FormData,0<=q(Rn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.H&&(this.a.responseType=this.H),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Mn(this),0<this.o&&((this.B=(i=this.a,ot&&yt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=U(this.ta,this)):this.m=ne(this.ta,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Ln(this,t)}},T.ta=function(){void 0!==N&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},T.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Vn(this))},T.C=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Vn(this,!0)),On.M.C.call(this)},T.va=function(){this.j||(this.w||this.l||this.g?Cn(this):this.Oa())},T.Oa=function(){Cn(this)},T.S=function(){try{return 2<Fn(this)?this.a.status:-1}catch(t){return-1}},T.Y=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},T.Ja=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Dn(e)}},T.qa=function(){return this.h},T.Ma=function(){return"string"==typeof this.f?this.f:String(this.f)},(T=Bn.prototype).oa=8,T.u=1,T.xa=function(t){if(this.g)if(this.g=null,1==this.u){if(!t){this.H=Math.floor(1e5*Math.random()),t=this.H++;var e,n=new De(this,t,void 0),r=this.j;if(this.F&&(r?tt(r=J(r),this.F):r=this.F),null===this.h&&(n.m=r),this.fa)t:{for(var i=e=0;i<this.f.length;i++){var o=this.f[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.f.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Xn(this,n,e),Je(i=We(this.v),"RID",t),Je(i,"CVER",22),this.s&&Je(i,"X-HTTP-Session-Id",this.s),Kn(this,i),this.h&&r&&qn(i,this.h,r),En(this.b,n),this.fa?(Je(i,"$req",e),Je(i,"SID","null"),n.R=!0,Re(n,i,null)):Re(n,i,e),this.u=2}}else 3==this.u&&(t?Wn(this,t):0==this.f.length||mn(this.b)||Wn(this))},T.wa=function(){this.i=null,this.a=new De(this,"rpc",this.J),null===this.h&&(this.a.m=this.j),this.a.J=0;var t=We(this.ea);Je(t,"RID","rpc"),Je(t,"SID",this.B),Je(t,"CI",this.U?"0":"1"),Je(t,"AID",this.G),Kn(this,t),Je(t,"TYPE","xmlhttp"),this.h&&this.j&&qn(t,this.h,this.j),this.D&&this.a.setTimeout(this.D);var e=this.a,n=this.R;e.B=1,e.f=Ze(We(t)),e.j=null,e.F=!0,ke(e,n)},T.Na=function(){null!=this.l&&(this.l=null,this.a.cancel(),this.a=null,$n(this),ye())},T.Ta=function(t){ye()},(T=or.prototype).na=function(){},T.ma=function(){},T.la=function(){},T.ka=function(){},T.Ha=function(){},sr.prototype.a=function(t,e){return new ur(t,e)},M(ur,jt),(T=ur.prototype).addEventListener=function(t,e,n,r){ur.M.addEventListener.call(this,t,e,n,r)},T.removeEventListener=function(t,e,n,r){ur.M.removeEventListener.call(this,t,e,n,r)},T.Ka=function(){this.a.c=this.f,this.h&&(this.a.w=!0);var t=this.a,e=this.l,n=this.b||void 0;ye(),t.P=e,t.N=n||{},t.U=t.W,t.v=rr(t,null,t.P),Hn(t)},T.close=function(){Gn(this.a)},T.La=function(t){var e;"string"==typeof t?((e={}).__data__=t,zn(this.a,e)):this.g?((e={}).__data__=Gt(t),zn(this.a,e)):zn(this.a,t)},T.C=function(){this.a.c=null,delete this.f,Gn(this.a),delete this.a,ur.M.C.call(this)},M(ar,Ne),M(hr,Ae),M(cr,or),cr.prototype.na=function(){this.a.dispatchEvent("a")},cr.prototype.ma=function(t){this.a.dispatchEvent(new ar(t))},cr.prototype.la=function(t){this.a.dispatchEvent(new hr)},cr.prototype.ka=function(){this.a.dispatchEvent("b")},sr.prototype.createWebChannel=sr.prototype.a,ur.prototype.send=ur.prototype.La,ur.prototype.open=ur.prototype.Ka,ur.prototype.close=ur.prototype.close,me.NO_ERROR=0,me.TIMEOUT=8,me.HTTP_ERROR=6,we.COMPLETE="complete",(Ie.EventType=_e).OPEN="a",_e.CLOSE="b",_e.ERROR="c",_e.MESSAGE="d",jt.prototype.listen=jt.prototype.ra,On.prototype.listenOnce=On.prototype.sa,On.prototype.getLastError=On.prototype.Ma,On.prototype.getLastErrorCode=On.prototype.qa,On.prototype.getStatus=On.prototype.S,On.prototype.getResponseJson=On.prototype.Ja,On.prototype.getResponseText=On.prototype.Y,On.prototype.send=On.prototype.$;var fr={createWebChannelTransport:function(){return new sr},ErrorCode:me,EventType:we,WebChannel:Ie,XhrIo:On},lr=fr.createWebChannelTransport,pr=fr.ErrorCode,dr=fr.EventType,yr=fr.WebChannel,vr=fr.XhrIo,gr=(mr.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},mr.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},mr.prototype.setServiceProps=function(t){return this.serviceProps=t,this},mr);function mr(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var wr=Zp.SDK_VERSION,br=new h("@firebase/firestore");function Er(){return br.logLevel}function Ir(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];br.logLevel<=p.DEBUG&&(e=n.map(_r),br.debug.apply(br,d(["Firestore ("+wr+"): "+t],e)))}function Tr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];br.logLevel<=p.ERROR&&(e=n.map(_r),br.error.apply(br,d(["Firestore ("+wr+"): "+t],e)))}function _r(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Nr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+wr+") INTERNAL ASSERTION FAILED: "+t;throw Tr(e),new Error(e)}function Ar(t){t||Nr()}function Sr(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Dr=(Or.t=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Sr(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Or);function Or(){}function xr(t,e){return t<e?-1:e<t?1:0}function Pr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Rr(t){return t+"\0"}function kr(t,e,n,r,i){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var Lr=(Object.defineProperty(Ur.prototype,"i",{get:function(){return"(default)"===this.database},enumerable:!0,configurable:!0}),Ur.prototype.isEqual=function(t){return t instanceof Ur&&t.projectId===this.projectId&&t.database===this.database},Ur.prototype.o=function(t){return xr(this.projectId,t.projectId)||xr(this.database,t.database)},Ur);function Ur(t,e){this.projectId=t,this.database=e||"(default)"}function Cr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Vr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Mr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Fr,qr,jr=(Zr.prototype.get=function(t){var e=this.h(t),n=this.l[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],u=o[1];if(this.u(s,t))return u}},Zr.prototype.has=function(t){return void 0!==this.get(t)},Zr.prototype.set=function(t,e){var n=this.h(t),r=this.l[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.u(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.l[n]=[[t,e]]},Zr.prototype.delete=function(t){var e=this.h(t),n=this.l[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.u(n[r][0],t))return 1===n.length?delete this.l[e]:n.splice(r,1),!0;return!1},Zr.prototype.forEach=function(u){Vr(this.l,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];u(o,s)}})},Zr.prototype._=function(){return Mr(this.l)},Zr),Br={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Gr=(n(Jr,qr=Error),Jr),Qr=($r.now=function(){return $r.fromMillis(Date.now())},$r.fromDate=function(t){return $r.fromMillis(t.getTime())},$r.fromMillis=function(t){var e=Math.floor(t/1e3);return new $r(e,1e6*(t-1e3*e))},$r.prototype.toDate=function(){return new Date(this.toMillis())},$r.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},$r.prototype.T=function(t){return this.seconds===t.seconds?xr(this.nanoseconds,t.nanoseconds):xr(this.seconds,t.seconds)},$r.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},$r.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},$r.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},$r),zr=(Yr.I=function(t){return new Yr(t)},Yr.min=function(){return new Yr(new Qr(0,0))},Yr.prototype.o=function(t){return this.timestamp.T(t.timestamp)},Yr.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Yr.prototype.A=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Yr.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Yr.prototype.R=function(){return this.timestamp},Yr),Hr=(Object.defineProperty(Xr.prototype,"length",{get:function(){return this.m},enumerable:!0,configurable:!0}),Xr.prototype.isEqual=function(t){return 0===Xr.P(this,t)},Xr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof Xr?t.forEach(function(t){e.push(t)}):e.push(t),this.V(e)},Xr.prototype.limit=function(){return this.offset+this.length},Xr.prototype.g=function(t){return t=void 0===t?1:t,this.V(this.segments,this.offset+t,this.length-t)},Xr.prototype.p=function(){return this.V(this.segments,this.offset,this.length-1)},Xr.prototype.v=function(){return this.segments[this.offset]},Xr.prototype.S=function(){return this.get(this.length-1)},Xr.prototype.get=function(t){return this.segments[this.offset+t]},Xr.prototype._=function(){return 0===this.length},Xr.prototype.D=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Xr.prototype.C=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},Xr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},Xr.prototype.F=function(){return this.segments.slice(this.offset,this.limit())},Xr.P=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},Xr),Wr=(n(Kr,Fr=Hr),Kr.prototype.V=function(t,e,n){return new Kr(t,e,n)},Kr.prototype.N=function(){return this.F().join("/")},Kr.prototype.toString=function(){return this.N()},Kr.$=function(t){if(0<=t.indexOf("//"))throw new Gr(Br.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new Kr(t.split("/").filter(function(t){return 0<t.length}))},Kr);function Kr(){return null!==Fr&&Fr.apply(this,arguments)||this}function Xr(t,e,n){void 0===e?e=0:e>t.length&&Nr(),void 0===n?n=t.length-e:n>t.length-e&&Nr(),this.segments=t,this.offset=e,this.m=n}function Yr(t){this.timestamp=t}function $r(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Gr(Br.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Gr(Br.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Gr(Br.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Gr(Br.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Jr(t,e){var n=this;return(n=qr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Zr(t,e){this.h=t,this.u=e,this.l={}}Wr.k=new Wr([]);var ti,ei=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ni=(n(ri,ti=Hr),ri.prototype.V=function(t,e,n){return new ri(t,e,n)},ri.M=function(t){return ei.test(t)},ri.prototype.N=function(){return this.F().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),ri.M(t)||(t="`"+t+"`"),t}).join(".")},ri.prototype.toString=function(){return this.N()},ri.prototype.L=function(){return 1===this.length&&"__name__"===this.get(0)},ri.O=function(){return new ri(["__name__"])},ri.B=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Gr(Br.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Gr(Br.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Gr(Br.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Gr(Br.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ri(e)},ri);function ri(){return null!==ti&&ti.apply(this,arguments)||this}ni.k=new ni([]);var ii=(oi.q=function(t){return new oi(Wr.$(t).g(5))},oi.prototype.U=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},oi.prototype.isEqual=function(t){return null!==t&&0===Wr.P(this.path,t.path)},oi.prototype.toString=function(){return this.path.toString()},oi.P=function(t,e){return Wr.P(t.path,e.path)},oi.W=function(t){return t.length%2==0},oi.j=function(t){return new oi(new Wr(t.slice()))},oi);function oi(t){this.path=t}function si(t){return null==t}function ui(t){return-0===t&&1/t==-1/0}function ai(t){return"number"==typeof t&&Number.isInteger(t)&&!ui(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}ii.EMPTY=new ii(new Wr([]));var hi=(ci.fromBase64String=function(t){return new ci(atob(t))},ci.fromUint8Array=function(t){return new ci(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},ci.prototype.toBase64=function(){return t=this.K,btoa(t);var t},ci.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.K)},ci.prototype.G=function(){return 2*this.K.length},ci.prototype.o=function(t){return xr(this.K,t.K)},ci.prototype.isEqual=function(t){return this.K===t.K},ci);function ci(t){this.K=t}function fi(t){this.count=t}hi.H=new hi("");var li,pi,di=(yi.prototype.X=function(t){return new yi(this.target,this.targetId,this.Y,t,this.J,this.lastLimboFreeSnapshotVersion,this.resumeToken)},yi.prototype.Z=function(t,e){return new yi(this.target,this.targetId,this.Y,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},yi.prototype.tt=function(t){return new yi(this.target,this.targetId,this.Y,this.sequenceNumber,this.J,t,this.resumeToken)},yi);function yi(t,e,n,r,i,o,s){void 0===i&&(i=zr.min()),void 0===o&&(o=zr.min()),void 0===s&&(s=hi.H),this.target=t,this.targetId=e,this.Y=n,this.sequenceNumber=r,this.J=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function vi(t){switch(t){case Br.OK:return Nr();case Br.CANCELLED:case Br.UNKNOWN:case Br.DEADLINE_EXCEEDED:case Br.RESOURCE_EXHAUSTED:case Br.INTERNAL:case Br.UNAVAILABLE:case Br.UNAUTHENTICATED:return;case Br.INVALID_ARGUMENT:case Br.NOT_FOUND:case Br.ALREADY_EXISTS:case Br.PERMISSION_DENIED:case Br.FAILED_PRECONDITION:case Br.ABORTED:case Br.OUT_OF_RANGE:case Br.UNIMPLEMENTED:case Br.DATA_LOSS:return 1;default:return Nr()}}function gi(t){if(void 0===t)return Tr("GRPC error has no .code"),Br.UNKNOWN;switch(t){case li.OK:return Br.OK;case li.CANCELLED:return Br.CANCELLED;case li.UNKNOWN:return Br.UNKNOWN;case li.DEADLINE_EXCEEDED:return Br.DEADLINE_EXCEEDED;case li.RESOURCE_EXHAUSTED:return Br.RESOURCE_EXHAUSTED;case li.INTERNAL:return Br.INTERNAL;case li.UNAVAILABLE:return Br.UNAVAILABLE;case li.UNAUTHENTICATED:return Br.UNAUTHENTICATED;case li.INVALID_ARGUMENT:return Br.INVALID_ARGUMENT;case li.NOT_FOUND:return Br.NOT_FOUND;case li.ALREADY_EXISTS:return Br.ALREADY_EXISTS;case li.PERMISSION_DENIED:return Br.PERMISSION_DENIED;case li.FAILED_PRECONDITION:return Br.FAILED_PRECONDITION;case li.ABORTED:return Br.ABORTED;case li.OUT_OF_RANGE:return Br.OUT_OF_RANGE;case li.UNIMPLEMENTED:return Br.UNIMPLEMENTED;case li.DATA_LOSS:return Br.DATA_LOSS;default:return Nr()}}(pi=li=li||{})[pi.OK=0]="OK",pi[pi.CANCELLED=1]="CANCELLED",pi[pi.UNKNOWN=2]="UNKNOWN",pi[pi.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",pi[pi.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",pi[pi.NOT_FOUND=5]="NOT_FOUND",pi[pi.ALREADY_EXISTS=6]="ALREADY_EXISTS",pi[pi.PERMISSION_DENIED=7]="PERMISSION_DENIED",pi[pi.UNAUTHENTICATED=16]="UNAUTHENTICATED",pi[pi.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",pi[pi.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",pi[pi.ABORTED=10]="ABORTED",pi[pi.OUT_OF_RANGE=11]="OUT_OF_RANGE",pi[pi.UNIMPLEMENTED=12]="UNIMPLEMENTED",pi[pi.INTERNAL=13]="INTERNAL",pi[pi.UNAVAILABLE=14]="UNAVAILABLE",pi[pi.DATA_LOSS=15]="DATA_LOSS";var mi=(Ti.prototype.et=function(t,e){return new Ti(this.P,this.root.et(t,e,this.P).st(null,null,bi.nt,null,null))},Ti.prototype.remove=function(t){return new Ti(this.P,this.root.remove(t,this.P).st(null,null,bi.nt,null,null))},Ti.prototype.get=function(t){for(var e=this.root;!e._();){var n=this.P(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Ti.prototype.indexOf=function(t){for(var e=0,n=this.root;!n._();){var r=this.P(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Ti.prototype._=function(){return this.root._()},Object.defineProperty(Ti.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),Ti.prototype.it=function(){return this.root.it()},Ti.prototype.rt=function(){return this.root.rt()},Ti.prototype.ot=function(t){return this.root.ot(t)},Ti.prototype.forEach=function(n){this.ot(function(t,e){return n(t,e),!1})},Ti.prototype.toString=function(){var n=[];return this.ot(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Ti.prototype.ht=function(t){return this.root.ht(t)},Ti.prototype.at=function(){return new wi(this.root,null,this.P,!1)},Ti.prototype.ut=function(t){return new wi(this.root,t,this.P,!1)},Ti.prototype.ct=function(){return new wi(this.root,null,this.P,!0)},Ti.prototype.lt=function(t){return new wi(this.root,t,this.P,!0)},Ti),wi=(Ii.prototype.dt=function(){var t=this.ft.pop(),e={key:t.key,value:t.value};if(this._t)for(t=t.left;!t._();)this.ft.push(t),t=t.right;else for(t=t.right;!t._();)this.ft.push(t),t=t.left;return e},Ii.prototype.wt=function(){return 0<this.ft.length},Ii.prototype.Tt=function(){if(0===this.ft.length)return null;var t=this.ft[this.ft.length-1];return{key:t.key,value:t.value}},Ii),bi=(Ei.prototype.st=function(t,e,n,r,i){return new Ei(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ei.prototype._=function(){return!1},Ei.prototype.ot=function(t){return this.left.ot(t)||t(this.key,this.value)||this.right.ot(t)},Ei.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},Ei.prototype.min=function(){return this.left._()?this:this.left.min()},Ei.prototype.it=function(){return this.min().key},Ei.prototype.rt=function(){return this.right._()?this.key:this.right.rt()},Ei.prototype.et=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.st(null,null,null,r.left.et(t,e,n),null):0===i?r.st(null,e,null,null,null):r.st(null,null,null,null,r.right.et(t,e,n))).Et()},Ei.prototype.It=function(){if(this.left._())return Ei.EMPTY;var t=this;return t.left.At()||t.left.left.At()||(t=t.Rt()),(t=t.st(null,null,null,t.left.It(),null)).Et()},Ei.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left._()||r.left.At()||r.left.left.At()||(r=r.Rt()),r=r.st(null,null,null,r.left.remove(t,e),null);else{if(r.left.At()&&(r=r.Pt()),r.right._()||r.right.At()||r.right.left.At()||(r=r.Vt()),0===e(t,r.key)){if(r.right._())return Ei.EMPTY;n=r.right.min(),r=r.st(n.key,n.value,null,null,r.right.It())}r=r.st(null,null,null,null,r.right.remove(t,e))}return r.Et()},Ei.prototype.At=function(){return this.color},Ei.prototype.Et=function(){var t=this;return t.right.At()&&!t.left.At()&&(t=t.gt()),t.left.At()&&t.left.left.At()&&(t=t.Pt()),t.left.At()&&t.right.At()&&(t=t.pt()),t},Ei.prototype.Rt=function(){var t=this.pt();return t.right.left.At()&&(t=(t=(t=t.st(null,null,null,null,t.right.Pt())).gt()).pt()),t},Ei.prototype.Vt=function(){var t=this.pt();return t.left.left.At()&&(t=(t=t.Pt()).pt()),t},Ei.prototype.gt=function(){var t=this.st(null,null,Ei.RED,null,this.right.left);return this.right.st(null,null,this.color,t,null)},Ei.prototype.Pt=function(){var t=this.st(null,null,Ei.RED,this.left.right,null);return this.left.st(null,null,this.color,null,t)},Ei.prototype.pt=function(){var t=this.left.st(null,null,!this.left.color,null,null),e=this.right.st(null,null,!this.right.color,null,null);return this.st(null,null,!this.color,t,e)},Ei.prototype.yt=function(){var t=this.bt();return Math.pow(2,t)<=this.size+1},Ei.prototype.bt=function(){if(this.At()&&this.left.At())throw Nr();if(this.right.At())throw Nr();var t=this.left.bt();if(t!==this.right.bt())throw Nr();return t+(this.At()?0:1)},Ei);function Ei(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Ei.RED,this.left=null!=r?r:Ei.EMPTY,this.right=null!=i?i:Ei.EMPTY,this.size=this.left.size+1+this.right.size}function Ii(t,e,n,r){this._t=r,this.ft=[];for(var i=1;!t._();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this._t?t.left:t.right;else{if(0===i){this.ft.push(t);break}this.ft.push(t),t=this._t?t.right:t.left}}function Ti(t,e){this.P=t,this.root=e||bi.EMPTY}function _i(){this.size=0}bi.EMPTY=null,bi.RED=!0,bi.nt=!1,bi.EMPTY=(Object.defineProperty(_i.prototype,"key",{get:function(){throw Nr()},enumerable:!0,configurable:!0}),Object.defineProperty(_i.prototype,"value",{get:function(){throw Nr()},enumerable:!0,configurable:!0}),Object.defineProperty(_i.prototype,"color",{get:function(){throw Nr()},enumerable:!0,configurable:!0}),Object.defineProperty(_i.prototype,"left",{get:function(){throw Nr()},enumerable:!0,configurable:!0}),Object.defineProperty(_i.prototype,"right",{get:function(){throw Nr()},enumerable:!0,configurable:!0}),_i.prototype.st=function(t,e,n,r,i){return this},_i.prototype.et=function(t,e,n){return new bi(t,e)},_i.prototype.remove=function(t,e){return this},_i.prototype._=function(){return!0},_i.prototype.ot=function(t){return!1},_i.prototype.ht=function(t){return!1},_i.prototype.it=function(){return null},_i.prototype.rt=function(){return null},_i.prototype.At=function(){return!1},_i.prototype.yt=function(){return!0},_i.prototype.bt=function(){return 0},new _i);var Ni=(Oi.prototype.has=function(t){return null!==this.data.get(t)},Oi.prototype.first=function(){return this.data.it()},Oi.prototype.last=function(){return this.data.rt()},Object.defineProperty(Oi.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),Oi.prototype.indexOf=function(t){return this.data.indexOf(t)},Oi.prototype.forEach=function(n){this.data.ot(function(t,e){return n(t),!1})},Oi.prototype.vt=function(t,e){for(var n=this.data.ut(t[0]);n.wt();){var r=n.dt();if(0<=this.P(r.key,t[1]))return;e(r.key)}},Oi.prototype.St=function(t,e){for(var n=void 0!==e?this.data.ut(e):this.data.at();n.wt();)if(!t(n.dt().key))return},Oi.prototype.Dt=function(t){var e=this.data.ut(t);return e.wt()?e.dt().key:null},Oi.prototype.at=function(){return new Ai(this.data.at())},Oi.prototype.ut=function(t){return new Ai(this.data.ut(t))},Oi.prototype.add=function(t){return this.st(this.data.remove(t).et(t,!0))},Oi.prototype.delete=function(t){return this.has(t)?this.st(this.data.remove(t)):this},Oi.prototype._=function(){return this.data._()},Oi.prototype.Ct=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Oi.prototype.isEqual=function(t){if(!(t instanceof Oi))return!1;if(this.size!==t.size)return!1;for(var e=this.data.at(),n=t.data.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(0!==this.P(r,i))return!1}return!0},Oi.prototype.F=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Oi.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Oi.prototype.st=function(t){var e=new Oi(this.P);return e.data=t,e},Oi),Ai=(Di.prototype.dt=function(){return this.Ft.dt().key},Di.prototype.wt=function(){return this.Ft.wt()},Di),Si=new mi(ii.P);function Di(t){this.Ft=t}function Oi(t){this.P=t,this.data=new mi(this.P)}var xi=new mi(ii.P);var Pi=new mi(ii.P),Ri=new Ni(ii.P);function ki(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Ri,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var Li=new Ni(xr);function Ui(t,e,n,r){this.Zt=t,this.removedTargetIds=e,this.key=n,this.te=r}function Ci(t,e){this.targetId=t,this.ee=e}function Vi(t,e,n,r){void 0===n&&(n=hi.H),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}var Mi=($i.kt=function(t){return new $i(t.P)},$i.prototype.has=function(t){return null!=this.Nt.get(t)},$i.prototype.get=function(t){return this.Nt.get(t)},$i.prototype.first=function(){return this.$t.it()},$i.prototype.last=function(){return this.$t.rt()},$i.prototype._=function(){return this.$t._()},$i.prototype.indexOf=function(t){var e=this.Nt.get(t);return e?this.$t.indexOf(e):-1},Object.defineProperty($i.prototype,"size",{get:function(){return this.$t.size},enumerable:!0,configurable:!0}),$i.prototype.forEach=function(n){this.$t.ot(function(t,e){return n(t),!1})},$i.prototype.add=function(t){var e=this.delete(t.key);return e.st(e.Nt.et(t.key,t),e.$t.et(t,null))},$i.prototype.delete=function(t){var e=this.get(t);return e?this.st(this.Nt.remove(t),this.$t.remove(e)):this},$i.prototype.isEqual=function(t){if(!(t instanceof $i))return!1;if(this.size!==t.size)return!1;for(var e=this.$t.at(),n=t.$t.at();e.wt();){var r=e.dt().key,i=n.dt().key;if(!r.isEqual(i))return!1}return!0},$i.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},$i.prototype.st=function(t,e){var n=new $i;return n.P=this.P,n.Nt=t,n.$t=e,n},$i),Fi=(Yi.prototype.track=function(t){var e=t.doc.key,n=this.xt.get(e);!n||0!==t.type&&3===n.type?this.xt=this.xt.et(e,t):3===t.type&&1!==n.type?this.xt=this.xt.et(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.xt=this.xt.et(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.xt=this.xt.et(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.xt=this.xt.remove(e):1===t.type&&2===n.type?this.xt=this.xt.et(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.xt=this.xt.et(e,{type:2,doc:t.doc}):Nr()},Yi.prototype.Mt=function(){var n=[];return this.xt.ot(function(t,e){n.push(e)}),n},Yi),qi=(Xi.Ut=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Xi(t,e,Mi.kt(e),i,n,r,!0,!1)},Object.defineProperty(Xi.prototype,"hasPendingWrites",{get:function(){return!this.Ot._()},enumerable:!0,configurable:!0}),Xi.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Bt===t.Bt&&this.Ot.isEqual(t.Ot)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.Lt.isEqual(t.Lt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Xi),ji=(Ki.Gt=function(t,e){var n=new Map;return n.set(t,Bi.zt(t,e)),new Ki(zr.min(),n,Li,Si,ki())},Ki),Bi=(Wi.zt=function(t,e){return new Wi(hi.H,e,ki(),ki(),ki())},Wi),Gi=(Object.defineProperty(Hi.prototype,"Ht",{get:function(){return this.re},enumerable:!0,configurable:!0}),Object.defineProperty(Hi.prototype,"resumeToken",{get:function(){return this.ie},enumerable:!0,configurable:!0}),Object.defineProperty(Hi.prototype,"he",{get:function(){return 0!==this.se},enumerable:!0,configurable:!0}),Object.defineProperty(Hi.prototype,"ae",{get:function(){return this.oe},enumerable:!0,configurable:!0}),Hi.prototype.ue=function(t){0<t.G()&&(this.oe=!0,this.ie=t)},Hi.prototype.ce=function(){var n=ki(),r=ki(),i=ki();return this.ne.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Nr()}}),new Bi(this.ie,this.re,n,r,i)},Hi.prototype.le=function(){this.oe=!1,this.ne=Zi()},Hi.prototype._e=function(t,e){this.oe=!0,this.ne=this.ne.et(t,e)},Hi.prototype.fe=function(t){this.oe=!0,this.ne=this.ne.remove(t)},Hi.prototype.de=function(){this.se+=1},Hi.prototype.we=function(){--this.se},Hi.prototype.Te=function(){this.oe=!0,this.re=!0},Hi),Qi=(zi.prototype.Pe=function(t){for(var e=0,n=t.Zt;e<n.length;e++){var r=n[e];t.te instanceof qs?this.Ve(r,t.te):t.te instanceof js&&this.ge(r,t.key,t.te)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.ge(s,t.key,t.te)}},zi.prototype.pe=function(n){var r=this;this.ye(n,function(t){var e=r.be(t);switch(n.state){case 0:r.ve(t)&&e.ue(n.resumeToken);break;case 1:e.we(),e.he||e.le(),e.ue(n.resumeToken);break;case 2:e.we(),e.he||r.removeTarget(t);break;case 3:r.ve(t)&&(e.Te(),e.ue(n.resumeToken));break;case 4:r.ve(t)&&(r.Se(t),e.ue(n.resumeToken));break;default:Nr()}})},zi.prototype.ye=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Ie.forEach(function(t,e){r.ve(e)&&n(e)})},zi.prototype.De=function(t){var e,n,r=t.targetId,i=t.ee.count,o=this.Ce(r);o&&(mu(e=o.target)?0===i?(n=new ii(e.path),this.ge(r,n,new js(n,zr.min()))):Ar(1===i):this.Fe(r)!==i&&(this.Se(r),this.me=this.me.add(r)))},zi.prototype.Ne=function(i){var o=this,s=new Map;this.Ie.forEach(function(t,e){var n,r=o.Ce(e);r&&(t.Ht&&mu(r.target)&&(n=new ii(r.target.path),null!==o.Ae.get(n)||o.$e(e,n)||o.ge(e,n,new js(n,i))),t.ae&&(s.set(e,t.ce()),t.le()))});var r=ki();this.Re.forEach(function(t,e){var n=!0;e.St(function(t){var e=o.Ce(t);return!e||2===e.Y||(n=!1)}),n&&(r=r.add(t))});var t=new ji(i,s,this.me,this.Ae,r);return this.Ae=Si,this.Re=Ji(),this.me=new Ni(xr),t},zi.prototype.Ve=function(t,e){var n;this.ve(t)&&(n=this.$e(t,e.key)?2:0,this.be(t)._e(e.key,n),this.Ae=this.Ae.et(e.key,e),this.Re=this.Re.et(e.key,this.ke(e.key).add(t)))},zi.prototype.ge=function(t,e,n){var r;this.ve(t)&&(r=this.be(t),this.$e(t,e)?r._e(e,1):r.fe(e),this.Re=this.Re.et(e,this.ke(e).delete(t)),n&&(this.Ae=this.Ae.et(e,n)))},zi.prototype.removeTarget=function(t){this.Ie.delete(t)},zi.prototype.Fe=function(t){var e=this.be(t).ce();return this.Ee.xe(t).size+e.Yt.size-e.Xt.size},zi.prototype.de=function(t){this.be(t).de()},zi.prototype.be=function(t){var e=this.Ie.get(t);return e||(e=new Gi,this.Ie.set(t,e)),e},zi.prototype.ke=function(t){var e=this.Re.get(t);return e||(e=new Ni(xr),this.Re=this.Re.et(t,e)),e},zi.prototype.ve=function(t){var e=null!==this.Ce(t);return e||Ir("WatchChangeAggregator","Detected inactive target",t),e},zi.prototype.Ce=function(t){var e=this.Ie.get(t);return e&&e.he?null:this.Ee.Me(t)},zi.prototype.Se=function(e){var n=this;this.Ie.set(e,new Gi),this.Ee.xe(e).forEach(function(t){n.ge(e,t,null)})},zi.prototype.$e=function(t,e){return this.Ee.xe(t).has(e)},zi);function zi(t){this.Ee=t,this.Ie=new Map,this.Ae=Si,this.Re=Ji(),this.me=new Ni(xr)}function Hi(){this.se=0,this.ne=Zi(),this.ie=hi.H,this.re=!1,this.oe=!0}function Wi(t,e,n,r,i){this.resumeToken=t,this.Ht=e,this.Yt=n,this.Jt=r,this.Xt=i}function Ki(t,e,n,r,i){this.J=t,this.Qt=e,this.Wt=n,this.jt=r,this.Kt=i}function Xi(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Lt=n,this.docChanges=r,this.Ot=i,this.fromCache=o,this.Bt=s,this.qt=u}function Yi(){this.xt=new mi(ii.P)}function $i(n){this.P=n?function(t,e){return n(t,e)||ii.P(t.key,e.key)}:function(t,e){return ii.P(t.key,e.key)},this.Nt=xi,this.$t=new mi(this.P)}function Ji(){return new mi(ii.P)}function Zi(){return new mi(ii.P)}function to(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function eo(t){var e=ho(t.mapValue.fields.__local_write_time__.timestampValue);return new Qr(e.seconds,e.nanos)}var no=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ro(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?to(t)?4:10:Nr()}function io(r,i){var t,e,n,o=ro(r);if(o!==ro(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return eo(r).isEqual(eo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=ho(r.timestampValue),n=ho(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return n=i,fo(r.bytesValue).isEqual(fo(n.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return e=i,co((t=r).geoPointValue.latitude)===co(e.geoPointValue.latitude)&&co(t.geoPointValue.longitude)===co(e.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return co(t.integerValue)===co(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=co(t.doubleValue),r=co(e.doubleValue);return n===r?ui(n)===ui(r):isNaN(n)&&isNaN(r)}return!1}(r,i);case 9:return Pr(r.arrayValue.values||[],i.arrayValue.values||[],io);case 10:return function(){var t=r.mapValue.fields||{},e=i.mapValue.fields||{};if(Cr(t)!==Cr(e))return!1;for(var n in t)if(t.hasOwnProperty(n)&&(void 0===e[n]||!io(t[n],e[n])))return!1;return!0}();default:return Nr()}}function oo(t,e){return void 0!==(t.values||[]).find(function(t){return io(t,e)})}function so(t,e){var n,r,i,o,s,u,a,h,c,f,l=ro(t),p=ro(e);if(l!==p)return xr(l,p);switch(l){case 0:return 0;case 1:return xr(t.booleanValue,e.booleanValue);case 2:return h=e,(c=co(t.integerValue||t.doubleValue))<(f=co(h.integerValue||h.doubleValue))?-1:f<c?1:c===f?0:isNaN(c)?isNaN(f)?0:-1:1;case 3:return uo(t.timestampValue,e.timestampValue);case 4:return uo(eo(t),eo(e));case 5:return xr(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=fo(o),a=fo(s),u.o(a);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=xr(n[i],r[i]);if(0!==o)return o}return xr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,r=e.geoPointValue,0!==(i=xr(co(n.latitude),co(r.latitude)))?i:xr(co(n.longitude),co(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=so(n[i],r[i]);if(o)return o}return xr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=xr(r[s],o[s]);if(0!==u)return u;var a=so(n[r[s]],i[o[s]]);if(0!==a)return a}return xr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Nr()}}function uo(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return xr(t,e);var n=ho(t),r=ho(e),i=xr(n.seconds,r.seconds);return 0!==i?i:xr(n.nanos,r.nanos)}function ao(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=ho(i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?fo(i.bytesValue).toBase64():"referenceValue"in i?(n=i.referenceValue,ii.q(n).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Nr();var t,e,n}(t)}function ho(t){if(Ar(!!t),"string"!=typeof t)return{seconds:co(t.seconds),nanos:co(t.nanos)};var e,n=0,r=no.exec(t);Ar(!!r),r[1]&&(e=((e=r[1])+"000000000").substr(0,9),n=Number(e));var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:n}}function co(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function fo(t){return"string"==typeof t?hi.fromBase64String(t):hi.fromUint8Array(t)}function lo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.N()}}function po(t){return t&&"integerValue"in t}function yo(t){return!!t&&"arrayValue"in t}function vo(t){return t&&"nullValue"in t}function go(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function mo(t){return t&&"mapValue"in t}var wo={asc:"ASCENDING",desc:"DESCENDING"},bo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Eo=function(t,e){this.s=t,this.Le=e};function Io(t){return{integerValue:""+t}}function To(t,e){if(t.Le){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ui(e)?"-0":e}}function _o(t,e){return t.Le?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function No(t,e){return t.Le?e.toBase64():e.toUint8Array()}function Ao(t,e){return t.Le?(Ar(void 0===e||"string"==typeof e),hi.fromBase64String(e||"")):(Ar(void 0===e||e instanceof Uint8Array),hi.fromUint8Array(e||new Uint8Array))}function So(t){return Ar(!!t),zr.I((e=ho(t),new Qr(e.seconds,e.nanos)));var e}function Do(t,e){return new Wr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).N()}function Oo(t){var e=Wr.$(t);return Ar(zo(e)),e}function xo(t,e){return Do(t.s,e.path)}function Po(t,e){var n=Oo(e);return Ar(n.get(1)===t.s.projectId),Ar(!n.get(3)&&!t.s.database||n.get(3)===t.s.database),new ii(Uo(n))}function Ro(t,e){return Do(t.s,e)}function ko(t){var e=Oo(t);return 4===e.length?Wr.k:Uo(e)}function Lo(t){return new Wr(["projects",t.s.projectId,"databases",t.s.database]).N()}function Uo(t){return Ar(4<t.length&&"documents"===t.get(4)),t.g(5)}function Co(t,e,n){return{name:xo(t,e),fields:n.proto.mapValue.fields}}function Vo(t,e){var n,r,i,o;if(e instanceof fs)n={update:Co(t,e.key,e.value)};else if(e instanceof ds)n={delete:xo(t,e.key)};else if(e instanceof ls)n={update:Co(t,e.key,e.data),updateMask:(r=e.Oe,i=[],r.fields.forEach(function(t){return i.push(t.N())}),{fieldPaths:i})};else if(e instanceof ps)n={transform:{document:xo(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof Ho)return{fieldPath:t.field.N(),setToServerValue:"REQUEST_TIME"};if(e instanceof Ko)return{fieldPath:t.field.N(),appendMissingElements:{values:e.elements}};if(e instanceof Xo)return{fieldPath:t.field.N(),removeAllFromArray:{values:e.elements}};if(e instanceof Yo)return{fieldPath:t.field.N(),increment:e.Be};throw Nr()})}};else{if(!(e instanceof ys))return Nr();n={verify:xo(t,e.key)}}return e.Ue.qe||(n.currentDocument=void 0!==(o=e.Ue).updateTime?{updateTime:_o(t,o.updateTime.R())}:void 0!==o.exists?{exists:o.exists}:Nr()),n}function Mo(e,t){var n,r,i=t.currentDocument?void 0!==(n=t.currentDocument).updateTime?hs.updateTime(So(n.updateTime)):void 0!==n.exists?hs.exists(n.exists):hs.Qe():hs.Qe();if(t.update){t.update.name;var o=Po(e,t.update.name),s=new vs({mapValue:{fields:t.update.fields}});if(t.updateMask){var u=(r=t.updateMask.fieldPaths||[],new us(r.map(function(t){return ni.B(t)})));return new ls(o,s,u,i)}return new fs(o,s,i)}if(t.delete){var a=Po(e,t.delete);return new ds(a,i)}if(t.transform){var h=Po(e,t.transform.document),c=t.transform.fieldTransforms.map(function(t){return function(t,e){var n,r,i=null;"setToServerValue"in e?(Ar("REQUEST_TIME"===e.setToServerValue),i=Ho.instance):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],i=new Ko(n)):"removeAllFromArray"in e?(r=e.removeAllFromArray.values||[],i=new Xo(r)):"increment"in e?i=new Yo(t,e.increment):Nr();var o=ni.B(e.fieldPath);return new as(o,i)}(e,t)});return Ar(!0===i.exists),new ps(h,c)}if(t.verify){var f=Po(e,t.verify);return new ys(f,i)}return Nr()}function Fo(t,e){return{documents:[Ro(t,e.path)]}}function qo(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=Ro(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Ro(t,r.p()),n.structuredQuery.from=[{collectionId:r.S()}]);var i=function(t){if(0!==t.length){var e=t.map(function(t){return t instanceof Qs?function(t){if("=="===t.op){if(go(t.value))return{unaryFilter:{field:Go(t.field),op:"IS_NAN"}};if(vo(t.value))return{unaryFilter:{field:Go(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:Go(t.field),op:(e=t.op,bo[e]),value:t.value}};var e}(t):Nr()});return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map(function(t){return{field:Go((e=t).field),direction:(n=e.dir,wo[n])};var e,n})}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var s,u=(s=e.limit,t.Le||si(s)?s:{value:s});return null!==u&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=jo(e.startAt)),e.endAt&&(n.structuredQuery.endAt=jo(e.endAt)),n}function jo(t){return{before:t.before,values:t.position}}function Bo(t){var e=!!t.before,n=t.values||[];return new Ys(n,e)}function Go(t){return{fieldPath:t.N()}}function Qo(t){return ni.B(t.fieldPath)}function zo(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var Ho=(Wo.prototype.je=function(t,e){return n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},t&&(n.fields.__previous_value__=t),{mapValue:n};var n},Wo.prototype.Ke=function(t,e){return e},Wo.prototype.Ge=function(t){return null},Wo.prototype.isEqual=function(t){return t instanceof Wo},Wo);function Wo(){}Ho.instance=new Ho;var Ko=(Zo.prototype.je=function(t,e){return this.apply(t)},Zo.prototype.Ke=function(t,e){return this.apply(t)},Zo.prototype.apply=function(t){for(var n=ts(t),e=function(e){n.some(function(t){return io(t,e)})||n.push(e)},r=0,i=this.elements;r<i.length;r++)e(i[r]);return{arrayValue:{values:n}}},Zo.prototype.Ge=function(t){return null},Zo.prototype.isEqual=function(t){return t instanceof Zo&&Pr(this.elements,t.elements,io)},Zo),Xo=(Jo.prototype.je=function(t,e){return this.apply(t)},Jo.prototype.Ke=function(t,e){return this.apply(t)},Jo.prototype.apply=function(t){for(var n=ts(t),e=function(e){n=n.filter(function(t){return!io(t,e)})},r=0,i=this.elements;r<i.length;r++)e(i[r]);return{arrayValue:{values:n}}},Jo.prototype.Ge=function(t){return null},Jo.prototype.isEqual=function(t){return t instanceof Jo&&Pr(this.elements,t.elements,io)},Jo),Yo=($o.prototype.je=function(t,e){var n=this.Ge(t),r=this.asNumber(n)+this.asNumber(this.Be);return po(n)&&po(this.Be)?Io(r):To(this.serializer,r)},$o.prototype.Ke=function(t,e){return e},$o.prototype.Ge=function(t){return po(e=t)||e&&"doubleValue"in e?t:{integerValue:0};var e},$o.prototype.isEqual=function(t){return t instanceof $o&&io(this.Be,t.Be)},$o.prototype.asNumber=function(t){return co(t.integerValue||t.doubleValue)},$o);function $o(t,e){this.serializer=t,this.Be=e}function Jo(t){this.elements=t}function Zo(t){this.elements=t}function ts(t){return yo(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function es(t,e){this.version=t,this.transformResults=e}var ns,rs,is,os,ss,us=(Ds.prototype.ze=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].D(t))return!0;return!1},Ds.prototype.isEqual=function(t){return Pr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Ds),as=(Ss.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},Ss),hs=(As.Qe=function(){return new As},As.exists=function(t){return new As(void 0,t)},As.updateTime=function(t){return new As(t)},Object.defineProperty(As.prototype,"qe",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),As.prototype.He=function(t){return void 0!==this.updateTime?t instanceof qs&&t.version.isEqual(this.updateTime):void 0===this.exists||this.exists===t instanceof qs},As.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},As),cs=(Ns.prototype.Ye=function(t){},Ns.Je=function(t){return t instanceof qs?t.version:zr.min()},Ns),fs=(n(_s,ss=cs),_s.prototype.Ke=function(t,e){this.Ye(t);var n=e.version;return new qs(this.key,n,this.value,{hasCommittedMutations:!0})},_s.prototype.je=function(t,e,n){if(this.Ye(t),!this.Ue.He(t))return t;var r=cs.Je(t);return new qs(this.key,r,this.value,{Xe:!0})},_s.prototype.Ze=function(t){return null},_s.prototype.isEqual=function(t){return t instanceof _s&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.Ue.isEqual(t.Ue)},_s),ls=(n(Ts,os=cs),Ts.prototype.Ke=function(t,e){if(this.Ye(t),!this.Ue.He(t))return new Bs(this.key,e.version);var n=this.ts(t);return new qs(this.key,e.version,n,{hasCommittedMutations:!0})},Ts.prototype.je=function(t,e,n){if(this.Ye(t),!this.Ue.He(t))return t;var r=cs.Je(t),i=this.ts(t);return new qs(this.key,r,i,{Xe:!0})},Ts.prototype.Ze=function(t){return null},Ts.prototype.isEqual=function(t){return t instanceof Ts&&this.key.isEqual(t.key)&&this.Oe.isEqual(t.Oe)&&this.Ue.isEqual(t.Ue)},Ts.prototype.ts=function(t){var e=t instanceof qs?t.data():vs.empty();return this.es(e)},Ts.prototype.es=function(t){var n=this,r=new gs(t);return this.Oe.fields.forEach(function(t){var e;t._()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.ss()},Ts),ps=(n(Is,is=cs),Is.prototype.Ke=function(t,e){if(this.Ye(t),Ar(null!=e.transformResults),!this.Ue.He(t))return new Bs(this.key,e.version);var n=this.ns(t),r=this.rs(t,e.transformResults),i=e.version,o=this.os(n.data(),r);return new qs(this.key,i,o,{hasCommittedMutations:!0})},Is.prototype.je=function(t,e,n){if(this.Ye(t),!this.Ue.He(t))return t;var r=this.ns(t),i=this.hs(n,t,e),o=this.os(r.data(),i);return new qs(this.key,r.version,o,{Xe:!0})},Is.prototype.Ze=function(t){for(var e=null,n=0,r=this.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof qs?t.field(i.field):void 0,s=i.transform.Ge(o||null);null!=s&&(e=null==e?(new gs).set(i.field,s):e.set(i.field,s))}return e?e.ss():null},Is.prototype.isEqual=function(t){return t instanceof Is&&this.key.isEqual(t.key)&&Pr(this.fieldTransforms,t.fieldTransforms,function(t,e){return t.isEqual(e)})&&this.Ue.isEqual(t.Ue)},Is.prototype.ns=function(t){return t},Is.prototype.rs=function(t,e){var n=[];Ar(this.fieldTransforms.length===e.length);for(var r=0;r<e.length;r++){var i=this.fieldTransforms[r],o=i.transform,s=null;t instanceof qs&&(s=t.field(i.field)),n.push(o.Ke(s,e[r]))}return n},Is.prototype.hs=function(t,e,n){for(var r=[],i=0,o=this.fieldTransforms;i<o.length;i++){var s=o[i],u=s.transform,a=null;e instanceof qs&&(a=e.field(s.field)),null===a&&n instanceof qs&&(a=n.field(s.field)),r.push(u.je(a,t))}return r},Is.prototype.os=function(t,e){for(var n=new gs(t),r=0;r<this.fieldTransforms.length;r++){var i=this.fieldTransforms[r].field;n.set(i,e[r])}return n.ss()},Is),ds=(n(Es,rs=cs),Es.prototype.Ke=function(t,e){return this.Ye(t),new js(this.key,e.version,{hasCommittedMutations:!0})},Es.prototype.je=function(t,e,n){return this.Ye(t),this.Ue.He(t)?new js(this.key,zr.min()):t},Es.prototype.Ze=function(t){return null},Es.prototype.isEqual=function(t){return t instanceof Es&&this.key.isEqual(t.key)&&this.Ue.isEqual(t.Ue)},Es),ys=(n(bs,ns=cs),bs.prototype.Ke=function(t,e){Nr()},bs.prototype.je=function(t,e,n){Nr()},bs.prototype.Ze=function(t){Nr()},bs.prototype.isEqual=function(t){return t instanceof bs&&this.key.isEqual(t.key)&&this.Ue.isEqual(t.Ue)},bs),vs=(ws.empty=function(){return new ws({mapValue:{}})},ws.prototype.field=function(t){if(t._())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!mo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.S()])||null},ws.prototype.isEqual=function(t){return io(this.proto,t.proto)},ws),gs=(ms.prototype.set=function(t,e){return this.cs(t,e),this},ms.prototype.delete=function(t){return this.cs(t,null),this},ms.prototype.cs=function(t,e){for(var n=this.us,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map||(o=o&&10===ro(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),n=o}n.set(t.S(),e)},ms.prototype.ss=function(){var t=this.ls(ni.k,this.us);return null!=t?new vs(t):this.as},ms.prototype.ls=function(r,t){var i=this,o=!1,e=this.as.field(r),s=mo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.ls(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},ms);function ms(t){void 0===t&&(t=vs.empty()),this.as=t,this.us=new Map}function ws(t){this.proto=t}function bs(t,e){var n=this;return(n=ns.call(this)||this).key=t,n.Ue=e,n.type=4,n}function Es(t,e){var n=this;return(n=rs.call(this)||this).key=t,n.Ue=e,n.type=3,n}function Is(t,e){var n=this;return(n=is.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ue=hs.exists(!0),n}function Ts(t,e,n,r){var i=this;return(i=os.call(this)||this).key=t,i.data=e,i.Oe=n,i.Ue=r,i.type=1,i}function _s(t,e,n){var r=this;return(r=ss.call(this)||this).key=t,r.value=e,r.Ue=n,r.type=0,r}function Ns(){}function As(t,e){this.updateTime=t,this.exists=e}function Ss(t,e){this.field=t,this.transform=e}function Ds(t){(this.fields=t).sort(ni.P)}function Os(t){var u=[];return Vr(t.fields||{},function(t,e){var n=new ni([t]);if(mo(e)){var r=Os(e.mapValue).fields;if(0===r.length)u.push(n);else for(var i=0,o=r;i<o.length;i++){var s=o[i];u.push(n.child(s))}}else u.push(n)}),new us(u)}function xs(t,e){this.key=t,this.version=e}var Ps,Rs,ks,Ls,Us,Cs,Vs,Ms,Fs,qs=(n(su,Fs=xs),su.prototype.field=function(t){return this._s.field(t)},su.prototype.data=function(){return this._s},su.prototype.fs=function(){return this._s.proto},su.prototype.isEqual=function(t){return t instanceof su&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Xe===t.Xe&&this.hasCommittedMutations===t.hasCommittedMutations&&this._s.isEqual(t._s)},su.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this._s.toString()+", {hasLocalMutations: "+this.Xe+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(su.prototype,"hasPendingWrites",{get:function(){return this.Xe||this.hasCommittedMutations},enumerable:!0,configurable:!0}),su),js=(n(ou,Ms=xs),ou.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(ou.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),ou.prototype.isEqual=function(t){return t instanceof ou&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},ou),Bs=(n(iu,Vs=xs),iu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(iu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),iu.prototype.isEqual=function(t){return t instanceof iu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},iu),Gs=(ru.As=function(t){return new ru(t)},Object.defineProperty(ru.prototype,"orderBy",{get:function(){if(null===this.Ts){this.Ts=[];var t=this.Rs(),e=this.ms();if(null!==t&&null===e)t.L()||this.Ts.push(new fu(t)),this.Ts.push(new fu(ni.O(),"asc"));else{for(var n,r=!1,i=0,o=this.ds;i<o.length;i++){var s=o[i];this.Ts.push(s),s.field.L()&&(r=!0)}r||(n=0<this.ds.length?this.ds[this.ds.length-1].dir:"asc",this.Ts.push(new fu(ni.O(),n)))}}return this.Ts},enumerable:!0,configurable:!0}),ru.prototype.Ps=function(t){var e=this.filters.concat([t]);return new ru(this.path,this.collectionGroup,this.ds.slice(),e,this.limit,this.ws,this.startAt,this.endAt)},ru.prototype.Vs=function(t){var e=this.ds.concat([t]);return new ru(this.path,this.collectionGroup,e,this.filters.slice(),this.limit,this.ws,this.startAt,this.endAt)},ru.prototype.gs=function(t){return new ru(this.path,this.collectionGroup,this.ds.slice(),this.filters.slice(),t,"F",this.startAt,this.endAt)},ru.prototype.ps=function(t){return new ru(this.path,this.collectionGroup,this.ds.slice(),this.filters.slice(),t,"L",this.startAt,this.endAt)},ru.prototype.ys=function(t){return new ru(this.path,this.collectionGroup,this.ds.slice(),this.filters.slice(),this.limit,this.ws,t,this.endAt)},ru.prototype.bs=function(t){return new ru(this.path,this.collectionGroup,this.ds.slice(),this.filters.slice(),this.limit,this.ws,this.startAt,t)},ru.prototype.vs=function(t){return new ru(t,null,this.ds.slice(),this.filters.slice(),this.limit,this.ws,this.startAt,this.endAt)},ru.prototype.Ss=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.ds.length||1===this.ds.length&&this.ds[0].field.L())},ru.prototype.canonicalId=function(){return vu(this.We())+"|lt:"+this.ws},ru.prototype.toString=function(){return"Query(target="+(e=(t=this.We()).path.N(),null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),0<t.filters.length&&(e+=", filters: ["+t.filters.join(", ")+"]"),si(t.limit)||(e+=", limit: "+t.limit),0<t.orderBy.length&&(e+=", orderBy: ["+t.orderBy.join(", ")+"]"),t.startAt&&(e+=", startAt: "+uu(t.startAt)),t.endAt&&(e+=", endAt: "+uu(t.endAt)),"Target("+e+")")+"; limitType="+this.ws+")";var t,e},ru.prototype.isEqual=function(t){return gu(this.We(),t.We())&&this.ws===t.ws},ru.prototype.Ds=function(t,e){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],s=o.compare(t,e);if(0!==s)return s;n=n||o.field.L()}return 0},ru.prototype.matches=function(t){return this.Cs(t)&&this.Fs(t)&&this.Ns(t)&&this.$s(t)},ru.prototype.ks=function(){return!si(this.limit)&&"F"===this.ws},ru.prototype.xs=function(){return!si(this.limit)&&"L"===this.ws},ru.prototype.ms=function(){return 0<this.ds.length?this.ds[0].field:null},ru.prototype.Rs=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof Qs&&n.Ms())return n.field}return null},ru.prototype.Ls=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(r instanceof Qs&&0<=t.indexOf(r.op))return r.op}return null},ru.prototype.Os=function(){return mu(this.We())},ru.prototype.Bs=function(){return null!==this.collectionGroup},ru.prototype.We=function(){if(!this.Es)if("F"===this.ws)this.Es=yu(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var r=n[e],i="desc"===r.dir?"asc":"desc";t.push(new fu(r.field,i))}var o=this.endAt?new Ys(this.endAt.position,!this.endAt.before):null,s=this.startAt?new Ys(this.startAt.position,!this.startAt.before):null;this.Es=yu(this.path,this.collectionGroup,t,this.filters,this.limit,o,s)}return this.Es},ru.prototype.Cs=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.U(this.collectionGroup)&&this.path.D(e):ii.W(this.path)?this.path.isEqual(e):this.path.C(e)},ru.prototype.Fs=function(t){for(var e=0,n=this.ds;e<n.length;e++){var r=n[e];if(!r.field.L()&&null===t.field(r.field))return!1}return!0},ru.prototype.Ns=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},ru.prototype.$s=function(t){return!(this.startAt&&!au(this.startAt,this.orderBy,t)||this.endAt&&au(this.endAt,this.orderBy,t))},ru.prototype.Is=function(t){},ru),Qs=(n(nu,Cs=function(){}),nu.create=function(t,e,n){if(t.L())return"in"===e?new Hs(t,n):new zs(t,e,n);if(vo(n)){if("=="!==e)throw new Gr(Br.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new nu(t,e,n)}if(go(n)){if("=="!==e)throw new Gr(Br.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new nu(t,e,n)}return"array-contains"===e?new Ws(t,n):"in"===e?new Ks(t,n):"array-contains-any"===e?new Xs(t,n):new nu(t,e,n)},nu.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&ro(this.value)===ro(e)&&this.qs(so(e,this.value))},nu.prototype.qs=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return 0<t;case">=":return 0<=t;default:return Nr()}},nu.prototype.Ms=function(){return 0<=["<","<=",">",">="].indexOf(this.op)},nu.prototype.canonicalId=function(){return this.field.N()+this.op.toString()+ao(this.value)},nu.prototype.isEqual=function(t){return t instanceof nu&&this.op===t.op&&this.field.isEqual(t.field)&&io(this.value,t.value)},nu.prototype.toString=function(){return this.field.N()+" "+this.op+" "+ao(this.value)},nu),zs=(n(eu,Us=Qs),eu.prototype.matches=function(t){var e=ii.P(t.key,this.key);return this.qs(e)},eu),Hs=(n(tu,Ls=Qs),tu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},tu),Ws=(n(Zs,ks=Qs),Zs.prototype.matches=function(t){var e=t.field(this.field);return yo(e)&&oo(e.arrayValue,this.value)},Zs),Ks=(n(Js,Rs=Qs),Js.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&oo(this.value.arrayValue,e)},Js),Xs=(n($s,Ps=Qs),$s.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!yo(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return oo(e.value.arrayValue,t)})},$s),Ys=function(t,e){this.position=t,this.before=e};function $s(t,e){return Ps.call(this,t,"array-contains-any",e)||this}function Js(t,e){return Rs.call(this,t,"in",e)||this}function Zs(t,e){return ks.call(this,t,"array-contains",e)||this}function tu(t,e){var n=this;return(n=Ls.call(this,t,"in",e)||this).keys=(e.arrayValue.values||[]).map(function(t){return ii.q(t.referenceValue)}),n}function eu(t,e,n){var r=this;return(r=Us.call(this,t,e,n)||this).key=ii.q(n.referenceValue),r}function nu(t,e,n){var r=this;return(r=Cs.call(this)||this).field=t,r.op=e,r.value=n,r}function ru(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.ds=n,this.filters=r,this.limit=i,this.ws=o,this.startAt=s,this.endAt=u,this.Ts=null,this.Es=null,this.startAt&&this.Is(this.startAt),this.endAt&&this.Is(this.endAt)}function iu(){return null!==Vs&&Vs.apply(this,arguments)||this}function ou(t,e,n){var r=this;return(r=Ms.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function su(t,e,n,r){var i=this;return(i=Fs.call(this,t,e)||this)._s=n,i.Xe=!!r.Xe,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function uu(t){return(t.before?"b":"a")+":"+t.position.map(ao).join(",")}function au(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.L()?ii.P(ii.q(s.referenceValue),n.key):so(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function hu(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!io(t.position[n],e.position[n]))return!1;return!0}var cu,fu=(du.prototype.compare=function(t,e){var n,r,i,o,s=this.Us?ii.P(t.key,e.key):(n=this.field,r=e,i=t.field(n),o=r.field(n),null!==i&&null!==o?so(i,o):Nr());switch(this.dir){case"asc":return s;case"desc":return-1*s;default:return Nr()}},du.prototype.canonicalId=function(){return this.field.N()+this.dir.toString()},du.prototype.toString=function(){return this.field.N()+" ("+this.dir+")"},du.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},du),lu=(n(pu,cu=function(t,e,n,r,i,o,s){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s}),pu);function pu(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null);var u=this;return(u=cu.call(this,t,e,n,r,i,o,s)||this).Qs=null,u}function du(t,e){this.field=t,void 0===e&&(e="asc"),this.dir=e,this.Us=t.L()}function yu(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new lu(t,e,n,r,i,o,s)}function vu(t){var e,n=t;return null===n.Qs&&(e=n.path.N(),null!==n.collectionGroup&&(e+="|cg:"+n.collectionGroup),e+="|f:",e+=n.filters.map(function(t){return t.canonicalId()}).join(","),e+="|ob:",e+=n.orderBy.map(function(t){return t.canonicalId()}).join(","),si(n.limit)||(e+="|l:",e+=n.limit),n.startAt&&(e+="|lb:",e+=uu(n.startAt)),n.endAt&&(e+="|ub:",e+=uu(n.endAt)),n.Qs=e),n.Qs}function gu(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!t.orderBy[n].isEqual(e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(!t.filters[r].isEqual(e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!hu(t.startAt,e.startAt)&&hu(t.endAt,e.endAt)}function mu(t){return ii.W(t.path)&&null===t.collectionGroup&&0===t.filters.length}var wu=(Uu.prototype.Ke=function(t,e,n){for(var r=n.js,i=0;i<this.mutations.length;i++){var o,s=this.mutations[i];s.key.isEqual(t)&&(o=r[i],e=s.Ke(e,o))}return e},Uu.prototype.je=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=i.je(e,e,this.Ws))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=a.je(e,o,this.Ws))}return e},Uu.prototype.Ks=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.je(t.key,n.get(t.key));e&&(i=i.et(t.key,e))}),i},Uu.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},ki())},Uu.prototype.isEqual=function(t){return this.batchId===t.batchId&&Pr(this.mutations,t.mutations,function(t,e){return t.isEqual(e)})&&Pr(this.baseMutations,t.baseMutations,function(t,e){return t.isEqual(e)})},Uu),bu=(Lu.from=function(t,e,n){Ar(t.mutations.length===n.length);for(var r=Pi,i=t.mutations,o=0;o<i.length;o++)r=r.et(i[o].key,n[o].version);return new Lu(t,e,n,r)},Lu),Eu=(ku.prototype.catch=function(t){return this.next(void 0,t)},ku.prototype.next=function(r,i){var o=this;return this.Xs&&Nr(),this.Xs=!0,this.Js?this.error?this.Zs(i,this.error):this.tn(r,this.result):new ku(function(e,n){o.Hs=function(t){o.tn(r,t).next(e,n)},o.Ys=function(t){o.Zs(i,t).next(e,n)}})},ku.prototype.en=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ku.prototype.sn=function(t){try{var e=t();return e instanceof ku?e:ku.resolve(e)}catch(t){return ku.reject(t)}},ku.prototype.tn=function(t,e){return t?this.sn(function(){return t(e)}):ku.resolve(e)},ku.prototype.Zs=function(t,e){return t?this.sn(function(){return t(e)}):ku.reject(e)},ku.resolve=function(n){return new ku(function(t,e){t(n)})},ku.reject=function(n){return new ku(function(t,e){e(n)})},ku.nn=function(t){return new ku(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ku.rn=function(t){for(var n=ku.resolve(!1),e=function(e){n=n.next(function(t){return t?ku.resolve(t):e()})},r=0,i=t;r<i.length;r++)e(i[r]);return n},ku.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.nn(i)},ku),Iu=(Object.defineProperty(Ru.prototype,"readTime",{get:function(){return this.an},set:function(t){this.an=t},enumerable:!0,configurable:!0}),Ru.prototype.un=function(t,e){this.cn(),this.readTime=e,this.on.set(t.key,t)},Ru.prototype.ln=function(t,e){this.cn(),e&&(this.readTime=e),this.on.set(t,null)},Ru.prototype._n=function(t,e){this.cn();var n=this.on.get(e);return void 0!==n?Eu.resolve(n):this.fn(t,e)},Ru.prototype.getEntries=function(t,e){return this.dn(t,e)},Ru.prototype.apply=function(t){return this.cn(),this.hn=!0,this.wn(t)},Ru.prototype.cn=function(){},Ru),Tu="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",_u=(Pu.prototype.En=function(t){this.Tn.push(t)},Pu.prototype.In=function(){this.Tn.forEach(function(t){return t()})},Pu),Nu=(xu.prototype.Pn=function(e,n){var r=this;return this.Rn.Vn(e,n).next(function(t){return r.gn(e,n,t)})},xu.prototype.gn=function(t,r,i){return this.An._n(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].je(r,t);return t})},xu.prototype.pn=function(t,e,i){var o=Si;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].je(t,e);o=o.et(t,e)}),o},xu.prototype.yn=function(e,t){var n=this;return this.An.getEntries(e,t).next(function(t){return n.bn(e,t)})},xu.prototype.bn=function(r,i){var o=this;return this.Rn.vn(r,i).next(function(t){var e=o.pn(r,i,t),n=Si;return e.forEach(function(t,e){e=e||new js(t,zr.min()),n=n.et(t,e)}),n})},xu.prototype.Sn=function(t,e,n){return e.Os()?this.Dn(t,e.path):e.Bs()?this.Cn(t,e,n):this.Fn(t,e,n)},xu.prototype.Dn=function(t,e){return this.Pn(t,new ii(e)).next(function(t){var e=xi;return t instanceof qs&&(e=e.et(t.key,t)),e})},xu.prototype.Cn=function(n,r,i){var o=this,s=r.collectionGroup,u=xi;return this.mn.Nn(n,s).next(function(t){return Eu.forEach(t,function(t){var e=r.vs(t.child(s));return o.Fn(n,e,i).next(function(t){t.forEach(function(t,e){u=u.et(t,e)})})}).next(function(){return u})})},xu.prototype.Fn=function(e,n,t){var c,f,r=this;return this.An.Sn(e,n,t).next(function(t){return c=t,r.Rn.$n(e,n)}).next(function(t){return f=t,r.kn(e,f,c).next(function(t){c=t;for(var e=0,n=f;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=c.get(u),h=s.je(a,a,r.Ws);c=h instanceof qs?c.et(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){n.matches(e)||(c=c.remove(t))}),c})},xu.prototype.kn=function(t,e,n){for(var r=ki(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof ls&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.An.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof qs&&(h=h.et(t,e))}),h})},xu),Au=(Ou.Ln=function(t,e){for(var n=ki(),r=ki(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Ou(t,e.fromCache,n,r)},Ou),Su=(Du.prototype.Bn=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Du.prototype.next=function(){var t=++this.previousValue;return this.qn&&this.qn(t),t},Du);function Du(t,e){var n=this;this.previousValue=t,e&&(e.On=function(t){return n.Bn(t)},this.qn=function(t){return e.Un(t)})}function Ou(t,e,n,r){this.targetId=t,this.fromCache=e,this.xn=n,this.Mn=r}function xu(t,e,n){this.An=t,this.Rn=e,this.mn=n}function Pu(){this.Tn=[]}function Ru(){this.on=new jr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.hn=!1}function ku(t){var e=this;this.Hs=null,this.Ys=null,this.result=void 0,this.error=void 0,this.Js=!1,this.Xs=!1,t(function(t){e.Js=!0,e.result=t,e.Hs&&e.Hs(t)},function(t){e.Js=!0,e.error=t,e.Ys&&e.Ys(t)})}function Lu(t,e,n,r){this.batch=t,this.Gs=e,this.js=n,this.zs=r}function Uu(t,e,n,r){this.batchId=t,this.Ws=e,this.baseMutations=n,this.mutations=r}function Cu(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}Su.Qn=-1;var Vu=(Mu.prototype.reset=function(){this.Hn=0},Mu.prototype.Xn=function(){this.Hn=this.zn},Mu.prototype.Zn=function(t){var e=this;this.cancel();var n=Math.floor(this.Hn+this.ti()),r=Math.max(0,Date.now()-this.Jn),i=Math.max(0,n-r);0<i&&Ir("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Hn+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Yn=this.Wn.ei(this.jn,i,function(){return e.Jn=Date.now(),t()}),this.Hn*=this.Gn,this.Hn<this.Kn&&(this.Hn=this.Kn),this.Hn>this.zn&&(this.Hn=this.zn)},Mu.prototype.si=function(){null!==this.Yn&&(this.Yn.ni(),this.Yn=null)},Mu.prototype.cancel=function(){null!==this.Yn&&(this.Yn.cancel(),this.Yn=null)},Mu.prototype.ti=function(){return(Math.random()-.5)*this.Hn},Mu);function Mu(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Wn=t,this.jn=e,this.Kn=n,this.Gn=r,this.zn=i,this.Hn=0,this.Yn=null,this.Jn=Date.now(),this.reset()}function Fu(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=ju(e)),e=qu(t.get(n),e);return ju(e)}function qu(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function ju(t){return t+""}function Bu(t){var e=t.length;if(Ar(2<=e),2===e)return Ar(""===t.charAt(0)&&""===t.charAt(1)),Wr.k;for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&Nr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Nr()}o=s+2}return new Wr(r)}var Gu=(Ku.prototype.ri=function(t,e){return this.ii.add(e),Eu.resolve()},Ku.prototype.Nn=function(t,e){return Eu.resolve(this.ii.getEntries(e))},Ku),Qu=(Wu.prototype.add=function(t){var e=t.S(),n=t.p(),r=this.index[e]||new Ni(Wr.P),i=!r.has(n);return this.index[e]=r.add(n),i},Wu.prototype.has=function(t){var e=t.S(),n=t.p(),r=this.index[e];return r&&r.has(n)},Wu.prototype.getEntries=function(t){return(this.index[t]||new Ni(Wr.P)).F()},Wu),zu=(Hu.prototype.ri=function(t,e){var n=this;if(this.oi.has(e))return Eu.resolve();var r=e.S(),i=e.p();t.En(function(){n.oi.add(e)});var o={collectionId:r,parent:Fu(i)};return Xu(t).put(o)},Hu.prototype.Nn=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Rr(i),""],!1,!0);return Xu(t).hi(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(Bu(r.parent))}return o})},Hu);function Hu(){this.oi=new Qu}function Wu(){this.index={}}function Ku(){this.ii=new Qu}function Xu(t){return _a.ai(t,eh.store)}function Yu(t){this.ui=t}function $u(t,e){if(e.document)return n=t.ui,r=e.document,i=!!e.hasCommittedMutations,o=Po(n,r.name),s=So(r.updateTime),u=new vs({mapValue:{fields:r.fields}}),new qs(o,s,u,{hasCommittedMutations:!!i});var n,r,i,o,s,u;if(e.noDocument){var a=ii.j(e.noDocument.path),h=na(e.noDocument.readTime);return new js(a,h,{hasCommittedMutations:!!e.hasCommittedMutations})}if(e.unknownDocument){var c=ii.j(e.unknownDocument.path),f=na(e.unknownDocument.version);return new Bs(c,f)}return Nr()}function Ju(t,e,n){var r,i,o=Zu(n),s=e.key.path.p().F();if(e instanceof qs){var u={name:xo(r=t.ui,(i=e).key),fields:i.fs().mapValue.fields,updateTime:_o(r,i.version.R())},a=e.hasCommittedMutations;return new Ya(null,null,u,a,o,s)}if(e instanceof js){var h=e.key.path.F(),c=ea(e.version),f=e.hasCommittedMutations;return new Ya(null,new Ka(h,c),null,f,o,s)}if(e instanceof Bs){var l=e.key.path.F(),p=ea(e.version);return new Ya(new Xa(l,p),null,null,!0,o,s)}return Nr()}function Zu(t){var e=t.R();return[e.seconds,e.nanoseconds]}function ta(t){var e=new Qr(t[0],t[1]);return zr.I(e)}function ea(t){var e=t.R();return new ja(e.seconds,e.nanoseconds)}function na(t){var e=new Qr(t.seconds,t.nanoseconds);return zr.I(e)}function ra(e,t){var n=(t.baseMutations||[]).map(function(t){return Mo(e.ui,t)}),r=t.mutations.map(function(t){return Mo(e.ui,t)}),i=Qr.fromMillis(t.localWriteTimeMs);return new wu(t.batchId,i,n,r)}function ia(t){var e=na(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?na(t.lastLimboFreeSnapshotVersion):zr.min(),r=(void 0!==t.query.documents?function(t){Ar(1===t.documents.length);var e=t.documents[0];return Gs.As(ko(e)).We()}:function(t){var e,n=ko(t.parent),r=t.structuredQuery,i=r.from?r.from.length:0,o=null;0<i&&(Ar(1===i),(e=r.from[0]).allDescendants?o=e.collectionId:n=n.child(e.collectionId));var s=[];r.where&&(s=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Qo(t.unaryFilter.field);return Qs.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Qo(t.unaryFilter.field);return Qs.create(n,"==",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Nr()}}(e)]:void 0!==e.fieldFilter?[(n=e,Qs.create(Qo(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Nr()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Nr():[];var n}(r.where));var u=[];r.orderBy&&(u=r.orderBy.map(function(t){return new fu(Qo((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}));var a,h,c=null;r.limit&&(c=si(h="object"==typeof(a=r.limit)?a.value:a)?null:h);var f=null;r.startAt&&(f=Bo(r.startAt));var l=null;return r.endAt&&(l=Bo(r.endAt)),new Gs(n,o,u,s,c,"F",f,l).We()})(t.query);return new di(r,t.targetId,0,t.lastListenSequenceNumber,e,n,hi.fromBase64String(t.resumeToken))}function oa(t,e){var n=ea(e.J),r=ea(e.lastLimboFreeSnapshotVersion),i=(mu(e.target)?Fo:qo)(t.ui,e.target),o=e.resumeToken.toBase64();return new Ja(e.targetId,vu(e.target),n,o,e.sequenceNumber,r,i)}var sa,ua=(aa.prototype.un=function(t,e,n){return ca(t).put(fa(e),n)},aa.prototype.ln=function(t,e){var n=ca(t),r=fa(e);return n.delete(r)},aa.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.ci(e,t)})},aa.prototype._n=function(t,e){var n=this;return ca(t).get(fa(e)).next(function(t){return n.li(t)})},aa.prototype._i=function(t,e){var n=this;return ca(t).get(fa(e)).next(function(t){var e=n.li(t);return e?{fi:e,size:la(t)}:null})},aa.prototype.getEntries=function(t,e){var r=this,i=Si;return this.di(t,e,function(t,e){var n=r.li(e);i=i.et(t,n)}).next(function(){return i})},aa.prototype.wi=function(t,e){var r=this,i=Si,o=new mi(ii.P);return this.di(t,e,function(t,e){var n=r.li(e);o=n?(i=i.et(t,n),o.et(t,la(e))):(i=i.et(t,null),o.et(t,0))}).next(function(){return{Ti:i,Ei:o}})},aa.prototype.di=function(t,e,i){if(e._())return Eu.resolve();var n=IDBKeyRange.bound(e.first().path.F(),e.last().path.F()),o=e.at(),s=o.dt();return ca(t).Ii({range:n},function(t,e,n){for(var r=ii.j(t);s&&ii.P(s,r)<0;)i(s,null),s=o.dt();s&&s.isEqual(r)&&(i(s,e),s=o.wt()?o.dt():null),s?n.Ai(s.path.F()):n.done()}).next(function(){for(;s;)i(s,null),s=o.wt()?o.dt():null})},aa.prototype.Sn=function(t,i,e){var n,r,o,s=this,u=xi,a=i.path.length+1,h={};return e.isEqual(zr.min())?(n=i.path.F(),h.range=IDBKeyRange.lowerBound(n)):(r=i.path.F(),o=Zu(e),h.range=IDBKeyRange.lowerBound([r,o],!0),h.index=Ya.collectionReadTimeIndex),ca(t).Ii(h,function(t,e,n){var r;t.length===a&&(r=$u(s.serializer,e),i.path.D(r.key.path)?r instanceof qs&&i.matches(r)&&(u=u.et(r.key,r)):n.done())}).next(function(){return u})},aa.prototype.Ri=function(t,e){var r=this,i=Si,o=Zu(e),n=ca(t),s=IDBKeyRange.lowerBound(o,!0);return n.Ii({index:Ya.readTimeIndex,range:s},function(t,e){var n=$u(r.serializer,e);i=i.et(n.key,n),o=e.readTime}).next(function(){return{mi:i,readTime:ta(o)}})},aa.prototype.Pi=function(t){var e=ca(t),r=zr.min();return e.Ii({index:Ya.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=ta(e.readTime)),n.done()}).next(function(){return r})},aa.prototype.Vi=function(t){return new aa.gi(this,!!t&&t.pi)},aa.prototype.yi=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},aa.prototype.getMetadata=function(t){return ha(t).get($a.key).next(function(t){return Ar(!!t),t})},aa.prototype.ci=function(t,e){return ha(t).put($a.key,e)},aa.prototype.li=function(t){if(t){var e=$u(this.serializer,t);return e instanceof js&&e.version.isEqual(zr.min())?null:e}return null},aa);function aa(t,e){this.serializer=t,this.mn=e}function ha(t){return _a.ai(t,$a.store)}function ca(t){return _a.ai(t,Ya.store)}function fa(t){return t.path.F()}function la(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Nr();e=t.noDocument}return JSON.stringify(e).length}function pa(t,e){var n=this;return(n=sa.call(this)||this).bi=t,n.pi=e,n.vi=new jr(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}ua.gi=(n(pa,sa=Iu),pa.prototype.wn=function(s){var u=this,a=[],h=0,c=new Ni(function(t,e){return xr(t.N(),e.N())});return this.on.forEach(function(t,e){var n,r,i,o=u.vi.get(t);e?(n=Ju(u.bi.serializer,e,u.readTime),c=c.add(t.path.p()),r=la(n),h+=r-o,a.push(u.bi.un(s,t,n))):(h-=o,u.pi?(i=Ju(u.bi.serializer,new js(t,zr.min()),u.readTime),a.push(u.bi.un(s,t,i))):a.push(u.bi.ln(s,t)))}),c.forEach(function(t){a.push(u.bi.mn.ri(s,t))}),a.push(this.bi.updateMetadata(s,h)),Eu.nn(a)},pa.prototype.fn=function(t,e){var n=this;return this.bi._i(t,e).next(function(t){return null===t?(n.vi.set(e,0),null):(n.vi.set(e,t.size),t.fi)})},pa.prototype.dn=function(t,e){var n=this;return this.bi.wi(t,e).next(function(t){var e=t.Ti;return t.Ei.forEach(function(t,e){n.vi.set(t,e)}),e})},pa);var da=(ga.prototype.next=function(){return this.Si+=2,this.Si},ga.Di=function(){return new ga(0)},ga.Ci=function(){return new ga(-1)},ga),ya=(va.prototype.Ni=function(n){var r=this;return this.$i(n).next(function(t){var e=new da(t.highestTargetId);return t.highestTargetId=e.next(),r.ki(n,t).next(function(){return t.highestTargetId})})},va.prototype.xi=function(t){return this.$i(t).next(function(t){return zr.I(new Qr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},va.prototype.Mi=function(t){return this.$i(t).next(function(t){return t.highestListenSequenceNumber})},va.prototype.Li=function(e,n,r){var i=this;return this.$i(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.R()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.ki(e,t)})},va.prototype.Oi=function(e,n){var r=this;return this.Bi(e,n).next(function(){return r.$i(e).next(function(t){return t.targetCount+=1,r.qi(n,t),r.ki(e,t)})})},va.prototype.Ui=function(t,e){return this.Bi(t,e)},va.prototype.Qi=function(e,t){var n=this;return this.Wi(e,t.targetId).next(function(){return ma(e).delete(t.targetId)}).next(function(){return n.$i(e)}).next(function(t){return Ar(0<t.targetCount),--t.targetCount,n.ki(e,t)})},va.prototype.ji=function(r,i,o){var s=this,u=0,a=[];return ma(r).Ii(function(t,e){var n=ia(e);n.sequenceNumber<=i&&null===o.get(n.targetId)&&(u++,a.push(s.Qi(r,n)))}).next(function(){return Eu.nn(a)}).next(function(){return u})},va.prototype.ye=function(t,r){return ma(t).Ii(function(t,e){var n=ia(e);r(n)})},va.prototype.$i=function(t){return wa(t).get(th.key).next(function(t){return Ar(null!==t),t})},va.prototype.ki=function(t,e){return wa(t).put(th.key,e)},va.prototype.Bi=function(t,e){return ma(t).put(oa(this.serializer,e))},va.prototype.qi=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},va.prototype.Ki=function(t){return this.$i(t).next(function(t){return t.targetCount})},va.prototype.Gi=function(t,i){var e=vu(i),n=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),o=null;return ma(t).Ii({range:n,index:Ja.queryTargetsIndexName},function(t,e,n){var r=ia(e);gu(i,r.target)&&(o=r,n.done())}).next(function(){return o})},va.prototype.zi=function(n,t,r){var i=this,o=[],s=ba(n);return t.forEach(function(t){var e=Fu(t.path);o.push(s.put(new Za(r,e))),o.push(i.Fi.Hi(n,r,t))}),Eu.nn(o)},va.prototype.Yi=function(n,t,r){var i=this,o=ba(n);return Eu.forEach(t,function(t){var e=Fu(t.path);return Eu.nn([o.delete([r,e]),i.Fi.Ji(n,r,t)])})},va.prototype.Wi=function(t,e){var n=ba(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},va.prototype.Xi=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=ba(t),o=ki();return r.Ii({range:n,Zi:!0},function(t,e,n){var r=Bu(t[1]),i=new ii(r);o=o.add(i)}).next(function(){return o})},va.prototype.tr=function(t,e){var n=Fu(e.path),r=IDBKeyRange.bound([n],[Rr(n)],!1,!0),i=0;return ba(t).Ii({index:Za.documentTargetsIndex,Zi:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},va.prototype.Me=function(t,e){return ma(t).get(e).next(function(t){return t?ia(t):null})},va);function va(t,e){this.Fi=t,this.serializer=e}function ga(t){this.Si=t}function ma(t){return _a.ai(t,Ja.store)}function wa(t){return _a.ai(t,th.store)}function ba(t){return _a.ai(t,Za.store)}var Ea,Ia="Failed to obtain exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Ta=(n(Aa,Ea=_u),Aa),_a=(Na.ai=function(t,e){if(t instanceof Ta)return sh.ai(t.er,e);throw Nr()},Na.prototype.start=function(){var e=this;return sh.Ir(this.dr,Fa,new qa(this.serializer)).then(function(t){return e.Ar=t,e.Rr()}).then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Gr(Br.FAILED_PRECONDITION,Ia);return e.mr(),e.Pr(),e.Vr(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e.Tr.Mi(t)})}).then(function(t){e.rr=new Su(t,e.nr)}).then(function(){e.or=!0}).catch(function(t){return e.Ar&&e.Ar.close(),Promise.reject(t)})},Na.prototype.gr=function(n){var t=this;return this.lr=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.pr?[2,n(e)]:[2]})})},n(this.isPrimary)},Na.prototype.yr=function(n){var t=this;this.Ar.br(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},Na.prototype.vr=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Wn.Sr(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.pr?[4,this.Rr()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},Na.prototype.Rr=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return Da(e).put(new rh(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.Dr(e).next(function(t){t||(n.isPrimary=!1,n.Wn.Cr(function(){return n.lr(!1)}))})}).next(function(){return n.Fr(e)}).next(function(t){return n.isPrimary&&!t?n.Nr(e).next(function(){return!1}):!!t&&n.$r(e).next(function(){return!0})})}).catch(function(t){if(lh(t))return Ir("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Ir("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.Wn.Cr(function(){return n.lr(t)}),n.isPrimary=t})},Na.prototype.Dr=function(t){var e=this;return Sa(t).get(Ba.key).next(function(t){return Eu.resolve(e.kr(t))})},Na.prototype.xr=function(t){return Da(t).delete(this.clientId)},Na.prototype.Mr=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.Lr(this.cr,18e5)?[3,2]:(this.cr=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=Na.ai(t,rh.store);return r.hi().next(function(t){var e=o.Or(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return Eu.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.Er)for(n=0,r=e;n<r.length;n++)i=r[n],this.Er.removeItem(this.Br(i.clientId));t.label=2;case 2:return[2]}})})},Na.prototype.Vr=function(){var t=this;this.ur=this.Wn.ei("client_metadata_refresh",4e3,function(){return t.Rr().then(function(){return t.Mr()}).then(function(){return t.Vr()})})},Na.prototype.kr=function(t){return!!t&&t.ownerId===this.clientId},Na.prototype.Fr=function(e){var i=this;return this.ir?Eu.resolve(!0):Sa(e).get(Ba.key).next(function(t){if(null!==t&&i.Lr(t.leaseTimestampMs,5e3)&&!i.qr(t.ownerId)){if(i.kr(t)&&i.networkEnabled)return!0;if(!i.kr(t)){if(!t.allowTabSynchronization)throw new Gr(Br.FAILED_PRECONDITION,Ia);return!1}}return!(!i.networkEnabled||!i.inForeground)||Da(e).hi().next(function(t){return void 0===i.Or(t,5e3).find(function(t){if(i.clientId!==t.clientId){var e=!i.networkEnabled&&t.networkEnabled,n=!i.inForeground&&t.inForeground,r=i.networkEnabled===t.networkEnabled;if(e||n&&r)return!0}return!1})})}).next(function(t){return i.isPrimary!==t&&Ir("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},Na.prototype.Ur=function(){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.or=!1,this.Qr(),this.ur&&(this.ur.cancel(),this.ur=null),this.Wr(),this.jr(),[4,this.runTransaction("shutdown","readwrite",function(t){return e.Nr(t).next(function(){return e.xr(t)})}).catch(function(t){Ir("IndexedDbPersistence","Proceeding with shutdown despite failure: ",t)})];case 1:return t.sent(),this.Ar.close(),this.Kr(),[2]}})})},Na.prototype.Or=function(t,e){var n=this;return t.filter(function(t){return n.Lr(t.updateTimeMs,e)&&!n.qr(t.clientId)})},Na.prototype.Gr=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return Da(t).hi().next(function(t){return e.Or(t,18e5).map(function(t){return t.clientId})})})},Na.clearPersistence=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return Na._r()?(e=n+Na.wr,[4,sh.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})},Object.defineProperty(Na.prototype,"pr",{get:function(){return this.or},enumerable:!0,configurable:!0}),Na.prototype.zr=function(t){return Ra.Hr(t,this.serializer,this.mn,this.Fi)},Na.prototype.Yr=function(){return this.Tr},Na.prototype.Jr=function(){return this.An},Na.prototype.Xr=function(){return this.mn},Na.prototype.runTransaction=function(e,n,r){var i=this;Ir("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.Ar.runTransaction(t,oh,function(t){return o=new Ta(t,i.rr?i.rr.next():Su.Qn),"readwrite-primary"===n?i.Dr(o).next(function(t){return!!t||i.Fr(o)}).next(function(t){if(!t)throw Tr("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.Wn.Cr(function(){return i.lr(!1)}),new Gr(Br.FAILED_PRECONDITION,Tu);return r(o)}).next(function(t){return i.$r(o).next(function(){return t})}):i.Zr(o).next(function(){return r(o)})}).then(function(t){return o.In(),t})},Na.prototype.Zr=function(t){var e=this;return Sa(t).get(Ba.key).next(function(t){if(null!==t&&e.Lr(t.leaseTimestampMs,5e3)&&!e.qr(t.ownerId)&&!e.kr(t)&&!(e.ir||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Gr(Br.FAILED_PRECONDITION,Ia)})},Na.prototype.$r=function(t){var e=new Ba(this.clientId,this.allowTabSynchronization,Date.now());return Sa(t).put(Ba.key,e)},Na._r=function(){return sh._r()},Na.to=function(t){var e=t.s.projectId;return t.s.i||(e+="."+t.s.database),"firestore/"+t.persistenceKey+"/"+e+"/"},Na.prototype.Nr=function(t){var e=this,n=Sa(t);return n.get(Ba.key).next(function(t){return e.kr(t)?(Ir("IndexedDbPersistence","Releasing primary lease."),n.delete(Ba.key)):Eu.resolve()})},Na.prototype.Lr=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Tr("Detected an update time that is in the future: "+t+" > "+n),1))},Na.prototype.mr=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ar=function(){t.Wn.Sr(function(){return t.inForeground="visible"===t.document.visibilityState,t.Rr()})},this.document.addEventListener("visibilitychange",this.ar),this.inForeground="visible"===this.document.visibilityState)},Na.prototype.Wr=function(){this.ar&&(this.document.removeEventListener("visibilitychange",this.ar),this.ar=null)},Na.prototype.Pr=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.hr=function(){e.Qr(),e.Wn.Sr(function(){return e.Ur()})},this.window.addEventListener("unload",this.hr))},Na.prototype.jr=function(){this.hr&&(this.window.removeEventListener("unload",this.hr),this.hr=null)},Na.prototype.qr=function(t){var e;try{var n=null!==(null===(e=this.Er)||void 0===e?void 0:e.getItem(this.Br(t)));return Ir("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Tr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},Na.prototype.Qr=function(){if(this.Er)try{this.Er.setItem(this.Br(this.clientId),String(Date.now()))}catch(t){Tr("Failed to set zombie client id.",t)}},Na.prototype.Kr=function(){if(this.Er)try{this.Er.removeItem(this.Br(this.clientId))}catch(t){}},Na.prototype.Br=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},Na);function Na(t,e,n,r,i,o,s,u,a,h){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Wn=i,this.window=o,this.document=s,this.nr=a,this.ir=h,this.rr=null,this.or=!1,this.isPrimary=!1,this.networkEnabled=!0,this.hr=null,this.inForeground=!1,this.ar=null,this.ur=null,this.cr=Number.NEGATIVE_INFINITY,this.lr=function(t){return Promise.resolve()},!Na._r())throw new Gr(Br.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Fi=new Oa(this,r),this.dr=e+Na.wr,this.serializer=new Yu(u),this.Tr=new ya(this.Fi,this.serializer),this.mn=new zu,this.An=new ua(this.serializer,this.mn),this.window&&this.window.localStorage?this.Er=this.window.localStorage:(this.Er=null,!1===h&&Tr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function Aa(t,e){var n=this;return(n=Ea.call(this)||this).er=t,n.sr=e,n}function Sa(t){return _a.ai(t,Ba.store)}function Da(t){return _a.ai(t,rh.store)}_a.wr="main";var Oa=(xa.prototype.so=function(t){var n=this.no(t);return this.db.Yr().Ki(t).next(function(e){return n.next(function(t){return e+t})})},xa.prototype.no=function(t){var e=0;return this.io(t,function(t){e++}).next(function(){return e})},xa.prototype.ye=function(t,e){return this.db.Yr().ye(t,e)},xa.prototype.io=function(t,n){return this.ro(t,function(t,e){return n(e)})},xa.prototype.Hi=function(t,e,n){return Pa(t,n)},xa.prototype.Ji=function(t,e,n){return Pa(t,n)},xa.prototype.ji=function(t,e,n){return this.db.Yr().ji(t,e,n)},xa.prototype.oo=Pa,xa.prototype.ho=function(t,e){return r=e,i=!1,Ma(n=t).ao(function(t){return La(n,t,r).next(function(t){return t&&(i=!0),Eu.resolve(!t)})}).next(function(){return i});var n,r,i},xa.prototype.uo=function(r,i){var o=this,s=this.db.Jr().Vi(),u=[],a=0;return this.ro(r,function(e,t){var n;t<=i&&(n=o.ho(r,e).next(function(t){if(!t)return a++,s._n(r,e).next(function(){return s.ln(e),ba(r).delete([0,Fu(e.path)])})}),u.push(n))}).next(function(){return Eu.nn(u)}).next(function(){return s.apply(r)}).next(function(){return a})},xa.prototype.removeTarget=function(t,e){var n=e.X(t.sr);return this.db.Yr().Ui(t,n)},xa.prototype.co=Pa,xa.prototype.ro=function(t,o){var s,e=ba(t),u=Su.Qn;return e.Ii({index:Za.documentTargetsIndex},function(t,e){var n=t[0],r=(t[1],e.path),i=e.sequenceNumber;0===n?(u!==Su.Qn&&o(new ii(Bu(s)),u),u=i,s=r):u=Su.Qn}).next(function(){u!==Su.Qn&&o(new ii(Bu(s)),u)})},xa.prototype.lo=function(t){return this.db.Jr().yi(t)},xa);function xa(t,e){this.db=t,this.eo=new kh(this,e)}function Pa(t,e){return ba(t).put((n=t.sr,new Za(0,Fu(e.path),n)));var n}var Ra=(ka.Hr=function(t,e,n,r){return Ar(""!==t.uid),new ka(t.fo()?t.uid:"",e,n,r)},ka.prototype.do=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ca(t).Ii({index:za.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},ka.prototype.wo=function(d,y,v,g){var m=this,w=Va(d),b=Ca(d);return b.add({}).next(function(t){Ar("number"==typeof t);for(var e,n,r,i,o,s=new wu(t,y,v,g),u=(e=m.serializer,n=m.userId,i=(r=s).baseMutations.map(function(t){return Vo(e.ui,t)}),o=r.mutations.map(function(t){return Vo(e.ui,t)}),new za(n,r.batchId,r.Ws.toMillis(),i,o)),a=[],h=new Ni(function(t,e){return xr(t.N(),e.N())}),c=0,f=g;c<f.length;c++){var l=f[c],p=Ha.key(m.userId,l.key.path,t),h=h.add(l.key.path.p());a.push(b.put(u)),a.push(w.put(p,Ha.PLACEHOLDER))}return h.forEach(function(t){a.push(m.mn.ri(d,t))}),d.En(function(){m._o[t]=s.keys()}),Eu.nn(a).next(function(){return s})})},ka.prototype.To=function(t,e){var n=this;return Ca(t).get(e).next(function(t){return t?(Ar(t.userId===n.userId),ra(n.serializer,t)):null})},ka.prototype.Eo=function(t,n){var r=this;return this._o[n]?Eu.resolve(this._o[n]):this.To(t,n).next(function(t){if(t){var e=t.keys();return r._o[n]=e}return null})},ka.prototype.Io=function(t,e){var r=this,i=e+1,n=IDBKeyRange.lowerBound([this.userId,i]),o=null;return Ca(t).Ii({index:za.userMutationsIndex,range:n},function(t,e,n){e.userId===r.userId&&(Ar(e.batchId>=i),o=ra(r.serializer,e)),n.done()}).next(function(){return o})},ka.prototype.Ao=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Ca(t).Ii({index:za.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},ka.prototype.Ro=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ca(t).hi(za.userMutationsIndex,n).next(function(t){return t.map(function(t){return ra(e.serializer,t)})})},ka.prototype.Vn=function(u,a){var h=this,t=Ha.prefixForPath(this.userId,a.path),e=IDBKeyRange.lowerBound(t),c=[];return Va(u).Ii({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=Bu(i);if(r===h.userId&&a.path.isEqual(s))return Ca(u).get(o).next(function(t){if(!t)throw Nr();Ar(t.userId===h.userId),c.push(ra(h.serializer,t))});n.done()}).next(function(){return c})},ka.prototype.vn=function(r,t){var a=this,h=new Ni(xr),i=[];return t.forEach(function(u){var t=Ha.prefixForPath(a.userId,u.path),e=IDBKeyRange.lowerBound(t),n=Va(r).Ii({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=Bu(i);r===a.userId&&u.path.isEqual(s)?h=h.add(o):n.done()});i.push(n)}),Eu.nn(i).next(function(){return a.mo(r,h)})},ka.prototype.$n=function(t,e){var u=this,a=e.path,h=a.length+1,n=Ha.prefixForPath(this.userId,a),r=IDBKeyRange.lowerBound(n),c=new Ni(xr);return Va(t).Ii({range:r},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=Bu(i);r===u.userId&&a.D(s)?s.length===h&&(c=c.add(o)):n.done()}).next(function(){return u.mo(t,c)})},ka.prototype.mo=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(Ca(e).get(t).next(function(t){if(null===t)throw Nr();Ar(t.userId===n.userId),r.push(ra(n.serializer,t))}))}),Eu.nn(i).next(function(){return r})},ka.prototype.Po=function(e,n){var r=this;return Ua(e.er,this.userId,n).next(function(t){return e.En(function(){r.Vo(n.batchId)}),Eu.forEach(t,function(t){return r.Fi.oo(e,t)})})},ka.prototype.Vo=function(t){delete this._o[t]},ka.prototype.po=function(n){var o=this;return this.do(n).next(function(t){if(!t)return Eu.resolve();var e=IDBKeyRange.lowerBound(Ha.prefixForUser(o.userId)),i=[];return Va(n).Ii({range:e},function(t,e,n){var r;t[0]===o.userId?(r=Bu(t[1]),i.push(r)):n.done()}).next(function(){Ar(0===i.length)})})},ka.prototype.tr=function(t,e){return La(t,this.userId,e)},ka.prototype.yo=function(t){var e=this;return Ma(t).get(this.userId).next(function(t){return t||new Qa(e.userId,-1,"")})},ka);function ka(t,e,n,r){this.userId=t,this.serializer=e,this.mn=n,this.Fi=r,this._o={}}function La(t,o,e){var n=Ha.prefixForPath(o,e.path),s=n[1],r=IDBKeyRange.lowerBound(n),u=!1;return Va(t).Ii({range:r,Zi:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function Ua(t,e,n){var r=t.store(za.store),i=t.store(Ha.store),o=[],s=IDBKeyRange.only(n.batchId),u=0,a=r.Ii({range:s},function(t,e,n){return u++,n.delete()});o.push(a.next(function(){Ar(1===u)}));for(var h=[],c=0,f=n.mutations;c<f.length;c++){var l=f[c],p=Ha.key(e,l.key.path,n.batchId);o.push(i.delete(p)),h.push(l.key)}return Eu.nn(o).next(function(){return h})}function Ca(t){return _a.ai(t,za.store)}function Va(t){return _a.ai(t,Ha.store)}function Ma(t){return _a.ai(t,Qa.store)}var Fa=10,qa=(Ga.prototype.createOrUpgrade=function(n,r,t,e){var i=this;Ar(t<e&&0<=t&&e<=Fa);var o,s=new ph(r);t<1&&1<=e&&(n.createObjectStore(Ba.store),(o=n).createObjectStore(Qa.store,{keyPath:Qa.keyPath}),o.createObjectStore(za.store,{keyPath:za.keyPath,autoIncrement:!0}).createIndex(za.userMutationsIndex,za.userMutationsKeyPath,{unique:!0}),o.createObjectStore(Ha.store),nh(n),n.createObjectStore(Ya.store));var u,a=Eu.resolve();return t<3&&3<=e&&(0!==t&&((u=n).deleteObjectStore(Za.store),u.deleteObjectStore(Ja.store),u.deleteObjectStore(th.store),nh(n)),a=a.next(function(){return t=s.store(th.store),e=new th(0,0,zr.min().R(),0),t.put(th.key,e);var t,e})),t<4&&4<=e&&(0!==t&&(a=a.next(function(){return r=n,(i=s).store(za.store).hi().next(function(t){r.deleteObjectStore(za.store),r.createObjectStore(za.store,{keyPath:za.keyPath,autoIncrement:!0}).createIndex(za.userMutationsIndex,za.userMutationsKeyPath,{unique:!0});var e=i.store(za.store),n=t.map(function(t){return e.put(t)});return Eu.nn(n)});var r,i})),a=a.next(function(){n.createObjectStore(rh.store,{keyPath:rh.keyPath})})),t<5&&5<=e&&(a=a.next(function(){return i.removeAcknowledgedMutations(s)})),t<6&&6<=e&&(a=a.next(function(){return n.createObjectStore($a.store),i.addDocumentGlobal(s)})),t<7&&7<=e&&(a=a.next(function(){return i.ensureSequenceNumbers(s)})),t<8&&8<=e&&(a=a.next(function(){return i.createCollectionParentIndex(n,s)})),t<9&&9<=e&&(a=a.next(function(){var t,e;(e=n).objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges"),(t=r.objectStore(Ya.store)).createIndex(Ya.readTimeIndex,Ya.readTimeIndexPath,{unique:!1}),t.createIndex(Ya.collectionReadTimeIndex,Ya.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=e&&(a=a.next(function(){return i.rewriteCanonicalIds(s)})),a},Ga.prototype.addDocumentGlobal=function(e){var n=0;return e.store(Ya.store).Ii(function(t,e){n+=la(e)}).next(function(){var t=new $a(n);return e.store($a.store).put($a.key,t)})},Ga.prototype.removeAcknowledgedMutations=function(r){var i=this,t=r.store(Qa.store),e=r.store(za.store);return t.hi().next(function(t){return Eu.forEach(t,function(n){var t=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return e.hi(za.userMutationsIndex,t).next(function(t){return Eu.forEach(t,function(t){Ar(t.userId===n.userId);var e=ra(i.serializer,t);return Ua(r,n.userId,e).next(function(){})})})})})},Ga.prototype.ensureSequenceNumbers=function(t){var s=t.store(Za.store),e=t.store(Ya.store);return t.store(th.store).get(th.key).next(function(i){var o=[];return e.Ii(function(t,e){var n=new Wr(t),r=[0,Fu(n)];o.push(s.get(r).next(function(t){return t?Eu.resolve():s.put(new Za(0,Fu(n),i.highestListenSequenceNumber))}))}).next(function(){return Eu.nn(o)})})},Ga.prototype.createCollectionParentIndex=function(t,e){function r(t){if(o.add(t)){var e=t.S(),n=t.p();return i.put({collectionId:e,parent:Fu(n)})}}t.createObjectStore(eh.store,{keyPath:eh.keyPath});var i=e.store(eh.store),o=new Qu;return e.store(Ya.store).Ii({Zi:!0},function(t,e){return r(new Wr(t).p())}).next(function(){return e.store(Ha.store).Ii({Zi:!0},function(t,e){t[0];var n=t[1];return r((t[2],Bu(n)).p())})})},Ga.prototype.rewriteCanonicalIds=function(t){var i=this,o=t.store(Ja.store);return o.Ii(function(t,e){var n=ia(e),r=oa(i.serializer,n);return o.put(r)})},Ga),ja=function(t,e){this.seconds=t,this.nanoseconds=e},Ba=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};function Ga(t){this.serializer=t}Ba.store="owner",Ba.key="owner";var Qa=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Qa.store="mutationQueues",Qa.keyPath="userId";var za=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};za.store="mutations",za.keyPath="batchId",za.userMutationsIndex="userMutationsIndex",za.userMutationsKeyPath=["userId","batchId"];var Ha=(Wa.prefixForUser=function(t){return[t]},Wa.prefixForPath=function(t,e){return[t,Fu(e)]},Wa.key=function(t,e,n){return[t,Fu(e),n]},Wa);function Wa(){}Ha.store="documentMutations",Ha.PLACEHOLDER=new Ha;var Ka=function(t,e){this.path=t,this.readTime=e},Xa=function(t,e){this.path=t,this.version=e},Ya=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Ya.store="remoteDocuments",Ya.readTimeIndex="readTimeIndex",Ya.readTimeIndexPath="readTime",Ya.collectionReadTimeIndex="collectionReadTimeIndex",Ya.collectionReadTimeIndexPath=["parentPath","readTime"];var $a=function(t){this.byteSize=t};$a.store="remoteDocumentGlobal",$a.key="remoteDocumentGlobalKey";var Ja=function(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s};Ja.store="targets",Ja.keyPath="targetId",Ja.queryTargetsIndexName="queryTargetsIndex",Ja.queryTargetsKeyPath=["canonicalId","targetId"];var Za=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Za.store="targetDocuments",Za.keyPath=["targetId","path"],Za.documentTargetsIndex="documentTargetsIndex",Za.documentTargetsKeyPath=["path","targetId"];var th=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};th.key="targetGlobalKey",th.store="targetGlobal";var eh=function(t,e){this.collectionId=t,this.parent=e};function nh(t){t.createObjectStore(Za.store,{keyPath:Za.keyPath}).createIndex(Za.documentTargetsIndex,Za.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Ja.store,{keyPath:Ja.keyPath}).createIndex(Ja.queryTargetsIndexName,Ja.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(th.store)}eh.store="collectionParents",eh.keyPath=["collectionId","parent"];var rh=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};rh.store="clientMetadata",rh.keyPath="clientId";var ih,oh=d(d(d([Qa.store,za.store,Ha.store,Ya.store,Ja.store,Ba.store,th.store,Za.store],[rh.store]),[$a.store]),[eh.store]),sh=(fh.Ir=function(o,t,s){return Ir("SimpleDb","Opening database:",o),new Eu(function(n,r){var i=indexedDB.open(o,t);i.onsuccess=function(t){var e=t.target.result;n(new fh(e))},i.onblocked=function(){r(new Gr(Br.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(t){var e=t.target.error;"VersionError"===e.name?r(new Gr(Br.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(e)},i.onupgradeneeded=function(t){Ir("SimpleDb",'Database "'+o+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;s.createOrUpgrade(e,i.transaction,t.oldVersion,Fa).next(function(){Ir("SimpleDb","Database upgrade to version "+Fa+" complete")})}}).en()},fh.delete=function(t){return Ir("SimpleDb","Removing database:",t),gh(window.indexedDB.deleteDatabase(t)).en()},fh._r=function(){if("undefined"==typeof indexedDB)return!1;if(fh.vo())return!0;var t=g(),e=fh.bo(t),n=0<e&&e<10,r=fh.So(t),i=0<r&&r<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||i)},fh.vo=function(){var t;return"undefined"!=typeof __PRIVATE_process&&"YES"===(null===(t=__PRIVATE_process.__PRIVATE_env)||void 0===t?void 0:t.Do)},fh.ai=function(t,e){return t.store(e)},fh.bo=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},fh.So=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},fh.prototype.br=function(e){this.db.onversionchange=function(t){return e(t)}},fh.prototype.runTransaction=function(r,h,c){return y(this,void 0,void 0,function(){var s,u,e,a,n;return v(this,function(t){switch(t.label){case 0:s="readonly"===r,u=0,e=function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:++u,e=ph.open(a.db,s?"readonly":"readwrite",h),t.label=1;case 1:return t.trys.push([1,3,,4]),n=c(e).catch(function(t){return e.abort(t),Eu.reject(t)}).en(),r={},n.catch(function(){}),[4,e.Co];case 2:return[2,(r.value=(t.sent(),n),r)];case 3:return i=t.sent(),o="FirebaseError"!==i.name&&u<3,Ir("SimpleDb","Transaction failed with error: %s. Retrying: %s.",i.message,o),o?[3,4]:[2,{value:Promise.reject(i)}];case 4:return[2]}})},a=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(n=t.sent()))return[2,n.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},fh.prototype.close=function(){this.db.close()},fh),uh=(Object.defineProperty(ch.prototype,"Js",{get:function(){return this.No},enumerable:!0,configurable:!0}),Object.defineProperty(ch.prototype,"ko",{get:function(){return this.$o},enumerable:!0,configurable:!0}),Object.defineProperty(ch.prototype,"cursor",{set:function(t){this.Fo=t},enumerable:!0,configurable:!0}),ch.prototype.done=function(){this.No=!0},ch.prototype.Ai=function(t){this.$o=t},ch.prototype.delete=function(){return gh(this.Fo.delete())},ch),ah=(n(hh,ih=Gr),hh);function hh(t){var e=this;return(e=ih.call(this,Br.UNAVAILABLE,"IndexedDB transaction failed: "+t)||this).name="IndexedDbTransactionError",e}function ch(t){this.Fo=t,this.No=!1,this.$o=null}function fh(t){this.db=t,12.2===fh.bo(g())&&Tr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function lh(t){return"IndexedDbTransactionError"===t.name}var ph=(vh.open=function(t,e,n){return new vh(t.transaction(n,e))},Object.defineProperty(vh.prototype,"Co",{get:function(){return this.xo.promise},enumerable:!0,configurable:!0}),vh.prototype.abort=function(t){t&&this.xo.reject(t),this.aborted||(Ir("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},vh.prototype.store=function(t){var e=this.transaction.objectStore(t);return new dh(e)},vh),dh=(yh.prototype.put=function(t,e){return gh(void 0!==e?(Ir("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Ir("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},yh.prototype.add=function(t){return Ir("SimpleDb","ADD",this.store.name,t,t),gh(this.store.add(t))},yh.prototype.get=function(e){var n=this;return gh(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Ir("SimpleDb","GET",n.store.name,e,t),t})},yh.prototype.delete=function(t){return Ir("SimpleDb","DELETE",this.store.name,t),gh(this.store.delete(t))},yh.prototype.count=function(){return Ir("SimpleDb","COUNT",this.store.name),gh(this.store.count())},yh.prototype.hi=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.Mo(n,function(t,e){r.push(e)}).next(function(){return r})},yh.prototype.Lo=function(t,e){Ir("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.Zi=!1;var r=this.cursor(n);return this.Mo(r,function(t,e,n){return n.delete()})},yh.prototype.Ii=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.Mo(r,e)},yh.prototype.ao=function(i){var t=this.cursor({});return new Eu(function(n,r){t.onerror=function(t){var e=wh(t.target.error);r(e)},t.onsuccess=function(t){var e=t.target.result;e?i(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},yh.prototype.Mo=function(t,s){var u=[];return new Eu(function(o,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n,r,i=t.target.result;i?(e=new uh(i),(n=s(i.primaryKey,i.value,e))instanceof Eu&&(r=n.catch(function(t){return e.done(),Eu.reject(t)}),u.push(r)),e.Js?o():null===e.ko?i.continue():i.continue(e.ko)):o()}}).next(function(){return Eu.nn(u)})},yh.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},yh.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Zi?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},yh);function yh(t){this.store=t}function vh(t){var n=this;this.transaction=t,this.aborted=!1,this.xo=new Cu,this.transaction.oncomplete=function(){n.xo.resolve()},this.transaction.onabort=function(){t.error?n.xo.reject(new ah(t.error)):n.xo.resolve()},this.transaction.onerror=function(t){var e=wh(t.target.error);n.xo.reject(new ah(e))}}function gh(t){return new Eu(function(n,r){t.onsuccess=function(t){var e=t.target.result;n(e)},t.onerror=function(t){var e=wh(t.target.error);r(e)}})}var mh=!1;function wh(t){var e=sh.bo(g());if(12.2<=e&&e<13){var n="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(n)){var r=new Gr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return mh||(mh=!0,setTimeout(function(){throw r},0)),r}}return t}function bh(){return"undefined"!=typeof window?window:null}var Eh=(_h.Qo=function(t,e,n,r,i){var o=new _h(t,e,Date.now()+n,r,i);return o.start(n),o},_h.prototype.start=function(t){var e=this;this.Wo=setTimeout(function(){return e.jo()},t)},_h.prototype.ni=function(){return this.jo()},_h.prototype.cancel=function(t){null!==this.Wo&&(this.clearTimeout(),this.Uo.reject(new Gr(Br.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},_h.prototype.jo=function(){var e=this;this.Oo.Sr(function(){return null!==e.Wo?(e.clearTimeout(),e.op().then(function(t){return e.Uo.resolve(t)})):Promise.resolve()})},_h.prototype.clearTimeout=function(){null!==this.Wo&&(this.qo(this),clearTimeout(this.Wo),this.Wo=null)},_h),Ih=(Object.defineProperty(Th.prototype,"eh",{get:function(){return this.zo},enumerable:!0,configurable:!0}),Th.prototype.Sr=function(t){this.enqueue(t)},Th.prototype.sh=function(t){this.nh(),this.ih(t)},Th.prototype.rh=function(t){return this.nh(),this.ih(t)},Th.prototype.oh=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.nh(),this.zo?[3,2]:(this.zo=!0,(e=bh())&&e.removeEventListener("visibilitychange",this.th),[4,this.rh(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Th.prototype.enqueue=function(t){return this.nh(),this.zo?new Promise(function(t){}):this.ih(t)},Th.prototype.Cr=function(i){var t=this;this.nh(),this.zo||(this.Go=this.Go.then(function(){var n=new Cu,r=function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,i()];case 1:return t.sent(),n.resolve(),this.Zo.reset(),[3,3];case 2:if(!lh(e=t.sent()))throw n.resolve(),e;return Ir("AsyncQueue","Operation failed with retryable error: "+e),this.Zo.Zn(r),[3,3];case 3:return[2]}})})};return t.Sr(r),n.promise}))},Th.prototype.ih=function(t){var r=this,e=this.Ko.then(function(){return r.Jo=!0,t().catch(function(t){throw r.Yo=t,r.Jo=!1,Tr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Jo=!1,t})});return this.Ko=e},Th.prototype.ei=function(t,e,n){var r=this;this.nh(),-1<this.Xo.indexOf(t)&&(e=0);var i=Eh.Qo(this,t,e,n,function(t){return r.hh(t)});return this.Ho.push(i),i},Th.prototype.nh=function(){this.Yo&&Nr()},Th.prototype.ah=function(){},Th.prototype.uh=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Ko];case 1:t.sent(),t.label=2;case 2:if(e!==this.Ko)return[3,0];t.label=3;case 3:return[2]}})})},Th.prototype.lh=function(t){for(var e=0,n=this.Ho;e<n.length;e++)if(n[e].jn===t)return!0;return!1},Th.prototype._h=function(r){var i=this;return this.uh().then(function(){i.Ho.sort(function(t,e){return t.Bo-e.Bo});for(var t=0,e=i.Ho;t<e.length;t++){var n=e[t];if(n.ni(),"all"!==r&&n.jn===r)break}return i.uh()})},Th.prototype.fh=function(t){this.Xo.push(t)},Th.prototype.hh=function(t){var e=this.Ho.indexOf(t);this.Ho.splice(e,1)},Th);function Th(){var t=this;this.Ko=Promise.resolve(),this.Go=Promise.resolve(),this.zo=!1,this.Ho=[],this.Yo=null,this.Jo=!1,this.Xo=[],this.Zo=new Vu(this,"async_queue_retry"),this.th=function(){return t.Zo.si()};var e=bh();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.th)}function _h(t,e,n,r,i){this.Oo=t,this.jn=e,this.Bo=n,this.op=r,this.qo=i,this.Uo=new Cu,this.then=this.Uo.promise.then.bind(this.Uo.promise),this.Uo.promise.catch(function(t){})}function Nh(t,e){if(Tr("AsyncQueue",e+": "+t),lh(t))return new Gr(Br.UNAVAILABLE,e+": "+t);throw t}function Ah(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=xr(n,i);return 0===s?xr(r,o):s}var Sh=(Ph.prototype.Th=function(){return++this.wh},Ph.prototype.Eh=function(t){var e,n=[t,this.Th()];this.buffer.size<this.dh?this.buffer=this.buffer.add(n):Ah(n,e=this.buffer.last())<0&&(this.buffer=this.buffer.delete(e).add(n))},Object.defineProperty(Ph.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),Ph),Dh={Ih:!1,Ah:0,Rh:0,mh:0},Oh=(xh.ph=function(t){return new xh(t,xh.yh,xh.bh)},xh);function xh(t,e,n){this.Ph=t,this.Vh=e,this.gh=n}function Ph(t){this.dh=t,this.buffer=new Ni(Ah),this.wh=0}Oh.vh=-1,Oh.Sh=1048576,Oh.Dh=41943040,Oh.yh=10,Oh.bh=1e3,Oh.Ch=new Oh(Oh.Dh,Oh.yh,Oh.bh),Oh.DISABLED=new Oh(Oh.vh,0,0);var Rh=(Vh.prototype.start=function(t){this.eo.$h.Ph!==Oh.vh&&this.kh(t)},Vh.prototype.stop=function(){this.Nh&&(this.Nh.cancel(),this.Nh=null)},Object.defineProperty(Vh.prototype,"pr",{get:function(){return null!==this.Nh},enumerable:!0,configurable:!0}),Vh.prototype.kh=function(n){var t=this,e=this.Fh?3e5:6e4;Ir("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.Nh=this.Oo.ei("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.Nh=null,this.Fh=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.xh(this.eo)];case 2:return t.sent(),[3,7];case 3:return lh(e=t.sent())?(Ir("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,jh(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.kh(n)];case 8:return t.sent(),[2]}})})})},Vh),kh=(Ch.prototype.Lh=function(t,e){return this.Mh.so(t).next(function(t){return Math.floor(e/100*t)})},Ch.prototype.Oh=function(t,e){var n=this;if(0===e)return Eu.resolve(Su.Qn);var r=new Sh(e);return this.Mh.ye(t,function(t){return r.Eh(t.sequenceNumber)}).next(function(){return n.Mh.io(t,function(t){return r.Eh(t)})}).next(function(){return r.maxValue})},Ch.prototype.ji=function(t,e,n){return this.Mh.ji(t,e,n)},Ch.prototype.uo=function(t,e){return this.Mh.uo(t,e)},Ch.prototype.Bh=function(e,n){var r=this;return this.$h.Ph===Oh.vh?(Ir("LruGarbageCollector","Garbage collection skipped; disabled"),Eu.resolve(Dh)):this.lo(e).next(function(t){return t<r.$h.Ph?(Ir("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.$h.Ph),Dh):r.qh(e,n)})},Ch.prototype.lo=function(t){return this.Mh.lo(t)},Ch.prototype.qh=function(e,n){var r,i,o,s,u,a,h,c=this,f=Date.now();return this.Lh(e,this.$h.Vh).next(function(t){return i=t>c.$h.gh?(Ir("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.$h.gh+" from "+t),c.$h.gh):t,s=Date.now(),c.Oh(e,i)}).next(function(t){return r=t,u=Date.now(),c.ji(e,r,n)}).next(function(t){return o=t,a=Date.now(),c.uo(e,r)}).next(function(t){return h=Date.now(),Er()<=p.DEBUG&&Ir("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(h-a)+"ms\nTotal Duration: "+(h-f)+"ms"),Eu.resolve({Ih:!0,Ah:i,Rh:o,mh:t})})},Ch),Lh=(Uh.prototype.start=function(){return Promise.resolve()},Uh.prototype.Hh=function(i){return y(this,void 0,void 0,function(){var e,m,n,r=this;return v(this,function(t){switch(t.label){case 0:return e=this.Rn,m=this.Gh,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return r.Rn.Ro(v).next(function(t){return g=t,e=r.persistence.zr(i),m=new Nu(r.Kh,e,r.persistence.Xr()),e.Ro(v)}).next(function(t){for(var e=[],n=[],r=ki(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,f=t;c<f.length;c++){var l=f[c];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.yn(v,r).next(function(t){return{Yh:t,Jh:e,Xh:n}})})})];case 1:return n=t.sent(),[2,(this.Rn=e,this.Gh=m,this.Uh.zh(this.Gh),n)]}})})},Uh.prototype.Zh=function(u){var a,h=this,c=Qr.now(),t=u.reduce(function(t,e){return t.add(e.key)},ki());return this.persistence.runTransaction("Locally write mutations","readwrite",function(s){return h.Gh.yn(s,t).next(function(t){a=t;for(var e=[],n=0,r=u;n<r.length;n++){var i=r[n],o=i.Ze(a.get(i.key));null!=o&&e.push(new ls(i.key,o,Os(o.proto.mapValue),hs.exists(!0)))}return h.Rn.wo(s,c,e,u)})}).then(function(t){var e=t.Ks(a);return{batchId:t.batchId,on:e}})},Uh.prototype.ta=function(r){var i=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=r.batch.keys(),n=i.Kh.Vi({pi:!0});return i.ea(t,r,n).next(function(){return n.apply(t)}).next(function(){return i.Rn.po(t)}).next(function(){return i.Gh.yn(t,e)})})},Uh.prototype.sa=function(t){var r=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return r.Rn.To(e,t).next(function(t){return Ar(null!==t),n=t.keys(),r.Rn.Po(e,t)}).next(function(){return r.Rn.po(e)}).next(function(){return r.Gh.yn(e,n)})})},Uh.prototype.Ao=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.Rn.Ao(t)})},Uh.prototype.xi=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Tr.xi(t)})},Uh.prototype.na=function(a){var h=this,c=a.J,f=this.Qh;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var i=h.Kh.Vi({pi:!0});f=h.Qh;var s=[];a.Qt.forEach(function(t,e){var n,r,i=f.get(e);i&&(s.push(h.Tr.Yi(o,t.Xt,e).next(function(){return h.Tr.zi(o,t.Yt,e)})),0<(n=t.resumeToken).G()&&(r=i.Z(n,c).X(o.sr),f=f.et(e,r),Uh.ia(i,r,t)&&s.push(h.Tr.Ui(o,r))))});var t,u=Si,n=ki();return a.jt.forEach(function(t,e){n=n.add(t)}),s.push(i.getEntries(o,n).next(function(r){a.jt.forEach(function(t,e){var n=r.get(t);e instanceof js&&e.version.isEqual(zr.min())?(i.ln(t,c),u=u.et(t,e)):null==n||0<e.version.o(n.version)||0===e.version.o(n.version)&&n.hasPendingWrites?(i.un(e,c),u=u.et(t,e)):Ir("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Kt.has(t)&&s.push(h.persistence.Fi.co(o,t))})})),c.isEqual(zr.min())||(t=h.Tr.xi(o).next(function(t){return h.Tr.Li(o,o.sr,c)}),s.push(t)),Eu.nn(s).next(function(){return i.apply(o)}).next(function(){return h.Gh.bn(o,u)})}).then(function(t){return h.Qh=f,t})},Uh.ia=function(t,e,n){return Ar(0<e.resumeToken.G()),0===t.resumeToken.G()||e.J.A()-t.J.A()>=this.ra||0<n.Yt.size+n.Jt.size+n.Xt.size},Uh.prototype.oa=function(c){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return Eu.forEach(c,function(e){return Eu.forEach(e.xn,function(t){return h.persistence.Fi.Hi(n,e.targetId,t)}).next(function(){return Eu.forEach(e.Mn,function(t){return h.persistence.Fi.Ji(n,e.targetId,t)})})})})];case 1:return t.sent(),[3,3];case 2:if(!lh(e=t.sent()))throw e;return Ir("LocalStore","Failed to update sequence numbers: "+e),[3,3];case 3:for(n=0,r=c;n<r.length;n++)i=r[n],o=i.targetId,i.fromCache||(s=this.Qh.get(o),u=s.J,a=s.tt(u),this.Qh=this.Qh.et(o,a));return[2]}})})},Uh.prototype.ha=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.Rn.Io(t,e)})},Uh.prototype.aa=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.Gh.Pn(t,e)})},Uh.prototype.ua=function(r){var i=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Tr.Gi(e,r).next(function(t){return t?(n=t,Eu.resolve(n)):i.Tr.Ni(e).next(function(t){return n=new di(r,t,0,e.sr),i.Tr.Oi(e,n).next(function(){return n})})})}).then(function(t){var e=i.Qh.get(t.targetId);return(null===e||0<t.J.o(e.J))&&(i.Qh=i.Qh.et(t.targetId,t),i.Wh.set(r,t.targetId)),t})},Uh.prototype.Gi=function(t,e){var n=this.Wh.get(e);return void 0!==n?Eu.resolve(this.Qh.get(n)):this.Tr.Gi(t,e)},Uh.prototype.ca=function(t,e){var n=this,r=this.Qh.get(t),i=e?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release target",i,function(t){return e?Eu.resolve():n.persistence.Fi.removeTarget(t,r)}).then(function(){n.Qh=n.Qh.remove(t),n.Wh.delete(r.target)})},Uh.prototype.la=function(t,n){var r=this,i=zr.min(),o=ki();return this.persistence.runTransaction("Execute query","readonly",function(e){return r.Gi(e,t.We()).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.Tr.Xi(e,t.targetId).next(function(t){o=t})}).next(function(){return r.Uh.Sn(e,t,n?i:zr.min(),n?o:ki())}).next(function(t){return{documents:t,_a:o}})})},Uh.prototype.ea=function(t,i,o){var e=this,s=i.batch,n=s.keys(),u=Eu.resolve();return n.forEach(function(r){u=u.next(function(){return o._n(t,r)}).next(function(t){var e=t,n=i.zs.get(r);Ar(null!==n),(!e||e.version.o(n)<0)&&(e=s.Ke(r,e,i))&&o.un(e,i.Gs)})}),u.next(function(){return e.Rn.Po(t,s)})},Uh.prototype.xh=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Bh(t,n.Qh)})},Uh);function Uh(t,e,n){this.persistence=t,this.Uh=e,this.Qh=new mi(xr),this.Wh=new jr(vu,gu),this.jh=zr.min(),this.Rn=t.zr(n),this.Kh=t.Jr(),this.Tr=t.Yr(),this.Gh=new Nu(this.Kh,this.Rn,this.persistence.Xr()),this.Uh.zh(this.Gh)}function Ch(t,e){this.Mh=t,this.$h=e}function Vh(t,e){this.eo=t,this.Oo=e,this.Fh=!1,this.Nh=null}Lh.ra=3e8;var Mh,Fh=(n(qh,Mh=Lh),qh.prototype.start=function(){return this.fa()},qh.prototype.da=function(t){var n=this;return this.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return n.Rn.Eo(e,t).next(function(t){return t?n.Gh.yn(e,t):Eu.resolve(null)})})},qh.prototype.wa=function(t){this.Rn.Vo(t)},qh.prototype.vr=function(t){this.persistence.vr(t)},qh.prototype.Gr=function(){return this.persistence.Gr()},qh.prototype.Ta=function(e){var n=this,t=this.Qh.get(e);return t?Promise.resolve(t.target):this.persistence.runTransaction("Get target data","readonly",function(t){return n.Tr.Me(t,e).next(function(t){return t?t.target:null})})},qh.prototype.Ri=function(){var r=this;return this.persistence.runTransaction("Get new document changes","readonly",function(t){return r.Kh.Ri(t,r.jh)}).then(function(t){var e=t.mi,n=t.readTime;return r.jh=n,e})},qh.prototype.fa=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,(e=this).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return n.Kh.Pi(t)})];case 1:return e.jh=t.sent(),[2]}})})},qh);function qh(t,e,n){var r=this;return(r=Mh.call(this,t,e,n)||this).persistence=t,r.Rn=t.zr(n),r.Kh=t.Jr(),r.Tr=t.Yr(),r}function jh(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Br.FAILED_PRECONDITION||e.message!==Tu)throw e;return Ir("LocalStore","Unexpectedly lost primary lease"),[2]})})}var Bh=(zh.prototype._=function(){return this.Ea._()},zh.prototype.Hi=function(t,e){var n=new Gh(t,e);this.Ea=this.Ea.add(n),this.Aa=this.Aa.add(n)},zh.prototype.ma=function(t,e){var n=this;t.forEach(function(t){return n.Hi(t,e)})},zh.prototype.Ji=function(t,e){this.Pa(new Gh(t,e))},zh.prototype.Va=function(t,e){var n=this;t.forEach(function(t){return n.Ji(t,e)})},zh.prototype.ga=function(t){var e=this,n=ii.EMPTY,r=new Gh(n,t),i=new Gh(n,t+1),o=[];return this.Aa.vt([r,i],function(t){e.Pa(t),o.push(t.key)}),o},zh.prototype.pa=function(){var e=this;this.Ea.forEach(function(t){return e.Pa(t)})},zh.prototype.Pa=function(t){this.Ea=this.Ea.delete(t),this.Aa=this.Aa.delete(t)},zh.prototype.ya=function(t){var e=ii.EMPTY,n=new Gh(e,t),r=new Gh(e,t+1),i=ki();return this.Aa.vt([n,r],function(t){i=i.add(t.key)}),i},zh.prototype.tr=function(t){var e=new Gh(t,0),n=this.Ea.Dt(e);return null!==n&&t.isEqual(n.key)},zh),Gh=(Qh.Ia=function(t,e){return ii.P(t.key,e.key)||xr(t.ba,e.ba)},Qh.Ra=function(t,e){return xr(t.ba,e.ba)||ii.P(t.key,e.key)},Qh);function Qh(t,e){this.key=t,this.ba=e}function zh(){this.Ea=new Ni(Gh.Ia),this.Aa=new Ni(Gh.Ra)}function Hh(t,e){if(0!==e.length)throw new Gr(Br.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+cc(e.length,"argument")+".")}function Wh(t,e,n){if(e.length!==n)throw new Gr(Br.INVALID_ARGUMENT,"Function "+t+"() requires "+cc(n,"argument")+", but was called with "+cc(e.length,"argument")+".")}function Kh(t,e,n){if(e.length<n)throw new Gr(Br.INVALID_ARGUMENT,"Function "+t+"() requires at least "+cc(n,"argument")+", but was called with "+cc(e.length,"argument")+".")}function Xh(t,e,n,r){if(e.length<n||e.length>r)throw new Gr(Br.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+cc(e.length,"argument")+".")}function Yh(t,e,n,r){nc(t,e,hc(n)+" argument",r)}function $h(t,e,n,r){void 0!==r&&Yh(t,e,n,r)}function Jh(t,e,n,r){nc(t,e,n+" option",r)}function Zh(t,e,n,r){void 0!==r&&Jh(t,e,n,r)}function tc(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(ic(s))}var u=ic(n);throw new Gr(Br.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function ec(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Gr(Br.INVALID_ARGUMENT,"Invalid value "+ic(r)+" provided to function "+t+"() for its "+hc(n)+" argument. Acceptable values: "+e.join(", "));return r}function nc(t,e,n,r){if(!("object"===e?rc(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=ic(r);throw new Gr(Br.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function rc(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function ic(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Nr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function oc(t,e,n){if(void 0===n)throw new Gr(Br.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+hc(e)+" argument, but it was undefined.")}function sc(n,t,r){Vr(t,function(t,e){if(r.indexOf(t)<0)throw new Gr(Br.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function uc(t,e,n,r){var i=ic(r);return new Gr(Br.INVALID_ARGUMENT,"Function "+t+"() requires its "+hc(n)+" argument to be a "+e+", but it was: "+i)}function ac(t,e,n){if(n<=0)throw new Gr(Br.INVALID_ARGUMENT,"Function "+t+"() requires its "+hc(e)+" argument to be a positive number, but it was: "+n+".")}function hc(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function cc(t,e){return t+" "+e+(1===t?"":"s")}function fc(){if("undefined"==typeof Uint8Array)throw new Gr(Br.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function lc(){if("undefined"==typeof atob)throw new Gr(Br.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function pc(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Gr(Br.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(Yh("FieldPath","string",e,t[e]),0===t[e].length)throw new Gr(Br.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Sa=new ni(t)}var dc,yc=(mc.fromBase64String=function(t){Wh("Blob.fromBase64String",arguments,1),Yh("Blob.fromBase64String","string",1,t),lc();try{return new mc(hi.fromBase64String(t))}catch(t){throw new Gr(Br.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},mc.fromUint8Array=function(t){if(Wh("Blob.fromUint8Array",arguments,1),fc(),!(t instanceof Uint8Array))throw uc("Blob.fromUint8Array","Uint8Array",1,t);return new mc(hi.fromUint8Array(t))},mc.prototype.toBase64=function(){return Wh("Blob.toBase64",arguments,0),lc(),this.va.toBase64()},mc.prototype.toUint8Array=function(){return Wh("Blob.toUint8Array",arguments,0),fc(),this.va.toUint8Array()},mc.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},mc.prototype.isEqual=function(t){return this.va.isEqual(t.va)},mc),vc=(n(gc,dc=pc),gc.documentId=function(){return gc.Da},gc.prototype.isEqual=function(t){if(!(t instanceof gc))throw uc("isEqual","FieldPath",1,t);return this.Sa.isEqual(t.Sa)},gc);function gc(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return dc.call(this,t)||this}function mc(t){lc(),this.va=t}vc.Da=new vc(ni.O().N());var wc,bc,Ec,Ic,Tc,_c,Nc,Ac=new RegExp("[~\\*/\\[\\]]"),Sc=function(){this.Ca=this},Dc=(n(Gc,Nc=Sc),Gc.prototype.Na=function(t){if(2!==t.$a)throw 1===t.$a?t.ka(this.Fa+"() can only appear at the top level of your update data"):t.ka(this.Fa+"() cannot be used with set() unless you pass {merge:true}");return t.Oe.push(t.path),null},Gc.prototype.isEqual=function(t){return t instanceof Gc},Gc),Oc=(n(Bc,_c=Sc),Bc.prototype.Na=function(t){return new as(t.path,Ho.instance)},Bc.prototype.isEqual=function(t){return t instanceof Bc},Bc),xc=(n(jc,Tc=Sc),jc.prototype.Na=function(t){var e=new Jc({$a:3,methodName:this.Fa,Ma:!0},t.s,t.serializer,t.ignoreUndefinedProperties),n=this.xa.map(function(t){return nf(t,e)}),r=new Ko(n);return new as(t.path,r)},jc.prototype.isEqual=function(t){return this===t},jc),Pc=(n(qc,Ic=Sc),qc.prototype.Na=function(t){var e=new Jc({$a:3,methodName:this.Fa,Ma:!0},t.s,t.serializer,t.ignoreUndefinedProperties),n=this.xa.map(function(t){return nf(t,e)}),r=new Xo(n);return new as(t.path,r)},qc.prototype.isEqual=function(t){return this===t},qc),Rc=(n(Fc,Ec=Sc),Fc.prototype.Na=function(t){var e=new Jc({$a:3,methodName:this.Fa},t.s,t.serializer,t.ignoreUndefinedProperties),n=nf(this.La,e),r=new Yo(t.serializer,n);return new as(t.path,r)},Fc.prototype.isEqual=function(t){return this===t},Fc),kc=(n(Mc,bc=Sc),Mc.delete=function(){return Hh("FieldValue.delete",arguments),new Lc(new Dc("FieldValue.delete"))},Mc.serverTimestamp=function(){return Hh("FieldValue.serverTimestamp",arguments),new Lc(new Oc("FieldValue.serverTimestamp"))},Mc.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Kh("FieldValue.arrayUnion",arguments,1),new Lc(new xc("FieldValue.arrayUnion",t))},Mc.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Kh("FieldValue.arrayRemove",arguments,1),new Lc(new Pc("FieldValue.arrayRemove",t))},Mc.increment=function(t){return Yh("FieldValue.increment","number",1,t),Wh("FieldValue.increment",arguments,1),new Lc(new Rc("FieldValue.increment",t))},Mc),Lc=(n(Vc,wc=kc),Vc.prototype.Na=function(t){return this.Ca.Na(t)},Vc.prototype.isEqual=function(t){return t instanceof Vc&&this.Ca.isEqual(t.Ca)},Vc),Uc=(Object.defineProperty(Cc.prototype,"latitude",{get:function(){return this.Oa},enumerable:!0,configurable:!0}),Object.defineProperty(Cc.prototype,"longitude",{get:function(){return this.Ba},enumerable:!0,configurable:!0}),Cc.prototype.isEqual=function(t){return this.Oa===t.Oa&&this.Ba===t.Ba},Cc.prototype.T=function(t){return xr(this.Oa,t.Oa)||xr(this.Ba,t.Ba)},Cc);function Cc(t,e){if(Wh("GeoPoint",arguments,2),Yh("GeoPoint","number",1,t),Yh("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Gr(Br.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Gr(Br.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Oa=t,this.Ba=e}function Vc(t){var e=this;return(e=wc.call(this)||this).Ca=t,e.Fa=t.Fa,e}function Mc(){return null!==bc&&bc.apply(this,arguments)||this}function Fc(t,e){var n=this;return(n=Ec.call(this)||this).Fa=t,n.La=e,n}function qc(t,e){var n=this;return(n=Ic.call(this)||this).Fa=t,n.xa=e,n}function jc(t,e){var n=this;return(n=Tc.call(this)||this).Fa=t,n.xa=e,n}function Bc(t){var e=this;return(e=_c.call(this)||this).Fa=t,e}function Gc(t){var e=this;return(e=Nc.call(this)||this).Fa=t,e}function Qc(t){return new Eo(t,!0)}var zc=/^__.*__$/,Hc=function(t,e,n){this.qa=t,this.Ua=e,this.Qa=n},Wc=(Yc.prototype.Wa=function(t,e){var n=[];return null!==this.Oe?n.push(new ls(t,this.data,this.Oe,e)):n.push(new fs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new ps(t,this.fieldTransforms)),n},Yc),Kc=(Xc.prototype.Wa=function(t,e){var n=[new ls(t,this.data,this.Oe,e)];return 0<this.fieldTransforms.length&&n.push(new ps(t,this.fieldTransforms)),n},Xc);function Xc(t,e,n){this.data=t,this.Oe=e,this.fieldTransforms=n}function Yc(t,e,n){this.data=t,this.Oe=e,this.fieldTransforms=n}function $c(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Nr()}}var Jc=(Object.defineProperty(ef.prototype,"path",{get:function(){return this.settings.path},enumerable:!0,configurable:!0}),Object.defineProperty(ef.prototype,"$a",{get:function(){return this.settings.$a},enumerable:!0,configurable:!0}),ef.prototype.Ka=function(t){return new ef(Object.assign(Object.assign({},this.settings),t),this.s,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Oe)},ef.prototype.Ga=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Ka({path:n,Ma:!1});return r.za(t),r},ef.prototype.Ha=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Ka({path:n,Ma:!1});return r.ja(),r},ef.prototype.Ya=function(t){return this.Ka({path:void 0,Ma:!0})},ef.prototype.ka=function(t){var e=!this.path||this.path._()?"":" (found in field "+this.path.toString()+")";return new Gr(Br.INVALID_ARGUMENT,"Function "+this.settings.methodName+"() called with invalid data. "+t+e)},ef.prototype.contains=function(e){return void 0!==this.Oe.find(function(t){return e.D(t)})||void 0!==this.fieldTransforms.find(function(t){return e.D(t.field)})},ef.prototype.ja=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.za(this.path.get(t))},ef.prototype.za=function(t){if(0===t.length)throw this.ka("Document fields must not be empty");if($c(this.$a)&&zc.test(t))throw this.ka('Document fields cannot begin and end with "__"')},ef),Zc=(tf.prototype.Ja=function(t,e,n){void 0===n&&(n={});var r=this.Xa(n.merge||n.mergeFields?2:0,t);sf("Data must be an object, but it was:",r,e);var i,o,s=rf(e,r);if(n.merge)i=new us(r.Oe),o=r.fieldTransforms;else if(n.mergeFields){for(var u=[],a=0,h=n.mergeFields;a<h.length;a++){var c=h[a],f=void 0;if(c instanceof pc)f=c.Sa;else{if("string"!=typeof c)throw Nr();f=af(t,c)}if(!r.contains(f))throw new Gr(Br.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");hf(u,f)||u.push(f)}i=new us(u),o=r.fieldTransforms.filter(function(t){return i.ze(t.field)})}else i=null,o=r.fieldTransforms;return new Wc(new vs(s),i,o)},tf.prototype.Za=function(o,t){var s=this.Xa(1,o);sf("Data must be an object, but it was:",s,t);var u=[],a=new gs;Vr(t,function(t,e){var n,r=af(o,t),i=s.Ha(r);e instanceof Sc&&e.Ca instanceof Dc?u.push(r):null!=(n=nf(e,i))&&(u.push(r),a.set(r,n))});var e=new us(u);return new Kc(a.ss(),e,s.fieldTransforms)},tf.prototype.tu=function(t,e,n,r){var i=this.Xa(1,t),o=[uf(t,e)],s=[n];if(r.length%2!=0)throw new Gr(Br.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var u=0;u<r.length;u+=2)o.push(uf(t,r[u])),s.push(r[u+1]);for(var a,h,c,f,l=[],p=new gs,d=o.length-1;0<=d;--d){hf(l,o[d])||(a=o[d],h=s[d],c=i.Ha(a),h instanceof Sc&&h.Ca instanceof Dc?l.push(a):null!=(f=nf(h,c))&&(l.push(a),p.set(a,f)))}var y=new us(l);return new Kc(p.ss(),y,i.fieldTransforms)},tf.prototype.Xa=function(t,e){return new Jc({$a:t,methodName:e,path:ni.k,Ma:!1},this.s,this.serializer,this.ignoreUndefinedProperties)},tf.prototype.eu=function(t,e,n){return void 0===n&&(n=!1),nf(e,this.Xa(n?4:3,t))},tf);function tf(t,e,n){this.s=t,this.ignoreUndefinedProperties=e,this.serializer=n||Qc(t)}function ef(t,e,n,r,i,o){this.settings=t,this.s=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.ja(),this.fieldTransforms=i||[],this.Oe=o||[]}function nf(s,t){if(of(s))return sf("Unsupported field value:",t,s),rf(s,t);if(s instanceof Sc)return function(t,e){if(!$c(e.$a))throw e.ka(t.Fa+"() can only be used with update() and set()");if(!e.path)throw e.ka(t.Fa+"() is not currently supported inside arrays");var n=t.Na(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Oe.push(t.path),s instanceof Array){if(t.settings.Ma&&4!==t.$a)throw t.ka("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=nf(i[r],t.Ya(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return n=e.serializer,ai(r=t)?Io(r):To(n,r);var n,r;if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var i=Qr.fromDate(t);return{timestampValue:_o(e.serializer,i)}}if(t instanceof Qr){var o=new Qr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:_o(e.serializer,o)}}if(t instanceof Uc)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof yc)return{bytesValue:No(e.serializer,t)};if(t instanceof Hc){var s=e.s,u=t.qa;if(!u.isEqual(s))throw e.ka("Document reference is for database "+u.projectId+"/"+u.database+" but should be for database "+s.projectId+"/"+s.database);return{referenceValue:Do(t.qa||e.s,t.Ua.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.ka("Unsupported field value: "+ic(t))}(s,t)}function rf(t,r){var i={};return Mr(t)?r.path&&0<r.path.length&&r.Oe.push(r.path):Vr(t,function(t,e){var n=nf(e,r.Ga(t));null!=n&&(i[t]=n)}),{mapValue:{fields:i}}}function of(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Qr||t instanceof Uc||t instanceof yc||t instanceof Hc||t instanceof Sc)}function sf(t,e,n){if(!of(n)||!rc(n)){var r=ic(n);throw"an object"===r?e.ka(t+" a custom object"):e.ka(t+" "+r)}}function uf(t,e){if(e instanceof pc)return e.Sa;if("string"==typeof e)return af(t,e);throw new Gr(Br.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function af(t,e){try{return function(e){if(0<=e.search(Ac))throw new Gr(Br.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(vc.bind.apply(vc,d([void 0],e.split("."))))}catch(t){throw new Gr(Br.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Sa}catch(e){var n=e instanceof Error?e.message:e.toString();throw new Gr(Br.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function hf(t,e){return t.some(function(t){return t.isEqual(e)})}var cf=(ff.prototype.fo=function(){return null!=this.uid},ff.prototype.su=function(){return this.fo()?"uid:"+this.uid:"anonymous-user"},ff.prototype.isEqual=function(t){return t.uid===this.uid},ff);function ff(t){this.uid=t}function lf(t,e){this.user=e,this.type="OAuth",this.ru={},this.ru.Authorization="Bearer "+t}cf.UNAUTHENTICATED=new cf(null),cf.nu=new cf("google-credentials-uid"),cf.iu=new cf("first-party-uid");var pf,df,yf,vf=(Vf.prototype.getToken=function(){return Promise.resolve(null)},Vf.prototype.hu=function(){},Vf.prototype.au=function(t){(this.ou=t)(cf.UNAUTHENTICATED)},Vf.prototype.uu=function(){this.ou=null},Vf),gf=(Cf.prototype.getToken=function(){var e=this,n=this._u,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e._u!==n?(Ir("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Ar("string"==typeof t.accessToken),new lf(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Cf.prototype.hu=function(){this.forceRefresh=!0},Cf.prototype.au=function(t){this.ou=t,this.lu&&t(this.currentUser)},Cf.prototype.uu=function(){this.auth&&this.auth.removeAuthTokenListener(this.cu),this.cu=null,this.ou=null},Cf.prototype.fu=function(){var t=this.auth&&this.auth.getUid();return Ar(null===t||"string"==typeof t),new cf(t)},Cf),mf=(Object.defineProperty(Uf.prototype,"ru",{get:function(){var t={"X-Goog-AuthUser":this.wu},e=this.du.auth.Tu([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),Uf),wf=(Lf.prototype.getToken=function(){return Promise.resolve(new mf(this.du,this.wu))},Lf.prototype.au=function(t){t(cf.iu)},Lf.prototype.uu=function(){},Lf.prototype.hu=function(){},Lf),bf=(kf.prototype.Pu=function(){return 1===this.state||2===this.state||4===this.state},kf.prototype.Vu=function(){return 2===this.state},kf.prototype.start=function(){3!==this.state?this.auth():this.gu()},kf.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Pu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},kf.prototype.pu=function(){this.state=0,this.Zo.reset()},kf.prototype.yu=function(){var t=this;this.Vu()&&null===this.mu&&(this.mu=this.Wn.ei(this.Eu,6e4,function(){return t.bu()}))},kf.prototype.vu=function(t){this.Su(),this.stream.send(t)},kf.prototype.bu=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.Vu()?[2,this.close(0)]:[2]})})},kf.prototype.Su=function(){this.mu&&(this.mu.cancel(),this.mu=null)},kf.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Su(),this.Zo.cancel(),this.Ru++,3!==e?this.Zo.reset():n&&n.code===Br.RESOURCE_EXHAUSTED?(Tr(n.toString()),Tr("Using maximum backoff delay to prevent overloading the backend."),this.Zo.Xn()):n&&n.code===Br.UNAUTHENTICATED&&this.Au.hu(),null!==this.stream&&(this.Du(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Cu(n)];case 1:return t.sent(),[2]}})})},kf.prototype.Du=function(){},kf.prototype.auth=function(){var n=this;this.state=1;var t=this.Fu(this.Ru),e=this.Ru;this.Au.getToken().then(function(t){n.Ru===e&&n.Nu(t)},function(e){t(function(){var t=new Gr(Br.UNKNOWN,"Fetching auth token failed: "+e.message);return n.$u(t)})})},kf.prototype.Nu=function(t){var e=this,n=this.Fu(this.Ru);this.stream=this.ku(t),this.stream.xu(function(){n(function(){return e.state=2,e.listener.xu()})}),this.stream.Cu(function(t){n(function(){return e.$u(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},kf.prototype.gu=function(){var t=this;this.state=4,this.Zo.Zn(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},kf.prototype.$u=function(t){return Ir("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},kf.prototype.Fu=function(e){var n=this;return function(t){n.Wn.Sr(function(){return n.Ru===e?t():(Ir("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},kf),Ef=(n(Rf,yf=bf),Rf.prototype.ku=function(t){return this.Iu.Mu("Listen",t)},Rf.prototype.onMessage=function(t){this.Zo.reset();var e=function(t,e){var n,r,i;if("targetChange"in e){e.targetChange;var o="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Nr(),s=e.targetChange.targetIds||[],u=Ao(t,e.targetChange.resumeToken),a=e.targetChange.cause,h=new Vi(o,s,u,a&&(r=void 0===(n=a).code?Br.UNKNOWN:gi(n.code),new Gr(r,n.message||""))||null)}else if("documentChange"in e){e.documentChange;var c=e.documentChange;c.document,c.document.name,c.document.updateTime;var f=Po(t,c.document.name),l=So(c.document.updateTime),p=new vs({mapValue:{fields:c.document.fields}}),d=new qs(f,l,p,{});h=new Ui(c.targetIds||[],c.removedTargetIds||[],d.key,d)}else if("documentDelete"in e){e.documentDelete;var y=e.documentDelete;y.document;var v=Po(t,y.document),g=y.readTime?So(y.readTime):zr.min(),m=new js(v,g);h=new Ui([],y.removedTargetIds||[],m.key,m)}else if("documentRemove"in e){e.documentRemove;var w=e.documentRemove;w.document;var b=Po(t,w.document);h=new Ui([],w.removedTargetIds||[],b,null)}else{if(!("filter"in e))return Nr();e.filter;var E=e.filter;E.targetId;var I=new fi(E.count||0);h=new Ci(E.targetId,I)}return h}(this.serializer,t),n=function(t){if(!("targetChange"in t))return zr.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?zr.min():So(e.readTime)}(t);return this.listener.Lu(e,n)},Rf.prototype.Ou=function(t){var e,n,r,i,o={};o.database=Lo(this.serializer),o.addTarget=(e=this.serializer,(r=mu(i=(n=t).target)?{documents:Fo(e,i)}:{query:qo(e,i)}).targetId=n.targetId,0<n.resumeToken.G()&&(r.resumeToken=No(e,n.resumeToken)),r);var s,u,a=(this.serializer,s=t,null==(u=function(){switch(s.Y){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Nr()}}())?null:{"goog-listen-tags":u});a&&(o.labels=a),this.vu(o)},Rf.prototype.Bu=function(t){var e={};e.database=Lo(this.serializer),e.removeTarget=t,this.vu(e)},Rf),If=(n(Pf,df=bf),Object.defineProperty(Pf.prototype,"Uu",{get:function(){return this.qu},enumerable:!0,configurable:!0}),Pf.prototype.start=function(){this.qu=!1,this.lastStreamToken=hi.H,df.prototype.start.call(this)},Pf.prototype.Du=function(){this.qu&&this.Qu([])},Pf.prototype.ku=function(t){return this.Iu.Mu("Write",t)},Pf.prototype.onMessage=function(t){if(Ar(!!t.streamToken),this.lastStreamToken=Ao(this.serializer,t.streamToken),this.qu){this.Zo.reset();var e=(r=t.writeResults,i=t.commitTime,r&&0<r.length?(Ar(void 0!==i),r.map(function(t){return function(t,e){var n=t.updateTime?So(t.updateTime):So(e);n.isEqual(zr.min())&&(n=So(e));var r=null;return t.transformResults&&0<t.transformResults.length&&(r=t.transformResults),new es(n,r)}(t,i)})):[]),n=So(t.commitTime);return this.listener.Wu(n,e)}var r,i;return Ar(!t.writeResults||0===t.writeResults.length),this.qu=!0,this.listener.ju()},Pf.prototype.Ku=function(){var t={};t.database=Lo(this.serializer),this.vu(t)},Pf.prototype.Qu=function(t){var e=this,n={streamToken:No(this.serializer,this.lastStreamToken),writes:t.map(function(t){return Vo(e.serializer,t)})};this.vu(n)},Pf),Tf=(n(xf,pf=function(){this.Gu=void 0}),xf.prototype.Hu=function(){if(this.zu)throw new Gr(Br.FAILED_PRECONDITION,"The client has already been terminated.")},xf.prototype.Yu=function(e,n){var r=this;return this.Hu(),this.credentials.getToken().then(function(t){return r.Iu.Yu(e,n,t)}).catch(function(t){throw t.code===Br.UNAUTHENTICATED&&r.credentials.hu(),t})},xf.prototype.Ju=function(e,n){var r=this;return this.Hu(),this.credentials.getToken().then(function(t){return r.Iu.Ju(e,n,t)}).catch(function(t){throw t.code===Br.UNAUTHENTICATED&&r.credentials.hu(),t})},xf),_f=(Of.prototype.nc=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.ic(),0<this.mutations.length)throw new Gr(Br.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var i,e,n,o,r;return v(this,function(t){switch(t.label){case 0:return e={database:Lo((i=s).serializer),documents:u.map(function(t){return xo(i.serializer,t)})},[4,i.Ju("BatchGetDocuments",e)];case 1:return n=t.sent(),o=new Map,n.forEach(function(t){var e,n,r=(e=i.serializer,"found"in(n=t)?function(t,e){Ar(!!e.found),e.found.name,e.found.updateTime;var n=Po(t,e.found.name),r=So(e.found.updateTime),i=new vs({mapValue:{fields:e.found.fields}});return new qs(n,r,i,{})}(e,n):"missing"in n?function(t,e){Ar(!!e.missing),Ar(!!e.readTime);var n=Po(t,e.missing),r=So(e.readTime);return new js(n,r)}(e,n):Nr());o.set(r.key.toString(),r)}),r=[],[2,(u.forEach(function(t){var e=o.get(t.toString());Ar(!!e),r.push(e)}),r)]}})})}(this.Xu,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof js||t instanceof qs?n.rc(t):Nr()}),e)]}})})},Of.prototype.set=function(t,e){this.write(e.Wa(t,this.Ue(t))),this.sc.add(t)},Of.prototype.update=function(t,e){try{this.write(e.Wa(t,this.oc(t)))}catch(t){this.ec=t}this.sc.add(t)},Of.prototype.delete=function(t){this.write([new ds(t,this.Ue(t))]),this.sc.add(t)},Of.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,r=this;return v(this,function(t){switch(t.label){case 0:if(this.ic(),this.ec)throw this.ec;return e=this.Zu,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){var n=new ii(Wr.$(e));r.mutations.push(new ys(n,r.Ue(n)))}),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return n={database:Lo((e=r).serializer),writes:i.map(function(t){return Vo(e.serializer,t)})},[4,e.Yu("Commit",n)];case 1:return t.sent(),[2]}})})}(this.Xu,this.mutations)];case 1:return t.sent(),this.tc=!0,[2]}})})},Of.prototype.rc=function(t){var e;if(t instanceof qs)e=t.version;else{if(!(t instanceof js))throw Nr();e=zr.min()}var n=this.Zu.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Gr(Br.ABORTED,"Document version changed between two reads.")}else this.Zu.set(t.key.toString(),e)},Of.prototype.Ue=function(t){var e=this.Zu.get(t.toString());return!this.sc.has(t)&&e?hs.updateTime(e):hs.Qe()},Of.prototype.oc=function(t){var e=this.Zu.get(t.toString());if(this.sc.has(t)||!e)return hs.exists(!0);if(e.isEqual(zr.min()))throw new Gr(Br.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return hs.updateTime(e)},Of.prototype.write=function(t){this.ic(),this.mutations=this.mutations.concat(t)},Of.prototype.ic=function(){},Of),Nf=(Df.prototype.lc=function(){var t=this;0===this.ac&&(this._c("Unknown"),this.uc=this.Oo.ei("online_state_timeout",1e4,function(){return t.uc=null,t.fc("Backend didn't respond within 10 seconds."),t._c("Offline"),Promise.resolve()}))},Df.prototype.dc=function(t){"Online"===this.state?this._c("Unknown"):(this.ac++,1<=this.ac&&(this.wc(),this.fc("Connection failed 1 times. Most recent error: "+t.toString()),this._c("Offline")))},Df.prototype.set=function(t){this.wc(),this.ac=0,"Online"===t&&(this.cc=!1),this._c(t)},Df.prototype._c=function(t){t!==this.state&&(this.state=t,this.hc(t))},Df.prototype.fc=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.cc?(Tr(e),this.cc=!1):Ir("OnlineStateTracker",e)},Df.prototype.wc=function(){null!==this.uc&&(this.uc.cancel(),this.uc=null)},Df),Af=(Sf.prototype.start=function(){return this.enableNetwork()},Sf.prototype.enableNetwork=function(){return this.Rc.delete(0),this.$c()},Sf.prototype.$c=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Vc()?(this.kc()?this.xc():this.pc.set("Unknown"),[4,this.Mc()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Sf.prototype.disableNetwork=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Rc.add(0),[4,this.Lc()];case 1:return t.sent(),this.pc.set("Offline"),[2]}})})},Sf.prototype.Lc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.Dc.stop()];case 1:return t.sent(),[4,this.yc.stop()];case 2:return t.sent(),0<this.Ec.length&&(Ir("RemoteStore","Stopping write stream with "+this.Ec.length+" pending writes"),this.Ec=[]),this.Oc(),[2]}})})},Sf.prototype.Ur=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Ir("RemoteStore","RemoteStore shutting down."),this.Rc.add(5),[4,this.Lc()];case 1:return t.sent(),this.mc.Ur(),this.pc.set("Unknown"),[2]}})})},Sf.prototype.listen=function(t){this.Ic.has(t.targetId)||(this.Ic.set(t.targetId,t),this.kc()?this.xc():this.yc.Vu()&&this.Bc(t))},Sf.prototype.qc=function(t){this.Ic.delete(t),this.yc.Vu()&&this.Uc(t),0===this.Ic.size&&(this.yc.Vu()?this.yc.yu():this.Vc()&&this.pc.set("Unknown"))},Sf.prototype.Me=function(t){return this.Ic.get(t)||null},Sf.prototype.xe=function(t){return this.Qc.xe(t)},Sf.prototype.Bc=function(t){this.Ac.de(t.targetId),this.yc.Ou(t)},Sf.prototype.Uc=function(t){this.Ac.de(t),this.yc.Bu(t)},Sf.prototype.xc=function(){this.Ac=new Qi(this),this.yc.start(),this.pc.lc()},Sf.prototype.kc=function(){return this.Vc()&&!this.yc.Pu()&&0<this.Ic.size},Sf.prototype.Vc=function(){return 0===this.Rc.size},Sf.prototype.Oc=function(){this.Ac=null},Sf.prototype.bc=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){return this.Ic.forEach(function(t,e){n.Bc(t)}),[2]})})},Sf.prototype.vc=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return this.Oc(),this.kc()?(this.pc.dc(e),this.xc()):this.pc.set("Unknown"),[2]})})},Sf.prototype.Sc=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:if(this.pc.set("Online"),!(i instanceof Vi&&2===i.state&&i.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.Wc(i)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Ir("RemoteStore","Failed to remove targets %s: %s ",i.targetIds.join(","),e),[4,this.jc(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(i instanceof Ui?this.Ac.Pe(i):i instanceof Ci?this.Ac.De(i):this.Ac.pe(i),o.isEqual(zr.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,this.Tc.xi()];case 8:return n=t.sent(),0<=o.o(n)?[4,this.Kc(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Ir("RemoteStore","Failed to raise snapshot:",r=t.sent()),[4,this.jc(r)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},Sf.prototype.jc=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!lh(n))throw n;return this.Rc.add(1),[4,this.Lc()];case 1:return t.sent(),this.pc.set("Offline"),r=r||function(){return e.Tc.xi()},this.Oo.Cr(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Ir("RemoteStore","Retrying IndexedDB access"),[4,r()];case 1:return t.sent(),this.Rc.delete(1),[4,this.$c()];case 2:return t.sent(),[2]}})})}),[2]}})})},Sf.prototype.Gc=function(e){var n=this;return e().catch(function(t){return n.jc(t,e)})},Sf.prototype.Kc=function(r){var i=this,t=this.Ac.Ne(r);return t.Qt.forEach(function(t,e){var n;0<t.resumeToken.G()&&((n=i.Ic.get(e))&&i.Ic.set(e,n.Z(t.resumeToken,r)))}),t.Wt.forEach(function(t){var e,n=i.Ic.get(t);n&&(i.Ic.set(t,n.Z(hi.H,n.J)),i.Uc(t),e=new di(n.target,t,1,n.sequenceNumber),i.Bc(e))}),this.Qc.na(t)},Sf.prototype.Wc=function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=o.cause,n=0,r=o.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],this.Ic.has(i)?[4,this.Qc.zc(i,e)]:[3,3]):[3,5];case 2:t.sent(),this.Ic.delete(i),this.Ac.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},Sf.prototype.Mc=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:e=0<this.Ec.length?this.Ec[this.Ec.length-1].batchId:-1,t.label=1;case 1:if(!this.Hc())return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,this.Tc.ha(e)];case 3:return null===(n=t.sent())?(0===this.Ec.length&&this.Dc.yu(),[3,7]):(e=n.batchId,this.Yc(n),[3,6]);case 4:return r=t.sent(),[4,this.jc(r)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return this.Jc()&&this.Xc(),[2]}})})},Sf.prototype.Hc=function(){return this.Vc()&&this.Ec.length<10},Sf.prototype.Zc=function(){return this.Ec.length},Sf.prototype.Yc=function(t){this.Ec.push(t),this.Dc.Vu()&&this.Dc.Uu&&this.Dc.Qu(t.mutations)},Sf.prototype.Jc=function(){return this.Vc()&&!this.Dc.Pu()&&0<this.Ec.length},Sf.prototype.Xc=function(){this.Dc.start()},Sf.prototype.Cc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.Dc.Ku(),[2]})})},Sf.prototype.Nc=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){for(e=0,n=this.Ec;e<n.length;e++)r=n[e],this.Dc.Qu(r.mutations);return[2]})})},Sf.prototype.Wu=function(i,o){return y(this,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){switch(t.label){case 0:return e=this.Ec.shift(),n=bu.from(e,i,o),[4,this.Gc(function(){return r.Qc.tl(n)})];case 1:return t.sent(),[4,this.Mc()];case 2:return t.sent(),[2]}})})},Sf.prototype.Fc=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e&&this.Dc.Uu?[4,this.el(e)]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.Jc()&&this.Xc(),[2]}})})},Sf.prototype.el=function(i){return y(this,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){switch(t.label){case 0:return vi(n=i.code)&&n!==Br.ABORTED?(e=this.Ec.shift(),this.Dc.pu(),[4,this.Gc(function(){return r.Qc.sl(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,this.Mc()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Sf.prototype.nl=function(){return new _f(this.Xu)},Sf.prototype.gc=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Rc.add(4),[4,this.Lc()];case 1:return t.sent(),this.pc.set("Unknown"),this.Rc.delete(4),[4,this.$c()];case 2:return t.sent(),[2]}})})},Sf.prototype.il=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Oo.ah(),Ir("RemoteStore","RemoteStore received new credentials"),this.Rc.add(3),[4,this.Lc()];case 1:return t.sent(),this.pc.set("Unknown"),[4,this.Qc.il(e)];case 2:return t.sent(),this.Rc.delete(3),[4,this.$c()];case 3:return t.sent(),[2]}})})},Sf.prototype.rl=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(this.Rc.delete(2),[4,this.$c()]):[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:(this.Rc.add(2),[4,this.Lc()]);case 3:t.sent(),this.pc.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},Sf);function Sf(t,e,n,r,i){var o,s,u,a,h,c,f=this;this.Tc=t,this.Xu=e,this.Oo=n,this.Ec=[],this.Ic=new Map,this.Ac=null,this.Rc=new Set,this.mc=i,this.mc.Pc(function(t){n.Sr(function(){return y(f,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Vc()?(Ir("RemoteStore","Restarting streams for network reachability change."),[4,this.gc()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.pc=new Nf(n,r),this.yc=(a=this.Xu,h=n,c={xu:this.bc.bind(this),Cu:this.vc.bind(this),Lu:this.Sc.bind(this)},new Ef(h,a.Iu,a.credentials,a.serializer,c)),this.Dc=(o=this.Xu,s=n,u={xu:this.Cc.bind(this),Cu:this.Fc.bind(this),ju:this.Nc.bind(this),Wu:this.Wu.bind(this)},new If(s,o.Iu,o.credentials,o.serializer,u))}function Df(t,e){this.Oo=t,this.hc=e,this.state="Unknown",this.ac=0,this.uc=null,this.cc=!0}function Of(t){this.Xu=t,this.Zu=new Map,this.mutations=[],this.tc=!1,this.ec=null,this.sc=new Set}function xf(t,e,n){var r=this;return(r=pf.call(this)||this).Iu=t,r.credentials=e,r.serializer=n,r.zu=!1,r}function Pf(t,e,n,r,i){var o=this;return(o=df.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.qu=!1,o.lastStreamToken=hi.H,o}function Rf(t,e,n,r,i){var o=this;return(o=yf.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function kf(t,e,n,r,i,o){this.Wn=t,this.Eu=n,this.Iu=r,this.Au=i,this.listener=o,this.state=0,this.Ru=0,this.mu=null,this.stream=null,this.Zo=new Vu(t,e)}function Lf(t,e){this.du=t,this.wu=e}function Uf(t,e){this.du=t,this.wu=e,this.type="FirstParty",this.user=cf.iu}function Cf(t){var e=this;this.cu=null,this.currentUser=cf.UNAUTHENTICATED,this.lu=!1,this._u=0,this.ou=null,this.forceRefresh=!1,this.cu=function(){e._u++,e.currentUser=e.fu(),e.lu=!0,e.ou&&e.ou(e.currentUser)},this._u=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.cu):(this.cu(null),t.get().then(function(t){e.auth=t,e.cu&&e.auth.addAuthTokenListener(e.cu)},function(){}))}function Vf(){this.ou=null}function Mf(t,e){return"firestore_clients_"+t+"_"+e}function Ff(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.fo()&&(r+="_"+e.uid),r}function qf(t,e){return"firestore_targets_"+t+"_"+e}function jf(t){this.key=t}function Bf(t){this.key=t}function Gf(t,e,n){this.query=t,this.targetId=e,this.view=n}function Qf(t){this.key=t,this.R_=!1}function zf(){this.if=void 0,this.rf=[]}var Hf,Wf,Kf=(Nl.ol=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new Gr(r.error.code,r.error.message)),i?new Nl(t,e,r.state,o):(Tr("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},Nl.prototype.hl=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Nl),Xf=(_l.ol=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new Gr(n.error.code,n.error.message)),r?new _l(t,n.state,i):(Tr("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},_l.prototype.hl=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},_l),Yf=(Tl.ol=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Li,o=0;r&&o<n.activeTargetIds.length;++o)r=ai(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new Tl(t,i):(Tr("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},Tl),$f=(Il.ol=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Il(e.clientId,e.onlineState):(Tr("SharedClientState","Failed to parse online state: "+t),null)},Il),Jf=(El.prototype.al=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},El.prototype.ul=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},El.prototype.hl=function(){var t={activeTargetIds:this.activeTargetIds.F(),updateTimeMs:Date.now()};return JSON.stringify(t)},El),Zf=(bl._r=function(t){return!(!t||!t.localStorage)},bl.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f,l=this;return v(this,function(t){switch(t.label){case 0:return[4,this.Qc.Gr()];case 1:for(e=t.sent(),n=0,r=e;n<r.length;n++)(i=r[n])!==this.cl&&(o=this.getItem(Mf(this.persistenceKey,i)))&&(s=Yf.ol(i,o))&&(this.fl=this.fl.et(s.clientId,s));for(this.ml(),(u=this.storage.getItem(this.Rl))&&(a=this.Pl(u))&&this.Vl(a),h=0,c=this.dl;h<c.length;h++)f=c[h],this._l(f);return this.dl=[],this.window.addEventListener("unload",function(){return l.Ur()}),this.pr=!0,[2]}})})},bl.prototype.Un=function(t){this.setItem(this.Tl,JSON.stringify(t))},bl.prototype.gl=function(){return this.pl(this.fl)},bl.prototype.yl=function(n){var r=!1;return this.fl.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},bl.prototype.bl=function(t){this.vl(t,"pending")},bl.prototype.Sl=function(t,e,n){this.vl(t,e,n),this.Dl(t)},bl.prototype.Cl=function(t){var e,n,r="not-current";return this.yl(t)&&(!(e=this.storage.getItem(qf(this.persistenceKey,t)))||(n=Xf.ol(t,e))&&(r=n.state)),this.Fl.al(t),this.ml(),r},bl.prototype.Nl=function(t){this.Fl.ul(t),this.ml()},bl.prototype.$l=function(t){return this.Fl.activeTargetIds.has(t)},bl.prototype.kl=function(t){this.removeItem(qf(this.persistenceKey,t))},bl.prototype.xl=function(t,e,n){this.Ml(t,e,n)},bl.prototype.Hh=function(t,e,n){var r=this;e.forEach(function(t){r.Dl(t)}),this.currentUser=t,n.forEach(function(t){r.bl(t)})},bl.prototype.Ll=function(t){this.Ol(t)},bl.prototype.Ur=function(){this.pr&&(this.window.removeEventListener("storage",this.ll),this.removeItem(this.wl),this.pr=!1)},bl.prototype.getItem=function(t){var e=this.storage.getItem(t);return Ir("SharedClientState","READ",t,e),e},bl.prototype.setItem=function(t,e){Ir("SharedClientState","SET",t,e),this.storage.setItem(t,e)},bl.prototype.removeItem=function(t){Ir("SharedClientState","REMOVE",t),this.storage.removeItem(t)},bl.prototype._l=function(t){var e=this,u=t;if(u.storageArea===this.storage){if(Ir("SharedClientState","EVENT",u.key,u.newValue),u.key===this.wl)return void Tr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Wn.Cr(function(){return y(e,void 0,void 0,function(){var e,n,r,i,o,s;return v(this,function(t){if(this.pr){if(null!==u.key)if(this.El.test(u.key)){if(null==u.newValue)return e=this.Bl(u.key),[2,this.ql(e,null)];if(n=this.Ul(u.key,u.newValue))return[2,this.ql(n.clientId,n)]}else if(this.Il.test(u.key)){if(null!==u.newValue&&(r=this.Ql(u.key,u.newValue)))return[2,this.Wl(r)]}else if(this.Al.test(u.key)){if(null!==u.newValue&&(i=this.jl(u.key,u.newValue)))return[2,this.Kl(i)]}else if(u.key===this.Rl){if(null!==u.newValue&&(o=this.Pl(u.newValue)))return[2,this.Vl(o)]}else u.key===this.Tl&&(s=function(t){var e=Su.Qn;if(null!=t)try{var n=JSON.parse(t);Ar("number"==typeof n),e=n}catch(t){Tr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(u.newValue))!==Su.Qn&&this.On(s)}else this.dl.push(u);return[2]})})})}},Object.defineProperty(bl.prototype,"Fl",{get:function(){return this.fl.get(this.cl)},enumerable:!0,configurable:!0}),bl.prototype.ml=function(){this.setItem(this.wl,this.Fl.hl())},bl.prototype.vl=function(t,e,n){var r=new Kf(this.currentUser,t,e,n),i=Ff(this.persistenceKey,this.currentUser,t);this.setItem(i,r.hl())},bl.prototype.Dl=function(t){var e=Ff(this.persistenceKey,this.currentUser,t);this.removeItem(e)},bl.prototype.Ol=function(t){var e={clientId:this.cl,onlineState:t};this.storage.setItem(this.Rl,JSON.stringify(e))},bl.prototype.Ml=function(t,e,n){var r=qf(this.persistenceKey,t),i=new Xf(t,e,n);this.setItem(r,i.hl())},bl.prototype.Bl=function(t){var e=this.El.exec(t);return e?e[1]:null},bl.prototype.Ul=function(t,e){var n=this.Bl(t);return Yf.ol(n,e)},bl.prototype.Ql=function(t,e){var n=this.Il.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Kf.ol(new cf(i),r,e)},bl.prototype.jl=function(t,e){var n=this.Al.exec(t),r=Number(n[1]);return Xf.ol(r,e)},bl.prototype.Pl=function(t){return $f.ol(t)},bl.prototype.Wl=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this.Qc.Gl(e.batchId,e.state,e.error)]:(Ir("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},bl.prototype.Kl=function(t){return this.Qc.zl(t.targetId,t.state,t.error)},bl.prototype.ql=function(t,e){var n=this,r=e?this.fl.et(t,e):this.fl.remove(t),i=this.pl(this.fl),o=this.pl(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this.Qc.Hl(s,u).then(function(){n.fl=r})},bl.prototype.Vl=function(t){this.fl.get(t.clientId)&&this.hc(t.onlineState)},bl.prototype.pl=function(t){var n=Li;return t.forEach(function(t,e){n=n.Ct(e.activeTargetIds)}),n},bl),tl=(wl.prototype.bl=function(t){},wl.prototype.Sl=function(t,e,n){},wl.prototype.Cl=function(t){return this.Yl.al(t),this.Jl[t]||"not-current"},wl.prototype.xl=function(t,e,n){this.Jl[t]=e},wl.prototype.Nl=function(t){this.Yl.ul(t)},wl.prototype.$l=function(t){return this.Yl.activeTargetIds.has(t)},wl.prototype.kl=function(t){delete this.Jl[t]},wl.prototype.gl=function(){return this.Yl.activeTargetIds},wl.prototype.yl=function(t){return this.Yl.activeTargetIds.has(t)},wl.prototype.start=function(){return this.Yl=new Jf,Promise.resolve()},wl.prototype.Hh=function(t,e,n){},wl.prototype.Ll=function(t){},wl.prototype.Ur=function(){},wl.prototype.Un=function(t){},wl),el=(Object.defineProperty(ml.prototype,"s_",{get:function(){return this.Xl},enumerable:!0,configurable:!0}),ml.prototype.n_=function(t,e){var u=this,a=e?e.i_:new Fi,h=e?e.e_:this.e_,c=e?e.Ot:this.Ot,f=h,l=!1,p=this.query.ks()&&h.size===this.query.limit?h.last():null,d=this.query.xs()&&h.size===this.query.limit?h.first():null;if(t.ot(function(t,e){var n=h.get(t),r=(r=e instanceof qs?e:null)&&(u.query.matches(r)?r:null),i=!!n&&u.Ot.has(n.key),o=!!r&&(r.Xe||u.Ot.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(a.track({type:3,doc:r}),s=!0):u.r_(n,r)||(a.track({type:2,doc:r}),s=!0,(p&&0<u.query.Ds(r,p)||d&&u.query.Ds(r,d)<0)&&(l=!0)):!n&&r?(a.track({type:0,doc:r}),s=!0):n&&!r&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(l=!0)),s&&(c=r?(f=f.add(r),o?c.add(t):c.delete(t)):(f=f.delete(t),c.delete(t)))}),this.query.ks()||this.query.xs())for(;f.size>this.query.limit;){var n=this.query.ks()?f.last():f.first(),f=f.delete(n.key),c=c.delete(n.key);a.track({type:1,doc:n})}return{e_:f,i_:a,o_:l,Ot:c}},ml.prototype.r_=function(t,e){return t.Xe&&e.hasCommittedMutations&&!e.Xe},ml.prototype.wn=function(t,e,n){var o=this,r=this.e_;this.e_=t.e_,this.Ot=t.Ot;var i=t.i_.Mt();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.query.Ds(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Nr()}}var r,i}),this.h_(n);var s=e?this.a_():[],u=0===this.t_.size&&this.Ht?1:0,a=u!==this.Zl;return this.Zl=u,0!==i.length||a?{snapshot:new qi(this.query,t.e_,r,i,t.Ot,0==u,a,!1),u_:s}:{u_:s}},ml.prototype.c_=function(t){return this.Ht&&"Offline"===t?(this.Ht=!1,this.wn({e_:this.e_,i_:new Fi,Ot:this.Ot,o_:!1},!1)):{u_:[]}},ml.prototype.l_=function(t){return!this.Xl.has(t)&&!!this.e_.has(t)&&!this.e_.get(t).Xe},ml.prototype.h_=function(t){var e=this;t&&(t.Yt.forEach(function(t){return e.Xl=e.Xl.add(t)}),t.Jt.forEach(function(t){}),t.Xt.forEach(function(t){return e.Xl=e.Xl.delete(t)}),this.Ht=t.Ht)},ml.prototype.a_=function(){var e=this;if(!this.Ht)return[];var n=this.t_;this.t_=ki(),this.e_.forEach(function(t){e.l_(t.key)&&(e.t_=e.t_.add(t.key))});var r=[];return n.forEach(function(t){e.t_.has(t)||r.push(new Bf(t))}),this.t_.forEach(function(t){n.has(t)||r.push(new jf(t))}),r},ml.prototype.__=function(t){this.Xl=t._a,this.t_=ki();var e=this.n_(t.documents);return this.wn(e,!0)},ml.prototype.f_=function(){return qi.Ut(this.query,this.e_,this.Ot,0===this.Zl)},ml),nl=(gl.prototype.w_=function(){this.T_()},gl.prototype.T_=function(){var t=this;this.Zo.Zn(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new _f(this.Xu),(n=this.E_(e))&&n.then(function(t){r.Oo.Sr(function(){return e.commit().then(function(){r.Uo.resolve(t)}).catch(function(t){r.I_(t)})})}).catch(function(t){r.I_(t)}),[2]})})})},gl.prototype.E_=function(t){try{var e=this.updateFunction(t);return!si(e)&&e.catch&&e.then?e:(this.Uo.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Uo.reject(t),null}},gl.prototype.I_=function(t){var e=this;0<this.d_&&this.A_(t)?(--this.d_,this.Oo.Sr(function(){return e.T_(),Promise.resolve()})):this.Uo.reject(t)},gl.prototype.A_=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!vi(e)},gl),rl=(Object.defineProperty(vl.prototype,"k_",{get:function(){return!0},enumerable:!0,configurable:!0}),vl.prototype.subscribe=function(t){this.g_=t},vl.prototype.listen=function(s){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return this.x_("listen()"),(r=this.p_.get(s))?(e=r.targetId,this.P_.Cl(e),n=r.view.f_(),[3,4]):[3,1];case 1:return[4,this.Tc.ua(s.We())];case 2:return i=t.sent(),o=this.P_.Cl(i.targetId),e=i.targetId,[4,this.M_(s,e,"current"===o)];case 3:n=t.sent(),this.k_&&this.m_.listen(i),t.label=4;case 4:return[2,n]}})})},vl.prototype.M_=function(u,a,h){return y(this,void 0,void 0,function(){var e,n,r,i,o,s;return v(this,function(t){switch(t.label){case 0:return[4,this.Tc.la(u,!0)];case 1:return e=t.sent(),n=new el(u,e._a),r=n.n_(e.documents),i=Bi.zt(a,h&&"Offline"!==this.onlineState),o=n.wn(r,this.k_,i),this.L_(a,o.u_),s=new Gf(u,a,n),[2,(this.p_.set(u,s),this.y_.has(a)?this.y_.get(a).push(u):this.y_.set(a,[u]),o.snapshot)]}})})},vl.prototype.qc=function(i){return y(this,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){switch(t.label){case 0:return this.x_("unlisten()"),e=this.p_.get(i),1<(n=this.y_.get(e.targetId)).length?[2,(this.y_.set(e.targetId,n.filter(function(t){return!t.isEqual(i)})),void this.p_.delete(i))]:this.k_?(this.P_.Nl(e.targetId),this.P_.yl(e.targetId)?[3,2]:[4,this.Tc.ca(e.targetId,!1).then(function(){r.P_.kl(e.targetId),r.m_.qc(e.targetId),r.O_(e.targetId)}).catch(jh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.O_(e.targetId),[4,this.Tc.ca(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},vl.prototype.write=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:this.x_("write()"),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,this.Tc.Zh(i)];case 2:return e=t.sent(),this.P_.bl(e.batchId),this.B_(e.batchId,o),[4,this.q_(e.on)];case 3:return t.sent(),[4,this.m_.Mc()];case 4:return t.sent(),[3,6];case 5:return n=t.sent(),r=Nh(n,"Failed to persist write"),o.reject(r),[3,6];case 6:return[2]}})})},vl.prototype.runTransaction=function(t,e,n){new nl(t,this.Xu,e,n).w_()},vl.prototype.na=function(n){return y(this,void 0,void 0,function(){var e,r=this;return v(this,function(t){switch(t.label){case 0:this.x_("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.Tc.na(n)];case 2:return e=t.sent(),n.Qt.forEach(function(t,e){var n=r.S_.get(e);n&&(Ar(t.Yt.size+t.Jt.size+t.Xt.size<=1),0<t.Yt.size?n.R_=!0:0<t.Jt.size?Ar(n.R_):0<t.Xt.size&&(Ar(n.R_),n.R_=!1))}),[4,this.q_(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,jh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},vl.prototype.c_=function(r,t){this.x_("applyOnlineStateChange()");var i=[];this.p_.forEach(function(t,e){var n=e.view.c_(r);n.snapshot&&i.push(n.snapshot)}),this.g_.U_(r),this.g_.Lu(i),this.onlineState=r},vl.prototype.zc=function(u,a){return y(this,void 0,void 0,function(){var e,n,r,i,o,s=this;return v(this,function(t){switch(t.label){case 0:return this.x_("rejectListens()"),this.P_.xl(u,"rejected",a),e=this.S_.get(u),(n=e&&e.key)?(r=(r=new mi(ii.P)).et(n,new js(n,zr.min())),i=ki().add(n),o=new ji(zr.min(),new Map,new Ni(xr),r,i),[4,this.na(o)]):[3,2];case 1:return t.sent(),this.v_=this.v_.remove(n),this.S_.delete(u),this.Q_(),[3,4];case 2:return[4,this.Tc.ca(u,!1).then(function(){return s.O_(u,a)}).catch(jh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})},vl.prototype.tl=function(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:this.x_("applySuccessfulWrite()"),e=r.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.Tc.ta(r)];case 2:return n=t.sent(),this.W_(e,null),this.j_(e),this.P_.Sl(e,"acknowledged"),[4,this.q_(n)];case 3:return t.sent(),[3,6];case 4:return[4,jh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},vl.prototype.sl=function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.x_("rejectFailedWrite()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.Tc.sa(n)];case 2:return e=t.sent(),this.W_(n,r),this.j_(n),this.P_.Sl(n,"rejected",r),[4,this.q_(e)];case 3:return t.sent(),[3,6];case 4:return[4,jh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},vl.prototype.K_=function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:this.m_.Vc()||Ir("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Tc.Ao()];case 2:return-1===(e=t.sent())?[2,void o.resolve()]:((n=this.F_.get(e)||[]).push(o),this.F_.set(e,n),[3,4]);case 3:return r=t.sent(),i=Nh(r,"Initialization of waitForPendingWrites() operation failed"),o.reject(i),[3,4];case 4:return[2]}})})},vl.prototype.j_=function(t){(this.F_.get(t)||[]).forEach(function(t){t.resolve()}),this.F_.delete(t)},vl.prototype.G_=function(e){this.F_.forEach(function(t){t.forEach(function(t){t.reject(new Gr(Br.CANCELLED,e))})}),this.F_.clear()},vl.prototype.B_=function(t,e){var n=(n=(n=this.C_[this.currentUser.su()])||new mi(xr)).et(t,e);this.C_[this.currentUser.su()]=n},vl.prototype.W_=function(t,e){var n,r=this.C_[this.currentUser.su()];r&&((n=r.get(t))&&(e?n.reject(e):n.resolve(),r=r.remove(t)),this.C_[this.currentUser.su()]=r)},vl.prototype.O_=function(t,e){var n=this;void 0===e&&(e=null),this.P_.Nl(t);for(var r=0,i=this.y_.get(t);r<i.length;r++){var o=i[r];this.p_.delete(o),e&&this.g_.z_(o,e)}this.y_.delete(t),this.k_&&this.D_.ga(t).forEach(function(t){n.D_.tr(t)||n.H_(t)})},vl.prototype.H_=function(t){var e=this.v_.get(t);null!==e&&(this.m_.qc(e),this.v_=this.v_.remove(t),this.S_.delete(e),this.Q_())},vl.prototype.L_=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof jf?(this.D_.Hi(i.key,t),this.Y_(i)):i instanceof Bf?(Ir("SyncEngine","Document no longer in limbo: "+i.key),this.D_.Ji(i.key,t),this.D_.tr(i.key)||this.H_(i.key)):Nr()}},vl.prototype.Y_=function(t){var e=t.key;this.v_.get(e)||(Ir("SyncEngine","New document in limbo: "+e),this.b_.push(e),this.Q_())},vl.prototype.Q_=function(){for(;0<this.b_.length&&this.v_.size<this.V_;){var t=this.b_.shift(),e=this.N_.next();this.S_.set(e,new Qf(t)),this.v_=this.v_.et(t,e),this.m_.listen(new di(Gs.As(t.path).We(),e,2,Su.Qn))}},vl.prototype.J_=function(){return this.v_},vl.prototype.X_=function(){return this.b_},vl.prototype.q_=function(r,a){return y(this,void 0,void 0,function(){var o,s,e,u=this;return v(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.p_.forEach(function(t,i){e.push(Promise.resolve().then(function(){var n=i.view.n_(r);return n.o_?u.Tc.la(i.query,!1).then(function(t){var e=t.documents;return i.view.n_(e,n)}):n}).then(function(t){var e,n=a&&a.Qt.get(i.targetId),r=i.view.wn(t,u.k_,n);u.L_(i.targetId,r.u_),r.snapshot&&(u.k_&&u.P_.xl(i.targetId,r.snapshot.fromCache?"not-current":"current"),o.push(r.snapshot),e=Au.Ln(i.targetId,r.snapshot),s.push(e))}))}),[4,Promise.all(e)];case 1:return t.sent(),this.g_.Lu(o),[4,this.Tc.oa(s)];case 2:return t.sent(),[2]}})})},vl.prototype.x_=function(t){},vl.prototype.il=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.currentUser.isEqual(n)?[3,3]:(Ir("SyncEngine","User change. New user:",n.su()),[4,this.Tc.Hh(n)]);case 1:return e=t.sent(),this.currentUser=n,this.G_("'waitForPendingWrites' promise is rejected due to a user change."),this.P_.Hh(n,e.Jh,e.Xh),[4,this.q_(e.Yh)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},vl.prototype.enableNetwork=function(){return this.m_.enableNetwork()},vl.prototype.disableNetwork=function(){return this.m_.disableNetwork()},vl.prototype.xe=function(t){var e=this.S_.get(t);if(e&&e.R_)return ki().add(e.key);var n=ki(),r=this.y_.get(t);if(!r)return n;for(var i=0,o=r;i<o.length;i++)var s=o[i],u=this.p_.get(s),n=n.Ct(u.view.s_);return n},vl),il=(n(yl,Hf=rl),Object.defineProperty(yl.prototype,"k_",{get:function(){return!0===this.Z_},enumerable:!0,configurable:!0}),yl.prototype.enableNetwork=function(){return this.Tc.vr(!0),Hf.prototype.enableNetwork.call(this)},yl.prototype.disableNetwork=function(){return this.Tc.vr(!1),Hf.prototype.disableNetwork.call(this)},yl.prototype.tf=function(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.Tc.la(r.query,!0)];case 1:return e=t.sent(),n=r.view.__(e),[2,(this.Z_&&this.L_(r.targetId,n.u_),n)]}})})},yl.prototype.c_=function(t,e){this.k_&&0===e&&(Hf.prototype.c_.call(this,t,e),this.P_.Ll(t)),this.k_||1!==e||Hf.prototype.c_.call(this,t,e)},yl.prototype.Gl=function(n,r,i){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.x_("applyBatchState()"),[4,this.Tc.da(n)];case 1:return null===(e=t.sent())?[3,6]:"pending"!==r?[3,3]:[4,this.m_.Mc()];case 2:return t.sent(),[3,4];case 3:"acknowledged"===r||"rejected"===r?(this.W_(n,i||null),this.Tc.wa(n)):Nr(),t.label=4;case 4:return[4,this.q_(e)];case 5:return t.sent(),[3,7];case 6:Ir("SyncEngine","Cannot apply mutation batch with id: "+n),t.label=7;case 7:return[2]}})})},yl.prototype.rl=function(h){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a=this;return v(this,function(t){switch(t.label){case 0:return!0!==h||!0===this.Z_?[3,3]:(e=this.P_.gl(),[4,this.ef(e.F(),!0)]);case 1:return n=t.sent(),this.Z_=!0,[4,this.m_.rl(!0)];case 2:for(t.sent(),r=0,i=n;r<i.length;r++)o=i[r],this.m_.listen(o);return[3,7];case 3:return!1!==h||!1===this.Z_?[3,7]:(s=[],u=Promise.resolve(),this.y_.forEach(function(t,e){a.P_.$l(e)?s.push(e):u=u.then(function(){return a.O_(e),a.Tc.ca(e,!0)}),a.m_.qc(e)}),[4,u]);case 4:return t.sent(),[4,this.ef(s,!1)];case 5:return t.sent(),this.sf(),this.Z_=!1,[4,this.m_.rl(!1)];case 6:t.sent(),t.label=7;case 7:return[2]}})})},yl.prototype.sf=function(){var n=this;this.S_.forEach(function(t,e){n.m_.qc(e)}),this.D_.pa(),this.S_=new Map,this.v_=new mi(ii.P)},yl.prototype.ef=function(d,t){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f,l,p;return v(this,function(t){switch(t.label){case 0:e=[],n=[],r=0,i=d,t.label=1;case 1:return r<i.length?(o=i[r],s=void 0,(u=this.y_.get(o))&&0!==u.length?[4,this.Tc.ua(u[0].We())]:[3,7]):[3,13];case 2:s=t.sent(),a=0,h=u,t.label=3;case 3:return a<h.length?(c=h[a],f=this.p_.get(c),[4,this.tf(f)]):[3,6];case 4:(l=t.sent()).snapshot&&n.push(l.snapshot),t.label=5;case 5:return a++,[3,3];case 6:return[3,11];case 7:return[4,this.Tc.Ta(o)];case 8:return p=t.sent(),[4,this.Tc.ua(p)];case 9:return s=t.sent(),[4,this.M_(this.nf(p),o,!1)];case 10:t.sent(),t.label=11;case 11:e.push(s),t.label=12;case 12:return r++,[3,1];case 13:return[2,(this.g_.Lu(n),e)]}})})},yl.prototype.nf=function(t){return new Gs(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)},yl.prototype.Gr=function(){return this.Tc.Gr()},yl.prototype.zl=function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.Z_?(Ir("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!this.y_.has(r))return[3,8];switch(i){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,this.Tc.Ri()];case 3:return e=t.sent(),n=ji.Gt(r,"current"===i),[4,this.q_(e,n)];case 4:return t.sent(),[3,8];case 5:return[4,this.Tc.ca(r,!0)];case 6:return t.sent(),this.O_(r,o),[3,8];case 7:Nr(),t.label=8;case 8:return[2]}})})},yl.prototype.Hl=function(l,p){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,h,c,f=this;return v(this,function(t){switch(t.label){case 0:if(!this.Z_)return[3,10];e=0,n=l,t.label=1;case 1:return e<n.length?(r=n[e],this.y_.has(r)?(Ir("SyncEngine","Adding an already active target "+r),[3,5]):[4,this.Tc.Ta(r)]):[3,6];case 2:return i=t.sent(),[4,this.Tc.ua(i)];case 3:return o=t.sent(),[4,this.M_(this.nf(i),o.targetId,!1)];case 4:t.sent(),this.m_.listen(o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return u.y_.has(e)?[4,u.Tc.ca(e,!1).then(function(){f.m_.qc(e),f.O_(e)}).catch(jh)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=this,a=0,h=p,t.label=7;case 7:return a<h.length?(c=h[a],[5,s(c)]):[3,10];case 8:t.sent(),t.label=9;case 9:return a++,[3,7];case 10:return[2]}})})},yl),ol=(dl.prototype.listen=function(u){return y(this,void 0,void 0,function(){var e,n,r,i,o,s;return v(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(r=this.hf.get(e))||(n=!0,r=new zf),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),i=r,[4,this.Qc.listen(e)];case 2:return i.if=t.sent(),[3,4];case 3:return o=t.sent(),s=Nh(o,"Initialization of query '"+u.query+"' failed"),[2,void u.onError(s)];case 4:return this.hf.set(e,r),r.rf.push(u),u.c_(this.onlineState),r.if&&u.uf(r.if)&&this.cf(),[2]}})})},dl.prototype.qc=function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){return e=o.query,n=!1,(r=this.hf.get(e))&&0<=(i=r.rf.indexOf(o))&&(r.rf.splice(i,1),n=0===r.rf.length),n?[2,(this.hf.delete(e),this.Qc.qc(e))]:[2]})})},dl.prototype.Lu=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.hf.get(o);if(s){for(var u=0,a=s.rf;u<a.length;u++)a[u].uf(i)&&(e=!0);s.if=i}}e&&this.cf()},dl.prototype.z_=function(t,e){var n=this.hf.get(t);if(n)for(var r=0,i=n.rf;r<i.length;r++)i[r].onError(e);this.hf.delete(t)},dl.prototype.U_=function(i){this.onlineState=i;var o=!1;this.hf.forEach(function(t,e){for(var n=0,r=e.rf;n<r.length;n++)r[n].c_(i)&&(o=!0)}),o&&this.cf()},dl.prototype.lf=function(t){this.af.add(t),t.next()},dl.prototype._f=function(t){this.af.delete(t)},dl.prototype.cf=function(){this.af.forEach(function(t){t.next()})},dl),sl=(pl.prototype.uf=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new qi(t.query,t.docs,t.Lt,e,t.Ot,t.fromCache,t.Bt,!0)}var o=!1;return this.df?this.Tf(t)&&(this.ff.next(t),o=!0):this.Ef(t,this.onlineState)&&(this.If(t),o=!0),this.wf=t,o},pl.prototype.onError=function(t){this.ff.error(t)},pl.prototype.c_=function(t){this.onlineState=t;var e=!1;return this.wf&&!this.df&&this.Ef(this.wf,t)&&(this.If(this.wf),e=!0),e},pl.prototype.Ef=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Af&&n||t.docs._()&&"Offline"!==e)},pl.prototype.Tf=function(t){if(0<t.docChanges.length)return!0;var e=this.wf&&this.wf.hasPendingWrites!==t.hasPendingWrites;return!(!t.Bt&&!e)&&!0===this.options.includeMetadataChanges},pl.prototype.If=function(t){t=qi.Ut(t.query,t.docs,t.Ot,t.fromCache),this.df=!0,this.ff.next(t)},pl),ul=(ll.prototype.zh=function(t){this.Rf=t},ll.prototype.Sn=function(e,r,i,o){var s=this;return r.Ss()||i.isEqual(zr.min())?this.mf(e,r):this.Rf.yn(e,o).next(function(t){var n=s.Pf(r,t);return(r.ks()||r.xs())&&s.o_(r.ws,n,o,i)?s.mf(e,r):(Er()<=p.DEBUG&&Ir("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),r.toString()),s.Rf.Sn(e,r,i).next(function(e){return n.forEach(function(t){e=e.et(t.key,t)}),e}))})},ll.prototype.Pf=function(n,t){var r=new Ni(function(t,e){return n.Ds(t,e)});return t.forEach(function(t,e){e instanceof qs&&n.matches(e)&&(r=r.add(e))}),r},ll.prototype.o_=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.o(r))},ll.prototype.mf=function(t,e){return Er()<=p.DEBUG&&Ir("IndexFreeQueryEngine","Using full collection scan to execute query:",e.toString()),this.Rf.Sn(t,e,zr.min())},ll),al=(fl.prototype.do=function(t){return Eu.resolve(0===this.Rn.length)},fl.prototype.wo=function(t,e,n,r){var i=this.Vf;this.Vf++,0<this.Rn.length&&this.Rn[this.Rn.length-1];var o=new wu(i,e,n,r);this.Rn.push(o);for(var s=0,u=r;s<u.length;s++){var a=u[s];this.gf=this.gf.add(new Gh(a.key,i)),this.mn.ri(t,a.key.path.p())}return Eu.resolve(o)},fl.prototype.To=function(t,e){return Eu.resolve(this.pf(e))},fl.prototype.Io=function(t,e){var n=e+1,r=this.yf(n),i=r<0?0:r;return Eu.resolve(this.Rn.length>i?this.Rn[i]:null)},fl.prototype.Ao=function(){return Eu.resolve(0===this.Rn.length?-1:this.Vf-1)},fl.prototype.Ro=function(t){return Eu.resolve(this.Rn.slice())},fl.prototype.Vn=function(t,e){var n=this,r=new Gh(e,0),i=new Gh(e,Number.POSITIVE_INFINITY),o=[];return this.gf.vt([r,i],function(t){var e=n.pf(t.ba);o.push(e)}),Eu.resolve(o)},fl.prototype.vn=function(t,e){var r=this,i=new Ni(xr);return e.forEach(function(t){var e=new Gh(t,0),n=new Gh(t,Number.POSITIVE_INFINITY);r.gf.vt([e,n],function(t){i=i.add(t.ba)})}),Eu.resolve(this.bf(i))},fl.prototype.$n=function(t,e){var n=e.path,r=n.length+1,i=n;ii.W(i)||(i=i.child(""));var o=new Gh(new ii(i),0),s=new Ni(xr);return this.gf.St(function(t){var e=t.key.path;return!!n.D(e)&&(e.length===r&&(s=s.add(t.ba)),!0)},o),Eu.resolve(this.bf(s))},fl.prototype.bf=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.pf(t);null!==e&&r.push(e)}),r},fl.prototype.Po=function(n,r){var i=this;Ar(0===this.vf(r.batchId,"removed")),this.Rn.shift();var o=this.gf;return Eu.forEach(r.mutations,function(t){var e=new Gh(t.key,r.batchId);return o=o.delete(e),i.Fi.oo(n,t.key)}).next(function(){i.gf=o})},fl.prototype.Vo=function(t){},fl.prototype.tr=function(t,e){var n=new Gh(e,0),r=this.gf.Dt(n);return Eu.resolve(e.isEqual(r&&r.key))},fl.prototype.po=function(t){return this.Rn.length,Eu.resolve()},fl.prototype.vf=function(t,e){return this.yf(t)},fl.prototype.yf=function(t){return 0===this.Rn.length?0:t-this.Rn[0].batchId},fl.prototype.pf=function(t){var e=this.yf(t);return e<0||e>=this.Rn.length?null:this.Rn[e]},fl),hl=(cl.prototype.un=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.Sf(e);return this.docs=this.docs.et(r,{fi:e,size:s,readTime:n}),this.size+=s-o,this.mn.ri(t,r.path.p())},cl.prototype.ln=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},cl.prototype._n=function(t,e){var n=this.docs.get(e);return Eu.resolve(n?n.fi:null)},cl.prototype.getEntries=function(t,e){var n=this,r=Si;return e.forEach(function(t){var e=n.docs.get(t);r=r.et(t,e?e.fi:null)}),Eu.resolve(r)},cl.prototype.Sn=function(t,e,n){for(var r=xi,i=new ii(e.path.child("")),o=this.docs.ut(i);o.wt();){var s=o.dt(),u=s.key,a=s.value,h=a.fi,c=a.readTime;if(!e.path.D(u.path))break;c.o(n)<=0||h instanceof qs&&e.matches(h)&&(r=r.et(h.key,h))}return Eu.resolve(r)},cl.prototype.Df=function(t,e){return Eu.forEach(this.docs,function(t){return e(t)})},cl.prototype.Vi=function(t){return new cl.gi(this)},cl.prototype.yi=function(t){return Eu.resolve(this.size)},cl);function cl(t,e){this.mn=t,this.Sf=e,this.docs=new mi(ii.P),this.size=0}function fl(t,e){this.mn=t,this.Fi=e,this.Rn=[],this.Vf=1,this.gf=new Ni(Gh.Ia)}function ll(){}function pl(t,e,n){this.query=t,this.ff=e,this.df=!1,this.wf=null,this.onlineState="Unknown",this.options=n||{}}function dl(t){this.Qc=t,this.hf=new jr(function(t){return t.canonicalId()},function(t,e){return t.isEqual(e)}),this.onlineState="Unknown",this.af=new Set,this.Qc.subscribe(this)}function yl(t,e,n,r,i,o){var s=this;return(s=Hf.call(this,t,e,n,r,i,o)||this).Tc=t,s.Z_=void 0,s}function vl(t,e,n,r,i,o){this.Tc=t,this.m_=e,this.Xu=n,this.P_=r,this.currentUser=i,this.V_=o,this.g_=null,this.p_=new jr(function(t){return t.canonicalId()},function(t,e){return t.isEqual(e)}),this.y_=new Map,this.b_=[],this.v_=new mi(ii.P),this.S_=new Map,this.D_=new Bh,this.C_={},this.F_=new Map,this.N_=da.Ci(),this.onlineState="Unknown"}function gl(t,e,n,r){this.Oo=t,this.Xu=e,this.updateFunction=n,this.Uo=r,this.d_=5,this.Zo=new Vu(this.Oo,"transaction_retry")}function ml(t,e){this.query=t,this.Xl=e,this.Zl=null,this.Ht=!1,this.t_=ki(),this.Ot=ki(),this.e_=new Mi(t.Ds.bind(t))}function wl(){this.Yl=new Jf,this.Jl={},this.Qc=null,this.hc=null,this.On=null}function bl(t,e,n,r,i){this.window=t,this.Wn=e,this.persistenceKey=n,this.cl=r,this.Qc=null,this.hc=null,this.On=null,this.ll=this._l.bind(this),this.fl=new mi(xr),this.pr=!1,this.dl=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.wl=Mf(this.persistenceKey,this.cl),this.Tl="firestore_sequence_number_"+this.persistenceKey,this.fl=this.fl.et(this.cl,new Jf),this.El=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Il=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.Al=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Rl="firestore_online_state_"+this.persistenceKey,this.window.addEventListener("storage",this.ll)}function El(){this.activeTargetIds=Li}function Il(t,e){this.clientId=t,this.onlineState=e}function Tl(t,e){this.clientId=t,this.activeTargetIds=e}function _l(t,e,n){this.targetId=t,this.state=e,this.error=n}function Nl(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function Al(t){var e=this;return(e=Wf.call(this)||this).bi=t,e}hl.gi=(n(Al,Wf=Iu),Al.prototype.wn=function(n){var r=this,i=[];return this.on.forEach(function(t,e){e?i.push(r.bi.un(n,e,r.readTime)):r.bi.ln(t)}),Eu.nn(i)},Al.prototype.fn=function(t,e){return this.bi._n(t,e)},Al.prototype.dn=function(t,e){return this.bi.getEntries(t,e)},Al);var Sl,Dl,Ol=(ep.prototype.ye=function(t,n){return this.Cf.forEach(function(t,e){return n(e)}),Eu.resolve()},ep.prototype.xi=function(t){return Eu.resolve(this.lastRemoteSnapshotVersion)},ep.prototype.Mi=function(t){return Eu.resolve(this.Ff)},ep.prototype.Ni=function(t){return this.highestTargetId=this.$f.next(),Eu.resolve(this.highestTargetId)},ep.prototype.Li=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Ff&&(this.Ff=e),Eu.resolve()},ep.prototype.Bi=function(t){this.Cf.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.$f=new da(e),this.highestTargetId=e),t.sequenceNumber>this.Ff&&(this.Ff=t.sequenceNumber)},ep.prototype.Oi=function(t,e){return this.Bi(e),this.targetCount+=1,Eu.resolve()},ep.prototype.Ui=function(t,e){return this.Bi(e),Eu.resolve()},ep.prototype.Qi=function(t,e){return this.Cf.delete(e.target),this.Nf.ga(e.targetId),--this.targetCount,Eu.resolve()},ep.prototype.ji=function(n,r,i){var o=this,s=0,u=[];return this.Cf.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Cf.delete(t),u.push(o.Wi(n,e.targetId)),s++)}),Eu.nn(u).next(function(){return s})},ep.prototype.Ki=function(t){return Eu.resolve(this.targetCount)},ep.prototype.Gi=function(t,e){var n=this.Cf.get(e)||null;return Eu.resolve(n)},ep.prototype.zi=function(t,e,n){return this.Nf.ma(e,n),Eu.resolve()},ep.prototype.Yi=function(e,t,n){this.Nf.Va(t,n);var r=this.persistence.Fi,i=[];return r&&t.forEach(function(t){i.push(r.oo(e,t))}),Eu.nn(i)},ep.prototype.Wi=function(t,e){return this.Nf.ga(e),Eu.resolve()},ep.prototype.Xi=function(t,e){var n=this.Nf.ya(e);return Eu.resolve(n)},ep.prototype.tr=function(t,e){return Eu.resolve(this.Nf.tr(e))},ep),xl=(tp.prototype.start=function(){return Promise.resolve()},tp.prototype.Ur=function(){return this.or=!1,Promise.resolve()},Object.defineProperty(tp.prototype,"pr",{get:function(){return this.or},enumerable:!0,configurable:!0}),tp.prototype.yr=function(){},tp.prototype.Xr=function(){return this.mn},tp.prototype.zr=function(t){var e=this.kf[t.su()];return e||(e=new al(this.mn,this.Fi),this.kf[t.su()]=e),e},tp.prototype.Yr=function(){return this.Tr},tp.prototype.Jr=function(){return this.An},tp.prototype.runTransaction=function(t,e,n){var r=this;Ir("MemoryPersistence","Starting transaction:",t);var i=new Pl(this.rr.next());return this.Fi.Mf(),n(i).next(function(t){return r.Fi.Lf(i).next(function(){return t})}).en().then(function(t){return i.In(),t})},tp.prototype.Of=function(e,n){return Eu.rn(Object.values(this.kf).map(function(t){return function(){return t.tr(e,n)}}))},tp),Pl=(n(Zl,Dl=_u),Zl),Rl=(Jl.Uf=function(t){return new Jl(t)},Object.defineProperty(Jl.prototype,"Qf",{get:function(){if(this.qf)return this.qf;throw Nr()},enumerable:!0,configurable:!0}),Jl.prototype.Hi=function(t,e,n){return this.Bf.Hi(n,e),this.Qf.delete(n),Eu.resolve()},Jl.prototype.Ji=function(t,e,n){return this.Bf.Ji(n,e),this.Qf.add(n),Eu.resolve()},Jl.prototype.oo=function(t,e){return this.Qf.add(e),Eu.resolve()},Jl.prototype.removeTarget=function(t,e){var n=this;this.Bf.ga(e.targetId).forEach(function(t){return n.Qf.add(t)});var r=this.persistence.Yr();return r.Xi(t,e.targetId).next(function(t){t.forEach(function(t){return n.Qf.add(t)})}).next(function(){return r.Qi(t,e)})},Jl.prototype.Mf=function(){this.qf=new Set},Jl.prototype.Lf=function(t){var n=this,r=this.persistence.Jr().Vi();return Eu.forEach(this.Qf,function(e){return n.Wf(t,e).next(function(t){t||r.ln(e)})}).next(function(){return n.qf=null,r.apply(t)})},Jl.prototype.co=function(t,e){var n=this;return this.Wf(t,e).next(function(t){t?n.Qf.delete(e):n.Qf.add(e)})},Jl.prototype.xf=function(t){return 0},Jl.prototype.Wf=function(t,e){var n=this;return Eu.rn([function(){return Eu.resolve(n.Bf.tr(e))},function(){return n.persistence.Yr().tr(t,e)},function(){return n.persistence.Of(t,e)}])},Jl),kl=($l.prototype.xu=function(t){this.Gf=t},$l.prototype.Cu=function(t){this.zf=t},$l.prototype.onMessage=function(t){this.Hf=t},$l.prototype.close=function(){this.Kf()},$l.prototype.send=function(t){this.jf(t)},$l.prototype.Yf=function(){this.Gf()},$l.prototype.Jf=function(t){this.zf(t)},$l.prototype.Xf=function(t){this.Hf(t)},$l),Ll={BatchGetDocuments:"batchGet",Commit:"commit"},Ul="gl-js/ fire/"+wr,Cl=(Yl.prototype.td=function(t,e){if(e)for(var n in e.ru)e.ru.hasOwnProperty(n)&&(t[n]=e.ru[n]);t["X-Goog-Api-Client"]=Ul},Yl.prototype.Yu=function(a,r,i){var h=this,c=this.ed(a);return new Promise(function(o,s){var u=new vr;u.listenOnce(dr.COMPLETE,function(){try{switch(u.getLastErrorCode()){case pr.NO_ERROR:var t=u.getResponseJson();Ir("Connection","XHR received:",JSON.stringify(t)),o(t);break;case pr.TIMEOUT:Ir("Connection",'RPC "'+a+'" timed out'),s(new Gr(Br.DEADLINE_EXCEEDED,"Request time out"));break;case pr.HTTP_ERROR:var e,n,r=u.getStatus();Ir("Connection",'RPC "'+a+'" failed with status:',r,"response text:",u.getResponseText()),0<r?(e=u.getResponseJson().error)&&e.status&&e.message?(i=e.status.toLowerCase().replace("_","-"),n=0<=Object.values(Br).indexOf(i)?i:Br.UNKNOWN,s(new Gr(n,e.message))):s(new Gr(Br.UNKNOWN,"Server responded with status "+u.getStatus())):(Ir("Connection",'RPC "'+a+'" failed'),s(new Gr(Br.UNAVAILABLE,"Connection failed.")));break;default:Nr()}}finally{Ir("Connection",'RPC "'+a+'" completed.')}var i});var t=Object.assign({},r);delete t.database;var e=JSON.stringify(t);Ir("Connection","XHR sending: ",c+" "+e);var n={"Content-Type":"text/plain"};h.td(n,i),u.send(c,"POST",e,n,15)})},Yl.prototype.Ju=function(t,e,n){return this.Yu(t,e,n)},Yl.prototype.Mu=function(t,e){var n,r,i=[this.Zf,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=lr(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.td(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(g())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=g().indexOf("Electron/")||0<=(r=g()).indexOf("MSIE ")||0<=r.indexOf("Trident/")||0<=g().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=i.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Ir("Connection","Creating WebChannel: "+u+" "+s);var h=o.createWebChannel(u,s),c=!1,f=!1,l=new kl({jf:function(t){f?Ir("Connection","Not sending because WebChannel is closed:",t):(c||(Ir("Connection","Opening WebChannel transport."),h.open(),c=!0),Ir("Connection","WebChannel sending:",t),h.send(t))},Kf:function(){return h.close()}});return a(yr.EventType.OPEN,function(){f||Ir("Connection","WebChannel transport opened.")}),a(yr.EventType.CLOSE,function(){f||(f=!0,Ir("Connection","WebChannel transport closed"),l.Jf())}),a(yr.EventType.ERROR,function(t){f||(f=!0,function(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];br.logLevel<=p.WARN&&(e=n.map(_r),br.warn.apply(br,d(["Firestore ("+wr+"): Connection"],e)))}("Connection","WebChannel transport errored:",t),l.Jf(new Gr(Br.UNAVAILABLE,"The operation could not be completed")))}),a(yr.EventType.MESSAGE,function(t){var e,n,r,i,o,s;f||(Ar(!!(n=t.data[0])),(r=n.error||(null===(e=n[0])||void 0===e?void 0:e.error))?(Ir("Connection","WebChannel received error:",r),i=r.status,o=function(){var t=li[i];if(void 0!==t)return gi(t)}(),s=r.message,void 0===o&&(o=Br.INTERNAL,s="Unknown error status: "+i+" with message "+r.message),f=!0,l.Jf(new Gr(o,s)),h.close()):(Ir("Connection","WebChannel received:",n),l.Xf(n)))}),setTimeout(function(){l.Yf()},0),l},Yl.prototype.ed=function(t){var e=Ll[t];return this.Zf+"/v1/projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents:"+e},Yl),Vl=(Xl.prototype.Pc=function(t){this.hd.push(t)},Xl.prototype.Ur=function(){window.removeEventListener("online",this.sd),window.removeEventListener("offline",this.rd)},Xl.prototype.ad=function(){window.addEventListener("online",this.sd),window.addEventListener("offline",this.rd)},Xl.prototype.nd=function(){Ir("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.hd;t<e.length;t++)(0,e[t])(0)},Xl.prototype.od=function(){Ir("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.hd;t<e.length;t++)(0,e[t])(1)},Xl._r=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Xl),Ml=(Kl.prototype.Pc=function(t){},Kl.prototype.Ur=function(){},Kl),Fl="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",ql=(Wl.prototype.initialize=function(n){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.P_=this.ud(n),this.persistence=this.ld(n),[4,this.persistence.start()];case 1:return t.sent(),this._d=this.fd(n),this.Tc=this.dd(n),this.m_=this.wd(n),this.Qc=this.Td(n),this.Ed=this.Id(n),this.P_.hc=function(t){return e.Qc.c_(t,1)},this.m_.Qc=this.Qc,[4,this.Tc.start()];case 2:return t.sent(),[4,this.P_.start()];case 3:return t.sent(),[4,this.m_.start()];case 4:return t.sent(),[4,this.m_.rl(this.Qc.k_)];case 5:return t.sent(),[2]}})})},Wl.prototype.Id=function(t){return new ol(this.Qc)},Wl.prototype.fd=function(t){return null},Wl.prototype.dd=function(t){return new Lh(this.persistence,new ul,t.Ad)},Wl.prototype.ld=function(t){if(t.md.Rd)throw new Gr(Br.FAILED_PRECONDITION,Fl);return new xl(Rl.Uf)},Wl.prototype.wd=function(t){var e=this;return new Af(this.Tc,t.Xu,t.Oo,function(t){return e.Qc.c_(t,0)},new(Vl._r()?Vl:Ml))},Wl.prototype.ud=function(t){return new tl},Wl.prototype.Td=function(t){return new rl(this.Tc,this.m_,t.Xu,this.P_,t.Ad,t.V_)},Wl.prototype.clearPersistence=function(t){throw new Gr(Br.FAILED_PRECONDITION,Fl)},Wl),jl=(n(Hl,Sl=ql),Hl.prototype.initialize=function(e){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return[4,Sl.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,this.persistence.gr(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.Qc.rl(e)];case 1:return t.sent(),this._d&&(e&&!this._d.pr?this._d.start(this.Tc):e||this._d.stop()),[2]}})})})];case 2:return t.sent(),[2]}})})},Hl.prototype.dd=function(t){return new Fh(this.persistence,new ul,t.Ad)},Hl.prototype.Td=function(t){var e=new il(this.Tc,this.m_,t.Xu,this.P_,t.Ad,t.V_);return this.P_ instanceof Zf&&(this.P_.Qc=e),e},Hl.prototype.fd=function(t){var e=this.persistence.Fi.eo;return new Rh(e,t.Oo)},Hl.prototype.ld=function(t){var e=_a.to(t.Pd),n=Qc(t.Pd.s);return new _a(t.md.synchronizeTabs,e,t.clientId,Oh.ph(t.md.cacheSizeBytes),t.Oo,bh(),"undefined"!=typeof document?document:null,n,this.P_,t.md.ir)},Hl.prototype.ud=function(t){if(t.md.Rd&&t.md.synchronizeTabs){var e=bh();if(!Zf._r(e))throw new Gr(Br.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=_a.to(t.Pd);return new Zf(e,t.Oo,n,t.clientId,t.Ad)}return new tl},Hl.prototype.clearPersistence=function(t){var e=_a.to(t);return _a.clearPersistence(e)},Hl),Bl=(zl.prototype.start=function(e,n){var r=this;this.Hu();var i=new Cu,o=new Cu,s=!1;return this.credentials.au(function(t){if(!s)return s=!0,Ir("FirestoreClient","Initializing. user=",t.uid),r.Vd(e,n,t,o).then(i.resolve,i.reject);r.Oo.Cr(function(){return r.m_.il(t)})}),this.Oo.Sr(function(){return i.promise}),o.promise},zl.prototype.enableNetwork=function(){var t=this;return this.Hu(),this.Oo.enqueue(function(){return t.Qc.enableNetwork()})},zl.prototype.Vd=function(a,h,c,f){return y(this,void 0,void 0,function(){var n,r,i,o,s,u=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,(s=this.Pd,Promise.resolve(new Cl(s)))];case 1:return n=t.sent(),r=Qc(this.Pd.s),e=this.credentials,i=new Tf(n,e,r),[4,a.initialize({Oo:this.Oo,Pd:this.Pd,Xu:i,clientId:this.clientId,Ad:c,V_:100,md:h})];case 2:return t.sent(),this.persistence=a.persistence,this.P_=a.P_,this.Tc=a.Tc,this.m_=a.m_,this.Qc=a.Qc,this._d=a._d,this.gd=a.Ed,this.persistence.yr(function(){return y(u,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),f.resolve(),[3,4];case 3:if(o=t.sent(),f.reject(o),!this.pd(o))throw o;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+o),this.Vd(new ql,{Rd:!1},c,f))];case 4:return[2]}var e})})},zl.prototype.pd=function(t){return"FirebaseError"===t.name?t.code===Br.FAILED_PRECONDITION||t.code===Br.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},zl.prototype.Hu=function(){if(this.Oo.eh)throw new Gr(Br.FAILED_PRECONDITION,"The client has already been terminated.")},zl.prototype.disableNetwork=function(){var t=this;return this.Hu(),this.Oo.enqueue(function(){return t.Qc.disableNetwork()})},zl.prototype.terminate=function(){var t=this;return this.Oo.oh(function(){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this._d&&this._d.stop(),[4,this.m_.Ur()];case 1:return t.sent(),[4,this.P_.Ur()];case 2:return t.sent(),[4,this.persistence.Ur()];case 3:return t.sent(),this.credentials.uu(),[2]}})})})},zl.prototype.waitForPendingWrites=function(){var t=this;this.Hu();var e=new Cu;return this.Oo.Sr(function(){return t.Qc.K_(e)}),e.promise},zl.prototype.listen=function(t,e,n){var r=this;this.Hu();var i=new sl(t,e,n);return this.Oo.Sr(function(){return r.gd.listen(i)}),i},zl.prototype.qc=function(t){var e=this;this.yd||this.Oo.Sr(function(){return e.gd.qc(t)})},zl.prototype.bd=function(o){return y(this,void 0,void 0,function(){var i,e=this;return v(this,function(t){switch(t.label){case 0:return this.Hu(),i=new Cu,[4,this.Oo.enqueue(function(){return y(e,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Tc.aa(o)];case 1:return(e=t.sent())instanceof qs?i.resolve(e):e instanceof js?i.resolve(null):i.reject(new Gr(Br.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return n=t.sent(),r=Nh(n,"Failed to get document '"+o+" from cache"),i.reject(r),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),i.promise)]}})})},zl.prototype.vd=function(a){return y(this,void 0,void 0,function(){var u,e=this;return v(this,function(t){switch(t.label){case 0:return this.Hu(),u=new Cu,[4,this.Oo.enqueue(function(){return y(e,void 0,void 0,function(){var e,n,r,i,o,s;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.Tc.la(a,!0)];case 1:return e=t.sent(),n=new el(a,e._a),r=n.n_(e.documents),i=n.wn(r,!1),u.resolve(i.snapshot),[3,3];case 2:return o=t.sent(),s=Nh(o,"Failed to execute query '"+a+" against cache"),u.reject(s),[3,3];case 3:return[2]}})})})];case 1:return[2,(t.sent(),u.promise)]}})})},zl.prototype.write=function(t){var e=this;this.Hu();var n=new Cu;return this.Oo.Sr(function(){return e.Qc.write(t,n)}),n.promise},zl.prototype.s=function(){return this.Pd.s},zl.prototype.lf=function(t){var e=this;this.Hu(),this.Oo.Sr(function(){return e.gd.lf(t),Promise.resolve()})},zl.prototype._f=function(t){var e=this;this.yd||this.Oo.Sr(function(){return e.gd._f(t),Promise.resolve()})},Object.defineProperty(zl.prototype,"yd",{get:function(){return this.Oo.eh},enumerable:!0,configurable:!0}),zl.prototype.transaction=function(t){var e=this;this.Hu();var n=new Cu;return this.Oo.Sr(function(){return e.Qc.runTransaction(e.Oo,t,n),Promise.resolve()}),n.promise},zl),Gl=(Ql.prototype.next=function(t){this.Sd(this.observer.next,t)},Ql.prototype.error=function(t){this.Sd(this.observer.error,t)},Ql.prototype.Dd=function(){this.muted=!0},Ql.prototype.Sd=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Ql);function Ql(t){this.observer=t,this.muted=!1}function zl(t,e,n){this.Pd=t,this.credentials=e,this.Oo=n,this.clientId=Dr.t()}function Hl(){return null!==Sl&&Sl.apply(this,arguments)||this}function Wl(){}function Kl(){}function Xl(){var t=this;this.sd=function(){return t.nd()},this.rd=function(){return t.od()},this.hd=[],this.ad()}function Yl(t){this.s=t.s;var e=t.ssl?"https":"http";this.Zf=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function $l(t){this.jf=t.jf,this.Kf=t.Kf}function Jl(t){this.persistence=t,this.Bf=new Bh,this.qf=null}function Zl(t){var e=this;return(e=Dl.call(this)||this).sr=t,e}function tp(t){var e=this;this.kf={},this.rr=new Su(0),this.or=!1,this.or=!0,this.Fi=t(this),this.Tr=new Ol(this),this.mn=new Gu,this.An=new hl(this.mn,function(t){return e.Fi.xf(t)})}function ep(t){this.persistence=t,this.Cf=new jr(vu,gu),this.lastRemoteSnapshotVersion=zr.min(),this.highestTargetId=0,this.Ff=0,this.Nf=new Bh,this.targetCount=0,this.$f=da.Di()}function np(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var rp,ip,op,sp,up=(Rp.prototype.Nd=function(t){switch(ro(t)){case 0:return null;case 1:return t.booleanValue;case 2:return co(t.integerValue||t.doubleValue);case 3:return this.$d(t.timestampValue);case 4:return this.kd(t);case 5:return t.stringValue;case 6:return new yc(fo(t.bytesValue));case 7:return this.xd(t.referenceValue);case 8:return this.Md(t.geoPointValue);case 9:return this.Ld(t.arrayValue);case 10:return this.Od(t.mapValue);default:throw Nr()}},Rp.prototype.Od=function(t){var n=this,r={};return Vr(t.fields||{},function(t,e){r[t]=n.Nd(e)}),r},Rp.prototype.Md=function(t){return new Uc(co(t.latitude),co(t.longitude))},Rp.prototype.Ld=function(t){var e=this;return(t.values||[]).map(function(t){return e.Nd(t)})},Rp.prototype.kd=function(t){switch(this.Cd){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return to(n)?t(n):n}(t);return null==e?null:this.Nd(e);case"estimate":return this.$d(eo(t));default:return null}},Rp.prototype.$d=function(t){var e=ho(t),n=new Qr(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},Rp.prototype.xd=function(t){var e=Wr.$(t);Ar(zo(e));var n=new Lr(e.get(1),e.get(3)),r=new ii(e.g(5));return n.isEqual(this.s)||Tr("Document "+r+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.s.projectId+"/"+this.s.database+") instead."),this.Fd(r)},Rp),ap=Oh.vh,hp=(Pp.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Pp),cp=(Object.defineProperty(xp.prototype,"Hd",{get:function(){return this.Yd||(this.Yd=new Zc(this.qa,this.zd.ignoreUndefinedProperties)),this.Yd},enumerable:!0,configurable:!0}),xp.prototype.settings=function(t){Wh("Firestore.settings",arguments,1),Yh("Firestore.settings","object",1,t);var e=new hp(t);if(this.Qd&&!this.zd.isEqual(e))throw new Gr(Br.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.zd=e).credentials&&(this.Kd=function(t){if(!t)return new vf;switch(t.type){case"gapi":var e=t.Jd;return Ar(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new wf(e,t.wu||"0");case"provider":return t.Jd;default:throw new Gr(Br.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},xp.prototype.enableNetwork=function(){return this.Ud(),this.Qd.enableNetwork()},xp.prototype.disableNetwork=function(){return this.Ud(),this.Qd.disableNetwork()},xp.prototype.enablePersistence=function(t){var e,n;if(this.Qd)throw new Gr(Br.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var r=!1,i=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Tr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),r=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n,i=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,r&&i))throw new Gr(Br.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Xd(this.Gd,{Rd:!0,cacheSizeBytes:this.zd.cacheSizeBytes,synchronizeTabs:r,ir:i})},xp.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){var r,e=this;return v(this,function(t){if(void 0!==this.Qd&&!this.Qd.yd)throw new Gr(Br.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return r=new Cu,[2,(this.qd.sh(function(){return y(e,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),e=this.Zd(),[4,this.Gd.clearPersistence(e)];case 1:return t.sent(),r.resolve(),[3,3];case 2:return n=t.sent(),r.reject(n),[3,3];case 3:return[2]}})})}),r.promise)]})})},xp.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(xp.prototype,"tw",{get:function(){return this.Ud(),this.Qd.yd},enumerable:!0,configurable:!0}),xp.prototype.waitForPendingWrites=function(){return this.Ud(),this.Qd.waitForPendingWrites()},xp.prototype.onSnapshotsInSync=function(t){if(this.Ud(),np(t))return this.ew(t);Yh("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.ew(e)},xp.prototype.ew=function(t){var e=this,n=new Gl({next:function(){t.next&&t.next()},error:function(t){throw Nr()}});return this.Qd.lf(n),function(){n.Dd(),e.Qd._f(n)}},xp.prototype.Ud=function(){return this.Qd||this.Xd(new ql,{Rd:!1}),this.Qd},xp.prototype.Zd=function(){return new kr(this.qa,this.jd,this.zd.host,this.zd.ssl,this.zd.forceLongPolling)},xp.prototype.Xd=function(t,e){var n=this.Zd();return this.Qd=new Bl(n,this.Kd,this.qd),this.Qd.start(t,e)},xp.Wd=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Gr(Br.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Gr(Br.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Lr(n)},Object.defineProperty(xp.prototype,"app",{get:function(){if(!this.Bd)throw new Gr(Br.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Bd},enumerable:!0,configurable:!0}),xp.prototype.collection=function(t){return Wh("Firestore.collection",arguments,1),Yh("Firestore.collection","non-empty string",1,t),this.Ud(),new wp(Wr.$(t),this,null)},xp.prototype.doc=function(t){return Wh("Firestore.doc",arguments,1),Yh("Firestore.doc","non-empty string",1,t),this.Ud(),pp.sw(Wr.$(t),this,null)},xp.prototype.collectionGroup=function(t){if(Wh("Firestore.collectionGroup",arguments,1),Yh("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Gr(Br.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.Ud(),new gp(new Gs(Wr.k,t),this,null)},xp.prototype.runTransaction=function(e){var n=this;return Wh("Firestore.runTransaction",arguments,1),Yh("Firestore.runTransaction","function",1,e),this.Ud().transaction(function(t){return e(new fp(n,t))})},xp.prototype.batch=function(){return this.Ud(),new lp(this)},Object.defineProperty(xp,"logLevel",{get:function(){switch(Er()){case p.DEBUG:return"debug";case p.ERROR:return"error";case p.SILENT:return"silent";case p.WARN:return"warn";case p.INFO:return"info";case p.VERBOSE:return"verbose";default:return"error"}},enumerable:!0,configurable:!0}),xp.setLogLevel=function(t){Wh("Firestore.setLogLevel",arguments,1),ec("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),br.setLogLevel(t)},xp.prototype.nw=function(){return this.zd.timestampsInSnapshots},xp),fp=(Op.prototype.get=function(t){var n=this;Wh("Transaction.get",arguments,1);var r=Cp("Transaction.get",t,this.iw);return this.rw.nc([r.Ua]).then(function(t){if(!t||1!==t.length)return Nr();var e=t[0];if(e instanceof js)return new yp(n.iw,r.Ua,null,!1,!1,r.Qa);if(e instanceof qs)return new yp(n.iw,r.Ua,e,!1,!1,r.Qa);throw Nr()})},Op.prototype.set=function(t,e,n){Xh("Transaction.set",arguments,2,3);var r=Cp("Transaction.set",t,this.iw);n=kp("Transaction.set",n);var i=Vp(r.Qa,e,"Transaction.set"),o=i[0],s=i[1],u=this.iw.Hd.Ja(s,o,n);return this.rw.set(r.Ua,u),this},Op.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof vc?(Kh("Transaction.update",arguments,3),r=Cp("Transaction.update",t,this.iw),this.iw.Hd.tu("Transaction.update",e,n,o)):(Wh("Transaction.update",arguments,2),r=Cp("Transaction.update",t,this.iw),this.iw.Hd.Za("Transaction.update",e)),this.rw.update(r.Ua,i),this},Op.prototype.delete=function(t){Wh("Transaction.delete",arguments,1);var e=Cp("Transaction.delete",t,this.iw);return this.rw.delete(e.Ua),this},Op),lp=(Dp.prototype.set=function(t,e,n){Xh("WriteBatch.set",arguments,2,3),this.aw();var r=Cp("WriteBatch.set",t,this.iw);n=kp("WriteBatch.set",n);var i=Vp(r.Qa,e,"WriteBatch.set"),o=i[0],s=i[1],u=this.iw.Hd.Ja(s,o,n);return this.ow=this.ow.concat(u.Wa(r.Ua,hs.Qe())),this},Dp.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.aw(),i="string"==typeof e||e instanceof vc?(Kh("WriteBatch.update",arguments,3),r=Cp("WriteBatch.update",t,this.iw),this.iw.Hd.tu("WriteBatch.update",e,n,o)):(Wh("WriteBatch.update",arguments,2),r=Cp("WriteBatch.update",t,this.iw),this.iw.Hd.Za("WriteBatch.update",e)),this.ow=this.ow.concat(i.Wa(r.Ua,hs.exists(!0))),this},Dp.prototype.delete=function(t){Wh("WriteBatch.delete",arguments,1),this.aw();var e=Cp("WriteBatch.delete",t,this.iw);return this.ow=this.ow.concat(new ds(e.Ua,hs.Qe())),this},Dp.prototype.commit=function(){return this.aw(),this.hw=!0,0<this.ow.length?this.iw.Ud().write(this.ow):Promise.resolve()},Dp.prototype.aw=function(){if(this.hw)throw new Gr(Br.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Dp),pp=(n(Sp,sp=Hc),Sp.sw=function(t,e,n){if(t.length%2!=0)throw new Gr(Br.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.N()+" has "+t.length);return new Sp(new ii(t),e,n)},Object.defineProperty(Sp.prototype,"id",{get:function(){return this.Ua.path.S()},enumerable:!0,configurable:!0}),Object.defineProperty(Sp.prototype,"parent",{get:function(){return new wp(this.Ua.path.p(),this.firestore,this.Qa)},enumerable:!0,configurable:!0}),Object.defineProperty(Sp.prototype,"path",{get:function(){return this.Ua.path.N()},enumerable:!0,configurable:!0}),Sp.prototype.collection=function(t){if(Wh("DocumentReference.collection",arguments,1),Yh("DocumentReference.collection","non-empty string",1,t),!t)throw new Gr(Br.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Wr.$(t);return new wp(this.Ua.path.child(e),this.firestore,null)},Sp.prototype.isEqual=function(t){if(!(t instanceof Sp))throw uc("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Ua.isEqual(t.Ua)&&this.Qa===t.Qa},Sp.prototype.set=function(t,e){Xh("DocumentReference.set",arguments,1,2),e=kp("DocumentReference.set",e);var n=Vp(this.Qa,t,"DocumentReference.set"),r=n[0],i=n[1],o=this.firestore.Hd.Ja(i,r,e);return this.Qd.write(o.Wa(this.Ua,hs.Qe()))},Sp.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof vc?(Kh("DocumentReference.update",arguments,2),this.firestore.Hd.tu("DocumentReference.update",t,e,r)):(Wh("DocumentReference.update",arguments,1),this.firestore.Hd.Za("DocumentReference.update",t)),this.Qd.write(n.Wa(this.Ua,hs.exists(!0)))},Sp.prototype.delete=function(){return Wh("DocumentReference.delete",arguments,0),this.Qd.write([new ds(this.Ua,hs.Qe())])},Sp.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Xh("DocumentReference.onSnapshot",arguments,1,4);var n={includeMetadataChanges:!1},r=0;"object"!=typeof t[r]||np(t[r])||(sc("DocumentReference.onSnapshot",n=t[r],["includeMetadataChanges"]),Zh("DocumentReference.onSnapshot","boolean","includeMetadataChanges",n.includeMetadataChanges),r++);var i={includeMetadataChanges:n.includeMetadataChanges},o=np(t[r])?t[r]:(Yh("DocumentReference.onSnapshot","function",r,t[r]),$h("DocumentReference.onSnapshot","function",r+1,t[r+1]),$h("DocumentReference.onSnapshot","function",r+2,t[r+2]),{next:t[r],error:t[r+1],complete:t[r+2]});return this.uw(i,o)},Sp.prototype.uw=function(t,n){var r=this,e=function(t){console.error("Uncaught Error in onSnapshot:",t)};n.error&&(e=n.error.bind(n));var i=new Gl({next:function(t){var e;n.next&&(e=t.docs.get(r.Ua),n.next(new yp(r.firestore,r.Ua,e,t.fromCache,t.hasPendingWrites,r.Qa)))},error:e}),o=this.Qd.listen(Gs.As(this.Ua.path),i,t);return function(){i.Dd(),r.Qd.qc(o)}},Sp.prototype.get=function(n){var r=this;return Xh("DocumentReference.get",arguments,0,1),Up("DocumentReference.get",n),new Promise(function(e,t){n&&"cache"===n.source?r.firestore.Ud().bd(r.Ua).then(function(t){e(new yp(r.firestore,r.Ua,t,!0,t instanceof qs&&t.Xe,r.Qa))},t):r.cw(e,t,n)})},Sp.prototype.cw=function(e,n,r){var i=this.uw({includeMetadataChanges:!0,Af:!0},{next:function(t){i(),!t.exists&&t.metadata.fromCache?n(new Gr(Br.UNAVAILABLE,"Failed to get document because the client is offline.")):t.exists&&t.metadata.fromCache&&r&&"server"===r.source?n(new Gr(Br.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):e(t)},error:n})},Sp.prototype.withConverter=function(t){return new Sp(this.Ua,this.firestore,t)},Sp),dp=(Ap.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Ap),yp=(Np.prototype.data=function(t){var e=this;if(Xh("DocumentSnapshot.data",arguments,0,1),t=Lp("DocumentSnapshot.data",t),this.lw){if(this.Qa){var n=new vp(this.iw,this.Ua,this.lw,this._w,this.fw,null);return this.Qa.fromFirestore(n,t)}return new up(this.iw.qa,this.iw.nw(),t.serverTimestamps||"none",function(t){return new pp(t,e.iw,null)}).Nd(this.lw.fs())}},Np.prototype.get=function(t,e){var n=this;if(Xh("DocumentSnapshot.get",arguments,1,2),e=Lp("DocumentSnapshot.get",e),this.lw){var r=this.lw.data().field(uf("DocumentSnapshot.get",t));if(null!==r)return new up(this.iw.qa,this.iw.nw(),e.serverTimestamps||"none",function(t){return new pp(t,n.iw,n.Qa)}).Nd(r)}},Object.defineProperty(Np.prototype,"id",{get:function(){return this.Ua.path.S()},enumerable:!0,configurable:!0}),Object.defineProperty(Np.prototype,"ref",{get:function(){return new pp(this.Ua,this.iw,this.Qa)},enumerable:!0,configurable:!0}),Object.defineProperty(Np.prototype,"exists",{get:function(){return null!==this.lw},enumerable:!0,configurable:!0}),Object.defineProperty(Np.prototype,"metadata",{get:function(){return new dp(this.fw,this._w)},enumerable:!0,configurable:!0}),Np.prototype.isEqual=function(t){if(!(t instanceof Np))throw uc("isEqual","DocumentSnapshot",1,t);return this.iw===t.iw&&this._w===t._w&&this.Ua.isEqual(t.Ua)&&(null===this.lw?null===t.lw:this.lw.isEqual(t.lw))&&this.Qa===t.Qa},Np),vp=(n(_p,op=yp),_p.prototype.data=function(t){return op.prototype.data.call(this,t)},_p),gp=(Tp.prototype.ww=function(t,e,n){var r;if(t.L()){if("array-contains"===e||"array-contains-any"===e)throw new Gr(Br.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+e+"' queries on FieldPath.documentId().");if("in"===e){this.Tw(n,e);for(var i=[],o=0,s=n;o<s.length;o++){var u=s[o];i.push(this.Ew(u))}r={arrayValue:{values:i}}}else r=this.Ew(n)}else"in"!==e&&"array-contains-any"!==e||this.Tw(n,e),r=this.Hd.eu("Query.where",n,"in"===e);var a=Qs.create(t,e,r);return this.Iw(a),a},Tp.prototype.Aw=function(t,e){if(null!==this.dw.startAt)throw new Gr(Br.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.dw.endAt)throw new Gr(Br.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var n=new fu(t,e);return this.Rw(n),n},Tp.prototype.mw=function(t,e,n){if(!e)throw new Gr(Br.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");for(var r=[],i=0,o=this.dw.orderBy;i<o.length;i++){var s=o[i];if(s.field.L())r.push(lo(this.qa,e.key));else{var u=e.field(s.field);if(to(u))throw new Gr(Br.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+s.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===u){var a=s.field.N();throw new Gr(Br.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+a+"' (used as the orderBy) does not exist.")}r.push(u)}}return new Ys(r,n)},Tp.prototype.Pw=function(t,e,n){var r=this.dw.ds;if(e.length>r.length)throw new Gr(Br.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<e.length;o++){var s=e[o];if(r[o].field.L()){if("string"!=typeof s)throw new Gr(Br.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof s);if(!this.dw.Bs()&&-1!==s.indexOf("/"))throw new Gr(Br.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+s+"' contains a slash.");var u=this.dw.path.child(Wr.$(s));if(!ii.W(u))throw new Gr(Br.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+u+"' is not because it contains an odd number of segments.");var a=new ii(u);i.push(lo(this.qa,a))}else{var h=this.Hd.eu(t,s);i.push(h)}}return new Ys(i,n)},Tp.prototype.Vw=function(t){if(t.xs()&&0===t.ds.length)throw new Gr(Br.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},Tp.prototype.Ew=function(t){if("string"==typeof t){if(""===t)throw new Gr(Br.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.dw.Bs()&&-1!==t.indexOf("/"))throw new Gr(Br.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this.dw.path.child(Wr.$(t));if(!ii.W(e))throw new Gr(Br.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return lo(this.qa,new ii(e))}if(t instanceof Hc)return lo(this.qa,t.Ua);throw new Gr(Br.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+ic(t)+".")},Tp.prototype.Tw=function(t,e){if(!Array.isArray(t)||0===t.length)throw new Gr(Br.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Gr(Br.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new Gr(Br.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Gr(Br.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},Tp.prototype.Iw=function(t){if(t instanceof Qs){var e=["array-contains","array-contains-any"],n=["in","array-contains-any"],r=0<=e.indexOf(t.op),i=0<=n.indexOf(t.op);if(t.Ms()){var o=this.dw.Rs();if(null!==o&&!o.isEqual(t.field))throw new Gr(Br.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var s=this.dw.ms();null!==s&&this.gw(t.field,s)}else if(i||r){var u=null;if(i&&(u=this.dw.Ls(n)),null===u&&r&&(u=this.dw.Ls(e)),null!=u)throw u===t.op?new Gr(Br.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new Gr(Br.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+u.toString()+"' filters.")}}},Tp.prototype.Rw=function(t){var e;null!==this.dw.ms()||null!==(e=this.dw.Rs())&&this.gw(e,t.field)},Tp.prototype.gw=function(t,e){if(!e.isEqual(t))throw new Gr(Br.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},n(Ip,ip=Tp),Ip.prototype.where=function(t,e,n){Wh("Query.where",arguments,3),oc("Query.where",3,n);var r=ec("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e),i=uf("Query.where",t),o=this.ww(i,r,n);return new Ip(this.dw.Ps(o),this.firestore,this.Qa)},Ip.prototype.orderBy=function(t,e){var n;if(Xh("Query.orderBy",arguments,1,2),$h("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Gr(Br.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var r=uf("Query.orderBy",t),i=this.Aw(r,n);return new Ip(this.dw.Vs(i),this.firestore,this.Qa)},Ip.prototype.limit=function(t){return Wh("Query.limit",arguments,1),Yh("Query.limit","number",1,t),ac("Query.limit",1,t),new Ip(this.dw.gs(t),this.firestore,this.Qa)},Ip.prototype.limitToLast=function(t){return Wh("Query.limitToLast",arguments,1),Yh("Query.limitToLast","number",1,t),ac("Query.limitToLast",1,t),new Ip(this.dw.ps(t),this.firestore,this.Qa)},Ip.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Kh("Query.startAt",arguments,1);var r=this.pw("Query.startAt",t,e,!0);return new Ip(this.dw.ys(r),this.firestore,this.Qa)},Ip.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Kh("Query.startAfter",arguments,1);var r=this.pw("Query.startAfter",t,e,!1);return new Ip(this.dw.ys(r),this.firestore,this.Qa)},Ip.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Kh("Query.endBefore",arguments,1);var r=this.pw("Query.endBefore",t,e,!0);return new Ip(this.dw.bs(r),this.firestore,this.Qa)},Ip.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Kh("Query.endAt",arguments,1);var r=this.pw("Query.endAt",t,e,!1);return new Ip(this.dw.bs(r),this.firestore,this.Qa)},Ip.prototype.isEqual=function(t){if(!(t instanceof Ip))throw uc("isEqual","Query",1,t);return this.firestore===t.firestore&&this.dw.isEqual(t.dw)&&this.Qa===t.Qa},Ip.prototype.withConverter=function(t){return new Ip(this.dw,this.firestore,t)},Ip.prototype.pw=function(t,e,n,r){if(oc(t,1,e),e instanceof yp)return Wh(t,d([e],n),1),this.mw(t,e.lw,r);var i=[e].concat(n);return this.Pw(t,i,r)},Ip.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Xh("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!=typeof t[i]||np(t[i])||(sc("Query.onSnapshot",r=t[i],["includeMetadataChanges"]),Zh("Query.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++),n=np(t[i])?t[i]:(Yh("Query.onSnapshot","function",i,t[i]),$h("Query.onSnapshot","function",i+1,t[i+1]),$h("Query.onSnapshot","function",i+2,t[i+2]),{next:t[i],error:t[i+1],complete:t[i+2]}),this.Vw(this.dw),this.uw(r,n)},Ip.prototype.uw=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new Gl({next:function(t){e.next&&e.next(new mp(n.firestore,n.dw,t,n.Qa))},error:r}),o=this.firestore.Ud(),s=o.listen(this.dw,i,t);return function(){i.Dd(),o.qc(s)}},Ip.prototype.get=function(n){var r=this;return Xh("Query.get",arguments,0,1),Up("Query.get",n),this.Vw(this.dw),new Promise(function(e,t){n&&"cache"===n.source?r.firestore.Ud().vd(r.dw).then(function(t){e(new mp(r.firestore,r.dw,t,r.Qa))},t):r.cw(e,t,n)})},Ip.prototype.cw=function(e,n,r){var i=this.uw({includeMetadataChanges:!0,Af:!0},{next:function(t){i(),t.metadata.fromCache&&r&&"server"===r.source?n(new Gr(Br.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):e(t)},error:n})},Ip),mp=(Object.defineProperty(Ep.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!0,configurable:!0}),Object.defineProperty(Ep.prototype,"empty",{get:function(){return this.bw.docs._()},enumerable:!0,configurable:!0}),Object.defineProperty(Ep.prototype,"size",{get:function(){return this.bw.docs.size},enumerable:!0,configurable:!0}),Ep.prototype.forEach=function(e,n){var r=this;Xh("QuerySnapshot.forEach",arguments,1,2),Yh("QuerySnapshot.forEach","function",1,e),this.bw.docs.forEach(function(t){e.call(n,r.Dw(t))})},Object.defineProperty(Ep.prototype,"query",{get:function(){return new gp(this.yw,this.iw,this.Qa)},enumerable:!0,configurable:!0}),Ep.prototype.docChanges=function(t){t&&(sc("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Zh("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.bw.qt)throw new Gr(Br.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.vw&&this.Sw===e||(this.vw=function(i,e,o,s){if(o.Lt._()){var n=0;return o.docChanges.map(function(t){var e=new vp(i,t.doc.key,t.doc,o.fromCache,o.Ot.has(t.doc.key),s);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var u=o.Lt;return o.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new vp(i,t.doc.key,t.doc,o.fromCache,o.Ot.has(t.doc.key),s),n=-1,r=-1;return 0!==t.type&&(n=u.indexOf(t.doc.key),u=u.delete(t.doc.key)),1!==t.type&&(r=(u=u.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Nr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.iw,e,this.bw,this.Qa),this.Sw=e),this.vw},Ep.prototype.isEqual=function(t){if(!(t instanceof Ep))throw uc("isEqual","QuerySnapshot",1,t);return this.iw===t.iw&&this.yw.isEqual(t.yw)&&this.bw.isEqual(t.bw)&&this.Qa===t.Qa},Ep.prototype.Dw=function(t){return new vp(this.iw,t.key,t,this.metadata.fromCache,this.bw.Ot.has(t.key),this.Qa)},Ep),wp=(n(bp,rp=gp),Object.defineProperty(bp.prototype,"id",{get:function(){return this.dw.path.S()},enumerable:!0,configurable:!0}),Object.defineProperty(bp.prototype,"parent",{get:function(){var t=this.dw.path.p();return t._()?null:new pp(new ii(t),this.firestore,null)},enumerable:!0,configurable:!0}),Object.defineProperty(bp.prototype,"path",{get:function(){return this.dw.path.N()},enumerable:!0,configurable:!0}),bp.prototype.doc=function(t){Xh("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=Dr.t()),Yh("CollectionReference.doc","non-empty string",1,t);var e=Wr.$(t);return pp.sw(this.dw.path.child(e),this.firestore,this.Qa)},bp.prototype.add=function(t){Wh("CollectionReference.add",arguments,1),Yh("CollectionReference.add","object",1,this.Qa?this.Qa.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},bp.prototype.withConverter=function(t){return new bp(this.Cw,this.firestore,t)},bp);function bp(t,e,n){var r=this;if(((r=rp.call(this,Gs.As(t),e,n)||this).Cw=t).length%2!=1)throw new Gr(Br.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.N()+" has "+t.length);return r}function Ep(t,e,n,r){this.iw=t,this.yw=e,this.bw=n,this.Qa=r,this.vw=null,this.Sw=null,this.metadata=new dp(n.hasPendingWrites,n.fromCache)}function Ip(t,e,n){var r=this;return(r=ip.call(this,e.qa,e.Hd,t)||this).dw=t,r.firestore=e,r.Qa=n,r}function Tp(t,e,n){this.qa=t,this.Hd=e,this.dw=n}function _p(){return null!==op&&op.apply(this,arguments)||this}function Np(t,e,n,r,i,o){this.iw=t,this.Ua=e,this.lw=n,this._w=r,this.fw=i,this.Qa=o}function Ap(t,e){this.hasPendingWrites=t,this.fromCache=e}function Sp(t,e,n){var r=this;return(r=sp.call(this,e.qa,t,n)||this).Ua=t,r.firestore=e,r.Qa=n,r.Qd=r.firestore.Ud(),r}function Dp(t){this.iw=t,this.ow=[],this.hw=!1}function Op(t,e){this.iw=t,this.rw=e}function xp(t,e,n){var r=this;if(void 0===n&&(n=new ql),this.Bd=null,this.qd=new Ih,this.INTERNAL={delete:function(){return y(r,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ud(),[4,this.Qd.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var i=t;this.Bd=i,this.qa=xp.Wd(i),this.jd=i.name,this.Kd=new gf(e)}else{var o=t;if(!o.projectId)throw new Gr(Br.INVALID_ARGUMENT,"Must provide projectId");this.qa=new Lr(o.projectId,o.database),this.jd="[DEFAULT]",this.Kd=new vf}this.Gd=n,this.zd=new hp({})}function Pp(t){var e,n,r,i;if(void 0===t.host){if(void 0!==t.ssl)throw new Gr(Br.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Jh("settings","non-empty string","host",t.host),this.host=t.host,Zh("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(sc("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),Zh("settings","object","credentials",t.credentials),this.credentials=t.credentials,Zh("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),Zh("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Tr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Tr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,this.ignoreUndefinedProperties=null!==(r=t.ignoreUndefinedProperties)&&void 0!==r&&r,Zh("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=Oh.Dh;else{if(t.cacheSizeBytes!==ap&&t.cacheSizeBytes<Oh.Sh)throw new Gr(Br.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+Oh.Sh);this.cacheSizeBytes=t.cacheSizeBytes}Zh("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=null!==(i=t.experimentalForceLongPolling)&&void 0!==i&&i}function Rp(t,e,n,r){this.s=t,this.timestampsInSnapshots=e,this.Cd=n,this.Fd=r}function kp(t,e){if(void 0===e)return{merge:!1};if(sc(t,e,["merge","mergeFields"]),Zh(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Gr(Br.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+ic(n));for(var r,i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof vc))throw new Gr(Br.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+ic(n[i]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Gr(Br.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function Lp(t,e){return void 0===e?{}:(sc(t,e,["serverTimestamps"]),tc(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Up(t,e){$h(t,"object",1,e),e&&(sc(t,e,["source"]),tc(t,0,"source",e.source,["default","server","cache"]))}function Cp(t,e,n){if(e instanceof Hc){if(e.firestore!==n)throw new Gr(Br.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw uc(t,"DocumentReference",1,e)}function Vp(t,e,n){var r;return t?(r=t.toFirestore(e),n="toFirestore() in "+n):r=e,[r,n]}var Mp=["length","name"];function Fp(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new Gr(Br.INVALID_ARGUMENT,t)}for(var r=0,i=Object.getOwnPropertyNames(t);r<i.length;r++){var o=i[r];-1===Mp.indexOf(o)&&(n[o]=t[o])}return n}var qp,jp=Fp(cp,"Use firebase.firestore() instead."),Bp=Fp(fp,"Use firebase.firestore().runTransaction() instead."),Gp=Fp(lp,"Use firebase.firestore().batch() instead."),Qp=Fp(pp,"Use firebase.firestore().doc() instead."),zp=Fp(yp),Hp=Fp(vp),Wp=Fp(gp),Kp=Fp(mp),Xp=Fp(wp,"Use firebase.firestore().collection() instead."),Yp=Fp(kc,"Use FieldValue.<field>() instead."),$p=Fp(yc,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),Jp={Firestore:jp,GeoPoint:Uc,Timestamp:Qr,Blob:$p,Transaction:Bp,WriteBatch:Gp,DocumentReference:Qp,DocumentSnapshot:zp,Query:Wp,QueryDocumentSnapshot:Hp,QuerySnapshot:Kp,CollectionReference:Xp,FieldPath:vc,FieldValue:Yp,setLogLevel:cp.setLogLevel,CACHE_SIZE_UNLIMITED:ap};(qp=Zp).INTERNAL.registerComponent(new gr("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new cp(e,n,new jl);var e,n},"PUBLIC").setServiceProps(Object.assign({},Jp))),qp.registerVersion("@firebase/firestore","1.15.5")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});
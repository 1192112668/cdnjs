!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(xf){"use strict";try{(function(){var u,t,e=(t=xf)&&"object"==typeof t&&"default"in t?t:{default:t},r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function i(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=c[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(be=u=u||{})[be.DEBUG=0]="DEBUG",be[be.VERBOSE=1]="VERBOSE",be[be.INFO=2]="INFO",be[be.WARN=3]="WARN",be[be.ERROR=4]="ERROR",be[be.SILENT=5]="SILENT";var a={debug:u.DEBUG,verbose:u.VERBOSE,info:u.INFO,warn:u.WARN,error:u.ERROR,silent:u.SILENT},h=u.INFO,c=((Ee={})[u.DEBUG]="log",Ee[u.VERBOSE]="log",Ee[u.INFO]="info",Ee[u.WARN]="warn",Ee[u.ERROR]="error",Ee),l=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),f.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?a[t]:t},Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=h,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(n(w,d=Error),w);function w(t,e){return(e=d.call(this,e)||this).code=t,e.name=g,Object.setPrototypeOf(e,w.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,b.prototype.create),e}var b=(E.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r,i=e[0]||{},o=this.service+"/"+t,t=(t=this.errors[t])?(r=i,t.replace(I,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").",s=new m(o,t),u=0,a=Object.keys(i);u<a.length;u++){var h=a[u];"_"!==h.slice(-1)&&(h in s&&console.warn('Overwriting FirebaseError base field "'+h+'" can cause unexpected behavior.'),s[h]=i[h])}return s},E);function E(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var I=/\{\$([^}]+)}/g,T=function(t,e){return(T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function A(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,R="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S=R||self;function D(){}function L(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function O(t){var e=L(t);return"array"==e||"object"==e&&"number"==typeof t.length}function P(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var k="closure_uid_"+(1e9*Math.random()>>>0),_=0;function U(t,e,n){return t.call.apply(t.bind,arguments)}function V(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?U:V).apply(null,arguments)}function j(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var M=Date.now;function x(t,e){function n(){}n.prototype=e.prototype,t.S=e.prototype,t.prototype=new n,t.prototype.constructor=t}function q(){this.j=this.j,this.i=this.i}q.prototype.j=!1,q.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,k)&&this[k]||(this[k]=++_))},q.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var F=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function G(){return Array.prototype.concat.apply([],arguments)}function Q(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function z(t){return/^[\s\xa0]*$/.test(t)}var W,H=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function X(t,e){return-1!=t.indexOf(e)}function Y(t,e){return t<e?-1:e<t?1:0}var K=S.navigator;function J(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Z(t){var e,n={};for(e in t)n[e]=t[e];return n}W=(K=K&&K.userAgent)?K:"";var $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function tt(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<$.length;i++)e=$[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function et(t){return et[" "](t),t}et[" "]=D;var nt,rt=X(W,"Opera"),it=X(W,"Trident")||X(W,"MSIE"),ot=X(W,"Edge"),st=ot||it,ut=X(W,"Gecko")&&!(X(W.toLowerCase(),"webkit")&&!X(W,"Edge"))&&!(X(W,"Trident")||X(W,"MSIE"))&&!X(W,"Edge"),at=X(W.toLowerCase(),"webkit")&&!X(W,"Edge");function ht(){var t=S.document;return t?t.documentMode:void 0}var ct="",lt=(lt=W,ut?/rv:([^\);]+)(\)|;)/.exec(lt):ot?/Edge\/([\d\.]+)/.exec(lt):it?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(lt):at?/WebKit\/(\S+)/.exec(lt):rt?/(?:Version)[ \/]?(\S+)/.exec(lt):void 0);lt&&(ct=lt?lt[1]:""),nt=it&&null!=(lt=ht())&&lt>parseFloat(ct)?String(lt):ct;var ft={};function pt(u){return t=u,e=function(){for(var t=0,e=H(String(nt)).split("."),n=H(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=Y(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Y(0==o[2].length,0==s[2].length)||Y(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=ft,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var dt=S.document&&it&&(ht()||parseInt(nt,10))||void 0,yt=!it||9<=Number(dt),vt=it&&!pt("9"),gt=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",D,e),S.removeEventListener("test",D,e)}catch(t){}return t}();function mt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function wt(t,e){if(mt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ut){t:{try{et(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:bt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}mt.prototype.b=function(){this.defaultPrevented=!0},x(wt,mt);var bt={2:"touch",3:"pen",4:"mouse"};wt.prototype.b=function(){wt.S.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,vt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Et="closure_listenable_"+(1e6*Math.random()|0),It=0;function Tt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++It,this.Y=this.Z=!1}function At(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function Nt(t){this.src=t,this.a={},this.b=0}function Rt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=F(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(At(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function St(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}Nt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=St(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Tt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Dt="closure_lm_"+(1e6*Math.random()|0),Lt={};function Ot(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Mt(r),e&&e[Et]?e.wa(n,r,P(i)?!!i.capture:!!i,o):Pt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Ot(t,e[o],n,r,i);return null}return n=Mt(n),t&&t[Et]?t.va(e,n,P(r)?!!r.capture:!!r,i):Pt(t,e,n,!1,r,i)}function Pt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=P(i)?!!i.capture:!!i;if(s&&!yt)return null;var u,a,h=Ct(t);if(h||(t[Dt]=h=new Nt(t)),(n=h.add(e,n,r,s,o)).proxy)return n;if(u=Vt,r=a=yt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)gt||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(_t(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function kt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[Et]?Rt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(_t(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ct(e))?(Rt(n,t),0==n.b&&(n.src=null,e[Dt]=null)):At(t)))}function _t(t){return t in Lt?Lt[t]:Lt[t]="on"+t}function Ut(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&kt(t),n.call(r,e)}function Vt(t,e){if(t.Y)return!0;if(yt)return Ut(t,new wt(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ut(t,e=new wt(e,this))}function Ct(t){return(t=t[Dt])instanceof Nt?t:null}var jt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Mt(e){return"function"==L(e)?e:(e[jt]||(e[jt]=function(t){return e.handleEvent(t)}),e[jt])}function xt(){q.call(this),this.c=new Nt(this),(this.J=this).C=null}function qt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Rt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}x(xt,q),xt.prototype[Et]=!0,(N=xt.prototype).addEventListener=function(t,e,n,r){Ot(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=P(i)?!!i.capture:!!i,r=Mt(r),e&&e[Et]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=St(s=e.a[n],r,i,o))&&(At(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Ct(e))&&(n=e.a[n.toString()],e=-1,n&&(e=St(n,r,i,o)),(r=-1<e?n[e]:null)&&kt(r))}(this,t,e,n,r)},N.dispatchEvent=function(t){var e,n=this.C;if(n)for(e=[];n;n=n.C)e.push(n);n=this.J;var r=t.type||t;if("string"==typeof t?t=new mt(t,n):t instanceof mt?t.target=t.target||n:(s=t,tt(t=new mt(r,n),s)),s=!0,e)for(var i=e.length-1;0<=i;i--)var o=t.a=e[i],s=qt(o,r,!0,t)&&s;if(s=qt(o=t.a=n,r,!0,t)&&s,s=qt(o,r,!1,t)&&s,e)for(i=0;i<e.length;i++)s=qt(o=t.a=e[i],r,!1,t)&&s;return s},N.G=function(){if(xt.S.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)At(n[r]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},N.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ft=S.JSON.stringify;function Bt(){this.b=this.a=null}var Gt,Qt=(zt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new zt(function(){return new Wt},function(t){t.reset()},100));function zt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Wt(){this.next=this.b=this.a=null}function Ht(t,e){var n;Gt||(n=S.Promise.resolve(void 0),Gt=function(){n.then(Kt)}),Xt||(Gt(),Xt=!0),Yt.add(t,e)}Bt.prototype.add=function(t,e){var n=Qt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Wt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Xt=!(Wt.prototype.reset=function(){this.next=this.b=this.a=null}),Yt=new Bt;function Kt(){for(var t,e;n=e=void 0,n=null,(e=Yt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var n=Qt;n.g(t),n.b<n.f&&(n.b++,t.next=n.a,n.a=t)}Xt=!1}function Jt(t,e){xt.call(this),this.b=t||1,this.a=e||S,this.f=C(this.Ya,this),this.g=M()}function Zt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function $t(t,e,n){if("function"==L(t))n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}x(Jt,xt),(N=Jt.prototype).aa=!1,N.M=null,N.Ya=function(){var t;this.aa&&(0<(t=M()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),this.dispatchEvent("tick"),this.aa&&(Zt(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=M())},N.G=function(){Jt.S.G.call(this),Zt(this),delete this.a};var te,ee,ne,re=(T(ee=oe,ne=te=q),ee.prototype=null===ne?Object.create(ne):(ie.prototype=ne.prototype,new ie),oe.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=$t(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},oe.prototype.G=function(){te.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},oe);function ie(){this.constructor=ee}function oe(t,e,n){var r=te.call(this)||this;return r.g=null!=n?t.bind(n):t,r.h=e,r.b=null,r.c=!1,r.a=null,r}function se(t){q.call(this),this.b=t,this.a={}}x(se,q);var ue=[];function ae(t,e,n,r){Array.isArray(n)||(n&&(ue[0]=n.toString()),n=ue);for(var i=0;i<n.length;i++){var o=Ot(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function he(t){J(t.a,function(t,e){this.a.hasOwnProperty(e)&&kt(t)},t),t.a={}}function ce(){this.a=!0}function le(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return Ft(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}se.prototype.G=function(){se.S.G.call(this),he(this)},se.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ce.prototype.info=function(){};var fe=null;function pe(){return fe=fe||new xt}function de(t){mt.call(this,"serverreachability",t)}function ye(){var t=pe();t.dispatchEvent(new de(t))}function ve(t){mt.call(this,"statevent",t)}function ge(){var t=pe();t.dispatchEvent(new ve(t))}function me(t){mt.call(this,"timingevent",t)}function we(t,e){if("function"!=L(t))throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}x(de,mt),x(ve,mt),x(me,mt);var be={NO_ERROR:0,Za:1,gb:2,fb:3,bb:4,eb:5,hb:6,Da:7,TIMEOUT:8,kb:9},Ee={ab:"complete",ob:"success",Ea:"error",Da:"abort",mb:"ready",nb:"readystatechange",TIMEOUT:"timeout",ib:"incrementaldata",lb:"progress",cb:"downloadprogress",pb:"uploadprogress"};function Ie(){}function Te(t){var e;return(e=t.a)||(e=t.a={}),e}function Ae(){}Ie.prototype.a=null;var Ne,R={OPEN:"a",$a:"b",Ea:"c",jb:"d"};function Re(){mt.call(this,"d")}function Se(){mt.call(this,"c")}function De(){}function Le(t,e,n,r){this.g=t,this.c=e,this.f=n,this.T=r||1,this.J=new se(this),this.P=Oe,t=st?125:void 0,this.R=new Jt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.U=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.W=this.C=this.V=this.I=!1}x(Re,mt),x(Se,mt),x(De,Ie),Ne=new De;var Oe=45e3,Pe={},ke={};function _e(t,e,n){t.H=1,t.i=tn(Xe(e)),t.j=n,t.I=!0,Ue(t,null)}function Ue(t,e){t.u=M(),Ce(t),t.l=Xe(t.i);var s,u,a,h,c,l,n=t.l,r=t.T;Array.isArray(r)||(r=[String(r)]),dn(n.b,"t",r),t.D=0,t.a=ur(t.g,t.g.C?e:null),0<t.O&&(t.F=new re(C(t.Ca,t,t.a),t.O)),ae(t.J,t.a,"readystatechange",t.Wa),e=t.B?Z(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ye(),s=t.c,u=t.m,a=t.l,h=t.f,c=t.T,l=t.j,s.info(function(){if(s.a)if(l)for(var t="",e=l.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=l;return"XMLHTTP REQ ("+h+") [attempt "+c+"]: "+u+"\n"+a+"\n"+t})}function Ve(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?ke:(i=Number(u.substring(i,o)),isNaN(i)?Pe:(o+=1)+i>u.length?ke:(u=u.substr(o,i),r.D=o+i,u)));if(u==ke){4==e&&(t.h=4,ge(),s=!1),le(t.c,t.f,null,"[Incomplete Response]");break}if(u==Pe){t.h=4,ge(),le(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}le(t.c,t.f,u,null),Fe(t,u)}4==e&&0==n.length&&(t.h=1,ge(),s=!1),t.b=t.b&&s,s?0<n.length&&!t.W&&(t.W=!0,(e=t.g).a==t&&e.V&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),$n(e),e.F=!0)):(le(t.c,t.f,n,"[Invalid Chunked Response]"),qe(t),xe(t))}function Ce(t){t.U=M()+t.P,je(t,t.P)}function je(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=we(C(t.Ua,t),e)}function Me(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function xe(t){0==t.g.v||t.A||nr(t.g,t)}function qe(t){Me(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Zt(t.R),he(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Fe(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||En(u.b,t)))if(u.I=t.N,!t.C&&En(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var h=a;if(0==h[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;er(u),Qn(u)}Zn(u),ge()}}else u.oa=h[1],0<u.oa-u.P&&h[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=we(C(u.Ra,u),6e3));if(bn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else ir(u,11)}else if(!t.C&&u.a!=t||er(u),!z(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)h=e[a],u.P=h[0],h=h[1],2==u.v?"c"==h[0]?(u.J=h[1],u.ga=h[2],null!=(r=h[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=h[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=h[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(X(r,"spdy")||X(r,"quic")||X(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(In(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,$e(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.V&&(u.N=M()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=sr(n,n.C?n.ga:null,n.fa),i.C?(Tn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Me(o),Ce(o)),n.a=i):Jn(n),0<u.g.length&&Hn(u)):"stop"!=h[0]&&"close"!=h[0]||ir(u,7):3==u.v&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?ir(u,7):Gn(u):"noop"!=h[0]&&u.f&&u.f.sa(h),u.o=0);ye()}catch(t){}}function Be(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(O(t)||"string"==typeof t)B(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(O(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(O(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Ge(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Ge)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Qe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];ze(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)ze(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function ze(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=Le.prototype).setTimeout=function(t){this.P=t},N.Wa=function(t){t=t.target;var e=this.F;e&&3==xn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=xn(this.a),n=this.a.ua(),r=this.a.X();if(!(e<3||3==e&&!st&&!this.a.$())){this.A||4!=e||7==n||ye(),Me(this);var i=this.a.X();if(this.N=i,n=this.a.$(),this.b=200==i,r=this.c,u=this.m,a=this.l,h=this.f,c=this.T,l=e,f=i,r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+c+"]: "+u+"\n"+a+"\n"+l+" "+f}),this.b){if(this.V&&!this.C){e:{if(this.a){var o=this.a;if((o=o.a?o.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(o)){var s=o;break e}}s=null}if(!s){this.b=!1,this.h=3,ge(),qe(this),xe(this);break t}le(this.c,this.f,s,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Fe(this,s)}this.I?(Ve(this,e,n),st&&this.b&&3==e&&(ae(this.J,this.R,"tick",this.Va),this.R.start())):(le(this.c,this.f,n,null),Fe(this,n)),4==e&&qe(this),this.b&&!this.A&&(4==e?nr(this.g,this):(this.b=!1,Ce(this)))}else 400==i&&0<n.indexOf("Unknown SID")?this.h=3:this.h=0,ge(),qe(this),xe(this)}}}catch(t){}var u,a,h,c,l,f},N.Va=function(){var t,e;this.a&&(t=xn(this.a),e=this.a.$(),this.D<e.length&&(Me(this),Ve(this,t,e),this.b&&4!=t&&Ce(this)))},N.cancel=function(){this.A=!0,qe(this)},N.Ua=function(){this.o=null;var t,e,n=M();0<=n-this.U?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ye(),ge()),qe(this),this.h=2,xe(this)):je(this,this.U-n)},(N=Ge.prototype).K=function(){Qe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return Qe(this),this.a.concat()},N.get=function(t,e){return ze(this.b,t)?this.b[t]:e},N.set=function(t,e){ze(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var We=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function He(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof He?(this.a=void 0!==e?e:t.a,Ye(this,t.f),this.j=t.j,Ke(this,t.c),Je(this,t.h),this.g=t.g,e=t.b,(n=new cn).c=e.c,e.a&&(n.a=new Ge(e.a),n.b=e.b),Ze(this,n),this.i=t.i):t&&(n=String(t).match(We))?(this.a=!!e,Ye(this,n[1]||"",!0),this.j=en(n[2]||""),Ke(this,n[3]||"",!0),Je(this,n[4]),this.g=en(n[5]||"",!0),Ze(this,n[6]||"",!0),this.i=en(n[7]||"")):(this.a=!!e,this.b=new cn(null,this.a))}function Xe(t){return new He(t)}function Ye(t,e,n){t.f=n?en(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ke(t,e,n){t.c=n?en(e,!0):e}function Je(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Ze(t,e,n){var r,i;e instanceof cn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(ln(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(fn(this,e),dn(this,n,t))},r)),r.f=i):(n||(e=nn(e,an)),t.b=new cn(e,t.a))}function $e(t,e,n){t.b.set(e,n)}function tn(t){return $e(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^M()).toString(36)),t}function en(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function nn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,rn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function rn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}He.prototype.toString=function(){var t=[],e=this.f;e&&t.push(nn(e,on,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(nn(e,on,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(nn(n,"/"==n.charAt(0)?un:sn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",nn(n,hn)),t.join("")};var on=/[#\/\?@]/g,sn=/[#\?:]/g,un=/[#\?]/g,an=/[#\?@]/g,hn=/#/g;function cn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function ln(u){u.a||(u.a=new Ge,u.b=0,u.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],o=n,s=i?decodeURIComponent(i.replace(/\+/g," ")):"",u.add(decodeURIComponent(o.replace(/\+/g," ")),s)}}var o,s}(u.c))}function fn(t,e){ln(t),e=yn(t,e),ze(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,ze((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Qe(t)))}function pn(t,e){return ln(t),e=yn(t,e),ze(t.a.b,e)}function dn(t,e,n){fn(t,e),0<n.length&&(t.c=null,t.a.set(yn(t,e),Q(n)),t.b+=n.length)}function yn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function vn(t,e){this.b=t,this.a=e}function gn(t){this.g=t||mn,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().qb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(N=cn.prototype).add=function(t,e){ln(this),this.c=null,t=yn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(n,r){ln(this),this.a.forEach(function(t,e){B(t,function(t){n.call(r,t,e,this)},this)},this)},N.L=function(){ln(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},N.K=function(t){ln(this);var e=[];if("string"==typeof t)pn(this,t)&&(e=G(e,this.a.get(yn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=G(e,t[n])}return e},N.set=function(t,e){return ln(this),this.c=null,pn(this,t=yn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var mn=10;function wn(t){return t.b||t.a&&t.a.size>=t.f}function bn(t){return t.b?1:t.a?t.a.size:0}function En(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function In(t,e){t.a?t.a.add(e):t.b=e}function Tn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function An(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return Q(t.c);var r=t.c;try{for(var i=A(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Nn(){}function Rn(){this.a=new Nn}function Sn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}gn.prototype.cancel=function(){var t,e;if(this.c=An(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=A(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},Nn.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},Nn.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var Dn=S.JSON.parse;function Ln(t){xt.call(this),this.headers=new Ge,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=On,this.D=this.F=!1}x(Ln,xt);var On="",Pn=/^https?$/i,kn=["POST","PUT"];function _n(t){return"content-type"==t.toLowerCase()}function Un(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Vn(t),jn(t)}function Vn(t){t.u||(t.u=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Cn(t){if(t.b&&(!t.s[1]||4!=xn(t)||2!=t.X()))if(t.l&&4==xn(t))$t(t.za,0,t);else if(t.dispatchEvent("readystatechange"),4==xn(t)){t.b=!1;try{var e,n,r,i,o=t.X();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(We)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!Pn.test(i?i.toLowerCase():"")),e=n),e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<xn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.X()+"]",Vn(t)}}finally{jn(t)}}}function jn(t,e){if(t.a){Mn(t);var n=t.a,r=t.s[0]?D:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function Mn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function xn(t){return t.a?t.a.readyState:0}function qn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",J(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):$e(t,e,n))}function Fn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Bn(t){this.pa=0,this.g=[],this.c=new ce,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.W=this.i=this.O=this.l=null,this.La=this.R=0,this.Ia=Fn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.T=!0,this.I=this.oa=this.P=-1,this.U=this.o=this.u=0,this.Fa=Fn("baseRetryDelayMs",5e3,t),this.Ma=Fn("retryDelaySeedMs",1e4,t),this.Ja=Fn("forwardChannelMaxRetries",2,t),this.ma=Fn("forwardChannelRequestTimeoutMs",2e4,t),this.Ka=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new gn(t&&t.concurrentRequestLimit),this.ka=new Rn,this.da=t&&t.fastHandshake||!1,this.Ga=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.T=!1),this.V=!this.da&&this.T&&t&&t.c||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null}function Gn(t){var e,n;zn(t),3==t.v&&(e=t.R++,$e(n=Xe(t.B),"SID",t.J),$e(n,"RID",e),$e(n,"TYPE","terminate"),Yn(t,n),(e=new Le(t,t.c,e,void 0)).H=2,e.i=tn(Xe(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.i.toString(),"")),!n&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=ur(e.g,null),e.a.ba(e.i)),e.u=M(),Ce(e)),or(t)}function Qn(t){t.a&&($n(t),t.a.cancel(),t.a=null)}function zn(t){Qn(t),t.j&&(S.clearTimeout(t.j),t.j=null),er(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function Wn(t,e){t.g.push(new vn(t.La++,e)),3==t.v&&Hn(t)}function Hn(t){wn(t.b)||t.h||(t.h=!0,Ht(t.Ba,t),t.u=0)}function Xn(t,e){var n=e?e.f:t.R++,r=Xe(t.B);$e(r,"SID",t.J),$e(r,"RID",n),$e(r,"AID",t.P),Yn(t,r),t.i&&t.l&&qn(r,t.i,t.l),n=new Le(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Kn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),In(t.b,n),_e(n,r,e)}function Yn(t,n){t.f&&Be({},function(t,e){$e(n,e,t)})}function Kn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?C(t.f.Ha,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=i[a].b,c=i[a].a;if((h-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+h+"_"||"";try{Be(t,function(t,e){var n=t;P(t)&&(n=Ft(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(c,s)}catch(t){r&&r(c)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Jn(t){t.a||t.j||(t.U=1,Ht(t.Aa,t),t.o=0)}function Zn(t){return!(t.a||t.j||3<=t.o)&&(t.U++,t.j=we(C(t.Aa,t),rr(t,t.o)),t.o++,1)}function $n(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function tr(t){t.a=new Le(t,t.c,"rpc",t.U),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Xe(t.la);$e(e,"RID","rpc"),$e(e,"SID",t.J),$e(e,"CI",t.H?"0":"1"),$e(e,"AID",t.P),Yn(t,e),$e(e,"TYPE","xmlhttp"),t.i&&t.l&&qn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=tn(Xe(e)),n.j=null,n.I=!0,Ue(n,t)}function er(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function nr(t,e){var n,r=null;if(t.a==e){er(t),$n(t),t.a=null;var i=2}else{if(!En(t.b,e))return;r=e.s,Tn(t.b,e),i=1}if(t.I=e.N,0!=t.v)if(e.b)1==i?(r=e.j?e.j.length:0,e=M()-e.u,n=t.u,(i=pe()).dispatchEvent(new me(i)),Hn(t)):Jn(t);else if(3==(n=e.h)||0==n&&0<t.I||!(1==i&&function(t,e){if(!(bn(t.b)>=t.b.f-(t.h?1:0))){if(t.h)return t.g=e.s.concat(t.g),1;if(!(1==t.v||2==t.v||t.u>=(t.Ia?0:t.Ja)))return t.h=we(C(t.Ba,t,e),rr(t,t.u)),t.u++,1}}(t,e)||2==i&&Zn(t)))switch(r&&0<r.length&&(e=t.b,e.c=e.c.concat(r)),n){case 1:ir(t,5);break;case 4:ir(t,10);break;case 3:ir(t,6);break;default:ir(t,2)}}function rr(t,e){var n=t.Fa+Math.floor(Math.random()*t.Ma);return t.f||(n*=2),n*e}function ir(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=C(t.Xa,t),r||(r=new He("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||Ye(r,"https"),tn(r)),n=r.toString(),r=o,o=new ce,S.Image?((i=new Image).onload=j(Sn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=j(Sn,o,i,"TestLoadImage: error",!1,r),i.onabort=j(Sn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=j(Sn,o,i,"TestLoadImage: timeout",!1,r),S.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):ge(),t.v=0,t.f&&t.f.ra(e),or(t),zn(t)}function or(t){t.v=0,t.I=-1,t.f&&(0==An(t.b).length&&0==t.g.length||(t.b.c.length=0,Q(t.g),t.g.length=0),t.f.qa())}function sr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof He?Xe(s):new He(s,void 0);return""!=a.c?(e&&Ke(a,e+"."+a.c),Je(a,a.h)):(r=(u=S.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new He(null,void 0),r&&Ye(u,r),i&&Ke(u,i),o&&Je(u,o),s&&(u.g=s),a=u),t.W&&J(t.W,function(t,e){$e(a,e,t)}),e=t.A,n=t.na,e&&n&&$e(a,e,n),$e(a,"VER",t.ha),Yn(t,a),a}function ur(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Ln(t.Ka)).F=t.C,e}function ar(){}function hr(){if(it&&!(10<=Number(dt)))throw Error("Environmental error: no available transport.")}function cr(t,e){xt.call(this),this.a=new Bn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!z(t)&&(this.a.i=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!z(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new pr(this)}function lr(t){Re.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function fr(){Se.call(this),this.status=1}function pr(t){this.a=t}(N=Ln.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Te(this.H):Te(Ne),this.a.onreadystatechange=C(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Un(this,t)}t=n||"";var i,o=new Ge(this.headers);r&&Be(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=_n,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=F(kn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Mn(this),0<this.o&&((this.D=(i=this.a,it&&pt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=C(this.xa,this)):this.m=$t(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Un(this,t)}},N.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),jn(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),jn(this,!0)),Ln.S.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?Cn(this):this.Ta())},N.Ta=function(){Cn(this)},N.X=function(){try{return 2<xn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Na=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Dn(e)}},N.ua=function(){return this.h},N.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=Bn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Le(this,this.c,t,void 0),r=this.l;if(this.O&&(r?tt(r=Z(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Kn(this,n,e),$e(i=Xe(this.B),"RID",t),$e(i,"CVER",22),this.A&&$e(i,"X-HTTP-Session-Id",this.A),Yn(this,i),this.i&&r&&qn(i,this.i,r),In(this.b,n),this.Ga&&$e(i,"TYPE","init"),this.da?($e(i,"$req",e),$e(i,"SID","null"),n.V=!0,_e(n,i,null)):_e(n,i,e),this.v=2}}else 3==this.v&&(t?Xn(this,t):0==this.g.length||wn(this.b)||Xn(this))},N.Aa=function(){var t;this.j=null,tr(this),this.V&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=we(C(this.Sa,this),t))},N.Sa=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,Qn(this),tr(this))},N.Ra=function(){null!=this.m&&(this.m=null,Qn(this),Zn(this),ge())},N.Xa=function(t){t?this.c.info("Successfully pinged google.com"):this.c.info("Failed to ping google.com"),ge()},(N=ar.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ha=function(){},hr.prototype.a=function(t,e){return new cr(t,e)},x(cr,xt),(N=cr.prototype).addEventListener=function(t,e,n,r){cr.S.addEventListener.call(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){cr.S.removeEventListener.call(this,t,e,n,r)},N.Oa=function(){this.a.f=this.f,this.h&&(this.a.C=!0);var t=this.a,e=this.l,n=this.b||void 0;ge(),t.fa=e,t.W=n||{},t.H=t.T,t.B=sr(t,null,t.fa),Hn(t)},N.close=function(){Gn(this.a)},N.Pa=function(t){var e;"string"==typeof t?((e={}).__data__=t,Wn(this.a,e)):this.g?((e={}).__data__=Ft(t),Wn(this.a,e)):Wn(this.a,t)},N.G=function(){this.a.f=null,delete this.f,Gn(this.a),delete this.a,cr.S.G.call(this)},x(lr,Re),x(fr,Se),x(pr,ar),pr.prototype.ta=function(){this.a.dispatchEvent("a")},pr.prototype.sa=function(t){this.a.dispatchEvent(new lr(t))},pr.prototype.ra=function(t){this.a.dispatchEvent(new fr)},pr.prototype.qa=function(){this.a.dispatchEvent("b")},hr.prototype.createWebChannel=hr.prototype.a,cr.prototype.send=cr.prototype.Pa,cr.prototype.open=cr.prototype.Oa,be.NO_ERROR=0,be.TIMEOUT=8,be.HTTP_ERROR=6,Ee.COMPLETE="complete",(Ae.EventType=R).OPEN="a",R.CLOSE="b",R.ERROR="c",R.MESSAGE="d",xt.prototype.listen=xt.prototype.va,Ln.prototype.listenOnce=Ln.prototype.wa,Ln.prototype.getLastError=Ln.prototype.Qa,Ln.prototype.getLastErrorCode=Ln.prototype.ua,Ln.prototype.getStatus=Ln.prototype.X,Ln.prototype.getResponseJson=Ln.prototype.Na,Ln.prototype.getResponseText=Ln.prototype.$,Ln.prototype.send=Ln.prototype.ba;var dr=(Ee={createWebChannelTransport:function(){return new hr},ErrorCode:be,EventType:Ee,WebChannel:Ae,XhrIo:Ln}).createWebChannelTransport,yr=Ee.ErrorCode,vr=Ee.EventType,gr=Ee.WebChannel,mr=Ee.XhrIo,wr=(br.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},br.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},br.prototype.setServiceProps=function(t){return this.serviceProps=t,this},br);function br(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var Er,Ir={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Tr=(n(Nr,Er=Error),Nr),Ar=new l("@firebase/firestore");function Nr(t,e){var n=this;return(n=Er.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Rr(){return Ar.logLevel}function Sr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=u.DEBUG&&(e=n.map(Or),Ar.debug.apply(Ar,i(["Firestore (7.23.0): "+t],e)))}function Dr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=u.ERROR&&(e=n.map(Or),Ar.error.apply(Ar,i(["Firestore (7.23.0): "+t],e)))}function Lr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];Ar.logLevel<=u.WARN&&(e=n.map(Or),Ar.warn.apply(Ar,i(["Firestore (7.23.0): "+t],e)))}function Or(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Pr(t){throw void 0===t&&(t="Unexpected state"),Dr(t="FIRESTORE (7.23.0) INTERNAL ASSERTION FAILED: "+t),new Error(t)}function kr(t){t||Pr()}function _r(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function Ur(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Vr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Cr,jr,l=(Object.defineProperty(zr.prototype,"length",{get:function(){return this.t},enumerable:!1,configurable:!0}),zr.prototype.isEqual=function(t){return 0===zr.i(this,t)},zr.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof zr?t.forEach(function(t){e.push(t)}):e.push(t),this.o(e)},zr.prototype.limit=function(){return this.offset+this.length},zr.prototype.u=function(t){return t=void 0===t?1:t,this.o(this.segments,this.offset+t,this.length-t)},zr.prototype.h=function(){return this.o(this.segments,this.offset,this.length-1)},zr.prototype.l=function(){return this.segments[this.offset]},zr.prototype._=function(){return this.get(this.length-1)},zr.prototype.get=function(t){return this.segments[this.offset+t]},zr.prototype.m=function(){return 0===this.length},zr.prototype.T=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},zr.prototype.I=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},zr.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},zr.prototype.A=function(){return this.segments.slice(this.offset,this.limit())},zr.i=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},zr),Mr=(n(Qr,jr=l),Qr.prototype.o=function(t,e,n){return new Qr(t,e,n)},Qr.prototype.R=function(){return this.A().join("/")},Qr.prototype.toString=function(){return this.R()},Qr.P=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new Qr(n)},Qr.p=function(){return new Qr([])},Qr),xr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,qr=(n(Gr,Cr=l),Gr.prototype.o=function(t,e,n){return new Gr(t,e,n)},Gr.g=function(t){return xr.test(t)},Gr.prototype.R=function(){return this.A().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),Gr.g(t)||(t="`"+t+"`"),t}).join(".")},Gr.prototype.toString=function(){return this.R()},Gr.prototype.V=function(){return 1===this.length&&"__name__"===this.get(0)},Gr.v=function(){return new Gr(["__name__"])},Gr.S=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Tr(Ir.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Tr(Ir.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Tr(Ir.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Gr(e)},Gr.p=function(){return new Gr([])},Gr),Fr=(Br.C=function(t){return new Br(Mr.P(t))},Br.D=function(t){return new Br(Mr.P(t).u(5))},Br.prototype.F=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Br.prototype.isEqual=function(t){return null!==t&&0===Mr.i(this.path,t.path)},Br.prototype.toString=function(){return this.path.toString()},Br.i=function(t,e){return Mr.i(t.path,e.path)},Br.N=function(t){return t.length%2==0},Br.$=function(t){return new Br(new Mr(t.slice()))},Br);function Br(t){this.path=t}function Gr(){return null!==Cr&&Cr.apply(this,arguments)||this}function Qr(){return null!==jr&&jr.apply(this,arguments)||this}function zr(t,e,n){void 0===e?e=0:e>t.length&&Pr(),void 0===n?n=t.length-e:n>t.length-e&&Pr(),this.segments=t,this.offset=e,this.t=n}function Wr(t,e){if(0!==e.length)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+ci(e.length,"argument")+".")}function Hr(t,e,n){if(e.length!==n)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires "+ci(n,"argument")+", but was called with "+ci(e.length,"argument")+".")}function Xr(t,e,n){if(e.length<n)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires at least "+ci(n,"argument")+", but was called with "+ci(e.length,"argument")+".")}function Yr(t,e,n,r){if(e.length<n||e.length>r)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+ci(e.length,"argument")+".")}function Kr(t,e,n,r){ni(t,e,hi(n)+" argument",r)}function Jr(t,e,n,r){void 0!==r&&Kr(t,e,n,r)}function Zr(t,e,n,r){ni(t,e,n+" option",r)}function $r(t,e,n,r){void 0!==r&&Zr(t,e,n,r)}function ti(t,e,n,r,a){void 0!==r&&function(t,e,n){for(var r=[],i=0,o=a;i<o.length;i++){var s=o[i];if(s===n)return;r.push(ii(s))}var u=ii(n);throw new Tr(Ir.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+r.join(", "))}(t,n,r)}function ei(t,e,n,r){if(!e.some(function(t){return t===r}))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid value "+ii(r)+" provided to function "+t+"() for its "+hi(n)+" argument. Acceptable values: "+e.join(", "));return r}function ni(t,e,n,r){if(!("object"===e?ri(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e))throw r=ii(r),new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}function ri(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function ii(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Pr();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function oi(t,e,n){if(void 0===n)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+hi(e)+" argument, but it was undefined.")}function si(n,t,r){Ur(t,function(t,e){if(r.indexOf(t)<0)throw new Tr(Ir.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function ui(t,e,n,r){return r=ii(r),new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires its "+hi(n)+" argument to be a "+e+", but it was: "+r)}function ai(t,e,n){if(n<=0)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires its "+hi(e)+" argument to be a positive number, but it was: "+n+".")}function hi(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function ci(t,e){return t+" "+e+(1===t?"":"s")}var li=(fi.k=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},fi);function fi(){}function pi(t,e){return t<e?-1:e<t?1:0}function di(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}var yi=(vi.fromBase64String=function(t){return new vi(atob(t))},vi.fromUint8Array=function(t){return new vi(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},vi.prototype.toBase64=function(){return t=this.O,btoa(t);var t},vi.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.O)},vi.prototype.M=function(){return 2*this.O.length},vi.prototype.L=function(t){return pi(this.O,t.O)},vi.prototype.isEqual=function(t){return this.O===t.O},vi);function vi(t){this.O=t}yi.q=new yi("");var gi=(mi.fromBase64String=function(t){try{return new mi(yi.fromBase64String(t))}catch(t){throw new Tr(Ir.INVALID_ARGUMENT,"Failed to construct Bytes from Base64 string: "+t)}},mi.fromUint8Array=function(t){return new mi(yi.fromUint8Array(t))},mi.prototype.toBase64=function(){return this.U.toBase64()},mi.prototype.toUint8Array=function(){return this.U.toUint8Array()},mi.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},mi.prototype.isEqual=function(t){return this.U.isEqual(t.U)},mi);function mi(t){this.U=t}function wi(){if("undefined"==typeof Uint8Array)throw new Tr(Ir.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function bi(){if("undefined"==typeof atob)throw new Tr(Ir.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function Ei(t,e,n,r,i){this.B=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}var Ii,Ti=(n(ki,Ii=gi),ki.fromBase64String=function(t){Hr("Blob.fromBase64String",arguments,1),Kr("Blob.fromBase64String","string",1,t),bi();try{return new ki(yi.fromBase64String(t))}catch(t){throw new Tr(Ir.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},ki.fromUint8Array=function(t){if(Hr("Blob.fromUint8Array",arguments,1),wi(),!(t instanceof Uint8Array))throw ui("Blob.fromUint8Array","Uint8Array",1,t);return new ki(yi.fromUint8Array(t))},ki.prototype.toBase64=function(){return Hr("Blob.toBase64",arguments,0),bi(),Ii.prototype.toBase64.call(this)},ki.prototype.toUint8Array=function(){return Hr("Blob.toUint8Array",arguments,0),wi(),Ii.prototype.toUint8Array.call(this)},ki.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},ki),Ai=(Object.defineProperty(Pi.prototype,"j",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Pi.prototype.isEqual=function(t){return t instanceof Pi&&t.projectId===this.projectId&&t.database===this.database},Pi.prototype.L=function(t){return pi(this.projectId,t.projectId)||pi(this.database,t.database)},Pi),Ni=(Oi.prototype.get=function(t){var e=this.W(t);if(void 0!==(e=this.K[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.G(i,t))return o}},Oi.prototype.has=function(t){return void 0!==this.get(t)},Oi.prototype.set=function(t,e){var n=this.W(t),r=this.K[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.G(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.K[n]=[[t,e]]},Oi.prototype.delete=function(t){var e=this.W(t),n=this.K[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.G(n[r][0],t))return 1===n.length?delete this.K[e]:n.splice(r,1),!0;return!1},Oi.prototype.forEach=function(s){Ur(this.K,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},Oi.prototype.m=function(){return Vr(this.K)},Oi),Ri=(Li.now=function(){return Li.fromMillis(Date.now())},Li.fromDate=function(t){return Li.fromMillis(t.getTime())},Li.fromMillis=function(t){var e=Math.floor(t/1e3);return new Li(e,1e6*(t-1e3*e))},Li.prototype.toDate=function(){return new Date(this.toMillis())},Li.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Li.prototype.H=function(t){return this.seconds===t.seconds?pi(this.nanoseconds,t.nanoseconds):pi(this.seconds,t.seconds)},Li.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Li.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Li.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},Li.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Li),Si=(Di.Y=function(t){return new Di(t)},Di.min=function(){return new Di(new Ri(0,0))},Di.prototype.L=function(t){return this.timestamp.H(t.timestamp)},Di.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},Di.prototype.J=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},Di.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},Di.prototype.X=function(){return this.timestamp},Di);function Di(t){this.timestamp=t}function Li(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Tr(Ir.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Oi(t,e){this.W=t,this.G=e,this.K={}}function Pi(t,e){this.projectId=t,this.database=e||"(default)"}function ki(){return null!==Ii&&Ii.apply(this,arguments)||this}function _i(t){return null==t}function Ui(t){return 0===t&&1/t==-1/0}var Vi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Z=null};function Ci(t,e,n,r,i,o,s){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),new Vi(t,e,n,r,i,o,s)}function ji(t){var e=t;return null===e.Z&&(t=e.path.R(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.R()+t.op.toString()+jo(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.R()+t.dir}).join(","),_i(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=ia(e.startAt)),e.endAt&&(t+="|ub:",t+=ia(e.endAt)),e.Z=t),e.Z}function Mi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!_o(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!sa(t.startAt,e.startAt)&&sa(t.endAt,e.endAt)}function xi(t){return Fr.N(t.path)&&null===t.collectionGroup&&0===t.filters.length}function qi(t){this.count=t}var Fi,Bi=(Gi.prototype.nt=function(t){return new Gi(this.target,this.targetId,this.tt,t,this.et,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Gi.prototype.st=function(t,e){return new Gi(this.target,this.targetId,this.tt,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Gi.prototype.it=function(t){return new Gi(this.target,this.targetId,this.tt,this.sequenceNumber,this.et,t,this.resumeToken)},Gi);function Gi(t,e,n,r,i,o,s){void 0===i&&(i=Si.min()),void 0===o&&(o=Si.min()),void 0===s&&(s=yi.q),this.target=t,this.targetId=e,this.tt=n,this.sequenceNumber=r,this.et=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Qi(t){switch(t){case Ir.OK:return Pr(),0;case Ir.CANCELLED:case Ir.UNKNOWN:case Ir.DEADLINE_EXCEEDED:case Ir.RESOURCE_EXHAUSTED:case Ir.INTERNAL:case Ir.UNAVAILABLE:case Ir.UNAUTHENTICATED:return;case Ir.INVALID_ARGUMENT:case Ir.NOT_FOUND:case Ir.ALREADY_EXISTS:case Ir.PERMISSION_DENIED:case Ir.FAILED_PRECONDITION:case Ir.ABORTED:case Ir.OUT_OF_RANGE:case Ir.UNIMPLEMENTED:case Ir.DATA_LOSS:return 1;default:return Pr(),0}}function zi(t){if(void 0===t)return Dr("GRPC error has no .code"),Ir.UNKNOWN;switch(t){case Fi.OK:return Ir.OK;case Fi.CANCELLED:return Ir.CANCELLED;case Fi.UNKNOWN:return Ir.UNKNOWN;case Fi.DEADLINE_EXCEEDED:return Ir.DEADLINE_EXCEEDED;case Fi.RESOURCE_EXHAUSTED:return Ir.RESOURCE_EXHAUSTED;case Fi.INTERNAL:return Ir.INTERNAL;case Fi.UNAVAILABLE:return Ir.UNAVAILABLE;case Fi.UNAUTHENTICATED:return Ir.UNAUTHENTICATED;case Fi.INVALID_ARGUMENT:return Ir.INVALID_ARGUMENT;case Fi.NOT_FOUND:return Ir.NOT_FOUND;case Fi.ALREADY_EXISTS:return Ir.ALREADY_EXISTS;case Fi.PERMISSION_DENIED:return Ir.PERMISSION_DENIED;case Fi.FAILED_PRECONDITION:return Ir.FAILED_PRECONDITION;case Fi.ABORTED:return Ir.ABORTED;case Fi.OUT_OF_RANGE:return Ir.OUT_OF_RANGE;case Fi.UNIMPLEMENTED:return Ir.UNIMPLEMENTED;case Fi.DATA_LOSS:return Ir.DATA_LOSS;default:return Pr()}}(l=Fi=Fi||{})[l.OK=0]="OK",l[l.CANCELLED=1]="CANCELLED",l[l.UNKNOWN=2]="UNKNOWN",l[l.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",l[l.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",l[l.NOT_FOUND=5]="NOT_FOUND",l[l.ALREADY_EXISTS=6]="ALREADY_EXISTS",l[l.PERMISSION_DENIED=7]="PERMISSION_DENIED",l[l.UNAUTHENTICATED=16]="UNAUTHENTICATED",l[l.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",l[l.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",l[l.ABORTED=10]="ABORTED",l[l.OUT_OF_RANGE=11]="OUT_OF_RANGE",l[l.UNIMPLEMENTED=12]="UNIMPLEMENTED",l[l.INTERNAL=13]="INTERNAL",l[l.UNAVAILABLE=14]="UNAVAILABLE",l[l.DATA_LOSS=15]="DATA_LOSS";var Wi=(Ji.prototype.rt=function(t,e){return new Ji(this.i,this.root.rt(t,e,this.i).copy(null,null,Xi.ot,null,null))},Ji.prototype.remove=function(t){return new Ji(this.i,this.root.remove(t,this.i).copy(null,null,Xi.ot,null,null))},Ji.prototype.get=function(t){for(var e=this.root;!e.m();){var n=this.i(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Ji.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.m();){var r=this.i(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Ji.prototype.m=function(){return this.root.m()},Object.defineProperty(Ji.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Ji.prototype.ut=function(){return this.root.ut()},Ji.prototype.ct=function(){return this.root.ct()},Ji.prototype.at=function(t){return this.root.at(t)},Ji.prototype.forEach=function(n){this.at(function(t,e){return n(t,e),!1})},Ji.prototype.toString=function(){var n=[];return this.at(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Ji.prototype.ht=function(t){return this.root.ht(t)},Ji.prototype.lt=function(){return new Hi(this.root,null,this.i,!1)},Ji.prototype._t=function(t){return new Hi(this.root,t,this.i,!1)},Ji.prototype.ft=function(){return new Hi(this.root,null,this.i,!0)},Ji.prototype.dt=function(t){return new Hi(this.root,t,this.i,!0)},Ji),Hi=(Ki.prototype.Et=function(){var t=this.Tt.pop(),e={key:t.key,value:t.value};if(this.wt)for(t=t.left;!t.m();)this.Tt.push(t),t=t.right;else for(t=t.right;!t.m();)this.Tt.push(t),t=t.left;return e},Ki.prototype.It=function(){return 0<this.Tt.length},Ki.prototype.At=function(){if(0===this.Tt.length)return null;var t=this.Tt[this.Tt.length-1];return{key:t.key,value:t.value}},Ki),Xi=(Yi.prototype.copy=function(t,e,n,r,i){return new Yi(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Yi.prototype.m=function(){return!1},Yi.prototype.at=function(t){return this.left.at(t)||t(this.key,this.value)||this.right.at(t)},Yi.prototype.ht=function(t){return this.right.ht(t)||t(this.key,this.value)||this.left.ht(t)},Yi.prototype.min=function(){return this.left.m()?this:this.left.min()},Yi.prototype.ut=function(){return this.min().key},Yi.prototype.ct=function(){return this.right.m()?this.key:this.right.ct()},Yi.prototype.rt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.rt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.rt(t,e,n))).Rt()},Yi.prototype.yt=function(){if(this.left.m())return Yi.EMPTY;var t=this;return t.left.Pt()||t.left.left.Pt()||(t=t.gt()),(t=t.copy(null,null,null,t.left.yt(),null)).Rt()},Yi.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.m()||r.left.Pt()||r.left.left.Pt()||(r=r.gt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Pt()&&(r=r.Vt()),r.right.m()||r.right.Pt()||r.right.left.Pt()||(r=r.vt()),0===e(t,r.key)){if(r.right.m())return Yi.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.yt())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Rt()},Yi.prototype.Pt=function(){return this.color},Yi.prototype.Rt=function(){var t=this;return t.right.Pt()&&!t.left.Pt()&&(t=t.bt()),t.left.Pt()&&t.left.left.Pt()&&(t=t.Vt()),t.left.Pt()&&t.right.Pt()&&(t=t.St()),t},Yi.prototype.gt=function(){var t=this.St();return t.right.left.Pt()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Vt())).bt()).St()),t},Yi.prototype.vt=function(){var t=this.St();return t.left.left.Pt()&&(t=(t=t.Vt()).St()),t},Yi.prototype.bt=function(){var t=this.copy(null,null,Yi.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Yi.prototype.Vt=function(){var t=this.copy(null,null,Yi.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Yi.prototype.St=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Yi.prototype.Ct=function(){var t=this.Dt();return Math.pow(2,t)<=this.size+1},Yi.prototype.Dt=function(){if(this.Pt()&&this.left.Pt())throw Pr();if(this.right.Pt())throw Pr();var t=this.left.Dt();if(t!==this.right.Dt())throw Pr();return t+(this.Pt()?0:1)},Yi);function Yi(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Yi.RED,this.left=null!=r?r:Yi.EMPTY,this.right=null!=i?i:Yi.EMPTY,this.size=this.left.size+1+this.right.size}function Ki(t,e,n,r){this.wt=r,this.Tt=[];for(var i=1;!t.m();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.wt?t.left:t.right;else{if(0===i){this.Tt.push(t);break}this.Tt.push(t),t=this.wt?t.right:t.left}}function Ji(t,e){this.i=t,this.root=e||Xi.EMPTY}function Zi(){this.size=0}Xi.EMPTY=null,Xi.RED=!0,Xi.ot=!1,Xi.EMPTY=(Object.defineProperty(Zi.prototype,"key",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(Zi.prototype,"value",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(Zi.prototype,"color",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(Zi.prototype,"left",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Object.defineProperty(Zi.prototype,"right",{get:function(){throw Pr()},enumerable:!1,configurable:!0}),Zi.prototype.copy=function(t,e,n,r,i){return this},Zi.prototype.rt=function(t,e,n){return new Xi(t,e)},Zi.prototype.remove=function(t,e){return this},Zi.prototype.m=function(){return!0},Zi.prototype.at=function(t){return!1},Zi.prototype.ht=function(t){return!1},Zi.prototype.ut=function(){return null},Zi.prototype.ct=function(){return null},Zi.prototype.Pt=function(){return!1},Zi.prototype.Ct=function(){return!0},Zi.prototype.Dt=function(){return 0},new Zi);var $i=(ro.prototype.has=function(t){return null!==this.data.get(t)},ro.prototype.first=function(){return this.data.ut()},ro.prototype.last=function(){return this.data.ct()},Object.defineProperty(ro.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),ro.prototype.indexOf=function(t){return this.data.indexOf(t)},ro.prototype.forEach=function(n){this.data.at(function(t,e){return n(t),!1})},ro.prototype.Ft=function(t,e){for(var n=this.data._t(t[0]);n.It();){var r=n.Et();if(0<=this.i(r.key,t[1]))return;e(r.key)}},ro.prototype.Nt=function(t,e){for(var n=void 0!==e?this.data._t(e):this.data.lt();n.It();)if(!t(n.Et().key))return},ro.prototype.$t=function(t){return(t=this.data._t(t)).It()?t.Et().key:null},ro.prototype.lt=function(){return new to(this.data.lt())},ro.prototype._t=function(t){return new to(this.data._t(t))},ro.prototype.add=function(t){return this.copy(this.data.remove(t).rt(t,!0))},ro.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},ro.prototype.m=function(){return this.data.m()},ro.prototype.kt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},ro.prototype.isEqual=function(t){if(!(t instanceof ro))return!1;if(this.size!==t.size)return!1;for(var e=this.data.lt(),n=t.data.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(0!==this.i(r,i))return!1}return!0},ro.prototype.A=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},ro.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},ro.prototype.copy=function(t){var e=new ro(this.i);return e.data=t,e},ro),to=(no.prototype.Et=function(){return this.xt.Et().key},no.prototype.It=function(){return this.xt.It()},no),eo=new Wi(Fr.i);function no(t){this.xt=t}function ro(t){this.i=t,this.data=new Wi(this.i)}var io=new Wi(Fr.i),oo=new Wi(Fr.i),so=new $i(Fr.i);function uo(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=so,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var ao=new $i(pi),ho=(Ro.Lt=function(t){return new Ro(t.i)},Ro.prototype.has=function(t){return null!=this.Ot.get(t)},Ro.prototype.get=function(t){return this.Ot.get(t)},Ro.prototype.first=function(){return this.Mt.ut()},Ro.prototype.last=function(){return this.Mt.ct()},Ro.prototype.m=function(){return this.Mt.m()},Ro.prototype.indexOf=function(t){return(t=this.Ot.get(t))?this.Mt.indexOf(t):-1},Object.defineProperty(Ro.prototype,"size",{get:function(){return this.Mt.size},enumerable:!1,configurable:!0}),Ro.prototype.forEach=function(n){this.Mt.at(function(t,e){return n(t),!1})},Ro.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ot.rt(t.key,t),e.Mt.rt(t,null))},Ro.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ot.remove(t),this.Mt.remove(e)):this},Ro.prototype.isEqual=function(t){if(!(t instanceof Ro))return!1;if(this.size!==t.size)return!1;for(var e=this.Mt.lt(),n=t.Mt.lt();e.It();){var r=e.Et().key,i=n.Et().key;if(!r.isEqual(i))return!1}return!0},Ro.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Ro.prototype.copy=function(t,e){var n=new Ro;return n.i=this.i,n.Ot=t,n.Mt=e,n},Ro),co=(No.prototype.track=function(t){var e=t.doc.key,n=this.qt.get(e);!n||0!==t.type&&3===n.type?this.qt=this.qt.rt(e,t):3===t.type&&1!==n.type?this.qt=this.qt.rt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.qt=this.qt.rt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.qt=this.qt.rt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.qt=this.qt.remove(e):1===t.type&&2===n.type?this.qt=this.qt.rt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.qt=this.qt.rt(e,{type:2,doc:t.doc}):Pr()},No.prototype.Ut=function(){var n=[];return this.qt.at(function(t,e){n.push(e)}),n},No),lo=(Ao.Gt=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Ao(t,e,ho.Lt(e),i,n,r,!0,!1)},Object.defineProperty(Ao.prototype,"hasPendingWrites",{get:function(){return!this.Qt.m()},enumerable:!1,configurable:!0}),Ao.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.jt===t.jt&&this.Qt.isEqual(t.Qt)&&Su(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Bt.isEqual(t.Bt)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Ao),fo=(To.Jt=function(t,e){var n=new Map;return n.set(t,po.Xt(t,e)),new To(Si.min(),n,ao,eo,uo())},To),po=(Io.Xt=function(t,e){return new Io(yi.q,e,uo(),uo(),uo())},Io),yo=function(t,e,n,r){this.se=t,this.removedTargetIds=e,this.key=n,this.ie=r},vo=function(t,e){this.targetId=t,this.re=e},go=function(t,e,n,r){void 0===n&&(n=yi.q),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},mo=(Object.defineProperty(Eo.prototype,"Zt",{get:function(){return this.ae},enumerable:!1,configurable:!0}),Object.defineProperty(Eo.prototype,"resumeToken",{get:function(){return this.ce},enumerable:!1,configurable:!0}),Object.defineProperty(Eo.prototype,"le",{get:function(){return 0!==this.oe},enumerable:!1,configurable:!0}),Object.defineProperty(Eo.prototype,"_e",{get:function(){return this.he},enumerable:!1,configurable:!0}),Eo.prototype.fe=function(t){0<t.M()&&(this.he=!0,this.ce=t)},Eo.prototype.de=function(){var n=uo(),r=uo(),i=uo();return this.ue.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Pr()}}),new po(this.ce,this.ae,n,r,i)},Eo.prototype.we=function(){this.he=!1,this.ue=Do()},Eo.prototype.me=function(t,e){this.he=!0,this.ue=this.ue.rt(t,e)},Eo.prototype.Te=function(t){this.he=!0,this.ue=this.ue.remove(t)},Eo.prototype.Ee=function(){this.oe+=1},Eo.prototype.Ie=function(){--this.oe},Eo.prototype.Ae=function(){this.he=!0,this.ae=!0},Eo),wo=(bo.prototype.Ve=function(t){for(var e=0,n=t.se;e<n.length;e++){var r=n[e];t.ie instanceof hu?this.ve(r,t.ie):t.ie instanceof cu&&this.be(r,t.key,t.ie)}for(var i=0,o=t.removedTargetIds;i<o.length;i++){var s=o[i];this.be(s,t.key,t.ie)}},bo.prototype.Se=function(n){var r=this;this.Ce(n,function(t){var e=r.De(t);switch(n.state){case 0:r.Fe(t)&&e.fe(n.resumeToken);break;case 1:e.Ie(),e.le||e.we(),e.fe(n.resumeToken);break;case 2:e.Ie(),e.le||r.removeTarget(t);break;case 3:r.Fe(t)&&(e.Ae(),e.fe(n.resumeToken));break;case 4:r.Fe(t)&&(r.Ne(t),e.fe(n.resumeToken));break;default:Pr()}})},bo.prototype.Ce=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.ye.forEach(function(t,e){r.Fe(e)&&n(e)})},bo.prototype.$e=function(t){var e=t.targetId,n=t.re.count;(t=this.ke(e))&&(xi(t=t.target)?0===n?(t=new Fr(t.path),this.be(e,t,new cu(t,Si.min()))):kr(1===n):this.xe(e)!==n&&(this.Ne(e),this.ge=this.ge.add(e)))},bo.prototype.Oe=function(r){var i=this,o=new Map;this.ye.forEach(function(t,e){var n=i.ke(e);n&&(t.Zt&&xi(n.target)&&(n=new Fr(n.target.path),null!==i.Pe.get(n)||i.Me(e,n)||i.be(e,n,new cu(n,r))),t._e&&(o.set(e,t.de()),t.we()))});var s=uo();this.pe.forEach(function(t,e){var n=!0;e.Nt(function(t){return!(t=i.ke(t))||2===t.tt||(n=!1)}),n&&(s=s.add(t))});var t=new fo(r,o,this.ge,this.Pe,s);return this.Pe=eo,this.pe=So(),this.ge=new $i(pi),t},bo.prototype.ve=function(t,e){var n;this.Fe(t)&&(n=this.Me(t,e.key)?2:0,this.De(t).me(e.key,n),this.Pe=this.Pe.rt(e.key,e),this.pe=this.pe.rt(e.key,this.Le(e.key).add(t)))},bo.prototype.be=function(t,e,n){var r;this.Fe(t)&&(r=this.De(t),this.Me(t,e)?r.me(e,1):r.Te(e),this.pe=this.pe.rt(e,this.Le(e).delete(t)),n&&(this.Pe=this.Pe.rt(e,n)))},bo.prototype.removeTarget=function(t){this.ye.delete(t)},bo.prototype.xe=function(t){var e=this.De(t).de();return this.Re.qe(t).size+e.te.size-e.ne.size},bo.prototype.Ee=function(t){this.De(t).Ee()},bo.prototype.De=function(t){var e=this.ye.get(t);return e||(e=new mo,this.ye.set(t,e)),e},bo.prototype.Le=function(t){var e=this.pe.get(t);return e||(e=new $i(pi),this.pe=this.pe.rt(t,e)),e},bo.prototype.Fe=function(t){var e=null!==this.ke(t);return e||Sr("WatchChangeAggregator","Detected inactive target",t),e},bo.prototype.ke=function(t){var e=this.ye.get(t);return e&&e.le?null:this.Re.Ue(t)},bo.prototype.Ne=function(e){var n=this;this.ye.set(e,new mo),this.Re.qe(e).forEach(function(t){n.be(e,t,null)})},bo.prototype.Me=function(t,e){return this.Re.qe(t).has(e)},bo);function bo(t){this.Re=t,this.ye=new Map,this.Pe=eo,this.pe=So(),this.ge=new $i(pi)}function Eo(){this.oe=0,this.ue=Do(),this.ce=yi.q,this.ae=!1,this.he=!0}function Io(t,e,n,r,i){this.resumeToken=t,this.Zt=e,this.te=n,this.ee=r,this.ne=i}function To(t,e,n,r,i){this.et=t,this.zt=e,this.Kt=n,this.Ht=r,this.Yt=i}function Ao(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Bt=n,this.docChanges=r,this.Qt=i,this.fromCache=o,this.jt=s,this.Wt=u}function No(){this.qt=new Wi(Fr.i)}function Ro(n){this.i=n?function(t,e){return n(t,e)||Fr.i(t.key,e.key)}:function(t,e){return Fr.i(t.key,e.key)},this.Ot=io,this.Mt=new Wi(this.i)}function So(){return new Wi(Fr.i)}function Do(){return new Wi(Fr.i)}function Lo(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Oo(t){return t=Mo(t.mapValue.fields.__local_write_time__.timestampValue),new Ri(t.seconds,t.nanos)}var Po=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ko(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Lo(t)?4:10:Pr()}function _o(r,i){var t,e,n,o=ko(r);if(o!==ko(i))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return Oo(r).isEqual(Oo(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=Mo(r.timestampValue),t=Mo(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return t=i,qo(r.bytesValue).isEqual(qo(t.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return o=i,xo((t=r).geoPointValue.latitude)===xo(o.geoPointValue.latitude)&&xo(t.geoPointValue.longitude)===xo(o.geoPointValue.longitude);case 2:return n=i,"integerValue"in(e=r)&&"integerValue"in n?xo(e.integerValue)===xo(n.integerValue):"doubleValue"in e&&"doubleValue"in n&&((e=xo(e.doubleValue))===(n=xo(n.doubleValue))?Ui(e)===Ui(n):isNaN(e)&&isNaN(n));case 9:return di(r.arrayValue.values||[],i.arrayValue.values||[],_o);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(_r(e)!==_r(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!_o(e[t],n[t])))return!1;return!0}();default:return Pr()}}function Uo(t,e){return void 0!==(t.values||[]).find(function(t){return _o(t,e)})}function Vo(t,e){var n,r,i,o,s=ko(t),u=ko(e);if(s!==u)return pi(s,u);switch(s){case 0:return 0;case 1:return pi(t.booleanValue,e.booleanValue);case 2:return n=e,(r=xo(t.integerValue||t.doubleValue))<(n=xo(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return Co(t.timestampValue,e.timestampValue);case 4:return Co(Oo(t),Oo(e));case 5:return pi(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,o=e.bytesValue,i=qo(i),o=qo(o),i.L(o);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=pi(n[i],r[i]);if(0!==o)return o}return pi(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return s=t.geoPointValue,r=e.geoPointValue,0!==(n=pi(xo(s.latitude),xo(r.latitude)))?n:pi(xo(s.longitude),xo(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Vo(n[i],r[i]);if(o)return o}return pi(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=pi(r[s],o[s]);if(0!==u)return u;if(0!==(u=Vo(n[r[s]],i[o[s]])))return u}return pi(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Pr()}}function Co(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return pi(t,e);var n=Mo(t),t=Mo(e);return 0!==(e=pi(n.seconds,t.seconds))?e:pi(n.nanos,t.nanos)}function jo(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=Mo(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?qo(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,Fr.D(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Pr();var t,e}(t)}function Mo(t){if(kr(!!t),"string"!=typeof t)return{seconds:xo(t.seconds),nanos:xo(t.nanos)};var e=0,n=Po.exec(t);return kr(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function xo(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function qo(t){return"string"==typeof t?yi.fromBase64String(t):yi.fromUint8Array(t)}function Fo(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.R()}}function Bo(t){return t&&"integerValue"in t}function Go(t){return!!t&&"arrayValue"in t}function Qo(t){return t&&"nullValue"in t}function zo(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Wo(t){return t&&"mapValue"in t}var Ho={asc:"ASCENDING",desc:"DESCENDING"},Xo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Yo=function(t,e){this.B=t,this.Be=e};function Ko(t){return{integerValue:""+t}}function Jo(t,e){if(t.Be){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ui(e)?"-0":e}}function Zo(t,e){return"number"==typeof(n=e)&&Number.isInteger(n)&&!Ui(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER?Ko(e):Jo(t,e);var n}function $o(t,e){return t.Be?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function ts(t,e){return t.Be?e.toBase64():e.toUint8Array()}function es(t){return kr(!!t),Si.Y((t=Mo(t),new Ri(t.seconds,t.nanos)))}function ns(t,e){return new Mr(["projects",t.projectId,"databases",t.database]).child("documents").child(e).R()}function rs(t,e){return ns(t.B,e.path)}function is(t,e){return kr(ls(e=Mr.P(e))),kr(e.get(1)===t.B.projectId),kr(!e.get(3)&&!t.B.database||e.get(3)===t.B.database),new Fr((kr(4<(e=e).length&&"documents"===e.get(4)),e.u(5)))}function os(t,e){return ns(t.B,e)}function ss(t){return new Mr(["projects",t.B.projectId,"databases",t.B.database]).R()}function us(t,e,n){return{name:rs(t,e),fields:n.proto.mapValue.fields}}function as(t,e){var n,r,i;if(e instanceof Fs)n={update:us(t,e.key,e.value)};else if(e instanceof Zs)n={delete:rs(t,e.key)};else if(e instanceof Bs)n={update:us(t,e.key,e.data),updateMask:(i=e.Qe,r=[],i.fields.forEach(function(t){return r.push(t.R())}),{fieldPaths:r})};else if(e instanceof Hs)n={transform:{document:rs(t,e.key),fieldTransforms:e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof ys)return{fieldPath:t.field.R(),setToServerValue:"REQUEST_TIME"};if(e instanceof vs)return{fieldPath:t.field.R(),appendMissingElements:{values:e.elements}};if(e instanceof Es)return{fieldPath:t.field.R(),removeAllFromArray:{values:e.elements}};if(e instanceof Ns)return{fieldPath:t.field.R(),increment:e.je};throw Pr()})}};else{if(!(e instanceof $s))return Pr();n={verify:rs(t,e.key)}}return e.Ge.We||(n.currentDocument=void 0!==(i=e.Ge).updateTime?{updateTime:$o(e=t,(t=i.updateTime).X())}:void 0!==i.exists?{exists:i.exists}:Pr()),n}function hs(t){return{before:t.before,values:t.position}}function cs(t){return{fieldPath:t.R()}}function ls(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}function fs(t,e){return t instanceof Ns?Bo(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var ps,ds,ys=(n(ms,ds=l=function(){this.ze=void 0}),ms),vs=(n(gs,ps=l),gs);function gs(t){var e=this;return(e=ps.call(this)||this).elements=t,e}function ms(){return null!==ds&&ds.apply(this,arguments)||this}function ws(t,e){for(var n=Ds(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return _o(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var bs,Es=(n(Is,bs=l),Is);function Is(t){var e=this;return(e=bs.call(this)||this).elements=t,e}function Ts(t,e){for(var n=Ds(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!_o(t,e)})}(i[r]);return{arrayValue:{values:n}}}var As,Ns=(n(Rs,As=l),Rs);function Rs(t,e){var n=this;return(n=As.call(this)||this).serializer=t,n.je=e,n}function Ss(t){return xo(t.integerValue||t.doubleValue)}function Ds(t){return Go(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Ls(t,e){this.field=t,this.transform=e}var Os=(Ps.prototype.Ke=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].T(t))return!0;return!1},Ps.prototype.isEqual=function(t){return di(this.fields,t.fields,function(t,e){return t.isEqual(e)})},Ps);function Ps(t){(this.fields=t).sort(qr.i)}function ks(t,e){this.version=t,this.transformResults=e}var _s=(Us.He=function(){return new Us},Us.exists=function(t){return new Us(void 0,t)},Us.updateTime=function(t){return new Us(t)},Object.defineProperty(Us.prototype,"We",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Us.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Us);function Us(t,e){this.updateTime=t,this.exists=e}function Vs(t,e){return void 0!==t.updateTime?e instanceof hu&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof hu}function Cs(t,e,n,r){return t instanceof Fs?(o=e,Vs((i=t).Ge,o)?(o=Ms(o),new hu(i.key,o,i.value,{Ye:!0})):o):t instanceof Bs?function(t,e){if(!Vs(t.Ge,e))return e;var n=Ms(e),e=zs(t,e);return new hu(t.key,n,e,{Ye:!0})}(t,e):t instanceof Hs?function(t,e,n,r){if(!Vs(t.Ge,e))return e;var i=e,r=function(t,e,n,r){for(var i,o=[],s=0,u=t;s<u.length;s++){var a=u[s],h=a.transform,c=null;n instanceof hu&&(c=n.field(a.field)),null===c&&r instanceof hu&&(c=r.field(a.field)),o.push((i=c,a=e,c=void 0,(h=h)instanceof ys?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}},i&&(c.fields.__previous_value__=i),{mapValue:c}):h instanceof vs?ws(h,i):h instanceof Es?Ts(h,i):(i=Ss(h=fs(c=h,i))+Ss(c.je),Bo(h)&&Bo(c.je)?Ko(i):Jo(c.serializer,i))))}return o}(t.fieldTransforms,n,e,r),r=Ys(t,i.data(),r);return new hu(t.key,i.version,r,{Ye:!0})}(t,e,r,n):(e=e,Vs((t=t).Ge,e)?new cu(t.key,Si.min()):e);var i,o}function js(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.Ge.isEqual(e.Ge)&&(0===t.type?t.value.isEqual(e.value):1===t.type?t.data.isEqual(e.data)&&t.Qe.isEqual(e.Qe):2!==t.type||di(t.fieldTransforms,t.fieldTransforms,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof vs&&e instanceof vs||t instanceof Es&&e instanceof Es?di(t.elements,e.elements,_o):t instanceof Ns&&e instanceof Ns?_o(t.je,e.je):t instanceof ys&&e instanceof ys)}))}function Ms(t){return t instanceof hu?t.version:Si.min()}var xs,qs,Fs=(n(Qs,qs=l=function(){}),Qs),Bs=(n(Gs,xs=l),Gs);function Gs(t,e,n,r){var i=this;return(i=xs.call(this)||this).key=t,i.data=e,i.Qe=n,i.Ge=r,i.type=1,i}function Qs(t,e,n){var r=this;return(r=qs.call(this)||this).key=t,r.value=e,r.Ge=n,r.type=0,r}function zs(t,e){return n=t,e=e instanceof hu?e.data():tu.empty(),r=new eu(e),n.Qe.fields.forEach(function(t){var e;t.m()||(null!==(e=n.data.field(t))?r.set(t,e):r.delete(t))}),r.Je();var n,r}var Ws,Hs=(n(Xs,Ws=l),Xs);function Xs(t,e){var n=this;return(n=Ws.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Ge=_s.exists(!0),n}function Ys(t,e,n){for(var r=new eu(e),i=0;i<t.fieldTransforms.length;i++){var o=t.fieldTransforms[i];r.set(o.field,n[i])}return r.Je()}var Ks,Js,Zs=(n(ou,Js=l),ou),$s=(n(iu,Ks=l),iu),tu=(ru.empty=function(){return new ru({mapValue:{}})},ru.prototype.field=function(t){if(t.m())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Wo(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t._()])||null},ru.prototype.isEqual=function(t){return _o(this.proto,t.proto)},ru),eu=(nu.prototype.set=function(t,e){return this.tn(t,e),this},nu.prototype.delete=function(t){return this.tn(t,null),this},nu.prototype.tn=function(t,e){for(var n=this.Ze,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===ko(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t._(),e)},nu.prototype.Je=function(){var t=this.en(qr.p(),this.Ze);return null!=t?new tu(t):this.Xe},nu.prototype.en=function(r,t){var i=this,o=!1,e=this.Xe.field(r),s=Wo(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.en(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},nu);function nu(t){void 0===t&&(t=tu.empty()),this.Xe=t,this.Ze=new Map}function ru(t){this.proto=t}function iu(t,e){var n=this;return(n=Ks.call(this)||this).key=t,n.Ge=e,n.type=4,n}function ou(t,e){var n=this;return(n=Js.call(this)||this).key=t,n.Ge=e,n.type=3,n}var su,uu,au,hu=(n(yu,au=l=function(t,e){this.key=t,this.version=e}),yu.prototype.field=function(t){return this.nn.field(t)},yu.prototype.data=function(){return this.nn},yu.prototype.sn=function(){return this.nn.proto},yu.prototype.isEqual=function(t){return t instanceof yu&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Ye===t.Ye&&this.hasCommittedMutations===t.hasCommittedMutations&&this.nn.isEqual(t.nn)},yu.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.nn.toString()+", {hasLocalMutations: "+this.Ye+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(yu.prototype,"hasPendingWrites",{get:function(){return this.Ye||this.hasCommittedMutations},enumerable:!1,configurable:!0}),yu),cu=(n(du,uu=l),du.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(du.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),du.prototype.isEqual=function(t){return t instanceof du&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},du),lu=(n(pu,su=l),pu.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(pu.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),pu.prototype.isEqual=function(t){return t instanceof pu&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},pu),fu=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.rn=n,this.filters=r,this.limit=i,this.on=o,this.startAt=s,this.endAt=u,this.un=null,this.cn=null,this.startAt,this.endAt};function pu(){return null!==su&&su.apply(this,arguments)||this}function du(t,e,n){var r=this;return(r=uu.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function yu(t,e,n,r){var i=this;return(i=au.call(this,t,e)||this).nn=n,i.Ye=!!r.Ye,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function vu(t){return new fu(t)}function gu(t){return!_i(t.limit)&&"F"===t.on}function mu(t){return!_i(t.limit)&&"L"===t.on}function wu(t){return 0<t.rn.length?t.rn[0].field:null}function bu(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.an())return r.field}return null}function Eu(t){return null!==t.collectionGroup}function Iu(t){var e=t;if(null===e.un){e.un=[];var n=bu(e),t=wu(e);if(null!==n&&null===t)n.V()||e.un.push(new ua(n)),e.un.push(new ua(qr.v(),"asc"));else{for(var r=!1,i=0,o=e.rn;i<o.length;i++){var s=o[i];e.un.push(s),s.field.V()&&(r=!0)}r||(n=0<e.rn.length?e.rn[e.rn.length-1].dir:"asc",e.un.push(new ua(qr.v(),n)))}}return e.un}function Tu(t){var e=t;if(!e.cn)if("F"===e.on)e.cn=Ci(e.path,e.collectionGroup,Iu(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Iu(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new ua(o.field,s))}var u=e.endAt?new $u(e.endAt.position,!e.endAt.before):null,t=e.startAt?new $u(e.startAt.position,!e.startAt.before):null;e.cn=Ci(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.cn}function Au(t,e,n){return new fu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Nu(t,e){return new fu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,e,t.endAt)}function Ru(t,e){return new fu(t.path,t.collectionGroup,t.rn.slice(),t.filters.slice(),t.limit,t.on,t.startAt,e)}function Su(t,e){return Mi(Tu(t),Tu(e))&&t.on===e.on}function Du(t){return ji(Tu(t))+"|lt:"+t.on}function Lu(t){return"Query(target="+(n=(e=Tu(t)).path.R(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.R()+" "+t.op+" "+jo(t.value)}).join(", ")+"]"),_i(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.R()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+ia(e.startAt)),e.endAt&&(n+=", endAt: "+ia(e.endAt)),"Target("+n+")")+"; limitType="+t.on+")";var e,n}function Ou(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.F(e.collectionGroup)&&e.path.T(n):Fr.N(e.path)?e.path.isEqual(n):e.path.I(n))&&function(t){for(var e=0,n=i.rn;e<n.length;e++){var r=n[e];if(!r.field.V()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||oa(t.startAt,Iu(t),n))&&(!t.endAt||!oa(t.endAt,Iu(t),n)));var e,n}function Pu(u){return function(t,e){for(var n=!1,r=0,i=Iu(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i,o;switch(n=t.field.V()?Fr.i(e.key,n.key):(r=t.field,i=n,o=e.field(r),r=i.field(r),null!==o&&null!==r?Vo(o,r):Pr()),t.dir){case"asc":return n;case"desc":return-1*n;default:return Pr()}}(o,t,e);if(0!==s)return s;n=n||o.field.V()}return 0}}var ku,_u=(n(Uu,ku=function(){}),Uu.create=function(t,e,n){if(t.V())return"in"===e||"not-in"===e?this.hn(t,e,n):new Mu(t,e,n);if(Qo(n)){if("=="!==e&&"!="!==e)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. Null only supports '==' and '!=' comparisons.");return new Uu(t,e,n)}if(zo(n)){if("=="!==e&&"!="!==e)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. NaN only supports '==' and '!=' comparisons.");return new Uu(t,e,n)}return"array-contains"===e?new Yu(t,n):"in"===e?new Ku(t,n):"not-in"===e?new Ju(t,n):"array-contains-any"===e?new Zu(t,n):new Uu(t,e,n)},Uu.hn=function(t,e,n){return new("in"===e?xu:qu)(t,n)},Uu.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this.ln(Vo(t,this.value)):null!==t&&ko(this.value)===ko(t)&&this.ln(Vo(t,this.value))},Uu.prototype.ln=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Pr()}},Uu.prototype.an=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},Uu);function Uu(t,e,n){var r=this;return(r=ku.call(this)||this).field=t,r.op=e,r.value=n,r}var Vu,Cu,ju,Mu=(n(Gu,ju=_u),Gu.prototype.matches=function(t){return t=Fr.i(t.key,this.key),this.ln(t)},Gu),xu=(n(Bu,Cu=_u),Bu.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},Bu),qu=(n(Fu,Vu=_u),Fu.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},Fu);function Fu(t,e){var n=this;return(n=Vu.call(this,t,"not-in",e)||this).keys=Qu(0,e),n}function Bu(t,e){var n=this;return(n=Cu.call(this,t,"in",e)||this).keys=Qu(0,e),n}function Gu(t,e,n){var r=this;return(r=ju.call(this,t,e,n)||this).key=Fr.D(n.referenceValue),r}function Qu(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return Fr.D(t.referenceValue)})}var zu,Wu,Hu,Xu,Yu=(n(ra,Xu=_u),ra.prototype.matches=function(t){return Go(t=t.field(this.field))&&Uo(t.arrayValue,this.value)},ra),Ku=(n(na,Hu=_u),na.prototype.matches=function(t){return null!==(t=t.field(this.field))&&Uo(this.value.arrayValue,t)},na),Ju=(n(ea,Wu=_u),ea.prototype.matches=function(t){return!Uo(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!Uo(this.value.arrayValue,t))},ea),Zu=(n(ta,zu=_u),ta.prototype.matches=function(t){var e=this;return!(!Go(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return Uo(e.value.arrayValue,t)})},ta),$u=function(t,e){this.position=t,this.before=e};function ta(t,e){return zu.call(this,t,"array-contains-any",e)||this}function ea(t,e){return Wu.call(this,t,"not-in",e)||this}function na(t,e){return Hu.call(this,t,"in",e)||this}function ra(t,e){return Xu.call(this,t,"array-contains",e)||this}function ia(t){return(t.before?"b":"a")+":"+t.position.map(jo).join(",")}function oa(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.V()?Fr.i(Fr.D(s.referenceValue),n.key):Vo(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function sa(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!_o(t.position[n],e.position[n]))return!1;return!0}var ua=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function aa(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var ha=(fa.prototype.reset=function(){this.Tn=0},fa.prototype.An=function(){this.Tn=this.mn},fa.prototype.Rn=function(t){var e=this;this.cancel();var n=Math.floor(this.Tn+this.yn()),r=Math.max(0,Date.now()-this.In),i=Math.max(0,n-r);0<i&&Sr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Tn+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.En=this._n.Pn(this.fn,i,function(){return e.In=Date.now(),t()}),this.Tn*=this.wn,this.Tn<this.dn&&(this.Tn=this.dn),this.Tn>this.mn&&(this.Tn=this.mn)},fa.prototype.pn=function(){null!==this.En&&(this.En.gn(),this.En=null)},fa.prototype.cancel=function(){null!==this.En&&(this.En.cancel(),this.En=null)},fa.prototype.yn=function(){return(Math.random()-.5)*this.Tn},fa),ca=(la.prototype.catch=function(t){return this.next(void 0,t)},la.prototype.next=function(r,i){var o=this;return this.Sn&&Pr(),this.Sn=!0,this.bn?this.error?this.Cn(i,this.error):this.Dn(r,this.result):new la(function(e,n){o.Vn=function(t){o.Dn(r,t).next(e,n)},o.vn=function(t){o.Cn(i,t).next(e,n)}})},la.prototype.Fn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},la.prototype.Nn=function(t){try{var e=t();return e instanceof la?e:la.resolve(e)}catch(t){return la.reject(t)}},la.prototype.Dn=function(t,e){return t?this.Nn(function(){return t(e)}):la.resolve(e)},la.prototype.Cn=function(t,e){return t?this.Nn(function(){return t(e)}):la.reject(e)},la.resolve=function(n){return new la(function(t,e){t(n)})},la.reject=function(n){return new la(function(t,e){e(n)})},la.$n=function(t){return new la(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},la.kn=function(t){for(var n=la.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?la.resolve(t):e()})}(r[e]);return n},la.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.$n(i)},la);function la(t){var e=this;this.Vn=null,this.vn=null,this.result=void 0,this.error=void 0,this.bn=!1,this.Sn=!1,t(function(t){e.bn=!0,e.result=t,e.Vn&&e.Vn(t)},function(t){e.bn=!0,e.error=t,e.vn&&e.vn(t)})}function fa(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this._n=t,this.fn=e,this.dn=n,this.wn=r,this.mn=i,this.Tn=0,this.En=null,this.In=Date.now(),this.reset()}function pa(t){return"IndexedDbTransactionError"===t.name}function da(){return"undefined"!=typeof document?document:null}var ya=(ma.qn=function(t,e,n,r,i){return(i=new ma(t,e,Date.now()+n,r,i)).start(n),i},ma.prototype.start=function(t){var e=this;this.Un=setTimeout(function(){return e.Bn()},t)},ma.prototype.gn=function(){return this.Bn()},ma.prototype.cancel=function(t){null!==this.Un&&(this.clearTimeout(),this.Ln.reject(new Tr(Ir.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},ma.prototype.Bn=function(){var e=this;this.xn.Qn(function(){return null!==e.Un?(e.clearTimeout(),e.op().then(function(t){return e.Ln.resolve(t)})):Promise.resolve()})},ma.prototype.clearTimeout=function(){null!==this.Un&&(this.Mn(this),clearTimeout(this.Un),this.Un=null)},ma),va=(Object.defineProperty(ga.prototype,"Zn",{get:function(){return this.Gn},enumerable:!1,configurable:!0}),ga.prototype.Qn=function(t){this.enqueue(t)},ga.prototype.ts=function(t){this.es(),this.ns(t)},ga.prototype.ss=function(){var t;this.Gn||(this.Gn=!0,(t=da())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xn))},ga.prototype.enqueue=function(t){return this.es(),this.Gn?new Promise(function(t){}):this.ns(t)},ga.prototype.rs=function(t){var e=this;this.Wn.push(t),this.Qn(function(){return e.os()})},ga.prototype.os=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Wn.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Wn[0]()];case 2:return t.sent(),this.Wn.shift(),this.Jn.reset(),[3,4];case 3:if(!pa(e=t.sent()))throw e;return Sr("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Wn.length&&this.Jn.Rn(function(){return n.os()}),t.label=5;case 5:return[2]}})})},ga.prototype.ns=function(t){var r=this,e=this.jn.then(function(){return r.Hn=!0,t().catch(function(t){throw r.Kn=t,r.Hn=!1,Dr("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",e.stack&&(n=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),n)),t;var e,n}).then(function(t){return r.Hn=!1,t})});return this.jn=e},ga.prototype.Pn=function(t,e,n){var r=this;return this.es(),-1<this.Yn.indexOf(t)&&(e=0),n=ya.qn(this,t,e,n,function(t){return r.us(t)}),this.zn.push(n),n},ga.prototype.es=function(){this.Kn&&Pr()},ga.prototype.cs=function(){},ga.prototype.hs=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.jn];case 1:t.sent(),t.label=2;case 2:if(e!==this.jn)return[3,0];t.label=3;case 3:return[2]}})})},ga.prototype.ls=function(t){for(var e=0,n=this.zn;e<n.length;e++)if(n[e].fn===t)return!0;return!1},ga.prototype._s=function(r){var i=this;return this.hs().then(function(){i.zn.sort(function(t,e){return t.On-e.On});for(var t=0,e=i.zn;t<e.length;t++){var n=e[t];if(n.gn(),"all"!==r&&n.fn===r)break}return i.hs()})},ga.prototype.fs=function(t){this.Yn.push(t)},ga.prototype.us=function(t){t=this.zn.indexOf(t),this.zn.splice(t,1)},ga);function ga(){var e=this;this.jn=Promise.resolve(),this.Wn=[],this.Gn=!1,this.zn=[],this.Kn=null,this.Hn=!1,this.Yn=[],this.Jn=new ha(this,"async_queue_retry"),this.Xn=function(){var t=da();t&&Sr("AsyncQueue","Visibility state changed to  ",t.visibilityState),e.Jn.pn()};var t=da();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Xn)}function ma(t,e,n,r,i){this.xn=t,this.fn=e,this.On=n,this.op=r,this.Mn=i,this.Ln=new aa,this.then=this.Ln.promise.then.bind(this.Ln.promise),this.Ln.promise.catch(function(t){})}function wa(t,e){if(Dr("AsyncQueue",e+": "+t),pa(t))return new Tr(Ir.UNAVAILABLE,e+": "+t);throw t}function ba(){this.ds=void 0,this.listeners=[]}function Ea(){this.ws=new Ni(Du,Su),this.onlineState="Unknown",this.Ts=new Set}function Ia(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.ws.get(n))||(r=!0,i=new ba),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.Es(n)];case 2:return o.ds=t.sent(),[3,4];case 3:return o=wa(o=t.sent(),"Initialization of query '"+Lu(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.ws.set(n,i),i.listeners.push(u),u.Is(e.onlineState),i.ds&&u.As(i.ds)&&Aa(e),[2]}})})}function Ta(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.ws.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.ws.delete(n),e.Rs(n))]:[2]})})}function Aa(t){t.Ts.forEach(function(t){t.next()})}var Na=(Da.prototype.As=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new lo(t.query,t.docs,t.Bt,e,t.Qt,t.fromCache,t.jt,!0)}var o=!1;return this.Ps?this.gs(t)&&(this.ys.next(t),o=!0):this.Vs(t,this.onlineState)&&(this.vs(t),o=!0),this.ps=t,o},Da.prototype.onError=function(t){this.ys.error(t)},Da.prototype.Is=function(t){this.onlineState=t;var e=!1;return this.ps&&!this.Ps&&this.Vs(this.ps,t)&&(this.vs(this.ps),e=!0),e},Da.prototype.Vs=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.bs&&n||t.docs.m()&&"Offline"!==e)},Da.prototype.gs=function(t){if(0<t.docChanges.length)return!0;var e=this.ps&&this.ps.hasPendingWrites!==t.hasPendingWrites;return!(!t.jt&&!e)&&!0===this.options.includeMetadataChanges},Da.prototype.vs=function(t){t=lo.Gt(t.query,t.docs,t.Qt,t.fromCache),this.Ps=!0,this.ys.next(t)},Da),Ra=(Sa.prototype.Ss=function(){return null!=this.uid},Sa.prototype.Cs=function(){return this.Ss()?"uid:"+this.uid:"anonymous-user"},Sa.prototype.isEqual=function(t){return t.uid===this.uid},Sa);function Sa(t){this.uid=t}function Da(t,e,n){this.query=t,this.ys=e,this.Ps=!1,this.ps=null,this.onlineState="Unknown",this.options=n||{}}Ra.UNAUTHENTICATED=new Ra(null),Ra.Ds=new Ra("google-credentials-uid"),Ra.Fs=new Ra("first-party-uid");var La=(Oa.prototype.$s=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Oa.prototype.next=function(){var t=++this.previousValue;return this.ks&&this.ks(t),t},Oa);function Oa(t,e){var n=this;this.previousValue=t,e&&(e.Ns=function(t){return n.$s(t)},this.ks=function(t){return e.xs(t)})}La.Os=-1;var Pa=(Qa.prototype.Ms=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Qa.prototype.Ls=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Qa.prototype.qs=function(){var t={activeTargetIds:this.activeTargetIds.A(),updateTimeMs:Date.now()};return JSON.stringify(t)},Qa),ka=(Ga.prototype.js=function(t){},Ga.prototype.Ws=function(t,e,n){},Ga.prototype.Gs=function(t){return this.Us.Ms(t),this.Bs[t]||"not-current"},Ga.prototype.zs=function(t,e,n){this.Bs[t]=e},Ga.prototype.Ks=function(t){this.Us.Ls(t)},Ga.prototype.Hs=function(t){return this.Us.activeTargetIds.has(t)},Ga.prototype.Ys=function(t){delete this.Bs[t]},Ga.prototype.Js=function(){return this.Us.activeTargetIds},Ga.prototype.Xs=function(t){return this.Us.activeTargetIds.has(t)},Ga.prototype.start=function(){return this.Us=new Pa,Promise.resolve()},Ga.prototype.Zs=function(t,e,n){},Ga.prototype.ti=function(t){},Ga.prototype.ei=function(){},Ga.prototype.xs=function(t){},Ga),_a=(Ba.prototype.si=function(t,e,n){for(var r,i,o,s,u,a,h=n.ii,c=0;c<this.mutations.length;c++){var l=this.mutations[c];l.key.isEqual(t)&&(r=l,i=e,o=h[c],a=u=s=void 0,e=r instanceof Fs?new hu(r.key,o.version,r.value,{hasCommittedMutations:!0}):r instanceof Bs?(u=i,a=o,Vs((s=r).Ge,u)?(u=zs(s,u),new hu(s.key,a.version,u,{hasCommittedMutations:!0})):new lu(s.key,a.version)):r instanceof Hs?function(t,e,n){if(kr(null!=n.transformResults),!Vs(t.Ge,e))return new lu(t.key,n.version);var r=e,e=function(t,e,n){var r=[];kr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof hu&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof vs?ws(o,s):o instanceof Es?Ts(o,s):u))}return r}(t.fieldTransforms,e,n.transformResults),n=n.version,e=Ys(t,r.data(),e);return new hu(t.key,n,e,{hasCommittedMutations:!0})}(r,i,o):new cu(r.key,o.version,{hasCommittedMutations:!0}))}return e},Ba.prototype.ri=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++){var i=r[n];i.key.isEqual(t)&&(e=Cs(i,e,e,this.ni))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=Cs(a,e,o,this.ni))}return e},Ba.prototype.oi=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.ri(t.key,n.get(t.key));e&&(i=i.rt(t.key,e))}),i},Ba.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},uo())},Ba.prototype.isEqual=function(t){return this.batchId===t.batchId&&di(this.mutations,t.mutations,js)&&di(this.baseMutations,t.baseMutations,js)},Ba),Ua=(Fa.from=function(t,e,n){kr(t.mutations.length===n.length);for(var r=oo,i=t.mutations,o=0;o<i.length;o++)r=r.rt(i[o].key,n[o].version);return new Fa(t,e,n,r)},Fa),Va=(qa.prototype._i=function(e,n){var r=this;return this.hi.fi(e,n).next(function(t){return r.di(e,n,t)})},qa.prototype.di=function(t,r,i){return this.ai.wi(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].ri(r,t);return t})},qa.prototype.mi=function(t,e,i){var o=eo;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].ri(t,e);o=o.rt(t,e)}),o},qa.prototype.Ti=function(e,t){var n=this;return this.ai.getEntries(e,t).next(function(t){return n.Ei(e,t)})},qa.prototype.Ei=function(e,r){var i=this;return this.hi.Ii(e,r).next(function(t){var t=i.mi(e,r,t),n=eo;return t.forEach(function(t,e){e=e||new cu(t,Si.min()),n=n.rt(t,e)}),n})},qa.prototype.Ai=function(t,e,n){return r=e,Fr.N(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.Ri(t,e.path):Eu(e)?this.yi(t,e,n):this.Pi(t,e,n);var r},qa.prototype.Ri=function(t,e){return this._i(t,new Fr(e)).next(function(t){var e=io;return t instanceof hu&&(e=e.rt(t.key,t)),e})},qa.prototype.yi=function(n,r,i){var o=this,s=r.collectionGroup,u=io;return this.li.pi(n,s).next(function(t){return ca.forEach(t,function(t){var e=(e=r,t=t.child(s),new fu(t,null,e.rn.slice(),e.filters.slice(),e.limit,e.on,e.startAt,e.endAt));return o.Pi(n,e,i).next(function(t){t.forEach(function(t,e){u=u.rt(t,e)})})}).next(function(){return u})})},qa.prototype.Pi=function(e,n,t){var h,c,r=this;return this.ai.Ai(e,n,t).next(function(t){return h=t,r.hi.gi(e,n)}).next(function(t){return c=t,r.Vi(e,c,h).next(function(t){h=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key,a=Cs(s,a=h.get(u),a,r.ni);h=a instanceof hu?h.rt(u,a):h.remove(u)}})}).next(function(){return h.forEach(function(t,e){Ou(n,e)||(h=h.remove(t))}),h})},qa.prototype.Vi=function(t,e,n){for(var r=uo(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Bs&&null===n.get(a.key)&&(r=r.add(a.key))}var h=n;return this.ai.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof hu&&(h=h.rt(t,e))}),h})},qa),Ca=(xa.Si=function(t,e){for(var n=uo(),r=uo(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new xa(t,e.fromCache,n,r)},xa),ja=(Ma.Ni=function(t){return new Ma(t,Ma.$i,Ma.ki)},Ma);function Ma(t,e,n){this.Ci=t,this.Di=e,this.Fi=n}function xa(t,e,n,r){this.targetId=t,this.fromCache=e,this.vi=n,this.bi=r}function qa(t,e,n){this.ai=t,this.hi=e,this.li=n}function Fa(t,e,n,r){this.batch=t,this.ui=e,this.ii=n,this.ci=r}function Ba(t,e,n,r){this.batchId=t,this.ni=e,this.baseMutations=n,this.mutations=r}function Ga(){this.Us=new Pa,this.Bs={},this.Qs=null,this.Ns=null}function Qa(){this.activeTargetIds=ao}ja.xi=-1,ja.Oi=1048576,ja.Mi=41943040,ja.$i=10,ja.ki=1e3,ja.Li=new ja(ja.Mi,ja.$i,ja.ki),ja.qi=new ja(ja.xi,0,0);var za=(Za.prototype.Bi=function(t,e){return this.Ui.add(e),ca.resolve()},Za.prototype.pi=function(t,e){return ca.resolve(this.Ui.getEntries(e))},Za),Wa=(Ja.prototype.add=function(t){var e=t._(),n=t.h(),r=this.index[e]||new $i(Mr.i),t=!r.has(n);return this.index[e]=r.add(n),t},Ja.prototype.has=function(t){var e=t._(),t=t.h();return(e=this.index[e])&&e.has(t)},Ja.prototype.getEntries=function(t){return(this.index[t]||new $i(Mr.i)).A()},Ja),Ha=(Ka.prototype.next=function(){return this.Qi+=2,this.Qi},Ka.ji=function(){return new Ka(0)},Ka.Wi=function(){return new Ka(-1)},Ka),Xa=(Ya.prototype.ir=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.rr(t,n.zi)})},Ya);function Ya(t,e,n){this.persistence=t,this.Gi=e,this.zi=new Wi(pi),this.Ki=new Ni(ji,Mi),this.Hi=Si.min(),this.hi=t.Yi(n),this.Ji=t.Xi(),this.Zi=t.tr(),this.er=new Va(this.Ji,this.hi,this.persistence.nr()),this.Gi.sr(this.er)}function Ka(t){this.Qi=t}function Ja(){this.index={}}function Za(){this.Ui=new Wa}function $a(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Zi._r(t)})}function th(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).zi.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Ar.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!pa(r=t.sent()))throw r;return Sr("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.zi=e.zi.remove(o),e.Ki.delete(n.target),[2]}})})}function eh(t,o,s){var u=t,a=Si.min(),h=uo();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=Tu(o),(void 0!==(t=(i=t).Ki.get(r))?ca.resolve(i.zi.get(t)):i.Zi.Pr(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u.Zi.pr(e,t.targetId).next(function(t){h=t})}).next(function(){return u.Gi.Ai(e,o,s?a:Si.min(),s?h:uo())}).next(function(t){return{documents:t,gr:h}});var t,n,r,i})}function nh(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Ir.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Sr("LocalStore","Unexpectedly lost primary lease"),[2]})})}function rh(t,e){this.user=e,this.type="OAuth",this.Ur={},this.Ur.Authorization="Bearer "+t}function ih(t,e,n,r,i){var o=this;this.Bo=t,this.Qo=e,this.xn=n,this.jo={},this.Wo=[],this.Go=new Map,this.zo=new Set,this.Ko=[],this.Ho=i,this.Ho.Yo(function(t){n.Qn(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Mh(this)?(Sr("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).zo.add(4),[4,Oh(e)];case 1:return t.sent(),e.Jo.set("Unknown"),e.zo.delete(4),[4,Lh(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Jo=new gh(n,r)}var oh,sh,uh,ah=(Dh.prototype.m=function(){return this.Vr.m()},Dh.prototype.Cr=function(t,e){e=new hh(t,e),this.Vr=this.Vr.add(e),this.br=this.br.add(e)},Dh.prototype.Dr=function(t,e){var n=this;t.forEach(function(t){return n.Cr(t,e)})},Dh.prototype.Fr=function(t,e){this.Nr(new hh(t,e))},Dh.prototype.$r=function(t,e){var n=this;t.forEach(function(t){return n.Fr(t,e)})},Dh.prototype.kr=function(t){var e=this,n=new Fr(new Mr([])),r=new hh(n,t),t=new hh(n,t+1),i=[];return this.br.Ft([r,t],function(t){e.Nr(t),i.push(t.key)}),i},Dh.prototype.Or=function(){var e=this;this.Vr.forEach(function(t){return e.Nr(t)})},Dh.prototype.Nr=function(t){this.Vr=this.Vr.delete(t),this.br=this.br.delete(t)},Dh.prototype.Mr=function(t){var e=new Fr(new Mr([])),n=new hh(e,t),t=new hh(e,t+1),r=uo();return this.br.Ft([n,t],function(t){r=r.add(t.key)}),r},Dh.prototype.Lr=function(t){var e=new hh(t,0);return null!==(e=this.Vr.$t(e))&&t.isEqual(e.key)},Dh),hh=(Sh.vr=function(t,e){return Fr.i(t.key,e.key)||pi(t.qr,e.qr)},Sh.Sr=function(t,e){return pi(t.qr,e.qr)||Fr.i(t.key,e.key)},Sh),ch=(Rh.prototype.getToken=function(){return Promise.resolve(null)},Rh.prototype.Qr=function(){},Rh.prototype.jr=function(t){(this.Br=t)(Ra.UNAUTHENTICATED)},Rh.prototype.Wr=function(){this.Br=null},Rh),lh=(Nh.prototype.getToken=function(){var e=this,n=this.Kr,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.Kr!==n?(Sr("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(kr("string"==typeof t.accessToken),new rh(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Nh.prototype.Qr=function(){this.forceRefresh=!0},Nh.prototype.jr=function(t){this.Br=t,this.zr&&t(this.currentUser)},Nh.prototype.Wr=function(){this.auth&&this.auth.removeAuthTokenListener(this.Gr),this.Gr=null,this.Br=null},Nh.prototype.Hr=function(){var t=this.auth&&this.auth.getUid();return kr(null===t||"string"==typeof t),new Ra(t)},Nh),fh=(Object.defineProperty(Ah.prototype,"Ur",{get:function(){var t={"X-Goog-AuthUser":this.Jr},e=this.Yr.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Ah),ph=(Th.prototype.getToken=function(){return Promise.resolve(new fh(this.Yr,this.Jr))},Th.prototype.jr=function(t){t(Ra.Fs)},Th.prototype.Wr=function(){},Th.prototype.Qr=function(){},Th),l=(Ih.prototype.io=function(){return 1===this.state||2===this.state||4===this.state},Ih.prototype.ro=function(){return 2===this.state},Ih.prototype.start=function(){3!==this.state?this.auth():this.oo()},Ih.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.io()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Ih.prototype.uo=function(){this.state=0,this.Jn.reset()},Ih.prototype.co=function(){var t=this;this.ro()&&null===this.so&&(this.so=this._n.Pn(this.Xr,6e4,function(){return t.ao()}))},Ih.prototype.ho=function(t){this.lo(),this.stream.send(t)},Ih.prototype.ao=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.ro()?[2,this.close(0)]:[2]})})},Ih.prototype.lo=function(){this.so&&(this.so.cancel(),this.so=null)},Ih.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.lo(),this.Jn.cancel(),this.no++,3!==e?this.Jn.reset():n&&n.code===Ir.RESOURCE_EXHAUSTED?(Dr(n.toString()),Dr("Using maximum backoff delay to prevent overloading the backend."),this.Jn.An()):n&&n.code===Ir.UNAUTHENTICATED&&this.eo.Qr(),null!==this.stream&&(this._o(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.fo(n)];case 1:return t.sent(),[2]}})})},Ih.prototype._o=function(){},Ih.prototype.auth=function(){var n=this;this.state=1;var t=this.do(this.no),e=this.no;this.eo.getToken().then(function(t){n.no===e&&n.wo(t)},function(e){t(function(){var t=new Tr(Ir.UNKNOWN,"Fetching auth token failed: "+e.message);return n.mo(t)})})},Ih.prototype.wo=function(t){var e=this,n=this.do(this.no);this.stream=this.To(t),this.stream.Eo(function(){n(function(){return e.state=2,e.listener.Eo()})}),this.stream.fo(function(t){n(function(){return e.mo(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Ih.prototype.oo=function(){var t=this;this.state=4,this.Jn.Rn(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},Ih.prototype.mo=function(t){return Sr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Ih.prototype.do=function(e){var n=this;return function(t){n._n.Qn(function(){return n.no===e?t():(Sr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Ih),dh=(n(Eh,uh=l),Eh.prototype.To=function(t){return this.Zr.Io("Listen",t)},Eh.prototype.onMessage=function(t){this.Jn.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(i=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===i?1:"REMOVE"===i?2:"CURRENT"===i?3:"RESET"===i?4:Pr(),r=e.targetChange.targetIds||[],i=(o=e.targetChange.resumeToken,t.Be?(kr(void 0===o||"string"==typeof o),yi.fromBase64String(o||"")):(kr(void 0===o||o instanceof Uint8Array),yi.fromUint8Array(o||new Uint8Array))),o=e.targetChange.cause,s=o&&(o=void 0===(s=o).code?Ir.UNKNOWN:zi(s.code),new Tr(o,s.message||"")),r=new go(n,r,i,s||null)}else if("documentChange"in e){e.documentChange,(a=e.documentChange).document,a.document.name,a.document.updateTime;var i=is(t,a.document.name),u=es(a.document.updateTime),s=new tu({mapValue:{fields:a.document.fields}}),u=new hu(i,u,s,{}),s=a.targetIds||[],a=a.removedTargetIds||[];r=new yo(s,a,u.key,u)}else if("documentDelete"in e){e.documentDelete,(a=e.documentDelete).document;var u=is(t,a.document),h=a.readTime?es(a.readTime):Si.min(),h=new cu(u,h),a=a.removedTargetIds||[];r=new yo([],a,h.key,h)}else if("documentRemove"in e){e.documentRemove,(h=e.documentRemove).document;var c=is(t,h.document),h=h.removedTargetIds||[];r=new yo([],h,c,null)}else{if(!("filter"in e))return Pr();e.filter,(c=e.filter).targetId,e=new qi(e=c.count||0),c=c.targetId,r=new vo(c,e)}return r}(this.serializer,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?Si.min():es(e.readTime);return this.listener.Ao(n,t)},Eh.prototype.Ro=function(t){var e,n,r,i,o,s,u,a,h={};h.database=ss(this.serializer),h.addTarget=(e=this.serializer,(r=xi(r=(n=t).target)?{documents:{documents:[os(e,r.path)]}}:{query:(i=e,s={structuredQuery:{}},u=(o=r).path,null!==o.collectionGroup?(s.parent=os(i,u),s.structuredQuery.from=[{collectionId:o.collectionGroup,allDescendants:!0}]):(s.parent=os(i,u.h()),s.structuredQuery.from=[{collectionId:u._()}]),(u=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(zo(t.value))return{unaryFilter:{field:cs(t.field),op:"IS_NAN"}};if(Qo(t.value))return{unaryFilter:{field:cs(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(zo(t.value))return{unaryFilter:{field:cs(t.field),op:"IS_NOT_NAN"}};if(Qo(t.value))return{unaryFilter:{field:cs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:cs(t.field),op:(e=t.op,Xo[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(o.filters))&&(s.structuredQuery.where=u),(u=function(t){if(0!==t.length)return t.map(function(t){return{field:cs((t=t).field),direction:(t=t.dir,Ho[t])}})}(o.orderBy))&&(s.structuredQuery.orderBy=u),u=o.limit,null!==(u=i.Be||_i(u)?u:{value:u})&&(s.structuredQuery.limit=u),o.startAt&&(s.structuredQuery.startAt=hs(o.startAt)),o.endAt&&(s.structuredQuery.endAt=hs(o.endAt)),s)}).targetId=n.targetId,0<n.resumeToken.M()&&(r.resumeToken=ts(e,n.resumeToken)),r),(t=(this.serializer,a=t,null==(t=function(){switch(a.tt){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Pr()}}())?null:{"goog-listen-tags":t}))&&(h.labels=t),this.ho(h)},Eh.prototype.yo=function(t){var e={};e.database=ss(this.serializer),e.removeTarget=t,this.ho(e)},Eh),yh=(n(bh,sh=l),Object.defineProperty(bh.prototype,"po",{get:function(){return this.Po},enumerable:!1,configurable:!0}),bh.prototype.start=function(){this.Po=!1,this.lastStreamToken=void 0,sh.prototype.start.call(this)},bh.prototype._o=function(){this.Po&&this.Vo([])},bh.prototype.To=function(t){return this.Zr.Io("Write",t)},bh.prototype.onMessage=function(t){if(kr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.Po){this.Jn.reset();var e=(n=t.writeResults,i=t.commitTime,n&&0<n.length?(kr(void 0!==i),n.map(function(t){return n=i,(r=(e=t).updateTime?es(e.updateTime):es(n)).isEqual(Si.min())&&(r=es(n)),n=null,e.transformResults&&0<e.transformResults.length&&(n=e.transformResults),new ks(r,n);var e,n,r})):[]),n=es(t.commitTime);return this.listener.vo(n,e)}var i;return kr(!t.writeResults||0===t.writeResults.length),this.Po=!0,this.listener.bo()},bh.prototype.So=function(){var t={};t.database=ss(this.serializer),this.ho(t)},bh.prototype.Vo=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return as(e.serializer,t)})};this.ho(t)},bh),vh=(n(wh,oh=function(){}),wh.prototype.Do=function(){if(this.Co)throw new Tr(Ir.FAILED_PRECONDITION,"The client has already been terminated.")},wh.prototype.Fo=function(e,n,r){var i=this;return this.Do(),this.credentials.getToken().then(function(t){return i.Zr.Fo(e,n,r,t)}).catch(function(t){throw t.code===Ir.UNAUTHENTICATED&&i.credentials.Qr(),t})},wh.prototype.No=function(e,n,r){var i=this;return this.Do(),this.credentials.getToken().then(function(t){return i.Zr.No(e,n,r,t)}).catch(function(t){throw t.code===Ir.UNAUTHENTICATED&&i.credentials.Qr(),t})},wh.prototype.terminate=function(){this.Co=!1},wh),gh=(mh.prototype.Oo=function(){var t=this;0===this.$o&&(this.Mo("Unknown"),this.ko=this.xn.Pn("online_state_timeout",1e4,function(){return t.ko=null,t.Lo("Backend didn't respond within 10 seconds."),t.Mo("Offline"),Promise.resolve()}))},mh.prototype.qo=function(t){"Online"===this.state?this.Mo("Unknown"):(this.$o++,1<=this.$o&&(this.Uo(),this.Lo("Connection failed 1 times. Most recent error: "+t.toString()),this.Mo("Offline")))},mh.prototype.set=function(t){this.Uo(),this.$o=0,"Online"===t&&(this.xo=!1),this.Mo(t)},mh.prototype.Mo=function(t){t!==this.state&&(this.state=t,this.Qs(t))},mh.prototype.Lo=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.xo?(Dr(t),this.xo=!1):Sr("OnlineStateTracker",t)},mh.prototype.Uo=function(){null!==this.ko&&(this.ko.cancel(),this.ko=null)},mh);function mh(t,e){this.xn=t,this.Qs=e,this.state="Unknown",this.$o=0,this.ko=null,this.xo=!0}function wh(t,e,n){var r=this;return(r=oh.call(this)||this).credentials=t,r.Zr=e,r.serializer=n,r.Co=!1,r}function bh(t,e,n,r,i){var o=this;return(o=sh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).serializer=r,o.Po=!1,o}function Eh(t,e,n,r,i){var o=this;return(o=uh.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).serializer=r,o}function Ih(t,e,n,r,i,o){this._n=t,this.Xr=n,this.Zr=r,this.eo=i,this.listener=o,this.state=0,this.no=0,this.so=null,this.stream=null,this.Jn=new ha(t,e)}function Th(t,e){this.Yr=t,this.Jr=e}function Ah(t,e){this.Yr=t,this.Jr=e,this.type="FirstParty",this.user=Ra.Fs}function Nh(t){var e=this;this.Gr=null,this.currentUser=Ra.UNAUTHENTICATED,this.zr=!1,this.Kr=0,this.Br=null,this.forceRefresh=!1,this.Gr=function(){e.Kr++,e.currentUser=e.Hr(),e.zr=!0,e.Br&&e.Br(e.currentUser)},this.Kr=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.Gr):(this.Gr(null),t.get().then(function(t){e.auth=t,e.Gr&&e.auth.addAuthTokenListener(e.Gr)},function(){}))}function Rh(){this.Br=null}function Sh(t,e){this.key=t,this.qr=e}function Dh(){this.Vr=new $i(hh.vr),this.br=new $i(hh.Sr)}function Lh(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!Mh(r))return[3,4];e=0,n=r.Ko,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Oh(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.Ko,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Ph(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Sr("RemoteStore","RemoteStore shutting down."),e.zo.add(5),[4,Oh(e)];case 1:return t.sent(),e.Ho.ei(),e.Jo.set("Unknown"),[2]}})})}function kh(t,e){t.Go.has(e.targetId)||(t.Go.set(e.targetId,e),jh(t)?Ch(t):zh(t).ro()&&Uh(t,e))}function _h(t,e){var n=t,t=zh(n);n.Go.delete(e),t.ro()&&Vh(n,e),0===n.Go.size&&(t.ro()?t.co():Mh(n)&&n.Jo.set("Unknown"))}function Uh(t,e){t.Xo.Ee(e.targetId),zh(t).Ro(e)}function Vh(t,e){t.Xo.Ee(e),zh(t).yo(e)}function Ch(e){e.Xo=new wo({qe:function(t){return e.jo.qe(t)},Ue:function(t){return e.Go.get(t)||null}}),zh(e).start(),e.Jo.Oo()}function jh(t){return Mh(t)&&!zh(t).io()&&0<t.Go.size}function Mh(t){return 0===t.zo.size}function xh(t){t.Xo=void 0}function qh(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!pa(r))throw r;return n.zo.add(1),[4,Oh(n)];case 1:return t.sent(),n.Jo.set("Offline"),i=i||function(){return $a(n.Bo)},n.xn.rs(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Sr("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.zo.delete(1),[4,Lh(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function Fh(e,n){return n().catch(function(t){return qh(e,t,n)})}function Bh(c){return y(this,void 0,void 0,function(){var s,u,a,h;return v(this,function(t){switch(t.label){case 0:u=Wh(s=c),a=0<s.Wo.length?s.Wo[s.Wo.length-1].batchId:-1,t.label=1;case 1:if(!(Mh(s)&&s.Wo.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(r=s.Bo,i=a,(o=r).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===i&&(i=-1),o.hi.yr(t,i)}))];case 3:return null===(h=t.sent())?(0===s.Wo.length&&u.co(),[3,7]):(a=h.batchId,n=h,(e=s).Wo.push(n),(e=Wh(e)).ro()&&e.po&&e.Vo(n.mutations),[3,6]);case 4:return h=t.sent(),[4,qh(s,h)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return Gh(s)&&Qh(s),[2]}var e,n,r,i,o})})}function Gh(t){return Mh(t)&&!Wh(t).io()&&0<t.Wo.length}function Qh(t){Wh(t).start()}function zh(n){var t,e,r,i=this;return n.su||(n.su=(t=n.Qo,e=n.xn,r={Eo:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.Go.forEach(function(t,e){Uh(n,t)}),[2]})})}.bind(null,n),fo:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return xh(e),jh(e)?(e.Jo.qo(n),Ch(e)):e.Jo.set("Unknown"),[2]})})}.bind(null,n),Ao:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Jo.set("Online"),!(u instanceof go&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.Go.has(i)?[4,o.jo.Zo(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.Go.delete(i),o.Xo.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Sr("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,qh(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof yo?s.Xo.Ve(u):u instanceof vo?s.Xo.$e(u):s.Xo.Se(u),a.isEqual(Si.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,$a(s.Bo)];case 8:return o=t.sent(),0<=a.L(o)?[4,(i=a,(e=(r=s).Xo.Oe(i)).zt.forEach(function(t,e){var n;0<t.resumeToken.M()&&(n=r.Go.get(e))&&r.Go.set(e,n.st(t.resumeToken,i))}),e.Kt.forEach(function(t){var e=r.Go.get(t);e&&(r.Go.set(t,e.st(yi.q,e.et)),Vh(r,t),e=new Bi(e.target,t,1,e.sequenceNumber),Uh(r,e))}),r.jo.tu(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Sr("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,qh(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},t.Do(),new dh(e,t.Zr,t.credentials,t.serializer,r)),n.Ko.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.su.uo(),jh(n)?Ch(n):n.Jo.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.su.stop()];case 2:t.sent(),xh(n),t.label=3;case 3:return[2]}})})})),n.su}function Wh(n){var t,e,r,i=this;return n.iu||(n.iu=(t=n.Qo,e=n.xn,r={Eo:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return Wh(e).So(),[2]})})}.bind(null,n),fo:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&Wh(e).po?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Qi(n=i.code)&&n!==Ir.ABORTED?(e=r.Wo.shift(),Wh(r).uo(),[4,Fh(r,function(){return r.jo.nu(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,Bh(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return Gh(e)&&Qh(e),[2]}})})}.bind(null,n),bo:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=Wh(o),n=0,r=o.Wo;n<r.length;n++)i=r[n],e.Vo(i.mutations);return[2]})})}.bind(null,n),vo:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Wo.shift(),n=Ua.from(e,i,o),[4,Fh(r,function(){return r.jo.eu(n)})];case 1:return t.sent(),[4,Bh(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Do(),new yh(e,t.Zr,t.credentials,t.serializer,r)),n.Ko.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.iu.uo(),[4,Bh(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.iu.stop()];case 3:t.sent(),0<n.Wo.length&&(Sr("RemoteStore","Stopping write stream with "+n.Wo.length+" pending writes"),n.Wo=[]),t.label=4;case 4:return[2]}})})})),n.iu}function Hh(t,e,n){this.query=t,this.targetId=e,this.view=n}var Xh=function(t){this.key=t},Yh=function(t){this.key=t},Kh=(Object.defineProperty(tc.prototype,"hu",{get:function(){return this.ru},enumerable:!1,configurable:!0}),tc.prototype.lu=function(t,e){var s=this,u=e?e._u:new co,a=(e||this).au,h=(e||this).Qt,c=a,l=!1,f=gu(this.query)&&a.size===this.query.limit?a.last():null,p=mu(this.query)&&a.size===this.query.limit?a.first():null;if(t.at(function(t,e){var n=a.get(t),r=(r=e instanceof hu?e:null)&&(Ou(s.query,r)?r:null),i=!!n&&s.Qt.has(n.key),o=!!r&&(r.Ye||s.Qt.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.fu(n,r)||(u.track({type:2,doc:r}),e=!0,(f&&0<s.cu(r,f)||p&&s.cu(r,p)<0)&&(l=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(f||p)&&(l=!0)),e&&(h=r?(c=c.add(r),o?h.add(t):h.delete(t)):(c=c.delete(t),h.delete(t)))}),gu(this.query)||mu(this.query))for(;c.size>this.query.limit;){var n=gu(this.query)?c.last():c.first(),c=c.delete(n.key),h=h.delete(n.key);u.track({type:1,doc:n})}return{au:c,_u:u,du:l,Qt:h}},tc.prototype.fu=function(t,e){return t.Ye&&e.hasCommittedMutations&&!e.Ye},tc.prototype.wu=function(t,e,n){var o=this,r=this.au;this.au=t.au,this.Qt=t.Qt;var i=t._u.Ut();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.cu(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Pr()}}var r,i}),this.mu(n);var s=e?this.Tu():[],e=(n=0===this.uu.size&&this.Zt?1:0)!==this.ou;return this.ou=n,0!==i.length||e?{snapshot:new lo(this.query,t.au,r,i,t.Qt,0==n,e,!1),Eu:s}:{Eu:s}},tc.prototype.Is=function(t){return this.Zt&&"Offline"===t?(this.Zt=!1,this.wu({au:this.au,_u:new co,Qt:this.Qt,du:!1},!1)):{Eu:[]}},tc.prototype.Iu=function(t){return!this.ru.has(t)&&!!this.au.has(t)&&!this.au.get(t).Ye},tc.prototype.mu=function(t){var e=this;t&&(t.te.forEach(function(t){return e.ru=e.ru.add(t)}),t.ee.forEach(function(t){}),t.ne.forEach(function(t){return e.ru=e.ru.delete(t)}),this.Zt=t.Zt)},tc.prototype.Tu=function(){var e=this;if(!this.Zt)return[];var n=this.uu;this.uu=uo(),this.au.forEach(function(t){e.Iu(t.key)&&(e.uu=e.uu.add(t.key))});var r=[];return n.forEach(function(t){e.uu.has(t)||r.push(new Yh(t))}),this.uu.forEach(function(t){n.has(t)||r.push(new Xh(t))}),r},tc.prototype.Au=function(t){return this.ru=t.gr,this.uu=uo(),t=this.lu(t.documents),this.wu(t,!0)},tc.prototype.Ru=function(){return lo.Gt(this.query,this.au,this.Qt,0===this.ou)},tc),Jh=function(t){this.key=t,this.yu=!1},Zh=(Object.defineProperty($h.prototype,"Mu",{get:function(){return!0===this.Ou},enumerable:!1,configurable:!0}),$h);function $h(t,e,n,r,i,o){this.Bo=t,this.Pu=e,this.pu=n,this.gu=r,this.currentUser=i,this.Vu=o,this.vu={},this.bu=new Ni(Du,Su),this.Su=new Map,this.Cu=[],this.Du=new Wi(Fr.i),this.Fu=new Map,this.Nu=new ah,this.$u={},this.ku=new Map,this.xu=Ha.Wi(),this.onlineState="Unknown",this.Ou=void 0}function tc(t,e){this.query=t,this.ru=e,this.ou=null,this.Zt=!1,this.uu=uo(),this.Qt=uo(),this.cu=Pu(t),this.au=new ho(this.cu)}function ec(f,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:(o=f).Pu.jo.eu=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Bo,c=s,(l=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=c.batch.keys(),n=l.Ji.ur({cr:!0}),i=l,o=t,s=n,u=(r=c).batch,a=u.keys(),h=ca.resolve();return a.forEach(function(n){h=h.next(function(){return s.wi(o,n)}).next(function(t){var e=t;kr(null!==(t=r.ci.get(n))),(!e||e.version.L(t)<0)&&(e=u.si(n,e,r))&&s.ar(e,r.ui)})}),h.next(function(){return i.hi.hr(o,u)}).next(function(){return n.apply(t)}).next(function(){return l.hi.lr(t)}).next(function(){return l.er.Ti(t,e)})}))];case 2:return i=t.sent(),oc(n,r,null),ic(n,r),n.gu.Ws(r,"acknowledged"),[4,cc(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,nh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,c,l})})}.bind(null,o),o.Pu.jo.nu=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Bo,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.hi.Wu(e,r).next(function(t){return kr(null!==t),n=t.keys(),i.hi.hr(e,t)}).next(function(){return i.hi.lr(e)}).next(function(){return i.er.Ti(e,n)})}))];case 2:return o=t.sent(),oc(n,u,a),ic(n,u),n.gu.Ws(u,"rejected",a),[4,cc(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,nh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,o),u=o,t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(r=u.Bo,a=p,c=r,l=Ri.now(),i=a.reduce(function(t,e){return t.add(e.key)},uo()),c.persistence.runTransaction("Locally write mutations","readwrite",function(u){return c.er.Ti(u,i).next(function(t){h=t;for(var s,e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=(s=i,o=h.get(i.key),s instanceof Hs?function(t){for(var e=null,n=0,r=s.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof hu?t.field(i.field):void 0;null!=(o=fs(i.transform,o||null))&&(e=(null==e?new eu:e).set(i.field,o))}return e?e.Je():null}(o):null);null!=o&&e.push(new Bs(i.key,o,function s(t){var u=[];return Ur(t.fields||{},function(t,e){var n=new qr([t]);if(Wo(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new Os(u)}(o.proto.mapValue),_s.exists(!0)))}return c.hi.Qu(u,l,e,a)})}).then(function(t){var e=t.oi(h);return{batchId:t.batchId,ju:e}}))];case 2:return s=t.sent(),u.gu.js(s.batchId),e=u,n=s.batchId,o=d,r=(r=(r=e.$u[e.currentUser.Cs()])||new Wi(pi)).rt(n,o),e.$u[e.currentUser.Cs()]=r,[4,cc(u,s.ju)];case 3:return t.sent(),[4,Bh(u.Pu)];case 4:return t.sent(),[3,6];case 5:return u=wa(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,a,h,c,l,i,o})})}function nc(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:n=i,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.Bo,h=e,c=(a=o).et,l=h.zi,h.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var i=h.Ji.ur({cr:!0});l=h.zi;var u=[];a.zt.forEach(function(t,e){var n,r,i,o=l.get(e);o&&(u.push(h.Zi.dr(s,t.ne,e).next(function(){return h.Zi.wr(s,t.te,e)})),0<(i=t.resumeToken).M()&&(n=o.st(i,c).nt(s.mr),l=l.rt(e,n),r=o,i=t,kr(0<(o=n).resumeToken.M()),(0===r.resumeToken.M()||3e8<=o.et.J()-r.et.J()||0<i.te.size+i.ee.size+i.ne.size)&&u.push(h.Zi.Tr(s,n))))});var t,o=eo,n=uo();return a.Ht.forEach(function(t,e){n=n.add(t)}),u.push(i.getEntries(s,n).next(function(r){a.Ht.forEach(function(t,e){var n=r.get(t);e instanceof cu&&e.version.isEqual(Si.min())?(i.Er(t,c),o=o.rt(t,e)):null==n||0<e.version.L(n.version)||0===e.version.L(n.version)&&n.hasPendingWrites?(i.ar(e,c),o=o.rt(t,e)):Sr("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.Yt.has(t)&&u.push(h.persistence.Ar.Ir(s,t))})})),c.isEqual(Si.min())||(t=h.Zi._r(s).next(function(t){return h.Zi.Rr(s,s.mr,c)}),u.push(t)),ca.$n(u).next(function(){return i.apply(s)}).next(function(){return h.er.Ei(s,o)})}).then(function(t){return h.zi=l,t}))];case 2:return r=t.sent(),o.zt.forEach(function(t,e){(e=n.Fu.get(e))&&(kr(t.te.size+t.ee.size+t.ne.size<=1),0<t.te.size?e.yu=!0:0<t.ee.size?kr(e.yu):0<t.ne.size&&(kr(e.yu),e.yu=!1))}),[4,cc(n,r,o)];case 3:return t.sent(),[3,6];case 4:return[4,nh(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,a,h,c,l})})}function rc(t,n,e){var r;((t=t).Mu&&0===e||!t.Mu&&1===e)&&(r=[],t.bu.forEach(function(t,e){(e=e.view.Is(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.ws.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Is(i)&&(o=!0)}),o&&Aa(t)}(t.pu,n),r.length&&t.vu.Ao(r),t.onlineState=n,t.Mu&&t.gu.ti(n))}function ic(t,e){(t.ku.get(e)||[]).forEach(function(t){t.resolve()}),t.ku.delete(e)}function oc(t,e,n){var r=t,i=r.$u[r.currentUser.Cs()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.$u[r.currentUser.Cs()]=i)}function sc(e,t,n){void 0===n&&(n=null),e.gu.Ks(t);for(var r=0,i=e.Su.get(t);r<i.length;r++){var o=i[r];e.bu.delete(o),n&&e.vu.Lu(o,n)}e.Su.delete(t),e.Mu&&e.Nu.kr(t).forEach(function(t){e.Nu.Lr(t)||uc(e,t)})}function uc(t,e){var n=t.Du.get(e);null!==n&&(_h(t.Pu,n),t.Du=t.Du.remove(e),t.Fu.delete(n),hc(t))}function ac(t,e,n){for(var r,i,o=0,s=n;o<s.length;o++){var u=s[o];u instanceof Xh?(t.Nu.Cr(u.key,e),r=t,i=(i=u).key,r.Du.get(i)||(Sr("SyncEngine","New document in limbo: "+i),r.Cu.push(i),hc(r))):u instanceof Yh?(Sr("SyncEngine","Document no longer in limbo: "+u.key),t.Nu.Fr(u.key,e),t.Nu.Lr(u.key)||uc(t,u.key)):Pr()}}function hc(t){for(;0<t.Cu.length&&t.Du.size<t.Vu;){var e=t.Cu.shift(),n=t.xu.next();t.Fu.set(n,new Jh(e)),t.Du=t.Du.rt(e,n),kh(t.Pu,new Bi(Tu(vu(e.path)),n,2,La.Os))}}function cc(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).bu.m()?[3,3]:(n.bu.forEach(function(t,e){o.push(n.Bu(e,s,u).then(function(t){t&&(n.Mu&&n.gu.zs(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=Ca.Si(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.vu.Ao(r),[4,function(a,h){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ca.forEach(h,function(e){return ca.forEach(e.vi,function(t){return r.persistence.Ar.Cr(n,e.targetId,t)}).next(function(){return ca.forEach(e.bi,function(t){return r.persistence.Ar.Fr(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!pa(e=t.sent()))throw e;return Sr("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=h;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.zi.get(o),u=s.et,u=s.it(u),r.zi=r.zi.rt(o,u));return[2]}})})}(n.Bo,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}var lc,fc,pc,dc=(Fc.prototype.sr=function(t){this.Ju=t},Fc.prototype.Ai=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.rn.length||1===r.rn.length&&r.rn[0].field.V())||i.isEqual(Si.min())?this.Xu(e,r):this.Ju.Ti(e,o).next(function(t){var n=s.Zu(r,t);return(gu(r)||mu(r))&&s.du(r.on,n,o,i)?s.Xu(e,r):(Rr()<=u.DEBUG&&Sr("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Lu(r)),s.Ju.Ai(e,r,i).next(function(e){return n.forEach(function(t){e=e.rt(t.key,t)}),e}))})},Fc.prototype.Zu=function(n,t){var r=new $i(Pu(n));return t.forEach(function(t,e){e instanceof hu&&Ou(n,e)&&(r=r.add(e))}),r},Fc.prototype.du=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version.L(r))},Fc.prototype.Xu=function(t,e){return Rr()<=u.DEBUG&&Sr("IndexFreeQueryEngine","Using full collection scan to execute query:",Lu(e)),this.Ju.Ai(t,e,Si.min())},Fc),yc=(qc.prototype.nc=function(t){return ca.resolve(0===this.hi.length)},qc.prototype.Qu=function(t,e,n,r){var i=this.tc;this.tc++,0<this.hi.length&&this.hi[this.hi.length-1],n=new _a(i,e,n,r),this.hi.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.ec=this.ec.add(new hh(u.key,i)),this.li.Bi(t,u.key.path.h())}return ca.resolve(n)},qc.prototype.Wu=function(t,e){return ca.resolve(this.sc(e))},qc.prototype.yr=function(t,e){return e+=1,e=(e=this.ic(e))<0?0:e,ca.resolve(this.hi.length>e?this.hi[e]:null)},qc.prototype.Gu=function(){return ca.resolve(0===this.hi.length?-1:this.tc-1)},qc.prototype.zu=function(t){return ca.resolve(this.hi.slice())},qc.prototype.fi=function(t,e){var n=this,r=new hh(e,0),e=new hh(e,Number.POSITIVE_INFINITY),i=[];return this.ec.Ft([r,e],function(t){t=n.sc(t.qr),i.push(t)}),ca.resolve(i)},qc.prototype.Ii=function(t,e){var n=this,r=new $i(pi);return e.forEach(function(t){var e=new hh(t,0),t=new hh(t,Number.POSITIVE_INFINITY);n.ec.Ft([e,t],function(t){r=r.add(t.qr)})}),ca.resolve(this.rc(r))},qc.prototype.gi=function(t,e){var n=e.path,r=n.length+1,e=n;Fr.N(e)||(e=e.child(""));var e=new hh(new Fr(e),0),i=new $i(pi);return this.ec.Nt(function(t){var e=t.key.path;return!!n.T(e)&&(e.length===r&&(i=i.add(t.qr)),!0)},e),ca.resolve(this.rc(i))},qc.prototype.rc=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.sc(t))&&n.push(t)}),n},qc.prototype.hr=function(n,r){var i=this;kr(0===this.oc(r.batchId,"removed")),this.hi.shift();var o=this.ec;return ca.forEach(r.mutations,function(t){var e=new hh(t.key,r.batchId);return o=o.delete(e),i.Ar.uc(n,t.key)}).next(function(){i.ec=o})},qc.prototype.cc=function(t){},qc.prototype.Lr=function(t,e){var n=new hh(e,0),n=this.ec.$t(n);return ca.resolve(e.isEqual(n&&n.key))},qc.prototype.lr=function(t){return this.hi.length,ca.resolve()},qc.prototype.oc=function(t,e){return this.ic(t)},qc.prototype.ic=function(t){return 0===this.hi.length?0:t-this.hi[0].batchId},qc.prototype.sc=function(t){return(t=this.ic(t))<0||t>=this.hi.length?null:this.hi[t]},qc),vc=(xc.prototype.ar=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.ac(e);return this.docs=this.docs.rt(r,{hc:e,size:o,readTime:n}),this.size+=o-i,this.li.Bi(t,r.path.h())},xc.prototype.Er=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},xc.prototype.wi=function(t,e){return e=this.docs.get(e),ca.resolve(e?e.hc:null)},xc.prototype.getEntries=function(t,e){var n=this,r=eo;return e.forEach(function(t){var e=n.docs.get(t);r=r.rt(t,e?e.hc:null)}),ca.resolve(r)},xc.prototype.Ai=function(t,e,n){for(var r=io,i=new Fr(e.path.child("")),o=this.docs._t(i);o.It();){var s=(u=o.Et()).key,u=(a=u.value).hc,a=a.readTime;if(!e.path.T(s.path))break;a.L(n)<=0||u instanceof hu&&Ou(e,u)&&(r=r.rt(u.key,u))}return ca.resolve(r)},xc.prototype.lc=function(t,e){return ca.forEach(this.docs,function(t){return e(t)})},xc.prototype.ur=function(t){return new gc(this)},xc.prototype._c=function(t){return ca.resolve(this.size)},xc),gc=(Object.defineProperty(Mc.prototype,"readTime",{get:function(){return this.dc},set:function(t){this.dc=t},enumerable:!1,configurable:!0}),Mc.prototype.ar=function(t,e){this.wc(),this.readTime=e,this.ju.set(t.key,t)},Mc.prototype.Er=function(t,e){this.wc(),e&&(this.readTime=e),this.ju.set(t,null)},Mc.prototype.wi=function(t,e){this.wc();var n=this.ju.get(e);return void 0!==n?ca.resolve(n):this.mc(t,e)},Mc.prototype.getEntries=function(t,e){return this.Tc(t,e)},Mc.prototype.apply=function(t){return this.wc(),this.fc=!0,this.wu(t)},Mc.prototype.wc=function(){},n(jc,pc=Mc),jc.prototype.wu=function(n){var r=this,i=[];return this.ju.forEach(function(t,e){e?i.push(r.Ec.ar(n,e,r.readTime)):r.Ec.Er(t)}),ca.$n(i)},jc.prototype.mc=function(t,e){return this.Ec.wi(t,e)},jc.prototype.Tc=function(t,e){return this.Ec.getEntries(t,e)},jc),mc=(Cc.prototype.Ce=function(t,n){return this.Ic.forEach(function(t,e){return n(e)}),ca.resolve()},Cc.prototype._r=function(t){return ca.resolve(this.lastRemoteSnapshotVersion)},Cc.prototype.Pc=function(t){return ca.resolve(this.Ac)},Cc.prototype.qu=function(t){return this.highestTargetId=this.yc.next(),ca.resolve(this.highestTargetId)},Cc.prototype.Rr=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Ac&&(this.Ac=e),ca.resolve()},Cc.prototype.gc=function(t){this.Ic.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.yc=new Ha(e),this.highestTargetId=e),t.sequenceNumber>this.Ac&&(this.Ac=t.sequenceNumber)},Cc.prototype.Uu=function(t,e){return this.gc(e),this.targetCount+=1,ca.resolve()},Cc.prototype.Tr=function(t,e){return this.gc(e),ca.resolve()},Cc.prototype.Vc=function(t,e){return this.Ic.delete(e.target),this.Rc.kr(e.targetId),--this.targetCount,ca.resolve()},Cc.prototype.vc=function(n,r,i){var o=this,s=0,u=[];return this.Ic.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Ic.delete(t),u.push(o.bc(n,e.targetId)),s++)}),ca.$n(u).next(function(){return s})},Cc.prototype.Sc=function(t){return ca.resolve(this.targetCount)},Cc.prototype.Pr=function(t,e){return e=this.Ic.get(e)||null,ca.resolve(e)},Cc.prototype.wr=function(t,e,n){return this.Rc.Dr(e,n),ca.resolve()},Cc.prototype.dr=function(e,t,n){this.Rc.$r(t,n);var r=this.persistence.Ar,i=[];return r&&t.forEach(function(t){i.push(r.uc(e,t))}),ca.$n(i)},Cc.prototype.bc=function(t,e){return this.Rc.kr(e),ca.resolve()},Cc.prototype.pr=function(t,e){return e=this.Rc.Mr(e),ca.resolve(e)},Cc.prototype.Lr=function(t,e){return ca.resolve(this.Rc.Lr(e))},Cc),wc=(Vc.prototype.start=function(){return Promise.resolve()},Vc.prototype.ei=function(){return this.Fc=!1,Promise.resolve()},Object.defineProperty(Vc.prototype,"$c",{get:function(){return this.Fc},enumerable:!1,configurable:!0}),Vc.prototype.kc=function(){},Vc.prototype.xc=function(){},Vc.prototype.nr=function(){return this.li},Vc.prototype.Yi=function(t){var e=this.Cc[t.Cs()];return e||(e=new yc(this.li,this.Ar),this.Cc[t.Cs()]=e),e},Vc.prototype.tr=function(){return this.Zi},Vc.prototype.Xi=function(){return this.ai},Vc.prototype.runTransaction=function(t,e,n){var r=this;Sr("MemoryPersistence","Starting transaction:",t);var i=new bc(this.Dc.next());return this.Ar.Oc(),n(i).next(function(t){return r.Ar.Mc(i).next(function(){return t})}).Fn().then(function(t){return i.Lc(),t})},Vc.prototype.qc=function(e,n){return ca.kn(Object.values(this.Cc).map(function(t){return function(){return t.Lr(e,n)}}))},Vc),bc=(Uc.prototype.Bc=function(t){this.Uc.push(t)},Uc.prototype.Lc=function(){this.Uc.forEach(function(t){return t()})},n(_c,fc=Uc),_c),Ec=(kc.Wc=function(t){return new kc(t)},Object.defineProperty(kc.prototype,"Gc",{get:function(){if(this.jc)return this.jc;throw Pr()},enumerable:!1,configurable:!0}),kc.prototype.Cr=function(t,e,n){return this.Qc.Cr(n,e),this.Gc.delete(n.toString()),ca.resolve()},kc.prototype.Fr=function(t,e,n){return this.Qc.Fr(n,e),this.Gc.add(n.toString()),ca.resolve()},kc.prototype.uc=function(t,e){return this.Gc.add(e.toString()),ca.resolve()},kc.prototype.removeTarget=function(t,e){var n=this;this.Qc.kr(e.targetId).forEach(function(t){return n.Gc.add(t.toString())});var r=this.persistence.tr();return r.pr(t,e.targetId).next(function(t){t.forEach(function(t){return n.Gc.add(t.toString())})}).next(function(){return r.Vc(t,e)})},kc.prototype.Oc=function(){this.jc=new Set},kc.prototype.Mc=function(n){var r=this,i=this.persistence.Xi().ur();return ca.forEach(this.Gc,function(t){var e=Fr.C(t);return r.zc(n,e).next(function(t){t||i.Er(e)})}).next(function(){return r.jc=null,i.apply(n)})},kc.prototype.Ir=function(t,e){var n=this;return this.zc(t,e).next(function(t){t?n.Gc.delete(e.toString()):n.Gc.add(e.toString())})},kc.prototype.Nc=function(t){return 0},kc.prototype.zc=function(t,e){var n=this;return ca.kn([function(){return ca.resolve(n.Qc.Lr(e))},function(){return n.persistence.tr().Lr(t,e)},function(){return n.persistence.qc(t,e)}])},kc),Ic=(Pc.prototype.Eo=function(t){this.Yc=t},Pc.prototype.fo=function(t){this.Jc=t},Pc.prototype.onMessage=function(t){this.Xc=t},Pc.prototype.close=function(){this.Hc()},Pc.prototype.send=function(t){this.Kc(t)},Pc.prototype.Zc=function(){this.Yc()},Pc.prototype.ta=function(t){this.Jc(t)},Pc.prototype.ea=function(t){this.Xc(t)},Pc),Tc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},Ac=(Oc.prototype.Fo=function(e,t,n,r){var i=this.ra(e,t);return Sr("RestConnection","Sending: ",i,n),t={},this.oa(t,r),this.ua(e,i,t,n).then(function(t){return Sr("RestConnection","Received: ",t),t},function(t){throw Lr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},Oc.prototype.No=function(t,e,n,r){return this.Fo(t,e,n,r)},Oc.prototype.oa=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/7.23.0",t["Content-Type"]="text/plain",e)for(var n in e.Ur)e.Ur.hasOwnProperty(n)&&(t[n]=e.Ur[n])},Oc.prototype.ra=function(t,e){return t=Tc[t],this.sa+"/v1/"+e+":"+t},n(Lc,lc=Oc),Lc.prototype.ua=function(o,e,s,u){return new Promise(function(n,r){var i=new mr;i.listenOnce(vr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case yr.NO_ERROR:var t=i.getResponseJson();Sr("Connection","XHR received:",JSON.stringify(t)),n(t);break;case yr.TIMEOUT:Sr("Connection",'RPC "'+o+'" timed out'),r(new Tr(Ir.DEADLINE_EXCEEDED,"Request time out"));break;case yr.HTTP_ERROR:var e=i.getStatus();Sr("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace("_","-"),e=0<=Object.values(Ir).indexOf(e)?e:Ir.UNKNOWN,r(new Tr(e,t.message))):r(new Tr(Ir.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Tr(Ir.UNAVAILABLE,"Connection failed."));break;default:Pr()}}finally{Sr("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},Lc.prototype.Io=function(t,e){var n,r=[this.sa,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=dr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.B.projectId+"/databases/"+this.B.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.oa(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),Sr("Connection","Creating WebChannel: "+(r=r.join("")),t);var o=i.createWebChannel(r,t),s=!1,u=!1,a=new Ic({Kc:function(t){u?Sr("Connection","Not sending because WebChannel is closed:",t):(s||(Sr("Connection","Opening WebChannel transport."),o.open(),s=!0),Sr("Connection","WebChannel sending:",t),o.send(t))},Hc:function(){return o.close()}});return(t=function(t,e){o.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})})(gr.EventType.OPEN,function(){u||Sr("Connection","WebChannel transport opened.")}),t(gr.EventType.CLOSE,function(){u||(u=!0,Sr("Connection","WebChannel transport closed"),a.ta())}),t(gr.EventType.ERROR,function(t){u||(u=!0,Lr("Connection","WebChannel transport errored:",t),a.ta(new Tr(Ir.UNAVAILABLE,"The operation could not be completed")))}),t(gr.EventType.MESSAGE,function(t){var e,n,r,i;u||(kr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Sr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Fi[r];if(void 0!==t)return zi(t)}(),i=n.message,void 0===t&&(t=Ir.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),u=!0,a.ta(new Tr(t,i)),o.close()):(Sr("Connection","WebChannel received:",e),a.ea(e)))}),setTimeout(function(){a.Zc()},0),a},Lc),Nc=(Dc.prototype.Yo=function(t){this._a.push(t)},Dc.prototype.ei=function(){window.removeEventListener("online",this.ca),window.removeEventListener("offline",this.ha)},Dc.prototype.fa=function(){window.addEventListener("online",this.ca),window.addEventListener("offline",this.ha)},Dc.prototype.aa=function(){Sr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this._a;t<e.length;t++)(0,e[t])(0)},Dc.prototype.la=function(){Sr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this._a;t<e.length;t++)(0,e[t])(1)},Dc.da=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Dc),Rc=(Sc.prototype.Yo=function(t){},Sc.prototype.ei=function(){},Sc);function Sc(){}function Dc(){var t=this;this.ca=function(){return t.aa()},this.ha=function(){return t.la()},this._a=[],this.fa()}function Lc(t){var e=this;return(e=lc.call(this,t)||this).forceLongPolling=t.forceLongPolling,e}function Oc(t){this.na=t,this.B=t.B;var e=t.ssl?"https":"http";this.sa=e+"://"+t.host,this.ia="projects/"+this.B.projectId+"/databases/"+this.B.database+"/documents"}function Pc(t){this.Kc=t.Kc,this.Hc=t.Hc}function kc(t){this.persistence=t,this.Qc=new ah,this.jc=null}function _c(t){var e=this;return(e=fc.call(this)||this).mr=t,e}function Uc(){this.Uc=[]}function Vc(t){var e=this;this.Cc={},this.Dc=new La(0),this.Fc=!1,this.Fc=!0,this.Ar=t(this),this.Zi=new mc(this),this.li=new za,this.ai=(t=this.li,new vc(t,function(t){return e.Ar.Nc(t)}))}function Cc(t){this.persistence=t,this.Ic=new Ni(ji,Mi),this.lastRemoteSnapshotVersion=Si.min(),this.highestTargetId=0,this.Ac=0,this.Rc=new ah,this.targetCount=0,this.yc=Ha.ji()}function jc(t){var e=this;return(e=pc.call(this)||this).Ec=t,e}function Mc(){this.ju=new Ni(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.fc=!1}function xc(t,e){this.li=t,this.ac=e,this.docs=new Wi(Fr.i),this.size=0}function qc(t,e){this.li=t,this.Ar=e,this.hi=[],this.tc=1,this.ec=new $i(hh.vr)}function Fc(){}function Bc(t){return new Yo(t,!0)}var Gc,Qc,zc="You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.",Wc=(il.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.gu=this.wa(e),this.persistence=this.ma(e),[4,this.persistence.start()];case 1:return t.sent(),this.Ta=this.Ea(e),this.Bo=this.Ia(e),[2]}})})},il.prototype.Ea=function(t){return null},il.prototype.Ia=function(t){return e=this.persistence,n=new dc,t=t.Aa,new Xa(e,n,t);var e,n},il.prototype.ma=function(t){if(t.persistenceSettings.Ra)throw new Tr(Ir.FAILED_PRECONDITION,zc);return new wc(Ec.Wc)},il.prototype.wa=function(t){return new ka},il.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Ta&&this.Ta.stop(),[4,this.gu.ei()];case 1:return t.sent(),[4,this.persistence.ei()];case 2:return t.sent(),[2]}})})},il.prototype.clearPersistence=function(t,e){throw new Tr(Ir.FAILED_PRECONDITION,zc)},il),Hc=(rl.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.Bo?[3,2]:(this.Bo=n.Bo,this.gu=n.gu,this.Qo=this.ya(r),this.Pu=this.Pa(r),this.pu=this.pa(r),this.ga=this.Va(r),this.gu.Qs=function(t){return rc(e.ga,t,1)},this.Pu.jo.va=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Sr("SyncEngine","User change. New user:",o.Cs()),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).hi,m=e.er,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.hi.zu(v).next(function(t){return g=t,n=e.persistence.Yi(o),m=new Va(e.Ji,n,e.persistence.nr()),n.zu(v)}).next(function(t){for(var e=[],n=[],r=uo(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var h=a[u],r=r.add(h.key)}for(var c=0,l=t;c<l.length;c++){var f=l[c];n.push(f.batchId);for(var p=0,d=f.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Ti(v,r).next(function(t){return{Ku:t,Hu:e,Yu:n}})})})];case 1:return r=t.sent(),[2,(e.hi=n,e.er=m,e.Gi.sr(e.er),r)]}})})}(n.Bo,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).ku.forEach(function(t){t.forEach(function(t){t.reject(new Tr(Ir.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.ku.clear(),n.gu.Zs(o,r.Hu,r.Yu),[4,cc(n,r.Ku)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this.ga),[4,function(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.zo.delete(2),[4,Lh(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.zo.add(2),[4,Oh(e)]);case 3:t.sent(),e.Jo.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}(this.Pu,this.ga.Mu)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},rl.prototype.pa=function(t){return new Ea},rl.prototype.ya=function(t){var e=Bc(t.na.B),n=(n=t.na,new Ac(n));return t=t.credentials,new vh(t,n,e)},rl.prototype.Pa=function(t){var e=this;return new ih(this.Bo,this.Qo,t.xn,function(t){return rc(e.ga,t,0)},t=new(Nc.da()?Nc:Rc))},rl.prototype.Va=function(t){return e=this.Bo,n=this.Pu,r=this.pu,i=this.gu,o=t.Aa,s=t.Vu,u=!t.persistenceSettings.Ra||!t.persistenceSettings.synchronizeTabs,s=new Zh(e,n,r,i,o,s),u&&(s.Ou=!0),s;var e,n,r,i,o,s,u},rl.prototype.terminate=function(){return Ph(this.Pu)},rl),Xc=(nl.prototype.next=function(t){this.observer.next&&this.ba(this.observer.next,t)},nl.prototype.error=function(t){this.observer.error?this.ba(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},nl.prototype.Sa=function(){this.muted=!0},nl.prototype.ba=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},nl),Yc=function(t){!function(){if(!(t instanceof Array)||t.length<1)throw new Tr(Ir.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var e=0;e<t.length;++e)if(Kr("FieldPath","string",e,t[e]),0===t[e].length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Ca=new qr(t)},Kc=(n(el,Qc=Yc),el.documentId=function(){return new el(qr.v().R())},el.prototype.isEqual=function(t){if(!(t instanceof el))throw ui("isEqual","FieldPath",1,t);return this.Ca.isEqual(t.Ca)},el),Jc=new RegExp("[~\\*/\\[\\]]"),Zc=function(t){this.Da=t},$c=(n(tl,Gc=Zc),tl.prototype.Fa=function(t){if(2!==t.Na)throw 1===t.Na?t.$a(this.Da+"() can only appear at the top level of your update data"):t.$a(this.Da+"() cannot be used with set() unless you pass {merge:true}");return t.Qe.push(t.path),null},tl.prototype.isEqual=function(t){return t instanceof tl},tl);function tl(){return null!==Gc&&Gc.apply(this,arguments)||this}function el(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Qc.call(this,t)||this}function nl(t){this.observer=t,this.muted=!1}function rl(){}function il(){}function ol(t,e,n){return new Dl({Na:3,ka:e.settings.ka,methodName:t.Da,xa:n},e.B,e.serializer,e.ignoreUndefinedProperties)}var sl,ul,al,hl,cl=(n(Rl,hl=Zc),Rl.prototype.Fa=function(t){return new Ls(t.path,new ys)},Rl.prototype.isEqual=function(t){return t instanceof Rl},Rl),ll=(n(Nl,al=Zc),Nl.prototype.Fa=function(t){var e=ol(this,t,!0),n=this.Oa.map(function(t){return Cl(t,e)}),n=new vs(n);return new Ls(t.path,n)},Nl.prototype.isEqual=function(t){return this===t},Nl),fl=(n(Al,ul=Zc),Al.prototype.Fa=function(t){var e=ol(this,t,!0),n=this.Oa.map(function(t){return Cl(t,e)}),n=new Es(n);return new Ls(t.path,n)},Al.prototype.isEqual=function(t){return this===t},Al),pl=(n(Tl,sl=Zc),Tl.prototype.Fa=function(t){var e=new Ns(t.serializer,Zo(t.serializer,this.Ma));return new Ls(t.path,e)},Tl.prototype.isEqual=function(t){return this===t},Tl),dl=(Object.defineProperty(Il.prototype,"latitude",{get:function(){return this.La},enumerable:!1,configurable:!0}),Object.defineProperty(Il.prototype,"longitude",{get:function(){return this.qa},enumerable:!1,configurable:!0}),Il.prototype.isEqual=function(t){return this.La===t.La&&this.qa===t.qa},Il.prototype.toJSON=function(){return{latitude:this.La,longitude:this.qa}},Il.prototype.H=function(t){return pi(this.La,t.La)||pi(this.qa,t.qa)},Il),yl=function(t){this.Ua=t},vl=/^__.*__$/,gl=function(t,e,n){this.Ba=t,this.Qa=e,this.ja=n},ml=(El.prototype.Wa=function(t,e){var n=[];return null!==this.Qe?n.push(new Bs(t,this.data,this.Qe,e)):n.push(new Fs(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new Hs(t,this.fieldTransforms)),n},El),wl=(bl.prototype.Wa=function(t,e){return e=[new Bs(t,this.data,this.Qe,e)],0<this.fieldTransforms.length&&e.push(new Hs(t,this.fieldTransforms)),e},bl);function bl(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function El(t,e,n){this.data=t,this.Qe=e,this.fieldTransforms=n}function Il(t,e){if(Hr("GeoPoint",arguments,2),Kr("GeoPoint","number",1,t),Kr("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Tr(Ir.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Tr(Ir.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.La=t,this.qa=e}function Tl(t,e){var n=this;return(n=sl.call(this,t)||this).Ma=e,n}function Al(t,e){var n=this;return(n=ul.call(this,t)||this).Oa=e,n}function Nl(t,e){var n=this;return(n=al.call(this,t)||this).Oa=e,n}function Rl(){return null!==hl&&hl.apply(this,arguments)||this}function Sl(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Pr()}}var Dl=(Object.defineProperty(Pl.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Pl.prototype,"Na",{get:function(){return this.settings.Na},enumerable:!1,configurable:!0}),Pl.prototype.za=function(t){return new Pl(Object.assign(Object.assign({},this.settings),t),this.B,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.Qe)},Pl.prototype.Ka=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.za({path:e,xa:!1})).Ha(t),e},Pl.prototype.Ya=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.za({path:t,xa:!1})).Ga(),t},Pl.prototype.Ja=function(t){return this.za({path:void 0,xa:!0})},Pl.prototype.$a=function(t){return Bl(t,this.settings.methodName,this.settings.Xa||!1,this.path,this.settings.ka)},Pl.prototype.contains=function(e){return void 0!==this.Qe.find(function(t){return e.T(t)})||void 0!==this.fieldTransforms.find(function(t){return e.T(t.field)})},Pl.prototype.Ga=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Ha(this.path.get(t))},Pl.prototype.Ha=function(t){if(0===t.length)throw this.$a("Document fields must not be empty");if(Sl(this.Na)&&vl.test(t))throw this.$a('Document fields cannot begin and end with "__"')},Pl),Ll=(Ol.prototype.Za=function(t,e,n,r){return void 0===r&&(r=!1),new Dl({Na:t,methodName:e,ka:n,path:qr.p(),xa:!1,Xa:r},this.B,this.serializer,this.ignoreUndefinedProperties)},Ol);function Ol(t,e,n){this.B=t,this.ignoreUndefinedProperties=e,this.serializer=n||Bc(t)}function Pl(t,e,n,r,i,o){this.settings=t,this.B=e,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Ga(),this.fieldTransforms=i||[],this.Qe=o||[]}function kl(t,e,n,r,i,o){void 0===o&&(o={});var s=t.Za(o.merge||o.mergeFields?2:0,e,n,i);xl("Data must be an object, but it was:",s,r);var u,a,r=jl(r,s);if(o.merge)u=new Os(s.Qe),a=s.fieldTransforms;else if(o.mergeFields){for(var h=[],c=0,l=o.mergeFields;c<l.length;c++){var f=l[c],p=void 0;if(f instanceof Yc)p=f.Ca;else{if("string"!=typeof f)throw Pr();p=Fl(e,f,n)}if(!s.contains(p))throw new Tr(Ir.INVALID_ARGUMENT,"Field '"+p+"' is specified in your field mask but missing from your input data.");Gl(h,p)||h.push(p)}u=new Os(h),a=s.fieldTransforms.filter(function(t){return u.Ke(t.field)})}else u=null,a=s.fieldTransforms;return new ml(new tu(r),u,a)}function _l(t,r,i,e){var o=t.Za(1,r,i);xl("Data must be an object, but it was:",o,e);var s=[],u=new eu;return Ur(e,function(t,e){var n=Fl(r,t,i),t=o.Ya(n);e instanceof $c||e instanceof yl&&e.Ua instanceof $c?s.push(n):null!=(t=Cl(e,t))&&(s.push(n),u.set(n,t))}),e=new Os(s),new wl(u.Je(),e,o.fieldTransforms)}function Ul(t,e,n,r,i,o){var s=t.Za(1,e,n),u=[ql(e,r,n)],a=[i];if(o.length%2!=0)throw new Tr(Ir.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<o.length;h+=2)u.push(ql(e,o[h])),a.push(o[h+1]);for(var c,l,f,p=[],d=new eu,y=u.length-1;0<=y;--y)Gl(p,u[y])||(c=u[y],l=a[y],f=s.Ya(c),l instanceof $c||l instanceof yl&&l.Ua instanceof $c?p.push(c):null!=(f=Cl(l,f))&&(p.push(c),d.set(c,f)));return i=new Os(p),new wl(d.Je(),i,s.fieldTransforms)}function Vl(t,e,n,r){return void 0===r&&(r=!1),Cl(n,t.Za(r?4:3,e))}function Cl(s,t){if(s instanceof yl&&(s=s.Ua),Ml(s))return xl("Unsupported field value:",t,s),jl(s,t);if(s instanceof Zc)return function(t,e){if(!Sl(e.Na))throw e.$a(t.Da+"() can only be used with update() and set()");if(!e.path)throw e.$a(t.Da+"() is not currently supported inside arrays");(t=t.Fa(e))&&e.fieldTransforms.push(t)}(s,t),null;if(t.path&&t.Qe.push(t.path),s instanceof Array){if(t.settings.xa&&4!==t.Na)throw t.$a("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=Cl(i[r],t.Ja(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Zo(e.serializer,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Ri.fromDate(t);return{timestampValue:$o(e.serializer,n)}}if(t instanceof Ri){var r=new Ri(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:$o(e.serializer,r)}}if(t instanceof dl)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof gi)return{bytesValue:ts(e.serializer,t.U)};if(t instanceof gl){if(n=e.B,!(r=t.Ba).isEqual(n))throw e.$a("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:ns(t.Ba||e.B,t.Qa.path)}}if(void 0===t&&e.ignoreUndefinedProperties)return null;throw e.$a("Unsupported field value: "+ii(t))}(s,t)}function jl(t,n){var r={};return Vr(t)?n.path&&0<n.path.length&&n.Qe.push(n.path):Ur(t,function(t,e){null!=(e=Cl(e,n.Ka(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function Ml(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Ri||t instanceof dl||t instanceof gi||t instanceof gl||t instanceof Zc)}function xl(t,e,n){if(!Ml(n)||!ri(n))throw"an object"===(n=ii(n))?e.$a(t+" a custom object"):e.$a(t+" "+n)}function ql(t,e,n){if(e instanceof Yc)return e.Ca;if("string"==typeof e)return Fl(t,e);throw Bl("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}function Fl(t,e,n){try{return function(e){if(0<=e.search(Jc))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Kc.bind.apply(Kc,i([void 0],e.split("."))))}catch(t){throw new Tr(Ir.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Ca}catch(e){throw Bl(e instanceof Error?e.message:e.toString(),t,!1,void 0,n)}}function Bl(t,e,n,r,i){var o=r&&!r.m(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Tr(Ir.INVALID_ARGUMENT,(e+=". ")+t+n)}function Gl(t,e){return t.some(function(t){return t.isEqual(e)})}var Ql=(Yl.prototype.ih=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.rh(),0<this.mutations.length)throw new Tr(Ir.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var i,e,n,o,r;return v(this,function(t){switch(t.label){case 0:return e=ss((i=s).serializer)+"/documents",n={documents:u.map(function(t){return rs(i.serializer,t)})},[4,i.No("BatchGetDocuments",e,n)];case 1:return n=t.sent(),o=new Map,n.forEach(function(t){var e,n,r,t=(e=i.serializer,"found"in(t=t)?function(t,e){kr(!!e.found),e.found.name,e.found.updateTime;var n=is(t,e.found.name),t=es(e.found.updateTime),e=new tu({mapValue:{fields:e.found.fields}});return new hu(n,t,e,{})}(e,t):"missing"in t?(n=e,kr(!!(r=t).missing),kr(!!r.readTime),n=is(n,r.missing),r=es(r.readTime),new cu(n,r)):Pr());o.set(t.key.toString(),t)}),r=[],[2,(u.forEach(function(t){kr(!!(t=o.get(t.toString()))),r.push(t)}),r)]}})})}(this.Qo,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof cu||t instanceof hu?n.oh(t):Pr()}),e)]}})})},Yl.prototype.set=function(t,e){this.write(e.Wa(t,this.Ge(t))),this.sh.add(t.toString())},Yl.prototype.update=function(t,e){try{this.write(e.Wa(t,this.uh(t)))}catch(t){this.nh=t}this.sh.add(t.toString())},Yl.prototype.delete=function(t){this.write([new Zs(t,this.Ge(t))]),this.sh.add(t.toString())},Yl.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.rh(),this.nh)throw this.nh;return e=this.th,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=Fr.C(e),n.mutations.push(new $s(e,n.Ge(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=ss((e=i).serializer)+"/documents",r={writes:o.map(function(t){return as(e.serializer,t)})},[4,e.Fo("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Qo,this.mutations)];case 1:return t.sent(),this.eh=!0,[2]}})})},Yl.prototype.oh=function(t){var e;if(t instanceof hu)e=t.version;else{if(!(t instanceof cu))throw Pr();e=Si.min()}var n=this.th.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Tr(Ir.ABORTED,"Document version changed between two reads.")}else this.th.set(t.key.toString(),e)},Yl.prototype.Ge=function(t){var e=this.th.get(t.toString());return!this.sh.has(t.toString())&&e?_s.updateTime(e):_s.He()},Yl.prototype.uh=function(t){var e=this.th.get(t.toString());if(this.sh.has(t.toString())||!e)return _s.exists(!0);if(e.isEqual(Si.min()))throw new Tr(Ir.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return _s.updateTime(e)},Yl.prototype.write=function(t){this.rh(),this.mutations=this.mutations.concat(t)},Yl.prototype.rh=function(){},Yl),zl=(Xl.prototype.run=function(){this.hh()},Xl.prototype.hh=function(){var t=this;this.Jn.Rn(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Ql(this.Qo),(n=this.lh(e))&&n.then(function(t){r.xn.Qn(function(){return e.commit().then(function(){r.Ln.resolve(t)}).catch(function(t){r._h(t)})})}).catch(function(t){r._h(t)}),[2]})})})},Xl.prototype.lh=function(t){try{var e=this.updateFunction(t);return!_i(e)&&e.catch&&e.then?e:(this.Ln.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Ln.reject(t),null}},Xl.prototype._h=function(t){var e=this;0<this.ah&&this.fh(t)?(--this.ah,this.xn.Qn(function(){return e.hh(),Promise.resolve()})):this.Ln.reject(t)},Xl.prototype.fh=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!Qi(t))},Xl),Wl=(Hl.prototype.start=function(t,e,n,r){var i=this;this.wh(),this.na=t;var o=new aa,s=!1;return this.credentials.jr(function(t){return s?void i.xn.rs(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r).xn.cs(),Sr("RemoteStore","RemoteStore received new credentials"),n=Mh(e),e.zo.add(3),[4,Oh(e)];case 1:return t.sent(),n&&e.Jo.set("Unknown"),[4,e.jo.va(i)];case 2:return t.sent(),e.zo.delete(3),[4,Lh(e)];case 3:return t.sent(),[2]}})})}(i.Pu,t)}):(s=!0,Sr("FirestoreClient","Initializing. user=",t.uid),i.mh(e,n,r,t,o).then(i.dh.resolve,i.dh.reject))}),this.xn.Qn(function(){return i.dh.promise}),o.promise},Hl.prototype.enableNetwork=function(){var e=this;return this.wh(),this.xn.enqueue(function(){return e.persistence.xc(!0),(t=e.Pu).zo.delete(0),Lh(t);var t})},Hl.prototype.mh=function(r,i,o,s,u){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),e={xn:this.xn,na:this.na,clientId:this.clientId,credentials:this.credentials,Aa:s,Vu:100,persistenceSettings:o},[4,r.initialize(e)];case 1:return t.sent(),[4,i.initialize(r,e)];case 2:return t.sent(),this.persistence=r.persistence,this.gu=r.gu,this.Bo=r.Bo,this.Ta=r.Ta,this.Qo=i.Qo,this.Pu=i.Pu,this.ga=i.ga,this.Th=i.pu,this.Th.Es=function(h,c){return y(this,void 0,void 0,function(){var n,o,s,u,a;return v(this,function(t){switch(t.label){case 0:return(e=h).Pu.jo.tu=nc.bind(null,e),e.Pu.jo.qe=function(t,e){var n=t;if((t=n.Fu.get(e))&&t.yu)return uo().add(t.key);var r=uo();if(!(e=n.Su.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.bu.get(s),r=r.kt(s.view.hu);return r}.bind(null,e),e.Pu.jo.Zo=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).gu.zs(s,"rejected",u),i=e.Fu.get(s),(n=i&&i.key)?(r=(r=new Wi(Fr.i)).rt(n,new cu(n,Si.min())),i=uo().add(n),i=new fo(Si.min(),new Map,new $i(pi),r,i),[4,nc(e,i)]):[3,2];case 1:return t.sent(),e.Du=e.Du.remove(n),e.Fu.delete(s),hc(e),[3,4];case 2:return[4,th(e.Bo,s,!1).then(function(){return sc(e,s,u)}).catch(nh)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,e),e.vu.Ao=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.ws.get(u)){for(var a=0,h=u.listeners;a<h.length;a++)h[a].As(s)&&(r=!0);u.ds=s}}r&&Aa(n)}.bind(null,e.pu),e.vu.Lu=function(t,e,n){var r=t;if(t=r.ws.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.ws.delete(e)}.bind(null,e.pu),(a=(n=e).bu.get(c))?(o=a.targetId,n.gu.Gs(o),s=a.view.Ru(),[3,4]):[3,1];case 1:return[4,(e=n.Bo,r=Tu(c),(i=e).persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i.Zi.Pr(e,r).next(function(t){return t?(n=t,ca.resolve(n)):i.Zi.qu(e).next(function(t){return n=new Bi(r,t,0,e.mr),i.Zi.Uu(e,n).next(function(){return n})})})}).then(function(t){var e=i.zi.get(t.targetId);return(null===e||0<t.et.L(e.et))&&(i.zi=i.zi.rt(t.targetId,t),i.Ki.set(r,t.targetId)),t}))];case 2:return u=t.sent(),a=n.gu.Gs(u.targetId),o=u.targetId,[4,function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Bu=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.lu(o)).du?[4,eh(r.Bo,i.query,!1).then(function(t){return t=t.documents,i.view.lu(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.zt.get(i.targetId),n=i.view.wu(e,r.Mu,n),[2,(ac(r,i.targetId,n.Eu),n.snapshot)]}})})}(i,t,e,n)},[4,eh(i.Bo,o,!0)];case 1:return n=t.sent(),r=new Kh(o,n.gr),e=r.lu(n.documents),n=po.Xt(s,u&&"Offline"!==i.onlineState),n=r.wu(e,i.Mu,n),ac(i,s,n.Eu),r=new Hh(o,s,r),i.bu.set(o,r),i.Su.has(s)?i.Su.get(s).push(o):i.Su.set(s,[o]),[2,n.snapshot]}})})}(n,c,o,"current"===a)];case 3:s=t.sent(),n.Mu&&kh(n.Pu,u),t.label=4;case 4:return[2,s]}var r,i,e})})}.bind(null,this.ga),this.Th.Rs=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).bu.get(o),1<(r=e.Su.get(n.targetId)).length?[2,(e.Su.set(n.targetId,r.filter(function(t){return!Su(t,o)})),void e.bu.delete(o))]:e.Mu?(e.gu.Ks(n.targetId),e.gu.Xs(n.targetId)?[3,2]:[4,th(e.Bo,n.targetId,!1).then(function(){e.gu.Ys(n.targetId),_h(e.Pu,n.targetId),sc(e,n.targetId)}).catch(nh)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return sc(e,n.targetId),[4,th(e.Bo,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,this.ga),this.persistence.kc(function(){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),u.resolve(),[3,4];case 3:if(e=t.sent(),u.reject(e),!this.Eh(e))throw e;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),this.mh(new Wc,new Hc,{Ra:!1},s,u))];case 4:return[2]}})})},Hl.prototype.Eh=function(t){return"FirebaseError"===t.name?t.code===Ir.FAILED_PRECONDITION||t.code===Ir.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Hl.prototype.wh=function(){if(this.xn.Zn)throw new Tr(Ir.FAILED_PRECONDITION,"The client has already been terminated.")},Hl.prototype.disableNetwork=function(){var t=this;return this.wh(),this.xn.enqueue(function(){return t.persistence.xc(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).zo.add(0),[4,Oh(e)];case 1:return t.sent(),e.Jo.set("Offline"),[2]}})})}(t.Pu)})},Hl.prototype.terminate=function(){var t=this;this.xn.ss();var n=new aa;return this.xn.ts(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),this.Ta&&this.Ta.stop(),[4,Ph(this.Pu)];case 1:return t.sent(),[4,this.gu.ei()];case 2:return t.sent(),[4,this.persistence.ei()];case 3:return t.sent(),this.credentials.Wr(),n.resolve(),[3,5];case 4:return e=wa(e=t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,5];case 5:return[2]}})})}),n.promise},Hl.prototype.waitForPendingWrites=function(){var t=this;this.wh();var e=new aa;return this.xn.Qn(function(){return function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:Mh((n=o).Pu)||Sr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.Bo).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.hi.Gu(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.ku.get(r)||[]).push(s),n.ku.set(r,i),[3,4]);case 3:return i=wa(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}(t.ga,e)}),e.promise},Hl.prototype.listen=function(t,e,n){var r=this;this.wh();var i=new Xc(n),o=new Na(t,i,e);return this.xn.Qn(function(){return Ia(r.Th,o)}),function(){i.Sa(),r.xn.Qn(function(){return Ta(r.Th,o)})}},Hl.prototype.Ih=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.wh(),[4,this.dh.promise];case 1:return t.sent(),e=new aa,[2,(this.xn.Qn(function(){return function(i,o,s){return y(this,void 0,void 0,function(){var r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=o,(n=i).persistence.runTransaction("read document","readonly",function(t){return n.er._i(t,e)}))];case 1:return(r=t.sent())instanceof hu?s.resolve(r):r instanceof cu?s.resolve(null):s.reject(new Tr(Ir.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=wa(r=t.sent(),"Failed to get document '"+o+" from cache"),s.reject(r),[3,3];case 3:return[2]}var e,n})})}(n.Bo,r,e)}),e.promise)]}})})},Hl.prototype.Ah=function(h,c){return void 0===c&&(c={}),y(this,void 0,void 0,function(){var e,a=this;return v(this,function(t){switch(t.label){case 0:return this.wh(),[4,this.dh.promise];case 1:return t.sent(),e=new aa,[2,(this.xn.Qn(function(){return n=a.Th,r=a.xn,i=h,o=c,s=e,t=new Xc({next:function(t){r.Qn(function(){return Ta(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Tr(Ir.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Tr(Ir.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new Na(vu(i.path),t,{includeMetadataChanges:!0,bs:!0}),Ia(n,u);var n,r,i,o,s,t,u}),e.promise)]}})})},Hl.prototype.Rh=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return this.wh(),[4,this.dh.promise];case 1:return t.sent(),e=new aa,[2,(this.xn.Qn(function(){return function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,eh(r,i,!0)];case 1:return n=t.sent(),e=new Kh(i,n.gr),n=e.lu(n.documents),n=e.wu(n,!1),o.resolve(n.snapshot),[3,3];case 2:return n=wa(n=t.sent(),"Failed to execute query '"+i+" against cache"),o.reject(n),[3,3];case 3:return[2]}})})}(n.Bo,r,e)}),e.promise)]}})})},Hl.prototype.yh=function(h,c){return void 0===c&&(c={}),y(this,void 0,void 0,function(){var u,a=this;return v(this,function(t){switch(t.label){case 0:return this.wh(),[4,this.dh.promise];case 1:return t.sent(),u=new aa,[2,(this.xn.Qn(function(){return e=a.Th,n=a.xn,t=h,r=c,i=u,o=new Xc({next:function(t){n.Qn(function(){return Ta(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Tr(Ir.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new Na(t,o,{includeMetadataChanges:!0,bs:!0}),Ia(e,s);var e,n,t,r,i,o,s}),u.promise)]}})})},Hl.prototype.write=function(t){var e=this;this.wh();var n=new aa;return this.xn.Qn(function(){return ec(e.ga,t,n)}),n.promise},Hl.prototype.B=function(){return this.na.B},Hl.prototype.Ph=function(t){var e=this;this.wh();var r=new Xc(t);return this.xn.Qn(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,(e=this.Th,n=r,e.Ts.add(n),void n.next())];var e,n})})}),function(){r.Sa(),e.xn.Qn(function(){return y(e,void 0,void 0,function(){return v(this,function(t){return[2,void this.Th.Ts.delete(r)]})})})}},Object.defineProperty(Hl.prototype,"ph",{get:function(){return this.xn.Zn},enumerable:!1,configurable:!0}),Hl.prototype.transaction=function(t){var e=this;this.wh();var n=new aa;return this.xn.Qn(function(){return new zl(e.xn,e.Qo,t,n).run(),Promise.resolve()}),n.promise},Hl);function Hl(t,e){this.credentials=t,this.xn=e,this.clientId=li.k(),this.dh=new aa}function Xl(t,e,n,r){this.xn=t,this.Qo=e,this.updateFunction=n,this.Ln=r,this.ah=5,this.Jn=new ha(this.xn,"transaction_retry")}function Yl(t){this.Qo=t,this.th=new Map,this.mutations=[],this.eh=!1,this.nh=null,this.sh=new Set}function Kl(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Jl,Zl,$l=(mf.prototype.Sh=function(t){switch(ko(t)){case 0:return null;case 1:return t.booleanValue;case 2:return xo(t.integerValue||t.doubleValue);case 3:return this.Ch(t.timestampValue);case 4:return this.Dh(t);case 5:return t.stringValue;case 6:return this.bh(qo(t.bytesValue));case 7:return this.Fh(t.referenceValue);case 8:return this.Nh(t.geoPointValue);case 9:return this.$h(t.arrayValue);case 10:return this.kh(t.mapValue);default:throw Pr()}},mf.prototype.kh=function(t){var n=this,r={};return Ur(t.fields||{},function(t,e){r[t]=n.Sh(e)}),r},mf.prototype.Nh=function(t){return new dl(xo(t.latitude),xo(t.longitude))},mf.prototype.$h=function(t){var e=this;return(t.values||[]).map(function(t){return e.Sh(t)})},mf.prototype.Dh=function(t){switch(this.gh){case"previous":var e=function t(e){return Lo(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==e?null:this.Sh(e);case"estimate":return this.Ch(Oo(t));default:return null}},mf.prototype.Ch=function(t){return t=Mo(t),t=new Ri(t.seconds,t.nanos),this.timestampsInSnapshots?t:t.toDate()},mf.prototype.Fh=function(t){var e=Mr.P(t);return kr(ls(e)),t=new Ai(e.get(1),e.get(3)),e=new Fr(e.u(5)),t.isEqual(this.B)||Dr("Document "+e+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+this.B.projectId+"/"+this.B.database+") instead."),this.Vh(e)},mf),tf=ja.xi,ef=(gf.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},gf),nf=(Object.defineProperty(vf.prototype,"Gh",{get:function(){return this.zh||(this.zh=new Ll(this.Ba,this.Wh.ignoreUndefinedProperties)),this.zh},enumerable:!1,configurable:!0}),vf.prototype.settings=function(t){if(Hr("Firestore.settings",arguments,1),Kr("Firestore.settings","object",1,t),t.merge&&delete(t=Object.assign(Object.assign({},this.Wh),t)).merge,t=new ef(t),this.Uh&&!this.Wh.isEqual(t))throw new Tr(Ir.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Wh=t).credentials&&(this.jh=function(t){if(!t)return new ch;switch(t.type){case"gapi":var e=t.client;return kr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new ph(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Tr(Ir.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},vf.prototype.enableNetwork=function(){return this.qh(),this.Uh.enableNetwork()},vf.prototype.disableNetwork=function(){return this.qh(),this.Uh.disableNetwork()},vf.prototype.enablePersistence=function(t){var e;if(this.Uh)throw new Tr(Ir.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var n=!1,r=!1;if(t&&(void 0!==t.experimentalTabSynchronization&&Dr("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),n=null!==(e=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==e&&e,r=!!t.experimentalForceOwningTab&&t.experimentalForceOwningTab,n&&r))throw new Tr(Ir.INVALID_ARGUMENT,"The 'experimentalForceOwningTab' setting cannot be used with 'synchronizeTabs'.");return this.Kh(this.xh,this.Oh,{Ra:!0,cacheSizeBytes:this.Wh.cacheSizeBytes,synchronizeTabs:n,Hh:r})},vf.prototype.clearPersistence=function(){return y(this,void 0,void 0,function(){var n,e=this;return v(this,function(t){if(void 0!==this.Uh&&!this.Uh.ph)throw new Tr(Ir.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");return n=new aa,[2,(this.Lh.ts(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.xh.clearPersistence(this.Ba,this.Qh)];case 1:return t.sent(),n.resolve(),[3,3];case 2:return e=t.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise)]})})},vf.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(vf.prototype,"Yh",{get:function(){return this.qh(),this.Uh.ph},enumerable:!1,configurable:!0}),vf.prototype.waitForPendingWrites=function(){return this.qh(),this.Uh.waitForPendingWrites()},vf.prototype.onSnapshotsInSync=function(t){return this.qh(),Kl(t)||(Kr("Firestore.onSnapshotsInSync","function",1,t),t={next:t}),this.Uh.Ph(t)},vf.prototype.qh=function(){return this.Uh||this.Kh(new Wc,new Hc,{Ra:!1}),this.Uh},vf.prototype.Jh=function(){return new Ei(this.Ba,this.Qh,this.Wh.host,this.Wh.ssl,this.Wh.experimentalForceLongPolling)},vf.prototype.Kh=function(t,e,n){var r=this.Jh();return this.Uh=new Wl(this.jh,this.Lh),this.Uh.start(r,t,e,n)},vf.Bh=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Tr(Ir.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e;if(!(t=t.options.projectId)||"string"!=typeof t)throw new Tr(Ir.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new Ai(t)},Object.defineProperty(vf.prototype,"app",{get:function(){if(!this.Mh)throw new Tr(Ir.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Mh},enumerable:!1,configurable:!0}),vf.prototype.collection=function(t){return Hr("Firestore.collection",arguments,1),Kr("Firestore.collection","non-empty string",1,t),this.qh(),new Rf(Mr.P(t),this,null)},vf.prototype.doc=function(t){return Hr("Firestore.doc",arguments,1),Kr("Firestore.doc","non-empty string",1,t),this.qh(),sf.Xh(Mr.P(t),this,null)},vf.prototype.collectionGroup=function(t){if(Hr("Firestore.collectionGroup",arguments,1),Kr("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.qh(),new Af((t=t,new fu(Mr.p(),t)),this,null)},vf.prototype.runTransaction=function(e){var n=this;return Hr("Firestore.runTransaction",arguments,1),Kr("Firestore.runTransaction","function",1,e),this.qh().transaction(function(t){return e(new rf(n,t))})},vf.prototype.batch=function(){return this.qh(),new of(this)},Object.defineProperty(vf,"logLevel",{get:function(){switch(Rr()){case u.DEBUG:return"debug";case u.ERROR:return"error";case u.SILENT:return"silent";case u.WARN:return"warn";case u.INFO:return"info";case u.VERBOSE:return"verbose";default:return"error"}},enumerable:!1,configurable:!0}),vf.setLogLevel=function(t){Hr("Firestore.setLogLevel",arguments,1),ei("setLogLevel",["debug","error","silent","warn","info","verbose"],1,t),Ar.setLogLevel(t)},vf.prototype.Zh=function(){return this.Wh.timestampsInSnapshots},vf.prototype.tl=function(){return this.Wh},vf),rf=(yf.prototype.get=function(t){var e=this;Hr("Transaction.get",arguments,1);var n=_f("Transaction.get",t,this.el);return this.nl.ih([n.Qa]).then(function(t){if(!t||1!==t.length)return Pr();if((t=t[0])instanceof cu)return new af(e.el,n.Qa,null,!1,!1,n.ja);if(t instanceof hu)return new af(e.el,n.Qa,t,!1,!1,n.ja);throw Pr()})},yf.prototype.set=function(t,e,n){return Yr("Transaction.set",arguments,2,3),t=_f("Transaction.set",t,this.el),n=Of("Transaction.set",n),e=Uf(t.ja,e,n),n=kl(this.el.Gh,"Transaction.set",t.Qa,e,null!==t.ja,n),this.nl.set(t.Qa,n),this},yf.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return e="string"==typeof e||e instanceof Kc?(Xr("Transaction.update",arguments,3),r=_f("Transaction.update",t,this.el),Ul(this.el.Gh,"Transaction.update",r.Qa,e,n,i)):(Hr("Transaction.update",arguments,2),r=_f("Transaction.update",t,this.el),_l(this.el.Gh,"Transaction.update",r.Qa,e)),this.nl.update(r.Qa,e),this},yf.prototype.delete=function(t){return Hr("Transaction.delete",arguments,1),t=_f("Transaction.delete",t,this.el),this.nl.delete(t.Qa),this},yf),of=(df.prototype.set=function(t,e,n){return Yr("WriteBatch.set",arguments,2,3),this.rl(),t=_f("WriteBatch.set",t,this.el),n=Of("WriteBatch.set",n),e=Uf(t.ja,e,n),n=kl(this.el.Gh,"WriteBatch.set",t.Qa,e,null!==t.ja,n),this.sl=this.sl.concat(n.Wa(t.Qa,_s.He())),this},df.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];return this.rl(),e="string"==typeof e||e instanceof Kc?(Xr("WriteBatch.update",arguments,3),r=_f("WriteBatch.update",t,this.el),Ul(this.el.Gh,"WriteBatch.update",r.Qa,e,n,i)):(Hr("WriteBatch.update",arguments,2),r=_f("WriteBatch.update",t,this.el),_l(this.el.Gh,"WriteBatch.update",r.Qa,e)),this.sl=this.sl.concat(e.Wa(r.Qa,_s.exists(!0))),this},df.prototype.delete=function(t){return Hr("WriteBatch.delete",arguments,1),this.rl(),t=_f("WriteBatch.delete",t,this.el),this.sl=this.sl.concat(new Zs(t.Qa,_s.He())),this},df.prototype.commit=function(){return this.rl(),this.il=!0,0<this.sl.length?this.el.qh().write(this.sl):Promise.resolve()},df.prototype.rl=function(){if(this.il)throw new Tr(Ir.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},df),sf=(n(pf,Zl=gl),pf.Xh=function(t,e,n){if(t.length%2!=0)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.R()+" has "+t.length);return new pf(new Fr(t),e,n)},Object.defineProperty(pf.prototype,"id",{get:function(){return this.Qa.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(pf.prototype,"parent",{get:function(){return new Rf(this.Qa.path.h(),this.firestore,this.ja)},enumerable:!1,configurable:!0}),Object.defineProperty(pf.prototype,"path",{get:function(){return this.Qa.path.R()},enumerable:!1,configurable:!0}),pf.prototype.collection=function(t){if(Hr("DocumentReference.collection",arguments,1),Kr("DocumentReference.collection","non-empty string",1,t),!t)throw new Tr(Ir.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");return t=Mr.P(t),new Rf(this.Qa.path.child(t),this.firestore,null)},pf.prototype.isEqual=function(t){if(!(t instanceof pf))throw ui("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.Qa.isEqual(t.Qa)&&this.ja===t.ja},pf.prototype.set=function(t,e){return Yr("DocumentReference.set",arguments,1,2),e=Of("DocumentReference.set",e),t=Uf(this.ja,t,e),e=kl(this.firestore.Gh,"DocumentReference.set",this.Qa,t,null!==this.ja,e),this.Uh.write(e.Wa(this.Qa,_s.He()))},pf.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return t="string"==typeof t||t instanceof Kc?(Xr("DocumentReference.update",arguments,2),Ul(this.firestore.Gh,"DocumentReference.update",this.Qa,t,e,n)):(Hr("DocumentReference.update",arguments,1),_l(this.firestore.Gh,"DocumentReference.update",this.Qa,t)),this.Uh.write(t.Wa(this.Qa,_s.exists(!0)))},pf.prototype.delete=function(){return Hr("DocumentReference.delete",arguments,0),this.Uh.write([new Zs(this.Qa,_s.He())])},pf.prototype.onSnapshot=function(){for(var e=this,n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];Yr("DocumentReference.onSnapshot",arguments,1,4);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||Kl(n[i])||(si("DocumentReference.onSnapshot",r=n[i],["includeMetadataChanges"]),$r("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};Kl(n[i])?(s=n[i],n[i]=null===(r=s.next)||void 0===r?void 0:r.bind(s),n[i+1]=null===(r=s.error)||void 0===r?void 0:r.bind(s),n[i+2]=null===(r=s.complete)||void 0===r?void 0:r.bind(s)):(Kr("DocumentReference.onSnapshot","function",i,n[i]),Jr("DocumentReference.onSnapshot","function",i+1,n[i+1]),Jr("DocumentReference.onSnapshot","function",i+2,n[i+2]));var s={next:function(t){n[i]&&n[i](e.ol(t))},error:n[i+1],complete:n[i+2]};return this.Uh.listen(vu(this.Qa.path),o,s)},pf.prototype.get=function(t){var e=this;Yr("DocumentReference.get",arguments,0,1),kf("DocumentReference.get",t);var n=this.firestore.qh();return t&&"cache"===t.source?n.Ih(this.Qa).then(function(t){return new af(e.firestore,e.Qa,t,!0,t instanceof hu&&t.Ye,e.ja)}):n.Ah(this.Qa,t).then(function(t){return e.ol(t)})},pf.prototype.withConverter=function(t){return new pf(this.Qa,this.firestore,t)},pf.prototype.ol=function(t){var e=t.docs.get(this.Qa);return new af(this.firestore,this.Qa,e,t.fromCache,t.hasPendingWrites,this.ja)},pf),uf=(ff.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},ff),af=(lf.prototype.data=function(t){var e=this;if(Yr("DocumentSnapshot.data",arguments,0,1),t=Pf("DocumentSnapshot.data",t),this.ul){if(this.ja){var n=new hf(this.el,this.Qa,this.ul,this.cl,this.al,null);return this.ja.fromFirestore(n,t)}return new $l(this.el.Ba,this.el.Zh(),t.serverTimestamps||"none",function(t){return new sf(t,e.el,null)},function(t){return new Ti(t)}).Sh(this.ul.sn())}},lf.prototype.get=function(t,e){var n=this;if(Yr("DocumentSnapshot.get",arguments,1,2),e=Pf("DocumentSnapshot.get",e),this.ul&&null!==(t=this.ul.data().field(ql("DocumentSnapshot.get",t,this.Qa))))return new $l(this.el.Ba,this.el.Zh(),e.serverTimestamps||"none",function(t){return new sf(t,n.el,n.ja)},function(t){return new Ti(t)}).Sh(t)},Object.defineProperty(lf.prototype,"id",{get:function(){return this.Qa.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(lf.prototype,"ref",{get:function(){return new sf(this.Qa,this.el,this.ja)},enumerable:!1,configurable:!0}),Object.defineProperty(lf.prototype,"exists",{get:function(){return null!==this.ul},enumerable:!1,configurable:!0}),Object.defineProperty(lf.prototype,"metadata",{get:function(){return new uf(this.al,this.cl)},enumerable:!1,configurable:!0}),lf.prototype.isEqual=function(t){if(!(t instanceof lf))throw ui("isEqual","DocumentSnapshot",1,t);return this.el===t.el&&this.cl===t.cl&&this.Qa.isEqual(t.Qa)&&(null===this.ul?null===t.ul:this.ul.isEqual(t.ul))&&this.ja===t.ja},lf),hf=(n(cf,Jl=af),cf.prototype.data=function(t){return Jl.prototype.data.call(this,t)},cf);function cf(){return null!==Jl&&Jl.apply(this,arguments)||this}function lf(t,e,n,r,i,o){this.el=t,this.Qa=e,this.ul=n,this.cl=r,this.al=i,this.ja=o}function ff(t,e){this.hasPendingWrites=t,this.fromCache=e}function pf(t,e,n){var r=this;return(r=Zl.call(this,e.Ba,t,n)||this).Qa=t,r.firestore=e,r.ja=n,r.Uh=r.firestore.qh(),r}function df(t){this.el=t,this.sl=[],this.il=!1}function yf(t,e){this.el=t,this.nl=e}function vf(t,e,n,r){var i=this;if(void 0===n&&(n=new Wc),void 0===r&&(r=new Hc),this.xh=n,this.Oh=r,this.Mh=null,this.Lh=new va,this.INTERNAL={delete:function(){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.qh(),[4,this.Uh.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options)r=t,this.Mh=r,this.Ba=vf.Bh(r),this.Qh=r.name,this.jh=new lh(e);else{if(!(t=t).projectId)throw new Tr(Ir.INVALID_ARGUMENT,"Must provide projectId");this.Ba=new Ai(t.projectId,t.database),this.Qh="[DEFAULT]",this.jh=new ch}this.Wh=new ef({})}function gf(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Tr(Ir.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Zr("settings","non-empty string","host",t.host),this.host=t.host,$r("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(si("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling","ignoreUndefinedProperties"]),$r("settings","object","credentials",t.credentials),this.credentials=t.credentials,$r("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),$r("settings","boolean","ignoreUndefinedProperties",t.ignoreUndefinedProperties),!0===t.timestampsInSnapshots?Dr("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Dr("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(e=t.timestampsInSnapshots)||void 0===e||e,this.ignoreUndefinedProperties=null!==(e=t.ignoreUndefinedProperties)&&void 0!==e&&e,$r("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=ja.Mi;else{if(t.cacheSizeBytes!==tf&&t.cacheSizeBytes<ja.Oi)throw new Tr(Ir.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+ja.Oi);this.cacheSizeBytes=t.cacheSizeBytes}$r("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.experimentalForceLongPolling=null!==(t=t.experimentalForceLongPolling)&&void 0!==t&&t}function mf(t,e,n,r,i){this.B=t,this.timestampsInSnapshots=e,this.gh=n,this.Vh=r,this.bh=i}function wf(t,e,n){if("string"==typeof n){if(""===n)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Eu(e)&&-1!==n.indexOf("/"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(Mr.P(n)),!Fr.N(e))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Fo(t,new Fr(e))}if(n instanceof gl)return Fo(t,n.Qa);throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+ii(n)+".")}function bf(t,e){if(!Array.isArray(t)||0===t.length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if("in"===e||"array-contains-any"===e){if(0<=t.indexOf(null))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")}}function Ef(t,e,n){if(!n.isEqual(e))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function If(t){if(mu(t)&&0===t.rn.length)throw new Tr(Ir.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Tf,Af=(Lf.prototype.where=function(t,e,n){return Hr("Query.where",arguments,3),oi("Query.where",3,n),e=ei("Query.where",["<","<=","==","!=",">=",">","array-contains","in","array-contains-any","not-in"],2,e),t=ql("Query.where",t),e=function(t,e,n,r,i,o){if(r.V()){if("array-contains"===i||"array-contains-any"===i)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){bf(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var h=a[u];s.push(wf(n,t,h))}c={arrayValue:{values:s}}}else c=wf(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||bf(o,i),c=Vl(e,"Query.where",o,"in"===i||"not-in"===i);var c=_u.create(r,i,c);return function(t,e){if(e.an()){var n=bu(t);if(null!==n&&!n.isEqual(e.field))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=wu(t))&&Ef(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,c),c}(this.hl,this.firestore.Gh,this.firestore.Ba,t,e,n),new Lf((e=(n=this.hl).filters.concat([e]),new fu(n.path,n.collectionGroup,n.rn.slice(),e,n.limit,n.on,n.startAt,n.endAt)),this.firestore,this.ja)},Lf.prototype.orderBy=function(t,e){if(Yr("Query.orderBy",arguments,1,2),Jr("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Tr(Ir.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}var n,t=ql("Query.orderBy",t),t=function(t,e,n){if(null!==t.startAt)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new ua(e,n);return e=r,null!==wu(n=t)||null!==(t=bu(n))&&Ef(0,t,e.field),r}(this.hl,t,n);return new Lf((t=(n=this.hl).rn.concat([t]),new fu(n.path,n.collectionGroup,t,n.filters.slice(),n.limit,n.on,n.startAt,n.endAt)),this.firestore,this.ja)},Lf.prototype.limit=function(t){return Hr("Query.limit",arguments,1),Kr("Query.limit","number",1,t),ai("Query.limit",1,t),new Lf(Au(this.hl,t,"F"),this.firestore,this.ja)},Lf.prototype.limitToLast=function(t){return Hr("Query.limitToLast",arguments,1),Kr("Query.limitToLast","number",1,t),ai("Query.limitToLast",1,t),new Lf(Au(this.hl,t,"L"),this.firestore,this.ja)},Lf.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Xr("Query.startAt",arguments,1),t=this.ll("Query.startAt",t,e,!0),new Lf(Nu(this.hl,t),this.firestore,this.ja)},Lf.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Xr("Query.startAfter",arguments,1),t=this.ll("Query.startAfter",t,e,!1),new Lf(Nu(this.hl,t),this.firestore,this.ja)},Lf.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Xr("Query.endBefore",arguments,1),t=this.ll("Query.endBefore",t,e,!0),new Lf(Ru(this.hl,t),this.firestore,this.ja)},Lf.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return Xr("Query.endAt",arguments,1),t=this.ll("Query.endAt",t,e,!1),new Lf(Ru(this.hl,t),this.firestore,this.ja)},Lf.prototype.isEqual=function(t){if(!(t instanceof Lf))throw ui("isEqual","Query",1,t);return this.firestore===t.firestore&&Su(this.hl,t.hl)&&this.ja===t.ja},Lf.prototype.withConverter=function(t){return new Lf(this.hl,this.firestore,t)},Lf.prototype.ll=function(h,t,e,n){return oi(h,1,t),t instanceof af?(Hr(h,i([t],e),1),function(t,e,n,r){if(!n)throw new Tr(Ir.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+h+"().");for(var i=[],o=0,s=Iu(t);o<s.length;o++){var u=s[o];if(u.field.V())i.push(Fo(e,n.key));else{var a=n.field(u.field);if(Lo(a))throw new Tr(Ir.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.R(),new Tr(Ir.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new $u(i,r)}(this.hl,this.firestore.Ba,t.ul,n)):(e=[t].concat(e),function(t,e,n,r,i,o){var s=t.rn;if(i.length>s.length)throw new Tr(Ir.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var h=i[a];if(s[a].field.V()){if("string"!=typeof h)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof h);if(!Eu(t)&&-1!==h.indexOf("/"))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+h+"' contains a slash.");var c=t.path.child(Mr.P(h));if(!Fr.N(c))throw new Tr(Ir.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+c+"' is not because it contains an odd number of segments.");c=new Fr(c),u.push(Fo(e,c))}else h=Vl(n,r,h),u.push(h)}return new $u(u,o)}(this.hl,this.firestore.Ba,this.firestore.Gh,h,e,n))},Lf.prototype.onSnapshot=function(){for(var t,e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Yr("Query.onSnapshot",arguments,1,4);var i={},o=0;"object"!=typeof n[o]||Kl(n[o])||(si("Query.onSnapshot",i=n[o],["includeMetadataChanges"]),$r("Query.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),o++),Kl(n[o])?(s=n[o],n[o]=null===(t=s.next)||void 0===t?void 0:t.bind(s),n[o+1]=null===(t=s.error)||void 0===t?void 0:t.bind(s),n[o+2]=null===(t=s.complete)||void 0===t?void 0:t.bind(s)):(Kr("Query.onSnapshot","function",o,n[o]),Jr("Query.onSnapshot","function",o+1,n[o+1]),Jr("Query.onSnapshot","function",o+2,n[o+2]));var s={next:function(t){n[o]&&n[o](new Nf(e.firestore,e.hl,t,e.ja))},error:n[o+1],complete:n[o+2]};return If(this.hl),this.firestore.qh().listen(this.hl,i,s)},Lf.prototype.get=function(t){var e=this;Yr("Query.get",arguments,0,1),kf("Query.get",t),If(this.hl);var n=this.firestore.qh();return(t&&"cache"===t.source?n.Rh(this.hl):n.yh(this.hl,t)).then(function(t){return new Nf(e.firestore,e.hl,t,e.ja)})},Lf),Nf=(Object.defineProperty(Df.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(Df.prototype,"empty",{get:function(){return this.fl.docs.m()},enumerable:!1,configurable:!0}),Object.defineProperty(Df.prototype,"size",{get:function(){return this.fl.docs.size},enumerable:!1,configurable:!0}),Df.prototype.forEach=function(e,n){var r=this;Yr("QuerySnapshot.forEach",arguments,1,2),Kr("QuerySnapshot.forEach","function",1,e),this.fl.docs.forEach(function(t){e.call(n,r.ml(t,r.metadata.fromCache,r.fl.Qt.has(t.key)))})},Object.defineProperty(Df.prototype,"query",{get:function(){return new Af(this._l,this.el,this.ja)},enumerable:!1,configurable:!0}),Df.prototype.docChanges=function(t){if(t&&(si("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),$r("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges)),(t=!(!t||!t.includeMetadataChanges))&&this.fl.Wt)throw new Tr(Ir.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.dl&&this.wl===t||(this.dl=function(i,e,o){if(i.Bt.m()){var n=0;return i.docChanges.map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key));return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var s=i.Bt;return i.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=o(t.doc,i.fromCache,i.Qt.has(t.doc.key)),n=-1,r=-1;return 0!==t.type&&(n=s.indexOf(t.doc.key),s=s.delete(t.doc.key)),1!==t.type&&(r=(s=s.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Pr()}}(),doc:e,oldIndex:n,newIndex:r}})}(this.fl,t,this.ml.bind(this)),this.wl=t),this.dl},Df.prototype.isEqual=function(t){if(!(t instanceof Df))throw ui("isEqual","QuerySnapshot",1,t);return this.el===t.el&&Su(this._l,t._l)&&this.fl.isEqual(t.fl)&&this.ja===t.ja},Df.prototype.ml=function(t,e,n){return new hf(this.el,t.key,t,e,n,this.ja)},Df),Rf=(n(Sf,Tf=Af),Object.defineProperty(Sf.prototype,"id",{get:function(){return this.hl.path._()},enumerable:!1,configurable:!0}),Object.defineProperty(Sf.prototype,"parent",{get:function(){var t=this.hl.path.h();return t.m()?null:new sf(new Fr(t),this.firestore,null)},enumerable:!1,configurable:!0}),Object.defineProperty(Sf.prototype,"path",{get:function(){return this.hl.path.R()},enumerable:!1,configurable:!0}),Sf.prototype.doc=function(t){return Yr("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=li.k()),Kr("CollectionReference.doc","non-empty string",1,t),t=Mr.P(t),sf.Xh(this.hl.path.child(t),this.firestore,this.ja)},Sf.prototype.add=function(t){Hr("CollectionReference.add",arguments,1),Kr("CollectionReference.add","object",1,t=this.ja?this.ja.toFirestore(t):t);var e=this.doc();return new sf(e.Qa,this.firestore,null).set(t).then(function(){return e})},Sf.prototype.withConverter=function(t){return new Sf(this.Tl,this.firestore,t)},Sf);function Sf(t,e,n){var r=this;if(((r=Tf.call(this,vu(t),e,n)||this).Tl=t).length%2!=1)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.R()+" has "+t.length);return r}function Df(t,e,n,r){this.el=t,this._l=e,this.fl=n,this.ja=r,this.dl=null,this.wl=null,this.metadata=new uf(n.hasPendingWrites,n.fromCache)}function Lf(t,e,n){this.hl=t,this.firestore=e,this.ja=n}function Of(t,e){if(void 0===e)return{merge:!1};if(si(t,e,["merge","mergeFields"]),$r(t,"boolean","merge",e.merge),void 0!==(n=e.mergeFields)&&function(t,e,n){if(!(n instanceof Array))throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+ii(n));for(var r,i=0;i<n.length;++i)if(!("string"==typeof(r=n[i])||r instanceof Kc))throw new Tr(Ir.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+i+" was: "+ii(n[i]))}(t,"mergeFields",n),void 0!==e.mergeFields&&void 0!==e.merge)throw new Tr(Ir.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n;return e}function Pf(t,e){return void 0===e?{}:(si(t,e,["serverTimestamps"]),ti(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function kf(t,e){Jr(t,"object",1,e),e&&(si(t,e,["source"]),ti(t,0,"source",e.source,["default","server","cache"]))}function _f(t,e,n){if(e instanceof gl){if(e.firestore!==n)throw new Tr(Ir.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw ui(t,"DocumentReference",1,e)}function Uf(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Vf,Cf,l=(n(Mf,Vf=yl),Mf.serverTimestamp=function(){Wr("FieldValue.serverTimestamp",arguments);var t=new cl("serverTimestamp");return t.Da="FieldValue.serverTimestamp",new Mf(t)},Mf.delete=function(){Wr("FieldValue.delete",arguments);var t=new $c("deleteField");return t.Da="FieldValue.delete",new Mf(t)},Mf.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Xr("FieldValue.arrayUnion",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Xr("arrayUnion()",arguments,1),new ll("arrayUnion",t)}.apply(void 0,t);return n.Da="FieldValue.arrayUnion",new Mf(n)},Mf.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Xr("FieldValue.arrayRemove",arguments,1);var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Xr("arrayRemove()",arguments,1),new fl("arrayRemove",t)}.apply(void 0,t);return n.Da="FieldValue.arrayRemove",new Mf(n)},Mf.increment=function(t){return Kr("FieldValue.increment","number",1,t),Hr("FieldValue.increment",arguments,1),(t=new pl("increment",t)).Da="FieldValue.increment",new Mf(t)},Mf.prototype.isEqual=function(t){return this.Ua.isEqual(t.Ua)},Mf),jf={Firestore:nf,GeoPoint:dl,Timestamp:Ri,Blob:Ti,Transaction:rf,WriteBatch:of,DocumentReference:sf,DocumentSnapshot:af,Query:Af,QueryDocumentSnapshot:hf,QuerySnapshot:Nf,CollectionReference:Rf,FieldPath:Kc,FieldValue:l,setLogLevel:nf.setLogLevel,CACHE_SIZE_UNLIMITED:tf};function Mf(){return null!==Vf&&Vf.apply(this,arguments)||this}(Cf=e.default).INTERNAL.registerComponent(new wr("firestore",function(t){return e=t.getProvider("app").getImmediate(),t=t.getProvider("auth-internal"),new nf(e,t,new Wc,new Hc);var e},"PUBLIC").setServiceProps(Object.assign({},jf))),Cf.registerVersion("@firebase/firestore","1.17.3")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
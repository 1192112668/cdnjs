import{Injectable,ComponentFactoryResolver,ApplicationRef,Injector}from"@angular/core";import{DynamicDialogComponent}from"./dynamicdialog";import{DynamicDialogInjector}from"./dynamicdialog-injector";import{DynamicDialogConfig}from"./dynamicdialog-config";import{DynamicDialogRef}from"./dynamicdialog-ref";export class DialogService{constructor(o,e,n){this.componentFactoryResolver=o,this.appRef=e,this.injector=n}open(o,e){const n=this.appendDialogComponentToBody(e);return this.dialogComponentRef.instance.childComponentType=o,n}appendDialogComponentToBody(o){const e=new WeakMap;e.set(DynamicDialogConfig,o);const n=new DynamicDialogRef;e.set(DynamicDialogRef,n);const t=n.onClose.subscribe(()=>{this.dialogComponentRef.instance.close()}),i=n.onDestroy.subscribe(()=>{this.removeDialogComponentFromBody(),i.unsubscribe(),t.unsubscribe()}),a=this.componentFactoryResolver.resolveComponentFactory(DynamicDialogComponent).create(new DynamicDialogInjector(this.injector,e));this.appRef.attachView(a.hostView);const c=a.hostView.rootNodes[0];return document.body.appendChild(c),this.dialogComponentRef=a,n}removeDialogComponentFromBody(){this.appRef.detachView(this.dialogComponentRef.hostView),this.dialogComponentRef.destroy()}};DialogService.decorators=[{type:Injectable}],DialogService.ctorParameters=(()=>[{type:ComponentFactoryResolver},{type:ApplicationRef},{type:Injector}]);
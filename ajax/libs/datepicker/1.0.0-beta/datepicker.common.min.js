"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var $=_interopDefault(require("jquery")),DEFAULTS={autoShow:!1,autoHide:!1,autoPick:!1,inline:!1,container:null,trigger:null,language:"",format:"mm/dd/yyyy",date:null,startDate:null,endDate:null,startView:0,weekStart:0,yearFirst:!1,yearSuffix:"",days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],itemTag:"li",mutedClass:"muted",pickedClass:"picked",disabledClass:"disabled",highlightedClass:"highlighted",template:'<div class="datepicker-container"><div class="datepicker-panel" data-view="years picker"><ul><li data-view="years prev">&lsaquo;</li><li data-view="years current"></li><li data-view="years next">&rsaquo;</li></ul><ul data-view="years"></ul></div><div class="datepicker-panel" data-view="months picker"><ul><li data-view="year prev">&lsaquo;</li><li data-view="year current"></li><li data-view="year next">&rsaquo;</li></ul><ul data-view="months"></ul></div><div class="datepicker-panel" data-view="days picker"><ul><li data-view="month prev">&lsaquo;</li><li data-view="month current"></li><li data-view="month next">&rsaquo;</li></ul><ul data-view="week"></ul><ul data-view="days"></ul></div></div>',offset:10,zIndex:1e3,filter:null,show:null,hide:null,pick:null},WINDOW="undefined"!=typeof window?window:{},NAMESPACE="datepicker",EVENT_CLICK="click."+NAMESPACE,EVENT_FOCUS="focus."+NAMESPACE,EVENT_HIDE="hide."+NAMESPACE,EVENT_KEYUP="keyup."+NAMESPACE,EVENT_PICK="pick."+NAMESPACE,EVENT_RESIZE="resize."+NAMESPACE,EVENT_SHOW="show."+NAMESPACE,CLASS_HIDE=NAMESPACE+"-hide",LANGUAGES={},VIEWS={DAYS:0,MONTHS:1,YEARS:2},toString=Object.prototype.toString;function typeOf(e){return toString.call(e).slice(8,-1).toLowerCase()}function isString(e){return"string"==typeof e}var isNaN=Number.isNaN||WINDOW.isNaN;function isNumber(e){return"number"==typeof e&&!isNaN(e)}function isUndefined(e){return void 0===e}function isDate(e){return"date"===typeOf(e)}function proxy(s,a){for(var e=arguments.length,n=Array(2<e?e-2:0),t=2;t<e;t++)n[t-2]=arguments[t];return function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return s.apply(a,n.concat(t))}}function selectorOf(e){return'[data-view="'+e+'"]'}function isLeapYear(e){return e%4==0&&e%100!=0||e%400==0}function getDaysInMonth(e,t){return[31,isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]}function getMinDay(e,t,i){return Math.min(i,getDaysInMonth(e,t))}var formatParts=/(y|m|d)+/g;function parseFormat(i){var e=String(i).toLowerCase(),t=e.match(formatParts);if(!t||0===t.length)throw new Error("Invalid date format.");return i={source:e,parts:t},$.each(t,function(e,t){switch(t){case"dd":case"d":i.hasDay=!0;break;case"mm":case"m":i.hasMonth=!0;break;case"yyyy":case"yy":i.hasYear=!0}}),i}var REGEXP_DIGITS=/\d+/g,methods={show:function(){this.built||this.build(),this.shown||this.trigger(EVENT_SHOW).isDefaultPrevented()||(this.shown=!0,this.$picker.removeClass(CLASS_HIDE).on(EVENT_CLICK,$.proxy(this.click,this)),this.showView(this.options.startView),this.inline||($(window).on(EVENT_RESIZE,this.onResize=proxy(this.place,this)),$(document).on(EVENT_CLICK,this.onGlobalClick=proxy(this.globalClick,this)),$(document).on(EVENT_KEYUP,this.onGlobalKeyup=proxy(this.globalKeyup,this)),this.place()))},hide:function(){this.shown&&(this.trigger(EVENT_HIDE).isDefaultPrevented()||(this.shown=!1,this.$picker.addClass(CLASS_HIDE).off(EVENT_CLICK,this.click),this.inline||($(window).off(EVENT_RESIZE,this.onResize),$(document).off(EVENT_CLICK,this.onGlobalClick),$(document).off(EVENT_KEYUP,this.onGlobalKeyup))))},toggle:function(){this.shown?this.hide():this.show()},update:function(){var e=this.getValue();e!==this.oldValue&&(this.setDate(e,!0),this.oldValue=e)},pick:function(e){var t=this.$element,i=this.date;this.trigger(EVENT_PICK,{view:e||"",date:i}).isDefaultPrevented()||(i=this.formatDate(this.date),this.setValue(i),this.isInput&&(t.trigger("input"),t.trigger("change")))},reset:function(){this.setDate(this.initialDate,!0),this.setValue(this.initialValue),this.shown&&this.showView(this.options.startView)},getMonthName:function(e,t){var i=this.options,s=i.monthsShort,a=i.months;return $.isNumeric(e)?e=Number(e):isUndefined(t)&&(t=e),!0===t&&(a=s),a[isNumber(e)?e:this.date.getMonth()]},getDayName:function(e,t,i){var s=this.options,a=s.days;return $.isNumeric(e)?e=Number(e):(isUndefined(i)&&(i=t),isUndefined(t)&&(t=e)),i?a=s.daysMin:t&&(a=s.daysShort),a[isNumber(e)?e:this.date.getDay()]},getDate:function(e){var t=this.date;return e?this.formatDate(t):new Date(t)},setDate:function(e,t){var i=this.options.filter;if(isDate(e)||isString(e)){if(e=this.parseDate(e),$.isFunction(i)&&!1===i.call(this.$element,e,"day"))return;this.date=e,this.viewDate=new Date(e),t||this.pick(),this.built&&this.render()}},setStartDate:function(e){isDate(e)||isString(e)?this.startDate=this.parseDate(e):this.startDate=null,this.built&&this.render()},setEndDate:function(e){isDate(e)||isString(e)?this.endDate=this.parseDate(e):this.endDate=null,this.built&&this.render()},parseDate:function(e){var s=this.format,t=[];if(isDate(e))return new Date(e.getFullYear(),e.getMonth(),e.getDate());isString(e)&&(t=e.match(REGEXP_DIGITS)||[]),e=new Date;var i=s.parts.length,a=e.getFullYear(),n=e.getDate(),r=e.getMonth();return t.length===i&&$.each(t,function(e,t){var i=parseInt(t,10)||1;switch(s.parts[e]){case"dd":case"d":n=i;break;case"mm":case"m":r=i-1;break;case"yy":a=2e3+i;break;case"yyyy":a=i}}),new Date(a,r,n)},formatDate:function(e){var t,i,s=this.format,a="";return isDate(e)&&(t=e.getFullYear(),(i={d:e.getDate(),m:e.getMonth()+1,yy:t.toString().substring(2),yyyy:t}).dd=(i.d<10?"0":"")+i.d,i.mm=(i.m<10?"0":"")+i.m,a=s.source,$.each(s.parts,function(e,t){a=a.replace(t,i[t])})),a},destroy:function(){this.unbind(),this.unbuild(),this.$element.removeData(NAMESPACE)}},handlers={click:function(e){var t=$(e.target),i=this.options,s=this.viewDate,a=this.format;if(e.stopPropagation(),e.preventDefault(),!t.hasClass("disabled")){var n=t.data("view"),r=s.getFullYear(),h=s.getMonth(),o=s.getDate();switch(n){case"years prev":case"years next":r="years prev"===n?r-10:r+10,this.viewDate=new Date(r,h,getMinDay(r,h,o)),this.renderYears();break;case"year prev":case"year next":r="year prev"===n?r-1:r+1,this.viewDate=new Date(r,h,getMinDay(r,h,o)),this.renderMonths();break;case"year current":a.hasYear&&this.showView(VIEWS.YEARS);break;case"year picked":a.hasMonth?this.showView(VIEWS.MONTHS):(t.addClass(i.pickedClass).siblings().removeClass(i.pickedClass),this.hideView()),this.pick("year");break;case"year":r=parseInt(t.text(),10),this.date=new Date(r,h,getMinDay(r,h,o)),a.hasMonth?(this.viewDate=new Date(this.date),this.showView(VIEWS.MONTHS)):(t.addClass(i.pickedClass).siblings().removeClass(i.pickedClass),this.renderYears(),this.hideView()),this.pick("year");break;case"month prev":case"month next":(h="month prev"===n?h-1:h+1)<0?(--r,h+=12):11<h&&(r+=1,h-=12),this.viewDate=new Date(r,h,getMinDay(r,h,o)),this.renderDays();break;case"month current":a.hasMonth&&this.showView(VIEWS.MONTHS);break;case"month picked":a.hasDay?this.showView(VIEWS.DAYS):(t.addClass(i.pickedClass).siblings().removeClass(i.pickedClass),this.hideView()),this.pick("month");break;case"month":h=$.inArray(t.text(),i.monthsShort),this.date=new Date(r,h,getMinDay(r,h,o)),a.hasDay?(this.viewDate=new Date(r,h,getMinDay(r,h,o)),this.showView(VIEWS.DAYS)):(t.addClass(i.pickedClass).siblings().removeClass(i.pickedClass),this.renderMonths(),this.hideView()),this.pick("month");break;case"day prev":case"day next":case"day":"day prev"===n?--h:"day next"===n&&(h+=1),o=parseInt(t.text(),10),this.date=new Date(r,h,o),this.viewDate=new Date(r,h,o),this.renderDays(),"day"===n&&this.hideView(),this.pick("day");break;case"day picked":this.hideView(),this.pick("day")}}},globalClick:function(e){for(var t=e.target,i=this.element,s=this.$trigger[0],a=!0;t!==document;){if(t===s||t===i){a=!1;break}t=t.parentNode}a&&this.hide()},keyup:function(){this.update()},globalKeyup:function(e){var t=e.target,i=e.key,s=e.keyCode;this.isInput&&t!==this.element&&this.shown&&("Tab"===i||9===s)&&this.hide()}},render={render:function(){this.renderYears(),this.renderMonths(),this.renderDays()},renderWeek:function(){var i=this,s=[],e=this.options,t=e.weekStart,a=e.daysMin,t=parseInt(t,10)%7,a=a.slice(t).concat(a.slice(0,t));$.each(a,function(e,t){s.push(i.createItem({text:t}))}),this.$week.html(s.join(""))},renderYears:function(){for(var e=this.options,t=this.startDate,i=this.endDate,s=e.disabledClass,a=e.filter,n=e.yearSuffix,r=this.viewDate.getFullYear(),h=(new Date).getFullYear(),o=this.date.getFullYear(),l=[],d=!1,u=!1,c=void 0,c=-5;c<=6;c+=1){var p=new Date(r+c,1,1),g=!1;t&&(g=p.getFullYear()<t.getFullYear(),-5===c&&(d=g)),!g&&i&&(g=p.getFullYear()>i.getFullYear(),6===c&&(u=g)),!g&&a&&(g=!1===a.call(this.$element,p,"year"));var f=r+c===o,y=f?"year picked":"year";l.push(this.createItem({picked:f,disabled:g,text:r+c,view:g?"year disabled":y,highlighted:p.getFullYear()===h}))}this.$yearsPrev.toggleClass(s,d),this.$yearsNext.toggleClass(s,u),this.$yearsCurrent.toggleClass(s,!0).html(r+-5+n+" - "+(r+6)+n),this.$years.html(l.join(""))},renderMonths:function(){for(var e=this.options,t=this.startDate,i=this.endDate,s=this.viewDate,a=e.disabledClass||"",n=e.monthsShort,r=$.isFunction(e.filter)&&e.filter,h=s.getFullYear(),o=new Date,l=o.getFullYear(),d=o.getMonth(),u=this.date.getFullYear(),c=this.date.getMonth(),p=[],g=!1,f=!1,y=void 0,y=0;y<=11;y+=1){var m=new Date(h,y,1),v=!1;t&&(v=(g=m.getFullYear()===t.getFullYear())&&m.getMonth()<t.getMonth()),!v&&i&&(v=(f=m.getFullYear()===i.getFullYear())&&m.getMonth()>i.getMonth()),!v&&r&&(v=!1===r.call(this.$element,m,"month"));var E=h===u&&y===c,D=E?"month picked":"month";p.push(this.createItem({disabled:v,picked:E,highlighted:h===l&&m.getMonth()===d,index:y,text:n[y],view:v?"month disabled":D}))}this.$yearPrev.toggleClass(a,g),this.$yearNext.toggleClass(a,f),this.$yearCurrent.toggleClass(a,g&&f).html(h+e.yearSuffix||""),this.$months.html(p.join(""))},renderDays:function(){var e=this.$element,t=this.options,i=this.startDate,s=this.endDate,a=this.viewDate,n=this.date,r=t.disabledClass,h=t.filter,o=t.monthsShort,l=t.weekStart,d=t.yearSuffix,u=a.getFullYear(),c=a.getMonth(),p=new Date,g=p.getFullYear(),f=p.getMonth(),y=p.getDate(),m=n.getFullYear(),v=n.getMonth(),E=n.getDate(),D=void 0,w=void 0,S=void 0,C=[],k=u,$=c,T=!1;0===c?(--k,$=11):--$,D=getDaysInMonth(k,$);var A=new Date(u,c,1);for((S=A.getDay()-parseInt(l,10)%7)<=0&&(S+=7),i&&(T=A.getTime()<=i.getTime()),w=D-(S-1);w<=D;w+=1){var N=new Date(k,$,w),b=!1;i&&(b=N.getTime()<i.getTime()),!b&&h&&(b=!1===h.call(e,N,"day")),C.push(this.createItem({disabled:b,highlighted:k===g&&$===f&&N.getDate()===y,muted:!0,picked:k===m&&$===v&&w===E,text:w,view:"day prev"}))}var I=[],M=u,V=c,_=!1;11===c?(M+=1,V=0):V+=1,D=getDaysInMonth(u,c),S=42-(C.length+D);var P=new Date(u,c,D);for(s&&(_=P.getTime()>=s.getTime()),w=1;w<=S;w+=1){var O=new Date(M,V,w),x=M===m&&V===v&&w===E,F=!1;s&&(F=O.getTime()>s.getTime()),!F&&h&&(F=!1===h.call(e,O,"day")),I.push(this.createItem({disabled:F,picked:x,highlighted:M===g&&V===f&&O.getDate()===y,muted:!0,text:w,view:"day next"}))}for(var L=[],w=1;w<=D;w+=1){var Y=new Date(u,c,w),H=!1;i&&(H=Y.getTime()<i.getTime()),!H&&s&&(H=Y.getTime()>s.getTime()),!H&&h&&(H=!1===h.call(e,Y,"day"));var W=u===m&&c===v&&w===E,K=W?"day picked":"day";L.push(this.createItem({disabled:H,picked:W,highlighted:u===g&&c===f&&Y.getDate()===y,text:w,view:H?"day disabled":K}))}this.$monthPrev.toggleClass(r,T),this.$monthNext.toggleClass(r,_),this.$monthCurrent.toggleClass(r,T&&_).html(t.yearFirst?u+d+" "+o[c]:o[c]+" "+u+d),this.$days.html(C.join("")+L.join("")+I.join(""))}},_createClass=function(){function s(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(e,t,i){return t&&s(e.prototype,t),i&&s(e,i),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var AnotherDatepicker,CLASS_TOP_LEFT=NAMESPACE+"-top-left",CLASS_TOP_RIGHT=NAMESPACE+"-top-right",CLASS_BOTTOM_LEFT=NAMESPACE+"-bottom-left",CLASS_BOTTOM_RIGHT=NAMESPACE+"-bottom-right",CLASS_PLACEMENTS=[CLASS_TOP_LEFT,CLASS_TOP_RIGHT,CLASS_BOTTOM_LEFT,CLASS_BOTTOM_RIGHT].join(" "),Datepicker=function(){function i(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,i),this.$element=$(e),this.element=e,this.options=$.extend({},DEFAULTS,LANGUAGES[t.language],$.isPlainObject(t)&&t),this.built=!1,this.shown=!1,this.isInput=!1,this.inline=!1,this.initialValue="",this.initialDate=null,this.startDate=null,this.endDate=null,this.init()}return _createClass(i,[{key:"init",value:function(){var e=this.$element,t=this.options,i=t.startDate,s=t.endDate,a=t.date;this.$trigger=$(t.trigger),this.isInput=e.is("input")||e.is("textarea"),this.inline=t.inline&&(t.container||!this.isInput),this.format=parseFormat(t.format);var n=this.getValue();this.initialValue=n,this.oldValue=n,a=this.parseDate(a||n),i&&(i=this.parseDate(i),a.getTime()<i.getTime()&&(a=new Date(i)),this.startDate=i),s&&(s=this.parseDate(s),i&&s.getTime()<i.getTime()&&(s=new Date(i)),a.getTime()>s.getTime()&&(a=new Date(s)),this.endDate=s),this.date=a,this.viewDate=new Date(a),this.initialDate=new Date(this.date),this.bind(),(t.autoShow||this.inline)&&this.show(),t.autoPick&&this.pick()}},{key:"build",value:function(){var e,t,i;this.built||(this.built=!0,e=this.$element,t=this.options,i=$(t.template),this.$picker=i,this.$week=i.find(selectorOf("week")),this.$yearsPicker=i.find(selectorOf("years picker")),this.$yearsPrev=i.find(selectorOf("years prev")),this.$yearsNext=i.find(selectorOf("years next")),this.$yearsCurrent=i.find(selectorOf("years current")),this.$years=i.find(selectorOf("years")),this.$monthsPicker=i.find(selectorOf("months picker")),this.$yearPrev=i.find(selectorOf("year prev")),this.$yearNext=i.find(selectorOf("year next")),this.$yearCurrent=i.find(selectorOf("year current")),this.$months=i.find(selectorOf("months")),this.$daysPicker=i.find(selectorOf("days picker")),this.$monthPrev=i.find(selectorOf("month prev")),this.$monthNext=i.find(selectorOf("month next")),this.$monthCurrent=i.find(selectorOf("month current")),this.$days=i.find(selectorOf("days")),this.inline?$(t.container||e).append(i.addClass(NAMESPACE+"-inline")):($(document.body).append(i.addClass(NAMESPACE+"-dropdown")),i.addClass(CLASS_HIDE)),this.renderWeek())}},{key:"unbuild",value:function(){this.built&&(this.built=!1,this.$picker.remove())}},{key:"bind",value:function(){var e=this.options,t=this.$element;$.isFunction(e.show)&&t.on(EVENT_SHOW,e.show),$.isFunction(e.hide)&&t.on(EVENT_HIDE,e.hide),$.isFunction(e.pick)&&t.on(EVENT_PICK,e.pick),this.isInput&&t.on(EVENT_KEYUP,$.proxy(this.keyup,this)),this.inline||(e.trigger?this.$trigger.on(EVENT_CLICK,$.proxy(this.toggle,this)):this.isInput?t.on(EVENT_FOCUS,$.proxy(this.show,this)):t.on(EVENT_CLICK,$.proxy(this.show,this)))}},{key:"unbind",value:function(){var e=this.$element,t=this.options;$.isFunction(t.show)&&e.off(EVENT_SHOW,t.show),$.isFunction(t.hide)&&e.off(EVENT_HIDE,t.hide),$.isFunction(t.pick)&&e.off(EVENT_PICK,t.pick),this.isInput&&e.off(EVENT_KEYUP,this.keyup),this.inline||(t.trigger?this.$trigger.off(EVENT_CLICK,this.toggle):this.isInput?e.off(EVENT_FOCUS,this.show):e.off(EVENT_CLICK,this.show))}},{key:"showView",value:function(e){var t=this.$yearsPicker,i=this.$monthsPicker,s=this.$daysPicker,a=this.format;if(a.hasYear||a.hasMonth||a.hasDay)switch(Number(e)){case VIEWS.YEARS:i.addClass(CLASS_HIDE),s.addClass(CLASS_HIDE),a.hasYear?(this.renderYears(),t.removeClass(CLASS_HIDE),this.place()):this.showView(VIEWS.DAYS);break;case VIEWS.MONTHS:t.addClass(CLASS_HIDE),s.addClass(CLASS_HIDE),a.hasMonth?(this.renderMonths(),i.removeClass(CLASS_HIDE),this.place()):this.showView(VIEWS.YEARS);break;default:t.addClass(CLASS_HIDE),i.addClass(CLASS_HIDE),a.hasDay?(this.renderDays(),s.removeClass(CLASS_HIDE),this.place()):this.showView(VIEWS.MONTHS)}}},{key:"hideView",value:function(){!this.inline&&this.options.autoHide&&this.hide()}},{key:"place",value:function(){var e,t,i,s,a,n,r,h,o,l,d,u,c,p;this.inline||(e=this.$element,t=this.options,i=this.$picker,s=$(document).outerWidth(),a=$(document).outerHeight(),n=e.outerWidth(),r=e.outerHeight(),h=i.width(),o=i.height(),d=(l=e.offset()).left,u=l.top,c=parseFloat(t.offset),p=CLASS_TOP_LEFT,isNaN(c)&&(c=10),o<u&&a<u+r+o?(u-=o+c,p=CLASS_BOTTOM_LEFT):u+=r+c,s<d+h&&(d+=n-h,p=p.replace("left","right")),i.removeClass(CLASS_PLACEMENTS).addClass(p).css({top:u,left:d,zIndex:parseInt(t.zIndex,10)}))}},{key:"trigger",value:function(e,t){var i=$.Event(e,t);return this.$element.trigger(i),i}},{key:"createItem",value:function(e){var t=this.options,i=t.itemTag,s={text:"",view:"",muted:!1,picked:!1,disabled:!1,highlighted:!1},a=[];return $.extend(s,e),s.muted&&a.push(t.mutedClass),s.highlighted&&a.push(t.highlightedClass),s.picked&&a.push(t.pickedClass),s.disabled&&a.push(t.disabledClass),"<"+i+' class="'+a.join(" ")+'" data-view="'+s.view+'">'+s.text+"</"+i+">"}},{key:"getValue",value:function(){var e=this.$element;return this.isInput?e.val():e.text()}},{key:"setValue",value:function(e){var t=0<arguments.length&&void 0!==e?e:"",i=this.$element;this.isInput?i.val(t):i.text(t)}}],[{key:"setDefaults",value:function(e){var t=0<arguments.length&&void 0!==e?e:{};$.extend(DEFAULTS,LANGUAGES[t.language],$.isPlainObject(t)&&t)}}]),i}();$.extend&&$.extend(Datepicker.prototype,render,handlers,methods),$.fn&&(AnotherDatepicker=$.fn.datepicker,$.fn.datepicker=function(h){for(var e=arguments.length,o=Array(1<e?e-1:0),t=1;t<e;t++)o[t-1]=arguments[t];var l=void 0;return this.each(function(e,t){var i,s=$(t),a="destroy"===h;if(!(r=s.data(NAMESPACE))){if(a)return;var n=$.extend({},s.data(),$.isPlainObject(h)&&h),r=new Datepicker(t,n);s.data(NAMESPACE,r)}isString(h)&&(i=r[h],$.isFunction(i)&&(l=i.apply(r,o),a&&s.removeData(NAMESPACE)))}),isUndefined(l)?this:l},$.fn.datepicker.Constructor=Datepicker,$.fn.datepicker.languages=LANGUAGES,$.fn.datepicker.setDefaults=Datepicker.setDefaults,$.fn.datepicker.noConflict=function(){return $.fn.datepicker=AnotherDatepicker,this});
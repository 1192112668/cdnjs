"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _enzymeShallowEqual=_interopRequireDefault(require("enzyme-shallow-equal")),_slicedToArray2=_interopRequireDefault(require("@babel/runtime/helpers/slicedToArray")),_defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty")),_assertThisInitialized2=_interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized")),_inheritsLoose2=_interopRequireDefault(require("@babel/runtime/helpers/inheritsLoose")),_react=_interopRequireDefault(require("react")),_propTypes=_interopRequireDefault(require("prop-types")),_reactMomentProptypes=_interopRequireDefault(require("react-moment-proptypes")),_airbnbPropTypes=require("airbnb-prop-types"),_moment=_interopRequireDefault(require("moment")),_object=_interopRequireDefault(require("object.values")),_isTouchDevice=_interopRequireDefault(require("is-touch-device")),_defaultPhrases=require("../defaultPhrases"),_getPhrasePropTypes=_interopRequireDefault(require("../utils/getPhrasePropTypes")),_isInclusivelyAfterDay=_interopRequireDefault(require("../utils/isInclusivelyAfterDay")),_isNextDay=_interopRequireDefault(require("../utils/isNextDay")),_isSameDay=_interopRequireDefault(require("../utils/isSameDay")),_isAfterDay=_interopRequireDefault(require("../utils/isAfterDay")),_isBeforeDay=_interopRequireDefault(require("../utils/isBeforeDay")),_isPreviousDay=_interopRequireDefault(require("../utils/isPreviousDay")),_getVisibleDays=_interopRequireDefault(require("../utils/getVisibleDays")),_isDayVisible=_interopRequireDefault(require("../utils/isDayVisible")),_getSelectedDateOffset=_interopRequireDefault(require("../utils/getSelectedDateOffset")),_toISODateString=_interopRequireDefault(require("../utils/toISODateString")),_modifiers=require("../utils/modifiers"),_DisabledShape=_interopRequireDefault(require("../shapes/DisabledShape")),_FocusedInputShape=_interopRequireDefault(require("../shapes/FocusedInputShape")),_ScrollableOrientationShape=_interopRequireDefault(require("../shapes/ScrollableOrientationShape")),_DayOfWeekShape=_interopRequireDefault(require("../shapes/DayOfWeekShape")),_CalendarInfoPositionShape=_interopRequireDefault(require("../shapes/CalendarInfoPositionShape")),_NavPositionShape=_interopRequireDefault(require("../shapes/NavPositionShape")),_constants=require("../constants"),_DayPicker=_interopRequireDefault(require("./DayPicker")),_getPooledMoment=_interopRequireDefault(require("../utils/getPooledMoment"));function ownKeys(t,e){var a,i=Object.keys(t);return Object.getOwnPropertySymbols&&(a=Object.getOwnPropertySymbols(t),e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,a)),i}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(a),!0).forEach(function(e){(0,_defineProperty2.default)(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):ownKeys(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}var propTypes="production"!==process.env.NODE_ENV?(0,_airbnbPropTypes.forbidExtraProps)({startDate:_reactMomentProptypes.default.momentObj,endDate:_reactMomentProptypes.default.momentObj,onDatesChange:_propTypes.default.func,startDateOffset:_propTypes.default.func,endDateOffset:_propTypes.default.func,minDate:_reactMomentProptypes.default.momentObj,maxDate:_reactMomentProptypes.default.momentObj,focusedInput:_FocusedInputShape.default,onFocusChange:_propTypes.default.func,onClose:_propTypes.default.func,keepOpenOnDateSelect:_propTypes.default.bool,minimumNights:_propTypes.default.number,disabled:_DisabledShape.default,isOutsideRange:_propTypes.default.func,isDayBlocked:_propTypes.default.func,isDayHighlighted:_propTypes.default.func,getMinNightsForHoverDate:_propTypes.default.func,renderMonthText:(0,_airbnbPropTypes.mutuallyExclusiveProps)(_propTypes.default.func,"renderMonthText","renderMonthElement"),renderMonthElement:(0,_airbnbPropTypes.mutuallyExclusiveProps)(_propTypes.default.func,"renderMonthText","renderMonthElement"),renderWeekHeaderElement:_propTypes.default.func,enableOutsideDays:_propTypes.default.bool,numberOfMonths:_propTypes.default.number,orientation:_ScrollableOrientationShape.default,withPortal:_propTypes.default.bool,initialVisibleMonth:_propTypes.default.func,hideKeyboardShortcutsPanel:_propTypes.default.bool,daySize:_airbnbPropTypes.nonNegativeInteger,noBorder:_propTypes.default.bool,verticalBorderSpacing:_airbnbPropTypes.nonNegativeInteger,horizontalMonthPadding:_airbnbPropTypes.nonNegativeInteger,dayPickerNavigationInlineStyles:_propTypes.default.object,navPosition:_NavPositionShape.default,navPrev:_propTypes.default.node,navNext:_propTypes.default.node,renderNavPrevButton:_propTypes.default.func,renderNavNextButton:_propTypes.default.func,noNavButtons:_propTypes.default.bool,onPrevMonthClick:_propTypes.default.func,onNextMonthClick:_propTypes.default.func,onOutsideClick:_propTypes.default.func,renderCalendarDay:_propTypes.default.func,renderDayContents:_propTypes.default.func,renderCalendarInfo:_propTypes.default.func,renderKeyboardShortcutsButton:_propTypes.default.func,renderKeyboardShortcutsPanel:_propTypes.default.func,calendarInfoPosition:_CalendarInfoPositionShape.default,firstDayOfWeek:_DayOfWeekShape.default,verticalHeight:_airbnbPropTypes.nonNegativeInteger,transitionDuration:_airbnbPropTypes.nonNegativeInteger,onBlur:_propTypes.default.func,isFocused:_propTypes.default.bool,showKeyboardShortcuts:_propTypes.default.bool,onTab:_propTypes.default.func,onShiftTab:_propTypes.default.func,monthFormat:_propTypes.default.string,weekDayFormat:_propTypes.default.string,phrases:_propTypes.default.shape((0,_getPhrasePropTypes.default)(_defaultPhrases.DayPickerPhrases)),dayAriaLabelFormat:_propTypes.default.string,isRTL:_propTypes.default.bool}):{},defaultProps={startDate:void 0,endDate:void 0,minDate:null,maxDate:null,onDatesChange:function(){},startDateOffset:void 0,endDateOffset:void 0,focusedInput:null,onFocusChange:function(){},onClose:function(){},keepOpenOnDateSelect:!1,minimumNights:1,disabled:!1,isOutsideRange:function(){},isDayBlocked:function(){},isDayHighlighted:function(){},getMinNightsForHoverDate:function(){},renderMonthText:null,renderWeekHeaderElement:null,enableOutsideDays:!1,numberOfMonths:1,orientation:_constants.HORIZONTAL_ORIENTATION,withPortal:!1,hideKeyboardShortcutsPanel:!1,initialVisibleMonth:null,daySize:_constants.DAY_SIZE,dayPickerNavigationInlineStyles:null,navPosition:_constants.NAV_POSITION_TOP,navPrev:null,navNext:null,renderNavPrevButton:null,renderNavNextButton:null,noNavButtons:!1,onPrevMonthClick:function(){},onNextMonthClick:function(){},onOutsideClick:function(){},renderCalendarDay:void 0,renderDayContents:null,renderCalendarInfo:null,renderMonthElement:null,renderKeyboardShortcutsButton:void 0,renderKeyboardShortcutsPanel:void 0,calendarInfoPosition:_constants.INFO_POSITION_BOTTOM,firstDayOfWeek:null,verticalHeight:null,noBorder:!1,transitionDuration:void 0,verticalBorderSpacing:void 0,horizontalMonthPadding:13,onBlur:function(){},isFocused:!1,showKeyboardShortcuts:!1,onTab:function(){},onShiftTab:function(){},monthFormat:"MMMM YYYY",weekDayFormat:"dd",phrases:_defaultPhrases.DayPickerPhrases,dayAriaLabelFormat:void 0,isRTL:!1},getChooseAvailableDatePhrase=function(e,t){return t===_constants.START_DATE?e.chooseAvailableStartDate:t===_constants.END_DATE?e.chooseAvailableEndDate:e.chooseAvailableDate},DayPickerRangeController=function(o){(0,_inheritsLoose2.default)(t,o);var e=t.prototype;function t(t){var a=o.call(this,t)||this;a.isTouchDevice=(0,_isTouchDevice.default)(),a.today=(0,_moment.default)(),a.modifiers={today:function(e){return a.isToday(e)},blocked:function(e){return a.isBlocked(e)},"blocked-calendar":function(e){return t.isDayBlocked(e)},"blocked-out-of-range":function(e){return t.isOutsideRange(e)},"highlighted-calendar":function(e){return t.isDayHighlighted(e)},valid:function(e){return!a.isBlocked(e)},"selected-start":function(e){return a.isStartDate(e)},"selected-end":function(e){return a.isEndDate(e)},"blocked-minimum-nights":function(e){return a.doesNotMeetMinimumNights(e)},"selected-span":function(e){return a.isInSelectedSpan(e)},"last-in-range":function(e){return a.isLastInRange(e)},hovered:function(e){return a.isHovered(e)},"hovered-span":function(e){return a.isInHoveredSpan(e)},"hovered-offset":function(e){return a.isInHoveredSpan(e)},"after-hovered-start":function(e){return a.isDayAfterHoveredStartDate(e)},"first-day-of-week":function(e){return a.isFirstDayOfWeek(e)},"last-day-of-week":function(e){return a.isLastDayOfWeek(e)},"hovered-start-first-possible-end":function(e,t){return a.isFirstPossibleEndDateForHoveredStartDate(e,t)},"hovered-start-blocked-minimum-nights":function(e,t){return a.doesNotMeetMinNightsForHoveredStartDate(e,t)},"before-hovered-end":function(e){return a.isDayBeforeHoveredEndDate(e)},"no-selected-start-before-selected-end":function(e){return a.beforeSelectedEnd(e)&&!t.startDate},"selected-start-in-hovered-span":function(e,t){return a.isStartDate(e)&&(0,_isAfterDay.default)(t,e)},"selected-start-no-selected-end":function(e){return a.isStartDate(e)&&!t.endDate},"selected-end-no-selected-start":function(e){return a.isEndDate(e)&&!t.startDate}};var e=a.getStateForNewMonth(t),i=e.currentMonth,n=e.visibleDays,r=getChooseAvailableDatePhrase(t.phrases,t.focusedInput);return a.state={hoverDate:null,currentMonth:i,phrases:_objectSpread({},t.phrases,{chooseAvailableDate:r}),visibleDays:n,disablePrev:a.shouldDisableMonthNavigation(t.minDate,i),disableNext:a.shouldDisableMonthNavigation(t.maxDate,i)},a.onDayClick=a.onDayClick.bind((0,_assertThisInitialized2.default)(a)),a.onDayMouseEnter=a.onDayMouseEnter.bind((0,_assertThisInitialized2.default)(a)),a.onDayMouseLeave=a.onDayMouseLeave.bind((0,_assertThisInitialized2.default)(a)),a.onPrevMonthClick=a.onPrevMonthClick.bind((0,_assertThisInitialized2.default)(a)),a.onNextMonthClick=a.onNextMonthClick.bind((0,_assertThisInitialized2.default)(a)),a.onMonthChange=a.onMonthChange.bind((0,_assertThisInitialized2.default)(a)),a.onYearChange=a.onYearChange.bind((0,_assertThisInitialized2.default)(a)),a.onMultiplyScrollableMonths=a.onMultiplyScrollableMonths.bind((0,_assertThisInitialized2.default)(a)),a.getFirstFocusableDay=a.getFirstFocusableDay.bind((0,_assertThisInitialized2.default)(a)),a}return e[!_react.default.PureComponent&&"shouldComponentUpdate"]=function(e,t){return!(0,_enzymeShallowEqual.default)(this.props,e)||!(0,_enzymeShallowEqual.default)(this.state,t)},e.componentWillReceiveProps=function(e){var i=this,t=e.startDate,a=e.endDate,n=e.focusedInput,r=e.getMinNightsForHoverDate,o=e.minimumNights,s=e.isOutsideRange,d=e.isDayBlocked,l=e.isDayHighlighted,u=e.phrases,f=e.initialVisibleMonth,c=e.numberOfMonths,h=e.enableOutsideDays,p=this.props,D=p.startDate,y=p.endDate,_=p.focusedInput,b=p.minimumNights,v=p.isOutsideRange,m=p.isDayBlocked,M=p.isDayHighlighted,g=p.phrases,T=p.initialVisibleMonth,S=p.numberOfMonths,O=p.enableOutsideDays,P=this.state.hoverDate,k=this.state.visibleDays,N=!1,R=!1,E=!1;s!==v&&(this.modifiers["blocked-out-of-range"]=function(e){return s(e)},N=!0),d!==m&&(this.modifiers["blocked-calendar"]=function(e){return d(e)},R=!0),l!==M&&(this.modifiers["highlighted-calendar"]=function(e){return l(e)},E=!0);var C,B,I=N||R||E,A=t!==D,F=a!==y,q=n!==_;(c!==S||h!==O||f!==T&&!_&&q)&&(B=(C=this.getStateForNewMonth(e)).currentMonth,k=C.visibleDays,this.setState({currentMonth:B,visibleDays:k}));var x,j,w,H,L,z,V,W,K={};A&&(K=this.deleteModifier(K,D,"selected-start"),K=this.addModifier(K,t,"selected-start"),D&&(x=D.clone().add(1,"day"),j=D.clone().add(b+1,"days"),K=this.deleteModifierFromRange(K,x,j,"after-hovered-start"),a&&y||(K=this.deleteModifier(K,D,"selected-start-no-selected-end"))),!D&&a&&t&&(K=this.deleteModifier(K,a,"selected-end-no-selected-start"),K=this.deleteModifier(K,a,"selected-end-in-hovered-span"),(0,_object.default)(k).forEach(function(e){Object.keys(e).forEach(function(e){var t=(0,_moment.default)(e);K=i.deleteModifier(K,t,"no-selected-start-before-selected-end")})}))),F&&(K=this.deleteModifier(K,y,"selected-end"),K=this.addModifier(K,a,"selected-end"),!y||t&&D||(K=this.deleteModifier(K,y,"selected-end-no-selected-start"))),(A||F)&&(D&&y&&(K=this.deleteModifierFromRange(K,D,y.clone().add(1,"day"),"selected-span")),t&&a&&(K=this.deleteModifierFromRange(K,t,a.clone().add(1,"day"),"hovered-span"),K=this.addModifierToRange(K,t.clone().add(1,"day"),a,"selected-span")),t&&!a&&(K=this.addModifier(K,t,"selected-start-no-selected-end")),a&&!t&&(K=this.addModifier(K,a,"selected-end-no-selected-start")),!t&&a&&(0,_object.default)(k).forEach(function(e){Object.keys(e).forEach(function(e){var t=(0,_moment.default)(e);(0,_isBeforeDay.default)(t,a)&&(K=i.addModifier(K,t,"no-selected-start-before-selected-end"))})})),!this.isTouchDevice&&A&&t&&!a&&(w=t.clone().add(1,"day"),H=t.clone().add(o+1,"days"),K=this.addModifierToRange(K,w,H,"after-hovered-start")),!this.isTouchDevice&&F&&!t&&a&&(L=a.clone().subtract(o,"days"),z=a.clone(),K=this.addModifierToRange(K,L,z,"before-hovered-end")),0<b&&(q||A||o!==b)&&(V=D||this.today,K=this.deleteModifierFromRange(K,V,V.clone().add(b,"days"),"blocked-minimum-nights"),K=this.deleteModifierFromRange(K,V,V.clone().add(b,"days"),"blocked")),(q||I)&&(0,_object.default)(k).forEach(function(e){Object.keys(e).forEach(function(e){var t=(0,_getPooledMoment.default)(e),a=!1;(q||N)&&(s(t)?(K=i.addModifier(K,t,"blocked-out-of-range"),a=!0):K=i.deleteModifier(K,t,"blocked-out-of-range")),(q||R)&&(d(t)?(K=i.addModifier(K,t,"blocked-calendar"),a=!0):K=i.deleteModifier(K,t,"blocked-calendar")),K=a?i.addModifier(K,t,"blocked"):i.deleteModifier(K,t,"blocked"),(q||E)&&(K=l(t)?i.addModifier(K,t,"highlighted-calendar"):i.deleteModifier(K,t,"highlighted-calendar"))})}),!this.isTouchDevice&&q&&P&&!this.isBlocked(P)&&(0<(W=r(P))&&n===_constants.END_DATE&&(K=this.deleteModifierFromRange(K,P.clone().add(1,"days"),P.clone().add(W,"days"),"hovered-start-blocked-minimum-nights"),K=this.deleteModifier(K,P.clone().add(W,"days"),"hovered-start-first-possible-end")),0<W&&n===_constants.START_DATE&&(K=this.addModifierToRange(K,P.clone().add(1,"days"),P.clone().add(W,"days"),"hovered-start-blocked-minimum-nights"),K=this.addModifier(K,P.clone().add(W,"days"),"hovered-start-first-possible-end"))),0<o&&t&&n===_constants.END_DATE&&(K=this.addModifierToRange(K,t,t.clone().add(o,"days"),"blocked-minimum-nights"),K=this.addModifierToRange(K,t,t.clone().add(o,"days"),"blocked"));var Y,Z=(0,_moment.default)();(0,_isSameDay.default)(this.today,Z)||(K=this.deleteModifier(K,this.today,"today"),K=this.addModifier(K,Z,"today"),this.today=Z),0<Object.keys(K).length&&this.setState({visibleDays:_objectSpread({},k,{},K)}),!q&&u===g||(Y=getChooseAvailableDatePhrase(u,n),this.setState({phrases:_objectSpread({},u,{chooseAvailableDate:Y})}))},e.onDayClick=function(e,t){var a=this.props,i=a.keepOpenOnDateSelect,n=a.minimumNights,r=a.onBlur,o=a.focusedInput,s=a.onFocusChange,d=a.onClose,l=a.onDatesChange,u=a.startDateOffset,f=a.endDateOffset,c=a.disabled;if(t&&t.preventDefault(),!this.isBlocked(e)){var h,p,D,y,_=this.props,b=_.startDate,v=_.endDate;if(u||f){if(b=(0,_getSelectedDateOffset.default)(u,e),v=(0,_getSelectedDateOffset.default)(f,e),this.isBlocked(b)||this.isBlocked(v))return;l({startDate:b,endDate:v}),i||(s(null),d({startDate:b,endDate:v}))}else{o===_constants.START_DATE?(h=v&&v.clone().subtract(n,"days"),p=(0,_isBeforeDay.default)(h,e)||(0,_isAfterDay.default)(b,v),(D=c===_constants.END_DATE)&&p||(b=e,p&&(v=null)),l({startDate:b,endDate:v}),D&&!p?(s(null),d({startDate:b,endDate:v})):D||s(_constants.END_DATE)):o===_constants.END_DATE?(y=b&&b.clone().add(n,"days"),b?(0,_isInclusivelyAfterDay.default)(e,y)?(l({startDate:b,endDate:v=e}),i||(s(null),d({startDate:b,endDate:v}))):c!==_constants.START_DATE?l({startDate:b=e,endDate:v=null}):l({startDate:b,endDate:v}):(l({startDate:b,endDate:v=e}),s(_constants.START_DATE))):l({startDate:b,endDate:v})}r()}},e.onDayMouseEnter=function(e){var t,a,i,n,r,o,s,d,l,u,f,c,h,p,D,y,_,b,v,m,M,g,T,S,O,P,k;this.isTouchDevice||(a=(t=this.props).startDate,i=t.endDate,n=t.focusedInput,r=t.getMinNightsForHoverDate,o=t.minimumNights,s=t.startDateOffset,d=t.endDateOffset,u=(l=this.state).hoverDate,f=l.visibleDays,c=l.dateOffset,y=null,n&&(b={},(h=s||d)&&(y={start:p=(0,_getSelectedDateOffset.default)(s,e),end:D=(0,_getSelectedDateOffset.default)(d,e,function(e){return e.add(1,"day")})},c&&c.start&&c.end&&(b=this.deleteModifierFromRange(b,c.start,c.end,"hovered-offset")),b=this.addModifierToRange(b,p,D,"hovered-offset")),h||(b=this.deleteModifier(b,u,"hovered"),b=this.addModifier(b,e,"hovered"),a&&!i&&n===_constants.END_DATE&&((0,_isAfterDay.default)(u,a)&&(_=u.clone().add(1,"day"),b=this.deleteModifierFromRange(b,a,_,"hovered-span")),((0,_isBeforeDay.default)(e,a)||(0,_isSameDay.default)(e,a))&&(b=this.deleteModifier(b,a,"selected-start-in-hovered-span")),!this.isBlocked(e)&&(0,_isAfterDay.default)(e,a)&&(v=e.clone().add(1,"day"),b=this.addModifierToRange(b,a,v,"hovered-span"),b=this.addModifier(b,a,"selected-start-in-hovered-span"))),!a&&i&&n===_constants.START_DATE&&((0,_isBeforeDay.default)(u,i)&&(b=this.deleteModifierFromRange(b,u,i,"hovered-span")),((0,_isAfterDay.default)(e,i)||(0,_isSameDay.default)(e,i))&&(b=this.deleteModifier(b,i,"selected-end-in-hovered-span")),!this.isBlocked(e)&&(0,_isBeforeDay.default)(e,i)&&(b=this.addModifierToRange(b,e,i,"hovered-span"),b=this.addModifier(b,i,"selected-end-in-hovered-span"))),a&&(m=a.clone().add(1,"day"),M=a.clone().add(o+1,"days"),b=this.deleteModifierFromRange(b,m,M,"after-hovered-start"),(0,_isSameDay.default)(e,a)&&(g=a.clone().add(1,"day"),T=a.clone().add(o+1,"days"),b=this.addModifierToRange(b,g,T,"after-hovered-start"))),i&&(S=i.clone().subtract(o,"days"),b=this.deleteModifierFromRange(b,S,i,"before-hovered-end"),(0,_isSameDay.default)(e,i)&&(O=i.clone().subtract(o,"days"),b=this.addModifierToRange(b,O,i,"before-hovered-end"))),!u||this.isBlocked(u)||0<(P=r(u))&&n===_constants.START_DATE&&(b=this.deleteModifierFromRange(b,u.clone().add(1,"days"),u.clone().add(P,"days"),"hovered-start-blocked-minimum-nights"),b=this.deleteModifier(b,u.clone().add(P,"days"),"hovered-start-first-possible-end")),this.isBlocked(e)||0<(k=r(e))&&n===_constants.START_DATE&&(b=this.addModifierToRange(b,e.clone().add(1,"days"),e.clone().add(k,"days"),"hovered-start-blocked-minimum-nights"),b=this.addModifier(b,e.clone().add(k,"days"),"hovered-start-first-possible-end"))),this.setState({hoverDate:e,dateOffset:y,visibleDays:_objectSpread({},f,{},b)})))},e.onDayMouseLeave=function(e){var t,a,i,n,r,o,s=this.props,d=s.startDate,l=s.endDate,u=s.focusedInput,f=s.getMinNightsForHoverDate,c=s.minimumNights,h=this.state,p=h.hoverDate,D=h.visibleDays,y=h.dateOffset;!this.isTouchDevice&&p&&(a={},a=this.deleteModifier(a,p,"hovered"),y&&(a=this.deleteModifierFromRange(a,y.start,y.end,"hovered-offset")),d&&!l&&((0,_isAfterDay.default)(p,d)&&(t=p.clone().add(1,"day"),a=this.deleteModifierFromRange(a,d,t,"hovered-span")),(0,_isAfterDay.default)(e,d)&&(a=this.deleteModifier(a,d,"selected-start-in-hovered-span"))),!d&&l&&((0,_isAfterDay.default)(l,p)&&(a=this.deleteModifierFromRange(a,p,l,"hovered-span")),(0,_isBeforeDay.default)(e,l)&&(a=this.deleteModifier(a,l,"selected-end-in-hovered-span"))),d&&(0,_isSameDay.default)(e,d)&&(i=d.clone().add(1,"day"),n=d.clone().add(c+1,"days"),a=this.deleteModifierFromRange(a,i,n,"after-hovered-start")),l&&(0,_isSameDay.default)(e,l)&&(r=l.clone().subtract(c,"days"),a=this.deleteModifierFromRange(a,r,l,"before-hovered-end")),this.isBlocked(p)||0<(o=f(p))&&u===_constants.START_DATE&&(a=this.deleteModifierFromRange(a,p.clone().add(1,"days"),p.clone().add(o,"days"),"hovered-start-blocked-minimum-nights"),a=this.deleteModifier(a,p.clone().add(o,"days"),"hovered-start-first-possible-end")),this.setState({hoverDate:null,visibleDays:_objectSpread({},D,{},a)}))},e.onPrevMonthClick=function(){var e=this.props,t=e.enableOutsideDays,a=e.maxDate,i=e.minDate,n=e.numberOfMonths,r=e.onPrevMonthClick,o=this.state,s=o.currentMonth,d=o.visibleDays,l={};Object.keys(d).sort().slice(0,n+1).forEach(function(e){l[e]=d[e]});var u=s.clone().subtract(2,"months"),f=(0,_getVisibleDays.default)(u,1,t,!0),c=s.clone().subtract(1,"month");this.setState({currentMonth:c,disablePrev:this.shouldDisableMonthNavigation(i,c),disableNext:this.shouldDisableMonthNavigation(a,c),visibleDays:_objectSpread({},l,{},this.getModifiers(f))},function(){r(c.clone())})},e.onNextMonthClick=function(){var e=this.props,t=e.enableOutsideDays,a=e.maxDate,i=e.minDate,n=e.numberOfMonths,r=e.onNextMonthClick,o=this.state,s=o.currentMonth,d=o.visibleDays,l={};Object.keys(d).sort().slice(1).forEach(function(e){l[e]=d[e]});var u=s.clone().add(n+1,"month"),f=(0,_getVisibleDays.default)(u,1,t,!0),c=s.clone().add(1,"month");this.setState({currentMonth:c,disablePrev:this.shouldDisableMonthNavigation(i,c),disableNext:this.shouldDisableMonthNavigation(a,c),visibleDays:_objectSpread({},l,{},this.getModifiers(f))},function(){r(c.clone())})},e.onMonthChange=function(e){var t=this.props,a=t.numberOfMonths,i=t.enableOutsideDays,n=t.orientation===_constants.VERTICAL_SCROLLABLE,r=(0,_getVisibleDays.default)(e,a,i,n);this.setState({currentMonth:e.clone(),visibleDays:this.getModifiers(r)})},e.onYearChange=function(e){var t=this.props,a=t.numberOfMonths,i=t.enableOutsideDays,n=t.orientation===_constants.VERTICAL_SCROLLABLE,r=(0,_getVisibleDays.default)(e,a,i,n);this.setState({currentMonth:e.clone(),visibleDays:this.getModifiers(r)})},e.onMultiplyScrollableMonths=function(){var e=this.props,t=e.numberOfMonths,a=e.enableOutsideDays,i=this.state,n=i.currentMonth,r=i.visibleDays,o=Object.keys(r).length,s=n.clone().add(o,"month"),d=(0,_getVisibleDays.default)(s,t,a,!0);this.setState({visibleDays:_objectSpread({},r,{},this.getModifiers(d))})},e.getFirstFocusableDay=function(e){var t=this,a=this.props,i=a.startDate,n=a.endDate,r=a.focusedInput,o=a.minimumNights,s=a.numberOfMonths,d=e.clone().startOf("month");if(r===_constants.START_DATE&&i?d=i.clone():r===_constants.END_DATE&&!n&&i?d=i.clone().add(o,"days"):r===_constants.END_DATE&&n&&(d=n.clone()),this.isBlocked(d)){for(var l=[],u=e.clone().add(s-1,"months").endOf("month"),f=d.clone();!(0,_isAfterDay.default)(f,u);)f=f.clone().add(1,"day"),l.push(f);var c=l.filter(function(e){return!t.isBlocked(e)});0<c.length&&(d=(0,_slicedToArray2.default)(c,1)[0])}return d},e.getModifiers=function(e){var a=this,i={};return Object.keys(e).forEach(function(t){i[t]={},e[t].forEach(function(e){i[t][(0,_toISODateString.default)(e)]=a.getModifiersForDay(e)})}),i},e.getModifiersForDay=function(t){var a=this;return new Set(Object.keys(this.modifiers).filter(function(e){return a.modifiers[e](t)}))},e.getStateForNewMonth=function(e){var t=this,a=e.initialVisibleMonth,i=e.numberOfMonths,n=e.enableOutsideDays,r=e.orientation,o=e.startDate,s=(a||(o?function(){return o}:function(){return t.today}))(),d=r===_constants.VERTICAL_SCROLLABLE;return{currentMonth:s,visibleDays:this.getModifiers((0,_getVisibleDays.default)(s,i,n,d))}},e.shouldDisableMonthNavigation=function(e,t){if(!e)return!1;var a=this.props,i=a.numberOfMonths,n=a.enableOutsideDays;return(0,_isDayVisible.default)(e,t,i,n)},e.addModifier=function(e,t,a){return(0,_modifiers.addModifier)(e,t,a,this.props,this.state)},e.addModifierToRange=function(e,t,a,i){for(var n=e,r=t.clone();(0,_isBeforeDay.default)(r,a);)n=this.addModifier(n,r,i),r=r.clone().add(1,"day");return n},e.deleteModifier=function(e,t,a){return(0,_modifiers.deleteModifier)(e,t,a,this.props,this.state)},e.deleteModifierFromRange=function(e,t,a,i){for(var n=e,r=t.clone();(0,_isBeforeDay.default)(r,a);)n=this.deleteModifier(n,r,i),r=r.clone().add(1,"day");return n},e.doesNotMeetMinimumNights=function(e){var t=this.props,a=t.startDate,i=t.isOutsideRange,n=t.focusedInput,r=t.minimumNights;if(n!==_constants.END_DATE)return!1;if(a){var o=e.diff(a.clone().startOf("day").hour(12),"days");return o<r&&0<=o}return i((0,_moment.default)(e).subtract(r,"days"))},e.doesNotMeetMinNightsForHoveredStartDate=function(e,t){var a=this.props,i=a.focusedInput,n=a.getMinNightsForHoverDate;if(i!==_constants.END_DATE)return!1;if(!t||this.isBlocked(t))return!1;var r=n(t),o=e.diff(t.clone().startOf("day").hour(12),"days");return o<r&&0<=o},e.isDayAfterHoveredStartDate=function(e){var t=this.props,a=t.startDate,i=t.endDate,n=t.minimumNights,r=(this.state||{}).hoverDate;return!!a&&!i&&!this.isBlocked(e)&&(0,_isNextDay.default)(r,e)&&0<n&&(0,_isSameDay.default)(r,a)},e.isEndDate=function(e){var t=this.props.endDate;return(0,_isSameDay.default)(e,t)},e.isHovered=function(e){var t=(this.state||{}).hoverDate;return!!this.props.focusedInput&&(0,_isSameDay.default)(e,t)},e.isInHoveredSpan=function(e){var t=this.props,a=t.startDate,i=t.endDate,n=(this.state||{}).hoverDate,r=!!a&&!i&&(e.isBetween(a,n)||(0,_isSameDay.default)(n,e)),o=!!i&&!a&&(e.isBetween(n,i)||(0,_isSameDay.default)(n,e)),s=n&&!this.isBlocked(n);return(r||o)&&s},e.isInSelectedSpan=function(e){var t=this.props,a=t.startDate,i=t.endDate;return e.isBetween(a,i,"days")},e.isLastInRange=function(e){var t=this.props.endDate;return this.isInSelectedSpan(e)&&(0,_isNextDay.default)(e,t)},e.isStartDate=function(e){var t=this.props.startDate;return(0,_isSameDay.default)(e,t)},e.isBlocked=function(e){var t=this.props,a=t.isDayBlocked,i=t.isOutsideRange;return a(e)||i(e)||this.doesNotMeetMinimumNights(e)},e.isToday=function(e){return(0,_isSameDay.default)(e,this.today)},e.isFirstDayOfWeek=function(e){var t=this.props.firstDayOfWeek;return e.day()===(t||_moment.default.localeData().firstDayOfWeek())},e.isLastDayOfWeek=function(e){var t=this.props.firstDayOfWeek;return e.day()===((t||_moment.default.localeData().firstDayOfWeek())+6)%7},e.isFirstPossibleEndDateForHoveredStartDate=function(e,t){var a=this.props,i=a.focusedInput,n=a.getMinNightsForHoverDate;if(i!==_constants.END_DATE||!t||this.isBlocked(t))return!1;var r=n(t),o=t.clone().add(r,"days");return(0,_isSameDay.default)(e,o)},e.beforeSelectedEnd=function(e){var t=this.props.endDate;return(0,_isBeforeDay.default)(e,t)},e.isDayBeforeHoveredEndDate=function(e){var t=this.props,a=t.startDate,i=t.endDate,n=t.minimumNights,r=(this.state||{}).hoverDate;return!!i&&!a&&!this.isBlocked(e)&&(0,_isPreviousDay.default)(r,e)&&0<n&&(0,_isSameDay.default)(r,i)},e.render=function(){var e=this.props,t=e.numberOfMonths,a=e.orientation,i=e.monthFormat,n=e.renderMonthText,r=e.renderWeekHeaderElement,o=e.dayPickerNavigationInlineStyles,s=e.navPosition,d=e.navPrev,l=e.navNext,u=e.renderNavPrevButton,f=e.renderNavNextButton,c=e.noNavButtons,h=e.onOutsideClick,p=e.withPortal,D=e.enableOutsideDays,y=e.firstDayOfWeek,_=e.renderKeyboardShortcutsButton,b=e.renderKeyboardShortcutsPanel,v=e.hideKeyboardShortcutsPanel,m=e.daySize,M=e.focusedInput,g=e.renderCalendarDay,T=e.renderDayContents,S=e.renderCalendarInfo,O=e.renderMonthElement,P=e.calendarInfoPosition,k=e.onBlur,N=e.onShiftTab,R=e.onTab,E=e.isFocused,C=e.showKeyboardShortcuts,B=e.isRTL,I=e.weekDayFormat,A=e.dayAriaLabelFormat,F=e.verticalHeight,q=e.noBorder,x=e.transitionDuration,j=e.verticalBorderSpacing,w=e.horizontalMonthPadding,H=this.state,L=H.currentMonth,z=H.phrases,V=H.visibleDays,W=H.disablePrev,K=H.disableNext;return _react.default.createElement(_DayPicker.default,{orientation:a,enableOutsideDays:D,modifiers:V,numberOfMonths:t,onDayClick:this.onDayClick,onDayMouseEnter:this.onDayMouseEnter,onDayMouseLeave:this.onDayMouseLeave,onPrevMonthClick:this.onPrevMonthClick,onNextMonthClick:this.onNextMonthClick,onMonthChange:this.onMonthChange,onTab:R,onShiftTab:N,onYearChange:this.onYearChange,onMultiplyScrollableMonths:this.onMultiplyScrollableMonths,monthFormat:i,renderMonthText:n,renderWeekHeaderElement:r,withPortal:p,hidden:!M,initialVisibleMonth:function(){return L},daySize:m,onOutsideClick:h,disablePrev:W,disableNext:K,dayPickerNavigationInlineStyles:o,navPosition:s,navPrev:d,navNext:l,renderNavPrevButton:u,renderNavNextButton:f,noNavButtons:c,renderCalendarDay:g,renderDayContents:T,renderCalendarInfo:S,renderMonthElement:O,renderKeyboardShortcutsButton:_,renderKeyboardShortcutsPanel:b,calendarInfoPosition:P,firstDayOfWeek:y,hideKeyboardShortcutsPanel:v,isFocused:E,getFirstFocusableDay:this.getFirstFocusableDay,onBlur:k,showKeyboardShortcuts:C,phrases:z,isRTL:B,weekDayFormat:I,dayAriaLabelFormat:A,verticalHeight:F,verticalBorderSpacing:j,noBorder:q,transitionDuration:x,horizontalMonthPadding:w})},t}(_react.default.PureComponent||_react.default.Component);(exports.default=DayPickerRangeController).propTypes="production"!==process.env.NODE_ENV?propTypes:{},DayPickerRangeController.defaultProps=defaultProps;
Lawnchair.adapter("webkit-sqlite",function(){function l(t,n){console.log("error in sqlite adaptor!",t,n)}return Function.prototype.bind||(Function.prototype.bind=function(t){function n(){}function i(){return s.apply(this instanceof n?this:t||{},a.concat(e.call(arguments)))}var e=[].slice,a=e.call(arguments,1),s=this;return n.prototype=s.prototype,i.prototype=new n,i}),{valid:function(){return!!window.openDatabase},init:function(t,n){function i(){return a.call(e,e)}var e=this,a=e.fn(e.name,n),s="CREATE TABLE IF NOT EXISTS "+this.name+" (id NVARCHAR(32) UNIQUE PRIMARY KEY, value TEXT, timestamp REAL)";this.db=openDatabase(this.name,"1.0.0",this.name,65536),this.db.transaction(function(t){t.executeSql(s,[],i,l)})},keys:function(t){var s=this.lambda(t),r=this,n="SELECT id FROM "+this.name+" ORDER BY timestamp DESC";return this.db.transaction(function(t){t.executeSql(n,[],function(t,n){if(0==n.rows.length)s.call(r,[]);else{for(var i=[],e=0,a=n.rows.length;e<a;e++)i.push(n.rows.item(e).id);s.call(r,i)}},l)}),this},save:function(a,t){function s(){t&&(a.key=i,n.lambda(t).call(n,a))}var n=this,i=a.key||n.uuid(),r="INSERT INTO "+this.name+" (value, timestamp, id) VALUES (?,?,?)",o="UPDATE "+this.name+" SET value=?, timestamp=? WHERE id=?",u=[new Date,i];return n.exists(a.key,function(e){n.db.transaction(function(t){var n,i;e?(delete(i=a).key,u.unshift(JSON.stringify(i)),t.executeSql(o,u,s,l)):(n=a,u.unshift(JSON.stringify(n)),t.executeSql(r,u,s,l))})}),this},batch:function(n,t){function i(t){e.push(t),a=e.length===n.length}for(var e=[],a=!1,s=this,r=setInterval(function(){a&&(t&&s.lambda(t).call(s,e),clearInterval(r))},200),o=0,u=n.length;o<u;o++)this.save(n[o],i);return this},get:function(r,o){function n(t,n){var i=null,e=[];if(n.rows.length)for(var a=0,s=n.rows.length;a<s;a++)(i=JSON.parse(n.rows.item(a).value)).key=n.rows.item(a).id,e.push(i);u.isArray(r)||(e=e.length?e[0]:null),o&&u.lambda(o).call(u,e)}var u=this,i="",i=this.isArray(r)?"SELECT id, value FROM "+this.name+" WHERE id IN ('"+r.join("','")+"')":"SELECT id, value FROM "+this.name+" WHERE id = '"+r+"'";return this.db.transaction(function(t){t.executeSql(i,[],n,l)}),this},exists:function(n,i){function e(t,n){i&&s.fn("exists",i).call(s,0<n.rows.length)}var a="SELECT * FROM "+this.name+" WHERE id = ?",s=this;return this.db.transaction(function(t){t.executeSql(a,[n],e,l)}),this},all:function(t){function n(t,n){if(0!=n.rows.length)for(var i=0,e=n.rows.length;i<e;i++){var a=JSON.parse(n.rows.item(i).value);a.key=n.rows.item(i).id,r.push(a)}o&&o.call(s,r)}var s=this,i="SELECT * FROM "+this.name,r=[],o=this.fn(this.name,t)||void 0;return this.db.transaction(function(t){t.executeSql(i,[],n,l)}),this},remove:function(t,n){function i(){n&&e.lambda(n).call(e)}var e=this,a="string"==typeof t?t:t.key,s="DELETE FROM "+this.name+" WHERE id = ?";return this.db.transaction(function(t){t.executeSql(s,[a],i,l)}),this},nuke:function(t){var n="DELETE FROM "+this.name,i=this,e=t?function(){i.lambda(t).call(i)}:function(){};return this.db.transaction(function(t){t.executeSql(n,[],e,l)}),this}}}());
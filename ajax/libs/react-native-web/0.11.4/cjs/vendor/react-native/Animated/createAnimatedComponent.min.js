"use strict";exports.__esModule=!0,exports.default=void 0;var _AnimatedEvent=require("./AnimatedEvent"),_AnimatedProps=_interopRequireDefault(require("./nodes/AnimatedProps")),_react=_interopRequireDefault(require("react")),_ViewStylePropTypes=_interopRequireDefault(require("../../../exports/View/ViewStylePropTypes")),_invariant=_interopRequireDefault(require("fbjs/lib/invariant"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _extends(){return(_extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t}).apply(this,arguments)}function _inheritsLoose(t,e){t.prototype=Object.create(e.prototype),(t.prototype.constructor=t).__proto__=e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function createAnimatedComponent(e){(0,_invariant.default)("string"==typeof e||e.prototype&&e.prototype.isReactComponent,"`createAnimatedComponent` does not support stateless functional components; use a class component instead.");var t=function(n){function o(t){var e=n.call(this,t)||this;return e._invokeAnimatedPropsCallbackOnMount=!1,e._eventDetachers=[],e._animatedPropsCallback=function(){if(null==e._component)e._invokeAnimatedPropsCallbackOnMount=!0;else if(o.__skipSetNativeProps_FOR_TESTS_ONLY||"function"!=typeof e._component.setNativeProps)e.forceUpdate();else{if(e._propsAnimated.__isNative)throw new Error('Attempting to run JS driven animation on animated node that has been moved to "native" earlier by starting an animation with `useNativeDriver: true`');e._component.setNativeProps(e._propsAnimated.__getAnimatedValue())}},e._setComponentRef=e._setComponentRef.bind(_assertThisInitialized(_assertThisInitialized(e))),e}_inheritsLoose(o,n);var t=o.prototype;return t.componentWillUnmount=function(){this._propsAnimated&&this._propsAnimated.__detach(),this._detachNativeEvents()},t.setNativeProps=function(t){this._component.setNativeProps(t)},t.UNSAFE_componentWillMount=function(){this._attachProps(this.props)},t.componentDidMount=function(){this._invokeAnimatedPropsCallbackOnMount&&(this._invokeAnimatedPropsCallbackOnMount=!1,this._animatedPropsCallback()),this._propsAnimated.setNativeView(this._component),this._attachNativeEvents()},t._attachNativeEvents=function(){function t(t){var e=n.props[t];e instanceof _AnimatedEvent.AnimatedEvent&&e.__isNative&&(e.__attach(o,t),n._eventDetachers.push(function(){return e.__detach(o,t)}))}var n=this,o=this._component.getScrollableNode?this._component.getScrollableNode():this._component;for(var e in this.props)t(e)},t._detachNativeEvents=function(){this._eventDetachers.forEach(function(t){return t()}),this._eventDetachers=[]},t._attachProps=function(t){var e=this._propsAnimated;this._propsAnimated=new _AnimatedProps.default(t,this._animatedPropsCallback),e&&e.__detach()},t.UNSAFE_componentWillReceiveProps=function(t){this._attachProps(t)},t.componentDidUpdate=function(t){this._component!==this._prevComponent&&this._propsAnimated.setNativeView(this._component),this._component===this._prevComponent&&t===this.props||(this._detachNativeEvents(),this._attachNativeEvents())},t.render=function(){var t=this._propsAnimated.__getValue();return _react.default.createElement(e,_extends({},t,{ref:this._setComponentRef,collapsable:!this._propsAnimated.__isNative&&t.collapsable}))},t._setComponentRef=function(t){this._prevComponent=this._component,this._component=t},t.getNode=function(){return this._component},o}(_react.default.Component);t.__skipSetNativeProps_FOR_TESTS_ONLY=!1;var n=e.propTypes;return t.propTypes="production"!==process.env.NODE_ENV?{style:function(t){if(n)for(var e in _ViewStylePropTypes.default)n[e]||void 0===t[e]||console.warn("You are setting the style `{ "+e+": ... }` as a prop. You should nest it in a style object. E.g. `{ style: { "+e+": ... } }`")}}:{},t}var _default=createAnimatedComponent;exports.default=createAnimatedComponent,module.exports=exports.default;
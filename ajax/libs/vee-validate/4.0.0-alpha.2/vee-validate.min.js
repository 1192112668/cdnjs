/**
  * vee-validate vundefined
  * (c) 2020 Abdelrahman Awad
  * @license MIT
  */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],t):t((e=e||self).VeeValidate={},e.Vue)}(this,(function(e,t){"use strict";function a(e){return"function"==typeof e}const r=e=>null!==e&&e&&"object"==typeof e&&!Array.isArray(e),n={};function i(e){return a(e)&&!!e.__locatorRef}function u(e){return e&&a(e.validate)}function l(e){return`v_${e}_error`}function s(e){if(!(t=e)||!("undefined"!=typeof Event&&a(Event)&&t instanceof Event||t&&t.srcElement))return e;var t;const r=e.target;return"file"===r.type&&r.files?Array.from(r.files):r.value}function o(e){return t.isRef(e)?e.value:e}function d(e){return t.computed(()=>Object.keys(e).reduce((t,a)=>(t[a]=e[a].value,t),{}))}function c(e){const t={};return Object.defineProperty(t,"_$$isNormalized",{value:!0,writable:!1,enumerable:!1,configurable:!1}),e?a(e)||u(e)||r(e)&&e._$$isNormalized?e:r(e)?Object.keys(e).reduce((t,a)=>{const n=function(e){if(!0===e)return[];if(Array.isArray(e))return e;if(r(e))return e;return[e]}(e[a]);return!1!==e[a]&&(t[a]=v(n)),t},t):"string"!=typeof e?t:e.split("|").reduce((e,t)=>{const a=f(t);return a.name?(e[a.name]=v(a.params),e):e},t):t}function v(e){const t=e=>"string"==typeof e&&"@"===e[0]?function(e){const t=t=>t[e];return t.__locatorRef=e,t}(e.slice(1)):e;return Array.isArray(e)?e.map(t):Object.keys(e).reduce((a,r)=>(a[r]=t(e[r]),a),{})}const f=e=>{let t=[];const a=e.split(":")[0];return e.includes(":")&&(t=e.split(":").slice(1).join(":").split(",")),{name:a,params:t}};const m=(e,t)=>e.slots.default&&e.slots.default(t)||[];let p=Object.assign({},{defaultMessage:({field:e})=>e+" is not valid.",skipOptional:!0,bails:!0});const h=()=>p;async function b(e,t,r={}){const n=null==r?void 0:r.bails,i=null==r?void 0:r.skipIfEmpty,l={name:(null==r?void 0:r.name)||"{field}",rules:c(t),bails:null==n||n,skipIfEmpty:null==i||i,forceRequired:!1,crossTable:(null==r?void 0:r.values)||{}},s=await async function(e,t){if(a(e.rules)){const a=await e.rules(t),r="string"!=typeof a&&a;return{valid:r,errors:r?[]:[{msg:a,rule:""}]}}if(u(e.rules))return async function(e,t){const a=await e.rules.validate(t).then(()=>!0).catch(e=>{if("ValidationError"===e.name)return e.message;throw e}),r="string"!=typeof a&&a;return{valid:r,errors:r?[]:[{msg:a,rule:""}]}}(e,t);const r=[],n=Object.keys(e.rules),i=n.length;for(let a=0;a<i;a++){const i=n[a],u=await g(e,t,{name:i,params:e.rules[i]});if(!u.valid&&u.error&&(r.push(u.error),e.bails))return{valid:!1,errors:r}}return{valid:!r.length,errors:r}}(l,e),o=[];return s.errors.forEach(e=>{const t=e.msg;o.push(t)}),{valid:s.valid,errors:o}}async function g(e,t,a){const r=(u=a.name,n[u]);var u;if(!r)throw new Error(`No such validator '${a.name}' exists.`);const l=function(e,t){const a=e=>i(e)?e(t):e;if(Array.isArray(e))return e.map(a);return Object.keys(e).reduce((t,r)=>(t[r]=a(e[r]),t),{})}(a.params,e.crossTable),s={field:e.name,value:t,form:e.crossTable,rule:a},o=await r(t,l,s);return"string"==typeof o?{valid:!1,error:{rule:a.name,msg:o}}:{valid:o,error:o?void 0:y(s)}}function y(e){return{msg:(0,h().defaultMessage)(e),rule:e.rule.name}}function j(e,r,n){var u;const{value:d,form:v,immediate:f,bails:m,disabled:p}=function(e){const a=()=>({value:t.ref(void 0),immediate:!1,bails:!0,rules:"",disabled:!1});if(!e)return a();return Object.assign(Object.assign({},a()),e||{})}(n),{meta:h,errors:g,onBlur:y,handleChange:j,reset:O,patch:S}=function(e){const a=t.ref([]),{onBlur:r,reset:n,meta:i}=function(){const e=t.reactive({untouched:!0,touched:!1,dirty:!1,pristine:!0,valid:!1,invalid:!1,validated:!1,pending:!1,changed:!1,passed:!1,failed:!1}),a=t.computed(()=>e.valid&&e.validated),r=t.computed(()=>e.invalid&&e.validated);return{meta:Object.assign(Object.assign({},t.toRefs(e)),{passed:a,failed:r}),onBlur:()=>{e.touched=!0,e.untouched=!1},reset:function(){const t={untouched:!0,touched:!1,dirty:!1,pristine:!0,valid:!1,invalid:!1,validated:!1,pending:!1,changed:!1,passed:!1,failed:!1};Object.keys(e).forEach(a=>{"passed"!==a&&"failed"!==a&&(e[a]=t[a])})}}}(),u=e.value;return{meta:i,errors:a,patch:function(t){return a.value=t.errors,i.changed.value=u!==e.value,i.valid.value=t.valid,i.invalid.value=!t.valid,i.validated.value=!0,t},reset:()=>{a.value=[],n()},onBlur:r,handleChange:t=>{e.value=s(t),i.dirty.value=!0,i.pristine.value=!1}}}(d),E=function(e,t){if(!e)return;return e[t]}(null===(u=null==n?void 0:n.form)||void 0===u?void 0:u.schema,o(e)),w=t.computed(()=>c(E||o(r))),_=async()=>{var t;if(h.pending.value=!0,!v||!v.validateSchema){const a=await b(d.value,w.value,{name:o(e),values:null!==(t=null==v?void 0:v.values.value)&&void 0!==t?t:{},bails:m});return h.valid.value=a.valid,h.invalid.value=!a.valid,h.pending.value=!1,a}const a=await v.validateSchema();return h.pending.value=!1,a[o(e)]},k=()=>_().then(S);t.onMounted(()=>{_().then(e=>{f&&S(e)})});const F=t.computed(()=>g.value[0]),R=function(e,a){return t.computed(()=>({"aria-invalid":a.failed.value?"true":"false","aria-describedBy":l(o(e))}))}(e,h),V={name:e,value:d,meta:h,errors:g,errorMessage:F,aria:R,reset:O,validate:k,handleChange:j,onBlur:y,disabled:p,setValidationState:S};if(t.watch(d,k,{deep:!0}),t.isRef(r)&&t.watch(r,k,{deep:!0}),!v)return V;v.register(V);const A=t.computed(()=>{const e=w.value;return!e||a(e)||a(e.validate)?[]:Object.keys(e).reduce((e,t)=>{const a=(r=w.value[t],Array.isArray(r)?r.filter(i):Object.keys(r).filter(e=>i(r[e])).map(e=>r[e])).map(e=>e.__locatorRef);var r;return e.push(...a),e},[])});return t.watchEffect(()=>{A.value.length&&A.value.forEach(e=>{e in v.values.value&&h.validated.value&&k()})}),V}const O=t.defineComponent({name:"Field",props:{as:{type:[String,Object],default:void 0},name:{type:String,required:!0},rules:{type:[Object,String,Function],default:null},immediate:{type:Boolean,default:!1},bails:{type:Boolean,default:()=>h().bails},disabled:{type:Boolean,default:!1},debounce:{type:Number,default:0},customMessages:{type:Object,default:void 0}},setup(e,a){const r=e.name,n=t.inject("$_veeForm",void 0),i=t.computed(()=>e.disabled),u=t.computed(()=>e.rules),{errors:l,value:s,errorMessage:o,validate:c,handleChange:v,onBlur:f,reset:p,meta:h,aria:b}=j(r,u,{form:n,immediate:e.immediate,bails:e.bails,disabled:i}),g=function(e,t=0,a={cancelled:!1}){if(!t)return e;let r;return(...n)=>{clearTimeout(r),r=setTimeout(()=>{r=void 0,a.cancelled||e(...n)},t)}}(v,e.debounce),y=d(h),O=t.computed(()=>({field:{name:r,disabled:e.disabled,onInput:g,onChange:g,"onUpdate:modelValue":g,onBlur:f,value:s.value},aria:b.value,meta:y.value,errors:l.value,errorMessage:o.value,validate:c,reset:p,handleChange:g}));return()=>{const r=m(a,O.value);return e.as?t.h(e.as,Object.assign(Object.assign(Object.assign({},a.attrs),O.value.field),(n=e.as,["input","textarea","select"].includes(n)?O.value.aria:{})),r):r;var n}}});function S(e){const a=t.ref([]),r=t.ref(!1),n=t.computed(()=>a.value.reduce((e,t)=>(e[t.name]=t,e),{})),i=t.computed(()=>a.value.filter(e=>!o(e.disabled))),l=t.computed(()=>i.value.reduce((e,t)=>(e[t.name]=t.value,e),{})),s={register(t){var r;const n=o(t.name);(null===(r=null==e?void 0:e.initialValues)||void 0===r?void 0:r[n])&&(t.value.value=null==e?void 0:e.initialValues[n]),a.value.push(t)},fields:n,values:l,schema:null==e?void 0:e.validationSchema,validateSchema:u(null==e?void 0:e.validationSchema)?(e=!1)=>async function(e,t=!1){const a=await e.schema.validate(e.values.value,{abortEarly:!1}).then(()=>[]).catch(e=>{if("ValidationError"!==e.name)throw e;return e.inner||[]}),r=e.fields.value,n=a.reduce((e,t)=>(e[t.path]=t,e),{});return Object.keys(r).reduce((e,a)=>{const i=r[a],u=(n[a]||{errors:[]}).errors,l={errors:u,valid:!u.length};return e[a]=l,(t||i.meta.validated)&&i.setValidationState(l),e},{})}(s,e):void 0},d=async()=>{if(s.validateSchema)return s.validateSchema(!0).then(e=>Object.keys(e).every(t=>e[t].valid));return(await Promise.all(i.value.map(e=>e.validate()))).every(e=>e.valid)},c=t.computed(()=>i.value.reduce((e,t)=>(e[t.name]=t.errorMessage,e),{})),v=e=>function(t){return t instanceof Event&&(t.preventDefault(),t.stopPropagation()),r.value=!0,d().then(a=>{if(a&&"function"==typeof e)return e(l.value,t)}).then(()=>{r.value=!1})},f=v((e,t)=>{t&&t.target.submit()});return{errors:c,meta:function(e){return Object.keys(E).reduce((a,r)=>(a[r]=t.computed(()=>{const t=E[r];return e.value[t](e=>e.meta[r])}),a),{})}(a),form:s,values:l,validate:d,isSubmitting:r,handleReset:()=>{a.value.forEach(e=>e.reset())},handleSubmit:v,submitForm:f}}const E={valid:"every",invalid:"some",dirty:"some",pristine:"every",touched:"some",untouched:"every",pending:"some",validated:"every",changed:"some",passed:"every",failed:"some"};const w=t.defineComponent({name:"Form",inheritAttrs:!1,props:{as:{type:String,default:"form"},validationSchema:{type:Object,default:void 0},initialValues:{type:Object,default:void 0}},setup(e,a){const{form:r,errors:n,validate:i,handleSubmit:u,handleReset:l,values:s,meta:o,isSubmitting:c,submitForm:v}=S({validationSchema:e.validationSchema,initialValues:e.initialValues});t.provide("$_veeForm",r),t.provide("$_veeFormErrors",n);const f=d(o),p=t.computed(()=>({meta:f.value,errors:n.value,values:s.value,isSubmitting:c.value,validate:i,handleSubmit:u,handleReset:l,submitForm:v})),h=a.attrs.onSubmit?u(a.attrs.onSubmit):v;function b(){l(),"function"==typeof a.attrs.onReset&&a.attrs.onReset()}return()=>{const r=m(a,p.value);if(!e.as)return r;const n="form"===e.as?{novalidate:!0}:{};return t.h(e.as,Object.assign(Object.assign(Object.assign({},n),a.attrs),{onSubmit:h,onReset:b}),r)}}}),_=t.defineComponent({props:{as:{type:String,default:void 0},name:{type:String,required:!0}},setup(e,a){const r=t.inject("$_veeFormErrors",void 0),n=t.computed(()=>r.value[e.name]);return()=>{const r=m(a,{message:n.value}),i=e.as,u={id:l(e.name),role:"alert"};return!i&&r.length?r:r.length?t.h(i,Object.assign(Object.assign({},u),a.attrs),r):t.h(i||"span",u,n.value)}}});e.ErrorMessage=_,e.Field=O,e.Form=w,e.configure=e=>{var t;t=e,p=Object.assign(Object.assign({},p),t)},e.defineRule=function(e,t){!function(e,t){if(a(t))return;throw new Error(`Extension Error: The validator '${e}' must be a function.`)}(e,t),n[e]=t},e.useField=j,e.useForm=S,e.validate=b,Object.defineProperty(e,"__esModule",{value:!0})}));
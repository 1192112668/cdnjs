define(["./Deferred","./promise/Promise"],function(i,c){"use strict";return function(e,n,r,t){var o,s=e&&"function"==typeof e.then;return s?(s&&e instanceof c||(o=new i(e.cancel),e.then(o.resolve,o.reject,o.progress),e=o.promise),n||r||t?e.then(n,r,t):e):1<arguments.length?n?n(e):e:(new i).resolve(e)}});
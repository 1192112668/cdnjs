define(["../_base/config","../_base/json","../_base/kernel","../_base/lang","../_base/xhr","../sniff","../_base/window","../dom","../dom-construct","../query","require","../aspect","../request/iframe"],function(l,u,c,e,d,t,o,f,r,n,a,m,h){c.deprecated("dojo/io/iframe","Use dojo/request/iframe.","2.0");var s=(s=h._iframeName).substring(0,s.lastIndexOf("_")),i=e.delegate(h,{create:function(){return i._frame=h.create.apply(h,arguments)},get:null,post:null,send:function(e){var n,t=d._ioSetArgs(e,function(e){n&&n.cancel()},function(e){var t=null,o=e.ioArgs;try{var r=o.handleAs;"xml"===r||"html"===r?t=n.response.data:(t=n.response.text,"json"===r?t=u.fromJson(t):"javascript"===r&&(t=c.eval(t)))}catch(e){t=e}return t},function(e,t){return t.ioArgs._hasError=!0,e}),o=t.ioArgs,r="GET",a=f.byId(e.form);e.method&&"POST"===e.method.toUpperCase()&&a&&(r="POST");var s,i={method:r,handleAs:"json"===e.handleAs||"javascript"===e.handleAs?"text":e.handleAs,form:e.form,query:a?null:e.content,data:a?e.content:null,timeout:e.timeout,ioArgs:o};return i.method&&(i.method=i.method.toUpperCase()),l.ioPublish&&c.publish&&!1!==o.args.ioPublish&&(s=m.after(h,"_notifyStart",function(e){e.options.ioArgs===o&&(s.remove(),d._ioNotifyStart(t))},!0)),n=h(o.url,i,!0),o._callNext=n._callNext,n.then(function(){t.resolve(t)}).otherwise(function(e){t.ioArgs.error=e,t.reject(e)}),t},_iframeOnload:o.global[s+"_onload"]});return e.setObject("dojo.io.iframe",i),i});
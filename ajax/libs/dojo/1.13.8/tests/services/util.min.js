define(["exports","intern/dojo/_base/lang","intern/dojo/_base/array","intern/dojo/Deferred","intern/dojo/errors/CancelError","intern/dojo/promise/Promise","intern/dojo/promise/all"],function(i,o,r,t,c,n,s){i.Promise=function(e){var r,n=new t(function(e){return r?r(e):new c("canceled")});try{e(o.hitch(n,"resolve"),o.hitch(n,"reject"),o.hitch(n,"progress"),function(e){r=e})}catch(e){n.reject(e)}return n.promise},i.Promise.reject=function(e){var r=new t;return r.reject(e),r.promise},i.Promise.resolve=function(e){if(e instanceof n)return e;if(e instanceof t)return e.promise;var r=new t;return e&&"function"==typeof e.then?e.then(o.hitch(r,"resolve"),o.hitch(r,"reject"),o.hitch(r,"progress")):r.resolve(e),r.promise},i.map=function(e,n){return s(r.map(e,function(e,r){return i.Promise.resolve(e).then(function(e){return n(e,r)})}))},i.delay=function(e,o){var t=i.Promise.resolve(e);return new i.Promise(function(e,r,n){setTimeout(function(){t.then(e,r,n)},o)})},i.call=function(e){var r=Array.prototype.slice.call(arguments,1);return i.Promise(function(n,o){r.push(function(e,r){e?o(e):n(r)}),e.apply(this,r)})}});
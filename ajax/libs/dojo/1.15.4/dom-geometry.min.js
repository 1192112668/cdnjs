define(["./sniff","./_base/window","./dom","./dom-style"],function(c,d,s,b){var h={boxModel:"content-box"};c("ie")&&(h.boxModel="BackCompat"==document.compatMode?"border-box":"content-box"),h.getPadExtents=function(t,e){t=s.byId(t);var o=e||b.getComputedStyle(t),r=b.toPixelValue,n=r(t,o.paddingLeft),i=r(t,o.paddingTop),d=r(t,o.paddingRight),l=r(t,o.paddingBottom);return{l:n,t:i,r:d,b:l,w:n+d,h:i+l}};var p="none";function f(t,e,o,r,n,i){i=i||"px";var d=t.style;isNaN(e)||(d.left=e+i),isNaN(o)||(d.top=o+i),0<=r&&(d.width=r+i),0<=n&&(d.height=n+i)}function u(t){return"button"==t.tagName.toLowerCase()||"input"==t.tagName.toLowerCase()&&"button"==(t.getAttribute("type")||"").toLowerCase()}function g(t){return"border-box"==h.boxModel||"table"==t.tagName.toLowerCase()||u(t)}h.getBorderExtents=function(t,e){t=s.byId(t);var o=b.toPixelValue,r=e||b.getComputedStyle(t),n=r.borderLeftStyle!=p?o(t,r.borderLeftWidth):0,i=r.borderTopStyle!=p?o(t,r.borderTopWidth):0,d=r.borderRightStyle!=p?o(t,r.borderRightWidth):0,l=r.borderBottomStyle!=p?o(t,r.borderBottomWidth):0;return{l:n,t:i,r:d,b:l,w:n+d,h:i+l}},h.getPadBorderExtents=function(t,e){t=s.byId(t);var o=e||b.getComputedStyle(t),r=h.getPadExtents(t,o),n=h.getBorderExtents(t,o);return{l:r.l+n.l,t:r.t+n.t,r:r.r+n.r,b:r.b+n.b,w:r.w+n.w,h:r.h+n.h}},h.getMarginExtents=function(t,e){t=s.byId(t);var o=e||b.getComputedStyle(t),r=b.toPixelValue,n=r(t,o.marginLeft),i=r(t,o.marginTop),d=r(t,o.marginRight),l=r(t,o.marginBottom);return{l:n,t:i,r:d,b:l,w:n+d,h:i+l}},h.getMarginBox=function(t,e){t=s.byId(t);var o,r=e||b.getComputedStyle(t),n=h.getMarginExtents(t,r),i=t.offsetLeft-n.l,d=t.offsetTop-n.t,l=t.parentNode,a=b.toPixelValue;return 8!=c("ie")||c("quirks")||l&&(i-=(o=b.getComputedStyle(l)).borderLeftStyle!=p?a(t,o.borderLeftWidth):0,d-=o.borderTopStyle!=p?a(t,o.borderTopWidth):0),{l:i,t:d,w:t.offsetWidth+n.w,h:t.offsetHeight+n.h}},h.getContentBox=function(t,e){t=s.byId(t);var o,r,n,i=e||b.getComputedStyle(t),d=t.clientWidth,l=h.getPadExtents(t,i),a=h.getBorderExtents(t,i),f=t.offsetLeft+l.l+a.l,u=t.offsetTop+l.t+a.t,g=d?t.clientHeight:(d=t.offsetWidth-a.w,t.offsetHeight-a.h);return 8!=c("ie")||c("quirks")||(o=t.parentNode,r=b.toPixelValue,o&&(f-=(n=b.getComputedStyle(o)).borderLeftStyle!=p?r(t,n.borderLeftWidth):0,u-=n.borderTopStyle!=p?r(t,n.borderTopWidth):0)),{l:f,t:u,w:d-l.w,h:g-l.h}},h.setContentSize=function(t,e,o){t=s.byId(t);var r,n=e.w,i=e.h;g(t)&&(r=h.getPadBorderExtents(t,o),0<=n&&(n+=r.w),0<=i&&(i+=r.h)),f(t,NaN,NaN,n,i)};var y={l:0,t:0,w:0,h:0};return h.setMarginBox=function(t,e,o){t=s.byId(t);var r,n=o||b.getComputedStyle(t),i=e.w,d=e.h,l=g(t)?y:h.getPadBorderExtents(t,n),a=h.getMarginExtents(t,n);c("webkit")&&u(t)&&(r=t.style,0<=i&&!r.width&&(r.width="4px"),0<=d&&!r.height&&(r.height="4px")),0<=i&&(i=Math.max(i-l.w-a.w,0)),0<=d&&(d=Math.max(d-l.h-a.h,0)),f(t,e.l,e.t,i,d)},h.isBodyLtr=function(t){return t=t||d.doc,"ltr"==(d.body(t).dir||t.documentElement.dir||"ltr").toLowerCase()},h.docScroll=function(t){var e=(t=t||d.doc).parentWindow||t.defaultView;return"pageXOffset"in e?{x:e.pageXOffset,y:e.pageYOffset}:(e=c("quirks")?d.body(t):t.documentElement)&&{x:h.fixIeBiDiScrollLeft(e.scrollLeft||0,t),y:e.scrollTop||0}},h.getIeDocumentElementOffset=function(t){return{x:0,y:0}},h.fixIeBiDiScrollLeft=function(t,e){e=e||d.doc;var o=c("ie");if(!o||h.isBodyLtr(e))return t;var r=c("quirks"),n=r?d.body(e):e.documentElement,i=d.global;return 6==o&&!r&&i.frameElement&&n.scrollHeight>n.clientHeight&&(t+=n.clientLeft),o<8||r?t+n.clientWidth-n.scrollWidth:-t},h.position=function(t,e){t=s.byId(t);var o,r=d.body(t.ownerDocument),n={x:(n=t.getBoundingClientRect()).left,y:n.top,w:n.right-n.left,h:n.bottom-n.top};return c("ie")<9&&(n.x-=c("quirks")?r.clientLeft+r.offsetLeft:0,n.y-=c("quirks")?r.clientTop+r.offsetTop:0),e&&(o=h.docScroll(t.ownerDocument),n.x+=o.x,n.y+=o.y),n},h.getMarginSize=function(t,e){t=s.byId(t);var o=h.getMarginExtents(t,e||b.getComputedStyle(t)),r=t.getBoundingClientRect();return{w:r.right-r.left+o.w,h:r.bottom-r.top+o.h}},h.normalizeEvent=function(t){var e,o,r;"layerX"in t||(t.layerX=t.offsetX,t.layerY=t.offsetY),"pageX"in t||(o=(e=t.target)&&e.ownerDocument||document,r=c("quirks")?o.body:o.documentElement,t.pageX=t.clientX+h.fixIeBiDiScrollLeft(r.scrollLeft||0,o),t.pageY=t.clientY+(r.scrollTop||0))},h});
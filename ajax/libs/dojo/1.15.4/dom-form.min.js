define(["./_base/lang","./dom","./io-query","./json"],function(b,c,t,i){var y={fieldToObject:function(e){var t=null;if(e=c.byId(e)){var i=e.name,n=(e.type||"").toLowerCase();if(i&&n&&!e.disabled)if("radio"==n||"checkbox"==n)e.checked&&(t=e.value);else if(e.multiple){t=[];for(var o=[e.firstChild];o.length;)for(var r=o.pop();r;r=r.nextSibling){if(1!=r.nodeType||"option"!=r.tagName.toLowerCase()){r.nextSibling&&o.push(r.nextSibling),r.firstChild&&o.push(r.firstChild);break}r.selected&&t.push(r.value)}}else t=e.value}return t},toObject:function(e){for(var t,i,n,o,r={},l=c.byId(e).elements,a=0,u=l.length;a<u;++a){var s=l[a],f=s.name,d=(s.type||"").toLowerCase();f&&d&&"file|submit|image|reset|button".indexOf(d)<0&&!s.disabled&&(t=r,i=f,n=y.fieldToObject(s),o=void 0,null!==n&&("string"==typeof(o=t[i])?t[i]=[o,n]:b.isArray(o)?o.push(n):t[i]=n),"image"==d&&(r[f+".x"]=r[f+".y"]=r[f].x=r[f].y=0))}return r},toQuery:function(e){return t.objectToQuery(y.toObject(e))},toJson:function(e,t){return i.stringify(y.toObject(e),null,t?4:0)}};return y});
define(["./sniff","./_base/window","./dom","./dom-style"],function(c,d,h,s){var b={boxModel:"content-box"};c("ie")&&(b.boxModel="BackCompat"==document.compatMode?"border-box":"content-box"),b.getPadExtents=function(t,e){t=h.byId(t);var o=e||s.getComputedStyle(t),r=s.toPixelValue,n=r(t,o.paddingLeft),i=r(t,o.paddingTop),d=r(t,o.paddingRight),l=r(t,o.paddingBottom);return{l:n,t:i,r:d,b:l,w:n+d,h:i+l}};var y="none";function f(t,e,o,r,n,i){i=i||"px";var d=t.style;isNaN(e)||(d.left=e+i),isNaN(o)||(d.top=o+i),0<=r&&(d.width=r+i),0<=n&&(d.height=n+i)}function u(t){return"button"==t.tagName.toLowerCase()||"input"==t.tagName.toLowerCase()&&"button"==(t.getAttribute("type")||"").toLowerCase()}function g(t){return"border-box"==b.boxModel||"table"==t.tagName.toLowerCase()||u(t)}function i(t){var e,o={x:0,y:0,width:0,height:0,top:0,right:0,bottom:0,left:0};try{e=t.getBoundingClientRect()}catch(t){return o}return void 0===e.left?o:e}b.getBorderExtents=function(t,e){t=h.byId(t);var o=s.toPixelValue,r=e||s.getComputedStyle(t),n=r.borderLeftStyle!=y?o(t,r.borderLeftWidth):0,i=r.borderTopStyle!=y?o(t,r.borderTopWidth):0,d=r.borderRightStyle!=y?o(t,r.borderRightWidth):0,l=r.borderBottomStyle!=y?o(t,r.borderBottomWidth):0;return{l:n,t:i,r:d,b:l,w:n+d,h:i+l}},b.getPadBorderExtents=function(t,e){t=h.byId(t);var o=e||s.getComputedStyle(t),r=b.getPadExtents(t,o),n=b.getBorderExtents(t,o);return{l:r.l+n.l,t:r.t+n.t,r:r.r+n.r,b:r.b+n.b,w:r.w+n.w,h:r.h+n.h}},b.getMarginExtents=function(t,e){t=h.byId(t);var o=e||s.getComputedStyle(t),r=s.toPixelValue,n=r(t,o.marginLeft),i=r(t,o.marginTop),d=r(t,o.marginRight),l=r(t,o.marginBottom);return{l:n,t:i,r:d,b:l,w:n+d,h:i+l}},b.getMarginBox=function(t,e){t=h.byId(t);var o,r=e||s.getComputedStyle(t),n=b.getMarginExtents(t,r),i=t.offsetLeft-n.l,d=t.offsetTop-n.t,l=t.parentNode,a=s.toPixelValue;return 8!=c("ie")||c("quirks")||l&&(i-=(o=s.getComputedStyle(l)).borderLeftStyle!=y?a(t,o.borderLeftWidth):0,d-=o.borderTopStyle!=y?a(t,o.borderTopWidth):0),{l:i,t:d,w:t.offsetWidth+n.w,h:t.offsetHeight+n.h}},b.getContentBox=function(t,e){t=h.byId(t);var o,r,n,i=e||s.getComputedStyle(t),d=t.clientWidth,l=b.getPadExtents(t,i),a=b.getBorderExtents(t,i),f=t.offsetLeft+l.l+a.l,u=t.offsetTop+l.t+a.t,g=d?t.clientHeight:(d=t.offsetWidth-a.w,t.offsetHeight-a.h);return 8!=c("ie")||c("quirks")||(o=t.parentNode,r=s.toPixelValue,o&&(f-=(n=s.getComputedStyle(o)).borderLeftStyle!=y?r(t,n.borderLeftWidth):0,u-=n.borderTopStyle!=y?r(t,n.borderTopWidth):0)),{l:f,t:u,w:d-l.w,h:g-l.h}},b.setContentSize=function(t,e,o){t=h.byId(t);var r,n=e.w,i=e.h;g(t)&&(r=b.getPadBorderExtents(t,o),0<=n&&(n+=r.w),0<=i&&(i+=r.h)),f(t,NaN,NaN,n,i)};var p={l:0,t:0,w:0,h:0};return b.setMarginBox=function(t,e,o){t=h.byId(t);var r,n=o||s.getComputedStyle(t),i=e.w,d=e.h,l=g(t)?p:b.getPadBorderExtents(t,n),a=b.getMarginExtents(t,n);c("webkit")&&u(t)&&(r=t.style,0<=i&&!r.width&&(r.width="4px"),0<=d&&!r.height&&(r.height="4px")),0<=i&&(i=Math.max(i-l.w-a.w,0)),0<=d&&(d=Math.max(d-l.h-a.h,0)),f(t,e.l,e.t,i,d)},b.isBodyLtr=function(t){return t=t||d.doc,"ltr"==(d.body(t).dir||t.documentElement.dir||"ltr").toLowerCase()},b.docScroll=function(t){var e=(t=t||d.doc).parentWindow||t.defaultView;return"pageXOffset"in e?{x:e.pageXOffset,y:e.pageYOffset}:(e=c("quirks")?d.body(t):t.documentElement)&&{x:b.fixIeBiDiScrollLeft(e.scrollLeft||0,t),y:e.scrollTop||0}},b.getIeDocumentElementOffset=function(t){return{x:0,y:0}},b.fixIeBiDiScrollLeft=function(t,e){e=e||d.doc;var o=c("ie");if(!o||b.isBodyLtr(e))return t;var r=c("quirks"),n=r?d.body(e):e.documentElement,i=d.global;return 6==o&&!r&&i.frameElement&&n.scrollHeight>n.clientHeight&&(t+=n.clientLeft),o<8||r?t+n.clientWidth-n.scrollWidth:-t},b.position=function(t,e){t=h.byId(t);var o,r=d.body(t.ownerDocument),n={x:(n=i(t)).left,y:n.top,w:n.right-n.left,h:n.bottom-n.top};return c("ie")<9&&(n.x-=c("quirks")?r.clientLeft+r.offsetLeft:0,n.y-=c("quirks")?r.clientTop+r.offsetTop:0),e&&(o=b.docScroll(t.ownerDocument),n.x+=o.x,n.y+=o.y),n},b.getMarginSize=function(t,e){t=h.byId(t);var o=b.getMarginExtents(t,e||s.getComputedStyle(t)),r=i(t);return{w:r.right-r.left+o.w,h:r.bottom-r.top+o.h}},b.normalizeEvent=function(t){var e,o,r;"layerX"in t||(t.layerX=t.offsetX,t.layerY=t.offsetY),"pageX"in t||(o=(e=t.target)&&e.ownerDocument||document,r=c("quirks")?o.body:o.documentElement,t.pageX=t.clientX+b.fixIeBiDiScrollLeft(r.scrollLeft||0,o),t.pageY=t.clientY+(r.scrollTop||0))},b});
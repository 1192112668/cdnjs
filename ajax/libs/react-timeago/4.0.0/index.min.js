"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},_slicedToArray=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var r=[],o=!0,n=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(o=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);o=!0);}catch(t){n=!0,i=t}finally{try{!o&&u.return&&u.return()}finally{if(n)throw i}}return r}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},_createClass=function(){function o(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(t,e,r){return e&&o(t.prototype,e),r&&o(t,r),t}}(),_react=require("react"),React=_interopRequireWildcard(_react);function _interopRequireWildcard(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function _objectWithoutProperties(t,e){var r={};for(var o in t)0<=e.indexOf(o)||Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o]);return r}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var Component=React.Component,MINUTE=60,HOUR=60*MINUTE,DAY=24*HOUR,WEEK=7*DAY,MONTH=30*DAY,YEAR=365*DAY,TimeAgo=function(){function i(){var t,e,a;_classCallCheck(this,i);for(var r=arguments.length,o=Array(r),n=0;n<r;n++)o[n]=arguments[n];return(e=a=_possibleConstructorReturn(this,(t=i.__proto__||Object.getPrototypeOf(i)).call.apply(t,[this].concat(o)))).isStillMounted=!1,a.tick=function(t){var e,r,o,n,i;a.isStillMounted&&a.props.live&&(e=new Date(a.props.date).valueOf(),r=Date.now(),n=(o=Math.round(Math.abs(r-e)/1e3))<MINUTE?1e3:o<HOUR?1e3*MINUTE:o<DAY?1e3*HOUR:0,(i=Math.min(Math.max(n,1e3*a.props.minPeriod),1e3*a.props.maxPeriod))&&(a.timeoutId=setTimeout(a.tick,i)),t||a.forceUpdate())},_possibleConstructorReturn(a,e)}return _inherits(i,Component),_createClass(i,[{key:"componentDidMount",value:function(){this.isStillMounted=!0,this.props.live&&this.tick(!0)}},{key:"componentDidUpdate",value:function(t){this.props.live===t.live&&this.props.date===t.date||(!this.props.live&&this.timeoutId&&clearTimeout(this.timeoutId),this.tick())}},{key:"componentWillUnmount",value:function(){this.isStillMounted=!1,this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=void 0)}},{key:"render",value:function(){var t=this.props,e=t.date,r=(t.formatter,t.component),o=(t.live,t.minPeriod,t.maxPeriod,t.title),n=_objectWithoutProperties(t,["date","formatter","component","live","minPeriod","maxPeriod","title"]),i=new Date(e).valueOf(),a=Date.now(),u=Math.round(Math.abs(a-i)/1e3),s=i<a?"ago":"from now",l=u<MINUTE?[Math.round(u),"second"]:u<HOUR?[Math.round(u/MINUTE),"minute"]:u<DAY?[Math.round(u/HOUR),"hour"]:u<WEEK?[Math.round(u/DAY),"day"]:u<MONTH?[Math.round(u/WEEK),"week"]:u<YEAR?[Math.round(u/MONTH),"month"]:[Math.round(u/YEAR),"year"],c=_slicedToArray(l,2),p=c[0],f=c[1],d=void 0===o?"string"==typeof e?e:new Date(e).toISOString().substr(0,16).replace("T"," "):o,h="time"===r?Object.assign({},n,{dateTime:new Date(e).toISOString()}):n;return React.createElement(r,_extends({},h,{title:d}),this.props.formatter(p,f,s,i))}}]),i}();TimeAgo.displayName="TimeAgo",TimeAgo.defaultProps={live:!0,component:"time",minPeriod:0,maxPeriod:1/0,formatter:function(t,e,r){return 1!==t&&(e+="s"),t+" "+e+" "+r}},exports.default=TimeAgo;
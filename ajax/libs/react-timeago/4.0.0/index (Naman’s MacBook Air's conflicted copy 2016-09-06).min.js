"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _slicedToArray=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],o=!0,n=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(o=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);o=!0);}catch(e){n=!0,i=e}finally{try{!o&&s.return&&s.return()}finally{if(n)throw i}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},_createClass=function(){function o(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),e}}(),_react=require("react"),_react2=_interopRequireDefault(_react);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var MINUTE=60,HOUR=60*MINUTE,DAY=24*HOUR,WEEK=7*DAY,MONTH=30*DAY,YEAR=365*DAY,TimeAgo=function(){function i(){var e,t,a;_classCallCheck(this,i);for(var r=arguments.length,o=Array(r),n=0;n<r;n++)o[n]=arguments[n];return(t=a=_possibleConstructorReturn(this,(e=Object.getPrototypeOf(i)).call.apply(e,[this].concat(o)))).isStillMounted=!1,a.tick=function(e){var t,r,o,n,i;a.isStillMounted&&a.props.live&&(t=new Date(a.props.date).valueOf(),r=Date.now(),n=(o=Math.round(Math.abs(r-t)/1e3))<MINUTE?1e3:o<HOUR?1e3*MINUTE:o<DAY?1e3*HOUR:0,(i=Math.min(Math.max(n,1e3*a.props.minPeriod),1e3*a.props.maxPeriod))&&(a.timeoutId=setTimeout(a.tick,i)),e||a.forceUpdate())},_possibleConstructorReturn(a,t)}return _inherits(i,_react.Component),_createClass(i,[{key:"componentDidMount",value:function(){this.isStillMounted=!0,this.props.live&&this.tick(!0)}},{key:"componentDidUpdate",value:function(e){this.props.live===e.live&&this.props.date===e.date||(!this.props.live&&this.timeoutId&&clearTimeout(this.timeoutId),this.tick())}},{key:"componentWillUnmount",value:function(){this.isStillMounted=!1,this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=void 0)}},{key:"render",value:function(){var e=new Date(this.props.date).valueOf(),t=Date.now(),r=Math.round(Math.abs(t-e)/1e3),o=e<t?"ago":"from now",n=r<MINUTE?[Math.round(r),"second"]:r<HOUR?[Math.round(r/MINUTE),"minute"]:r<DAY?[Math.round(r/HOUR),"hour"]:r<WEEK?[Math.round(r/DAY),"day"]:r<MONTH?[Math.round(r/WEEK),"week"]:r<YEAR?[Math.round(r/MONTH),"month"]:[Math.round(r/YEAR),"year"],i=_slicedToArray(n,2),a=i[0],s=i[1],u=Object.assign({},this.props);u.title=u.title||"string"==typeof u.date?u.date:new Date(u.date).toISOString().substr(0,16).replace("T"," "),"time"===u.component&&(u.dateTime=new Date(u.date).toISOString()),delete u.date,delete u.formatter,delete u.component;var p=this.props.component;return _react2.default.createElement(p,u,this.props.formatter(a,s,o,e))}}]),i}();TimeAgo.displayName="TimeAgo",TimeAgo.propTypes={live:_react.PropTypes.bool.isRequired,minPeriod:_react.PropTypes.number.isRequired,maxPeriod:_react.PropTypes.number.isRequired,component:_react.PropTypes.oneOfType([_react.PropTypes.string,_react.PropTypes.func]).isRequired,formatter:_react.PropTypes.func.isRequired,date:_react.PropTypes.oneOfType([_react.PropTypes.string,_react.PropTypes.number,_react.PropTypes.instanceOf(Date)]).isRequired},TimeAgo.defaultProps={live:!0,component:"time",minPeriod:0,maxPeriod:1/0,formatter:function(e,t,r){return 1!==e&&(t+="s"),e+" "+t+" "+r}},exports.default=TimeAgo;
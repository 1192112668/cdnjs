"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}(),_utils=require("./utils"),utils=_interopRequireWildcard(_utils);function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var storage={setItem:function(e,t){if(window.localStorage)try{window.localStorage.setItem(e,t)}catch(e){}},getItem:function(e,t){if(window.localStorage)try{return window.localStorage.getItem(e,t)}catch(e){return}}};function getDefaults(){return{enabled:!1,prefix:"i18next_res_",expirationTime:6048e5}}var Cache=function(){function n(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,n),this.init(e,t),this.type="cache",this.debouncedStore=utils.debounce(this.store,1e4)}return _createClass(n,[{key:"init",value:function(e,t){var n=1<arguments.length&&void 0!==t?t:{};this.services=e,this.options=utils.defaults(n,this.options||{},getDefaults())}},{key:"load",value:function(e,n){var i=this,r={},a=(new Date).getTime();if(!window.localStorage||!e.length)return n(null,null);var o=e.length;e.forEach(function(e){var t=storage.getItem(i.options.prefix+e);t&&(t=JSON.parse(t)).i18nStamp&&t.i18nStamp+i.options.expirationTime>a&&(r[e]=t),0===--o&&n(null,r)})}},{key:"store",value:function(e){if(window.localStorage)for(var t in e)e[t].i18nStamp=(new Date).getTime(),storage.setItem(this.options.prefix+t,JSON.stringify(e[t]))}},{key:"save",value:function(e){this.debouncedStore(e)}}]),n}();Cache.type="cache",exports.default=Cache;
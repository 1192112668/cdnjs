"use strict";var helpers=require("./helpers.js"),__chunk_2=require("./chunk-cd0dcc1d.js"),__chunk_3=require("./chunk-cdf52db8.js"),AM="AM",PM="PM",HOUR_FORMAT_24="24",HOUR_FORMAT_12="12",defaultTimeFormatter=function(e,t){var i=e.getHours(),n=e.getMinutes(),s=e.getSeconds(),u="";return t.hourFormat===HOUR_FORMAT_12&&(u=" "+(i<12?AM:PM),12<i?i-=12:0===i&&(i=12)),t.pad(i)+":"+t.pad(n)+(t.enableSeconds?":"+t.pad(s):"")+u},defaultTimeParser=function(e,t){if(e){var i,n=!1;t.hourFormat===HOUR_FORMAT_12&&(e=(i=e.split(" "))[0],n=i[1]===AM);var s=e.split(":"),u=parseInt(s[0],10),r=parseInt(s[1],10),o=t.enableSeconds?parseInt(s[2],10):0;if(isNaN(u)||u<0||23<u||t.hourFormat===HOUR_FORMAT_12&&(u<1||12<u)||isNaN(r)||r<0||59<r)return null;var l=null;return t.computedValue&&!isNaN(t.computedValue)?l=new Date(t.computedValue):(l=t.timeCreator()).setMilliseconds(0),l.setSeconds(o),l.setMinutes(r),t.hourFormat===HOUR_FORMAT_12&&(n&&12===u?u=0:n||12===u||(u+=12)),l.setHours(u),new Date(l.getTime())}return null},TimepickerMixin={mixins:[__chunk_3.FormElementMixin],inheritAttrs:!1,props:{value:Date,inline:Boolean,minTime:Date,maxTime:Date,placeholder:String,editable:Boolean,disabled:Boolean,hourFormat:{type:String,default:HOUR_FORMAT_24,validator:function(e){return e===HOUR_FORMAT_24||e===HOUR_FORMAT_12}},incrementHours:{type:Number,default:1},incrementMinutes:{type:Number,default:1},incrementSeconds:{type:Number,default:1},timeFormatter:{type:Function,default:function(e,t){return"function"==typeof __chunk_2.config.defaultTimeFormatter?__chunk_2.config.defaultTimeFormatter(e):defaultTimeFormatter(e,t)}},timeParser:{type:Function,default:function(e,t){return"function"==typeof __chunk_2.config.defaultTimeParser?__chunk_2.config.defaultTimeParser(e):defaultTimeParser(e,t)}},mobileNative:{type:Boolean,default:function(){return __chunk_2.config.defaultTimepickerMobileNative}},timeCreator:{type:Function,default:function(){return"function"==typeof __chunk_2.config.defaultTimeCreator?__chunk_2.config.defaultTimeCreator():new Date}},position:String,unselectableTimes:Array,openOnFocus:Boolean,enableSeconds:Boolean,defaultMinutes:Number,defaultSeconds:Number,focusable:{type:Boolean,default:!0},tzOffset:{type:Number,default:0},appendToBody:Boolean},data:function(){return{dateSelected:this.value,hoursSelected:null,minutesSelected:null,secondsSelected:null,meridienSelected:null,_elementRef:"input",AM:AM,PM:PM,HOUR_FORMAT_24:HOUR_FORMAT_24,HOUR_FORMAT_12:HOUR_FORMAT_12}},computed:{computedValue:{get:function(){return this.dateSelected},set:function(e){this.dateSelected=e,this.$emit("input",this.dateSelected)}},hours:function(){if(!this.incrementHours||this.incrementHours<1)throw new Error("Hour increment cannot be null or less than 1.");for(var e=[],t=this.isHourFormat24?24:12,i=0;i<t;i+=this.incrementHours){var n=i,s=n;this.isHourFormat24||(s=n=i+1,this.meridienSelected===this.AM?12===n&&(n=0):this.meridienSelected===this.PM&&12!==n&&(n+=12)),e.push({label:this.formatNumber(s),value:n})}return e},minutes:function(){if(!this.incrementMinutes||this.incrementMinutes<1)throw new Error("Minute increment cannot be null or less than 1.");for(var e=[],t=0;t<60;t+=this.incrementMinutes)e.push({label:this.formatNumber(t,!0),value:t});return e},seconds:function(){if(!this.incrementSeconds||this.incrementSeconds<1)throw new Error("Second increment cannot be null or less than 1.");for(var e=[],t=0;t<60;t+=this.incrementSeconds)e.push({label:this.formatNumber(t,!0),value:t});return e},meridiens:function(){return[AM,PM]},isMobile:function(){return this.mobileNative&&helpers.isMobile.any()},isHourFormat24:function(){return this.hourFormat===HOUR_FORMAT_24}},watch:{hourFormat:function(){null!==this.hoursSelected&&(this.meridienSelected=12<=this.hoursSelected?PM:AM)},value:{handler:function(e){this.updateInternalState(e),this.isValid||this.$refs.input.checkHtml5Validity()},immediate:!0}},methods:{onMeridienChange:function(e){null!==this.hoursSelected&&(e===PM?this.hoursSelected+=12:e===AM&&(this.hoursSelected-=12)),this.updateDateSelected(this.hoursSelected,this.minutesSelected,this.enableSeconds?this.secondsSelected:0,e)},onHoursChange:function(e){this.minutesSelected||void 0===this.defaultMinutes||(this.minutesSelected=this.defaultMinutes),this.secondsSelected||void 0===this.defaultSeconds||(this.secondsSelected=this.defaultSeconds),this.updateDateSelected(parseInt(e,10),this.minutesSelected,this.enableSeconds?this.secondsSelected:0,this.meridienSelected)},onMinutesChange:function(e){!this.secondsSelected&&this.defaultSeconds&&(this.secondsSelected=this.defaultSeconds),this.updateDateSelected(this.hoursSelected,parseInt(e,10),this.enableSeconds?this.secondsSelected:0,this.meridienSelected)},onSecondsChange:function(e){this.updateDateSelected(this.hoursSelected,this.minutesSelected,parseInt(e,10),this.meridienSelected)},updateDateSelected:function(e,t,i,n){var s;null!=e&&null!=t&&(!this.isHourFormat24&&null!==n||this.isHourFormat24)&&(s=null,this.computedValue&&!isNaN(this.computedValue)?s=new Date(this.computedValue):(s=this.timeCreator()).setMilliseconds(0),s.setHours(e),s.setMinutes(t),s.setSeconds(i),this.computedValue=new Date(s.getTime()))},updateInternalState:function(e){e?(this.hoursSelected=e.getHours(),this.minutesSelected=e.getMinutes(),this.secondsSelected=e.getSeconds(),this.meridienSelected=12<=e.getHours()?PM:AM):(this.hoursSelected=null,this.minutesSelected=null,this.secondsSelected=null,this.meridienSelected=AM),this.dateSelected=e},isHourDisabled:function(t){var e,i,n=this,s=!1;return this.minTime&&(e=this.minTime.getHours(),i=this.minutes.every(function(e){return n.isMinuteDisabledForHour(t,e.value)}),s=t<e||i),this.maxTime&&(s=s||this.maxTime.getHours()<t),this.unselectableTimes&&(s=s||0<this.unselectableTimes.filter(function(e){return n.enableSeconds&&null!==n.secondsSelected?e.getHours()===t&&e.getMinutes()===n.minutesSelected&&e.getSeconds()===n.secondsSelected:null!==n.minutesSelected?e.getHours()===t&&e.getMinutes()===n.minutesSelected:e.getHours()===t}).length),s},isMinuteDisabledForHour:function(e,t){var i,n,s,u,r=!1;return this.minTime&&(i=this.minTime.getHours(),n=this.minTime.getMinutes(),r=e===i&&t<n),this.maxTime&&(r||(s=this.maxTime.getHours(),u=this.maxTime.getMinutes(),r=e===s&&u<t)),r},isMinuteDisabled:function(t){var i=this,e=!1;return null!==this.hoursSelected&&(e=!!this.isHourDisabled(this.hoursSelected)||this.isMinuteDisabledForHour(this.hoursSelected,t),this.unselectableTimes&&(e=e||0<this.unselectableTimes.filter(function(e){return i.enableSeconds&&null!==i.secondsSelected?e.getHours()===i.hoursSelected&&e.getMinutes()===t&&e.getSeconds()===i.secondsSelected:e.getHours()===i.hoursSelected&&e.getMinutes()===t}).length)),e},isSecondDisabled:function(t){var e,i,n,s,u,r,o=this,l=!1;return null!==this.minutesSelected&&(this.isMinuteDisabled(this.minutesSelected)?l=!0:(this.minTime&&(e=this.minTime.getHours(),i=this.minTime.getMinutes(),n=this.minTime.getSeconds(),l=this.hoursSelected===e&&this.minutesSelected===i&&t<n),this.maxTime&&(l||(s=this.maxTime.getHours(),u=this.maxTime.getMinutes(),r=this.maxTime.getSeconds(),l=this.hoursSelected===s&&this.minutesSelected===u&&r<t))),this.unselectableTimes&&(l=l||0<this.unselectableTimes.filter(function(e){return e.getHours()===o.hoursSelected&&e.getMinutes()===o.minutesSelected&&e.getSeconds()===t}).length)),l},onChange:function(e){var t=this.timeParser(e,this);this.updateInternalState(t),t&&!isNaN(t)?this.computedValue=t:(this.computedValue=null,this.$refs.input.newValue=this.computedValue)},toggle:function(e){this.$refs.dropdown&&(this.$refs.dropdown.isActive="boolean"==typeof e?e:!this.$refs.dropdown.isActive)},close:function(){this.toggle(!1)},handleOnFocus:function(){this.onFocus(),this.openOnFocus&&this.toggle(!0)},formatHHMMSS:function(e){var t=new Date(e);if(!e||isNaN(t))return"";var i=t.getHours(),n=t.getMinutes(),s=t.getSeconds();return this.formatNumber(i,!0)+":"+this.formatNumber(n,!0)+":"+this.formatNumber(s,!0)},onChangeNativePicker:function(e){var t,i,n=e.target.value;n?(t=null,this.computedValue&&!isNaN(this.computedValue)?t=new Date(this.computedValue):(t=new Date).setMilliseconds(0),i=n.split(":"),t.setHours(parseInt(i[0],10)),t.setMinutes(parseInt(i[1],10)),t.setSeconds(i[2]?parseInt(i[2],10):0),this.computedValue=new Date(t.getTime())):this.computedValue=null},formatNumber:function(e,t){return this.isHourFormat24||t?this.pad(e):e},pad:function(e){return(e<10?"0":"")+e},formatValue:function(e){return e&&!isNaN(e)?this.timeFormatter(e,this):null},keyPress:function(e){this.$refs.dropdown&&this.$refs.dropdown.isActive&&27===e.keyCode&&this.toggle(!1)},onActiveChange:function(e){e||this.onBlur()}},created:function(){"undefined"!=typeof window&&document.addEventListener("keyup",this.keyPress)},beforeDestroy:function(){"undefined"!=typeof window&&document.removeEventListener("keyup",this.keyPress)}};exports.TimepickerMixin=TimepickerMixin;
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CanvasUtils=void 0;var ColorUtils_1=require("./ColorUtils"),Utils_1=require("./Utils"),CanvasUtils=function(){function t(){}return t.paintBase=function(t,e,o){t.save(),t.fillStyle=null!=o?o:"rgba(0,0,0,0)",t.fillRect(0,0,e.width,e.height),t.restore()},t.clear=function(t,e){t.clearRect(0,0,e.width,e.height)},t.drawLinkLine=function(t,e,o,i,l,r,s,a,n,d,h){var g,y,f,C,c,w,U,u,x,v,p,S,b,_,m,k,P,L=!1;Utils_1.Utils.getDistance(o,i)<=l?(this.drawLine(t,o,i),L=!0):s&&(w=c=void 0,g={x:i.x-r.width,y:i.y},f=(y=Utils_1.Utils.getDistances(o,g)).dx,C=y.dy,y.distance<=l?(c={x:0,y:m=o.y-C/f*o.x},w={x:r.width,y:m}):(U={x:i.x,y:i.y-r.height},x=(u=Utils_1.Utils.getDistances(o,U)).dx,v=u.dy,u.distance<=l?(c={x:k=-(m=o.y-v/x*o.x)/(v/x),y:0},w={x:k,y:r.height}):(p={x:i.x-r.width,y:i.y-r.height},b=(S=Utils_1.Utils.getDistances(o,p)).dx,_=S.dy,S.distance<=l&&(w={x:(c={x:k=-(m=o.y-_/b*o.x)/(_/b),y:m}).x+r.width,y:c.y+r.height}))),c&&w&&(this.drawLine(t,o,c),this.drawLine(t,i,w),L=!0)),L&&(t.lineWidth=e,a&&(t.globalCompositeOperation="destination-out"),t.strokeStyle=ColorUtils_1.ColorUtils.getStyleFromRgb(n,d),!h.enable||(P=ColorUtils_1.ColorUtils.colorToRgb(h.color))&&(t.shadowBlur=h.blur,t.shadowColor=ColorUtils_1.ColorUtils.getStyleFromRgb(P)),t.stroke())},t.drawLinkTriangle=function(t,e,o,i,l,r,s,a){this.drawTriangle(t,o,i,l),t.lineWidth=e,r&&(t.globalCompositeOperation="destination-out"),t.fillStyle=ColorUtils_1.ColorUtils.getStyleFromRgb(s,a),t.fill()},t.drawConnectLine=function(t,e,o,i,l){t.save(),this.drawLine(t,i,l),t.lineWidth=e,t.strokeStyle=o,t.stroke(),t.restore()},t.gradient=function(t,e,o,i){var l=Math.floor(o.size.value/e.size.value),r=e.getColor(),s=o.getColor();if(r&&s){var a=e.getPosition(),n=o.getPosition(),d=ColorUtils_1.ColorUtils.mix(r,s,e.size.value,o.size.value),h=t.createLinearGradient(a.x,a.y,n.x,n.y);return h.addColorStop(0,ColorUtils_1.ColorUtils.getStyleFromHsl(r,i)),h.addColorStop(1<l?1:l,ColorUtils_1.ColorUtils.getStyleFromRgb(d,i)),h.addColorStop(1,ColorUtils_1.ColorUtils.getStyleFromHsl(s,i)),h}},t.drawGrabLine=function(t,e,o,i,l,r){t.save(),this.drawLine(t,o,i),t.strokeStyle=ColorUtils_1.ColorUtils.getStyleFromRgb(l,r),t.lineWidth=e,t.stroke(),t.restore()},t.drawParticle=function(t,e,o,i,l,r,s,a,n){var d=o.getPosition();e.save(),e.translate(d.x,d.y),e.beginPath(),0!==o.angle&&e.rotate(o.angle*Math.PI/180),r&&(e.globalCompositeOperation="destination-out"),this.drawShape(t,e,o,s,a,i);var h=o.shadowColor;n.enable&&h&&(e.shadowBlur=n.blur,e.shadowColor=ColorUtils_1.ColorUtils.getStyleFromRgb(h),e.shadowOffsetX=n.offset.x,e.shadowOffsetY=n.offset.y),e.fillStyle=l;var g=o.stroke;e.lineWidth=g.width,o.strokeColor&&(e.strokeStyle=ColorUtils_1.ColorUtils.getStyleFromRgb(o.strokeColor,o.stroke.opacity)),o.close&&e.closePath(),0<g.width&&o.strokeColor&&e.stroke(),o.fill&&e.fill(),e.restore(),e.save(),e.translate(d.x,d.y),0!==o.angle&&e.rotate(o.angle*Math.PI/180),r&&(e.globalCompositeOperation="destination-out"),this.drawShapeAfterEffect(t,e,o,s,a,i),e.restore()},t.drawShape=function(t,e,o,i,l,r){var s;!o.shape||(s=t.drawers[o.shape])&&s.draw(e,o,i,l,r)},t.drawShapeAfterEffect=function(t,e,o,i,l,r){var s;!o.shape||null!=(s=t.drawers[o.shape])&&s.afterEffect&&s.afterEffect(e,o,i,l,r)},t.drawPlugin=function(t,e,o){void 0!==e.draw&&(t.save(),e.draw(t,o),t.restore())},t.drawLine=function(t,e,o){t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(o.x,o.y),t.closePath()},t.drawTriangle=function(t,e,o,i){t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(o.x,o.y),t.lineTo(i.x,i.y),t.closePath()},t}();exports.CanvasUtils=CanvasUtils;
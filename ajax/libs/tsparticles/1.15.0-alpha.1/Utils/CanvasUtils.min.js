"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CanvasUtils=void 0;var ColorUtils_1=require("./ColorUtils"),Utils_1=require("./Utils"),CanvasUtils=function(){function t(){}return t.paintBase=function(t,o,e){t.save(),t.fillStyle=null!=e?e:"rgba(0,0,0,0)",t.fillRect(0,0,o.width,o.height),t.restore()},t.clear=function(t,o){t.clearRect(0,0,o.width,o.height)},t.drawLinkLine=function(t,o,e,i,l,r,s,a,n,h,d){var g,y,c,f,w,C,U,x,u=Utils_1.Utils.getDistance(e,i);u<=l?this.drawLine(t,e,i):s&&(g={x:i.x-r.width,y:i.y},(u=Utils_1.Utils.getDistance(e,g))<=l?(f=e.x-(i.x-r.width),w=e.y-i.y,C=e.y-w/f*e.x,this.drawLine(t,e,{x:0,y:C}),this.drawLine(t,i,{x:r.width,y:C})):(y={x:i.x,y:i.y-r.height},(u=Utils_1.Utils.getDistance(e,y))<=l?(f=e.x-i.x,w=e.y-(i.y-r.height),U=-(C=e.y-w/f*e.x)/(w/f),this.drawLine(t,e,{x:U,y:0}),this.drawLine(t,i,{x:U,y:r.height})):(c={x:i.x-r.width,y:i.y-r.height},(u=Utils_1.Utils.getDistance(e,c))<=l&&(f=e.x-(i.x-r.width),w=e.y-(i.y-r.height),U=-(C=e.y-w/f*e.x)/(w/f),this.drawLine(t,e,{x:U,y:C}),this.drawLine(t,i,{x:U+r.width,y:C+r.height}))))),t.lineWidth=o,a&&(t.globalCompositeOperation="destination-out"),t.strokeStyle=ColorUtils_1.ColorUtils.getStyleFromRgb(n,h),!d.enable||(x="string"==typeof d.color?ColorUtils_1.ColorUtils.stringToRgb(d.color):ColorUtils_1.ColorUtils.colorToRgb(d.color))&&(t.shadowBlur=d.blur,t.shadowColor=ColorUtils_1.ColorUtils.getStyleFromRgb(x)),t.stroke()},t.drawLinkTriangle=function(t,o,e,i,l,r,s,a){this.drawTriangle(t,e,i,l),t.lineWidth=o,r&&(t.globalCompositeOperation="destination-out"),t.fillStyle=ColorUtils_1.ColorUtils.getStyleFromRgb(s,a),t.fill()},t.drawConnectLine=function(t,o,e,i,l){t.save(),this.drawLine(t,i,l),t.lineWidth=o,t.strokeStyle=e,t.stroke(),t.restore()},t.gradient=function(t,o,e,i){var l=Math.floor(e.size.value/o.size.value);if(o.color&&e.color){var r=o.getPosition(),s=e.getPosition(),a=ColorUtils_1.ColorUtils.mix(o.color,e.color,o.size.value,e.size.value),n=t.createLinearGradient(r.x,r.y,s.x,s.y);return n.addColorStop(0,ColorUtils_1.ColorUtils.getStyleFromHsl(o.color,i)),n.addColorStop(1<l?1:l,ColorUtils_1.ColorUtils.getStyleFromRgb(a,i)),n.addColorStop(1,ColorUtils_1.ColorUtils.getStyleFromHsl(e.color,i)),n}},t.drawGrabLine=function(t,o,e,i,l,r){t.save(),this.drawLine(t,e,i),t.strokeStyle=ColorUtils_1.ColorUtils.getStyleFromRgb(l,r),t.lineWidth=o,t.stroke(),t.restore()},t.drawParticle=function(t,o,e,i,l,r,s,a,n){var h=e.getPosition();o.save(),o.translate(h.x,h.y),o.beginPath(),0!==e.angle&&o.rotate(e.angle*Math.PI/180),r&&(o.globalCompositeOperation="destination-out");var d=e.shadowColor;n.enable&&d&&(o.shadowBlur=n.blur,o.shadowColor=ColorUtils_1.ColorUtils.getStyleFromRgb(d),o.shadowOffsetX=n.offset.x,o.shadowOffsetY=n.offset.y),o.fillStyle=l;var g=e.stroke;0<g.width&&e.strokeColor&&(o.strokeStyle=ColorUtils_1.ColorUtils.getStyleFromRgb(e.strokeColor,e.stroke.opacity),o.lineWidth=g.width),this.drawShape(t,o,e,s,a,i),e.close&&o.closePath(),0<g.width&&e.strokeColor&&o.stroke(),e.fill&&o.fill(),o.restore(),o.save(),o.translate(h.x,h.y),0!==e.angle&&o.rotate(e.angle*Math.PI/180),r&&(o.globalCompositeOperation="destination-out"),this.drawShapeAfterEffect(t,o,e,s,a,i),o.restore()},t.drawShape=function(t,o,e,i,l,r){var s;!e.shape||(s=t.drawers[e.shape])&&s.draw(o,e,i,l,r)},t.drawShapeAfterEffect=function(t,o,e,i,l,r){var s;!e.shape||(s=t.drawers[e.shape])&&void 0!==s.afterEffect&&s.afterEffect(o,e,i,l,r)},t.drawPlugin=function(t,o,e){t.save(),void 0!==o.draw&&o.draw(t,e),t.restore()},t.drawLine=function(t,o,e){t.beginPath(),t.moveTo(o.x,o.y),t.lineTo(e.x,e.y),t.closePath()},t.drawTriangle=function(t,o,e,i){t.beginPath(),t.moveTo(o.x,o.y),t.lineTo(e.x,e.y),t.lineTo(i.x,i.y),t.moveTo(e.x,e.y),t.lineTo(i.x,i.y),t.closePath()},t}();exports.CanvasUtils=CanvasUtils;
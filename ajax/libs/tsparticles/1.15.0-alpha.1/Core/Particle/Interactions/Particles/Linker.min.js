"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Linker=void 0;var ColorUtils_1=require("../../../../Utils/ColorUtils"),Constants_1=require("../../../../Utils/Constants"),Utils_1=require("../../../../Utils/Utils"),Circle_1=require("../../../../Utils/Circle"),CircleWarp_1=require("../../../../Utils/CircleWarp"),Linker=function(){function i(){}return i.link=function(i,e,t){for(var n,l=i.particlesOptions.lineLinked,r=l.opacity,s=null!==(n=i.lineLinkedDistance)&&void 0!==n?n:e.retina.lineLinkedDistance,o=e.canvas.size,a=l.warp,c=i.getPosition(),p=a?new CircleWarp_1.CircleWarp(c.x,c.y,s,o):new Circle_1.Circle(c.x,c.y,s),C=0,d=e.particles.quadTree.query(p);C<d.length;C++){var u=d[C];if(i!==u&&u.particlesOptions.lineLinked.enable){var k,U,_,L=u.getPosition(),x=Utils_1.Utils.getDistance(c,L);if(a&&s<x&&(k={x:L.x-o.width,y:L.y},s<(x=Utils_1.Utils.getDistance(c,k))&&(U={x:L.x-o.width,y:L.y-o.height},s<(x=Utils_1.Utils.getDistance(c,U))&&(_={x:L.x,y:L.y-o.height},x=Utils_1.Utils.getDistance(c,_)))),s<x)return;var y,f,g=r-x*r/s;0<g&&(e.particles.lineLinkedColor||((f="string"==typeof(y=i.particlesOptions.lineLinked.color)?y:y.value)!==Constants_1.Constants.randomColorValue||i.particlesOptions.lineLinked.consent?e.particles.lineLinkedColor=ColorUtils_1.ColorUtils.colorToRgb({value:f}):i.particlesOptions.lineLinked.blink?e.particles.lineLinkedColor=Constants_1.Constants.randomColorValue:e.particles.lineLinkedColor=Constants_1.Constants.midColorValue),-1==u.links.map(function(i){return i.destination}).indexOf(i)&&-1==i.links.map(function(i){return i.destination}).indexOf(u)&&i.links.push({destination:u,opacity:g}))}}},i}();exports.Linker=Linker;
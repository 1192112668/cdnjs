"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CanvasUtils=void 0;var ColorUtils_1=require("./ColorUtils"),Utils_1=require("./Utils"),CanvasUtils=function(){function t(){}return t.paintBase=function(t,o,e){t.save(),t.fillStyle=null!=e?e:"rgba(0,0,0,0)",t.fillRect(0,0,o.width,o.height),t.restore()},t.clear=function(t,o){t.clearRect(0,0,o.width,o.height)},t.drawLinkLine=function(t,o,e,i,l,r,s,a,n,d,h){var y,c,g,f,C,w,U,u,x,v,p,S,b,_,m,k,P;Utils_1.Utils.getDistance(e,i)<=l?this.drawLine(t,e,i):s&&(w=C=void 0,y={x:i.x-r.width,y:i.y},g=(c=Utils_1.Utils.getDistances(e,y)).dx,f=c.dy,c.distance<=l?(C={x:0,y:m=e.y-f/g*e.x},w={x:r.width,y:m}):(U={x:i.x,y:i.y-r.height},x=(u=Utils_1.Utils.getDistances(e,U)).dx,v=u.dy,u.distance<=l?(C={x:k=-(m=e.y-v/x*e.x)/(v/x),y:0},w={x:k,y:r.height}):(p={x:i.x-r.width,y:i.y-r.height},b=(S=Utils_1.Utils.getDistances(e,p)).dx,_=S.dy,S.distance<=l&&(w={x:(C={x:k=-(m=e.y-_/b*e.x)/(_/b),y:m}).x+r.width,y:C.y+r.height}))),C&&w&&(this.drawLine(t,e,C),this.drawLine(t,i,w))),t.lineWidth=o,a&&(t.globalCompositeOperation="destination-out"),t.strokeStyle=ColorUtils_1.ColorUtils.getStyleFromRgb(n,d),!h.enable||(P=ColorUtils_1.ColorUtils.colorToRgb(h.color))&&(t.shadowBlur=h.blur,t.shadowColor=ColorUtils_1.ColorUtils.getStyleFromRgb(P)),t.stroke()},t.drawLinkTriangle=function(t,o,e,i,l,r,s,a){this.drawTriangle(t,e,i,l),t.lineWidth=o,r&&(t.globalCompositeOperation="destination-out"),t.fillStyle=ColorUtils_1.ColorUtils.getStyleFromRgb(s,a),t.fill()},t.drawConnectLine=function(t,o,e,i,l){t.save(),this.drawLine(t,i,l),t.lineWidth=o,t.strokeStyle=e,t.stroke(),t.restore()},t.gradient=function(t,o,e,i){var l=Math.floor(e.size.value/o.size.value);if(o.color&&e.color){var r=o.getPosition(),s=e.getPosition(),a=ColorUtils_1.ColorUtils.mix(o.color,e.color,o.size.value,e.size.value),n=t.createLinearGradient(r.x,r.y,s.x,s.y);return n.addColorStop(0,ColorUtils_1.ColorUtils.getStyleFromHsl(o.color,i)),n.addColorStop(1<l?1:l,ColorUtils_1.ColorUtils.getStyleFromRgb(a,i)),n.addColorStop(1,ColorUtils_1.ColorUtils.getStyleFromHsl(e.color,i)),n}},t.drawGrabLine=function(t,o,e,i,l,r){t.save(),this.drawLine(t,e,i),t.strokeStyle=ColorUtils_1.ColorUtils.getStyleFromRgb(l,r),t.lineWidth=o,t.stroke(),t.restore()},t.drawParticle=function(t,o,e,i,l,r,s,a,n){var d=e.getPosition();o.save(),o.translate(d.x,d.y),o.beginPath(),0!==e.angle&&o.rotate(e.angle*Math.PI/180),r&&(o.globalCompositeOperation="destination-out");var h=e.shadowColor;n.enable&&h&&(o.shadowBlur=n.blur,o.shadowColor=ColorUtils_1.ColorUtils.getStyleFromRgb(h),o.shadowOffsetX=n.offset.x,o.shadowOffsetY=n.offset.y),o.fillStyle=l;var y=e.stroke;0<y.width&&e.strokeColor&&(o.strokeStyle=ColorUtils_1.ColorUtils.getStyleFromRgb(e.strokeColor,e.stroke.opacity),o.lineWidth=y.width),this.drawShape(t,o,e,s,a,i),e.close&&o.closePath(),0<y.width&&e.strokeColor&&o.stroke(),e.fill&&o.fill(),o.restore(),o.save(),o.translate(d.x,d.y),0!==e.angle&&o.rotate(e.angle*Math.PI/180),r&&(o.globalCompositeOperation="destination-out"),this.drawShapeAfterEffect(t,o,e,s,a,i),o.restore()},t.drawShape=function(t,o,e,i,l,r){var s;!e.shape||(s=t.drawers[e.shape])&&s.draw(o,e,i,l,r)},t.drawShapeAfterEffect=function(t,o,e,i,l,r){var s;!e.shape||null!=(s=t.drawers[e.shape])&&s.afterEffect&&s.afterEffect(o,e,i,l,r)},t.drawPlugin=function(t,o,e){void 0!==o.draw&&(t.save(),o.draw(t,e),t.restore())},t.drawLine=function(t,o,e){t.beginPath(),t.moveTo(o.x,o.y),t.lineTo(e.x,e.y),t.closePath()},t.drawTriangle=function(t,o,e,i){t.beginPath(),t.moveTo(o.x,o.y),t.lineTo(e.x,e.y),t.lineTo(i.x,i.y),t.moveTo(e.x,e.y),t.lineTo(i.x,i.y),t.closePath()},t}();exports.CanvasUtils=CanvasUtils;
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CanvasUtils=void 0;var ColorUtils_1=require("./ColorUtils"),Utils_1=require("./Utils"),CanvasUtils=function(){function t(){}return t.paintBase=function(t,o,e){t.save(),t.fillStyle=null!=e?e:"rgba(0,0,0,0)",t.fillRect(0,0,o.width,o.height),t.restore()},t.clear=function(t,o){t.clearRect(0,0,o.width,o.height)},t.drawLinkLine=function(t,o,e,l,i,r,s,a,n,d,h){var g,c,y,C,f,U,u,w,v,x,b,p,S,_,m,k,P;Utils_1.Utils.getDistance(e,l)<=i?this.drawLine(t,e,l):s&&(U=f=void 0,g={x:l.x-r.width,y:l.y},y=(c=Utils_1.Utils.getDistances(e,g)).dx,C=c.dy,c.distance<=i?(f={x:0,y:m=e.y-C/y*e.x},U={x:r.width,y:m}):(u={x:l.x,y:l.y-r.height},v=(w=Utils_1.Utils.getDistances(e,u)).dx,x=w.dy,w.distance<=i?(f={x:k=-(m=e.y-x/v*e.x)/(x/v),y:0},U={x:k,y:r.height}):(b={x:l.x-r.width,y:l.y-r.height},S=(p=Utils_1.Utils.getDistances(e,b)).dx,_=p.dy,p.distance<=i&&(U={x:(f={x:k=-(m=e.y-_/S*e.x)/(_/S),y:m}).x+r.width,y:f.y+r.height}))),f&&U&&(this.drawLine(t,e,f),this.drawLine(t,l,U))),t.lineWidth=o,a&&(t.globalCompositeOperation="destination-out"),t.strokeStyle=ColorUtils_1.ColorUtils.getStyleFromRgb(n,d),!h.enable||(P=ColorUtils_1.ColorUtils.colorToRgb(h.color))&&(t.shadowBlur=h.blur,t.shadowColor=ColorUtils_1.ColorUtils.getStyleFromRgb(P)),t.stroke()},t.drawLinkTriangle=function(t,o,e,l,i,r,s,a){this.drawTriangle(t,e,l,i),t.lineWidth=o,r&&(t.globalCompositeOperation="destination-out"),t.fillStyle=ColorUtils_1.ColorUtils.getStyleFromRgb(s,a),t.fill()},t.drawConnectLine=function(t,o,e,l,i){t.save(),this.drawLine(t,l,i),t.lineWidth=o,t.strokeStyle=e,t.stroke(),t.restore()},t.gradient=function(t,o,e,l){var i,r,s=Math.floor(e.size.value/o.size.value),a=null!==(i=o.bubble.color)&&void 0!==i?i:o.color?ColorUtils_1.ColorUtils.hslToRgb(o.color):void 0,n=null!==(r=e.bubble.color)&&void 0!==r?r:e.color?ColorUtils_1.ColorUtils.hslToRgb(e.color):void 0;if(a&&n){var d=o.getPosition(),h=e.getPosition(),g=ColorUtils_1.ColorUtils.mix(a,n,o.size.value,e.size.value),c=t.createLinearGradient(d.x,d.y,h.x,h.y);return c.addColorStop(0,ColorUtils_1.ColorUtils.getStyleFromRgb(a,l)),c.addColorStop(1<s?1:s,ColorUtils_1.ColorUtils.getStyleFromRgb(g,l)),c.addColorStop(1,ColorUtils_1.ColorUtils.getStyleFromRgb(n,l)),c}},t.drawGrabLine=function(t,o,e,l,i,r){t.save(),this.drawLine(t,e,l),t.strokeStyle=ColorUtils_1.ColorUtils.getStyleFromRgb(i,r),t.lineWidth=o,t.stroke(),t.restore()},t.drawParticle=function(t,o,e,l,i,r,s,a,n){var d=e.getPosition();o.save(),o.translate(d.x,d.y),o.beginPath(),0!==e.angle&&o.rotate(e.angle*Math.PI/180),r&&(o.globalCompositeOperation="destination-out");var h=e.shadowColor;n.enable&&h&&(o.shadowBlur=n.blur,o.shadowColor=ColorUtils_1.ColorUtils.getStyleFromRgb(h),o.shadowOffsetX=n.offset.x,o.shadowOffsetY=n.offset.y),o.fillStyle=i;var g=e.stroke;0<g.width&&e.strokeColor&&(o.strokeStyle=ColorUtils_1.ColorUtils.getStyleFromRgb(e.strokeColor,e.stroke.opacity),o.lineWidth=g.width),this.drawShape(t,o,e,s,a,l),e.close&&o.closePath(),0<g.width&&e.strokeColor&&o.stroke(),e.fill&&o.fill(),o.restore(),o.save(),o.translate(d.x,d.y),0!==e.angle&&o.rotate(e.angle*Math.PI/180),r&&(o.globalCompositeOperation="destination-out"),this.drawShapeAfterEffect(t,o,e,s,a,l),o.restore()},t.drawShape=function(t,o,e,l,i,r){var s;!e.shape||(s=t.drawers[e.shape])&&s.draw(o,e,l,i,r)},t.drawShapeAfterEffect=function(t,o,e,l,i,r){var s;!e.shape||null!=(s=t.drawers[e.shape])&&s.afterEffect&&s.afterEffect(o,e,l,i,r)},t.drawPlugin=function(t,o,e){void 0!==o.draw&&(t.save(),o.draw(t,e),t.restore())},t.drawLine=function(t,o,e){t.beginPath(),t.moveTo(o.x,o.y),t.lineTo(e.x,e.y),t.closePath()},t.drawTriangle=function(t,o,e,l){t.beginPath(),t.moveTo(o.x,o.y),t.lineTo(e.x,e.y),t.lineTo(l.x,l.y),t.closePath()},t}();exports.CanvasUtils=CanvasUtils;
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Linker=void 0;const Utils_1=require("../../../../Utils");class Linker{constructor(i){this.container=i}isEnabled(i){return i.particlesOptions.links.enable}reset(){}interact(i){var t;const s=this.container,e=i.particlesOptions.links,n=e.opacity,o=null!==(t=i.linksDistance)&&void 0!==t?t:s.retina.linksDistance,l=s.canvas.size,r=e.warp,a=i.getPosition(),c=r?new Utils_1.CircleWarp(a.x,a.y,o,l):new Utils_1.Circle(a.x,a.y,o),p=s.particles.quadTree.query(c);for(const t of p){const c=t.particlesOptions.links;if(i===t||!c.enable||e.id!==c.id)continue;const p=t.getPosition();let d=Utils_1.Utils.getDistance(a,p);if(r&&d>o){const i={x:p.x-l.width,y:p.y};if((d=Utils_1.Utils.getDistance(a,i))>o){const i={x:p.x-l.width,y:p.y-l.height};if((d=Utils_1.Utils.getDistance(a,i))>o){const i={x:p.x,y:p.y-l.height};d=Utils_1.Utils.getDistance(a,i)}}}if(d>o)return;const U=n-d*n/o;if(U>0){const e=i.particlesOptions.links;let n=void 0!==e.id?s.particles.linksColors.get(e.id):s.particles.linksColor;if(!n){const i=e.color,t="string"==typeof i?i:i.value;n=t===Utils_1.Constants.randomColorValue?e.consent?Utils_1.ColorUtils.colorToRgb({value:t}):e.blink?Utils_1.Constants.randomColorValue:Utils_1.Constants.midColorValue:Utils_1.ColorUtils.colorToRgb({value:t}),void 0!==e.id?s.particles.linksColors.set(e.id,n):s.particles.linksColor=n}-1===t.links.map(i=>i.destination).indexOf(i)&&-1===i.links.map(i=>i.destination).indexOf(t)&&i.links.push({destination:t,opacity:U})}}}}exports.Linker=Linker;
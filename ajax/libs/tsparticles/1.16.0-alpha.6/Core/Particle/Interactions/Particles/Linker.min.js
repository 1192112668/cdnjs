"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Linker=void 0;const Utils_1=require("../../../../Utils");class Linker{constructor(i){this.container=i}isEnabled(i){return i.particlesOptions.links.enable}reset(i){}interact(i,t){var s;const n=this.container,e=i.particlesOptions.links,o=e.opacity,l=null!==(s=i.linksDistance)&&void 0!==s?s:n.retina.linksDistance,r=n.canvas.size,a=e.warp,c=i.getPosition(),p=a?new Utils_1.CircleWarp(c.x,c.y,l,r):new Utils_1.Circle(c.x,c.y,l),d=n.particles.quadTree.query(p);for(const t of d){const s=t.particlesOptions.links;if(i===t||!s.enable||e.id!==s.id)continue;const p=t.getPosition();let d=Utils_1.Utils.getDistance(c,p);if(a&&d>l){const i={x:p.x-r.width,y:p.y};if((d=Utils_1.Utils.getDistance(c,i))>l){const i={x:p.x-r.width,y:p.y-r.height};if((d=Utils_1.Utils.getDistance(c,i))>l){const i={x:p.x,y:p.y-r.height};d=Utils_1.Utils.getDistance(c,i)}}}if(d>l)return;const U=o-d*o/l;if(U>0){const s=i.particlesOptions.links;let e=void 0!==s.id?n.particles.linksColors[s.id]:n.particles.linksColor;if(!e){const i=s.color,t="string"==typeof i?i:i.value;e=t===Utils_1.Constants.randomColorValue?s.consent?Utils_1.ColorUtils.colorToRgb({value:t}):s.blink?Utils_1.Constants.randomColorValue:Utils_1.Constants.midColorValue:Utils_1.ColorUtils.colorToRgb({value:t}),void 0!==s.id?n.particles.linksColors[s.id]=e:n.particles.linksColor=e}-1===t.links.map(i=>i.destination).indexOf(i)&&-1===i.links.map(i=>i.destination).indexOf(t)&&i.links.push({destination:t,opacity:U})}}}}exports.Linker=Linker;
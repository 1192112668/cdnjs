!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.ShareThis=t()}(this,function(){"use strict";function o(e,t){return e[n=n||function(e){for(var t="atchesSelector",n=["matches","m"+t,"webkitM"+t,"mozM"+t,"msM"+t,"oM"+t],o=0;o<n.length;o++){var r=n[o];if(e[r])return r}}(e)](t)}function h(e,t){for(var n=e;n&&(1!==n.nodeType||!o(n,t));)n=n.parentNode;return n}function v(e){return"function"==typeof e}function s(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function m(e,t,n){var o,r,i=n.document,a=i.defaultView,c=function(e){if(e.isCollapsed)return!0;var t=e.anchorNode.compareDocumentPosition(e.focusNode);return t?0<(4&t):e.anchorOffset<e.focusOffset}(a.getSelection()),u=function(e,t){var n=void 0,o=e.getClientRects(),r=[].slice.bind(o);if(t){for(var i=1/0,a=o.length;a--;){var c=o[a];if(c.left>i)break;i=c.left}n=r(a+1)}else{for(var u=-1/0,f=0;f<o.length;f++){var l=o[f];if(l.right<u)break;u=l.right}n=r(0,f)}return{top:Math.min.apply(Math,s(n.map(function(e){return e.top}))),bottom:Math.max.apply(Math,s(n.map(function(e){return e.bottom}))),left:n[0].left,right:n[n.length-1].right}}(t,c),f=(r=(o=a).document.body,("static"===o.getComputedStyle(r).position?r.parentNode:r).getBoundingClientRect()),l=e.style;c?l.right=i.documentElement.clientWidth-u.right+f.left+"px":l.left=u.left-f.left+"px",l.width=u.right-u.left+"px",l.height=u.bottom-u.top+"px",l.top=u.top-f.top+"px",l.position="absolute",e.className=n.popoverClass}function g(e,t){var n,o=h(t.target,"["+r+"]");!o||(n=function(e,t){for(var n=0;n<e.length;n++){var o=e[n];if(o.name===t)return o}}(e,o.getAttribute(r)))&&v(n.action)&&n.action(t,o)}var n=void 0,y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r="data-share-via",b=void 0,C=["selectionchange","mouseup","touchend","touchcancel"];return function(e){function n(e){l.addEventListener(e,r)}function t(e){l.removeEventListener(e,r)}function o(){p&&m(p,a(),u)}function r(e){var t=e.type;!p!=("selectionchange"===t)&&setTimeout(function(){var e,t,n,o,r,i=a();i?(t=!p,n=(e=i).toString(),o=u.transformer(n),(r=u.sharers.filter(function(e,t,n){var o=n.active;return v(o)?o(e,t):o===b||o}.bind(null,o,n))).length?(t&&(p=d.createPopover()),p.sharers=r,p.innerHTML=function(e,t,n,o){var r=e.shareUrl||e.document.defaultView.location;return"<ul>"+t.map(function(e){return'<li data-share-via="'+e.name+'">'+e.render.call(e,n,o,r)+"</li>"}).join("")+"</ul>"}(u,r,o,n),m(p,e,u),t&&(d.attachPopover(p),v(u.onOpen)&&u.onOpen(p,o,n))):p&&c()):c()},10)}function a(){var e=s.getSelection(),t=e.rangeCount&&e.getRangeAt(0);if(t){var n=function(e,t){var n=e.cloneRange();if(e.collapsed||!t)return n;var o,r,i,a=h(e.startContainer,t);return a?(o=a,r=e.endContainer,!(i=o.compareDocumentPosition(r))||0<(16&i)||n.setEnd(a,a.childNodes.length)):(a=h(e.endContainer,t))?n.setStart(a,0):n.collapse(),n}(t,u.selector);if(!n.collapsed&&n.getClientRects().length)return n}}function c(){p&&(d.removePopover(p),p=b,v(u.onClose)&&u.onClose())}var u=(Object.assign||function(e,t){if(t&&"object"===(void 0===t?"undefined":y(t)))for(var n in t)e[n]=t[n];return e})({document:document,selector:"body",sharers:[],popoverClass:"share-this-popover",transformer:function(e){return e.trim().replace(/\s+/g," ")}},e||{}),i=!1,f=!1,l=b,s=b,p=b,d=b;return{init:function(){return!i&&(l=u.document,(s=l.defaultView).getSelection?(C.forEach(n),s.addEventListener("resize",o),t=l,d={createPopover:function(){var e=t.createElement("div");return e.addEventListener("click",function(e){g(this.sharers,e)}),e},attachPopover:function(e){t.body.appendChild(e)},removePopover:function(e){var t=e.parentNode;t&&t.removeChild(e)}},i=!0):(console.warn("share-this: Selection API isn't supported"),!1));var t},destroy:function(){return!(!i||f)&&(C.forEach(t),s.removeEventListener("resize",o),c(),f=!(s=l=b))}}}});
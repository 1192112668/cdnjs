"use strict";import H from"../Core/Globals.js";import SVGElement from"../Core/Renderer/SVG/SVGElement.js";import SVGRenderer from"../Core/Renderer/SVG/SVGRenderer.js";import U from"../Core/Utilities.js";var addEvent=U.addEvent,defined=U.defined,isNumber=U.isNumber,merge=U.merge,objectEach=U.objectEach,seriesType=U.seriesType,wrap=U.wrap;import"../Core/Series/Series.js";import"../Core/Renderer/SVG/SVGRenderer.js";import onSeriesMixin from"../Mixins/OnSeries.js";var noop=H.noop,Renderer=H.Renderer,Series=H.Series,TrackerMixin=H.TrackerMixin,VMLRenderer=H.VMLRenderer,symbols=SVGRenderer.prototype.symbols;function createPinSymbol(e){symbols[e+"pin"]=function(r,t,i,o,s){var n,a=s&&s.anchorX,l=s&&s.anchorY;if("circle"===e&&o>i&&(r-=Math.round((o-i)/2),i=o),n=symbols[e](r,t,i,o),a&&l){var p=a;if("circle"===e)p=r+i/2;else{var c=n[0],h=n[1];"M"===c[0]&&"L"===h[0]&&(p=(c[1]+h[1])/2)}var d=t>l?t:t+o;n.push(["M",p,d],["L",a,l]),n=n.concat(symbols.circle(a-1,l-1,2,2))}return n}}seriesType("flags","column",{pointRange:0,allowOverlapX:!1,shape:"flag",stackDistance:12,textAlign:"center",tooltip:{pointFormat:"{point.text}<br/>"},threshold:null,y:-30,fillColor:"#ffffff",lineWidth:1,states:{hover:{lineColor:"#000000",fillColor:"#ccd6eb"}},style:{fontSize:"11px",fontWeight:"bold"}},{sorted:!1,noSharedTooltip:!0,allowDG:!1,takeOrdinalPosition:!1,trackerGroups:["markerGroup"],forceCrop:!0,init:Series.prototype.init,pointAttribs:function(e,r){var t=this.options,i=e&&e.color||this.color,o=t.lineColor,s=e&&e.lineWidth,n=e&&e.fillColor||t.fillColor;return r&&(n=t.states[r].fillColor,o=t.states[r].lineColor,s=t.states[r].lineWidth),{fill:n||i,stroke:o||i,"stroke-width":s||t.lineWidth||0}},translate:onSeriesMixin.translate,getPlotBox:onSeriesMixin.getPlotBox,drawPoints:function(){var e,r,t,i,o,s,n,a,l,p,c,h=this.points,d=this.chart,f=d.renderer,u=d.inverted,m=this.options,y=m.y,g=this.yAxis,v={},b=[];for(i=h.length;i--;)o=h[i],p=(u?o.plotY:o.plotX)>this.xAxis.len,e=o.plotX,n=o.stackIndex,t=o.options.shape||m.shape,void 0!==(r=o.plotY)&&(r=o.plotY+y-(void 0!==n&&n*m.stackDistance)),o.anchorX=n?void 0:o.plotX,a=n?void 0:o.plotY,c="flag"!==t,s=o.graphic,void 0!==r&&e>=0&&!p?(s||(s=o.graphic=f.label("",null,null,t,null,null,m.useHTML),d.styledMode||s.attr(this.pointAttribs(o)).css(merge(m.style,o.style)),s.attr({align:c?"center":"left",width:m.width,height:m.height,"text-align":m.textAlign}).addClass("highcharts-point").add(this.markerGroup),o.graphic.div&&(o.graphic.div.point=o),d.styledMode||s.shadow(m.shadow),s.isNew=!0),e>0&&(e-=s.strokeWidth()%2),l={y:r,anchorY:a},m.allowOverlapX&&(l.x=e,l.anchorX=o.anchorX),s.attr({text:o.options.title||m.title||"A"})[s.isNew?"attr":"animate"](l),m.allowOverlapX||(v[o.plotX]?v[o.plotX].size=Math.max(v[o.plotX].size,s.width):v[o.plotX]={align:c?.5:0,size:s.width,target:e,anchorX:e}),o.tooltipPos=[e,r+g.pos-d.plotTop]):s&&(o.graphic=s.destroy());m.allowOverlapX||(objectEach(v,function(e){e.plotX=e.anchorX,b.push(e)}),H.distribute(b,u?g.len:this.xAxis.len,100),h.forEach(function(e){var r=e.graphic&&v[e.plotX];r&&(e.graphic[e.graphic.isNew?"attr":"animate"]({x:r.pos+r.align*r.size,anchorX:e.anchorX}),defined(r.pos)?e.graphic.isNew=!1:(e.graphic.attr({x:-9999,anchorX:-9999}),e.graphic.isNew=!0))})),m.useHTML&&wrap(this.markerGroup,"on",function(e){return SVGElement.prototype.on.apply(e.apply(this,[].slice.call(arguments,1)),[].slice.call(arguments,1))})},drawTracker:function(){var e=this.points;TrackerMixin.drawTrackerPoint.apply(this),e.forEach(function(r){var t=r.graphic;t&&addEvent(t.element,"mouseover",function(){r.stackIndex>0&&!r.raised&&(r._y=t.y,t.attr({y:r._y-8}),r.raised=!0),e.forEach(function(e){e!==r&&e.raised&&e.graphic&&(e.graphic.attr({y:e._y}),e.raised=!1)})})})},animate:function(e){e&&this.setClip()},setClip:function(){Series.prototype.setClip.apply(this,arguments),!1!==this.options.clip&&this.sharedClipKey&&this.markerGroup.clip(this.chart[this.sharedClipKey])},buildKDTree:noop,invertGroups:noop},{isValid:function(){return isNumber(this.y)||void 0===this.y}}),symbols.flag=function(e,r,t,i,o){var s=o&&o.anchorX||e,n=o&&o.anchorY||r,a=symbols.circle(s-1,n-1,2,2);return a.push(["M",s,n],["L",e,r+i],["L",e,r],["L",e+t,r],["L",e+t,r+i],["L",e,r+i],["Z"]),a},createPinSymbol("circle"),createPinSymbol("square"),Renderer===VMLRenderer&&["circlepin","flag","squarepin"].forEach(function(e){VMLRenderer.prototype.symbols[e]=symbols[e]});
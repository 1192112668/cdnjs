"use strict";import H from"../../Core/Globals.js";import U from"../../Core/Utilities.js";var correctFloat=U.correctFloat,isArray=U.isArray,seriesType=U.seriesType;import requiredIndicator from"../../Mixins/IndicatorRequired.js";var EMAindicator=H.seriesTypes.ema;seriesType("tema","ema",{},{init:function(){var e=arguments,t=this;requiredIndicator.isParentLoaded(EMAindicator,"ema",t.type,function(r){r.prototype.init.apply(t,e)})},getEMA:function(e,t,r,l,i,a){return EMAindicator.prototype.calculateEma(a||[],e,void 0===i?1:i,this.chart.series[0].EMApercent,t,void 0===l?-1:l,r)},getTemaPoint:function(e,t,r,l){return[e[l-3],correctFloat(3*r.level1-3*r.level2+r.level3)]},getValues:function(e,t){var r,l,i,a,o=t.period,s=2*o,v=3*o,n=e.xData,p=e.yData,c=p?p.length:0,u=-1,d=0,h=0,m=[],y=[],A=[],E=[],M=[],f={};if(e.EMApercent=2/(o+1),!(c<3*o-2)){for(isArray(p[0])&&(u=t.index?t.index:0),h=(d=EMAindicator.prototype.accumulatePeriodPoints(o,u,p))/o,d=0,i=o;i<c+3;i++)i<c+1&&(f.level1=this.getEMA(p,r,h,u,i)[1],E.push(f.level1)),r=f.level1,i<s?d+=f.level1:(i===s&&(h=d/o,d=0),f.level1=E[i-o-1],f.level2=this.getEMA([f.level1],l,h)[1],M.push(f.level2),l=f.level2,i<v?d+=f.level2:(i===v&&(h=d/o),i===c+1&&(f.level1=E[i-o-1],f.level2=this.getEMA([f.level1],l,h)[1],M.push(f.level2)),f.level1=E[i-o-2],f.level2=M[i-2*o-1],f.level3=this.getEMA([f.level2],f.prevLevel3,h)[1],(a=this.getTemaPoint(n,v,f,i))&&(m.push(a),y.push(a[0]),A.push(a[1])),f.prevLevel3=f.level3));return{values:m,xData:y,yData:A}}}});
"use strict";import H from"../../Core/Globals.js";import U from"../../Core/Utilities.js";var isArray=U.isArray,merge=U.merge,seriesType=U.seriesType;import multipleLinesMixin from"../../Mixins/MultipleLines.js";var SMA=H.seriesTypes.sma;function getStandardDeviation(i,t,e,o){for(var a,r=0,s=i.length,n=0;n<s;n++)r+=(a=(e?i[n][t]:i[n])-o)*a;return r/=s-1,Math.sqrt(r)}seriesType("bb","sma",{params:{period:20,standardDeviation:2,index:3},bottomLine:{styles:{lineWidth:1,lineColor:void 0}},topLine:{styles:{lineWidth:1,lineColor:void 0}},tooltip:{pointFormat:'<span style="color:{point.color}">‚óè</span><b> {series.name}</b><br/>Top: {point.top}<br/>Middle: {point.middle}<br/>Bottom: {point.bottom}<br/>'},marker:{enabled:!1},dataGrouping:{approximation:"averages"}},merge(multipleLinesMixin,{pointArrayMap:["top","middle","bottom"],pointValKey:"middle",nameComponents:["period","standardDeviation"],linesApiNames:["topLine","bottomLine"],init:function(){SMA.prototype.init.apply(this,arguments),this.options=merge({topLine:{styles:{lineColor:this.color}},bottomLine:{styles:{lineColor:this.color}}},this.options)},getValues:function(i,t){var e,o,a,r,s,n,l,p,m,d,y=t.period,u=t.standardDeviation,b=i.xData,h=i.yData,g=h?h.length:0,v=[],D=[],c=[];if(!(b.length<y)){for(p=isArray(h[0]),d=y;d<=g;d++)s=b.slice(d-y,d),n=h.slice(d-y,d),r=(m=SMA.prototype.getValues.call(this,{xData:s,yData:n},t)).xData[0],o=(e=m.yData[0])+u*(l=getStandardDeviation(n,t.index,p,e)),a=e-u*l,v.push([r,o,e,a]),D.push(r),c.push([o,e,a]);return{values:v,xData:D,yData:c}}}}));
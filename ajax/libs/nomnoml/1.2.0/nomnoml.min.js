!function(t){"object"==typeof module&&module.exports?module.exports=t(require("dagre")):this.nomnoml=t(dagre)}(function(I){!function(t){t.buildStyle=function(t){return{bold:t.bold||!1,underline:t.underline||!1,italic:t.italic||!1,dashed:t.dashed||!1,empty:t.empty||!1,center:t.center||!1,fill:t.fill||void 0,stroke:t.stroke||void 0,visual:t.visual||"class",direction:t.direction||void 0}};function n(t,n,e){this.lines=t,this.nodes=n,this.relations=e}t.Compartment=n;function e(){}t.Relation=e;function i(t,n,e){this.type=t,this.name=n,this.compartments=e,this.dividers=[]}t.Classifier=i}(u=u||{});var C,W=this&&this.__spreadArrays||function(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;for(var i=Array(t),r=0,n=0;n<e;n++)for(var a=arguments[n],s=0,o=a.length;s<o;s++,r++)i[r]=a[s];return i};(C=u=u||{}).layout=function(A,E,t){function i(t,n,e){var i,r,a,s=(r=t.lines,a=n?"normal":"bold",r.length?(A.setFont(E,a,"normal"),{width:Math.round(Math.max.apply(Math,r.map(A.textWidth))+2*E.padding),height:Math.round(A.textHeight()*r.length+2*E.padding)}):{width:0,height:E.padding});if(!t.nodes.length&&!t.relations.length)return t.width=s.width,t.height=s.height,void(t.offset={x:E.padding,y:E.padding});t.nodes.forEach(P);var o=new I.graphlib.Graph;o.setGraph({rankdir:e.direction||E.direction,nodesep:E.spacing,edgesep:E.spacing,ranksep:E.spacing,acyclicer:E.acyclicer,ranker:E.ranker});for(var l=0,h=t.nodes;l<h.length;l++){var c=h[l];o.setNode(c.name,{width:c.layoutWidth,height:c.layoutHeight})}for(var u=0,d=t.relations;u<d.length;u++){var f=d[u];-1<f.assoc.indexOf("_")?o.setEdge(f.start,f.end,{id:f.id,minlen:0}):1!=(null!==(i=E.gravity)&&void 0!==i?i:1)?o.setEdge(f.start,f.end,{id:f.id,minlen:E.gravity}):o.setEdge(f.start,f.end,{id:f.id})}I.layout(o);var y=C.skanaar.indexBy(t.relations,"id"),p=C.skanaar.indexBy(t.nodes,"name");o.nodes().forEach(function(t){var n=o.node(t);p[t].x=n.x,p[t].y=n.y});var g=0,m=0,x=0,v=0;o.edges().forEach(function(t){var n=o.edge(t),e=p[t.v],i=p[t.w],r=y[n.id];r.path=W([e],n.points,[i]).map(T);var a=r.path[1],s=r.path[r.path.length-2];L(r.startLabel,a,z(M(a,e,4),e,i)),L(r.endLabel,s,z(M(s,i,2),i,e)),g=Math.min.apply(Math,W([g,r.startLabel.x,r.endLabel.x],n.points.map(function(t){return t.x}),n.points.map(function(t){return t.x}))),m=Math.max.apply(Math,W([m,r.startLabel.x+r.startLabel.width,r.endLabel.x+r.endLabel.width],n.points.map(function(t){return t.x}))),x=Math.min.apply(Math,W([x,r.startLabel.y,r.endLabel.y],n.points.map(function(t){return t.y}))),v=Math.max.apply(Math,W([v,r.startLabel.y+r.startLabel.height,r.endLabel.y+r.endLabel.height],n.points.map(function(t){return t.y})))});var k=o.graph(),w=Math.max(k.width,m-g),b=Math.max(k.height,v-x),S=b?b+2*E.gutter:0,_=w?w+2*E.gutter:0;t.width=Math.max(s.width,_)+2*E.padding,t.height=s.height+S+E.padding,t.offset={x:E.padding-g,y:E.padding-x}}function T(t){return{x:t.x,y:t.y}}function L(t,n,e){var i,r;t.text?(i=E.fontSize,r=t.text.split("`"),t.width=Math.max.apply(Math,r.map(function(t){return A.textWidth(t)})),t.height=i*r.length,t.x=n.x+(1==e||4==e?E.padding:-t.width-E.padding),t.y=n.y+(3==e||4==e?E.padding:-t.height-E.padding)):(t.width=0,t.height=0,t.x=n.x,t.y=n.y)}function M(t,n,e){return t.x<n.x&&t.y<n.y?1:t.x>n.x&&t.y<n.y?2:t.x>n.x&&t.y>n.y?3:t.x<n.x&&t.y>n.y?4:e}function z(t,n,e){if(e.x==n.x||e.y==n.y)return t;if((e.y<n.y?e.x<n.x?2:1:e.x<n.x?3:4)===t){if("LR"===E.direction)return[4,3,2,1][t-1];if("TB"===E.direction)return[2,1,4,3][t-1]}return t}function P(t){var e=E.styles[t.type]||C.styles.CLASS;t.compartments.forEach(function(t,n){i(t,n,e)}),C.layouters[e.visual](E,t),t.layoutWidth=t.width+2*E.edgeMargin,t.layoutHeight=t.height+2*E.edgeMargin}return i(t,0,C.styles.CLASS),t};var i,o,t,n,f,h,x,e,r,p,a,s,l,c,u,g,d=this&&this.__extends||(i=function(t,n){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}i(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)});function y(){return t.call(this,"max_import_depth exceeded")||this}function m(t,n,e,i){var r,a,s,o,l,h=f.parse(t),c=h.config,u=(r=c,a=n,{setFont:function(t,n,e){a.setFont(t.font,n,e,r.fontSize)},textWidth:function(t){return a.measureText(t).width},textHeight:function(){return r.leading*r.fontSize}}),d=f.layout(u,c,h.root);return e&&(s=e,o=d,l=c.zoom*i,s.width=o.width*l,s.height=o.height*l),c.zoom*=i,f.render(n,c,d,u.setFont),{config:c,layout:d}}function v(t){return(null!=t?t:"").toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function k(t,n){n.width=Math.max.apply(Math,n.compartments.map(function(t){return t.width})),n.height=g.skanaar.sum(n.compartments,function(t){return t.height}),n.dividers=[];for(var e=0,i=0,r=n.compartments;i<r.length;i++){var a=r[i];a.x=0,a.y=e,a.width=n.width,e+=a.height,a!=g.skanaar.last(n.compartments)&&n.dividers.push([{x:0,y:e},{x:n.width,y:e}])}}function w(t,n){n.dividers=[],n.compartments=[],n.width=2.5*t.fontSize,n.height=2.5*t.fontSize}o=u=u||{},t=Error,d(y,t),n=y,o.ImportDepthError=n,o.compileFile=function(t,n){var e=require("fs"),i=require("path"),r=i.dirname(t),a=t.substr(r.length);function s(t){return e.readFileSync(i.join(r,t),{encoding:"utf8"})}return o.processImports(s(a),s,n)},(f=u=u||{}).version="1.2.0",f.draw=function(t,n,e){return m(n,f.skanaar.Canvas(t),t,e||1)},f.renderSvg=function(t,n){var e=f.skanaar.Svg("",n),i=m(t,e,null,1),r=i.config,a=i.layout;return e.serialize({width:a.width,height:a.height},t,r.title)},f.processImports=function e(t,i,r){if(void 0===r&&(r=10),-1==r)throw new f.ImportDepthError;return t.replace(/#import: *(.*)/g,function(t,n){return e(function(t){try{return i(t)||""}catch(t){return""}}(n),i,r-1)})},(h=u=u||{}).parse=function(t){var n=t.split("\n").map(function(t,n){return{text:t,index:n}}),e=n.filter(function(t){return"#"===t.text[0]}),i={};e.forEach(function(n){try{var t=n.text.substring(1).split(":");i[t[0].trim()]=t[1].trim()}catch(t){throw new Error("line "+(n.index+1))}});var r=n.map(function(t){return"#"!==(n=t.text)[0]&&"//"!==n.trim().substring(0,2)?n.trim():"";var n}).join("\n").trim();if(""==r)return{root:new h.Compartment([],[],[]),config:s(i)};var a=h.intermediateParse(r);return{root:h.transformParseIntoSyntaxTree(a),config:s(i)};function l(t){return"down"!=t&&"right"==t?"LR":"TB"}function s(t){var n,e,i,r,a,s={};for(var o in t){"."==o[0]&&(e=t[o],s[o.substring(1).toUpperCase()]=(i=e,r=void 0,{bold:(r=h.skanaar.hasSubstring)(i,"bold"),underline:r(i,"underline"),italic:r(i,"italic"),dashed:r(i,"dashed"),empty:r(i,"empty"),center:"left"!=h.skanaar.last(i.match("align=([^ ]*)")||[]),fill:h.skanaar.last(i.match("fill=([^ ]*)")||[]),stroke:h.skanaar.last(i.match("stroke=([^ ]*)")||[]),visual:h.skanaar.last(i.match("visual=([^ ]*)")||[])||"class",direction:l(h.skanaar.last(i.match("direction=([^ ]*)")||[]))}))}return{arrowSize:+t.arrowSize||1,bendSize:+t.bendSize||.3,direction:l(t.direction),gutter:+t.gutter||5,edgeMargin:+t.edgeMargin||0,gravity:+(null!==(n=t.gravity)&&void 0!==n?n:1),edges:"hard"==t.edges?"hard":"rounded",fill:(t.fill||"#eee8d5;#fdf6e3;#eee8d5;#fdf6e3").split(";"),background:t.background||"transparent",fillArrows:"true"===t.fillArrows,font:t.font||"Helvetica",fontSize:+t.fontSize||12,leading:+t.leading||1.25,lineWidth:+t.lineWidth||3,padding:+t.padding||8,spacing:+t.spacing||40,stroke:t.stroke||"#33322E",title:t.title||"nomnoml",zoom:+t.zoom||1,acyclicer:"greedy"===t.acyclicer?"greedy":void 0,ranker:"network-simplex"==(a=t.ranker)||"tight-tree"==a||"longest-path"==a?a:"network-simplex",styles:h.skanaar.merged(h.styles,s)}}},h.intermediateParse=function(t){return M.parse(t)},h.transformParseIntoSyntaxTree=function(t){var o=0;function e(t){var n=[],e=[],r=[];t.forEach(function(t){"string"==typeof t&&n.push(t),void 0!==t.assoc&&(e.push(t.start),e.push(t.end),r.push({id:o++,assoc:t.assoc,start:t.start.parts[0][0],end:t.end.parts[0][0],startLabel:{text:t.startLabel},endLabel:{text:t.endLabel}})),void 0!==t.parts&&e.push(t)});var i=e.map(l).sort(function(t,n){return n.compartments.length-t.compartments.length}),a=h.skanaar.uniqueBy(i,"name"),s=r.filter(function(t){for(var n=0,e=r;n<e.length;n++){var i=e[n];if(t===i)return!0;if(i.start==t.start&&i.end==t.end)return!1}return!0});return new h.Compartment(n,a,s)}function l(t){var n=t.parts.map(e);return new h.Classifier(t.type,t.id,n)}return e(t)},(x=u=u||{}).render=function(t,d,n,c){var f=t,y=x.skanaar.vector;function u(a,s,n){f.save(),f.translate(a.offset.x,a.offset.y),f.fillStyle(s.stroke||d.stroke),a.lines.forEach(function(t,n){f.textAlign(s.center?"center":"left");var e,i=s.center?a.width/2-d.padding:0,r=(.5+(n+.5)*d.leading)*d.fontSize;t&&f.fillText(t,i,r),s.underline&&(e=f.measureText(t).width,r+=Math.round(.2*d.fontSize)+.5,f.path([{x:i-e/2,y:r},{x:i+e/2,y:r}]).stroke(),f.lineWidth(d.lineWidth))}),f.translate(d.gutter,d.gutter),a.relations.forEach(function(t){!function(t){var n=t.path[1],e=t.path[t.path.length-2],i=t.path.slice(1,-1);{var r;f.fillStyle(d.stroke),c(d,"normal"),g(t.startLabel),g(t.endLabel),"-/-"!==t.assoc&&"_/_"!==t.assoc&&(x.skanaar.hasSubstring(t.assoc,"--")||x.skanaar.hasSubstring(t.assoc,"__")?(r=Math.max(4,2*d.lineWidth),f.setLineDash([r,r]),o(i),f.setLineDash([])):o(i))}function a(t,n,e){">"===t||"<"===t?m(n,h,e,!1):":>"===t||"<:"===t?m(n,l,e,!1):"+"===t?m(n,h,e,p):"o"===t&&m(n,l,e,p)}var s=t.assoc.split(/[-_]/);a(x.skanaar.last(s),i,e),a(s[0],i.reverse(),n)}(t)}),a.nodes.forEach(function(t){!function(t,i){var n=Math.round(t.x-t.width/2),e=Math.round(t.y-t.height/2),r=d.styles[t.type]||x.styles.CLASS;{var a;f.fillStyle(r.fill||d.fill[i]||x.skanaar.last(d.fill)),f.strokeStyle(r.stroke||d.stroke),r.dashed&&(a=Math.max(4,2*d.lineWidth),f.setLineDash([a,a]))}var s=x.visualizers[r.visual]||x.visualizers.class;f.setData("name",t.name),s(t,n,e,d,f),f.setLineDash([]),f.save(),f.translate(n,e),t.compartments.forEach(function(t,n){var e=0<n?x.buildStyle({stroke:r.stroke}):r;e.empty||(f.save(),f.translate(t.x,t.y),c(d,e.bold?"bold":"normal",e.italic?"italic":void 0),u(t,e,i+1),f.restore())});for(var o=0,l=t.dividers;o<l.length;o++){var h=l[o];f.path(h).stroke()}f.restore()}(t,n)}),f.restore()}function o(t){if("rounded"===d.edges){var n=d.spacing*d.bendSize;f.beginPath(),f.moveTo(t[0].x,t[0].y);for(var e=1;e<t.length-1;e++)f.arcTo(t[e].x,t[e].y,t[e+1].x,t[e+1].y,n);f.lineTo(x.skanaar.last(t).x,x.skanaar.last(t).y),f.stroke()}else f.path(t).stroke()}var l=!1,h=!0,p=!0;function g(e){var i;e&&e.text&&(i=d.fontSize,e.text.split("`").forEach(function(t,n){return f.fillText(t,e.x,e.y+i*(n+1))}))}function m(t,n,e,i){var r=d.spacing*d.arrowSize/30,a=y.diff(t[t.length-2],x.skanaar.last(t)),s=y.normalize(a);function o(t){return y.add(e,y.mult(s,t*r))}var l=o(i?7:10),h=y.rot(s),c=i?o(14):n&&!d.fillArrows?o(5):l,u=[y.add(l,y.mult(h,4*r)),c,y.add(l,y.mult(h,-4*r)),e];f.fillStyle(n?d.stroke:d.fill[0]),f.circuit(u).fillAndStroke()}f.save(),f.scale(d.zoom,d.zoom),f.clear(),f.save(),f.strokeStyle("transparent"),f.fillStyle(d.background),f.rect(0,0,n.width,n.height).fill(),f.restore(),c(d,"bold"),f.lineWidth(d.lineWidth),f.lineJoin("round"),f.lineCap("round"),f.strokeStyle(d.stroke),d.lineWidth%2==1&&f.translate(.5,.5),u(n,x.buildStyle({stroke:void 0}),0),f.restore()},((e=u=u||{}).skanaar||(e.skanaar={})).Canvas=function(e,n){var a=e.getContext("2d"),i={x:0,y:0};function r(t){var n=e;return{x:t.clientX-n.getBoundingClientRect().left-n.clientLeft+n.scrollLeft,y:t.clientY-n.getBoundingClientRect().top-n.clientTop+n.scrollTop}}n&&(e.addEventListener("mousedown",function(t){n.mousedown&&n.mousedown(r(t))}),e.addEventListener("mouseup",function(t){n.mouseup&&n.mouseup(r(t))}),e.addEventListener("mousemove",function(t){i=r(t),n.mousemove&&n.mousemove(r(t))}));var s={stroke:function(){return a.stroke(),s},fill:function(){return a.fill(),s},fillAndStroke:function(){return a.fill(),a.stroke(),s}};function o(t,n,e){e=void 0===e?1:e,n=n||{x:0,y:0},a.beginPath(),a.moveTo(n.x+e*t[0].x,n.y+e*t[0].y);for(var i=1,r=t.length;i<r;i++)a.lineTo(n.x+e*t[i].x,n.y+e*t[i].y);return s}return{mousePos:function(){return i},width:function(){return e.width},height:function(){return e.height},clear:function(){a.clearRect(0,0,e.width,e.height)},circle:function(t,n){return a.beginPath(),a.arc(t.x,t.y,n,0,6.2832),s},ellipse:function(t,n,e,i,r){return void 0===i&&(i=0),void 0===r&&(r=6.2832),a.beginPath(),a.save(),a.translate(t.x,t.y),a.scale(1,e/n),a.arc(0,0,n/2,i,r),a.restore(),s},arc:function(t,n,e,i,r){return a.beginPath(),a.moveTo(t,n),a.arc(t,n,e,i,r),s},roundRect:function(t,n,e,i,r){return a.beginPath(),a.moveTo(t+r,n),a.arcTo(t+e,n,t+e,n+r,r),a.lineTo(t+e,n+i-r),a.arcTo(t+e,n+i,t+e-r,n+i,r),a.lineTo(t+r,n+i),a.arcTo(t,n+i,t,n+i-r,r),a.lineTo(t,n+r),a.arcTo(t,n,t+r,n,r),a.closePath(),s},rect:function(t,n,e,i){return a.beginPath(),a.moveTo(t,n),a.lineTo(t+e,n),a.lineTo(t+e,n+i),a.lineTo(t,n+i),a.closePath(),s},path:o,circuit:function(t,n,e){return o(t,n,e),a.closePath(),s},setFont:function(t,n,e,i){a.font=n+" "+(e||"")+" "+i+"pt "+t+", Helvetica, sans-serif"},fillStyle:function(t){a.fillStyle=t},strokeStyle:function(t){a.strokeStyle=t},textAlign:function(t){a.textAlign=t},lineCap:function(t){a.lineCap=t},lineJoin:function(t){a.lineJoin=t},lineWidth:function(t){a.lineWidth=t},arcTo:function(){return a.arcTo.apply(a,arguments)},beginPath:function(){return a.beginPath.apply(a,arguments)},fillText:function(){return a.fillText.apply(a,arguments)},lineTo:function(){return a.lineTo.apply(a,arguments)},measureText:function(){return a.measureText.apply(a,arguments)},moveTo:function(){return a.moveTo.apply(a,arguments)},restore:function(){return a.restore.apply(a,arguments)},setData:function(t,n){},save:function(){return a.save.apply(a,arguments)},scale:function(){return a.scale.apply(a,arguments)},setLineDash:function(){return a.setLineDash.apply(a,arguments)},stroke:function(){return a.stroke.apply(a,arguments)},translate:function(){return a.translate.apply(a,arguments)}}},r=u=u||{},(p=r.skanaar||(r.skanaar={})).charWidths={0:10,1:10,2:10,3:10,4:10,5:10,6:10,7:10,8:10,9:10," ":5,"!":5,'"':6,"#":10,$:10,"%":15,"&":11,"'":4,"(":6,")":6,"*":7,"+":10,",":5,"-":6,".":5,"/":5,":":5,";":5,"<":10,"=":10,">":10,"?":10,"@":17,A:11,B:11,C:12,D:12,E:11,F:10,G:13,H:12,I:5,J:9,K:11,L:10,M:14,N:12,O:13,P:11,Q:13,R:12,S:11,T:10,U:12,V:11,W:16,X:11,Y:11,Z:10,"[":5,"\\":5,"]":5,"^":8,_:10,"`":6,a:10,b:10,c:9,d:10,e:10,f:5,g:10,h:10,i:4,j:4,k:9,l:4,m:14,n:10,o:10,p:10,q:10,r:6,s:9,t:5,u:10,v:9,w:12,x:9,y:9,z:9,"{":6,"|":5,"}":6,"~":10},p.Svg=function(s,t){var a=[{x:0,y:0,stroke:"none",strokeWidth:1,dashArray:"none",fill:"none",textAlign:"left",font:"Helvetica, Arial, sans-serif",fontSize:12,attributes:{}}],o=[],n=t?t.createElement("canvas"):null,e=n?n.getContext("2d"):null,l=(i.prototype.stroke=function(){var t=this.attr.style||"";return this.attr.style=t+"stroke:"+u("stroke")+";fill:none;stroke-dasharray:"+u("dashArray")+";stroke-width:"+u("strokeWidth")+";",this},i.prototype.fill=function(){var t=this.attr.style||"";return this.attr.style=t+"stroke:none; fill:"+u("fill")+";",this},i.prototype.fillAndStroke=function(){var t=this.attr.style||"";return this.attr.style=t+"stroke:"+u("stroke")+";fill:"+u("fill")+";stroke-dasharray:"+u("dashArray")+";stroke-width:"+u("strokeWidth")+";",this},i);function i(t,n,e){this.name=t,this.attr=n,this.content=e||void 0}function r(n,e){return a.forEach(function(t){n+=t[e]}),n}function h(t){return Math.round(10*r(t,"x"))/10}function c(t){return Math.round(10*r(t,"y"))/10}function u(t){for(var n=a.length-1;0<=n;n--)if(a[n][t])return a[n][t]}function d(t){return t[t.length-1]}function f(t,e,i){return i=void 0===i?1:i,e=e||{x:0,y:0},y("path",{d:t.map(function(t,n){return(n?"L":"M")+h(e.x+i*t.x)+" "+c(e.y+i*t.y)}).join(" ")})}function y(t,n,e){var i=new l(t,n,e),r=u("attributes");for(var a in r)i.attr["data-"+a]=r[a];return o.push(i),i}return{width:function(){return 0},height:function(){return 0},clear:function(){},circle:function(t,n){return y("circle",{r:n,cx:h(t.x),cy:c(t.y)})},ellipse:function(t,n,e,i,r){if(r){var a=c(t.y);return y("path",{d:"M"+h(t.x-n/2)+" "+a+"A"+n/2+" "+e/2+" 0 1 0 "+h(t.x+n/2)+" "+a})}return y("ellipse",{cx:h(t.x),cy:c(t.y),rx:n/2,ry:e/2})},arc:function(t,n,e){return y("ellipse",{cx:h(t),cy:c(n),rx:e,ry:e})},roundRect:function(t,n,e,i,r){return y("rect",{x:h(t),y:c(n),rx:r,ry:r,height:i,width:e})},rect:function(t,n,e,i){return y("rect",{x:h(t),y:c(n),height:i,width:e})},path:f,circuit:function(t,n,e){var i=f(t,n,e);return i.attr.d+=" Z",i},setFont:function(t,n,e,i){t=n+" "+(e||"")+" "+i+"pt "+t+", Helvetica, sans-serif";d(a).font=t,d(a).fontSize=i},strokeStyle:function(t){d(a).stroke=t},fillStyle:function(t){d(a).fill=t},arcTo:function(t,n,e,i){d(o).attr.d+="L"+h(t)+" "+c(n)+" L"+h(e)+" "+c(i)+" "},beginPath:function(){return y("path",{d:""})},fillText:function(t,n,e){var i={x:h(n),y:c(e),style:"fill: "+d(a).fill+";"},r=u("font");return r&&(i.style+="font:"+r+";"),"center"===u("textAlign")&&(i.style+="text-anchor: middle;"),y("text",i,t)},lineCap:function(t){s+=";stroke-linecap:"+t},lineJoin:function(t){s+=";stroke-linejoin:"+t},lineTo:function(t,n){return d(o).attr.d+="L"+h(t)+" "+c(n)+" ",d(o)},lineWidth:function(t){d(a).strokeWidth=t},measureText:function(t){return e?(e.font=u("font")||"normal 12pt Helvetica",e.measureText(t)):{width:p.sum(t,function(t){var n=u("fontSize")/12;return p.charWidths[t]?p.charWidths[t]*n:16*n})}},moveTo:function(t,n){d(o).attr.d+="M"+h(t)+" "+c(n)+" "},restore:function(){a.pop()},save:function(){a.push({x:0,y:0,stroke:null,strokeWidth:null,fill:null,textAlign:null,dashArray:"none",font:null,fontSize:null,attributes:null})},setData:function(t,n){u("attributes")[t]=n},scale:function(){},setLineDash:function(t){d(a).dashArray=0===t.length?"none":t[0]+" "+t[1]},stroke:function(){d(o).stroke()},textAlign:function(t){d(a).textAlign=t},translate:function(t,n){d(a).x+=t,d(a).y+=n},serialize:function(t,n,e){function i(n){return Object.keys(n).map(function(t){return t+'="'+v(n[t])+'"'}).join(" ")}var r=o;n&&r.unshift(new l("desc",{},n)),e&&r.unshift(new l("title",{},e));var a=r.map(function(t){return"<"+t.name+" "+i(t.attr)+">"+v(t.content)+"</"+t.name+">"}).join("\n  ");return"<svg "+i({version:"1.1",baseProfile:"full",width:t.width,height:t.height,viewbox:"0 0 "+t.width+" "+t.height,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:ev":"http://www.w3.org/2001/xml-events",style:"font:"+u("font")+";"+s})+">\n  "+a+"\n</svg>"}}},a=u=u||{},(s=a.skanaar||(a.skanaar={})).sum=function(t,n){for(var e=0,i=0,r=t.length;e<r;e++)i+=n(t[e]);return i},s.find=function(t,n){for(var e=0;e<t.length;e++)if(n(t[e]))return t[e]},s.last=function(t){return t[t.length-1]},s.hasSubstring=function(t,n){return""===n||!!t&&-1!==t.indexOf(n)},s.merged=function(t,n){function e(t,n){for(var e in n)t[e]=n[e]}var i={};return e(i,t),e(i,n),i},s.indexBy=function(t,n){for(var e={},i=0;i<t.length;i++)e[t[i][n]]=t[i];return e},s.uniqueBy=function(t,n){for(var e={},i=[],r=0;r<t.length;r++){var a=t[r][n];e[a]||(e[a]=!0,i.push(t[r]))}return i},l=u=u||{},(c=l.skanaar||(l.skanaar={})).vector={dist:function(t,n){return c.vector.mag(c.vector.diff(t,n))},add:function(t,n){return{x:t.x+n.x,y:t.y+n.y}},diff:function(t,n){return{x:t.x-n.x,y:t.y-n.y}},mult:function(t,n){return{x:n*t.x,y:n*t.y}},mag:function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},normalize:function(t){return c.vector.mult(t,1/c.vector.mag(t))},rot:function(t){return{x:t.y,y:-t.x}}},(g=u=u||{}).styles={ABSTRACT:g.buildStyle({visual:"class",center:!0,italic:!0}),ACTOR:g.buildStyle({visual:"actor",center:!0}),CHOICE:g.buildStyle({visual:"rhomb",center:!0}),CLASS:g.buildStyle({visual:"class",center:!0,bold:!0}),DATABASE:g.buildStyle({visual:"database",center:!0,bold:!0}),END:g.buildStyle({visual:"end",center:!0,empty:!0}),FRAME:g.buildStyle({visual:"frame"}),HIDDEN:g.buildStyle({visual:"hidden",center:!0,empty:!0}),INPUT:g.buildStyle({visual:"input",center:!0}),INSTANCE:g.buildStyle({visual:"class",center:!0,underline:!0}),LABEL:g.buildStyle({visual:"none"}),NOTE:g.buildStyle({visual:"note"}),PACKAGE:g.buildStyle({visual:"package"}),RECEIVER:g.buildStyle({visual:"receiver"}),REFERENCE:g.buildStyle({visual:"class",center:!0,dashed:!0}),SENDER:g.buildStyle({visual:"sender"}),START:g.buildStyle({visual:"start",center:!0,empty:!0}),STATE:g.buildStyle({visual:"roundrect",center:!0}),TABLE:g.buildStyle({visual:"table",center:!0,bold:!0}),TRANSCEIVER:g.buildStyle({visual:"transceiver"}),USECASE:g.buildStyle({visual:"ellipse",center:!0})},g.layouters={actor:function(t,n){n.width=Math.max.apply(Math,W([2*t.padding],n.compartments.map(function(t){return t.width}))),n.height=3*t.padding+g.skanaar.sum(n.compartments,function(t){return t.height}),n.dividers=[];for(var e=3*t.padding,i=0,r=n.compartments;i<r.length;i++){var a=r[i];a.x=0,a.y=e,a.width=n.width,e+=a.height,a!=g.skanaar.last(n.compartments)&&n.dividers.push([{x:t.padding,y:e},{x:n.width-t.padding,y:e}])}},class:k,database:function(t,n){n.width=Math.max.apply(Math,n.compartments.map(function(t){return t.width})),n.height=g.skanaar.sum(n.compartments,function(t){return t.height})+2*t.padding,n.dividers=[];for(var e=1.5*t.padding,i=0,r=n.compartments;i<r.length;i++){var a=r[i];a.x=0,a.y=e,a.width=n.width,e+=a.height,a!=g.skanaar.last(n.compartments)&&n.dividers.push([{x:0,y:e},{x:n.width,y:e}])}},ellipse:function(t,n){var e=Math.max.apply(Math,n.compartments.map(function(t){return t.width})),i=g.skanaar.sum(n.compartments,function(t){return t.height});n.width=1.25*e,n.height=1.25*i,n.dividers=[];function r(t){return t*t}function a(t){return Math.sqrt(.25-r(t/n.height-.5))*n.width}for(var s=.125*i,o=0,l=n.compartments;o<l.length;o++){var h=l[o];h.x=.125*e,h.y=s,h.width=e,s+=h.height,h!=g.skanaar.last(n.compartments)&&n.dividers.push([{x:n.width/2+a(s)-1,y:s},{x:n.width/2-a(s)+1,y:s}])}},end:w,frame:function(t,n){var e=n.compartments[0].width,i=n.compartments[0].height;k(0,n),n.dividers.length&&n.dividers.shift(),n.dividers.unshift([{x:0,y:i},{x:e-i/4,y:i},{x:e+i/4,y:i/2},{x:e+i/4,y:0}])},hidden:function(t,n){n.dividers=[],n.compartments=[],n.width=1,n.height=1},input:k,none:k,note:k,package:k,receiver:k,rhomb:function(t,n){var e=Math.max.apply(Math,n.compartments.map(function(t){return t.width})),i=g.skanaar.sum(n.compartments,function(t){return t.height});n.width=1.5*e,n.height=1.5*i,n.dividers=[];for(var r=.25*i,a=0,s=n.compartments;a<s.length;a++){var o=s[a];o.x=.25*e,o.y=r,o.width=e,r+=o.height;var l=n.width/n.height;o!=g.skanaar.last(n.compartments)&&n.dividers.push([{x:n.width/2+(r<n.height/2?r*l:(n.height-r)*l),y:r},{x:n.width/2-(r<n.height/2?r*l:(n.height-r)*l),y:r}])}},roundrect:k,sender:k,start:w,table:function(t,e){if(1!=e.compartments.length){for(var n,i,r=e.compartments.slice(1),a=[[]],s=0,o=r;s<o.length;s++){var l=o[s];l==g.skanaar.last(r)||(i=l).lines.length||i.nodes.length||i.relations.length||!g.skanaar.last(a).length?(n=g.skanaar.last(a),a[0]!=n&&a[0].length==n.length?a.push([l]):g.skanaar.last(a).push(l)):a.push([])}var h=e.compartments[0],c=Math.max.apply(Math,W([h.width/a[0].length],r.map(function(t){return t.width}))),u=Math.max.apply(Math,r.map(function(t){return t.height}));e.width=c*a[0].length,e.height=h.height+u*a.length;var d=h.height;e.dividers=W([[{x:0,y:h.height},{x:0,y:h.height}]],a.map(function(t,n){return[{x:0,y:d+n*u},{x:e.width,y:d+n*u}]}),a[0].map(function(t,n){return[{x:(n+1)*c,y:d},{x:(n+1)*c,y:e.height}]})),h.x=0,h.y=0,h.width=e.width;for(var f=0;f<a.length;f++)for(var y=0;y<a[f].length;y++){var p=a[f][y];p.x=y*c,p.y=d+f*u,p.width=c}}else k(0,e)},transceiver:k},g.visualizers={actor:function(t,n,e,i,r){var a=i.padding/2,s=e+4*a,o={x:t.x,y:s-a};r.circle(o,a).fillAndStroke(),r.path([{x:t.x,y:s},{x:t.x,y:s+2*a}]).stroke(),r.path([{x:t.x-a,y:s+a},{x:t.x+a,y:s+a}]).stroke(),r.path([{x:t.x-a,y:s+a+i.padding},{x:t.x,y:s+i.padding},{x:t.x+a,y:s+a+i.padding}]).stroke()},class:function(t,n,e,i,r){r.rect(n,e,t.width,t.height).fillAndStroke()},database:function(t,n,e,i,r){var a=i.padding,s=e-a/2;r.rect(n,e+a,t.width,t.height-1.5*a).fill(),r.path([{x:n,y:s+1.5*a},{x:n,y:s-.5*a+t.height}]).stroke(),r.path([{x:n+t.width,y:s+1.5*a},{x:n+t.width,y:s-.5*a+t.height}]).stroke(),r.ellipse({x:t.x,y:s+1.5*a},t.width,1.5*a).fillAndStroke(),r.ellipse({x:t.x,y:s-.5*a+t.height},t.width,1.5*a,0,3.1416).fillAndStroke()},ellipse:function(t,n,e,i,r){r.ellipse({x:t.x,y:t.y},t.width,t.height).fillAndStroke()},end:function(t,n,e,i,r){r.circle({x:t.x,y:e+t.height/2},t.height/3).fillAndStroke(),r.fillStyle(i.stroke),r.circle({x:t.x,y:e+t.height/2},t.height/3-i.padding/2).fill()},frame:function(t,n,e,i,r){r.rect(n,e,t.width,t.height).fillAndStroke()},hidden:function(t,n,e,i,r){},input:function(t,n,e,i,r){r.circuit([{x:n+i.padding,y:e},{x:n+t.width,y:e},{x:n+t.width-i.padding,y:e+t.height},{x:n,y:e+t.height}]).fillAndStroke()},none:function(t,n,e,i,r){},note:function(t,n,e,i,r){r.circuit([{x:n,y:e},{x:n+t.width-i.padding,y:e},{x:n+t.width,y:e+i.padding},{x:n+t.width,y:e+t.height},{x:n,y:e+t.height},{x:n,y:e}]).fillAndStroke(),r.path([{x:n+t.width-i.padding,y:e},{x:n+t.width-i.padding,y:e+i.padding},{x:n+t.width,y:e+i.padding}]).stroke()},package:function(t,n,e,i,r){var a=t.compartments[0].height;r.rect(n,e+a,t.width,t.height-a).fillAndStroke();var s=r.measureText(t.name).width+2*i.padding;r.circuit([{x:n,y:e+a},{x:n,y:e},{x:n+s,y:e},{x:n+s,y:e+a}]).fillAndStroke()},receiver:function(t,n,e,i,r){r.circuit([{x:n-i.padding,y:e},{x:n+t.width,y:e},{x:n+t.width,y:e+t.height},{x:n-i.padding,y:e+t.height},{x:n,y:e+t.height/2}]).fillAndStroke()},rhomb:function(t,n,e,i,r){r.circuit([{x:t.x,y:e},{x:n+t.width,y:t.y},{x:t.x,y:e+t.height},{x:n,y:t.y}]).fillAndStroke()},roundrect:function(t,n,e,i,r){var a=Math.min(2*i.padding*i.leading,t.height/2);r.roundRect(n,e,t.width,t.height,a).fillAndStroke()},sender:function(t,n,e,i,r){r.circuit([{x:n,y:e},{x:n+t.width-i.padding,y:e},{x:n+t.width,y:e+t.height/2},{x:n+t.width-i.padding,y:e+t.height},{x:n,y:e+t.height}]).fillAndStroke()},start:function(t,n,e,i,r){r.fillStyle(i.stroke),r.circle({x:t.x,y:e+t.height/2},t.height/2.5).fill()},table:function(t,n,e,i,r){r.rect(n,e,t.width,t.height).fillAndStroke()},transceiver:function(t,n,e,i,r){r.circuit([{x:n-i.padding,y:e},{x:n+t.width,y:e},{x:n+t.width+i.padding,y:e+t.height/2},{x:n+t.width,y:e+t.height},{x:n-i.padding,y:e+t.height},{x:n,y:e+t.height/2}]).fillAndStroke()}};var b,S,_,A,E,T,L,M=(E=[12,14],T={trace:function(){},yy:{},symbols_:{error:2,root:3,compartment:4,EOF:5,slot:6,IDENT:7,class:8,association:9,SEP:10,parts:11,"|":12,"[":13,"]":14,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",7:"IDENT",10:"SEP",12:"|",13:"[",14:"]"},productions_:[0,[3,2],[6,1],[6,1],[6,1],[4,1],[4,3],[11,1],[11,3],[11,2],[9,3],[8,3]],performAction:function(t,n,e,i,r,a){var s=a.length-1;switch(r){case 1:return a[s-1];case 2:this.$=a[s].trim().replace(/\\(\[|\]|\|)/g,"$1");break;case 3:case 4:this.$=a[s];break;case 5:case 7:this.$=[a[s]];break;case 6:this.$=a[s-2].concat(a[s]);break;case 8:this.$=a[s-2].concat([a[s]]);break;case 9:this.$=a[s-1].concat([[]]);break;case 10:var o=a[s-1].trim().replace(/\\(\[|\]|\|)/g,"$1").match("^(.*?)([<:o+]*[-_]/?[-_]*[:o+>]*)(.*)$");this.$={assoc:o[2],start:a[s-2],end:a[s],startLabel:o[1].trim(),endLabel:o[3].trim()};break;case 11:var l="CLASS",h=a[s-1][0][0],c=a[s-1][0][0].match("<([a-z]*)>(.*)");c&&(l=c[1].toUpperCase(),h=c[2].trim()),a[s-1][0][0]=h,this.$={type:l,id:h,parts:a[s-1]}}},table:[{3:1,4:2,6:3,7:b=[1,4],8:5,9:6,13:S=[1,7]},{1:[3]},{5:[1,8],10:_=[1,9]},z(A=[5,10,12,14],[2,5]),z(A,[2,2]),z(A,[2,3],{7:[1,10]}),z(A,[2,4]),{4:12,6:3,7:b,8:5,9:6,11:11,13:S},{1:[2,1]},{6:13,7:b,8:5,9:6,13:S},{8:14,13:S},{12:[1,16],14:[1,15]},z(E,[2,7],{10:_}),z(A,[2,6]),z(A,[2,10]),z([5,7,10,12,14],[2,11]),z(E,[2,9],{6:3,8:5,9:6,4:17,7:b,13:S}),z(E,[2,8],{10:_})],defaultActions:{8:[2,1]},parseError:function(t,n){if(!n.recoverable){var e=new Error(t);throw e.hash=n,e}this.trace(t)},parse:function(t){var n=this,e=[0],i=[null],r=[],a=this.table,s="",o=0,l=0,h=0,c=r.slice.call(arguments,1),u=Object.create(this.lexer),d={yy:{}};for(var f in this.yy)Object.prototype.hasOwnProperty.call(this.yy,f)&&(d.yy[f]=this.yy[f]);u.setInput(t,d.yy),d.yy.lexer=u,d.yy.parser=this,void 0===u.yylloc&&(u.yylloc={});var y=u.yylloc;r.push(y);var p=u.options&&u.options.ranges;"function"==typeof d.yy.parseError?this.parseError=d.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var g,m,x,v,k,w,b,S,_=function(){var t=u.lex()||1;return"number"!=typeof t&&(t=n.symbols_[t]||t),t},A={};;){if(x=e[e.length-1],void 0===(v=this.defaultActions[x]?this.defaultActions[x]:(null==g&&(g=_()),a[x]&&a[x][g]))||!v.length||!v[0]){var E="",T=[];for(w in a[x])this.terminals_[w]&&2<w&&T.push("'"+this.terminals_[w]+"'");E=u.showPosition?"Parse error on line "+(o+1)+":\n"+u.showPosition()+"\nExpecting "+T.join(", ")+", got '"+(this.terminals_[g]||g)+"'":"Parse error on line "+(o+1)+": Unexpected "+(1==g?"end of input":"'"+(this.terminals_[g]||g)+"'"),this.parseError(E,{text:u.match,token:this.terminals_[g]||g,line:u.yylineno,loc:y,expected:T})}if(v[0]instanceof Array&&1<v.length)throw new Error("Parse Error: multiple actions possible at state: "+x+", token: "+g);switch(v[0]){case 1:e.push(g),i.push(u.yytext),r.push(u.yylloc),e.push(v[1]),g=null,m?(g=m,m=null):(l=u.yyleng,s=u.yytext,o=u.yylineno,y=u.yylloc,0<h&&h--);break;case 2:if(b=this.productions_[v[1]][1],A.$=i[i.length-b],A._$={first_line:r[r.length-(b||1)].first_line,last_line:r[r.length-1].last_line,first_column:r[r.length-(b||1)].first_column,last_column:r[r.length-1].last_column},p&&(A._$.range=[r[r.length-(b||1)].range[0],r[r.length-1].range[1]]),void 0!==(k=this.performAction.apply(A,[s,l,o,d.yy,v[1],i,r].concat(c))))return k;b&&(e=e.slice(0,-1*b*2),i=i.slice(0,-1*b),r=r.slice(0,-1*b)),e.push(this.productions_[v[1]][0]),i.push(A.$),r.push(A._$),S=a[e[e.length-2]][e[e.length-1]],e.push(S);break;case 3:return!0}}return!0}},L={EOF:1,parseError:function(t,n){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,n)},setInput:function(t,n){return this.yy=n||this.yy||{},this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];return this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t,t.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var n=t.length,e=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-n),this.offset-=n;var i=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),e.length-1&&(this.yylineno-=e.length-1);var r=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:e?(e.length===i.length?this.yylloc.first_column:0)+i[i.length-e.length].length-e[0].length:this.yylloc.first_column-n},this.options.ranges&&(this.yylloc.range=[r[0],r[0]+this.yyleng-n]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(20<t.length?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(20<t.length?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),n=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+n+"^"},test_match:function(t,n){var e,i,r;if(this.options.backtrack_lexer&&(r={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(r.yylloc.range=this.yylloc.range.slice(0))),(i=t[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=i.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:i?i[i.length-1].length-i[i.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],e=this.performAction.call(this,this.yy,this,n,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),e)return e;if(this._backtrack){for(var a in r)this[a]=r[a];return!1}return!1},next:function(){if(this.done)return this.EOF;var t,n,e,i;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var r=this._currentRules(),a=0;a<r.length;a++)if((e=this._input.match(this.rules[r[a]]))&&(!n||e[0].length>n[0].length)){if(n=e,i=a,this.options.backtrack_lexer){if(!1!==(t=this.test_match(e,r[a])))return t;if(this._backtrack){n=!1;continue}return!1}if(!this.options.flex)break}return n?!1!==(t=this.test_match(n,r[i]))&&t:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return t||this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return 0<this.conditionStack.length-1?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(t){return 0<=(t=this.conditionStack.length-1-Math.abs(t||0))?this.conditionStack[t]:"INITIAL"},pushState:function(t){this.begin(t)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(t,n,e){switch(e){case 0:return 12;case 1:return 7;case 2:return 13;case 3:return 14;case 4:return 10;case 5:return 5;case 6:return"INVALID"}},rules:[/^(?:\s*\|\s*)/,/^(?:(\\(\[|\]|\|)|[^\]\[|;\n])+)/,/^(?:\[)/,/^(?:\s*\])/,/^(?:[ ]*(;|\n)+[ ]*)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6],inclusive:!0}}},T.lexer=L,new((P.prototype=T).Parser=P));function z(t,n,e,i){for(e=e||{},i=t.length;i--;e[t[i]]=n);return e}function P(){this.yy={}}return u});
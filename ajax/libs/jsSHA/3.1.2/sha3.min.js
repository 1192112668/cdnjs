!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t=t||self).jsSHA=n()}(this,function(){"use strict";var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function s(t,n,e,r){for(var i,o,u=n||[0],s=(e=e||0)>>>3,a=-1===r?3:0,h=0;h<t.length;h+=1)i=(o=h+s)>>>2,u.length<=i&&u.push(0),u[i]|=t[h]<<8*(a+r*(o%4));return{value:u,binLen:8*t.length+e}}function a(t,e,u){switch(e){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw new Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(t){case"HEX":return function(t,n,e){return function(t,n,e,r){var i,o,u;if(0!=t.length%2)throw new Error("String of HEX type must be in byte increments");for(var s=n||[0],a=(e=e||0)>>>3,h=-1===r?3:0,f=0;f<t.length;f+=2){if(i=parseInt(t.substr(f,2),16),isNaN(i))throw new Error("String of HEX type contains invalid characters");for(o=(u=(f>>>1)+a)>>>2;s.length<=o;)s.push(0);s[o]|=i<<8*(h+r*(u%4))}return{value:s,binLen:4*t.length+e}}(t,n,e,u)};case"TEXT":return function(t,v,n){return function(t,n,e,r){var i,o,u,s,a,h,f,c,l=0,p=v||[0],w=(e=e||0)>>>3;if("UTF8"===n)for(f=-1===r?3:0,u=0;u<t.length;u+=1)for(o=[],(i=t.charCodeAt(u))<128?o.push(i):i<2048?(o.push(192|i>>>6),o.push(128|63&i)):i<55296||57344<=i?o.push(224|i>>>12,128|i>>>6&63,128|63&i):(u+=1,i=65536+((1023&i)<<10|1023&t.charCodeAt(u)),o.push(240|i>>>18,128|i>>>12&63,128|i>>>6&63,128|63&i)),s=0;s<o.length;s+=1){for(a=(h=l+w)>>>2;p.length<=a;)p.push(0);p[a]|=o[s]<<8*(f+r*(h%4)),l+=1}else for(f=-1===r?2:0,c="UTF16LE"===n&&1!==r||"UTF16LE"!==n&&1===r,u=0;u<t.length;u+=1){for(i=t.charCodeAt(u),!0==c&&(i=(s=255&i)<<8|i>>>8),a=(h=l+w)>>>2;p.length<=a;)p.push(0);p[a]|=i<<8*(f+r*(h%4)),l+=2}return{value:p,binLen:8*l+e}}(t,e,n,u)};case"B64":return function(t,w,n){return function(t,n,e){var r,i,o,u,s,a,h=0,f=w||[0],c=(n=n||0)>>>3,l=-1===e?3:0,p=t.indexOf("=");if(-1===t.search(/^[a-zA-Z0-9=+/]+$/))throw new Error("Invalid character in base-64 string");if(t=t.replace(/=/g,""),-1!==p&&p<t.length)throw new Error("Invalid '=' found in base-64 string");for(r=0;r<t.length;r+=4){for(u=t.substr(r,4),i=o=0;i<u.length;i+=1)o|=v.indexOf(u.charAt(i))<<18-6*i;for(i=0;i<u.length-1;i+=1){for(s=(a=h+c)>>>2;f.length<=s;)f.push(0);f[s]|=(o>>>16-8*i&255)<<8*(l+e*(a%4)),h+=1}}return{value:f,binLen:8*h+n}}(t,n,u)};case"BYTES":return function(t,f,n){return function(t,n,e){for(var r,i,o,u=f||[0],s=(n=n||0)>>>3,a=-1===e?3:0,h=0;h<t.length;h+=1)r=t.charCodeAt(h),i=(o=h+s)>>>2,u.length<=i&&u.push(0),u[i]|=r<<8*(a+e*(o%4));return{value:u,binLen:8*t.length+n}}(t,n,u)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch(t){throw new Error("ARRAYBUFFER not supported by this environment")}return function(t,n,e){return r=n,i=e,o=u,s(new Uint8Array(t),r,i,o);var r,i,o};case"UINT8ARRAY":try{new Uint8Array(0)}catch(t){throw new Error("UINT8ARRAY not supported by this environment")}return function(t,n,e){return s(t,n,e,u)};default:throw new Error("format must be HEX, TEXT, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}function h(t,a,n,e){switch(t){case"HEX":return function(t){return function(t,n,e){for(var r,i="",o=a/8,u=-1===n?3:0,s=0;s<o;s+=1)r=t[s>>>2]>>>8*(u+n*(s%4)),i+="0123456789abcdef".charAt(r>>>4&15)+"0123456789abcdef".charAt(15&r);return e.outputUpper?i.toUpperCase():i}(t,n,e)};case"B64":return function(t){return function(t,n,e,r){for(var i,o,u,s,a="",h=n/8,f=-1===e?3:0,c=0;c<h;c+=3)for(u=c+1<h?t[c+1>>>2]:0,s=c+2<h?t[c+2>>>2]:0,o=(t[c>>>2]>>>8*(f+e*(c%4))&255)<<16|(u>>>8*(f+e*((c+1)%4))&255)<<8|s>>>8*(f+e*((c+2)%4))&255,i=0;i<4;i+=1)a+=8*c+6*i<=n?v.charAt(o>>>6*(3-i)&63):r.b64Pad;return a}(t,a,n,e)};case"BYTES":return function(t){return function(t,n){for(var e,r="",i=a/8,o=-1===n?3:0,u=0;u<i;u+=1)e=t[u>>>2]>>>8*(o+n*(u%4))&255,r+=String.fromCharCode(e);return r}(t,n)};case"ARRAYBUFFER":try{new ArrayBuffer(0)}catch(t){throw new Error("ARRAYBUFFER not supported by this environment")}return function(t){return function(t,n){for(var e=a/8,r=new ArrayBuffer(e),i=new Uint8Array(r),o=-1===n?3:0,u=0;u<e;u+=1)i[u]=t[u>>>2]>>>8*(o+n*(u%4))&255;return r}(t,n)};case"UINT8ARRAY":try{new Uint8Array(0)}catch(t){throw new Error("UINT8ARRAY not supported by this environment")}return function(t){return function(t,n){for(var e=a/8,r=-1===n?3:0,i=new Uint8Array(e),o=0;o<e;o+=1)i[o]=t[o>>>2]>>>8*(r+n*(o%4))&255;return i}(t,n)};default:throw new Error("format must be HEX, B64, BYTES, ARRAYBUFFER, or UINT8ARRAY")}}function f(t,n){var e,r,i=t.binLen>>>3,o=n.binLen>>>3,u=i<<3,s=4-i<<3;if(i%4==0)return{value:t.value.concat(n.value),binLen:t.binLen+n.binLen};for(e=0;e<o;e+=4)r=i+e>>>2,t.value[r]|=n.value[e>>>2]<<u,t.value.push(0),t.value[1+r]|=n.value[e>>>2]>>>s;return(t.value.length<<2)-4>=o+i&&t.value.pop(),{value:t.value,binLen:t.binLen+n.binLen}}function c(t){var n={outputUpper:!1,b64Pad:"=",outputLen:-1},e=t||{},r="Output length must be a multiple of 8";if(n.outputUpper=e.outputUpper||!1,e.b64Pad&&(n.b64Pad=e.b64Pad),e.outputLen){if(e.outputLen%8!=0)throw new Error(r);n.outputLen=e.outputLen}else if(e.shakeLen){if(e.shakeLen%8!=0)throw new Error(r);n.outputLen=e.shakeLen}if("boolean"!=typeof n.outputUpper)throw new Error("Invalid outputUpper formatting option");if("string"!=typeof n.b64Pad)throw new Error("Invalid b64Pad formatting option");return n}function l(t,n,e,r){var i=t+" must include a value and format";if(!n){if(!r)throw new Error(i);return r}if(void 0===n.value||!n.format)throw new Error(i);return a(n.format,n.encoding||"UTF8",e)(n.value)}var t=(n.prototype.update=function(t){for(var n=0,e=this.m>>>5,r=this.R(t,this.s,this.u),i=r.binLen,o=r.value,u=i>>>5,s=0;s<u;s+=e)n+this.m<=i&&(this.U=this.T(o.slice(s,s+e),this.U),n+=this.m);this.v+=n,this.s=o.slice(n>>>5),this.u=i%this.m,this.h=!0},n.prototype.getHash=function(t,n){var e,r,i=this.F,o=c(n);if(this.C){if(-1===o.outputLen)throw new Error("Output length must be specified in options");i=o.outputLen}var u=h(t,i,this.H,o);if(this.A&&this.B)return u(this.B(o));for(r=this.L(this.s.slice(),this.u,this.v,this.S(this.U),i),e=1;e<this.numRounds;e+=1)this.C&&i%32!=0&&(r[r.length-1]&=16777215>>>24-i%32),r=this.L(r,i,0,this.g(this.o),i);return u(r)},n.prototype.setHMACKey=function(t,n,e){if(!this.k)throw new Error("Variant does not support HMAC");if(this.h)throw new Error("Cannot set MAC key after calling update");var r=a(n,(e||{}).encoding||"UTF8",this.H);this.Y(r(t))},n.prototype.Y=function(t){var n,e=this.m>>>3,r=e/4-1;if(1!==this.numRounds)throw new Error("Cannot set numRounds with MAC");if(this.A)throw new Error("MAC key already set");for(e<t.binLen/8&&(t.value=this.L(t.value,t.binLen,0,this.g(this.o),this.F));t.value.length<=r;)t.value.push(0);for(n=0;n<=r;n+=1)this.l[n]=909522486^t.value[n],this.p[n]=1549556828^t.value[n];this.U=this.T(this.l,this.U),this.v=this.m,this.A=!0},n.prototype.getHMAC=function(t,n){var e=c(n);return h(t,this.F,this.H,e)(this.N())},n.prototype.N=function(){if(!this.A)throw new Error("Cannot call getHMAC without first setting MAC key");var t=this.L(this.s.slice(),this.u,this.v,this.S(this.U),this.F),n=this.T(this.p,this.g(this.o));return this.L(t,this.F,this.m,n,this.F)},n),p=function(t,n){this.I=t,this.K=n};function n(t,n,e){var r=e||{};if(this.t=n,this.i=r.encoding||"UTF8",this.numRounds=r.numRounds||1,isNaN(this.numRounds)||this.numRounds!==parseInt(this.numRounds,10)||this.numRounds<1)throw new Error("numRounds must a integer >= 1");this.o=t,this.s=[],this.u=0,this.h=!1,this.v=0,this.A=!1,this.l=[],this.p=[]}function w(t,n){var e;return 32<n?(e=64-n,new p(t.K<<n|t.I>>>e,t.I<<n|t.K>>>e)):0!==n?(e=32-n,new p(t.I<<n|t.K>>>e,t.K<<n|t.I>>>e)):t}function m(t,n){return new p(t.I^n.I,t.K^n.K)}var A,r,i,b=[new p(0,1),new p(0,32898),new p(2147483648,32906),new p(2147483648,2147516416),new p(0,32907),new p(0,2147483649),new p(2147483648,2147516545),new p(2147483648,32777),new p(0,138),new p(0,136),new p(0,2147516425),new p(0,2147483658),new p(0,2147516555),new p(2147483648,139),new p(2147483648,32905),new p(2147483648,32771),new p(2147483648,32770),new p(2147483648,128),new p(0,32778),new p(2147483648,2147483658),new p(2147483648,2147516545),new p(2147483648,32896),new p(0,2147483649),new p(2147483648,2147516424)],d=[[0,36,3,41,18],[1,44,10,45,2],[62,6,43,15,61],[28,55,25,21,56],[27,20,39,8,14]];function E(t){for(var n=[],e=0;e<5;e+=1)n[e]=[new p(0,0),new p(0,0),new p(0,0),new p(0,0),new p(0,0)];return n}function g(t){for(var n=[],e=0;e<5;e+=1)n[e]=t[e].slice();return n}function y(t,n){var e,r,i,o,u,s,a,h,f,c=[],l=[];if(null!==t)for(r=0;r<t.length;r+=2)n[(r>>>1)%5][(r>>>1)/5|0]=m(n[(r>>>1)%5][(r>>>1)/5|0],new p(t[r+1],t[r]));for(e=0;e<24;e+=1){for(o=E(),r=0;r<5;r+=1)c[r]=(u=n[r][0],s=n[r][1],a=n[r][2],h=n[r][3],f=n[r][4],new p(u.I^s.I^a.I^h.I^f.I,u.K^s.K^a.K^h.K^f.K));for(r=0;r<5;r+=1)l[r]=m(c[(r+4)%5],w(c[(r+1)%5],1));for(r=0;r<5;r+=1)for(i=0;i<5;i+=1)n[r][i]=m(n[r][i],l[r]);for(r=0;r<5;r+=1)for(i=0;i<5;i+=1)o[i][(2*r+3*i)%5]=w(n[r][i],d[r][i]);for(r=0;r<5;r+=1)for(i=0;i<5;i+=1)n[r][i]=m(o[r][i],new p(~o[(r+1)%5][i].I&o[(r+2)%5][i].I,~o[(r+1)%5][i].K&o[(r+2)%5][i].K));n[0][0]=m(n[0][0],b[e])}return n}function u(t){for(var n,e=0,r=[0,0],i=[4294967295&t,t/4294967296&2097151],o=6;0<=o;o--)0==(n=i[o>>2]>>>8*o&255)&&0===e||(r[e+1>>2]|=n<<8*(e+1),e+=1);return e=0!==e?e:1,r[0]|=e,{value:4<e+1?r:[r[0]],binLen:8+8*e}}function L(t){return f(u(t.binLen),t)}function U(t,n){for(var e=u(n),r=n>>>2,i=(r-(e=f(e,t)).value.length%r)%r,o=0;o<i;o++)e.value.push(0);return e.value}return e(r=o,i=A=t),r.prototype=null===i?Object.create(i):(R.prototype=i.prototype,new R),o.prototype.O=function(t,n){var e,r={funcName:l("funcName",(e=t||{}||{}).funcName,1,{value:[],binLen:0}),customization:l("Customization",e.customization,1,{value:[],binLen:0})};n&&(r.funcName=n);var i=f(L(r.funcName),L(r.customization));if(0===r.customization.binLen&&0===r.funcName.binLen)return 31;for(var o=U(i,this.m>>>3),u=0;u<o.length;u+=this.m>>>5)this.U=this.T(o.slice(u,u+(this.m>>>5)),this.U),this.v+=this.m;return 4},o.prototype.M=function(t){var n,e={kmacKey:l("kmacKey",(n=t||{}||{}).kmacKey,1),funcName:{value:[1128353099],binLen:32},customization:l("Customization",n.customization,1,{value:[],binLen:0})};this.O(t,e.funcName);for(var r=U(L(e.kmacKey),this.m>>>3),i=0;i<r.length;i+=this.m>>>5)this.U=this.T(r.slice(i,i+(this.m>>>5)),this.U),this.v+=this.m;this.A=!0},o.prototype.X=function(t){var n=f({value:this.s.slice(),binLen:this.u},function(t){for(var n,e=0,r=[0,0],i=[4294967295&t,t/4294967296&2097151],o=6;0<=o;o--)0==(n=i[o>>2]>>>8*o&255)&&0===e||(r[e>>2]|=n<<8*e,e+=1);return r[(e=0!==e?e:1)>>2]|=e<<8*e,{value:4<e+1?r:[r[0]],binLen:8+8*e}}(t.outputLen));return this.L(n.value,n.binLen,this.v,this.S(this.U),t.outputLen)},o;function o(t,n,e){var r=this,o=6,u=0,i=e||{};if(1!==(r=A.call(this,t,n,e)||this).numRounds){if(i.kmacKey||i.hmacKey)throw new Error("Cannot set numRounds with MAC");if("CSHAKE128"===r.o||"CSHAKE256"===r.o)throw new Error("Cannot set numRounds for CSHAKE variants")}switch(r.H=1,r.R=a(r.t,r.i,r.H),r.T=y,r.S=g,r.g=E,r.U=E(),r.C=!1,t){case"SHA3-224":r.m=u=1152,r.F=224,r.k=!0,r.B=r.N;break;case"SHA3-256":r.m=u=1088,r.F=256,r.k=!0,r.B=r.N;break;case"SHA3-384":r.m=u=832,r.F=384,r.k=!0,r.B=r.N;break;case"SHA3-512":r.m=u=576,r.F=512,r.k=!0,r.B=r.N;break;case"SHAKE128":o=31,r.m=u=1344,r.F=-1,r.C=!0,r.k=!1,r.B=null;break;case"SHAKE256":o=31,r.m=u=1088,r.F=-1,r.C=!0,r.k=!1,r.B=null;break;case"KMAC128":o=4,r.m=u=1344,r.M(e),r.F=-1,r.C=!0,r.k=!1,r.B=r.X;break;case"KMAC256":o=4,r.m=u=1088,r.M(e),r.F=-1,r.C=!0,r.k=!1,r.B=r.X;break;case"CSHAKE128":r.m=u=1344,o=r.O(e),r.F=-1,r.C=!0,r.k=!1,r.B=null;break;case"CSHAKE256":r.m=u=1088,o=r.O(e),r.F=-1,r.C=!0,r.k=!1,r.B=null;break;default:throw new Error("Chosen SHA variant is not supported")}return r.L=function(t,n,e,r,i){return function(t,n,e,r,i,o){for(var u,s=0,a=[],h=r>>>5,f=n>>>5,c=0;c<f&&r<=n;c+=h)e=y(t.slice(c,c+h),e),n-=r;for(t=t.slice(c),n%=r;t.length<h;)t.push(0);for(t[(c=n>>>3)>>2]^=i<<c%4*8,t[h-1]^=2147483648,e=y(t,e);32*a.length<o&&(u=e[s%5][s/5|0],a.push(u.K),!(32*a.length>=o));)a.push(u.I),0==64*(s+=1)%r&&(y(null,e),s=0);return a}(t,n,r,u,o,i)},i.hmacKey&&r.Y(l("hmacKey",i.hmacKey,r.H)),r}function R(){this.constructor=r}});
function cameraName(a){return a.replace(/\s*\([0-9a-f]+(:[0-9a-f]+)?\)\s*$/,"")||a||null}class MediaError extends Error{constructor(a){super(`Cannot access video stream (${a}).`),this.type=a}}class Camera{constructor(a,e){this.id=a,this.name=e,this._stream=null}async start(){let a={audio:!1,video:{mandatory:{sourceId:this.id,minWidth:600,maxWidth:800,minAspectRatio:1.6},optional:[]}};return this._stream=await Camera._wrapErrors(async()=>await navigator.mediaDevices.getUserMedia(a)),window.URL.createObjectURL(this._stream)}stop(){if(this._stream){for(let a of this._stream.getVideoTracks())a.stop();this._stream=null}}static async getCameras(){return await this._ensureAccess(),(await navigator.mediaDevices.enumerateDevices()).filter(a=>"videoinput"===a.kind).map(a=>new Camera(a.deviceId,cameraName(a.label)))}static async _ensureAccess(){return await this._wrapErrors(async()=>{let a=await navigator.mediaDevices.getUserMedia({video:!0});for(let e of a.getVideoTracks())e.stop()})}static async _wrapErrors(a){try{return await a()}catch(a){throw a.name?new MediaError(a.name):a}}}module.exports=Camera;
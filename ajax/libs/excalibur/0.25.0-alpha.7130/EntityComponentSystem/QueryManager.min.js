import{buildTypeKey}from"./Util";import{Query}from"./Query";var QueryManager=function(){function e(e){this.scene=e,this._queries={}}return e.prototype._addQuery=function(e){this._queries[buildTypeKey(e.types)]=e;for(var t=0,r=this.scene.entityManager.entities;t<r.length;t++){var i=r[t];e.addEntity(i)}},e.prototype.maybeRemoveQuery=function(e){0===e.observers.length&&(e.clear(),delete this._queries[buildTypeKey(e.types)])},e.prototype.addEntity=function(e){for(var t in this._queries)this._queries[t]&&this._queries[t].addEntity(e)},e.prototype.removeComponent=function(e,t){for(var r in this._queries)this._queries[r].matches(e.types.concat([t.type]))&&this._queries[r].removeEntity(e)},e.prototype.removeEntity=function(e){for(var t in this._queries)this._queries[t].entities.indexOf(e)>-1&&this._queries[t].removeEntity(e)},e.prototype.createQuery=function(e){var t=this.getQuery(e);if(t)return t;var r=new Query(e);return this._addQuery(r),r},e.prototype.getQuery=function(e){var t=buildTypeKey(e);return this._queries[t]?this._queries[t]:null},e}();export{QueryManager};
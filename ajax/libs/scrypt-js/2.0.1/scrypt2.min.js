"use strict";!function(r){var t=2147483647;function s(r){var y=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],g=1779033703,d=3144134277,m=1013904242,b=2773480762,I=1359893119,A=2600822924,E=528734635,k=1541459225,B=new Array(64);function e(r){for(var e=0,n=r.length;64<=n;){for(var t,f,o,a,u=g,i=d,s=m,c=b,h=I,l=A,p=E,w=k,v=0;v<16;v++)f=e+4*v,B[v]=(255&r[f])<<24|(255&r[f+1])<<16|(255&r[f+2])<<8|255&r[f+3];for(v=16;v<64;v++)o=((t=B[v-2])>>>17|t<<15)^(t>>>19|t<<13)^t>>>10,a=((t=B[v-15])>>>7|t<<25)^(t>>>18|t<<14)^t>>>3,B[v]=(o+B[v-7]|0)+(a+B[v-16]|0)|0;for(v=0;v<64;v++)o=(((h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7))+(h&l^~h&p)|0)+(w+(y[v]+B[v]|0)|0)|0,a=((u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10))+(u&i^u&s^i&s)|0,w=p,p=l,l=h,h=c+o|0,c=s,s=i,i=u,u=o+a|0;g=g+u|0,d=d+i|0,m=m+s|0,b=b+c|0,I=I+h|0,A=A+l|0,E=E+p|0,k=k+w|0,e+=64,n-=64}}e(r);var n,t=r.length%64,f=r.length/536870912|0,o=r.length<<3,a=t<56?56:120,u=r.slice(r.length-t,r.length);for(u.push(128),n=1+t;n<a;n++)u.push(0);return u.push(f>>>24&255),u.push(f>>>16&255),u.push(f>>>8&255),u.push(f>>>0&255),u.push(o>>>24&255),u.push(o>>>16&255),u.push(o>>>8&255),u.push(o>>>0&255),e(u),[g>>>24&255,g>>>16&255,g>>>8&255,g>>>0&255,d>>>24&255,d>>>16&255,d>>>8&255,d>>>0&255,m>>>24&255,m>>>16&255,m>>>8&255,m>>>0&255,b>>>24&255,b>>>16&255,b>>>8&255,b>>>0&255,I>>>24&255,I>>>16&255,I>>>8&255,I>>>0&255,A>>>24&255,A>>>16&255,A>>>8&255,A>>>0&255,E>>>24&255,E>>>16&255,E>>>8&255,E>>>0&255,k>>>24&255,k>>>16&255,k>>>8&255,k>>>0&255]}function _(r,e,n){r=r.length<=64?r:s(r);for(var t=64+e.length+4,f=new Array(t),o=new Array(64),a=[],u=0;u<64;u++)f[u]=54;for(u=0;u<r.length;u++)f[u]^=r[u];for(u=0;u<e.length;u++)f[64+u]=e[u];for(u=t-4;u<t;u++)f[u]=0;for(u=0;u<64;u++)o[u]=92;for(u=0;u<r.length;u++)o[u]^=r[u];function i(){for(var r=t-1;t-4<=r;r--){if(f[r]++,f[r]<=255)return;f[r]=0}}for(;32<=n;)i(),a=a.concat(s(o.concat(s(f)))),n-=32;return 0<n&&(i(),a=a.concat(s(o.concat(s(f))).slice(0,n))),new Buffer(a)}function j(r,e,n,t,f){var o;for(z(r,16*(2*n-1),f,0,16),o=0;o<2*n;o++)q(r,16*o,f,16),a(f,t),z(f,0,r,e+16*o,16);for(o=0;o<n;o++)z(r,e+2*o*16,r,16*o,16);for(o=0;o<n;o++)z(r,e+16*(2*o+1),r,16*(o+n),16)}function f(r,e){return r<<e|r>>>32-e}function a(r,e){z(r,0,e,0,16);for(var n=8;0<n;n-=2)e[4]^=f(e[0]+e[12],7),e[8]^=f(e[4]+e[0],9),e[12]^=f(e[8]+e[4],13),e[0]^=f(e[12]+e[8],18),e[9]^=f(e[5]+e[1],7),e[13]^=f(e[9]+e[5],9),e[1]^=f(e[13]+e[9],13),e[5]^=f(e[1]+e[13],18),e[14]^=f(e[10]+e[6],7),e[2]^=f(e[14]+e[10],9),e[6]^=f(e[2]+e[14],13),e[10]^=f(e[6]+e[2],18),e[3]^=f(e[15]+e[11],7),e[7]^=f(e[3]+e[15],9),e[11]^=f(e[7]+e[3],13),e[15]^=f(e[11]+e[7],18),e[1]^=f(e[0]+e[3],7),e[2]^=f(e[1]+e[0],9),e[3]^=f(e[2]+e[1],13),e[0]^=f(e[3]+e[2],18),e[6]^=f(e[5]+e[4],7),e[7]^=f(e[6]+e[5],9),e[4]^=f(e[7]+e[6],13),e[5]^=f(e[4]+e[7],18),e[11]^=f(e[10]+e[9],7),e[8]^=f(e[11]+e[10],9),e[9]^=f(e[8]+e[11],13),e[10]^=f(e[9]+e[8],18),e[12]^=f(e[15]+e[14],7),e[13]^=f(e[12]+e[15],9),e[14]^=f(e[13]+e[12],13),e[15]^=f(e[14]+e[13],18);for(n=0;n<16;++n)r[n]+=e[n]}function q(r,e,n,t){for(var f=0;f<t;f++)n[f]^=r[e+f]}function z(r,e,n,t,f){for(;f--;)n[t++]=r[e++]}function C(r){if(r&&"number"==typeof r.length){for(var e=0;e<r.length;e++){if("number"!=typeof r[e])return;var n=parseInt(r[e]);if(n!=r[e]||n<0||256<=n)return}return 1}}function e(o,r,a,u,i,s,c){if(!c)throw new Error("missing callback");if(0===a||0!=(a&a-1))throw new Error("invalid parameter N (must be power of 2)");if(t/128/u<a)throw new Error("invalid parameter N (too large)");if(t/128/i<u)throw new Error("invalid parameter r (too large)");if(!C(o))throw new Error("password must be an array or buffer.");if(!C(r))throw new Error("salt must be an array or buffer.");o=new Buffer(o),r=new Buffer(r);for(var h=_(o,r,128*i*u),l=new Int32Array(32*i*u),e=0;e<l.length;e++){var n=4*e;l[e]=(255&h[3+n])<<24|(255&h[2+n])<<16|(255&h[1+n])<<8|(255&h[0+n])<<0}var p,w,v=new Int32Array(64*u),y=new Int32Array(32*u*a),g=32*u,d=new Int32Array(16),m=new Int32Array(16),b=i*a*2,I=0,A=null,E=!1,k=0,B=0,x=parseInt(1e3/u),N="undefined"!=typeof setImmediate?setImmediate:setTimeout,T=function(){if(E)return c(new Error("cancelled"),I/b);switch(k){case 0:z(l,w=32*B*u,v,0,g),k=1,p=0;case 1:x<(e=a-p)&&(e=x);for(var r=0;r<e;r++)z(v,0,y,(p+r)*g,g),j(v,g,u,d,m);if(p+=e,I+=e,(n=parseInt(1e3*I/b))!==A){if(E=c(null,I/b))break;A=n}if(p<a)break;p=0,k=2;case 2:var e;x<(e=a-p)&&(e=x);for(var n,r=0;r<e;r++){var t=v[16*(2*u-1)]&a-1;q(y,t*g,v,g),j(v,g,u,d,m)}if(p+=e,I+=e,(n=parseInt(1e3*I/b))!==A){if(E=c(null,I/b))break;A=n}if(p<a)break;if(z(v,0,l,w,g),++B<i){k=0;break}h=[];for(r=0;r<l.length;r++)h.push(l[r]>>0&255),h.push(l[r]>>8&255),h.push(l[r]>>16&255),h.push(l[r]>>24&255);var f=_(o,h,s);return c(null,1,f)}N(T)};T()}"undefined"!=typeof exports?module.exports=e:"function"==typeof define&&define.amd?define(e):(r.scrypt=e,r&&r.scrypt&&(r._scrypt=r.scrypt))}(this);
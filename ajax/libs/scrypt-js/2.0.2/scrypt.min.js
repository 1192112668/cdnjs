"use strict";!function(r){var t=2147483647;function s(r){var y=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],g=1779033703,d=3144134277,b=1013904242,m=2773480762,A=1359893119,E=2600822924,k=528734635,I=1541459225,U=new Array(64);function n(r){for(var n=0,e=r.length;64<=e;){for(var t,f,o,a,u=g,i=d,s=b,c=m,h=A,l=E,p=k,w=I,v=0;v<16;v++)f=n+4*v,U[v]=(255&r[f])<<24|(255&r[f+1])<<16|(255&r[f+2])<<8|255&r[f+3];for(v=16;v<64;v++)o=((t=U[v-2])>>>17|t<<15)^(t>>>19|t<<13)^t>>>10,a=((t=U[v-15])>>>7|t<<25)^(t>>>18|t<<14)^t>>>3,U[v]=(o+U[v-7]|0)+(a+U[v-16]|0)|0;for(v=0;v<64;v++)o=(((h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7))+(h&l^~h&p)|0)+(w+(y[v]+U[v]|0)|0)|0,a=((u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10))+(u&i^u&s^i&s)|0,w=p,p=l,l=h,h=c+o|0,c=s,s=i,i=u,u=o+a|0;g=g+u|0,d=d+i|0,b=b+s|0,m=m+c|0,A=A+h|0,E=E+l|0,k=k+p|0,I=I+w|0,n+=64,e-=64}}n(r);var e,t=r.length%64,f=r.length/536870912|0,o=r.length<<3,a=t<56?56:120,u=r.slice(r.length-t,r.length);for(u.push(128),e=1+t;e<a;e++)u.push(0);return u.push(f>>>24&255),u.push(f>>>16&255),u.push(f>>>8&255),u.push(f>>>0&255),u.push(o>>>24&255),u.push(o>>>16&255),u.push(o>>>8&255),u.push(o>>>0&255),n(u),[g>>>24&255,g>>>16&255,g>>>8&255,g>>>0&255,d>>>24&255,d>>>16&255,d>>>8&255,d>>>0&255,b>>>24&255,b>>>16&255,b>>>8&255,b>>>0&255,m>>>24&255,m>>>16&255,m>>>8&255,m>>>0&255,A>>>24&255,A>>>16&255,A>>>8&255,A>>>0&255,E>>>24&255,E>>>16&255,E>>>8&255,E>>>0&255,k>>>24&255,k>>>16&255,k>>>8&255,k>>>0&255,I>>>24&255,I>>>16&255,I>>>8&255,I>>>0&255]}function L(r,n,e){r=r.length<=64?r:s(r);for(var t=64+n.length+4,f=new Array(t),o=new Array(64),a=[],u=0;u<64;u++)f[u]=54;for(u=0;u<r.length;u++)f[u]^=r[u];for(u=0;u<n.length;u++)f[64+u]=n[u];for(u=t-4;u<t;u++)f[u]=0;for(u=0;u<64;u++)o[u]=92;for(u=0;u<r.length;u++)o[u]^=r[u];function i(){for(var r=t-1;t-4<=r;r--){if(f[r]++,f[r]<=255)return;f[r]=0}}for(;32<=e;)i(),a=a.concat(s(o.concat(s(f)))),e-=32;return 0<e&&(i(),a=a.concat(s(o.concat(s(f))).slice(0,e))),a}function T(r,n,e,t,f){var o;for(j(r,16*(2*e-1),f,0,16),o=0;o<2*e;o++)_(r,16*o,f,16),a(f,t),j(f,0,r,n+16*o,16);for(o=0;o<e;o++)j(r,n+2*o*16,r,16*o,16);for(o=0;o<e;o++)j(r,n+16*(2*o+1),r,16*(o+e),16)}function f(r,n){return r<<n|r>>>32-n}function a(r,n){j(r,0,n,0,16);for(var e=8;0<e;e-=2)n[4]^=f(n[0]+n[12],7),n[8]^=f(n[4]+n[0],9),n[12]^=f(n[8]+n[4],13),n[0]^=f(n[12]+n[8],18),n[9]^=f(n[5]+n[1],7),n[13]^=f(n[9]+n[5],9),n[1]^=f(n[13]+n[9],13),n[5]^=f(n[1]+n[13],18),n[14]^=f(n[10]+n[6],7),n[2]^=f(n[14]+n[10],9),n[6]^=f(n[2]+n[14],13),n[10]^=f(n[6]+n[2],18),n[3]^=f(n[15]+n[11],7),n[7]^=f(n[3]+n[15],9),n[11]^=f(n[7]+n[3],13),n[15]^=f(n[11]+n[7],18),n[1]^=f(n[0]+n[3],7),n[2]^=f(n[1]+n[0],9),n[3]^=f(n[2]+n[1],13),n[0]^=f(n[3]+n[2],18),n[6]^=f(n[5]+n[4],7),n[7]^=f(n[6]+n[5],9),n[4]^=f(n[7]+n[6],13),n[5]^=f(n[4]+n[7],18),n[11]^=f(n[10]+n[9],7),n[8]^=f(n[11]+n[10],9),n[9]^=f(n[8]+n[11],13),n[10]^=f(n[9]+n[8],18),n[12]^=f(n[15]+n[14],7),n[13]^=f(n[12]+n[15],9),n[14]^=f(n[13]+n[12],13),n[15]^=f(n[14]+n[13],18);for(e=0;e<16;++e)r[e]+=n[e]}function _(r,n,e,t){for(var f=0;f<t;f++)e[f]^=r[n+f]}function j(r,n,e,t,f){for(;f--;)e[t++]=r[n++]}function q(r){if(r&&"number"==typeof r.length){for(var n=0;n<r.length;n++){if("number"!=typeof r[n])return;var e=parseInt(r[n]);if(e!=r[n]||e<0||256<=e)return}return 1}}function z(r,n){var e=parseInt(r);if(r!=e)throw new Error("invalid "+n);return e}function n(o,r,a,u,i,s,c){if(!c)throw new Error("missing callback");if(a=z(a,"N"),u=z(u,"r"),i=z(i,"p"),s=z(s,"dkLen"),0===a||0!=(a&a-1))throw new Error("N must be power of 2");if(t/128/u<a)throw new Error("N too large");if(t/128/i<u)throw new Error("r too large");if(!q(o))throw new Error("password must be an array or buffer");if(!q(r))throw new Error("salt must be an array or buffer");o=new Buffer(o),r=new Buffer(r);for(var h=L(o,r,128*i*u),l=new Uint32Array(32*i*u),n=0;n<l.length;n++){var e=4*n;l[n]=(255&h[3+e])<<24|(255&h[2+e])<<16|(255&h[1+e])<<8|(255&h[0+e])<<0}var p,w,v=new Uint32Array(64*u),y=new Uint32Array(32*u*a),g=32*u,d=new Uint32Array(16),b=new Uint32Array(16),m=i*a*2,A=0,E=null,k=!1,I=0,U=0,N=parseInt(1e3/u),x="undefined"!=typeof setImmediate?setImmediate:setTimeout,B=function(){if(k)return c(new Error("cancelled"),A/m);switch(I){case 0:j(l,w=32*U*u,v,0,g),I=1,p=0;case 1:N<(n=a-p)&&(n=N);for(var r=0;r<n;r++)j(v,0,y,(p+r)*g,g),T(v,g,u,d,b);if(p+=n,A+=n,(e=parseInt(1e3*A/m))!==E){if(k=c(null,A/m))break;E=e}if(p<a)break;p=0,I=2;case 2:var n;N<(n=a-p)&&(n=N);for(var e,r=0;r<n;r++){var t=v[16*(2*u-1)]&a-1;_(y,t*g,v,g),T(v,g,u,d,b)}if(p+=n,A+=n,(e=parseInt(1e3*A/m))!==E){if(k=c(null,A/m))break;E=e}if(p<a)break;if(j(v,0,l,w,g),++U<i){I=0;break}h=[];for(r=0;r<l.length;r++)h.push(l[r]>>0&255),h.push(l[r]>>8&255),h.push(l[r]>>16&255),h.push(l[r]>>24&255);var f=L(o,h,s);return c(null,1,f)}x(B)};B()}"undefined"!=typeof exports?module.exports=n:"function"==typeof define&&define.amd?define(n):r&&(r.scrypt&&(r._scrypt=r.scrypt),r.scrypt=n)}(this);
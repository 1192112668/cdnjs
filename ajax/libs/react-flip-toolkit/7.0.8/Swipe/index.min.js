function t(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var e=require("rematrix"),i=require("react"),n=t(i),r=(t(require("prop-types")),function(t){return"number"==typeof t}),o=function(t){return"[object Object]"===Object.prototype.toString.call(t)},s=function(t){return Array.prototype.slice.apply(t)};function a(i){for(var t=[],e=arguments.length-1;0<e--;)t[e]=arguments[e+1];return t.forEach(function(t){if(t)for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(i[e]=t[e])}),i}var l,p=function(t,e,i){return t+(e-t)*i},c={noWobble:{stiffness:200,damping:26},gentle:{stiffness:120,damping:14},veryGentle:{stiffness:130,damping:17},wobbly:{stiffness:180,damping:12},stiff:{stiffness:260,damping:26}},u=function(t){return o(t)?t:-1<Object.keys(c).indexOf(t)?c[t]:{}};"undefined"!=typeof window&&(l=window.requestAnimationFrame);var d=l=l||function(t){window.setTimeout(t,1e3/60)},f=Date.now(),h="object"==typeof performance&&"function"==typeof performance.now?function(){return performance.now()}:function(){return Date.now()-f};function g(t,e){var i=t.indexOf(e);-1!==i&&t.splice(i,1)}var m=function(){};m.prototype.run=function(){var t=this;d(function(){t.springSystem.loop(h())})};var v=function(){this.position=0,this.velocity=0},y=0,S=function(t){this._id="s"+y++,this._springSystem=t,this.listeners=[],this._startValue=0,this._currentState=new v,this._displacementFromRestThreshold=.001,this._endValue=0,this._overshootClampingEnabled=!1,this._previousState=new v,this._restSpeedThreshold=.001,this._tempState=new v,this._timeAccumulator=0,this._wasAtRest=!0,this._cachedSpringConfig={}};S.prototype.getId=function(){return this._id},S.prototype.destroy=function(){this.listeners=[],this._springSystem.deregisterSpring(this)},S.prototype.setSpringConfig=function(t){return this._springConfig=t,this},S.prototype.getCurrentValue=function(){return this._currentState.position},S.prototype.getDisplacementDistanceForState=function(t){return Math.abs(this._endValue-t.position)},S.prototype.setEndValue=function(t){if(t===this._endValue)return this;if(this.prevEndValue=t,this._endValue===t&&this.isAtRest())return this;this._startValue=this.getCurrentValue(),this._endValue=t,this._springSystem.activateSpring(this.getId());for(var e=0,i=this.listeners.length;e<i;e++){var n=this.listeners[e].onSpringEndStateChange;n&&n(this)}return this},S.prototype.setVelocity=function(t){return t===this._currentState.velocity||(this._currentState.velocity=t,this._springSystem.activateSpring(this.getId())),this},S.prototype.setCurrentValue=function(t){this._startValue=t,this._currentState.position=t;for(var e=0,i=this.listeners.length;e<i;e++){var n=this.listeners[e];n.onSpringUpdate&&n.onSpringUpdate(this)}return this},S.prototype.setAtRest=function(){return this._endValue=this._currentState.position,this._tempState.position=this._currentState.position,this._currentState.velocity=0,this},S.prototype.setOvershootClampingEnabled=function(t){return this._overshootClampingEnabled=t,this},S.prototype.isOvershooting=function(){var t=this._startValue,e=this._endValue;return 0<this._springConfig.tension&&(t<e&&this.getCurrentValue()>e||e<t&&this.getCurrentValue()<e)},S.prototype.advance=function(t,e){var i=this.isAtRest();if(!i||!this._wasAtRest){var n=.064<e?.064:e;this._timeAccumulator+=n;for(var r,o,s,a,l=this._springConfig.tension,p=this._springConfig.friction,c=this._currentState.position,u=this._currentState.velocity,d=this._tempState.position,h=this._tempState.velocity;.001<=this._timeAccumulator;)this._timeAccumulator-=.001,this._timeAccumulator<.001&&(this._previousState.position=c,this._previousState.velocity=u),r=l*(this._endValue-d)-p*u,s=l*(this._endValue-(d=c+.001*u*.5))-p*(h=u+.001*r*.5),a=l*(this._endValue-(d=c+.001*(o=h)*.5))-p*(h=u+.001*s*.5),d=c+.001*h,c+=1/6*(u+2*(o+h)+(h=u+.001*a))*.001,u+=1/6*(r+2*(s+a)+(l*(this._endValue-d)-p*h))*.001;this._tempState.position=d,this._tempState.velocity=h,this._currentState.position=c,this._currentState.velocity=u,0<this._timeAccumulator&&this._interpolate(this._timeAccumulator/.001),(this.isAtRest()||this._overshootClampingEnabled&&this.isOvershooting())&&(0<this._springConfig.tension?(this._startValue=this._endValue,this._currentState.position=this._endValue):(this._endValue=this._currentState.position,this._startValue=this._endValue),this.setVelocity(0),i=!0);var f=!1;this._wasAtRest&&(f=!(this._wasAtRest=!1));var g=!1;i&&(g=this._wasAtRest=!0),this.notifyPositionUpdated(f,g)}},S.prototype.notifyPositionUpdated=function(e,i){var n=this;this.listeners.filter(Boolean).forEach(function(t){e&&t.onSpringActivate&&!n._onActivateCalled&&(t.onSpringActivate(n),n._onActivateCalled=!0),t.onSpringUpdate&&t.onSpringUpdate(n),i&&t.onSpringAtRest&&t.onSpringAtRest(n)})},S.prototype.systemShouldAdvance=function(){return!this.isAtRest()||!this.wasAtRest()},S.prototype.wasAtRest=function(){return this._wasAtRest},S.prototype.isAtRest=function(){return Math.abs(this._currentState.velocity)<this._restSpeedThreshold&&(this.getDisplacementDistanceForState(this._currentState)<=this._displacementFromRestThreshold||0===this._springConfig.tension)},S.prototype._interpolate=function(t){this._currentState.position=this._currentState.position*t+this._previousState.position*(1-t),this._currentState.velocity=this._currentState.velocity*t+this._previousState.velocity*(1-t)},S.prototype.addListener=function(t){return this.listeners.push(t),this},S.prototype.addOneTimeListener=function(n){var r=this;return Object.keys(n).forEach(function(t){var i;n[t]=(i=n[t],function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];i.apply(void 0,t),r.removeListener(n)})}),this.listeners.push(n),this},S.prototype.removeListener=function(t){return g(this.listeners,t),this};var _=function(t){this.looper=t||new m,(this.looper.springSystem=this).listeners=[],this._activeSprings=[],this._idleSpringIndices=[],this._isIdle=!0,this._lastTimeMillis=-1,this._springRegistry={}};_.prototype.createSpring=function(t,e){return this.createSpringWithConfig({tension:t,friction:e})},_.prototype.createSpringWithConfig=function(t){var e=new S(this);return this.registerSpring(e),e.setSpringConfig(t),e},_.prototype.getIsIdle=function(){return this._isIdle},_.prototype.registerSpring=function(t){this._springRegistry[t.getId()]=t},_.prototype.deregisterSpring=function(t){g(this._activeSprings,t),delete this._springRegistry[t.getId()]},_.prototype.advance=function(e,i){for(var n=this;0<this._idleSpringIndices.length;)this._idleSpringIndices.pop();for(this._activeSprings.filter(Boolean).forEach(function(t){t.systemShouldAdvance()?t.advance(e/1e3,i/1e3):n._idleSpringIndices.push(n._activeSprings.indexOf(t))});0<this._idleSpringIndices.length;){var t=this._idleSpringIndices.pop();0<=t&&this._activeSprings.splice(t,1)}},_.prototype.loop=function(t){var e;-1===this._lastTimeMillis&&(this._lastTimeMillis=t-1);var i=t-this._lastTimeMillis;this._lastTimeMillis=t;for(var n=0,r=this.listeners.length,n=0;n<r;n++)(e=this.listeners[n]).onBeforeIntegrate&&e.onBeforeIntegrate(this);for(this.advance(t,i),0===this._activeSprings.length&&(this._isIdle=!0,this._lastTimeMillis=-1),n=0;n<r;n++)(e=this.listeners[n]).onAfterIntegrate&&e.onAfterIntegrate(this);this._isIdle||this.looper.run()},_.prototype.activateSpring=function(t){var e=this._springRegistry[t];-1===this._activeSprings.indexOf(e)&&this._activeSprings.push(e),this.getIsIdle()&&(this._isIdle=!1,this.looper.run())};var E=new _,C=function(t){var e=t.springConfig,i=e.overshootClamping,n=t.getOnUpdateFunc,r=t.onAnimationEnd,o=t.isGestureControlled,s=t.onSpringActivate,a=E.createSpring(e.stiffness,e.damping);a.setOvershootClampingEnabled(!!i);var l={onSpringActivate:s,onSpringAtRest:o?function(){}:function(){a.destroy(),r()},onSpringUpdate:n({spring:a,onAnimationEnd:r})};return a.addListener(l),a},I=function(t){var e=C(t);return e.setEndValue(1),e},w=function(t,e,r){var i,o,s,a;void 0===e&&(e={}),t&&t.length&&(e.reverse&&t.reverse(),o="number"!=typeof(i=e.speed)?1.1:1+Math.min(Math.max(5*i,0),5),s=1/Math.max(Math.min(t.length,100),10),(a=t.map(function(t,n){var e=t.getOnUpdateFunc;return t.getOnUpdateFunc=function(t){var i=e(t);return function(t){var e=t.getCurrentValue();((e=e<.01?0:.99<e?1:e)>=s||r)&&a[n+1]&&a[n+1](Math.max(Math.min(e*o,1),0)),i(t)}},t}).map(function(t){var e=C(Object.assign({},t,{isGestureControlled:r}));if(e)return e.setEndValue.bind(e)}).filter(Boolean))[0]&&!r&&a[0](1))},b=function(e){return[0,1,4,5,12,13].map(function(t){return e[t]})},A=function(t){return t.top<window.innerHeight&&0<t.bottom&&t.left<window.innerWidth&&0<t.right},O=function(t,e){var i;return a(t,((i={})[e[0]]=e[1],i))},x=function(t,e){return s(e?document.querySelectorAll('[data-portal-key="'+e+'"]'):t.querySelectorAll("[data-flip-id]"))},P=function(t){return t.map(function(t){return[t,t.getBoundingClientRect()]})},F={event:void 0,target:void 0,time:void 0,xy:[0,0],delta:[0,0],initial:[0,0],previous:[0,0],local:[0,0],lastLocal:[0,0],velocity:0,distance:0,down:!1,first:!0},D={window:window,touchOnly:!1,onDown:void 0,onUp:void 0},U=function(l){return function(t){var a=t.inProgressAnimations,e=t.onFinished,i=t.velocity;void 0===i&&(i=1);var n=Object.keys(a).map(function(o){var t=a[o],e=t.spring,s=t.onAnimationEnd;return e?(Object.keys(e._cachedSpringConfig).length&&e.setSpringConfig(e._cachedSpringConfig),e.setVelocity(Math.max(Math.min(i,15),2)).setEndValue(l),new Promise(function(n,r){e.addOneTimeListener({onSpringAtRest:function(t){if(t.getCurrentValue()!==l)return r();var e,i;n(),1===l&&s(),(e=a)[i=o]&&e[i].spring&&e[i].spring.destroy(),delete e[i]}})})):Promise.reject()});Promise.all(n).then(e)}},V=U(1),j=U(0),M=function(t){this.props=t,this.flipInitiatorData=void 0,this.isFinishing=!1,this.prevProps={};var e,a,i,n,h,l,p,r,o=(e={onAction:this.onAction.bind(this),config:this.props},i=F,n={onAction:e.onAction,config:Object.assign(D,e.config)},h=n.onAction,l=function(){a.touchOnly||(a.window.removeEventListener("mousemove",u,{passive:!0}),a.window.removeEventListener("mouseup",p,{passive:!0})),a.window.removeEventListener("touchmove",u,{passive:!0}),a.window.removeEventListener("touchend",p,{passive:!0})},p=function(t){l(),c(t)},r={},(a=n.config).touchOnly||(r.onMouseDown=g),r.onTouchStart=g,{handlers:r,set:f}),s=o.set;function f(t){return i=t(i)}function c(i){f(function(t){var e=Object.assign({},t,{down:!1,first:!1});return h&&h(e),a.onUp&&a.onUp(e),Object.assign({},e,{event:i,lastLocal:t.local})})}function u(p){var t=p.touches?p.touches[0]:p,c=t.pageX,u=t.pageY;f(function(t){var e=Date.now(),i=c-t.xy[0],n=u-t.xy[1],r=c-t.initial[0],o=u-t.initial[1],s=Math.sqrt(r*r+o*o),a=Math.sqrt(i*i+n*n),l=Object.assign({},t,{event:p,time:e,xy:[c,u],delta:[r,o],local:[t.lastLocal[0]+c-t.initial[0],t.lastLocal[1]+u-t.initial[1]],velocity:a/(e-t.time),distance:s,previous:t.xy,first:!1});return h&&h(l),Object.assign({},l)})}function g(t){var n,e,r,o,s;t.targetTouches&&1<t.targetTouches.length||a.maxWidth&&!window.matchMedia("screen and (max-width: "+a.maxWidth+"px)")||(a.touchOnly||(a.window.addEventListener("mousemove",u,{passive:!0}),a.window.addEventListener("mouseup",p,{passive:!0})),a.window.addEventListener("touchmove",u,{passive:!0}),a.window.addEventListener("touchend",p,{passive:!0}),e=(n=t).touches?n.touches[0]:n,r=e.target,o=e.pageX,s=e.pageY,f(function(t){var e=t.lastLocal||F.lastLocal,i=Object.assign({},F,{event:n,target:r,lastLocal:e,local:e,xy:[o,s],initial:[o,s],previous:[o,s],down:!0,time:Date.now(),cancel:function(){l(),d(function(){return c(n)})}});return h(i),a.onDown&&a.onDown(i),Object.assign({},i)}))}this.handlers=o.handlers,this.set=s};M.prototype.onAction=function(t){var e,i,n,r,o,s,a,l,p,c=this,u=t.velocity,d=t.delta,h=d[0],f=d[1],g=t.down,m=t.first;if(!(this.isFinishing||m&&h+f===0)){var v=this.props,y=v.inProgressAnimations,S=v.setIsGestureInitiated,_=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&-1===e.indexOf(n)&&(i[n]=t[n]);return i}(v,["inProgressAnimations","setIsGestureInitiated"]),E=String(this.props.flipId);if(y&&S){function C(){c.flipInitiatorData&&c.flipInitiatorData.cancelFlip({props:c.props,prevProps:c.prevProps}),delete c.flipInitiatorData,c.isFinishing=!1}var I=Boolean(Object.keys(y).length),w=["left","right","up","down"].map(function(t){return _[t]?Object.assign({direction:t,threshold:c.props.threshold||.15},_[t]):null}).filter(Boolean),b=(l=h,p=f,Math.abs(l)>Math.abs(p)?0<l?"right":"left":0<p?"down":"up"),A=w.filter(function(t){return t.direction===b})[0];if(!I){if(!A)return;return a=A,c.flipInitiatorData=Object.assign({},a),c.set(function(t){return Object.assign({},t,{initial:t.xy})}),S(!0),a.initFlip({props:c.props,prevProps:c.prevProps}),void setTimeout(function(){y[E]?Object.keys(y).forEach(function(t){E&&(y[t].flipInitiator=E)}):delete c.flipInitiatorData},0)}if(this.flipInitiatorData){function O(){c.isFinishing=!0,j({velocity:u,inProgressAnimations:y,onFinished:C})}if(this.flipInitiatorData.direction!==b&&I&&!g)return O();var x=(r={deltaX:h,deltaY:f,direction:this.flipInitiatorData.direction},{up:-(s=r.deltaY),down:s,left:-(o=r.deltaX),right:o}[r.direction]);if(x<=0&&!m)return C();var P=y[E].difference,F=P.translateXDifference,U=P.translateYDifference,D=P.prevRect,M=P.currentRect,R=x/Math.abs(-1<["up","down"].indexOf(this.flipInitiatorData.direction)?M.height-D.height+U:M.width-M.width+F);return!g&&R<this.flipInitiatorData.threshold?O():R>this.flipInitiatorData.threshold?(this.isFinishing=!0,V({velocity:u,inProgressAnimations:y,onFinished:function(){delete c.flipInitiatorData,delete c.isFinishing}})):(i=(e={percentage:R,inProgressAnimations:y}).inProgressAnimations,n=e.percentage,void Object.keys(i).forEach(function(t){var e=i[t].spring;Object.keys(e._cachedSpringConfig).length||(i[t].spring._cachedSpringConfig=i[t].spring._springConfig),e.setSpringConfig({tension:300,friction:26}),i[t].spring.setEndValue(n)}))}}}};var R=new _,k=i.createContext({}),T=i.createContext("portal"),G=i.createContext({}),L=function(i){function t(){var t=this;i.apply(this,arguments),this.isGestureControlled=!1,this.isGestureInitiated=!1,this.inProgressAnimations={},this.flipCallbacks={},this.el=void 0,this.setIsGestureInitiated=function(){t.isGestureInitiated=!0}}return i&&(t.__proto__=i),((t.prototype=Object.create(i&&i.prototype)).constructor=t).prototype.getSnapshotBeforeUpdate=function(t){return this.isGestureInitiated?(this.isGestureControlled=!0,this.isGestureInitiated=!1):this.isGestureControlled=!1,t.flipKey!==this.props.flipKey&&this.el?function(t){var e=t.element,o=t.flipCallbacks;void 0===o&&(o={});var i=t.inProgressAnimations;void 0===i&&(i={});var n=x(e,t.portalKey),r=s(e.querySelectorAll("[data-inverse-flip-id]")),l={},p=[],c={};n.filter(function(t){return o&&o[t.dataset.flipId]&&o[t.dataset.flipId].onExit}).forEach(function(t){var e,i=t.parentNode;!t.closest||(e=t.closest("[data-exit-container]"))&&(i=e);var n=p.findIndex(function(t){return t[0]===i});-1===n&&(p.push([i,i.getBoundingClientRect()]),n=p.length-1),l[t.dataset.flipId]=p[n][1],c[t.dataset.flipId]=i});var u,d,h=P(n),f=h.map(function(t){var e,i=t[0],n=t[1],r={};return o&&o[i.dataset.flipId]&&o[i.dataset.flipId].onExit&&(e=l[i.dataset.flipId],a(r,{element:i,parent:c[i.dataset.flipId],childPosition:{top:n.top-e.top,left:n.left-e.left,width:n.width,height:n.height}})),[i.dataset.flipId,{rect:n,opacity:parseFloat(window.getComputedStyle(i).opacity||"1"),domDataForExitAnimations:r}]}).reduce(O,{});return u=i,d=n.concat(r),Object.keys(u).forEach(function(t){u[t].spring&&u[t].spring.destroy(),delete u[t]}),d.forEach(function(t){t.style.transform="",t.style.opacity=""}),{flippedElementPositions:f,cachedOrderedFlipIds:h.map(function(t){return t[0].dataset.flipId})}}({element:this.el,flipCallbacks:this.flipCallbacks,inProgressAnimations:this.inProgressAnimations,portalKey:this.props.portalKey}):null},t.prototype.componentDidUpdate=function(t,i,n){this.props.flipKey!==t.flipKey&&this.el&&function(t){var i=t.cachedOrderedFlipIds;void 0===i&&(i=[]);var n=t.inProgressAnimations;void 0===n&&(n={});var o=t.flippedElementPositionsBeforeUpdate;void 0===o&&(o={});var l=t.flipCallbacks;void 0===l&&(l={});var d=t.containerEl,h=t.applyTransformOrigin,f=t.spring,g=t.debug,m=t.portalKey,v=t.staggerConfig;void 0===v&&(v={});var y=t.decisionData;void 0===y&&(y={});function S(t){return o[t]&&tt[t]}var _,E,C,F,U,D,V,j,M,R,k,T,G,L,K,B,q,X,Y,W,H,N,J,z=t.handleEnterUpdateDelete,Q=t.isGestureControlled,Z=t.onComplete,$=t.onStart,tt=P(x((J={element:d,portalKey:m}).element,J.portalKey)).map(function(t){var e=t[0],i=t[1],n=window.getComputedStyle(e);return[e.dataset.flipId,{element:e,rect:i,opacity:parseFloat(n.opacity),transform:n.transform}]}).reduce(O,{}),et=(H=(q={containerEl:d,portalKey:m}).containerEl,(N=q.portalKey)?(W=N,function(t){return s(document.querySelectorAll('[data-portal-key="'+W+'"]'+t))}):H?(X=H,Y=Math.random().toFixed(5),X.dataset.flipperId=Y,function(t){return s(X.querySelectorAll('[data-flipper-id="'+Y+'"] '+t))}):function(){return[]}),it=(B=et,function(t){return B('[data-flip-id="'+t+'"]')[0]}),nt=Object.keys(o).concat(Object.keys(tt)).filter(function(t){return!S(t)}),rt={flipCallbacks:l,getElement:it,flippedElementPositionsBeforeUpdate:o,flippedElementPositionsAfterUpdate:tt,inProgressAnimations:n,decisionData:y},ot=(_=a({},rt,{unflippedIds:nt}),C=_.unflippedIds,F=_.flipCallbacks,U=_.getElement,D=_.flippedElementPositionsBeforeUpdate,V=_.flippedElementPositionsAfterUpdate,j=_.inProgressAnimations,M=_.decisionData,R=C.filter(function(t){return V[t]}).filter(function(t){return F[t]&&F[t].onAppear}),k=C.filter(function(t){return D[t]&&F[t]&&F[t].onExit}),T=new Promise(function(t){E=t}),G=[],L=0,K=k.map(function(t,e){var i=D[t].domDataForExitAnimations,n=i.element,r=i.parent,o=i.childPosition,s=o.top,a=o.left,l=o.width,p=o.height;"static"===getComputedStyle(r).position&&(r.style.position="relative"),n.style.transform="matrix(1, 0, 0, 1, 0, 0)",n.style.position="absolute",n.style.top=s+"px",n.style.left=a+"px",n.style.height=p+"px",n.style.width=l+"px";var c=G.filter(function(t){return t[0]===r})[0];c||(c=[r,document.createDocumentFragment()],G.push(c)),c[1].appendChild(n),L+=1;function u(){try{r.removeChild(n)}catch(t){}finally{0==--L&&E()}}return j[t]={stop:u},function(){return F[t].onExit(n,e,u,M)}}),G.forEach(function(t){t[0].appendChild(t[1])}),K.length||E(),{hideEnteringElements:function(){R.forEach(function(t){var e=U(t);e&&(e.style.opacity="0")})},animateEnteringElements:function(){R.forEach(function(t,e){var i=U(t);i&&F[t].onAppear(i,e,M)})},animateExitingElements:function(){return K.forEach(function(t){return t()}),T}}),st=ot.hideEnteringElements,at=ot.animateEnteringElements,lt=ot.animateExitingElements,pt=a({},rt,{containerEl:d,isGestureControlled:Q,flippedIds:i.filter(S),applyTransformOrigin:h,spring:f,debug:g,staggerConfig:v,scopedSelector:et,onComplete:Z});$&&$(d,y);var ct=function(){var t=pt.flippedIds,G=pt.flipCallbacks,L=pt.inProgressAnimations,K=pt.flippedElementPositionsBeforeUpdate,B=pt.flippedElementPositionsAfterUpdate,q=pt.applyTransformOrigin,X=pt.spring,i=pt.getElement,n=pt.debug,o=pt.staggerConfig;void 0===o&&(o={});var Y=pt.decisionData;void 0===Y&&(Y={});var W,l=pt.onComplete,d=pt.containerEl,H=pt.isGestureControlled,h=new Promise(function(t){W=t});if(l&&h.then(function(){return l(d,Y)}),!t.length)return function(){return W([]),h};var N=[],f=i(t[0]),J=f?f.ownerDocument.querySelector("body"):document.querySelector("body"),g=t.reduce(function(t,e){return t[e]=(t[e]||0)+1,t},{});Object.keys(g).filter(function(t){return 1<g[t]});var z=t.map(function(n){var i=K[n].rect,o=B[n].rect,t=K[n].opacity,l=B[n].opacity,d=o.width<1||o.height<1,h=B[n].element;if(!A(i)&&!A(o))return!1;if(!h)return!1;var f=JSON.parse(h.dataset.flipConfig),g=function(t){void 0===t&&(t={});var e=t.flippedSpring;return a({},c.noWobble,u(t.flipperSpring),u(e))}({flipperSpring:X,flippedSpring:f.spring}),m=!0===f.stagger?"default":f.stagger,v={element:h,id:n,stagger:m,springConfig:g};if(G[n]&&G[n].shouldFlip&&!G[n].shouldFlip(Y.previous,Y.current))return!1;var y=Math.abs(i.left-o.left),S=Math.abs(i.top-o.top),_=y+S,E=Math.abs(i.width-o.width)+Math.abs(i.height-o.height),C=Math.abs(l-t);if(_<.5&&E<.5&&C<.01)return!1;var I=e.parse(B[n].transform),w={matrix:I},O={matrix:[]},x=[I];f.translate&&(x.push(e.translateX(i.left-o.left)),x.push(e.translateY(i.top-o.top))),f.scale&&(x.push(e.scaleX(Math.max(i.width,1)/Math.max(o.width,1))),x.push(e.scaleY(Math.max(i.height,1)/Math.max(o.height,1)))),f.opacity&&(O.opacity=t,w.opacity=l);var P=[];G[n]&&G[n].shouldInvert&&!G[n].shouldInvert(Y.previous,Y.current)||(P=s(h.querySelectorAll('[data-inverse-flip-id="'+n+'"]')).map(function(t){return[t,JSON.parse(t.dataset.flipConfig)]})),O.matrix=b(x.reduce(e.multiply)),w.matrix=b(w.matrix);var F,U,D,V,j,M,R=(U=(F={element:h,invertedChildren:P,body:J}).element,D=F.invertedChildren,V=F.body,function(t){var e,i,l,p,n=t.matrix,o=t.opacity,s=t.forceMinVals;r(o)&&(U.style.opacity=o+""),s&&(U.style.minHeight="1px",U.style.minWidth="1px"),n&&(e="matrix("+n.join(", ")+")",U.style.transform=e,D&&(l=(i={invertedChildren:D,matrix:n,body:V}).matrix,p=i.body,i.invertedChildren.forEach(function(t){var e,i,n,r,o,s=t[0],a=t[1];p.contains(s)&&(e=l[0],i=l[3],n=l[5],r={translateX:0,translateY:0,scaleX:1,scaleY:1},o="",a.translate&&(r.translateX=-l[4]/e,r.translateY=-n/i,o+="translate("+r.translateX+"px, "+r.translateY+"px)"),a.scale&&(r.scaleX=1/e,r.scaleY=1/i,o+=" scale("+r.scaleX+", "+r.scaleY+")"),s.style.transform=o)})))});G[n]&&G[n].onComplete&&(j=G[n].onComplete,M=function(){return j(h,Y)});var k=r(O.opacity)&&r(w.opacity)&&O.opacity!==w.opacity,T=!1;return a({},v,{stagger:m,springConfig:g,getOnUpdateFunc:function(t){return L[n]={spring:t.spring,onAnimationEnd:t.onAnimationEnd,difference:{translateXDifference:y,translateYDifference:S,prevRect:i,currentRect:o}},function(t){G[n]&&G[n].onSpringUpdate&&G[n].onSpringUpdate(t.getCurrentValue()),T||(T=!0,G[n]&&G[n].onStart&&G[n].onStart(h,Y));var e,i=t.getCurrentValue();J.contains(h)?((e={matrix:[]}).matrix=O.matrix.map(function(t,e){return p(t,w.matrix[e],i)}),k&&(e.opacity=p(O.opacity,w.opacity,i)),R(e)):t.destroy()}},initializeFlip:function(){R({matrix:O.matrix,opacity:k?O.opacity:void 0,forceMinVals:d}),G[n]&&G[n].onStartImmediate&&G[n].onStartImmediate(h,Y),f.transformOrigin?h.style.transformOrigin=f.transformOrigin:q&&(h.style.transformOrigin="0 0"),P.forEach(function(t){var e=t[0],i=t[1];i.transformOrigin?e.style.transformOrigin=i.transformOrigin:q&&(e.style.transformOrigin="0 0")})},onAnimationEnd:function(){delete L[n],"function"==typeof M&&M(),h.style.transform="",P.forEach(function(t){t[0].style.transform=""}),d&&h&&(h.style.minHeight="",h.style.minWidth=""),N.push(n),N.length>=z.length&&W(N)},isGestureControlled:H,delayUntil:f.delayUntil})}).filter(Boolean);if(z.forEach(function(t){return(0,t.initializeFlip)()}),n)return function(){};var m=z.filter(function(t){return t.delayUntil&&(e=t.delayUntil,z.filter(function(t){return t.id===e}).length);var e}),v={},y={},S={};m.forEach(function(t){t.stagger?(S[t.stagger]=!0,y[t.delayUntil]?y[t.delayUntil].push(t.stagger):y[t.delayUntil]=[t.stagger]):v[t.delayUntil]?v[t.delayUntil].push(t):v[t.delayUntil]=[t]});var _=z.filter(function(t){return t.stagger}).reduce(function(t,e){return t[e.stagger]?t[e.stagger].push(e):t[e.stagger]=[e],t},{}),E=z.filter(function(t){return-1===m.indexOf(t)});return E.forEach(function(t){t.onSpringActivate=function(){v[t.id]&&v[t.id].forEach(I),y[t.id]&&Object.keys(y[t.id].reduce(function(t,e){var i;return a(t,((i={})[e]=!0,i))},{})).forEach(function(t){w(_[t],o[t],H)})}}),function(){return z.length||W([]),E.filter(function(t){return!t.stagger}).forEach(I),Object.keys(_).forEach(function(t){S[t]||w(_[t],o[t],H)}),h}}();z?z({hideEnteringElements:st,animateEnteringElements:at,animateExitingElements:lt,animateFlippedElements:ct}):(st(),lt().then(at),ct())}({flippedElementPositionsBeforeUpdate:n.flippedElementPositions,cachedOrderedFlipIds:n.cachedOrderedFlipIds,isGestureControlled:this.isGestureControlled,containerEl:this.el,inProgressAnimations:this.inProgressAnimations,flipCallbacks:this.flipCallbacks,applyTransformOrigin:this.props.applyTransformOrigin,spring:this.props.spring,debug:this.props.debug,portalKey:this.props.portalKey,staggerConfig:this.props.staggerConfig,handleEnterUpdateDelete:this.props.handleEnterUpdateDelete,decisionData:{previous:t.decisionData,current:this.props.decisionData},onComplete:this.props.onComplete,onStart:this.props.onStart})},t.prototype.render=function(){var e=this,t=this.props,i=t.portalKey,r=n.createElement(G.Provider,{value:{inProgressAnimations:this.inProgressAnimations,setIsGestureInitiated:this.setIsGestureInitiated}},n.createElement(k.Provider,{value:this.flipCallbacks},n.createElement(t.element,{className:t.className,ref:function(t){return e.el=t}},this.props.children)));return i&&(r=n.createElement(T.Provider,{value:i},r)),r},t}(i.Component);function K(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&-1===e.indexOf(n)&&(i[n]=t[n]);return i}L.defaultProps={applyTransformOrigin:!0,element:"div"};var B=function(t){var e=t.children,n=t.flipId,r=t.inverseFlipId,o=t.portalKey,s=t.gestureHandlers,l=K(t,["children","flipId","inverseFlipId","portalKey","gestureHandlers"]),p=e,c="function"==typeof p;if(!c)try{p=i.Children.only(e)}catch(t){throw new Error("Each Flipped component must wrap a single child")}l.scale||l.translate||l.opacity||a(l,{translate:!0,scale:!0,opacity:!0});var u={};return u["data-flip-config"]=JSON.stringify(l),n?u["data-flip-id"]=String(n):r&&(u["data-inverse-flip-id"]=String(r)),o&&(u["data-portal-key"]=o),c?p(u):(s&&a(u,s),i.cloneElement(p,u))},q=function(t){var i=t.children,r=t.flipId,s=t.shouldFlip,a=t.shouldInvert,l=t.onAppear,p=t.onStart,c=t.onStartImmediate,u=t.onComplete,d=t.onExit,h=t.onSpringUpdate,f=t.gestureHandlers,g=K(t,["children","flipId","shouldFlip","shouldInvert","onAppear","onStart","onStartImmediate","onComplete","onExit","onSpringUpdate","gestureHandlers"]);return i?g.inverseFlipId?n.createElement(B,Object.assign({},g),i):n.createElement(T.Consumer,null,function(e){return n.createElement(k.Consumer,null,function(t){return o(t)&&r&&(t[r]={shouldFlip:s,shouldInvert:a,onAppear:l,onStart:p,onStartImmediate:c,onComplete:u,onExit:d,onSpringUpdate:h}),n.createElement(B,Object.assign({flipId:r},g,{portalKey:e,gestureHandlers:f}),i)})}):null};q.displayName="Flipped";var X=function(t){function e(){t.apply(this,arguments),this.processProps=function(t){return Object.assign({},t,{flipId:t.flipId?String(t.flipId):String(t.children.props.flipId)})},this.swipe=new M(this.processProps(this.props))}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.componentDidUpdate=function(t){this.swipe.props=this.processProps(this.props),this.swipe.prevProps=this.processProps(t)},e.prototype.render=function(){return n.Children.only(this.props.children),i.cloneElement(this.props.children,"Flipped"===this.props.children.type.displayName?{gestureHandlers:this.swipe.handlers}:this.swipe.handlers)},e}(i.Component);exports.Flipper=L,exports.Flipped=q,exports.ExitContainer=function(t){var e;return i.cloneElement(t.children,((e={})["data-exit-container"]=!0,e))},exports.Swipe=function(e){return n.createElement(G.Consumer,null,function(t){return n.createElement(X,Object.assign({inProgressAnimations:t.inProgressAnimations,setIsGestureInitiated:t.setIsGestureInitiated},e))})},exports.spring=function(t){var n=t.values,r=t.onUpdate,e=t.delay;void 0===e&&(e=0);var i=t.onComplete,o=a({},c.noWobble,u(t.config)),s=o.overshootClamping,l=R.createSpring(o.stiffness,o.damping);return l.setOvershootClampingEnabled(!!s),l.addListener({onSpringAtRest:function(t){i&&i(),t.destroy()},onSpringUpdate:function(t){var e=t.getCurrentValue();if(!n)return r(e);var i=Object.keys(n).map(function(t){return[t,p(n[t][0],n[t][1],e)]}).reduce(function(t,e){var i;return Object.assign(t,((i={})[e[0]]=e[1],i))},{});r(i)}}),e?setTimeout(function(){l.setEndValue(1)},e):l.setEndValue(1),l};
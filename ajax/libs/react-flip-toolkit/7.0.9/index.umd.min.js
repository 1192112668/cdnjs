!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("rematrix"),require("prop-types"),require("react")):"function"==typeof define&&define.amd?define(["exports","rematrix","prop-types","react"],e):e(t.ReactFlipToolkit={},t.Rematrix,t.PropTypes,t.React)}(this,function(t,G,e,p){e=e&&e.hasOwnProperty("default")?e.default:e;function Q(t){return"number"==typeof t}function f(t){return"[object Object]"===Object.prototype.toString.call(t)}function Z(t){return Array.prototype.slice.apply(t)}var h="default"in p?p.default:p;function $(n){for(var t=[],e=arguments.length-1;0<e--;)t[e]=arguments[e+1];return t.forEach(function(t){if(t)for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])}),n}function tt(t,e,n){return t+(e-t)*n}function et(t){return f(t)?t:-1<Object.keys(nt).indexOf(t)?nt[t]:{}}var n,nt={noWobble:{stiffness:200,damping:26},gentle:{stiffness:120,damping:14},veryGentle:{stiffness:130,damping:17},wobbly:{stiffness:180,damping:12},stiff:{stiffness:260,damping:26}};"undefined"!=typeof window&&(n=window.requestAnimationFrame);var i=n=n||function(t){window.setTimeout(t,1e3/60)},r=Date.now(),o="object"==typeof performance&&"function"==typeof performance.now?function(){return performance.now()}:function(){return Date.now()-r};function a(t,e){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}function s(){}s.prototype.run=function(){var t=this;i(function(){t.springSystem.loop(o())})};function l(){this.position=0,this.velocity=0}function c(t){this._id="s"+u++,this._springSystem=t,this.listeners=[],this._startValue=0,this._currentState=new l,this._displacementFromRestThreshold=.001,this._endValue=0,this._overshootClampingEnabled=!1,this._previousState=new l,this._restSpeedThreshold=.001,this._tempState=new l,this._timeAccumulator=0,this._wasAtRest=!0,this._cachedSpringConfig={}}var u=0;c.prototype.getId=function(){return this._id},c.prototype.destroy=function(){this.listeners=[],this._springSystem.deregisterSpring(this)},c.prototype.setSpringConfig=function(t){return this._springConfig=t,this},c.prototype.getCurrentValue=function(){return this._currentState.position},c.prototype.getDisplacementDistanceForState=function(t){return Math.abs(this._endValue-t.position)},c.prototype.setEndValue=function(t){if(t===this._endValue)return this;if(this.prevEndValue=t,this._endValue===t&&this.isAtRest())return this;this._startValue=this.getCurrentValue(),this._endValue=t,this._springSystem.activateSpring(this.getId());for(var e=0,n=this.listeners.length;e<n;e++){var i=this.listeners[e].onSpringEndStateChange;i&&i(this)}return this},c.prototype.setVelocity=function(t){return t===this._currentState.velocity||(this._currentState.velocity=t,this._springSystem.activateSpring(this.getId())),this},c.prototype.setCurrentValue=function(t){this._startValue=t,this._currentState.position=t;for(var e=0,n=this.listeners.length;e<n;e++){var i=this.listeners[e];i.onSpringUpdate&&i.onSpringUpdate(this)}return this},c.prototype.setAtRest=function(){return this._endValue=this._currentState.position,this._tempState.position=this._currentState.position,this._currentState.velocity=0,this},c.prototype.setOvershootClampingEnabled=function(t){return this._overshootClampingEnabled=t,this},c.prototype.isOvershooting=function(){var t=this._startValue,e=this._endValue;return 0<this._springConfig.tension&&(t<e&&this.getCurrentValue()>e||e<t&&this.getCurrentValue()<e)},c.prototype.advance=function(t,e){var n=this.isAtRest();if(!n||!this._wasAtRest){var i=.064<e?.064:e;this._timeAccumulator+=i;for(var r,o,a,s,l=this._springConfig.tension,p=this._springConfig.friction,c=this._currentState.position,u=this._currentState.velocity,d=this._tempState.position,f=this._tempState.velocity;.001<=this._timeAccumulator;)this._timeAccumulator-=.001,this._timeAccumulator<.001&&(this._previousState.position=c,this._previousState.velocity=u),r=l*(this._endValue-d)-p*u,a=l*(this._endValue-(d=c+.001*u*.5))-p*(f=u+.001*r*.5),s=l*(this._endValue-(d=c+.001*(o=f)*.5))-p*(f=u+.001*a*.5),d=c+.001*f,c+=1/6*(u+2*(o+f)+(f=u+.001*s))*.001,u+=1/6*(r+2*(a+s)+(l*(this._endValue-d)-p*f))*.001;this._tempState.position=d,this._tempState.velocity=f,this._currentState.position=c,this._currentState.velocity=u,0<this._timeAccumulator&&this._interpolate(this._timeAccumulator/.001),(this.isAtRest()||this._overshootClampingEnabled&&this.isOvershooting())&&(0<this._springConfig.tension?(this._startValue=this._endValue,this._currentState.position=this._endValue):(this._endValue=this._currentState.position,this._startValue=this._endValue),this.setVelocity(0),n=!0);var h=!1;this._wasAtRest&&(h=!(this._wasAtRest=!1));var g=!1;n&&(g=this._wasAtRest=!0),this.notifyPositionUpdated(h,g)}},c.prototype.notifyPositionUpdated=function(e,n){var i=this;this.listeners.filter(Boolean).forEach(function(t){e&&t.onSpringActivate&&!i._onActivateCalled&&(t.onSpringActivate(i),i._onActivateCalled=!0),t.onSpringUpdate&&t.onSpringUpdate(i),n&&t.onSpringAtRest&&t.onSpringAtRest(i)})},c.prototype.systemShouldAdvance=function(){return!this.isAtRest()||!this.wasAtRest()},c.prototype.wasAtRest=function(){return this._wasAtRest},c.prototype.isAtRest=function(){return Math.abs(this._currentState.velocity)<this._restSpeedThreshold&&(this.getDisplacementDistanceForState(this._currentState)<=this._displacementFromRestThreshold||0===this._springConfig.tension)},c.prototype._interpolate=function(t){this._currentState.position=this._currentState.position*t+this._previousState.position*(1-t),this._currentState.velocity=this._currentState.velocity*t+this._previousState.velocity*(1-t)},c.prototype.addListener=function(t){return this.listeners.push(t),this},c.prototype.addOneTimeListener=function(i){var r=this;return Object.keys(i).forEach(function(t){var n;i[t]=(n=i[t],function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];n.apply(void 0,t),r.removeListener(i)})}),this.listeners.push(i),this},c.prototype.removeListener=function(t){return a(this.listeners,t),this};function d(t){this.looper=t||new s,(this.looper.springSystem=this).listeners=[],this._activeSprings=[],this._idleSpringIndices=[],this._isIdle=!0,this._lastTimeMillis=-1,this._springRegistry={}}d.prototype.createSpring=function(t,e){return this.createSpringWithConfig({tension:t,friction:e})},d.prototype.createSpringWithConfig=function(t){var e=new c(this);return this.registerSpring(e),e.setSpringConfig(t),e},d.prototype.getIsIdle=function(){return this._isIdle},d.prototype.registerSpring=function(t){this._springRegistry[t.getId()]=t},d.prototype.deregisterSpring=function(t){a(this._activeSprings,t),delete this._springRegistry[t.getId()]},d.prototype.advance=function(e,n){for(var i=this;0<this._idleSpringIndices.length;)this._idleSpringIndices.pop();for(this._activeSprings.filter(Boolean).forEach(function(t){t.systemShouldAdvance()?t.advance(e/1e3,n/1e3):i._idleSpringIndices.push(i._activeSprings.indexOf(t))});0<this._idleSpringIndices.length;){var t=this._idleSpringIndices.pop();0<=t&&this._activeSprings.splice(t,1)}},d.prototype.loop=function(t){var e;-1===this._lastTimeMillis&&(this._lastTimeMillis=t-1);var n=t-this._lastTimeMillis;this._lastTimeMillis=t;for(var i=0,r=this.listeners.length,i=0;i<r;i++)(e=this.listeners[i]).onBeforeIntegrate&&e.onBeforeIntegrate(this);for(this.advance(t,n),0===this._activeSprings.length&&(this._isIdle=!0,this._lastTimeMillis=-1),i=0;i<r;i++)(e=this.listeners[i]).onAfterIntegrate&&e.onAfterIntegrate(this);this._isIdle||this.looper.run()},d.prototype.activateSpring=function(t){var e=this._springRegistry[t];-1===this._activeSprings.indexOf(e)&&this._activeSprings.push(e),this.getIsIdle()&&(this._isIdle=!1,this.looper.run())};function g(t){var e=t.springConfig,n=e.overshootClamping,i=t.getOnUpdateFunc,r=t.onAnimationEnd,o=t.onSpringActivate,a=y.createSpring(e.stiffness,e.damping);a.setOvershootClampingEnabled(!!n);var s={onSpringActivate:o,onSpringAtRest:function(){a.destroy(),r()},onSpringUpdate:i({spring:a,onAnimationEnd:r})};return a.addListener(s),a}function it(t){var e=g(t);return e.setEndValue(1),e}function rt(t,e){var n,r,o,a;void 0===e&&(e={}),t&&t.length&&(e.reverse&&t.reverse(),r="number"!=typeof(n=e.speed)?1.1:1+Math.min(Math.max(5*n,0),5),o=1/Math.max(Math.min(t.length,100),10),(a=t.map(function(t,i){var e=t.getOnUpdateFunc;return t.getOnUpdateFunc=function(t){var n=e(t);return function(t){var e=t.getCurrentValue();(e=e<.01?0:.99<e?1:e)>=o&&a[i+1]&&a[i+1](Math.max(Math.min(e*r,1),0)),n(t)}},t}).map(function(t){var e=g(t);if(e)return e.setEndValue.bind(e)}).filter(Boolean))[0]&&a[0](1))}function ot(e){return[0,1,4,5,12,13].map(function(t){return e[t]})}function at(t){return t.top<window.innerHeight&&0<t.bottom&&t.left<window.innerWidth&&0<t.right}function st(t,e){var n;return $(t,((n={})[e[0]]=e[1],n))}function lt(t,e){return Z(e?document.querySelectorAll('[data-portal-key="'+e+'"]'):t.querySelectorAll("[data-flip-id]"))}function pt(t){return t.map(function(t){return[t,t.getBoundingClientRect()]})}var m,y=new d,v=new d,S=p.createContext({}),_=p.createContext("portal"),E=((m=p.Component)&&(C.__proto__=m),((C.prototype=Object.create(m&&m.prototype)).constructor=C).prototype.getSnapshotBeforeUpdate=function(t){return t.flipKey!==this.props.flipKey&&this.el?function(t){var e=t.element,o=t.flipCallbacks;void 0===o&&(o={});var n=t.inProgressAnimations;void 0===n&&(n={});var i=lt(e,t.portalKey),r=Z(e.querySelectorAll("[data-inverse-flip-id]")),a={},s=[],l={};i.filter(function(t){return o&&o[t.dataset.flipId]&&o[t.dataset.flipId].onExit}).forEach(function(t){var e,n=t.parentNode;!t.closest||(e=t.closest("[data-exit-container]"))&&(n=e);var i=s.findIndex(function(t){return t[0]===n});-1===i&&(s.push([n,n.getBoundingClientRect()]),i=s.length-1),a[t.dataset.flipId]=s[i][1],l[t.dataset.flipId]=n});var p,c,u=pt(i),d=u.map(function(t){var e,n=t[0],i=t[1],r={};return o&&o[n.dataset.flipId]&&o[n.dataset.flipId].onExit&&(e=a[n.dataset.flipId],$(r,{element:n,parent:l[n.dataset.flipId],childPosition:{top:i.top-e.top,left:i.left-e.left,width:i.width,height:i.height}})),[n.dataset.flipId,{rect:i,opacity:parseFloat(window.getComputedStyle(n).opacity||"1"),domDataForExitAnimations:r}]}).reduce(st,{});return p=n,c=i.concat(r),Object.keys(p).forEach(function(t){p[t].destroy&&p[t].destroy(),p[t].onAnimationEnd&&p[t].onAnimationEnd(!0),delete p[t]}),c.forEach(function(t){t.style.transform="",t.style.opacity=""}),{flippedElementPositions:d,cachedOrderedFlipIds:u.map(function(t){return t[0].dataset.flipId})}}({element:this.el,flipCallbacks:this.flipCallbacks,inProgressAnimations:this.inProgressAnimations,portalKey:this.props.portalKey}):null},C.prototype.componentDidUpdate=function(t,e,n){this.props.flipKey!==t.flipKey&&this.el&&function(t){var e=t.cachedOrderedFlipIds;void 0===e&&(e=[]);var n=t.inProgressAnimations;void 0===n&&(n={});var i=t.flippedElementPositionsBeforeUpdate;void 0===i&&(i={});var r=t.flipCallbacks;void 0===r&&(r={});var o=t.containerEl,a=t.applyTransformOrigin,s=t.spring,l=t.debug,p=t.portalKey,c=t.staggerConfig;void 0===c&&(c={});var u=t.decisionData;function d(t){return i[t]&&K[t]}void 0===u&&(u={});var f,h,g,m,y,v,S,_,E,C,A,b,I,x,O,w,U,V,F,P,R,M,k,j=t.handleEnterUpdateDelete,D=t.onComplete,T=t.onStart,K=pt(lt((k={element:o,portalKey:p}).element,k.portalKey)).map(function(t){var e=t[0],n=t[1],i=window.getComputedStyle(e);return[e.dataset.flipId,{element:e,rect:n,opacity:parseFloat(i.opacity),transform:i.transform}]}).reduce(st,{}),B=(R=(U={containerEl:o,portalKey:p}).containerEl,(M=U.portalKey)?(P=M,function(t){return Z(document.querySelectorAll('[data-portal-key="'+P+'"]'+t))}):R?(V=R,F=Math.random().toFixed(5),V.dataset.flipperId=F,function(t){return Z(V.querySelectorAll('[data-flipper-id="'+F+'"] '+t))}):function(){return[]}),q=(w=B,function(t){return w('[data-flip-id="'+t+'"]')[0]}),W=Object.keys(i).concat(Object.keys(K)).filter(function(t){return!d(t)}),X={flipCallbacks:r,getElement:q,flippedElementPositionsBeforeUpdate:i,flippedElementPositionsAfterUpdate:K,inProgressAnimations:n,decisionData:u},Y=(f=$({},X,{unflippedIds:W}),g=f.unflippedIds,m=f.flipCallbacks,y=f.getElement,v=f.flippedElementPositionsBeforeUpdate,S=f.flippedElementPositionsAfterUpdate,_=f.inProgressAnimations,E=f.decisionData,C=g.filter(function(t){return S[t]}).filter(function(t){return m[t]&&m[t].onAppear}),A=g.filter(function(t){return v[t]&&m[t]&&m[t].onExit}),b=new Promise(function(t){h=t}),I=[],x=0,O=A.map(function(t,e){var n=v[t].domDataForExitAnimations,i=n.element,r=n.parent,o=n.childPosition,a=o.top,s=o.left,l=o.width,p=o.height;"static"===getComputedStyle(r).position&&(r.style.position="relative"),i.style.transform="matrix(1, 0, 0, 1, 0, 0)",i.style.position="absolute",i.style.top=a+"px",i.style.left=s+"px",i.style.height=p+"px",i.style.width=l+"px";var c=I.filter(function(t){return t[0]===r})[0];function u(){try{r.removeChild(i)}catch(t){}finally{0==--x&&h()}}return c||(c=[r,document.createDocumentFragment()],I.push(c)),c[1].appendChild(i),x+=1,_[t]={stop:u},function(){return m[t].onExit(i,e,u,E)}}),I.forEach(function(t){t[0].appendChild(t[1])}),O.length||h(),{hideEnteringElements:function(){C.forEach(function(t){var e=y(t);e&&(e.style.opacity="0")})},animateEnteringElements:function(){C.forEach(function(t,e){var n=y(t);n&&m[t].onAppear(n,e,E)})},animateExitingElements:function(){return O.forEach(function(t){return t()}),b}}),N=Y.hideEnteringElements,L=Y.animateEnteringElements,H=Y.animateExitingElements,J=$({},X,{containerEl:o,flippedIds:e.filter(d),applyTransformOrigin:a,spring:s,debug:l,staggerConfig:c,scopedSelector:B,onComplete:D});T&&T(o,u);var z=function(){var t=J.flippedIds,w=J.flipCallbacks,U=J.inProgressAnimations,V=J.flippedElementPositionsBeforeUpdate,F=J.flippedElementPositionsAfterUpdate,P=J.applyTransformOrigin,R=J.spring,e=J.getElement,n=J.debug,i=J.staggerConfig;void 0===i&&(i={});var M=J.decisionData;void 0===M&&(M={});var k,r=J.onComplete,o=J.containerEl,a=new Promise(function(t){k=t});if(r&&a.then(function(){return r(o,M)}),!t.length)return function(){return k([]),a};var j=[],s=e(t[0]),D=s?s.ownerDocument.querySelector("body"):document.querySelector("body"),l=t.reduce(function(t,e){return t[e]=(t[e]||0)+1,t},{});Object.keys(l).filter(function(t){return 1<l[t]});var T=t.map(function(i){var t=V[i].rect,e=F[i].rect,n=V[i].opacity,r=F[i].opacity,o=e.width<1||e.height<1,a=F[i].element;if(!at(t)&&!at(e))return!1;if(!a)return!1;var s=JSON.parse(a.dataset.flipConfig),l=function(t){void 0===t&&(t={});var e=t.flippedSpring;return $({},nt.noWobble,et(t.flipperSpring),et(e))}({flipperSpring:R,flippedSpring:s.spring}),p=!0===s.stagger?"default":s.stagger,c={element:a,id:i,stagger:p,springConfig:l};if(w[i]&&w[i].shouldFlip&&!w[i].shouldFlip(M.previous,M.current))return!1;var u=Math.abs(t.left-e.left)+Math.abs(t.top-e.top),d=Math.abs(t.width-e.width)+Math.abs(t.height-e.height),f=Math.abs(r-n);if(u<.5&&d<.5&&f<.01)return!1;var h=G.parse(F[i].transform),g={matrix:h},m={matrix:[]},y=[h];s.translate&&(y.push(G.translateX(t.left-e.left)),y.push(G.translateY(t.top-e.top))),s.scale&&(y.push(G.scaleX(Math.max(t.width,1)/Math.max(e.width,1))),y.push(G.scaleY(Math.max(t.height,1)/Math.max(e.height,1)))),s.opacity&&(m.opacity=n,g.opacity=r);var v=[];w[i]&&w[i].shouldInvert&&!w[i].shouldInvert(M.previous,M.current)||(v=Z(a.querySelectorAll('[data-inverse-flip-id="'+i+'"]')).map(function(t){return[t,JSON.parse(t.dataset.flipConfig)]})),m.matrix=ot(y.reduce(G.multiply)),g.matrix=ot(g.matrix);var S,_,E,C,A,b,I=(_=(S={element:a,invertedChildren:v,body:D}).element,E=S.invertedChildren,C=S.body,function(t){var e,n,l,p,i=t.matrix,r=t.opacity,o=t.forceMinVals;Q(r)&&(_.style.opacity=r+""),o&&(_.style.minHeight="1px",_.style.minWidth="1px"),i&&(e="matrix("+i.join(", ")+")",_.style.transform=e,E&&(l=(n={invertedChildren:E,matrix:i,body:C}).matrix,p=n.body,n.invertedChildren.forEach(function(t){var e,n,i,r,o,a=t[0],s=t[1];p.contains(a)&&(e=l[0],n=l[3],i=l[5],r={translateX:0,translateY:0,scaleX:1,scaleY:1},o="",s.translate&&(r.translateX=-l[4]/e,r.translateY=-i/n,o+="translate("+r.translateX+"px, "+r.translateY+"px)"),s.scale&&(r.scaleX=1/e,r.scaleY=1/n,o+=" scale("+r.scaleX+", "+r.scaleY+")"),a.style.transform=o)})))});w[i]&&w[i].onComplete&&(A=w[i].onComplete,b=function(){return A(a,M)});var x=Q(m.opacity)&&Q(g.opacity)&&m.opacity!==g.opacity,O=!1;return $({},c,{stagger:p,springConfig:l,getOnUpdateFunc:function(t){var e=t.spring,n=t.onAnimationEnd;return U[i]={destroy:e.destroy.bind(e),onAnimationEnd:n},function(t){w[i]&&w[i].onSpringUpdate&&w[i].onSpringUpdate(t.getCurrentValue()),O||(O=!0,w[i]&&w[i].onStart&&w[i].onStart(a,M));var e,n=t.getCurrentValue();D.contains(a)?((e={matrix:[]}).matrix=m.matrix.map(function(t,e){return tt(t,g.matrix[e],n)}),x&&(e.opacity=tt(m.opacity,g.opacity,n)),I(e)):t.destroy()}},initializeFlip:function(){I({matrix:m.matrix,opacity:x?m.opacity:void 0,forceMinVals:o}),w[i]&&w[i].onStartImmediate&&w[i].onStartImmediate(a,M),s.transformOrigin?a.style.transformOrigin=s.transformOrigin:P&&(a.style.transformOrigin="0 0"),v.forEach(function(t){var e=t[0],n=t[1];n.transformOrigin?e.style.transformOrigin=n.transformOrigin:P&&(e.style.transformOrigin="0 0")})},onAnimationEnd:function(t){delete U[i],"function"==typeof b&&b(),a.style.transform="",v.forEach(function(t){t[0].style.transform=""}),o&&a&&(a.style.minHeight="",a.style.minWidth=""),t||(j.push(i),j.length>=T.length&&k(j))},delayUntil:s.delayUntil})}).filter(Boolean);if(T.forEach(function(t){return(0,t.initializeFlip)()}),n)return function(){};var p=T.filter(function(t){return t.delayUntil&&(e=t.delayUntil,T.filter(function(t){return t.id===e}).length);var e}),c={},u={},d={};p.forEach(function(t){t.stagger?(d[t.stagger]=!0,u[t.delayUntil]?u[t.delayUntil].push(t.stagger):u[t.delayUntil]=[t.stagger]):c[t.delayUntil]?c[t.delayUntil].push(t):c[t.delayUntil]=[t]});var f=T.filter(function(t){return t.stagger}).reduce(function(t,e){return t[e.stagger]?t[e.stagger].push(e):t[e.stagger]=[e],t},{}),h=T.filter(function(t){return-1===p.indexOf(t)});return h.forEach(function(t){t.onSpringActivate=function(){c[t.id]&&c[t.id].forEach(it),u[t.id]&&Object.keys(u[t.id].reduce(function(t,e){var n;return $(t,((n={})[e]=!0,n))},{})).forEach(function(t){rt(f[t],i[t])})}}),function(){return T.length||k([]),h.filter(function(t){return!t.stagger}).forEach(it),Object.keys(f).forEach(function(t){d[t]||rt(f[t],i[t])}),a}}();j?j({hideEnteringElements:N,animateEnteringElements:L,animateExitingElements:H,animateFlippedElements:z}):(N(),H().then(L),z())}({flippedElementPositionsBeforeUpdate:n.flippedElementPositions,cachedOrderedFlipIds:n.cachedOrderedFlipIds,containerEl:this.el,inProgressAnimations:this.inProgressAnimations,flipCallbacks:this.flipCallbacks,applyTransformOrigin:this.props.applyTransformOrigin,spring:this.props.spring,debug:this.props.debug,portalKey:this.props.portalKey,staggerConfig:this.props.staggerConfig,handleEnterUpdateDelete:this.props.handleEnterUpdateDelete,decisionData:{previous:t.decisionData,current:this.props.decisionData},onComplete:this.props.onComplete,onStart:this.props.onStart})},C.prototype.render=function(){var e=this,t=this.props,n=t.portalKey,i=h.createElement(S.Provider,{value:this.flipCallbacks},h.createElement(t.element,{className:t.className,ref:function(t){return e.el=t}},this.props.children));return n&&(i=h.createElement(_.Provider,{value:n},i)),i},C);function C(){m.apply(this,arguments),this.inProgressAnimations={},this.flipCallbacks={},this.el=void 0}function A(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&-1===e.indexOf(i)&&(n[i]=t[i]);return n}E.defaultProps={applyTransformOrigin:!0,element:"div"};function b(t){var e=t.children,n=t.flipId,i=t.inverseFlipId,r=t.portalKey,o=A(t,["children","flipId","inverseFlipId","portalKey"]),a=e,s="function"==typeof a;if(!s)try{a=p.Children.only(e)}catch(t){throw new Error("Each Flipped component must wrap a single child")}o.scale||o.translate||o.opacity||$(o,{translate:!0,scale:!0,opacity:!0});var l={};return l["data-flip-config"]=JSON.stringify(o),n?l["data-flip-id"]=String(n):i&&(l["data-inverse-flip-id"]=String(i)),r&&(l["data-portal-key"]=r),s?a(l):p.cloneElement(a,l)}function I(t){var n=t.children,i=t.flipId,r=t.shouldFlip,o=t.shouldInvert,a=t.onAppear,s=t.onStart,l=t.onStartImmediate,p=t.onComplete,c=t.onExit,u=t.onSpringUpdate,d=A(t,["children","flipId","shouldFlip","shouldInvert","onAppear","onStart","onStartImmediate","onComplete","onExit","onSpringUpdate"]);return n?d.inverseFlipId?h.createElement(b,Object.assign({},d),n):h.createElement(_.Consumer,null,function(e){return h.createElement(S.Consumer,null,function(t){return f(t)&&i&&(t[i]={shouldFlip:r,shouldInvert:o,onAppear:a,onStart:s,onStartImmediate:l,onComplete:p,onExit:c,onSpringUpdate:u}),h.createElement(b,Object.assign({flipId:i},d,{portalKey:e}),n)})}):null}I.displayName="Flipped",t.Flipper=E,t.Flipped=I,t.ExitContainer=function(t){var e;return p.cloneElement(t.children,((e={})["data-exit-container"]=!0,e))},t.spring=function(t){var i=t.values,r=t.onUpdate,e=t.delay;void 0===e&&(e=0);var n=t.onComplete,o=$({},nt.noWobble,et(t.config)),a=o.overshootClamping,s=v.createSpring(o.stiffness,o.damping);return s.setOvershootClampingEnabled(!!a),s.addListener({onSpringAtRest:function(t){n&&n(),t.destroy()},onSpringUpdate:function(t){var e=t.getCurrentValue();if(!i)return r(e);var n=Object.keys(i).map(function(t){return[t,tt(i[t][0],i[t][1],e)]}).reduce(function(t,e){var n;return Object.assign(t,((n={})[e[0]]=e[1],n))},{});r(n)}}),e?setTimeout(function(){s.setEndValue(1)},e):s.setEndValue(1),s}});
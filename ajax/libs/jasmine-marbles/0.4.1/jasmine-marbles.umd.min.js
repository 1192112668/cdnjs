!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("rxjs"),require("rxjs/testing"),require("lodash")):"function"==typeof define&&define.amd?define(["exports","rxjs","rxjs/testing","lodash"],t):t(e["jasmine-marbles"]=e["jasmine-marbles"]||{},e.Rx,e.Rx,e._)}(this,function(e,t,r,n){"use strict";function s(e){return JSON.stringify(e,function(e,t){return Array.isArray(t)?"["+t.map(function(e){return"\n\t"+s(e)})+"\n]":t}).replace(/\\"/g,'"').replace(/\\t/g,"\t").replace(/\\n/g,"\n")}function i(e){const{notification:t}=e;if(t){const{kind:e,exception:r}=t;"E"===e&&r instanceof Error&&(t.exception={name:r.name,message:r.message})}return e}function o(e,t){if(Array.isArray(e)&&Array.isArray(t)){e=e.map(i),t=t.map(i);const r=n.isEqual(e,t);if(r)return;let o="\nExpected \n";e.forEach(e=>o+=`\t${s(e)}\n`),o+="\t\nto deep equal \n",t.forEach(e=>o+=`\t${s(e)}\n`),expect(r).toEqual(o)}else expect(e).toEqual(t)}let a;function c(){a=new r.TestScheduler(o)}function u(){if(a)return a;throw new Error("No test scheduler initialized")}function f(){a=null}class l extends t.Observable{constructor(e,t,r){super(),this.marbles=e,this.values=t,this.error=r,this.source=u().createColdObservable(e,t,r)}getSubscriptions(){return this.source.subscriptions}}class p extends t.Observable{constructor(e,t,r){super(),this.marbles=e,this.values=t,this.error=r,this.source=u().createHotObservable(e,t,r)}getSubscriptions(){return this.source.subscriptions}}function m(){jasmine.addMatchers({toHaveSubscriptions:()=>({compare:function(e,t){const n=("string"==typeof t?[t]:t).map(e=>r.TestScheduler.parseMarblesAsSubscriptions(e));return expect(n).toEqual(e.getSubscriptions()),{pass:!0}}}),toBeObservable:()=>({compare:function(e,n){const s=[];let i;const o=u();o.schedule(()=>{i=e.subscribe(e=>{let r=e;e instanceof t.Observable&&(r=function(e,r){const n=[],s=u();return e.subscribe(e=>{n.push({frame:s.frame-r,notification:t.Notification.createNext(e)})},e=>{n.push({frame:s.frame-r,notification:t.Notification.createError(e)})},()=>{n.push({frame:s.frame-r,notification:t.Notification.createComplete()})}),n}(r,o.frame)),s.push({frame:o.frame,notification:t.Notification.createNext(r)})},e=>{s.push({frame:o.frame,notification:t.Notification.createError(e)})},()=>{s.push({frame:o.frame,notification:t.Notification.createComplete()})})}),o.flush();const a=r.TestScheduler.parseMarbles(n.marbles,n.values,n.error,!0);return expect(s).toEqual(a),{pass:!0}}})})}"object"==typeof module&&module.exports&&(jasmine.getEnv().beforeAll(()=>m()),jasmine.getEnv().beforeEach(()=>c()),jasmine.getEnv().afterEach(()=>{u().flush(),f()})),e.hot=function(e,t,r){return new p(e.trim(),t,r)},e.cold=function(e,t,r){return new l(e.trim(),t,r)},e.time=function(e){return u().createTime(e.trim())},e.addMatchers=m,e.getTestScheduler=u,e.initTestScheduler=c,e.resetTestScheduler=f,Object.defineProperty(e,"__esModule",{value:!0})});
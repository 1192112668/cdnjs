!function(O){O.extend(O.jqx._jqxGrid.prototype,{_exportData:function(e,t){var r=this,l=(l="string"==typeof t?t:t.fileName)||"jqxGrid";t&&"string"!=typeof t||(t={header:!0,filterBy:null,groupBy:null,style:null,fileName:l,pageOrientation:"portrait",expandChart:"+",collapseChar:"-"});var s=new O.jqx.dataAdapter.DataExporter({exportHeader:t.header});s.expandChar=t.expandChar,s.collapseChar=t.collapseChar,s.pageOrientation=t.pageOrientation,s.style=t.style,s.filterBy=t.filterBy,s.groupBy=t.groupBy;for(var o=[],i=r.columngroups||[],a=0,n=0;n<r.columns.records.length;n++)null!==r.columns.records[n].datafield&&(o[a++]={label:r.columns.records[n].text,dataField:r.columns.records[n].datafield});if(s.header={columns:o,columngroups:i},!t.style){var d=window.getComputedStyle(r.element),h=window.getComputedStyle(0<r.columns.records.length&&r.columns.records[0].element?r.columns.records[0].element:r.host.find(".jqx-grid-header")[0]),c=window.getComputedStyle(r.host.find(".jqx-grid-header")[0]);if(!(0===r.offsetWidth||0===r.offsetHeight)){function f(e){var t=e.fontSize,r=e.borderRightColor,l=e.backgroundColor,s=e.color,o=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f");function i(e){return(e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/))?"#"+a(e[1])+a(e[2])+a(e[3]).toUpperCase():"#ffffff"}function a(e){return isNaN(e)?"00":o[(e-e%16)/16]+o[e%16]}return{borderColor:i(r),fontSize:t,fontFamily:"Helvetica",color:i(s),backgroundColor:i(l)}}for(var g,u,p=f(d),m=f(h),y=f(c),x={height:"30px",border:"1px solid "+p.borderColor,fontFamily:y.fontFamily,fontSize:y.fontSize,color:y.color,backgroundColor:m.backgroundColor,fontWeight:"400"},b={border:"1px solid "+p.borderColor,fontFamily:p.fontFamily,fontSize:p.fontSize},v={height:r.rowsheight+"px"},n=0;n<r.columns.records.length;n++){(j=r.columns.records[n]).exportable&&(x[j.datafield]={textAlign:j.align,width:j.width+"px",format:j.cellsformat||""},g=j.cellsformat||"","date"===j.dataType?g="d":"dateTime"===j.dataType?g="D":"time"===j.dataType&&(g="t"),u={textAlign:j.cellsalign,format:g},b[j.datafield]=u)}r.altrows&&(v.alternationCount=2,v.alternationStart=0,v.alternationEnd=0,v.alternationIndex0Color=p.color,v.alternationIndex0BackgroundColor=p.backgroundColor,v.alternationIndex1Color=p.color,v.alternationIndex1BackgroundColor="#F5F5F5"),s.style={border:"1px solid "+p.borderColor,borderCollapse:"collapse",header:x,columns:b,rows:v}}}for(var w=this.getrows(),C=[],n=0;n<w.length;n++){var S=w[n];if(!S.hidden){for(var j,q={},T=0;T<r.columns.records.length;T++){q[(j=r.columns.records[T]).datafield]=S[j.datafield]}C.push(q)}}return!t.groupBy&&r.groups&&(s.groupBy=r.groups.slice(0)),s.exportData(C,e,t.fileName,null)},exportview:function(e,t){this._exportData(e,t)},exportdata:function(h,e,c,f,t,r,l){if(!O.jqx.dataAdapter.ArrayExporter)throw"jqxGrid: Missing reference to jqxdata.export.js!";if("xlsx"!==h){null==c&&(c=!0);var g=this;if(null==f)if(0==(f=this.getrows()).length)throw"No data to export.";this.exporting=!0,this.pageable||(this.loadondemand=!0),this.altrows&&this._renderrows(this.virtualsizeinfo);var s=this.hScrollInstance.value;this.hScrollInstance.setPosition(0),this._renderrows(this.virtualsizeinfo);var u=null!=t&&t,p={},m={},o=this.host.find(".jqx-grid-cell:first"),i=this.host.find(".jqx-grid-cell-alt:first");o.removeClass(this.toThemeProperty("jqx-grid-cell-selected")),o.removeClass(this.toThemeProperty("jqx-fill-state-pressed")),i.removeClass(this.toThemeProperty("jqx-grid-cell-selected")),i.removeClass(this.toThemeProperty("jqx-fill-state-pressed")),o.removeClass(this.toThemeProperty("jqx-grid-cell-hover")),o.removeClass(this.toThemeProperty("jqx-fill-state-hover")),i.removeClass(this.toThemeProperty("jqx-grid-cell-hover")),i.removeClass(this.toThemeProperty("jqx-fill-state-hover"));for(var y="cell",x=1,b="column",v=1,w=[],a=0;a<this.columns.records.length;a++){var n=this.columns.records[a];if(""!=n.cellclassname)if(n.customCellStyles=new Array,"string"==typeof n.cellclassname)for(var d=0;d<f.length;d++)n.customCellStyles[d]=n.cellclassname;else for(d=0;d<f.length;d++){var C=this.getrowboundindex(d),S=n.cellclassname(C,n.displayfield,f[d][n.displayfield],f[d]);S&&(n.customCellStyles[d]=S)}}var j,q,T,F=new Array,_=null,I=null,P=null;O.each(this.columns.records,function(e){var t,r=O(g.table[0].rows[0].cells[e]);1<g.table[0].rows.length&&(t=O(g.table[0].rows[1].cells[e]),P=P||t),I=I||r;function l(e){if(e.removeClass(g.toThemeProperty("jqx-grid-cell-selected")),e.removeClass(g.toThemeProperty("jqx-fill-state-pressed")),e.removeClass(g.toThemeProperty("jqx-grid-cell-hover")),e.removeClass(g.toThemeProperty("jqx-fill-state-hover")),s.customCellStyles)for(var t in s.customCellStyles)e.removeClass(s.customCellStyles[t])}var s=this;if(l(r),t&&l(t),null==this.displayfield)return!0;g.showaggregates&&g.getcolumnaggregateddata&&w.push(g.getcolumnaggregateddata(this.displayfield,this.aggregates,!0,f));var d=g._getexportcolumntype(this);!this.exportable||this.hidden&&!u||(p[this.displayfield]={},p[this.displayfield].text=this.text,p[this.displayfield].width=parseInt(this.width),isNaN(p[this.displayfield].width)&&(p[this.displayfield].width=60),p[this.displayfield].formatString=this.cellsformat,p[this.displayfield].localization=g.gridlocalization,p[this.displayfield].type=d,p[this.displayfield].cellsAlign=this.cellsalign,p[this.displayfield].hidden=!c,p[this.displayfield].displayfield=this.displayfield,F.push(p[this.displayfield])),y="cell"+x;var o,i=O(this.element);if(null==this.element&&(i=O(this.uielement)),_?s._rendered||(i=_,r=I,t=P,o=g.toTP("jqx-grid-cell")+" "+g.toTP("jqx-item"),r[0].className=o,o+=g.toTP("jqx-grid-cell-alt"),t&&(t[0].className=o)):_=i,b="column"+v,"html"==h||"xls"==h||"pdf"==h){function a(e,t,r,l,s,o,i,a,n){m[e]={},null!=t&&0!=t[0].offsetWidth&&0!=t[0].offsetHeight&&(m[e]["font-size"]=t.css("font-size"),m[e]["font-weight"]=t.css("font-weight"),m[e]["font-style"]=t.css("font-style"),m[e]["background-color"]=o._getexportcolor(t.css("background-color")),m[e].color=o._getexportcolor(t.css("color")),m[e]["border-color"]=o._getexportcolor(t.css("border-top-color")),r?m[e]["text-align"]=s.align:(m[e]["text-align"]=s.cellsalign,m[e].formatString=s.cellsformat,m[e].dataType=d),"html"!=h&&"pdf"!=h||(m[e]["border-top-width"]=t.css("border-top-width"),m[e]["border-left-width"]=t.css("border-left-width"),m[e]["border-right-width"]=t.css("border-right-width"),m[e]["border-bottom-width"]=t.css("border-bottom-width"),m[e]["border-top-style"]=t.css("border-top-style"),m[e]["border-left-style"]=t.css("border-left-style"),m[e]["border-right-style"]=t.css("border-right-style"),m[e]["border-bottom-style"]=t.css("border-bottom-style"),r?(0==i&&(m[e]["border-left-width"]=t.css("border-right-width")),m[e]["border-top-width"]=t.css("border-right-width"),m[e]["border-bottom-width"]=t.css("border-bottom-width")):0==i&&(m[e]["border-left-width"]=t.css("border-right-width")),m[e].height=t.css("height")),!s.exportable||s.hidden&&!u||(1==a?(p[s.displayfield].customCellStyles||(p[s.displayfield].customCellStyles=new Array),p[s.displayfield].customCellStyles[n]=e):r?p[s.displayfield].style=e:l?p[s.displayfield].cellAltStyle=e:p[s.displayfield].cellStyle=e))}if(a(b,i,!0,!1,this,g,e),v++,a(y,r,!1,!1,this,g,e),g.altrows&&a(y="cellalt"+x,t,!1,!0,this,g,e),this.customCellStyles){for(var n in s.customCellStyles)r.removeClass(s.customCellStyles[n]);for(var n in s.customCellStyles)r.addClass(s.customCellStyles[n]),a(y+s.customCellStyles[n],r,!1,!1,this,g,e,!0,n),r.removeClass(s.customCellStyles[n])}x++}}),O.each(this.columns.records,function(e){p[this.displayfield]&&(p[this.displayfield].columnsDataFields=F)}),this.showaggregates&&(j=[],q="xls"==h?"_AG":"",T=this.groupable?this.groups.length:0,this.rowdetails&&T++,"checkbox"===this.selectionmode&&T++,0<w.length&&(O.each(this.columns.records,function(e){if(this.aggregates)for(var t,r,l,s=0;s<this.aggregates.length;s++){j[s]||(j[s]={}),j[s]&&(t=g._getaggregatename(this.aggregates[s]),r=g._getaggregatetype(this.aggregates[s]),(l=w[e-T])&&(j[s][this.displayfield]=q+t+": "+l[r]))}}),O.each(this.columns.records,function(e){for(var t=0;t<j.length;t++)null==j[t][this.displayfield]&&(j[t][this.displayfield]=q)})),O.each(j,function(){f.push(this)}));var z=this,N=O.jqx.dataAdapter.ArrayExporter(f,p,m);if(null==e){this._renderrows(this.virtualsizeinfo);var A=N.exportTo(h);return this.showaggregates&&O.each(j,function(){f.pop(this)}),setTimeout(function(){z.exporting=!1},50),this.hScrollInstance.setPosition(s),this._renderrows(this.virtualsizeinfo),A}N.exportToFile(h,e,r,l),this.showaggregates&&O.each(j,function(){f.pop(this)}),this._renderrows(this.virtualsizeinfo),setTimeout(function(){z.exporting=!1},50),this.hScrollInstance.setPosition(s),this._renderrows(this.virtualsizeinfo)}else this._exportData("xlsx",e)},_getexportcolor:function(e){var t,r="transparent"==e?"#FFFFFF":e;if(r&&r.toString()||(r="#FFFFFF"),-1==r.toString().indexOf("rgb"))return-1!=r.toString().indexOf("#")&&4==r.toString().length&&(t=r.toString().substring(1,4),r+=t),r;var l=r.split(",");if(-1!=r.toString().indexOf("rgba")){var s=parseInt(l[0].substring(5)),o=parseInt(l[1]),i=parseInt(l[2]),a=parseInt(l[3].substring(1,4)),n={r:s,g:o,b:i},d=this._rgbToHex(n);return 0==s&&0==o&&0==i&&0==a?"#ffffff":"#"+d}n={r:s=parseInt(l[0].substring(4)),g:o=parseInt(l[1]),b:i=parseInt(l[2].substring(1,4))};return"#"+(d=this._rgbToHex(n))},_rgbToHex:function(e){return this._intToHex(e.r)+this._intToHex(e.g)+this._intToHex(e.b)},_intToHex:function(e){var t=parseInt(e).toString(16);return 1==t.length&&(t="0"+t),t.toUpperCase()},_getexportcolumntype:function(e){var t="string",r=this.source.datafields||(this.source._source?this.source._source.datafields:null);if(r){var l="";if(O.each(r,function(){if(this.name==e.displayfield)return this.type&&(l=this.type),!1}),l)return l}if(null!=e){if(null==this.dataview.cachedrecords)return t;var s=null;if(this.virtualmode)O.each(this.dataview.cachedrecords,function(){return s=this[e.displayfield],!1});else{if(0==this.dataview.cachedrecords.length)return t;if(null!=(s=this.dataview.cachedrecords[0][e.displayfield])&&""==s.toString())return"string"}if(null!=s){if(-1!=e.cellsformat.indexOf("c"))return"number";if(-1!=e.cellsformat.indexOf("n"))return"number";if(-1!=e.cellsformat.indexOf("p"))return"number";if(-1!=e.cellsformat.indexOf("d"))return"date";if(-1!=e.cellsformat.indexOf("y"))return"date";if(-1!=e.cellsformat.indexOf("M"))return"date";if(-1!=e.cellsformat.indexOf("m"))return"date";if(-1!=e.cellsformat.indexOf("t"))return"date";if("boolean"==typeof s)t="boolean";else if(O.jqx.dataFormat.isNumber(s))t="number";else{var o=new Date(s);if("NaN"==o.toString()||"Invalid Date"==o.toString())if(O.jqx.dataFormat){if(null!=(o=O.jqx.dataFormat.tryparsedate(s))){if(o&&o.getFullYear()&&1970==o.getFullYear()&&0==o.getMonth()&&1==o.getDate()){var i=new Number(s);return isNaN(i)?"string":"number"}return"date"}t="string"}else t="string";else t="date"}}}return t}})}(jqxBaseFramework);
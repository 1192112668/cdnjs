!function(G){G.extend(G.jqx._jqxGrid.prototype,{selectallrows:function(){this._trigger=!1;var e=this.virtualmode?this.dataview.totalrecords:this.dataview.loadedrecords.length;this.selectedrowindexes=new Array;for(var t=this.dataview.loadedrecords,l=0;l<e;l++){var i,s=t[l];s?null!=(i=this.getboundindex(s))&&(this.selectedrowindexes[l]=i):this.selectedrowindexes[l]=l}"checkbox"!=this.selectionmode||this._checkboxcolumnupdating||this._checkboxcolumn&&this._checkboxcolumn.checkboxelement.jqxCheckBox({checked:!0}),this._renderrows(this.virtualsizeinfo),this._trigger=!0,"checkbox"==this.selectionmode&&this._raiseEvent(2,{rowindex:this.selectedrowindexes})},unselectallrows:function(){this._trigger=!1;this.virtualmode?this.dataview.totalrecords:this.dataview.loadedrecords.length;this.selectedrowindexes=new Array,"checkbox"!=this.selectionmode||this._checkboxcolumnupdating||this._checkboxcolumn&&this._checkboxcolumn.checkboxelement.jqxCheckBox({checked:!1}),this._renderrows(this.virtualsizeinfo),this._trigger=!0,"checkbox"==this.selectionmode&&this._raiseEvent(2,{rowindex:this.selectedrowindexes})},selectrow:function(e,t){"none"!==this.selectionmode&&(this._applyrowselection(e,!0,t),!1!==t&&this._updatecheckboxselection())},_updatecheckboxselection:function(){if("checkbox"==this.selectionmode){var e=this.getrows();if(e&&this._checkboxcolumn){if(0===e.length)return void this._checkboxcolumn.checkboxelement.jqxCheckBox({checked:!1});var t=e.length;this.groupable&&(t=this.dataview.loadedrecords.length),this.virtualmode&&(t=this.source._source.totalrecords);var l=this.selectedrowindexes.length;l===t?this._checkboxcolumn.checkboxelement.jqxCheckBox({checked:!0}):0===l?this._checkboxcolumn.checkboxelement.jqxCheckBox({checked:!1}):this._checkboxcolumn.checkboxelement.jqxCheckBox({checked:null})}}},unselectrow:function(e,t){this._applyrowselection(e,!1,t),!1!==t&&this._updatecheckboxselection()},selectcell:function(e,t){this._applycellselection(e,t,!0)},unselectcell:function(e,t){this._applycellselection(e,t,!1)},clearselection:function(e,t){if(this._trigger=!1,this.selectedrowindex=-1,this._oldselectedcell=null,!1!==t)for(var l=0;l<this.selectedrowindexes.length;l++)this._raiseEvent(3,{rowindex:this.selectedrowindexes[l]});this.selectedrowindexes=new Array,this.selectedcells=new Array,this.selectedcell=null,"checkbox"!=this.selectionmode||this._checkboxcolumnupdating||this._checkboxcolumn.checkboxelement.jqxCheckBox({checked:!1});for(l=0;l<this.columns.records.length;l++)this.columns.records[l].selected=!1,this.columns.records[l]._applyStyle();!1!==e?(this._renderrows(this.virtualsizeinfo),this._trigger=!0,"checkbox"==this.selectionmode&&this._raiseEvent(3,{rowindex:this.selectedrowindexes})):this._trigger=!0},getselectedrowindex:function(){if(-1==this.selectedrowindex||null==this.selectedrowindex){var e=0;if(e<this.selectedrowindexes.length)return this.selectedrowindexes[e]}return this.selectedrowindex},getselectedrowindexes:function(){return this.selectedrowindexes},getselectedcell:function(){if(!this.selectedcell)return null;var e=this.selectedcell;return e.row=this.selectedcell.rowindex,e.column=this.selectedcell.datafield,e.value=this.getcellvalue(e.row,e.column),e},getselectedcells:function(){var e=new Array;for(var t in this.selectedcells)e[e.length]=this.selectedcells[t];return e},getselection:function(){return{cells:this.getselectedcells(),rows:this.getselectedrowindexes()}},_getcellsforcopypaste:function(){var e=new Array;if(-1==this.selectionmode.indexOf("cell"))for(var t=this.selectedrowindexes,l=0;l<t.length;l++)for(var i,s=t[l],o=0;o<this.columns.records.length;o++){"_checkboxcolumn"!==this.columns.records[o].datafield&&(this.columns.records[o].datafield,i={rowindex:s,datafield:this.columns.records[o].datafield},e.push(i))}return e},deleteselection:function(){var e=this,t=e.getselectedcells();if(-1==this.selectionmode.indexOf("cell")&&(t=this._getcellsforcopypaste()),null!=t&&0<t.length){for(var l=0;l<t.length;l++){var i,s=t[l],o=e.getcolumn(s.datafield),a=e.getcellvalue(s.rowindex,s.datafield);o&&""!==a&&(i=null,"checkbox"==o.columntype&&(o.threestatecheckbox||(i=!1)),e._raiseEvent(17,{rowindex:s.rowindex,datafield:s.datafield,value:a}),l==t.length-1?e.setcellvalue(s.rowindex,s.datafield,i,!0):e.setcellvalue(s.rowindex,s.datafield,i,!1),o.displayfield!=o.datafield&&e.setcellvalue(s.rowindex,o.displayfield,i,!0),e._raiseEvent(18,{rowindex:s.rowindex,datafield:s.datafield,oldvalue:a,value:i}))}this.dataview.updateview(),this._renderrows(this.virtualsizeinfo)}},copyselection:function(){var i="",s=this;this.clipboardselection={},this.logicalclipboardselection={},this._clipboardselection=[];var e=s.getselectedcells();-1==this.selectionmode.indexOf("cell")&&(e=this._getcellsforcopypaste());var t=new Array;if(null!=e&&0<e.length){for(var l=999999999999999,o=-1,a=0;a<e.length;a++){var r,n,d=e[a],c=s.getcolumn(d.datafield);null==c||!c.clipboard||c.hidden&&!this.copytoclipboardhiddencolumns||(-1==t.indexOf(c.text)&&t.push(c.text),r=s.getcelltext(d.rowindex,c.displayfield),n=this.getrowdisplayindex(d.rowindex),this.clipboardselection[n]||(this.clipboardselection[n]={}),this.clipboardselection[n][c.displayfield]=r,this.logicalclipboardselection[n]||(this.logicalclipboardselection[n]={}),this.logicalclipboardselection[n][c.displayfield]=r,c.displayfield!=c.datafield&&(this.logicalclipboardselection[n][c.datafield]=s.getcellvalue(d.rowindex,c.datafield)),l=Math.min(l,n),o=Math.max(o,n))}for(var h,u=new Array,f=l;f<=o;f++){this.logicalclipboardselection[f]&&(h=G.extend({},this.logicalclipboardselection[f]),u.push(h))}if(this.logicalclipboardselection=u,this.copytoclipboardwithheaders){for(var p=0;p<t.length;p++)0<p&&(i+="\t"),i+=t[p];i+="\r\n"}for(f=l;f<=o;f++){var g=0;this._clipboardselection[this._clipboardselection.length]=new Array,null!=this.clipboardselection[f]&&(G.each(this.clipboardselection[f],function(e,t){0<g&&(i+="\t");var l=null==t?"":t;s._clipboardselection[s._clipboardselection.length-1][g]=l,g++,i+=l}),f<o&&(i+="\r\n"))}}return this.clipboardselectedtext=i},pasteselection:function(){var e=this.getselectedcells();if(this._oldselectedcell=null,-1==this.selectionmode.indexOf("cell")&&(e=this._getcellsforcopypaste()),null!=e&&0<e.length){var t=e[0].rowindex,l=this.getrowdisplayindex(t),i=e[0].datafield,s=this._getcolumnindex(i);this.selectedrowindexes=new Array,this.selectedcells=new Array;e.length;var o=0,a=new Array,r=[];this.copytoclipboardwithheaders&&this._clipboardselection.splice(0,1);for(var n=0;n<this._clipboardselection.length;n++){o+=this._clipboardselection[n].length,a[n]=new Array;for(var d=0;d<this._clipboardselection[n].length;d++){var c=this._clipboardselection[n][d];a[n].push(c)}}if(o<e.length){for(var h=new Array,n=0;n<e.length;n++){h[(b=e[n]).rowindex]||(h[b.rowindex]=new Array),h[b.rowindex].push(b)}for(var u=0,f=0,n=0;n<h.length;n++)if(h[n]){for(d=0;d<h[n].length;d++){var p=(b=h[n][d]).rowindex;if("_checkboxcolumn"!==(m=this.getcolumn(b.datafield)).datafield&&!m.hidden){c="";if(null==a[u][f]&&(f=0),c=a[u][f],f++,m.cellsformat&&(-1!=m.cellsformat.indexOf("p")||-1!=m.cellsformat.indexOf("c")||-1!=m.cellsformat.indexOf("n")||-1!=m.cellsformat.indexOf("f"))){-1<c.indexOf(this.gridlocalization.currencysymbol)&&(c=c.replace(this.gridlocalization.currencysymbol,"")),-1<(c=(c=function(e,t,l){var i=e;if(t==l)return e;for(var s=i.indexOf(t);-1!=s;)s=(i=i.replace(t,l)).indexOf(t);return i}(c,this.gridlocalization.thousandsseparator,"")).replace(this.gridlocalization.decimalseparator,".")).indexOf(this.gridlocalization.percentsymbol)&&(c=c.replace(this.gridlocalization.percentsymbol,""));for(var g="",v=0;v<c.length;v++){"-"===(_=c.substring(v,v+1))&&(g+="-"),"."===_&&(g+="."),null!=_.match(/^[0-9]+$/)&&(g+=_)}c=(c=g).replace(/ /g,""),c=new Number(c),isNaN(c)&&(c="")}this._raiseEvent(17,{rowindex:p,datafield:b.datafield,value:c});var w=this.getrowdata(p);r.push({oldvalue:w[b.datafield],value:c,datafield:b.datafield,row:p}),this.setcellvalue(p,m.displayfield,c,!1),m.displayfield!=m.datafield&&this.logicalclipboardselection&&this.logicalclipboardselection[p]&&null!=(y=this.logicalclipboardselection[p][m.datafield])&&this.setcellvalue(p,m.datafield,y,!1),this._raiseEvent(18,{rowindex:p,datafield:b.datafield,oldvalue:this.getcellvalue(b.rowindex,b.datafield),value:c}),this._applycellselection(p,b.datafield,!0,!1)}}f=0,a[++u]||(u=0)}}else{if(!this._clipboardselection)return;for(w=0;w<this._clipboardselection.length;w++)for(var m,x=0;x<this._clipboardselection[w].length;x++){if((m=this.getcolumnat(s+x))&&("_checkboxcolumn"!==m.datafield&&!m.hidden)){var p=this.getrowboundindex(l+w),b=this.getcell(p,m.datafield),c=null;if(null!=(c=this._clipboardselection[w][x])){if(m.cellsformat&&(-1!=m.cellsformat.indexOf("p")||-1!=m.cellsformat.indexOf("c")||-1!=m.cellsformat.indexOf("n")||-1!=m.cellsformat.indexOf("f"))){-1<c.indexOf(this.gridlocalization.currencysymbol)&&(c=c.replace(this.gridlocalization.currencysymbol,"")),-1<(c=(c=function(e,t,l){var i=e;if(t==l)return e;for(var s=i.indexOf(t);-1!=s;)s=(i=i.replace(t,l)).indexOf(t);return i}(c,this.gridlocalization.thousandsseparator,"")).replace(this.gridlocalization.decimalseparator,".")).indexOf(this.gridlocalization.percentsymbol)&&(c=c.replace(this.gridlocalization.percentsymbol,""));for(var _,g="",v=0;v<c.length;v++){"-"===(_=c.substring(v,v+1))&&(g+="-"),"."===_&&(g+="."),null!=_.match(/^[0-9]+$/)&&(g+=_)}c=(c=g).replace(/ /g,""),c=new Number(c),isNaN(c)&&(c="")}this._raiseEvent(17,{rowindex:p,datafield:b.datafield,value:c});var y,k=this.getrowdata(p);r.push({oldvalue:k[b.datafield],value:c,datafield:b.datafield,row:p}),this.setcellvalue(p,m.displayfield,c,!1),m.displayfield!=m.datafield&&this.logicalclipboardselection&&null!=(y=this.logicalclipboardselection[w][m.datafield])&&this.setcellvalue(p,m.datafield,y,!1),this._raiseEvent(18,{rowindex:p,datafield:b.datafield,oldvalue:this.getcellvalue(b.rowindex,b.datafield),value:c}),this._applycellselection(p,b.datafield,!0,!1)}}}}"checkbox"==this.selectionmode&&this._updatecheckboxselection(),this.dataview.updateview(),this._renderrows(this.virtualsizeinfo)}this._undoRedo.push({action:"paste",data:r}),this._undoRedoIndex=-1,this.clipboardend&&this.clipboardend("paste")},_applyrowselection:function(e,t,l,i,s){if(null==e)return!1;var o,a=this.selectedrowindex;"singlerow"==this.selectionmode&&(t?this._raiseEvent(2,{rowindex:e,row:this.getrowdata(e)}):this._raiseEvent(3,{rowindex:e,row:this.getrowdata(e)}),this._raiseEvent(3,{rowindex:a}),this.selectedrowindexes=new Array,this.selectedcells=new Array),1==i&&(this.selectedrowindexes=new Array),0<this.dataview.filters.length&&((o=this.getrowdata(e))&&void 0!==o.dataindex?e=o.dataindex:o&&void 0===o.dataindex&&null!=o.uid&&(e=this.getrowboundindexbyid(o.uid)));var r,n=this.selectedrowindexes.indexOf(e);return t?(this.selectedrowindex=e,-1==n?(this.selectedrowindexes.push(e),"singlerow"!=this.selectionmode&&this._raiseEvent(2,{rowindex:e,row:this.getrowdata(e)})):"multiplerows"==this.selectionmode&&(this.selectedrowindexes.splice(n,1),this._raiseEvent(3,{rowindex:this.selectedrowindex,row:this.getrowdata(e)}),this.selectedrowindex=0<this.selectedrowindexes.length?this.selectedrowindexes[this.selectedrowindexes.length-1]:-1)):(0<=n||"singlerow"==this.selectionmode||"multiplerowsextended"==this.selectionmode||"multiplerowsadvanced"==this.selectionmode)&&(r=this.selectedrowindexes[n],this.selectedrowindexes.splice(n,1),this._raiseEvent(3,{rowindex:r,row:this.getrowdata(e)}),this.selectedrowindex=-1),null!=l&&!l||this._rendervisualrows(),!0},_applycellselection:function(e,t,l,i){if(null==e)return!1;if(null==t)return!1;this._autofill&&(this._autofill.remove(),G(document).off("pointermove.autofill"),G(document).off("pointerup.autofill"),this._autofill=null);var s;this.selectedrowindex;"singlecell"==this.selectionmode&&(null!=(s=this.selectedcell)&&this._raiseEvent(16,{rowindex:s.rowindex,datafield:s.datafield}),this.selectedcells=new Array),"multiplecellsextended"!=this.selectionmode&&"multiplecellsadvanced"!=this.selectionmode||null!=(s=this.selectedcell)&&this._raiseEvent(16,{rowindex:s.rowindex,datafield:s.datafield});var o,a=e+"_"+t;0<this.dataview.filters.length&&((o=this.getrowdata(e))&&void 0!==o.dataindex?a=(e=o.dataindex)+"_"+t:o&&void 0===o.dataindex&&o.uid&&(a=(e=this.getrowboundindexbyid(o.uid))+"_"+t));var r={rowindex:e,datafield:t};return l?(this.selectedcell=r,this.selectedcells[a]?"multiplecells"!=this.selectionmode&&"multiplecellsextended"!=this.selectionmode&&"multiplecellsadvanced"!=this.selectionmode||(delete this.selectedcells[a],0<this.selectedcells.length&&this.selectedcells.length--,this._raiseEvent(16,r)):(this.selectedcells[a]=r,this.selectedcells.length++,this._raiseEvent(15,r))):(delete this.selectedcells[a],0<this.selectedcells.length&&this.selectedcells.length--,this._raiseEvent(16,r)),null!=i&&!i||this._rendervisualrows(),!0},_getcellindex:function(e){var t=-1;return G.each(this.selectedcells,function(){if(t++,this[e])return!1}),t},_clearhoverstyle:function(){if(null!=this.hoveredrow&&-1!=this.hoveredrow&&!this.vScrollInstance.isScrolling()&&!this.hScrollInstance.isScrolling()){var e=this.table.find(".jqx-grid-cell-hover");0<e.length&&(e.removeClass(this.toTP("jqx-grid-cell-hover")),e.removeClass(this.toTP("jqx-fill-state-hover")));for(var t=0;t<e.length;t++){var l,i=e[t].getAttribute("columnindex");!i||(l=this.columns.records[parseInt(i)])&&l._applyCellStyle(e[t])}this.hoveredrow=-1}},_clearselectstyle:function(){for(var e=this.table[0].rows.length,t=this.table[0].rows,l=this.toTP("jqx-grid-cell-selected"),i=this.toTP("jqx-fill-state-pressed"),s=this.toTP("jqx-grid-cell-hover"),o=this.toTP("jqx-fill-state-hover"),a=0;a<e;a++)for(var r=t[a],n=r.cells.length,d=r.cells,c=0;c<n;c++){var h=d[c],u=G(h);-1!=h.className.indexOf("jqx-grid-cell-selected")&&(u.removeClass(l),u.removeClass(i)),-1!=h.className.indexOf("jqx-grid-cell-hover")&&(u.removeClass(s),u.removeClass(o));var f,p=h.getAttribute("columnindex");!p||(f=this.columns.records[parseInt(p)])&&f._applyCellStyle(h)}},_selectpath:function(e,t){var l=this._lastClickedCell?Math.min(this._lastClickedCell.row,e):0,i=this._lastClickedCell?Math.max(this._lastClickedCell.row,e):0;if(l<=i){var s=this._getcolumnindex(this._lastClickedCell.column||this._lastClickedCell.datafield),o=this._getcolumnindex(t),a=Math.min(s,o),r=Math.max(s,o);this.selectedcells=new Array;for(var n=this.dataview.loadedrecords,d=l;d<=i;d++)for(var c=a;c<=r;c++){e=n[d];this._applycellselection(this.getboundindex(e),this._getcolumnat(c).datafield,!0,!1),this.getboundindex(e),this._getcolumnat(c).datafield}this._rendervisualrows()}},_selectrowpath:function(e){if("multiplerowsextended"==this.selectionmode){var t=this._lastClickedCell?Math.min(this._lastClickedCell.row,e):0,l=this._lastClickedCell?Math.max(this._lastClickedCell.row,e):0,i=this.dataview.loadedrecords;if(t<=l){this.selectedrowindexes=new Array;for(var s=t;s<=l;s++){var e=i[s],o=this.getrowboundindex(s);this._applyrowselection(o,!0,!1)}this._rendervisualrows()}}},_selectrowwithmouse:function(e,t,l,i,s,o){if(null!=(w=t.row)){var a=t.index;if(null!=this.hittestinfo[a]){for(var r=0;r<this.columns.records.length;r++){var n=this.columns.records[r];n.selected=!1,n.element&&n.element.removeAttribute("selected"),n._applyStyle()}var d=this.hittestinfo[a].visualrow;if(!this.hittestinfo[a].details){d.cells[0].className;if(!w.group){if("multiplerows"==this.selectionmode||"multiplecells"==this.selectionmode||"checkbox"==this.selectionmode||-1!=this.selectionmode.indexOf("multiple")&&(1==o||1==s)){var c,h=this.getboundindex(w);0<this.dataview.filters.length&&((c=this.getrowdata(h))&&null==(h=c.dataindex)&&(h=this.getboundindex(w)));var u,f=-1!=l.indexOf(h),p=this.getboundindex(w)+"_"+i;if(-1!=this.selectionmode.indexOf("cell")){var g,v=null!=this.selectedcells[p];null!=this.selectedcells[p]&&v?this._selectcellwithstyle(e,!1,a,i,d):this._selectcellwithstyle(e,!0,a,i,d),!o||null!=this._lastClickedCell||(g=this.getselectedcells())&&0<g.length&&(this._lastClickedCell={row:g[0].rowindex,column:g[0].datafield}),o&&this._lastClickedCell&&(this._selectpath(w.visibleindex,i),this.mousecaptured=!1,"visible"==this.selectionarea.css("visibility")&&this.selectionarea.css("visibility","hidden"))}else{if(f?s?this._applyrowselection(this.getboundindex(w),!1):this._selectrowwithstyle(e,d,!1,i):this._selectrowwithstyle(e,d,!0,i),!o||null!=this._lastClickedCell||(u=this.getselectedrowindexes())&&0<u.length&&(this._lastClickedCell={row:u[0],column:i}),o&&this._lastClickedCell){this.selectedrowindexes=new Array;for(var w,m=this._lastClickedCell?Math.min(this._lastClickedCell.row,w.visibleindex):0,x=this._lastClickedCell?Math.max(this._lastClickedCell.row,w.visibleindex):0,b=this.dataview.loadedrecords,_=m;_<=x;_++){(w=b[_])&&this._applyrowselection(this.getboundindex(w),!0,!1,!1)}this._rendervisualrows()}}}else this._clearselectstyle(),this._selectrowwithstyle(e,d,!0,i),-1!=this.selectionmode.indexOf("cell")&&this._selectcellwithstyle(e,!0,a,i,d);o||(this._lastClickedCell={row:w.visibleindex,column:i})}}}}},_selectcellwithstyle:function(e,t,l,i,s){var o=G(s.cells[e._getcolumnindex(i)]);o.removeClass(this.toTP("jqx-grid-cell-hover")),o.removeClass(this.toTP("jqx-fill-state-hover")),t?(o.addClass(this.toTP("jqx-grid-cell-selected")),o.addClass(this.toTP("jqx-fill-state-pressed"))):(o.removeClass(this.toTP("jqx-grid-cell-selected")),o.removeClass(this.toTP("jqx-fill-state-pressed"))),this.getcolumn(i)._applyCellStyle(o)},_selectrowwithstyle:function(e,t,l,i){var s=t.cells.length,o=0;e.rowdetails&&e.showrowdetailscolumn?this.rtl?(--s,s-=this.groups.length):o=1+this.groups.length:this.groupable&&(this.rtl?s-=this.groups.length:o=this.groups.length);for(var a=o;a<s;a++){var r,n=t.cells[a];l?(G(n).removeClass(this.toTP("jqx-grid-cell-hover")),G(n).removeClass(this.toTP("jqx-fill-state-hover")),-1==e.selectionmode.indexOf("cell")&&(G(n).addClass(this.toTP("jqx-grid-cell-selected")),G(n).addClass(this.toTP("jqx-fill-state-pressed")))):(G(n).removeClass(this.toTP("jqx-grid-cell-hover")),G(n).removeClass(this.toTP("jqx-grid-cell-selected")),G(n).removeClass(this.toTP("jqx-fill-state-hover")),G(n).removeClass(this.toTP("jqx-fill-state-pressed"))),!(i=n.getAttribute("columnindex"))||(r=this.columns.records[parseInt(i)])&&r._applyCellStyle(n)}},_handlemousemoveselection:function(e,l,t){if(l.hScrollInstance.isScrolling()||l.vScrollInstance.isScrolling())return!1;if(("multiplerowsextended"==l.selectionmode||"multiplecellsextended"==l.selectionmode||"multiplecellsadvanced"==l.selectionmode)&&l.mousecaptured){if(l.multipleselectionbegins)if(!1===l.multipleselectionbegins(e))return!0;var i=this.showheader?this.columnsheader.height()+2:0,s=this._groupsheader()?this.groupsheader.height():0;s+=this.showtoolbar?this.toolbar.height():0,s+=this.showfilterbar?this.toolbarheight:0;var o,a=this.host.coord();this.hasTransform&&(a=G.jqx.utilities.getOffset(this.host),o=this._getBodyOffset(),a.left-=o.left,a.top-=o.top),"0px"===this.host.css("border-top-width")&&(s-=2);var r=e.pageX,n=e.pageY-s;if(e._pageX&&(r=e._pageX,n=e._pageY-s),3<Math.abs(this.mousecaptureposition.left-r)||3<Math.abs(this.mousecaptureposition.top-n)||l.autofill){parseInt(this.columnsheader.coord().top);this.hasTransform&&G.jqx.utilities.getOffset(this.columnsheader).top,r<a.left&&(r=a.left),r>a.left+this.host.width()&&(r=a.left+this.host.width());var d=a.top+i;n<d&&(n=d+5);var c=parseInt(Math.min(l.mousecaptureposition.left,r)),h=-5+parseInt(Math.min(l.mousecaptureposition.top,n)),u=parseFloat(Math.abs(l.mousecaptureposition.left-r)),f=parseInt(Math.abs(l.mousecaptureposition.top-n));if(c-=a.left,h-=a.top,this.selectionarea.css("visibility","visible"),"multiplecellsadvanced"==l.selectionmode){var p=(r=c)+u,g=l.hScrollInstance,v=g.value;this.rtl&&("hidden"!=this.hScrollBar.css("visibility")&&(v=g.max-g.value),this.vScrollBar[0].style.visibility);var w=l.table[0].rows[0],m=0,x=I=l.mousecaptureposition.clickedcell,b=!1,_=0,y=w.cells.length;l.mousecaptureposition.left<=e.pageX&&(_=I);for(var k=!1,C=_;C<y;C++){var q=parseFloat(G(this.columnsrow[0].cells[C]).css("left")),j=q-v;if(!l.columns.records[C].pinned||l.columns.records[C].hidden){if(k){b=!0,x--;break}var O=this._getcolumnat(C);if(!(null!=O&&O.hidden||l.groupable&&0<l.groups.length&&C<l.groups.length)){T=j+G(this.columnsrow[0].cells[C]).width();if(l.mousecaptureposition.left>e.pageX){if(r<=T&&j<=r){x=C,b=!0;break}}else if(p<=T&&j<=p){x=C,b=!0;break}}}else{C==I&&(k=!0);var T=q+G(this.columnsrow[0].cells[C]).width();if(l.mousecaptureposition.left>e.pageX){if(r<=T&&j<=r){x=C,b=!0;break}}else if(p<=T&&j<=p){x=C,b=!0;break}}}b||(l.mousecaptureposition.left>e.pageX?G.each(this.columns.records,function(e,t){return!!(l.groupable&&0<l.groups.length&&e<l.groups.length)||(this.pinned||this.hidden?void 0:(x=e,!1))}):(!l.groupable||l.groupable&&0<!l.groups.length)&&(x=w.cells.length-1));var S=I,I=Math.min(I,x),x=Math.max(S,x);h+=5,h+=s;l.table[0].rows.indexOf(l.mousecaptureposition.clickedrow);for(var A=0,P=-1,E=-1,z=0,C=0;C<l.table[0].rows.length;C++){var R=G(l.table[0].rows[C]);0==C&&(z=R.coord().top);var K=R.height(),M=z-a.top;if(-1==P&&h<=M+K){for(var B=!1,N=0;N<l.groups.length;N++){if(-1!=(X=R[0].cells[N].className).indexOf("jqx-grid-group-collapse")||-1!=X.indexOf("jqx-grid-group-expand")){B=!0;break}}if(B)continue;P=C}if(z+=K,l.groupable&&0<l.groups.length){for(var X,B=!1,N=0;N<l.groups.length;N++){if(-1!=(X=R[0].cells[N].className).indexOf("jqx-grid-group-collapse")||-1!=X.indexOf("jqx-grid-group-expand")){B=!0;break}}if(B)continue;for(var m=0,D=l.groups.length;D<R[0].cells.length;D++){var F=R[0].cells[D];""==G(F).html()&&m++}if(m==R[0].cells.length-l.groups.length)continue}if(-1!=P&&(A+=K),h+f<M+K){E=C;break}}if(-1!=P){h=G(l.table[0].rows[P]).coord().top-a.top-s-2;var Y=0;this.filterable&&this.showfilterrow&&(Y=this.filterrowheight),parseFloat(l.table[0].style.top)<0&&h<this.rowsheight+Y&&(h-=parseFloat(l.table[0].style.top),A+=parseFloat(l.table[0].style.top)),f=A;var L=G(this.columnsrow[0].cells[I]),$=G(this.columnsrow[0].cells[x]),c=parseFloat(L.css("left")),u=parseFloat($.css("left"))-parseFloat(c)+$.width()-2;if(c-=v,k&&(c+=v),l.editcell&&l.editable&&l.endcelledit&&(I!=x||P!=E)){if(0==l.editcell.validated)return;l.endcelledit(l.editcell.row,l.editcell.column,!0,!0)}}}this.selectionarea.width(u),this.selectionarea.css("left",c),null!==t&&(this.selectionarea.css("top",h),this.selectionarea.height(f))}}},_handlemouseupselection:function(t,l){if(this.selectionarea){if("visible"!=this.selectionarea[0].style.visibility)return l._handlemousemoveselection(t,l),l._handleAutofill(t,l),l.mousecaptured=!1,l.selectionarea[0].style.visibility="hidden",!0;if(l.mousecaptured&&("multiplerowsextended"==l.selectionmode||"multiplerowsadvanced"==l.selectionmode||"multiplecellsextended"==l.selectionmode||"multiplecellsadvanced"==l.selectionmode)){if(l.mousecaptured=!1,"visible"==this.selectionarea.css("visibility")){this.selectionarea.css("visibility","hidden");var e=this.showheader?this.columnsheader.height()+2:0,i=this._groupsheader()?this.groupsheader.height():0;"0px"===this.host.css("border-top-width")&&(i-=2),i+=this.showtoolbar?this.toolbar.height():0,i+=this.showfilterbar?this.toolbarheight:0;var s=this.selectionarea.coord(),o=this.host.coord();this.hasTransform&&(o=G.jqx.utilities.getOffset(this.host),s=G.jqx.utilities.getOffset(this.selectionarea)),"0px"===this.host.css("border-top-width")&&(i-=2);var a=s.left-o.left,r=s.top-e-o.top-i,n=r,d=a+this.selectionarea.width(),c=a,h=new Array,u=new Array;if("multiplerowsextended"==l.selectionmode){for(;r<n+this.selectionarea.height();){var f=(m=this._hittestrow(a,r)).row;-1!=(b=m.index)&&(u[b]||(u[b]=!0,h[h.length]=m)),r+=20}n=0;G.each(h,function(){var e=this.row;"none"!=l.selectionmode&&l._selectrowwithmouse&&(!t.ctrlKey&&!t.metaKey&&0==n?l._applyrowselection(l.getboundindex(e),!0,!1,!0):l._applyrowselection(l.getboundindex(e),!0,!1,!1),n++)})}else{"multiplecellsadvanced"==l.selectionmode&&(r+=2);var p=l.hScrollInstance,g=p.value;this.rtl&&("hidden"!=this.hScrollBar.css("visibility")&&(g=p.max-p.value),"hidden"!=this.vScrollBar[0].style.visibility&&(g-=this.scrollbarsize+4));var v=l.table[0].rows[0],w=l.selectionarea.height();!t.ctrlKey&&!t.metaKey&&0<w&&(l.selectedcells=new Array);for(var m,x=w;r<n+x;){if(m=l._hittestrow(a,r)){var b,f=m.row;if(-1!=(b=m.index)&&!u[b]){u[b]=!0;for(var _=0;_<v.cells.length;_++){var y=parseFloat(G(l.columnsrow[0].cells[_]).css("left"))-g,k=y+G(l.columnsrow[0].cells[_]).width();(y<=c&&c<=k||y<=d&&d<=k||c<=y&&y<=d)&&(l._applycellselection(l.getboundindex(f),l._getcolumnat(_).datafield,!0,!1),l.getboundindex(f),l._getcolumnat(_).datafield,0)}}r+=5}else r+=5}}l.autosavestate&&l.savestate&&l.savestate()}l._renderrows(l.virtualsizeinfo),l._handleAutofill(t,l)}}},_handleAutofill:function(e,c){var t=this.showheader?this.columnsheader.height()+2:0,l=this._groupsheader()?this.groupsheader.height():0;"0px"===this.host.css("border-top-width")&&(l-=2);new Array;var i=new Array;l+=this.showtoolbar?this.toolbar.height():0,l+=this.showfilterbar?this.toolbarheight:0;var s=this.selectionarea.coord(),o=this.host.coord();this.hasTransform&&(o=G.jqx.utilities.getOffset(this.host),s=G.jqx.utilities.getOffset(this.selectionarea)),"0px"===this.host.css("border-top-width")&&(l-=2);var a=s.left-o.left,r=s.top-t-o.top-l,n=r,d=a+this.selectionarea.width(),h=a,u=null,f=null;"multiplecellsadvanced"==c.selectionmode&&(r+=2);var p=c.hScrollInstance,g=p.value;this.rtl&&("hidden"!=this.hScrollBar.css("visibility")&&(g=p.max-p.value),"hidden"!=this.vScrollBar[0].style.visibility&&(g-=this.scrollbarsize+4));for(var v=c.table[0].rows[0],w=c.selectionarea.height();r<n+w;){var m=c._hittestrow(a,r);if(m){var x=m.row,b=m.index;if(-1!=b&&!i[b]){i[b]=!0;for(var _=0;_<v.cells.length;_++){var y=parseFloat(G(c.columnsrow[0].cells[_]).css("left"))-g,k=y+G(c.columnsrow[0].cells[_]).width();(y<=h&&h<=k||y<=d&&d<=k||h<=y&&y<=d)&&(u={x:a,y:r,rowindex:b,row:c.getboundindex(x),index:_,datafield:c._getcolumnat(_).datafield},f=f||u)}}r+=5}else r+=5}var C=c;C._autofill&&C._autofill.remove(),C.autofill&&(C._autofill=document.createElement("div"),C._autofill.style.width="6px",C._autofill.style.height="6px",C._autofill.style.position="absolute",C._autofill.style.top=s.top+w+1+"px",C._autofill.style.left=d+10+"px",C._autofill.style.cursor="crosshair",C._autofill.style.paddingLeft="0px",C._autofill.style.paddingTop="0px",C._autofill.style.paddingRight="0px",C._autofill.style.paddingBottom="0px",C._autofill.style.borderTopLeftRadius="0px",C._autofill.style.borderTopRightRadius="0px",C._autofill.style.borderBottomLeftRadius="0px",C._autofill.style.borderBottomRightRadius="0px",C._autofill.style.background="transparent",G(C._autofill).addClass(C.toThemeProperty("jqx-widget")),G(C._autofill).addClass(C.toThemeProperty("jqx-button")),G(C._autofill).addClass(C.toThemeProperty("primary")),G(C._autofill).addClass(C.toThemeProperty("jqx-fill-state-pressed")),C._lastClickedCell=u,C._autofill.onpointerdown=function(e){C._autofillDragStart=!0,C.mousecaptured=!0;var t=C.showheader?C.columnsheader.height()+2:0,l=C._groupsheader()?C.groupsheader.height():0;l+=C.showtoolbar?C.toolbarheight:0,l+=C.showfilterbar?C.toolbarheight:0;var i=C.host.coord(),s=y-i.left,o=top-t-i.top-l;if(C.pageable&&!C.autoheight&&C.gotopage&&C.pager.coord().top-i.top-l-t<o)return;var a,r,n,d=C._hittestrow(s,o);d&&(d.details||(d.row,d.index,e.target.className,a=C.table[0].rows[f.rowindex],r=G(c.columnsrow[0].cells[f.index]).coord().left,n=G(a).coord().top+1,C.mousecaptured=!0,C.mousecaptureposition={x:r,y:n,left:e.pageX,top:e.pageY,clickedrow:a},C.copyselection(),e.stopPropagation(),e.preventDefault()))},G(document).off("pointermove.autofill"),G(document).off("pointerup.autofill"),G(document).on("pointermove.autofill",function(e){C._autofillDragStart&&(C.mousecaptureposition.position?"y"===C.mousecaptureposition.position?(e._pageX=C.mousecaptureposition.x,e._pageY=e.pageY,C.mousecaptureposition.top=C.mousecaptureposition.y,C._handlemousemoveselection(e,C)):(e._pageX=e.pageX,e._pageY=C.mousecaptureposition.y,C.mousecaptureposition.clickedcell=f.index,C.mousecaptureposition.left=C.mousecaptureposition.x,C._handlemousemoveselection(e,C,null)):5<=Math.abs(C.mousecaptureposition.left-e.pageX)?C.mousecaptureposition.position="x":Math.abs(C.mousecaptureposition.top-e.pageY)&&(C.mousecaptureposition.position="y"))}),G(document).on("pointerup.autofill",function(e){C._handlemouseupselection(e,C),C._autofillDragStart=!1,C.mousecaptureposition=null,C.mousecaptured=!1,C.pasteselection(),C._handlemouseupselection(e,C)}),C.element.appendChild(C._autofill))},selectprevcell:function(e,t){var l=this._getcolumnindex(t),i=(this.columns.records.length,this._getprevvisiblecolumn(l));null!=i&&(this.clearselection(),this.selectcell(e,i.datafield))},selectnextcell:function(e,t){var l=this._getcolumnindex(t),i=(this.columns.records.length,this._getnextvisiblecolumn(l));null!=i&&(this.clearselection(),this.selectcell(e,i.datafield))},_getfirstvisiblecolumn:function(){for(var e=this.columns.records.length,t=0;t<e;t++){var l=this.columns.records[t];if(!l.hidden&&null!=l.datafield)return l}return null},_getlastvisiblecolumn:function(){for(var e=this.columns.records.length-1;0<=e;e--){var t=this.columns.records[e];if(!t.hidden&&null!=t.datafield)return t}return null},_handlekeydown:function(f,p){if(p.groupable&&p.groups.length,p.disabled)return!1;if(32===(y=f.charCode?f.charCode:f.keyCode?f.keyCode:0)&&(f.metaKey||f.ctrlKey)&&"multiplecellsadvanced"==p.selectionmode){var e=this.getselectedcell();if(f.shiftKey){this.clearselection();for(var t,l=0;l<this.columns.records.length;l++){(t=this.columns.records[l]).selectable&&t.toggleSelection(t,f,!0)}this._renderrows(this.virtualsizeinfo)}else{e&&(t=this.getcolumn(e.datafield)).selectable&&G(t.element).trigger("click")}}if(p.editcell&&"multiplecellsadvanced"!=p.selectionmode)return!0;if(p.editcell&&"multiplecellsadvanced"==p.selectionmode){if(!(33<=y&&y<=40))return!0;if(f.altKey)return!(p._cancelkeydown=!1);if(null!=p._cancelkeydown&&0!=p._cancelkeydown)return!(p._cancelkeydown=!1);if("selectedrow"===p.editmode)return!0;if(p.endcelledit(p.editcell.row,p.editcell.column,!1,!0),p._cancelkeydown=!1,p.editcell&&!p.editcell.validated)return p._rendervisualrows(),p.endcelledit(p.editcell.row,p.editcell.column,!1,!0),!1}if("none"==p.selectionmode)return!0;if(p.showfilterrow&&p.filterable&&this.filterrow&&G(f.target).ischildof(p.filterrow))return!0;if(p.showeverpresentrow){if(p.addnewrowtop&&G(f.target).ischildof(p.addnewrowtop))return!0;if(p.addnewrowbottom&&G(f.target).ischildof(p.addnewrowbottom))return!0}if(f.target.className&&0<=f.target.className.indexOf("jqx-grid-widget"))return!0;if(p.pageable&&G(f.target).ischildof(this.pager))return!0;if(this.showtoolbar&&G(f.target).ischildof(this.toolbar))return!0;if(this.showfilterbar&&G(f.target).ischildof(this.filterbar))return!0;if(this.showstatusbar&&G(f.target).ischildof(this.statusbar))return!0;var g=!1;if(f.altKey)return!0;if((f.ctrlKey||f.metaKey)&&this.clipboard){var i,s=String.fromCharCode(y).toLowerCase();if("z"===s&&this._undoRedo){if(-1===this._undoRedoIndex&&(this._undoRedoIndex=this._undoRedo.length-1),i=this._undoRedo[this._undoRedoIndex])if("setcellvalue"===i.action)this.setcellvalue(i.data.row,i.data.datafield,i.data.oldvalue),this.clearselection(),this.selectcell(i.data.row,i.data.datafield),this.ensurecellvisible(i.data.row,i.data.datafield);else if("paste"===i.action){this.clearselection();for(l=0;l<i.data.length;l++){var o=i.data[l];this.setcellvalue(o.row,o.datafield,o.oldvalue),this._applycellselection(o.row,o.datafield,!0,!1),0===l&&this.ensurecellvisible(o.row,o.datafield)}this._rendervisualrows()}0<this._undoRedoIndex&&this._undoRedoIndex--}if("y"===s&&this._undoRedo){if(-1===this._undoRedoIndex&&(this._undoRedoIndex=this._undoRedo.length-1),i=this._undoRedo[this._undoRedoIndex])if("setcellvalue"===i.action)this.setcellvalue(i.data.row,i.data.datafield,i.data.value),this.clearselection(),this.selectcell(i.data.row,i.data.datafield),this.ensurecellvisible(i.data.row,i.data.datafield);else if("paste"===i.action){this.clearselection();for(l=0;l<i.data.length;l++){o=i.data[l];this.setcellvalue(o.row,o.datafield,o.value),this._applycellselection(o.row,o.datafield,!0,!1),0===l&&this.ensurecellvisible(o.row,o.datafield)}this._rendervisualrows()}this._undoRedoIndex<this._undoRedo.length-1&&this._undoRedoIndex++}if("d"===s&&(this.copyselection(),this._clipboardselection[0],this._clipboardselection=[this._clipboardselection[0]],this.pasteselection()),this.clipboardbegin){var a=null;if("c"==s?a=this.clipboardbegin("copy",this.copyselection()):"x"==s?a=this.clipboardbegin("cut",this.copyselection()):"v"==s&&(a=this.clipboardbegin("paste")),!1===a)return!1}if("c"==s||"x"==s){var r,n=this.copyselection();if("c"==s&&this.clipboardend&&this.clipboardend("copy"),"x"==s&&this.clipboardend&&this.clipboardend("cut"),window.clipboardData?window.clipboardData.setData("Text",n):((r=G('<textarea style="position: absolute; left: -1000px; top: -1000px;"/>')).val(n),G("body").append(r),r.select(),setTimeout(function(){document.designMode="off",r.select(),r.remove(),p.focus()},100)),"c"==s&&G.jqx.browser.msie)return!1;if("c"==s)return!0}else if("v"==s){if(document.activeElement&&"INPUT"===document.activeElement.nodeName)return!0;var d=G('<textarea style="position: absolute; left: -1000px; top: -1000px;"/>');G("body").append(d),d.select();var c=this;return setTimeout(function(){c._clipboardselection=new Array;var e=d.val();0==e.length&&window.clipboardData&&(d.val(window.clipboardData.getData("Text")),e=d.val());for(var t=e.split("\n"),l=0;l<t.length;l++)if(0<t[l].split("\t").length){var i=t[l].split("\t");if(1==i.length&&l==t.length-1&&""==i[0])continue;0<i.length&&c._clipboardselection.push(i)}c.pasteselection(),d.remove(),c.focus()},100),!0}if("x"==s)return this.deleteselection(),this.host.focus(),!1}var h=Math.round(p._gettableheight()),u=Math.round(h/p.rowsheight),v=p.getdatainformation();switch(p.selectionmode){case"singlecell":case"multiplecells":case"multiplecellsextended":case"multiplecellsadvanced":if(null===(e=p.getselectedcell())&&p.selectcell(0,p.columns.records[0].displayfield),null!=e){function w(e,t,h,u){function l(e,t){var l,i=p.dataview.loadedrecords[e];if(p.groupable&&0<p.groups.length){var s=e;"up"==u&&s++,"down"==u&&s--;for(var i=p.getdisplayrows()[s],o=1,a=!0;a&&o<300&&(a=!1,"down"==u?i=p.getdisplayrows()[s+o]:"up"==u&&(i=p.getdisplayrows()[s-o]),i);){i&&i.group&&(a=!0),i&&i.totalsrow&&(a=!0);for(var r=i.parentItem;r;)!r||(l=r).group&&p.expandedgroups[l.uniqueid]&&p.expandedgroups[l.uniqueid].expanded||(a=!0),r=r.parentItem;if(!a)break;o++}if(300==o&&(i=null),p.pageable){var n=!1;if(i){for(var d=0;d<p.dataview.rows.length;d++)p.dataview.rows[d].boundindex==i.boundindex&&(n=!0);n||(i=null)}}}else if(p.pageable){n=!1;if(i){for(d=0;d<p.dataview.rows.length;d++)p.dataview.rows[d].boundindex==i.boundindex&&(n=!0);n||(p.pagerpageinput&&9===f.keyCode&&i.boundindex>p.dataview.rows[p.dataview.rows.length-1].boundindex&&(p.pagerpageinput.focus(),f.preventDefault()),p.ensurerowvisible(i))}}if(null!=i&&null!=t&&!i.totalsrow){!h&&null!=h||p.clearselection();var c=p.getboundindex(i);return p.selectcell(c,t),p._oldselectedcell=p.selectedcell,g=!0,p.groupable?p.ensurecellvisible(c,t):p.ensurecellvisible(e,t),1}}if(l(e,t)||p.groupable||(p.ensurecellvisible(e,t),l(e,t),p.virtualmode&&p.host.focus()),!(p.groupable&&0<p.groups.length))if(f.shiftKey&&9!=f.keyCode){if(("multiplecellsextended"==p.selectionmode||"multiplecellsadvanced"==p.selectionmode)&&p._lastClickedCell){p._selectpath(e,t);var i=p.dataview.loadedrecords[e],s=p.getboundindex(i);return void(p.selectedcell={rowindex:s,datafield:t})}}else f.shiftKey||(p._lastClickedCell={row:e,column:t})}var m,x,b,_,y,k,C,q=this.getrowvisibleindex(e.rowindex),j=e.datafield,O=p._getcolumnindex(j),T=(p.columns.records.length,f.shiftKey&&"singlecell"!=p.selectionmode&&"multiplecells"!=p.selectionmode),S=function(){var e;p.pageable?(e=p.dataview.pagenum*p.dataview.pagesize,w(e,j,!T)):w(0,j,!T)},I=function(){var e=v.rowscount-1;p.pageable&&(e=p.dataview.pagenum*p.dataview.pagesize+p.dataview.rows.length-1),w(e,j,!T)},A=9==y&&!f.shiftKey,P=9==y&&f.shiftKey;if(p.rtl&&(m=A,A=P,P=m),(A||P)&&(T=!1),(A||P)&&document.activeElement&&document.activeElement.className&&0<=document.activeElement.className.indexOf("jqx-grid-cell-add-new-row"))return!0;(R=f.ctrlKey||f.metaKey)&&37==y?null!=(k=p._getfirstvisiblecolumn(O))&&w(q,k.datafield):R&&39==y?null!=(x=p._getlastvisiblecolumn(O))&&w(q,x.datafield):39==y||A?null!=(b=p._getnextvisiblecolumn(O))?w(q,b.datafield,!T):A?(_=p._getfirstvisiblecolumn(),y=40,j=_.displayfield):g=!0:37==y||P?null!=(k=p._getprevvisiblecolumn(O))?w(q,k.datafield,!T):P?(C=p._getlastvisiblecolumn(),y=38,j=C.displayfield):g=!0:36==y?S():35==y?I():33==y?0<=q-u?(w(z=q-u,j,!T),p.pageable&&p.virtualmode&&(p.gotoprevpage(),setTimeout(function(){w(z,j,!T)},25))):S():34==y&&(v.rowscount>q+u?(w(z=q+u,j,!T),p.pageable&&p.virtualmode&&(p.gotonextpage(),setTimeout(function(){w(z,j,!T)},25))):I()),38==y&&(R?S():0<q?w(q-1,j,!T,"up"):g=!1),40==y&&(R?I():v.rowscount>q+1||p.groupable&&0<p.groups.length?w(q+1,j,!T,"down"):g=!0)}break;case"singlerow":case"multiplerows":case"multiplerowsextended":case"multiplerowsadvanced":if(null==(q=p.getselectedrowindex())||-1==q)return!0;q=this.getrowvisibleindex(q);function E(e,c,h){function t(e){var t,l=p.dataview.loadedrecords[e];if(p.groupable&&0<p.groups.length){"up"==h&&e++,"down"==h&&e--;for(var l=p.getdisplayrows()[e],i=1,s=!0;s&&i<300&&(s=!1,"down"==h?l=p.getdisplayrows()[e+i]:"up"==h&&(l=p.getdisplayrows()[e-i]),l);){l&&l.group&&(s=!0),l&&l.totalsrow&&(s=!0);for(var o=l.parentItem;o;)!o||(t=o).group&&p.expandedgroups[t.uniqueid]&&p.expandedgroups[t.uniqueid].expanded||(s=!0),o=o.parentItem;if(!s)break;i++}if(300==i&&(l=null),p.pageable){var a=!1;if(l){for(var r=0;r<p.dataview.rows.length;r++)p.dataview.rows[r].boundindex==l.boundindex&&(a=!0);a||(l=null)}}}if(null!=l){var n=p.getboundindex(l),d=p.selectedrowindex;return!c&&null!=c||p.clearselection(),p.selectedrowindex=d,p.selectrow(n,!1),(p.groupable?p.ensurerowvisible(n):p.ensurerowvisible(e))&&!p.autoheight&&!p.groupable||p._rendervisualrows(),g=!0}}if(t(e)||p.groupable||(p.ensurerowvisible(e),t(e),p.virtualmode&&setTimeout(function(){t(e)},25),p.virtualmode&&p.host.focus()),!(p.groupable&&0<p.groups.length))if(f.shiftKey&&9!=y){if("multiplerowsextended"==p.selectionmode&&p._lastClickedCell)return p._selectrowpath(e),void(p.selectedrowindex=p.getrowboundindex(e))}else f.shiftKey||(p._lastClickedCell={row:e},p.selectedrowindex=p.getrowboundindex(e))}var z,T=f.shiftKey&&"singlerow"!=p.selectionmode&&"multiplerows"!=p.selectionmode,S=function(){var e;p.pageable?(e=p.dataview.pagenum*p.dataview.pagesize,E(e,!T)):E(0,!T)},I=function(){var e=v.rowscount-1;p.pageable&&(e=p.dataview.pagenum*p.dataview.pagesize+p.dataview.rows.length-1),E(e,!T)},R=f.ctrlKey||f.metaKey;36==y||R&&38==y?S():35==y||R&&40==y?I():33==y?0<=q-u?(E(z=q-u,!T,"up"),p.pageable&&p.virtualmode&&(p.gotoprevpage(),setTimeout(function(){E(z,!T)},25))):S():34==y?v.rowscount>q+u?(E(z=q+u,!T,"down"),p.pageable&&p.virtualmode&&(p.gotonextpage(),setTimeout(function(){E(z,!T)},25))):I():38==y?0<q?E(q-1,!T,"up"):g=!0:40==y&&(v.rowscount>q+1||p.groupable&&0<p.groups.length?E(q+1,!T,"down"):g=!0)}return!g||(p.autosavestate&&p.savestate&&p.savestate(),!1)},_handlemousemove:function(e,t){var l,i,s,o,a,r;if(!t.vScrollInstance.isScrolling()&&(!t.hScrollInstance.isScrolling()&&(!t.enablehover&&"multiplerows"!=t.selectionmode||(a=this.showheader?this.columnsheader.height()+2:0,r=this._groupsheader()?this.groupsheader.height():0,r+=this.showtoolbar?this.toolbarheight:0,r+=this.showfilterbar?this.toolbarheight:0,l=this.host.coord(),this.hasTransform&&(l=G.jqx.utilities.getOffset(this.host),o=this._getBodyOffset(),l.left-=o.left,l.top-=o.top),i=e.pageX-l.left,s=e.pageY-a-l.top-r),"multiplerowsextended"!=t.selectionmode&&"multiplecellsextended"!=t.selectionmode&&"multiplecellsadvanced"!=t.selectionmode||1!=t.mousecaptured))){if(!t.enablehover)return!0;if(!t.disabled&&!this.vScrollInstance.isScrolling()&&!this.hScrollInstance.isScrolling()){var n=this._hittestrow(i,s);if(n){var d=n.row,c=n.index;if((-1==this.hoveredrow||-1==c||this.hoveredrow!=c||-1!=this.selectionmode.indexOf("cell")||"checkbox"==this.selectionmode)&&(this._clearhoverstyle(),-1!=c&&null!=d)){var h=this.hittestinfo[c].visualrow;if(null!=h&&!(this.hittestinfo[c].details||e.clientX>G(h).width()+G(h).coord().left)){var u=0,f=h.cells.length;if(t.rowdetails&&t.showrowdetailscolumn?this.rtl?(--f,f-=this.groups.length):u=1+this.groups.length:this.groupable&&(this.rtl?f-=this.groups.length:u=this.groups.length),0!=h.cells.length){var p=h.cells[u].className;if(!(d.group||0<=this.selectionmode.indexOf("row")&&-1!=p.indexOf("jqx-grid-cell-selected")))if(this.hoveredrow=c,-1==this.selectionmode.indexOf("cell")&&"checkbox"!=this.selectionmode)for(m=u;m<f;m++){_=h.cells[m];G(_).addClass(this.toTP("jqx-grid-cell-hover")),G(_).addClass(this.toTP("jqx-fill-state-hover")),this.cellhover&&this.cellhover(_,e.pageX,e.pageY),(b=this._getcolumnat(m))._applyCellStyle(_)}else{var g=-1,v=this.hScrollInstance,w=v.value;this.rtl&&"hidden"!=this.hScrollBar.css("visibility")&&(w=v.max-v.value);for(var m=u;m<f;m++){var x=parseInt(G(this.columnsrow[0].cells[m]).css("left"))-w;if(this.columns.records[m].pinned&&!this.rtl&&(x=parseInt(G(this.columnsrow[0].cells[m]).css("left"))),i<=x+G(this.columnsrow[0].cells[m]).width()&&x<=i){g=m;break}}if(-1!=g){var b,_=h.cells[g];if(this.cellhover&&this.cellhover(_,e.pageX,e.pageY),-1==_.className.indexOf("jqx-grid-cell-selected"))if(this.editcell)if((b=this._getcolumnat(g))&&this.editcell.row==c&&this.editcell.column==b.datafield)return;G(_).addClass(this.toTP("jqx-grid-cell-hover")),G(_).addClass(this.toTP("jqx-fill-state-hover")),(b=this._getcolumnat(g))._applyCellStyle(_)}}}}}}}}}})}(jqxBaseFramework);
!function(e){e.extend(e.jqx._jqxGrid.prototype,{selectallrows:function(){this._trigger=!1;var e=this.virtualmode?this.dataview.totalrecords:this.dataview.loadedrecords.length;this.selectedrowindexes=new Array,this.selectedcells=new Array;for(var t=this.dataview.loadedrecords,l=0;l<e;l++){var i=t[l];if(i){var s=this.getboundindex(i);null!=s&&(this.selectedrowindexes[l]=s);for(let e=0;e<this.columns.records.length;e++)this.selectedcells[s+"_"+this.columns.records[e].datafield]=!0}else this.selectedrowindexes[l]=l}"checkbox"!=this.selectionmode||this._checkboxcolumnupdating||this._checkboxcolumn&&this._checkboxcolumn.checkboxelement.jqxCheckBox({checked:!0}),this._renderrows(this.virtualsizeinfo),this._trigger=!0,"checkbox"==this.selectionmode&&this._raiseEvent(2,{rowindex:this.selectedrowindexes})},unselectallrows:function(){this._trigger=!1;this.virtualmode?this.dataview.totalrecords:this.dataview.loadedrecords.length;this.selectedrowindexes=new Array,this.selectedcells=new Array,"checkbox"!=this.selectionmode||this._checkboxcolumnupdating||this._checkboxcolumn&&this._checkboxcolumn.checkboxelement.jqxCheckBox({checked:!1}),this._renderrows(this.virtualsizeinfo),this._trigger=!0,"checkbox"==this.selectionmode&&this._raiseEvent(2,{rowindex:this.selectedrowindexes})},selectrow:function(e,t){"none"!==this.selectionmode&&(this._applyrowselection(e,!0,t),!1!==t&&this._updatecheckboxselection())},_updatecheckboxselection:function(){if("checkbox"==this.selectionmode){var e=this.getrows();if(e&&this._checkboxcolumn){if(0===e.length)return void this._checkboxcolumn.checkboxelement.jqxCheckBox({checked:!1});var t=e.length;this.groupable&&(t=this.dataview.loadedrecords.length),this.virtualmode&&(t=this.source._source.totalrecords);var l=this.selectedrowindexes.length;l===t?this._checkboxcolumn.checkboxelement.jqxCheckBox({checked:!0}):0===l?this._checkboxcolumn.checkboxelement.jqxCheckBox({checked:!1}):this._checkboxcolumn.checkboxelement.jqxCheckBox({checked:null})}}},unselectrow:function(e,t){this._applyrowselection(e,!1,t),!1!==t&&this._updatecheckboxselection()},selectcell:function(e,t){this._applycellselection(e,t,!0)},unselectcell:function(e,t){this._applycellselection(e,t,!1)},clearselection:function(e,t){if(this._trigger=!1,this.selectedrowindex=-1,this._oldselectedcell=null,!1!==t)for(var l=0;l<this.selectedrowindexes.length;l++)this._raiseEvent(3,{rowindex:this.selectedrowindexes[l]});this.selectedrowindexes=new Array,this.selectedcells=new Array,this.selectedcell=null,"checkbox"!=this.selectionmode||this._checkboxcolumnupdating||this._checkboxcolumn.checkboxelement.jqxCheckBox({checked:!1});for(l=0;l<this.columns.records.length;l++)this.columns.records[l].selected=!1,this.columns.records[l]._applyStyle();!1!==e?(this._renderrows(this.virtualsizeinfo),this._trigger=!0,"checkbox"==this.selectionmode&&this._raiseEvent(3,{rowindex:this.selectedrowindexes})):this._trigger=!0},getselectedrowindex:function(){if(-1==this.selectedrowindex||null==this.selectedrowindex)for(var e=0;e<this.selectedrowindexes.length;e++)return this.selectedrowindexes[e];return this.selectedrowindex},getselectedrowindexes:function(){return this.selectedrowindexes},getselectedcell:function(){if(!this.selectedcell)return null;var e=this.selectedcell;return e.row=this.selectedcell.rowindex,e.column=this.selectedcell.datafield,e.value=this.getcellvalue(e.row,e.column),e},getselectedcells:function(){var e=new Array;for(var t in this.selectedcells)e[e.length]=this.selectedcells[t];return e},getselection:function(){return{cells:this.getselectedcells(),rows:this.getselectedrowindexes()}},_getcellsforcopypaste:function(){var e=new Array;if(-1==this.selectionmode.indexOf("cell"))for(var t=this.selectedrowindexes,l=0;l<t.length;l++)for(var i=t[l],s=0;s<this.columns.records.length;s++)if("_checkboxcolumn"!==this.columns.records[s].datafield){this.columns.records[s].datafield;var o={rowindex:i,datafield:this.columns.records[s].datafield};e.push(o)}return e},deleteselection:function(){var e=this.getselectedcells();if(-1==this.selectionmode.indexOf("cell")&&(e=this._getcellsforcopypaste()),null!=e&&e.length>0){for(var t=0;t<e.length;t++){var l=e[t],i=this.getcolumn(l.datafield),s=this.getcellvalue(l.rowindex,l.datafield);if(i&&""!==s){var o=null;"checkbox"==i.columntype&&(i.threestatecheckbox||(o=!1)),this._raiseEvent(17,{rowindex:l.rowindex,datafield:l.datafield,value:s}),t==e.length-1?(this.setcellvalue(l.rowindex,l.datafield,o,!0),i.displayfield!=i.datafield&&this.setcellvalue(l.rowindex,i.displayfield,o,!0)):(this.setcellvalue(l.rowindex,l.datafield,o,!1),i.displayfield!=i.datafield&&this.setcellvalue(l.rowindex,i.displayfield,o,!0)),this._raiseEvent(18,{rowindex:l.rowindex,datafield:l.datafield,oldvalue:s,value:o})}}this.dataview.updateview(),this._renderrows(this.virtualsizeinfo)}},copyselection:function(){var t="",l=this;this.clipboardselection={},this.logicalclipboardselection={},this._clipboardselection=[];var i=l.getselectedcells();-1==this.selectionmode.indexOf("cell")&&(i=this._getcellsforcopypaste());var s=new Array;if(null!=i&&i.length>0){for(var o=999999999999999,a=-1,r=0;r<i.length;r++){var n=i[r],d=l.getcolumn(n.datafield);if(null!=d&&d.clipboard&&(!d.hidden||this.copytoclipboardhiddencolumns)){-1==s.indexOf(d.text)&&s.push(d.text);var c=l.getcelltext(n.rowindex,d.displayfield),h=this.getrowdisplayindex(n.rowindex);this.clipboardselection[h]||(this.clipboardselection[h]={}),this.clipboardselection[h][d.displayfield]=c,this.logicalclipboardselection[h]||(this.logicalclipboardselection[h]={}),this.logicalclipboardselection[h][d.displayfield]=c,d.displayfield!=d.datafield&&(this.logicalclipboardselection[h][d.datafield]=l.getcellvalue(n.rowindex,d.datafield)),o=Math.min(o,h),a=Math.max(a,h)}}for(var u=new Array,f=o;f<=a;f++)if(this.logicalclipboardselection[f]){var p=e.extend({},this.logicalclipboardselection[f]);u.push(p)}if(this.logicalclipboardselection=u,this.copytoclipboardwithheaders){for(var g=0;g<s.length;g++)g>0&&(t+="\t"),t+=s[g];t+="\r\n"}for(f=o;f<=a;f++){var v=0;this._clipboardselection[this._clipboardselection.length]=new Array,null!=this.clipboardselection[f]&&(e.each(this.clipboardselection[f],function(e,i){v>0&&(t+="\t");var s=i;null==i&&(s=""),l._clipboardselection[l._clipboardselection.length-1][v]=s,v++,t+=s}),f<a&&(t+="\r\n"))}}return this.clipboardselectedtext=t,t},pasteselection:function(){var e=this.getselectedcells();if(this._oldselectedcell=null,-1==this.selectionmode.indexOf("cell")&&(e=this._getcellsforcopypaste()),null!=e&&e.length>0){var t=e[0].rowindex,l=this.getrowdisplayindex(t),i=e[0].datafield,s=this._getcolumnindex(i);this.selectedrowindexes=new Array,this.selectedcells=new Array;e.length;var o=0,a=new Array,r=[];this.copytoclipboardwithheaders&&this._clipboardselection.splice(0,1),this._clipboardselection||(this._clipboardselection=[]);for(var n=0;n<this._clipboardselection.length;n++){o+=this._clipboardselection[n].length,a[n]=new Array;for(var d=0;d<this._clipboardselection[n].length;d++){var c=this._clipboardselection[n][d];a[n].push(c)}}if(o<e.length){var h=new Array;for(n=0;n<e.length;n++){h[(b=e[n]).rowindex]||(h[b.rowindex]=new Array),h[b.rowindex].push(b)}var u=0,f=0;for(n=0;n<h.length;n++)if(h[n]){for(d=0;d<h[n].length;d++){var p=(b=h[n][d]).rowindex;if("_checkboxcolumn"!==(x=this.getcolumn(b.datafield)).datafield&&!x.hidden){c="";if(null==a[u][f]&&(f=0),c=""+a[u][f],f++,x.cellsformat&&(-1!=x.cellsformat.indexOf("p")||-1!=x.cellsformat.indexOf("c")||-1!=x.cellsformat.indexOf("n")||-1!=x.cellsformat.indexOf("f"))){c.indexOf&&c.indexOf(this.gridlocalization.currencysymbol)>-1&&(c=c.replace(this.gridlocalization.currencysymbol,"")),(c=(c=function(e,t,l){var i=e;if(t==l)return e;for(var s=i.indexOf(t);-1!=s;)s=(i=i.replace(t,l)).indexOf(t);return i}(c,this.gridlocalization.thousandsseparator,"")).replace(this.gridlocalization.decimalseparator,".")).indexOf(this.gridlocalization.percentsymbol)>-1&&(c=c.replace(this.gridlocalization.percentsymbol,""));for(var g="",v=0;v<c.length;v++){"-"===(_=c.substring(v,v+1))&&(g+="-"),"."===_&&(g+="."),null!=_.match(/^[0-9]+$/)&&(g+=_)}c=(c=g).replace(/ /g,""),c=new Number(c),isNaN(c)&&(c="")}this._raiseEvent(17,{rowindex:p,datafield:b.datafield,value:c});var w=this.getrowdata(p);if(r.push({oldvalue:w[b.datafield],value:c,datafield:b.datafield,row:p}),this.pushToHistory=!0,this.setcellvalue(p,x.displayfield,c,!1),this.pushToHistory=!1,x.displayfield!=x.datafield&&this.logicalclipboardselection)if(this.logicalclipboardselection[p])null!=(y=this.logicalclipboardselection[p][x.datafield])&&this.setcellvalue(p,x.datafield,y,!1);this._raiseEvent(18,{rowindex:p,datafield:b.datafield,oldvalue:this.getcellvalue(b.rowindex,b.datafield),value:c}),this._applycellselection(p,b.datafield,!0,!1)}}f=0,a[++u]||(u=0)}}else{if(!this._clipboardselection)return;for(w=0;w<this._clipboardselection.length;w++)for(var m=0;m<this._clipboardselection[w].length;m++){var x;if((x=this.getcolumnat(s+m))&&("_checkboxcolumn"!==x.datafield&&!x.hidden)){p=this.getrowboundindex(l+w);var b=this.getcell(p,x.datafield);c=null;if(null!=(c=this._clipboardselection[w][m])){if(x.cellsformat&&(-1!=x.cellsformat.indexOf("p")||-1!=x.cellsformat.indexOf("c")||-1!=x.cellsformat.indexOf("n")||-1!=x.cellsformat.indexOf("f"))){c.indexOf(this.gridlocalization.currencysymbol)>-1&&(c=c.replace(this.gridlocalization.currencysymbol,"")),(c=(c=function(e,t,l){var i=e;if(t==l)return e;for(var s=i.indexOf(t);-1!=s;)s=(i=i.replace(t,l)).indexOf(t);return i}(c,this.gridlocalization.thousandsseparator,"")).replace(this.gridlocalization.decimalseparator,".")).indexOf(this.gridlocalization.percentsymbol)>-1&&(c=c.replace(this.gridlocalization.percentsymbol,""));for(g="",v=0;v<c.length;v++){var _;"-"===(_=c.substring(v,v+1))&&(g+="-"),"."===_&&(g+="."),null!=_.match(/^[0-9]+$/)&&(g+=_)}c=(c=g).replace(/ /g,""),c=new Number(c),isNaN(c)&&(c="")}this._raiseEvent(17,{rowindex:p,datafield:b.datafield,value:c});var y,k=this.getrowdata(p);if(r.push({oldvalue:k[b.datafield],value:c,datafield:b.datafield,row:p}),this.pushToHistory=!0,this.setcellvalue(p,x.displayfield,c,!1),this.pushToHistory=!1,x.displayfield!=x.datafield&&this.logicalclipboardselection)null!=(y=this.logicalclipboardselection[w][x.datafield])&&this.setcellvalue(p,x.datafield,y,!1);this._raiseEvent(18,{rowindex:p,datafield:b.datafield,oldvalue:this.getcellvalue(b.rowindex,b.datafield),value:c}),this._applycellselection(p,b.datafield,!0,!1)}}}}"checkbox"==this.selectionmode&&this._updatecheckboxselection(),this.dataview.updateview(),this._renderrows(this.virtualsizeinfo)}this._undoRedo.push({action:"paste",data:r}),this._undoRedoIndex=-1,this.clipboardend&&this.clipboardend("paste")},_applyrowselection:function(e,t,l,i,s){if(null==e)return!1;var o=this.selectedrowindex;if("singlerow"==this.selectionmode&&(t?this._raiseEvent(2,{rowindex:e,row:this.getrowdata(e)}):this._raiseEvent(3,{rowindex:e,row:this.getrowdata(e)}),this._raiseEvent(3,{rowindex:o}),this.selectedrowindexes=new Array,this.selectedcells=new Array),1==i&&(this.selectedrowindexes=new Array),this.dataview.filters.length>0){var a=this.getrowdata(e);a&&void 0!==a.dataindex?e=a.dataindex:a&&void 0===a.dataindex&&null!=a.uid&&(e=this.getrowboundindexbyid(a.uid))}var r=this.selectedrowindexes.indexOf(e);if(t)this.selectedrowindex=e,-1==r?(this.selectedrowindexes.push(e),"singlerow"!=this.selectionmode&&this._raiseEvent(2,{rowindex:e,row:this.getrowdata(e)})):"multiplerows"==this.selectionmode&&(this.selectedrowindexes.splice(r,1),this._raiseEvent(3,{rowindex:this.selectedrowindex,row:this.getrowdata(e)}),this.selectedrowindex=this.selectedrowindexes.length>0?this.selectedrowindexes[this.selectedrowindexes.length-1]:-1);else if(r>=0||"singlerow"==this.selectionmode||"multiplerowsextended"==this.selectionmode||"multiplerowsadvanced"==this.selectionmode){var n=this.selectedrowindexes[r];this.selectedrowindexes.splice(r,1),this._raiseEvent(3,{rowindex:n,row:this.getrowdata(e)}),this.selectedrowindex=-1}return(null==l||l)&&this._rendervisualrows(),!0},_applycellselection:function(t,l,i,s,o){if(null==t)return!1;if(null==l)return!1;this._autofill&&(this._autofill.remove(),e(document).off("pointermove.autofill"),e(document).off("pointerup.autofill"),this._autofill=null);var a;this.selectedrowindex;"singlecell"==this.selectionmode&&(null!=(a=this.selectedcell)&&this._raiseEvent(16,{rowindex:a.rowindex,datafield:a.datafield}),this.selectedcells=new Array);"multiplecellsextended"!=this.selectionmode&&"multiplecellsadvanced"!=this.selectionmode||null!=(a=this.selectedcell)&&this._raiseEvent(16,{rowindex:a.rowindex,datafield:a.datafield});var r=t+"_"+l;if(this.dataview.filters.length>0){var n=this.getrowdata(t);if(n&&void 0!==n.dataindex)r=(t=n.dataindex)+"_"+l;else if(n&&void 0===n.dataindex&&n.uid)r=(t=this.getrowboundindexbyid(n.uid))+"_"+l}var d={rowindex:t,datafield:l};if(i){var c=this.selectedcell;if(this.selectedcell=d,this.selectedcells[r])"multiplecells"!=this.selectionmode&&"multiplecellsextended"!=this.selectionmode&&"multiplecellsadvanced"!=this.selectionmode||(delete this.selectedcells[r],this.selectedcells.length>0&&this.selectedcells.length--,!1!==o&&this._raiseEvent(16,d));else{this.selectedcells[r]=d,this.selectedcells.length++;var h=!0;c&&c.datafield===d.datafield&&d.rowindex===c.rowindex&&(h=!1),h&&!1!==o&&this._raiseEvent(15,d)}}else delete this.selectedcells[r],this.selectedcells.length>0&&this.selectedcells.length--,!1!==o&&this._raiseEvent(16,d);return(null==s||s)&&this._rendervisualrows(),!0},_getcellindex:function(t){var l=-1;return e.each(this.selectedcells,function(){if(l++,this[t])return!1}),l},_clearhoverstyle:function(){if(null!=this.hoveredrow&&-1!=this.hoveredrow&&!this.vScrollInstance.isScrolling()&&!this.hScrollInstance.isScrolling()){var e=this.table.find(".jqx-grid-cell-hover");e.length>0&&(e.removeClass(this.toTP("jqx-grid-cell-hover")),e.removeClass(this.toTP("jqx-fill-state-hover")));for(var t=0;t<e.length;t++){var l=e[t].getAttribute("columnindex");if(l){var i=this.columns.records[parseInt(l)];i&&i._applyCellStyle(e[t])}}this.hoveredrow=-1}},_clearselectstyle:function(){for(var t=this.table[0].rows.length,l=this.table[0].rows,i=this.toTP("jqx-grid-cell-selected"),s=this.toTP("jqx-fill-state-pressed"),o=this.toTP("jqx-grid-cell-hover"),a=this.toTP("jqx-fill-state-hover"),r=0;r<t;r++)for(var n=l[r],d=n.cells.length,c=n.cells,h=0;h<d;h++){var u=c[h],f=e(u);-1!=u.className.indexOf("jqx-grid-cell-selected")&&(f.removeClass(i),f.removeClass(s)),-1!=u.className.indexOf("jqx-grid-cell-hover")&&(f.removeClass(o),f.removeClass(a));var p=u.getAttribute("columnindex");if(p){var g=this.columns.records[parseInt(p)];g&&g._applyCellStyle(u)}}},_selectpath:function(e,t){var l=this._lastClickedCell?Math.min(this._lastClickedCell.row,e):0,i=this._lastClickedCell?Math.max(this._lastClickedCell.row,e):0;if(l<=i){var s=this._getcolumnindex(this._lastClickedCell.column||this._lastClickedCell.datafield),o=this._getcolumnindex(t),a=Math.min(s,o),r=Math.max(s,o);this.selectedcells=new Array;for(var n=this.dataview.loadedrecords,d=l;d<=i;d++)for(var c=a;c<=r;c++){e=n[d];this._applycellselection(this.getboundindex(e),this._getcolumnat(c).datafield,!0,!1),{row:this.getboundindex(e),datafield:this._getcolumnat(c).datafield}}this._rendervisualrows()}},_selectrowpath:function(e){if("multiplerowsextended"==this.selectionmode){var t=this._lastClickedCell?Math.min(this._lastClickedCell.row,e):0,l=this._lastClickedCell?Math.max(this._lastClickedCell.row,e):0,i=this.dataview.loadedrecords;if(t<=l){this.selectedrowindexes=new Array;for(var s=t;s<=l;s++){e=i[s];var o=this.getrowboundindex(s);this._applyrowselection(o,!0,!1)}this._rendervisualrows()}}},_selectrowwithmouse:function(e,t,l,i,s,o){if(null!=(_=t.row)){var a=t.index;if(null!=this.hittestinfo[a]){for(var r=0;r<this.columns.records.length;r++){var n=this.columns.records[r];n.selected=!1,n.element&&n.element.removeAttribute("selected"),n._applyStyle()}var d=this.hittestinfo[a].visualrow;if(!this.hittestinfo[a].details){d.cells[0].className;if(!_.group){if("multiplerows"==this.selectionmode||"multiplecells"==this.selectionmode||"checkbox"==this.selectionmode||-1!=this.selectionmode.indexOf("multiple")&&(1==o||1==s)){var c=this.getboundindex(_);if(this.dataview.filters.length>0){var h=this.getrowdata(c);if(h&&null==(c=h.dataindex))c=this.getboundindex(_)}var u=-1!=l.indexOf(c),f=this.getboundindex(_)+"_"+i;if(-1!=this.selectionmode.indexOf("cell")){var p=null!=this.selectedcells[f];if(null!=this.selectedcells[f]&&p?this._selectcellwithstyle(e,!1,a,i,d):this._selectcellwithstyle(e,!0,a,i,d),o&&null==this._lastClickedCell){var g=this.getselectedcells();g&&g.length>0&&(this._lastClickedCell={row:g[0].rowindex,column:g[0].datafield})}o&&this._lastClickedCell&&(this._selectpath(_.visibleindex,i),this.mousecaptured=!1,"visible"==this.selectionarea.css("visibility")&&this.selectionarea.css("visibility","hidden"))}else{if(u?s?this._applyrowselection(this.getboundindex(_),!1):this._selectrowwithstyle(e,d,!1,i):this._selectrowwithstyle(e,d,!0,i),o&&null==this._lastClickedCell){var v=this.getselectedrowindexes();v&&v.length>0&&(this._lastClickedCell={row:v[0],column:i})}if(o&&this._lastClickedCell){this.selectedrowindexes=new Array;for(var w=this._lastClickedCell?Math.min(this._lastClickedCell.row,_.visibleindex):0,m=this._lastClickedCell?Math.max(this._lastClickedCell.row,_.visibleindex):0,x=this.dataview.loadedrecords,b=w;b<=m;b++){var _;(_=x[b])&&this._applyrowselection(this.getboundindex(_),!0,!1,!1)}this._rendervisualrows()}}}else this._clearselectstyle(),this._selectrowwithstyle(e,d,!0,i),-1!=this.selectionmode.indexOf("cell")&&this._selectcellwithstyle(e,!0,a,i,d);o||(this._lastClickedCell={row:_.visibleindex,column:i})}}}}},_selectcellwithstyle:function(t,l,i,s,o){var a=e(o.cells[t._getcolumnindex(s)]);a.removeClass(this.toTP("jqx-grid-cell-hover")),a.removeClass(this.toTP("jqx-fill-state-hover")),l?(a.addClass(this.toTP("jqx-grid-cell-selected")),a.addClass(this.toTP("jqx-fill-state-pressed"))):(a.removeClass(this.toTP("jqx-grid-cell-selected")),a.removeClass(this.toTP("jqx-fill-state-pressed"))),this.getcolumn(s)._applyCellStyle(a)},_selectrowwithstyle:function(t,l,i,s){var o=l.cells.length,a=0;t.rowdetails&&t.showrowdetailscolumn?this.rtl?(o-=1,o-=this.groups.length):a=1+this.groups.length:this.groupable&&(this.rtl?o-=this.groups.length:a=this.groups.length);for(var r=a;r<o;r++){var n=l.cells[r];if(i?(e(n).removeClass(this.toTP("jqx-grid-cell-hover")),e(n).removeClass(this.toTP("jqx-fill-state-hover")),-1==t.selectionmode.indexOf("cell")&&(e(n).addClass(this.toTP("jqx-grid-cell-selected")),e(n).addClass(this.toTP("jqx-fill-state-pressed")))):(e(n).removeClass(this.toTP("jqx-grid-cell-hover")),e(n).removeClass(this.toTP("jqx-grid-cell-selected")),e(n).removeClass(this.toTP("jqx-fill-state-hover")),e(n).removeClass(this.toTP("jqx-fill-state-pressed"))),s=n.getAttribute("columnindex")){var d=this.columns.records[parseInt(s)];d&&d._applyCellStyle(n)}}},_handlemousemoveselection:function(t,l,i){if(l.hScrollInstance.isScrolling()||l.vScrollInstance.isScrolling())return!1;if(("multiplerowsextended"==l.selectionmode||"multiplecellsextended"==l.selectionmode||"multiplecellsadvanced"==l.selectionmode)&&l.mousecaptured){if(l.multipleselectionbegins)if(!1===l.multipleselectionbegins(t))return!0;var s=this.showheader?this.columnsheader.height()+2:0,o=this._groupsheader()?this.groupsheader.height():0;o+=this.showtoolbar?this.toolbar.height():0,o+=this.showfilterbar?this.toolbarheight:0;var a=this.host.coord();if(this.hasTransform){a=e.jqx.utilities.getOffset(this.host);var r=this._getBodyOffset();a.left-=r.left,a.top-=r.top}"0px"===this.host.css("border-top-width")&&(o-=2);var n=t.pageX,d=t.pageY-o;if(t._pageX&&(n=t._pageX,d=t._pageY-o),Math.abs(this.mousecaptureposition.left-n)>3||Math.abs(this.mousecaptureposition.top-d)>3||l.autofill){parseInt(this.columnsheader.coord().top);this.hasTransform&&e.jqx.utilities.getOffset(this.columnsheader).top,n<a.left&&(n=a.left),n>a.left+this.host.width()&&(n=a.left+this.host.width());var c=a.top+s;d<c&&(d=c+5);var h=parseInt(Math.min(l.mousecaptureposition.left,n)),u=-5+parseInt(Math.min(l.mousecaptureposition.top,d)),f=parseFloat(Math.abs(l.mousecaptureposition.left-n)),p=parseInt(Math.abs(l.mousecaptureposition.top-d));if(h-=a.left,u-=a.top,this.selectionarea.css("visibility","visible"),"multiplecellsadvanced"==l.selectionmode){var g=(n=h)+f,v=l.hScrollInstance,w=v.value;this.rtl&&("hidden"!=this.hScrollBar.css("visibility")&&(w=v.max-v.value),this.vScrollBar[0].style.visibility);var m=l.table[0].rows[0],x=0,b=l.mousecaptureposition.clickedcell,_=b,y=!1,k=0,C=m.cells.length;l.mousecaptureposition.left<=t.pageX&&(k=b);for(var q=!1,j=k;j<C;j++){var O=parseFloat(e(this.columnsrow[0].cells[j]).css("left")),T=O-w;if(!l.columns.records[j].pinned||l.columns.records[j].hidden){if(q){y=!0,_--;break}var I=this._getcolumnat(j);if(!(null!=I&&I.hidden||l.groupable&&l.groups.length>0&&j<l.groups.length)){S=T+e(this.columnsrow[0].cells[j]).width();if(l.mousecaptureposition.left>t.pageX){if(S>=n&&n>=T){_=j,y=!0;break}}else if(S>=g&&g>=T){_=j,y=!0;break}}}else{j==b&&(q=!0);var S=O+e(this.columnsrow[0].cells[j]).width();if(l.mousecaptureposition.left>t.pageX){if(S>=n&&n>=T){_=j,y=!0;break}}else if(S>=g&&g>=T){_=j,y=!0;break}}}y||(l.mousecaptureposition.left>t.pageX?e.each(this.columns.records,function(e,t){return!!(l.groupable&&l.groups.length>0&&e<l.groups.length)||(this.pinned||this.hidden?void 0:(_=e,!1))}):(!l.groupable||l.groupable&&!l.groups.length>0)&&(_=m.cells.length-1));var A=b;b=Math.min(b,_),_=Math.max(A,_),u+=5,u+=o;l.table[0].rows.indexOf(l.mousecaptureposition.clickedrow);var E=0,P=-1,z=-1,R=0;for(j=0;j<l.table[0].rows.length;j++){var K=e(l.table[0].rows[j]);0==j&&(R=K.coord().top);var M=K.height(),B=R-a.top;if(-1==P&&B+M>=u){for(var N=!1,X=0;X<l.groups.length;X++){if(-1!=(D=K[0].cells[X].className).indexOf("jqx-grid-group-collapse")||-1!=D.indexOf("jqx-grid-group-expand")){N=!0;break}}if(N)continue;P=j}if(R+=M,l.groupable&&l.groups.length>0){for(N=!1,X=0;X<l.groups.length;X++){var D;if(-1!=(D=K[0].cells[X].className).indexOf("jqx-grid-group-collapse")||-1!=D.indexOf("jqx-grid-group-expand")){N=!0;break}}if(N)continue;x=0;for(var F=l.groups.length;F<K[0].cells.length;F++){var Y=K[0].cells[F];""==e(Y).html()&&x++}if(x==K[0].cells.length-l.groups.length)continue}if(-1!=P&&(E+=M),B+M>u+p){z=j;break}}if(-1!=P){u=e(l.table[0].rows[P]).coord().top-a.top-o-2;var H=0;this.filterable&&this.showfilterrow&&(H=this.filterrowheight),parseFloat(l.table[0].style.top)<0&&u<this.rowsheight+H&&(u-=parseFloat(l.table[0].style.top),E+=parseFloat(l.table[0].style.top)),p=E;var L=e(this.columnsrow[0].cells[b]),$=e(this.columnsrow[0].cells[_]);if(h=parseFloat(L.css("left")),f=parseFloat($.css("left"))-parseFloat(h)+$.width()-2,h-=w,q&&(h+=w),l.editcell&&l.editable&&l.endcelledit&&(b!=_||P!=z)){if(0==l.editcell.validated)return;l.endcelledit(l.editcell.row,l.editcell.column,!0,!0)}}}this.selectionarea.width(f),this.selectionarea.css("left",h),null!==i&&(this.selectionarea.css("top",u),this.selectionarea.height(p))}}},_handlemouseupselection:function(t,l,i){if(this.selectionarea){if("visible"!=this.selectionarea[0].style.visibility)return l._handlemousemoveselection(t,l),!1!==i&&(l.__firstcell?l._handleAutofill(t,l):(l.__firstcell=l.getselectedcell(),l.__firstcell.index=l.columns.records.indexOf(l.getcolumn(l.__firstcell.datafield)),l._handleAutofill(t,l))),l.mousecaptured=!1,l.selectionarea[0].style.visibility="hidden",!0;if(l.mousecaptured&&("multiplerowsextended"==l.selectionmode||"multiplerowsadvanced"==l.selectionmode||"multiplecellsextended"==l.selectionmode||"multiplecellsadvanced"==l.selectionmode)){if(l.mousecaptured=!1,"visible"==this.selectionarea.css("visibility")){this.selectionarea.css("visibility","hidden");var s=this.showheader?this.columnsheader.height()+2:0,o=this._groupsheader()?this.groupsheader.height():0;"0px"===this.host.css("border-top-width")&&(o-=2),o+=this.showtoolbar?this.toolbar.height():0,o+=this.showfilterbar?this.toolbarheight:0;var a=this.selectionarea.coord(),r=this.host.coord();this.hasTransform&&(r=e.jqx.utilities.getOffset(this.host),a=e.jqx.utilities.getOffset(this.selectionarea)),"0px"===this.host.css("border-top-width")&&(o-=2);var n=a.left-r.left,d=a.top-s-r.top-o,c=d,h=n+this.selectionarea.width(),u=n,f=new Array,p=new Array;if("multiplerowsextended"==l.selectionmode){for(;d<c+this.selectionarea.height();){var g=(A=this._hittestrow(n,d)).row;-1!=(E=A.index)&&(p[E]||(p[E]=!0,f[f.length]=A)),d+=20}c=0;e.each(f,function(){var e=this.row;"none"!=l.selectionmode&&l._selectrowwithmouse&&(t.ctrlKey||t.metaKey?l._applyrowselection(l.getboundindex(e),!0,!1,!1):0==c?l._applyrowselection(l.getboundindex(e),!0,!1,!0):l._applyrowselection(l.getboundindex(e),!0,!1,!1),c++)})}else{var v=null,w=null;"multiplecellsadvanced"==l.selectionmode&&(d+=2);var m=l.hScrollInstance,x=m.value;this.rtl&&("hidden"!=this.hScrollBar.css("visibility")&&(x=m.max-m.value),"hidden"!=this.vScrollBar[0].style.visibility&&(x-=this.scrollbarsize+4));var b=l.table[0].rows[0],_=l.selectionarea.height();!t.ctrlKey&&!t.metaKey&&_>0&&(l.selectedcells=new Array);var y=_,k=(parseInt(this.vScrollInstance.value),parseInt(this.hScrollInstance.value)),C=(this._gettableheight(),null!=this._hostwidth?this._hostwidth:this.host.width()),q=this.groupable&&this.groups.length>0?this.groups.length:0,j=this.columns.records.length-q,O=this.groupable&&this.groups.length>0,T=this._getvisualcolumnsindexes(k,C,q,j,O,!0,!0),I=T.start,S=T.end;for(this.__firstcell=null;d<c+y;){var A;if(A=l._hittestrow(n,d)){var E;g=A.row;if(-1!=(E=A.index)&&!p[E])if(p[E]=!0,this.enableoptimization)for(P=I;P<S;P++){z=(k=parseFloat(l.columnsrow[0].cells[P].style.left)-x)+l.columns.records[P].width;(u>=k&&u<=z||h>=k&&h<=z||k>=u&&k<=h)&&(l._applycellselection(l.getboundindex(g),l._getcolumnat(P).datafield,!0,!1),v={x:n,y:d,rowindex:E,row:l.getboundindex(g),index:P,datafield:l._getcolumnat(P).datafield},l.__lastcell=v,w||(w=v,l.__firstcell=w))}else for(var P=0;P<b.cells.length;P++){var z=(k=parseFloat(e(l.columnsrow[0].cells[P]).css("left"))-x)+e(l.columnsrow[0].cells[P]).width();(u>=k&&u<=z||h>=k&&h<=z||k>=u&&k<=h)&&(l._applycellselection(l.getboundindex(g),l._getcolumnat(P).datafield,!0,!1),v={x:n,y:d,rowindex:E,row:l.getboundindex(g),index:P,datafield:l._getcolumnat(P).datafield},l.__lastcell=v,w||(w=v,l.__firstcell=w))}d+=5}else d+=5}}l.autosavestate&&l.savestate&&l.savestate()}l._renderrows(l.virtualsizeinfo),!1!==i&&l._handleAutofill(t,l)}}},_handleAutofill:function(t,l){if(this.autofill){var i=this,s=this.showheader?this.columnsheader.height()+2:0,o=this._groupsheader()?this.groupsheader.height():0;"0px"===this.host.css("border-top-width")&&(o-=2);new Array,new Array;o+=this.showtoolbar?this.toolbar.height():0,o+=this.showfilterbar?this.toolbarheight:0;var a=this.selectionarea.coord(),r=this.host.coord();this.hasTransform&&(r=e.jqx.utilities.getOffset(this.host),a=e.jqx.utilities.getOffset(this.selectionarea)),"0px"===this.host.css("border-top-width")&&(o-=2);var n=a.left-r.left,d=(a.top,r.top,n+this.selectionarea.width()),c=i.__lastcell,h=i.__firstcell;"multiplecellsadvanced"==l.selectionmode&&2;var u=l.hScrollInstance;u.value;this.rtl&&("hidden"!=this.hScrollBar.css("visibility")&&u.max-u.value,"hidden"!=this.vScrollBar[0].style.visibility&&this.scrollbarsize+4);l.table[0].rows[0];var f=l.selectionarea.height(),p=parseInt(t.pageX),g=parseInt(t.pageY),v=f;(i=l)._autofill&&i._autofill.remove(),h&&!i.getcolumn(h.datafield).autofill||i.autofill&&(i._autofill=document.createElement("div"),i._autofill.style.width="6px",i._autofill.style.height="6px",i._autofill.style.position="absolute",i._autofill.style.top=a.top+v+1+"px",i._autofill.style.left=d+i.host.offset().left+2+"px",i._autofill.style.cursor="crosshair",i._autofill.style.paddingLeft="0px",i._autofill.style.paddingTop="0px",i._autofill.style.paddingRight="0px",i._autofill.style.paddingBottom="0px",i._autofill.style.borderTopLeftRadius="0px",i._autofill.style.borderTopRightRadius="0px",i._autofill.style.borderBottomLeftRadius="0px",i._autofill.style.borderBottomRightRadius="0px",i._autofill.style.background="transparent",e(i._autofill).addClass(i.toThemeProperty("jqx-widget")),e(i._autofill).addClass(i.toThemeProperty("jqx-button")),e(i._autofill).addClass(i.toThemeProperty("primary")),e(i._autofill).addClass(i.toThemeProperty("jqx-fill-state-pressed")),i._lastClickedCell=c,i._autofill.onpointerdown=function(t){i._handlemouseupselection(t,i,!1);var s=t.originalEvent?t.originalEvent:t;i._autofillDragStart=!0,i.mousecaptured=!0;var o=i.showheader?i.columnsheader.height()+2:0,a=i._groupsheader()?i.groupsheader.height():0;a+=i.showtoolbar?i.toolbarheight:0,a+=i.showfilterbar?i.toolbarheight:0;var r=i.host.coord(),n=p-r.left,d=g-o-r.top-a;if(i.pageable&&!i.autoheight&&i.gotopage&&d>i.pager.coord().top-r.top-a-o)return;var c=i._hittestrow(n,d);if(c&&!c.details){c.row,c.index,s.target.className;var u=i.table[0].rows[h.rowindex],f=e(l.columnsrow[0].cells[h.index]).coord().left,v=e(u).coord().top+1;i.mousecaptured=!0,i.mousecaptureposition={x:f,y:v,left:s.pageX,top:s.pageY,clickedrow:u},i.copyselection(),s.stopPropagation(),s.preventDefault()}},e(document).off("pointermove.autofill"),e(document).off("pointerup.autofill"),e(document).on("pointermove.autofill",function(e){if(i._autofillDragStart){var t=e.originalEvent?e.originalEvent:e;i.mousecaptureposition.position?"y"===i.mousecaptureposition.position?(t._pageX=i.mousecaptureposition.x,t._pageY=t.pageY,i.mousecaptureposition.top=i.mousecaptureposition.y,i._handlemousemoveselection(t,i)):(t._pageX=t.pageX,t._pageY=i.mousecaptureposition.y,i.mousecaptureposition.clickedcell=h.index,i.mousecaptureposition.left=i.mousecaptureposition.x,i._handlemousemoveselection(t,i,null)):Math.abs(i.mousecaptureposition.left-t.pageX)>=5?i.mousecaptureposition.position="x":Math.abs(i.mousecaptureposition.top-t.pageY)&&(i.mousecaptureposition.position="y")}}),e(document).on("pointerup.autofill",function(e){var t=e.originalEvent?e.originalEvent:e;i._handlemouseupselection(t,i),i._autofillDragStart=!1,i.mousecaptureposition=null,i.mousecaptured=!1,i.pasteselection(),i._handlemouseupselection(t,i)}),i.element.appendChild(i._autofill))}},selectprevcell:function(e,t){var l=this._getcolumnindex(t),i=(this.columns.records.length,this._getprevvisiblecolumn(l));null!=i&&(this.clearselection(),this.selectcell(e,i.datafield))},selectnextcell:function(e,t){var l=this._getcolumnindex(t),i=(this.columns.records.length,this._getnextvisiblecolumn(l));null!=i&&(this.clearselection(),this.selectcell(e,i.datafield))},_getfirstvisiblecolumn:function(){for(var e=this.columns.records.length,t=0;t<e;t++){var l=this.columns.records[t];if(!l.hidden&&null!=l.datafield)return l}return null},_getlastvisiblecolumn:function(){for(var e=this.columns.records.length-1;e>=0;e--){var t=this.columns.records[e];if(!t.hidden&&null!=t.datafield)return t}return null},_handlekeydown:function(t,l){if(l.groupable&&l.groups.length,l.disabled)return!1;var i=t.charCode?t.charCode:t.keyCode?t.keyCode:0;if(32===i&&(t.metaKey||t.ctrlKey)&&"multiplecellsadvanced"==l.selectionmode){var s=this.getselectedcell();if(t.shiftKey){if(this.clearselection(),this.selectallrows(),this.columns.records.length<30)for(var o=0;o<this.columns.records.length;o++){var a;(a=this.columns.records[o]).selectable&&a.toggleSelection(a,t,!0)}return void this._renderrows(this.virtualsizeinfo)}s&&(a=this.getcolumn(s.datafield)).selectable&&(this.clearselection(),a.toggleSelection(a,t,!0),this._renderrows(this.virtualsizeinfo))}if(l.editcell&&"multiplecellsadvanced"!=l.selectionmode)return!0;if(l.editcell&&"multiplecellsadvanced"==l.selectionmode){if(!(i>=33&&i<=40))return!0;if(t.altKey)return l._cancelkeydown=!1,!0;if(null!=l._cancelkeydown&&0!=l._cancelkeydown)return l._cancelkeydown=!1,!0;if("selectedrow"===l.editmode)return!0;if(l.endcelledit(l.editcell.row,l.editcell.column,!1,!0),l._cancelkeydown=!1,l.editcell&&!l.editcell.validated)return l._rendervisualrows(),l.endcelledit(l.editcell.row,l.editcell.column,!1,!0),!1}if("none"==l.selectionmode)return!0;if(l.showfilterrow&&l.filterable&&this.filterrow&&e(t.target).ischildof(l.filterrow))return!0;if(l.showeverpresentrow){if(l.addnewrowtop&&e(t.target).ischildof(l.addnewrowtop))return!0;if(l.addnewrowbottom&&e(t.target).ischildof(l.addnewrowbottom))return!0}if(t.target.className&&t.target.className.indexOf("jqx-grid-widget")>=0)return!0;if(l.pageable&&e(t.target).ischildof(this.pager))return!0;if(this.showtoolbar&&e(t.target).ischildof(this.toolbar))return!0;if(this.showfilterbar&&e(t.target).ischildof(this.filterbar))return!0;if(this.showstatusbar&&e(t.target).ischildof(this.statusbar))return!0;var r=!1;if(t.altKey)return!0;if((t.ctrlKey||t.metaKey)&&this.clipboard){var n=String.fromCharCode(i).toLowerCase();if("z"===n&&this._undoRedo){if(-1===this._undoRedoIndex&&(this._undoRedoIndex=this._undoRedo.length-1),c=this._undoRedo[this._undoRedoIndex])if("setcellvalue"===c.action)this.setcellvalue(c.data.row,c.data.datafield,c.data.oldvalue),this.clearselection(),this.selectcell(c.data.row,c.data.datafield),this.ensurecellvisible(c.data.row,c.data.datafield);else if("paste"===c.action){if(this.clearselection(),c.data)for(o=0;o<c.data.length;o++){var d=c.data[o];this.setcellvalue(d.row,d.datafield,d.oldvalue),this._applycellselection(d.row,d.datafield,!0,!1),0===o&&this.ensurecellvisible(d.row,d.datafield)}this._rendervisualrows()}this._undoRedoIndex>0&&this._undoRedoIndex--}if("y"===n&&this._undoRedo){var c;if(-1===this._undoRedoIndex&&(this._undoRedoIndex=this._undoRedo.length-1),c=this._undoRedo[this._undoRedoIndex])if("setcellvalue"===c.action)this.setcellvalue(c.data.row,c.data.datafield,c.data.value),this.clearselection(),this.selectcell(c.data.row,c.data.datafield),this.ensurecellvisible(c.data.row,c.data.datafield);else if("paste"===c.action){this.clearselection();for(o=0;o<c.data.length;o++){d=c.data[o];this.setcellvalue(d.row,d.datafield,d.value),this._applycellselection(d.row,d.datafield,!0,!1),0===o&&this.ensurecellvisible(d.row,d.datafield)}this._rendervisualrows()}this._undoRedoIndex<this._undoRedo.length-1&&this._undoRedoIndex++}if("d"===n){this.copyselection(),this._clipboardselection[0];this._clipboardselection=[this._clipboardselection[0]],this.pasteselection()}if(this.clipboardbegin){var h=null;if("c"==n?h=this.clipboardbegin("copy",this.copyselection()):"x"==n?h=this.clipboardbegin("cut",this.copyselection()):"v"==n&&(h=this.clipboardbegin("paste")),!1===h)return!1}if("c"==n||"x"==n){var u=this.copyselection();if("c"==n&&this.clipboardend&&this.clipboardend("copy"),"x"==n&&this.clipboardend&&this.clipboardend("cut"),window.clipboardData)window.clipboardData.setData("Text",u);else{var f=e('<textarea style="position: absolute; left: -1000px; top: -1000px;"/>');f.val(u),e("body").append(f),f.select(),setTimeout(function(){document.designMode="off",f.select(),f.remove(),l.focus()},100)}if("c"==n&&e.jqx.browser.msie)return!1;if("c"==n)return!0}else if("v"==n){if(document.activeElement&&"INPUT"===document.activeElement.nodeName)return!0;var p=e('<textarea style="position: absolute; left: -1000px; top: -1000px;"/>');e("body").append(p),p.select();var g=this;return setTimeout(function(){if(g._clipboardselection=new Array,0==(e=p.val()).length&&window.clipboardData){p.val(window.clipboardData.getData("Text"));var e=p.val()}for(var t=e.split("\n"),l=0;l<t.length;l++)if(t[l].split("\t").length>0){var i=t[l].split("\t");if(1==i.length&&l==t.length-1&&""==i[0])continue;i.length>0&&g._clipboardselection.push(i)}g.pasteselection(),p.remove(),g.focus()},100),!0}if("x"==n)return this.deleteselection(),this.host.focus(),!1}var v=Math.round(l._gettableheight()),w=Math.round(v/l.rowsheight),m=l.getdatainformation();switch(l.selectionmode){case"singlecell":case"multiplecells":case"multiplecellsextended":case"multiplecellsadvanced":if(null===(s=l.getselectedcell())&&l.selectcell(0,l.columns.records[0].displayfield),null!=s){var x=this.getrowvisibleindex(s.rowindex),b=s.datafield,_=l._getcolumnindex(b),y=(l.columns.records.length,function(e,i,s,o){var a=function(e,i){var a,n=l.dataview.loadedrecords[e];if(l.groupable&&l.groups.length>0){var d=e;"up"==o&&d++,"down"==o&&d--;n=l.getdisplayrows()[d];for(var c=1,h=!0;h&&c<300&&(h=!1,"down"==o?n=l.getdisplayrows()[d+c]:"up"==o&&(n=l.getdisplayrows()[d-c]),n);){n&&n.group&&(h=!0),n&&n.totalsrow&&(h=!0);for(var u=n.parentItem;u;)!u||(a=u).group&&(l.expandedgroups[a.uniqueid]?l.expandedgroups[a.uniqueid].expanded:void 0)||(h=!0),u=u.parentItem;if(!h)break;c++}if(300==c&&(n=null),l.pageable){var f=!1;if(n){for(var p=0;p<l.dataview.rows.length;p++)l.dataview.rows[p].boundindex==n.boundindex&&(f=!0);f||(n=null)}}}else if(l.pageable){f=!1;if(n){for(p=0;p<l.dataview.rows.length;p++)l.dataview.rows[p].boundindex==n.boundindex&&(f=!0);f||(l.pagerpageinput&&9===t.keyCode&&n.boundindex>l.dataview.rows[l.dataview.rows.length-1].boundindex&&(l.pagerpageinput.focus(),t.preventDefault()),l.ensurerowvisible(n))}}if(null!=n&&null!=i&&!n.totalsrow){(s||null==s)&&l.clearselection();var g=l.getboundindex(n);return l.selectcell(g,i),l._oldselectedcell=l.selectedcell,r=!0,l.groupable?l.ensurecellvisible(g,i):l.ensurecellvisible(e,i),!0}return!1};if(a(e,i)||l.groupable||(l.ensurecellvisible(e,i),a(e,i),l.virtualmode&&l.host.focus()),!(l.groupable&&l.groups.length>0))if(t.shiftKey&&9!=t.keyCode){if(("multiplecellsextended"==l.selectionmode||"multiplecellsadvanced"==l.selectionmode)&&l._lastClickedCell){l._selectpath(e,i);var n=l.dataview.loadedrecords[e],d=l.getboundindex(n);return void(l.selectedcell={rowindex:d,datafield:i})}}else t.shiftKey||(l._lastClickedCell={row:e,column:i})}),k=t.shiftKey&&"singlecell"!=l.selectionmode&&"multiplecells"!=l.selectionmode,C=function(){if(l.pageable){var e=l.dataview.pagenum*l.dataview.pagesize;y(e,b,!k)}else y(0,b,!k)},q=function(){var e=m.rowscount-1;l.pageable&&(e=l.dataview.pagenum*l.dataview.pagesize+l.dataview.rows.length-1);y(e,b,!k)},j=9==i&&!t.shiftKey,O=9==i&&t.shiftKey;if(l.rtl){var T=j;j=O,O=T}if((j||O)&&(k=!1),(j||O)&&document.activeElement&&document.activeElement.className&&document.activeElement.className.indexOf("jqx-grid-cell-add-new-row")>=0)return!0;if((R=t.ctrlKey||t.metaKey)&&37==i)null!=(E=l._getfirstvisiblecolumn(_))&&y(x,E.datafield);else if(R&&39==i){var I=l._getlastvisiblecolumn(_);null!=I&&y(x,I.datafield)}else if(39==i||j){var S=l._getnextvisiblecolumn(_);if(null!=S)y(x,S.datafield,!k);else if(j){var A=l._getfirstvisiblecolumn();i=40,b=A.displayfield}else r=!0}else if(37==i||O){var E;if(null!=(E=l._getprevvisiblecolumn(_)))y(x,E.datafield,!k);else if(O){var P=l._getlastvisiblecolumn();i=38,b=P.displayfield}else r=!0}else if(36==i)C();else if(35==i)q();else if(33==i){if(x-w>=0)y(K=x-w,b,!k),l.pageable&&l.virtualmode&&(l.gotoprevpage(),setTimeout(function(){y(K,b,!k)},25));else C()}else if(34==i){if(m.rowscount>x+w)y(K=x+w,b,!k),l.pageable&&l.virtualmode&&(l.gotonextpage(),setTimeout(function(){y(K,b,!k)},25));else q()}38==i&&(R?C():x>0?y(x-1,b,!k,"up"):r=!1),40==i&&(R?q():m.rowscount>x+1||l.groupable&&l.groups.length>0?y(x+1,b,!k,"down"):r=!0)}break;case"singlerow":case"multiplerows":case"multiplerowsextended":case"multiplerowsadvanced":if(null==(x=l.getselectedrowindex())||-1==x)return!0;x=this.getrowvisibleindex(x);var z=function(e,s,o){var a=function(e){var t,i=l.dataview.loadedrecords[e];if(l.groupable&&l.groups.length>0){"up"==o&&e++,"down"==o&&e--;i=l.getdisplayrows()[e];for(var a=1,n=!0;n&&a<300&&(n=!1,"down"==o?i=l.getdisplayrows()[e+a]:"up"==o&&(i=l.getdisplayrows()[e-a]),i);){i&&i.group&&(n=!0),i&&i.totalsrow&&(n=!0);for(var d=i.parentItem;d;)!d||(t=d).group&&(l.expandedgroups[t.uniqueid]?l.expandedgroups[t.uniqueid].expanded:void 0)||(n=!0),d=d.parentItem;if(!n)break;a++}if(300==a&&(i=null),l.pageable){var c=!1;if(i){for(var h=0;h<l.dataview.rows.length;h++)l.dataview.rows[h].boundindex==i.boundindex&&(c=!0);c||(i=null)}}}if(null!=i){var u=l.getboundindex(i),f=l.selectedrowindex;if((s||null==s)&&l.clearselection(),l.selectedrowindex=f,l.selectrow(u,!1),l.groupable)var p=l.ensurerowvisible(u);else p=l.ensurerowvisible(e);return(!p||l.autoheight||l.groupable)&&l._rendervisualrows(),r=!0,!0}return!1};if(a(e)||l.groupable||(l.ensurerowvisible(e),a(e),l.virtualmode&&setTimeout(function(){a(e)},25),l.virtualmode&&l.host.focus()),!(l.groupable&&l.groups.length>0))if(t.shiftKey&&9!=i){if("multiplerowsextended"==l.selectionmode&&l._lastClickedCell)return l._selectrowpath(e),void(l.selectedrowindex=l.getrowboundindex(e))}else t.shiftKey||(l._lastClickedCell={row:e},l.selectedrowindex=l.getrowboundindex(e))},R=(k=t.shiftKey&&"singlerow"!=l.selectionmode&&"multiplerows"!=l.selectionmode,C=function(){if(l.pageable){var e=l.dataview.pagenum*l.dataview.pagesize;z(e,!k)}else z(0,!k)},q=function(){var e=m.rowscount-1;l.pageable&&(e=l.dataview.pagenum*l.dataview.pagesize+l.dataview.rows.length-1);z(e,!k)},t.ctrlKey||t.metaKey);if(36==i||R&&38==i)C();else if(35==i||R&&40==i)q();else if(33==i){if(x-w>=0)z(K=x-w,!k,"up"),l.pageable&&l.virtualmode&&(l.gotoprevpage(),setTimeout(function(){z(K,!k)},25));else C()}else if(34==i){var K;if(m.rowscount>x+w)z(K=x+w,!k,"down"),l.pageable&&l.virtualmode&&(l.gotonextpage(),setTimeout(function(){z(K,!k)},25));else q()}else 38==i?x>0?z(x-1,!k,"up"):r=!0:40==i&&(m.rowscount>x+1||l.groupable&&l.groups.length>0?z(x+1,!k,"down"):r=!0)}return!r||(l.autosavestate&&l.savestate&&l.savestate(),!1)},_handlemousemove:function(t,l){if(!l.vScrollInstance.isScrolling()&&!l.hScrollInstance.isScrolling()){var i,s,o,a,r;if(l.enablehover||"multiplerows"==l.selectionmode){if(i=this.showheader?this.columnsheader.height()+2:0,s=this._groupsheader()?this.groupsheader.height():0,s+=this.showtoolbar?this.toolbarheight:0,s+=this.showfilterbar?this.toolbarheight:0,o=this.host.coord(),this.hasTransform){o=e.jqx.utilities.getOffset(this.host);var n=this._getBodyOffset();o.left-=n.left,o.top-=n.top}a=t.pageX-o.left,r=t.pageY-i-o.top-s}if("multiplerowsextended"!=l.selectionmode&&"multiplecellsextended"!=l.selectionmode&&"multiplecellsadvanced"!=l.selectionmode||1!=l.mousecaptured){if(!l.enablehover)return!0;if(!l.disabled&&!this.vScrollInstance.isScrolling()&&!this.hScrollInstance.isScrolling()){var d=this._hittestrow(a,r);if(d){var c=d.row,h=d.index;if((-1==this.hoveredrow||-1==h||this.hoveredrow!=h||-1!=this.selectionmode.indexOf("cell")||"checkbox"==this.selectionmode)&&(this._clearhoverstyle(),-1!=h&&null!=c)){var u=this.hittestinfo[h].visualrow;if(null!=u&&!(this.hittestinfo[h].details||t.clientX>e(u).width()+e(u).coord().left)){var f=0,p=u.cells.length;if(l.rowdetails&&l.showrowdetailscolumn?this.rtl?(p-=1,p-=this.groups.length):f=1+this.groups.length:this.groupable&&(this.rtl?p-=this.groups.length:f=this.groups.length),0!=u.cells.length){var g=u.cells[f].className;if(!(c.group||this.selectionmode.indexOf("row")>=0&&-1!=g.indexOf("jqx-grid-cell-selected")))if(this.hoveredrow=h,-1==this.selectionmode.indexOf("cell")&&"checkbox"!=this.selectionmode)for(x=f;x<p;x++){y=u.cells[x];e(y).addClass(this.toTP("jqx-grid-cell-hover")),e(y).addClass(this.toTP("jqx-fill-state-hover")),this.cellhover&&this.cellhover(y,t.pageX,t.pageY),(_=this._getcolumnat(x))._applyCellStyle(y)}else{var v=-1,w=this.hScrollInstance,m=w.value;this.rtl&&"hidden"!=this.hScrollBar.css("visibility")&&(m=w.max-w.value);for(var x=f;x<p;x++){var b=parseInt(this.columnsrow[0].cells[x].style.left)-m;if(this.columns.records[x].pinned&&!this.rtl&&(b=parseInt(this.columnsrow[0].cells[x].style.left)),b+this.columns.records[x].width>=a&&a>=b){v=x;break}}if(-1!=v){var _,y=u.cells[v];if(this.cellhover&&this.cellhover(y,t.pageX,t.pageY),-1==y.className.indexOf("jqx-grid-cell-selected"))if(this.editcell)if((_=this._getcolumnat(v))&&this.editcell.row==h&&this.editcell.column==_.datafield)return;e(y).addClass(this.toTP("jqx-grid-cell-hover")),e(y).addClass(this.toTP("jqx-fill-state-hover")),(_=this._getcolumnat(v))._applyCellStyle(y)}}}}}}}}}}})}(jqxBaseFramework);
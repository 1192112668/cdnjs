!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).immer={})}(this,function(e){"use strict";var t,r="undefined"!=typeof Symbol,n="undefined"!=typeof Map,a="undefined"!=typeof Set,i="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,s=r?Symbol("immer-nothing"):((t={})["immer-nothing"]=!0,t),o=r?Symbol("immer-draftable"):"__$immer_draftable",d=r?Symbol("immer-state"):"__$immer_state",f=r?Symbol.iterator:"@@iterator",u={0:"Illegal state",1:"Immer drafts cannot have computed properties",2:"This object has been frozen and should not be mutated",3:function(e){return"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+e},4:"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.",5:"Immer forbids circular references",6:"The first or second argument to `produce` must be a function",7:"The third argument to `produce` must be a function or undefined",8:"First argument to `createDraft` must be a plain object, an array, or an immerable object",9:"First argument to `finishDraft` must be a draft returned by `createDraft`",10:"The given draft is already finalized",11:"Object.defineProperty() cannot be used on an Immer draft",12:"Object.setPrototypeOf() cannot be used on an Immer draft",13:"Immer only supports deleting array indices",14:"Immer only supports setting array indices and the 'length' property",15:function(e){return"Cannot apply patch, path doesn't resolve: "+e},16:'Sets cannot have "replace" patches.',17:function(e){return"Unsupported patch operation: "+e},18:function(e){return"The plugin for '"+e+"' has not been loaded into Immer. To enable the plugin, import and call `enable"+e+"()` when initializing your application."},19:"plugin not loaded",20:"Cannot use proxies if Proxy, Proxy.revocable or Reflect are not available"};function l(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var a=u[e],i=a?"function"==typeof a?a.apply(null,r):a:"unknown error nr: "+e;throw new Error("[Immer] "+i)}var c=0,p=1,_=2,h=3,P=0,O=1,w=4,z=5,j=2,x=3;function y(e){return!!e&&!!e[d]}function v(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);return!t||t===Object.prototype}(e)||Array.isArray(e)||!!e[o]||!!e.constructor[o]||D(e)||M(e))}var b="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames;function S(r,n,e){void 0===e&&(e=!1),A(r)===c?(e?Object.keys:b)(r).forEach(function(e){return n(e,r[e],r)}):r.forEach(function(e,t){return n(t,e,r)})}function A(e){var t=e[d];return t?3<t.type_?t.type_-4:t.type_:Array.isArray(e)?p:D(e)?_:M(e)?h:c}function k(e,t){return A(e)===_?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function E(e,t){return A(e)===_?e.get(t):e[t]}function m(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function D(e){return n&&e instanceof Map}function M(e){return a&&e instanceof Set}function g(e){return e.copy_||e.base_}function F(n,a){if(void 0===a&&(a=!1),Array.isArray(n))return n.slice();var i=Object.create(Object.getPrototypeOf(n));return S(n,function(e){var t,r;e!==d&&(r=(t=Object.getOwnPropertyDescriptor(n,e)).value,t.get&&(a||l(1),r=t.get.call(n)),t.enumerable?i[e]=r:Object.defineProperty(i,e,{value:r,writable:!0,configurable:!0}))}),i}function I(e,t){y(e)||Object.isFrozen(e)||!v(e)||(1<A(e)&&(e.set=e.add=e.clear=e.delete=R),Object.freeze(e),t&&S(e,function(e,t){return I(t,!0)},!0))}function R(){l(2)}var N,T={};function W(e){var t=T[e];return t||l(18,e),t}function C(e,t){T[e]=t}function U(){return N||l(0),N}function K(e,t){t&&(W("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function J(e){L(e),e.drafts_.forEach(q),e.drafts_=null}function L(e){e===N&&(N=e.parent_)}function $(e){return N={drafts_:[],parent_:N,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function q(e){var t=e[d];t.type_===P||t.type_===O?t.revoke_():t.revoked_=!0}function B(e,t){t.unfinalizedDrafts_=t.drafts_.length;var r=t.drafts_[0],n=void 0!==e&&e!==r;return t.immer_.useProxies_||W("ES5").willFinalizeES5_(t,e,n),n?(r[d].modified_&&(J(t),l(4)),v(e)&&(e=G(t,e),t.parent_||Q(t,e)),t.patches_&&W("Patches").generateReplacementPatches_(r[d],e,t.patches_,t.inversePatches_)):e=G(t,r,[]),J(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==s?e:void 0}function G(r,n,a){if(Object.isFrozen(n))return n;var i,o=n[d];return o?o.scope_!==r?n:o.modified_?(o.finalized_||(o.finalized_=!0,o.scope_.unfinalizedDrafts_--,S(i=o.type_===w||o.type_===z?o.copy_=F(o.draft_,!0):o.copy_,function(e,t){return H(r,o,i,e,t,a)}),Q(r,i,!1),a&&r.patches_&&W("Patches").generatePatches_(o,a,r.patches_,r.inversePatches_)),o.copy_):(Q(r,o.base_,!0),o.base_):(S(n,function(e,t){return H(r,o,n,e,t,a)},!0),n)}function H(e,t,r,n,a,i){if(a===r&&l(5),y(a)){var o=G(e,a,i&&t&&t.type_!==x&&!k(t.assigned_,n)?i.concat(n):void 0);if(c=n,s=o,(f=A(u=r))===_?u.set(c,s):f===h?(u.delete(c),u.add(s)):u[c]=s,!y(o))return;e.canAutoFreeze_=!1}var u,c,s,f;if((!t||!m(a,E(t.base_,n)))&&v(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;G(e,a),t&&t.scope_.parent_||Q(e,a)}}function Q(e,t,r){void 0===r&&(r=!1),e.immer_.autoFreeze_&&e.canAutoFreeze_&&I(t,r)}var V={get:function(e,t){if(t===d)return e;var r=e.drafts_;if(!e.modified_&&k(r,t))return r[t];var n=g(e)[t];if(e.finalized_||!v(n))return n;if(e.modified_){if(n!==Y(e.base_,t))return n;r=e.copy_}return r[t]=re(e.scope_.immer_,n,e)},has:function(e,t){return t in g(e)},ownKeys:function(e){return Reflect.ownKeys(g(e))},set:function(e,t,r){if(!e.modified_){var n=Y(e.base_,t);if(r?m(n,r)||r===e.drafts_[t]:m(n,r)&&t in e.base_)return!0;ee(e),Z(e)}return e.assigned_[t]=!0,e.copy_[t]=r,!0},deleteProperty:function(e,t){return void 0!==Y(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,ee(e),Z(e)):e.assigned_[t]&&delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor:function(e,t){var r=g(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&(n.writable=!0,n.configurable=e.type_!==O||"length"!==t),n},defineProperty:function(){l(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.base_)},setPrototypeOf:function(){l(12)}},X={};function Y(e,t){var r=e[d],n=Reflect.getOwnPropertyDescriptor(r?g(r):e,t);return n&&n.value}function Z(e){var r;e.modified_||(e.modified_=!0,e.type_!==P&&e.type_!==O||(r=e.copy_=F(e.base_),S(e.drafts_,function(e,t){r[e]=t}),e.drafts_=void 0),e.parent_&&Z(e.parent_))}function ee(e){e.copy_||(e.copy_=F(e.base_))}S(V,function(e,t){X[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),X.deleteProperty=function(e,t){return isNaN(parseInt(t))&&l(13),V.deleteProperty.call(this,e[0],t)},X.set=function(e,t,r){return"length"!==t&&isNaN(parseInt(t))&&l(14),V.set.call(this,e[0],t,r,e[0])};var te=function(){function e(e){this.useProxies_=i,this.autoFreeze_=!0,"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),this.produce=this.produce.bind(this),this.produceWithPatches=this.produceWithPatches.bind(this)}var t=e.prototype;return t.produce=function(e,i,t){if("function"==typeof e&&"function"!=typeof i){var o=i;i=e;var u=this;return function(e){var t=this;void 0===e&&(e=o);for(var r=arguments.length,n=new Array(1<r?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return u.produce(e,function(e){return i.call.apply(i,[t,e].concat(n))})}}var r;if("function"!=typeof i&&l(6),void 0!==t&&"function"!=typeof t&&l(7),v(e)){var n=$(this),a=re(this,e,void 0),c=!0;try{r=i(a),c=!1}finally{(c?J:L)(n)}return"undefined"!=typeof Promise&&r instanceof Promise?r.then(function(e){return K(n,t),B(e,n)},function(e){throw J(n),e}):(K(n,t),B(r,n))}if((r=i(e))!==s)return void 0===r&&(r=e),this.autoFreeze_&&I(r,!0),r},t.produceWithPatches=function(a,e){var r,n,i=this;return"function"==typeof a?function(e){for(var t=arguments.length,r=new Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return i.produceWithPatches(e,function(e){return a.apply(void 0,[e].concat(r))})}:[this.produce(a,e,function(e,t){r=e,n=t}),r,n]},t.createDraft=function(e){v(e)||l(8);var t=$(this),r=re(this,e,void 0);return r[d].isManual_=!0,L(t),r},t.finishDraft=function(e,t){var r=e&&e[d];r&&r.isManual_||l(9),r.finalized_&&l(10);var n=r.scope_;return K(n,t),B(void 0,n)},t.setAutoFreeze=function(e){this.autoFreeze_=e},t.setUseProxies=function(e){i||l(20),this.useProxies_=e},t.applyPatches=function(e,t){for(var r=t.length-1;0<=r;r--){var n=t[r];if(0===n.path.length&&"replace"===n.op){e=n.value;break}}var a=W("Patches").applyPatches_;return y(e)?a(e,t):this.produce(e,function(e){return a(e,t.slice(r+1))})},e}();function re(e,t,r){var n=D(t)?W("MapSet").proxyMap_(t,r):M(t)?W("MapSet").proxySet_(t,r):e.useProxies_?function(e,t){var r=Array.isArray(e),n={type_:r?O:P,scope_:t?t.scope_:U(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,drafts_:{},copy_:null,revoke_:null,isManual_:!1},a=n,i=V;r&&(a=[n],i=X);var o=Proxy.revocable(a,i),u=o.revoke,c=o.proxy;return n.draft_=c,n.revoke_=u,c}(t,r):W("ES5").createES5Proxy_(t,r);return(r?r.scope_:U()).drafts_.push(n),n}function ne(e,t){e.useProxies_?Z(t):W("ES5").markChangedES5_(t)}function ae(){function u(e,t){var r=e[d];if(!r||r.finalizing_)return e[t];r.finalizing_=!0;var n=e[t];return r.finalizing_=!1,n}function p(e){e.modified_||(e.modified_=!0,e.parent_&&p(e.parent_))}function c(e){e.copy_||(e.copy_=r(e.base_))}function r(e){var t=e&&e[d];if(t){t.finalizing_=!0;var r=F(t.draft_,!0);return t.finalizing_=!1,r}return F(e)}var s={};function n(e){for(var t=e.length-1;0<=t;t--){var r=e[t][d];if(!r.modified_)switch(r.type_){case z:_(r)&&p(r);break;case w:a(r)&&p(r)}}}function a(e){for(var t=e.base_,r=e.draft_,n=Object.keys(r),a=n.length-1;0<=a;a--){var i=n[a],o=t[i];if(void 0===o&&!k(t,i))return 1;var u=r[i],c=u&&u[d];if(c?c.base_!==o:!m(u,o))return 1}return n.length!==Object.keys(t).length}function _(e){var t=e.draft_;if(t.length!==e.base_.length)return 1;var r=Object.getOwnPropertyDescriptor(t,t.length-1);return!(!r||r.get)}function f(e){e.revoked_&&l(3,JSON.stringify(g(e)))}C("ES5",{createES5Proxy_:function(a,e){var i=Array.isArray(a),o=r(a);S(o,function(e){var t,r,n;!function(e,t,r){var n=s[t];n?n.enumerable=r:s[t]=n={enumerable:r,get:function(){return function(e,t){f(e);var r=u(g(e),t);if(e.finalizing_)return r;if(r===u(e.base_,t)&&v(r))return c(e),e.copy_[t]=re(e.scope_.immer_,r,e);return r}(this[d],t)},set:function(e){!function(e,t,r){if(f(e),e.assigned_[t]=!0,!e.modified_){if(m(r,u(g(e),t)))return;p(e),c(e)}e.copy_[t]=r}(this[d],t,e)}};Object.defineProperty(e,t,n)}(o,e,i||(t=a,r=e,!(!(n=Object.getOwnPropertyDescriptor(t,r))||!n.enumerable)))});var t={type_:i?z:w,scope_:e?e.scope_:U(),modified_:!1,finalizing_:!1,finalized_:!1,assigned_:{},parent_:e,base_:a,draft_:o,copy_:null,revoked_:!1,isManual_:!1};return Object.defineProperty(o,d,{value:t,writable:!0}),o},markChangedES5_:p,willFinalizeES5_:function(e,t,r){e.drafts_.forEach(function(e){e[d].finalizing_=!0}),r?y(t)&&t[d].scope_===e&&n(e.drafts_):(e.patches_&&function t(e){if(!e||"object"!=typeof e)return;var r=e[d];if(!r)return;var n=r.base_,a=r.draft_,i=r.assigned_,o=r.type_;if(o===w)S(a,function(e){e!==d&&(void 0!==n[e]||k(n,e)?i[e]||t(a[e]):(i[e]=!0,p(r)))}),S(n,function(e){void 0!==a[e]||k(a,e)||(i[e]=!1,p(r))});else if(o===z){if(_(r)&&(p(r),i.length=!0),a.length<n.length)for(var u=a.length;u<n.length;u++)i[u]=!1;else for(var c=n.length;c<a.length;c++)i[c]=!0;for(var s=Math.min(a.length,n.length),f=0;f<s;f++)void 0===i[f]&&t(a[f])}}(e.drafts_[0]),n(e.drafts_))}})}function ie(){var v="replace",b="add",m="remove";function s(e){if(!e||"object"!=typeof e)return e;if(Array.isArray(e))return e.map(s);if(D(e))return new Map(Array.from(e.entries()).map(function(e){return[e[0],s(e[1])]}));if(M(e))return new Set(Array.from(e).map(s));var t=Object.create(Object.getPrototypeOf(e));for(var r in e)t[r]=s(e[r]);return t}function g(e){return y(e)?s(e):e}C("Patches",{applyPatches_:function(c,e){return e.forEach(function(e){for(var t=e.path,r=e.op,n=c,a=0;a<t.length-1;a++)"object"!=typeof(n=E(n,t[a]))&&l(15,t.join("/"));var i=A(n),o=s(e.value),u=t[t.length-1];switch(r){case v:switch(i){case _:return n.set(u,o);case h:l(16);default:return n[u]=o}case b:switch(i){case p:return n.splice(u,0,o);case _:return n.set(u,o);case h:return n.add(o);default:return n[u]=o}case m:switch(i){case p:return n.splice(u,1);case _:return n.delete(u);case h:return n.delete(e.value);default:return delete n[u]}default:l(17,r)}}),c},generatePatches_:function(e,t,r,n){switch(e.type_){case P:case w:case j:return _=t,d=r,l=n,h=(p=e).base_,y=p.copy_,void S(p.assigned_,function(e,t){var r,n=E(h,e),a=E(y,e),i=t?k(h,e)?v:b:m;n===a&&i===v||(r=_.concat(e),d.push(i===m?{op:i,path:r}:{op:i,path:r,value:a}),l.push(i===b?{op:m,path:r}:i===m?{op:b,path:r,value:g(n)}:{op:v,path:r,value:g(n)}))});case z:case O:return function(e,t,r,n){var a=e.base_,i=e.assigned_,o=e.copy_;{var u,c;o.length<a.length&&(a=(u=[o,a])[0],o=u[1],r=(c=[n,r])[0],n=c[1])}var s=o.length-a.length,f=0;for(;a[f]===o[f]&&f<a.length;)++f;var p=a.length;for(;f<p&&a[p-1]===o[p+s-1];)--p;for(var _=f;_<p;++_){var d;i[_]&&o[_]!==a[_]&&(d=t.concat([_]),r.push({op:v,path:d,value:g(o[_])}),n.push({op:v,path:d,value:g(a[_])}))}for(var l=r.length,h=p+s-1;p<=h;--h){var y=t.concat([h]);r[l+h-p]={op:b,path:y,value:g(o[h])},n.push({op:m,path:y})}}(e,t,r,n);case x:return i=t,o=r,u=n,c=(a=e).base_,s=a.copy_,f=0,c.forEach(function(e){var t;s.has(e)||(t=i.concat([f]),o.push({op:m,path:t,value:e}),u.unshift({op:b,path:t,value:e})),f++}),f=0,void s.forEach(function(e){var t;c.has(e)||(t=i.concat([f]),o.push({op:b,path:t,value:e}),u.unshift({op:m,path:t,value:e})),f++})}var a,i,o,u,c,s,f,p,_,d,l,h,y},generateReplacementPatches_:function(e,t,r,n){r.push({op:v,path:[],value:t}),n.push({op:v,path:[],value:e.base_})}})}function oe(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function r(e,t){function r(){this.constructor=e}n(e,t),e.prototype=(r.prototype=t.prototype,new r)}var a=function(){function e(e,t){return this[d]={type_:j,parent_:t,scope_:t?t.scope_:U(),modified_:!1,finalized_:!1,copy_:void 0,assigned_:void 0,base_:e,draft_:this,isManual_:!1,revoked_:!1},this}r(e,Map);var t=e.prototype;return Object.defineProperty(t,"size",{get:function(){return g(this[d]).size}}),t.has=function(e){return g(this[d]).has(e)},t.set=function(e,t){var r=this[d];return c(r),g(r).get(e)!==t&&(i(r),ne(r.scope_.immer_,r),r.assigned_.set(e,!0),r.copy_.set(e,t),r.assigned_.set(e,!0)),this},t.delete=function(e){if(!this.has(e))return!1;var t=this[d];return c(t),i(t),ne(t.scope_.immer_,t),t.assigned_.set(e,!1),t.copy_.delete(e),!0},t.clear=function(){var e=this[d];return c(e),i(e),ne(e.scope_.immer_,e),e.assigned_=new Map,e.copy_.clear()},t.forEach=function(n,a){var i=this;g(this[d]).forEach(function(e,t,r){n.call(a,i.get(t),t,i)})},t.get=function(e){var t=this[d];c(t);var r=g(t).get(e);if(t.finalized_||!v(r))return r;if(r!==t.base_.get(e))return r;var n=re(t.scope_.immer_,r,t);return i(t),t.copy_.set(e,n),n},t.keys=function(){return g(this[d]).keys()},t.values=function(){var t=this,r=this.keys(),e={};return e[f]=function(){return t.values()},e.next=function(){var e=r.next();return e.done?e:{done:!1,value:t.get(e.value)}},e},t.entries=function(){var r=this,n=this.keys(),e={};return e[f]=function(){return r.entries()},e.next=function(){var e=n.next();if(e.done)return e;var t=r.get(e.value);return{done:!1,value:[e.value,t]}},e},t[f]=function(){return this.entries()},e}();function i(e){e.copy_||(e.assigned_=new Map,e.copy_=new Map(e.base_))}var o=function(){function e(e,t){return this[d]={type_:x,parent_:t,scope_:t?t.scope_:U(),modified_:!1,finalized_:!1,copy_:void 0,base_:e,draft_:this,drafts_:new Map,revoked_:!1,isManual_:!1},this}r(e,Set);var t=e.prototype;return Object.defineProperty(t,"size",{get:function(){return g(this[d]).size}}),t.has=function(e){var t=this[d];return c(t),t.copy_?!!t.copy_.has(e)||!(!t.drafts_.has(e)||!t.copy_.has(t.drafts_.get(e))):t.base_.has(e)},t.add=function(e){var t=this[d];return c(t),t.copy_?t.copy_.add(e):t.base_.has(e)||(u(t),ne(t.scope_.immer_,t),t.copy_.add(e)),this},t.delete=function(e){if(!this.has(e))return!1;var t=this[d];return c(t),u(t),ne(t.scope_.immer_,t),t.copy_.delete(e)||!!t.drafts_.has(e)&&t.copy_.delete(t.drafts_.get(e))},t.clear=function(){var e=this[d];return c(e),u(e),ne(e.scope_.immer_,e),e.copy_.clear()},t.values=function(){var e=this[d];return c(e),u(e),e.copy_.values()},t.entries=function(){var e=this[d];return c(e),u(e),e.copy_.entries()},t.keys=function(){return this.values()},t[f]=function(){return this.values()},t.forEach=function(e,t){for(var r=this.values(),n=r.next();!n.done;)e.call(t,n.value,n.value,this),n=r.next()},e}();function u(r){r.copy_||(r.copy_=new Set,r.base_.forEach(function(e){var t;v(e)?(t=re(r.scope_.immer_,e,r),r.drafts_.set(e,t),r.copy_.add(t)):r.copy_.add(e)}))}function c(e){e.revoked_&&l(3,JSON.stringify(g(e)))}C("MapSet",{proxyMap_:function(e,t){return new a(e,t)},proxySet_:function(e,t){return new o(e,t)}})}var ue=new te,ce=ue.produce,se=ue.produceWithPatches.bind(ue),fe=ue.setAutoFreeze.bind(ue),pe=ue.setUseProxies.bind(ue),_e=ue.applyPatches.bind(ue),de=ue.createDraft.bind(ue),le=ue.finishDraft.bind(ue);e.Immer=te,e.applyPatches=_e,e.castDraft=function(e){return e},e.castImmutable=function(e){return e},e.createDraft=de,e.default=ce,e.enableAllPlugins=function(){ae(),oe(),ie()},e.enableES5=ae,e.enableMapSet=oe,e.enablePatches=ie,e.finishDraft=le,e.immerable=o,e.isDraft=y,e.isDraftable=v,e.nothing=s,e.original=function(e){if(e&&e[d])return e[d].base_},e.produce=ce,e.produceWithPatches=se,e.setAutoFreeze=fe,e.setUseProxies=pe,Object.defineProperty(e,"__esModule",{value:!0})});
"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var deepmerge=_interopDefault(require("deepmerge")),version="2.1.0";let batchId=null;function triggerUpdate(e,t){e.$root._vueMeta.initialized||!e.$root._vueMeta.initializing&&"watcher"!==t||(e.$root._vueMeta.initialized=null),e.$root._vueMeta.initialized&&!e.$root._vueMeta.paused&&batchUpdate(()=>e.$meta().refresh())}function batchUpdate(e,t=10){return clearTimeout(batchId),batchId=setTimeout(()=>{e()},t)}function isArray(e){return Array.isArray(e)}function isUndefined(e){return void 0===e}function isObject(e){return"object"==typeof e}function isPureObject(e){return"object"==typeof e&&null!==e}function isFunction(e){return"function"==typeof e}function isString(e){return"string"==typeof e}function ensureIsArray(e,t){return t&&isObject(e)?(isArray(e[t])||(e[t]=[]),e):isArray(e)?e:[]}function ensuredPush(e,t,n){ensureIsArray(e,t),e[t].push(n)}function hasMetaInfo(e=this){return e&&(!0===e._vueMeta||isObject(e._vueMeta))}function inMetaInfoBranch(e=this){return e&&!isUndefined(e._vueMeta)}function addNavGuards(e){if(e.$root._vueMeta.navGuards||!e.$root.$router)return;e.$root._vueMeta.navGuards=!0;const t=e.$root.$router,n=e.$root.$meta();t.beforeEach((e,t,i)=>{n.pause(),i()}),t.afterEach(()=>{const{metaInfo:e}=n.resume();e&&e.afterNavigation&&isFunction(e.afterNavigation)&&e.afterNavigation(e)})}function hasGlobalWindowFn(){try{return!isUndefined(window)}catch(e){return!1}}const hasGlobalWindow=hasGlobalWindowFn(),_global=hasGlobalWindow?window:global,console=_global.console=_global.console||{};function warn(...e){console&&console.warn&&console.warn(...e)}let appId=1;function createMixin(e,t){const n=["activated","deactivated","beforeMount"];return{beforeCreate(){if(Object.defineProperty(this,"_hasMetaInfo",{configurable:!0,get(){return e.config.devtools&&!this.$root._vueMeta.hasMetaInfoDeprecationWarningShown&&(warn("VueMeta DeprecationWarning: _hasMetaInfo has been deprecated and will be removed in a future version. Please use hasMetaInfo(vm) instead"),this.$root._vueMeta.hasMetaInfoDeprecationWarningShown=!0),hasMetaInfo(this)}}),!isUndefined(this.$options[t.keyName])&&null!==this.$options[t.keyName]){if(this.$root._vueMeta||(this.$root._vueMeta={appId:appId},appId++),!this._vueMeta){this._vueMeta=!0;let e=this.$parent;for(;e&&e!==this.$root;)isUndefined(e._vueMeta)&&(e._vueMeta=!1),e=e.$parent}isFunction(this.$options[t.keyName])&&(this.$options.computed||(this.$options.computed={}),this.$options.computed.$metaInfo=this.$options[t.keyName],this.$isServer||ensuredPush(this.$options,"created",()=>{this.$watch("$metaInfo",function(){triggerUpdate(this,"watcher")})})),isUndefined(this.$root._vueMeta.initialized)&&(this.$root._vueMeta.initialized=this.$isServer,this.$root._vueMeta.initialized||(ensuredPush(this.$options,"beforeMount",()=>{this.$root.$el&&this.$root.$el.hasAttribute&&this.$root.$el.hasAttribute("data-server-rendered")&&(this.$root._vueMeta.appId=t.ssrAppId)}),ensuredPush(this.$options,"mounted",()=>{this.$root._vueMeta.initialized||(this.$root._vueMeta.initializing=!0,this.$nextTick(function(){const{tags:e,metaInfo:n}=this.$root.$meta().refresh();!1===e&&null===this.$root._vueMeta.initialized&&this.$nextTick(()=>triggerUpdate(this,"initializing")),this.$root._vueMeta.initialized=!0,delete this.$root._vueMeta.initializing,!t.refreshOnceOnNavigation&&n.afterNavigation&&addNavGuards(this)}))}),t.refreshOnceOnNavigation&&addNavGuards(this))),this.$isServer||(n.forEach(e=>{ensuredPush(this.$options,e,()=>triggerUpdate(this,e))}),ensuredPush(this.$options,"destroyed",()=>{const e=setInterval(()=>{this.$el&&null!==this.$el.offsetParent||(clearInterval(e),this.$parent&&triggerUpdate(this,"destroyed"))},50)}))}}}}const defaultInfo={title:void 0,titleChunk:"",titleTemplate:"%s",htmlAttrs:{},bodyAttrs:{},headAttrs:{},base:[],link:[],meta:[],style:[],script:[],noscript:[],__dangerouslyDisableSanitizers:[],__dangerouslyDisableSanitizersByTagID:{}},keyName="metaInfo",attribute="data-vue-meta",ssrAttribute="data-vue-meta-server-rendered",tagIDKeyName="vmid",metaTemplateKeyName="template",contentKeyName="content",ssrAppId="ssr",defaultOptions={keyName:keyName,attribute:attribute,ssrAttribute:ssrAttribute,tagIDKeyName:"vmid",contentKeyName:"content",metaTemplateKeyName:"template",ssrAppId:"ssr"},metaInfoOptionKeys=["titleChunk","titleTemplate","changed","__dangerouslyDisableSanitizers","__dangerouslyDisableSanitizersByTagID"],disableOptionKeys=["__dangerouslyDisableSanitizers","__dangerouslyDisableSanitizersByTagID"],metaInfoAttributeKeys=["htmlAttrs","headAttrs","bodyAttrs"],tagsSupportingOnload=["link","style","script"],tagsWithoutEndTag=["base","meta","link"],tagsWithInnerContent=["noscript","script","style"],tagAttributeAsInnerContent=["innerHTML","cssText","json"],commonDataAttributes=["body","pbody"],booleanHtmlAttributes=["allowfullscreen","amp","async","autofocus","autoplay","checked","compact","controls","declare","default","defaultchecked","defaultmuted","defaultselected","defer","disabled","enabled","formnovalidate","hidden","indeterminate","inert","ismap","itemscope","loop","multiple","muted","nohref","noresize","noshade","novalidate","nowrap","open","pauseonexit","readonly","required","reversed","scoped","seamless","selected","sortable","truespeed","typemustmatch","visible"];function setOptions(e){e=isObject(e)?e:{};for(const t in defaultOptions)e[t]||(e[t]=defaultOptions[t]);return e}function getOptions(e){const t={};for(const n in e)t[n]=e[n];return t}function pause(e=!0){return this.$root._vueMeta.paused=!0,()=>resume(e)}function resume(e=!0){if(this.$root._vueMeta.paused=!1,e)return this.$root.$meta().refresh()}function applyTemplate({component:e,metaTemplateKeyName:t,contentKeyName:n},i,o,a){return isUndefined(o)&&(o=i[t],delete i[t]),!!o&&(isUndefined(a)&&(a=i[n]),i[n]=isFunction(o)?o.call(e,a):o.replace(/%s/g,a),!0)}function findIndex(e,t){if(!Array.prototype.findIndex){for(let n=0;n<e.length;n++)if(t.call(arguments[2],e[n],n,e))return n;return-1}return e.findIndex(t,arguments[2])}function toArray(e){return Array.from?Array.from(e):Array.prototype.slice.call(e)}function includes(e,t){if(!Array.prototype.includes){for(const n in e)if(e[n]===t)return!0;return!1}return e.includes(t)}const serverSequences=[[/&/g,"&amp;"],[/</g,"&lt;"],[/>/g,"&gt;"],[/"/g,"&quot;"],[/'/g,"&#x27;"]],clientSequences=[[/&/g,"&"],[/</g,"<"],[/>/g,">"],[/"/g,'"'],[/'/g,"'"]];function escape(e,t,n){const{tagIDKeyName:i}=t,{doEscape:o=(e=>e),escapeKeys:a}=n,r={};for(const s in e){const u=e[s];if(includes(metaInfoOptionKeys,s)){r[s]=u;continue}let[c]=disableOptionKeys;if(n[c]&&includes(n[c],s)){r[s]=u;continue}const l=e[i];if(l&&(c=disableOptionKeys[1],n[c]&&n[c][l]&&includes(n[c][l],s)))r[s]=u;else if(isString(u)?r[s]=o(u):isArray(u)?r[s]=u.map(e=>isPureObject(e)?escape(e,t,{...n,escapeKeys:!0}):o(e)):isPureObject(u)?r[s]=escape(u,t,{...n,escapeKeys:!0}):r[s]=u,a){const e=o(s);s!==e&&(r[e]=r[s],delete r[s])}}return r}function arrayMerge({component:e,tagIDKeyName:t,metaTemplateKeyName:n,contentKeyName:i},o,a){const r=[];return o.forEach((o,s)=>{if(!o[t])return void r.push(o);const u=findIndex(a,e=>e[t]===o[t]),c=a[u];if(-1===u)return void r.push(o);if(c.hasOwnProperty(i)&&void 0===c[i]||c.hasOwnProperty("innerHTML")&&void 0===c.innerHTML)return r.push(o),void a.splice(u,1);if(null===c[i]||null===c.innerHTML)return void a.splice(u,1);const l=o[n];l&&(c[n]?c[i]||applyTemplate({component:e,metaTemplateKeyName:n,contentKeyName:i},c,void 0,o[i]):applyTemplate({component:e,metaTemplateKeyName:n,contentKeyName:i},c,l))}),r.concat(a)}function merge(e,t,n={}){return t.hasOwnProperty("title")&&void 0===t.title&&delete t.title,metaInfoAttributeKeys.forEach(e=>{if(t[e])for(const n in t[e])t[e].hasOwnProperty(n)&&void 0===t[e][n]&&(includes(booleanHtmlAttributes,n)&&warn("VueMeta: Please note that since v2 the value undefined is not used to indicate boolean attributes anymore, see migration guide for details"),delete t[e][n])}),deepmerge(e,t,{arrayMerge:(e,t)=>arrayMerge(n,e,t)})}function getComponentOption(e={},t,n={}){const{keyName:i,metaTemplateKeyName:o,tagIDKeyName:a}=e,{$options:r,$children:s}=t;if(t._inactive)return n;if(r[i]){let o=r[i];if(isFunction(o)&&(o=o.call(t)),!isObject(o))return n;n=merge(n,o,e)}return s.length&&s.forEach(t=>{inMetaInfoBranch(t)&&(n=getComponentOption(e,t,n))}),o&&n.meta&&(n.meta.forEach(t=>applyTemplate(e,t)),n.meta=n.meta.filter((e,t,n)=>!e.hasOwnProperty(a)||t===findIndex(n,t=>t[a]===e[a]))),n}function getMetaInfo(e={},t,n=[]){let i=getComponentOption(e,t,defaultInfo);i.title&&(i.titleChunk=i.title),i.titleTemplate&&"%s"!==i.titleTemplate&&applyTemplate({component:t,contentKeyName:"title"},i,i.titleTemplate,i.titleChunk||""),i.base&&(i.base=Object.keys(i.base).length?[i.base]:[]);const o={doEscape:e=>n.reduce((e,[t,n])=>e.replace(t,n),e)};return disableOptionKeys.forEach((e,t)=>{if(0===t)ensureIsArray(i,e);else if(1===t)for(const t in i[e])ensureIsArray(i[e],t);o[e]=i[e]}),i=escape(i,e,o)}function getTag(e,t){return e[t]||(e[t]=document.getElementsByTagName(t)[0]),e[t]}function getElementsKey({body:e,pbody:t}){return e?"body":t?"pbody":"head"}function queryElements(e,{appId:t,attribute:n,type:i,tagIDKeyName:o},a={}){const r=[`${i}[${n}="${t}"]`,`${i}[data-${o}]`].map(e=>{for(const t in a){const n=a[t];e+=`[data-${t}${n&&!0!==n?`="${n}"`:""}]`}return e});return toArray(e.querySelectorAll(r.join(", ")))}const callbacks=[];function isDOMComplete(e=document){return"complete"===e.readyState}function addCallback(e,t){1===arguments.length&&(t=e,e=""),callbacks.push([e,t])}function addCallbacks({tagIDKeyName:e},t,n,i){let o=!1;for(const i of n)i[e]&&i.callback&&(o=!0,addCallback(`${t}[data-${e}="${i[e]}"]`,i.callback));return i&&o?addListeners():o}function addListeners(){isDOMComplete()?applyCallbacks():document.onreadystatechange=(()=>{applyCallbacks()})}function applyCallbacks(e){for(const[t,n]of callbacks){const i=`${t}[onload="this.__vm_l=1"]`;let o=[];e||(o=toArray(document.querySelectorAll(i))),e&&e.matches(i)&&(o=[e]);for(const e of o){if(e.__vm_cb)continue;const t=()=>{e.__vm_cb=!0,e.removeAttribute("onload"),n(e)};e.__vm_l?t():e.__vm_ev||(e.__vm_ev=!0,e.addEventListener("load",t))}}}function updateAttribute({attribute:e}={},t,n){const i=n.getAttribute(e),o=i?i.split(","):[],a=toArray(o),r=[];for(const e in t)if(t.hasOwnProperty(e)){const i=includes(booleanHtmlAttributes,e)?"":isArray(t[e])?t[e].join(" "):t[e];n.setAttribute(e,i||""),includes(o,e)||o.push(e),r.push(a.indexOf(e))}const s=a.filter((e,t)=>!includes(r,t)).reduce((e,t)=>(n.removeAttribute(t),e+1),0);o.length===s?n.removeAttribute(e):n.setAttribute(e,o.sort().join(","))}function updateTitle(e){(e||""===e)&&(document.title=e)}function updateTag(e,t={},n,i,o,a){const{attribute:r,tagIDKeyName:s}=t,u=[s,...commonDataAttributes],c=[],l={appId:e,attribute:r,type:n,tagIDKeyName:s},d={head:queryElements(o,l),pbody:queryElements(a,l,{pbody:!0}),body:queryElements(a,l,{body:!0})};if(i.length>1){const e=[];i=i.filter(t=>{const n=JSON.stringify(t),i=!includes(e,n);return e.push(n),i})}if(i.length)for(const t of i){if(t.skip)continue;const i=document.createElement(n);i.setAttribute(r,e);for(const e in t){if(!t.hasOwnProperty(e))continue;if("innerHTML"===e){i.innerHTML=t.innerHTML;continue}if("json"===e){i.innerHTML=JSON.stringify(t.json);continue}if("cssText"===e){i.styleSheet?i.styleSheet.cssText=t.cssText:i.appendChild(document.createTextNode(t.cssText));continue}if("callback"===e){i.onload=(()=>t[e](i));continue}const n=includes(u,e)?`data-${e}`:e,o=includes(booleanHtmlAttributes,e);if(o&&!t[e])continue;const a=o?"":t[e];i.setAttribute(n,a)}const o=d[getElementsKey(t)];let a;o.some((e,t)=>(a=t,i.isEqualNode(e)))&&(a||0===a)?o.splice(a,1):c.push(i)}let f=[];for(const e of Object.values(d))f=[...f,...e];for(const e of f)e.parentNode.removeChild(e);for(const e of c)e.hasAttribute("data-body")?a.appendChild(e):e.hasAttribute("data-pbody")?a.insertBefore(e,a.firstChild):o.appendChild(e);return{oldTags:f,newTags:c}}function updateClientMetaInfo(e,t={},n){const{ssrAttribute:i,ssrAppId:o}=t,a={},r=getTag(a,"html");if(e===o&&r.hasAttribute(i)){r.removeAttribute(i);let e=!1;for(const i of tagsSupportingOnload)n[i]&&addCallbacks(t,i,n[i])&&(e=!0);return e&&addListeners(),!1}const s={},u={};for(const i in n){if(includes(metaInfoOptionKeys,i))continue;if("title"===i){updateTitle(n.title);continue}if(includes(metaInfoAttributeKeys,i)){const e=i.substr(0,4);updateAttribute(t,n[i],getTag(a,e));continue}if(!isArray(n[i]))continue;const{oldTags:o,newTags:r}=updateTag(e,t,i,n[i],getTag(a,"head"),getTag(a,"body"));r.length&&(s[i]=r,u[i]=o)}return{addedTags:s,removedTags:u}}function _refresh(e={}){return function(){const t=getMetaInfo(e,this.$root,clientSequences),n=updateClientMetaInfo(this.$root._vueMeta.appId,e,t);return n&&isFunction(t.changed)&&t.changed(t,n.addedTags,n.removedTags),{vm:this,metaInfo:t,tags:n}}}function attributeGenerator({attribute:e,ssrAttribute:t}={},n,i){return{text(o){let a="";const r=[];for(const e in i)i.hasOwnProperty(e)&&(r.push(e),a+=isUndefined(i[e])||booleanHtmlAttributes.includes(e)?e:`${e}="${isArray(i[e])?i[e].join(" "):i[e]}"`,a+=" ");return a&&(a+=`${e}="${r.sort().join(",")}"`),"htmlAttrs"===n&&o?`${t}${a?" ":""}${a}`:a}}}function titleGenerator({attribute:e}={},t,n){return{text:()=>n?`<${t}>${n}</${t}>`:""}}function tagGenerator({ssrAppId:e,attribute:t,tagIDKeyName:n}={},i,o){const a=[n,"callback",...commonDataAttributes];return{text:({body:n=!1,pbody:r=!1}={})=>o.reduce((o,s)=>{if(s.skip)return o;if(0===Object.keys(s).length)return o;if(Boolean(s.body)!==n||Boolean(s.pbody)!==r)return o;let u=s.once?"":` ${t}="${e}"`;for(const e in s){if(tagAttributeAsInnerContent.includes(e)||"once"===e)continue;let t="";if(a.includes(e)&&(t="data-"),"callback"===e){u+=' onload="this.__vm_l=1"';continue}const n=!t&&booleanHtmlAttributes.includes(e);n&&!s[e]||(u+=` ${t}${e}`+(n?"":`="${s[e]}"`))}let c="";s.json&&(c=JSON.stringify(s.json));const l=s.innerHTML||s.cssText||c,d=!tagsWithoutEndTag.includes(i),f=d&&tagsWithInnerContent.includes(i);return`${o}<${i}${u}${!f&&d?"/":""}>`+(f?`${l}</${i}>`:"")},"")}}function generateServerInjector(e,t,n){return"title"===t?titleGenerator(e,t,n):metaInfoAttributeKeys.includes(t)?attributeGenerator(e,t,n):tagGenerator(e,t,n)}function _inject(e={}){return function(){const t=getMetaInfo(e,this.$root,serverSequences);for(const n in t)!metaInfoOptionKeys.includes(n)&&t.hasOwnProperty(n)&&(t[n]=generateServerInjector(e,n,t[n]));return t}}function _$meta(e={}){const t=_refresh(e),n=_inject(e);return function(){return{getOptions:()=>getOptions(e),refresh:t.bind(this),inject:n.bind(this),pause:pause.bind(this),resume:resume.bind(this)}}}function install(e,t={}){e.__vuemeta_installed||(e.__vuemeta_installed=!0,t=setOptions(t),e.prototype.$meta=_$meta(t),e.mixin(createMixin(e,t)))}var index={version:version,install:install,hasMetaInfo:hasMetaInfo};module.exports=index;
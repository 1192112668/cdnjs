"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var matmul_1=require("../types/matmul"),MatMulProgram=function(t,n,e,i){void 0===e&&(e=matmul_1.MatrixOrientation.REGULAR),void 0===i&&(i=matmul_1.MatrixOrientation.REGULAR),this.variableNames=["matrixA","matrixB"];var a=e===matmul_1.MatrixOrientation.REGULAR?t[0]:t[1],r=i===matmul_1.MatrixOrientation.REGULAR?n[1]:n[0];function o(t,n){return e===matmul_1.MatrixOrientation.REGULAR?"aRow, "+n+" + "+t:n+" + "+t+", aRow"}function u(t,n){return i===matmul_1.MatrixOrientation.REGULAR?n+" + "+t+", bCol":"bCol, "+n+" + "+t}this.outputShape=[a,r];var M=e===matmul_1.MatrixOrientation.REGULAR?t[1]:t[0],x=4*Math.floor(M/4),l=M%4;this.userCode=" float dotARowBCol(int aRow, int bCol) {\n      float result = 0.0;\n      for (int i = 0; i < "+x+"; i += 4) {\n        vec4 a = vec4(\n          getMatrixA("+o(0,"i")+"),\n          getMatrixA("+o(1,"i")+"),\n          getMatrixA("+o(2,"i")+"),\n          getMatrixA("+o(3,"i")+")\n        );\n        vec4 b = vec4(\n          getMatrixB("+u(0,"i")+"),\n          getMatrixB("+u(1,"i")+"),\n          getMatrixB("+u(2,"i")+"),\n          getMatrixB("+u(3,"i")+")\n        );\n\n        result += dot(a, b);\n      }\n\n      if ("+(1==l)+") {\n        result += getMatrixA("+o(0,x)+") *\n          getMatrixB("+u(0,x)+");\n      } else if ("+(2==l)+") {\n        vec2 a = vec2(\n          getMatrixA("+o(0,x)+"),\n          getMatrixA("+o(1,x)+")\n        );\n        vec2 b = vec2(\n          getMatrixB("+u(0,x)+"),\n          getMatrixB("+u(1,x)+")\n        );\n        result += dot(a, b);\n      } else if ("+(3==l)+") {\n        vec3 a = vec3(\n          getMatrixA("+o(0,x)+"),\n          getMatrixA("+o(1,x)+"),\n          getMatrixA("+o(2,x)+")\n        );\n        vec3 b = vec3(\n          getMatrixB("+u(0,x)+"),\n          getMatrixB("+u(1,x)+"),\n          getMatrixB("+u(2,x)+")\n        );\n        result += dot(a, b);\n      }\n\n      return result;\n    }\n\n    void main() {\n      ivec2 resRC = getOutputCoords();\n      setOutput(dotARowBCol(resRC.x, resRC.y));\n    }\n    "};exports.MatMulProgram=MatMulProgram;
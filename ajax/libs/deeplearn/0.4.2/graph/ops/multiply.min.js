"use strict";var __extends=this&&this.__extends||function(){var s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])};return function(e,r){function t(){this.constructor=e}s(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}}();Object.defineProperty(exports,"__esModule",{value:!0});var util=require("../../util"),graph_util=require("../graph_util"),op_1=require("./op"),Multiply=function(a){function e(e,r,t){var s=a.call(this)||this;return s.x1Tensor=e,s.x2Tensor=r,s.yTensor=t,util.assert(1===util.sizeFromShape(e.shape)||1===util.sizeFromShape(r.shape)||util.arraysEqual(e.shape,r.shape),"One of t1 or t2 must be a scalar, or t1 and t2 must have the same shape"),s}return __extends(e,a),e.prototype.feedForward=function(t,s){var a=this,o=s.get(this.x1Tensor),i=s.get(this.x2Tensor);t.scope(function(e){var r=util.isScalarShape(o.shape)?t.scalarTimesArray(o,i):util.isScalarShape(i.shape)?t.scalarTimesArray(i,o):t.elementWiseMul(o,i);s.set(a.yTensor,e(r))})},e.prototype.backProp=function(r,e,t){var s=this,a=e.get(this.x1Tensor),o=e.get(this.x2Tensor),i=t.get(this.yTensor);r.scope(function(){var e;graph_util.shouldBackProp(s.x1Tensor)&&(util.isScalarShape(s.x1Tensor.shape)?(e=r.elementWiseMul(i,o),t.add(s.x1Tensor,r.sum(e))):util.isScalarShape(o.shape)?t.add(s.x1Tensor,r.scalarTimesArray(o,i)):t.add(s.x1Tensor,r.elementWiseMul(o,i))),graph_util.shouldBackProp(s.x2Tensor)&&(util.isScalarShape(s.x2Tensor.shape)?(e=r.elementWiseMul(i,a),t.add(s.x2Tensor,r.sum(e))):util.isScalarShape(a.shape)?t.add(s.x2Tensor,r.scalarTimesArray(a,i)):t.add(s.x2Tensor,r.elementWiseMul(a,i)))})},e}(op_1.Operation);exports.Multiply=Multiply;
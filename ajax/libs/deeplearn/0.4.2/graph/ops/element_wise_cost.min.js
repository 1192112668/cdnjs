"use strict";var __extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(exports,"__esModule",{value:!0});var environment_1=require("../../environment"),cost_functions_1=require("../../math/cost_functions"),ndarray_1=require("../../math/ndarray"),util=require("../../util"),graph_util=require("../graph_util"),op_1=require("./op"),ElementWiseCost=function(s){function e(e,t,r,n){var o=s.call(this)||this;return o.x1Tensor=e,o.x2Tensor=t,o.yTensor=r,o.func=n,o.oneOverNScalar=environment_1.ENV.math.keep(ndarray_1.Scalar.new(1/util.sizeFromShape(e.shape))),o}return __extends(e,s),e.prototype.feedForward=function(o,s){var i=this,a=s.get(this.x1Tensor),u=s.get(this.x2Tensor);o.scope(function(e){var t=i.func.cost(o,a,u),r=o.sum(t),n=o.scalarTimesArray(i.oneOverNScalar,r);s.set(i.yTensor,e(n))})},e.prototype.backProp=function(e,t,r){var n=this,o=t.get(this.x1Tensor),s=t.get(this.x2Tensor);e.scope(function(){graph_util.shouldBackProp(n.x1Tensor)&&r.add(n.x1Tensor,n.func.der(e,o,s)),graph_util.shouldBackProp(n.x2Tensor)&&r.add(n.x2Tensor,n.func.der(e,s,o))})},e.prototype.dispose=function(){this.func.dispose(),this.oneOverNScalar.dispose()},e}(op_1.Operation),MeanSquaredCost=function(n){function e(e,t,r){return n.call(this,e,t,r,new cost_functions_1.SquareCostFunc)||this}return __extends(e,n),e}(exports.ElementWiseCost=ElementWiseCost);exports.MeanSquaredCost=MeanSquaredCost;
"use strict";var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,s){e.__proto__=s}||function(e,s){for(var r in s)s.hasOwnProperty(r)&&(e[r]=s[r])};return function(e,s){function r(){this.constructor=e}t(e,s),e.prototype=null===s?Object.create(s):(r.prototype=s.prototype,new r)}}();Object.defineProperty(exports,"__esModule",{value:!0});var util=require("../../util"),graph_util=require("../graph_util"),op_1=require("./op"),Add=function(a){function e(e,s,r){var t=a.call(this)||this;return t.x1Tensor=e,t.x2Tensor=s,t.yTensor=r,util.assert(1===util.sizeFromShape(e.shape)||1===util.sizeFromShape(s.shape)||util.arraysEqual(e.shape,s.shape)||2===e.shape.length&&1===s.shape.length&&e.shape[1]===s.shape[0]||1===e.shape.length&&2===s.shape.length&&e.shape[0]===s.shape[1],"One of t1 or t2 must be a scalar, or t1 and t2 must have the same shape, or one of them can be broadcasted (2D and 1D)."),t}return __extends(e,a),e.prototype.feedForward=function(r,t){var a=this,o=t.get(this.x1Tensor),n=t.get(this.x2Tensor);r.scope(function(e){var s=util.isScalarShape(o.shape)?r.scalarPlusArray(o,n):util.isScalarShape(n.shape)?r.scalarPlusArray(n,o):r.add(o,n);t.set(a.yTensor,e(s))})},e.prototype.backProp=function(s,e,r){var t=this,a=r.get(this.yTensor);s.scope(function(){var e;graph_util.shouldBackProp(t.x1Tensor)&&(1===t.x1Tensor.shape.length&&2===t.x2Tensor.shape.length&&t.x1Tensor.shape[0]===t.x2Tensor.shape[1]?(e=s.sum(a,0),r.add(t.x1Tensor,e)):util.isScalarShape(t.x1Tensor.shape)?(e=s.sum(a),r.add(t.x1Tensor,e)):r.add(t.x1Tensor,s.clone(a))),graph_util.shouldBackProp(t.x2Tensor)&&(2===t.x1Tensor.shape.length&&1===t.x2Tensor.shape.length&&t.x1Tensor.shape[1]===t.x2Tensor.shape[0]?(e=s.sum(a,0),r.add(t.x2Tensor,e)):util.isScalarShape(t.x2Tensor.shape)?(e=s.sum(a),r.add(t.x2Tensor,e)):r.add(t.x2Tensor,s.clone(a)))})},e.prototype.dispose=function(){null!=this.dySizeScalar&&this.dySizeScalar.dispose()},e}(op_1.Operation);exports.Add=Add;
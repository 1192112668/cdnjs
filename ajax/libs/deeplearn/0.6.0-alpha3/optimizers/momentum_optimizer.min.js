"use strict";var __extends=this&&this.__extends||function(){var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}();Object.defineProperty(exports,"__esModule",{value:!0});var environment_1=require("../environment"),globals_1=require("../globals"),ops_1=require("../ops/ops"),sgd_optimizer_1=require("./sgd_optimizer"),MomentumOptimizer=function(n){function t(t,e,o){void 0===o&&(o=!1);var i=n.call(this,t)||this;return i.learningRate=t,i.momentum=e,i.useNesterov=o,i.m=ops_1.scalar(i.momentum),i.accumulations={},i}return __extends(t,n),t.prototype.applyGradients=function(t){function e(o){var i=environment_1.ENV.engine.registeredVariables[o];null==u.accumulations[o]&&globals_1.tidy(function(){s.accumulations[o]=ops_1.zerosLike(i).variable(!1)});var n=u.accumulations[o],r=t[o];globals_1.tidy(function(){var t=s.m.mul(n).add(r),e=s.useNesterov?s.c.mul(r.add(t.mul(s.m))).add(i):s.c.mul(t).add(i);s.accumulations[o].assign(t),i.assign(e)})}var s=this,u=this;for(var o in t)e(o)},t.prototype.dispose=function(){if(n.prototype.dispose.call(this),this.m.dispose(),null!=this.accumulations)for(var t in this.accumulations)this.accumulations[t].dispose()},t.prototype.setMomentum=function(t){this.momentum=t},t}(sgd_optimizer_1.SGDOptimizer);exports.MomentumOptimizer=MomentumOptimizer;
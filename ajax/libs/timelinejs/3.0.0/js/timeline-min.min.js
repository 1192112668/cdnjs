!function(t){t.VCO={VERSION:"0.1",_originalL:t.VCO}}(this),VCO.debug=!0,VCO.Bind=function(t,e){return function(){return t.apply(e,arguments)}},trace=function(t){VCO.debug&&(window.console?console.log(t):"undefined"!=typeof jsTrace&&jsTrace.send(t))},VCO.Util={extend:function(t){for(var e,i=Array.prototype.slice.call(arguments,1),n=0,a=i.length;n<a;n++)for(var s in e=i[n]||{})e.hasOwnProperty(s)&&(t[s]=e[s]);return t},setOptions:function(t,e){t.options=VCO.Util.extend({},t.options,e),""===t.options.uniqueid&&(t.options.uniqueid=VCO.Util.unique_ID(6))},isEven:function(t){return t==parseFloat(t)?!(t%2):void 0},findArrayNumberByUniqueID:function(t,e,i){for(var n=0,a=0;a<e.length;a++)e[a].data[i]==t&&(n=a);return n},convertUnixTime:function(t){var e,i,n,a=[],s={ymd:"",time:"",time_array:[],date_array:[],full_array:[]};s.ymd=t.split(" ")[0],s.time=t.split(" ")[1],s.date_array=s.ymd.split("-"),s.time_array=s.time.split(":"),s.full_array=s.date_array.concat(s.time_array);for(var o=0;o<s.full_array.length;o++)a.push(parseInt(s.full_array[o]));return i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n=(e=new Date(a[0],a[1],a[2],a[3],a[4],a[5])).getFullYear(),i[e.getMonth()]+", "+e.getDate()+" "+n},setData:function(t,e){t.data=VCO.Util.extend({},t.data,e),""===t.data.uniqueid&&(t.data.uniqueid=VCO.Util.unique_ID(6))},mergeData:function(t,e){var i;for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},stamp:function(){var e=0,i="_vco_id";return function(t){return t[i]=t[i]||++e,t[i]}}(),isArray:function(){if(Array.isArray)return Array.isArray;var e=Object.prototype.toString,i=e.call([]);return function(t){return e.call(t)===i}}(),getRandomNumber:function(t){return Math.floor(Math.random()*t)},unique_ID:function(t,e){function n(){return"abcdefghijklmnopqurstuvwxyz".substr(Math.floor(32*Math.random()),1)}function i(t){for(var e="",i=0;i<t;i++)e+=n();return e}return e?e+"-"+i(t):"vco-"+i(t)},htmlify:function(t){return t.match(/<p>[\s\S]*?<\/p>/)?t:"<p>"+t+"</p>"},unlinkify:function(t){return t?t=(t=t.replace(/<a\b[^>]*>/i,"")).replace(/<\/a>/i,""):t},getParamString:function(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i+"="+t[i]);return"?"+e.join("&")},formatNum:function(t,e){var i=Math.pow(10,e||5);return Math.round(t*i)/i},falseFn:function(){return!1},requestAnimFrame:function(){function a(t){window.setTimeout(t,1e3/60)}var s=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||a;return function(t,e,i,n){t=e?VCO.Util.bind(t,e):t,i&&s===a?t():s(t,n)}}(),bind:function(t,e){return function(){return t.apply(e,arguments)}},template:function(t,n){return t.replace(/\{ *([\w_]+) *\}/g,function(t,e){var i=n[e];if(!n.hasOwnProperty(e))throw new Error("No value provided for variable "+t);return i})},hexToRgb:function(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(t,e,i,n){return e+e+i+i+n+n});var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null},ratio:{square:function(t){var e={w:0,h:0};return t.w>t.h&&0<t.h?(e.h=t.h,e.w=t.h):(e.w=t.w,e.h=t.w),e},r16_9:function(t){return null!==t.w&&""!==t.w?Math.round(t.w/16*9):null!==t.h&&""!==t.h?Math.round(t.h/9*16):0},r4_3:function(t){return null!==t.w&&""!==t.w?Math.round(t.w/4*3):null!==t.h&&""!==t.h?Math.round(t.h/3*4):void 0}},getObjectAttributeByIndex:function(t,e){if(void 0===t)return"";var i=0;for(var n in t){if(e===i)return t[n];i++}return""},getUrlVars:function(t){var e,i,n=[],a=t.toString();a.match("&#038;")?a=a.replace("&#038;","&"):a.match("&#38;")?a=a.replace("&#38;","&"):a.match("&amp;")&&(a=a.replace("&amp;","&")),i=a.slice(a.indexOf("?")+1).split("&");for(var s=0;s<i.length;s++)e=i[s].split("="),n.push(e[0]),n[e[0]]=e[1];return n},trim:function(t){return t.replace(/^\s+|\s+$/g,"")},slugify:function(t){t=(t=VCO.Util.trim(t)).toLowerCase();for(var e="ãàáäâẽèéëêìíïîõòóöôùúüûñç·/_,:;",i=0,n=e.length;i<n;i++)t=t.replace(new RegExp(e.charAt(i),"g"),"aaaaaeeeeeiiiiooooouuuunc------".charAt(i));return(t=t.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-")).replace(/^([0-9])/,"_$1")},maxDepth:function(t){for(var e=[],i=0,n=0;n<t.length;n++){if(e.push(t[n]),1<e.length){for(var a=e[e.length-1],s=-1,o=0;o<e.length-1;o++)e[o][1]<a[0]&&(s=o);0<=s&&(e=e.slice(s+1))}e.length>i&&(i=e.length)}return i},pad:function(t,e){for(t=String(t),e=e||2;t.length<e;)t="0"+t;return t}},function(t){var o,r,h,n,l,i,a,c,s,d,u,e,m,p,_,f,g,v,y,C,O,x,w,b,k,V,M,D,T,E,S,L=(c=(a=[]).slice,s=a.filter,d=window.document,u={},e={},m={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},p=/^\s*<(\w+|!)[^>]*>/,_=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,f=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,g=/^(?:body|html)$/i,v=/([A-Z])/g,y=["val","css","html","text","data","width","height","offset"],C=d.createElement("table"),O=d.createElement("tr"),x={tr:d.createElement("tbody"),tbody:C,thead:C,tfoot:C,td:O,th:O,"*":d.createElement("div")},w=/complete|loaded|interactive/,b=/^[\w-]*$/,V=(k={}).toString,M={},D=d.createElement("div"),T={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},E=Array.isArray||function(t){return t instanceof Array},M.matches=function(t,e){if(!e||!t||1!==t.nodeType)return!1;var i=t.webkitMatchesSelector||t.mozMatchesSelector||t.oMatchesSelector||t.matchesSelector;if(i)return i.call(t,e);var n,a=t.parentNode,s=!a;return s&&(a=D).appendChild(t),n=~M.qsa(a,e).indexOf(t),s&&D.removeChild(t),n},l=function(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})},i=function(i){return s.call(i,function(t,e){return i.indexOf(t)==e})},M.fragment=function(t,e,i){var n,a,s;return _.test(t)&&(n=h(d.createElement(RegExp.$1))),n||(t.replace&&(t=t.replace(f,"<$1></$2>")),e===o&&(e=p.test(t)&&RegExp.$1),e in x||(e="*"),(s=x[e]).innerHTML=""+t,n=h.each(c.call(s.childNodes),function(){s.removeChild(this)})),z(i)&&(a=h(n),h.each(i,function(t,e){-1<y.indexOf(t)?a[t](e):a.attr(t,e)})),n},M.Z=function(t,e){return(t=t||[]).__proto__=h.fn,t.selector=e||"",t},M.isZ=function(t){return t instanceof M.Z},M.init=function(t,e){var i,n;if(!t)return M.Z();if("string"==typeof t)if("<"==(t=t.trim())[0]&&p.test(t))i=M.fragment(t,RegExp.$1,e),t=null;else{if(e!==o)return h(e).find(t);i=M.qsa(d,t)}else{if(N(t))return h(d).ready(t);if(M.isZ(t))return t;if(E(t))n=t,i=s.call(n,function(t){return null!=t});else if(I(t))i=[t],t=null;else if(p.test(t))i=M.fragment(t.trim(),RegExp.$1,e),t=null;else{if(e!==o)return h(e).find(t);i=M.qsa(d,t)}}return M.Z(i,t)},(h=function(t,e){return M.init(t,e)}).extend=function(e){var i,t=c.call(arguments,1);return"boolean"==typeof e&&(i=e,e=t.shift()),t.forEach(function(t){!function t(e,i,n){for(r in i)n&&(z(i[r])||E(i[r]))?(z(i[r])&&!z(e[r])&&(e[r]={}),E(i[r])&&!E(e[r])&&(e[r]=[]),t(e[r],i[r],n)):i[r]!==o&&(e[r]=i[r])}(e,t,i)}),e},M.qsa=function(t,e){var i,n="#"==e[0],a=!n&&"."==e[0],s=n||a?e.slice(1):e,o=b.test(s);return P(t)&&o&&n?(i=t.getElementById(s))?[i]:[]:1!==t.nodeType&&9!==t.nodeType?[]:c.call(o&&!n?a?t.getElementsByClassName(s):t.getElementsByTagName(e):t.querySelectorAll(e))},h.contains=function(t,e){return t!==e&&t.contains(e)},h.type=A,h.isFunction=N,h.isWindow=j,h.isArray=E,h.isPlainObject=z,h.isEmptyObject=function(t){var e;for(e in t)return!1;return!0},h.inArray=function(t,e,i){return a.indexOf.call(e,t,i)},h.camelCase=l,h.trim=function(t){return null==t?"":String.prototype.trim.call(t)},h.uuid=0,h.support={},h.expr={},h.map=function(t,e){var i,n,a,s,o=[];if(B(t))for(n=0;n<t.length;n++)null!=(i=e(t[n],n))&&o.push(i);else for(a in t)null!=(i=e(t[a],a))&&o.push(i);return 0<(s=o).length?h.fn.concat.apply([],s):s},h.each=function(t,e){var i,n;if(B(t)){for(i=0;i<t.length;i++)if(!1===e.call(t[i],i,t[i]))return t}else for(n in t)if(!1===e.call(t[n],n,t[n]))return t;return t},h.grep=function(t,e){return s.call(t,e)},window.JSON&&(h.parseJSON=JSON.parse),h.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){k["[object "+e+"]"]=e.toLowerCase()}),h.fn={forEach:a.forEach,reduce:a.reduce,push:a.push,sort:a.sort,indexOf:a.indexOf,concat:a.concat,map:function(i){return h(h.map(this,function(t,e){return i.call(t,e,t)}))},slice:function(){return h(c.apply(this,arguments))},ready:function(t){return w.test(d.readyState)&&d.body?t(h):d.addEventListener("DOMContentLoaded",function(){t(h)},!1),this},get:function(t){return t===o?c.call(this):this[0<=t?t:t+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(i){return a.every.call(this,function(t,e){return!1!==i.call(t,e,t)}),this},filter:function(e){return N(e)?this.not(this.not(e)):h(s.call(this,function(t){return M.matches(t,e)}))},add:function(t,e){return h(i(this.concat(h(t,e))))},is:function(t){return 0<this.length&&M.matches(this[0],t)},not:function(e){var i,n=[];return N(e)&&e.call!==o?this.each(function(t){e.call(this,t)||n.push(this)}):(i="string"==typeof e?this.filter(e):B(e)&&N(e.item)?c.call(e):h(e),this.forEach(function(t){i.indexOf(t)<0&&n.push(t)})),h(n)},has:function(t){return this.filter(function(){return I(t)?h.contains(this,t):h(this).find(t).size()})},eq:function(t){return-1===t?this.slice(t):this.slice(t,+t+1)},first:function(){var t=this[0];return t&&!I(t)?t:h(t)},last:function(){var t=this[this.length-1];return t&&!I(t)?t:h(t)},find:function(t){var i=this;return"object"==typeof t?h(t).filter(function(){var e=this;return a.some.call(i,function(t){return h.contains(t,e)})}):1==this.length?h(M.qsa(this[0],t)):this.map(function(){return M.qsa(this,t)})},closest:function(t,e){var i=this[0],n=!1;for("object"==typeof t&&(n=h(t));i&&!(n?0<=n.indexOf(i):M.matches(i,t));)i=i!==e&&!P(i)&&i.parentNode;return h(i)},parents:function(t){for(var e=[],i=this;0<i.length;)i=h.map(i,function(t){return(t=t.parentNode)&&!P(t)&&e.indexOf(t)<0?(e.push(t),t):void 0});return F(e,t)},parent:function(t){return F(i(this.pluck("parentNode")),t)},children:function(t){return F(this.map(function(){return H(this)}),t)},contents:function(){return this.map(function(){return c.call(this.childNodes)})},siblings:function(t){return F(this.map(function(t,e){return s.call(H(e.parentNode),function(t){return t!==e})}),t)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(e){return h.map(this,function(t){return t[e]})},show:function(){return this.each(function(){var t,e,i;"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=(t=this.nodeName,u[t]||(e=d.createElement(t),d.body.appendChild(e),i=getComputedStyle(e,"").getPropertyValue("display"),e.parentNode.removeChild(e),"none"==i&&(i="block"),u[t]=i),u[t]))})},replaceWith:function(t){return this.before(t).remove()},wrap:function(e){var i,n,a=N(e);return this[0]&&!a&&(i=h(e).get(0),n=i.parentNode||1<this.length),this.each(function(t){h(this).wrapAll(a?e.call(this,t):n?i.cloneNode(!0):i)})},wrapAll:function(t){if(this[0]){h(this[0]).before(t=h(t));for(var e;(e=t.children()).length;)t=e.first();h(t).append(this)}return this},wrapInner:function(a){var s=N(a);return this.each(function(t){var e=h(this),i=e.contents(),n=s?a.call(this,t):a;i.length?i.wrapAll(n):e.append(n)})},unwrap:function(){return this.parent().each(function(){h(this).replaceWith(h(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(e){return this.each(function(){var t=h(this);(e===o?"none"==t.css("display"):e)?t.show():t.hide()})},prev:function(t){return h(this.pluck("previousElementSibling")).filter(t||"*")},next:function(t){return h(this.pluck("nextElementSibling")).filter(t||"*")},html:function(i){return 0===arguments.length?0<this.length?this[0].innerHTML:null:this.each(function(t){var e=this.innerHTML;h(this).empty().append(W(this,i,t,e))})},text:function(t){return 0===arguments.length?0<this.length?this[0].textContent:null:this.each(function(){this.textContent=t===o?"":""+t})},attr:function(e,i){var t;return"string"==typeof e&&i===o?0==this.length||1!==this[0].nodeType?o:"value"==e&&"INPUT"==this[0].nodeName?this.val():!(t=this[0].getAttribute(e))&&e in this[0]?this[0][e]:t:this.each(function(t){if(1===this.nodeType)if(I(e))for(r in e)$(this,r,e[r]);else $(this,e,W(this,i,t,this.getAttribute(e)))})},removeAttr:function(t){return this.each(function(){1===this.nodeType&&$(this,t)})},prop:function(e,i){return e=T[e]||e,i===o?this[0]&&this[0][e]:this.each(function(t){this[e]=W(this,i,t,this[e])})},data:function(t,e){var i=this.attr("data-"+t.replace(v,"-$1").toLowerCase(),e);return null!==i?Z(i):o},val:function(e){return 0===arguments.length?this[0]&&(this[0].multiple?h(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value):this.each(function(t){this.value=W(this,e,t,this.value)})},offset:function(s){if(s)return this.each(function(t){var e=h(this),i=W(this,s,t,e.offset()),n=e.offsetParent().offset(),a={top:i.top-n.top,left:i.left-n.left};"static"==e.css("position")&&(a.position="relative"),e.css(a)});if(0==this.length)return null;var t=this[0].getBoundingClientRect();return{left:t.left+window.pageXOffset,top:t.top+window.pageYOffset,width:Math.round(t.width),height:Math.round(t.height)}},css:function(t,e){if(arguments.length<2){var i=this[0],n=getComputedStyle(i,"");if(!i)return;if("string"==typeof t)return i.style[l(t)]||n.getPropertyValue(t);if(E(t)){var a={};return h.each(E(t)?t:[t],function(t,e){a[e]=i.style[l(e)]||n.getPropertyValue(e)}),a}}var s="";if("string"==A(t))e||0===e?s=U(t)+":"+R(t,e):this.each(function(){this.style.removeProperty(U(t))});else for(r in t)t[r]||0===t[r]?s+=U(r)+":"+R(r,t[r])+";":this.each(function(){this.style.removeProperty(U(r))});return this.each(function(){this.style.cssText+=";"+s})},index:function(t){return t?this.indexOf(h(t)[0]):this.parent().children().indexOf(this[0])},hasClass:function(t){return!!t&&a.some.call(this,function(t){return this.test(Y(t))},q(t))},addClass:function(i){return i?this.each(function(t){n=[];var e=Y(this);W(this,i,t,e).split(/\s+/g).forEach(function(t){h(this).hasClass(t)||n.push(t)},this),n.length&&Y(this,e+(e?" ":"")+n.join(" "))}):this},removeClass:function(e){return this.each(function(t){return e===o?Y(this,""):(n=Y(this),W(this,e,t,n).split(/\s+/g).forEach(function(t){n=n.replace(q(t)," ")}),void Y(this,n.trim()))})},toggleClass:function(i,n){return i?this.each(function(t){var e=h(this);W(this,i,t,Y(this)).split(/\s+/g).forEach(function(t){(n===o?!e.hasClass(t):n)?e.addClass(t):e.removeClass(t)})}):this},scrollTop:function(t){if(this.length){var e="scrollTop"in this[0];return t===o?e?this[0].scrollTop:this[0].pageYOffset:this.each(e?function(){this.scrollTop=t}:function(){this.scrollTo(this.scrollX,t)})}},scrollLeft:function(t){if(this.length){var e="scrollLeft"in this[0];return t===o?e?this[0].scrollLeft:this[0].pageXOffset:this.each(e?function(){this.scrollLeft=t}:function(){this.scrollTo(t,this.scrollY)})}},position:function(){if(this.length){var t=this[0],e=this.offsetParent(),i=this.offset(),n=g.test(e[0].nodeName)?{top:0,left:0}:e.offset();return i.top-=parseFloat(h(t).css("margin-top"))||0,i.left-=parseFloat(h(t).css("margin-left"))||0,n.top+=parseFloat(h(e[0]).css("border-top-width"))||0,n.left+=parseFloat(h(e[0]).css("border-left-width"))||0,{top:i.top-n.top,left:i.left-n.left}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||d.body;t&&!g.test(t.nodeName)&&"static"==h(t).css("position");)t=t.offsetParent;return t})}},h.fn.detach=h.fn.remove,["width","height"].forEach(function(n){var a=n.replace(/./,function(t){return t[0].toUpperCase()});h.fn[n]=function(e){var t,i=this[0];return e===o?j(i)?i["inner"+a]:P(i)?i.documentElement["scroll"+a]:(t=this.offset())&&t[n]:this.each(function(t){(i=h(this)).css(n,W(this,e,t,i[n]()))})}}),["after","prepend","before","append"].forEach(function(e,s){var o=s%2;h.fn[e]=function(){var e,i,n=h.map(arguments,function(t){return"object"==(e=A(t))||"array"==e||null==t?t:M.fragment(t)}),a=1<this.length;return n.length<1?this:this.each(function(t,e){i=o?e:e.parentNode,e=0==s?e.nextSibling:1==s?e.firstChild:2==s?e:null,n.forEach(function(t){if(a)t=t.cloneNode(!0);else if(!i)return h(t).remove();!function t(e,i){for(var n in i(e),e.childNodes)t(e.childNodes[n],i)}(i.insertBefore(t,e),function(t){null==t.nodeName||"SCRIPT"!==t.nodeName.toUpperCase()||t.type&&"text/javascript"!==t.type||t.src||window.eval.call(window,t.innerHTML)})})})},h.fn[o?e+"To":"insert"+(s?"Before":"After")]=function(t){return h(t)[e](this),this}}),M.Z.prototype=h.fn,M.uniq=i,M.deserializeValue=Z,h.zepto=M,h);function A(t){return null==t?String(t):k[V.call(t)]||"object"}function N(t){return"function"==A(t)}function j(t){return null!=t&&t==t.window}function P(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE}function I(t){return"object"==A(t)}function z(t){return I(t)&&!j(t)&&Object.getPrototypeOf(t)==Object.prototype}function B(t){return"number"==typeof t.length}function U(t){return t.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function q(t){return t in e?e[t]:e[t]=new RegExp("(^|\\s)"+t+"(\\s|$)")}function R(t,e){return"number"!=typeof e||m[U(t)]?e:e+"px"}function H(t){return"children"in t?c.call(t.children):h.map(t.childNodes,function(t){return 1==t.nodeType?t:void 0})}function F(t,e){return null==e?h(t):h(t).filter(e)}function W(t,e,i,n){return N(e)?e.call(t,i,n):e}function $(t,e,i){null==i?t.removeAttribute(e):t.setAttribute(e,i)}function Y(t,e){var i=t.className,n=i&&i.baseVal!==o;return e===o?n?i.baseVal:i:void(n?i.baseVal=e:t.className=e)}function Z(e){var t;try{return e?"true"==e||"false"!=e&&("null"==e?null:/^0/.test(e)||isNaN(t=Number(e))?/^[\[\{]/.test(e)?h.parseJSON(e):e:t):e}catch(t){return e}}window.Zepto=L,void 0===window.$&&(window.$=L),function(c){function d(t){return t._zid||(t._zid=e++)}function o(t,e,i,n){var a,s;return(e=u(e)).ns&&(s=e.ns,a=new RegExp("(?:^| )"+s.replace(" "," .* ?")+"(?: |$)")),(x[d(t)]||[]).filter(function(t){return!(!t||e.e&&t.e!=e.e||e.ns&&!a.test(t.ns)||i&&d(t.fn)!==d(i)||n&&t.sel!=n)})}function u(t){var e=(""+t).split(".");return{e:e[0],ns:e.slice(1).sort().join(" ")}}function m(t,e){return t.del&&!i&&t.e in n||!!e}function p(t){return w[t]||i&&n[t]||t}function l(a,t,e,s,o,r,h){var i=d(a),l=x[i]||(x[i]=[]);t.split(/\s/).forEach(function(t){if("ready"==t)return c(document).ready(e);var i=u(t);i.fn=e,i.sel=o,i.e in w&&(e=function(t){var e=t.relatedTarget;return!e||e!==this&&!c.contains(this,e)?i.fn.apply(this,arguments):void 0});var n=(i.del=r)||e;i.proxy=function(t){if(!(t=f(t)).isImmediatePropagationStopped()){t.data=s;var e=n.apply(a,t._args==y?[t]:[t].concat(t._args));return!1===e&&(t.preventDefault(),t.stopPropagation()),e}},i.i=l.length,l.push(i),"addEventListener"in a&&a.addEventListener(p(i.e),i.proxy,m(i,h))})}function _(e,t,i,n,a){var s=d(e);(t||"").split(/\s/).forEach(function(t){o(e,t,i,n).forEach(function(t){delete x[s][t.i],"removeEventListener"in e&&e.removeEventListener(p(t.e),t.proxy,m(t,a))})})}function f(n,a){return!a&&n.isDefaultPrevented||(a=a||n,c.each(t,function(t,e){var i=a[t];n[t]=function(){return this[e]=r,i&&i.apply(a,arguments)},n[e]=b}),(a.defaultPrevented!==y?a.defaultPrevented:"returnValue"in a?!1===a.returnValue:a.getPreventDefault&&a.getPreventDefault())&&(n.isDefaultPrevented=r)),n}function g(t){var e,i={originalEvent:t};for(e in t)a.test(e)||t[e]===y||(i[e]=t[e]);return f(i,t)}c.zepto.qsa;function v(t){return"string"==typeof t}var y,e=1,C=Array.prototype.slice,O=c.isFunction,x={},s={},i="onfocusin"in window,n={focus:"focusin",blur:"focusout"},w={mouseenter:"mouseover",mouseleave:"mouseout"};s.click=s.mousedown=s.mouseup=s.mousemove="MouseEvents",c.event={add:l,remove:_},c.proxy=function(t,e){if(O(t)){function i(){return t.apply(e,arguments)}return i._zid=d(t),i}if(v(e))return c.proxy(t[e],t);throw new TypeError("expected function")},c.fn.bind=function(t,e,i){return this.on(t,e,i)},c.fn.unbind=function(t,e){return this.off(t,e)},c.fn.one=function(t,e,i,n){return this.on(t,e,i,n,1)};var r=function(){return!0},b=function(){return!1},a=/^([A-Z]|returnValue$|layer[XY]$)/,t={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};c.fn.delegate=function(t,e,i){return this.on(e,t,i)},c.fn.undelegate=function(t,e,i){return this.off(e,t,i)},c.fn.live=function(t,e){return c(document.body).delegate(this.selector,t,e),this},c.fn.die=function(t,e){return c(document.body).undelegate(this.selector,t,e),this},c.fn.on=function(e,a,i,s,o){var r,h,n=this;return e&&!v(e)?(c.each(e,function(t,e){n.on(t,a,i,e,o)}),n):(v(a)||O(s)||!1===s||(s=i,i=a,a=y),!O(i)&&!1!==i||(s=i,i=y),!1===s&&(s=b),n.each(function(t,n){o&&(r=function(t){return _(n,t.type,s),s.apply(this,arguments)}),a&&(h=function(t){var e,i=c(t.target).closest(a,n).get(0);return i&&i!==n?(e=c.extend(g(t),{currentTarget:i,liveFired:n}),(r||s).apply(i,[e].concat(C.call(arguments,1)))):void 0}),l(n,e,s,i,a,h||r)}))},c.fn.off=function(t,i,e){var n=this;return t&&!v(t)?(c.each(t,function(t,e){n.off(t,i,e)}),n):(v(i)||O(e)||!1===e||(e=i,i=y),!1===e&&(e=b),n.each(function(){_(this,t,e,i)}))},c.fn.trigger=function(t,e){return(t=v(t)||c.isPlainObject(t)?c.Event(t):f(t))._args=e,this.each(function(){"dispatchEvent"in this?this.dispatchEvent(t):c(this).triggerHandler(t,e)})},c.fn.triggerHandler=function(i,n){var a,s;return this.each(function(t,e){(a=g(v(i)?c.Event(i):i))._args=n,a.target=e,c.each(o(e,i.type||i),function(t,e){return s=e.proxy(a),!a.isImmediatePropagationStopped()&&void 0})}),s},"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(e){c.fn[e]=function(t){return t?this.bind(e,t):this.trigger(e)}}),["focus","blur"].forEach(function(e){c.fn[e]=function(t){return t?this.bind(e,t):this.each(function(){try{this[e]()}catch(t){}}),this}}),c.Event=function(t,e){v(t)||(t=(e=t).type);var i=document.createEvent(s[t]||"Events"),n=!0;if(e)for(var a in e)"bubbles"==a?n=!!e[a]:i[a]=e[a];return i.initEvent(t,n,!0),f(i)}}(L),function(_){function f(t,e,i,n){return t.global?(a=e||d,s=i,o=n,r=_.Event(s),_(a).trigger(r,o),!r.isDefaultPrevented()):void 0;var a,s,o,r}function g(t,e){var i=e.context;return!1!==e.beforeSend.call(i,t,e)&&!1!==f(e,i,"ajaxBeforeSend",[t,e])&&void f(e,i,"ajaxSend",[t,e])}function v(t,e,i,n){var a=i.context,s="success";i.success.call(a,t,s,e),n&&n.resolveWith(a,[t,s,e]),f(i,a,"ajaxSuccess",[e,i,t]),o(s,e,i)}function y(t,e,i,n,a){var s=n.context;n.error.call(s,i,e,t),a&&a.rejectWith(s,[i,e,t]),f(n,s,"ajaxError",[i,n,t||e]),o(e,i,n)}function o(t,e,i){var n,a=i.context;i.complete.call(a,e,t),f(i,a,"ajaxComplete",[e,i]),(n=i).global&&!--_.active&&f(n,null,"ajaxStop")}function C(){}function O(t,e){return""==e?t:(t+"&"+e).replace(/[&?]{1,2}/,"?")}function h(t,e,i,n){var a=!_.isFunction(e);return{url:t,data:a?e:void 0,success:a?_.isFunction(i)?i:void 0:e,dataType:a&&n||i}}var x,w,c=0,d=window.document,l=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,b=/^(?:text|application)\/javascript/i,k=/^(?:text|application)\/xml/i,V="application/json",M="text/html",D=/^\s*$/;_.active=0,_.ajaxJSONP=function(i,n){if(!("type"in i))return _.ajax(i);function t(t){_(r).triggerHandler("error",t||"abort")}var a,s,e=i.jsonpCallback,o=(_.isFunction(e)?e():e)||"jsonp"+ ++c,r=d.createElement("script"),h=window[o],l={abort:t};return n&&n.promise(l),_(r).on("load error",function(t,e){clearTimeout(s),_(r).off().remove(),"error"!=t.type&&a?v(a[0],l,i,n):y(null,e||"error",l,i,n),window[o]=h,a&&_.isFunction(h)&&h(a[0]),h=a=void 0}),!1===g(l,i)?t("abort"):(window[o]=function(){a=arguments},r.src=i.url.replace(/\?(.+)=\?/,"?$1="+o),d.head.appendChild(r),0<i.timeout&&(s=setTimeout(function(){t("timeout")},i.timeout))),l},_.ajaxSettings={type:"GET",beforeSend:C,success:C,error:C,complete:C,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:V,xml:"application/xml, text/xml",html:M,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0},_.ajax=function(t){var e,i,n=_.extend({},t||{}),a=_.Deferred&&_.Deferred();for(x in _.ajaxSettings)void 0===n[x]&&(n[x]=_.ajaxSettings[x]);(i=n).global&&0==_.active++&&f(i,null,"ajaxStart"),n.crossDomain||(n.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(n.url)&&RegExp.$2!=window.location.host),n.url||(n.url=window.location.toString()),(e=n).processData&&e.data&&"string"!=_.type(e.data)&&(e.data=_.param(e.data,e.traditional)),!e.data||e.type&&"GET"!=e.type.toUpperCase()||(e.url=O(e.url,e.data),e.data=void 0),!1===n.cache&&(n.url=O(n.url,"_="+Date.now()));var s=n.dataType,o=/\?.+=\?/.test(n.url);if("jsonp"==s||o)return o||(n.url=O(n.url,n.jsonp?n.jsonp+"=?":!1===n.jsonp?"":"callback=?")),_.ajaxJSONP(n,a);function r(t,e){c[t.toLowerCase()]=[t,e]}var h,l=n.accepts[s],c={},d=/^([\w-]+:)\/\//.test(n.url)?RegExp.$1:window.location.protocol,u=n.xhr(),m=u.setRequestHeader;if(a&&a.promise(u),n.crossDomain||r("X-Requested-With","XMLHttpRequest"),r("Accept",l||"*/*"),(l=n.mimeType||l)&&(-1<l.indexOf(",")&&(l=l.split(",",2)[0]),u.overrideMimeType&&u.overrideMimeType(l)),(n.contentType||!1!==n.contentType&&n.data&&"GET"!=n.type.toUpperCase())&&r("Content-Type",n.contentType||"application/x-www-form-urlencoded"),n.headers)for(w in n.headers)r(w,n.headers[w]);if(u.setRequestHeader=r,!(u.onreadystatechange=function(){if(4==u.readyState){u.onreadystatechange=C,clearTimeout(h);var t,e=!1;if(200<=u.status&&u.status<300||304==u.status||0==u.status&&"file:"==d){s=s||((i=(i=n.mimeType||u.getResponseHeader("content-type"))&&i.split(";",2)[0])&&(i==M?"html":i==V?"json":b.test(i)?"script":k.test(i)&&"xml")||"text"),t=u.responseText;try{"script"==s?(0,eval)(t):"xml"==s?t=u.responseXML:"json"==s&&(t=D.test(t)?null:_.parseJSON(t))}catch(t){e=t}e?y(e,"parsererror",u,n,a):v(t,u,n,a)}else y(u.statusText||null,u.status?"error":"abort",u,n,a)}var i})===g(u,n))return u.abort(),y(null,"abort",u,n,a),u;if(n.xhrFields)for(w in n.xhrFields)u[w]=n.xhrFields[w];var p=!("async"in n)||n.async;for(w in u.open(n.type,n.url,p,n.username,n.password),c)m.apply(u,c[w]);return 0<n.timeout&&(h=setTimeout(function(){u.onreadystatechange=C,u.abort(),y(null,"timeout",u,n,a)},n.timeout)),u.send(n.data?n.data:null),u},_.get=function(t,e,i,n){return _.ajax(h.apply(null,arguments))},_.post=function(t,e,i,n){var a=h.apply(null,arguments);return a.type="POST",_.ajax(a)},_.getJSON=function(t,e,i){var n=h.apply(null,arguments);return n.dataType="json",_.ajax(n)},_.fn.load=function(t,e,i){if(!this.length)return this;var n,a=this,s=t.split(/\s/),o=h(t,e,i),r=o.success;return 1<s.length&&(o.url=s[0],n=s[1]),o.success=function(t){a.html(n?_("<div>").html(t.replace(l,"")).find(n):t),r&&r.apply(a,arguments)},_.ajax(o),this};var n=encodeURIComponent;_.param=function(t,e){var i=[];return i.add=function(t,e){this.push(n(t)+"="+n(e))},function i(n,t,a,s){var o,r=_.isArray(t),h=_.isPlainObject(t);_.each(t,function(t,e){o=_.type(e),s&&(t=a?s:s+"["+(h||"object"==o||"array"==o?t:"")+"]"),!s&&r?n.add(e.name,e.value):"array"==o||!a&&"object"==o?i(n,e,a,t):n.add(t,e)})}(i,t,e),i.join("&").replace(/%20/g,"+")}}(L),(S=L).fn.serializeArray=function(){var e,i=[];return S([].slice.call(this.get(0).elements)).each(function(){var t=(e=S(this)).attr("type");"fieldset"!=this.nodeName.toLowerCase()&&!this.disabled&&"submit"!=t&&"reset"!=t&&"button"!=t&&("radio"!=t&&"checkbox"!=t||this.checked)&&i.push({name:e.attr("name"),value:e.val()})}),i},S.fn.serialize=function(){var e=[];return this.serializeArray().forEach(function(t){e.push(encodeURIComponent(t.name)+"="+encodeURIComponent(t.value))}),e.join("&")},S.fn.submit=function(t){var e;return t?this.bind("submit",t):this.length&&(e=S.Event("submit"),this.eq(0).trigger(e),e.isDefaultPrevented()||this.get(0).submit()),this},function(i){"__proto__"in{}||i.extend(i.zepto,{Z:function(t,e){return t=t||[],i.extend(t,i.fn),t.selector=e||"",t.__Z=!0,t},isZ:function(t){return"array"===i.type(t)&&"__Z"in t}});try{getComputedStyle(void 0)}catch(t){var e=getComputedStyle;window.getComputedStyle=function(t){try{return e(t)}catch(t){return null}}}}(L),t.getJSON=L.getJSON,t.ajax=L.ajax}(VCO),VCO.Class=function(){},VCO.Class.extend=function(t){function e(){this.initialize&&this.initialize.apply(this,arguments)}function i(){}i.prototype=this.prototype;var n=new i;for(var a in(n.constructor=e).prototype=n,e.superclass=this.prototype,this)this.hasOwnProperty(a)&&"prototype"!==a&&"superclass"!==a&&(e[a]=this[a]);return t.statics&&(VCO.Util.extend(e,t.statics),delete t.statics),t.includes&&(VCO.Util.extend.apply(null,[n].concat(t.includes)),delete t.includes),t.options&&n.options&&(t.options=VCO.Util.extend({},n.options,t.options)),VCO.Util.extend(n,t),e.extend=VCO.Class.extend,e.include=function(t){VCO.Util.extend(this.prototype,t)},e},VCO.Events={addEventListener:function(t,e,i){var n=this._vco_events=this._vco_events||{};return n[t]=n[t]||[],n[t].push({action:e,context:i||this}),this},hasEventListeners:function(t){var e="_vco_events";return e in this&&t in this[e]&&0<this[e][t].length},removeEventListener:function(t,e,i){if(!this.hasEventListeners(t))return this;for(var n=0,a=this._vco_events,s=a[t].length;n<s;n++)if(a[t][n].action===e&&(!i||a[t][n].context===i))return a[t].splice(n,1),this;return this},fireEvent:function(t,e){if(!this.hasEventListeners(t))return this;for(var i=VCO.Util.extend({type:t,target:this},e),n=this._vco_events[t].slice(),a=0,s=n.length;a<s;a++)n[a].action.call(n[a].context||this,i);return this}},VCO.Events.on=VCO.Events.addEventListener,VCO.Events.off=VCO.Events.removeEventListener,VCO.Events.fire=VCO.Events.fireEvent,function(){var t,e=navigator.userAgent.toLowerCase(),i=document.documentElement,n="ActiveXObject"in window,a=-1!==e.indexOf("webkit"),s=-1!==e.indexOf("phantom"),o=-1!==e.search("android [23]"),r="undefined"!=typeof orientation,h=navigator.msPointerEnabled&&navigator.msMaxTouchPoints&&!window.PointerEvent,l=window.PointerEvent&&navigator.pointerEnabled&&navigator.maxTouchPoints||h,c=n&&"transition"in i.style,d="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!o,u="MozPerspective"in i.style,m="OTransition"in i.style,p=(window.opera,"devicePixelRatio"in window&&1<window.devicePixelRatio);!p&&"matchMedia"in window&&(p=(t=window.matchMedia("(min-resolution:144dpi)"))&&t.matches);var _=!window.L_NO_TOUCH&&!s&&(l||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch);VCO.Browser={ie:n,ielt9:n&&!document.addEventListener,webkit:a,firefox:-1!==e.indexOf("gecko")&&!a&&!window.opera&&!n,android:-1!==e.indexOf("android"),android23:o,chrome:-1!==e.indexOf("chrome"),ie3d:c,webkit3d:d,gecko3d:u,opera3d:m,any3d:!window.L_DISABLE_3D&&(c||d||u||m)&&!s,mobile:r,mobileWebkit:r&&a,mobileWebkit3d:r&&d,mobileOpera:r&&window.opera,touch:!!_,msPointer:!!h,pointer:!!l,retina:!!p,orientation:function(){var t=window.innerWidth,e=window.innerHeight<t?"landscape":"portrait";return Math.abs(window.orientation),trace(e),e}}}(),VCO.Load=function(){function a(t){for(var e=0,i=!1,e=0;e<n.length;e++)n[e]==t&&(i=!0);return i||(n.push(t),0)}var n=[];return{css:function(t,e,i,n){a(t)?e():VCO.LoadIt.css(t,e,i,n)},js:function(t,e,i,n){a(t)?e():VCO.LoadIt.js(t,e,i,n)}}}(this.document),VCO.LoadIt=function(_){function f(t,e){var i,n=_.createElement(t);for(i in e)e.hasOwnProperty(i)&&n.setAttribute(i,e[i]);return n}function g(t){var e,i,n=x[t];n&&(e=n.callback,(i=n.urls).shift(),s=0,i.length||(e&&e.call(n.context,n.obj),x[t]=null,w[t].length&&a(t)))}function a(t,e,i,n,a){function s(){g(t)}var o,r,h,l,c,d,u,m="css"===t,p=[];if(C||(u=navigator.userAgent,((C={async:!0===_.createElement("script").async}).webkit=/AppleWebKit\//.test(u))||(C.ie=/MSIE/.test(u))||(C.opera=/Opera/.test(u))||(C.gecko=/Gecko\//.test(u))||(C.unknown=!0)),e)if(e="string"==typeof e?[e]:e.concat(),m||C.async||C.gecko||C.opera)w[t].push({urls:e,callback:i,obj:n,context:a});else for(o=0,r=e.length;o<r;++o)w[t].push({urls:[e[o]],callback:o===r-1?i:null,obj:n,context:a});if(!x[t]&&(l=x[t]=w[t].shift())){for(O=O||(_.head||_.getElementsByTagName("head")[0]),o=0,r=(c=l.urls).length;o<r;++o)d=c[o],m?h=C.gecko?f("style"):f("link",{href:d,rel:"stylesheet"}):(h=f("script",{src:d})).async=!1,h.className="lazyload",h.setAttribute("charset","utf-8"),C.ie&&!m?h.onreadystatechange=function(){/loaded|complete/.test(h.readyState)&&(h.onreadystatechange=null,s())}:m&&(C.gecko||C.webkit)?C.webkit?(l.urls[o]=h.href,y()):(h.innerHTML='@import "'+d+'";',v(h)):h.onload=h.onerror=s,p.push(h);for(o=0,r=p.length;o<r;++o)O.appendChild(p[o])}}function v(e){var i;try{i=!!e.sheet.cssRules}catch(t){return void((s+=1)<200?setTimeout(function(){v(e)},50):i&&g("css"))}g("css")}function y(){var t,e=x.css;if(e){for(t=i.length;0<=--t;)if(i[t].href===e.urls[0]){g("css");break}s+=1,e&&(s<200?setTimeout(y,50):g("css"))}}var C,O,x={},s=0,w={css:[],js:[]},i=_.styleSheets;return{css:function(t,e,i,n){a("css",t,e,i,n)},js:function(t,e,i,n){a("js",t,e,i,n)}}}(this.document),VCO.TimelineConfig=VCO.Class.extend({VALID_PROPERTIES:["scale","slides"],initialize:function(t,e){if("string"==typeof t){var i=this;VCO.ajax({type:"GET",url:t,dataType:"json",success:function(t){if(!t||!t.timeline)throw"data must have a timeline property";i._importProperties(t.timeline),i._cleanData(),e&&e(i)},error:function(t,e){throw trace(t),trace(e),"Configuration could not be loaded: "+e}})}else{if("object"!=typeof t)throw"Invalid Argument";if(!t.timeline)throw"data must have a timeline property";this._importProperties(t.timeline),this._cleanData(),e&&e(this)}},_cleanData:function(){this._makeUniqueIdentifiers(this.slides),this._processDates(this.slides),VCO.DateUtil.sortByDate(this.slides)},_importProperties:function(t){for(var e=0;e<this.VALID_PROPERTIES.length;e++)k=this.VALID_PROPERTIES[e],this[k]=t[k]},_makeUniqueIdentifiers:function(t){for(var e,i=[],n=0;n<t.length;n++)t[n].uniqueid&&0<t[n].uniqueid.replace(/\s+/,"").length&&(t[n].uniqueid=VCO.Util.slugify(t[n].uniqueid),-1!=i.indexOf(t[n].uniqueid)?t[n].uniqueid="":i.push(t[n].uniqueid));if(i.length!=t.length)for(n=0;n<t.length;n++){t[n].uniqueid||(e=(e=t[n].text?VCO.Util.slugify(t[n].text.headline):null)||VCO.Util.unique_ID(6),-1!=i.indexOf(e)&&(e=e+"-"+n),i.push(e),t[n].uniqueid=e)}},_processDates:function(t){var e=null;if(!this.scale){trace("Determining scale dynamically"),this.scale="javascript";for(var i=0;i<t.length;i++){if(void 0===t[i].start_date)throw"item "+i+" is missing a start_date";var n=new VCO.BigDate(t[i].start_date).data.date_obj.year;if(n<-271820||275759<n){this.scale="cosmological";break}}}if("javascript"==this.scale)e=VCO.Date,trace("using VCO.Date");else{if("cosmological"!=this.scale)throw"Don't know how to process dates on scale "+this.scale;e=VCO.BigDate,trace("using VCO.BigDate")}for(i=0;i<t.length;i++){if(void 0===t[i].start_date)throw"item "+i+" is missing a start_date";t[i].start_date=new e(t[i].start_date),void 0!==t[i].end_date&&(t[i].end_date=new e(t[i].end_date))}}}),function(a){function s(t){var e={};for(k in t)0==k.indexOf("gsx$")&&(e[k.substr(4)]=t[k].$t);if(!e.startdate)throw"All items must have a start date column.";var i={media:{caption:e.mediacaption||"",credit:e.mediacredit||"",url:e.media||"",thumb:""},text:{headline:e.headline||"",text:e.text||""}};return i.start_date=a.Date.parseDate(e.startdate),t.enddate&&(i.end_date=a.Date.parseDate(t.enddate)),i}a.ConfigFactory={fromGoogle:function(t){t="https://spreadsheets.google.com/feeds/list/"+function(t){var e=/\bkey=([_A-Za-z0-9]+)&?/i;if(t.match(e))return t.match(e)[1];var i,n=null;return t.match("docs.google.com/spreadsheets/d/")&&(i=t.indexOf("docs.google.com/spreadsheets/d/")+"docs.google.com/spreadsheets/d/".length,n=t.substr(i).split("/")[0]),n=n||t}(t)+"/od6/public/values?alt=json";var e=a.ajax({url:t,async:!1}),i=[],e=JSON.parse(e.responseText);window.google_data=e;for(var n=0;n<e.feed.entry.length;n++)i.push(s(e.feed.entry[n]));return{scale:"javascript",timeline:{slides:i}}}}}(VCO),VCO.Language=function(t){for(k in VCO.Language.languages.en)this[k]=VCO.Language.languages.en[k];if(t&&t.language&&"string"==typeof t.language&&"en"!=t.language){var e,i,n,a=t.language;if(!(a in VCO.Language.languages)){n=/\.json$/.test(a)?a:(e="/locale/"+a+".json",i=t.script_path||"",/\/$/.test(i)&&(e=e.substr(1)),i+e);var s=VCO.ajax({url:n,async:!1});if(200!=s.status)throw"Could not load language ["+a+"]: "+s.statusText;VCO.Language.languages[a]=JSON.parse(s.responseText)}VCO.Util.mergeData(this,VCO.Language.languages[a])}},VCO.Language.formatNumber=function(t,e){if(e.match(/%(\.(\d+))?f/)){var i=e.match(/%(\.(\d+))?f/),n=i[0];return i[2]&&(t=t.toFixed(i[2])),e.replace(n,t)}return e},VCO.Language.prototype.mergeData=function(t){for(k in VCO.Language.languages.en)t[k]&&("object"==typeof this[k]?VCO.Util.mergeData(t[k],this[k]):this[k]=t[k])},VCO.Language.fallback={messages:{}},VCO.Language.prototype.getMessage=function(t){return this.messages[t]||VCO.Language.fallback.messages[t]||t},VCO.Language.prototype._=VCO.Language.prototype.getMessage,VCO.Language.prototype.formatDate=function(t,e){return t.constructor==Date?this.formatJSDate(t,e):t.constructor==VCO.BigYear?this.formatBigYear(t,e):t.data&&t.data.date_obj?this.formatDate(t.data.date_obj,e):(trace("Unfamiliar date presented for formatting"),t.toString())},VCO.Language.prototype.formatBigYear=function(t,e){var i=t.year,n=this.bigdateformats[e]||this.bigdateformats.fallback;if(n){for(var a=0;a<n.length;a++){var s=n[a];if(1<Math.abs(i/s[0]))return VCO.Language.formatNumber(Math.abs(i/s[0]),s[1])}return i.toString()}return trace("Language file dateformats missing cosmological. Falling back."),VCO.Language.formatNumber(i,e)},VCO.Language.prototype.formatJSDate=function(t,e){e=e||"full";var i=(i=this.dateformats[e]||VCO.Language.fallback.dateformats[e])||e,n=t.getDate(),a=t.getDay(),s=t.getMonth(),o=t.getFullYear(),r=t.getHours(),h=t.getMinutes(),l=t.getSeconds(),c=t.getMilliseconds(),d=t.getTimezoneOffset(),u={d:n,dd:VCO.Util.pad(n),ddd:this.date.day_abbr[a],dddd:this.date.day[a],m:s+1,mm:VCO.Util.pad(s+1),mmm:this.date.month_abbr[s],mmmm:this.date.month[s],yy:String(o).slice(2),yyyy:this.use_bc&&o<0?Math.abs(o)+" "+this.use_bc:o,h:r%12||12,hh:VCO.Util.pad(r%12||12),H:r,HH:VCO.Util.pad(r),M:h,MM:VCO.Util.pad(h),s:l,ss:VCO.Util.pad(l),l:VCO.Util.pad(c,3),L:VCO.Util.pad(99<c?Math.round(c/10):c),t:r<12?"a":"p",tt:r<12?"am":"pm",T:r<12?"A":"P",TT:r<12?"AM":"PM",Z:(String(t).match(/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g)||[""]).pop().replace(/[^-+\dA-Z]/g,""),o:(0<d?"-":"+")+VCO.Util.pad(100*Math.floor(Math.abs(d)/60)+Math.abs(d)%60,4),S:["th","st","nd","rd"][3<n%10?0:(n%100-n%10!=10)*n%10]};return i.replace(VCO.Language.DATE_FORMAT_TOKENS,function(t){return t in u?u[t]:t.slice(1,t.length-1)})},VCO.Language.DATE_FORMAT_TOKENS=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,VCO.Language.languages={en:{name:"English",lang:"en",messages:{loading:"Loading",wikipedia:"From Wikipedia, the free encyclopedia"},date:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],month_abbr:["Jan.","Feb.","March","April","May","June","July","Aug.","Sept.","Oct.","Nov.","Dec."],day:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],day_abbr:["Sun.","Mon.","Tues.","Wed.","Thurs.","Fri.","Sat."]},dateformats:{year:"yyyy",month_short:"mmm",month:"mmmm yyyy",full_short:"mmm d",full:"mmmm d',' yyyy",time:"h:MM:ss TT' <small>'mmmm d',' yyyy'</small>'",time_short:"h:MM:ss TT",time_no_seconds_short:"h:MM TT",time_no_minutes_short:"h TT",time_no_seconds_small_date:"h:MM TT' <small>'mmmm d',' yyyy'</small>'",full_long:"mmm d',' yyyy 'at' h:MM TT",full_long_small_date:"h:MM TT' <small>mmm d',' yyyy'</small>'"},bigdateformats:{fallback:[[1e9,"%.2f billion years ago"],[1e6,"%.1f million years ago"],[1e3,"%.1f thousand years ago"],[1,"%f years ago"]],compact:[[1e9,"%.2f bya"],[1e6,"%.1f mya"],[1e3,"%.1f kya"],[1,"%f years ago"]],verbose:[[1e9,"%.2f billion years ago"],[1e6,"%.1f million years ago"],[1e3,"%.1f thousand years ago"],[1,"%f years ago"]]}}},VCO.Language.fallback=new VCO.Language,VCO.I18NMixins={getLanguage:function(){return this.options&&this.options.language?this.options.language:(trace("Expected a language option"),VCO.Language.fallback)},_:function(t){return this.getLanguage()._(t)}},VCO.Easings={ease:[.25,.1,.25,1],linear:[0,0,1,1],easein:[.42,0,1,1],easeout:[0,0,.58,1],easeinout:[.42,0,.58,1]},VCO.Ease={KeySpline:function(r){function h(t,e){return 1-3*e+3*t}function l(t,e){return 3*e-6*t}function c(t,e,i){return((h(e,i)*t+l(e,i))*t+3*e)*t}this.get=function(t){return r[0]==r[1]&&r[2]==r[3]?t:c(function(t){for(var e,i,n,a=t,s=0;s<4;++s){var o=(e=a,i=r[0],n=r[2],3*h(i,n)*e*e+2*l(i,n)*e+3*i);if(0==o)return a;a-=(c(a,r[0],r[2])-t)/o}return a}(t),r[1],r[3])}},easeInSpline:function(t){return new VCO.Ease.KeySpline(VCO.Easings.easein).get(t)},easeInOutExpo:function(t){return new VCO.Ease.KeySpline(VCO.Easings.easein).get(t)},easeOut:function(t){return Math.sin(t*Math.PI/2)},easeOutStrong:function(t){return 1==t?1:1-Math.pow(2,-10*t)},easeIn:function(t){return t*t},easeInStrong:function(t){return 0==t?0:Math.pow(2,10*(t-1))},easeOutBounce:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInBack:function(t){return t*t*(2.70158*t-1.70158)},easeOutBack:function(t){return--t*t*(2.70158*t+1.70158)+1},bounce:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},bouncePast:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?2-(7.5625*(t-=1.5/2.75)*t+.75):t<2.5/2.75?2-(7.5625*(t-=2.25/2.75)*t+.9375):2-(7.5625*(t-=2.625/2.75)*t+.984375)},swingTo:function(t){return--t*t*(2.70158*t+1.70158)+1},swingFrom:function(t){return t*t*(2.70158*t-1.70158)},elastic:function(t){return-1*Math.pow(4,-8*t)*Math.sin(2*(6*t-1)*Math.PI/2)+1},spring:function(t){return 1-Math.cos(4.5*t*Math.PI)*Math.exp(6*-t)},blink:function(t,e){return Math.round(t*(e||5))%2},pulse:function(t,e){return-Math.cos(t*((e||5)-.5)*2*Math.PI)/2+.5},wobble:function(t){return-Math.cos(t*Math.PI*9*t)/2+.5},sinusoidal:function(t){return-Math.cos(t*Math.PI)/2+.5},flicker:function(t){t+=(Math.random()-.5)/5;return easings.sinusoidal(t<0?0:1<t?1:t)},mirror:function(t){return easings.sinusoidal(t<.5?2*t:1-2*(t-.5))},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return t<.5?2*t*t:(4-2*t)*t-1},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return--t*t*t+1},easeInOutCubic:function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return 1- --t*t*t*t},easeInOutQuart:function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return 1+--t*t*t*t*t},easeInOutQuint:function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t}},VCO.Animate=function(t,e){return new vcoanimate(t,e)},window.vcoanimate=function(){function p(t){var e,i=y.length;for(s&&1e12<t&&(t=f()),r&&(t=f()),e=i;e--;)y[e](t);y.length&&v(p)}function _(t){var e,i=function(t,e,i){if(Array.prototype.indexOf)return t.indexOf(e);for(i=0;i<t.length;++i)if(t[i]===e)return i}(y,t);0<=i&&(e=y.slice(i+1),y.length=i,y=y.concat(e))}function O(t,e){var i,n={};return(i=t.match(l))&&(n.rotate=T(i[1],e?e.rotate:null)),(i=t.match(c))&&(n.scale=T(i[1],e?e.scale:null)),(i=t.match(d))&&(n.skewx=T(i[1],e?e.skewx:null),n.skewy=T(i[3],e?e.skewy:null)),(i=t.match(u))&&(n.translatex=T(i[1],e?e.translatex:null),n.translatey=T(i[3],e?e.translatey:null)),n}function x(t){var e="";return"rotate"in t&&(e+="rotate("+t.rotate+"deg) "),"scale"in t&&(e+="scale("+t.scale+") "),"translatex"in t&&(e+="translate("+t.translatex+"px,"+t.translatey+"px) "),"skewx"in t&&(e+="skew("+t.skewx+"deg,"+t.skewy+"deg)"),e}function w(t){var e,i,n,a=t.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/);return(a?(e=a[1],i=a[2],n=a[3],"#"+(1<<24|e<<16|i<<8|n).toString(16).slice(1)):t).replace(/#(\w)(\w)(\w)$/,"#$1$1$2$2$3$3")}function b(t){return t.replace(/-(.)/g,function(t,e){return e.toUpperCase()})}function k(t){return"function"==typeof t}function e(t){return Math.sin(t*Math.PI/2)}function V(t,n,a,s,o,r){s=k(s)?s:i.easings[s]||e;var h=t||g,l=this,c=r-o,d=f(),u=0,m=0;return 1===y.push(function t(e){var i=e-d;return h<i||u?(r=isFinite(r)?r:1,u&&!m||n(r),_(t),a&&a.apply(l)):void n(isFinite(r)?c*s(i/h)+o:s(i/h))})&&v(p),{stop:function(t){u=1,(m=t)||(a=null)}}}function M(t,e){for(var i,n=t.length,a=[],s=0;s<n;++s)a[s]=[t[s][0],t[s][1]];for(i=1;i<n;++i)for(s=0;s<n-i;++s)a[s][0]=(1-e)*a[s][0]+e*a[parseInt(s+1,10)][0],a[s][1]=(1-e)*a[s][1]+e*a[parseInt(s+1,10)][1];return[a[0][0],a[0][1]]}function D(t,e,i,n,a,s,o){if("transform"!=a)return"string"==typeof i[s][a]?function(t,e,i){for(var n,a,s,o=[],r=0;r<6;r++)a=Math.min(15,parseInt(e.charAt(r),16)),s=Math.min(15,parseInt(i.charAt(r),16)),n=15<(n=Math.floor((s-a)*t+a))?15:n<0?0:n,o[r]=n.toString(16);return"#"+o.join("")}(t,i[s][a],n[s][a]):(o=Math.round(((n[s][a]-i[s][a])*t+i[s][a])*g)/g,a in m||(o+=e[s][a]||"px"),o);for(var r in o={},i[s][a])o[r]=r in n[s][a]?Math.round(((n[s][a][r]-i[s][a][r])*t+i[s][a][r])*g)/g:i[s][a][r];return o}function T(t,e,i,n,a){return(i=h.exec(t))?(a=parseFloat(i[2]))&&e+("+"==i[1]?1:-1)*a:parseFloat(t)}function i(t,a){var s,e,i,n,o,r,h=t?h=isFinite(t.length)?t:[t]:[],l=a.complete,c=a.duration,d=a.easing,u=a.bezier,m=[],p=[],_=[],f=[];for(u&&(e=a.left,i=a.top,delete a.right,delete a.bottom,delete a.left,delete a.top),s=h.length;s--;){for(var g in m[s]={},p[s]={},_[s]={},u&&(n=N(h[s],"left"),o=N(h[s],"top"),r=[T(k(e)?e(h[s]):e||0,parseFloat(n)),T(k(i)?i(h[s]):i||0,parseFloat(o))],f[s]=k(u)?u(h[s],r):u,f[s].push(r),f[s].unshift([parseInt(n,10),parseInt(o,10)])),a){switch(g){case"complete":case"duration":case"easing":case"bezier":continue}var v,y=N(h[s],g),C=k(a[g])?a[g](h[s]):a[g];"string"!=typeof C||!E.test(C)||E.test(y)?(m[s][g]="transform"==g?O(y):"string"==typeof C&&E.test(C)?w(y).slice(1):parseFloat(y),p[s][g]="transform"==g?O(C,m[s][g]):"string"==typeof C&&"#"==C.charAt(0)?w(C).slice(1):T(C,parseFloat(y)),"string"==typeof C&&(v=C.match(S))&&(_[s][g]=v[1])):delete a[g]}}return V.apply(h,[c,function(t,e,i){for(s=h.length;s--;)for(var n in u&&(i=M(f[s],t),h[s].style.left=i[0]+"px",h[s].style.top=i[1]+"px"),a)e=D(t,_,m,p,n,s),"transform"==n?h[s].style[L]=x(e):"opacity"!=n||A?h[s].style[b(n)]=e:h[s].style.filter="alpha(opacity="+100*e+")"},l,d])}var a=document,n=window,t=n.performance,s=t&&(t.now||t.webkitNow||t.msNow||t.mozNow),f=s?function(){return s.call(t)}:function(){return+new Date},o=a.documentElement,r=!1,g=1e3,E=/^rgb\(|#/,h=/^([+\-])=([\d\.]+)/,S=/^(?:[\+\-]=?)?\d+(?:\.\d+)?(%|in|cm|mm|em|ex|pt|pc|px)$/,l=/rotate\(((?:[+\-]=)?([\-\d\.]+))deg\)/,c=/scale\(((?:[+\-]=)?([\d\.]+))\)/,d=/skew\(((?:[+\-]=)?([\-\d\.]+))deg, ?((?:[+\-]=)?([\-\d\.]+))deg\)/,u=/translate\(((?:[+\-]=)?([\-\d\.]+))px, ?((?:[+\-]=)?([\-\d\.]+))px\)/,m={lineHeight:1,zoom:1,zIndex:1,opacity:1,transform:1},L=function(){for(var t=a.createElement("a").style,e=["webkitTransform","MozTransform","OTransform","msTransform","Transform"],i=0;i<e.length;i++)if(e[i]in t)return e[i]}(),A=void 0!==a.createElement("a").style.opacity,N=a.defaultView&&a.defaultView.getComputedStyle?function(t,e){e=b(e="transform"==e?L:e);var i=null,n=a.defaultView.getComputedStyle(t,"");return n&&(i=n[e]),t.style[e]||i}:o.currentStyle?function(e,t){if("opacity"==(t=b(t))){var i=100;try{i=e.filters["DXImageTransform.Microsoft.Alpha"].opacity}catch(t){try{i=e.filters("alpha").opacity}catch(t){}}return i/100}var n=e.currentStyle?e.currentStyle[t]:null;return e.style[t]||n}:function(t,e){return t.style[b(e)]},v=n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||n.msRequestAnimationFrame||n.oRequestAnimationFrame||function(t){n.setTimeout(function(){t(+new Date)},17)},y=[];return v(function(t){r=1e12<t!=1e12<f()}),i.tween=V,i.getStyle=N,i.bezier=M,i.transform=L,i.parseTransform=O,i.formatTransform=x,i.easings={},i}(),VCO.Point=function(t,e,i){this.x=i?Math.round(t):t,this.y=i?Math.round(e):e},VCO.Point.prototype={add:function(t){return this.clone()._add(t)},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(t)},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t,e){return new VCO.Point(this.x/t,this.y/t,e)},multiplyBy:function(t){return new VCO.Point(this.x*t,this.y*t)},distanceTo:function(t){var e=t.x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},clone:function(){return new VCO.Point(this.x,this.y)},toString:function(){return"Point("+VCO.Util.formatNum(this.x)+", "+VCO.Util.formatNum(this.y)+")"}},VCO.DomMixins={show:function(t){t||(this._el.container.style.display="block")},hide:function(t){this._el.container.style.display="none"},addTo:function(t){t.appendChild(this._el.container),this.onAdd()},removeFrom:function(t){t.removeChild(this._el.container),this.onRemove()},animatePosition:function(t,e){var i={duration:this.options.duration,easing:this.options.ease};for(var n in t)t.hasOwnProperty(n)&&(i[n]=t[n]+"px");this.animator&&this.animator.stop(),this.animator=VCO.Animate(e,i)},onLoaded:function(){this.fire("loaded",this.data)},onAdd:function(){this.fire("added",this.data)},onRemove:function(){this.fire("removed",this.data)},setPosition:function(t,e){for(var i in t)t.hasOwnProperty(i)&&(e?e.style[i]=t[i]+"px":this._el.container.style[i]=t[i]+"px")},getPosition:function(){return VCO.Dom.getPosition(this._el.container)}},VCO.Dom={get:function(t){return"string"==typeof t?document.getElementById(t):t},getByClass:function(t){return t?document.getElementsByClassName(t):void 0},create:function(t,e,i){var n=document.createElement(t);return n.className=e,i&&i.appendChild(n),n},createText:function(t,e){var i=document.createTextNode(t);return e&&e.appendChild(i),i},getTranslateString:function(t){return VCO.Dom.TRANSLATE_OPEN+t.x+"px,"+t.y+"px"+VCO.Dom.TRANSLATE_CLOSE},setPosition:function(t,e){t._vco_pos=e,VCO.Browser.webkit3d?(t.style[VCO.Dom.TRANSFORM]=VCO.Dom.getTranslateString(e),VCO.Browser.android&&(t.style["-webkit-perspective"]="1000",t.style["-webkit-backface-visibility"]="hidden")):(t.style.left=e.x+"px",t.style.top=e.y+"px")},getPosition:function(t){for(var e={x:0,y:0};t&&!isNaN(t.offsetLeft)&&!isNaN(t.offsetTop);)e.x+=t.offsetLeft,e.y+=t.offsetTop,t=t.offsetParent;return e},testProp:function(t){for(var e=document.documentElement.style,i=0;i<t.length;i++)if(t[i]in e)return t[i];return!1}},VCO.Util.extend(VCO.Dom,{TRANSITION:VCO.Dom.testProp(["transition","webkitTransition","OTransition","MozTransition","msTransition"]),TRANSFORM:VCO.Dom.testProp(["transformProperty","WebkitTransform","OTransform","MozTransform","msTransform"]),TRANSLATE_OPEN:"translate"+(VCO.Browser.webkit3d?"3d(":"("),TRANSLATE_CLOSE:VCO.Browser.webkit3d?",0)":")"}),VCO.DomUtil={get:function(t){return"string"==typeof t?document.getElementById(t):t},getStyle:function(t,e){var i,n=t.style[e];return!n&&t.currentStyle&&(n=t.currentStyle[e]),n&&"auto"!==n||(n=(i=document.defaultView.getComputedStyle(t,null))?i[e]:null),"auto"===n?null:n},getViewportOffset:function(t){var e=0,i=0,n=t,a=document.body;do{if(e+=n.offsetTop||0,i+=n.offsetLeft||0,n.offsetParent===a&&"absolute"===VCO.DomUtil.getStyle(n,"position"))break;n=n.offsetParent}while(n);n=t;do{if(n===a)break;e-=n.scrollTop||0,i-=n.scrollLeft||0,n=n.parentNode}while(n);return new VCO.Point(i,e)},create:function(t,e,i){var n=document.createElement(t);return n.className=e,i&&i.appendChild(n),n},disableTextSelection:function(){document.selection&&document.selection.empty&&document.selection.empty(),this._onselectstart||(this._onselectstart=document.onselectstart,document.onselectstart=VCO.Util.falseFn)},enableTextSelection:function(){document.onselectstart=this._onselectstart,this._onselectstart=null},hasClass:function(t,e){return 0<t.className.length&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(t.className)},addClass:function(t,e){VCO.DomUtil.hasClass(t,e)||(t.className+=(t.className?" ":"")+e)},removeClass:function(t,i){t.className=t.className.replace(/(\S+)\s*/g,function(t,e){return e===i?"":t}).replace(/^\s+/,"")},setOpacity:function(t,e){VCO.Browser.ie?t.style.filter="alpha(opacity="+Math.round(100*e)+")":t.style.opacity=e},testProp:function(t){for(var e=document.documentElement.style,i=0;i<t.length;i++)if(t[i]in e)return t[i];return!1},getTranslateString:function(t){return VCO.DomUtil.TRANSLATE_OPEN+t.x+"px,"+t.y+"px"+VCO.DomUtil.TRANSLATE_CLOSE},getScaleString:function(t,e){return VCO.DomUtil.getTranslateString(e)+(" scale("+t+") ")+VCO.DomUtil.getTranslateString(e.multiplyBy(-1))},setPosition:function(t,e){t._vco_pos=e,VCO.Browser.webkit3d?(t.style[VCO.DomUtil.TRANSFORM]=VCO.DomUtil.getTranslateString(e),VCO.Browser.android&&(t.style["-webkit-perspective"]="1000",t.style["-webkit-backface-visibility"]="hidden")):(t.style.left=e.x+"px",t.style.top=e.y+"px")},getPosition:function(t){return t._vco_pos}},VCO.DomEvent={addListener:function(e,t,i,n){var a,s,o,r=VCO.Util.stamp(i),h="_vco_"+t+r;e[h]||(o=function(t){return i.call(n||e,t||VCO.DomEvent._getEvent())},VCO.Browser.touch&&"dblclick"===t&&this.addDoubleTapListener?this.addDoubleTapListener(e,o,r):"addEventListener"in e?"mousewheel"===t?(e.addEventListener("DOMMouseScroll",o,!1),e.addEventListener(t,o,!1)):"mouseenter"===t||"mouseleave"===t?(a=o,s="mouseenter"===t?"mouseover":"mouseout",o=function(t){return VCO.DomEvent._checkMouse(e,t)?a(t):void 0},e.addEventListener(s,o,!1)):e.addEventListener(t,o,!1):"attachEvent"in e&&e.attachEvent("on"+t,o),e[h]=o)},removeListener:function(t,e,i){var n=VCO.Util.stamp(i),a="_vco_"+e+n,s=t[a];s&&(VCO.Browser.touch&&"dblclick"===e&&this.removeDoubleTapListener?this.removeDoubleTapListener(t,n):"removeEventListener"in t?"mousewheel"===e?(t.removeEventListener("DOMMouseScroll",s,!1),t.removeEventListener(e,s,!1)):"mouseenter"===e||"mouseleave"===e?t.removeEventListener("mouseenter"===e?"mouseover":"mouseout",s,!1):t.removeEventListener(e,s,!1):"detachEvent"in t&&t.detachEvent("on"+e,s),t[a]=null)},_checkMouse:function(t,e){var i=e.relatedTarget;if(!i)return!0;try{for(;i&&i!==t;)i=i.parentNode}catch(t){return!1}return i!==t},_getEvent:function(){var t=window.event;if(!t)for(var e=arguments.callee.caller;e&&(!(t=e.arguments[0])||window.Event!==t.constructor);)e=e.caller;return t},stopPropagation:function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},disableClickPropagation:function(t){VCO.DomEvent.addListener(t,VCO.Draggable.START,VCO.DomEvent.stopPropagation),VCO.DomEvent.addListener(t,"click",VCO.DomEvent.stopPropagation),VCO.DomEvent.addListener(t,"dblclick",VCO.DomEvent.stopPropagation)},preventDefault:function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},stop:function(t){VCO.DomEvent.preventDefault(t),VCO.DomEvent.stopPropagation(t)},getWheelDelta:function(t){var e=0;return t.wheelDelta&&(e=t.wheelDelta/120),t.detail&&(e=-t.detail/3),e}},VCO.StyleSheet=VCO.Class.extend({includes:[VCO.Events],_el:{},initialize:function(){this.style=document.createElement("style"),this.style.appendChild(document.createTextNode("")),document.head.appendChild(this.style),this.sheet=this.style.sheet},addRule:function(t,e,i){var n=i?i:0;"insertRule"in this.sheet?this.sheet.insertRule(t+"{"+e+"}",n):"addRule"in this.sheet&&this.sheet.addRule(t,e,n)},onLoaded:function(t){this._state.loaded=!0,this.fire("loaded",this.data)}}),VCO.Date=VCO.Class.extend({initialize:function(t,e,i){"number"==typeof t?this.data={format:"yyyy mmmm",date_obj:new Date(t)}:Date==t.constructor?this.data={format:"yyyy mmmm",date_obj:t}:(this.data=t,this._createDateObj()),this._setFormat(e,i)},setDateFormat:function(t){this.data.format=t},getDisplayDate:function(t,e){return this.data.display_text?this.data.display_text:((t=t||VCO.Language.fallback).constructor!=VCO.Language&&(trace("First argument to getDisplayDate must be VCO.Language"),t=VCO.Language.fallback),format_key=e||this.data.format,t.formatDate(this.data.date_obj,format_key))},getMillisecond:function(){return this.getTime()},getTime:function(){return this.data.date_obj.getTime()},isBefore:function(t){if(!this.data.date_obj.constructor==t.data.date_obj.constructor)throw"Can't compare VCO.Dates on different scales";return"isBefore"in this.data.date_obj?this.data.date_obj.isBefore(t.data.date_obj):this.data.date_obj<t.data.date_obj},isAfter:function(t){if(!this.data.date_obj.constructor==t.data.date_obj.constructor)throw"Can't compare VCO.Dates on different scales";return"isAfter"in this.data.date_obj?this.data.date_obj.isAfter(t.data.date_obj):this.data.date_obj>t.data.date_obj},floor:function(t){for(var e=new Date(this.data.date_obj),i=0;i<VCO.Date.SCALES.length;i++)if(VCO.Date.SCALES[i][2](e),VCO.Date.SCALES[i][0]==t)return new VCO.Date(e);throw"invalid scale "+t},_getDateData:function(){var t={year:0,month:1,day:1,hour:0,minute:0,second:0,millisecond:0};for(var e in VCO.Util.mergeData(t,this.data),DATE_PARTS=VCO.Date.DATE_PARTS,DATE_PARTS){var i=parseInt(t[DATE_PARTS[e]]);isNaN(i)&&(i=1==e||2==e?1:0),t[DATE_PARTS[e]]=i}return 0<t.month&&t.month<=12&&(t.month=t.month-1),t},_createDateObj:function(){var t=this._getDateData();this.data.date_obj=new Date(t.year,t.month,t.day,t.hour,t.minute,t.second,t.millisecond)},_setFormat:function(t,e){t?this.data.format=t:this.data.format||(this.data.format=VCO.DateUtil.findBestFormat(this.data)),e?this.data.format_short=e:this.data.format_short||(this.data.format_short=VCO.DateUtil.findBestFormat(this.data,!0))}}),VCO.BigYear=VCO.Class.extend({initialize:function(t){if(this.year=parseInt(t),isNaN(this.year))throw"Invalid year "+t},isBefore:function(t){return this.year<t.year},isAfter:function(t){return this.year>t.year},getTime:function(){return this.year}}),function(o){o.SCALES=[["millisecond",1,function(t){}],["second",1e3,function(t){t.setMilliseconds(0)}],["minute",6e4,function(t){t.setSeconds(0)}],["hour",36e5,function(t){t.setMinutes(0)}],["day",864e5,function(t){t.setHours(0)}],["month",2592e6,function(t){t.setDate(1)}],["year",31536e6,function(t){t.setMonth(0)}],["decade",31536e7,function(t){var e=t.getFullYear();t.setFullYear(e-e%10)}],["century",31536e8,function(t){var e=t.getFullYear();t.setFullYear(e-e%100)}],["millennium",31536e9,function(t){var e=t.getFullYear();t.setFullYear(e-e%1e3)}]],o.DATE_PARTS=["millisecond","second","minute","hour","day","month","year"];var r=/^([\+-]?\d+?)(-\d{2}?)?(-\d{2}?)?$/,h=/^([\+-]?\d{4}(?!\d{2}\b))((-?)((0[1-9]|1[0-2])(\3([12]\d|0[1-9]|3[01]))?|W([0-4]\d|5[0-2])(-?[1-7])?|(00[1-9]|0[1-9]\d|[12]\d{2}|3([0-5]\d|6[1-6])))([T\s]((([01]\d|2[0-3])((:?)[0-5]\d)?|24\:?00)([\.,]\d+(?!:))?)?(\17[0-5]\d([\.,]\d+)?)?([zZ]|([\+-])([01]\d|2[0-3]):?([0-5]\d)?)?)?)?$/;o.parseISODate=function(t){var e=new Date(t);if(isNaN(e))throw"Invalid date: "+t;return{year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate(),hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds(),millisecond:e.getMilliseconds()}},o.parseDate=function(t){if(t.match(r)){var e=t.match(r).slice(1);return d={year:e[0].replace("+","")},e[1]&&(d.month=e[1].replace("-","")),e[2]&&(d.day=e[2].replace("-","")),d}if(t.match(h))return o.parseISODate(t);if(t.match(/^\-?\d+$/))return{year:t};var i,n,a,s={};return t.match(/\d+\/\d+\/\d+/)&&(i=t.match(/\d+\/\d+\/\d+/)[0],t=VCO.Util.trim(t.replace(i,"")),n=i.split("/"),s.month=n[0],s.day=n[1],s.year=n[2]),t.match(/\d+\/\d+/)&&(i=t.match(/\d+\/\d+/)[0],t=VCO.Util.trim(t.replace(i,"")),n=i.split("/"),s.month=n[0],s.year=n[1]),t.match(":")&&(a=t.split(":"),s.hour=a[0],s.minute=a[1],a[2]&&(second_parts=a[2].split("."),s.second=second_parts[0],s.millisecond=second_parts[1])),s}}(VCO.Date),VCO.BigDate=VCO.Date.extend({initialize:function(t,e,i){VCO.BigYear==t.constructor?this.data={date_obj:t}:(this.data=t,this._createDateObj()),this._setFormat(e,i)},_createDateObj:function(){var t=this._getDateData();this.data.date_obj=new VCO.BigYear(t.year)},floor:function(t){for(var e=0;e<VCO.BigDate.SCALES.length;e++)if(VCO.BigDate.SCALES[e][0]==t){var i=VCO.BigDate.SCALES[e][2](this.data.date_obj);return new VCO.BigDate(i)}throw"invalid scale "+t}}),function(){function t(i){return function(t){var e=t.getTime();return new VCO.BigYear(Math.floor(e/i)*i)}}VCO.BigDate.SCALES=[["age",1e6,new t(1e6)],["epoch",1e7,new t(1e7)],["era",1e8,new t(1e8)],["eon",1e9,new t(1e9)]]}(),VCO.DateUtil={get:function(t){return"string"==typeof t?document.getElementById(t):t},sortByDate:function(t,i){i=i||"start_date";t.sort(function(t,e){return t[i].isBefore(e[i])?-1:t[i].isAfter(e[i])?1:0})},findBestFormat:function(t,e){for(var i=VCO.Date.DATE_PARTS,n=0;n<i.length;n++)if(t[i[n]])return e?e in VCO.DateUtil.best_dateformats||(e="short"):e="base",VCO.DateUtil.best_dateformats[e][i[n]];return""},best_dateformats:{base:{millisecond:1,second:"time",minute:"time_no_seconds_small_date",hour:"time_no_seconds_small_date",day:"full",month:"month",year:"year",decade:"year",century:"year",millennium:"year",age:"fallback",epoch:"fallback",era:"fallback",eon:"fallback",eon2:"fallback"},short:{millisecond:1,second:"time_short",minute:"time_no_seconds_short",hour:"time_no_minutes_short",day:"full_short",month:"month_short",year:"year",decade:"year",century:"year",millennium:"year",age:"fallback",epoch:"fallback",era:"fallback",eon:"fallback",eon2:"fallback"}}},VCO.Draggable=VCO.Class.extend({includes:VCO.Events,_el:{},mousedrag:{down:"mousedown",up:"mouseup",leave:"mouseleave",move:"mousemove"},touchdrag:{down:"touchstart",up:"touchend",leave:"mouseleave",move:"touchmove"},initialize:function(t,e,i){this._el={drag:t,move:t},i&&(this._el.move=i),this.options={enable:{x:!0,y:!0},constraint:{top:!1,bottom:!1,left:!1,right:!1},momentum_multiplier:2e3,duration:1e3,ease:VCO.Ease.easeInOutQuint},this.animator=null,this.dragevent=this.mousedrag,VCO.Browser.touch&&(this.dragevent=this.touchdrag),this.data={sliding:!1,direction:"none",pagex:{start:0,end:0},pagey:{start:0,end:0},pos:{start:{x:0,y:0},end:{x:0,y:0}},new_pos:{x:0,y:0},new_pos_parent:{x:0,y:0},time:{start:0,end:0},touch:!1},VCO.Util.mergeData(this.options,e)},enable:function(t){this.data.pos.start=0,this._el.move.style.left=this.data.pos.start.x+"px",this._el.move.style.top=this.data.pos.start.y+"px",this._el.move.style.position="absolute"},disable:function(){VCO.DomEvent.removeListener(this._el.drag,this.dragevent.down,this._onDragStart,this),VCO.DomEvent.removeListener(this._el.drag,this.dragevent.up,this._onDragEnd,this)},stopMomentum:function(){this.animator&&this.animator.stop()},updateConstraint:function(t){this.options.constraint=t},_onDragStart:function(t){VCO.Browser.touch?t.originalEvent?(this.data.pagex.start=t.originalEvent.touches[0].screenX,this.data.pagey.start=t.originalEvent.touches[0].screenY):(this.data.pagex.start=t.targetTouches[0].screenX,this.data.pagey.start=t.targetTouches[0].screenY):(this.data.pagex.start=t.pageX,this.data.pagey.start=t.pageY),this.options.enable.x&&(this._el.move.style.left=this.data.pagex.start-this._el.move.offsetWidth/2+"px"),this.options.enable.y&&(this._el.move.style.top=this.data.pagey.start-this._el.move.offsetHeight/2+"px"),this.data.pos.start=VCO.Dom.getPosition(this._el.drag),this.data.time.start=(new Date).getTime(),this.fire("dragstart",this.data),VCO.DomEvent.addListener(this._el.drag,this.dragevent.move,this._onDragMove,this),VCO.DomEvent.addListener(this._el.drag,this.dragevent.leave,this._onDragEnd,this)},_onDragEnd:function(t){this.data.sliding=!1,VCO.DomEvent.removeListener(this._el.drag,this.dragevent.move,this._onDragMove,this),VCO.DomEvent.removeListener(this._el.drag,this.dragevent.leave,this._onDragEnd,this),this.fire("dragend",this.data),this._momentum()},_onDragMove:function(t){t.preventDefault(),this.data.sliding=!0,VCO.Browser.touch?t.originalEvent?(this.data.pagex.end=t.originalEvent.touches[0].screenX,this.data.pagey.end=t.originalEvent.touches[0].screenY):(this.data.pagex.end=t.targetTouches[0].screenX,this.data.pagey.end=t.targetTouches[0].screenY):(this.data.pagex.end=t.pageX,this.data.pagey.end=t.pageY),this.data.pos.end=VCO.Dom.getPosition(this._el.drag),this.data.new_pos.x=-(this.data.pagex.start-this.data.pagex.end-this.data.pos.start.x),this.data.new_pos.y=-(this.data.pagey.start-this.data.pagey.end-this.data.pos.start.y),this.options.enable.x&&(this._el.move.style.left=this.data.new_pos.x+"px"),this.options.enable.y&&(this._el.move.style.top=this.data.new_pos.y+"px"),this.fire("dragmove",this.data)},_momentum:function(){var t={x:0,y:0,time:0},e={x:0,y:0,time:0},i=!1;VCO.Browser.touch,t.time=10*((new Date).getTime()-this.data.time.start),e.time=10*((new Date).getTime()-this.data.time.start),e.x=this.options.momentum_multiplier*(Math.abs(this.data.pagex.end)-Math.abs(this.data.pagex.start)),e.y=this.options.momentum_multiplier*(Math.abs(this.data.pagey.end)-Math.abs(this.data.pagey.start)),t.x=Math.round(e.x/e.time),t.y=Math.round(e.y/e.time),this.data.new_pos.x=Math.min(this.data.pos.end.x+t.x),this.data.new_pos.y=Math.min(this.data.pos.end.y+t.y),this.options.enable.x?this.data.new_pos.x<0&&(this.data.new_pos.x=0):this.data.new_pos.x=this.data.pos.start.x,this.options.enable.y?this.data.new_pos.y<0&&(this.data.new_pos.y=0):this.data.new_pos.y=this.data.pos.start.y,e.time<3e3&&(i=!0),1e4<Math.abs(e.x)&&(this.data.direction="left",0<e.x&&(this.data.direction="right")),1e4<Math.abs(e.y)&&(this.data.direction="up",0<e.y&&(this.data.direction="down")),this._animateMomentum(),i&&this.fire("swipe_"+this.data.direction,this.data)},_animateMomentum:function(){var t={x:this.data.new_pos.x,y:this.data.new_pos.y},e={duration:this.options.duration,easing:VCO.Ease.easeOutStrong};this.options.enable.y&&((this.options.constraint.top||this.options.constraint.bottom)&&(t.y>this.options.constraint.bottom?t.y=this.options.constraint.bottom:t.y<this.options.constraint.top&&(t.y=this.options.constraint.top)),e.top=Math.floor(t.y)+"px"),this.options.enable.x&&((this.options.constraint.left||this.options.constraint.right)&&(t.x>this.options.constraint.left?t.x=this.options.constraint.left:t.x<this.options.constraint.right&&(t.x=this.options.constraint.right)),e.left=Math.floor(t.x)+"px"),this.animator=VCO.Animate(this._el.move,e),this.fire("momentum",this.data)}}),VCO.Swipable=VCO.Class.extend({includes:VCO.Events,_el:{},mousedrag:{down:"mousedown",up:"mouseup",leave:"mouseleave",move:"mousemove"},touchdrag:{down:"touchstart",up:"touchend",leave:"mouseleave",move:"touchmove"},initialize:function(t,e,i){this._el={drag:t,move:t},e&&(this._el.move=e),this.options={snap:!1,enable:{x:!0,y:!0},constraint:{top:!1,bottom:!1,left:0,right:!1},momentum_multiplier:2e3,duration:1e3,ease:VCO.Ease.easeInOutQuint},this.animator=null,this.dragevent=this.mousedrag,VCO.Browser.touch&&(this.dragevent=this.touchdrag),this.data={sliding:!1,direction:"none",pagex:{start:0,end:0},pagey:{start:0,end:0},pos:{start:{x:0,y:0},end:{x:0,y:0}},new_pos:{x:0,y:0},new_pos_parent:{x:0,y:0},time:{start:0,end:0},touch:!1},VCO.Util.mergeData(this.options,i)},enable:function(t){VCO.DomEvent.addListener(this._el.drag,this.dragevent.down,this._onDragStart,this),VCO.DomEvent.addListener(this._el.drag,this.dragevent.up,this._onDragEnd,this),this.data.pos.start=0,this._el.move.style.left=this.data.pos.start.x+"px",this._el.move.style.top=this.data.pos.start.y+"px",this._el.move.style.position="absolute"},disable:function(){VCO.DomEvent.removeListener(this._el.drag,this.dragevent.down,this._onDragStart,this),VCO.DomEvent.removeListener(this._el.drag,this.dragevent.up,this._onDragEnd,this)},stopMomentum:function(){this.animator&&this.animator.stop()},updateConstraint:function(t){this.options.constraint=t},_onDragStart:function(t){this.animator&&this.animator.stop(),VCO.Browser.touch?t.originalEvent?(this.data.pagex.start=t.originalEvent.touches[0].screenX,this.data.pagey.start=t.originalEvent.touches[0].screenY):(this.data.pagex.start=t.targetTouches[0].screenX,this.data.pagey.start=t.targetTouches[0].screenY):(this.data.pagex.start=t.pageX,this.data.pagey.start=t.pageY),this.options.enable.x,this.options.enable.y,this.data.pos.start={x:this._el.move.offsetLeft,y:this._el.move.offsetTop},this.data.time.start=(new Date).getTime(),this.fire("dragstart",this.data),VCO.DomEvent.addListener(this._el.drag,this.dragevent.move,this._onDragMove,this),VCO.DomEvent.addListener(this._el.drag,this.dragevent.leave,this._onDragEnd,this)},_onDragEnd:function(t){this.data.sliding=!1,VCO.DomEvent.removeListener(this._el.drag,this.dragevent.move,this._onDragMove,this),VCO.DomEvent.removeListener(this._el.drag,this.dragevent.leave,this._onDragEnd,this),this.fire("dragend",this.data),this._momentum()},_onDragMove:function(t){var e={x:0,y:0};this.data.sliding=!0,VCO.Browser.touch?t.originalEvent?(this.data.pagex.end=t.originalEvent.touches[0].screenX,this.data.pagey.end=t.originalEvent.touches[0].screenY):(this.data.pagex.end=t.targetTouches[0].screenX,this.data.pagey.end=t.targetTouches[0].screenY):(this.data.pagex.end=t.pageX,this.data.pagey.end=t.pageY),e.x=this.data.pagex.start-this.data.pagex.end,e.y=this.data.pagey.start-this.data.pagey.end,this.data.pos.end={x:this._el.drag.offsetLeft,y:this._el.drag.offsetTop},this.data.new_pos.x=-(e.x-this.data.pos.start.x),this.data.new_pos.y=-(e.y-this.data.pos.start.y),this.options.enable.x&&Math.abs(e.x)>Math.abs(e.y)&&(t.preventDefault(),this._el.move.style.left=this.data.new_pos.x+"px"),this.options.enable.y&&Math.abs(e.y)>Math.abs(e.y)&&(t.preventDefault(),this._el.move.style.top=this.data.new_pos.y+"px"),this.fire("dragmove",this.data)},_momentum:function(){var t={x:0,y:0,time:0},e={x:0,y:0,time:0},i={x:!1,y:!1},n=!1;this.data.direction=null,t.time=10*((new Date).getTime()-this.data.time.start),e.time=10*((new Date).getTime()-this.data.time.start),e.x=this.options.momentum_multiplier*(Math.abs(this.data.pagex.end)-Math.abs(this.data.pagex.start)),e.y=this.options.momentum_multiplier*(Math.abs(this.data.pagey.end)-Math.abs(this.data.pagey.start)),t.x=Math.round(e.x/e.time),t.y=Math.round(e.y/e.time),this.data.new_pos.x=Math.min(this.data.new_pos.x+t.x),this.data.new_pos.y=Math.min(this.data.new_pos.y+t.y),this.options.enable.x?this.options.constraint.left&&this.data.new_pos.x>this.options.constraint.left&&(this.data.new_pos.x=this.options.constraint.left):this.data.new_pos.x=this.data.pos.start.x,this.options.enable.y?this.data.new_pos.y<0&&(this.data.new_pos.y=0):this.data.new_pos.y=this.data.pos.start.y,e.time<2e3&&(n=!0),this.options.enable.x&&this.options.enable.y?Math.abs(e.x)>Math.abs(e.y)?i.x=!0:i.y=!0:this.options.enable.x?Math.abs(e.x)>Math.abs(e.y)&&(i.x=!0):Math.abs(e.y)>Math.abs(e.x)&&(i.y=!0),i.x&&(Math.abs(e.x)>this._el.drag.offsetWidth/2&&(n=!0),1e4<Math.abs(e.x)&&(this.data.direction="left",0<e.x&&(this.data.direction="right"))),i.y&&(Math.abs(e.y)>this._el.drag.offsetHeight/2&&(n=!0),1e4<Math.abs(e.y)&&(this.data.direction="up",0<e.y&&(this.data.direction="down"))),e.time<1e3||this._animateMomentum(),n&&this.data.direction?this.fire("swipe_"+this.data.direction,this.data):this.data.direction?this.fire("swipe_nodirection",this.data):this.options.snap&&(this.animator.stop(),this.animator=VCO.Animate(this._el.move,{top:this.data.pos.start.y,left:this.data.pos.start.x,duration:this.options.duration,easing:VCO.Ease.easeOutStrong}))},_animateMomentum:function(){var t={x:this.data.new_pos.x,y:this.data.new_pos.y},e={duration:this.options.duration,easing:VCO.Ease.easeOutStrong};this.options.enable.y&&((this.options.constraint.top||this.options.constraint.bottom)&&(t.y>this.options.constraint.bottom?t.y=this.options.constraint.bottom:t.y<this.options.constraint.top&&(t.y=this.options.constraint.top)),e.top=Math.floor(t.y)+"px"),this.options.enable.x&&(this.options.constraint.left&&t.x>=this.options.constraint.left&&(t.x=this.options.constraint.left),this.options.constraint.right&&t.x<this.options.constraint.right&&(t.x=this.options.constraint.right),e.left=Math.floor(t.x)+"px"),this.animator=VCO.Animate(this._el.move,e),this.fire("momentum",this.data)}}),VCO.MenuBar=VCO.Class.extend({includes:[VCO.Events,VCO.DomMixins],_el:{},initialize:function(t,e,i){this._el={parent:{},container:{},button_backtostart:{},button_zoomin:{},button_zoomout:{},arrow:{},line:{},coverbar:{},grip:{}},this.collapsed=!1,this._el.container="object"==typeof t?t:VCO.Dom.get(t),e&&(this._el.parent=e),this.options={width:600,height:600,duration:1e3,ease:VCO.Ease.easeInOutQuint,menubar_default_y:0},this.animator={},VCO.Util.mergeData(this.options,i),this._initLayout(),this._initEvents()},show:function(t){this.options.duration},hide:function(t){},setSticky:function(t){this.options.menubar_default_y=t},setColor:function(t){this._el.container.className=t?"vco-menubar vco-menubar-inverted":"vco-menubar"},updateDisplay:function(t,e,i,n){this._updateDisplay(t,e,i,n)},_onButtonZoomIn:function(t){this.fire("zoom_in",t)},_onButtonZoomOut:function(t){this.fire("zoom_out",t)},_onButtonBackToStart:function(t){this.fire("back_to_start",t)},_initLayout:function(){this._el.button_zoomin=VCO.Dom.create("span","vco-menubar-button",this._el.container),this._el.button_zoomout=VCO.Dom.create("span","vco-menubar-button",this._el.container),this._el.button_backtostart=VCO.Dom.create("span","vco-menubar-button",this._el.container),VCO.Browser.mobile&&this._el.container.setAttribute("ontouchstart"," "),this._el.button_backtostart.innerHTML="<span class='vco-icon-goback'></span>",this._el.button_zoomin.innerHTML="<span class='vco-icon-zoom-in'></span>",this._el.button_zoomout.innerHTML="<span class='vco-icon-zoom-out'></span>"},_initEvents:function(){VCO.DomEvent.addListener(this._el.button_backtostart,"click",this._onButtonBackToStart,this),VCO.DomEvent.addListener(this._el.button_zoomin,"click",this._onButtonZoomIn,this),VCO.DomEvent.addListener(this._el.button_zoomout,"click",this._onButtonZoomOut,this)},_updateDisplay:function(t,e,i){t&&(this.options.width=t),e&&(this.options.height=e)}}),VCO.Message=VCO.Class.extend({includes:[VCO.Events,VCO.DomMixins],_el:{},initialize:function(t,e,i){this._el={parent:{},container:{},message_container:{},loading_icon:{},message:{}},this.options={width:600,height:600,message_class:"vco-message",message_icon_class:"vco-loading-icon"},VCO.Util.mergeData(this.data,t),VCO.Util.mergeData(this.options,e),this._el.container=VCO.Dom.create("div",this.options.message_class),i&&(i.appendChild(this._el.container),this._el.parent=i),this.animator={},this._initLayout(),this._initEvents()},updateMessage:function(t){this._updateMessage(t)},updateDisplay:function(t,e){this._updateDisplay(t,e)},_updateMessage:function(t){var e;t?this._el.message.innerHTML=t:(e=this.options.language||VCO.Language.fallback,this._el.message.innerHTML=e._("loading"))},_onMouseClick:function(){this.fire("clicked",this.options)},_initLayout:function(){this._el.message_container=VCO.Dom.create("div","vco-message-container",this._el.container),this._el.loading_icon=VCO.Dom.create("div",this.options.message_icon_class,this._el.message_container),this._el.message=VCO.Dom.create("div","vco-message-content",this._el.message_container),this._updateMessage()},_initEvents:function(){VCO.DomEvent.addListener(this._el.container,"click",this._onMouseClick,this)},_updateDisplay:function(t,e,i){}}),VCO.MediaType=function(t){for(var e={},i=[{type:"youtube",name:"YouTube",match_str:"(www.)?youtube|youtu.be",cls:VCO.Media.YouTube},{type:"vimeo",name:"Vimeo",match_str:"(player.)?vimeo.com",cls:VCO.Media.Vimeo},{type:"dailymotion",name:"DailyMotion",match_str:"(www.)?dailymotion.com",cls:VCO.Media.DailyMotion},{type:"vine",name:"Vine",match_str:"(www.)?vine.co",cls:VCO.Media.Vine},{type:"soundcloud",name:"SoundCloud",match_str:"(player.)?soundcloud.com",cls:VCO.Media.SoundCloud},{type:"twitter",name:"Twitter",match_str:"(www.)?twitter.com",cls:VCO.Media.Twitter},{type:"googlemaps",name:"Google Map",match_str:"maps.google",cls:VCO.Media.Map},{type:"googleplus",name:"Google+",match_str:"plus.google",cls:VCO.Media.GooglePlus},{type:"flickr",name:"Flickr",match_str:"flickr.com/photos",cls:VCO.Media.Flickr},{type:"instagram",name:"Instagram",match_str:/(instagr.am|instagram.com)\/p\//,cls:VCO.Media.Instagram},{type:"profile",name:"Profile",match_str:/((instagr.am|instagram.com)(\/profiles\/|[-a-zA-Z0-9@:%_\+.~#?&//=]+instagramprofile))|[-a-zA-Z0-9@:%_\+.~#?&//=]+\?profile/,cls:VCO.Media.Profile},{type:"image",name:"Image",match_str:/jpg|jpeg|png|gif/i,cls:VCO.Media.Image},{type:"googledocs",name:"Google Doc",match_str:/\b.(doc|docx|xls|xlsx|ppt|pptx|pdf|pages|ai|psd|tiff|dxf|svg|eps|ps|ttf|xps|zip|tif)\b/,cls:VCO.Media.GoogleDoc},{type:"wikipedia",name:"Wikipedia",match_str:"(www.)?wikipedia.org",cls:VCO.Media.Wikipedia},{type:"spotify",name:"spotify",match_str:"spotify",cls:VCO.Media.Spotify},{type:"iframe",name:"iFrame",match_str:"iframe",cls:VCO.Media.IFrame},{type:"storify",name:"Storify",match_str:"storify",cls:VCO.Media.Storify},{type:"blockquote",name:"Quote",match_str:"blockquote",cls:VCO.Media.Blockquote},{type:"website",name:"Website",match_str:"http://",cls:VCO.Media.Website},{type:"image",name:"Image",match_str:"",cls:VCO.Media.Image}],n=0;n<i.length;n++){if(t instanceof Array)return{type:"slider",cls:VCO.Media.Slider};if(t.url.match(i[n].match_str))return(e=i[n]).url=t.url,e}return!1},VCO.Media=VCO.Class.extend({includes:[VCO.Events,VCO.I18NMixins],_el:{},initialize:function(t,e,i){this._el={container:{},content_container:{},content:{},content_item:{},content_link:{},caption:null,credit:null,parent:{},link:null},this.player=null,this.timer=null,this.load_timer=null,this.message=null,this.media_id=null,this._state={loaded:!1,show_meta:!1,media_loaded:!1},this.data={uniqueid:null,url:null,credit:null,caption:null,link:null,link_target:null},this.options={api_key_flickr:"f2cc870b4d233dd0a5bfe73fd0d64ef0",credit_height:0,caption_height:0},this.animator={},VCO.Util.mergeData(this.options,e),VCO.Util.mergeData(this.data,t),this._el.container=VCO.Dom.create("div","vco-media"),this.data.uniqueid&&(this._el.container.id=this.data.uniqueid),this._initLayout(),i&&(i.appendChild(this._el.container),this._el.parent=i)},loadMedia:function(){var t=this;if(!this._state.loaded)try{this.load_timer=setTimeout(function(){t._loadMedia(),t._state.loaded=!0,t._updateDisplay()},1200)}catch(t){trace("Error loading media for ",this._media),trace(t)}},loadingMessage:function(){this.message.updateMessage(this._("loading")+" "+this.options.media_name)},updateMediaDisplay:function(t){this._state.loaded&&(this._el.content_item.style.maxHeight=VCO.Browser.mobile?this.options.height/2+"px":this.options.height-this.options.credit_height-this.options.caption_height-30+"px",this._el.container.style.maxWidth=this.options.width+"px",VCO.Browser.firefox&&(this._el.content_item.offsetWidth,this._el.content_item.offsetHeight),this._updateMediaDisplay(t),this._state.media_loaded&&(this._el.credit&&(this._el.credit.style.width=this._el.content_item.offsetWidth+"px"),this._el.caption&&(this._el.caption.style.width=this._el.content_item.offsetWidth+"px")))},_loadMedia:function(){},_updateMediaDisplay:function(t){VCO.Browser.firefox&&(this._el.content_item.style.maxWidth=this.options.width+"px",this._el.content_item.style.width="auto")},show:function(){},hide:function(){},addTo:function(t){t.appendChild(this._el.container),this.onAdd()},removeFrom:function(t){t.removeChild(this._el.container),this.onRemove()},updateDisplay:function(t,e,i){this._updateDisplay(t,e,i)},stopMedia:function(){this._stopMedia()},loadErrorDisplay:function(t){this._el.content.removeChild(this._el.content_item),this._el.content_item=VCO.Dom.create("div","vco-media-item vco-media-loaderror",this._el.content),this._el.content_item.innerHTML="<div class='vco-icon-"+this.options.media_type+"'></div><p>"+t+"</p>",this.onLoaded(!0)},onLoaded:function(t){this._state.loaded=!0,this.fire("loaded",this.data),this.message&&this.message.hide(),t||this.showMeta(),this.updateDisplay()},onMediaLoaded:function(t){this._state.media_loaded=!0,this.fire("media_loaded",this.data),this._el.credit&&(this._el.credit.style.width=this._el.content_item.offsetWidth+"px"),this._el.caption&&(this._el.caption.style.width=this._el.content_item.offsetWidth+"px")},showMeta:function(t,e){this._state.show_meta=!0,this.data.credit&&""!=this.data.credit&&(this._el.credit=VCO.Dom.create("div","vco-credit",this._el.content_container),this._el.credit.innerHTML=this.data.credit,this.options.credit_height=this._el.credit.offsetHeight),this.data.caption&&""!=this.data.caption&&(this._el.caption=VCO.Dom.create("div","vco-caption",this._el.content_container),this._el.caption.innerHTML=this.data.caption,this.options.caption_height=this._el.caption.offsetHeight)},onAdd:function(){this.fire("added",this.data)},onRemove:function(){this.fire("removed",this.data)},_initLayout:function(){this.message=new VCO.Message({},this.options),this.message.addTo(this._el.container),this._el.content_container=VCO.Dom.create("div","vco-media-content-container",this._el.container),this.data.link&&""!=this.data.link?(this._el.link=VCO.Dom.create("a","vco-media-link",this._el.content_container),this._el.link.href=this.data.link,this._el.link.target=this.data.link_target&&""!=this.data.link_target?this.data.link_target:"_blank",this._el.content=VCO.Dom.create("div","vco-media-content",this._el.link)):this._el.content=VCO.Dom.create("div","vco-media-content",this._el.content_container)},_updateDisplay:function(t,e,i){t&&(this.options.width=t),e&&(this.options.height=e),i&&(this.options.layout=i),this._el.credit&&(this.options.credit_height=this._el.credit.offsetHeight),this._el.caption&&(this.options.caption_height=this._el.caption.offsetHeight+5),this.updateMediaDisplay(this.options.layout)},_stopMedia:function(){}}),VCO.Media.Blockquote=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){this.loadingMessage(),this._el.content_item=VCO.Dom.create("div","vco-media-item vco-media-blockquote",this._el.content),this._el.content_container.className="vco-media-content-container vco-media-content-container-text",this.media_id=this.data.url,this._el.content_item.innerHTML=this.media_id,this.onLoaded()},updateMediaDisplay:function(){},_updateMediaDisplay:function(){}}),VCO.Media.Flickr=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){var t,e=this;this.loadingMessage(),this._el.content_link=VCO.Dom.create("a","",this._el.content),this._el.content_link.href=this.data.url,this._el.content_link.target="_blank",this._el.content_item=VCO.Dom.create("img","vco-media-item vco-media-image vco-media-flickr vco-media-shadow",this._el.content_link),this._el.content_item.addEventListener("load",function(t){e.onMediaLoaded()}),this.establishMediaID(),t="https://api.flickr.com/services/rest/?method=flickr.photos.getSizes&api_key="+this.options.api_key_flickr+"&photo_id="+this.media_id+"&format=json&jsoncallback=?",VCO.getJSON(t,function(t){"ok"==t.stat?e.createMedia(t):e.loadErrorDisplay("Photo not found or private.")})},establishMediaID:function(){var t="flickr.com/photos/",e=this.data.url.indexOf(t);if(-1==e)throw"Invalid Flickr URL";var i=e+t.length;this.media_id=this.data.url.substr(i).split("/")[1]},createMedia:function(t){var e=this.sizes(this.options.height),i=t.sizes.size[t.sizes.size.length-2].source;self=this;for(var n=0;n<t.sizes.size.length;n++)t.sizes.size[n].label==e&&(i=t.sizes.size[n].source);this._el.content_item.src=i,this.onLoaded()},sizes:function(t){return t<=75?t<=0?"Large":"Thumbnail":t<=180?"Small":t<=240?"Small 320":t<=375?"Medium":t<=480?"Medium 640":"Large"}}),VCO.Media.Instagram=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){var e=this;this.loadingMessage(),this.media_id=this.data.url.split("/p/")[1].split("/")[0],this._el.content_link=VCO.Dom.create("a","",this._el.content),this._el.content_link.href=this.data.url,this._el.content_link.target="_blank",this._el.content_item=VCO.Dom.create("img","vco-media-item vco-media-image vco-media-instagram vco-media-shadow",this._el.content_link),this._el.content_item.addEventListener("load",function(t){e.onMediaLoaded()}),this._el.content_item.src="http://instagr.am/p/"+this.media_id+"/media/?size="+this.sizes(this._el.content.offsetWidth),this.onLoaded()},sizes:function(t){return t<=150?"t":t<=306?"m":"l"}}),VCO.Media.Profile=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){this.loadingMessage(),this._el.content_item=VCO.Dom.create("img","vco-media-item vco-media-image vco-media-profile vco-media-shadow",this._el.content),this._el.content_item.src=this.data.url,this.onLoaded()},_updateMediaDisplay:function(t){VCO.Browser.firefox&&(this._el.content_item.style.maxWidth=this.options.width/2-40+"px")}}),VCO.Media.GoogleDoc=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){this.loadingMessage(),this._el.content_item=VCO.Dom.create("div","vco-media-item vco-media-iframe",this._el.content),this.media_id=this.data.url,this.media_id,this._el.content_item.innerHTML=this.media_id.match(/docs.google.com/i)?"<iframe class='doc' frameborder='0' width='100%' height='100%' src='"+this.media_id+"&amp;embedded=true'></iframe>":"<iframe class='doc' frameborder='0' width='100%' height='100%' src='http://docs.google.com/viewer?url="+this.media_id+"&amp;embedded=true'></iframe>",this.onLoaded()},_updateMediaDisplay:function(){this._el.content_item.style.height=this.options.height+"px"}}),VCO.Media.GooglePlus=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){var t;this.loadingMessage(),this._el.content_item=VCO.Dom.create("div","vco-media-item vco-media-googleplus",this._el.content),this.media_id=this.data.url,t=this.media_id,this._el.content_item.innerHTML="<iframe frameborder='0' width='100%' height='100%' src='"+t+"'></iframe>",this.onLoaded()},_updateMediaDisplay:function(){this._el.content_item.style.height=this.options.height+"px"}}),VCO.Media.IFrame=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){var t;this.loadingMessage(),this._el.content_item=VCO.Dom.create("div","vco-media-item vco-media-iframe",this._el.content),this.media_id=this.data.url,t=this.media_id,this._el.content_item.innerHTML=t,this.onLoaded()},_updateMediaDisplay:function(){this._el.content_item.style.height=this.options.height+"px"}}),VCO.Media.Image=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){var e=this;this.loadingMessage(),this.data.link?(this._el.content_link=VCO.Dom.create("a","",this._el.content),this._el.content_link.href=this.data.link,this._el.content_link.target="_blank",this._el.content_item=VCO.Dom.create("img","vco-media-item vco-media-image vco-media-shadow",this._el.content_link)):this._el.content_item=VCO.Dom.create("img","vco-media-item vco-media-image vco-media-shadow",this._el.content),this._el.content_item.addEventListener("load",function(t){e.onMediaLoaded()}),this._el.content_item.src=this.data.url,this.onLoaded()},_updateMediaDisplay:function(t){VCO.Browser.firefox&&(this._el.content_item.style.width="auto")}}),VCO.Media.SoundCloud=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){var t,e=this;this.loadingMessage(),this._el.content_item=VCO.Dom.create("div","vco-media-item vco-media-iframe vco-media-soundcloud vco-media-shadow",this._el.content),this.media_id=this.data.url,t="http://soundcloud.com/oembed?url="+this.media_id+"&format=js&callback=?",VCO.getJSON(t,function(t){e.createMedia(t)})},createMedia:function(t){this._el.content_item.innerHTML=t.html,this.onLoaded()}}),VCO.Media.Storify=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){var t;this.loadingMessage(),this._el.content_item=VCO.Dom.create("div","vco-media-item vco-media-iframe vco-media-storify",this._el.content),this.media_id=this.data.url,t="<iframe frameborder='0' width='100%' height='100%' src='"+this.media_id+"/embed'></iframe>",t+="<script src='"+this.media_id+".js'><\/script>",this._el.content_item.innerHTML=t,this.onLoaded()},_updateMediaDisplay:function(){this._el.content_item.style.height=this.options.height+"px"}}),VCO.Media.Text=VCO.Class.extend({includes:[VCO.Events],_el:{container:{},content_container:{},content:{},headline:{},date:{}},data:{uniqueid:"",headline:"headline",text:"text"},options:{title:!1},initialize:function(t,e,i){VCO.Util.setData(this,t),VCO.Util.mergeData(this.options,e),this._el.container=VCO.Dom.create("div","vco-text"),this._el.container.id=this.data.uniqueid,this._initLayout(),i&&i.appendChild(this._el.container)},show:function(){},hide:function(){},addTo:function(t){t.appendChild(this._el.container)},removeFrom:function(t){t.removeChild(this._el.container)},headlineHeight:function(){return this._el.headline.offsetHeight+40},addDateText:function(t){this._el.date.innerHTML=t},onLoaded:function(){this.fire("loaded",this.data)},onAdd:function(){this.fire("added",this.data)},onRemove:function(){this.fire("removed",this.data)},_initLayout:function(){var t,e;this._el.content_container=VCO.Dom.create("div","vco-text-content-container",this._el.container),this._el.date=VCO.Dom.create("h3","vco-headline-date",this._el.content_container),""!=this.data.headline&&(t="vco-headline",this.options.title&&(t="vco-headline vco-headline-title"),this._el.headline=VCO.Dom.create("h2",t,this._el.content_container),this._el.headline.innerHTML=this.data.headline),""!=this.data.text&&(e="",e+=VCO.Util.htmlify(this.data.text),this._el.content=VCO.Dom.create("div","vco-text-content",this._el.content_container),this._el.content.innerHTML=e),this.onLoaded()}}),VCO.Media.Twitter=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){var t,n=this;this.loadingMessage(),this._el.content_item=VCO.Dom.create("div","vco-media-twitter",this._el.content),this._el.content_container.className="vco-media-content-container vco-media-content-container-text",this.media_id=this.data.url.match("status/")?this.data.url.split("status/")[1]:url.match("statuses/")?this.data.url.split("statuses/")[1]:"",t="https://api.twitter.com/1/statuses/oembed.json?id="+this.media_id+"&omit_script=true&include_entities=true&callback=?",VCO.ajax({type:"GET",url:t,dataType:"json",success:function(t){n.createMedia(t)},error:function(t,e){var i="";i+="Unable to load Tweet. <br/>"+n.media_id+"<br/>"+e,n.loadErrorDisplay(i)}})},createMedia:function(t){trace("create_media");var e="",i="",n=t.html.split("</p>&mdash;")[0]+"</p></blockquote>",a=t.author_url.split("twitter.com/")[1];e+=n,e+="<div class='vcard'>",e+="<a href='"+(i=t.html.split("</p>&mdash;")[1].split('<a href="')[1]).split('">')[0]+"' class='twitter-date' target='_blank'>"+i.split('">')[1].split("</a>")[0]+"</a>",e+="<div class='author'>",e+="<a class='screen-name url' href='"+t.author_url+"' target='_blank'>",e+="<span class='avatar'></span>",e+="<span class='fn'>"+t.author_name+" <span class='vco-icon-twitter'></span></span>",e+="<span class='nickname'>@"+a+"<span class='thumbnail-inline'></span></span>",e+="</a>",e+="</div>",e+="</div>",this._el.content_item.innerHTML=e,this.onLoaded()},updateMediaDisplay:function(){},_updateMediaDisplay:function(){}}),VCO.Media.Vimeo=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){var t,e=this;this.loadingMessage(),this._el.content_item=VCO.Dom.create("div","vco-media-item vco-media-iframe vco-media-vimeo vco-media-shadow",this._el.content),this.media_id=this.data.url.split(/video\/|\/\/vimeo\.com\//)[1].split(/[?&]/)[0],t="http://player.vimeo.com/video/"+this.media_id+"?api=1&title=0&amp;byline=0&amp;portrait=0&amp;color=ffffff",this.player=VCO.Dom.create("iframe","",this._el.content_item),this.player.addEventListener("load",function(t){e.onMediaLoaded()}),this.player.width="100%",this.player.height="100%",this.player.frameBorder="0",this.player.src=t,this.onLoaded()},_updateMediaDisplay:function(){this._el.content_item.style.height=VCO.Util.ratio.r16_9({w:this._el.content_item.offsetWidth})+"px"},_stopMedia:function(){try{this.player.contentWindow.postMessage(JSON.stringify({method:"pause"}),"http://player.vimeo.com")}catch(t){trace(t)}}}),VCO.Media.DailyMotion=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){var t;this.loadingMessage(),this._el.content_item=VCO.Dom.create("div","vco-media-item vco-media-iframe vco-media-dailymotion",this._el.content),this.media_id=this.data.url.match("video")?this.data.url.split("video/")[1].split(/[?&]/)[0]:this.data.url.split("embed/")[1].split(/[?&]/)[0],t="http://www.dailymotion.com/embed/video/"+this.media_id,this._el.content_item.innerHTML="<iframe autostart='false' frameborder='0' width='100%' height='100%' src='"+t+"'></iframe>",this.onLoaded()},_updateMediaDisplay:function(){this._el.content_item.style.height=VCO.Util.ratio.r16_9({w:this._el.content_item.offsetWidth})+"px"}}),VCO.Media.Vine=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){var t;this.loadingMessage(),this._el.content_item=VCO.Dom.create("div","vco-media-item vco-media-iframe vco-media-vine vco-media-shadow",this._el.content),this.media_id=this.data.url.split("vine.co/v/")[1],t="https://vine.co/v/"+this.media_id+"/embed/simple",this._el.content_item.innerHTML="<iframe frameborder='0' width='100%' height='100%' src='"+t+"'></iframe><script async src='http://platform.vine.co/static/scripts/embed.js' charset='utf-8'><\/script>",this.onLoaded()},_updateMediaDisplay:function(){var t=VCO.Util.ratio.square({w:this._el.content_item.offsetWidth,h:this.options.height});this._el.content_item.style.height=t.h+"px"}}),VCO.Media.Website=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){this.loadingMessage(),this._el.content_item=VCO.Dom.create("div","vco-media-item vco-media-blockquote",this._el.content),this._el.content_container.className="vco-media-content-container vco-media-content-container-text",this.media_id=this.data.url,this._el.content_item.innerHTML="<a target='_blank' href='"+this.media_id+"'> "+this.media_id+"</a>",this.onLoaded()},updateMediaDisplay:function(){},_updateMediaDisplay:function(){}}),VCO.Media.Wikipedia=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){var t,n=this;this.loadingMessage(),this._el.content_item=VCO.Dom.create("div","vco-media-item vco-media-wikipedia",this._el.content),this._el.content_container.className="vco-media-content-container vco-media-content-container-text",this.media_id=this.data.url.split("wiki/")[1].split("#")[0].replace("_"," "),this.media_id=this.media_id.replace(" ","%20"),t="http://"+this.data.url.split("//")[1].split(".wikipedia")[0]+".wikipedia.org/w/api.php?action=query&prop=extracts&redirects=&titles="+this.media_id+"&exintro=1&format=json&callback=?",VCO.ajax({type:"GET",url:t,dataType:"json",success:function(t){n.createMedia(t)},error:function(t,e){var i="";i+="Unable to load Wikipedia entry. <br/>"+n.media_id+"<br/>"+e,n.loadErrorDisplay(i)}})},createMedia:function(t){var e,i="";if(t.query){(i={entry:{},title:"",text:"",extract:"",paragraphs:1,text_array:[]}).entry=VCO.Util.getObjectAttributeByIndex(t.query.pages,0),i.extract=i.entry.extract,i.title=i.entry.title,i.extract.match("<p>")?i.text_array=i.extract.split("<p>"):i.text_array.push(i.extract);for(var n=0;n<i.text_array.length;n++)n+1<=i.paragraphs&&n+1<i.text_array.length&&(i.text+="<p>"+i.text_array[n+1]);e="<h4><a href='"+this.data.url+"' target='_blank'>"+i.title+"</a></h4>",e+="<span class='wiki-source'>"+this._("wikipedia")+"</span>",e+=i.text,i.extract.match("REDIRECT")||(this._el.content_item.innerHTML=e,this.onLoaded())}},updateMediaDisplay:function(){},_updateMediaDisplay:function(){}}),VCO.Media.YouTube=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){var t,e=this;this.loadingMessage(),this.youtube_loaded=!1,this._el.content_item=VCO.Dom.create("div","vco-media-item vco-media-youtube vco-media-shadow",this._el.content),this._el.content_item.id=VCO.Util.unique_ID(7),t=VCO.Util.getUrlVars(this.data.url),this.media_id={},this.data.url.match("v=")?this.media_id.id=t.v:this.data.url.match("/embed/")?this.media_id.id=this.data.url.split("embed/")[1].split(/[?&]/)[0]:this.data.url.match(/v\/|v=|youtu\.be\//)?this.media_id.id=this.data.url.split(/v\/|v=|youtu\.be\//)[1].split(/[?&]/)[0]:trace("YOUTUBE IN URL BUT NOT A VALID VIDEO"),this.media_id.start=t.t,this.media_id.hd=t.hd,VCO.Load.js("https://www.youtube.com/player_api",function(){e.createMedia()})},_updateMediaDisplay:function(){this._el.content_item.style.height=VCO.Util.ratio.r16_9({w:this.options.width})+"px",this._el.content_item.style.width=this.options.width+"px"},_stopMedia:function(){if(this.youtube_loaded)try{this.player.pauseVideo()}catch(t){trace(t)}},createMedia:function(){var t,e,i;void 0!==this.media_id.start?(i=e=0,(t=this.media_id.start.toString()).match("m")?(e=parseInt(t.split("m")[0],10),i=parseInt(t.split("m")[1].split("s")[0],10),this.media_id.start=60*e+i):this.media_id.start=0):this.media_id.start=0,this.media_id.hd=void 0!==this.media_id.hd,this.createPlayer()},createPlayer:function(){var t=this;clearTimeout(this.timer),"undefined"!=typeof YT&&void 0!==YT.Player?this.player=new YT.Player(this._el.content_item.id,{playerVars:{enablejsapi:1,color:"white",autohide:1,showinfo:0,theme:"light",start:this.media_id.start,fs:0,rel:0},videoId:this.media_id.id,events:{onReady:function(){t.onPlayerReady(),t.onLoaded()},onStateChange:t.onStateChange}}):this.timer=setTimeout(function(){t.createPlayer()},1e3)},onPlayerReady:function(t){this.youtube_loaded=!0,this._el.content_item=document.getElementById(this._el.content_item.id),this.onMediaLoaded()},onStateChange:function(t){}}),VCO.Media.Slider=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){this._el.content_item=VCO.Dom.create("img","vco-media-item vco-media-image",this._el.content),this._el.content_item.src=this.data.url,this.onLoaded()}}),VCO.Media.Spotify=VCO.Media.extend({includes:[VCO.Events],_loadMedia:function(){var t,e;this.loadingMessage(),this._el.content_item=VCO.Dom.create("div","vco-media-item vco-media-iframe vco-media-spotify",this._el.content),this.data.url.match("open.spotify.com/track/")?this.media_id="spotify:track:"+this.data.url.split("open.spotify.com/track/")[1]:this.data.url.match("spotify:track:")?this.media_id=this.data.url:this.data.url.match("/playlist/")?(e=this.data.url.split("open.spotify.com/user/")[1].split("/playlist/")[0],this.media_id="spotify:user:"+e+":playlist:"+this.data.url.split("/playlist/")[1]):this.data.url.match(":playlist:")&&(this.media_id=this.data.url),t="http://embed.spotify.com/?uri="+this.media_id+"&theme=white&view=coverart",this.player=VCO.Dom.create("iframe","vco-media-shadow",this._el.content_item),this.player.width="100%",this.player.height="100%",this.player.frameBorder="0",this.player.src=t,this.onLoaded()},_updateMediaDisplay:function(t){var e=this.options.height,i=0,n=0,e=VCO.Browser.mobile?this.options.height/2:this.options.height-this.options.credit_height-this.options.caption_height-30;this._el.content_item.style.maxHeight="none",trace(e),trace(this.options.width),n=e>this.options.width?(trace("height is greater"),i=this.options.width+80+"px",this.options.width+"px"):(trace("width is greater"),trace(this.options.width),i=e+"px",e-80+"px"),this.player.style.width=n,this.player.style.height=i,this._el.credit&&(this._el.credit.style.width=n),this._el.caption&&(this._el.caption.style.width=n)},_stopMedia:function(){}}),VCO.Slide=VCO.Class.extend({includes:[VCO.Events,VCO.DomMixins,VCO.I18NMixins],_el:{},initialize:function(t,e,i){this._el={container:{},scroll_container:{},background:{},content_container:{},content:{}},this._media=null,this._mediaclass={},this._text={},this._state={loaded:!1},this.has={headline:!1,text:!1,media:!1,title:!1,background:{image:!1,color:!1,color_value:""}},this.has.title=i,this.data={uniqueid:null,background:null,start_date:null,end_date:null,location:null,text:null,media:null},this.options={duration:1e3,slide_padding_lr:40,ease:VCO.Ease.easeInSpline,width:600,height:600,skinny_size:650,media_name:""},this.active=!1,this.animator={},VCO.Util.mergeData(this.options,e),VCO.Util.mergeData(this.data,t),this._initLayout(),this._initEvents()},show:function(){this.animator=VCO.Animate(this._el.slider_container,{left:-(this._el.container.offsetWidth*n)+"px",duration:this.options.duration,easing:this.options.ease})},hide:function(){},setActive:function(t){this.active=t,this.active?(this.data.background&&this.fire("background_change",this.has.background),this.loadMedia()):this.stopMedia()},addTo:function(t){t.appendChild(this._el.container)},removeFrom:function(t){t.removeChild(this._el.container)},updateDisplay:function(t,e,i){this._updateDisplay(t,e,i)},loadMedia:function(){this._media&&!this._state.loaded&&(this._media.loadMedia(),this._state.loaded=!0)},stopMedia:function(){this._media&&this._state.loaded&&this._media.stopMedia()},getBackground:function(){return this.has.background},scrollToTop:function(){this._el.container.scrollTop=0},_initLayout:function(){var t="";this._el.container=VCO.Dom.create("div","vco-slide"),this.data.uniqueid&&(this._el.container.id=this.data.uniqueid),this._el.scroll_container=VCO.Dom.create("div","vco-slide-scrollable-container",this._el.container),this._el.content_container=VCO.Dom.create("div","vco-slide-content-container",this._el.scroll_container),this._el.content=VCO.Dom.create("div","vco-slide-content",this._el.content_container),this._el.background=VCO.Dom.create("div","vco-slide-background",this._el.container),this.data.background&&(this.data.background.url&&(this.has.background.image=!0,this._el.container.className+=" vco-full-image-background",this.has.background.color_value="#000",this._el.background.style.backgroundImage="url('"+this.data.background.url+"')",this._el.background.style.display="block"),this.data.background.color&&(this.has.background.color=!0,this._el.container.className+=" vco-full-color-background",this.has.background.color_value=this.data.background.color),this.data.background.text_background&&(this._el.container.className+=" vco-text-background")),this.data.media&&this.data.media.url&&""!=this.data.media.url&&(this.has.media=!0),this.data.text&&this.data.text.text&&(this.has.text=!0),this.data.text&&this.data.text.headline&&(this.has.headline=!0),this.has.media&&(this.data.media.mediatype=VCO.MediaType(this.data.media),this.options.media_name=this.data.media.mediatype.name,this.options.media_type=this.data.media.mediatype.type,this._media=new this.data.media.mediatype.cls(this.data.media,this.options)),(this.has.text||this.has.headline)&&(this._text=new VCO.Media.Text(this.data.text,{title:this.has.title,language:this.options.language}),this.data.end_date&&(t=" &mdash; "+this.data.end_date.getDisplayDate(this.getLanguage())),this.data.start_date&&(t=this.data.start_date.getDisplayDate(this.getLanguage())+t,this._text.addDateText(t))),this.has.text||this.has.headline||!this.has.media?this.has.headline&&this.has.media&&!this.has.text?(this._el.container.className+=" vco-slide-media-only",this._text.addTo(this._el.content),this._media.addTo(this._el.content)):this.has.text&&this.has.media?(this._media.addTo(this._el.content),this._text.addTo(this._el.content)):(this.has.text||this.has.headline)&&(this._el.container.className+=" vco-slide-text-only",this._text.addTo(this._el.content)):(this._el.container.className+=" vco-slide-media-only",this._media.addTo(this._el.content)),this.onLoaded()},_initEvents:function(){},_updateDisplay:function(t,e,i){var n,a=this.options.slide_padding_lr,s=this.options.slide_padding_lr;this.options.width=t||this._el.container.offsetWidth,n=this.options.width-2*this.options.slide_padding_lr,VCO.Browser.mobile&&this.options.width<=this.options.skinny_size?(s=a=0,n=this.options.width):"landscape"==i||(this.options.width,this.options.skinny_size),this._el.content.style.paddingLeft=a+"px",this._el.content.style.paddingRight=s+"px",this._el.content.style.width=n+"px",this.options.height=e||this._el.container.offsetHeight,this._media&&(!this.has.text&&this.has.headline?this._media.updateDisplay(n,this.options.height-this._text.headlineHeight(),i):this.has.text||this.has.headline?this._media.updateDisplay(n/2,this.options.height,i):this._media.updateDisplay(n,this.options.height,i))}}),VCO.SlideNav=VCO.Class.extend({includes:[VCO.Events,VCO.DomMixins],_el:{},initialize:function(t,e,i){this._el={container:{},content_container:{},icon:{},title:{},description:{}},this.mediatype={},this.data={title:"Navigation",description:"Description"},this.options={direction:"previous"},this.animator=null,VCO.Util.mergeData(this.options,e),VCO.Util.mergeData(this.data,t),this._el.container=VCO.Dom.create("div","vco-slidenav-"+this.options.direction),VCO.Browser.mobile&&this._el.container.setAttribute("ontouchstart"," "),this._initLayout(),this._initEvents(),i&&i.appendChild(this._el.container)},update:function(t){this._update(t)},setColor:function(t){this._el.content_container.className=t?"vco-slidenav-content-container vco-slidenav-inverted":"vco-slidenav-content-container"},_onMouseClick:function(){this.fire("clicked",this.options)},_update:function(t){this.data=VCO.Util.mergeData(this.data,t),""!=this.data.title&&(this._el.title.innerHTML=VCO.Util.unlinkify(this.data.title)),""!=this.data.date&&(this._el.description.innerHTML=VCO.Util.unlinkify(this.data.description))},_initLayout:function(){this._el.content_container=VCO.Dom.create("div","vco-slidenav-content-container",this._el.container),this._el.icon=VCO.Dom.create("div","vco-slidenav-icon",this._el.content_container),this._el.title=VCO.Dom.create("div","vco-slidenav-title",this._el.content_container),this._el.description=VCO.Dom.create("div","vco-slidenav-description",this._el.content_container),this._el.icon.innerHTML="&nbsp;",this._update()},_initEvents:function(){VCO.DomEvent.addListener(this._el.container,"click",this._onMouseClick,this)}}),VCO.StorySlider=VCO.Class.extend({includes:VCO.Events,initialize:function(t,e,i,n){this._el={container:{},background:{},slider_container_mask:{},slider_container:{},slider_item_container:{}},this._nav={},this._nav.previous={},this._nav.next={},this.slide_spacing=0,this._slides=[],this._swipable,this.preloadTimer,this._message,this.current_slide=0,this.data={},this.options={id:"",layout:"portrait",width:600,height:600,default_bg_color:{r:256,g:256,b:256},slide_padding_lr:40,start_at_slide:1,slide_default_fade:"0%",duration:1e3,ease:VCO.Ease.easeInOutQuint,dragging:!0,trackResize:!0},"object"==typeof t?(this._el.container=t,this.options.id=VCO.Util.unique_ID(6,"vco")):(this.options.id=t,this._el.container=VCO.Dom.get(t)),this._el.container.id||(this._el.container.id=this.options.id),this.animator=null,VCO.Util.mergeData(this.options,i),VCO.Util.mergeData(this.data,e),n&&this.init()},init:function(){this._initLayout(),this._initEvents(),this._initData(),this._updateDisplay(),this.goTo(this.options.start_at_slide),this._onLoaded()},updateDisplay:function(t,e,i,n){this._updateDisplay(t,e,i,n)},createSlide:function(t){this._createSlide(t)},createSlides:function(t){this._createSlides(t)},_createSlides:function(t){for(var e=0;e<t.length;e++)""==t[e].uniqueid&&(t[e].uniqueid=VCO.Util.unique_ID(6,"vco-slide")),0==e?this._createSlide(t[e],!0):this._createSlide(t[e],!1)},_createSlide:function(t,e){var i=new VCO.Slide(t,this.options,e);this._addSlide(i),this._slides.push(i)},_destroySlide:function(t){this._removeSlide(t);for(var e=0;e<this._slides.length;e++)this._slides[e]==t&&this._slides.splice(e,1)},_addSlide:function(t){t.addTo(this._el.slider_item_container),t.on("added",this._onSlideAdded,this),t.on("background_change",this._onBackgroundChange,this)},_removeSlide:function(t){t.removeFrom(this._el.slider_item_container),t.off("added",this._onSlideAdded,this),t.off("background_change",this._onBackgroundChange)},goToId:function(t,e,i){_n="string"==typeof t||t instanceof String?VCO.Util.findArrayNumberByUniqueID(t,this._slides,"uniqueid"):t,this.goTo(_n,e,i)},goTo:function(t,e,i){var n=this;this.changeBackground({color_value:"",image:!1}),this.preloadTimer&&clearTimeout(this.preloadTimer);for(var a=0;a<this._slides.length;a++)this._slides[a].setActive(!1);t<this._slides.length&&0<=t&&(this.current_slide=t,this.animator&&this.animator.stop(),this._swipable&&this._swipable.stopMomentum(),e?(this._el.slider_container.style.left=-this.slide_spacing*t+"px",this._onSlideChange(i)):this.animator=VCO.Animate(this._el.slider_container,{left:-this.slide_spacing*t+"px",duration:this.options.duration,easing:this.options.ease,complete:this._onSlideChange(i)}),this._slides[this.current_slide].setActive(!0),this._slides[this.current_slide+1]?(this.showNav(this._nav.next,!0),this._nav.next.update(this.getNavInfo(this._slides[this.current_slide+1]))):this.showNav(this._nav.next,!1),this._slides[this.current_slide-1]?(this.showNav(this._nav.previous,!0),this._nav.previous.update(this.getNavInfo(this._slides[this.current_slide-1]))):this.showNav(this._nav.previous,!1),this.preloadTimer=setTimeout(function(){n.preloadSlides()},this.options.duration))},preloadSlides:function(){this._slides[this.current_slide+1]&&(this._slides[this.current_slide+1].loadMedia(),this._slides[this.current_slide+1].scrollToTop()),this._slides[this.current_slide+2]&&(this._slides[this.current_slide+2].loadMedia(),this._slides[this.current_slide+2].scrollToTop()),this._slides[this.current_slide-1]&&(this._slides[this.current_slide-1].loadMedia(),this._slides[this.current_slide-1].scrollToTop()),this._slides[this.current_slide-2]&&(this._slides[this.current_slide-2].loadMedia(),this._slides[this.current_slide-2].scrollToTop())},getNavInfo:function(t){var e={title:"",description:""};return t.data.text&&t.data.text.headline&&(e.title=t.data.text.headline),e},next:function(){this.goTo(this.current_slide+1<this._slides.length?this.current_slide+1:this.current_slide)},previous:function(){this.goTo(0<=this.current_slide-1?this.current_slide-1:this.current_slide)},showNav:function(t,e){this.options.width<=500&&VCO.Browser.mobile||(e?t.show():t.hide())},changeBackground:function(t){var e;this.options.slide_default_fade,(e=t.color_value?VCO.Util.hexToRgb(t.color_value):this.options.default_bg_color).r,e.g,e.b;this._el.background.style.backgroundImage="none",this._el.background.style.backgroundColor=t.color_value?t.color_value:"transparent",e.r<255&&e.g<255&&e.b<255||t.image?(this._nav.next.setColor(!0),this._nav.previous.setColor(!0)):(this._nav.next.setColor(!1),this._nav.previous.setColor(!1))},_updateDisplay:function(t,e,i,n){var a,s=void 0===n?this.options.layout:n;this.options.layout=s,this.slide_spacing=2*this.options.width,this.options.width=t||this._el.container.offsetWidth,this.options.height=e||this._el.container.offsetHeight,a=this.options.height/2,this._nav.next.setPosition({top:a}),this._nav.previous.setPosition({top:a});for(var o=0;o<this._slides.length;o++)this._slides[o].updateDisplay(this.options.width,this.options.height,s),this._slides[o].setPosition({left:this.slide_spacing*o,top:0});this.goTo(this.current_slide,!0,!0)},_initLayout:function(){this._el.container.className+=" vco-storyslider",this._el.slider_container_mask=VCO.Dom.create("div","vco-slider-container-mask",this._el.container),this._el.background=VCO.Dom.create("div","vco-slider-background vco-animate",this._el.container),this._el.slider_container=VCO.Dom.create("div","vco-slider-container vcoanimate",this._el.slider_container_mask),this._el.slider_item_container=VCO.Dom.create("div","vco-slider-item-container",this._el.slider_container),this.options.width=this._el.container.offsetWidth,this.options.height=this._el.container.offsetHeight,this._nav.previous=new VCO.SlideNav({title:"Previous",description:"description"},{direction:"previous"}),this._nav.next=new VCO.SlideNav({title:"Next",description:"description"},{direction:"next"}),this._nav.next.addTo(this._el.container),this._nav.previous.addTo(this._el.container),this._el.slider_container.style.left="0px",VCO.Browser.touch&&(this._swipable=new VCO.Swipable(this._el.slider_container_mask,this._el.slider_container,{enable:{x:!0,y:!1},snap:!0}),this._swipable.enable(),this._message=new VCO.Message({},{message_class:"vco-message-full",message_icon_class:"vco-icon-swipe-left"}),this._message.updateMessage("Swipe to Navigate<br><span class='vco-button'>OK</span>"),this._message.addTo(this._el.container))},_initEvents:function(){this._nav.next.on("clicked",this._onNavigation,this),this._nav.previous.on("clicked",this._onNavigation,this),this._message&&this._message.on("clicked",this._onMessageClick,this),this._swipable&&(this._swipable.on("swipe_left",this._onNavigation,this),this._swipable.on("swipe_right",this._onNavigation,this),this._swipable.on("swipe_nodirection",this._onSwipeNoDirection,this))},_initData:function(){this._createSlides(this.data.slides)},_onBackgroundChange:function(t){var e=this._slides[this.current_slide].getBackground();this.changeBackground(t),this.fire("colorchange",e)},_onMessageClick:function(t){this._message.hide()},_onSwipeNoDirection:function(t){this.goTo(this.current_slide)},_onNavigation:function(t){"next"==t.direction||"left"==t.direction?this.next():"previous"!=t.direction&&"right"!=t.direction||this.previous(),this.fire("nav_"+t.direction,this.data)},_onSlideAdded:function(t){trace("slideadded"),this.fire("slideAdded",this.data)},_onSlideRemoved:function(t){this.fire("slideAdded",this.data)},_onSlideChange:function(t){t||this.fire("change",{current_slide:this.current_slide,uniqueid:this._slides[this.current_slide].data.uniqueid})},_onMouseClick:function(t){},_fireMouseEvent:function(t){var e;this._loaded&&(e="mouseenter"===(e=t.type)?"mouseover":"mouseleave"===e?"mouseout":e,this.hasEventListeners(e)&&("contextmenu"===e&&VCO.DomEvent.preventDefault(t),this.fire(e,{latlng:"something",layerPoint:"something else"})))},_onLoaded:function(){this.fire("loaded",this.data)}}),VCO.TimeNav=VCO.Class.extend({includes:[VCO.Events,VCO.DomMixins],_el:{},initialize:function(t,e,i,n){this._el={parent:{},container:{},slider:{},slider_background:{},line:{},marker_container_mask:{},marker_container:{},marker_item_container:{},timeaxis:{},timeaxis_background:{}},this.collapsed=!1,this._el.container="object"==typeof t?t:VCO.Dom.get(t),this.data={uniqueid:"",slides:[{uniqueid:"",background:{url:null,color:null,opacity:50},date:null,location:{lat:-9.143962,lon:38.731094,zoom:13,icon:"http://maps.gstatic.com/intl/en_us/mapfiles/ms/micons/blue-pushpin.png"},text:{headline:"Slideshow Example",text:"Example slideshow slide "},media:[{uniqueid:"",text:{headline:"Slideshow Example",text:""},media:{url:"http://2.bp.blogspot.com/-dxJbW0CG8Zs/TmkoMA5-cPI/AAAAAAAAAqw/fQpsz9GpFdo/s1600/voyage-dans-la-lune-1902-02-g.jpg",credit:"",caption:"",link:null,link_target:null}},{uniqueid:"",text:{headline:"Slideshow Example",text:""},media:{url:"http://2.bp.blogspot.com/-dxJbW0CG8Zs/TmkoMA5-cPI/AAAAAAAAAqw/fQpsz9GpFdo/s1600/voyage-dans-la-lune-1902-02-g.jpg",credit:"",caption:"",link:null,link_target:null}},{uniqueid:"",text:{headline:"Slideshow Example",text:""},media:{url:"http://2.bp.blogspot.com/-dxJbW0CG8Zs/TmkoMA5-cPI/AAAAAAAAAqw/fQpsz9GpFdo/s1600/voyage-dans-la-lune-1902-02-g.jpg",credit:"",caption:"",link:null,link_target:null}},{uniqueid:"",text:{headline:"Slideshow Example",text:""},media:{url:"http://2.bp.blogspot.com/-dxJbW0CG8Zs/TmkoMA5-cPI/AAAAAAAAAqw/fQpsz9GpFdo/s1600/voyage-dans-la-lune-1902-02-g.jpg",credit:"",caption:"",link:null,link_target:null}}]},{uniqueid:"",background:{url:null,color:null,opacity:50},date:null,location:{lat:-9.143962,lon:38.731094,zoom:13,icon:"http://maps.gstatic.com/intl/en_us/mapfiles/ms/micons/blue-pushpin.png"},text:{headline:"YouTube",text:"Just add a link to the video in the media field."},media:{url:"http://www.youtube.com/watch?v=lIvftGgps24",credit:"",caption:"",link:null,link_target:null}}]},this.options={width:600,height:600,duration:1e3,ease:VCO.Ease.easeInOutQuint,optimal_tick_width:50,scale_factor:2,marker_padding:5,timenav_height_min:150,marker_height_min:30,marker_width_min:100,zoom_sequence:[.5,1,2,3,5,8,13,21,34,55,89]},this.animator=null,this._markers=[],this._marker_ticks=[],this.current_marker=0,this.current_id="",this.timescale={},this.timeaxis={},this.axishelper={},this.max_rows=6,this.animate_css=!1,this._swipable,VCO.Util.mergeData(this.options,i),VCO.Util.mergeData(this.data,e),n&&this.init()},init:function(){this._initLayout(),this._initEvents(),this._initData(),this._updateDisplay(),this._onLoaded()},positionMarkers:function(){this._positionMarkers()},updateDisplay:function(t,e,i,n){this._updateDisplay(t,e,i,n)},_getTimeScale:function(){return this.max_rows=Math.round((this.options.height-this._el.timeaxis_background.offsetHeight-this.options.marker_padding)/this.options.marker_height_min),this.max_rows<1&&(this.max_rows=1),new VCO.TimeScale(this.data.scale,this.data.slides,this._el.container.offsetWidth,this.options.scale_factor,this.max_rows)},_updateTimeScale:function(t){this.options.scale_factor=t,this._updateDrawTimeline()},zoomIn:function(t){for(var e=1,i=0;i<this.options.zoom_sequence.length;i++)this.options.scale_factor==this.options.zoom_sequence[i]&&(e=this.options.scale_factor==this.options.zoom_sequence[this.options.zoom_sequence.length-1]?this.options.scale_factor:this.options.zoom_sequence[i+1]);this.options.scale_factor=e,this.goTo(this.current_marker,!this._updateDrawTimeline(!0),!0)},zoomOut:function(t){if(0<this.options.scale_factor){for(var e=1,i=0;i<this.options.zoom_sequence.length;i++)this.options.scale_factor==this.options.zoom_sequence[i]&&(e=this.options.scale_factor==this.options.zoom_sequence[0]?this.options.zoom_sequence[0]:this.options.zoom_sequence[i-1]);this.options.scale_factor=e,this.goTo(this.current_marker,!this._updateDrawTimeline(!0),!0)}},_createMarkers:function(t){for(var e=0;e<t.length;e++)t[e].marker_number=e,this._createMarker(t[e])},_createMarker:function(t){var e=new VCO.TimeMarker(t,this.options);this._addMarker(e),this._markers.push(e),this._marker_ticks.push(e.getTime())},_addMarker:function(t){t.addTo(this._el.marker_item_container),t.on("markerclick",this._onMarkerClick,this),t.on("added",this._onMarkerAdded,this)},_removeMarker:function(t){t.removeFrom(this._el.marker_item_container)},_positionMarkers:function(t){for(var e=0;e<this._markers.length;e++){var i=this.timescale.getPositionInfo(e);this._markers[e].setClass(t?"vco-timemarker vco-timemarker-fast":"vco-timemarker"),this._markers[e].setPosition({left:i.start}),this._markers[e].setWidth(i.width)}},_assignRowsToMarkers:function(){for(var t=this.options.height-this._el.timeaxis_background.offsetHeight-this.options.marker_padding,e=Math.floor(t/this.timescale.getNumberOfRows()-this.options.marker_padding),i=0;i<this._markers.length;i++){this._markers[i].setHeight(e);var n=this.timescale.getPositionInfo(i).row,a=Math.floor(n*(e+this.options.marker_padding))+this.options.marker_padding,s=t-a+this.options.marker_padding;this._markers[i].setRowPosition(a,s)}},_resetMarkersActive:function(){for(var t=0;t<this._markers.length;t++)this._markers[t].setActive(!1)},goToId:function(t,e,i){_n="string"==typeof t||t instanceof String?VCO.Util.findArrayNumberByUniqueID(t,this._markers,"uniqueid"):t,this.goTo(_n,e,i)},goTo:function(t,e,i){var n=this.options.ease,a=this.options.duration;this._resetMarkersActive(),this._markers[t].setActive(!0),this.animator&&this.animator.stop(),e?(this._el.slider.className="vco-timenav-slider",this._el.slider.style.left=-this._markers[t].getLeft()+this.options.width/2+"px"):i?(this._el.slider.className="vco-timenav-slider vco-timenav-slider-animate",this.animate_css=!0,this._el.slider.style.left=-this._markers[t].getLeft()+this.options.width/2+"px"):(this._el.slider.className="vco-timenav-slider",this.animator=VCO.Animate(this._el.slider,{left:-this._markers[t].getLeft()+this.options.width/2+"px",duration:a,easing:n})),this.current_marker=t,this.current_id=this._markers[t].data.uniqueid},_onLoaded:function(){this.fire("loaded",this.data)},_onMarkerAdded:function(t){this.fire("dateAdded",this.data)},_onMarkerRemoved:function(t){this.fire("dateRemoved",this.data)},_onMarkerClick:function(t){this.goTo(t.marker_number),this.fire("change",{uniqueid:t.uniqueid})},_onMouseScroll:function(t){var e=0,i=0,n={right:-(this.timescale.getPixelWidth()-this.options.width/2),left:this.options.width/2};(t=t||window.event).originalEvent&&(t=t.originalEvent),void 0!==t.wheelDeltaX&&(e=t.wheelDeltaY/6,e=Math.abs(t.wheelDeltaX)>Math.abs(t.wheelDeltaY)?t.wheelDeltaX/6:0),e&&(t.preventDefault&&t.preventDefault(),t.returnValue=!1),i=parseInt(this._el.slider.style.left.replace("px",""))+e,n.left<i?i=n.left:i<n.right&&(i=n.right),this.animate_css&&(this._el.slider.className="vco-timenav-slider",this.animate_css=!1),this._el.slider.style.left=i+"px"},_onDragMove:function(t){this.animate_css&&(this._el.slider.className="vco-timenav-slider",this.animate_css=!1)},_updateDisplay:function(t,e,i){t&&(this.options.width=t),e&&e!=this.options.height&&(this.options.height=e,this.timescale=this._getTimeScale()),this._assignRowsToMarkers(),this._el.slider_background.style.width=this.timescale.getPixelWidth()+this.options.width+"px",this._el.slider_background.style.left=-this.options.width/2+"px",this._el.slider.style.width=this.timescale.getPixelWidth()+this.options.width+"px",this._swipable.updateConstraint({top:!1,bottom:!1,left:this.options.width/2,right:-(this.timescale.getPixelWidth()-this.options.width/2)}),this.goTo(this.current_marker,!0)},_drawTimeline:function(t){this.timescale=this._getTimeScale(),this.timeaxis.drawTicks(this.timescale,this.options.optimal_tick_width,this._marker_ticks),this._positionMarkers(t),this._assignRowsToMarkers()},_updateDrawTimeline:function(t){var e,i=!1;return t?(e=new VCO.TimeScale(this.data.scale,this.data.slides,this._el.container.offsetWidth,this.options.scale_factor,this._max_rows),this.timescale.getMajorScale()==e.getMajorScale()&&this.timescale.getMinorScale()==e.getMinorScale()&&(i=!0)):i=!0,i?(this.timescale=this._getTimeScale(),this.timeaxis.positionTicks(this.timescale,this.options.optimal_tick_width),this._positionMarkers(),this._assignRowsToMarkers(),this._updateDisplay()):this._drawTimeline(!0),i},_initLayout:function(){this._el.line=VCO.Dom.create("div","vco-timenav-line",this._el.container),this._el.slider=VCO.Dom.create("div","vco-timenav-slider",this._el.container),this._el.slider_background=VCO.Dom.create("div","vco-timenav-slider-background",this._el.slider),this._el.marker_container_mask=VCO.Dom.create("div","vco-timenav-container-mask",this._el.slider),this._el.marker_container=VCO.Dom.create("div","vco-timenav-container",this._el.marker_container_mask),this._el.marker_item_container=VCO.Dom.create("div","vco-timenav-item-container",this._el.marker_container),this._el.timeaxis=VCO.Dom.create("div","vco-timeaxis",this._el.slider),this._el.timeaxis_background=VCO.Dom.create("div","vco-timeaxis-background",this._el.container),this.timeaxis=new VCO.TimeAxis(this._el.timeaxis,this.options),this._swipable=new VCO.Swipable(this._el.slider_background,this._el.slider,{enable:{x:!0,y:!1},constraint:{top:!1,bottom:!1,left:this.options.width/2,right:!1},snap:!1}),this._swipable.enable()},_initEvents:function(){this._swipable.on("dragmove",this._onDragMove,this),VCO.DomEvent.addListener(this._el.container,"mousewheel",this._onMouseScroll,this),VCO.DomEvent.addListener(this._el.container,"DOMMouseScroll",this._onMouseScroll,this)},_initData:function(){this._createMarkers(this.data.slides),this._drawTimeline()}}),VCO.TimeMarker=VCO.Class.extend({includes:[VCO.Events,VCO.DomMixins],_el:{},initialize:function(t,e){this._el={container:{},content_container:{},media_container:{},timespan:{},line_left:{},line_right:{},content:{},text:{},media:{}},this._text={},this._state={loaded:!1},this.data={uniqueid:"",marker_number:0,background:null,date:{year:0,month:0,day:0,hour:0,minute:0,second:0,millisecond:0,thumbnail:"",format:""},text:{headline:"",text:""},media:null},this.options={duration:1e3,ease:VCO.Ease.easeInSpline,width:600,height:600,marker_width_min:100},this.active=!1,this.animator={},this.has_end_date=!1,VCO.Util.mergeData(this.options,e),VCO.Util.mergeData(this.data,t),this._initLayout(),this._initEvents()},show:function(){},hide:function(){},setActive:function(t){this.active=t,this._el.container.className=this.active&&this.has_end_date?"vco-timemarker vco-timemarker-with-end vco-timemarker-active":this.active?"vco-timemarker vco-timemarker-active":this.has_end_date?"vco-timemarker vco-timemarker-with-end":"vco-timemarker"},addTo:function(t){t.appendChild(this._el.container)},removeFrom:function(t){t.removeChild(this._el.container)},updateDisplay:function(t,e){this._updateDisplay(t,e)},loadMedia:function(){this._media&&!this._state.loaded&&(this._media.loadMedia(),this._state.loaded=!0)},stopMedia:function(){this._media&&this._state.loaded&&this._media.stopMedia()},getLeft:function(){return this._el.container.style.left.slice(0,-2)},getTime:function(){return this.data.start_date.getTime()},getEndTime:function(){return!!this.data.end_date&&this.data.end_date.getTime()},setHeight:function(t){var e=1;this._el.content_container.style.height=t+"px",this._el.timespan_content.style.height=t+"px",this._el.content.className=t<=30?"vco-timemarker-content vco-timemarker-content-small":"vco-timemarker-content",VCO.Browser.webkit?((e=Math.floor(t/14))<1&&(e=1),this._text.className="vco-headline",this._text.style.webkitLineClamp=e):(e=t/12,this._text.className=1<e?"vco-headline vco-headline-fadeout":"vco-headline",this._text.style.height=12*e+"px")},setWidth:function(t){this.data.end_date&&(this._el.container.style.width=t+"px",this._el.content_container.style.width=t>this.options.marker_width_min?t+"px":this.options.marker_width_min+"px")},setClass:function(t){this._el.container.className=t},setRowPosition:function(t,e){this.setPosition({top:t}),this._el.timespan.style.height=e+"px"},_onMarkerClick:function(t){this.fire("markerclick",{marker_number:this.data.marker_number,uniqueid:this.data.uniqueid})},_initLayout:function(){var t;this._el.container=VCO.Dom.create("div","vco-timemarker"),this.data.uniqueid&&(this._el.container.id=this.data.uniqueid+"-marker"),this.data.end_date&&(this.has_end_date=!0,this._el.container.className="vco-timemarker vco-timemarker-with-end"),this._el.timespan=VCO.Dom.create("div","vco-timemarker-timespan",this._el.container),this._el.timespan_content=VCO.Dom.create("div","vco-timemarker-timespan-content",this._el.timespan),this._el.content_container=VCO.Dom.create("div","vco-timemarker-content-container",this._el.container),this._el.content=VCO.Dom.create("div","vco-timemarker-content",this._el.content_container),this._el.line_left=VCO.Dom.create("div","vco-timemarker-line-left",this._el.timespan),this._el.line_right=VCO.Dom.create("div","vco-timemarker-line-right",this._el.timespan),this.data.media&&(this._el.media_container=VCO.Dom.create("div","vco-timemarker-media-container",this._el.content),this.data.media.thumb&&""!=this.data.media.thumb?(this._el.media=VCO.Dom.create("img","vco-timemarker-media",this._el.media_container),this._el.media.src=this.data.media.thumb):(t=VCO.MediaType(this.data.media).type,this._el.media=VCO.Dom.create("span","vco-icon-"+t,this._el.media_container))),this._el.text=VCO.Dom.create("div","vco-timemarker-text",this._el.content),this._text=VCO.Dom.create("h2","vco-headline",this._el.text),this.data.text.headline&&""!=this.data.text.headline?this._text.innerHTML=VCO.Util.unlinkify(this.data.text.headline):this.data.text.text&&""!=this.data.text.text?this._text.innerHTML=VCO.Util.unlinkify(this.data.text.text):this.data.media.caption&&""!=this.data.media.caption&&(this._text.innerHTML=VCO.Util.unlinkify(this.data.media.caption)),this.onLoaded()},_initEvents:function(){VCO.DomEvent.addListener(this._el.container,"click",this._onMarkerClick,this)},_updateDisplay:function(t,e,i){t&&(this.options.width=t),e&&(this.options.height=e)}}),VCO.TimeScale=VCO.Class.extend({initialize:function(t,e,i,n,a){this._scale=t||"javascript",this._display_width=i||500,this._screen_multiplier=n||3,this._pixel_width=this._screen_multiplier*this._display_width,this._positions=[],this._pixels_per_milli=0,this._earliest=e[0].start_date.getTime(),this._latest=e[e.length-1].start_date.getTime(),this._span_in_millis=this._latest-this._earliest,this._average=this._span_in_millis/e.length,this._pixels_per_milli=this.getPixelWidth()/this._span_in_millis,this._axis_helper=VCO.AxisHelper.getBestHelper(this),this._scaled_padding=1/this.getPixelsPerTick()*(this._display_width/2),this._computePositionInfo(e,a)},getScale:function(){return this._scale},getNumberOfRows:function(){return this._number_of_rows},getPixelWidth:function(){return this._pixel_width},getPosition:function(t){return(t-this._earliest)*this._pixels_per_milli},getPositionInfo:function(t){return this._positions[t]},getPixelsPerTick:function(){return this._axis_helper.getPixelsPerTick(this._pixels_per_milli)},getTicks:function(){return{major:this._axis_helper.getMajorTicks(this),minor:this._axis_helper.getMinorTicks(this)}},getDateFromTime:function(t){if("javascript"==this._scale)return new VCO.Date(t);if("cosmological"==this._scale)return new VCO.BigDate(new VCO.BigYear(t));throw"Don't know how to get date from time for "+this._scale},getMajorScale:function(){return this._axis_helper.major.name},getMinorScale:function(){return this._axis_helper.minor.name},_computePositionInfo:function(t,e,i){i=i||100;for(var n=[],a=0;a<t.length;a++){var s,o={start:this.getPosition(t[a].start_date.getTime())};this._positions.push(o),void 0!==t[a].end_date?(s=this.getPosition(t[a].end_date.getTime()),o.width=s-o.start,o.end=o.width>i?o.start+o.width:o.start+i):(o.width=i,o.end=o.start+i)}for(a=0;a<this._positions.length;a++){for(var r,h,o=this._positions[a],l=[],c=0;c<n.length;c++)if(l.push(n[c].end-o.start),l[c]<=0){n[o.row=c]=o;break}void 0===o.row&&(!e||n.length<e?(o.row=n.length,n.push(o)):(r=Math.min.apply(null,l),h=l.indexOf(r),o.row=h,o.end>n[h].end&&(n[h]=o)))}this._number_of_rows=n.length}}),VCO.TimeAxis=VCO.Class.extend({includes:[VCO.Events,VCO.DomMixins,VCO.I18NMixins],_el:{},initialize:function(t,e){this._el={container:{},content_container:{},major:{},minor:{}},this._text={},this._state={loaded:!1},this.data={},this.options={duration:1e3,ease:VCO.Ease.easeInSpline,width:600,height:600},this.active=!1,this.animator={},this.axis_helper={},this.minor_ticks=[],this.major_ticks=[],this.dateformat_lookup={millisecond:1,second:"time_short",minute:"time_no_seconds_short",hour:"time_no_minutes_short",day:"full_short",month:"month_short",year:"year",decade:"year",century:"year",millennium:"year",age:"compact",epoch:"compact",era:"compact",eon:"compact",eon2:"compact"},this._el.container="object"==typeof t?t:VCO.Dom.get(t),VCO.Util.mergeData(this.options,e),this._initLayout(),this._initEvents()},show:function(){},hide:function(){},addTo:function(t){t.appendChild(this._el.container)},removeFrom:function(t){t.removeChild(this._el.container)},updateDisplay:function(t,e){this._updateDisplay(t,e)},getLeft:function(){return this._el.container.style.left.slice(0,-2)},drawTicks:function(t,e,i){var n=t.getTicks();this._el.minor,this.dateformat_lookup[n.minor.name],n.minor.ticks,this.minor_ticks,this._el.major,this.dateformat_lookup[n.major.name],n.major.ticks,this.major_ticks;this._el.major.className="vco-timeaxis-major",this._el.minor.className="vco-timeaxis-minor",this._el.major.style.opacity=0,this._el.minor.style.opacity=0,this.major_ticks=this._createTickElements(n.major.ticks,this._el.major,this.dateformat_lookup[n.major.name]),this.minor_ticks=this._createTickElements(n.minor.ticks,this._el.minor,this.dateformat_lookup[n.minor.name],n.major.ticks),this.positionTicks(t,e,!0),this._el.major.className="vco-timeaxis-major vco-animate-opacity vco-timeaxis-animate-opacity",this._el.minor.className="vco-timeaxis-minor vco-animate-opacity vco-timeaxis-animate-opacity",this._el.major.style.opacity=1,this._el.minor.style.opacity=1},_createTickElements:function(t,e,i,n){e.innerHTML="";var a={};if(n)for(idx in n)a[n[idx].getTime()]=!0;for(var s=[],o=0;o<t.length;o++){var r,h,l=t[o];l.getTime()in a||(r=VCO.Dom.create("div","vco-timeaxis-tick",e),(h=VCO.Dom.create("span","vco-timeaxis-tick-text vco-animate-opacity",r)).innerHTML=l.getDisplayDate(this.getLanguage(),i),s.push({tick:r,tick_text:h,display_text:l.getDisplayDate(this.getLanguage(),i),date:l}))}return s},positionTicks:function(t,e,i){i?(this._el.major.className="vco-timeaxis-major",this._el.minor.className="vco-timeaxis-minor"):(this._el.major.className="vco-timeaxis-major vco-timeaxis-animate",this._el.minor.className="vco-timeaxis-minor vco-timeaxis-animate"),this._positionTickArray(this.major_ticks,t,e),this._positionTickArray(this.minor_ticks,t,e)},_positionTickArray:function(t,e,i){if(t[1]&&t[0]){var n=1;e.getPosition(t[1].date.getMillisecond())-e.getPosition(t[0].date.getMillisecond())<i&&(n=Math.round(i/e.getPixelsPerTick()));for(var a=1,s=0;s<t.length;s++){var o=t[s];o.tick.style.left=e.getPosition(o.date.getMillisecond())+"px",o.tick_text.innerHTML=o.display_text,1<n?n<=a?(a=1,o.tick_text.style.opacity=1):(a++,o.tick_text.style.opacity=0):o.tick_text.style.opacity=1}}},_initLayout:function(){this._el.content_container=VCO.Dom.create("div","vco-timeaxis-content-container",this._el.container),this._el.major=VCO.Dom.create("div","vco-timeaxis-major",this._el.content_container),this._el.minor=VCO.Dom.create("div","vco-timeaxis-minor",this._el.content_container),this.onLoaded()},_initEvents:function(){},_updateDisplay:function(t,e,i){t&&(this.options.width=t),e&&(this.options.height=e)}}),VCO.AxisHelper=VCO.Class.extend({initialize:function(t){if(!t)throw"Axis helper must be configured with options";this.scale=t.scale,this.minor=t.minor,this.major=t.major},getPixelsPerTick:function(t){return t*this.minor.factor},getMajorTicks:function(t){return this._getTicks(t,this.major)},getMinorTicks:function(t){return this._getTicks(t,this.minor)},_getTicks:function(t,e){for(var i=t._scaled_padding*e.factor,n=t._earliest-i,a=t._latest+i,s=[],o=n;o<a;o+=e.factor)s.push(t.getDateFromTime(o).floor(e.name));return window.ticks=s,window.axis_helper=this,{name:e.name,ticks:s}}}),function(s){function t(t,e){h[t]=[];for(var i=0;i<e.length-1;i++){var n=e[i],a=e[i+1];h[t].push(new s({scale:n[3],minor:{name:n[0],factor:n[1]},major:{name:a[0],factor:a[1]}}))}}var h={};t("javascript",VCO.Date.SCALES),t("cosmological",VCO.BigDate.SCALES),s.HELPERS=h,s.getBestHelper=function(t,e){"number"!=typeof e&&(e=100);var i=t.getScale(),n=h[i];if(!n)throw"No AxisHelper available for "+i;var a=null;for(var s in n){var o=n[s],r=o.getPixelsPerTick(t._pixels_per_milli);if(e<r)return null==a?o:Math.abs(e-r)<Math.abs(e-r)?o:a;a=o}return n[n.length-1]}}(VCO.AxisHelper),VCO.Timeline=VCO.Class.extend({includes:VCO.Events,initialize:function(t,e,i){var n=this;this.version="0.0.20",this.ready=!1,this._el={container:{},storyslider:{},timenav:{},menubar:{}},this._el.container="object"==typeof t?t:VCO.Dom.get(t),this._storyslider={},this._style_sheet=new VCO.StyleSheet,this._timenav={},this._menubar={},this._loaded={storyslider:!1,timenav:!1},this.config=null,this.options={script_path:"",height:this._el.container.offsetHeight,width:this._el.container.offsetWidth,theme_color:!1,hash_bookmark:!1,default_bg_color:{r:255,g:255,b:255},scale_factor:2,layout:"landscape",timenav_position:"bottom",optimal_tick_width:60,base_class:"",timenav_height:150,timenav_height_percentage:25,timenav_height_min:150,marker_height_min:30,marker_width_min:100,marker_padding:5,start_at_slide:0,menubar_height:0,skinny_size:650,relative_date:!1,use_bc:!1,duration:1e3,ease:VCO.Ease.easeInOutQuint,dragging:!0,trackResize:!0,map_type:"stamen:toner-lite",slide_padding_lr:100,slide_default_fade:"0%",zoom_sequence:[.5,1,2,3,5,8,13,21,34,55,89],api_key_flickr:"f2cc870b4d233dd0a5bfe73fd0d64ef0",language:"en"},this.current_slide=this.options.start_at_slide,this.animator_timenav=null,this.animator_storyslider=null,this.animator_menubar=null,VCO.Util.mergeData(this.options,i),!this.options.relative_date||"undefined"!=typeof moment?n._loadLanguage(e):VCO.Load.js(this.options.script_path+"/library/moment.js",function(){n._loadLanguage(e),trace("LOAD MOMENTJS")}),this.options.theme_color&&this._applyCustomColor(this.options.theme_color)},_loadLanguage:function(t){this.options.language=new VCO.Language(this.options),this._initData(t)},goToId:function(t){this.current_id!=t&&(this.current_id=t,this._timenav.goToId(this.current_id),this._storyslider.goToId(this.current_id,!1,!0),this.fire("change",{uniqueid:this.current_id},this))},goTo:function(t){t!=this.current_slide&&(this.current_slide=t,this._timenav.goTo(this.current_slide),this._storyslider.goTo(this.current_slide))},updateDisplay:function(){this.ready&&this._updateDisplay()},_calculateTimeNavHeight:function(t,e){var i=0;return t?i=t:(this.options.timenav_height_percentage||e)&&(i=Math.round(e?this.options.height/100*e:this.options.height/100*this.options.timenav_height_percentage)),i<this.options.timenav_height_min&&(i=this.options.timenav_height_min),i-2*this.options.marker_padding},_updateDisplay:function(t,e,i){var n,a=this.options.duration,s=this.options.base_class;i&&(a=i),this.options.width=this._el.container.offsetWidth,this.options.height=this._el.container.offsetHeight,this.options.layout=this.options.width<=this.options.skinny_size?"portrait":"landscape",VCO.Browser.touch&&(this.options.layout=VCO.Browser.orientation()),VCO.Browser.mobile?(s+=" vco-mobile",this.options.timenav_height=this._calculateTimeNavHeight(t,40)):this.options.timenav_height=this._calculateTimeNavHeight(t),"portrait"==this.options.layout?(s+=" vco-skinny",s+=" vco-layout-portrait"):s+=" vco-layout-landscape",this.options.storyslider_height=this.options.height-this.options.timenav_height,n=Math.round(this.options.storyslider_height+1+Math.ceil(this.options.timenav_height)/2-this._el.menubar.offsetHeight/2-17.5),e?(this._el.timenav.style.height=Math.ceil(this.options.timenav_height)+"px",this.animator_storyslider&&this.animator_storyslider.stop(),this.animator_storyslider=VCO.Animate(this._el.storyslider,{height:this.options.storyslider_height+"px",duration:a/2,easing:VCO.Ease.easeOutStrong}),this.animator_menubar&&this.animator_menubar.stop(),this.animator_menubar=VCO.Animate(this._el.menubar,{top:n+"px",duration:a/2,easing:VCO.Ease.easeOutStrong})):(this._el.timenav.style.height=Math.ceil(this.options.timenav_height)+"px",this._el.storyslider.style.height=this.options.storyslider_height+"px",this._el.menubar.style.top=n+"px"),this._timenav.updateDisplay(this.options.width,this.options.timenav_height,e),this._storyslider.updateDisplay(this.options.width,this.options.storyslider_height,e,this.options.layout),this._el.container.className=s},_updateHashBookmark:function(t){window.location.hash="#event-"+t.toString(),this.fire("hash_updated",{uniqueid:this.current_id,hashbookmark:"#event-"+t.toString()},this)},_applyCustomColor:function(t){var e=VCO.Util.hexToRgb(t);this._style_sheet.addRule(".vco-timemarker.vco-timemarker-active .vco-timemarker-content-container,.vco-timemarker.vco-timemarker-active .vco-timemarker-timespan .vco-timemarker-timespan-content,.vco-timemarker.vco-timemarker-with-end.vco-timemarker-active .vco-timemarker-line-left:after,.vco-timemarker.vco-timemarker-with-end.vco-timemarker-active .vco-timemarker-line-right:after,.vco-timemarker.vco-timemarker-active .vco-timemarker-line-left:after,.vco-timemarker.vco-timemarker-active .vco-timemarker-line-right:after,.vco-menubar-button:hover","background-color:"+t+" !important;"),this._style_sheet.addRule(".vco-timemarker.vco-timemarker-active .vco-timemarker-timespan","background-color:rgba("+e.r+","+e.g+","+e.b+",.15) !important;"),this._style_sheet.addRule(".vco-timemarker.vco-timemarker-with-end.vco-timemarker-active .vco-timemarker-timespan:after","background-color:rgba("+e.r+","+e.g+","+e.b+",.5) !important;"),this._style_sheet.addRule(".vco-timemarker.vco-timemarker-active .vco-timemarker-line-left, .vco-timemarker.vco-timemarker-active .vco-timemarker-line-right","border-color:"+t+" !important;"),this._style_sheet.addRule('.vco-timemarker.vco-timemarker-active .vco-timemarker-content-container .vco-timemarker-content .vco-timemarker-media-container [class^=vco-icon-], .vco-timemarker.vco-timemarker-active .vco-timemarker-content-container .vco-timemarker-content .vco-timemarker-media-container [class*=" vco-icon-"]',"color:rgba(255,255,255,.7) !important;"),this._style_sheet.addRule(".vco-timemarker.vco-timemarker-active .vco-timemarker-content-container .vco-timemarker-content .vco-timemarker-text h2.vco-headline.vco-headline-fadeout:after"," background: linear-gradient(to bottom, rgba("+e.r+","+e.g+","+e.b+",.15) 0px, "+t+" 80%) repeat scroll 0% 0% transparent !important;")},_initData:function(t){var e=this;VCO.TimelineConfig==t.constructor?(e.config=t,e._onDataLoaded()):e.config=new VCO.TimelineConfig(t,function(){e._onDataLoaded()})},_initLayout:function(){this._el.container.className+=" vco-timeline",this.options.base_class=this._el.container.className,this._el.container.innerHTML="","top"==this.options.timenav_position?(this._el.timenav=VCO.Dom.create("div","vco-timenav",this._el.container),this._el.storyslider=VCO.Dom.create("div","vco-storyslider",this._el.container)):(this._el.storyslider=VCO.Dom.create("div","vco-storyslider",this._el.container),this._el.timenav=VCO.Dom.create("div","vco-timenav",this._el.container)),this._el.menubar=VCO.Dom.create("div","vco-menubar",this._el.container),this.options.width=this._el.container.offsetWidth,this.options.height=this._el.container.offsetHeight,this._el.storyslider.style.top="1px",this.options.timenav_height=this._calculateTimeNavHeight(),this._timenav=new VCO.TimeNav(this._el.timenav,this.config,this.options),this._timenav.on("loaded",this._onTimeNavLoaded,this),this._timenav.options.height=this.options.timenav_height,this._timenav.init(),this._storyslider=new VCO.StorySlider(this._el.storyslider,this.config,this.options),this._storyslider.on("loaded",this._onStorySliderLoaded,this),this._storyslider.init(),this._menubar=new VCO.MenuBar(this._el.menubar,this._el.container,this.options),this.options.storyslider_height="portrait"==this.options.layout?this.options.height-this.options.timenav_height-1:this.options.height-1,this._updateDisplay(!1,!0,2e3)},_initEvents:function(){this._timenav.on("change",this._onTimeNavChange,this),this._storyslider.on("change",this._onSlideChange,this),this._storyslider.on("colorchange",this._onColorChange,this),this._menubar.on("zoom_in",this._onZoomIn,this),this._menubar.on("zoom_out",this._onZoomOut,this),this._menubar.on("back_to_start",this._onBackToStart,this)},_getCurrentSlide:function(t,e){return _n="string"==typeof t||t instanceof String?VCO.Util.findArrayNumberByUniqueID(t,e,"uniqueid"):t},_onDataLoaded:function(t){this.fire("dataloaded"),this._initLayout(),this._initEvents(),this.ready=!0},_onColorChange:function(t){this.fire("color_change",{uniqueid:this.current_id},this),t.color||t.image},_onSlideChange:function(t){this.current_id!=t.uniqueid&&(this.current_id=t.uniqueid,this._timenav.goToId(this.current_id),this._onChange(t))},_onTimeNavChange:function(t){this.current_id!=t.uniqueid&&(this.current_id=t.uniqueid,this._storyslider.goToId(this.current_id),this._onChange(t))},_onChange:function(t){this.fire("change",{uniqueid:this.current_id},this),this.options.hash_bookmark&&this._updateHashBookmark(this.current_id)},_onBackToStart:function(t){this._storyslider.goTo(0),this.fire("back_to_start",{uniqueid:this.current_id},this)},_onZoomIn:function(t){this._timenav.zoomIn(),this.fire("zoom_in",{zoom_level:this._timenav.options.scale_factor},this)},_onZoomOut:function(t){this._timenav.zoomOut(),this.fire("zoom_out",{zoom_level:this._timenav.options.scale_factor},this)},_onTimeNavLoaded:function(){this._loaded.timenav=!0,this._onLoaded()},_onStorySliderLoaded:function(){this._loaded.storyslider=!0,this._onLoaded()},_onLoaded:function(){this._loaded.storyslider&&this._loaded.timenav&&(this.fire("loaded",this.config),this.options.hash_bookmark&&""!=window.location.hash?this.goToId(window.location.hash.replace("#event-","")):(this.goTo(this.options.start_at_slide),this.current_id=this._timenav.current_id,this.options.hash_bookmark&&this._updateHashBookmark(this.current_id)))}});
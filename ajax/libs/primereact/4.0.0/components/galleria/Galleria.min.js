"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Galleria=void 0;var _react=_interopRequireWildcard(require("react")),_reactDom=_interopRequireDefault(require("react-dom")),_propTypes=_interopRequireDefault(require("prop-types")),_classnames=_interopRequireDefault(require("classnames")),_UniqueComponentId=_interopRequireDefault(require("../utils/UniqueComponentId")),_GalleriaPreview=require("./GalleriaPreview"),_GalleriaThumbnails=require("./GalleriaThumbnails"),_DomHandler=_interopRequireDefault(require("../utils/DomHandler"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _getRequireWildcardCache(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return _getRequireWildcardCache=function(){return e},e}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t=_getRequireWildcardCache();if(t&&t.has(e))return t.get(e);var r={};if(null!=e){var i,o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e){Object.prototype.hasOwnProperty.call(e,n)&&((i=o?Object.getOwnPropertyDescriptor(e,n):null)&&(i.get||i.set)?Object.defineProperty(r,n,i):r[n]=e[n])}}return r.default=e,t&&t.set(e,r),r}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ownKeys(t,e){var r,i=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)),i}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(r,!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Galleria=function(){function r(e){var t;return _classCallCheck(this,r),(t=_possibleConstructorReturn(this,_getPrototypeOf(r).call(this,e))).state={visible:!1,slideShowActive:!1},t.props.onItemChange||(t.state=_objectSpread({},t.state,{activeIndex:e.activeIndex})),t.onActiveItemChange=t.onActiveItemChange.bind(_assertThisInitialized(t)),t.show=t.show.bind(_assertThisInitialized(t)),t.hide=t.hide.bind(_assertThisInitialized(t)),t.startSlideShow=t.startSlideShow.bind(_assertThisInitialized(t)),t.stopSlideShow=t.stopSlideShow.bind(_assertThisInitialized(t)),t.id=t.props.id||(0,_UniqueComponentId.default)(),t}return _inherits(r,_react.Component),_createClass(r,[{key:"onActiveItemChange",value:function(e){this.props.onItemChange?this.props.onItemChange(e):this.setState({activeIndex:e.index})}},{key:"show",value:function(){var e=this;this.props.fullScreen&&_DomHandler.default.addClass(document.body,"p-overflow-hidden"),this.setState({visible:!0},function(){e.mask&&(e.mask.style.zIndex=String(e.props.baseZIndex+_DomHandler.default.generateZIndex()))})}},{key:"hide",value:function(){this.props.fullScreen&&_DomHandler.default.removeClass(document.body,"p-overflow-hidden"),this.setState({visible:!1})}},{key:"isAutoPlayActive",value:function(){return this.state.slideShowActive}},{key:"startSlideShow",value:function(){var t=this;this.interval=setInterval(function(){var e=t.props.circular&&t.props.value.length-1===t.activeItemIndex?0:t.activeItemIndex+1;t.onActiveItemChange({index:e})},this.props.transitionInterval),this.setState({slideShowActive:!0})}},{key:"stopSlideShow",value:function(){this.interval&&clearInterval(this.interval),this.setState({slideShowActive:!1})}},{key:"getPositionClassName",value:function(e,t){var r=["top","left","bottom","right"].find(function(e){return e===t});return r?"".concat(e,"-").concat(r):""}},{key:"isVertical",value:function(){return"left"===this.props.thumbnailsPosition||"right"===this.props.thumbnailsPosition}},{key:"componentWillUnmount",value:function(){this.state.slideShowActive&&this.stopSlideShow()}},{key:"renderHeader",value:function(){return this.props.header?_react.default.createElement("div",{className:"p-galleria-header"},this.props.header):null}},{key:"renderFooter",value:function(){return this.props.footer?_react.default.createElement("div",{className:"p-galleria-footer"},this.props.footer):null}},{key:"renderElement",value:function(){var t=this,e=this.isVertical(),r=this.props.showThumbnails&&this.getPositionClassName("p-galleria-thumbnails",this.props.thumbnailsPosition),i=this.props.showIndicators&&this.getPositionClassName("p-galleria-indicators",this.props.indicatorsPosition),o=(0,_classnames.default)("p-galleria p-component",this.props.className,{"p-galleria-fullscreen":this.props.fullScreen,"p-galleria-indicator-onpreview":this.props.showIndicatorsOnPreview,"p-galleria-preview-nav-onhover":this.props.showNavButtonsOnPreviewHover&&!this.props.fullScreen},r,i),n=this.props.fullScreen&&_react.default.createElement("button",{type:"button",className:"p-galleria-close p-link",onClick:this.hide},_react.default.createElement("span",{className:"p-galleria-close-icon pi pi-times"})),a=this.renderHeader(),s=this.renderFooter();return _react.default.createElement("div",{id:this.id,className:o,style:this.props.style},n,a,_react.default.createElement("div",{className:"p-galleria-content"},_react.default.createElement(_GalleriaPreview.GalleriaPreview,{ref:function(e){return t.previewContent=_reactDom.default.findDOMNode(e)},value:this.props.value,activeItemIndex:this.activeItemIndex,onActiveItemChange:this.onActiveItemChange,itemTemplate:this.props.previewItemTemplate,circular:this.props.circular,captionTemplate:this.props.captionTemplate,showIndicators:this.props.showIndicators,changePreviewOnIndicatorHover:this.props.changePreviewOnIndicatorHover,indicatorItemTemplate:this.props.indicatorItemTemplate,showPreviewNavButtons:this.props.showPreviewNavButtons,autoPlay:this.props.autoPlay,slideShowActive:this.state.slideShowActive,startSlideShow:this.startSlideShow,stopSlideShow:this.stopSlideShow}),this.props.showThumbnails&&_react.default.createElement(_GalleriaThumbnails.GalleriaThumbnails,{containerId:this.id,value:this.props.value,activeItemIndex:this.activeItemIndex,onActiveItemChange:this.onActiveItemChange,itemTemplate:this.props.thumbnailItemTemplate,numVisible:this.props.numVisible,responsiveOptions:this.props.responsiveOptions,circular:this.props.circular,isVertical:e,contentHeight:this.props.verticalThumbnailViewPortHeight,showThumbnailNavButtons:this.props.showThumbnailNavButtons,autoPlay:this.props.autoPlay,slideShowActive:this.state.slideShowActive,stopSlideShow:this.stopSlideShow})),s)}},{key:"renderGalleria",value:function(){var t=this,e=this.renderElement();if(this.props.fullScreen){var r=(0,_classnames.default)("p-galleria-mask p-component-overlay",{"p-galleria-visible":this.state.visible}),i=_react.default.createElement("div",{ref:function(e){return t.mask=e},className:r},e);return this.state.visible&&_reactDom.default.createPortal(i,document.body)}return e}},{key:"render",value:function(){return this.props.value&&0<this.props.value.length&&this.renderGalleria()}},{key:"activeItemIndex",get:function(){return this.props.onItemChange?this.props.activeIndex:this.state.activeIndex}}]),r}();_defineProperty(exports.Galleria=Galleria,"defaultProps",{id:null,value:null,activeIndex:0,fullScreen:!1,previewItemTemplate:null,thumbnailItemTemplate:null,indicatorItemTemplate:null,className:null,style:null,header:null,footer:null,numVisible:3,responsiveOptions:null,showPreviewNavButtons:!1,showThumbnailNavButtons:!0,showNavButtonsOnPreviewHover:!1,changePreviewOnIndicatorHover:!1,circular:!1,autoPlay:!1,transitionInterval:4e3,captionTemplate:null,showThumbnails:!0,thumbnailsPosition:"bottom",verticalThumbnailViewPortHeight:"300px",showIndicators:!1,showIndicatorsOnPreview:!1,indicatorsPosition:"bottom",baseZIndex:0,onItemChange:null}),_defineProperty(Galleria,"propTypes",{id:_propTypes.default.string,value:_propTypes.default.any,activeIndex:_propTypes.default.number,fullScreen:_propTypes.default.bool,previewItemTemplate:_propTypes.default.any,thumbnailItemTemplate:_propTypes.default.any,indicatorItemTemplate:_propTypes.default.any,className:_propTypes.default.string,style:_propTypes.default.object,header:_propTypes.default.any,footer:_propTypes.default.any,numVisible:_propTypes.default.number,responsiveOptions:_propTypes.default.array,showPreviewNavButtons:_propTypes.default.bool,showThumbnailNavButtons:_propTypes.default.bool,showNavButtonsOnPreviewHover:_propTypes.default.bool,changePreviewOnIndicatorHover:_propTypes.default.bool,circular:_propTypes.default.bool,autoPlay:_propTypes.default.bool,transitionInterval:_propTypes.default.number,captionTemplate:_propTypes.default.any,showThumbnails:_propTypes.default.bool,thumbnailsPosition:_propTypes.default.string,showIndicators:_propTypes.default.bool,showIndicatorsOnPreview:_propTypes.default.bool,indicatorsPosition:_propTypes.default.string,baseZIndex:_propTypes.default.number,onItemChange:_propTypes.default.func});
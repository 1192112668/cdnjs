"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _DomHandler=_interopRequireDefault(require("../utils/DomHandler"));function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}var Tooltip=function(){function e(t){_classCallCheck(this,e),this.target=t.target,this.targetContainer=t.targetContainer,this.content=t.content,this.options=t.options||{},this.options.event=this.options.event||"hover",this.options.position=this.options.position||"right",this.bindEvents()}return _createClass(e,[{key:"bindEvents",value:function(){"hover"===this.options.event?(this.mouseEnterListener=this.onMouseEnter.bind(this),this.mouseLeaveListener=this.onMouseLeave.bind(this),this.clickListener=this.onClick.bind(this),this.target.addEventListener("mouseenter",this.mouseEnterListener),this.target.addEventListener("mouseleave",this.mouseLeaveListener),this.target.addEventListener("click",this.clickListener)):"focus"===this.options.event&&(this.focusListener=this.onFocus.bind(this),this.blurListener=this.onBlur.bind(this),this.target.addEventListener("focus",this.focusListener),this.target.addEventListener("blur",this.blurListener))}},{key:"unbindEvents",value:function(){"hover"===this.options.event?(this.target.removeEventListener("mouseenter",this.mouseEnterListener),this.target.removeEventListener("mouseleave",this.mouseLeaveListener),this.target.removeEventListener("click",this.clickListener)):"focus"===this.options.event&&(this.target.removeEventListener("focus",this.focusListener),this.target.removeEventListener("blur",this.blurListener)),this.unbindDocumentResizeListener()}},{key:"onMouseEnter",value:function(){this.container||this.showTimeout||this.activate()}},{key:"onMouseLeave",value:function(){this.deactivate()}},{key:"onFocus",value:function(){this.activate()}},{key:"onBlur",value:function(){this.deactivate()}},{key:"onClick",value:function(){this.deactivate()}},{key:"activate",value:function(){var t=this;this.clearHideTimeout(),this.options.showDelay?this.showTimeout=setTimeout(function(){t.show()},this.options.showDelay):this.show()}},{key:"deactivate",value:function(){var t=this;this.clearShowTimeout(),this.options.hideDelay?this.hideTimeout=setTimeout(function(){t.hide()},this.options.hideDelay):this.hide()}},{key:"clearShowTimeout",value:function(){this.showTimeout&&(clearTimeout(this.showTimeout),this.showTimeout=null)}},{key:"clearHideTimeout",value:function(){this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=null)}},{key:"clearTimeouts",value:function(){this.clearShowTimeout(),this.clearHideTimeout()}},{key:"updateContent",value:function(t){this.content=t}},{key:"show",value:function(){this.content&&(this.create(),this.align(),_DomHandler.default.fadeIn(this.container,250),this.container.style.zIndex=++_DomHandler.default.zindex,this.bindDocumentResizeListener())}},{key:"hide",value:function(){this.remove()}},{key:"create",value:function(){this.container=document.createElement("div");var t=document.createElement("div");t.className="p-tooltip-arrow",this.container.appendChild(t),this.tooltipText=document.createElement("div"),this.tooltipText.className="p-tooltip-text",this.tooltipText.innerHTML=this.content,this.container.appendChild(this.tooltipText),document.body.appendChild(this.container),this.container.style.display="inline-block"}},{key:"remove",value:function(){this.container&&this.container.parentElement&&document.body.removeChild(this.container),this.unbindDocumentResizeListener(),this.clearTimeouts(),this.container=null}},{key:"align",value:function(){switch(this.options.position){case"top":this.alignTop(),this.isOutOfBounds()&&this.alignBottom();break;case"bottom":this.alignBottom(),this.isOutOfBounds()&&this.alignTop();break;case"left":this.alignLeft(),this.isOutOfBounds()&&(this.alignRight(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&this.alignBottom()));break;case"right":this.alignRight(),this.isOutOfBounds()&&(this.alignLeft(),this.isOutOfBounds()&&(this.alignTop(),this.isOutOfBounds()&&this.alignBottom()));break;default:throw new Error("Invalid position:"+this.options.position)}}},{key:"getHostOffset",value:function(){var t=(this.targetContainer||this.target).getBoundingClientRect();return{left:t.left+_DomHandler.default.getWindowScrollLeft(),top:t.top+_DomHandler.default.getWindowScrollTop()}}},{key:"alignRight",value:function(){this.preAlign("right");var t=this.targetContainer||this.target,e=this.getHostOffset(),i=e.left+_DomHandler.default.getOuterWidth(t),n=e.top+(_DomHandler.default.getOuterHeight(t)-_DomHandler.default.getOuterHeight(this.container))/2;this.container.style.left=i+"px",this.container.style.top=n+"px"}},{key:"alignLeft",value:function(){this.preAlign("left");var t=this.targetContainer||this.target,e=this.getHostOffset(),i=e.left-_DomHandler.default.getOuterWidth(this.container),n=e.top+(_DomHandler.default.getOuterHeight(t)-_DomHandler.default.getOuterHeight(this.container))/2;this.container.style.left=i+"px",this.container.style.top=n+"px"}},{key:"alignTop",value:function(){this.preAlign("top");var t=this.targetContainer||this.target,e=this.getHostOffset(),i=e.left+(_DomHandler.default.getOuterWidth(t)-_DomHandler.default.getOuterWidth(this.container))/2,n=e.top-_DomHandler.default.getOuterHeight(this.container);this.container.style.left=i+"px",this.container.style.top=n+"px"}},{key:"alignBottom",value:function(){this.preAlign("bottom");var t=this.targetContainer||this.target,e=this.getHostOffset(),i=e.left+(_DomHandler.default.getOuterWidth(t)-_DomHandler.default.getOuterWidth(this.container))/2,n=e.top+_DomHandler.default.getOuterHeight(t);this.container.style.left=i+"px",this.container.style.top=n+"px"}},{key:"preAlign",value:function(t){this.container.style.left="-999px",this.container.style.top="-999px";var e="p-tooltip p-component p-tooltip-"+t;this.container.className=this.options.className?e+" "+this.options.className:e}},{key:"isOutOfBounds",value:function(){var t=this.container.getBoundingClientRect(),e=t.top,i=t.left,n=_DomHandler.default.getOuterWidth(this.container),s=_DomHandler.default.getOuterHeight(this.container),o=_DomHandler.default.getViewport();return i+n>o.width||i<0||e<0||e+s>o.height}},{key:"bindDocumentResizeListener",value:function(){this.resizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.resizeListener)}},{key:"unbindDocumentResizeListener",value:function(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)}},{key:"onWindowResize",value:function(){this.hide()}},{key:"destroy",value:function(){this.unbindEvents(),this.remove(),this.target=null,this.targetContainer=null}}]),e}();exports.default=Tooltip;
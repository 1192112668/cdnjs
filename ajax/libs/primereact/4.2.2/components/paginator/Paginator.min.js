"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Paginator=void 0;var _react=_interopRequireWildcard(require("react")),_propTypes=_interopRequireDefault(require("prop-types")),_classnames=_interopRequireDefault(require("classnames")),_FirstPageLink=require("./FirstPageLink"),_NextPageLink=require("./NextPageLink"),_PrevPageLink=require("./PrevPageLink"),_LastPageLink=require("./LastPageLink"),_PageLinks=require("./PageLinks"),_RowsPerPageDropdown=require("./RowsPerPageDropdown"),_CurrentPageReport=require("./CurrentPageReport");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _getRequireWildcardCache(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return _getRequireWildcardCache=function(){return e},e}function _interopRequireWildcard(e){if(e&&e.__esModule)return e;if(null===e||"object"!==_typeof(e)&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache();if(t&&t.has(e))return t.get(e);var r,a={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e){Object.prototype.hasOwnProperty.call(e,o)&&((r=n?Object.getOwnPropertyDescriptor(e,o):null)&&(r.get||r.set)?Object.defineProperty(a,o,r):a[o]=e[o])}return a.default=e,t&&t.set(e,a),a}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(r){var a=_isNativeReflectConstruct();return function(){var e,t=_getPrototypeOf(r);return _possibleConstructorReturn(this,a?(e=_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Paginator=function(){_inherits(a,_react.Component);var r=_createSuper(a);function a(e){var t;return _classCallCheck(this,a),(t=r.call(this,e)).changePageToFirst=t.changePageToFirst.bind(_assertThisInitialized(t)),t.changePageToPrev=t.changePageToPrev.bind(_assertThisInitialized(t)),t.changePageToNext=t.changePageToNext.bind(_assertThisInitialized(t)),t.changePageToLast=t.changePageToLast.bind(_assertThisInitialized(t)),t.onRowsChange=t.onRowsChange.bind(_assertThisInitialized(t)),t.onPageLinkClick=t.onPageLinkClick.bind(_assertThisInitialized(t)),t}return _createClass(a,[{key:"isFirstPage",value:function(){return 0===this.getPage()}},{key:"isLastPage",value:function(){return this.getPage()===this.getPageCount()-1}},{key:"getPageCount",value:function(){return Math.ceil(this.props.totalRecords/this.props.rows)||1}},{key:"calculatePageLinkBoundaries",value:function(){var e=this.getPageCount(),t=Math.min(this.props.pageLinkSize,e),r=Math.max(0,Math.ceil(this.getPage()-t/2)),a=Math.min(e-1,r+t-1),n=this.props.pageLinkSize-(a-r+1);return[r=Math.max(0,r-n),a]}},{key:"updatePageLinks",value:function(){for(var e=[],t=this.calculatePageLinkBoundaries(),r=t[0],a=t[1],n=r;n<=a;n++)e.push(n+1);return e}},{key:"changePage",value:function(e,t){var r,a=this.getPageCount(),n=Math.floor(e/t);0<=n&&n<a&&(r={first:e,rows:t,page:n,pageCount:a},this.props.onPageChange&&this.props.onPageChange(r))}},{key:"getPage",value:function(){return Math.floor(this.props.first/this.props.rows)}},{key:"changePageToFirst",value:function(e){this.changePage(0,this.props.rows),e.preventDefault()}},{key:"changePageToPrev",value:function(e){this.changePage(this.props.first-this.props.rows,this.props.rows),e.preventDefault()}},{key:"onPageLinkClick",value:function(e){this.changePage((e.value-1)*this.props.rows,this.props.rows)}},{key:"changePageToNext",value:function(e){this.changePage(this.props.first+this.props.rows,this.props.rows),e.preventDefault()}},{key:"changePageToLast",value:function(e){this.changePage((this.getPageCount()-1)*this.props.rows,this.props.rows),e.preventDefault()}},{key:"onRowsChange",value:function(e){this.changePage(0,e.value)}},{key:"componentDidUpdate",value:function(e){0<this.getPage()&&e.totalRecords!==this.props.totalRecords&&this.props.first>=this.props.totalRecords&&this.changePage((this.getPageCount()-1)*this.props.rows,this.props.rows)}},{key:"render",value:function(){var a=this;if(this.props.alwaysShow||1!==this.getPageCount()){var e=(0,_classnames.default)("p-paginator p-component p-unselectable-text",this.props.className),t=this.props.template.split(" ").map(function(e){var t,r=e.trim();switch(r){case"FirstPageLink":t=_react.default.createElement(_FirstPageLink.FirstPageLink,{key:r,onClick:a.changePageToFirst,disabled:a.isFirstPage()});break;case"PrevPageLink":t=_react.default.createElement(_PrevPageLink.PrevPageLink,{key:r,onClick:a.changePageToPrev,disabled:a.isFirstPage()});break;case"NextPageLink":t=_react.default.createElement(_NextPageLink.NextPageLink,{key:r,onClick:a.changePageToNext,disabled:a.isLastPage()});break;case"LastPageLink":t=_react.default.createElement(_LastPageLink.LastPageLink,{key:r,onClick:a.changePageToLast,disabled:a.isLastPage()});break;case"PageLinks":t=_react.default.createElement(_PageLinks.PageLinks,{key:r,value:a.updatePageLinks(),page:a.getPage(),onClick:a.onPageLinkClick});break;case"RowsPerPageDropdown":t=_react.default.createElement(_RowsPerPageDropdown.RowsPerPageDropdown,{key:r,value:a.props.rows,options:a.props.rowsPerPageOptions,onChange:a.onRowsChange});break;case"CurrentPageReport":t=_react.default.createElement(_CurrentPageReport.CurrentPageReport,{template:a.props.currentPageReportTemplate,key:r,page:a.getPage(),pageCount:a.getPageCount(),first:a.props.first,rows:a.props.rows,totalRecords:a.props.totalRecords});break;default:t=null}return t}),r=this.props.leftContent&&_react.default.createElement("div",{className:"p-paginator-left-content"},this.props.leftContent),n=this.props.rightContent&&_react.default.createElement("div",{className:"p-paginator-right-content"},this.props.rightContent);return _react.default.createElement("div",{className:e,style:this.props.style},r,t,n)}return null}}]),a}();_defineProperty(exports.Paginator=Paginator,"defaultProps",{totalRecords:0,rows:0,first:0,pageLinkSize:5,rowsPerPageOptions:null,style:null,className:null,template:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown",onPageChange:null,leftContent:null,rightContent:null,currentPageReportTemplate:"({currentPage} of {totalPages})",alwaysShow:!0}),_defineProperty(Paginator,"propTypes",{totalRecords:_propTypes.default.number,rows:_propTypes.default.number,first:_propTypes.default.number,pageLinkSize:_propTypes.default.number,rowsPerPageOptions:_propTypes.default.array,style:_propTypes.default.object,className:_propTypes.default.string,template:_propTypes.default.string,onPageChange:_propTypes.default.func,leftContent:_propTypes.default.any,rightContent:_propTypes.default.any,currentPageReportTemplate:_propTypes.default.any,alwaysShow:_propTypes.default.bool});
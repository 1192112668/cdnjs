!function(e){"function"==typeof define&&define.amd?define(["jquery","./core"],e):e(jQuery,Formstone)}(function(a,e){"use strict";function o(){!function(){for(var e in r={unit:s.unit},u)if(u.hasOwnProperty(e))for(var t in l[e]){var n,i;l[e].hasOwnProperty(t)&&(n="Infinity"===t?1/0:parseInt(t,10),i=-1<e.indexOf("max"),l[e][t].matches&&(i?(!r[e]||n<r[e])&&(r[e]=n):(!r[e]||n>r[e])&&(r[e]=n)))}}(),n.trigger(c.mqChange,[r])}function h(e){var t=m(e.media),n=f[t],i=e.matches,r=i?c.enter:c.leave;if(n&&(n.active||!n.active&&i)){for(var a in n[r])n[r].hasOwnProperty(a)&&n[r][a].apply(n.mq);n.active=!0}}function m(e){return e.replace(/[^a-z0-9\s]/gi,"").replace(/[_\s]/g,"").replace(/^\s+|\s+$/g,"")}var t=e.Plugin("mediaquery",{utilities:{_initialize:function(e){for(var t in e=e||{},u)u.hasOwnProperty(t)&&(s[t]=e[t]?a.merge(e[t],s[t]):s[t]);for(var n in(s=a.extend(s,e)).minWidth.sort(d.sortDesc),s.maxWidth.sort(d.sortAsc),s.minHeight.sort(d.sortDesc),s.maxHeight.sort(d.sortAsc),u)if(u.hasOwnProperty(n))for(var i in l[n]={},s[n]){var r;s[n].hasOwnProperty(i)&&((r=window.matchMedia("("+u[n]+": "+(s[n][i]===1/0?1e5:s[n][i])+s.unit+")")).addListener(o),l[n][s[n][i]]=r)}o()},state:function(){return r},bind:function(e,t,n){var i=v.matchMedia(t),r=m(i.media);for(var a in f[r]||(f[r]={mq:i,active:!0,enter:{},leave:{}},f[r].mq.addListener(h)),n)n.hasOwnProperty(a)&&f[r].hasOwnProperty(a)&&(f[r][a][e]=n[a]);var o=f[r],s=i.matches;s&&o[c.enter].hasOwnProperty(e)?(o[c.enter][e].apply(i),o.active=!0):!s&&o[c.leave].hasOwnProperty(e)&&(o[c.leave][e].apply(i),o.active=!1)},unbind:function(e,t){if(e)if(t){var n=m(t);f[n]&&(f[n].enter[e]&&delete f[n].enter[e],f[n].leave[e]&&delete f[n].leave[e])}else for(var i in f)f.hasOwnProperty(i)&&(f[i].enter[e]&&delete f[i].enter[e],f[i].leave[e]&&delete f[i].leave[e])}},events:{mqChange:"mqchange"}}),s={minWidth:[0],maxWidth:[1/0],minHeight:[0],maxHeight:[1/0],unit:"px"},c=a.extend(t.events,{enter:"enter",leave:"leave"}),n=e.$window,v=n[0],d=t.functions,r=null,f=[],l={},u={minWidth:"min-width",maxWidth:"max-width",minHeight:"min-height",maxHeight:"max-height"}});
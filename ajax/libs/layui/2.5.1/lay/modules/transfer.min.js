layui.define("form",function(a){"use strict";function i(a){var e=this;e.index=++t.index,e.config=v.extend({},e.config,t.config,a),e.render()}var p=layui.form,v=layui.$,t={config:{},index:layui.transfer?layui.transfer.index+1e4:0,set:function(a){var e=this;return e.config=v.extend({},e.config,a),e},on:function(a,e){return layui.onevent.call(this,n,a,e)}},n="transfer",k="layui-transfer-topTitle",e="layui-transfer-left",b="layui-transfer-right",g="layui-transfer-dataLeft",x="layui-transfer-dataRight",l="layui-transfer-btnLeft",m="layui-transfer-btnRight",C="layui-btn-disabled";i.prototype.config={title:["列表一","列表二"],width:200,height:340,data:[],value:[],showSearch:!1,id:""},i.prototype.render=function(){var a=this,t=a.config,e="",n="",l=[];"function"==typeof t.parseData&&layui.each(t.data,function(a,e){t.data[a]=t.parseData(e)||e});var r=0,d="",s=0,c=0;layui.each(t.data,function(a,i){r=0,layui.each(t.value,function(a,e){if(i.value==e)return r=1,!0}),d='<li data-title="'+i.title+'"><input lay-skin="primary" type="checkbox" data-index="'+a+'" name="'+(0==r?"layTranLeftCheck":"layTranRightCheck")+'" title="'+i.title+'" value="'+i.value+'" class="layui-input" '+(i.disabled?"disabled":"")+"></li>",0==r?(e+=d,s+=i.disabled?0:1):(n+=d,c+=i.disabled?0:1,l.push(a))});var i=['<div class="layui-transfer layui-form layui-border-box" id="transfer-'+t.id+'" lay-filter="LAY-Transfer-'+a.index+'">','<div class="layui-transfer-left layui-transfer-box" data-total="'+s+'">','<div class="'+k+'"><input lay-skin="primary" name="layTranLeftCheck" lay-filter="layTranLeftCheckAll" type="checkbox" class="layui-input" title="'+t.title[0]+'"></div>',t.showSearch?'<div class="layui-transfer-search"><input class="layui-input" placeholder="关键字搜索"><i class="layui-icon layui-icon-search layui-transfer-searchI"></i></div><ul class="layui-transfer-data layui-transfer-dataLeft layui-transfer-short">':'<ul class="layui-transfer-data layui-transfer-dataLeft">',e+"</ul>","</div>",'<div class="layui-transfer-btn">','<button type="button" class="layui-btn layui-btn-primary layui-transfer-btnRight layui-btn-disabled"><i class="layui-icon layui-icon-next"></i></button>','<button type="button" class="layui-btn layui-btn-primary layui-transfer-btnLeft layui-btn-disabled"><i class="layui-icon layui-icon-prev"></i></button></div>','<div class="layui-transfer-right layui-transfer-box" data-arr="'+l+'" data-total="'+c+'">','<div class="'+k+'"><input lay-skin="primary" name="layTranRightCheck" lay-filter="layTranRightCheckAll" type="checkbox" class="layui-input" title="'+t.title[1]+'"></div>',t.showSearch?'<div class="layui-transfer-search"><input class="layui-input" placeholder="关键字搜索"><i class="layui-icon layui-icon-search layui-transfer-searchI"></i></div><ul class="layui-transfer-data layui-transfer-dataRight layui-transfer-short">':'<ul class="layui-transfer-data layui-transfer-dataRight">',n+"</ul>","</div>","</div>"].join(""),u=v(t.elem),f=u.next(".layui-transfer");f[0]&&f.remove(),a.elem=v(i),u.html(a.elem),a.layTop=a.elem.find("."+k),a.layBox=a.elem.find(".layui-transfer-box"),a.laySearch=a.elem.find(".layui-transfer-search"),a.layData=a.elem.find(".layui-transfer-data"),a.layBox.css({width:t.width,height:t.height}),a.layData.css({height:t.height-a.layTop.outerHeight()-a.laySearch.outerHeight()-2}),a.event(),p.render("checkbox","LAY-Transfer-"+a.index)},i.prototype.event=function(){function a(a){var e=s.find(a).find(".layui-transfer-search"),i=e.children("input").val();e.next().children("li").each(function(){-1==v(this).data("title").indexOf(i)?v(this).hide():v(this).show()})}var r=this,d=r.config,s=r.elem,c="",u="",f=s.find("."+e).find("."+k).find('input[name="layTranLeftCheck"]'),h=s.find("."+b).find("."+k).find('input[name="layTranRightCheck"]'),o=s.find("."+e).data("total"),y=s.find("."+b).data("total");s.on("click",'input[name="layTranLeftCheck"]+',function(){var i,a=v(this).prev(),t=a[0].checked,n=s.find("."+g).find('input[name="layTranLeftCheck"]'),e="layTranLeftCheckAll"==a.attr("lay-filter");a[0].disabled||(e?(c="",0==o?a[0].checked=!1:(n.each(function(a,e){e.disabled||((e.checked=t)?(c+=v(n[a]).data("index")+",",v(n[a]).parent("li").addClass("selected")):v(n[a]).parent("li").removeClass("selected"))}),t?s.find("."+m).removeClass(C):s.find("."+m).addClass(C))):(i=1,t?(n.each(function(a,e){e.disabled||e.checked||(i=0)}),1==i&&(f[0].checked=t),c+=a.data("index")+",",a.parent("li").addClass("selected"),s.find("."+m).removeClass(C)):(f[0].checked&&(f[0].checked=!1),a.parent("li").removeClass("selected"),c=c.replace(a.data("index"),""),n.each(function(a,e){e.checked&&(i=0)}),1==i&&s.find("."+m).addClass(C))),p.render("checkbox","LAY-Transfer-"+r.index))}),s.on("click",'input[name="layTranRightCheck"]+',function(){var i,a=v(this).prev(),t=a[0].checked,n=s.find("."+x).find('input[name="layTranRightCheck"]'),e="layTranRightCheckAll"===a.attr("lay-filter");a[0].disabled||(e?(u="",0==y?a[0].checked=!1:(n.each(function(a,e){e.disabled||((e.checked=t)?(u+=v(n[a]).data("index")+",",v(n[a]).parent("li").addClass("selected")):v(n[a]).parent("li").removeClass("selected"))}),t?s.find("."+l).removeClass(C):s.find("."+l).addClass(C)),p.render("checkbox","LAY-Transfer-"+r.index)):(i=1,t?(n.each(function(a,e){e.disabled||e.checked||(i=0)}),1==i&&(h[0].checked=t),u+=a.data("index")+",",a.parent("li").addClass("selected"),s.find("."+l).removeClass(C)):(h[0].checked&&(h[0].checked=!1),a.parent("li").removeClass("selected"),u=u.replace(a.data("index"),""),n.each(function(a,e){e.checked&&(i=0)}),1==i&&s.find("."+l).addClass(C))),p.render("checkbox","LAY-Transfer-"+r.index))}),s.on("click","."+m,function(){var t,n,l="";v(this).hasClass(C)||(s.find("."+g).find("li").each(function(){v(this).hasClass("selected")&&v(this).remove()}),t=s.find("."+b).data("arr"),n=0,layui.each(c.split(","),function(a,e){var i;e&&(i=d.data[e],l+='<li data-title="'+i.title+'"><input lay-skin="primary" type="checkbox" data-index="'+e+'" name="layTranRightCheck" title="'+i.title+'" value="'+i.value+'" class="layui-input" '+(i.disabled?"disabled":"")+"></li>",t+=","+e,n++)}),s.find("."+x).append(l),a("."+b),f[0].checked=!1,h[0].checked=!1,v(this).addClass(C),c="",y+=n,o-=n,s.find("."+b).data("total",y),s.find("."+b).data("total",o),s.find("."+b).data("arr",t),p.render("checkbox","LAY-Transfer-"+r.index),d.onchange&&d.onchange(r.getData()))}),s.on("click","."+l,function(){var t,n,l="";v(this).hasClass(C)||(s.find("."+x).find("li").each(function(){v(this).hasClass("selected")&&v(this).remove()}),t=s.find("."+b).data("arr"),n=0,layui.each(u.split(","),function(a,e){var i;e&&(i=d.data[e],l+='<li data-title="'+i.title+'"><input lay-skin="primary" type="checkbox" data-index="'+e+'" name="layTranLeftCheck" title="'+i.title+'" value="'+i.value+'" class="layui-input" '+(i.disabled?"disabled":"")+"></li>",t=t.replace(e,"").replace(/(,)+/g,","),n++)}),s.find("."+g).append(l),a("."+e),f[0].checked=!1,h[0].checked=!1,v(this).addClass(C),u="",y-=n,o+=n,s.find("."+b).data("total",y),s.find("."+b).data("total",o),s.find("."+b).data("arr",t),p.render("checkbox","LAY-Transfer-"+r.index),d.onchange&&d.onchange(r.getData()))}),s.find(".layui-transfer-search").on("keyup","input",function(){a(v(this).parent("div").parent("div"))})},i.prototype.getData=function(){var i=this.config,a=this.elem.find("."+b).data("arr"),t=[];return layui.each(a.split(",").sort(function(a,e){return a-e}),function(a,e){e&&t.push(i.data[e])}),t},t.render=function(a){var e=new i(a);return function(){var a=this;return{getData:function(){return a.getData()},config:a.config}}.call(e)},a(n,t)});
"use strict";var LSStorage=function(){function e(e){var t=e.storage,r=void 0===t?window.localStorage:t,n=e.stringify,o=void 0===n?JSON.stringify:n,a=e.parse,i=void 0===a?JSON.parse:a;this.storage=r,this.stringify=o,this.parse=i}return e.prototype.set=function(e,t){this.storage.setItem(e,this.stringify(t))},e.prototype.get=function(e){return this.parse(this.storage.getItem(e))},e.prototype.has=function(e){return null!=this.storage.getItem(e)},e}();function parsePath(e){return e.replace(/\[([^[\]]*)\]/g,".$1.").split(".").filter(function(e){return""!==e})}function get(e,t){return parsePath(t).reduce(function(e,t){return e&&e[t]},e)}function set(e,t,r){for(var n=parsePath(t),o=e,a=0;a<n.length-1;a++){var i=n[a];o.hasOwnProperty(i)||(o[i]={}),o=o[i]}o[n[n.length-1]]=r}function copy(e,t,r){set(e,r,get(t,r))}var isobj=function(e){return"object"==typeof e&&!Array.isArray(e)&&null!==e};function merge(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=0,o=t;n<o.length;n++){var a=o[n];for(var i in a)a.hasOwnProperty(i)&&(isobj(a[i])?merge(e[i],a[i]):e[i]=a[i])}return e}function applyPersistence(e,t){for(var r=t.keys,n=t.merge,o=void 0===n?merge:n,a=t.namespace,i=new LSStorage(t),s={},u=0,c=r;u<c.length;u++){var f=c[u];copy(s,e,f)}var g=null;if(i.has(a))g=i.get(a);else{for(var l={},p=0,h=r;p<h.length;p++){copy(l,s,f=h[p])}g=l}i.set(a,g),g=o(s,g);for(var v=function(t){copy(e,g,t),e.$watch(t,{handler:function(e){set(g,t,e),i.set(a,g)},deep:!0})},y=0,m=r;y<m.length;y++){v(f=m[y])}}function install(e){e.mixin({created:function(){var t=this;if("storage"in this.$options){var e=this.$options.storage;if(Array.isArray(e))return void e.forEach(function(e){return applyPersistence(t,e)});applyPersistence(this,e)}}})}function createVuexPlugin(e){var i=new LSStorage(e),s=e.keys,t=e.merge,u=void 0===t?merge:t,c=e.namespace;return function(e){var a=null;if(i.has(c))a=i.get(c);else{for(var t={},r=0,n=s;r<n.length;r++){var o=n[r];copy(t,e.state,o)}a=t}e.replaceState(u(e.state,a)),i.set(c,a),e.subscribe(function(e,t){for(var r={},n=0,o=s;n<o.length;n++){copy(r,t,o[n])}a=r,i.set(c,r)})}}var vuejsStorage=function(e){return createVuexPlugin(e)};vuejsStorage.install=install,module.exports=vuejsStorage;
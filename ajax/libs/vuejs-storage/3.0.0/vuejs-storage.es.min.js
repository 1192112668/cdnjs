function parsePath(e){return e.replace(/\[([^[\]]*)\]/g,".$1.").split(".").filter(function(e){return""!==e})}function get(e,r){return parsePath(r).reduce(function(e,r){return e&&e[r]},e)}function set(e,r,t){for(var n=parsePath(r),o=e,a=0;a<n.length-1;a++){var s=n[a];o.hasOwnProperty(s)||(o[s]={}),o=o[s]}o[n[n.length-1]]=t}function copy(e,r,t){set(e,t,get(r,t))}var StroageDriverImpl=function(){function e(e){this.storage=e}return e.prototype.set=function(e,r){this.storage.setItem(e,JSON.stringify(r))},e.prototype.get=function(e){return JSON.parse(this.storage.getItem(e))},e.prototype.has=function(e){return!!this.storage.getItem(e)},e}(),localStorage=new StroageDriverImpl(window.localStorage),sessionStorage=new StroageDriverImpl(window.sessionStorage),drivers=Object.freeze({localStorage:localStorage,sessionStorage:sessionStorage,default:StroageDriverImpl}),isobj=function(e){return"object"==typeof e&&!Array.isArray(e)&&null!==e};function merge(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];for(var n=0,o=r;n<o.length;n++){var a=o[n];for(var s in a)a.hasOwnProperty(s)&&(isobj(a[s])?merge(e[s],a[s]):e[s]=a[s])}return e}function applyPersistence(e,r){for(var t=r.keys,n=r.merge,o=void 0===n?merge:n,a=r.namespace,s=r.driver,i=void 0===s?localStorage:s,c={},g=0,l=t;g<l.length;g++){var u=l[g];copy(c,e,u)}var f=null;if(i.has(a))f=i.get(a);else{for(var p={},v=0,h=t;v<h.length;v++){copy(p,c,u=h[v])}f=p,i.set(a,f)}f=o(c,f);for(var y=function(r){copy(e,f,r),e.$watch(r,{handler:function(e){set(f,r,e),i.set(a,f)},deep:!0})},S=0,d=t;S<d.length;S++){y(u=d[S])}}function install(e){e.mixin({created:function(){var e=this;if("storage"in this.$options){var r=this.$options.storage;Array.isArray(r)?r.forEach(function(r){return applyPersistence(e,r)}):applyPersistence(this,r)}}})}function createVuexPlugin(e){var r=e.keys,t=e.merge,n=void 0===t?merge:t,o=e.namespace,a=e.driver,s=void 0===a?localStorage:a;return function(e){if(s.has(o)){var t=s.get(o);e.replaceState(n(e.state,t))}else{t={};for(var a=0,i=r;a<i.length;a++){var c=i[a];copy(t,e.state,c)}s.set(o,t)}e.subscribe(function(e,t){for(var n={},a=0,i=r;a<i.length;a++){copy(n,t,i[a])}s.set(o,n)})}}var vuejsStorage=function(e){return createVuexPlugin(e)};vuejsStorage.install=install,vuejsStorage.drivers=drivers;export default vuejsStorage;
"use strict";function parsePath(e){return e.replace(/\[([^[\]]*)\]/g,".$1.").split(".").filter(function(e){return""!==e})}function get(e,r){return parsePath(r).reduce(function(e,r){return e&&e[r]},e)}function set(e,r,t){for(var o=parsePath(r),n=e,a=0;a<o.length-1;a++){var s=o[a];n.hasOwnProperty(s)||(n[s]={}),n=n[s]}n[o[o.length-1]]=t}function copy(e,r,t){set(e,t,get(r,t))}var StroageDriverImpl=function(){function e(e){this.storage=e}return e.prototype.set=function(e,r){this.storage.setItem(e,JSON.stringify(r))},e.prototype.get=function(e){return JSON.parse(this.storage.getItem(e))},e.prototype.has=function(e){return!!this.storage.getItem(e)},e}(),localStorage=new StroageDriverImpl(window.localStorage),sessionStorage=new StroageDriverImpl(window.sessionStorage),drivers=Object.freeze({localStorage:localStorage,sessionStorage:sessionStorage,default:StroageDriverImpl}),isobj=function(e){return"object"==typeof e&&!Array.isArray(e)&&null!==e};function merge(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];for(var o=0,n=r;o<n.length;o++){var a=n[o];for(var s in a)a.hasOwnProperty(s)&&(isobj(a[s])?merge(e[s],a[s]):e[s]=a[s])}return e}function applyPersistence(e,r){for(var t=r.keys,o=r.merge,n=void 0===o?merge:o,a=r.namespace,s=r.driver,i=void 0===s?localStorage:s,c={},g=0,u=t;g<u.length;g++){var l=u[g];copy(c,e,l)}var f=null;if(i.has(a))f=i.get(a);else{for(var p={},v=0,h=t;v<h.length;v++){copy(p,c,l=h[v])}f=p,i.set(a,f)}f=n(c,f);for(var y=function(r){copy(e,f,r),e.$watch(r,{handler:function(e){set(f,r,e),i.set(a,f)},deep:!0})},S=0,d=t;S<d.length;S++){y(l=d[S])}}function install(e){e.mixin({created:function(){var e,r=this;"storage"in this.$options&&(e=this.$options.storage,Array.isArray(e)?e.forEach(function(e){return applyPersistence(r,e)}):applyPersistence(this,e))}})}function createVuexPlugin(e){var a=e.keys,r=e.merge,s=void 0===r?merge:r,i=e.namespace,t=e.driver,c=void 0===t?localStorage:t;return function(e){if(c.has(i)){var r=c.get(i);e.replaceState(s(e.state,r))}else{for(var r={},t=0,o=a;t<o.length;t++){var n=o[t];copy(r,e.state,n)}c.set(i,r)}e.subscribe(function(e,r){for(var t={},o=0,n=a;o<n.length;o++){copy(t,r,n[o])}c.set(i,t)})}}var vuejsStorage=function(e){return createVuexPlugin(e)};vuejsStorage.install=install,vuejsStorage.drivers=drivers,module.exports=vuejsStorage;
"use strict";function parsePath(e){return e.replace(/\[([^[\]]*)\]/g,".$1.").split(".").filter(function(e){return""!==e})}function get(e,t){return parsePath(t).reduce(function(e,t){return e&&e[t]},e)}function set(e,t,r){for(var n=parsePath(t),o=e,a=0;a<n.length-1;a++){var s=n[a];o.hasOwnProperty(s)||(o[s]={}),o=o[s]}o[n[n.length-1]]=r}function copy(e,t,r){set(e,r,get(t,r))}var StroageDriverImpl=function(){function e(e){this.storage=e}return e.prototype.set=function(e,t){this.storage.setItem(e,JSON.stringify(t))},e.prototype.get=function(e){return JSON.parse(this.storage.getItem(e))},e.prototype.has=function(e){return!!this.storage.getItem(e)},e}(),localStorage=new StroageDriverImpl(window.localStorage),sessionStorage=new StroageDriverImpl(window.sessionStorage),drivers=Object.freeze({localStorage:localStorage,sessionStorage:sessionStorage,default:StroageDriverImpl}),isobj=function(e){return"object"==typeof e&&!Array.isArray(e)&&null!==e},merge=function(e,t){for(var r=0,n=Object.keys(t);r<n.length;r++){var o=n[r];isobj(t[o])&&o in e?merge(e[o],t[o]):e[o]=t[o]}return e};function applyPersistence(e,t){for(var r=t.keys,n=t.merge,o=void 0===n?merge:n,a=t.namespace,s=t.driver,i=void 0===s?localStorage:s,c={},u=0,g=r;u<g.length;u++){var l=g[u];copy(c,e,l)}var f=null;if(i.has(a))f=i.get(a);else{for(var p={},v=0,h=r;v<h.length;v++){copy(p,c,l=h[v])}f=p,i.set(a,f)}f=o(c,f);for(var y=function(t){copy(e,f,t),e.$watch(t,{handler:function(e){set(f,t,e),i.set(a,f)},deep:!0})},S=0,d=r;S<d.length;S++){y(l=d[S])}}function install(e){e.mixin({created:function(){var e,t=this;"storage"in this.$options&&(e=this.$options.storage,Array.isArray(e)?e.forEach(function(e){return applyPersistence(t,e)}):applyPersistence(this,e))}})}function createVuexPlugin(e){var a=e.keys,t=e.merge,s=void 0===t?merge:t,i=e.namespace,r=e.driver,c=void 0===r?localStorage:r;return function(e){if(c.has(i)){var t=c.get(i);e.replaceState(s(e.state,t))}else{for(var t={},r=0,n=a;r<n.length;r++){var o=n[r];copy(t,e.state,o)}c.set(i,t)}e.subscribe(function(e,t){for(var r={},n=0,o=a;n<o.length;n++){copy(r,t,o[n])}c.set(i,r)})}}var vuejsStorage=function(e){return createVuexPlugin(e)};vuejsStorage.install=install,vuejsStorage.drivers=drivers,module.exports=vuejsStorage;
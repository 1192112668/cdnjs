function parsePath(e){return e.replace(/\[([^[\]]*)\]/g,".$1.").split(".").filter(function(e){return""!==e})}function get(e,t){return parsePath(t).reduce(function(e,t){return e&&e[t]},e)}function set(e,t,r){for(var n=parsePath(t),o=e,a=0;a<n.length-1;a++){var s=n[a];o.hasOwnProperty(s)||(o[s]={}),o=o[s]}o[n[n.length-1]]=r}function copy(e,t,r){set(e,r,get(t,r))}var StroageDriverImpl=function(){function e(e){this.storage=e}return e.prototype.set=function(e,t){this.storage.setItem(e,JSON.stringify(t))},e.prototype.get=function(e){return JSON.parse(this.storage.getItem(e))},e.prototype.has=function(e){return!!this.storage.getItem(e)},e}(),localStorage=new StroageDriverImpl(window.localStorage),sessionStorage=new StroageDriverImpl(window.sessionStorage),drivers=Object.freeze({localStorage:localStorage,sessionStorage:sessionStorage,default:StroageDriverImpl}),isobj=function(e){return"object"==typeof e&&!Array.isArray(e)&&null!==e},merge=function(e,t){for(var r=0,n=Object.keys(t);r<n.length;r++){var o=n[r];isobj(t[o])&&o in e?merge(e[o],t[o]):e[o]=t[o]}return e};function applyPersistence(e,t){for(var r=t.keys,n=t.merge,o=void 0===n?merge:n,a=t.namespace,s=t.driver,i=void 0===s?localStorage:s,c={},g=0,u=r;g<u.length;g++){var l=u[g];copy(c,e,l)}var f=null;if(i.has(a))f=i.get(a);else{for(var p={},v=0,h=r;v<h.length;v++){copy(p,c,l=h[v])}f=p,i.set(a,f)}f=o(c,f);for(var y=function(t){copy(e,f,t),e.$watch(t,{handler:function(e){set(f,t,e),i.set(a,f)},deep:!0})},S=0,d=r;S<d.length;S++){y(l=d[S])}}function install(e){e.mixin({created:function(){var e=this;if("storage"in this.$options){var t=this.$options.storage;Array.isArray(t)?t.forEach(function(t){return applyPersistence(e,t)}):applyPersistence(this,t)}}})}function createVuexPlugin(e){var t=e.keys,r=e.merge,n=void 0===r?merge:r,o=e.namespace,a=e.driver,s=void 0===a?localStorage:a;return function(e){if(s.has(o)){var r=s.get(o);e.replaceState(n(e.state,r))}else{r={};for(var a=0,i=t;a<i.length;a++){var c=i[a];copy(r,e.state,c)}s.set(o,r)}e.subscribe(function(e,r){for(var n={},a=0,i=t;a<i.length;a++){copy(n,r,i[a])}s.set(o,n)})}}var vuejsStorage=function(e){return createVuexPlugin(e)};vuejsStorage.install=install,vuejsStorage.drivers=drivers;export default vuejsStorage;